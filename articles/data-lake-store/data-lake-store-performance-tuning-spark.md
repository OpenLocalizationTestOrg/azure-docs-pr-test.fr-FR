---
title: "aaaAzure instructions de réglage de données Lake Store Spark performances | Documents Microsoft"
description: "Recommandations en matière d’optimisation des performances d’Azure Data Lake Store Spark"
services: data-lake-store
documentationcenter: 
author: stewu
manager: amitkul
editor: stewu
ms.assetid: ebde7b9f-2e51-4d43-b7ab-566417221335
ms.service: data-lake-store
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 12/19/2016
ms.author: stewu
ms.openlocfilehash: da1d172e9cb1199ad95605ea1718e78559f79650
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="performance-tuning-guidance-for-spark-on-hdinsight-and-azure-data-lake-store"></a><span data-ttu-id="94f90-103">Recommandations en matière d’optimisation des performances pour Spark sur HDInsight et Azure Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="94f90-103">Performance tuning guidance for Spark on HDInsight and Azure Data Lake Store</span></span>

<span data-ttu-id="94f90-104">Lors du paramétrage des performances sur Spark, vous devez tooconsider hello des applications qui s’exécuteront sur votre cluster.</span><span class="sxs-lookup"><span data-stu-id="94f90-104">When tuning performance on Spark, you need tooconsider hello number of apps that will be running on your cluster.</span></span>  <span data-ttu-id="94f90-105">Par défaut, vous pouvez exécuter 4 applications simultanément sur votre cluster HDI (Remarque : hello par défaut est sujet toochange).</span><span class="sxs-lookup"><span data-stu-id="94f90-105">By default, you can run 4 apps concurrently on your HDI cluster (Note: hello default setting is subject toochange).</span></span>  <span data-ttu-id="94f90-106">Vous pouvez décider des applications moins de toouse afin de pouvoir remplacer les paramètres par défaut de hello et d’utiliser le cluster de hello pour ces applications.</span><span class="sxs-lookup"><span data-stu-id="94f90-106">You may decide toouse fewer apps so you can override hello default settings and use more of hello cluster for those apps.</span></span>  

## <a name="prerequisites"></a><span data-ttu-id="94f90-107">Composants requis</span><span class="sxs-lookup"><span data-stu-id="94f90-107">Prerequisites</span></span>

* <span data-ttu-id="94f90-108">**Un abonnement Azure**.</span><span class="sxs-lookup"><span data-stu-id="94f90-108">**An Azure subscription**.</span></span> <span data-ttu-id="94f90-109">Consultez la page [Obtention d’un essai gratuit d’Azure](https://azure.microsoft.com/pricing/free-trial/).</span><span class="sxs-lookup"><span data-stu-id="94f90-109">See [Get Azure free trial](https://azure.microsoft.com/pricing/free-trial/).</span></span>
* <span data-ttu-id="94f90-110">**Un compte Azure Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="94f90-110">**An Azure Data Lake Store account**.</span></span> <span data-ttu-id="94f90-111">Pour obtenir des instructions sur la façon de voir d’un seul, toocreate [prise en main Azure Data Lake Store](data-lake-store-get-started-portal.md)</span><span class="sxs-lookup"><span data-stu-id="94f90-111">For instructions on how toocreate one, see [Get started with Azure Data Lake Store](data-lake-store-get-started-portal.md)</span></span>
* <span data-ttu-id="94f90-112">**Cluster HDInsight Azure** avec accès tooa compte Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="94f90-112">**Azure HDInsight cluster** with access tooa Data Lake Store account.</span></span> <span data-ttu-id="94f90-113">Voir [Créer un cluster HDInsight avec Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span><span class="sxs-lookup"><span data-stu-id="94f90-113">See [Create an HDInsight cluster with Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span></span> <span data-ttu-id="94f90-114">Assurez-vous que vous activez Bureau à distance de cluster de hello.</span><span class="sxs-lookup"><span data-stu-id="94f90-114">Make sure you enable Remote Desktop for hello cluster.</span></span>
* <span data-ttu-id="94f90-115">**Exécution d’un cluster Spark sur Azure Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="94f90-115">**Running Spark cluster on Azure Data Lake Store**.</span></span>  <span data-ttu-id="94f90-116">Pour plus d’informations, consultez [données de tooanalyze du cluster utilisez HDInsight Spark dans Data Lake Store](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-apache-spark-use-with-data-lake-store)</span><span class="sxs-lookup"><span data-stu-id="94f90-116">For more information, see [Use HDInsight Spark cluster tooanalyze data in Data Lake Store](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-apache-spark-use-with-data-lake-store)</span></span>
* <span data-ttu-id="94f90-117">**Instructions d’optimisation des performances sur ADLS**.</span><span class="sxs-lookup"><span data-stu-id="94f90-117">**Performance tuning guidelines on ADLS**.</span></span>  <span data-ttu-id="94f90-118">Pour les concepts généraux sur les performances, consultez [Data Lake Store Performance Tuning Guidance (Recommandations en matière d’optimisation des performances de Data Lake Store)](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance)</span><span class="sxs-lookup"><span data-stu-id="94f90-118">For general performance concepts, see [Data Lake Store Performance Tuning Guidance](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance)</span></span> 

## <a name="parameters"></a><span data-ttu-id="94f90-119">Paramètres</span><span class="sxs-lookup"><span data-stu-id="94f90-119">Parameters</span></span>

<span data-ttu-id="94f90-120">Lors de l’exécution des travaux Spark, voici hello principaux paramètres qui peuvent être des performances tooincrease analysé sur ADLS :</span><span class="sxs-lookup"><span data-stu-id="94f90-120">When running Spark jobs, here are hello most important settings that can be tuned tooincrease performance on ADLS:</span></span>

* <span data-ttu-id="94f90-121">**Num-exécuteurs** -hello du nombre de tâches simultanées qui peuvent être exécutés.</span><span class="sxs-lookup"><span data-stu-id="94f90-121">**Num-executors** - hello number of concurrent tasks that can be executed.</span></span>

* <span data-ttu-id="94f90-122">**Mémoire de l’exécuteur** -hello quantité de mémoire allouée tooeach exécuteur.</span><span class="sxs-lookup"><span data-stu-id="94f90-122">**Executor-memory** - hello amount of memory allocated tooeach executor.</span></span>

* <span data-ttu-id="94f90-123">**Cœurs de l’exécuteur** -nombre hello de cœurs allouée tooeach exécuteur.</span><span class="sxs-lookup"><span data-stu-id="94f90-123">**Executor-cores** - hello number of cores allocated tooeach executor.</span></span>                     

<span data-ttu-id="94f90-124">**Num-exécuteurs** Num-exécuteurs définira le nombre maximal de hello de tâches qui peuvent s’exécuter en parallèle.</span><span class="sxs-lookup"><span data-stu-id="94f90-124">**Num-executors** Num-executors will set hello maximum number of tasks that can run in parallel.</span></span>  <span data-ttu-id="94f90-125">nombre réel de Hello de tâches pouvant s’exécuter en parallèle est limitée par la mémoire de hello et de ressources processeur disponibles dans votre cluster.</span><span class="sxs-lookup"><span data-stu-id="94f90-125">hello actual number of tasks that can run in parallel is bounded by hello memory and CPU resources available in your cluster.</span></span>

<span data-ttu-id="94f90-126">**Mémoire de l’exécuteur** il s’agit quantité hello de mémoire qui est allouée tooeach exécuteur.</span><span class="sxs-lookup"><span data-stu-id="94f90-126">**Executor-memory** This is hello amount of memory that is being allocated tooeach executor.</span></span>  <span data-ttu-id="94f90-127">mémoire Hello nécessaire pour chaque exécuteur dépend de la tâche de hello.</span><span class="sxs-lookup"><span data-stu-id="94f90-127">hello memory needed for each executor is dependent on hello job.</span></span>  <span data-ttu-id="94f90-128">Pour les opérations complexes, la mémoire de hello doit toobe plus élevée.</span><span class="sxs-lookup"><span data-stu-id="94f90-128">For complex operations, hello memory needs toobe higher.</span></span>  <span data-ttu-id="94f90-129">Pour les opérations simples telles que la lecture et l’écriture, les besoins en mémoire seront inférieurs.</span><span class="sxs-lookup"><span data-stu-id="94f90-129">For simple operations like read and write, memory requirements will be lower.</span></span>  <span data-ttu-id="94f90-130">Hello quantité de mémoire pour chaque exécuteur peut être affichée dans Ambari.</span><span class="sxs-lookup"><span data-stu-id="94f90-130">hello amount of memory for each executor can be viewed in Ambari.</span></span>  <span data-ttu-id="94f90-131">Dans Ambari, accédez tooSpark et afficher l’onglet des configurations hello.</span><span class="sxs-lookup"><span data-stu-id="94f90-131">In Ambari, navigate tooSpark and view hello Configs tab.</span></span>  

<span data-ttu-id="94f90-132">**Cœurs de l’exécuteur** cela définit hello de noyaux utilisés par l’exécuteur, qui détermine le nombre de hello de threads parallèles qui peuvent être exécutés par l’exécuteur.</span><span class="sxs-lookup"><span data-stu-id="94f90-132">**Executor-cores** This sets hello amount of cores used per executor, which determines hello number of parallel threads that can be run per executor.</span></span>  <span data-ttu-id="94f90-133">Par exemple, si l’exécuteur-cœurs = 2, puis chaque exécuteur peut exécuter des tâches parallèles 2 exécuteur de hello.</span><span class="sxs-lookup"><span data-stu-id="94f90-133">For example, if executor-cores = 2, then each executor can run 2 parallel tasks in hello executor.</span></span>  <span data-ttu-id="94f90-134">Hello exécuteur-cœurs nécessitent dépendra de travail de hello.</span><span class="sxs-lookup"><span data-stu-id="94f90-134">hello executor-cores needed will be dependent on hello job.</span></span>  <span data-ttu-id="94f90-135">Les travaux intensifs en E/S ne nécessitent pas une grande quantité de mémoire par la tâche, ainsi chaque exécuteur peut gérer davantage de tâches parallèles.</span><span class="sxs-lookup"><span data-stu-id="94f90-135">I/O heavy jobs do not require a large amount of memory per task so each executor can handle more parallel tasks.</span></span>

<span data-ttu-id="94f90-136">Par défaut, deux cœurs YARN virtuels sont définis pour chaque cœur physique lors de l’exécution de Spark sur HDInsight.</span><span class="sxs-lookup"><span data-stu-id="94f90-136">By default, two virtual YARN cores are defined for each physical core when running Spark on HDInsight.</span></span>  <span data-ttu-id="94f90-137">Ce nombre offre un bon équilibre de simultanéité et de quantité de changement de contexte à partir de plusieurs threads.</span><span class="sxs-lookup"><span data-stu-id="94f90-137">This number provides a good balance of concurrecy and amount of context switching from multiple threads.</span></span>  

## <a name="guidance"></a><span data-ttu-id="94f90-138">Assistance</span><span class="sxs-lookup"><span data-stu-id="94f90-138">Guidance</span></span>

<span data-ttu-id="94f90-139">Lors de l’exécution des charges de travail analytique toowork Spark avec des données dans Data Lake Store, nous vous recommandons d’utiliser hello plus récente HDInsight version tooget hello des performances optimales avec Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="94f90-139">While running Spark analytic workloads toowork with data in Data Lake Store, we recommend that you use hello most recent HDInsight version tooget hello best performance with Data Lake Store.</span></span> <span data-ttu-id="94f90-140">Lorsque votre projet est plus intensive d’e/s, certains paramètres peuvent être configuré tooimprove performances.</span><span class="sxs-lookup"><span data-stu-id="94f90-140">When your job is more I/O intensive, then certain parameters can be configured tooimprove performance.</span></span>  <span data-ttu-id="94f90-141">Azure Data Lake Store est une plateforme de stockage hautement évolutive capable de gérer un débit élevé.</span><span class="sxs-lookup"><span data-stu-id="94f90-141">Azure Data Lake Store is a highly scalable storage platform that can handle high throughput.</span></span>  <span data-ttu-id="94f90-142">Si le travail de hello se compose principalement de lecture ou d’écriture, puis augmenter d’accès concurrentiel pour tooand d’e/s à partir d’Azure Data Lake Store peut accroître les performances.</span><span class="sxs-lookup"><span data-stu-id="94f90-142">If hello job mainly consists of read or writes, then increasing concurrency for I/O tooand from Azure Data Lake Store could increase performance.</span></span>

<span data-ttu-id="94f90-143">Il existe quelques approches générales tooincrease concurrence d’accès les tâches intensives d’e/s.</span><span class="sxs-lookup"><span data-stu-id="94f90-143">There are a few general ways tooincrease concurrency for I/O intensive jobs.</span></span>

<span data-ttu-id="94f90-144">**Étape 1 : Déterminer le nombre d’applications est en cours d’exécution sur votre cluster** – vous devez connaître le nombre d’applications s’exécutent sur le cluster hello notamment hello en cours.</span><span class="sxs-lookup"><span data-stu-id="94f90-144">**Step 1: Determine how many apps are running on your cluster** – You should know how many apps are running on hello cluster including hello current one.</span></span>  <span data-ttu-id="94f90-145">valeurs par défaut Hello pour chaque Spark paramètre suppose qu’il existe 4 applications qui s’exécutent simultanément.</span><span class="sxs-lookup"><span data-stu-id="94f90-145">hello default values for each Spark setting assumes that there are 4 apps running concurrently.</span></span>  <span data-ttu-id="94f90-146">Par conséquent, vous devez uniquement 25 % de cluster hello disponible pour chaque application.</span><span class="sxs-lookup"><span data-stu-id="94f90-146">Therefore, you will only have 25% of hello cluster available for each app.</span></span>  <span data-ttu-id="94f90-147">tooget de meilleur performances, vous pouvez remplacer les valeurs par défaut hello en modifiant le nombre de hello d’exécuteurs.</span><span class="sxs-lookup"><span data-stu-id="94f90-147">tooget better performance, you can override hello defaults by changing hello number of executors.</span></span>  

<span data-ttu-id="94f90-148">**Étape 2 : Définir la mémoire de l’exécuteur** : hello première tooset est hello exécuteur en mémoire.</span><span class="sxs-lookup"><span data-stu-id="94f90-148">**Step 2: Set executor-memory** – hello first thing tooset is hello executor-memory.</span></span>  <span data-ttu-id="94f90-149">mémoire de Hello sera dépend de la tâche hello que vous êtes toorun de cours.</span><span class="sxs-lookup"><span data-stu-id="94f90-149">hello memory will be dependent on hello job that you are going toorun.</span></span>  <span data-ttu-id="94f90-150">Vous pouvez augmenter la simultanéité en allouant de moins de mémoire par exécuteur.</span><span class="sxs-lookup"><span data-stu-id="94f90-150">You can increase concurrency by allocating less memory per executor.</span></span>  <span data-ttu-id="94f90-151">Si vous voyez les exceptions de mémoire insuffisante lors de l’exécution de votre travail, vous devez augmenter valeur hello pour ce paramètre.</span><span class="sxs-lookup"><span data-stu-id="94f90-151">If you see out of memory exceptions when you run your job, then you should increase hello value for this parameter.</span></span>  <span data-ttu-id="94f90-152">Un autre est tooget davantage de mémoire par à l’aide d’un cluster avec une quantité supérieure de mémoire ou en augmentant la taille de hello de votre cluster.</span><span class="sxs-lookup"><span data-stu-id="94f90-152">One alternative is tooget more memory by using a cluster that has higher amounts of memory or increasing hello size of your cluster.</span></span>  <span data-ttu-id="94f90-153">Plus de mémoire active plus toobe exécuteurs utilisé, ce qui signifie que plus de concurrence.</span><span class="sxs-lookup"><span data-stu-id="94f90-153">More memory will enable more executors toobe used, which means more concurrency.</span></span>

<span data-ttu-id="94f90-154">**Étape 3 : Définir des cœurs de l’exécuteur** – pour les e/s intensives les charges de travail qui n’ont pas d’opérations complexes, il est bon toostart comportant un grand nombre de nombre de hello tooincrease cœurs de l’exécuteur de tâches en parallèle par l’exécuteur.</span><span class="sxs-lookup"><span data-stu-id="94f90-154">**Step 3: Set executor-cores** – For I/O intensive workloads that do not have complex operations, it’s good toostart with a high number of executor-cores tooincrease hello number of parallel tasks per executor.</span></span>  <span data-ttu-id="94f90-155">Définition des cœurs de l’exécuteur too4 est un bon début.</span><span class="sxs-lookup"><span data-stu-id="94f90-155">Setting executor-cores too4 is a good start.</span></span>   

    executor-cores = 4
<span data-ttu-id="94f90-156">Augmenter le nombre hello de cœurs de l’exécuteur vous donneront plus de parallélisme afin de faire des essais avec différents de cœurs de l’exécuteur.</span><span class="sxs-lookup"><span data-stu-id="94f90-156">Increasing hello number of executor-cores will give you more parallelism so you can experiment with different executor-cores.</span></span>  <span data-ttu-id="94f90-157">Pour les travaux qui ont des opérations plus complexes, vous devez réduire le nombre de hello de cœurs par l’exécuteur.</span><span class="sxs-lookup"><span data-stu-id="94f90-157">For jobs that have more complex operations, you should reduce hello number of cores per executor.</span></span>  <span data-ttu-id="94f90-158">Si la valeur d’Executor-cores est supérieure à 4, puis le garbage collection peut devenir inefficace et dégrader les performances.</span><span class="sxs-lookup"><span data-stu-id="94f90-158">If executor-cores is set higher than 4, then garbage collection may become inefficient and degrade performance.</span></span>

<span data-ttu-id="94f90-159">**Étape 4 : Déterminer la quantité de mémoire YARN du cluster** : cette information est disponible dans Ambari.</span><span class="sxs-lookup"><span data-stu-id="94f90-159">**Step 4: Determine amount of YARN memory in cluster** – This information is available in Ambari.</span></span>  <span data-ttu-id="94f90-160">Accédez tooYARN et afficher l’onglet des configurations hello.  mémoire des fils de Hello s’affiche dans cette fenêtre.</span><span class="sxs-lookup"><span data-stu-id="94f90-160">Navigate tooYARN and view hello Configs tab.  hello YARN memory is displayed in this window.</span></span>  
<span data-ttu-id="94f90-161">Remarque : lorsque vous vous trouvez dans la fenêtre hello, vous pouvez également voir taille du conteneur fils hello par défaut.</span><span class="sxs-lookup"><span data-stu-id="94f90-161">Note: while you are in hello window, you can also see hello default YARN container size.</span></span>  <span data-ttu-id="94f90-162">taille du conteneur fils de Hello est hello identique à la mémoire par le paramètre de l’exécuteur.</span><span class="sxs-lookup"><span data-stu-id="94f90-162">hello YARN container size is hello same as memory per executor paramter.</span></span>

    Total YARN memory = nodes * YARN memory per node
<span data-ttu-id="94f90-163">**Étape 5 : Calculer num-executors**</span><span class="sxs-lookup"><span data-stu-id="94f90-163">**Step 5: Calculate num-executors**</span></span>

<span data-ttu-id="94f90-164">**Calculer la contrainte de mémoire** -paramètre num-exécuteurs de hello est limitée par la mémoire ou par processeur.</span><span class="sxs-lookup"><span data-stu-id="94f90-164">**Calculate memory constraint** - hello num-executors parameter is constrained either by memory or by CPU.</span></span>  <span data-ttu-id="94f90-165">contrainte de mémoire Hello est déterminée par la quantité hello de mémoire fils disponible pour votre application.</span><span class="sxs-lookup"><span data-stu-id="94f90-165">hello memory constraint is determined by hello amount of available YARN memory for your application.</span></span>  <span data-ttu-id="94f90-166">Vous devez prendre la mémoire YARN totale et la diviser par executor-memory.</span><span class="sxs-lookup"><span data-stu-id="94f90-166">You should take total YARN memory and divide that by executor-memory.</span></span>  <span data-ttu-id="94f90-167">contrainte de Hello doit toobe, déduplication mis à l’échelle de nombre hello d’applications afin de nous diviser par nombre hello d’applications.</span><span class="sxs-lookup"><span data-stu-id="94f90-167">hello constraint needs toobe de-scaled for hello number of apps so we divide by hello number of apps.</span></span>

    Memory constraint = (total YARN memory / executor memory) / # of apps   
<span data-ttu-id="94f90-168">**Calculer la contrainte de processeur** -hello contrainte de l’UC est calculée comme hello total cœurs virtuels divisés par un nombre de cœurs par l’exécuteur hello.</span><span class="sxs-lookup"><span data-stu-id="94f90-168">**Calculate CPU constraint** - hello CPU constraint is calculated as hello total virtual cores divided by hello number of cores per executor.</span></span>  <span data-ttu-id="94f90-169">Il existe 2 cœurs virtuels pour chaque noyau physique.</span><span class="sxs-lookup"><span data-stu-id="94f90-169">There are 2 virtual cores for each physical core.</span></span>  <span data-ttu-id="94f90-170">Contrainte de mémoire toohello semblables, nous avons division par nombre hello d’applications.</span><span class="sxs-lookup"><span data-stu-id="94f90-170">Similar toohello memory constraint, we have divide by hello number of apps.</span></span>

    virtual cores = (nodes in cluster * # of physical cores in node * 2)
    CPU constraint = (total virtual cores / # of cores per executor) / # of apps
<span data-ttu-id="94f90-171">**Définir les exécuteurs de num** – paramètre num-exécuteurs de hello est déterminée en prenant hello minimale de la contrainte de mémoire hello et une contrainte hello du processeur.</span><span class="sxs-lookup"><span data-stu-id="94f90-171">**Set num-executors** – hello num-executors parameter is determined by taking hello minimum of hello memory constraint and hello CPU constraint.</span></span> 

    num-executors = Min (total virtual Cores / # of cores per executor, available YARN memory / executor-memory)   
<span data-ttu-id="94f90-172">Définir un nombre plus élevé pour num-executors’augmente pas nécessairement les performances.</span><span class="sxs-lookup"><span data-stu-id="94f90-172">Setting a higher number of num-executors does not necessarily increase performance.</span></span>  <span data-ttu-id="94f90-173">Vous devez prendre en compte le fait que l’ajout d’exécuteurs ajoute une charge pour chaque exécuteur supplémentaire, ce qui peut dégrader les performances.</span><span class="sxs-lookup"><span data-stu-id="94f90-173">You should consider that adding more executors will add extra overhead for each additional executor, which can potentially degrade performance.</span></span>  <span data-ttu-id="94f90-174">Num-exécuteurs est limitée par les ressources de cluster hello.</span><span class="sxs-lookup"><span data-stu-id="94f90-174">Num-executors is bounded by hello cluster resources.</span></span>    

## <a name="example-calculation"></a><span data-ttu-id="94f90-175">Exemple de calcul</span><span class="sxs-lookup"><span data-stu-id="94f90-175">Example Calculation</span></span>

<span data-ttu-id="94f90-176">Supposons que vous disposez actuellement d’un cluster composé de 8 nœuds D4v2 qui est en cours d’exécution 2 applications y compris hello celui que vous allez toorun.</span><span class="sxs-lookup"><span data-stu-id="94f90-176">Let’s say you currently have a cluster composed of 8 D4v2 nodes that is running 2 apps including hello one you are going toorun.</span></span>  

<span data-ttu-id="94f90-177">**Étape 1 : Déterminer le nombre d’applications est en cours d’exécution sur votre cluster** – vous savez que vous disposez de 2 des applications sur votre cluster, y compris hello une que vous vous apprêtez toorun.</span><span class="sxs-lookup"><span data-stu-id="94f90-177">**Step 1: Determine how many apps are running on your cluster** – you know that you have 2 apps on your cluster, including hello one you are going toorun.</span></span>  

<span data-ttu-id="94f90-178">**Étape 2 : Configurer executor-memory** : pour cet exemple, nous déterminons que 6 Go pour executor-memory sera suffisant pour les travaux intensifs en E/S.</span><span class="sxs-lookup"><span data-stu-id="94f90-178">**Step 2: Set executor-memory** – for this example, we determine that 6GB of executor-memory will be sufficient for I/O intensive job.</span></span>  

    executor-memory = 6GB
<span data-ttu-id="94f90-179">**Étape 3 : Définir des cœurs de l’exécuteur** – dans la mesure où il s’agit d’un travail d’e/s intensif, nous pouvons définir nombre hello de cœurs pour chaque too4 exécuteur.</span><span class="sxs-lookup"><span data-stu-id="94f90-179">**Step 3: Set executor-cores** – Since this is an I/O intensive job, we can set hello number of cores for each executor too4.</span></span>  <span data-ttu-id="94f90-180">Définition de cœurs par l’exécuteur toolarger que 4 peut entraîner des problèmes de garbage collection.</span><span class="sxs-lookup"><span data-stu-id="94f90-180">Setting cores per executor toolarger than 4 may cause garbage collection problems.</span></span>  

    executor-cores = 4
<span data-ttu-id="94f90-181">**Étape 4 : Déterminer la quantité de mémoire fils cluster** – nous naviguons toofind tooAmbari out que chaque D4v2 a 25 Go de mémoire de fils.</span><span class="sxs-lookup"><span data-stu-id="94f90-181">**Step 4: Determine amount of YARN memory in cluster** – We navigate tooAmbari toofind out that each D4v2 has 25GB of YARN memory.</span></span>  <span data-ttu-id="94f90-182">Étant donné que 8 nœuds, la mémoire disponible fils hello est multipliée par 8.</span><span class="sxs-lookup"><span data-stu-id="94f90-182">Since there are 8 nodes, hello available YARN memory is multiplied by 8.</span></span>

    Total YARN memory = nodes * YARN memory* per node
    Total YARN memory = 8 nodes * 25GB = 200GB
<span data-ttu-id="94f90-183">**Étape 5 : Calculer les exécuteurs de num** – paramètre num-exécuteurs de hello est déterminée en prenant hello minimale de la contrainte de mémoire hello et la contrainte de l’UC de hello divisé par hello # d’applications qui s’exécutent sur Spark.</span><span class="sxs-lookup"><span data-stu-id="94f90-183">**Step 5: Calculate num-executors** – hello num-executors parameter is determined by taking hello minimum of hello memory constraint and hello CPU constraint divided by hello # of apps running on Spark.</span></span>    

<span data-ttu-id="94f90-184">**Calculer la contrainte de mémoire** : contrainte de mémoire hello est calculée en tant que mémoire fils totale hello divisée par la mémoire hello par l’exécuteur.</span><span class="sxs-lookup"><span data-stu-id="94f90-184">**Calculate memory constraint** – hello memory constraint is calculated as hello total YARN memory divided by hello memory per executor.</span></span>

    Memory constraint = (total YARN memory / executor memory) / # of apps   
    Memory constraint = (200GB / 6GB) / 2   
    Memory constraint = 16 (rounded)
<span data-ttu-id="94f90-185">**Calculer la contrainte de processeur** -hello contrainte de l’UC est calculée comme hello cœurs fils total divisés par un nombre de cœurs par l’exécuteur hello.</span><span class="sxs-lookup"><span data-stu-id="94f90-185">**Calculate CPU constraint** - hello CPU constraint is calculated as hello total yarn cores divided by hello number of cores per executor.</span></span>
    
    YARN cores = nodes in cluster * # of cores per node * 2   
    YARN cores = 8 nodes * 8 cores per D14 * 2 = 128
    CPU constraint = (total YARN cores / # of cores per executor) / # of apps
    CPU constraint = (128 / 4) / 2
    CPU constraint = 16
<span data-ttu-id="94f90-186">**Définir num-executors**</span><span class="sxs-lookup"><span data-stu-id="94f90-186">**Set num-executors**</span></span>

    num-executors = Min (memory constraint, CPU constraint)
    num-executors = Min (16, 16)
    num-executors = 16    

