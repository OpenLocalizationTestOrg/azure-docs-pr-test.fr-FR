---
title: "les instructions de réglage des performances de données Lake Store Storm aaaAzure | Documents Microsoft"
description: "Recommandations en matière d’optimisation des performances d’Azure Data Lake Store Storm"
services: data-lake-store
documentationcenter: 
author: stewu
manager: amitkul
editor: stewu
ms.assetid: ebde7b9f-2e51-4d43-b7ab-566417221335
ms.service: data-lake-store
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 12/19/2016
ms.author: stewu
ms.openlocfilehash: 5412fd46cf2373f5877030913df4fe1fc6f5473a
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="performance-tuning-guidance-for-storm-on-hdinsight-and-azure-data-lake-store"></a><span data-ttu-id="bb428-103">Recommandations en matière d’optimisation des performances pour Storm sur HDInsight et Azure Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="bb428-103">Performance tuning guidance for Storm on HDInsight and Azure Data Lake Store</span></span>

<span data-ttu-id="bb428-104">Comprendre les facteurs hello à prendre en compte lorsque vous paramétrez performances hello d’une topologie de Azure Storm.</span><span class="sxs-lookup"><span data-stu-id="bb428-104">Understand hello factors that should be considered when you tune hello performance of an Azure Storm topology.</span></span> <span data-ttu-id="bb428-105">Par exemple, il s’agit de caractéristiques de hello toounderstand important de travail hello par becs verseurs de hello et boulons hello (si travail de hello est d’e/s ou mémoire).</span><span class="sxs-lookup"><span data-stu-id="bb428-105">For example, it's important toounderstand hello characteristics of hello work done by hello spouts and hello bolts (whether hello work is I/O or memory intensive).</span></span> <span data-ttu-id="bb428-106">Cet article aborde diverses recommandations d’optimisation des performances, y compris la résolution des problèmes courants.</span><span class="sxs-lookup"><span data-stu-id="bb428-106">This article covers a range of performance tuning guidelines, including troubleshooting common issues.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="bb428-107">Composants requis</span><span class="sxs-lookup"><span data-stu-id="bb428-107">Prerequisites</span></span>

* <span data-ttu-id="bb428-108">**Un abonnement Azure**.</span><span class="sxs-lookup"><span data-stu-id="bb428-108">**An Azure subscription**.</span></span> <span data-ttu-id="bb428-109">Consultez la page [Obtention d’un essai gratuit d’Azure](https://azure.microsoft.com/pricing/free-trial/).</span><span class="sxs-lookup"><span data-stu-id="bb428-109">See [Get Azure free trial](https://azure.microsoft.com/pricing/free-trial/).</span></span>
* <span data-ttu-id="bb428-110">**Un compte Azure Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="bb428-110">**An Azure Data Lake Store account**.</span></span> <span data-ttu-id="bb428-111">Pour obtenir des instructions sur la façon de voir d’un seul, toocreate [prise en main Azure Data Lake Store](data-lake-store-get-started-portal.md).</span><span class="sxs-lookup"><span data-stu-id="bb428-111">For instructions on how toocreate one, see [Get started with Azure Data Lake Store](data-lake-store-get-started-portal.md).</span></span>
* <span data-ttu-id="bb428-112">**Un cluster Azure HDInsight** avec accès tooa compte Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="bb428-112">**An Azure HDInsight cluster** with access tooa Data Lake Store account.</span></span> <span data-ttu-id="bb428-113">Voir [Créer un cluster HDInsight avec Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span><span class="sxs-lookup"><span data-stu-id="bb428-113">See [Create an HDInsight cluster with Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span></span> <span data-ttu-id="bb428-114">Assurez-vous que vous activez Bureau à distance de cluster de hello.</span><span class="sxs-lookup"><span data-stu-id="bb428-114">Make sure you enable Remote Desktop for hello cluster.</span></span>
* <span data-ttu-id="bb428-115">**Exécution d’un cluster Storm sur Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="bb428-115">**Running a Storm cluster on Data Lake Store**.</span></span> <span data-ttu-id="bb428-116">Pour plus d’informations, consultez [Présentation d’Apache Storm sur HDInsight : analyse en temps réel pour Hadoop](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-storm-overview).</span><span class="sxs-lookup"><span data-stu-id="bb428-116">For more information, see [Storm on HDInsight](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-storm-overview).</span></span>
* <span data-ttu-id="bb428-117">**Recommandations en matière d’optimisation des performances sur Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="bb428-117">**Performance tuning guidelines on Data Lake Store**.</span></span>  <span data-ttu-id="bb428-118">Pour les concepts généraux sur les performances, consultez [Recommandations en matière d’optimisation des performances pour Azure Data Lake Store](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance).</span><span class="sxs-lookup"><span data-stu-id="bb428-118">For general performance concepts, see [Data Lake Store Performance Tuning Guidance](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance).</span></span>  

## <a name="tune-hello-parallelism-of-hello-topology"></a><span data-ttu-id="bb428-119">Paramétrer le parallélisme hello de topologie de hello</span><span class="sxs-lookup"><span data-stu-id="bb428-119">Tune hello parallelism of hello topology</span></span>

<span data-ttu-id="bb428-120">Vous pouvez être tooimprove en mesure des performances par l’accès simultané de hello croissante de tooand d’e/s de hello depuis Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="bb428-120">You might be able tooimprove performance by increasing hello concurrency of hello I/O tooand from Data Lake Store.</span></span> <span data-ttu-id="bb428-121">Une topologie Storm possède un ensemble de configurations qui déterminent le parallélisme de hello :</span><span class="sxs-lookup"><span data-stu-id="bb428-121">A Storm topology has a set of configurations that determine hello parallelism:</span></span>
* <span data-ttu-id="bb428-122">Nombre de processus de travail (travailleurs de hello sont équitablement distribuées entre hello machines virtuelles).</span><span class="sxs-lookup"><span data-stu-id="bb428-122">Number of worker processes (hello workers are evenly distributed across hello VMs).</span></span>
* <span data-ttu-id="bb428-123">Nombre d’instances d’exécuteur de Spout.</span><span class="sxs-lookup"><span data-stu-id="bb428-123">Number of spout executor instances.</span></span>
* <span data-ttu-id="bb428-124">Nombre d’instances d’exécuteur de Bolt.</span><span class="sxs-lookup"><span data-stu-id="bb428-124">Number of bolt executor instances.</span></span>
* <span data-ttu-id="bb428-125">Nombre de tâches de Spout.</span><span class="sxs-lookup"><span data-stu-id="bb428-125">Number of spout tasks.</span></span>
* <span data-ttu-id="bb428-126">Nombre de tâches de Bolt.</span><span class="sxs-lookup"><span data-stu-id="bb428-126">Number of bolt tasks.</span></span>

<span data-ttu-id="bb428-127">Par exemple, sur un cluster avec 4 machines virtuelles et 4 processus de travail, les exécuteurs de bec 32 et 32 bec de tâches et les exécuteurs éclair 256 et tâches d’éclair 512, tenez compte des éléments suivants de hello :</span><span class="sxs-lookup"><span data-stu-id="bb428-127">For example, on a cluster with 4 VMs and 4 worker processes, 32 spout executors and 32 spout tasks, and 256 bolt executors and 512 bolt tasks, consider hello following:</span></span>

<span data-ttu-id="bb428-128">Chaque superviseur, qui est un nœud Worker, a un seul processus Worker de machine virtuelle Java.</span><span class="sxs-lookup"><span data-stu-id="bb428-128">Each supervisor, which is a worker node, has a single worker Java virtual machine (JVM) process.</span></span> <span data-ttu-id="bb428-129">Ce processus de machine virtuelle Java gère 4 threads de Spout et 64 threads de Bolt.</span><span class="sxs-lookup"><span data-stu-id="bb428-129">This JVM process manages 4 spout threads and 64 bolt threads.</span></span> <span data-ttu-id="bb428-130">Au sein de chaque thread, les tâches sont exécutées séquentiellement.</span><span class="sxs-lookup"><span data-stu-id="bb428-130">Within each thread, tasks are run sequentially.</span></span> <span data-ttu-id="bb428-131">Chaque thread bec a 1 tâche hello précédant la configuration, et chaque thread éclair a 2 tâches.</span><span class="sxs-lookup"><span data-stu-id="bb428-131">With hello preceding configuration, each spout thread has 1 task, and each bolt thread has 2 tasks.</span></span>

<span data-ttu-id="bb428-132">Dans Storm, voici hello divers composants impliqués, et comment ils affectent niveau hello de parallélisme, que vous devez :</span><span class="sxs-lookup"><span data-stu-id="bb428-132">In Storm, here are hello various components involved, and how they affect hello level of parallelism you have:</span></span>
* <span data-ttu-id="bb428-133">nœud principal de Hello (appelée Nimbus dans Storm) est utilisé toosubmit et gérer des tâches.</span><span class="sxs-lookup"><span data-stu-id="bb428-133">hello head node (called Nimbus in Storm) is used toosubmit and manage jobs.</span></span> <span data-ttu-id="bb428-134">Ces nœuds n’ont aucun impact sur le degré de hello de parallélisme.</span><span class="sxs-lookup"><span data-stu-id="bb428-134">These nodes have no impact on hello degree of parallelism.</span></span>
* <span data-ttu-id="bb428-135">nœuds superviseur Hello.</span><span class="sxs-lookup"><span data-stu-id="bb428-135">hello supervisor nodes.</span></span> <span data-ttu-id="bb428-136">Dans HDInsight, il s’agit de nœud de travail tooa machine virtuelle Azure.</span><span class="sxs-lookup"><span data-stu-id="bb428-136">In HDInsight, this corresponds tooa worker node Azure VM.</span></span>
* <span data-ttu-id="bb428-137">tâches de travail Hello sont des processus Storm en cours d’exécution dans des machines virtuelles de hello.</span><span class="sxs-lookup"><span data-stu-id="bb428-137">hello worker tasks are Storm processes running in hello VMs.</span></span> <span data-ttu-id="bb428-138">Chaque tâche de travail correspond l’instance de machine virtuelle Java tooa.</span><span class="sxs-lookup"><span data-stu-id="bb428-138">Each worker task corresponds tooa JVM instance.</span></span> <span data-ttu-id="bb428-139">Storm distribue le nombre de hello de processus de travail vous spécifiez des nœuds de travail toohello d’une façon aussi équilibrée que possible.</span><span class="sxs-lookup"><span data-stu-id="bb428-139">Storm distributes hello number of worker processes you specify toohello worker nodes as evenly as possible.</span></span>
* <span data-ttu-id="bb428-140">Instances d’exécuteur de Spout et de Bolt.</span><span class="sxs-lookup"><span data-stu-id="bb428-140">Spout and bolt executor instances.</span></span> <span data-ttu-id="bb428-141">Chaque instance d’exécuteur correspond thread tooa qui s’exécutent dans le processus de travail hello (JVM).</span><span class="sxs-lookup"><span data-stu-id="bb428-141">Each executor instance corresponds tooa thread running within hello workers (JVMs).</span></span>
* <span data-ttu-id="bb428-142">Tâches de Storm.</span><span class="sxs-lookup"><span data-stu-id="bb428-142">Storm tasks.</span></span> <span data-ttu-id="bb428-143">Il s’agit des tâches logiques exécutées par chacun de ces threads.</span><span class="sxs-lookup"><span data-stu-id="bb428-143">These are logical tasks that each of these threads run.</span></span> <span data-ttu-id="bb428-144">Cela ne modifie pas le niveau de hello de parallélisme, vous devez évaluer si vous avez besoin de plusieurs tâches par l’exécuteur ou non.</span><span class="sxs-lookup"><span data-stu-id="bb428-144">This does not change hello level of parallelism, so you should evaluate if you need multiple tasks per executor or not.</span></span>

### <a name="get-hello-best-performance-from-data-lake-store"></a><span data-ttu-id="bb428-145">Obtenir des performances optimales hello Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="bb428-145">Get hello best performance from Data Lake Store</span></span>

<span data-ttu-id="bb428-146">Lorsque vous utilisez Data Lake Store, vous obtenez des performances optimales hello si vous hello suivant :</span><span class="sxs-lookup"><span data-stu-id="bb428-146">When working with Data Lake Store, you get hello best performance if you do hello following:</span></span>
* <span data-ttu-id="bb428-147">Fusionnez vos petits éléments dans des tailles supérieures (idéalement 4 Mo).</span><span class="sxs-lookup"><span data-stu-id="bb428-147">Coalesce your small appends into larger sizes (ideally 4 MB).</span></span>
* <span data-ttu-id="bb428-148">Effectuez autant de requêtes simultanées que vous le pouvez.</span><span class="sxs-lookup"><span data-stu-id="bb428-148">Do as many concurrent requests as you can.</span></span> <span data-ttu-id="bb428-149">Étant donné que chaque thread éclair effectue un blocage de lectures, vous souhaitez toohave quelque part dans la plage de hello de threads de 8 à 12 par cœur.</span><span class="sxs-lookup"><span data-stu-id="bb428-149">Because each bolt thread is doing blocking reads, you want toohave somewhere in hello range of 8-12 threads per core.</span></span> <span data-ttu-id="bb428-150">Cela permet de conserver hello hello de carte réseau et d’utilisation de processeur correctement.</span><span class="sxs-lookup"><span data-stu-id="bb428-150">This keeps hello NIC and hello CPU well utilized.</span></span> <span data-ttu-id="bb428-151">Une machine virtuelle plus grande permet d’avoir plus de demandes simultanées.</span><span class="sxs-lookup"><span data-stu-id="bb428-151">A larger VM enables more concurrent requests.</span></span>  

### <a name="example-topology"></a><span data-ttu-id="bb428-152">Exemple de topologie</span><span class="sxs-lookup"><span data-stu-id="bb428-152">Example topology</span></span>

<span data-ttu-id="bb428-153">Supposons que vous disposez d’un cluster de 8 nœuds Worker avec une machine virtuelle Azure D13v2.</span><span class="sxs-lookup"><span data-stu-id="bb428-153">Let’s assume you have an 8 worker node cluster with a D13v2 Azure VM.</span></span> <span data-ttu-id="bb428-154">Cet ordinateur virtuel a 8 cœurs, donc entre hello 8 nœuds de travail, vous avez 64 cœurs total.</span><span class="sxs-lookup"><span data-stu-id="bb428-154">This VM has 8 cores, so among hello 8 worker nodes, you have 64 total cores.</span></span>

<span data-ttu-id="bb428-155">Supposons que nous utilisons 8 threads bolt par cœur.</span><span class="sxs-lookup"><span data-stu-id="bb428-155">Let’s say we do 8 bolt threads per core.</span></span> <span data-ttu-id="bb428-156">Avec 64 cœurs, nous voulons 512 instances (c’est-à-dire les threads) d’exécuteur de Bolt au total.</span><span class="sxs-lookup"><span data-stu-id="bb428-156">Given 64 cores, that means we want 512 total bolt executor instances (that is, threads).</span></span> <span data-ttu-id="bb428-157">Dans ce cas, supposons que nous commencer par une machine virtuelle Java par machine virtuelle et principalement utiliser hello thread l’accès concurrentiel au sein de la concurrence de tooachieve hello JVM.</span><span class="sxs-lookup"><span data-stu-id="bb428-157">In this case, let’s say we start with one JVM per VM, and mainly use hello thread concurrency within hello JVM tooachieve concurrency.</span></span> <span data-ttu-id="bb428-158">Cela signifie que nous avons besoins de 8 tâches worker (une par machine virtuelle Azure) et 512 exécuteurs bolt.</span><span class="sxs-lookup"><span data-stu-id="bb428-158">That means we need 8 worker tasks (one per Azure VM), and 512 bolt executors.</span></span> <span data-ttu-id="bb428-159">Avec cette configuration, Storm tente de traitements de hello toodistribute uniformément entre les nœuds de travail (également connu sous les nœuds de superviseur), en donnant à chaque nœud de travail 1 machine virtuelle Java.</span><span class="sxs-lookup"><span data-stu-id="bb428-159">Given this configuration, Storm tries toodistribute hello workers evenly across worker nodes (also known as supervisor nodes), giving each worker node 1 JVM.</span></span> <span data-ttu-id="bb428-160">Maintenant dans, par exemple hello Storm tente des exécuteurs de hello toodistribute uniformément entre les superviseurs, donnant chaque responsable (autrement dit, JVM) 8 threads chacun.</span><span class="sxs-lookup"><span data-stu-id="bb428-160">Now within hello supervisors, Storm tries toodistribute hello executors evenly between supervisors, giving each supervisor (that is, JVM) 8 threads each.</span></span>

## <a name="tune-additional-parameters"></a><span data-ttu-id="bb428-161">Ajuster les paramètres supplémentaires</span><span class="sxs-lookup"><span data-stu-id="bb428-161">Tune additional parameters</span></span>
<span data-ttu-id="bb428-162">Une fois que vous avez la topologie de base hello, vous pouvez envisager si vous souhaitez que tootweak un des paramètres de hello :</span><span class="sxs-lookup"><span data-stu-id="bb428-162">After you have hello basic topology, you can consider whether you want tootweak any of hello parameters:</span></span>
* <span data-ttu-id="bb428-163">**Number of JVMs per worker node (Nombre de machines virtuelles Java par nœud Worker).**</span><span class="sxs-lookup"><span data-stu-id="bb428-163">**Number of JVMs per worker node.**</span></span> <span data-ttu-id="bb428-164">Si vous avez une structure de données de grande taille (par exemple, une table de recherche) que vous hébergez dans la mémoire, chaque machine virtuelle Java requiert une copie distincte.</span><span class="sxs-lookup"><span data-stu-id="bb428-164">If you have a large data structure (for example, a lookup table) that you host in memory, each JVM requires a separate copy.</span></span> <span data-ttu-id="bb428-165">Vous pouvez également utiliser structure de données hello entre le nombre de threads si vous avez moins de JVM.</span><span class="sxs-lookup"><span data-stu-id="bb428-165">Alternatively, you can use hello data structure across many threads if you have fewer JVMs.</span></span> <span data-ttu-id="bb428-166">Pour d’e/s d’éclair hello, nombre hello de JVM ne fait pas de différence en tant que nombre de hello de threads ajouté entre ces JVM.</span><span class="sxs-lookup"><span data-stu-id="bb428-166">For hello bolt’s I/O, hello number of JVMs does not make as much of a difference as hello number of threads added across those JVMs.</span></span> <span data-ttu-id="bb428-167">Par souci de simplicité, il s’agit d’un toohave conseillé une machine virtuelle Java par travail.</span><span class="sxs-lookup"><span data-stu-id="bb428-167">For simplicity, it's a good idea toohave one JVM per worker.</span></span> <span data-ttu-id="bb428-168">Selon ce que fait votre éclair ou l’application de traitement vous nécessite, cependant, vous devrez peut-être toochange ce nombre.</span><span class="sxs-lookup"><span data-stu-id="bb428-168">Depending on what your bolt is doing or what application processing you require, though, you may need toochange this number.</span></span>
* <span data-ttu-id="bb428-169">**Number of spout executors (Nombre d’exécuteurs de Spout).**</span><span class="sxs-lookup"><span data-stu-id="bb428-169">**Number of spout executors.**</span></span> <span data-ttu-id="bb428-170">Comme hello exemple précédent utilise boulons pour l’écriture de tooData Lake Store, nombre hello de becs verseurs n’est pas performances d’éclair toohello directement pertinents.</span><span class="sxs-lookup"><span data-stu-id="bb428-170">Because hello preceding example uses bolts for writing tooData Lake Store, hello number of spouts is not directly relevant toohello bolt performance.</span></span> <span data-ttu-id="bb428-171">Toutefois, selon la quantité de hello de traitement ou d’e/s se produit dans bec de hello, il est judicieux tootune hello becs verseurs amovibles pour de meilleures performances.</span><span class="sxs-lookup"><span data-stu-id="bb428-171">However, depending on hello amount of processing or I/O happening in hello spout, it's a good idea tootune hello spouts for best performance.</span></span> <span data-ttu-id="bb428-172">Assurez-vous que vous avez suffisamment boulons de hello becs verseurs toobe tookeep en mesure de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="bb428-172">Ensure that you have enough spouts toobe able tookeep hello bolts busy.</span></span> <span data-ttu-id="bb428-173">taux de sortie Hello de becs verseurs de hello doivent correspondre au débit hello de hello boulons.</span><span class="sxs-lookup"><span data-stu-id="bb428-173">hello output rates of hello spouts should match hello throughput of hello bolts.</span></span> <span data-ttu-id="bb428-174">dépend de la configuration réelle de Hello sur bec de hello.</span><span class="sxs-lookup"><span data-stu-id="bb428-174">hello actual configuration depends on hello spout.</span></span>
* <span data-ttu-id="bb428-175">**Nombre de tâches.**</span><span class="sxs-lookup"><span data-stu-id="bb428-175">**Number of tasks.**</span></span> <span data-ttu-id="bb428-176">Chaque Bolt s’exécute en tant que thread unique.</span><span class="sxs-lookup"><span data-stu-id="bb428-176">Each bolt runs as a single thread.</span></span> <span data-ttu-id="bb428-177">Les tâches supplémentaires par Bolt n’apportent pas d’accès concurrentiel supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="bb428-177">Additional tasks per bolt don't provide any additional concurrency.</span></span> <span data-ttu-id="bb428-178">Hello qu’ils sont utiles étant uniquement si votre processus d’accusé de réception hello tuple est une proportion élevée de temps d’exécution éclair.</span><span class="sxs-lookup"><span data-stu-id="bb428-178">hello only time they are of benefit is if your process of acknowledging hello tuple takes a large proportion of your bolt execution time.</span></span> <span data-ttu-id="bb428-179">Il s’agit d’un toogroup conseillé de tuples dans un plus grand ajouter avant d’envoyer un accusé de réception à partir d’éclair de hello.</span><span class="sxs-lookup"><span data-stu-id="bb428-179">It's a good idea toogroup many tuples into a larger append before you send an acknowledgement from hello bolt.</span></span> <span data-ttu-id="bb428-180">Par conséquent, dans la plupart des cas, plusieurs tâches ne fournissent pas d’avantage supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="bb428-180">So, in most cases, multiple tasks provide no additional benefit.</span></span>
* <span data-ttu-id="bb428-181">**Local or shuffle grouping (Groupage local ou aléatoire).**</span><span class="sxs-lookup"><span data-stu-id="bb428-181">**Local or shuffle grouping.**</span></span> <span data-ttu-id="bb428-182">Lorsque ce paramètre est activé, les tuples sont envoyés toobolts dans hello même processus de travail.</span><span class="sxs-lookup"><span data-stu-id="bb428-182">When this setting is enabled, tuples are sent toobolts within hello same worker process.</span></span> <span data-ttu-id="bb428-183">Cela réduit les communications entre processus et les appels réseau.</span><span class="sxs-lookup"><span data-stu-id="bb428-183">This reduces inter-process communication and network calls.</span></span> <span data-ttu-id="bb428-184">Cela est recommandé pour la plupart des topologies.</span><span class="sxs-lookup"><span data-stu-id="bb428-184">This is recommended for most topologies.</span></span>

<span data-ttu-id="bb428-185">Ce scénario de base est un bon point de départ.</span><span class="sxs-lookup"><span data-stu-id="bb428-185">This basic scenario is a good starting point.</span></span> <span data-ttu-id="bb428-186">Test avec votre propre hello tootweak de données précédents paramètres tooachieve optimiser les performances.</span><span class="sxs-lookup"><span data-stu-id="bb428-186">Test with your own data tootweak hello preceding parameters tooachieve optimal performance.</span></span>

## <a name="tune-hello-spout"></a><span data-ttu-id="bb428-187">Régler hello bec</span><span class="sxs-lookup"><span data-stu-id="bb428-187">Tune hello spout</span></span>

<span data-ttu-id="bb428-188">Vous pouvez modifier hello suivant paramètres tootune hello bec.</span><span class="sxs-lookup"><span data-stu-id="bb428-188">You can modify hello following settings tootune hello spout.</span></span>

- <span data-ttu-id="bb428-189">**Délai d’expiration de tuple : topology.message.timeout.secs**.</span><span class="sxs-lookup"><span data-stu-id="bb428-189">**Tuple timeout: topology.message.timeout.secs**.</span></span> <span data-ttu-id="bb428-190">Ce paramètre détermine la durée hello toocomplete qu’un message emprunte et recevoir l’accusé de réception, avant d’être considérée a échoué.</span><span class="sxs-lookup"><span data-stu-id="bb428-190">This setting determines hello amount of time a message takes toocomplete, and receive acknowledgement, before it is considered failed.</span></span>

- <span data-ttu-id="bb428-191">**Mémoire maximale par le processus worker : worker.childopts**.</span><span class="sxs-lookup"><span data-stu-id="bb428-191">**Max memory per worker process: worker.childopts**.</span></span> <span data-ttu-id="bb428-192">Ce paramètre vous permet de spécifier les paramètres de ligne de commande supplémentaires toohello Java travailleurs.</span><span class="sxs-lookup"><span data-stu-id="bb428-192">This setting lets you specify additional command-line parameters toohello Java workers.</span></span> <span data-ttu-id="bb428-193">Hello couramment utilisé paramètre ici est XmX, qui détermine le segment de mémoire hello mémoire maximale allouée tooa la machine virtuelle Java.</span><span class="sxs-lookup"><span data-stu-id="bb428-193">hello most commonly used setting here is XmX, which determines hello maximum memory allocated tooa JVM’s heap.</span></span>

- <span data-ttu-id="bb428-194">**Nombre max. de spouts en attente : topology.max.spout.pending**.</span><span class="sxs-lookup"><span data-stu-id="bb428-194">**Max spout pending: topology.max.spout.pending**.</span></span> <span data-ttu-id="bb428-195">Ce paramètre détermine le nombre de hello de tuples qui peut être en vol (pas encore d’accusé de réception de tous les nœuds dans une topologie de hello) par bec thread à tout moment.</span><span class="sxs-lookup"><span data-stu-id="bb428-195">This setting determines hello number of tuples that can in be flight (not yet acknowledged at all nodes in hello topology) per spout thread at any time.</span></span>

 <span data-ttu-id="bb428-196">Un calcul correct de toodo est la taille de hello de tooestimate de chacun de vos tuples.</span><span class="sxs-lookup"><span data-stu-id="bb428-196">A good calculation toodo is tooestimate hello size of each of your tuples.</span></span> <span data-ttu-id="bb428-197">Ensuite, calculez la quantité de mémoire par thread spout.</span><span class="sxs-lookup"><span data-stu-id="bb428-197">Then figure out how much memory one spout thread has.</span></span> <span data-ttu-id="bb428-198">Hello mémoire totale allouée thread tooa, divisé par cette valeur, doit vous donner la limite supérieure de hello pour bec max de hello en attente de paramètre.</span><span class="sxs-lookup"><span data-stu-id="bb428-198">hello total memory allocated tooa thread, divided by this value, should give you hello upper bound for hello max spout pending parameter.</span></span>

## <a name="tune-hello-bolt"></a><span data-ttu-id="bb428-199">Régler hello éclair</span><span class="sxs-lookup"><span data-stu-id="bb428-199">Tune hello bolt</span></span>
<span data-ttu-id="bb428-200">Lorsque vous écrivez tooData Lake Store, définir une stratégie de synchronisation de taille (tampon côté client de hello) too4 Mo.</span><span class="sxs-lookup"><span data-stu-id="bb428-200">When you're writing tooData Lake Store, set a size sync policy (buffer on hello client side) too4 MB.</span></span> <span data-ttu-id="bb428-201">Un vidage ou hsync() est ensuite effectuée uniquement lorsque la taille de mémoire tampon hello est hello à cette valeur.</span><span class="sxs-lookup"><span data-stu-id="bb428-201">A flushing or hsync() is then performed only when hello buffer size is hello at this value.</span></span> <span data-ttu-id="bb428-202">pilote de Data Lake Store Hello sur le travail de hello VM effectue automatiquement cette mise en mémoire tampon, sauf si vous effectuez explicitement un hsync().</span><span class="sxs-lookup"><span data-stu-id="bb428-202">hello Data Lake Store driver on hello worker VM automatically does this buffering, unless you explicitly perform an hsync().</span></span>

<span data-ttu-id="bb428-203">éclair de données Lake Store Storm Hello par défaut a un paramètre de stratégie de la synchronisation de taille (fileBufferSize) peut être utilisé tootune ce paramètre.</span><span class="sxs-lookup"><span data-stu-id="bb428-203">hello default Data Lake Store Storm bolt has a size sync policy parameter (fileBufferSize) that can be used tootune this parameter.</span></span>

<span data-ttu-id="bb428-204">Dans les topologies d’e/S intensives, il s’agit d’une bonne idée toohave chaque thread éclair écrire les fichiers propres tooits et tooset une stratégie de rotation des fichiers (fileRotationSize).</span><span class="sxs-lookup"><span data-stu-id="bb428-204">In I/O-intensive topologies, it's a good idea toohave each bolt thread write tooits own file, and tooset a file rotation policy (fileRotationSize).</span></span> <span data-ttu-id="bb428-205">Lorsque hello atteint une certaine taille, les flux hello sont vidé automatiquement et un nouveau fichier est écrit dans.</span><span class="sxs-lookup"><span data-stu-id="bb428-205">When hello file reaches a certain size, hello stream is automatically flushed and a new file is written to.</span></span> <span data-ttu-id="bb428-206">Hello, taille de fichier pour la rotation recommandée est de 1 Go.</span><span class="sxs-lookup"><span data-stu-id="bb428-206">hello recommended file size for rotation is 1 GB.</span></span>

### <a name="handle-tuple-data"></a><span data-ttu-id="bb428-207">Gérer les données de tuple</span><span class="sxs-lookup"><span data-stu-id="bb428-207">Handle tuple data</span></span>

<span data-ttu-id="bb428-208">Dans Storm, un bec conserve sur tooa tuple jusqu'à ce qu’elle est acceptée explicitement par un éclair de hello.</span><span class="sxs-lookup"><span data-stu-id="bb428-208">In Storm, a spout holds on tooa tuple until it is explicitly acknowledged by hello bolt.</span></span> <span data-ttu-id="bb428-209">Si un tuple a été lu par un éclair de hello mais n’a pas encore été accepté, bec de hello ne peut pas avoir rendue persistante dans le back-end Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="bb428-209">If a tuple has been read by hello bolt but has not been acknowledged yet, hello spout might not have persisted into Data Lake Store back end.</span></span> <span data-ttu-id="bb428-210">Après qu’un tuple est accepté, bec de hello peut être garanti la persistance par éclair de hello et source de données hello supprimez-les de quelque source qu’il lit à partir de.</span><span class="sxs-lookup"><span data-stu-id="bb428-210">After a tuple is acknowledged, hello spout can be guaranteed persistence by hello bolt, and can then delete hello source data from whatever source it is reading from.</span></span>  

<span data-ttu-id="bb428-211">Pour obtenir des performances optimales sur Data Lake Store, ont éclair de hello 4 Mo de données de tuple de la mémoire tampon.</span><span class="sxs-lookup"><span data-stu-id="bb428-211">For best performance on Data Lake Store, have hello bolt buffer 4 MB of tuple data.</span></span> <span data-ttu-id="bb428-212">Puis, écrivez toohello Data Lake Store précédent fin sous la forme d’une écriture de 4 Mo.</span><span class="sxs-lookup"><span data-stu-id="bb428-212">Then write toohello Data Lake Store back end as one 4-MB write.</span></span> <span data-ttu-id="bb428-213">Après les données de salutation a été correctement écrite toohello magasin (en appelant hflush()), éclair de hello peut accuser réception hello données toohello arrière bec.</span><span class="sxs-lookup"><span data-stu-id="bb428-213">After hello data has been successfully written toohello store (by calling hflush()), hello bolt can acknowledge hello data back toohello spout.</span></span> <span data-ttu-id="bb428-214">Il s’agit quel exemple hello boulon fournie n’ici.</span><span class="sxs-lookup"><span data-stu-id="bb428-214">This is what hello example bolt supplied here does.</span></span> <span data-ttu-id="bb428-215">Il est également acceptable toohold un plus grand nombre de tuples avant hello hflush() appel est effectué et hello tuples d’accusé de réception.</span><span class="sxs-lookup"><span data-stu-id="bb428-215">It is also acceptable toohold a larger number of tuples before hello hflush() call is made and hello tuples acknowledged.</span></span> <span data-ttu-id="bb428-216">Toutefois, cela augmente le nombre de hello de tuples en vol que bec de hello doit toohold, et par conséquent, augmente hello la quantité de mémoire requise par la machine virtuelle Java.</span><span class="sxs-lookup"><span data-stu-id="bb428-216">However, this increases hello number of tuples in flight that hello spout needs toohold, and therefore increases hello amount of memory required per JVM.</span></span>

> [!NOTE]
<span data-ttu-id="bb428-217">Applications peuvent avoir un tuples de tooacknowledge exigence plus fréquemment (à des tailles de données inférieure à 4 Mo) pour d’autres raisons de performances non.</span><span class="sxs-lookup"><span data-stu-id="bb428-217">Applications might have a requirement tooacknowledge tuples more frequently (at data sizes less than 4 MB) for other non-performance reasons.</span></span> <span data-ttu-id="bb428-218">Toutefois, sont susceptibles d’affecter hello d’e/s de débit toohello stockage back-end.</span><span class="sxs-lookup"><span data-stu-id="bb428-218">However, that might affect hello I/O throughput toohello storage back end.</span></span> <span data-ttu-id="bb428-219">Évaluez ce compromis par rapport aux performances d’e/s d’éclair hello.</span><span class="sxs-lookup"><span data-stu-id="bb428-219">Carefully weigh this tradeoff against hello bolt’s I/O performance.</span></span>

<span data-ttu-id="bb428-220">Si la vitesse d’entrée de tuples hello n’est pas élevé, afin de la mémoire tampon de 4 Mo hello prend un toofill beaucoup de temps, envisagez d’atténuation en :</span><span class="sxs-lookup"><span data-stu-id="bb428-220">If hello incoming rate of tuples is not high, so hello 4-MB buffer takes a long time toofill, consider mitigating this by:</span></span>
* <span data-ttu-id="bb428-221">Réduisant le nombre de hello de boulons, il existe donc moins toofill de mémoires tampons.</span><span class="sxs-lookup"><span data-stu-id="bb428-221">Reducing hello number of bolts, so there are fewer buffers toofill.</span></span>
* <span data-ttu-id="bb428-222">Ayant une stratégie basée sur le nombre ou heure, où une hflush() est déclenchée toutes les x vidages ou chaque millisecondes de y, et les tuples hello accumulés jusqu'à présent sont précédent.</span><span class="sxs-lookup"><span data-stu-id="bb428-222">Having a time-based or count-based policy, where an hflush() is triggered every x flushes or every y milliseconds, and hello tuples accumulated so far are acknowledged back.</span></span>

<span data-ttu-id="bb428-223">Notez que le débit de hello dans ce cas est inférieure, mais avec un taux d’événements lent, débit maximal n’est pas hello plus grand objectif quand même.</span><span class="sxs-lookup"><span data-stu-id="bb428-223">Note that hello throughput in this case is lower, but with a slow rate of events, maximum throughput is not hello biggest objective anyway.</span></span> <span data-ttu-id="bb428-224">Ces solutions d’atténuation vous aider à réduire le temps total hello nécessaire pour un tooflow tuple via toohello store.</span><span class="sxs-lookup"><span data-stu-id="bb428-224">These mitigations help you reduce hello total time that it takes for a tuple tooflow through toohello store.</span></span> <span data-ttu-id="bb428-225">Cela peut avoir une importance si vous souhaitez un pipeline en temps réel, même avec un taux d’événements faible.</span><span class="sxs-lookup"><span data-stu-id="bb428-225">This might matter if you want a real-time pipeline even with a low event rate.</span></span> <span data-ttu-id="bb428-226">Notez également que si votre taux de tuple est faible, vous devez ajuster paramètre topology.message.timeout_secs hello pour les tuples hello n’expirent pas pendant qu’ils reçoivent en mémoire tampon ou traité.</span><span class="sxs-lookup"><span data-stu-id="bb428-226">Also note that if your incoming tuple rate is low, you should adjust hello topology.message.timeout_secs parameter, so hello tuples don’t time out while they are getting buffered or processed.</span></span>

## <a name="monitor-your-topology-in-storm"></a><span data-ttu-id="bb428-227">Surveiller votre topologie dans Storm</span><span class="sxs-lookup"><span data-stu-id="bb428-227">Monitor your topology in Storm</span></span>  
<span data-ttu-id="bb428-228">Pendant l’exécution de votre topologie, vous pouvez le surveiller dans l’interface utilisateur hello Storm.</span><span class="sxs-lookup"><span data-stu-id="bb428-228">While your topology is running, you can monitor it in hello Storm user interface.</span></span> <span data-ttu-id="bb428-229">Voici toolook des principaux paramètres hello à :</span><span class="sxs-lookup"><span data-stu-id="bb428-229">Here are hello main parameters toolook at:</span></span>

* <span data-ttu-id="bb428-230">**Total process execution latency (Latence totale de l’exécution du processus).**</span><span class="sxs-lookup"><span data-stu-id="bb428-230">**Total process execution latency.**</span></span> <span data-ttu-id="bb428-231">Il s’agit de hello durée moyenne un tuple toobe émis par bec de hello, traité par un éclair de hello et d’accusé de réception.</span><span class="sxs-lookup"><span data-stu-id="bb428-231">This is hello average time one tuple takes toobe emitted by hello spout, processed by hello bolt, and acknowledged.</span></span>

* <span data-ttu-id="bb428-232">**Total bolt process latency (Latence totale du processus Bolt).**</span><span class="sxs-lookup"><span data-stu-id="bb428-232">**Total bolt process latency.**</span></span> <span data-ttu-id="bb428-233">Il s’agit de temps moyen de hello passé par le tuple de hello à éclair de hello jusqu'à ce qu’il reçoit un accusé de réception.</span><span class="sxs-lookup"><span data-stu-id="bb428-233">This is hello average time spent by hello tuple at hello bolt until it receives an acknowledgement.</span></span>

* <span data-ttu-id="bb428-234">**Total bolt execute latency (Latence totale d’exécution de Bolt).**</span><span class="sxs-lookup"><span data-stu-id="bb428-234">**Total bolt execute latency.**</span></span> <span data-ttu-id="bb428-235">Il s’agit hello moyenne temps passé par un éclair hello Bonjour exécuter la méthode.</span><span class="sxs-lookup"><span data-stu-id="bb428-235">This is hello average time spent by hello bolt in hello execute method.</span></span>

* <span data-ttu-id="bb428-236">**Nombre d’échecs.**</span><span class="sxs-lookup"><span data-stu-id="bb428-236">**Number of failures.**</span></span> <span data-ttu-id="bb428-237">Cela fait référence nombre toohello de tuples ayant échoué toobe complètement traité avant leur expiration du délai.</span><span class="sxs-lookup"><span data-stu-id="bb428-237">This refers toohello number of tuples that failed toobe fully processed before they timed out.</span></span>

* <span data-ttu-id="bb428-238">**Capacité.**</span><span class="sxs-lookup"><span data-stu-id="bb428-238">**Capacity.**</span></span> <span data-ttu-id="bb428-239">Il s’agit d’une mesure du niveau d’activité de votre système.</span><span class="sxs-lookup"><span data-stu-id="bb428-239">This is a measure of how busy your system is.</span></span> <span data-ttu-id="bb428-240">Si ce nombre a la valeur 1, vos bolts fonctionnent aussi rapidement que possible.</span><span class="sxs-lookup"><span data-stu-id="bb428-240">If this number is 1, your bolts are working as fast as they can.</span></span> <span data-ttu-id="bb428-241">S’il est inférieur à 1, augmentez le parallélisme de hello.</span><span class="sxs-lookup"><span data-stu-id="bb428-241">If it is less than 1, increase hello parallelism.</span></span> <span data-ttu-id="bb428-242">S’il est supérieur à 1, réduire le parallélisme de hello.</span><span class="sxs-lookup"><span data-stu-id="bb428-242">If it is greater than 1, reduce hello parallelism.</span></span>

## <a name="troubleshoot-common-problems"></a><span data-ttu-id="bb428-243">Résoudre les problèmes courants</span><span class="sxs-lookup"><span data-stu-id="bb428-243">Troubleshoot common problems</span></span>
<span data-ttu-id="bb428-244">Voici quelques scénarios courants de résolution des problèmes.</span><span class="sxs-lookup"><span data-stu-id="bb428-244">Here are a few common troubleshooting scenarios.</span></span>
* <span data-ttu-id="bb428-245">**Grand nombre de tuples expirés.** Examinez chaque nœud hello topologie toodetermine où le goulot d’étranglement hello est.</span><span class="sxs-lookup"><span data-stu-id="bb428-245">**Many tuples are timing out.** Look at each node in hello topology toodetermine where hello bottleneck is.</span></span> <span data-ttu-id="bb428-246">Hello plus souvent du est que hello boulons ne sont pas en mesure de tookeep haut avec becs verseurs de hello.</span><span class="sxs-lookup"><span data-stu-id="bb428-246">hello most common reason for this is that hello bolts are not able tookeep up with hello spouts.</span></span> <span data-ttu-id="bb428-247">Cela conduit tootuples objets mémoires tampons internes de hello lors toobe en attente traités.</span><span class="sxs-lookup"><span data-stu-id="bb428-247">This leads tootuples clogging hello internal buffers while waiting toobe processed.</span></span> <span data-ttu-id="bb428-248">Envisagez d’augmenter la valeur de délai d’attente hello ou de diminution bec max de hello en attente.</span><span class="sxs-lookup"><span data-stu-id="bb428-248">Consider increasing hello timeout value or decreasing hello max spout pending.</span></span>

* <span data-ttu-id="bb428-249">**Latence totale d’exécution de processus élevée, mais latence de traitement des Bolts faible.**</span><span class="sxs-lookup"><span data-stu-id="bb428-249">**There is a high total process execution latency, but a low bolt process latency.**</span></span> <span data-ttu-id="bb428-250">Dans ce cas, il est possible que les tuples hello ne sont pas reçus suffisamment rapide.</span><span class="sxs-lookup"><span data-stu-id="bb428-250">In this case, it is possible that hello tuples are not being acknowledged fast enough.</span></span> <span data-ttu-id="bb428-251">Vérifiez qu’il existe un nombre suffisant de validateurs.</span><span class="sxs-lookup"><span data-stu-id="bb428-251">Check that there are a sufficient number of acknowledgers.</span></span> <span data-ttu-id="bb428-252">Une autre possibilité est qu’ils attendent dans la file d’attente hello trop longtemps avant hello boulons démarrer leur traitement.</span><span class="sxs-lookup"><span data-stu-id="bb428-252">Another possibility is that they are waiting in hello queue for too long before hello bolts start processing them.</span></span> <span data-ttu-id="bb428-253">Diminuer bec max de hello en attente.</span><span class="sxs-lookup"><span data-stu-id="bb428-253">Decrease hello max spout pending.</span></span>

* <span data-ttu-id="bb428-254">**Latence d’exécution des Bolts élevée.**</span><span class="sxs-lookup"><span data-stu-id="bb428-254">**There is a high bolt execute latency.**</span></span> <span data-ttu-id="bb428-255">Cela signifie que méthode execute() hello votre éclair prend trop de temps.</span><span class="sxs-lookup"><span data-stu-id="bb428-255">This means that hello execute() method of your bolt is taking too long.</span></span> <span data-ttu-id="bb428-256">Optimiser le code hello, ou examiner les tailles d’écriture et comportement de vidage.</span><span class="sxs-lookup"><span data-stu-id="bb428-256">Optimize hello code, or look at write sizes and flush behavior.</span></span>

### <a name="data-lake-store-throttling"></a><span data-ttu-id="bb428-257">Limitation Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="bb428-257">Data Lake Store throttling</span></span>
<span data-ttu-id="bb428-258">Si vous avez atteint les limites de la bande passante fournie par Data Lake Store hello, vous pouvez rencontrer des échecs de la tâche.</span><span class="sxs-lookup"><span data-stu-id="bb428-258">If you hit hello limits of bandwidth provided by Data Lake Store, you might see task failures.</span></span> <span data-ttu-id="bb428-259">Consultez les journaux des tâches pour les erreurs de limitation.</span><span class="sxs-lookup"><span data-stu-id="bb428-259">Check task logs for throttling errors.</span></span> <span data-ttu-id="bb428-260">Vous pouvez réduire le parallélisme de hello en augmentant la taille du conteneur.</span><span class="sxs-lookup"><span data-stu-id="bb428-260">You can decrease hello parallelism by increasing container size.</span></span>    

<span data-ttu-id="bb428-261">toocheck si vous l’obtention de sont limités, activer le débogage hello journalisation côté client de hello :</span><span class="sxs-lookup"><span data-stu-id="bb428-261">toocheck if you are getting throttled, enable hello debug logging on hello client side:</span></span>

1. <span data-ttu-id="bb428-262">Dans **Ambari** > **Storm** > **Config** > **avancé storm-travail-log4j**, modifier  **&lt;racine niveau = « info »&gt;**  trop**&lt;racine niveau = « debug »&gt;**.</span><span class="sxs-lookup"><span data-stu-id="bb428-262">In **Ambari** > **Storm** > **Config** > **Advanced storm-worker-log4j**, change **&lt;root level="info"&gt;** too**&lt;root level=”debug”&gt;**.</span></span> <span data-ttu-id="bb428-263">Redémarrez tous les nœuds/service hello pour effet de tootake configuration hello.</span><span class="sxs-lookup"><span data-stu-id="bb428-263">Restart all hello nodes/service for hello configuration tootake effect.</span></span>
2. <span data-ttu-id="bb428-264">Moniteur hello Storm topologie ouvre une session sur les nœuds de travail (sous /var/log/storm/worker-artifacts /&lt;TopologyName&gt;/&lt;port&gt;/worker.log) pour les exceptions de limitation Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="bb428-264">Monitor hello Storm topology logs on worker nodes (under /var/log/storm/worker-artifacts/&lt;TopologyName&gt;/&lt;port&gt;/worker.log) for Data Lake Store throttling exceptions.</span></span>

## <a name="next-steps"></a><span data-ttu-id="bb428-265">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="bb428-265">Next steps</span></span>
<span data-ttu-id="bb428-266">Pour optimiser davantage les performances, consultez [ce blog](https://blogs.msdn.microsoft.com/shanyu/2015/05/14/performance-tuning-for-hdinsight-storm-and-microsoft-azure-eventhubs/).</span><span class="sxs-lookup"><span data-stu-id="bb428-266">Additional performance tuning for Storm can be referenced in [this blog](https://blogs.msdn.microsoft.com/shanyu/2015/05/14/performance-tuning-for-hdinsight-storm-and-microsoft-azure-eventhubs/).</span></span>

<span data-ttu-id="bb428-267">Pour un toorun exemple supplémentaire, consultez [sur GitHub](https://github.com/hdinsight/storm-performance-automation).</span><span class="sxs-lookup"><span data-stu-id="bb428-267">For an additional example toorun, see [this one on GitHub](https://github.com/hdinsight/storm-performance-automation).</span></span>
