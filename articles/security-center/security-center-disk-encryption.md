---
title: "Chiffrement d’une machine virtuelle Azure| Microsoft Docs"
description: "Cet article vous explique comment chiffrer une machine virtuelle Azure après avoir reçu une alerte du Centre de sécurité Azure."
services: security, security-center
documentationcenter: na
author: TomShinder
manager: swadhwa
editor: 
ms.assetid: f6c28bc4-1f79-4352-89d0-03659b2fa2f5
ms.service: security
ms.devlang: na
ms.topic: hero-article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 03/15/2017
ms.author: tomsh
ms.openlocfilehash: 8d39aafb0ab7b0e87afdf4d2f50f1e224b8d251f
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/11/2017
---
# <a name="encrypt-an-azure-virtual-machine"></a><span data-ttu-id="7e109-103">Chiffrement d’une machine virtuelle Azure</span><span class="sxs-lookup"><span data-stu-id="7e109-103">Encrypt an Azure Virtual Machine</span></span>
<span data-ttu-id="7e109-104">Le Centre de sécurité Azure émet une alerte si certaines de vos machines virtuelles ne sont pas chiffrées.</span><span class="sxs-lookup"><span data-stu-id="7e109-104">Azure Security Center will alert you if you have virtual machines that are not encrypted.</span></span> <span data-ttu-id="7e109-105">Ces alertes indiquant un niveau de gravité élevé, il est recommandé de chiffrer ces machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="7e109-105">These alerts will show as High Severity and the recommendation is to encrypt these virtual machines.</span></span>

![Recommandation de chiffrement de disque](./media/security-center-disk-encryption/security-center-disk-encryption-fig1.png)

> [!NOTE]
> <span data-ttu-id="7e109-107">Les informations contenues dans ce document concernent le chiffrement des machines virtuelles sans utiliser une clé de chiffrement à clé (requise pour la sauvegarde des machines virtuelles à l’aide d’Azure Backup).</span><span class="sxs-lookup"><span data-stu-id="7e109-107">The information in this document applies to encrypting virtual machines without using a Key Encryption Key (which is required for backing up virtual machines using Azure Backup).</span></span> <span data-ttu-id="7e109-108">Consultez l’article [Azure Disk Encryption for Windows and Linux Azure Virtual Machines](https://docs.microsoft.com/en-us/azure/security/azure-security-disk-encryption) (Utilisation d’Azure Disk Encryption pour les machines virtuelles Azure exécutées sous Windows et Linux) pour plus d’informations sur l’utilisation d’une clé de chiffrement à clé pour prendre en charge Azure Backup pour les machines virtuelles Azure chiffrées.</span><span class="sxs-lookup"><span data-stu-id="7e109-108">Please see the article [Azure Disk Encryption for Windows and Linux Azure Virtual Machines](https://docs.microsoft.com/en-us/azure/security/azure-security-disk-encryption) for information on how to use a Key Encryption Key to support Azure Backup for encrypted Azure Virtual Machines.</span></span>
>
>

<span data-ttu-id="7e109-109">Pour chiffrer les machines virtuelles Azure qui ont fait l’objet d’une alerte par le Centre de sécurité Azure, nous vous recommandons de procéder de la manière suivante :</span><span class="sxs-lookup"><span data-stu-id="7e109-109">To encrypt Azure Virtual Machines that have been identified by Azure Security Center as needing encryption, we recommend the following steps:</span></span>

* <span data-ttu-id="7e109-110">Installez et configurez Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="7e109-110">Install and configure Azure PowerShell.</span></span> <span data-ttu-id="7e109-111">Vous pourrez ainsi exécuter les commandes PowerShell nécessaires afin d’obtenir la configuration requise pour le chiffrement des machines virtuelles Azure.</span><span class="sxs-lookup"><span data-stu-id="7e109-111">This will enable you to run the PowerShell commands required to set up the prerequisites required to encrypt Azure Virtual Machines.</span></span>
* <span data-ttu-id="7e109-112">Récupérez et exécutez le script Azure PowerShell de configuration d’Azure Disk Encryption.</span><span class="sxs-lookup"><span data-stu-id="7e109-112">Obtain and run the Azure Disk Encryption Prerequisites Azure PowerShell script</span></span>
* <span data-ttu-id="7e109-113">Chiffrez vos machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="7e109-113">Encrypt your virtual machines</span></span>

<span data-ttu-id="7e109-114">Ce document permet aux utilisateurs peu familiarisés avec Azure PowerShell de chiffrer leurs machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="7e109-114">The goal of this document is to enable you to encrypt your virtual machines, even if you have little or no background in Azure PowerShell.</span></span>
<span data-ttu-id="7e109-115">Pour suivre cette procédure, vous devez utiliser Windows 10 en tant qu’ordinateur client à partir duquel vous allez configurer Azure Disk Encryption.</span><span class="sxs-lookup"><span data-stu-id="7e109-115">This document assumes you are using Windows 10 as the client machine from which you will configure Azure Disk Encryption.</span></span>

<span data-ttu-id="7e109-116">Il existe de nombreuses méthodes permettant d’obtenir la configuration requise et de configurer le chiffrement des machines virtuelles Azure.</span><span class="sxs-lookup"><span data-stu-id="7e109-116">There are many approaches that can be used to setup the prerequisites and to configure encryption for Azure Virtual Machines.</span></span> <span data-ttu-id="7e109-117">Si vous êtes déjà familiarisé avec Azure PowerShell ou avec l’interface de ligne de commande Azure, vous pouvez opter pour d’autres approches.</span><span class="sxs-lookup"><span data-stu-id="7e109-117">If you are already well-versed in Azure PowerShell or Azure CLI, then you may prefer to use alternate approaches.</span></span>

> [!NOTE]
> <span data-ttu-id="7e109-118">Pour plus d’informations sur les autres méthodes de configuration du chiffrement pour les machines virtuelles Azure, consultez [Azure Disk Encryption for Windows and Linux Azure Virtual Machines](https://gallery.technet.microsoft.com/Azure-Disk-Encryption-for-a0018eb0)(Utilisation d’Azure Disk Encryption pour les machines virtuelles Azure exécutées sous Windows et Linux).</span><span class="sxs-lookup"><span data-stu-id="7e109-118">To learn more about alternate approaches to configuring encryption for Azure virtual machines, please see [Azure Disk Encryption for Windows and Linux Azure Virtual Machines](https://gallery.technet.microsoft.com/Azure-Disk-Encryption-for-a0018eb0).</span></span>
>
>

## <a name="install-and-configure-azure-powershell"></a><span data-ttu-id="7e109-119">Installation et configuration d'Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="7e109-119">Install and configure Azure PowerShell</span></span>
<span data-ttu-id="7e109-120">Vous devez disposer d’Azure PowerShell version 1.2.1 ou ultérieure.</span><span class="sxs-lookup"><span data-stu-id="7e109-120">You need Azure PowerShell version 1.2.1 or above installed on your computer.</span></span> <span data-ttu-id="7e109-121">L’article [Installation et configuration d’Azure PowerShell](/powershell/azure/overview) décrit toutes les étapes à suivre pour configurer votre ordinateur avec Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="7e109-121">The article [How to install and configure Azure PowerShell](/powershell/azure/overview) contains all the steps you need to provision your computer to work with Azure PowerShell.</span></span> <span data-ttu-id="7e109-122">L’approche la plus simple consiste à installer Web PI, selon la procédure décrite dans la suite de cet article.</span><span class="sxs-lookup"><span data-stu-id="7e109-122">The most straightforward approach is to use the Web PI installation approach mentioned in that article.</span></span> <span data-ttu-id="7e109-123">Même si vous disposez déjà d’Azure PowerShell, nous vous recommandons de le réinstaller avec la méthode Web PI afin d’avoir la garantie d’utiliser la version la plus récente d’Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="7e109-123">Even if you already have Azure PowerShell installed, install again using the Web PI approach so that you have the latest version of Azure PowerShell.</span></span>

## <a name="obtain-and-run-the-azure-disk-encryption-prerequisites-configuration-script"></a><span data-ttu-id="7e109-124">Récupérer et exécuter le script de configuration d’Azure Disk Encryption</span><span class="sxs-lookup"><span data-stu-id="7e109-124">Obtain and run the Azure disk encryption prerequisites configuration script</span></span>
<span data-ttu-id="7e109-125">Le script de configuration d’Azure Disk Encryption permet de configurer toutes les conditions préalables requises pour le chiffrement de vos machines virtuelles Azure.</span><span class="sxs-lookup"><span data-stu-id="7e109-125">The Azure Disk Encryption Prerequisites Configuration Script will set up all the prerequisites required for encrypting your Azure Virtual Machines.</span></span>

1. <span data-ttu-id="7e109-126">Accédez à la page GitHub contenant le [script de configuration d’Azure Disk Encryption](https://github.com/Azure/azure-powershell/blob/master/src/ResourceManager/Compute/Commands.Compute/Extension/AzureDiskEncryption/Scripts/AzureDiskEncryptionPreRequisiteSetup.ps1).</span><span class="sxs-lookup"><span data-stu-id="7e109-126">Go to the GitHub page that has the [Azure Disk Encryption Prerequisite Setup Script](https://github.com/Azure/azure-powershell/blob/master/src/ResourceManager/Compute/Commands.Compute/Extension/AzureDiskEncryption/Scripts/AzureDiskEncryptionPreRequisiteSetup.ps1).</span></span>
2. <span data-ttu-id="7e109-127">Sur la page GibHub, cliquez sur le bouton **Raw** .</span><span class="sxs-lookup"><span data-stu-id="7e109-127">On the GibHub page, click the **Raw** button.</span></span>
3. <span data-ttu-id="7e109-128">Utilisez les touches **CTRL-A** pour sélectionner l’intégralité du texte de la page, puis les touches **CTRL-C** pour copier le contenu dans le Presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="7e109-128">Use **CTRL-A** to select all the text on the page and then use **CTRL-C** to copy all the text on the page to the clipboard.</span></span>
4. <span data-ttu-id="7e109-129">Ouvrez le **Bloc-notes** pour y coller le texte que vous avez copié.</span><span class="sxs-lookup"><span data-stu-id="7e109-129">Open **Notepad** and paste the copied text into Notepad.</span></span>
5. <span data-ttu-id="7e109-130">Sur votre lecteur C:, créez un dossier que vous appellerez **AzureADEScript**.</span><span class="sxs-lookup"><span data-stu-id="7e109-130">Create a new folder on your C: drive named **AzureADEScript**.</span></span>
6. <span data-ttu-id="7e109-131">Enregistrez le fichier du Bloc-notes (cliquez sur **Fichier**, puis sur **Enregistrer sous**).</span><span class="sxs-lookup"><span data-stu-id="7e109-131">Save the Notepad file – click **File**, then click **Save As**.</span></span> <span data-ttu-id="7e109-132">Dans la zone de texte Nom de fichier, entrez **« ADEPrereqScript.ps1 »** et cliquez sur **Enregistrer**.</span><span class="sxs-lookup"><span data-stu-id="7e109-132">In the File name textbox, enter **“ADEPrereqScript.ps1”** and click **Save**.</span></span> <span data-ttu-id="7e109-133">Veillez à placer le nom entre guillemets ; dans le cas contraire, le fichier sera enregistré avec l’extension .txt.</span><span class="sxs-lookup"><span data-stu-id="7e109-133">(make sure you put the quotation marks around the name, otherwise it will save the file with a .txt file extension).</span></span>

<span data-ttu-id="7e109-134">Maintenant que le contenu du script est enregistré, ouvrez le script dans PowerShell ISE :</span><span class="sxs-lookup"><span data-stu-id="7e109-134">Now that the script content is saved, open the script in the PowerShell ISE:</span></span>

1. <span data-ttu-id="7e109-135">Dans le menu Démarrer, cliquez sur **Cortana**.</span><span class="sxs-lookup"><span data-stu-id="7e109-135">In the Start Menu, click **Cortana**.</span></span> <span data-ttu-id="7e109-136">Demandez à **Cortana** d’accéder à PowerShell en saisissant **PowerShell** dans la zone de texte de recherche Cortana.</span><span class="sxs-lookup"><span data-stu-id="7e109-136">Ask **Cortana** “PowerShell” by typing **PowerShell** in the Cortana search text box.</span></span>
2. <span data-ttu-id="7e109-137">Cliquez avec le bouton droit sur **Windows PowerShell ISE**, puis cliquez sur **Exécuter en tant qu’administrateur**.</span><span class="sxs-lookup"><span data-stu-id="7e109-137">Right click **Windows PowerShell ISE** and click **Run as administrator**.</span></span>
3. <span data-ttu-id="7e109-138">Dans la fenêtre **Administrateur : Windows PowerShell ISE**, cliquez sur **Afficher** puis sur **Afficher le volet de script**.</span><span class="sxs-lookup"><span data-stu-id="7e109-138">In the **Administrator: Windows PowerShell ISE** window, click **View** and then click **Show Script Pane**.</span></span>
4. <span data-ttu-id="7e109-139">Si le volet **Commandes** s’affiche à droite de la fenêtre, cliquez sur l’icône **« x »** en haut à droite du volet pour le fermer.</span><span class="sxs-lookup"><span data-stu-id="7e109-139">If you see the **Commands** pane on the right side of the window, click the **“x”** in the top right corner of the pane to close it.</span></span> <span data-ttu-id="7e109-140">Si le texte s’affiche en caractères trop petits, utilisez les touches **CTRL+** (signe « + »).</span><span class="sxs-lookup"><span data-stu-id="7e109-140">If the text is too small for you to see, use **CTRL+Add** (“Add” is the “+” sign).</span></span> <span data-ttu-id="7e109-141">Si le texte est trop gros, utilisez les touches **CTRL-** (signe « - »).</span><span class="sxs-lookup"><span data-stu-id="7e109-141">If the text is too large, use **CTRL+Subtract** (Subtract is the “-“ sign).</span></span>
5. <span data-ttu-id="7e109-142">Cliquez sur **Fichier**, puis sur **Ouvrir**.</span><span class="sxs-lookup"><span data-stu-id="7e109-142">Click **File** and then click **Open**.</span></span> <span data-ttu-id="7e109-143">Accédez au dossier **C:\AzureADEScript** et double-cliquez sur **ADEPrereqScript**.</span><span class="sxs-lookup"><span data-stu-id="7e109-143">Navigate to the **C:\AzureADEScript** folder and the double-click on the **ADEPrereqScript**.</span></span>
6. <span data-ttu-id="7e109-144">Le contenu **ADEPrereqScript** doit maintenant apparaître dans PowerShell ISE. Un code couleur vous aide à distinguer plus facilement les différents composants, notamment les commandes, les paramètres et les variables.</span><span class="sxs-lookup"><span data-stu-id="7e109-144">The **ADEPrereqScript** contents should now appear in the PowerShell ISE and is color-coded to help you see various components, such as commands, parameters and variables more easily.</span></span>

<span data-ttu-id="7e109-145">Vous devriez obtenir un résultat semblable à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="7e109-145">You should now see something like the figure below.</span></span>

![Fenêtre PowerShell ISE](./media/security-center-disk-encryption/security-center-disk-encryption-fig2.png)

<span data-ttu-id="7e109-147">Le volet supérieur correspond au « volet de script » et le volet inférieur à la « console ».</span><span class="sxs-lookup"><span data-stu-id="7e109-147">The top pane is referred to as the “script pane” and the bottom pane is referred to as the “console”.</span></span> <span data-ttu-id="7e109-148">Nous emploierons ces termes dans la suite de cet article.</span><span class="sxs-lookup"><span data-stu-id="7e109-148">We will use these terms later in this article.</span></span>

## <a name="run-the-azure-disk-encryption-prerequisites-powershell-command"></a><span data-ttu-id="7e109-149">Exécuter la commande PowerShell de configuration d’Azure Disk Encryption</span><span class="sxs-lookup"><span data-stu-id="7e109-149">Run the Azure disk encryption prerequisites PowerShell command</span></span>
<span data-ttu-id="7e109-150">Après le démarrage du script de configuration d’Azure Disk Encryption, vous êtes invité à renseigner les informations suivantes :</span><span class="sxs-lookup"><span data-stu-id="7e109-150">The Azure Disk Encryption Prerequisites script will ask you for the following information after you start the script:</span></span>

* <span data-ttu-id="7e109-151">**Nom du groupe de ressources** nom du groupe de ressources que vous souhaitez placer dans le coffre de clés.</span><span class="sxs-lookup"><span data-stu-id="7e109-151">**Resource Group Name** - Name of the Resource Group that you want to put the Key Vault into.</span></span>  <span data-ttu-id="7e109-152">S’il n’existe aucun groupe de ressources associé à ce nom, un groupe de ressources sera créé en utilisant le nom que vous avez saisi.</span><span class="sxs-lookup"><span data-stu-id="7e109-152">A new Resource Group with the name you enter will be created if there isn’t already one with that name created.</span></span> <span data-ttu-id="7e109-153">Si vous disposez déjà d’un groupe de ressources et que vous souhaitez l’utiliser dans cet abonnement, entrez simplement le nom de ce groupe de ressources.</span><span class="sxs-lookup"><span data-stu-id="7e109-153">If you already have a Resource Group that you want to use in this subscription, then enter the name of that Resource Group.</span></span>
* <span data-ttu-id="7e109-154">**Nom du coffre de clés** : nom du coffre de clés dans lequel les clés de chiffrement doivent être placées.</span><span class="sxs-lookup"><span data-stu-id="7e109-154">**Key Vault Name** - Name of the Key Vault in which encryption keys are to be placed.</span></span> <span data-ttu-id="7e109-155">S’il n’existe aucun coffre de clés associé à ce nom, un coffre de clés sera créé en utilisant le nom que vous avez saisi.</span><span class="sxs-lookup"><span data-stu-id="7e109-155">A new Key Vault with this name will be created if you don’t already have a Key Vault with this name.</span></span> <span data-ttu-id="7e109-156">Si vous disposez déjà d’un coffre de clés et que vous souhaitez l’utiliser, entrez simplement le nom de ce coffre de clés.</span><span class="sxs-lookup"><span data-stu-id="7e109-156">If you already have a Key Vault that you want to use, enter the name of the existing Key Vault.</span></span>
* <span data-ttu-id="7e109-157">**Emplacement** : emplacement du coffre de clés.</span><span class="sxs-lookup"><span data-stu-id="7e109-157">**Location** - Location of the Key Vault.</span></span> <span data-ttu-id="7e109-158">Assurez-vous que le coffre de clés et les machines virtuelles à chiffrer se trouvent au même emplacement.</span><span class="sxs-lookup"><span data-stu-id="7e109-158">Make sure the Key Vault and VMs to be encrypted are in the same location.</span></span> <span data-ttu-id="7e109-159">Si vous ignorez l’emplacement du coffre de clés, lisez la suite de cet article pour vous aider à l’identifier.</span><span class="sxs-lookup"><span data-stu-id="7e109-159">If you don’t know the location, there are steps later in this article that will show you how to find out.</span></span>
* <span data-ttu-id="7e109-160">**Nom de l’application Azure Active Directory** : nom de l’application Azure Active Directory qui vous servira à écrire les clés secrètes dans le coffre de clés.</span><span class="sxs-lookup"><span data-stu-id="7e109-160">**Azure Active Directory Application Name** - Name of the Azure Active Directory application that will be used to write secrets to the Key Vault.</span></span> <span data-ttu-id="7e109-161">S’il n’existe aucune application de ce nom, une nouvelle application sera créée en utilisant le nom que vous avez saisi.</span><span class="sxs-lookup"><span data-stu-id="7e109-161">A new application with this name will be created if one doesn't exist.</span></span> <span data-ttu-id="7e109-162">Si vous disposez déjà d’une application Azure Active Directory et que vous souhaitez l’utiliser, entrez simplement le nom de l’application Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="7e109-162">If you already have an Azure Active Directory application that you want to use, enter the name of that Azure Active Directory application.</span></span>

> [!NOTE]
> <span data-ttu-id="7e109-163">Si vous souhaitez connaître l’intérêt qu’il y a à créer une application Azure Active Directory, consultez la rubrique *Inscription d’une application auprès d’Azure Active Directory* de l’article [Prise en main du coffre de clés Azure](../key-vault/key-vault-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="7e109-163">If you’re curious as to why you need to create an Azure Active Directory application, please see *Register an application with Azure Active Directory* section in the article [Getting Started with Azure Key Vault](../key-vault/key-vault-get-started.md).</span></span>
>
>

<span data-ttu-id="7e109-164">Pour chiffrer une machine virtuelle Azure, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="7e109-164">Perform the following steps to encrypt an Azure Virtual Machine:</span></span>

1. <span data-ttu-id="7e109-165">Si vous avez fermé PowerShell ISE, ouvrez une instance élevée de PowerShell ISE.</span><span class="sxs-lookup"><span data-stu-id="7e109-165">If you closed the PowerShell ISE, open an elevated instance of the PowerShell ISE.</span></span> <span data-ttu-id="7e109-166">Si vous n’avez pas encore ouvert PowerShell ISE, suivez les instructions indiquées au début de cet article.</span><span class="sxs-lookup"><span data-stu-id="7e109-166">Follow the instructions earlier in this article if the PowerShell ISE is not already open.</span></span> <span data-ttu-id="7e109-167">Si vous avez fermé le script, ouvrez le fichier **ADEPrereqScript.ps1** sous le menu **Fichier**, puis cliquez sur **Ouvrir** et sélectionnez le script à partir du dossier **c:\AzureADEScript**.</span><span class="sxs-lookup"><span data-stu-id="7e109-167">If you closed the script, then open the **ADEPrereqScript.ps1** clicking **File**, then **Open** and selecting the script from the **c:\AzureADEScript** folder.</span></span> <span data-ttu-id="7e109-168">Si vous avez suivi toutes les instructions fournies depuis le début de cet article, vous pouvez tout simplement passer à l’étape suivante.</span><span class="sxs-lookup"><span data-stu-id="7e109-168">If you have followed this article from the start, then just move on to the next step.</span></span>
2. <span data-ttu-id="7e109-169">Dans la console de PowerShell ISE (volet inférieur de PowerShell ISE), saisissez **cd c:\AzureADEScript** et appuyez sur **ENTRÉE** pour basculer le script sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="7e109-169">In the console of the PowerShell ISE (the bottom pane of the PowerShell ISE), change the focus to the local of the script by typing **cd c:\AzureADEScript** and press **ENTER**.</span></span>
3. <span data-ttu-id="7e109-170">Configurez la stratégie d’exécution sur votre ordinateur afin de pouvoir exécuter le script.</span><span class="sxs-lookup"><span data-stu-id="7e109-170">Set the execution policy on your machine so that you can run the script.</span></span> <span data-ttu-id="7e109-171">Dans la console, entrez **Set-ExecutionPolicy Unrestricted** , puis appuyez sur ENTRÉE.</span><span class="sxs-lookup"><span data-stu-id="7e109-171">Type **Set-ExecutionPolicy Unrestricted** in the console and then press ENTER.</span></span> <span data-ttu-id="7e109-172">Si une boîte de dialogue vous informe des effets d’une modification de la stratégie d’exécution, cliquez sur **Oui pour tout** ou **Oui** (si l’option **Oui pour tout** est disponible, sélectionnez-la sinon**Oui pour tout**, cliquez sur **Oui**).</span><span class="sxs-lookup"><span data-stu-id="7e109-172">If you see a dialog box telling about the effects of the change to execution policy, click either **Yes to all** or **Yes** (if you see **Yes to all**, select that option – if you do not see **Yes to all**, then click **Yes**).</span></span>
4. <span data-ttu-id="7e109-173">Connectez-vous à votre compte Azure.</span><span class="sxs-lookup"><span data-stu-id="7e109-173">Log into your Azure account.</span></span> <span data-ttu-id="7e109-174">Dans la console, entrez **Login-AzureRmAccount** et appuyez sur **ENTRÉE**.</span><span class="sxs-lookup"><span data-stu-id="7e109-174">In the console, type **Login-AzureRmAccount** and press **ENTER**.</span></span> <span data-ttu-id="7e109-175">Dans la nouvelle boîte de dialogue, entrez vos informations d’identification (assurez-vous que vous disposez des droits pour modifier les machines virtuelles ; dans le cas contraire, vous ne serez pas en mesure de les chiffrer.</span><span class="sxs-lookup"><span data-stu-id="7e109-175">A dialog box will appear in which you enter your credentials (make sure you have rights to change the virtual machines – if you do not have rights, you will not be able to encrypt them.</span></span> <span data-ttu-id="7e109-176">En cas de doute, renseignez-vous auprès du propriétaire ou de l’administrateur de votre abonnement).</span><span class="sxs-lookup"><span data-stu-id="7e109-176">If you are not sure, ask your subscription owner or administrator).</span></span> <span data-ttu-id="7e109-177">Vous devriez voir des informations concernant vos paramètres suivants : **Environment**, **Account**, **TenantId**, **SubscriptionId** et **CurrentStorageAccount**.</span><span class="sxs-lookup"><span data-stu-id="7e109-177">You should see information about your **Environment**, **Account**, **TenantId**, **SubscriptionId** and **CurrentStorageAccount**.</span></span> <span data-ttu-id="7e109-178">Copiez le contenu du champ **SubscriptionId** dans le Bloc-notes.</span><span class="sxs-lookup"><span data-stu-id="7e109-178">Copy the **SubscriptionId** to Notepad.</span></span> <span data-ttu-id="7e109-179">Vous en aurez besoin à l’étape 6.</span><span class="sxs-lookup"><span data-stu-id="7e109-179">You will need to use this in step #6.</span></span>
5. <span data-ttu-id="7e109-180">Identifiez l’abonnement auquel est associée votre machine virtuelle et repérez son emplacement.</span><span class="sxs-lookup"><span data-stu-id="7e109-180">Find what subscription your virtual machine belongs to and its location.</span></span> <span data-ttu-id="7e109-181">Accédez à [https://portal.azure.com](ttps://portal.azure.com) et connectez-vous.</span><span class="sxs-lookup"><span data-stu-id="7e109-181">Go to [https://portal.azure.com](ttps://portal.azure.com) and log in.</span></span>  <span data-ttu-id="7e109-182">À gauche de la page, cliquez sur **Machines virtuelles**.</span><span class="sxs-lookup"><span data-stu-id="7e109-182">On the left side of the page, click **Virtual Machines**.</span></span> <span data-ttu-id="7e109-183">Vous obtenez une liste de vos machines virtuelles ainsi que des abonnements auxquels elles sont rattachées.</span><span class="sxs-lookup"><span data-stu-id="7e109-183">You will see a list of your virtual machines and the subscriptions they belong to.</span></span>

   ![Machines virtuelles](./media/security-center-disk-encryption/security-center-disk-encryption-fig3.png)
6. <span data-ttu-id="7e109-185">Revenez maintenant à PowerShell ISE.</span><span class="sxs-lookup"><span data-stu-id="7e109-185">Return to the PowerShell ISE.</span></span> <span data-ttu-id="7e109-186">Définissez le contexte d’abonnement dans lequel le script sera exécuté.</span><span class="sxs-lookup"><span data-stu-id="7e109-186">Set the subscription context in which the script will be run.</span></span> <span data-ttu-id="7e109-187">Dans la console, tapez **Select-AzureRmSubscription –SubscriptionId &lt;ID_de_votre_abonement&gt;** (remplacez **&lt;ID_de_votre_abonement&gt;** par votre ID d’abonnement) et appuyez sur **ENTRÉE**.</span><span class="sxs-lookup"><span data-stu-id="7e109-187">In the console, type **Select-AzureRmSubscription –SubscriptionId <your_subscription_Id>** (replace **< your_subscription_Id >** with your actual Subscription ID) and press **ENTER**.</span></span> <span data-ttu-id="7e109-188">Vous verrez des informations concernant votre environnement et les paramètres **Account**, **TenantId**, **SubscriptionId** et **CurrentStorageAccount**.</span><span class="sxs-lookup"><span data-stu-id="7e109-188">You will see information about the Environment, **Account**, **TenantId**, **SubscriptionId** and **CurrentStorageAccount**.</span></span>
7. <span data-ttu-id="7e109-189">Vous êtes maintenant prêt à exécuter le script.</span><span class="sxs-lookup"><span data-stu-id="7e109-189">You are now ready to run the script.</span></span> <span data-ttu-id="7e109-190">Cliquez sur le bouton **Exécuter le script** ou appuyez sur la touche **F5** du clavier.</span><span class="sxs-lookup"><span data-stu-id="7e109-190">Click the **Run Script** button or press **F5** on the keyboard.</span></span>

   ![Exécution du script PowerShell](./media/security-center-disk-encryption/security-center-disk-encryption-fig4.png)
8. <span data-ttu-id="7e109-192">Le script vous invite à renseigner le paramètre **resourceGroupName** : entrez le nom du *Groupe de ressources* que vous souhaitez utiliser, puis appuyez sur **ENTRÉE**.</span><span class="sxs-lookup"><span data-stu-id="7e109-192">The script asks for **resourceGroupName:** - enter the name of *Resource Group* you want to use, then press **ENTER**.</span></span> <span data-ttu-id="7e109-193">Si vous ne disposez d’aucun groupe de ressources, saisissez un nouveau nom.</span><span class="sxs-lookup"><span data-stu-id="7e109-193">If you don’t have one, enter a name you want to use for a new one.</span></span> <span data-ttu-id="7e109-194">Si vous disposez déjà d’un *Groupe de ressources* que vous souhaitez utiliser (par exemple, celui dans lequel se trouve votre machine virtuelle), entrez le nom du Groupe de ressources existant.</span><span class="sxs-lookup"><span data-stu-id="7e109-194">If you already have a *Resource Group* that you want to use (such as the one that your virtual machine is in), enter the name of the existing Resource Group.</span></span>
9. <span data-ttu-id="7e109-195">Le script vous invite à renseigner le paramètre **keyVaultName** : entrez le nom du *Coffre de clés* que vous souhaitez utiliser, puis appuyez sur ENTRÉE.</span><span class="sxs-lookup"><span data-stu-id="7e109-195">The script asks for **keyVaultName:** - enter the name of the *Key Vault* you want to use, then press ENTER.</span></span> <span data-ttu-id="7e109-196">Si vous ne disposez d’aucun groupe de ressources, saisissez un nouveau nom.</span><span class="sxs-lookup"><span data-stu-id="7e109-196">If you don’t have one, enter a name you want to use for a new one.</span></span> <span data-ttu-id="7e109-197">Si vous disposez déjà d’un coffre de clés et que vous souhaitez l’utiliser, entrez simplement le nom de ce *Coffre de clés*.</span><span class="sxs-lookup"><span data-stu-id="7e109-197">If you already have a Key Vault that you want to use, enter the name of the existing *Key Vault*.</span></span>
10. <span data-ttu-id="7e109-198">Le script vous invite à renseigner le paramètre **location** : entrez le nom de l’emplacement dans lequel se trouve la machine virtuelle que vous souhaitez chiffrer, puis appuyez sur **ENTRÉE**.</span><span class="sxs-lookup"><span data-stu-id="7e109-198">The script asks for **location:** - enter the name of the location in which the VM you want to encrypt is located, then press **ENTER**.</span></span> <span data-ttu-id="7e109-199">Si vous ne connaissez pas l’emplacement, revenez à l’étape 5.</span><span class="sxs-lookup"><span data-stu-id="7e109-199">If you don’t remember the location, go back to step #5.</span></span>
11. <span data-ttu-id="7e109-200">Le script vous invite à renseigner le paramètre **aadAppName** : entrez le nom de l’application *Azure Active Directory* que vous souhaitez utiliser, puis appuyez sur **ENTRÉE**.</span><span class="sxs-lookup"><span data-stu-id="7e109-200">The script asks for **aadAppName:** - enter the name of the *Azure Active Directory* application you want to use, then press **ENTER**.</span></span> <span data-ttu-id="7e109-201">Si vous ne disposez d’aucun groupe de ressources, saisissez un nouveau nom.</span><span class="sxs-lookup"><span data-stu-id="7e109-201">If you don’t have one, enter a name you want to use for a new one.</span></span> <span data-ttu-id="7e109-202">Si vous disposez déjà d’une *application Azure Active Directory* et que vous souhaitez l’utiliser, entrez simplement le nom de votre *application Azure Active Directory*.</span><span class="sxs-lookup"><span data-stu-id="7e109-202">If you already have an *Azure Active Directory application* that you want to use, enter the name of the existing *Azure Active Directory application*.</span></span>
12. <span data-ttu-id="7e109-203">Une boîte de dialogue de connexion s’affiche.</span><span class="sxs-lookup"><span data-stu-id="7e109-203">A log in dialog box will appear.</span></span> <span data-ttu-id="7e109-204">Indiquez vos informations d’identification (vous devez effectivement vous reconnecter).</span><span class="sxs-lookup"><span data-stu-id="7e109-204">Provide your credentials (yes, you have logged in once, but now you need to do it again).</span></span>
13. <span data-ttu-id="7e109-205">Le script s’exécute. À la fin de son exécution, il vous demande de copier les valeurs des paramètres **aadClientID**, **aadClientSecret**, **diskEncryptionKeyVaultUrl** et **keyVaultResourceId**.</span><span class="sxs-lookup"><span data-stu-id="7e109-205">The script runs and when complete it will ask you to copy the values of the **aadClientID**, **aadClientSecret**, **diskEncryptionKeyVaultUrl**, and **keyVaultResourceId**.</span></span> <span data-ttu-id="7e109-206">Copiez chacune de ces valeurs dans le Presse-papiers, puis collez-les dans le Bloc-notes.</span><span class="sxs-lookup"><span data-stu-id="7e109-206">Copy each of these values to the clipboard and paste them into Notepad.</span></span>
14. <span data-ttu-id="7e109-207">De nouveau dans PowerShell ISE, placez le curseur à la fin de la dernière ligne, puis appuyez sur **ENTRÉE**.</span><span class="sxs-lookup"><span data-stu-id="7e109-207">Return to the PowerShell ISE and place the cursor at the end of the last line, and press **ENTER**.</span></span>

<span data-ttu-id="7e109-208">Le script doit générer un résultat semblable à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="7e109-208">The output of the script should look something like the screen below:</span></span>

![Sortie PowerShell](./media/security-center-disk-encryption/security-center-disk-encryption-fig5.png)

## <a name="encrypt-the-azure-virtual-machine"></a><span data-ttu-id="7e109-210">Chiffrer la machine virtuelle Azure</span><span class="sxs-lookup"><span data-stu-id="7e109-210">Encrypt the Azure virtual machine</span></span>
<span data-ttu-id="7e109-211">Vous êtes maintenant prêt à chiffrer votre machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="7e109-211">You are now ready to encrypt your virtual machine.</span></span> <span data-ttu-id="7e109-212">Si votre machine virtuelle se trouve dans le même groupe de ressources que le coffre de clés, vous pouvez passer directement aux étapes du chiffrement.</span><span class="sxs-lookup"><span data-stu-id="7e109-212">If your virtual machine is located in the same Resource Group as your Key Vault, you can move on to the encryption steps section.</span></span> <span data-ttu-id="7e109-213">Dans le cas contraire, vous devez saisir la commande suivante dans la console de PowerShell ISE :</span><span class="sxs-lookup"><span data-stu-id="7e109-213">However, if your virtual machine is not in the same Resource Group as your Key Vault, you will need to enter the following in the console in the PowerShell ISE:</span></span>

<span data-ttu-id="7e109-214">**$resourceGroupName = <’Virtual_Machine_RG’>**</span><span class="sxs-lookup"><span data-stu-id="7e109-214">**$resourceGroupName = <’Virtual_Machine_RG’>**</span></span>

<span data-ttu-id="7e109-215">Remplacez**< Virtual_Machine_RG >** par le nom du groupe de ressources dans lequel se trouvent vos machines virtuelles, en conservant les guillemets simples.</span><span class="sxs-lookup"><span data-stu-id="7e109-215">Replace **< Virtual_Machine_RG >** with the name of the Resource Group in which your virtual machines are contained, surrounded by a single quote.</span></span> <span data-ttu-id="7e109-216">Appuyez sur **Entrée**.</span><span class="sxs-lookup"><span data-stu-id="7e109-216">Then press **ENTER**.</span></span>
<span data-ttu-id="7e109-217">Pour vérifier que le nom du groupe de ressources que vous avez saisi est correct, entrez la commande suivante dans la console PowerShell ISE :</span><span class="sxs-lookup"><span data-stu-id="7e109-217">To confirm that the correct Resource Group name was entered, type the following in the PowerShell ISE console:</span></span>

<span data-ttu-id="7e109-218">**$resourceGroupName**</span><span class="sxs-lookup"><span data-stu-id="7e109-218">**$resourceGroupName**</span></span>

<span data-ttu-id="7e109-219">Appuyez sur **ENTRÉE**.</span><span class="sxs-lookup"><span data-stu-id="7e109-219">Press **ENTER**.</span></span> <span data-ttu-id="7e109-220">Le nom du groupe de ressources dans lequel se trouvent vos machines virtuelles doit normalement s’afficher.</span><span class="sxs-lookup"><span data-stu-id="7e109-220">You should see the name of Resource Group that your virtual machines are located in.</span></span> <span data-ttu-id="7e109-221">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="7e109-221">For example:</span></span>

![Sortie PowerShell](./media/security-center-disk-encryption/security-center-disk-encryption-fig6.png)

### <a name="encryption-steps"></a><span data-ttu-id="7e109-223">Étapes du chiffrement</span><span class="sxs-lookup"><span data-stu-id="7e109-223">Encryption steps</span></span>
<span data-ttu-id="7e109-224">Vous devez tout d’abord indiquer à PowerShell le nom de la machine virtuelle que vous souhaitez chiffrer.</span><span class="sxs-lookup"><span data-stu-id="7e109-224">First, you need to tell PowerShell the name of the virtual machine you want to encrypt.</span></span> <span data-ttu-id="7e109-225">Dans la console, entrez la commande suivante :</span><span class="sxs-lookup"><span data-stu-id="7e109-225">In the console, type:</span></span>

<span data-ttu-id="7e109-226">**$vmName = <’your_vm_name’>**</span><span class="sxs-lookup"><span data-stu-id="7e109-226">**$vmName = <’your_vm_name’>**</span></span>

<span data-ttu-id="7e109-227">Remplacez **<’your_vm_name’>** par le nom de votre machine virtuelle (en veillant à bien conserver les guillemets simples), puis appuyez sur **ENTRÉE**.</span><span class="sxs-lookup"><span data-stu-id="7e109-227">Replace **<’your_vm_name’>** with the name of your VM (make sure the name is surrounded by a single quote) and then press **ENTER**.</span></span>

<span data-ttu-id="7e109-228">Pour vérifier que le nom de la machine virtuelle saisi est correct, entrez la commande suivante :</span><span class="sxs-lookup"><span data-stu-id="7e109-228">To confirm that the correct VM name was entered, type:</span></span>

<span data-ttu-id="7e109-229">**$vmName**</span><span class="sxs-lookup"><span data-stu-id="7e109-229">**$vmName**</span></span>

<span data-ttu-id="7e109-230">Appuyez sur **ENTRÉE**.</span><span class="sxs-lookup"><span data-stu-id="7e109-230">Press **ENTER**.</span></span> <span data-ttu-id="7e109-231">Le nom de la machine virtuelle que vous souhaitez chiffrer doit normalement s’afficher.</span><span class="sxs-lookup"><span data-stu-id="7e109-231">You should see the name of the virtual machine you want to encrypt.</span></span> <span data-ttu-id="7e109-232">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="7e109-232">For example:</span></span>

![Sortie PowerShell](./media/security-center-disk-encryption/security-center-disk-encryption-fig7.png)

<span data-ttu-id="7e109-234">Il existe deux méthodes pour exécuter la commande de chiffrement de tous les disques sur une machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="7e109-234">There are two methods to run the encryption command to encrypt all drives on the virtual machine.</span></span> <span data-ttu-id="7e109-235">La première méthode consiste à saisir la commande suivante dans la console PowerShell ISE :</span><span class="sxs-lookup"><span data-stu-id="7e109-235">The first method is to type the following command in the PowerShell ISE console:</span></span>

~~~
Set-AzureRmVMDiskEncryptionExtension -ResourceGroupName $resourceGroupName -VMName $vmName -AadClientID $aadClientID -AadClientSecret $aadClientSecret -DiskEncryptionKeyVaultUrl $diskEncryptionKeyVaultUrl -DiskEncryptionKeyVaultId $keyVaultResourceId -VolumeType All
~~~

<span data-ttu-id="7e109-236">Appuyez ensuite sur **ENTRÉE**.</span><span class="sxs-lookup"><span data-stu-id="7e109-236">After typing this command press **ENTER**.</span></span>

<span data-ttu-id="7e109-237">La deuxième méthode consiste à cliquer dans le volet de script (le volet supérieur de PowerShell ISE) et à faire défiler le contenu jusqu’en bas du script.</span><span class="sxs-lookup"><span data-stu-id="7e109-237">The second method is to click in the script pane (the top pane of the PowerShell ISE) and scroll down to the bottom of the script.</span></span> <span data-ttu-id="7e109-238">Mettez en surbrillance la commande ci-dessus et cliquez dessus avec le bouton droit de la souris, puis cliquez sur **Exécuter la sélection** ou appuyez sur la touche **F8** du clavier.</span><span class="sxs-lookup"><span data-stu-id="7e109-238">Highlight the command listed above, and then right click it and then click **Run Selection** or press **F8** on the keyboard.</span></span>

![PowerShell ISE](./media/security-center-disk-encryption/security-center-disk-encryption-fig8.png)

<span data-ttu-id="7e109-240">Quelle que soit la méthode que vous utilisez, une boîte de dialogue vous informe que l’opération prendra 10 à 15 minutes.</span><span class="sxs-lookup"><span data-stu-id="7e109-240">Regardless of the method you use, a dialog box will appear informing you that it will take 10-15 minutes for the operation to complete.</span></span> <span data-ttu-id="7e109-241">Cliquez sur **Oui**.</span><span class="sxs-lookup"><span data-stu-id="7e109-241">Click **Yes**.</span></span>

<span data-ttu-id="7e109-242">Au cours du processus de chiffrement, vous pouvez revenir au portail Azure et consulter l’état de la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="7e109-242">While the encryption process is taking place, you can return to the Azure Portal and see the status of the virtual machine.</span></span> <span data-ttu-id="7e109-243">À gauche de la page, cliquez sur **Machines virtuelles** puis, dans le panneau **Machines virtuelles**, cliquez sur le nom de la machine virtuelle que vous êtes en train de chiffrer.</span><span class="sxs-lookup"><span data-stu-id="7e109-243">On the left side of the page, click **Virtual Machines**, then in the **Virtual Machines** blade, click the name of the virtual machine you’re encrypting.</span></span> <span data-ttu-id="7e109-244">Dans le panneau qui s’affiche, vous remarquerez que l’**État** est défini sur **Mise à jour**.</span><span class="sxs-lookup"><span data-stu-id="7e109-244">In the blade that appears, you’ll notice that the **Status** says that it’s **Updating**.</span></span> <span data-ttu-id="7e109-245">ce qui prouve que le chiffrement est en cours.</span><span class="sxs-lookup"><span data-stu-id="7e109-245">This demonstrates that encryption is in process.</span></span>

![Plus de détails sur la machine virtuelle](./media/security-center-disk-encryption/security-center-disk-encryption-fig9.png)

<span data-ttu-id="7e109-247">Revenez maintenant à PowerShell ISE.</span><span class="sxs-lookup"><span data-stu-id="7e109-247">Return to the PowerShell ISE.</span></span> <span data-ttu-id="7e109-248">Une fois le script exécuté, vous obtenez le message suivant.</span><span class="sxs-lookup"><span data-stu-id="7e109-248">When the script completes, you’ll see what appears in the figure below.</span></span>

![Sortie PowerShell](./media/security-center-disk-encryption/security-center-disk-encryption-fig10.png)

<span data-ttu-id="7e109-250">Pour vérifier que la machine virtuelle est bien chiffrée, revenez au portail Azure et cliquez sur **Machines virtuelles** à gauche de la page.</span><span class="sxs-lookup"><span data-stu-id="7e109-250">To demonstrate that the virtual machine is now encrypted, return to the Azure Portal and click **Virtual Machines** on the left side of the page.</span></span> <span data-ttu-id="7e109-251">Cliquez sur le nom de la machine virtuelle que vous avez chiffrée.</span><span class="sxs-lookup"><span data-stu-id="7e109-251">Click the name of the virtual machine you encrypted.</span></span> <span data-ttu-id="7e109-252">Dans le panneau **Paramètres**, cliquez sur **Disques**.</span><span class="sxs-lookup"><span data-stu-id="7e109-252">In the **Settings** blade, click **Disks**.</span></span>

![Options des paramètres](./media/security-center-disk-encryption/security-center-disk-encryption-fig11.png)

<span data-ttu-id="7e109-254">Dans le panneau **Disques**, l’option **Chiffrement** est **activée**.</span><span class="sxs-lookup"><span data-stu-id="7e109-254">On the **Disks** blade, you will see that **Encryption** is **Enabled**.</span></span>

![Propriétés des disques](./media/security-center-disk-encryption/security-center-disk-encryption-fig12.png)

## <a name="next-steps"></a><span data-ttu-id="7e109-256">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="7e109-256">Next steps</span></span>
<span data-ttu-id="7e109-257">Dans ce document, vous avez appris à chiffrer une machine virtuelle Azure.</span><span class="sxs-lookup"><span data-stu-id="7e109-257">In this document, you learned how to encrypt an Azure Virtual Machine.</span></span> <span data-ttu-id="7e109-258">Pour plus d’informations sur le Centre de sécurité Azure, consultez les rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="7e109-258">To learn more about Azure Security Center, see the following:</span></span>

* <span data-ttu-id="7e109-259">[Surveillance de l’intégrité de la sécurité dans le Centre de sécurité Azure](security-center-monitoring.md) : découvrez comment surveiller l’intégrité de vos ressources Azure</span><span class="sxs-lookup"><span data-stu-id="7e109-259">[Security health monitoring in Azure Security Center](security-center-monitoring.md) – Learn how to monitor the health of your Azure resources</span></span>
* <span data-ttu-id="7e109-260">[Gestion et résolution des alertes de sécurité dans le Centre de sécurité Azure](security-center-managing-and-responding-alerts.md) – Découvrez comment gérer et résoudre les alertes de sécurité</span><span class="sxs-lookup"><span data-stu-id="7e109-260">[Managing and responding to security alerts in Azure Security Center](security-center-managing-and-responding-alerts.md) - Learn how to manage and respond to security alerts</span></span>
* <span data-ttu-id="7e109-261">[FAQ du Centre de sécurité Azure](security-center-faq.md) – Forum Aux Questions concernant l’utilisation de ce service</span><span class="sxs-lookup"><span data-stu-id="7e109-261">[Azure Security Center FAQ](security-center-faq.md) – Find frequently asked questions about using the service</span></span>
* <span data-ttu-id="7e109-262">[Blog sur la sécurité Azure](http://blogs.msdn.com/b/azuresecurity/) : recherchez des billets de blog sur la sécurité et la conformité Azure</span><span class="sxs-lookup"><span data-stu-id="7e109-262">[Azure Security Blog](http://blogs.msdn.com/b/azuresecurity/) – Find blog posts about Azure security and compliance</span></span>
