---
title: "Passerelle de données locale | Microsoft Docs"
description: "Une passerelle locale est nécessaire si votre serveur Analysis Services dans Azure se connecte à des sources de données locales."
services: analysis-services
documentationcenter: 
author: minewiskan
manager: erikre
editor: 
tags: 
ms.assetid: cd596155-b608-4a34-935e-e45c95d884a9
ms.service: analysis-services
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: na
ms.date: 08/21/2017
ms.author: owend
ms.openlocfilehash: 514b5404e8cbfa0baa657eb41736e20cad502638
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/29/2017
---
# <a name="connecting-to-on-premises-data-sources-with-azure-on-premises-data-gateway"></a><span data-ttu-id="89137-103">Connexion aux sources de données locales avec la passerelle de données Azure locale</span><span class="sxs-lookup"><span data-stu-id="89137-103">Connecting to on-premises data sources with Azure On-premises Data Gateway</span></span>
<span data-ttu-id="89137-104">La passerelle de données locale agit comme un pont, en fournissant un transfert de données sécurisé entre des sources de données locales et vos serveurs Azure Analysis Services dans le cloud.</span><span class="sxs-lookup"><span data-stu-id="89137-104">The on-premises data gateway acts as a bridge, providing secure data transfer between on-premises data sources and your Azure Analysis Services servers in the cloud.</span></span> <span data-ttu-id="89137-105">Pouvant être utilisée avec plusieurs serveurs Azure Analysis Services dans la même région, la dernière version de la passerelle fonctionne également avec Azure Logic Apps, Power BI, Power Apps et Microsoft Flow.</span><span class="sxs-lookup"><span data-stu-id="89137-105">In addition to working with multiple Azure Analysis Services servers in the same region, the latest version of the gateway also works with Azure Logic Apps, Power BI, Power Apps, and Microsoft Flow.</span></span> <span data-ttu-id="89137-106">Vous pouvez associer plusieurs services dans la même région avec une passerelle unique.</span><span class="sxs-lookup"><span data-stu-id="89137-106">You can associate multiple services in the same region with a single gateway.</span></span> 

 <span data-ttu-id="89137-107">Azure Analysis Services nécessite une ressource de passerelle dans la même région.</span><span class="sxs-lookup"><span data-stu-id="89137-107">Azure Analysis Services requires a gateway resource in the same region.</span></span> <span data-ttu-id="89137-108">Par exemple, si vous avez des serveurs Azure Analysis Services dans la région Est des États-Unis 2, vous aurez besoin d’une ressource de passerelle dans la région Est des États-Unis 2.</span><span class="sxs-lookup"><span data-stu-id="89137-108">For example, if you have Azure Analysis Services servers in the East US 2 region, you need a gateway resource in the East US 2 region.</span></span> <span data-ttu-id="89137-109">Plusieurs serveurs de la région Est des États-Unis 2 peuvent utiliser la même passerelle.</span><span class="sxs-lookup"><span data-stu-id="89137-109">Multiple servers in East US 2 can use the same gateway.</span></span>

<span data-ttu-id="89137-110">La première configuration de la passerelle se déroule en quatre étapes :</span><span class="sxs-lookup"><span data-stu-id="89137-110">Getting setup with the gateway the first time is a four-part process:</span></span>

- <span data-ttu-id="89137-111">**Télécharger et exécuter le programme d’installation** - Cette étape installe un service de passerelle sur un ordinateur de votre organisation.</span><span class="sxs-lookup"><span data-stu-id="89137-111">**Download and run setup** - This step installs a gateway service on a computer in your organization.</span></span>

- <span data-ttu-id="89137-112">**Inscrire votre passerelle** - Lors de cette étape, vous spécifiez un nom et une clé de récupération pour votre passerelle et vous sélectionnez une région, pour l’inscription de votre passerelle auprès du service cloud de passerelle.</span><span class="sxs-lookup"><span data-stu-id="89137-112">**Register your gateway** - In this step, you specify a name and recovery key for your gateway, and select a region, registering your gateway with the Gateway Cloud Service.</span></span>

- <span data-ttu-id="89137-113">**Créer une ressource de passerelle dans Azure** - Lors de cette étape, vous créez une ressource de passerelle dans votre abonnement Azure.</span><span class="sxs-lookup"><span data-stu-id="89137-113">**Create a gateway resource in Azure** - In this step, you create a gateway resource in your Azure subscription.</span></span>

- <span data-ttu-id="89137-114">**Connecter vos serveurs à vos ressources de passerelle** - Une fois que vous avez une ressource de passerelle dans votre abonnement, vous pouvez commencer à y connecter vos serveurs.</span><span class="sxs-lookup"><span data-stu-id="89137-114">**Connect your servers to your gateway resource** - Once you have a gateway resource in your subscription, you can begin connecting your servers to it.</span></span>

<span data-ttu-id="89137-115">Une fois que vous avez configuré une ressource de passerelle dans votre abonnement, vous pouvez y connecter plusieurs serveurs et d’autres services.</span><span class="sxs-lookup"><span data-stu-id="89137-115">Once you have a gateway resource configured for your subscription, you can connect multiple servers, and other services to it.</span></span> <span data-ttu-id="89137-116">Vous devez uniquement installer une passerelle différente et créer d’autres ressources de passerelle si vous avez des serveurs ou d’autres services dans une autre région.</span><span class="sxs-lookup"><span data-stu-id="89137-116">You only need to install a different gateway and create additional gateway resources if you have servers or other services in a different region.</span></span>

<span data-ttu-id="89137-117">Pour commencer immédiatement, consultez la page [Install and configure on-premises data gateway](analysis-services-gateway-install.md) (Installer et configurer la passerelle de données locale).</span><span class="sxs-lookup"><span data-stu-id="89137-117">To get started right away, see [Install and configure on-premises data gateway](analysis-services-gateway-install.md).</span></span>

## <span data-ttu-id="89137-118"><a name="how-it-works"> </a>Fonctionnement</span><span class="sxs-lookup"><span data-stu-id="89137-118"><a name="how-it-works"> </a>How it works</span></span>
<span data-ttu-id="89137-119">La passerelle que vous installez sur un ordinateur de votre organisation s’exécute comme un service Windows, **Passerelle de données locale**.</span><span class="sxs-lookup"><span data-stu-id="89137-119">The gateway you install on a computer in your organization runs as a Windows service, **On-premises data gateway**.</span></span> <span data-ttu-id="89137-120">Ce service local est inscrit auprès du service cloud de passerelle via Azure Service Bus.</span><span class="sxs-lookup"><span data-stu-id="89137-120">This local service is registered with the Gateway Cloud Service through Azure Service Bus.</span></span> <span data-ttu-id="89137-121">Vous créez ensuite la ressource de passerelle correspondante pour votre abonnement Azure.</span><span class="sxs-lookup"><span data-stu-id="89137-121">You then create a gateway resource Gateway Cloud Service for your Azure subscription.</span></span> <span data-ttu-id="89137-122">Vos serveurs Azure Analysis Services sont alors connectés à vos ressources de passerelle.</span><span class="sxs-lookup"><span data-stu-id="89137-122">Your Azure Analysis Services servers are then connected to your gateway resource.</span></span> <span data-ttu-id="89137-123">Lorsque des modèles sur votre serveur doivent se connecter à vos sources de données locales pour des requêtes ou un traitement, un flux de données et de requête parcourt la ressource de passerelle, Azure Service Bus, le service de passerelle de données locale et vos sources de données.</span><span class="sxs-lookup"><span data-stu-id="89137-123">When models on your server need to connect to your on-premises data sources for queries or processing, a query and data flow traverses the gateway resource, Azure Service Bus, the local on-premises data gateway service, and your data sources.</span></span> 

![Fonctionnement](./media/analysis-services-gateway/aas-gateway-how-it-works.png)

<span data-ttu-id="89137-125">Requêtes et flux de données :</span><span class="sxs-lookup"><span data-stu-id="89137-125">Queries and data flow:</span></span>

1. <span data-ttu-id="89137-126">Une requête est créée par le service cloud avec les informations d’identification chiffrées de la source de données locale.</span><span class="sxs-lookup"><span data-stu-id="89137-126">A query is created by the cloud service with the encrypted credentials for the on-premises data source.</span></span> <span data-ttu-id="89137-127">Elle est ensuite envoyée dans une file d’attente pour être traitée par la passerelle.</span><span class="sxs-lookup"><span data-stu-id="89137-127">It's then sent to a queue for the gateway to process.</span></span>
2. <span data-ttu-id="89137-128">Le service cloud de la passerelle analyse la requête et envoie la requête vers [Azure Service Bus](https://azure.microsoft.com/documentation/services/service-bus/).</span><span class="sxs-lookup"><span data-stu-id="89137-128">The gateway cloud service analyzes the query and pushes the request to the [Azure Service Bus](https://azure.microsoft.com/documentation/services/service-bus/).</span></span>
3. <span data-ttu-id="89137-129">La passerelle de données locale interroge Azure Service Bus pour connaître les requêtes en attente.</span><span class="sxs-lookup"><span data-stu-id="89137-129">The on-premises data gateway polls the Azure Service Bus for pending requests.</span></span>
4. <span data-ttu-id="89137-130">La passerelle reçoit la requête, déchiffre les informations d’identification et se connecte aux sources de données avec ces informations d’identification.</span><span class="sxs-lookup"><span data-stu-id="89137-130">The gateway gets the query, decrypts the credentials, and connects to the data sources with those credentials.</span></span>
5. <span data-ttu-id="89137-131">La passerelle envoie la requête à la source de données pour exécution.</span><span class="sxs-lookup"><span data-stu-id="89137-131">The gateway sends the query to the data source for execution.</span></span>
6. <span data-ttu-id="89137-132">Les résultats sont renvoyés de la source de données vers la passerelle, puis vers le service cloud et votre serveur.</span><span class="sxs-lookup"><span data-stu-id="89137-132">The results are sent from the data source, back to the gateway, and then onto the cloud service and your server.</span></span>

## <span data-ttu-id="89137-133"><a name="windows-service-account"> </a>Compte de service Windows</span><span class="sxs-lookup"><span data-stu-id="89137-133"><a name="windows-service-account"> </a>Windows Service account</span></span>
<span data-ttu-id="89137-134">La passerelle de données locale est configurée afin d’utiliser *NT SERVICE\PBIEgwService* pour les informations d’identification d’ouverture de session du service Windows.</span><span class="sxs-lookup"><span data-stu-id="89137-134">The on-premises data gateway is configured to use *NT SERVICE\PBIEgwService* for the Windows service logon credential.</span></span> <span data-ttu-id="89137-135">Par défaut, elle dispose du droit d’ouverture de session en tant que service ; dans le contexte de l’ordinateur sur lequel vous installez la passerelle.</span><span class="sxs-lookup"><span data-stu-id="89137-135">By default, it has the right of Logon as a service; in the context of the machine that you are installing the gateway on.</span></span> <span data-ttu-id="89137-136">Ces informations d’identification ne correspondent pas au même compte que celui utilisé pour se connecter aux sources de données locales ou à votre compte Azure.</span><span class="sxs-lookup"><span data-stu-id="89137-136">This credential is not the same account used to connect to on-premises data sources or your Azure account.</span></span>  

<span data-ttu-id="89137-137">Si vous rencontrez des problèmes avec votre serveur proxy en raison de l’authentification, vous souhaiterez peut-être modifier le compte de service Windows sur un utilisateur de domaine ou un compte de service géré.</span><span class="sxs-lookup"><span data-stu-id="89137-137">If you encounter issues with your proxy server due to authentication, you may want to change the Windows service account to a domain user or managed service account.</span></span>

## <span data-ttu-id="89137-138"><a name="ports"> </a>Ports</span><span class="sxs-lookup"><span data-stu-id="89137-138"><a name="ports"> </a>Ports</span></span>
<span data-ttu-id="89137-139">La passerelle crée une connexion sortante vers Azure Service Bus.</span><span class="sxs-lookup"><span data-stu-id="89137-139">The gateway creates an outbound connection to Azure Service Bus.</span></span> <span data-ttu-id="89137-140">Elle communique sur les ports sortants : TCP 443 (par défaut), 5671, 5672 et 9350 à 9354.</span><span class="sxs-lookup"><span data-stu-id="89137-140">It communicates on outbound ports: TCP 443 (default), 5671, 5672, 9350 through 9354.</span></span>  <span data-ttu-id="89137-141">La passerelle ne nécessite pas de ports entrants.</span><span class="sxs-lookup"><span data-stu-id="89137-141">The gateway does not require inbound ports.</span></span>

<span data-ttu-id="89137-142">Nous vous recommandons d’autoriser les adresses IP pour votre région de données dans votre pare-feu.</span><span class="sxs-lookup"><span data-stu-id="89137-142">We recommend you whitelist the IP addresses for your data region in your firewall.</span></span> <span data-ttu-id="89137-143">Vous pouvez télécharger la [liste d’adresses IP de centre de données Microsoft Azure](https://www.microsoft.com/download/details.aspx?id=41653).</span><span class="sxs-lookup"><span data-stu-id="89137-143">You can download the [Microsoft Azure Datacenter IP list](https://www.microsoft.com/download/details.aspx?id=41653).</span></span> <span data-ttu-id="89137-144">Cette liste est actualisée chaque semaine.</span><span class="sxs-lookup"><span data-stu-id="89137-144">This list is updated weekly.</span></span>

> [!NOTE]
> <span data-ttu-id="89137-145">Les adresses IP répertoriées dans la liste d’adresses IP de centre de données Azure sont en notation CIDR.</span><span class="sxs-lookup"><span data-stu-id="89137-145">The IP Addresses listed in the Azure Datacenter IP list are in CIDR notation.</span></span> <span data-ttu-id="89137-146">Par exemple, 10.0.0.0/24 ne signifie pas 10.0.0.0 à 10.0.0.24.</span><span class="sxs-lookup"><span data-stu-id="89137-146">For example, 10.0.0.0/24 does not mean 10.0.0.0 through 10.0.0.24.</span></span> <span data-ttu-id="89137-147">En savoir plus sur la [notation CIDR](http://whatismyipaddress.com/cidr).</span><span class="sxs-lookup"><span data-stu-id="89137-147">Learn more about the [CIDR notation](http://whatismyipaddress.com/cidr).</span></span>
>
>

<span data-ttu-id="89137-148">Voici les noms de domaine complets utilisés par la passerelle.</span><span class="sxs-lookup"><span data-stu-id="89137-148">The following are the fully qualified domain names used by the gateway.</span></span>

| <span data-ttu-id="89137-149">Noms de domaine</span><span class="sxs-lookup"><span data-stu-id="89137-149">Domain names</span></span> | <span data-ttu-id="89137-150">Ports sortants</span><span class="sxs-lookup"><span data-stu-id="89137-150">Outbound ports</span></span> | <span data-ttu-id="89137-151">Description</span><span class="sxs-lookup"><span data-stu-id="89137-151">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="89137-152">*. powerbi.com</span><span class="sxs-lookup"><span data-stu-id="89137-152">*.powerbi.com</span></span> |<span data-ttu-id="89137-153">80</span><span class="sxs-lookup"><span data-stu-id="89137-153">80</span></span> |<span data-ttu-id="89137-154">HTTP utilisé pour télécharger le programme d’installation.</span><span class="sxs-lookup"><span data-stu-id="89137-154">HTTP used to download the installer.</span></span> |
| <span data-ttu-id="89137-155">*. powerbi.com</span><span class="sxs-lookup"><span data-stu-id="89137-155">*.powerbi.com</span></span> |<span data-ttu-id="89137-156">443</span><span class="sxs-lookup"><span data-stu-id="89137-156">443</span></span> |<span data-ttu-id="89137-157">HTTPS</span><span class="sxs-lookup"><span data-stu-id="89137-157">HTTPS</span></span> |
| <span data-ttu-id="89137-158">*.analysis.windows.net</span><span class="sxs-lookup"><span data-stu-id="89137-158">*.analysis.windows.net</span></span> |<span data-ttu-id="89137-159">443</span><span class="sxs-lookup"><span data-stu-id="89137-159">443</span></span> |<span data-ttu-id="89137-160">HTTPS</span><span class="sxs-lookup"><span data-stu-id="89137-160">HTTPS</span></span> |
| <span data-ttu-id="89137-161">*.login.windows.net</span><span class="sxs-lookup"><span data-stu-id="89137-161">*.login.windows.net</span></span> |<span data-ttu-id="89137-162">443</span><span class="sxs-lookup"><span data-stu-id="89137-162">443</span></span> |<span data-ttu-id="89137-163">HTTPS</span><span class="sxs-lookup"><span data-stu-id="89137-163">HTTPS</span></span> |
| <span data-ttu-id="89137-164">*.servicebus.windows.net</span><span class="sxs-lookup"><span data-stu-id="89137-164">*.servicebus.windows.net</span></span> |<span data-ttu-id="89137-165">5671-5672</span><span class="sxs-lookup"><span data-stu-id="89137-165">5671-5672</span></span> |<span data-ttu-id="89137-166">Advanced Message Queuing Protocol (AMQP)</span><span class="sxs-lookup"><span data-stu-id="89137-166">Advanced Message Queuing Protocol (AMQP)</span></span> |
| <span data-ttu-id="89137-167">*.servicebus.windows.net</span><span class="sxs-lookup"><span data-stu-id="89137-167">*.servicebus.windows.net</span></span> |<span data-ttu-id="89137-168">443, 9350-9354</span><span class="sxs-lookup"><span data-stu-id="89137-168">443, 9350-9354</span></span> |<span data-ttu-id="89137-169">Récepteurs du Service Bus Relay sur TCP (nécessite le port 443 pour l’acquisition du jeton Access Control)</span><span class="sxs-lookup"><span data-stu-id="89137-169">Listeners on Service Bus Relay over TCP (requires 443 for Access Control token acquisition)</span></span> |
| <span data-ttu-id="89137-170">*.frontend.clouddatahub.net</span><span class="sxs-lookup"><span data-stu-id="89137-170">*.frontend.clouddatahub.net</span></span> |<span data-ttu-id="89137-171">443</span><span class="sxs-lookup"><span data-stu-id="89137-171">443</span></span> |<span data-ttu-id="89137-172">HTTPS</span><span class="sxs-lookup"><span data-stu-id="89137-172">HTTPS</span></span> |
| <span data-ttu-id="89137-173">*.core.windows.net</span><span class="sxs-lookup"><span data-stu-id="89137-173">*.core.windows.net</span></span> |<span data-ttu-id="89137-174">443</span><span class="sxs-lookup"><span data-stu-id="89137-174">443</span></span> |<span data-ttu-id="89137-175">HTTPS</span><span class="sxs-lookup"><span data-stu-id="89137-175">HTTPS</span></span> |
| <span data-ttu-id="89137-176">login.microsoftonline.com</span><span class="sxs-lookup"><span data-stu-id="89137-176">login.microsoftonline.com</span></span> |<span data-ttu-id="89137-177">443</span><span class="sxs-lookup"><span data-stu-id="89137-177">443</span></span> |<span data-ttu-id="89137-178">HTTPS</span><span class="sxs-lookup"><span data-stu-id="89137-178">HTTPS</span></span> |
| <span data-ttu-id="89137-179">*.msftncsi.com</span><span class="sxs-lookup"><span data-stu-id="89137-179">*.msftncsi.com</span></span> |<span data-ttu-id="89137-180">443</span><span class="sxs-lookup"><span data-stu-id="89137-180">443</span></span> |<span data-ttu-id="89137-181">Permet de tester la connectivité internet si la passerelle est inaccessible par le service Power BI.</span><span class="sxs-lookup"><span data-stu-id="89137-181">Used to test internet connectivity if the gateway is unreachable by the Power BI service.</span></span> |
| <span data-ttu-id="89137-182">*.microsoftonline-p.com</span><span class="sxs-lookup"><span data-stu-id="89137-182">*.microsoftonline-p.com</span></span> |<span data-ttu-id="89137-183">443</span><span class="sxs-lookup"><span data-stu-id="89137-183">443</span></span> |<span data-ttu-id="89137-184">Utilisé pour l’authentification en fonction de la configuration.</span><span class="sxs-lookup"><span data-stu-id="89137-184">Used for authentication depending on configuration.</span></span> |

### <span data-ttu-id="89137-185"><a name="force-https"></a>Forcer les communications HTTPS avec Azure Service Bus</span><span class="sxs-lookup"><span data-stu-id="89137-185"><a name="force-https"></a>Forcing HTTPS communication with Azure Service Bus</span></span>
<span data-ttu-id="89137-186">Vous pouvez forcer la passerelle à communiquer avec Azure Service Bus à l’aide de HTTPS au lieu de TCP direct ; toutefois, cela peut affecter considérablement les performances.</span><span class="sxs-lookup"><span data-stu-id="89137-186">You can force the gateway to communicate with Azure Service Bus by using HTTPS instead of direct TCP; however, doing so can greatly reduce performance.</span></span> <span data-ttu-id="89137-187">Vous pouvez modifier le fichier *Microsoft.PowerBI.DataMovement.Pipeline.GatewayCore.dll.config* en remplaçant la valeur `AutoDetect` par `Https`.</span><span class="sxs-lookup"><span data-stu-id="89137-187">You can modify the *Microsoft.PowerBI.DataMovement.Pipeline.GatewayCore.dll.config* file by changing the value from `AutoDetect` to `Https`.</span></span> <span data-ttu-id="89137-188">Ce fichier se trouve généralement dans *C:\Program Files\On-premises data gateway*.</span><span class="sxs-lookup"><span data-stu-id="89137-188">This file is typically located at *C:\Program Files\On-premises data gateway*.</span></span>

```
<setting name="ServiceBusSystemConnectivityModeString" serializeAs="String">
    <value>Https</value>
</setting>
```

## <span data-ttu-id="89137-189"><a name="faq"></a>Forum Aux Questions</span><span class="sxs-lookup"><span data-stu-id="89137-189"><a name="faq"></a>Frequently asked questions</span></span>

### <a name="general"></a><span data-ttu-id="89137-190">Généralités</span><span class="sxs-lookup"><span data-stu-id="89137-190">General</span></span>

<span data-ttu-id="89137-191">**Q**: Ai-je besoin d’une passerelle pour les sources de données dans le cloud, par exemple Azure SQL Database ?</span><span class="sxs-lookup"><span data-stu-id="89137-191">**Q**: Do I need a gateway for data sources in the cloud, such as Azure SQL Database?</span></span> <br/><span data-ttu-id="89137-192">
**R** : Non.</span><span class="sxs-lookup"><span data-stu-id="89137-192">
**A**: No.</span></span> <span data-ttu-id="89137-193">Une passerelle se connecte uniquement aux sources de données locales.</span><span class="sxs-lookup"><span data-stu-id="89137-193">A gateway connects to on-premises data sources only.</span></span>

<span data-ttu-id="89137-194">**Q** : La passerelle doit-elle être installée sur le même ordinateur que la source de données ?</span><span class="sxs-lookup"><span data-stu-id="89137-194">**Q**: Does the gateway have to be installed on the same machine as the data source?</span></span> <br/><span data-ttu-id="89137-195">
**R** : Non.</span><span class="sxs-lookup"><span data-stu-id="89137-195">
**A**: No.</span></span> <span data-ttu-id="89137-196">La passerelle se connecte à la source de données en utilisant les informations de connexion fournies.</span><span class="sxs-lookup"><span data-stu-id="89137-196">The gateway connects to the data source using the connection information that was provided.</span></span> <span data-ttu-id="89137-197">En ce sens, considérez la passerelle comme une application cliente.</span><span class="sxs-lookup"><span data-stu-id="89137-197">Consider the gateway as a client application in this sense.</span></span> <span data-ttu-id="89137-198">La passerelle doit juste être en mesure de se connecter au nom du serveur fourni, en général sur le même réseau.</span><span class="sxs-lookup"><span data-stu-id="89137-198">The gateway just needs the capability to connect to the server name that was provided, typically on the same network.</span></span>

<a name="why-azure-work-school-account"></a>

<span data-ttu-id="89137-199">**Q** : Pourquoi dois-je utiliser un compte professionnel ou scolaire pour me connecter ?</span><span class="sxs-lookup"><span data-stu-id="89137-199">**Q**: Why do I need to use a work or school account to sign in?</span></span> <br/><span data-ttu-id="89137-200">
**R** : lorsque vous installez la passerelle de données locale, vous pouvez uniquement utiliser un compte professionnel ou scolaire Azure.</span><span class="sxs-lookup"><span data-stu-id="89137-200">
**A**: You can only use an Azure work or school account when you install the on-premises data gateway.</span></span> <span data-ttu-id="89137-201">Votre compte de connexion est stocké dans un client géré par Azure Active Directory (Azure AD).</span><span class="sxs-lookup"><span data-stu-id="89137-201">Your sign-in account is stored in a tenant that's managed by Azure Active Directory (Azure AD).</span></span> <span data-ttu-id="89137-202">En règle générale, le nom d’utilisateur principal (UPN) de votre compte Azure AD correspond à l’adresse de messagerie.</span><span class="sxs-lookup"><span data-stu-id="89137-202">Usually, your Azure AD account's user principal name (UPN) matches the email address.</span></span>

<span data-ttu-id="89137-203">**Q** : où mes informations d’identification sont-elles stockées ?</span><span class="sxs-lookup"><span data-stu-id="89137-203">**Q**: Where are my credentials stored?</span></span> <br/><span data-ttu-id="89137-204">
**R** : Les informations d’identification que vous entrez pour une source de données sont chiffrées et stockées dans le service cloud de passerelle.</span><span class="sxs-lookup"><span data-stu-id="89137-204">
**A**: The credentials that you enter for a data source are encrypted and stored in the Gateway Cloud Service.</span></span> <span data-ttu-id="89137-205">Les informations d’identification sont déchiffrées au niveau de la passerelle de données locale.</span><span class="sxs-lookup"><span data-stu-id="89137-205">The credentials are decrypted at the on-premises data gateway.</span></span>

<span data-ttu-id="89137-206">**Q** : Existe-t-il des exigences concernant la bande passante réseau ?</span><span class="sxs-lookup"><span data-stu-id="89137-206">**Q**: Are there any requirements for network bandwidth?</span></span> <br/><span data-ttu-id="89137-207">
**R** : Il est recommandé d’utiliser une connexion réseau offrant un bon débit.</span><span class="sxs-lookup"><span data-stu-id="89137-207">
**A**: It's recommend your network connection has good throughput.</span></span> <span data-ttu-id="89137-208">Chaque environnement est différent et la quantité de données envoyées affecte les résultats.</span><span class="sxs-lookup"><span data-stu-id="89137-208">Every environment is different, and the amount of data being sent affects the results.</span></span> <span data-ttu-id="89137-209">ExpressRoute peut vous aider à garantir un niveau de débit approprié entre les centres de données locaux et les centres de données Azure.</span><span class="sxs-lookup"><span data-stu-id="89137-209">Using ExpressRoute could help to guarantee a level of throughput between on-premises and the Azure datacenters.</span></span>
<span data-ttu-id="89137-210">Vous pouvez utiliser l’application tierce Azure Speed Test pour mesurer votre débit.</span><span class="sxs-lookup"><span data-stu-id="89137-210">You can use the third-party tool Azure Speed Test app to help gauge your throughput.</span></span>

<span data-ttu-id="89137-211">**Q** : Quelle est la latence d’exécution des requêtes adressées à une source de données à partir de la passerelle ?</span><span class="sxs-lookup"><span data-stu-id="89137-211">**Q**: What is the latency for running queries to a data source from the gateway?</span></span> <span data-ttu-id="89137-212">Quelle est la meilleure architecture ?</span><span class="sxs-lookup"><span data-stu-id="89137-212">What is the best architecture?</span></span> <br/><span data-ttu-id="89137-213">
**R** : Pour réduire la latence du réseau, installez la passerelle le plus près possible de la source de données.</span><span class="sxs-lookup"><span data-stu-id="89137-213">
**A**: To reduce network latency, install the gateway as close to the data source as possible.</span></span> <span data-ttu-id="89137-214">Si vous pouvez installer la passerelle sur la source de données réelle, cette proximité réduit le temps de latence.</span><span class="sxs-lookup"><span data-stu-id="89137-214">If you can install the gateway on the actual data source, this proximity minimizes the latency introduced.</span></span> <span data-ttu-id="89137-215">Songez également aux centres de données.</span><span class="sxs-lookup"><span data-stu-id="89137-215">Consider the datacenters too.</span></span> <span data-ttu-id="89137-216">Par exemple, si votre service utilise le centre de données États-Unis de l’Ouest et que SQL Server est hébergé sur une machine virtuelle Azure, votre machine virtuelle Azure doit également se situer dans les États-Unis de l’Ouest.</span><span class="sxs-lookup"><span data-stu-id="89137-216">For example, if your service uses the West US datacenter, and you have SQL Server hosted in an Azure VM, your Azure VM should be in the West US too.</span></span> <span data-ttu-id="89137-217">Cette proximité réduit la latence et évite des frais d’acheminement sur la machine virtuelle Azure.</span><span class="sxs-lookup"><span data-stu-id="89137-217">This proximity minimizes latency and avoids egress charges on the Azure VM.</span></span>

<span data-ttu-id="89137-218">**Q** : Comment les résultats sont-ils renvoyés vers le cloud ?</span><span class="sxs-lookup"><span data-stu-id="89137-218">**Q**: How are results sent back to the cloud?</span></span> <br/><span data-ttu-id="89137-219">
**R** : Les résultats sont envoyés via Azure Service Bus.</span><span class="sxs-lookup"><span data-stu-id="89137-219">
**A**: Results are sent through the Azure Service Bus.</span></span>

<span data-ttu-id="89137-220">**Q** : existe-t-il des connexions entrantes vers la passerelle à partir du cloud ?</span><span class="sxs-lookup"><span data-stu-id="89137-220">**Q**: Are there any inbound connections to the gateway from the cloud?</span></span> <br/><span data-ttu-id="89137-221">
**R** : Non.</span><span class="sxs-lookup"><span data-stu-id="89137-221">
**A**: No.</span></span> <span data-ttu-id="89137-222">La passerelle utilise des connexions sortantes vers Azure Service Bus.</span><span class="sxs-lookup"><span data-stu-id="89137-222">The gateway uses outbound connections to Azure Service Bus.</span></span>

<span data-ttu-id="89137-223">**Q** : Que se passe-t-il si je bloque les connexions sortantes ?</span><span class="sxs-lookup"><span data-stu-id="89137-223">**Q**: What if I block outbound connections?</span></span> <span data-ttu-id="89137-224">Que dois-je ouvrir ?</span><span class="sxs-lookup"><span data-stu-id="89137-224">What do I need to open?</span></span> <br/><span data-ttu-id="89137-225">
**R** : Vérifiez les ports et les hôtes que la passerelle utilise.</span><span class="sxs-lookup"><span data-stu-id="89137-225">
**A**: See the ports and hosts that the gateway uses.</span></span>

<span data-ttu-id="89137-226">**Q** : Comment s’appelle le service Windows réel ?</span><span class="sxs-lookup"><span data-stu-id="89137-226">**Q**: What is the actual Windows service called?</span></span><br/><span data-ttu-id="89137-227">
**R** : Dans Services, la passerelle se nomme « service de passerelle de données sur site ».</span><span class="sxs-lookup"><span data-stu-id="89137-227">
**A**: In Services, the gateway is called On-premises data gateway service.</span></span>

<span data-ttu-id="89137-228">**Q** : Le service Windows de passerelle peut-il s’exécuter avec un compte Azure Active Directory ?</span><span class="sxs-lookup"><span data-stu-id="89137-228">**Q**: Can the gateway Windows service run with an Azure Active Directory account?</span></span> <br/><span data-ttu-id="89137-229">
**R** : Non.</span><span class="sxs-lookup"><span data-stu-id="89137-229">
**A**: No.</span></span> <span data-ttu-id="89137-230">Le service Windows doit avoir un compte Windows valide.</span><span class="sxs-lookup"><span data-stu-id="89137-230">The Windows service must have a valid Windows account.</span></span> <span data-ttu-id="89137-231">Par défaut, le service sera exécuté avec le SID du service, NT SERVICE\PBIEgwService.</span><span class="sxs-lookup"><span data-stu-id="89137-231">By default, the service runs with the Service SID, NT SERVICE\PBIEgwService.</span></span>

### <span data-ttu-id="89137-232"><a name="high-availability"></a>Haute disponibilité et récupération d’urgence</span><span class="sxs-lookup"><span data-stu-id="89137-232"><a name="high-availability"></a>High availability and disaster recovery</span></span>

<span data-ttu-id="89137-233">**Q** : Quelles sont les options de récupération d’urgence disponibles ?</span><span class="sxs-lookup"><span data-stu-id="89137-233">**Q**: What options are available for disaster recovery?</span></span> <br/><span data-ttu-id="89137-234">
**R**: Vous pouvez utiliser la clé de récupération pour restaurer ou déplacer une passerelle.</span><span class="sxs-lookup"><span data-stu-id="89137-234">
**A**: You can use the recovery key to restore or move a gateway.</span></span> <span data-ttu-id="89137-235">Lorsque vous installez la passerelle, spécifiez la clé de récupération.</span><span class="sxs-lookup"><span data-stu-id="89137-235">When you install the gateway, specify the recovery key.</span></span>

<span data-ttu-id="89137-236">**Q** : Quel avantage la clé de récupération offre-t-elle ?</span><span class="sxs-lookup"><span data-stu-id="89137-236">**Q**: What is the benefit of the recovery key?</span></span> <br/><span data-ttu-id="89137-237">
**R** : La clé de récupération permet de migrer ou de récupérer les paramètres de votre passerelle en cas de récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="89137-237">
**A**: The recovery key provides a way to migrate or recover your gateway settings after a disaster.</span></span>

## <span data-ttu-id="89137-238"><a name="troubleshooting"> </a>Résolution des problèmes</span><span class="sxs-lookup"><span data-stu-id="89137-238"><a name="troubleshooting"> </a>Troubleshooting</span></span>

<span data-ttu-id="89137-239">**Q** : Comment puis-je voir les requêtes qui sont envoyées à la source de données locale ?</span><span class="sxs-lookup"><span data-stu-id="89137-239">**Q**: How can I see what queries are being sent to the on-premises data source?</span></span> <br/><span data-ttu-id="89137-240">
**R** : Vous pouvez activer le traçage de requête qui inclut les requêtes envoyées.</span><span class="sxs-lookup"><span data-stu-id="89137-240">
**A**: You can enable query tracing, which includes the queries that are sent.</span></span> <span data-ttu-id="89137-241">N’oubliez pas de rétablir la valeur d’origine du traçage des requêtes une fois les problèmes résolus.</span><span class="sxs-lookup"><span data-stu-id="89137-241">Remember to change query tracing back to the original value when done troubleshooting.</span></span> <span data-ttu-id="89137-242">Le fait de laisser activé le traçage des requêtes contribue à augmenter la taille des journaux.</span><span class="sxs-lookup"><span data-stu-id="89137-242">Leaving query tracing turned on creates larger logs.</span></span>

<span data-ttu-id="89137-243">Vous pouvez également utiliser les outils de suivi des requêtes proposés par votre source de données.</span><span class="sxs-lookup"><span data-stu-id="89137-243">You can also look at tools that your data source has for tracing queries.</span></span> <span data-ttu-id="89137-244">Par exemple, vous pouvez utiliser Extended Events ou SQL Profiler for SQL Server et Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="89137-244">For example, you can use Extended Events or SQL Profiler for SQL Server and Analysis Services.</span></span>

<span data-ttu-id="89137-245">**Q** : Où se situent les journaux de la passerelle ?</span><span class="sxs-lookup"><span data-stu-id="89137-245">**Q**: Where are the gateway logs?</span></span> <br/><span data-ttu-id="89137-246">
**R**: Voir la section Journaux plus loin dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="89137-246">
**A**: See Logs later in this topic.</span></span>

### <span data-ttu-id="89137-247"><a name="update"></a>Mise à jour avec la version la plus récente</span><span class="sxs-lookup"><span data-stu-id="89137-247"><a name="update"></a>Update to the latest version</span></span>

<span data-ttu-id="89137-248">Beaucoup de problèmes peuvent survenir si la version de la passerelle est obsolète.</span><span class="sxs-lookup"><span data-stu-id="89137-248">Many issues can surface when the gateway version becomes outdated.</span></span> <span data-ttu-id="89137-249">En règle générale, veillez toujours à utiliser la version la plus récente.</span><span class="sxs-lookup"><span data-stu-id="89137-249">As good general practice, make sure that you use the latest version.</span></span> <span data-ttu-id="89137-250">Si vous n’avez pas mis à jour la passerelle depuis un mois ou plus, vous pouvez installer la dernière version de la passerelle pour vérifier si le problème se reproduit.</span><span class="sxs-lookup"><span data-stu-id="89137-250">If you haven't updated the gateway for a month or longer, you might consider installing the latest version of the gateway, and see if you can reproduce the issue.</span></span>

### <a name="error-failed-to-add-user-to-group--2147463168-pbiegwservice-performance-log-users"></a><span data-ttu-id="89137-251">Erreur : Impossible d’ajouter l’utilisateur au groupe.</span><span class="sxs-lookup"><span data-stu-id="89137-251">Error: Failed to add user to group.</span></span> <span data-ttu-id="89137-252">(-2147463168 PBIEgwService Performance Log Users)</span><span class="sxs-lookup"><span data-stu-id="89137-252">(-2147463168 PBIEgwService Performance Log Users)</span></span>

<span data-ttu-id="89137-253">Cette erreur peut apparaître si vous essayez d’installer la passerelle sur un contrôleur de domaine qui n’est pas pris en charge.</span><span class="sxs-lookup"><span data-stu-id="89137-253">You might get this error if you try to install the gateway on a domain controller, which isn't supported.</span></span> <span data-ttu-id="89137-254">Veillez à déployer la passerelle sur un ordinateur qui n’est pas un contrôleur de domaine.</span><span class="sxs-lookup"><span data-stu-id="89137-254">Make sure that you deploy the gateway on a machine that isn't a domain controller.</span></span>

## <span data-ttu-id="89137-255"><a name="logs"></a>Journaux</span><span class="sxs-lookup"><span data-stu-id="89137-255"><a name="logs"></a>Logs</span></span>

<span data-ttu-id="89137-256">Les fichiers journaux constituent une ressource importante lors du dépannage.</span><span class="sxs-lookup"><span data-stu-id="89137-256">Log files are an important resource when troubleshooting.</span></span>

#### <a name="enterprise-gateway-service-logs"></a><span data-ttu-id="89137-257">Journaux du service de passerelle Enterprise</span><span class="sxs-lookup"><span data-stu-id="89137-257">Enterprise gateway service logs</span></span>

`C:\Users\PBIEgwService\AppData\Local\Microsoft\On-premises data gateway\<yyyyymmdd>.<Number>.log`

#### <a name="configuration-logs"></a><span data-ttu-id="89137-258">Journaux de configuration</span><span class="sxs-lookup"><span data-stu-id="89137-258">Configuration logs</span></span>

`C:\Users\<username>\AppData\Local\Microsoft\On-premises data gateway\GatewayConfigurator.log`




#### <a name="event-logs"></a><span data-ttu-id="89137-259">Journaux d’événements</span><span class="sxs-lookup"><span data-stu-id="89137-259">Event logs</span></span>

<span data-ttu-id="89137-260">Les journaux de passerelle de gestion des données et PowerBIGateway figurent sous **Journaux des applications et services**.</span><span class="sxs-lookup"><span data-stu-id="89137-260">You can find the Data Management Gateway and PowerBIGateway logs under **Application and Services Logs**.</span></span>


## <span data-ttu-id="89137-261"><a name="telemetry"></a>Télémétrie</span><span class="sxs-lookup"><span data-stu-id="89137-261"><a name="telemetry"></a>Telemetry</span></span>
<span data-ttu-id="89137-262">La télémétrie peut être utilisée pour la surveillance et la résolution des problèmes.</span><span class="sxs-lookup"><span data-stu-id="89137-262">Telemetry can be used for monitoring and troubleshooting.</span></span> <span data-ttu-id="89137-263">Par défaut</span><span class="sxs-lookup"><span data-stu-id="89137-263">By default</span></span>

<span data-ttu-id="89137-264">**Pour activer la télémétrie**</span><span class="sxs-lookup"><span data-stu-id="89137-264">**To turn on telemetry**</span></span>

1.  <span data-ttu-id="89137-265">Vérifiez le répertoire client de la passerelle de données sur site sur l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="89137-265">Check the On-premises data gateway client directory on the computer.</span></span> <span data-ttu-id="89137-266">En règle générale, il s’agit de la **passerelle de données %systemdrive%\Program Files\On-premises**.</span><span class="sxs-lookup"><span data-stu-id="89137-266">Typically, it is **%systemdrive%\Program Files\On-premises data gateway**.</span></span> <span data-ttu-id="89137-267">Vous pouvez également ouvrir une console de services et vérifiez le chemin d’accès au fichier exécutable : une propriété du service de passerelle de données sur site.</span><span class="sxs-lookup"><span data-stu-id="89137-267">Or, you can open a Services console and check the Path to executable: A property of the On-premises data gateway service.</span></span>
2.  <span data-ttu-id="89137-268">Dans le fichier Microsoft.PowerBI.DataMovement.Pipeline.GatewayCore.dll.config du répertoire client.</span><span class="sxs-lookup"><span data-stu-id="89137-268">In the Microsoft.PowerBI.DataMovement.Pipeline.GatewayCore.dll.config file from client directory.</span></span> <span data-ttu-id="89137-269">Modifiez le paramètre SendTelemetry sur true.</span><span class="sxs-lookup"><span data-stu-id="89137-269">Change the SendTelemetry setting to true.</span></span>
        
    ```
        <setting name="SendTelemetry" serializeAs="String">
                    <value>true</value>
        </setting>
    ```

3.  <span data-ttu-id="89137-270">Enregistrez vos modifications et redémarrez le service Windows : service de passerelle de données sur site.</span><span class="sxs-lookup"><span data-stu-id="89137-270">Save your changes and restart the Windows service: On-premises data gateway service.</span></span>




## <a name="next-steps"></a><span data-ttu-id="89137-271">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="89137-271">Next steps</span></span>
* [<span data-ttu-id="89137-272">Gérer Analysis Services</span><span class="sxs-lookup"><span data-stu-id="89137-272">Manage Analysis Services</span></span>](analysis-services-manage.md)
* [<span data-ttu-id="89137-273">Obtenir les données d’Azure Analysis Services</span><span class="sxs-lookup"><span data-stu-id="89137-273">Get data from Azure Analysis Services</span></span>](analysis-services-connect.md)
