---
title: les applications web en direct aaaProfiling sur Azure avec Application Insights | Documents Microsoft
description: "Identifier le chemin réactif hello dans votre code de serveur web avec un faible encombrement profileur."
services: application-insights
documentationcenter: 
author: CFreemanwa
manager: carmonm
ms.service: application-insights
ms.workload: tbd
ms.tgt_pltfrm: ibiza
ms.devlang: na
ms.topic: article
ms.date: 05/04/2017
ms.author: bwren
ms.openlocfilehash: 3c7f21076f19335e0f006327932e13623ec9526b
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="profiling-live-azure-web-apps-with-application-insights"></a><span data-ttu-id="17667-103">Profilage des applications web dynamiques Azure avec Application Insights</span><span class="sxs-lookup"><span data-stu-id="17667-103">Profiling live Azure web apps with Application Insights</span></span>

<span data-ttu-id="17667-104">*Cette fonctionnalité d’Application Insights est disponible pour les App Services, et disponible en aperçu pour Compute.*</span><span class="sxs-lookup"><span data-stu-id="17667-104">*This feature of Application Insights is GA for App Services and in preview for Compute.*</span></span>

<span data-ttu-id="17667-105">Découvrez combien de temps passé dans chaque méthode dans votre application web dynamique à l’aide de hello profilage de l’outil de [Azure Application Insights](app-insights-overview.md).</span><span class="sxs-lookup"><span data-stu-id="17667-105">Find out how much time is spent in each method in your live web application by using hello profiling tool of [Azure Application Insights](app-insights-overview.md).</span></span> <span data-ttu-id="17667-106">Il vous montre les profils détaillés d’en direct les demandes qui ont été pris en charge par votre application et met en évidence hello 'chemin réactif » qui est à l’aide de hello essentiel du temps.</span><span class="sxs-lookup"><span data-stu-id="17667-106">It shows you detailed profiles of live requests that were served by your app, and highlights hello 'hot path' that is using hello most time.</span></span> <span data-ttu-id="17667-107">Il sélectionne automatiquement des exemples associés à des temps de réponse différents.</span><span class="sxs-lookup"><span data-stu-id="17667-107">It automatically selects examples that have different response times.</span></span> <span data-ttu-id="17667-108">Générateur de profils Hello utilise la surcharge de toominimize différentes techniques.</span><span class="sxs-lookup"><span data-stu-id="17667-108">hello profiler uses various techniques toominimize overhead.</span></span>

<span data-ttu-id="17667-109">Hello profileur actuellement fonctionne pour ASP.NET web applications qui s’exécutent sur des Services d’application Azure au moins hello Basic niveau tarifaire.</span><span class="sxs-lookup"><span data-stu-id="17667-109">hello profiler currently works for ASP.NET web apps running on Azure App Services, in at least hello Basic pricing tier.</span></span> 

<a id="installation"></a>
## <a name="enable-hello-profiler"></a><span data-ttu-id="17667-110">Activer le Générateur de profils hello</span><span class="sxs-lookup"><span data-stu-id="17667-110">Enable hello profiler</span></span>

<span data-ttu-id="17667-111">[Installez Application Insights](app-insights-asp-net.md) dans votre code.</span><span class="sxs-lookup"><span data-stu-id="17667-111">[Install Application Insights](app-insights-asp-net.md) in your code.</span></span> <span data-ttu-id="17667-112">S’il est déjà installé, assurez-vous que vous avez la version la plus récente hello.</span><span class="sxs-lookup"><span data-stu-id="17667-112">If it's already installed, make sure you have hello latest version.</span></span> <span data-ttu-id="17667-113">(toodo, avec le bouton droit de votre projet dans l’Explorateur de solutions, choisissez Gérer les packages NuGet.</span><span class="sxs-lookup"><span data-stu-id="17667-113">(toodo this, right-click your project in Solution Explorer, and choose Manage NuGet packages.</span></span> <span data-ttu-id="17667-114">Sélectionnez Mises à jour et mettez à jour tous les packages.) Redéployez votre application.</span><span class="sxs-lookup"><span data-stu-id="17667-114">Select Updates and update all packages.) Re-deploy your app.</span></span>

<span data-ttu-id="17667-115">*Vous utilisez ASP.NET Core ? [Cliquez ici](#aspnetcore).*</span><span class="sxs-lookup"><span data-stu-id="17667-115">*Using ASP.NET Core? [Check here](#aspnetcore).*</span></span>

<span data-ttu-id="17667-116">Dans [https://portal.azure.com](https://portal.azure.com), ouvrez la ressource d’Application Insights hello pour votre application web.</span><span class="sxs-lookup"><span data-stu-id="17667-116">In [https://portal.azure.com](https://portal.azure.com), open hello Application Insights resource for your web app.</span></span> <span data-ttu-id="17667-117">Ouvrez **Performances** et cliquez sur **Activer Application Insights Profiler...**.</span><span class="sxs-lookup"><span data-stu-id="17667-117">Open **Performance** and click **Enable Application Insights Profiler...**.</span></span>

![Cliquez sur la bannière de profileur hello activer][enable-profiler-banner]

<span data-ttu-id="17667-119">Ou bien, vous pouvez toujours cliquer sur **configurer** tooview état, activer ou désactiver hello du Générateur de profils.</span><span class="sxs-lookup"><span data-stu-id="17667-119">Alternatively, you can always click **Configure** tooview status, enable, or disable hello Profiler.</span></span>

![Dans le panneau de performances hello, cliquez sur Configurer][performance-blade]

<span data-ttu-id="17667-121">Les applications web configurées avec Application Insights sont listées dans le panneau Configurer.</span><span class="sxs-lookup"><span data-stu-id="17667-121">Web apps that are configured with Application Insights are listed on Configure blade.</span></span> <span data-ttu-id="17667-122">Suivez les instructions tooinstall hello Profiler l’agent si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="17667-122">Follow instructions tooinstall hello Profiler agent if needed.</span></span> <span data-ttu-id="17667-123">Si aucune application web n’est encore configurée avec Application Insights, cliquez sur *Ajouter des applications liées*.</span><span class="sxs-lookup"><span data-stu-id="17667-123">If no web app is configured with Application Insights yet, click *Add Linked Apps*.</span></span>

<span data-ttu-id="17667-124">Hello d’utilisation *activer le Générateur de profils* ou *désactiver le Générateur de profils* boutons dans hello configurer panneau toocontrol hello Profiler sur toutes vos applications web lié.</span><span class="sxs-lookup"><span data-stu-id="17667-124">Use hello *Enable Profiler* or *Disable Profiler* buttons in hello Configure blade toocontrol hello Profiler on all your linked web apps.</span></span>



![Panneau Configurer][linked app services]

<span data-ttu-id="17667-126">profiler hello toostop ou redémarrage d’une instance du Service d’applications individuelles, vous la trouverez **Bonjour ressource du Service d’application**, dans **tâches Web**.</span><span class="sxs-lookup"><span data-stu-id="17667-126">toostop or restart hello profiler for an individual App Service instance, you'll find it **in hello App Service resource**, in **Web Jobs**.</span></span> <span data-ttu-id="17667-127">toodelete il, consultez sous **Extensions**.</span><span class="sxs-lookup"><span data-stu-id="17667-127">toodelete it, look under **Extensions**.</span></span>

![Désactiver le profileur pour des tâches web][disable-profiler-webjob]

<span data-ttu-id="17667-129">Nous vous recommandons d’avoir hello Profiler activé sur tous les toodiscover de vos applications web des performances des problèmes dès que possible.</span><span class="sxs-lookup"><span data-stu-id="17667-129">We recommend that you have hello Profiler enabled on all your web apps toodiscover any performance issues as soon as possible.</span></span>

<span data-ttu-id="17667-130">Si vous utilisez l’application web tooyour WebDeploy toodeploy modifications, vérifiez que vous excluez hello **App_Data** dossier soient supprimés lors du déploiement.</span><span class="sxs-lookup"><span data-stu-id="17667-130">If you use WebDeploy toodeploy changes tooyour web application, ensure that you exclude hello **App_Data** folder from being deleted during deployment.</span></span> <span data-ttu-id="17667-131">Dans le cas contraire, hello les fichiers de l’extension du Générateur de profils sont supprimés lorsque vous déployez ensuite hello web application tooAzure.</span><span class="sxs-lookup"><span data-stu-id="17667-131">Otherwise, hello profiler extension's files will be deleted when you next deploy hello web application tooAzure.</span></span>

### <a name="using-profiler-with-azure-vms-and-compute-resources-preview"></a><span data-ttu-id="17667-132">En utilisant le profileur avec les machines virtuelles Azure et les ressources de calcul (version préliminaire)</span><span class="sxs-lookup"><span data-stu-id="17667-132">Using profiler with Azure VMs and Compute resources (preview)</span></span>

<span data-ttu-id="17667-133">Lorsque vous [activez Application Insights pour les services d’application Azure en cours d’exécution](app-insights-azure-web-apps.md#run-time-instrumentation-with-application-insights), le profileur est automatiquement disponible.</span><span class="sxs-lookup"><span data-stu-id="17667-133">When you [enable Application Insights for Azure app services at run time](app-insights-azure-web-apps.md#run-time-instrumentation-with-application-insights), Profiler is automatically available.</span></span> <span data-ttu-id="17667-134">(Si vous déjà activé l’Application Insights pour la ressource de hello, vous devrez peut-être tooupdate toohello TVA version via hello **configurer** Assistant.)</span><span class="sxs-lookup"><span data-stu-id="17667-134">(If you already enabled Application Insights for hello resource, you might need tooupdate toohello lates version through hello **Configure** wizard.)</span></span>

<span data-ttu-id="17667-135">Il existe un [version d’évaluation de hello du Générateur de profils pour les ressources de calcul Azure](https://go.microsoft.com/fwlink/?linkid=848155).</span><span class="sxs-lookup"><span data-stu-id="17667-135">There is a [preview version of hello Profiler for Azure Compute resources](https://go.microsoft.com/fwlink/?linkid=848155).</span></span>


## <a name="limits"></a><span data-ttu-id="17667-136">limites</span><span class="sxs-lookup"><span data-stu-id="17667-136">Limits</span></span>

<span data-ttu-id="17667-137">rétention des données Hello par défaut est 5 jours.</span><span class="sxs-lookup"><span data-stu-id="17667-137">hello default data retention is 5 days.</span></span> <span data-ttu-id="17667-138">10 Go maximum reçus par jour.</span><span class="sxs-lookup"><span data-stu-id="17667-138">Maximum 10 GB ingested per day.</span></span>

<span data-ttu-id="17667-139">Il n’existe aucun frais pour le service de profil hello.</span><span class="sxs-lookup"><span data-stu-id="17667-139">There is no charge for hello profiler service.</span></span> <span data-ttu-id="17667-140">Votre application web doit être hébergée dans au moins hello niveau de base des Services d’application.</span><span class="sxs-lookup"><span data-stu-id="17667-140">Your web app must be hosted in at least hello Basic tier of App Services.</span></span>

## <a name="viewing-profiler-data"></a><span data-ttu-id="17667-141">Affichage des données du profileur</span><span class="sxs-lookup"><span data-stu-id="17667-141">Viewing profiler data</span></span>

<span data-ttu-id="17667-142">Ouvrez le panneau de performances hello et faites défiler la liste des opérations toohello.</span><span class="sxs-lookup"><span data-stu-id="17667-142">Open hello Performance blade and scroll down toohello operation list.</span></span>




![Colonne Exemples du panneau Performances d’Application Insights][performance-blade-examples]

<span data-ttu-id="17667-144">les colonnes dans la table de hello Hello sont :</span><span class="sxs-lookup"><span data-stu-id="17667-144">hello columns in hello table are:</span></span>

* <span data-ttu-id="17667-145">**Nombre de** -hello nombre de ces requêtes dans la plage de temps hello du Panneau de hello.</span><span class="sxs-lookup"><span data-stu-id="17667-145">**Count** - hello number of these requests in hello time range of hello blade.</span></span>
* <span data-ttu-id="17667-146">**Valeur médiane** -hello classique temps votre application toorespond tooa demande.</span><span class="sxs-lookup"><span data-stu-id="17667-146">**Median** - hello typical time your app takes toorespond tooa request.</span></span> <span data-ttu-id="17667-147">La moitié de toutes les réponses étaient plus rapides que cela.</span><span class="sxs-lookup"><span data-stu-id="17667-147">Half of all responses were faster than this.</span></span>
* <span data-ttu-id="17667-148">**95e centile** : 95 % des réponses étaient plus rapides que cela.</span><span class="sxs-lookup"><span data-stu-id="17667-148">**95th percentile** 95% of responses were faster than this.</span></span> <span data-ttu-id="17667-149">Si ce chiffre est très différent de la valeur médiane de hello, il peut y avoir un problème intermittent avec votre application.</span><span class="sxs-lookup"><span data-stu-id="17667-149">If this figure is very different from hello median, there might be an intermittent problem with your app.</span></span> <span data-ttu-id="17667-150">(Cette différence peut aussi s’expliquer par une fonctionnalité de conception, telle que la mise en cache.)</span><span class="sxs-lookup"><span data-stu-id="17667-150">(Or it might be explained by a design feature such as caching.)</span></span>
* <span data-ttu-id="17667-151">**Exemples** -une icône indique ce profileur hello a capturé les traces de pile pour cette opération.</span><span class="sxs-lookup"><span data-stu-id="17667-151">**Examples** - an icon indicates that hello profiler has captured stack traces for this operation.</span></span>

<span data-ttu-id="17667-152">Cliquez sur Explorateur de la trace hello exemples icône tooopen hello.</span><span class="sxs-lookup"><span data-stu-id="17667-152">Click hello Examples icon tooopen hello trace explorer.</span></span> <span data-ttu-id="17667-153">Hello l’Explorateur affiche plusieurs exemples qui hello du profileur a capturé, classés par temps de réponse.</span><span class="sxs-lookup"><span data-stu-id="17667-153">hello explorer shows several samples that hello profiler has captured, classified by response time.</span></span>

<span data-ttu-id="17667-154">Sélectionnez un tooshow exemple une répartition au niveau du code de temps passé à la demande de hello en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="17667-154">Select a sample tooshow a code-level breakdown of time spent executing hello request.</span></span>

![Explorateur de trace d’Application Insights][trace-explorer]

<span data-ttu-id="17667-156">**Afficher le chemin réactif** s’ouvre hello majeurs nœud terminal ou fermez au moins un problème.</span><span class="sxs-lookup"><span data-stu-id="17667-156">**Show hot path** opens hello biggest leaf node, or at least something close.</span></span> <span data-ttu-id="17667-157">Dans la plupart des cas, ce nœud sera tooa adjacents goulot d’étranglement.</span><span class="sxs-lookup"><span data-stu-id="17667-157">In most cases this node will be adjacent tooa performance bottleneck.</span></span>



* <span data-ttu-id="17667-158">**Étiquette**: nom hello de fonction hello ou un événement.</span><span class="sxs-lookup"><span data-stu-id="17667-158">**Label**: hello name of hello function or event.</span></span> <span data-ttu-id="17667-159">arborescence de Hello affiche une combinaison de code et les événements qui s’est produite (par exemple, les événements SQL et http).</span><span class="sxs-lookup"><span data-stu-id="17667-159">hello tree shows a mix of code and events that occurred (such as SQL and http events).</span></span> <span data-ttu-id="17667-160">les événements supérieur Hello représente hello globale durée de la demande.</span><span class="sxs-lookup"><span data-stu-id="17667-160">hello top event represents hello overall request duration.</span></span>
* <span data-ttu-id="17667-161">**Écoulé**: intervalle de temps hello entre hello opération début de hello et à la fin de hello.</span><span class="sxs-lookup"><span data-stu-id="17667-161">**Elapsed**: hello time interval between hello start of hello operation and hello end.</span></span>
* <span data-ttu-id="17667-162">**Lorsque**: montre lorsque événement de la fonction hello était en cours d’exécution dans les fonctions de tooother de relation.</span><span class="sxs-lookup"><span data-stu-id="17667-162">**When**: Shows when hello function/event was running in relation tooother functions.</span></span>

## <a name="how-tooread-performance-data"></a><span data-ttu-id="17667-163">Comment les données de performances tooread</span><span class="sxs-lookup"><span data-stu-id="17667-163">How tooread performance data</span></span>

<span data-ttu-id="17667-164">Générateur de profils Microsoft service utilise une combinaison d’échantillonnage des performances de hello tooanalyze (méthode) et l’instrumentation de votre application.</span><span class="sxs-lookup"><span data-stu-id="17667-164">Microsoft service profiler uses a combination of sampling method and instrumentation tooanalyze hello performance of your application.</span></span>
<span data-ttu-id="17667-165">Lors de la collection détaillée est en cours d’exécution, profileur service hello pointeur d’instruction de chaque UC de l’ordinateur hello dans toutes les millisecondes.</span><span class="sxs-lookup"><span data-stu-id="17667-165">When detailed collection is in progress, service profiler samples hello instruction pointer of each of hello machine's CPU in every millisecond.</span></span>
<span data-ttu-id="17667-166">Chaque exemple capture la pile des appels complète hello du thread hello actuellement l’exécution, en donnant des informations utiles et détaillées sur les éléments que thread en cours d’exécution sur les deux serveurs haute et basse des niveaux d’abstraction.</span><span class="sxs-lookup"><span data-stu-id="17667-166">Each sample captures hello complete call stack of hello thread currently executing, giving detailed and useful information about what that thread was doing at both high and low levels of abstraction.</span></span> <span data-ttu-id="17667-167">Profileur de service collecte également les autres événements tels que les événements de changement de contexte, des événements de la bibliothèque parallèle de tâches et de corrélation de pool de threads événements tootrack activité et causalité.</span><span class="sxs-lookup"><span data-stu-id="17667-167">Service profiler also collects other events such as context switching events, TPL events, and thread-pool events tootrack activity correlation and causality.</span></span>

<span data-ttu-id="17667-168">pile des appels Hello indiquée dans l’affichage de la chronologie hello est résultat hello Hello au-dessus d’échantillonnage et l’instrumentation.</span><span class="sxs-lookup"><span data-stu-id="17667-168">hello call stack shown in hello timeline view is hello result of hello above sampling and instrumentation.</span></span> <span data-ttu-id="17667-169">Étant donné que chaque exemple capture la pile des appels complète hello du thread de hello, elle inclut du code à partir de hello .NET framework, ainsi que les autres infrastructures que vous faites référence.</span><span class="sxs-lookup"><span data-stu-id="17667-169">Because each sample captures hello complete call stack of hello thread, it includes code from hello .NET framework, as well as other frameworks you reference.</span></span>

### <span data-ttu-id="17667-170"><a id="jitnewobj"></a>Allocation d’objets (`clr!JIT\_New or clr!JIT\_Newarr1`)</span><span class="sxs-lookup"><span data-stu-id="17667-170"><a id="jitnewobj"></a>Object Allocation (`clr!JIT\_New or clr!JIT\_Newarr1`)</span></span>
<span data-ttu-id="17667-171">Les fonctions d’assistance `clr!JIT\_New and clr!JIT\_Newarr1` intégrées au framework .NET allouent la mémoire à partir du segment de mémoire géré.</span><span class="sxs-lookup"><span data-stu-id="17667-171">`clr!JIT\_New and clr!JIT\_Newarr1` are helper functions inside .NET framework that allocates memory from managed heap.</span></span> <span data-ttu-id="17667-172">`clr!JIT\_New` est appelé lorsqu’un objet est alloué.</span><span class="sxs-lookup"><span data-stu-id="17667-172">`clr!JIT\_New` is invoked when an object is allocated.</span></span> <span data-ttu-id="17667-173">`clr!JIT\_Newarr1` est appelé lorsqu’un tableau d’objets est alloué.</span><span class="sxs-lookup"><span data-stu-id="17667-173">`clr!JIT\_Newarr1` is invoked when an object array is allocated.</span></span> <span data-ttu-id="17667-174">Ces deux fonctions sont généralement très rapides et s’exécutent en relativement peu de temps.</span><span class="sxs-lookup"><span data-stu-id="17667-174">These two functions are typically very fast and should take relatively small amount of time.</span></span> <span data-ttu-id="17667-175">Si vous voyez `clr!JIT\_New` ou `clr!JIT\_Newarr1` prendre un certain temps dans votre scénario, il s’agit d’une indication que le code de hello peut-être être allocation d’objets et consomme beaucoup de mémoire.</span><span class="sxs-lookup"><span data-stu-id="17667-175">If you see `clr!JIT\_New` or `clr!JIT\_Newarr1` take a substantial amount of time in your timeline, it's an indication that hello code may be allocating many objects and consuming significant amount of memory.</span></span>

### <span data-ttu-id="17667-176"><a id="theprestub"></a>Code de chargement (`clr!ThePreStub`)</span><span class="sxs-lookup"><span data-stu-id="17667-176"><a id="theprestub"></a>Loading Code (`clr!ThePreStub`)</span></span>
<span data-ttu-id="17667-177">`clr!ThePreStub`est une fonction d’assistance à l’intérieur de .NET framework qui prépare tooexecute de code hello pour hello la première fois.</span><span class="sxs-lookup"><span data-stu-id="17667-177">`clr!ThePreStub` is a helper function inside .NET framework that prepares hello code tooexecute for hello first time.</span></span> <span data-ttu-id="17667-178">Elle implique en général au moins une compilation JIT (juste à temps).</span><span class="sxs-lookup"><span data-stu-id="17667-178">This typically includes, but not limited to, JIT (Just In Time) compilation.</span></span> <span data-ttu-id="17667-179">Pour chaque méthode c#, `clr!ThePreStub` doit être appelé au maximum une fois pendant la durée de vie hello d’un processus.</span><span class="sxs-lookup"><span data-stu-id="17667-179">For each C# method, `clr!ThePreStub` should be invoked at most once during hello lifetime of a process.</span></span>

<span data-ttu-id="17667-180">Si vous voyez `clr!ThePreStub` prend beaucoup de temps pour une demande, il indique cette demande est hello premier celui qui exécute cette méthode et l’heure de hello pour tooload de runtime .NET framework que la méthode est importante.</span><span class="sxs-lookup"><span data-stu-id="17667-180">If you see `clr!ThePreStub` takes significant amount of time for a request, it indicates that request is hello first one that executes that method, and hello time for .NET framework runtime tooload that method is significant.</span></span> <span data-ttu-id="17667-181">Vous pouvez envisager un processus de mise en route qui s’exécute de la partie du code de hello avant que vos utilisateurs y accéder, ou envisagez d’exécuter NGen sur vos assemblys.</span><span class="sxs-lookup"><span data-stu-id="17667-181">You can consider a warm-up process that executes that portion of hello code before your users access it, or consider running NGen on your assemblies.</span></span>

### <span data-ttu-id="17667-182"><a id="lockcontention"></a>Contention de verrouillage (`clr!JITutil\_MonContention` ou `clr!JITutil\_MonEnterWorker`)</span><span class="sxs-lookup"><span data-stu-id="17667-182"><a id="lockcontention"></a>Lock Contention (`clr!JITutil\_MonContention` or `clr!JITutil\_MonEnterWorker`)</span></span>
<span data-ttu-id="17667-183">`clr!JITutil\_MonContention`ou `clr!JITutil\_MonEnterWorker` indiquer le thread en cours de hello est en attente pour un toobe verrou libéré.</span><span class="sxs-lookup"><span data-stu-id="17667-183">`clr!JITutil\_MonContention` or `clr!JITutil\_MonEnterWorker` indicate hello current thread is waiting for a lock toobe released.</span></span> <span data-ttu-id="17667-184">Cela se produit généralement lors de l’exécution d’une instruction lock C#, lors de l’appel de méthode Monitor.Enter, ou encore lors de l’appel d’une méthode avec l’attribut MethodImplOptions.Synchronized.</span><span class="sxs-lookup"><span data-stu-id="17667-184">This typically shows up when executing a C# lock statement, invoking Monitor.Enter method, or invoking a method with MethodImplOptions.Synchronized attribute.</span></span> <span data-ttu-id="17667-185">Contention de verrouillage se produit généralement lorsque le thread A acquiert un verrou, et le thread B tente d’hello tooacquire même verrouiller avant que le thread A le libère.</span><span class="sxs-lookup"><span data-stu-id="17667-185">Lock contention typically happens when thread A acquires a lock, and thread B tries tooacquire hello same lock before thread A releases it.</span></span>

### <span data-ttu-id="17667-186"><a id="ngencold"></a>Code de chargement (`[COLD]`)</span><span class="sxs-lookup"><span data-stu-id="17667-186"><a id="ngencold"></a>Loading code (`[COLD]`)</span></span>
<span data-ttu-id="17667-187">Si le nom de la méthode hello contient `[COLD]`, tel que `mscorlib.ni![COLD]System.Reflection.CustomAttribute.IsDefined`, cela signifie que hello .NET framework runtime exécute le code qui n’est pas optimisé par <a href="https://msdn.microsoft.com/library/e7k32f4k.aspx">l’optimisation guidée par profil</a> pour hello première fois.</span><span class="sxs-lookup"><span data-stu-id="17667-187">If hello method name contains `[COLD]`, such as `mscorlib.ni![COLD]System.Reflection.CustomAttribute.IsDefined`, it means that hello .NET framework runtime is executing code that is not optimized by <a href="https://msdn.microsoft.com/library/e7k32f4k.aspx">profile-guided optimization</a> for hello first time.</span></span> <span data-ttu-id="17667-188">Pour chaque méthode, il doit s’afficher au maximum une fois pendant la durée de vie hello de hello.</span><span class="sxs-lookup"><span data-stu-id="17667-188">For each method, it should show up at most once during hello lifetime of hello process.</span></span>

<span data-ttu-id="17667-189">Si le chargement de code prend beaucoup de temps pour une demande, il indique que cette demande est hello premier tooexecute un hello non optimisée partie de la méthode hello.</span><span class="sxs-lookup"><span data-stu-id="17667-189">If loading code takes significant amount of time for a request, it indicates that request is hello first one tooexecute hello unoptimized portion of hello method.</span></span> <span data-ttu-id="17667-190">Vous pouvez envisager un processus qui exécute cette partie du code de hello avant que vos utilisateurs y accéder de préchauffage.</span><span class="sxs-lookup"><span data-stu-id="17667-190">You can consider a warm up process that executes that portion of hello code before your users access it.</span></span>

### <span data-ttu-id="17667-191"><a id="httpclientsend"></a>Envoyer une requête HTTP</span><span class="sxs-lookup"><span data-stu-id="17667-191"><a id="httpclientsend"></a>Send HTTP Request</span></span>
<span data-ttu-id="17667-192">Les méthodes telles que `HttpClient.Send` indiquent les code hello attend un toocomplete de demande HTTP.</span><span class="sxs-lookup"><span data-stu-id="17667-192">Methods such as `HttpClient.Send` indicate hello code is waiting for a HTTP request toocomplete.</span></span>

### <span data-ttu-id="17667-193"><a id="sqlcommand"></a>Opération de base de données</span><span class="sxs-lookup"><span data-stu-id="17667-193"><a id="sqlcommand"></a>Database Operation</span></span>
<span data-ttu-id="17667-194">Méthode telle que SqlCommand.Execute indique le code de hello est en attente d’un toocomplete d’opération de base de données.</span><span class="sxs-lookup"><span data-stu-id="17667-194">Method such as SqlCommand.Execute indicates hello code is waiting for a database operation toocomplete.</span></span>

### <span data-ttu-id="17667-195"><a id="await"></a>En attente (`AWAIT\_TIME`)</span><span class="sxs-lookup"><span data-stu-id="17667-195"><a id="await"></a>Waiting (`AWAIT\_TIME`)</span></span>
<span data-ttu-id="17667-196">`AWAIT\_TIME`Indique le code de hello est en attente d’une autre tâche toocomplete.</span><span class="sxs-lookup"><span data-stu-id="17667-196">`AWAIT\_TIME` indicates hello code is waiting for another task toocomplete.</span></span> <span data-ttu-id="17667-197">Cela se produit généralement avec l’instruction C# « await ».</span><span class="sxs-lookup"><span data-stu-id="17667-197">This typically happens with C# 'await' statement.</span></span> <span data-ttu-id="17667-198">Lorsque le code de hello ne c# 'await', se déroule hello thread et retourne le contrôle toohello-pool de threads et il n’existe aucun thread est bloqué en attente de toofinish de 'await' hello.</span><span class="sxs-lookup"><span data-stu-id="17667-198">When hello code does a C# 'await', hello thread unwinds and returns control toohello thread-pool, and there is no thread that is blocked waiting for hello 'await' toofinish.</span></span> <span data-ttu-id="17667-199">Toutefois, logiquement hello de thread qu’avez-vous hello await est « bloqué » en attente de hello opération toocomplete.</span><span class="sxs-lookup"><span data-stu-id="17667-199">However, logically hello thread that did hello await is 'blocked' waiting for hello operation toocomplete.</span></span> <span data-ttu-id="17667-200">La `AWAIT\_TIME` indique le temps de hello bloqué en attente de toocomplete de tâche hello.</span><span class="sxs-lookup"><span data-stu-id="17667-200">The `AWAIT\_TIME` indicates hello blocked time waiting for hello task toocomplete.</span></span>

### <span data-ttu-id="17667-201"><a id="block"></a>Temps de blocage</span><span class="sxs-lookup"><span data-stu-id="17667-201"><a id="block"></a>Blocked Time</span></span>
<span data-ttu-id="17667-202">`BLOCKED_TIME`Indique le code de hello est en attente d’un autre toobe de ressources disponible, comme en attente pour un objet de synchronisation, en attente pour un toobe thread disponible, ou en attente pour un toofinish de demande.</span><span class="sxs-lookup"><span data-stu-id="17667-202">`BLOCKED_TIME` indicates hello code is waiting for another resource toobe available, such as waiting for a synchronization object, waiting for a thread toobe available, or waiting for a request toofinish.</span></span>

### <span data-ttu-id="17667-203"><a id="cpu"></a>Temps processeur</span><span class="sxs-lookup"><span data-stu-id="17667-203"><a id="cpu"></a>CPU Time</span></span>
<span data-ttu-id="17667-204">Hello du processeur est occupé à exécuter des instructions de hello.</span><span class="sxs-lookup"><span data-stu-id="17667-204">hello CPU is busy executing hello instructions.</span></span>

### <span data-ttu-id="17667-205"><a id="disk"></a>Temps du disque</span><span class="sxs-lookup"><span data-stu-id="17667-205"><a id="disk"></a>Disk Time</span></span>
<span data-ttu-id="17667-206">application Hello effectue les opérations de disque.</span><span class="sxs-lookup"><span data-stu-id="17667-206">hello application is performing disk operations.</span></span>

### <span data-ttu-id="17667-207"><a id="network"></a>Temps réseau</span><span class="sxs-lookup"><span data-stu-id="17667-207"><a id="network"></a>Network Time</span></span>
<span data-ttu-id="17667-208">application Hello effectue les opérations de réseau.</span><span class="sxs-lookup"><span data-stu-id="17667-208">hello application is performing network operations.</span></span>

### <span data-ttu-id="17667-209"><a id="when"></a>Colonne « When » (Quand)</span><span class="sxs-lookup"><span data-stu-id="17667-209"><a id="when"></a>When column</span></span>
<span data-ttu-id="17667-210">Il s’agit d’une visualisation de la manière dont les échantillons INCLUSIFS hello collectées pour un nœud peuvent varier au fil du temps.</span><span class="sxs-lookup"><span data-stu-id="17667-210">This is a visualization of how hello INCLUSIVE samples collected for a node vary over time.</span></span> <span data-ttu-id="17667-211">Hello total plage de demande de hello est divisée de 32 plages de temps et les échantillons inclusifs les hello pour ce nœud sont accumulent dans les compartiments de 32.</span><span class="sxs-lookup"><span data-stu-id="17667-211">hello total range of hello request is divided into 32 time buckets and hello inclusive samples for that node are accumulated into those 32 buckets.</span></span> <span data-ttu-id="17667-212">Chaque compartiment est ensuite représenté par une barre dont la hauteur reflète une valeur à l’échelle.</span><span class="sxs-lookup"><span data-stu-id="17667-212">Each bucket is then represented as a bar whose height represents a scaled value.</span></span> <span data-ttu-id="17667-213">Pour les nœuds marquées `CPU_TIME` ou `BLOCKED_TIME`, ou s’il existe une relation évidente d’utilisation d’une ressource (UC, disque, de thread), hello barre représente consommant une de ces ressources pour la période hello de compartiment.</span><span class="sxs-lookup"><span data-stu-id="17667-213">For nodes marked `CPU_TIME` or `BLOCKED_TIME`, or where there is an obvious relationship of consuming a resource (cpu, disk, thread), hello bar represents consuming one of those resources for hello period of time of that bucket.</span></span> <span data-ttu-id="17667-214">Pour ces mesures, vous pouvez dépasser le seuil de 100 % en consommant plusieurs ressources.</span><span class="sxs-lookup"><span data-stu-id="17667-214">For these metrics you can get greater than 100% by consuming multiple resources.</span></span> <span data-ttu-id="17667-215">Par exemple, si vous utilisez en moyenne deux processeurs sur un intervalle donné, vous obtenez 200 %.</span><span class="sxs-lookup"><span data-stu-id="17667-215">For example, if on average you use two CPUs over an interval then you get 200%.</span></span>


## <span data-ttu-id="17667-216"><a id="troubleshooting"></a>Résolution des problèmes</span><span class="sxs-lookup"><span data-stu-id="17667-216"><a id="troubleshooting"></a>Troubleshooting</span></span>

### <a name="how-can-i-know-whether-application-insights-profiler-is-running"></a><span data-ttu-id="17667-217">Comment savoir si le profileur d’Application Insights est en cours d’exécution ?</span><span class="sxs-lookup"><span data-stu-id="17667-217">How can I know whether Application Insights profiler is running?</span></span>

<span data-ttu-id="17667-218">Générateur de profils Hello s’exécute comme une tâche web continue dans l’application Web.</span><span class="sxs-lookup"><span data-stu-id="17667-218">hello profiler runs as a continuous web job in Web App.</span></span> <span data-ttu-id="17667-219">Vous pouvez ouvrir des ressources d’application Web hello dans https://portal.azure.com et vérifier l’état « ApplicationInsightsProfiler » dans le panneau des tâches Web hello.</span><span class="sxs-lookup"><span data-stu-id="17667-219">You can open hello Web App resource in https://portal.azure.com and check "ApplicationInsightsProfiler" status in hello WebJobs blade.</span></span> <span data-ttu-id="17667-220">Si elle n’est pas en cours d’exécution, ouvrez **journaux** toofind plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="17667-220">If it isn't running, open **Logs** toofind out more.</span></span>

### <a name="why-cant-i-find-any-stack-examples-even-though-hello-profiler-is-running"></a><span data-ttu-id="17667-221">Je ne trouve pas les exemples de pile même si le Générateur de profils hello est en cours d’exécution ?</span><span class="sxs-lookup"><span data-stu-id="17667-221">Why can't I find any stack examples even though hello profiler is running?</span></span>

<span data-ttu-id="17667-222">Vous pouvez vérifier plusieurs points.</span><span class="sxs-lookup"><span data-stu-id="17667-222">Here are a few things you can check.</span></span>

1. <span data-ttu-id="17667-223">Assurez-vous que votre plan Web App Service est au moins au niveau tarifaire De base.</span><span class="sxs-lookup"><span data-stu-id="17667-223">Make sure your Web App Service Plan is Basic tier and above.</span></span>
2. <span data-ttu-id="17667-224">Assurez-vous que le SDK Application Insights 2.2 Bêta ou version supérieure est activé sur votre application web.</span><span class="sxs-lookup"><span data-stu-id="17667-224">Make sure your Web App has Application Insights SDK 2.2 Beta and above enabled.</span></span>
3. <span data-ttu-id="17667-225">Assurez-vous que votre application Web a le paramètre hello APPINSIGHTS_INSTRUMENTATIONKEY hello utilisé de la même clé d’instrumentation par Application Insights SDK.</span><span class="sxs-lookup"><span data-stu-id="17667-225">Make sure your Web App has hello APPINSIGHTS_INSTRUMENTATIONKEY setting with hello same instrumentation key used by Application Insights SDK.</span></span>
4. <span data-ttu-id="17667-226">Assurez-vous que votre application web s’exécute sur .Net Framework 4.6.</span><span class="sxs-lookup"><span data-stu-id="17667-226">Make sure your Web App is running on .Net Framework 4.6.</span></span>
5. <span data-ttu-id="17667-227">S’il est une application ASP.NET Core, également vérifier [hello les dépendances requises](#aspnetcore).</span><span class="sxs-lookup"><span data-stu-id="17667-227">If it's an ASP.NET Core application, please also check [hello required dependencies](#aspnetcore).</span></span>

<span data-ttu-id="17667-228">Après le démarrage du Générateur de profils hello, il existe une période de préchauffage court lorsque le Générateur de profils hello activement pour collecter les traces de performances plusieurs.</span><span class="sxs-lookup"><span data-stu-id="17667-228">After hello profiler is started, there is a short warm-up period when hello profiler actively collects several performance traces.</span></span> <span data-ttu-id="17667-229">Après cela, Générateur de profils hello collecte des traces de performances pendant deux minutes dans toutes les heures.</span><span class="sxs-lookup"><span data-stu-id="17667-229">After that, hello profiler collects performance traces for two minutes in every hour.</span></span>  

### <a name="i-was-using-azure-service-profiler-what-happened-tooit"></a><span data-ttu-id="17667-230">J’utilisais avant l’agent Azure Service Profiler.</span><span class="sxs-lookup"><span data-stu-id="17667-230">I was using Azure Service Profiler.</span></span> <span data-ttu-id="17667-231">Quelles tooit s’est produit ?</span><span class="sxs-lookup"><span data-stu-id="17667-231">What happened tooit?</span></span>  

<span data-ttu-id="17667-232">Lorsque vous activez le profileur d’Application Insights, l’agent Azure Service Profiler est désactivé.</span><span class="sxs-lookup"><span data-stu-id="17667-232">When you enable Application Insights Profiler, Azure Service Profiler agent is disabled.</span></span>

### <span data-ttu-id="17667-233"><a id="double-counting"></a>Double comptage dans des threads parallèles</span><span class="sxs-lookup"><span data-stu-id="17667-233"><a id="double-counting"></a>Double counting in parallel threads</span></span>

<span data-ttu-id="17667-234">Dans certains hello cas métrique de temps total dans la visionneuse de pile hello est supérieure à la durée réelle de hello de demande de hello.</span><span class="sxs-lookup"><span data-stu-id="17667-234">In some cases hello total time metric in hello stack viewer is more than hello actual duration of hello request.</span></span>

<span data-ttu-id="17667-235">Cela peut se produire lorsque deux threads au moins sont associés à une requête et qu’ils s’exécutent en parallèle.</span><span class="sxs-lookup"><span data-stu-id="17667-235">This can happen when there are two or more threads associated with a request, operating in parallel.</span></span> <span data-ttu-id="17667-236">temps total de threads de Hello est alors plus de temps écoulé de hello.</span><span class="sxs-lookup"><span data-stu-id="17667-236">hello total thread time is then more than hello elapsed time.</span></span> <span data-ttu-id="17667-237">Dans de nombreux cas, un thread peut être en attente sur hello autres toocomplete.</span><span class="sxs-lookup"><span data-stu-id="17667-237">In many cases one thread may be waiting on hello other toocomplete.</span></span> <span data-ttu-id="17667-238">Hello visionneuse tentatives toodetect cela et omettre les attente inintéressants hello, mais pêche par excès côté hello de l’affichage trop plutôt que l’omission de ce qui peut être informations critiques.</span><span class="sxs-lookup"><span data-stu-id="17667-238">hello viewer tries toodetect this and omit hello uninteresting wait, but errs on hello side of showing too much rather than omitting what may be critical information.</span></span>  

<span data-ttu-id="17667-239">Lorsque vous voyez des threads parallèles dans vos traces, vous devez toodetermine threads en attente afin de déterminer le chemin d’accès critique de hello pour demande de hello.</span><span class="sxs-lookup"><span data-stu-id="17667-239">When you see parallel threads in your traces, you need toodetermine which threads are waiting so you can determine hello critical path for hello request.</span></span> <span data-ttu-id="17667-240">Dans la plupart des cas, le thread hello rapidement passe en état d’attente en attente simplement sur hello autres threads.</span><span class="sxs-lookup"><span data-stu-id="17667-240">In most cases, hello thread that quickly goes into a wait state is simply waiting on hello other threads.</span></span> <span data-ttu-id="17667-241">Se concentrer sur d’autres hello et ignorer les temps hello dans les threads en attente hello.</span><span class="sxs-lookup"><span data-stu-id="17667-241">Concentrate on hello others and ignore hello time in hello waiting threads.</span></span>

### <span data-ttu-id="17667-242"><a id="issue-loading-trace-in-viewer"></a>Aucune donnée de profilage</span><span class="sxs-lookup"><span data-stu-id="17667-242"><a id="issue-loading-trace-in-viewer"></a>No profiling data</span></span>

1. <span data-ttu-id="17667-243">Si les données de salutation que vous essayez tooview est antérieure à deux semaines, essayez de limiter votre filtre de temps, puis réessayez.</span><span class="sxs-lookup"><span data-stu-id="17667-243">If hello data you are trying tooview is older than a couple of weeks, try limiting your time filter and try again.</span></span>

2. <span data-ttu-id="17667-244">Vérifiez que l’accès toohttps://gateway.azureserviceprofiler.net n’ont pas bloqué par un pare-feu ou proxy.</span><span class="sxs-lookup"><span data-stu-id="17667-244">Check that proxies or a firewall have not blocked access toohttps://gateway.azureserviceprofiler.net.</span></span>

3. <span data-ttu-id="17667-245">Vérifiez que hello Application Insights, vous utilisez dans votre application clé d’instrumentation est même hello en tant que ressource Application Insights vous avez activé le profilage à l’aide de hello.</span><span class="sxs-lookup"><span data-stu-id="17667-245">Check that hello Application Insights instrumentation key you are using in your app is hello same as hello Application Insights resource you've enabled profiling with.</span></span> <span data-ttu-id="17667-246">clé de Hello est généralement dans ApplicationInsights.config, mais il peut également être trouvé dans le fichier web.config ou app.config.</span><span class="sxs-lookup"><span data-stu-id="17667-246">hello key is usually in ApplicationInsights.config but can also be found in web.config or app.config.</span></span>

### <a name="error-report-in-hello-profiling-viewer"></a><span data-ttu-id="17667-247">Rapport d’erreurs de hello visionneuse de profilage</span><span class="sxs-lookup"><span data-stu-id="17667-247">Error report in hello profiling viewer</span></span>

<span data-ttu-id="17667-248">Un ticket de support à partir du portail de hello du fichier.</span><span class="sxs-lookup"><span data-stu-id="17667-248">File a support ticket from hello portal.</span></span> <span data-ttu-id="17667-249">Veuillez inclure hello les ID de corrélation du message d’erreur hello.</span><span class="sxs-lookup"><span data-stu-id="17667-249">Please include hello correlation ID from hello error message.</span></span>

## <a name="manual-installation"></a><span data-ttu-id="17667-250">Installation manuelle</span><span class="sxs-lookup"><span data-stu-id="17667-250">Manual installation</span></span>

<span data-ttu-id="17667-251">Lorsque vous configurez le Générateur de profils hello, hello suivantes sont mises à jour les paramètres de l’application toohello Web.</span><span class="sxs-lookup"><span data-stu-id="17667-251">When you configure hello profiler, hello following updates are made toohello Web App's settings.</span></span> <span data-ttu-id="17667-252">Vous pouvez les effectuer manuellement par vous-même si votre environnement le requiert, par exemple, si votre application s’exécute dans l’environnement Azure App Service (ASE) :</span><span class="sxs-lookup"><span data-stu-id="17667-252">You can do them yourself manually if your environment requires, for example, if your application runs in Azure App Service Environment (ASE):</span></span>

1. <span data-ttu-id="17667-253">Dans le panneau de contrôle web application hello, ouvrez les paramètres.</span><span class="sxs-lookup"><span data-stu-id="17667-253">In hello web app control blade, open Settings.</span></span>
2. <span data-ttu-id="17667-254">Définissez « .net Framework version « toov4.6.</span><span class="sxs-lookup"><span data-stu-id="17667-254">Set ".Net Framework version" toov4.6.</span></span>
3. <span data-ttu-id="17667-255">Définissez tooOn « Always On ».</span><span class="sxs-lookup"><span data-stu-id="17667-255">Set "Always On" tooOn.</span></span>
4. <span data-ttu-id="17667-256">Ajouter le paramètre d’application «__APPINSIGHTS_INSTRUMENTATIONKEY__» et le jeu hello valeur toohello même clé d’instrumentation utilisé par hello SDK.</span><span class="sxs-lookup"><span data-stu-id="17667-256">Add app setting "__APPINSIGHTS_INSTRUMENTATIONKEY__" and set hello value toohello same instrumentation key used by hello SDK.</span></span>
5. <span data-ttu-id="17667-257">Ouvrez Outils avancés.</span><span class="sxs-lookup"><span data-stu-id="17667-257">Open Advanced Tools.</span></span>
6. <span data-ttu-id="17667-258">Cliquez sur « Go » tooopen hello Kudu site Web.</span><span class="sxs-lookup"><span data-stu-id="17667-258">Click "Go" tooopen hello Kudu website.</span></span>
7. <span data-ttu-id="17667-259">Dans le site Web de Kudu hello, sélectionnez « Extensions de Site ».</span><span class="sxs-lookup"><span data-stu-id="17667-259">In hello Kudu website, select "Site extensions".</span></span>
8. <span data-ttu-id="17667-260">Installez « __Application Insights__ »à partir de la galerie.</span><span class="sxs-lookup"><span data-stu-id="17667-260">Install "__Application Insights__" from Gallery.</span></span>
9. <span data-ttu-id="17667-261">Redémarrage de l’application web de hello.</span><span class="sxs-lookup"><span data-stu-id="17667-261">Restart hello web app.</span></span>

## <span data-ttu-id="17667-262"><a id="aspnetcore"></a>Prise en charge d’ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="17667-262"><a id="aspnetcore"></a>ASP.NET Core Support</span></span>

<span data-ttu-id="17667-263">Application ASP.NET Core doit tooinstall 2.1.0-beta6 de package Nuget de Microsoft.ApplicationInsights.AspNetCore ou supérieur toowork avec hello du Générateur de profils.</span><span class="sxs-lookup"><span data-stu-id="17667-263">ASP.NET Core application needs tooinstall Microsoft.ApplicationInsights.AspNetCore Nuget package 2.1.0-beta6 or higher toowork with hello Profiler.</span></span> <span data-ttu-id="17667-264">Nous n’est plus en charge les versions inférieures hello après 6/27/2017.</span><span class="sxs-lookup"><span data-stu-id="17667-264">We no longer support hello lower versions after 6/27/2017.</span></span>

## <a name="next-steps"></a><span data-ttu-id="17667-265">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="17667-265">Next steps</span></span>

* [<span data-ttu-id="17667-266">Utilisation d’Application Insights dans Visual Studio</span><span class="sxs-lookup"><span data-stu-id="17667-266">Working with Application Insights in Visual Studio</span></span>](https://docs.microsoft.com/azure/application-insights/app-insights-visual-studio)

[performance-blade]: ./media/app-insights-profiler/performance-blade.png
[performance-blade-examples]: ./media/app-insights-profiler/performance-blade-examples.png
[trace-explorer]: ./media/app-insights-profiler/trace-explorer.png
[trace-explorer-toolbar]: ./media/app-insights-profiler/trace-explorer-toolbar.png
[trace-explorer-hint-tip]: ./media/app-insights-profiler/trace-explorer-hint-tip.png
[trace-explorer-hot-path]: ./media/app-insights-profiler/trace-explorer-hot-path.png
[enable-profiler-banner]: ./media/app-insights-profiler/enable-profiler-banner.png
[disable-profiler-webjob]: ./media/app-insights-profiler/disable-profiler-webjob.png
[linked app services]: ./media/app-insights-profiler/linked-app-services.png
