---
title: "Analyse de la disponibilité et de la réactivité d’un site Web | Microsoft Docs"
description: "Configurez des tests web dans Application Insights. Recevez des alertes si un site web devient indisponible ou répond lentement."
services: application-insights
documentationcenter: 
author: SoubhagyaDash
manager: carmonm
ms.assetid: 46dc13b4-eb2e-4142-a21c-94a156f760ee
ms.service: application-insights
ms.workload: tbd
ms.tgt_pltfrm: ibiza
ms.devlang: na
ms.topic: get-started-article
ms.date: 05/25/2017
ms.author: bwren
ms.openlocfilehash: 6c7f52fc3998b0b29301206ffbc6a5a0c4134f6a
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/18/2017
---
# <a name="monitor-availability-and-responsiveness-of-any-web-site"></a><span data-ttu-id="61bf5-104">Analyse de la disponibilité et de la réactivité d'un site Web</span><span class="sxs-lookup"><span data-stu-id="61bf5-104">Monitor availability and responsiveness of any web site</span></span>
<span data-ttu-id="61bf5-105">Après avoir déployé votre application web ou votre site web sur un serveur, vous pouvez configurer des tests pour surveiller sa disponibilité et sa réactivité.</span><span class="sxs-lookup"><span data-stu-id="61bf5-105">After you've deployed your web app or web site to any server, you can set up tests to monitor its availability and responsiveness.</span></span> <span data-ttu-id="61bf5-106">[Azure Application Insights](app-insights-overview.md) envoie des requêtes web à votre application à intervalles réguliers à partir de différents points du monde,</span><span class="sxs-lookup"><span data-stu-id="61bf5-106">[Azure Application Insights](app-insights-overview.md) sends web requests to your application at regular intervals from points around the world.</span></span> <span data-ttu-id="61bf5-107">et vous alerte si votre application réagit lentement ou pas du tout.</span><span class="sxs-lookup"><span data-stu-id="61bf5-107">It alerts you if your application doesn't respond, or responds slowly.</span></span>

<span data-ttu-id="61bf5-108">Vous pouvez configurer des tests de disponibilité pour n’importe quel point de terminaison HTTP ou HTTPS accessible à partir du réseau Internet public.</span><span class="sxs-lookup"><span data-stu-id="61bf5-108">You can set up availability tests for any HTTP or HTTPS endpoint that is accessible from the public internet.</span></span> <span data-ttu-id="61bf5-109">Vous n’avez rien à ajouter au site web que vous testez.</span><span class="sxs-lookup"><span data-stu-id="61bf5-109">You don't have to add anything to the web site you're testing.</span></span> <span data-ttu-id="61bf5-110">Il ne faut pas nécessairement qu’il s’agisse de votre site : vous pouvez tester un service API REST dont vous dépendez.</span><span class="sxs-lookup"><span data-stu-id="61bf5-110">It doesn't even have to be your site: you could test a REST API service on which you depend.</span></span>

<span data-ttu-id="61bf5-111">Il existe deux types de tests de disponibilité :</span><span class="sxs-lookup"><span data-stu-id="61bf5-111">There are two types of availability tests:</span></span>

* <span data-ttu-id="61bf5-112">[Test ping d’URL](#create): un test simple que vous pouvez créer dans le portail Azure.</span><span class="sxs-lookup"><span data-stu-id="61bf5-112">[URL ping test](#create): a simple test that you can create in the Azure portal.</span></span>
* <span data-ttu-id="61bf5-113">[Test web multi-étapes](#multi-step-web-tests) : que vous créez dans Visual Studio Enterprise et que vous chargez sur le portail.</span><span class="sxs-lookup"><span data-stu-id="61bf5-113">[Multi-step web test](#multi-step-web-tests): which you create in Visual Studio Enterprise and upload to the portal.</span></span>

<span data-ttu-id="61bf5-114">Vous pouvez créer jusqu’à 25 tests de disponibilité par ressource d’application.</span><span class="sxs-lookup"><span data-stu-id="61bf5-114">You can create up to 25 availability tests per application resource.</span></span>

## <span data-ttu-id="61bf5-115"><a name="create"></a>1. Ouvrir une ressource pour vos rapports de test de disponibilité</span><span class="sxs-lookup"><span data-stu-id="61bf5-115"><a name="create"></a>1. Open a resource for your availability test reports</span></span>

<span data-ttu-id="61bf5-116">**Si vous avez déjà configuré Application Insights** pour votre application web, ouvrez sa ressource Application Insights dans le [portail Azure](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="61bf5-116">**If you have already configured Application Insights** for your web app, open its Application Insights resource in the [Azure portal](https://portal.azure.com).</span></span>

<span data-ttu-id="61bf5-117">**Ou, si vous souhaitez visualiser vos rapports dans une nouvelle ressource,** inscrivez-vous à [Microsoft Azure](http://azure.com), accédez au [portail Azure](https://portal.azure.com) et créez une ressource Application Insights.</span><span class="sxs-lookup"><span data-stu-id="61bf5-117">**Or, if you want to see your reports in a new resource,** sign up to [Microsoft Azure](http://azure.com), go to the [Azure portal](https://portal.azure.com), and create an Application Insights resource.</span></span>

![New > Application Insights](./media/app-insights-monitor-web-app-availability/11-new-app.png)

<span data-ttu-id="61bf5-119">Cliquez sur **Toutes les ressources** pour ouvrir le panneau Vue d’ensemble de la nouvelle ressource.</span><span class="sxs-lookup"><span data-stu-id="61bf5-119">Click **All resources** to open the Overview blade for the new resource.</span></span>

## <span data-ttu-id="61bf5-120"><a name="setup"></a>2. Créer un test Ping d’URL</span><span class="sxs-lookup"><span data-stu-id="61bf5-120"><a name="setup"></a>2. Create a URL ping test</span></span>
<span data-ttu-id="61bf5-121">Ouvrez le panneau de disponibilité et ajoutez un test.</span><span class="sxs-lookup"><span data-stu-id="61bf5-121">Open the Availability blade and add a test.</span></span>

![Fill at least the URL of your website](./media/app-insights-monitor-web-app-availability/13-availability.png)

* <span data-ttu-id="61bf5-123">**L’URL** peut être n’importe quelle page web que vous souhaitez tester, mais elle doit être visible à partir de l’Internet public.</span><span class="sxs-lookup"><span data-stu-id="61bf5-123">**The URL** can be any web page you want to test, but it must be visible from the public internet.</span></span> <span data-ttu-id="61bf5-124">L’URL peut contenir une chaîne de requête.</span><span class="sxs-lookup"><span data-stu-id="61bf5-124">The URL can include a query string.</span></span> <span data-ttu-id="61bf5-125">Vous pouvez donc, par exemple, tester un peu votre base de données.</span><span class="sxs-lookup"><span data-stu-id="61bf5-125">So, for example, you can exercise your database a little.</span></span> <span data-ttu-id="61bf5-126">Si l’URL correspond à une redirection, nous allons la suivre, jusqu’à 10 redirections.</span><span class="sxs-lookup"><span data-stu-id="61bf5-126">If the URL resolves to a redirect, we follow it up to 10 redirects.</span></span>
* <span data-ttu-id="61bf5-127">**Analyser les demandes dépendantes** : si cette option est activée, le test demande des images, des scripts, des fichiers de style et d’autres fichiers qui font partie de la page web de test.</span><span class="sxs-lookup"><span data-stu-id="61bf5-127">**Parse dependent requests**: If this option is checked, the test requests images, scripts, style files, and other files that are part of the web page under test.</span></span> <span data-ttu-id="61bf5-128">Le temps de réponse enregistré inclut le temps qui a été nécessaire pour obtenir ces fichiers.</span><span class="sxs-lookup"><span data-stu-id="61bf5-128">The recorded response time includes the time taken to get these files.</span></span> <span data-ttu-id="61bf5-129">Le test échoue si toutes ces ressources ne peuvent pas être téléchargées avec succès dans le délai imparti pour l’ensemble du test.</span><span class="sxs-lookup"><span data-stu-id="61bf5-129">The test fails if all these resources cannot be successfully downloaded within the timeout for the whole test.</span></span> 

    <span data-ttu-id="61bf5-130">Si l’option n’est pas cochée, le test ne demande que le fichier à l’URL spécifiée.</span><span class="sxs-lookup"><span data-stu-id="61bf5-130">If the option is not checked, the test only requests the file at the URL you specified.</span></span>
* <span data-ttu-id="61bf5-131">**Autoriser de nouvelles tentatives**: si cette option est cochée, une nouvelle tentative de test sera effectuée après un court intervalle en cas d’échec du test.</span><span class="sxs-lookup"><span data-stu-id="61bf5-131">**Enable retries**:  If this option is checked, when the test fails, it is retried after a short interval.</span></span> <span data-ttu-id="61bf5-132">L’échec est signalé uniquement après trois tentatives infructueuses.</span><span class="sxs-lookup"><span data-stu-id="61bf5-132">A failure is reported only if three successive attempts fail.</span></span> <span data-ttu-id="61bf5-133">Les tests suivants sont ensuite effectués selon la fréquence de test habituelle.</span><span class="sxs-lookup"><span data-stu-id="61bf5-133">Subsequent tests are then performed at the usual test frequency.</span></span> <span data-ttu-id="61bf5-134">La nouvelle tentative est temporairement suspendue jusqu’à la réussite de la tentative suivante.</span><span class="sxs-lookup"><span data-stu-id="61bf5-134">Retry is temporarily suspended until the next success.</span></span> <span data-ttu-id="61bf5-135">Cette règle est appliquée indépendamment à chaque emplacement de test.</span><span class="sxs-lookup"><span data-stu-id="61bf5-135">This rule is applied independently at each test location.</span></span> <span data-ttu-id="61bf5-136">Nous recommandons cette option.</span><span class="sxs-lookup"><span data-stu-id="61bf5-136">We recommend this option.</span></span> <span data-ttu-id="61bf5-137">En moyenne, environ 80 % des échecs disparaissent lors de la nouvelle tentative.</span><span class="sxs-lookup"><span data-stu-id="61bf5-137">On average, about 80% of failures disappear on retry.</span></span>
* <span data-ttu-id="61bf5-138">**Fréquence de test**: définit la fréquence selon laquelle le test est exécuté à partir de chaque emplacement de test.</span><span class="sxs-lookup"><span data-stu-id="61bf5-138">**Test frequency**: Sets how often the test is run from each test location.</span></span> <span data-ttu-id="61bf5-139">Avec une fréquence de 5 minutes et 5 emplacements de test, votre site sera testé en moyenne une fois par minute.</span><span class="sxs-lookup"><span data-stu-id="61bf5-139">With a frequency of five minutes and five test locations, your site is tested on average every minute.</span></span>
* <span data-ttu-id="61bf5-140">**emplacements de test** sont les lieux d’où nos serveurs envoient des requêtes web à votre URL.</span><span class="sxs-lookup"><span data-stu-id="61bf5-140">**Test locations** are the places from where our servers send web requests to your URL.</span></span> <span data-ttu-id="61bf5-141">Choisissez-en plusieurs de façon à distinguer les problèmes de votre site web des problèmes de réseau.</span><span class="sxs-lookup"><span data-stu-id="61bf5-141">Choose more than one so that you can distinguish problems in your website from network issues.</span></span> <span data-ttu-id="61bf5-142">Vous pouvez sélectionner jusqu’à 16 emplacements.</span><span class="sxs-lookup"><span data-stu-id="61bf5-142">You can select up to 16 locations.</span></span>
* <span data-ttu-id="61bf5-143">**Critères de réussite**:</span><span class="sxs-lookup"><span data-stu-id="61bf5-143">**Success criteria**:</span></span>

    <span data-ttu-id="61bf5-144">**Délai d’expiration de test**: diminuez cette valeur pour être averti des réponses lentes.</span><span class="sxs-lookup"><span data-stu-id="61bf5-144">**Test timeout**: Decrease this value to be alerted about slow responses.</span></span> <span data-ttu-id="61bf5-145">Le test est compté comme une erreur si des réponses de votre site n’ont pas été reçues pendant cette période.</span><span class="sxs-lookup"><span data-stu-id="61bf5-145">The test is counted as a failure if the responses from your site have not been received within this period.</span></span> <span data-ttu-id="61bf5-146">Si vous avez sélectionné **Analyser les demandes dépendantes**, l’ensemble des images, fichiers de style, scripts et autres ressources dépendantes ont dû être reçus pendant cette période.</span><span class="sxs-lookup"><span data-stu-id="61bf5-146">If you selected **Parse dependent requests**, then all the images, style files, scripts, and other dependent resources must have been received within this period.</span></span>

    <span data-ttu-id="61bf5-147">**Réponse HTTP**: le code d’état retourné est comptabilisé comme un succès.</span><span class="sxs-lookup"><span data-stu-id="61bf5-147">**HTTP response**: The returned status code that is counted as a success.</span></span> <span data-ttu-id="61bf5-148">200 est le code qui indique qu’une page web normale a été retournée.</span><span class="sxs-lookup"><span data-stu-id="61bf5-148">200 is the code that indicates that a normal web page has been returned.</span></span>

    <span data-ttu-id="61bf5-149">**Correspondance de contenu**: une chaîne telle que « Bienvenue !</span><span class="sxs-lookup"><span data-stu-id="61bf5-149">**Content match**: a string, like "Welcome!"</span></span> <span data-ttu-id="61bf5-150">Nous vérifions qu’une correspondance exacte respectant la casse est présente dans chaque réponse.</span><span class="sxs-lookup"><span data-stu-id="61bf5-150">We test that an exact case-sensitive match occurs in every response.</span></span> <span data-ttu-id="61bf5-151">Il doit s'agir d'une chaîne standard sans caractère générique.</span><span class="sxs-lookup"><span data-stu-id="61bf5-151">It must be a plain string, without wildcards.</span></span> <span data-ttu-id="61bf5-152">N'oubliez pas que si votre contenu change, vous devrez peut-être l'actualiser.</span><span class="sxs-lookup"><span data-stu-id="61bf5-152">Don't forget that if your page content changes you might have to update it.</span></span>
* <span data-ttu-id="61bf5-153">Des **alertes** vous sont envoyées par défaut, en cas de défaillance dans trois emplacements en cinq minutes.</span><span class="sxs-lookup"><span data-stu-id="61bf5-153">**Alerts** are, by default, sent to you if there are failures in three locations over five minutes.</span></span> <span data-ttu-id="61bf5-154">Une défaillance dans un emplacement est susceptible d’être un problème réseau et non un problème relatif à votre site.</span><span class="sxs-lookup"><span data-stu-id="61bf5-154">A failure in one location is likely to be a network problem, and not a problem with your site.</span></span> <span data-ttu-id="61bf5-155">Cependant, vous pouvez modifier le seuil de manière à ce qu’il soit plus ou moins sensible. Vous pouvez également modifier les destinataires des courriers électroniques.</span><span class="sxs-lookup"><span data-stu-id="61bf5-155">But you can change the threshold to be more or less sensitive, and you can also change who the emails should be sent to.</span></span>

    <span data-ttu-id="61bf5-156">Vous pouvez configurer un [webhook](../monitoring-and-diagnostics/insights-webhooks-alerts.md) qui est appelé lorsqu’une alerte est déclenchée.</span><span class="sxs-lookup"><span data-stu-id="61bf5-156">You can set up a [webhook](../monitoring-and-diagnostics/insights-webhooks-alerts.md) that is called when an alert is raised.</span></span> <span data-ttu-id="61bf5-157">(Mais notez qu’à l’heure actuelle, les paramètres de requête ne sont pas transmis en tant que propriétés.)</span><span class="sxs-lookup"><span data-stu-id="61bf5-157">(But note that, at present, query parameters are not passed through as Properties.)</span></span>

### <a name="test-more-urls"></a><span data-ttu-id="61bf5-158">Test d'autres URL</span><span class="sxs-lookup"><span data-stu-id="61bf5-158">Test more URLs</span></span>
<span data-ttu-id="61bf5-159">Ajoutez d’autres tests.</span><span class="sxs-lookup"><span data-stu-id="61bf5-159">Add more tests.</span></span> <span data-ttu-id="61bf5-160">Exemple : outre le test de votre page d’accueil, vous pouvez vérifier que votre base de données fonctionne correctement en testant une recherche sur l’URL.</span><span class="sxs-lookup"><span data-stu-id="61bf5-160">For example, In addition to testing your home page, you can make sure your database is running by testing the URL for a search.</span></span>


## <span data-ttu-id="61bf5-161"><a name="monitor"></a>3. Consulter les résultats des tests de disponibilité</span><span class="sxs-lookup"><span data-stu-id="61bf5-161"><a name="monitor"></a>3. See your availability test results</span></span>

<span data-ttu-id="61bf5-162">Au bout de quelques minutes, cliquez sur **Actualiser** pour afficher les résultats de test.</span><span class="sxs-lookup"><span data-stu-id="61bf5-162">After a few minutes, click **Refresh** to see test results.</span></span> 

![Summary results on the home blade](./media/app-insights-monitor-web-app-availability/14-availSummary-3.png)

<span data-ttu-id="61bf5-164">Le nuage de points montre des exemples de résultats de test contenant des détails de l’étape de test de diagnostic.</span><span class="sxs-lookup"><span data-stu-id="61bf5-164">The scatterplot shows samples of the test results that have diagnostic test-step detail in them.</span></span> <span data-ttu-id="61bf5-165">Le moteur de test stocke les détails de diagnostic pour les tests qui présentent des erreurs.</span><span class="sxs-lookup"><span data-stu-id="61bf5-165">The test engine stores diagnostic detail for tests that have failures.</span></span> <span data-ttu-id="61bf5-166">Pour les tests réussis, les détails de diagnostic sont stockés pour un sous-ensemble des exécutions.</span><span class="sxs-lookup"><span data-stu-id="61bf5-166">For successful tests, diagnostic details are stored for a subset of the executions.</span></span> <span data-ttu-id="61bf5-167">Pointez sur les points verts/rouges pour voir l’horodatage, la durée, l’emplacement et le nom du test.</span><span class="sxs-lookup"><span data-stu-id="61bf5-167">Hover over any of the green/red dots to see the test timestamp, test duration, location, and test name.</span></span> <span data-ttu-id="61bf5-168">Cliquez sur n’importe quel point dans le nuage de points pour afficher les détails du résultat de test.</span><span class="sxs-lookup"><span data-stu-id="61bf5-168">Click through any dot in the scatter plot to see the details of the test result.</span></span>  

<span data-ttu-id="61bf5-169">Sélectionnez un test ou emplacement spécifique, ou réduisez la période de temps pour voir plus de résultats autour de la période d’intérêt.</span><span class="sxs-lookup"><span data-stu-id="61bf5-169">Select a particular test, location, or reduce the time period to see more results around the time period of interest.</span></span> <span data-ttu-id="61bf5-170">Utilisez l’Explorateur de recherche pour voir les résultats de toutes les exécutions, ou utilisez les requêtes Analytics pour exécuter des rapports personnalisés sur ces données.</span><span class="sxs-lookup"><span data-stu-id="61bf5-170">Use Search Explorer to see results from all executions, or use Analytics queries to run custom reports on this data.</span></span>

<span data-ttu-id="61bf5-171">Outre les résultats bruts, il existe deux mesures de disponibilité dans Metrics Explorer :</span><span class="sxs-lookup"><span data-stu-id="61bf5-171">In addition to the raw results, there are two Availability metrics in Metrics Explorer:</span></span> 

1. <span data-ttu-id="61bf5-172">Disponibilité : pourcentage des tests qui ont réussi, sur toutes les exécutions de test.</span><span class="sxs-lookup"><span data-stu-id="61bf5-172">Availability: Percentage of the tests that were successful, across all test executions.</span></span> 
2. <span data-ttu-id="61bf5-173">Durée du test : durée moyenne du test sur toutes les exécutions de test.</span><span class="sxs-lookup"><span data-stu-id="61bf5-173">Test Duration: Average test duration across all test executions.</span></span>

<span data-ttu-id="61bf5-174">Vous pouvez appliquer des filtres sur le nom du test et sur l’emplacement pour analyser les tendances d’un test et/ou d’un emplacement en particulier.</span><span class="sxs-lookup"><span data-stu-id="61bf5-174">You can apply filters on the test name, location to analyze trends of a particular test and/or location.</span></span>

## <span data-ttu-id="61bf5-175"><a name="edit"></a>Examiner et modifier des tests</span><span class="sxs-lookup"><span data-stu-id="61bf5-175"><a name="edit"></a> Inspect and edit tests</span></span>

<span data-ttu-id="61bf5-176">Dans la page de résumé, sélectionnez un test spécifique.</span><span class="sxs-lookup"><span data-stu-id="61bf5-176">From the summary page, select a specific test.</span></span> <span data-ttu-id="61bf5-177">Ici, vous pouvez voir ses résultats spécifiques et le modifier ou le désactiver temporairement.</span><span class="sxs-lookup"><span data-stu-id="61bf5-177">There, you can see its specific results, and edit or temporarily disable it.</span></span>

![Edit or disable a web test](./media/app-insights-monitor-web-app-availability/19-availEdit-3.png)

<span data-ttu-id="61bf5-179">Vous souhaiterez peut-être désactiver les tests de disponibilité ou les règles d’alerte associées lorsque vous effectuez la maintenance de votre service.</span><span class="sxs-lookup"><span data-stu-id="61bf5-179">You might want to disable availability tests or the alert rules associated with them while you are performing maintenance on your service.</span></span> 

## <span data-ttu-id="61bf5-180"><a name="failures"></a>Si vous constatez des erreurs</span><span class="sxs-lookup"><span data-stu-id="61bf5-180"><a name="failures"></a>If you see failures</span></span>
<span data-ttu-id="61bf5-181">Cliquez sur un point rouge.</span><span class="sxs-lookup"><span data-stu-id="61bf5-181">Click a red dot.</span></span>

![Click a red dot](./media/app-insights-monitor-web-app-availability/open-instance-3.png)


<span data-ttu-id="61bf5-183">À partir d’un résultat de test de disponibilité, vous pouvez :</span><span class="sxs-lookup"><span data-stu-id="61bf5-183">From an availability test result, you can:</span></span>

* <span data-ttu-id="61bf5-184">Vérifier la réponse reçue à partir de votre serveur.</span><span class="sxs-lookup"><span data-stu-id="61bf5-184">Inspect the response received from your server.</span></span>
* <span data-ttu-id="61bf5-185">Ouvrir la télémétrie envoyée par votre application serveur lors du traitement de l’instance de requête ayant échoué.</span><span class="sxs-lookup"><span data-stu-id="61bf5-185">Open the telemetry sent by your server app while processing the failed request instance.</span></span>
* <span data-ttu-id="61bf5-186">Enregistrer un problème ou un élément de travail dans Git ou VSTS pour suivre le problème.</span><span class="sxs-lookup"><span data-stu-id="61bf5-186">Log an issue or work item in Git or VSTS to track the problem.</span></span> <span data-ttu-id="61bf5-187">Le bogue contient un lien vers cet événement.</span><span class="sxs-lookup"><span data-stu-id="61bf5-187">The bug will contain a link to this event.</span></span>
* <span data-ttu-id="61bf5-188">Ouvrir le résultat du test web dans Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="61bf5-188">Open the web test result in Visual Studio.</span></span>


<span data-ttu-id="61bf5-189">*Le résultat semble correct, mais une erreur est signalée ?*</span><span class="sxs-lookup"><span data-stu-id="61bf5-189">*Looks OK but reported as a failure?*</span></span> <span data-ttu-id="61bf5-190">Vérifiez toutes les images, les scripts, les feuilles de style et tout autre fichier chargé par la page.</span><span class="sxs-lookup"><span data-stu-id="61bf5-190">Check all the images, scripts, style sheets, and any other files loaded by the page.</span></span> <span data-ttu-id="61bf5-191">Si l’un d’eux échoue, le test signale une erreur, même si la page html principale se charge correctement.</span><span class="sxs-lookup"><span data-stu-id="61bf5-191">If any of them fails, the test is reported as failed, even if the main html page loads OK.</span></span>

<span data-ttu-id="61bf5-192">*Aucun élément connexe ?*</span><span class="sxs-lookup"><span data-stu-id="61bf5-192">*No related items?*</span></span> <span data-ttu-id="61bf5-193">Si Application Insights est défini pour votre application côté serveur, cela peut être en raison d’un [échantillonnage](app-insights-sampling.md) en cours.</span><span class="sxs-lookup"><span data-stu-id="61bf5-193">If you have Application Insights set up for your server-side application, that may be because [sampling](app-insights-sampling.md) is in operation.</span></span> 

## <a name="multi-step-web-tests"></a><span data-ttu-id="61bf5-194">Tests web à plusieurs étapes</span><span class="sxs-lookup"><span data-stu-id="61bf5-194">Multi-step web tests</span></span>
<span data-ttu-id="61bf5-195">Vous pouvez analyser un scénario qui implique une séquence d'URL.</span><span class="sxs-lookup"><span data-stu-id="61bf5-195">You can monitor a scenario that involves a sequence of URLs.</span></span> <span data-ttu-id="61bf5-196">Par exemple, si vous analysez un site Web commercial, vous pouvez vérifier que l’ajout d’articles au panier d’achat fonctionne correctement.</span><span class="sxs-lookup"><span data-stu-id="61bf5-196">For example, if you are monitoring a sales website, you can test that adding items to the shopping cart works correctly.</span></span>

> [!NOTE] 
> <span data-ttu-id="61bf5-197">Les tests web à plusieurs étapes ont un coût.</span><span class="sxs-lookup"><span data-stu-id="61bf5-197">There is a charge for multi-step web tests.</span></span> <span data-ttu-id="61bf5-198">[Mécanisme de tarification](http://azure.microsoft.com/pricing/details/application-insights/).</span><span class="sxs-lookup"><span data-stu-id="61bf5-198">[Pricing scheme](http://azure.microsoft.com/pricing/details/application-insights/).</span></span>
> 

<span data-ttu-id="61bf5-199">Pour créer un test à plusieurs étapes, vous enregistrez le scénario à l’aide de Visual Studio Enterprise et téléchargez ensuite l’enregistrement dans Application Insights.</span><span class="sxs-lookup"><span data-stu-id="61bf5-199">To create a multi-step test, you record the scenario by using Visual Studio Enterprise, and then upload the recording to Application Insights.</span></span> <span data-ttu-id="61bf5-200">Application Insights relit le scénario à intervalles réguliers et vérifie les réponses.</span><span class="sxs-lookup"><span data-stu-id="61bf5-200">Application Insights replays the scenario at intervals and verifies the responses.</span></span>

> [!NOTE]
> <span data-ttu-id="61bf5-201">Vous ne pouvez pas utiliser de fonctions codées ni de boucles dans vos tests.</span><span class="sxs-lookup"><span data-stu-id="61bf5-201">You can't use coded functions or loops in your tests.</span></span> <span data-ttu-id="61bf5-202">Le test doit être entièrement contenu dans le script .webtest.</span><span class="sxs-lookup"><span data-stu-id="61bf5-202">The test must be contained completely in the .webtest script.</span></span> <span data-ttu-id="61bf5-203">Toutefois, vous pouvez utiliser des plug-ins standard.</span><span class="sxs-lookup"><span data-stu-id="61bf5-203">However, you can use standard plugins.</span></span>
>

#### <a name="1-record-a-scenario"></a><span data-ttu-id="61bf5-204">1. Enregistrement d’un scénario</span><span class="sxs-lookup"><span data-stu-id="61bf5-204">1. Record a scenario</span></span>
<span data-ttu-id="61bf5-205">Utilisez Visual Studio Enterprise pour enregistrer une session web.</span><span class="sxs-lookup"><span data-stu-id="61bf5-205">Use Visual Studio Enterprise to record a web session.</span></span>

1. <span data-ttu-id="61bf5-206">Créez un projet de test de performance web.</span><span class="sxs-lookup"><span data-stu-id="61bf5-206">Create a Web performance test project.</span></span>

    ![Dans Visual Studio édition Enterprise, créez un projet à partir du modèle Projet de test de performance Web et de charge.](./media/app-insights-monitor-web-app-availability/appinsights-71webtest-multi-vs-create.png)

 * <span data-ttu-id="61bf5-208">*Le modèle Projet de test de performance Web et de charge ne s’affiche pas ?*</span><span class="sxs-lookup"><span data-stu-id="61bf5-208">*Don't see the Web Performance and Load Test template?*</span></span> <span data-ttu-id="61bf5-209">- Fermez Visual Studio Enterprise.</span><span class="sxs-lookup"><span data-stu-id="61bf5-209">- Close Visual Studio Enterprise.</span></span> <span data-ttu-id="61bf5-210">Ouvrez **le programme d’installation de Visual Studio** pour modifier votre installation de Visual Studio Enterprise.</span><span class="sxs-lookup"><span data-stu-id="61bf5-210">Open **Visual Studio Installer** to modify your Visual Studio Enterprise installation.</span></span> <span data-ttu-id="61bf5-211">Sous **Composants individuels**, sélectionnez **Web Performance and load testing tools** (Outils de test de performance Web et de charge).</span><span class="sxs-lookup"><span data-stu-id="61bf5-211">Under **Individual Components**, select **Web Performance and load testing tools**.</span></span>

2. <span data-ttu-id="61bf5-212">Ouvrez le fichier .webtest et lancez l'enregistrement.</span><span class="sxs-lookup"><span data-stu-id="61bf5-212">Open the .webtest file and start recording.</span></span>

    ![Ouvrez le fichier .webtest et cliquez sur Enregistrer.](./media/app-insights-monitor-web-app-availability/appinsights-71webtest-multi-vs-start.png)
3. <span data-ttu-id="61bf5-214">Effectuez les actions utilisateur que vous voulez simuler lors de votre test : ouvrez votre site web, ajoutez un produit au panier d’achat etc.</span><span class="sxs-lookup"><span data-stu-id="61bf5-214">Do the user actions you want to simulate in your test: open your website, add a product to the cart, and so on.</span></span> <span data-ttu-id="61bf5-215">Ensuite, arrêtez le test.</span><span class="sxs-lookup"><span data-stu-id="61bf5-215">Then stop your test.</span></span>

    ![L’enregistreur de test web s’exécute dans Internet Explorer.](./media/app-insights-monitor-web-app-availability/appinsights-71webtest-multi-vs-record.png)

    <span data-ttu-id="61bf5-217">Ne créez pas de scénario long.</span><span class="sxs-lookup"><span data-stu-id="61bf5-217">Don't make a long scenario.</span></span> <span data-ttu-id="61bf5-218">La limite est de 100 étapes et 2 minutes.</span><span class="sxs-lookup"><span data-stu-id="61bf5-218">There's a limit of 100 steps and 2 minutes.</span></span>
4. <span data-ttu-id="61bf5-219">Modifiez le test pour :</span><span class="sxs-lookup"><span data-stu-id="61bf5-219">Edit the test to:</span></span>

   * <span data-ttu-id="61bf5-220">ajouter des validations en vue de vérifier le texte reçu et les codes de réponse ;</span><span class="sxs-lookup"><span data-stu-id="61bf5-220">Add validations to check the received text and response codes.</span></span>
   * <span data-ttu-id="61bf5-221">supprimer les interactions superflues.</span><span class="sxs-lookup"><span data-stu-id="61bf5-221">Remove any superfluous interactions.</span></span> <span data-ttu-id="61bf5-222">Vous pouvez aussi supprimer les demandes dépendantes d’images ou celles à destination de sites AD ou de suivi.</span><span class="sxs-lookup"><span data-stu-id="61bf5-222">You could also remove dependent requests for pictures or to ad or tracking sites.</span></span>

     <span data-ttu-id="61bf5-223">Ne perdez pas de vue que vous pouvez modifier uniquement le script de test. Vous ne pouvez pas ajouter de code personnalisé ni appeler d’autres tests web.</span><span class="sxs-lookup"><span data-stu-id="61bf5-223">Remember that you can only edit the test script - you can't add custom code or call other web tests.</span></span> <span data-ttu-id="61bf5-224">N’insérez pas de boucles dans le test.</span><span class="sxs-lookup"><span data-stu-id="61bf5-224">Don't insert loops in the test.</span></span> <span data-ttu-id="61bf5-225">Vous pouvez utiliser des plug-ins de test web standard.</span><span class="sxs-lookup"><span data-stu-id="61bf5-225">You can use standard web test plug-ins.</span></span>
5. <span data-ttu-id="61bf5-226">Exécutez le test dans Visual Studio pour vérifier qu'il fonctionne.</span><span class="sxs-lookup"><span data-stu-id="61bf5-226">Run the test in Visual Studio to make sure it works.</span></span>

    <span data-ttu-id="61bf5-227">Le test runner web ouvre un navigateur web et répète les actions enregistrées.</span><span class="sxs-lookup"><span data-stu-id="61bf5-227">The web test runner opens a web browser and repeats the actions you recorded.</span></span> <span data-ttu-id="61bf5-228">Assurez-vous qu’il fonctionne comme prévu.</span><span class="sxs-lookup"><span data-stu-id="61bf5-228">Make sure it works as you expect.</span></span>

    ![Dans Visual Studio, ouvrez le fichier .webtest et cliquez sur Exécuter.](./media/app-insights-monitor-web-app-availability/appinsights-71webtest-multi-vs-run.png)

#### <a name="2-upload-the-web-test-to-application-insights"></a><span data-ttu-id="61bf5-230">2. Chargement du test web dans Application Insights</span><span class="sxs-lookup"><span data-stu-id="61bf5-230">2. Upload the web test to Application Insights</span></span>
1. <span data-ttu-id="61bf5-231">Dans le portail Application Insights, créez un test web.</span><span class="sxs-lookup"><span data-stu-id="61bf5-231">In the Application Insights portal, create a web test.</span></span>

    ![Sur le panneau des tests web, choisissez Ajouter.](./media/app-insights-monitor-web-app-availability/16-another-test.png)
2. <span data-ttu-id="61bf5-233">Sélectionnez le test à plusieurs étapes et téléchargez le fichier .webtest.</span><span class="sxs-lookup"><span data-stu-id="61bf5-233">Select multi-step test, and upload the .webtest file.</span></span>

    ![Sélectionnez test web multi-étapes.](./media/app-insights-monitor-web-app-availability/appinsights-71webtestUpload.png)

    <span data-ttu-id="61bf5-235">Définissez les emplacements de test, la fréquence et les paramètres d’alerte comme pour les tests ping.</span><span class="sxs-lookup"><span data-stu-id="61bf5-235">Set the test locations, frequency, and alert parameters in the same way as for ping tests.</span></span>

#### <a name="3-see-the-results"></a><span data-ttu-id="61bf5-236">3. Afficher les résultats</span><span class="sxs-lookup"><span data-stu-id="61bf5-236">3. See the results</span></span>

<span data-ttu-id="61bf5-237">Visualisez les résultats de votre test et les échecs éventuels de la même manière que les tests d’URL unique.</span><span class="sxs-lookup"><span data-stu-id="61bf5-237">View your test results and any failures in the same way as single-url tests.</span></span>

<span data-ttu-id="61bf5-238">En outre, vous pouvez télécharger les résultats des tests pour les afficher dans Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="61bf5-238">In addition, you can download the test results to view them in Visual Studio.</span></span>

#### <a name="too-many-failures"></a><span data-ttu-id="61bf5-239">Trop d’échecs ?</span><span class="sxs-lookup"><span data-stu-id="61bf5-239">Too many failures?</span></span>

* <span data-ttu-id="61bf5-240">Un échec est souvent dû à un test trop long.</span><span class="sxs-lookup"><span data-stu-id="61bf5-240">A common reason for failure is that the test runs too long.</span></span> <span data-ttu-id="61bf5-241">Le test ne doit pas durer plus de deux minutes.</span><span class="sxs-lookup"><span data-stu-id="61bf5-241">It mustn't run longer than two minutes.</span></span>

* <span data-ttu-id="61bf5-242">N’oubliez pas que toutes les ressources d’une page doivent se charger correctement pour que le test réussisse, y compris les scripts, les feuilles de style, les images, etc.</span><span class="sxs-lookup"><span data-stu-id="61bf5-242">Don't forget that all the resources of a page must load correctly for the test to succeed, including scripts, style sheets, images, and so forth.</span></span>

* <span data-ttu-id="61bf5-243">Le test web doit être entièrement contenu dans le script .webtest : vous ne pouvez pas utiliser de fonctions codées dans le test.</span><span class="sxs-lookup"><span data-stu-id="61bf5-243">The web test must be entirely contained in the .webtest script: you can't use coded functions in the test.</span></span>

### <a name="plugging-time-and-random-numbers-into-your-multi-step-test"></a><span data-ttu-id="61bf5-244">Ajout de plug-ins de temps et de nombres aléatoires à votre test à plusieurs étapes</span><span class="sxs-lookup"><span data-stu-id="61bf5-244">Plugging time and random numbers into your multi-step test</span></span>
<span data-ttu-id="61bf5-245">Supposons que vous testiez un outil qui obtient des données temporelles, telles que des actions à partir d’un flux externe.</span><span class="sxs-lookup"><span data-stu-id="61bf5-245">Suppose you're testing a tool that gets time-dependent data such as stocks from an external feed.</span></span> <span data-ttu-id="61bf5-246">Lorsque vous enregistrez votre test web, vous devez utiliser des heures spécifiques, mais vous les définissez en tant que paramètres de test, à savoir StartTime et EndTime.</span><span class="sxs-lookup"><span data-stu-id="61bf5-246">When you record your web test, you have to use specific times, but you set them as parameters of the test, StartTime and EndTime.</span></span>

![Un test web avec des paramètres.](./media/app-insights-monitor-web-app-availability/appinsights-72webtest-parameters.png)

<span data-ttu-id="61bf5-248">Lorsque vous exécutez le test, vous souhaitez que le paramètre EndTime corresponde systématiquement à l’heure actuelle et le paramètre StartTime à l’heure d’il y a 15 minutes.</span><span class="sxs-lookup"><span data-stu-id="61bf5-248">When you run the test, you'd like EndTime always to be the present time, and StartTime should be 15 minutes ago.</span></span>

<span data-ttu-id="61bf5-249">Les plug-ins de test web vous permettent de paramétrer les heures.</span><span class="sxs-lookup"><span data-stu-id="61bf5-249">Web Test Plug-ins provide the way to do parameterize times.</span></span>

1. <span data-ttu-id="61bf5-250">Ajoutez un plug-in de test web pour chaque valeur de paramètre variable souhaitée.</span><span class="sxs-lookup"><span data-stu-id="61bf5-250">Add a web test plug-in for each variable parameter value you want.</span></span> <span data-ttu-id="61bf5-251">Dans la barre d’outils de test web, sélectionnez **Ajouter un plug-in de test web**.</span><span class="sxs-lookup"><span data-stu-id="61bf5-251">In the web test toolbar, choose **Add Web Test Plugin**.</span></span>

    ![Choisissez Ajouter un plug-in de test web et sélectionnez un type.](./media/app-insights-monitor-web-app-availability/appinsights-72webtest-plugins.png)

    <span data-ttu-id="61bf5-253">Dans cet exemple, nous allons utiliser deux instances du plug-in Date Time.</span><span class="sxs-lookup"><span data-stu-id="61bf5-253">In this example, we use two instances of the Date Time Plug-in.</span></span> <span data-ttu-id="61bf5-254">Une instance est pour « il y a 15 minutes » et l’autre pour « maintenant ».</span><span class="sxs-lookup"><span data-stu-id="61bf5-254">One instance is for "15 minutes ago" and another for "now."</span></span>
2. <span data-ttu-id="61bf5-255">Ouvrez les propriétés de chaque plug-in.</span><span class="sxs-lookup"><span data-stu-id="61bf5-255">Open the properties of each plug-in.</span></span> <span data-ttu-id="61bf5-256">Donnez-lui un nom et configurez-le de manière à utiliser l’heure actuelle.</span><span class="sxs-lookup"><span data-stu-id="61bf5-256">Give it a name and set it to use the current time.</span></span> <span data-ttu-id="61bf5-257">Pour l'un d'eux, définissez Ajouter des minutes = -15.</span><span class="sxs-lookup"><span data-stu-id="61bf5-257">For one of them, set Add Minutes = -15.</span></span>

    ![Définissez le nom, utilisez l’heure actuelle et ajouter des minutes.](./media/app-insights-monitor-web-app-availability/appinsights-72webtest-plugin-parameters.png)
3. <span data-ttu-id="61bf5-259">Dans les paramètres de test web, utilisez {{nom du plug-in}} pour référencer un nom de plug-in.</span><span class="sxs-lookup"><span data-stu-id="61bf5-259">In the web test parameters, use {{plug-in name}} to reference a plug-in name.</span></span>

    ![Dans le paramètre de test, utilisez {{nom du plug-in}}.](./media/app-insights-monitor-web-app-availability/appinsights-72webtest-plugin-name.png)

<span data-ttu-id="61bf5-261">Maintenant, téléchargez votre test sur le portail.</span><span class="sxs-lookup"><span data-stu-id="61bf5-261">Now, upload your test to the portal.</span></span> <span data-ttu-id="61bf5-262">Il utilise les valeurs dynamiques à chaque exécution du test.</span><span class="sxs-lookup"><span data-stu-id="61bf5-262">It uses the dynamic values on every run of the test.</span></span>

## <a name="dealing-with-sign-in"></a><span data-ttu-id="61bf5-263">Gestion de la connexion</span><span class="sxs-lookup"><span data-stu-id="61bf5-263">Dealing with sign-in</span></span>
<span data-ttu-id="61bf5-264">Si vos utilisateurs se connectent à votre application, vous disposez de différentes options pour simuler la connexion et tester les pages suivant la connexion.</span><span class="sxs-lookup"><span data-stu-id="61bf5-264">If your users sign in to your app, you have various options for simulating sign-in so that you can test pages behind the sign-in.</span></span> <span data-ttu-id="61bf5-265">L’approche que vous utilisez dépend du type de sécurité fourni par l’application.</span><span class="sxs-lookup"><span data-stu-id="61bf5-265">The approach you use depends on the type of security provided by the app.</span></span>

<span data-ttu-id="61bf5-266">Dans tous les cas, vous devez créer un compte dans votre application uniquement à des fins de test.</span><span class="sxs-lookup"><span data-stu-id="61bf5-266">In all cases, you should create an account in your application just for the purpose of testing.</span></span> <span data-ttu-id="61bf5-267">Si possible, limitez les autorisations de ce compte de test afin que les tests web n’affectent aucunement les utilisateurs réels.</span><span class="sxs-lookup"><span data-stu-id="61bf5-267">If possible, restrict the permissions of this test account so that there's no possibility of the web tests affecting real users.</span></span>

### <a name="simple-username-and-password"></a><span data-ttu-id="61bf5-268">Nom d’utilisateur et mot de passe simples</span><span class="sxs-lookup"><span data-stu-id="61bf5-268">Simple username and password</span></span>
<span data-ttu-id="61bf5-269">Enregistrez un test web de la façon habituelle.</span><span class="sxs-lookup"><span data-stu-id="61bf5-269">Record a web test in the usual way.</span></span> <span data-ttu-id="61bf5-270">Supprimez d’abord les cookies</span><span class="sxs-lookup"><span data-stu-id="61bf5-270">Delete cookies first.</span></span>

### <a name="saml-authentication"></a><span data-ttu-id="61bf5-271">Authentication SAML</span><span class="sxs-lookup"><span data-stu-id="61bf5-271">SAML authentication</span></span>
<span data-ttu-id="61bf5-272">Utilisez le plug-in SAML qui est disponible pour les tests web.</span><span class="sxs-lookup"><span data-stu-id="61bf5-272">Use the SAML plugin that is available for web tests.</span></span>

### <a name="client-secret"></a><span data-ttu-id="61bf5-273">Clé secrète client</span><span class="sxs-lookup"><span data-stu-id="61bf5-273">Client secret</span></span>
<span data-ttu-id="61bf5-274">Si votre application présente un mode de connexion impliquant une clé secrète client, utilisez ce mode.</span><span class="sxs-lookup"><span data-stu-id="61bf5-274">If your app has a sign-in route that involves a client secret, use that route.</span></span> <span data-ttu-id="61bf5-275">Azure Active Directory (AAD) est un exemple de service fournissant une connexion avec clé secrète client.</span><span class="sxs-lookup"><span data-stu-id="61bf5-275">Azure Active Directory (AAD) is an example of a service that provides a client secret sign-in.</span></span> <span data-ttu-id="61bf5-276">Dans AAD, la clé secrète client est la clé d’application.</span><span class="sxs-lookup"><span data-stu-id="61bf5-276">In AAD, the client secret is the App Key.</span></span>

<span data-ttu-id="61bf5-277">Voici un exemple de test web d’une application web Azure à l’aide d’une clé d’application :</span><span class="sxs-lookup"><span data-stu-id="61bf5-277">Here's a sample web test of an Azure web app using an app key:</span></span>

![Exemple de clé secrète client](./media/app-insights-monitor-web-app-availability/110.png)

1. <span data-ttu-id="61bf5-279">Récupérez le jeton d’ADD à l’aide de la clé secrète client (clé d’application).</span><span class="sxs-lookup"><span data-stu-id="61bf5-279">Get token from AAD using client secret (AppKey).</span></span>
2. <span data-ttu-id="61bf5-280">Extrayez le jeton porteur de la réponse.</span><span class="sxs-lookup"><span data-stu-id="61bf5-280">Extract bearer token from response.</span></span>
3. <span data-ttu-id="61bf5-281">Appelez l’API à l’aide du jeton porteur de l’en-tête d’autorisation.</span><span class="sxs-lookup"><span data-stu-id="61bf5-281">Call API using bearer token in the authorization header.</span></span>

<span data-ttu-id="61bf5-282">Assurez-vous que le test web est un client réel, qu’il possède sa propre application dans AAD, puis utilisé son ID client et sa clé d’application.</span><span class="sxs-lookup"><span data-stu-id="61bf5-282">Make sure that the web test is an actual client - that is, it has its own app in AAD - and use its clientId + appkey.</span></span> <span data-ttu-id="61bf5-283">Votre service soumis à un test possède également sa propre application dans AAD : l’URI ID d’application se retrouve dans le champ dédié aux ressources du test web.</span><span class="sxs-lookup"><span data-stu-id="61bf5-283">Your service under test also has its own app in AAD: the appID URI of this app is reflected in the web test in the “resource” field.</span></span>

### <a name="open-authentication"></a><span data-ttu-id="61bf5-284">Authentification ouverte</span><span class="sxs-lookup"><span data-stu-id="61bf5-284">Open Authentication</span></span>
<span data-ttu-id="61bf5-285">Comme exemple d’authentification ouverte, citons la connexion avec votre compte Microsoft ou Google.</span><span class="sxs-lookup"><span data-stu-id="61bf5-285">An example of open authentication is signing in with your Microsoft or Google account.</span></span> <span data-ttu-id="61bf5-286">De nombreuses applications utilisant OAuth fournissent l’alternative de la clé secrète client ; commencez donc par rechercher cet élément.</span><span class="sxs-lookup"><span data-stu-id="61bf5-286">Many apps that use OAuth provide the client secret alternative, so your first tactic should be to investigate that possibility.</span></span>

<span data-ttu-id="61bf5-287">Si votre test doit se connecter à l’aide d’OAuth, l’approche générale est la suivante :</span><span class="sxs-lookup"><span data-stu-id="61bf5-287">If your test must sign in using OAuth, the general approach is:</span></span>

* <span data-ttu-id="61bf5-288">Utilisez un outil tel que Fiddler pour examiner le trafic entre votre navigateur web, le site d’authentification et votre application.</span><span class="sxs-lookup"><span data-stu-id="61bf5-288">Use a tool such as Fiddler to examine the traffic between your web browser, the authentication site, and your app.</span></span>
* <span data-ttu-id="61bf5-289">Effectuez deux connexions ou plus à l’aide d’ordinateurs ou de navigateurs différents, ou à des intervalles longs (pour que les jetons arrivent à expiration).</span><span class="sxs-lookup"><span data-stu-id="61bf5-289">Perform two or more sign-ins using different machines or browsers, or at long intervals (to allow tokens to expire).</span></span>
* <span data-ttu-id="61bf5-290">En comparant les différentes sessions, identifiez le jeton retransmis à partir du site d’authentification, qui est ensuite transmis à votre serveur d’application après la connexion.</span><span class="sxs-lookup"><span data-stu-id="61bf5-290">By comparing different sessions, identify the token passed back from the authenticating site, that is then passed to your app server after sign-in.</span></span>
* <span data-ttu-id="61bf5-291">Enregistrez un test web à l’aide de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="61bf5-291">Record a web test using Visual Studio.</span></span>
* <span data-ttu-id="61bf5-292">Paramétrez les jetons, en définissant le paramètre lorsque le jeton est retourné par l’authentificateur et en l’utilisant dans la requête soumise sur le site.</span><span class="sxs-lookup"><span data-stu-id="61bf5-292">Parameterize the tokens, setting the parameter when the token is returned from the authenticator, and using it in the query to the site.</span></span>
  <span data-ttu-id="61bf5-293">(Visual Studio tente de paramétrer le test, mais ne paramètre pas correctement les jetons.)</span><span class="sxs-lookup"><span data-stu-id="61bf5-293">(Visual Studio attempts to parameterize the test, but does not correctly parameterize the tokens.)</span></span>


## <a name="performance-tests"></a><span data-ttu-id="61bf5-294">Tests de performance</span><span class="sxs-lookup"><span data-stu-id="61bf5-294">Performance tests</span></span>
<span data-ttu-id="61bf5-295">Vous pouvez effectuer un test de charge sur votre site web.</span><span class="sxs-lookup"><span data-stu-id="61bf5-295">You can run a load test on your website.</span></span> <span data-ttu-id="61bf5-296">Comme pour le test de disponibilité, vous pouvez envoyer des requêtes uniques ou des requêtes à plusieurs étapes à partir de nos points de présence dans le monde.</span><span class="sxs-lookup"><span data-stu-id="61bf5-296">Like the availability test, you can send either simple requests or multi-step requests from our points around the world.</span></span> <span data-ttu-id="61bf5-297">Contrairement à un test de disponibilité, de nombreuses demandes sont envoyées, afin de simuler la présence de plusieurs utilisateurs simultanés.</span><span class="sxs-lookup"><span data-stu-id="61bf5-297">Unlike an availability test, many requests are sent, simulating multiple simultaneous users.</span></span>

<span data-ttu-id="61bf5-298">Dans le panneau Vue d’ensemble, ouvrez **Paramètres**, **Tests de performance**.</span><span class="sxs-lookup"><span data-stu-id="61bf5-298">From the Overview blade, open **Settings**, **Performance Tests**.</span></span> <span data-ttu-id="61bf5-299">Lorsque vous créez un test, vous êtes invité à vous connecter à Visual Studio Team Services ou à créer un compte.</span><span class="sxs-lookup"><span data-stu-id="61bf5-299">When you create a test, you are invited to connect to or create a Visual Studio Team Services account.</span></span>

<span data-ttu-id="61bf5-300">Une fois le test terminé, les temps de réponse et les taux de réussite s’affichent.</span><span class="sxs-lookup"><span data-stu-id="61bf5-300">When the test is complete, you are shown response times and success rates.</span></span>


![Test de performance](./media/app-insights-monitor-web-app-availability/perf-test.png)

> [!TIP]
> <span data-ttu-id="61bf5-302">Pour observer les effets d’un test de performances, utilisez [Flux temps réel](app-insights-live-stream.md) et [Profileur](app-insights-profiler.md).</span><span class="sxs-lookup"><span data-stu-id="61bf5-302">To observe the effects of a performance test, use [Live Stream](app-insights-live-stream.md) and [Profiler](app-insights-profiler.md).</span></span>
>

## <a name="automation"></a><span data-ttu-id="61bf5-303">Automatisation</span><span class="sxs-lookup"><span data-stu-id="61bf5-303">Automation</span></span>
* <span data-ttu-id="61bf5-304">[Utilisez des scripts PowerShell pour configurer un test de disponibilité](app-insights-powershell.md#add-an-availability-test) automatiquement.</span><span class="sxs-lookup"><span data-stu-id="61bf5-304">[Use PowerShell scripts to set up an availability test](app-insights-powershell.md#add-an-availability-test) automatically.</span></span>
* <span data-ttu-id="61bf5-305">Configurez un [webhook](../monitoring-and-diagnostics/insights-webhooks-alerts.md) qui est appelé lorsqu’une alerte est déclenchée.</span><span class="sxs-lookup"><span data-stu-id="61bf5-305">Set up a [webhook](../monitoring-and-diagnostics/insights-webhooks-alerts.md) that is called when an alert is raised.</span></span>

## <span data-ttu-id="61bf5-306"><a name="qna"></a>Des questions ?</span><span class="sxs-lookup"><span data-stu-id="61bf5-306"><a name="qna"></a>Questions?</span></span> <span data-ttu-id="61bf5-307">Des problèmes ?</span><span class="sxs-lookup"><span data-stu-id="61bf5-307">Problems?</span></span>
* <span data-ttu-id="61bf5-308">*Puis-je appeler du code à partir de mon test web ?*</span><span class="sxs-lookup"><span data-stu-id="61bf5-308">*Can I call code from my web test?*</span></span>

    <span data-ttu-id="61bf5-309">Non.</span><span class="sxs-lookup"><span data-stu-id="61bf5-309">No.</span></span> <span data-ttu-id="61bf5-310">Les étapes du test doivent se trouver dans le fichier .webtest.</span><span class="sxs-lookup"><span data-stu-id="61bf5-310">The steps of the test must be in the .webtest file.</span></span> <span data-ttu-id="61bf5-311">Et vous ne pouvez pas appeler d’autres tests web ou utiliser des boucles.</span><span class="sxs-lookup"><span data-stu-id="61bf5-311">And you can't call other web tests or use loops.</span></span> <span data-ttu-id="61bf5-312">En revanche, il existe un certain nombre de plug-ins qui peuvent s’avérer utiles.</span><span class="sxs-lookup"><span data-stu-id="61bf5-312">But there are several plug-ins that you might find helpful.</span></span>
* <span data-ttu-id="61bf5-313">*Le protocole HTTPS est-il pris en charge ?*</span><span class="sxs-lookup"><span data-stu-id="61bf5-313">*Is HTTPS supported?*</span></span>

    <span data-ttu-id="61bf5-314">Nous prenons en charge TLS 1.1 et TLS 1.2.</span><span class="sxs-lookup"><span data-stu-id="61bf5-314">We support TLS 1.1 and TLS 1.2.</span></span>
* <span data-ttu-id="61bf5-315">*Quelle est la différence entre les « tests Web » et les « tests de disponibilité » ?*</span><span class="sxs-lookup"><span data-stu-id="61bf5-315">*Is there a difference between "web tests" and "availability tests"?*</span></span>

    <span data-ttu-id="61bf5-316">Les deux conditions peuvent être référencées indifféremment.</span><span class="sxs-lookup"><span data-stu-id="61bf5-316">The two terms may be referenced interchangeably.</span></span> <span data-ttu-id="61bf5-317">« Tests de disponibilité » est un terme plus générique qui inclut les tests ping d’URL uniques en plus des tests web à plusieurs étapes.</span><span class="sxs-lookup"><span data-stu-id="61bf5-317">Availability tests is a more generic term that includes the single URL ping tests in addition to the multi-step web tests.</span></span>
* <span data-ttu-id="61bf5-318">*J’aimerais utiliser les tests de disponibilité sur notre serveur interne qui s’exécute derrière un pare-feu.*</span><span class="sxs-lookup"><span data-stu-id="61bf5-318">*I'd like to use availability tests on our internal server that runs behind a firewall.*</span></span>

    <span data-ttu-id="61bf5-319">Il existe deux solutions possibles :</span><span class="sxs-lookup"><span data-stu-id="61bf5-319">There are two possible solutions:</span></span>
    
    * <span data-ttu-id="61bf5-320">Configurez votre pare-feu pour autoriser les demandes entrantes provenant des [adresses IP de nos agents de test web](app-insights-ip-addresses.md).</span><span class="sxs-lookup"><span data-stu-id="61bf5-320">Configure your firewall to permit incoming requests from the [IP addresses of our web test agents](app-insights-ip-addresses.md).</span></span>
    * <span data-ttu-id="61bf5-321">Écrivez votre propre code pour tester régulièrement votre serveur interne.</span><span class="sxs-lookup"><span data-stu-id="61bf5-321">Write your own code to periodically test your internal server.</span></span> <span data-ttu-id="61bf5-322">Exécutez le code en tant que processus en arrière-plan sur un serveur test derrière votre pare-feu.</span><span class="sxs-lookup"><span data-stu-id="61bf5-322">Run the code as a background process on a test server behind your firewall.</span></span> <span data-ttu-id="61bf5-323">Le processus de test peut envoyer ses résultats à Application Insights à l’aide de l’API [TrackAvailability()](https://docs.microsoft.com/dotnet/api/microsoft.applicationinsights.telemetryclient.trackavailability) dans le package du kit de développement logiciel (SDK) principal.</span><span class="sxs-lookup"><span data-stu-id="61bf5-323">Your test process can send its results to Application Insights by using [TrackAvailability()](https://docs.microsoft.com/dotnet/api/microsoft.applicationinsights.telemetryclient.trackavailability) API in the core SDK package.</span></span> <span data-ttu-id="61bf5-324">Cela nécessite que votre serveur de test ait un accès sortant au point de terminaison d’ingestion Application Insights, mais ce risque de sécurité est beaucoup plus faible que l’alternative, qui consiste à autoriser les demandes entrantes.</span><span class="sxs-lookup"><span data-stu-id="61bf5-324">This requires your test server to have outgoing access to the Application Insights ingestion endpoint, but that is a much smaller security risk than the alternative of permitting incoming requests.</span></span> <span data-ttu-id="61bf5-325">Les résultats n’apparaissent pas dans les panneaux de tests web de disponibilité, mais ils s’affichent comme résultats de disponibilité dans Analytics, Search et Metric Explorer.</span><span class="sxs-lookup"><span data-stu-id="61bf5-325">The results will not appear in the availability web tests blades, but appears as availability results in Analytics, Search, and Metric Explorer.</span></span>
* <span data-ttu-id="61bf5-326">*Le chargement d’un test web multi-étapes échoue*</span><span class="sxs-lookup"><span data-stu-id="61bf5-326">*Uploading a multi-step web test fails*</span></span>

    <span data-ttu-id="61bf5-327">La limite de taille est de 300 Ko.</span><span class="sxs-lookup"><span data-stu-id="61bf5-327">There's a size limit of 300 K.</span></span>

    <span data-ttu-id="61bf5-328">Les boucles ne sont pas prises en charge.</span><span class="sxs-lookup"><span data-stu-id="61bf5-328">Loops aren't supported.</span></span>

    <span data-ttu-id="61bf5-329">Les références à d’autres tests web ne sont pas prises en charge.</span><span class="sxs-lookup"><span data-stu-id="61bf5-329">References to other web tests aren't supported.</span></span>

    <span data-ttu-id="61bf5-330">Les sources de données ne sont pas prises en charge.</span><span class="sxs-lookup"><span data-stu-id="61bf5-330">Data sources aren't supported.</span></span>
* <span data-ttu-id="61bf5-331">*Mon test à plusieurs étapes ne se termine pas.*</span><span class="sxs-lookup"><span data-stu-id="61bf5-331">*My multi-step test doesn't complete*</span></span>

    <span data-ttu-id="61bf5-332">Chaque test possède une limite de 100 demandes.</span><span class="sxs-lookup"><span data-stu-id="61bf5-332">There's a limit of 100 requests per test.</span></span>

    <span data-ttu-id="61bf5-333">Le test s’arrête s’il s’exécute pendant plus de deux minutes.</span><span class="sxs-lookup"><span data-stu-id="61bf5-333">The test is stopped if it runs longer than two minutes.</span></span>
* <span data-ttu-id="61bf5-334">*Comment puis-je exécuter un test avec des certificats clients ?*</span><span class="sxs-lookup"><span data-stu-id="61bf5-334">*How can I run a test with client certificates?*</span></span>

    <span data-ttu-id="61bf5-335">Désolé, ce n’est pas pris en charge.</span><span class="sxs-lookup"><span data-stu-id="61bf5-335">We don't support that, sorry.</span></span>


## <span data-ttu-id="61bf5-336"><a name="next"></a>Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="61bf5-336"><a name="next"></a>Next steps</span></span>
<span data-ttu-id="61bf5-337">[Recherche des journaux de diagnostic][diagnostic]</span><span class="sxs-lookup"><span data-stu-id="61bf5-337">[Search diagnostic logs][diagnostic]</span></span>

<span data-ttu-id="61bf5-338">[Résolution des problèmes][qna]</span><span class="sxs-lookup"><span data-stu-id="61bf5-338">[Troubleshooting][qna]</span></span>

[<span data-ttu-id="61bf5-339">Adresses IP d’agents de test web</span><span class="sxs-lookup"><span data-stu-id="61bf5-339">IP addresses of web test agents</span></span>](app-insights-ip-addresses.md)

<!--Link references-->

[azure-availability]: ../insights-create-web-tests.md
[diagnostic]: app-insights-diagnostic-search.md
[qna]: app-insights-troubleshoot-faq.md
[start]: app-insights-overview.md
