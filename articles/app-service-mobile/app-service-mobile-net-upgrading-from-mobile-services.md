---
title: "Mettre à niveau à partir de Mobile Services vers Azure App Service"
description: "Découvrez comment facilement mettre à niveau votre application Mobile Services vers App Service Mobile Apps"
services: app-service\mobile
documentationcenter: 
author: ggailey777
manager: syntaxc4
editor: 
ms.assetid: 9c0ac353-afb6-462b-ab94-d91b8247322f
ms.service: app-service-mobile
ms.workload: mobile
ms.tgt_pltfrm: mobile
ms.devlang: dotnet
ms.topic: article
ms.date: 10/01/2016
ms.author: glenga
ms.openlocfilehash: 81173b34d0d3b07c5c49d867b1dc5060c7311f12
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/03/2017
---
# <a name="upgrade-your-existing-net-azure-mobile-service-to-app-service"></a><span data-ttu-id="a5ad5-103">Mettre à niveau votre application .NET Azure Mobile Services existante vers App Service</span><span class="sxs-lookup"><span data-stu-id="a5ad5-103">Upgrade your existing .NET Azure Mobile Service to App Service</span></span>
<span data-ttu-id="a5ad5-104">App Service Mobile représente une nouvelle façon de créer des applications mobiles avec Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-104">App Service Mobile is a new way to build mobile applications using Microsoft Azure.</span></span> <span data-ttu-id="a5ad5-105">Pour en savoir plus, consultez [Que sont les applications Mobile Apps ?]</span><span class="sxs-lookup"><span data-stu-id="a5ad5-105">To learn more, see [What are Mobile Apps?].</span></span>

<span data-ttu-id="a5ad5-106">Cette rubrique décrit comment mettre à niveau une application principale .NET existante depuis Azure Mobile Services vers une nouvelle application App Service Mobile Apps.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-106">This topic describes how to upgrade an existing .NET backend application from Azure Mobile Services to a new App Service Mobile Apps.</span></span> <span data-ttu-id="a5ad5-107">Pendant cette mise à niveau, votre application Mobile Services existante peut continuer à fonctionner.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-107">While you perform this upgrade, your existing Mobile Services application can continue to operate.</span></span>   <span data-ttu-id="a5ad5-108">Si vous devez mettre à niveau une application principale Node.js, voir [Mettre à niveau votre application .NET Azure Mobile Services existante vers App Service](app-service-mobile-node-backend-upgrading-from-mobile-services.md).</span><span class="sxs-lookup"><span data-stu-id="a5ad5-108">If you need to upgrade a Node.js backend application, refer to [Upgrading your Node.js Mobile Services](app-service-mobile-node-backend-upgrading-from-mobile-services.md).</span></span>

<span data-ttu-id="a5ad5-109">Quand un serveur principal mobile est mis à niveau vers Azure App Service, il a accès à toutes les fonctionnalités App Service et c’est la [tarification App Service]qui est appliquée, et non celle de Mobile Services.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-109">When a mobile backend is upgraded to Azure App Service, it has access to all App Service features and are billed according to [App Service pricing], not Mobile Services pricing.</span></span>

## <a name="migrate-vs-upgrade"></a><span data-ttu-id="a5ad5-110">Migration et mise à niveau</span><span class="sxs-lookup"><span data-stu-id="a5ad5-110">Migrate vs. upgrade</span></span>
[!INCLUDE [app-service-mobile-migrate-vs-upgrade](../../includes/app-service-mobile-migrate-vs-upgrade.md)]

> [!TIP]
> <span data-ttu-id="a5ad5-111">Il est recommandé d’ [effectuer une migration](app-service-mobile-migrating-from-mobile-services.md) avant une mise à niveau.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-111">It is recommended that you [perform a migration](app-service-mobile-migrating-from-mobile-services.md) before going through an upgrade.</span></span> <span data-ttu-id="a5ad5-112">Ainsi, vous pouvez placer les deux versions de votre application sur le même plan App Service sans générer de frais supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-112">This way, you can put both versions of your application on the same App Service Plan and incur no additional cost.</span></span>
>
>

### <a name="improvements-in-mobile-apps-net-server-sdk"></a><span data-ttu-id="a5ad5-113">Améliorations du Kit de développement logiciel (SDK) serveur .NET Mobile Apps</span><span class="sxs-lookup"><span data-stu-id="a5ad5-113">Improvements in Mobile Apps .NET server SDK</span></span>
<span data-ttu-id="a5ad5-114">La mise à niveau vers le nouveau [Kit de développement logiciel (SDK) Mobile Apps](https://www.nuget.org/packages/Microsoft.Azure.Mobile.Server/) offre les avantages suivants :</span><span class="sxs-lookup"><span data-stu-id="a5ad5-114">Upgrading to the new [Mobile Apps SDK](https://www.nuget.org/packages/Microsoft.Azure.Mobile.Server/) provides the following benefits:</span></span>

* <span data-ttu-id="a5ad5-115">Plus de flexibilité sur les dépendances NuGet.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-115">More flexibility on NuGet dependencies.</span></span> <span data-ttu-id="a5ad5-116">L'environnement d'hébergement ne fournit plus ses propres versions des packages NuGet : vous pouvez donc utiliser d'autres versions compatibles.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-116">The hosting environment no longer provides its own versions of NuGet packages, so you can use alternative compatible versions.</span></span> <span data-ttu-id="a5ad5-117">Toutefois, si de nouvelles résolutions de bogues critiques ou mises à jour de sécurité sont apportées au SDK du serveur mobile ou à ses dépendances, vous devez mettre à jour manuellement votre service.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-117">However, if there are new critical bugfixes or security updates to the Mobile Server SDK or dependencies, you must update your service manually.</span></span>
* <span data-ttu-id="a5ad5-118">Plus de souplesse dans le SDK mobile.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-118">More flexibility in the mobile SDK.</span></span> <span data-ttu-id="a5ad5-119">Vous pouvez contrôler explicitement les fonctionnalités et itinéraires définis, comme l'authentification, les API de table et le point de terminaison de l'enregistrement Push.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-119">You can explicitly control which features and routes are set up, such as authentication, table APIs, and the push registration endpoint.</span></span> <span data-ttu-id="a5ad5-120">Pour en savoir plus, consultez [Utilisation du Kit de développement logiciel (SDK) serveur .NET pour Azure Mobile Apps](app-service-mobile-dotnet-backend-how-to-use-server-sdk.md).</span><span class="sxs-lookup"><span data-stu-id="a5ad5-120">To learn more, see [How to use the .NET server SDK for Azure Mobile Apps](app-service-mobile-dotnet-backend-how-to-use-server-sdk.md).</span></span>
* <span data-ttu-id="a5ad5-121">Prise en charge d'autres itinéraires et types de projets ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-121">Support for other ASP.NET project types and routes.</span></span> <span data-ttu-id="a5ad5-122">Vous pouvez désormais héberger des contrôleurs d'API web et MVC dans votre projet de backend mobile.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-122">You can now host MVC and Web API controllers in the same project as your mobile backend project.</span></span>
* <span data-ttu-id="a5ad5-123">Prise en charge de nouvelles fonctionnalités d'authentification App Service. Cela vous permet d'utiliser une configuration d'authentification commune à vos applications mobiles et web.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-123">Support for new App Service authentication features, which allow you to use a common authentication configuration across your web and mobile apps.</span></span>

## <span data-ttu-id="a5ad5-124"><a name="overview"></a>Présentation de la mise à niveau de base</span><span class="sxs-lookup"><span data-stu-id="a5ad5-124"><a name="overview"></a>Basic upgrade overview</span></span>
<span data-ttu-id="a5ad5-125">Dans de nombreux cas, la mise à niveau consiste simplement à basculer vers le nouveau SDK serveur Mobile Apps et à republier votre code dans une nouvelle instance Mobile Apps.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-125">In many cases, upgrading will be as simple as switching to the new Mobile Apps server SDK and republishing your code onto a new Mobile App instance.</span></span> <span data-ttu-id="a5ad5-126">Il existe toutefois des scénarios qui nécessitent une configuration supplémentaire, tels que les scénarios d'authentification avancée et l'utilisation de tâches planifiées.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-126">There are, however some scenarios which will require some additional configuration, such as advanced authentication scenarios and working with scheduled jobs.</span></span> <span data-ttu-id="a5ad5-127">Ils sont couverts individuellement dans les sections ultérieures.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-127">Each of these is covered in the later sections.</span></span>

> [!TIP]
> <span data-ttu-id="a5ad5-128">Il est conseillé de lire et de comprendre entièrement le reste de cette rubrique avant de commencer une mise à niveau.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-128">It is advised that you read and understand the rest of this topic completely before starting an upgrade.</span></span> <span data-ttu-id="a5ad5-129">Prenez note de toutes les fonctionnalités répertoriées ci-dessous que vous utilisez.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-129">Make note of any features you use which are called out below.</span></span>
>
>

<span data-ttu-id="a5ad5-130">Les Kits de développement logiciel (SDK) clients Mobile Services ne sont **pas** compatibles avec le nouveau Kit de développement logiciel (SDK) serveur Mobile Apps.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-130">The Mobile Services client SDKs are **not** compatible with the new Mobile Apps server SDK.</span></span> <span data-ttu-id="a5ad5-131">Afin d’assurer la continuité du service pour votre application, vous ne devez pas publier des modifications apportées à un site en train de desservir des clients publiés.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-131">In order to provide continuity of service for your app, you should not publish changes to a site currently serving published clients.</span></span> <span data-ttu-id="a5ad5-132">Vous devez plutôt créer une application mobile qui sert de doublon.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-132">Instead, you should create a new mobile app that serves as a duplicate.</span></span> <span data-ttu-id="a5ad5-133">Vous pouvez placer cette application sur le même plan App Service pour éviter d’encourir des frais supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-133">You can put this application on the same App Service plan to avoid incurring additional financial cost.</span></span>

<span data-ttu-id="a5ad5-134">Vous avez alors deux versions de l’application : l’une qui reste la même et délivre les applications publiées et l’autre que vous pouvez mettre à niveau et cibler avec une nouvelle version du client.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-134">You will then have two versions of the application: one which stays the same and serves published apps in the wild, and the other which you can then upgrade and target with a new client release.</span></span> <span data-ttu-id="a5ad5-135">Vous pouvez déplacer et tester votre code à votre rythme, mais vous devez vous assurer que tous les correctifs de bogues que vous apportez sont appliqués aux deux versions.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-135">You can move and test your code at your pace, but you should make sure that any bug fixes you make get applied to both.</span></span> <span data-ttu-id="a5ad5-136">Une fois que le nombre souhaité d’applications clientes ont effectué la mise à jour vers la dernière version, vous supprimez l’application originale qui a migré si vous le souhaitez.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-136">Once you feel that a desired number of client apps in the wild have updated to the latest version, you can delete the original migrated app if you desire.</span></span>

<span data-ttu-id="a5ad5-137">Le processus de mise à niveau est le suivant :</span><span class="sxs-lookup"><span data-stu-id="a5ad5-137">The full outline for the upgrade process is as follows:</span></span>

1. <span data-ttu-id="a5ad5-138">Créer une application Mobile App</span><span class="sxs-lookup"><span data-stu-id="a5ad5-138">Create a new Mobile App</span></span>
2. <span data-ttu-id="a5ad5-139">Mettre à jour le projet pour utiliser les nouveaux Kits de développement logiciel (SDK) serveur</span><span class="sxs-lookup"><span data-stu-id="a5ad5-139">Update the project to use the new Server SDKs</span></span>
3. <span data-ttu-id="a5ad5-140">Publier une nouvelle version de votre application cliente</span><span class="sxs-lookup"><span data-stu-id="a5ad5-140">Release a new version of your client application</span></span>
4. <span data-ttu-id="a5ad5-141">(Facultatif) Supprimer l’instance originale qui a migré</span><span class="sxs-lookup"><span data-stu-id="a5ad5-141">(Optional) Delete your original migrated instance</span></span>

## <span data-ttu-id="a5ad5-142"><a name="mobile-app-version"></a>Création d’une seconde instance d’application</span><span class="sxs-lookup"><span data-stu-id="a5ad5-142"><a name="mobile-app-version"></a>Creating a second application instance</span></span>
<span data-ttu-id="a5ad5-143">La première étape de la mise à niveau consiste à créer la ressource Mobile Apps qui hébergera la nouvelle version de votre application.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-143">The first step in upgrading is to create the Mobile App resource which will host the new version of your application.</span></span> <span data-ttu-id="a5ad5-144">Si vous avez déjà migré un service mobile existant, vous voulez créer cette version sur le même plan d’hébergement.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-144">If you have already migrated an existing mobile service, you will want to create this version on the same hosting plan.</span></span> <span data-ttu-id="a5ad5-145">Ouvrez le [portail Azure] et accédez à votre application migrée.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-145">Open the [Azure portal] and navigate to your migrated application.</span></span> <span data-ttu-id="a5ad5-146">Notez le plan App Service sur lequel elle s’exécute.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-146">Make note of the App Service Plan it is running on.</span></span>

<span data-ttu-id="a5ad5-147">Ensuite, créez la seconde instance d’application en suivant les [instructions de création d’un serveur principal .NET](app-service-mobile-dotnet-backend-how-to-use-server-sdk.md#create-app).</span><span class="sxs-lookup"><span data-stu-id="a5ad5-147">Next, create the second application instance by following the [.NET backend creation instructions](app-service-mobile-dotnet-backend-how-to-use-server-sdk.md#create-app).</span></span> <span data-ttu-id="a5ad5-148">Quand vous êtes invité à sélectionner votre plan App Service ou « plan d’hébergement », choisissez celui de votre application qui a migré.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-148">When prompted to select you App Service Plan or "hosting plan" choose the plan of your migrated application.</span></span>

<span data-ttu-id="a5ad5-149">Vous souhaiterez probablement utiliser les mêmes base de données et hub de notifications que dans Mobile Services.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-149">You will likely want to use the same database and Notification Hub as you did in Mobile Services.</span></span> <span data-ttu-id="a5ad5-150">Copiez ces valeurs en ouvrant le [portail Azure] et en accédant à l’application d’origine, puis cliquez sur **Paramètres** > **Paramètres d’application**.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-150">You can copy these values by opening [Azure portal] and navigating to the original application, then click **Settings** > **Application settings**.</span></span> <span data-ttu-id="a5ad5-151">Sous **Chaînes de connexion**, copiez `MS_NotificationHubConnectionString` et `MS_TableConnectionString`.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-151">Under **Connection Strings**, copy `MS_NotificationHubConnectionString` and `MS_TableConnectionString`.</span></span> <span data-ttu-id="a5ad5-152">Accédez à votre nouveau site de mise à niveau et collez-les en remplaçant les valeurs existantes.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-152">Navigate to your new upgrade site and paste them in, overwriting any existing values.</span></span> <span data-ttu-id="a5ad5-153">Répétez ce processus pour tous les autres paramètres d’application dont votre application a besoin.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-153">Repeat this process for any other application settings your app needs.</span></span> <span data-ttu-id="a5ad5-154">Si vous n’utilisez pas un service qui a migré, vous pouvez lire des chaînes de connexion et des paramètres d’application sous l’onglet **Configurer** de la section Mobile Services du [portail Azure Classic].</span><span class="sxs-lookup"><span data-stu-id="a5ad5-154">If not using a migrated service, you can read connection strings and app settings from the **Configure** tab of the Mobile Services section of the [Azure classic portal].</span></span>

<span data-ttu-id="a5ad5-155">Faites une copie du projet ASP.NET de votre application et publiez-la sur votre nouveau site.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-155">Make a copy of the ASP.NET project for your application and publish it to your new site.</span></span> <span data-ttu-id="a5ad5-156">En utilisant une copie de votre application cliente mise à jour avec la nouvelle URL, vérifiez que tout fonctionne comme prévu.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-156">Using a copy of your client application updated with the new URL, validate that everything works as expected.</span></span>

## <a name="updating-the-server-project"></a><span data-ttu-id="a5ad5-157">Mise à jour du projet serveur</span><span class="sxs-lookup"><span data-stu-id="a5ad5-157">Updating the server project</span></span>
<span data-ttu-id="a5ad5-158">Mobile Apps fournit une nouveau [Kit de développement logiciel (SDK) Mobile App Server] qui fournit de nombreuses fonctionnalités identiques à celles du runtime Mobile Services.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-158">Mobile Apps provides a new [Mobile App Server SDK] which provides much of the same functionality as the Mobile Services runtime.</span></span> <span data-ttu-id="a5ad5-159">Tout d’abord, vous devez supprimer toutes les références aux packages Mobile Services.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-159">First, you should remove all references to the Mobile Services packages.</span></span> <span data-ttu-id="a5ad5-160">Dans le gestionnaire de packages NuGet, recherchez `WindowsAzure.MobileServices.Backend`.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-160">In the NuGet package manager, search for `WindowsAzure.MobileServices.Backend`.</span></span> <span data-ttu-id="a5ad5-161">La plupart des applications affichent plusieurs packages, notamment `WindowsAzure.MobileServices.Backend.Tables` et `WindowsAzure.MobileServices.Backend.Entity`.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-161">Most apps will see several packages here, including `WindowsAzure.MobileServices.Backend.Tables` and `WindowsAzure.MobileServices.Backend.Entity`.</span></span> <span data-ttu-id="a5ad5-162">Dans ce cas, commencez avec le package le plus bas dans l’arborescence des dépendances, notamment `Entity`et supprimez-le.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-162">In such a case, start with the lowest package in the dependency tree, such as `Entity`, and remove it.</span></span> <span data-ttu-id="a5ad5-163">Quand vous y êtes invité, ne supprimez pas tous les packages dépendants.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-163">When prompted, do not remove all dependant packages.</span></span> <span data-ttu-id="a5ad5-164">Répétez ce processus jusqu’à ce que vous ayez supprimé `WindowsAzure.MobileServices.Backend` .</span><span class="sxs-lookup"><span data-stu-id="a5ad5-164">Repeat this process until you have removed `WindowsAzure.MobileServices.Backend` itself.</span></span>

<span data-ttu-id="a5ad5-165">À ce stade, vous avez un projet qui ne fait plus référence aux SDK Mobile Services.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-165">At this point you will have a project that no longer references Mobile Services SDKs.</span></span>

<span data-ttu-id="a5ad5-166">Ensuite, vous allez ajouter des références aux SDK Mobile Apps.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-166">Next you will add references the Mobile Apps SDK.</span></span> <span data-ttu-id="a5ad5-167">Pour cette mise à niveau, la plupart des développeurs préfèrent télécharger et installer le package `Microsoft.Azure.Mobile.Server.Quickstart` , car il permet d’extraire la totalité de l’ensemble requis.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-167">For this upgrade, most developers will want to download and install the `Microsoft.Azure.Mobile.Server.Quickstart` package, as this will pull in the entire required set.</span></span>

<span data-ttu-id="a5ad5-168">De nombreuses erreurs de compilateur proviennent des différences entre les SDK, mais elles sont faciles à corriger et elles sont décrites plus loin dans cette section.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-168">There will be quite a few compiler errors resulting from differences between the SDKs, but these are easy to address and are covered in the rest of this section.</span></span>

### <a name="base-configuration"></a><span data-ttu-id="a5ad5-169">Configuration de base</span><span class="sxs-lookup"><span data-stu-id="a5ad5-169">Base configuration</span></span>
<span data-ttu-id="a5ad5-170">Ensuite, dans WebApiConfig.cs, vous pouvez remplacer :</span><span class="sxs-lookup"><span data-stu-id="a5ad5-170">Then, in WebApiConfig.cs, you can replace:</span></span>

        // Use this class to set configuration options for your mobile service
        ConfigOptions options = new ConfigOptions();

        // Use this class to set WebAPI configuration options
        HttpConfiguration config = ServiceConfig.Initialize(new ConfigBuilder(options));

<span data-ttu-id="a5ad5-171">par</span><span class="sxs-lookup"><span data-stu-id="a5ad5-171">with</span></span>

        HttpConfiguration config = new HttpConfiguration();
        new MobileAppConfiguration()
            .UseDefaultConfiguration()
        .ApplyTo(config);

> [!NOTE]
> <span data-ttu-id="a5ad5-172">Si vous souhaitez en savoir plus sur le nouveau SDK serveur .NET et sur la façon d’ajouter/de supprimer des fonctionnalités de votre application, consultez la rubrique [Utilisation du Kit de développement logiciel (SDK) serveur .NET] .</span><span class="sxs-lookup"><span data-stu-id="a5ad5-172">If you wish to learn more about the new .NET server SDK and how to add/remove features from your app, please see the [How to use the .NET server SDK] topic.</span></span>
>
>

<span data-ttu-id="a5ad5-173">Si votre application utilise les fonctionnalités d’authentification, vous devez également inscrire un intergiciel (middleware) OWIN.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-173">If your app makes use of the authentication features, you will also need to register an OWIN middleware.</span></span> <span data-ttu-id="a5ad5-174">Dans ce cas, vous devez déplacer le code de configuration ci-dessus dans une nouvelle classe de démarrage OWIN.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-174">In this case, you should move the above configuration code into a new OWIN Startup class.</span></span>

1. <span data-ttu-id="a5ad5-175">Ajoutez le package NuGet `Microsoft.Owin.Host.SystemWeb` s’il n’est pas déjà inclus dans votre projet.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-175">Add the NuGet package `Microsoft.Owin.Host.SystemWeb` if it is not already included in your project.</span></span>
2. <span data-ttu-id="a5ad5-176">Dans Visual Studio, cliquez avec le bouton droit sur votre projet, puis sélectionnez **Ajouter** -> **Nouvel élément**.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-176">In Visual Studio, right click on your project and select **Add** -> **New Item**.</span></span> <span data-ttu-id="a5ad5-177">Sélectionnez **Web** -> **Général** -> **Classe de démarrage OWIN**.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-177">Select **Web** -> **General** -> **OWIN Startup class**.</span></span>
3. <span data-ttu-id="a5ad5-178">Déplacez le code ci-dessus pour MobileAppConfiguration de `WebApiConfig.Register()` vers la méthode `Configuration()` de votre nouvelle classe de démarrage.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-178">Move the above code for MobileAppConfiguration from `WebApiConfig.Register()` to the `Configuration()` method of your new startup class.</span></span>

<span data-ttu-id="a5ad5-179">Assurez-vous que la méthode `Configuration()` se termine par :</span><span class="sxs-lookup"><span data-stu-id="a5ad5-179">Make sure the `Configuration()` method ends with:</span></span>

        app.UseWebApi(config)
        app.UseAppServiceAuthentication(config);

<span data-ttu-id="a5ad5-180">Il existe des modifications supplémentaires liées à l’authentification qui sont abordées dans la section dédiée à l’authentification ci-après.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-180">There are additional changes related to authentication which are covered in the full authentication section below.</span></span>

### <a name="working-with-data"></a><span data-ttu-id="a5ad5-181">Utilisation des données</span><span class="sxs-lookup"><span data-stu-id="a5ad5-181">Working with Data</span></span>
<span data-ttu-id="a5ad5-182">Dans Mobile Services, le nom de l’application mobile servait de nom de schéma par défaut dans la configuration Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-182">In Mobile Services, the mobile app name served as the default schema name in the Entity Framework setup.</span></span>

<span data-ttu-id="a5ad5-183">Pour vous assurer d’avoir le même schéma référencé que celui d’avant, utilisez la commande suivante pour définir le schéma dans le DbContext de votre application :</span><span class="sxs-lookup"><span data-stu-id="a5ad5-183">To ensure that you have the same schema being referenced as before, use the following to set the schema in the DbContext for your application:</span></span>

        string schema = System.Configuration.ConfigurationManager.AppSettings.Get("MS_MobileServiceName");

<span data-ttu-id="a5ad5-184">Vérifiez que MS_MobileServiceName est défini si vous effectuez l’étape ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-184">Please make sure you have MS_MobileServiceName set if you do the above.</span></span> <span data-ttu-id="a5ad5-185">Vous pouvez également fournir un autre nom de schéma si votre application l’a personnalisé précédemment.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-185">You can also provide another schema name if your application customized this previously.</span></span>

### <a name="system-properties"></a><span data-ttu-id="a5ad5-186">Propriétés système</span><span class="sxs-lookup"><span data-stu-id="a5ad5-186">System Properties</span></span>
#### <a name="naming"></a><span data-ttu-id="a5ad5-187">Dénomination</span><span class="sxs-lookup"><span data-stu-id="a5ad5-187">Naming</span></span>
<span data-ttu-id="a5ad5-188">Dans le Kit de développement logiciel (SDK) serveur Azure Mobile Services, les propriétés système contiennent toujours un préfixe constitué de deux traits de soulignement (`__`) :</span><span class="sxs-lookup"><span data-stu-id="a5ad5-188">In the Azure Mobile Services server SDK, system properties always contain a double underscore (`__`) prefix for the properties:</span></span>

* <span data-ttu-id="a5ad5-189">__createdAt</span><span class="sxs-lookup"><span data-stu-id="a5ad5-189">__createdAt</span></span>
* <span data-ttu-id="a5ad5-190">__updatedAt</span><span class="sxs-lookup"><span data-stu-id="a5ad5-190">__updatedAt</span></span>
* <span data-ttu-id="a5ad5-191">__deleted</span><span class="sxs-lookup"><span data-stu-id="a5ad5-191">__deleted</span></span>
* <span data-ttu-id="a5ad5-192">__version</span><span class="sxs-lookup"><span data-stu-id="a5ad5-192">__version</span></span>

<span data-ttu-id="a5ad5-193">Les Kits de développement logiciel (SDK) clients Mobile Services ont une logique spéciale pour l’analyse des propriétés système dans ce format.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-193">The Mobile Services client SDKs have special logic for parsing system properties in this format.</span></span>

<span data-ttu-id="a5ad5-194">Dans Azure Mobile Apps, les propriétés système n’ont plus de format spécial et portent les noms suivants :</span><span class="sxs-lookup"><span data-stu-id="a5ad5-194">In Azure Mobile Apps, system properties no longer have a special format and have the following names:</span></span>

* <span data-ttu-id="a5ad5-195">createdAt</span><span class="sxs-lookup"><span data-stu-id="a5ad5-195">createdAt</span></span>
* <span data-ttu-id="a5ad5-196">updatedAt</span><span class="sxs-lookup"><span data-stu-id="a5ad5-196">updatedAt</span></span>
* <span data-ttu-id="a5ad5-197">deleted</span><span class="sxs-lookup"><span data-stu-id="a5ad5-197">deleted</span></span>
* <span data-ttu-id="a5ad5-198">version</span><span class="sxs-lookup"><span data-stu-id="a5ad5-198">version</span></span>

<span data-ttu-id="a5ad5-199">Les Kits de développement logiciel (SDK) clients Mobile Apps utilisent les nouveaux noms de propriétés système, donc aucune modification du code client n’est exigée.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-199">The Mobile Apps client SDKs use the new system properties names, so no changes are required to client code.</span></span> <span data-ttu-id="a5ad5-200">Toutefois, si vous effectuez directement des appels REST à votre service, alors vous devez modifier vos requêtes en conséquence.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-200">However, if you are directly making REST calls to your service then you should change your queries accordingly.</span></span>

#### <a name="local-store"></a><span data-ttu-id="a5ad5-201">Magasin local</span><span class="sxs-lookup"><span data-stu-id="a5ad5-201">Local store</span></span>
<span data-ttu-id="a5ad5-202">Les modifications apportées aux noms des propriétés système signifient qu’une base de données locale de synchronisation hors connexion pour Mobile Services n’est pas compatible avec Mobile Apps.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-202">The changes to the names of system properties mean that an offline sync local database for Mobile Services is not compatible with Mobile Apps.</span></span> <span data-ttu-id="a5ad5-203">Si possible, vous devez éviter de mettre à niveau des applications clientes depuis Mobile Services vers Mobile Apps tant que les modifications en attente n’ont pas été envoyées au serveur.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-203">If possible, you should avoid upgrading client apps from Mobile Services to Mobile Apps until after pending changes have been sent to the server.</span></span> <span data-ttu-id="a5ad5-204">Ensuite, l’application mise à niveau doit utiliser un nouveau nom de fichier de base de données.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-204">Then, the upgraded app should use a new database filename.</span></span>

<span data-ttu-id="a5ad5-205">Si une application cliente est mise à niveau depuis Mobile Services vers Mobile Apps alors qu’il existe des modifications hors connexion en attente dans la file d’attente des opérations, alors la base de données système doit être mise à jour pour utiliser les nouveaux noms de colonne.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-205">If a client app is upgraded from Mobile Services to Mobile Apps while there are pending offline changes in the operation queue, then the system database must be updated to use the new column names.</span></span> <span data-ttu-id="a5ad5-206">Sur iOS, cette mise à jour est possible en utilisant de légères migrations pour modifier les noms de colonne.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-206">On iOS, this can be achieved using lightweight migrations to change the column names.</span></span> <span data-ttu-id="a5ad5-207">Sur Android et le client géré .NET, vous devez écrire du code SQL personnalisé pour renommer les colonnes de vos tables d’objets de données.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-207">On Android and the .NET managed client, you should write custom SQL to rename the columns for your data object tables.</span></span>

<span data-ttu-id="a5ad5-208">Sur iOS, vous devez modifier votre schéma de base de données principal pour vos entités de données afin qu’il corresponde à ce qui suit.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-208">On iOS, you should change your Core Data schema for your data entities to match the following.</span></span> <span data-ttu-id="a5ad5-209">Notez que les propriétés `createdAt`, `updatedAt` et `version` n’ont plus de préfixe `ms_` :</span><span class="sxs-lookup"><span data-stu-id="a5ad5-209">Note that the properties `createdAt`, `updatedAt` and `version` no longer have an `ms_` prefix:</span></span>

| <span data-ttu-id="a5ad5-210">Attribut</span><span class="sxs-lookup"><span data-stu-id="a5ad5-210">Attribute</span></span> | <span data-ttu-id="a5ad5-211">Type</span><span class="sxs-lookup"><span data-stu-id="a5ad5-211">Type</span></span> | <span data-ttu-id="a5ad5-212">Remarque</span><span class="sxs-lookup"><span data-stu-id="a5ad5-212">Note</span></span> |
| --- | --- | --- |
| <span data-ttu-id="a5ad5-213">id</span><span class="sxs-lookup"><span data-stu-id="a5ad5-213">id</span></span> |<span data-ttu-id="a5ad5-214">Chaîne, marquée requise</span><span class="sxs-lookup"><span data-stu-id="a5ad5-214">String, marked required</span></span> |<span data-ttu-id="a5ad5-215">clé primaire dans le magasin distant</span><span class="sxs-lookup"><span data-stu-id="a5ad5-215">primary key in remote store</span></span> |
| <span data-ttu-id="a5ad5-216">createdAt</span><span class="sxs-lookup"><span data-stu-id="a5ad5-216">createdAt</span></span> |<span data-ttu-id="a5ad5-217">Date</span><span class="sxs-lookup"><span data-stu-id="a5ad5-217">Date</span></span> |<span data-ttu-id="a5ad5-218">(facultatif) correspond à la propriété système createdAt</span><span class="sxs-lookup"><span data-stu-id="a5ad5-218">(optional) maps to createdAt system property</span></span> |
| <span data-ttu-id="a5ad5-219">updatedAt</span><span class="sxs-lookup"><span data-stu-id="a5ad5-219">updatedAt</span></span> |<span data-ttu-id="a5ad5-220">Date</span><span class="sxs-lookup"><span data-stu-id="a5ad5-220">Date</span></span> |<span data-ttu-id="a5ad5-221">(facultatif) correspond à la propriété système updatedAt</span><span class="sxs-lookup"><span data-stu-id="a5ad5-221">(optional) maps to updatedAt system property</span></span> |
| <span data-ttu-id="a5ad5-222">version</span><span class="sxs-lookup"><span data-stu-id="a5ad5-222">version</span></span> |<span data-ttu-id="a5ad5-223">String</span><span class="sxs-lookup"><span data-stu-id="a5ad5-223">String</span></span> |<span data-ttu-id="a5ad5-224">(facultatif) permet de détecter les conflits, correspond à version</span><span class="sxs-lookup"><span data-stu-id="a5ad5-224">(optional) used to detect conflicts, maps to version</span></span> |

#### <a name="querying-system-properties"></a><span data-ttu-id="a5ad5-225">Interrogation des propriétés système</span><span class="sxs-lookup"><span data-stu-id="a5ad5-225">Querying system properties</span></span>
<span data-ttu-id="a5ad5-226">Dans Azure Mobile Services, les propriétés système ne sont pas envoyées par défaut, mais uniquement quand elles sont demandées à l’aide de la chaîne de requête `__systemProperties`.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-226">In Azure Mobile Services, system properties are not sent by default, but only when they are requested using the query string `__systemProperties`.</span></span> <span data-ttu-id="a5ad5-227">Par opposition, dans Azure Mobile Apps, les propriétés système sont **toujours sélectionnées** car elles font partie du modèle objet du SDK serveur.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-227">In contrast, in Azure Mobile Apps system properties are **always selected** since they are part of the server SDK object model.</span></span>

<span data-ttu-id="a5ad5-228">Cette modification affecte principalement les implémentations personnalisées des gestionnaires de domaine, comme les extensions de `MappedEntityDomainManager`.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-228">This change mainly impacts custom implementations of domain managers, such as extensions of `MappedEntityDomainManager`.</span></span> <span data-ttu-id="a5ad5-229">Dans Mobile Services, si un client ne demande jamais de propriétés système, il est possible d’utiliser un `MappedEntityDomainManager` qui ne correspond en fait pas à toutes les propriétés.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-229">In Mobile Services, if a client never requests any system properties, it is possible to use a `MappedEntityDomainManager` that does not actually map all properties.</span></span> <span data-ttu-id="a5ad5-230">Toutefois, dans Azure Mobile Apps, ces propriétés non mappées provoquent une erreur dans les requêtes GET.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-230">However, in Azure Mobile Apps, these unmapped properties will cause an error in GET queries.</span></span>

<span data-ttu-id="a5ad5-231">Pour résoudre ce problème, le plus simple consiste à modifier vos DTO pour qu’ils héritent de `ITableData` au lieu de `EntityData`.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-231">The easiest way to resolve the issue is to modify your DTOs so that they inherit from `ITableData` instead of `EntityData`.</span></span> <span data-ttu-id="a5ad5-232">Ensuite, ajoutez l’attribut `[NotMapped]` aux champs à omettre.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-232">Then, add the `[NotMapped]` attribute to the fields that should be omitted.</span></span>

<span data-ttu-id="a5ad5-233">L’exemple suivant définit `TodoItem` sans aucune propriété système :</span><span class="sxs-lookup"><span data-stu-id="a5ad5-233">For example, the following defines `TodoItem` with no system properties:</span></span>

    using System.ComponentModel.DataAnnotations.Schema;

    public class TodoItem : ITableData
    {
        public string Text { get; set; }

        public bool Complete { get; set; }

        public string Id { get; set; }

        [NotMapped]
        public DateTimeOffset? CreatedAt { get; set; }

        [NotMapped]
        public DateTimeOffset? UpdatedAt { get; set; }

        [NotMapped]
        public bool Deleted { get; set; }

        [NotMapped]
        public byte[] Version { get; set; }
    }

<span data-ttu-id="a5ad5-234">Remarque : si vous obtenez des erreurs sur `NotMapped`, ajoutez une référence à l’assembly `System.ComponentModel.DataAnnotations`.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-234">Note: if you get errors on `NotMapped`, add a reference to the assembly `System.ComponentModel.DataAnnotations`.</span></span>

### <a name="cors"></a><span data-ttu-id="a5ad5-235">CORS</span><span class="sxs-lookup"><span data-stu-id="a5ad5-235">CORS</span></span>
<span data-ttu-id="a5ad5-236">Mobile Services incluait une prise en charge de CORS en encapsulant la solution ASP.NET CORS.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-236">Mobile Services included some support for CORS by wrapping the ASP.NET CORS solution.</span></span> <span data-ttu-id="a5ad5-237">Cette couche d’encapsulation a été supprimée pour donner plus de contrôle au développeur, donc vous pouvez exploiter directement la [prise en charge ASP.NET CORS](http://www.asp.net/web-api/overview/security/enabling-cross-origin-requests-in-web-api).</span><span class="sxs-lookup"><span data-stu-id="a5ad5-237">This wrapping layer has been removed to give the developer more control, so you can directly leverage [ASP.NET CORS support](http://www.asp.net/web-api/overview/security/enabling-cross-origin-requests-in-web-api).</span></span>

<span data-ttu-id="a5ad5-238">Les principales sources de préoccupation en cas d’utilisation de CORS concernent les en-têtes `eTag` et `Location` qui doivent être autorisés pour que les Kits de développement logiciel (SDK) clients puissent fonctionner correctement.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-238">The main areas of concern if using CORS are that the `eTag` and `Location` headers must be allowed in order for the client SDKs to work properly.</span></span>

### <a name="push-notifications"></a><span data-ttu-id="a5ad5-239">Notifications Push</span><span class="sxs-lookup"><span data-stu-id="a5ad5-239">Push Notifications</span></span>
<span data-ttu-id="a5ad5-240">En matière de notifications Push, l'élément principal qui vous semblera peut-être manquant dans le kit de développement logiciel de serveur est la classe PushRegistrationHandler.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-240">For push, the main item that you may find missing from the Server SDK is the PushRegistrationHandler class.</span></span> <span data-ttu-id="a5ad5-241">Les inscriptions sont traitées légèrement différemment dans Mobile Apps et les inscriptions sans balise sont activées par défaut.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-241">Registrations are handled slightly differently in Mobile Apps, and tagless registrations are enabled by default.</span></span> <span data-ttu-id="a5ad5-242">La gestion des balises peut être accomplie à l'aide d'API personnalisées.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-242">Managing tags may be accomplished by using custom APIs.</span></span> <span data-ttu-id="a5ad5-243">Consultez les instructions liées à l’ [inscription des balises](app-service-mobile-dotnet-backend-how-to-use-server-sdk.md#tags) pour plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-243">Please see the [registering for tags](app-service-mobile-dotnet-backend-how-to-use-server-sdk.md#tags) instructions for more information.</span></span>

### <a name="scheduled-jobs"></a><span data-ttu-id="a5ad5-244">Tâches planifiées</span><span class="sxs-lookup"><span data-stu-id="a5ad5-244">Scheduled Jobs</span></span>
<span data-ttu-id="a5ad5-245">Les tâches planifiées ne sont pas intégrées à Mobile Apps, si bien que toutes les tâches existantes dans votre serveur principal .NET doivent être mises à niveau individuellement.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-245">Scheduled jobs are not built into Mobile Apps, so any existing jobs that you have in your .NET backend will need to be upgraded individually.</span></span> <span data-ttu-id="a5ad5-246">Une option consiste à créer une [tâche web] planifiée sur le site de code Mobile App.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-246">One option is to create a scheduled [Web Job] on the Mobile App code site.</span></span> <span data-ttu-id="a5ad5-247">Vous pouvez également configurer un contrôleur contenant le code de votre tâche et configurer [Azure Scheduler] pour traiter ce point de terminaison au moment prévu.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-247">You could also set up a controller that holds your job code and configure the [Azure Scheduler] to hit that endpoint on the expected schedule.</span></span>

### <a name="miscellaneous-changes"></a><span data-ttu-id="a5ad5-248">Modifications diverses</span><span class="sxs-lookup"><span data-stu-id="a5ad5-248">Miscellaneous changes</span></span>
<span data-ttu-id="a5ad5-249">Tous les ApiController consommés par un client mobile doivent désormais avoir l’attribut `[MobileAppController]` .</span><span class="sxs-lookup"><span data-stu-id="a5ad5-249">All ApiControllers which will be consumed by a mobile client must now have the `[MobileAppController]` attribute.</span></span> <span data-ttu-id="a5ad5-250">Celui-ci n’est plus inclus par défaut si bien que les autres ApiController ne sont pas affectés par les formateurs mobiles.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-250">This is no longer included by default so that other ApiControllers to go unaffected by the mobile formatters.</span></span>

<span data-ttu-id="a5ad5-251">L’objet `ApiServices` ne fait plus partie du SDK.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-251">The `ApiServices` object is no longer part of the SDK.</span></span> <span data-ttu-id="a5ad5-252">Pour accéder aux paramètres de Mobile Apps, vous pouvez utiliser les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="a5ad5-252">To access Mobile App settings, you can use the following:</span></span>

    MobileAppSettingsDictionary settings = this.Configuration.GetMobileAppSettingsProvider().GetMobileAppSettings();

<span data-ttu-id="a5ad5-253">De même, la journalisation s’effectue désormais avec le traçage ASP.NET standard :</span><span class="sxs-lookup"><span data-stu-id="a5ad5-253">Similarly, logging is now accomplished using the standard ASP.NET trace writing:</span></span>

    ITraceWriter traceWriter = this.Configuration.Services.GetTraceWriter();
    traceWriter.Info("Hello, World");  

## <span data-ttu-id="a5ad5-254"><a name="authentication"></a>Considérations relatives à l’authentification</span><span class="sxs-lookup"><span data-stu-id="a5ad5-254"><a name="authentication"></a>Authentication considerations</span></span>
<span data-ttu-id="a5ad5-255">Les composants d’authentification de Mobile Services sont maintenant déplacés vers la fonctionnalité d’authentification/autorisation App Service.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-255">The authentication components of Mobile Services have now been moved into the App Service Authentication/Authorization feature.</span></span> <span data-ttu-id="a5ad5-256">Pour en savoir plus sur l’activation de cette fonctionnalité pour votre site, consultez la rubrique [Ajouter l’authentification à votre application mobile](app-service-mobile-ios-get-started-users.md) .</span><span class="sxs-lookup"><span data-stu-id="a5ad5-256">You can learn about enabling this for your site by reading the [Add authentication to your mobile app](app-service-mobile-ios-get-started-users.md) topic.</span></span>

<span data-ttu-id="a5ad5-257">Pour certains fournisseurs, comme AAD, Facebook et Google, vous devez être en mesure d’exploiter l’inscription existante à partir de l’application de votre copie.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-257">For some providers, such as AAD, Facebook, and Google, you should be able to leverage the existing registration from your copy application.</span></span> <span data-ttu-id="a5ad5-258">Il vous suffit simplement d’accéder au portail du fournisseur d’identité et d’ajouter une nouvelle URL de redirection à l’inscription.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-258">You simply need to navigate to the identity provider's portal and add a new redirect URL to the registration.</span></span> <span data-ttu-id="a5ad5-259">Ensuite, configurez l’authentification/autorisation App Service avec l’ID client et le secret.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-259">Then configure App Service Authentication/Authorization with the client ID and secret.</span></span>

### <a name="controller-action-authorization"></a><span data-ttu-id="a5ad5-260">Autorisation des actions de contrôleur</span><span class="sxs-lookup"><span data-stu-id="a5ad5-260">Controller action authorization</span></span>
<span data-ttu-id="a5ad5-261">Toutes les instances de l’attribut `[AuthorizeLevel(AuthorizationLevel.User)]` doivent désormais être modifiées pour utiliser l’attribut `[Authorize]` ASP.NET standard.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-261">Any instances of the `[AuthorizeLevel(AuthorizationLevel.User)]` attribute must now be changed to use the standard ASP.NET `[Authorize]` attribute.</span></span> <span data-ttu-id="a5ad5-262">En outre, les contrôleurs sont désormais anonymes par défaut, comme dans d’autres applications ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-262">Additionally, controllers are now Anonymous by default, as in other ASP.NET applications.</span></span>
<span data-ttu-id="a5ad5-263">Si vous utilisez une des autres options AuthorizeLevel, comme Admin ou Application, notez qu’elles ont disparu.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-263">If you were using one of the other AuthorizeLevel options, such as Admin or Application, please note that these are gone.</span></span> <span data-ttu-id="a5ad5-264">Vous pouvez à la place configurer AuthorizationFilters pour utiliser des secrets partagés ou configurer un principal du service AAD pour activer les appels de service à service en toute sécurité.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-264">You can instead set up AuthorizationFilters for shared secrets or configure an AAD Service Principal to enable service-to-service calls securely.</span></span>

### <a name="getting-additional-user-information"></a><span data-ttu-id="a5ad5-265">Obtention d’informations utilisateur supplémentaires</span><span class="sxs-lookup"><span data-stu-id="a5ad5-265">Getting additional user information</span></span>
<span data-ttu-id="a5ad5-266">Vous pouvez obtenir des informations utilisateur supplémentaires, notamment des jetons d’accès par le biais de la méthode `GetAppServiceIdentityAsync()` :</span><span class="sxs-lookup"><span data-stu-id="a5ad5-266">You can get additional user information, including access tokens through the `GetAppServiceIdentityAsync()` method:</span></span>

        FacebookCredentials creds = await this.User.GetAppServiceIdentityAsync<FacebookCredentials>();

<span data-ttu-id="a5ad5-267">De plus, si votre application accepte les dépendances vis-à-vis des ID utilisateur, notamment en les stockant dans une base de données, il est important de noter que les ID utilisateur sont différents entre Mobile Services et App Service Mobile Apps.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-267">Additionally, if your application takes dependencies on user IDs, such as storing them in a database, it is important to note that the user IDs between Mobile Services and App Service Mobile Apps are different.</span></span> <span data-ttu-id="a5ad5-268">Vous pouvez quand même obtenir l’ID utilisateur Mobile Services.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-268">You can still get the Mobile Services User ID, though.</span></span> <span data-ttu-id="a5ad5-269">Toutes les sous-classes ProviderCredentials ont une propriété UserId.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-269">All of the ProviderCredentials subclasses have a UserId property.</span></span> <span data-ttu-id="a5ad5-270">Ainsi, en reprenant l’exemple précédent :</span><span class="sxs-lookup"><span data-stu-id="a5ad5-270">So continuing from the example before:</span></span>

        string mobileServicesUserId = creds.Provider + ":" + creds.UserId;

<span data-ttu-id="a5ad5-271">si votre application accepte les dépendances vis-à-vis des ID utilisateur, il est important d’exploiter la même inscription avec un fournisseur d’identité dans la mesure du possible.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-271">If your app does take any dependencies on user IDs, it is important that you leverage the same registration with an identity provider if possible.</span></span> <span data-ttu-id="a5ad5-272">Les ID utilisateur sont généralement limités à l'inscription de l'application qui a été utilisée, si bien que l'introduction d'une nouvelle inscription peut créer des problèmes de mise en correspondance des utilisateurs avec leurs données.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-272">User IDs are typically scoped to the application registration that was used, so introducing a new registration could create problems with matching users to their data.</span></span>

### <a name="custom-authentication"></a><span data-ttu-id="a5ad5-273">Authentification personnalisée</span><span class="sxs-lookup"><span data-stu-id="a5ad5-273">Custom authentication</span></span>
<span data-ttu-id="a5ad5-274">Si votre application utilise une solution d’authentification personnalisée, assurez-vous que le site mis à niveau a accès au système.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-274">If your app is using a custom authentication solution, you will want to make sure that the upgraded site has access to the system.</span></span> <span data-ttu-id="a5ad5-275">Suivez les nouvelles instructions liées à l’authentification personnalisée indiquées dans [Présentation du Kit de développement logiciel (SDK) serveur .NET] pour intégrer votre solution.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-275">Follow the new instructions for custom authentication in the [.NET server SDK overview] to integrate your solution.</span></span> <span data-ttu-id="a5ad5-276">Notez que les composants d’authentification personnalisée sont encore en version préliminaire.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-276">Please note that the custom authentication components are still in preview.</span></span>

## <span data-ttu-id="a5ad5-277"><a name="updating-clients"></a>Mise à jour des clients</span><span class="sxs-lookup"><span data-stu-id="a5ad5-277"><a name="updating-clients"></a>Updating clients</span></span>
<span data-ttu-id="a5ad5-278">Une fois que vous avez un serveur principal Mobile App opérationnel, vous pouvez travailler sur une nouvelle version de votre application cliente qui la consomme.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-278">Once you have an operational Mobile App backend, you can work on a new version of your client application which consumes it.</span></span> <span data-ttu-id="a5ad5-279">Mobile Apps inclut également une nouvelle version des Kits de développement logiciel (SDK) clients, et comme pour la mise à niveau serveur ci-dessus, vous devez supprimer toutes les références aux Kits de développement logiciel (SDK) Mobile Services avant d’installer les versions Mobile Apps.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-279">Mobile Apps also includes a new version of the client SDKs, and similar to the server upgrade above, you will need to remove all references to the Mobile Services SDKs before installing the Mobile Apps versions.</span></span>

<span data-ttu-id="a5ad5-280">L’une des principales modifications entre les versions a trait aux constructeurs qui n’exigent plus de clé d’application.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-280">One of the main changes between the versions is that the constructors no longer require an application key.</span></span> <span data-ttu-id="a5ad5-281">Désormais, vous passez simplement l’URL de votre application mobile.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-281">You now simply pass in the URL of your Mobile App.</span></span> <span data-ttu-id="a5ad5-282">Par exemple, sur les clients .NET, le constructeur `MobileServiceClient` est désormais :</span><span class="sxs-lookup"><span data-stu-id="a5ad5-282">For example, on the .NET clients, the `MobileServiceClient` constructor is now:</span></span>

        public static MobileServiceClient MobileService = new MobileServiceClient(
            "https://contoso.azurewebsites.net", // URL of the Mobile App
        );

<span data-ttu-id="a5ad5-283">Pour en savoir plus sur l’installation des nouveaux Kits de développement logiciel (SDK) et l’utilisation de la nouvelle structure, cliquez sur les liens ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="a5ad5-283">You can read about installing the new SDKs and using the new structure via the links below:</span></span>

* [<span data-ttu-id="a5ad5-284">iOS version 3.0.0 ou ultérieure</span><span class="sxs-lookup"><span data-stu-id="a5ad5-284">iOS version 3.0.0 or later</span></span>](app-service-mobile-ios-how-to-use-client-library.md)
* [<span data-ttu-id="a5ad5-285">.NET (Windows/Xamarin) version 2.0.0 ou ultérieure</span><span class="sxs-lookup"><span data-stu-id="a5ad5-285">.NET (Windows/Xamarin) version 2.0.0 or later</span></span>](app-service-mobile-dotnet-how-to-use-client-library.md)

<span data-ttu-id="a5ad5-286">Si votre application emploie des notifications Push, notez les instructions d’inscription spécifiques de chaque plateforme, car elles ont également fait l’objet de quelques modifications.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-286">If your application makes use of push notifications, make note of the specific registration instructions for each platform, as there have been some changes there as well.</span></span>

<span data-ttu-id="a5ad5-287">Une fois la nouvelle version cliente prête, essayez-la par rapport à votre projet de serveur mis à niveau.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-287">When you have the new client version ready, try it out against your upgraded server project.</span></span> <span data-ttu-id="a5ad5-288">Après avoir vérifié qu’elle fonctionne, vous pouvez publier une nouvelle version de votre application pour vos clients.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-288">After validating that it works, you can release a new version of your application to customers.</span></span> <span data-ttu-id="a5ad5-289">Enfin, une fois que vos clients ont eu l’occasion de recevoir ces mises à jour, vous pouvez supprimer la version Mobile Services de votre application.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-289">Eventually, once your customers have had a chance to receive these updates, you can delete the Mobile Services version of your app.</span></span> <span data-ttu-id="a5ad5-290">À ce stade, vous avez entièrement mis à niveau votre application vers App Service Mobile Apps avec le tout dernier SDK serveur Mobile Apps.</span><span class="sxs-lookup"><span data-stu-id="a5ad5-290">At this point, you have completely upgraded to an App Service Mobile App using the latest Mobile Apps server SDK.</span></span>

<!-- URLs. -->

<span data-ttu-id="a5ad5-291">[portail Azure]: https://portal.azure.com/</span><span class="sxs-lookup"><span data-stu-id="a5ad5-291">[Azure portal]: https://portal.azure.com/</span></span>
<span data-ttu-id="a5ad5-292">[portail Azure Classic]: https://manage.windowsazure.com/</span><span class="sxs-lookup"><span data-stu-id="a5ad5-292">[Azure classic portal]: https://manage.windowsazure.com/</span></span>
<span data-ttu-id="a5ad5-293">[Que sont les applications Mobile Apps ?]: app-service-mobile-value-prop.md</span><span class="sxs-lookup"><span data-stu-id="a5ad5-293">[What are Mobile Apps?]: app-service-mobile-value-prop.md</span></span>
[I already use web sites and mobile services – how does App Service help me?]: /en-us/documentation/articles/app-service-mobile-value-prop-migration-from-mobile-services
<span data-ttu-id="a5ad5-294">[Kit de développement logiciel (SDK) Mobile App Server]: http://www.nuget.org/packages/microsoft.azure.mobile.server</span><span class="sxs-lookup"><span data-stu-id="a5ad5-294">[Mobile App Server SDK]: http://www.nuget.org/packages/microsoft.azure.mobile.server</span></span>
[Create a Mobile App]: app-service-mobile-xamarin-ios-get-started.md
[Add push notifications to your mobile app]: app-service-mobile-xamarin-ios-get-started-push.md
[Add authentication to your mobile app]: app-service-mobile-xamarin-ios-get-started-users.md
<span data-ttu-id="a5ad5-295">[Azure Scheduler]: /en-us/documentation/services/scheduler/</span><span class="sxs-lookup"><span data-stu-id="a5ad5-295">[Azure Scheduler]: /en-us/documentation/services/scheduler/</span></span>
<span data-ttu-id="a5ad5-296">[tâche web]: ../app-service-web/websites-webjobs-resources.md</span><span class="sxs-lookup"><span data-stu-id="a5ad5-296">[Web Job]: ../app-service-web/websites-webjobs-resources.md</span></span>
<span data-ttu-id="a5ad5-297">[Utilisation du Kit de développement logiciel (SDK) serveur .NET]: app-service-mobile-dotnet-backend-how-to-use-server-sdk.md</span><span class="sxs-lookup"><span data-stu-id="a5ad5-297">[How to use the .NET server SDK]: app-service-mobile-dotnet-backend-how-to-use-server-sdk.md</span></span>
[Migrate from Mobile Services to an App Service Mobile App]: app-service-mobile-migrating-from-mobile-services.md
[Migrate your existing Mobile Service to App Service]: app-service-mobile-migrating-from-mobile-services.md
<span data-ttu-id="a5ad5-298">[tarification App Service]: https://azure.microsoft.com/en-us/pricing/details/app-service/</span><span class="sxs-lookup"><span data-stu-id="a5ad5-298">[App Service pricing]: https://azure.microsoft.com/en-us/pricing/details/app-service/</span></span>
<span data-ttu-id="a5ad5-299">[Présentation du Kit de développement logiciel (SDK) serveur .NET]: app-service-mobile-dotnet-backend-how-to-use-server-sdk.md</span><span class="sxs-lookup"><span data-stu-id="a5ad5-299">[.NET server SDK overview]: app-service-mobile-dotnet-backend-how-to-use-server-sdk.md</span></span>
