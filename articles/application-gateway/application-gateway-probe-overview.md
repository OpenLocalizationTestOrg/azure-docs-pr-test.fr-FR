---
title: "aaaHealth la présentation des moniteurs pour la passerelle d’Application Azure | Documents Microsoft"
description: "En savoir plus sur hello surveillance des fonctionnalités de la passerelle d’Application Azure"
services: application-gateway
documentationcenter: na
author: georgewallace
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 7eeba328-bb2d-4d3e-bdac-7552e7900b7f
ms.service: application-gateway
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 12/14/2016
ms.author: gwallace
ms.openlocfilehash: 5091d80394a354ff849ce7ccee8cc9d2fd0456db
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="application-gateway-health-monitoring-overview"></a><span data-ttu-id="9f58e-103">Vue d’ensemble de l’analyse d’intégrité Application Gateway</span><span class="sxs-lookup"><span data-stu-id="9f58e-103">Application Gateway health monitoring overview</span></span>

<span data-ttu-id="9f58e-104">Passerelle d’Application Azure par défaut surveille l’intégrité de hello de toutes les ressources dans son pool principal et supprime automatiquement n’importe quelle ressource considéré comme non intègre de pool de hello.</span><span class="sxs-lookup"><span data-stu-id="9f58e-104">Azure Application Gateway by default monitors hello health of all resources in its back-end pool and automatically removes any resource considered unhealthy from hello pool.</span></span> <span data-ttu-id="9f58e-105">Passerelle d’application continue des instances non intègre de toomonitor hello et ajoute les sauvegarder pool principal intègre de toohello une fois qu’ils deviennent disponibles et des sondes toohealth de répondre.</span><span class="sxs-lookup"><span data-stu-id="9f58e-105">Application Gateway continues toomonitor hello unhealthy instances and adds them back toohello healthy back-end pool once they become available and respond toohealth probes.</span></span> <span data-ttu-id="9f58e-106">Passerelle d’application envoie les sondes d’intégrité hello hello même port est défini dans les paramètres HTTP hello back-end.</span><span class="sxs-lookup"><span data-stu-id="9f58e-106">Application gateway sends hello health probes with hello same port that is defined in hello back-end HTTP settings.</span></span> <span data-ttu-id="9f58e-107">Cette configuration garantit que sonde hello teste hello même port que les clients utilisent tooconnect toohello principal.</span><span class="sxs-lookup"><span data-stu-id="9f58e-107">This configuration ensures that hello probe is testing hello same port that customers would be using tooconnect toohello backend.</span></span>

![exemple de sonde application gateway][1]

<span data-ttu-id="9f58e-109">Ajout toousing par défaut d’intégrité sonde analyse, vous pouvez également personnaliser toosuit de sonde d’intégrité hello exigences de votre application.</span><span class="sxs-lookup"><span data-stu-id="9f58e-109">In addition toousing default health probe monitoring, you can also customize hello health probe toosuit your application's requirements.</span></span> <span data-ttu-id="9f58e-110">Dans cet article, nous nous intéressons aux sondes d’intégrité par défaut et personnalisées.</span><span class="sxs-lookup"><span data-stu-id="9f58e-110">In this article, both default and custom health probes are covered.</span></span>

> [!NOTE]
> <span data-ttu-id="9f58e-111">S’il existe un groupe de sécurité réseau sur le sous-réseau de passerelle d’Application, les plages de ports 65503-65 534 doivent être ouvert sur le sous-réseau de passerelle d’Application hello pour le trafic entrant.</span><span class="sxs-lookup"><span data-stu-id="9f58e-111">If there is an NSG on Application Gateway subnet, port ranges 65503-65534 should be opened on hello Application Gateway subnet for Inbound traffic.</span></span> <span data-ttu-id="9f58e-112">Ces ports sont requis pour hello principal d’intégrité API toowork.</span><span class="sxs-lookup"><span data-stu-id="9f58e-112">These ports are required for hello backend health API toowork.</span></span>

## <a name="default-health-probe"></a><span data-ttu-id="9f58e-113">Sonde d’intégrité par défaut</span><span class="sxs-lookup"><span data-stu-id="9f58e-113">Default health probe</span></span>

<span data-ttu-id="9f58e-114">Une passerelle d’application configure automatiquement une sonde d’intégrité par défaut lorsque vous ne définissez pas de configuration de sonde personnalisée.</span><span class="sxs-lookup"><span data-stu-id="9f58e-114">An application gateway automatically configures a default health probe when you don't set up any custom probe configuration.</span></span> <span data-ttu-id="9f58e-115">Hello analyse le comportement fonctionne en créant que des adresses IP toohello demande HTTP configuré pour le pool principal de hello.</span><span class="sxs-lookup"><span data-stu-id="9f58e-115">hello monitoring behavior works by making an HTTP request toohello IP addresses configured for hello back-end pool.</span></span> <span data-ttu-id="9f58e-116">Pour les sondes par défaut si hello principal http est configuré pour le protocole HTTPS, sonde de hello utilise HTTPS en tant que contrôle d’intégrité tootest bien des serveurs principaux hello.</span><span class="sxs-lookup"><span data-stu-id="9f58e-116">For default probes if hello backend http settings are configured for HTTPS, hello probe uses HTTPS as well tootest health of hello backends.</span></span>

<span data-ttu-id="9f58e-117">Par exemple : vous configurez votre application passerelle toouse serveurs principaux A, B et C tooreceive HTTP le trafic réseau sur le port 80.</span><span class="sxs-lookup"><span data-stu-id="9f58e-117">For example: You configure your application gateway toouse back-end servers A, B, and C tooreceive HTTP network traffic on port 80.</span></span> <span data-ttu-id="9f58e-118">surveillance de l’état par défaut de Hello teste trois serveurs de hello pour une réponse HTTP intègre toutes les 30 secondes.</span><span class="sxs-lookup"><span data-stu-id="9f58e-118">hello default health monitoring tests hello three servers every 30 seconds for a healthy HTTP response.</span></span> <span data-ttu-id="9f58e-119">Le [code d’état](https://msdn.microsoft.com/library/aa287675.aspx) d’une réponse HTTP correcte est compris entre 200 et 399.</span><span class="sxs-lookup"><span data-stu-id="9f58e-119">A healthy HTTP response has a [status code](https://msdn.microsoft.com/library/aa287675.aspx) between 200 and 399.</span></span>

<span data-ttu-id="9f58e-120">En cas de vérification de sonde hello par défaut pour le serveur A, passerelle d’application hello retire son pool principal et le trafic réseau cesse de circuler toothis server.</span><span class="sxs-lookup"><span data-stu-id="9f58e-120">If hello default probe check fails for server A, hello application gateway removes it from its back-end pool, and network traffic stops flowing toothis server.</span></span> <span data-ttu-id="9f58e-121">Sonde Hello garde toocheck pour le serveur une toutes les 30 secondes.</span><span class="sxs-lookup"><span data-stu-id="9f58e-121">hello default probe still continues toocheck for server A every 30 seconds.</span></span> <span data-ttu-id="9f58e-122">Lorsque le serveur A répond correctement tooone demande à partir d’une sonde d’intégrité par défaut, il est rajouté en tant que pool principal de toohello intègre et démarre le trafic circulant toohello server à nouveau.</span><span class="sxs-lookup"><span data-stu-id="9f58e-122">When server A responds successfully tooone request from a default health probe, it is added back as healthy toohello back-end pool, and traffic starts flowing toohello server again.</span></span>

### <a name="default-health-probe-settings"></a><span data-ttu-id="9f58e-123">Paramètres de sonde d’intégrité par défaut</span><span class="sxs-lookup"><span data-stu-id="9f58e-123">Default health probe settings</span></span>

| <span data-ttu-id="9f58e-124">Propriétés de la sonde</span><span class="sxs-lookup"><span data-stu-id="9f58e-124">Probe property</span></span> | <span data-ttu-id="9f58e-125">Valeur</span><span class="sxs-lookup"><span data-stu-id="9f58e-125">Value</span></span> | <span data-ttu-id="9f58e-126">Description</span><span class="sxs-lookup"><span data-stu-id="9f58e-126">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="9f58e-127">URL de sonde</span><span class="sxs-lookup"><span data-stu-id="9f58e-127">Probe URL</span></span> |<span data-ttu-id="9f58e-128">http://127.0.0.1:\<port\>/</span><span class="sxs-lookup"><span data-stu-id="9f58e-128">http://127.0.0.1:\<port\>/</span></span> |<span data-ttu-id="9f58e-129">Chemin d'accès de l'URL</span><span class="sxs-lookup"><span data-stu-id="9f58e-129">URL path</span></span> |
| <span data-ttu-id="9f58e-130">Intervalle</span><span class="sxs-lookup"><span data-stu-id="9f58e-130">Interval</span></span> |<span data-ttu-id="9f58e-131">30</span><span class="sxs-lookup"><span data-stu-id="9f58e-131">30</span></span> |<span data-ttu-id="9f58e-132">Intervalle d’analyse en secondes</span><span class="sxs-lookup"><span data-stu-id="9f58e-132">Probe interval in seconds</span></span> |
| <span data-ttu-id="9f58e-133">Délai d’attente</span><span class="sxs-lookup"><span data-stu-id="9f58e-133">Time-out</span></span> |<span data-ttu-id="9f58e-134">30</span><span class="sxs-lookup"><span data-stu-id="9f58e-134">30</span></span> |<span data-ttu-id="9f58e-135">Délai d’expiration de l’analyse en secondes</span><span class="sxs-lookup"><span data-stu-id="9f58e-135">Probe time-out in seconds</span></span> |
| <span data-ttu-id="9f58e-136">Seuil de défaillance sur le plan de l’intégrité</span><span class="sxs-lookup"><span data-stu-id="9f58e-136">Unhealthy threshold</span></span> |<span data-ttu-id="9f58e-137">3</span><span class="sxs-lookup"><span data-stu-id="9f58e-137">3</span></span> |<span data-ttu-id="9f58e-138">Nombre de tentatives d’analyse</span><span class="sxs-lookup"><span data-stu-id="9f58e-138">Probe retry count.</span></span> <span data-ttu-id="9f58e-139">serveur principal de Hello est marquée vers le bas après que le nombre d’échecs de sonde consécutifs hello a atteint le seuil de défaillance hello.</span><span class="sxs-lookup"><span data-stu-id="9f58e-139">hello back-end server is marked down after hello consecutive probe failure count reaches hello unhealthy threshold.</span></span> |

> [!NOTE]
> <span data-ttu-id="9f58e-140">Hello port est hello même port en tant que paramètres de HTTP hello back-end.</span><span class="sxs-lookup"><span data-stu-id="9f58e-140">hello port is hello same port as hello back-end HTTP settings.</span></span>

<span data-ttu-id="9f58e-141">Sonde Hello examine uniquement http://127.0.0.1 :\<port\> toodetermine l’état d’intégrité.</span><span class="sxs-lookup"><span data-stu-id="9f58e-141">hello default probe looks only at http://127.0.0.1:\<port\> toodetermine health status.</span></span> <span data-ttu-id="9f58e-142">Si vous devez tooconfigure hello d’intégrité toogo tooa personnalisé URL de sonde ou modifiez d’autres paramètres, vous devez utiliser les sondes personnalisé comme décrit dans hello comme suit :</span><span class="sxs-lookup"><span data-stu-id="9f58e-142">If you need tooconfigure hello health probe toogo tooa custom URL or modify any other settings, you must use custom probes as described in hello following steps:</span></span>

## <a name="custom-health-probe"></a><span data-ttu-id="9f58e-143">Sonde d’intégrité personnalisée</span><span class="sxs-lookup"><span data-stu-id="9f58e-143">Custom health probe</span></span>

<span data-ttu-id="9f58e-144">Les sondes personnalisées permettent de toohave un contrôle plus précis sur la surveillance de l’intégrité hello.</span><span class="sxs-lookup"><span data-stu-id="9f58e-144">Custom probes allow you toohave a more granular control over hello health monitoring.</span></span> <span data-ttu-id="9f58e-145">Lorsque vous utilisez des sondes personnalisés, vous pouvez configurer intervalle d’analyse hello tootest d’URL et le chemin d’accès hello et combien tooaccept d’échecs de réponse avant de marquer l’instance du pool de back-end hello comme étant défectueux.</span><span class="sxs-lookup"><span data-stu-id="9f58e-145">When using custom probes, you can configure hello probe interval, hello URL and path tootest, and how many failed responses tooaccept before marking hello back-end pool instance as unhealthy.</span></span>

### <a name="custom-health-probe-settings"></a><span data-ttu-id="9f58e-146">Paramètres de sonde d’intégrité personnalisée</span><span class="sxs-lookup"><span data-stu-id="9f58e-146">Custom health probe settings</span></span>

<span data-ttu-id="9f58e-147">Hello tableau suivant fournit les définitions pour les propriétés d’une sonde de l’intégrité personnalisée hello.</span><span class="sxs-lookup"><span data-stu-id="9f58e-147">hello following table provides definitions for hello properties of a custom health probe.</span></span>

| <span data-ttu-id="9f58e-148">Propriétés de la sonde</span><span class="sxs-lookup"><span data-stu-id="9f58e-148">Probe property</span></span> | <span data-ttu-id="9f58e-149">Description</span><span class="sxs-lookup"><span data-stu-id="9f58e-149">Description</span></span> |
| --- | --- |
| <span data-ttu-id="9f58e-150">Nom</span><span class="sxs-lookup"><span data-stu-id="9f58e-150">Name</span></span> |<span data-ttu-id="9f58e-151">Nom de la sonde de hello.</span><span class="sxs-lookup"><span data-stu-id="9f58e-151">Name of hello probe.</span></span> <span data-ttu-id="9f58e-152">Ce nom est sonde de toohello toorefer utilisés dans les paramètres HTTP du serveur principal.</span><span class="sxs-lookup"><span data-stu-id="9f58e-152">This name is used toorefer toohello probe in back-end HTTP settings.</span></span> |
| <span data-ttu-id="9f58e-153">Protocole</span><span class="sxs-lookup"><span data-stu-id="9f58e-153">Protocol</span></span> |<span data-ttu-id="9f58e-154">Protocole utilisé sonde de hello toosend.</span><span class="sxs-lookup"><span data-stu-id="9f58e-154">Protocol used toosend hello probe.</span></span> <span data-ttu-id="9f58e-155">Sonde de Hello utilise le protocole de hello définie dans les paramètres HTTP hello principal</span><span class="sxs-lookup"><span data-stu-id="9f58e-155">hello probe uses hello protocol defined in hello back-end HTTP settings</span></span> |
| <span data-ttu-id="9f58e-156">Host</span><span class="sxs-lookup"><span data-stu-id="9f58e-156">Host</span></span> |<span data-ttu-id="9f58e-157">Hôte toosend hello de sonde à nom.</span><span class="sxs-lookup"><span data-stu-id="9f58e-157">Host name toosend hello probe.</span></span> <span data-ttu-id="9f58e-158">S’applique uniquement lorsque plusieurs sites sont configurés sur Application Gateway, sinon utilisez '127.0.0.1'.</span><span class="sxs-lookup"><span data-stu-id="9f58e-158">Applicable only when multi-site is configured on Application Gateway, otherwise use '127.0.0.1'.</span></span> <span data-ttu-id="9f58e-159">Cette valeur est différente du nom d’hôte de la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="9f58e-159">This value is different from VM host name.</span></span> |
| <span data-ttu-id="9f58e-160">Chemin</span><span class="sxs-lookup"><span data-stu-id="9f58e-160">Path</span></span> |<span data-ttu-id="9f58e-161">Chemin d’accès relatif de sonde de hello.</span><span class="sxs-lookup"><span data-stu-id="9f58e-161">Relative path of hello probe.</span></span> <span data-ttu-id="9f58e-162">chemin d’accès valide de Hello commence à partir de '/'.</span><span class="sxs-lookup"><span data-stu-id="9f58e-162">hello valid path starts from '/'.</span></span> |
| <span data-ttu-id="9f58e-163">Intervalle</span><span class="sxs-lookup"><span data-stu-id="9f58e-163">Interval</span></span> |<span data-ttu-id="9f58e-164">Intervalle d’analyse en secondes.</span><span class="sxs-lookup"><span data-stu-id="9f58e-164">Probe interval in seconds.</span></span> <span data-ttu-id="9f58e-165">Cette valeur est l’intervalle de temps hello entre deux analyses consécutives.</span><span class="sxs-lookup"><span data-stu-id="9f58e-165">This value is hello time interval between two consecutive probes.</span></span> |
| <span data-ttu-id="9f58e-166">Délai d’attente</span><span class="sxs-lookup"><span data-stu-id="9f58e-166">Time-out</span></span> |<span data-ttu-id="9f58e-167">Délai d’expiration de l’analyse en secondes.</span><span class="sxs-lookup"><span data-stu-id="9f58e-167">Probe time-out in seconds.</span></span> <span data-ttu-id="9f58e-168">Si une réponse valide n’est pas reçue dans ce délai, la sonde de hello est marquée comme ayant échoué.</span><span class="sxs-lookup"><span data-stu-id="9f58e-168">If a valid response is not received within this time-out period, hello probe is marked as failed.</span></span>  |
| <span data-ttu-id="9f58e-169">Seuil de défaillance sur le plan de l’intégrité</span><span class="sxs-lookup"><span data-stu-id="9f58e-169">Unhealthy threshold</span></span> |<span data-ttu-id="9f58e-170">Nombre de tentatives d’analyse</span><span class="sxs-lookup"><span data-stu-id="9f58e-170">Probe retry count.</span></span> <span data-ttu-id="9f58e-171">serveur principal de Hello est marquée vers le bas après que le nombre d’échecs de sonde consécutifs hello a atteint le seuil de défaillance hello.</span><span class="sxs-lookup"><span data-stu-id="9f58e-171">hello back-end server is marked down after hello consecutive probe failure count reaches hello unhealthy threshold.</span></span> |

> [!IMPORTANT]
> <span data-ttu-id="9f58e-172">Si la passerelle d’Application est configurée pour un site unique, par hello de valeur par défaut hôte nom doit être spécifié sous la forme '127.0.0.1', à moins que sinon configurés dans une sonde personnalisée.</span><span class="sxs-lookup"><span data-stu-id="9f58e-172">If Application Gateway is configured for a single site, by default hello Host name should be specified as '127.0.0.1', unless otherwise configured in custom probe.</span></span>
> <span data-ttu-id="9f58e-173">Pour référence, une sonde personnalisée est envoyée trop\<protocole\>://\<hôte\>:\<port\>\<chemin d’accès\>.</span><span class="sxs-lookup"><span data-stu-id="9f58e-173">For reference a custom probe is sent too\<protocol\>://\<host\>:\<port\>\<path\>.</span></span> <span data-ttu-id="9f58e-174">Hello port utilisé sera hello même port, tel que défini dans les paramètres HTTP hello back-end.</span><span class="sxs-lookup"><span data-stu-id="9f58e-174">hello port used will be hello same port as defined in hello back-end HTTP settings.</span></span>

## <a name="next-steps"></a><span data-ttu-id="9f58e-175">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="9f58e-175">Next steps</span></span>
<span data-ttu-id="9f58e-176">Après l’apprentissage sur la surveillance de l’intégrité de passerelle d’Application, vous pouvez configurer un [sonde de l’intégrité personnalisée](application-gateway-create-probe-portal.md) Bonjour portail Azure ou un [sonde de l’intégrité personnalisée](application-gateway-create-probe-ps.md) à l’aide de PowerShell et hello Azure Resource Manager modèle de déploiement.</span><span class="sxs-lookup"><span data-stu-id="9f58e-176">After learning about Application Gateway health monitoring, you can configure a [custom health probe](application-gateway-create-probe-portal.md) in hello Azure portal or a [custom health probe](application-gateway-create-probe-ps.md) using PowerShell and hello Azure Resource Manager deployment model.</span></span>

[1]: ./media/application-gateway-probe-overview/appgatewayprobe.png
