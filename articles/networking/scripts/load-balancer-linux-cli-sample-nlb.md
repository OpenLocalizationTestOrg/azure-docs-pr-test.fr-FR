---
title: "Exemple de Script CLI - charge équilibrer le trafic tooVMs pour la haute disponibilité d’aaaAzure | Documents Microsoft"
description: "Exemple de Script CLI Azure - charge équilibrer le trafic tooVMs pour la haute disponibilité"
services: load-balancer
documentationcenter: load-balancer
author: KumudD
manager: timlt
editor: tysonn
tags: 
ms.assetid: 
ms.service: load-balancer
ms.devlang: azurecli
ms.topic: article
ms.tgt_pltfrm: 
ms.workload: infrastructure
ms.date: 07/07/2017
ms.author: kumud
ms.openlocfilehash: 0954b5c261512724dfb9c6e7be123c9d45624f4d
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="load-balance-traffic-toovms-for-high-availability"></a><span data-ttu-id="257bc-103">Charger tooVMs le trafic de solde pour la haute disponibilité</span><span class="sxs-lookup"><span data-stu-id="257bc-103">Load balance traffic tooVMs for high availability</span></span>

<span data-ttu-id="257bc-104">Cet exemple de script crée tous les éléments nécessaires toorun plusieurs machines virtuelles de Ubuntu configurés dans une haute disponibilité et de charge équilibrée de configuration.</span><span class="sxs-lookup"><span data-stu-id="257bc-104">This script sample creates everything needed toorun several Ubuntu virtual machines configured in a highly available and load balanced configuration.</span></span> <span data-ttu-id="257bc-105">Après l’exécution du script hello, vous aurez trois machines virtuelles, tooan jointe à haute disponibilité Azure et accessible via un équilibrage de charge Azure.</span><span class="sxs-lookup"><span data-stu-id="257bc-105">After running hello script, you will have three virtual machines, joined tooan Azure Availability Set, and accessible through an Azure Load Balancer.</span></span> 

[!INCLUDE [sample-cli-install](../../../includes/sample-cli-install.md)]

[!INCLUDE [quickstarts-free-trial-note](../../../includes/quickstarts-free-trial-note.md)]

## <a name="sample-script"></a><span data-ttu-id="257bc-106">Exemple de script</span><span class="sxs-lookup"><span data-stu-id="257bc-106">Sample script</span></span>

[!code-azurecli-interactive[main](../../../cli_scripts/virtual-machine/create-vm-nlb/create-vm-nlb.sh "Quick Create VM")]

## <a name="clean-up-deployment"></a><span data-ttu-id="257bc-107">Nettoyer le déploiement</span><span class="sxs-lookup"><span data-stu-id="257bc-107">Clean up deployment</span></span> 

<span data-ttu-id="257bc-108">Exécutez hello suivant du groupe de ressources de commande tooremove hello, machine virtuelle et toutes les ressources.</span><span class="sxs-lookup"><span data-stu-id="257bc-108">Run hello following command tooremove hello resource group, VM, and all related resources.</span></span>

```azurecli
az group delete --name myResourceGroup
```

## <a name="script-explanation"></a><span data-ttu-id="257bc-109">Explication du script</span><span class="sxs-lookup"><span data-stu-id="257bc-109">Script explanation</span></span>

<span data-ttu-id="257bc-110">Ce script utilise hello suivant de commandes toocreate un groupe de ressources, machine virtuelle, haute disponibilité, équilibrage de charge et toutes les ressources.</span><span class="sxs-lookup"><span data-stu-id="257bc-110">This script uses hello following commands toocreate a resource group, virtual machine, availability set, load balancer, and all related resources.</span></span> <span data-ttu-id="257bc-111">Chaque commande figurant dans la documentation spécifique du toocommand liens table hello.</span><span class="sxs-lookup"><span data-stu-id="257bc-111">Each command in hello table links toocommand specific documentation.</span></span>

| <span data-ttu-id="257bc-112">Commande</span><span class="sxs-lookup"><span data-stu-id="257bc-112">Command</span></span> | <span data-ttu-id="257bc-113">Remarques</span><span class="sxs-lookup"><span data-stu-id="257bc-113">Notes</span></span> |
|---|---|
| [<span data-ttu-id="257bc-114">az group create</span><span class="sxs-lookup"><span data-stu-id="257bc-114">az group create</span></span>](https://docs.microsoft.com/cli/azure/group#create) | <span data-ttu-id="257bc-115">Crée un groupe de ressources dans lequel toutes les ressources sont stockées.</span><span class="sxs-lookup"><span data-stu-id="257bc-115">Creates a resource group in which all resources are stored.</span></span> |
| [<span data-ttu-id="257bc-116">az network vnet create</span><span class="sxs-lookup"><span data-stu-id="257bc-116">az network vnet create</span></span>](https://docs.microsoft.com/cli/azure/network/vnet#create) | <span data-ttu-id="257bc-117">Crée un réseau virtuel et un sous-réseau Azure.</span><span class="sxs-lookup"><span data-stu-id="257bc-117">Creates an Azure virtual network and subnet.</span></span> |
| [<span data-ttu-id="257bc-118">az network public-ip create</span><span class="sxs-lookup"><span data-stu-id="257bc-118">az network public-ip create</span></span>](https://docs.microsoft.com/cli/azure/network/public-ip#create) | <span data-ttu-id="257bc-119">Crée une adresse IP publique avec une adresse IP statique et un nom DNS associé.</span><span class="sxs-lookup"><span data-stu-id="257bc-119">Creates a public IP address with a static IP address and an associated DNS name.</span></span> |
| [<span data-ttu-id="257bc-120">az network lb create</span><span class="sxs-lookup"><span data-stu-id="257bc-120">az network lb create</span></span>](https://docs.microsoft.com/cli/azure/network/lb#create) | <span data-ttu-id="257bc-121">Crée un équilibreur de charge Azure.</span><span class="sxs-lookup"><span data-stu-id="257bc-121">Creates an Azure load balancer.</span></span> |
| [<span data-ttu-id="257bc-122">az network lb probe create</span><span class="sxs-lookup"><span data-stu-id="257bc-122">az network lb probe create</span></span>](https://docs.microsoft.com/cli/azure/network/lb/probe#create) | <span data-ttu-id="257bc-123">Crée une sonde d’équilibreur de charge.</span><span class="sxs-lookup"><span data-stu-id="257bc-123">Creates a load balancer probe.</span></span> <span data-ttu-id="257bc-124">Une sonde d’équilibrage de charge est utilisé toomonitor chaque machine virtuelle dans le jeu d’équilibrage de charge de hello.</span><span class="sxs-lookup"><span data-stu-id="257bc-124">A load balancer probe is used toomonitor each VM in hello load balancer set.</span></span> <span data-ttu-id="257bc-125">Si toutes les machines virtuelles devient inaccessible, le trafic n’est pas routé toohello machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="257bc-125">If any VM becomes inaccessible, traffic is not routed toohello VM.</span></span> |
| [<span data-ttu-id="257bc-126">az network lb rule create</span><span class="sxs-lookup"><span data-stu-id="257bc-126">az network lb rule create</span></span>](https://docs.microsoft.com/cli/azure/network/lb/rule#create) | <span data-ttu-id="257bc-127">Crée une règle d’équilibeur de charge.</span><span class="sxs-lookup"><span data-stu-id="257bc-127">Creates a load balancer rule.</span></span> <span data-ttu-id="257bc-128">Dans cet exemple, une règle est créée pour le port 80.</span><span class="sxs-lookup"><span data-stu-id="257bc-128">In this sample, a rule is created for port 80.</span></span> <span data-ttu-id="257bc-129">Comme le trafic HTTP arrive au niveau de l’équilibrage de charge hello, il est routé tooport 80 une des machines virtuelles de hello dans le jeu de hello équilibrage de charge.</span><span class="sxs-lookup"><span data-stu-id="257bc-129">As HTTP traffic arrives at hello load balancer, it is routed tooport 80 one of hello VMs in hello LB set.</span></span> |
| [<span data-ttu-id="257bc-130">az network lb inbound-nat-rule create</span><span class="sxs-lookup"><span data-stu-id="257bc-130">az network lb inbound-nat-rule create</span></span>](https://docs.microsoft.com/cli/azure/network/lb/inbound-nat-rule#create) | <span data-ttu-id="257bc-131">Crée une règle de traduction d’adresses réseau (NAT) pour l’équilibreur de charge.</span><span class="sxs-lookup"><span data-stu-id="257bc-131">Creates load balancer Network Address Translation (NAT) rule.</span></span>  <span data-ttu-id="257bc-132">Les règles NAT de mappent un port de port de tooa d’équilibrage de charge de hello sur une machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="257bc-132">NAT rules map a port of hello load balancer tooa port on a VM.</span></span> <span data-ttu-id="257bc-133">Dans cet exemple, une règle NAT est créée pour SSH trafic tooeach machine virtuelle dans le jeu d’équilibrage de charge de hello.</span><span class="sxs-lookup"><span data-stu-id="257bc-133">In this sample, a NAT rule is created for SSH traffic tooeach VM in hello load balancer set.</span></span>  |
| [<span data-ttu-id="257bc-134">az network nsg create</span><span class="sxs-lookup"><span data-stu-id="257bc-134">az network nsg create</span></span>](https://docs.microsoft.com/cli/azure/network/nsg#create) | <span data-ttu-id="257bc-135">Crée un groupe de sécurité réseau (NSG), qui est une limite de sécurité entre l’ordinateur virtuel pour internet et hello hello.</span><span class="sxs-lookup"><span data-stu-id="257bc-135">Creates a network security group (NSG), which is a security boundary between hello internet and hello virtual machine.</span></span> |
| [<span data-ttu-id="257bc-136">az network nsg rule create</span><span class="sxs-lookup"><span data-stu-id="257bc-136">az network nsg rule create</span></span>](https://docs.microsoft.com/cli/azure/network/nsg/rule#create) | <span data-ttu-id="257bc-137">Crée un tooallow de règle de groupe de sécurité réseau le trafic entrant.</span><span class="sxs-lookup"><span data-stu-id="257bc-137">Creates an NSG rule tooallow inbound traffic.</span></span> <span data-ttu-id="257bc-138">Dans cet exemple, le port 22 est ouvert pour le trafic SSH.</span><span class="sxs-lookup"><span data-stu-id="257bc-138">In this sample, port 22 is opened for SSH traffic.</span></span> |
| [<span data-ttu-id="257bc-139">az network nic create</span><span class="sxs-lookup"><span data-stu-id="257bc-139">az network nic create</span></span>](https://docs.microsoft.com/cli/azure/network/nic#create) | <span data-ttu-id="257bc-140">Crée une carte réseau virtuelle et attache les réseaux virtuels toohello, du sous-réseau et groupe de sécurité réseau.</span><span class="sxs-lookup"><span data-stu-id="257bc-140">Creates a virtual network card and attaches it toohello virtual network, subnet, and NSG.</span></span> |
| [<span data-ttu-id="257bc-141">az vm availability-set create</span><span class="sxs-lookup"><span data-stu-id="257bc-141">az vm availability-set create</span></span>](https://docs.microsoft.com/cli/azure/network/lb/rule#create) | <span data-ttu-id="257bc-142">Crée un groupe à haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="257bc-142">Creates an availability set.</span></span> <span data-ttu-id="257bc-143">Haute disponibilité garantit la disponibilité des applications en répartissant les machines virtuelles de hello sur ressources physiques telles qu’en cas de défaillance, ensemble hello n’est pas terminée.</span><span class="sxs-lookup"><span data-stu-id="257bc-143">Availability sets ensure application uptime by spreading hello virtual machines across physical resources such that if failure occurs, hello entire set is not effected.</span></span> |
| [<span data-ttu-id="257bc-144">az vm create</span><span class="sxs-lookup"><span data-stu-id="257bc-144">az vm create</span></span>](/cli/azure/vm#create) | <span data-ttu-id="257bc-145">Crée la machine virtuelle de hello et connecte une carte réseau de toohello, du réseau virtuel, sous-réseau et groupe de sécurité réseau.</span><span class="sxs-lookup"><span data-stu-id="257bc-145">Creates hello virtual machine and connects it toohello network card, virtual network, subnet, and NSG.</span></span> <span data-ttu-id="257bc-146">Cette commande spécifie également toobe d’image de machine virtuelle hello utilisé et les informations d’identification d’administration.</span><span class="sxs-lookup"><span data-stu-id="257bc-146">This command also specifies hello virtual machine image toobe used and administrative credentials.</span></span>  |
| [<span data-ttu-id="257bc-147">az group delete</span><span class="sxs-lookup"><span data-stu-id="257bc-147">az group delete</span></span>](https://docs.microsoft.com/cli/azure/vm/extension#set) | <span data-ttu-id="257bc-148">Supprime un groupe de ressources, y compris toutes les ressources imbriquées.</span><span class="sxs-lookup"><span data-stu-id="257bc-148">Deletes a resource group including all nested resources.</span></span> |

## <a name="next-steps"></a><span data-ttu-id="257bc-149">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="257bc-149">Next steps</span></span>

<span data-ttu-id="257bc-150">Pour plus d’informations sur hello CLI d’Azure, consultez [documentation relative à Azure CLI](https://docs.microsoft.com/cli/azure/overview).</span><span class="sxs-lookup"><span data-stu-id="257bc-150">For more information on hello Azure CLI, see [Azure CLI documentation](https://docs.microsoft.com/cli/azure/overview).</span></span>

<span data-ttu-id="257bc-151">Vous trouverez des exemples supplémentaires de script CLI de mise en réseau Azure Bonjour [documentation de la mise en réseau Azure](../cli-samples.md).</span><span class="sxs-lookup"><span data-stu-id="257bc-151">Additional Azure Networking CLI script samples can be found in hello [Azure Networking documentation](../cli-samples.md).</span></span>
