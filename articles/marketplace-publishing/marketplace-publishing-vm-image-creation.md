---
title: "Création d’une image de machine virtuelle pour Azure Marketplace | Microsoft Docs"
description: "Instructions détaillées sur la façon de créer une image de machine virtuelle pour Azure Marketplace et en permettre la commercialisation auprès des autres utilisateurs."
services: Azure Marketplace
documentationcenter: 
author: HannibalSII
manager: hascipio
editor: 
ms.assetid: 5c937b8e-e28d-4007-9fef-624046bca2ae
ms.service: marketplace
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: Azure
ms.workload: na
ms.date: 01/05/2017
ms.author: hascipio; v-divte
ms.openlocfilehash: 046ce7af40301014746c6aef07d08d81ab4adcc2
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/29/2017
---
# <a name="guide-to-create-a-virtual-machine-image-for-the-azure-marketplace"></a><span data-ttu-id="4b63d-103">Guide à la création d’une image de machine virtuelle pour Azure Marketplace</span><span class="sxs-lookup"><span data-stu-id="4b63d-103">Guide to create a virtual machine image for the Azure Marketplace</span></span>
<span data-ttu-id="4b63d-104">Cet article, **étape 2**, vous guide dans la préparation des disques durs virtuels (VHD) que vous allez déployer dans Azure Marketplace.</span><span class="sxs-lookup"><span data-stu-id="4b63d-104">This article, **Step 2**, walks you through preparing the virtual hard disks (VHDs) that you will deploy to the Azure Marketplace.</span></span> <span data-ttu-id="4b63d-105">Vos disques durs virtuels constituent le fondement de votre référence SKU.</span><span class="sxs-lookup"><span data-stu-id="4b63d-105">Your VHDs are the foundation of your SKU.</span></span> <span data-ttu-id="4b63d-106">Le processus varie selon que vous fournissez une référence SKU Linux ou Windows.</span><span class="sxs-lookup"><span data-stu-id="4b63d-106">The process differs depending on whether you are providing a Linux-based or Windows-based SKU.</span></span> <span data-ttu-id="4b63d-107">Cet article aborde ces deux scénarios.</span><span class="sxs-lookup"><span data-stu-id="4b63d-107">This article covers both scenarios.</span></span> <span data-ttu-id="4b63d-108">Ce processus peut être exécuté parallèlement à la procédure de [création de compte et d’enregistrement][link-acct-creation].</span><span class="sxs-lookup"><span data-stu-id="4b63d-108">This process can be performed in parallel with [Account creation and registration][link-acct-creation].</span></span>

## <a name="1-define-offers-and-skus"></a><span data-ttu-id="4b63d-109">1. Définir les offres et les références SKU</span><span class="sxs-lookup"><span data-stu-id="4b63d-109">1. Define Offers and SKUs</span></span>
<span data-ttu-id="4b63d-110">Dans cette section, vous apprenez à définir les offres et leurs références SKU associées.</span><span class="sxs-lookup"><span data-stu-id="4b63d-110">In this section, you learn to define the offers and their associated SKUs.</span></span>

<span data-ttu-id="4b63d-111">Une offre constitue le « parent » des références SKU associées.</span><span class="sxs-lookup"><span data-stu-id="4b63d-111">An offer is a "parent" to all of its SKUs.</span></span> <span data-ttu-id="4b63d-112">Vous pouvez proposer plusieurs offres.</span><span class="sxs-lookup"><span data-stu-id="4b63d-112">You can have multiple offers.</span></span> <span data-ttu-id="4b63d-113">Il vous revient de définir les modalités de structuration de vos offres.</span><span class="sxs-lookup"><span data-stu-id="4b63d-113">How you decide to structure your offers is up to you.</span></span> <span data-ttu-id="4b63d-114">Lorsqu’une offre est déployée dans un environnement intermédiaire, les références SKU associées le sont également.</span><span class="sxs-lookup"><span data-stu-id="4b63d-114">When an offer is pushed to staging, it is pushed along with all of its SKUs.</span></span> <span data-ttu-id="4b63d-115">Choisissez avec soin vos identificateurs SKU, car ceux-ci apparaissent dans l’URL.</span><span class="sxs-lookup"><span data-stu-id="4b63d-115">Carefully consider your SKU identifiers, because they will be visible in the URL:</span></span>

* <span data-ttu-id="4b63d-116">Azure.com : http://azure.microsoft.com/marketplace/partners/{espace_de_noms_partenaire}/{ID_offre}-{ID_référence}</span><span class="sxs-lookup"><span data-stu-id="4b63d-116">Azure.com: http://azure.microsoft.com/marketplace/partners/{PartnerNamespace}/{OfferIdentifier}-{SKUidentifier}</span></span>
* <span data-ttu-id="4b63d-117">Portail Azure en préversion : https://portal.azure.com/#gallery/{espace_de_noms_éditeur}.{ID_offre}{ID_référence}</span><span class="sxs-lookup"><span data-stu-id="4b63d-117">Azure preview portal: https://portal.azure.com/#gallery/{PublisherNamespace}.{OfferIdentifier}{SKUIDdentifier}</span></span>  

<span data-ttu-id="4b63d-118">Une référence SKU désigne le nom commercial d’une image de machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="4b63d-118">A SKU is the commercial name for a VM image.</span></span> <span data-ttu-id="4b63d-119">Une image de machine virtuelle contient un disque de système d’exploitation et aucun ou plusieurs disques de données.</span><span class="sxs-lookup"><span data-stu-id="4b63d-119">A VM image contains one operating system disk and zero or more data disks.</span></span> <span data-ttu-id="4b63d-120">Il s’agit en fait du profil de stockage complet d’une machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="4b63d-120">It is essentially the complete storage profile for a virtual machine.</span></span> <span data-ttu-id="4b63d-121">Chaque disque a un disque dur virtuel est nécessaire par disque.</span><span class="sxs-lookup"><span data-stu-id="4b63d-121">One VHD is needed per disk.</span></span> <span data-ttu-id="4b63d-122">Même les disques de données vides ont besoin de la création d’un disque dur virtuel.</span><span class="sxs-lookup"><span data-stu-id="4b63d-122">Even blank data disks require a VHD to be created.</span></span>

<span data-ttu-id="4b63d-123">Quel que soit le système d’exploitation que vous utilisez, ajoutez uniquement le nombre minimal de disques de données requis par la référence SKU.</span><span class="sxs-lookup"><span data-stu-id="4b63d-123">Regardless of which operating system you use, add only the minimum number of data disks needed by the SKU.</span></span> <span data-ttu-id="4b63d-124">Les clients ne suppriment pas les disques qui font partie d’une image lors du déploiement, mais peuvent toujours ajouter des disques pendant ou après le déploiement le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="4b63d-124">Customers cannot remove disks that are part of an image at the time of deployment but can always add disks during or after deployment if they need them.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="4b63d-125">**Ne modifiez pas le nombre de disques dans une nouvelle version de l’image.**</span><span class="sxs-lookup"><span data-stu-id="4b63d-125">**Do not change disk count in a new image version.**</span></span> <span data-ttu-id="4b63d-126">Si vous devez reconfigurer les disques de données dans l’image, définissez une nouvelle référence SKU.</span><span class="sxs-lookup"><span data-stu-id="4b63d-126">If you must reconfigure Data disks in the image, define a new SKU.</span></span> <span data-ttu-id="4b63d-127">La publication d’une nouvelle version de l’image avec un nombre de disques différent peut potentiellement rompre le nouveau déploiement basé sur la nouvelle version de l’image en cas de mise à l’échelle automatique, de déploiements automatiques de solutions via des modèles ARM et autres scénarios.</span><span class="sxs-lookup"><span data-stu-id="4b63d-127">Publishing a new image version with different disk counts will have the potential of breaking new deployment based on the new image version in cases of auto-scaling, automatic deployments of solutions through ARM templates and other scenarios.</span></span>
>
>

### <a name="11-add-an-offer"></a><span data-ttu-id="4b63d-128">1.1 Ajouter une offre</span><span class="sxs-lookup"><span data-stu-id="4b63d-128">1.1 Add an offer</span></span>
1. <span data-ttu-id="4b63d-129">Connectez-vous au [Portail de publication][link-pubportal] à l’aide de votre compte de vendeur.</span><span class="sxs-lookup"><span data-stu-id="4b63d-129">Sign in to the [Publishing Portal][link-pubportal] by using your seller account.</span></span>
2. <span data-ttu-id="4b63d-130">Accédez à l’onglet **Machines virtuelles** du Portail de publication.</span><span class="sxs-lookup"><span data-stu-id="4b63d-130">Select the **Virtual Machines** tab of the Publishing Portal.</span></span> <span data-ttu-id="4b63d-131">Dans le champ de saisie qui s’affiche, entrez le nom de votre offre.</span><span class="sxs-lookup"><span data-stu-id="4b63d-131">In the prompted entry field, enter your offer name.</span></span> <span data-ttu-id="4b63d-132">Le nom de l’offre correspond généralement au nom du produit ou service que vous prévoyez de vendre dans Azure Marketplace.</span><span class="sxs-lookup"><span data-stu-id="4b63d-132">The offer name is typically the name of the product or service that you plan to sell in the Azure Marketplace.</span></span>
3. <span data-ttu-id="4b63d-133">Sélectionnez **Créer**.</span><span class="sxs-lookup"><span data-stu-id="4b63d-133">Select **Create**.</span></span>

### <a name="12-define-a-sku"></a><span data-ttu-id="4b63d-134">1.2 Définir une référence SKU</span><span class="sxs-lookup"><span data-stu-id="4b63d-134">1.2 Define a SKU</span></span>
<span data-ttu-id="4b63d-135">Une fois que vous avez ajouté une offre, vous devez définir/identifier vos références SKU.</span><span class="sxs-lookup"><span data-stu-id="4b63d-135">After you have added an offer, you need to define and identify your SKUs.</span></span> <span data-ttu-id="4b63d-136">Vous pouvez proposer plusieurs offres, chaque offre étant elle-même associée à plusieurs références SKU.</span><span class="sxs-lookup"><span data-stu-id="4b63d-136">You can have multiple offers, and each offer can have multiple SKUs under it.</span></span> <span data-ttu-id="4b63d-137">Lorsqu’une offre est déployée dans un environnement intermédiaire, les références SKU associées le sont également.</span><span class="sxs-lookup"><span data-stu-id="4b63d-137">When an offer is pushed to staging, it is pushed along with all of its SKUs.</span></span>

1. <span data-ttu-id="4b63d-138">**Ajoutez une référence SKU.**</span><span class="sxs-lookup"><span data-stu-id="4b63d-138">**Add a SKU.**</span></span> <span data-ttu-id="4b63d-139">La référence SKU requiert un identificateur qui est utilisé dans l’URL.</span><span class="sxs-lookup"><span data-stu-id="4b63d-139">The SKU requires an identifier, which is used in the URL.</span></span> <span data-ttu-id="4b63d-140">L’identificateur doit être unique dans votre profil de publication. Il n’y a pas de risque de conflit avec les identificateurs d’autres éditeurs.</span><span class="sxs-lookup"><span data-stu-id="4b63d-140">The identifier must be unique within your publishing profile, but there is no risk of identifier collision with other publishers.</span></span>

   > [!NOTE]
   > <span data-ttu-id="4b63d-141">Les identificateurs de l’offre et de la référence SKU s’afficheront dans l’URL de l’offre sur Marketplace.</span><span class="sxs-lookup"><span data-stu-id="4b63d-141">The offer and SKU identifiers are displayed in the offer URL in the Marketplace.</span></span>
   >
   >
2. <span data-ttu-id="4b63d-142">**Ajoutez une description de votre référence SKU.**</span><span class="sxs-lookup"><span data-stu-id="4b63d-142">**Add a summary description for your SKU.**</span></span> <span data-ttu-id="4b63d-143">Des descriptions résumées sont visibles pour les clients, donc, vous devez les rendre facilement lisibles.</span><span class="sxs-lookup"><span data-stu-id="4b63d-143">Summary descriptions are visible to customers, so you should make them easily readable.</span></span> <span data-ttu-id="4b63d-144">Ces informations ne doivent pas être verrouillées jusqu’à la phase « Envoi vers staging »/</span><span class="sxs-lookup"><span data-stu-id="4b63d-144">This information does not need to be locked until the "Push to Staging" phase.</span></span> <span data-ttu-id="4b63d-145">intermédiaire.</span><span class="sxs-lookup"><span data-stu-id="4b63d-145">Until then, you are free to edit it.</span></span>
3. <span data-ttu-id="4b63d-146">Si vous utilisez des références SKU basées sur Windows, suivez les liens suggérés pour acquérir les versions approuvées de Windows Server.</span><span class="sxs-lookup"><span data-stu-id="4b63d-146">If you are using Windows-based SKUs, follow the suggested links to acquire the approved versions of Windows Server.</span></span>

## <a name="2-create-an-azure-compatible-vhd-linux-based"></a><span data-ttu-id="4b63d-147">2. Créer un disque dur virtuel compatible avec Azure (Linux)</span><span class="sxs-lookup"><span data-stu-id="4b63d-147">2. Create an Azure-compatible VHD (Linux-based)</span></span>
<span data-ttu-id="4b63d-148">Cette section se concerne sur les meilleures pratiques pour la création d’une image de machine virtuelle Linux pour Azure Marketplace.</span><span class="sxs-lookup"><span data-stu-id="4b63d-148">This section focuses on best practices for creating a Linux-based VM image for the Azure Marketplace.</span></span> <span data-ttu-id="4b63d-149">Pour consulter la procédure détaillée, consultez la documentation suivante : [Création et téléchargement d’un disque dur virtuel contenant le système d’exploitation Linux](../virtual-machines/linux/classic/create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2fclassic%2ftoc.json)</span><span class="sxs-lookup"><span data-stu-id="4b63d-149">For a step-by-step walkthrough, refer to the following documentation: [Creating and Uploading a Virtual Hard Disk that Contains the Linux Operating System](../virtual-machines/linux/classic/create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2fclassic%2ftoc.json)</span></span>

## <a name="3-create-an-azure-compatible-vhd-windows-based"></a><span data-ttu-id="4b63d-150">3. Créer un disque dur virtuel compatible avec Azure (Windows)</span><span class="sxs-lookup"><span data-stu-id="4b63d-150">3. Create an Azure-compatible VHD (Windows-based)</span></span>
<span data-ttu-id="4b63d-151">Cette section décrit la procédure de création d’une référence SKU basée sur Windows Server pour Azure Marketplace.</span><span class="sxs-lookup"><span data-stu-id="4b63d-151">This section focuses on the steps to create a SKU based on Windows Server for the Azure Marketplace.</span></span>

### <a name="31-ensure-that-you-are-using-the-correct-base-vhds"></a><span data-ttu-id="4b63d-152">3.1 Vérifier que vous utilisez les disques durs virtuels de base corrects</span><span class="sxs-lookup"><span data-stu-id="4b63d-152">3.1 Ensure that you are using the correct base VHDs</span></span>
<span data-ttu-id="4b63d-153">Le disque dur virtuel de système d’exploitation pour votre image de machine virtuelle doit être basé sur une image de base approuvée par Azure contenant Windows Server ou SQL Server.</span><span class="sxs-lookup"><span data-stu-id="4b63d-153">The operating system VHD for your VM image must be based on an Azure-approved base image that contains Windows Server or SQL Server.</span></span>

<span data-ttu-id="4b63d-154">Pour commencer, créez une machine virtuelle à partir d’une des images suivantes, situées dans le [portail Microsoft Azure][link-azure-portal] :</span><span class="sxs-lookup"><span data-stu-id="4b63d-154">To begin, create a VM from one of the following images, located at the [Microsoft Azure portal][link-azure-portal]:</span></span>

* <span data-ttu-id="4b63d-155">Windows Server ([2012 R2 Datacenter][link-datactr-2012-r2], [2012 Datacenter][link-datactr-2012], [2008 R2 SP1][link-datactr-2008-r2])</span><span class="sxs-lookup"><span data-stu-id="4b63d-155">Windows Server ([2012 R2 Datacenter][link-datactr-2012-r2], [2012 Datacenter][link-datactr-2012], [2008 R2 SP1][link-datactr-2008-r2])</span></span>
* <span data-ttu-id="4b63d-156">SQL Server 2014 ([Enterprise][link-sql-2014-ent], [Standard][link-sql-2014-std], [Web][link-sql-2014-web])</span><span class="sxs-lookup"><span data-stu-id="4b63d-156">SQL Server 2014 ([Enterprise][link-sql-2014-ent], [Standard][link-sql-2014-std], [Web][link-sql-2014-web])</span></span>
* <span data-ttu-id="4b63d-157">SQL Server 2012 SP2 ([Enterprise][link-sql-2012-ent], [Standard][link-sql-2012-std], [Web][link-sql-2012-web])</span><span class="sxs-lookup"><span data-stu-id="4b63d-157">SQL Server 2012 SP2 ([Enterprise][link-sql-2012-ent], [Standard][link-sql-2012-std], [Web][link-sql-2012-web])</span></span>

<span data-ttu-id="4b63d-158">Ces liens sont également disponibles dans le Portail de publication sous la page des références SKU.</span><span class="sxs-lookup"><span data-stu-id="4b63d-158">These links can also be found in the Publishing Portal under the SKU page.</span></span>

> [!TIP]
> <span data-ttu-id="4b63d-159">Si vous utilisez le portail Azure actuel ou PowerShell, les images Windows Server publiées à compter du 8 septembre 2014 sont approuvées.</span><span class="sxs-lookup"><span data-stu-id="4b63d-159">If you are using the current Azure portal or PowerShell, Windows Server images published on September 8, 2014 and later are approved.</span></span>
>
>

### <a name="32-create-your-windows-based-vm"></a><span data-ttu-id="4b63d-160">3.2 Créer votre machine virtuelle Windows</span><span class="sxs-lookup"><span data-stu-id="4b63d-160">3.2 Create your Windows-based VM</span></span>
<span data-ttu-id="4b63d-161">À partir du Portail Microsoft Azure, vous pouvez créer votre machine virtuelle sur la base d’une image de base approuvée en suivant quelques étapes simples.</span><span class="sxs-lookup"><span data-stu-id="4b63d-161">From the Microsoft Azure portal, you can create your VM based on an approved base image in just a few simple steps.</span></span> <span data-ttu-id="4b63d-162">Voici une vue d’ensemble du processus.</span><span class="sxs-lookup"><span data-stu-id="4b63d-162">The following is an overview of the process:</span></span>

1. <span data-ttu-id="4b63d-163">À partir de la page des images de base, sélectionnez **Créer une machine virtuelle** pour accéder au nouveau [Portail Microsoft Azure][link-azure-portal].</span><span class="sxs-lookup"><span data-stu-id="4b63d-163">From the base image page, select **Create Virtual Machine** to be directed to the new [Microsoft Azure portal][link-azure-portal].</span></span>

    ![dessin][img-acom-1]
2. <span data-ttu-id="4b63d-165">Connectez-vous au portail en utilisant le compte Microsoft et mot de passe de l’abonnement Azure que vous voulez utiliser.</span><span class="sxs-lookup"><span data-stu-id="4b63d-165">Sign in to the portal with the Microsoft account and password for the Azure subscription you want to use.</span></span>
3. <span data-ttu-id="4b63d-166">Suivez les invites pour créer une machine virtuelle à l’aide de l’image de base que vous avez sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="4b63d-166">Follow the prompts to create a VM by using the base image you have selected.</span></span> <span data-ttu-id="4b63d-167">Vous devez fournir un nom d’hôte (nom de l’ordinateur), un nom d’utilisateur (administrateur inscrit) et un mot de passe correspondant à la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="4b63d-167">You need to provide a host name (name of the computer), user name (registered as an administrator), and password for the VM.</span></span>

    ![dessin][img-portal-vm-create]
4. <span data-ttu-id="4b63d-169">Sélectionnez la taille de la machine virtuelle à déployer :</span><span class="sxs-lookup"><span data-stu-id="4b63d-169">Select the size of the VM to deploy:</span></span>

    <span data-ttu-id="4b63d-170">a.</span><span class="sxs-lookup"><span data-stu-id="4b63d-170">a.</span></span>    <span data-ttu-id="4b63d-171">Si vous envisagez de développer le disque dur virtuel localement, la taille n’a pas d’importance.</span><span class="sxs-lookup"><span data-stu-id="4b63d-171">If you plan to develop the VHD on-premises, the size does not matter.</span></span> <span data-ttu-id="4b63d-172">Vous pouvez utiliser une des machines virtuelles plus petites.</span><span class="sxs-lookup"><span data-stu-id="4b63d-172">Consider using one of the smaller VMs.</span></span>

    <span data-ttu-id="4b63d-173">b.</span><span class="sxs-lookup"><span data-stu-id="4b63d-173">b.</span></span>    <span data-ttu-id="4b63d-174">Si vous envisagez de développer l’image dans Azure, vous pouvez utiliser les tailles de machine virtuelle recommandées pour l’image sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="4b63d-174">If you plan to develop the image in Azure, consider using one of the recommended VM sizes for the selected image.</span></span>

    <span data-ttu-id="4b63d-175">c.</span><span class="sxs-lookup"><span data-stu-id="4b63d-175">c.</span></span>    <span data-ttu-id="4b63d-176">Pour plus d’informations sur la tarification, consultez le sélecteur de **niveaux tarifaires recommandés** inclus dans le portail.</span><span class="sxs-lookup"><span data-stu-id="4b63d-176">For pricing information, refer to the **Recommended pricing tiers** selector displayed on the portal.</span></span> <span data-ttu-id="4b63d-177">Celui-ci indique les trois tailles recommandées fournies par l’éditeur</span><span class="sxs-lookup"><span data-stu-id="4b63d-177">It will provide the three recommended sizes provided by the publisher.</span></span> <span data-ttu-id="4b63d-178">(dans ce cas, l’éditeur est Microsoft).</span><span class="sxs-lookup"><span data-stu-id="4b63d-178">(In this case, the publisher is Microsoft.)</span></span>

    ![dessin][img-portal-vm-size]
5. <span data-ttu-id="4b63d-180">Définissez les propriétés :</span><span class="sxs-lookup"><span data-stu-id="4b63d-180">Set properties:</span></span>

    <span data-ttu-id="4b63d-181">a.</span><span class="sxs-lookup"><span data-stu-id="4b63d-181">a.</span></span>    <span data-ttu-id="4b63d-182">Pour accélérer le déploiement, vous pouvez conserver les valeurs par défaut des propriétés qui figurent sous **Configuration facultative** et **Groupe de ressources**.</span><span class="sxs-lookup"><span data-stu-id="4b63d-182">For quick deployment, you can leave the default values for the properties under **Optional Configuration** and **Resource Group**.</span></span>

    <span data-ttu-id="4b63d-183">b.</span><span class="sxs-lookup"><span data-stu-id="4b63d-183">b.</span></span>    <span data-ttu-id="4b63d-184">Sous **Compte de stockage**, vous pouvez éventuellement sélectionner le compte de stockage du disque dur virtuel.</span><span class="sxs-lookup"><span data-stu-id="4b63d-184">Under **Storage Account**, you can optionally select the storage account in which the operating system VHD will be stored.</span></span>

    <span data-ttu-id="4b63d-185">c.</span><span class="sxs-lookup"><span data-stu-id="4b63d-185">c.</span></span>    <span data-ttu-id="4b63d-186">Sous **Groupe de ressources**, vous pouvez éventuellement sélectionner le groupe logique dans lequel placer la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="4b63d-186">Under **Resource Group**, you can optionally select the logical group in which to place the VM.</span></span>
6. <span data-ttu-id="4b63d-187">Sélectionnez l’ **emplacement** de déploiement :</span><span class="sxs-lookup"><span data-stu-id="4b63d-187">Select the **Location** for deployment:</span></span>

    <span data-ttu-id="4b63d-188">a.</span><span class="sxs-lookup"><span data-stu-id="4b63d-188">a.</span></span>    <span data-ttu-id="4b63d-189">Si vous envisagez de développer le disque dur virtuel localement, l’emplacement n’a pas d’importance, car vous téléchargerez l’image sur Azure ultérieurement.</span><span class="sxs-lookup"><span data-stu-id="4b63d-189">If you plan to develop the VHD on-premises, the location does not matter because you will upload the image to Azure later.</span></span>

    <span data-ttu-id="4b63d-190">b.</span><span class="sxs-lookup"><span data-stu-id="4b63d-190">b.</span></span>    <span data-ttu-id="4b63d-191">Si vous envisagez de développer l’image dans Azure, vous pouvez utiliser dès le départ une des régions Microsoft Azure basées aux États-Unis.</span><span class="sxs-lookup"><span data-stu-id="4b63d-191">If you plan to develop the image in Azure, consider using one of the US-based Microsoft Azure regions from the beginning.</span></span> <span data-ttu-id="4b63d-192">Ceci permet d’accélérer le processus de copie du disque dur virtuel effectué automatiquement par Microsoft lorsque vous soumettez votre image à des fins de certification.</span><span class="sxs-lookup"><span data-stu-id="4b63d-192">This speeds up the VHD copying process that Microsoft performs on your behalf when you submit your image for certification.</span></span>

    ![dessin][img-portal-vm-location]
7. <span data-ttu-id="4b63d-194">Cliquez sur **Create**.</span><span class="sxs-lookup"><span data-stu-id="4b63d-194">Click **Create**.</span></span> <span data-ttu-id="4b63d-195">La machine virtuelle commence à se déployer.</span><span class="sxs-lookup"><span data-stu-id="4b63d-195">The VM starts to deploy.</span></span> <span data-ttu-id="4b63d-196">L’opération ne dure que quelques minutes. Vous pouvez ensuite commencer à créer l’image pour votre référence SKU.</span><span class="sxs-lookup"><span data-stu-id="4b63d-196">Within minutes, you will have a successful deployment and can begin to create the image for your SKU.</span></span>

### <a name="33-develop-your-vhd-in-the-cloud"></a><span data-ttu-id="4b63d-197">3.3 Développer votre disque dur virtuel dans le cloud</span><span class="sxs-lookup"><span data-stu-id="4b63d-197">3.3 Develop your VHD in the cloud</span></span>
<span data-ttu-id="4b63d-198">Il est vivement recommandé de développer votre disque dur virtuel dans le cloud à l’aide du protocole RDP (Remote Desktop Protocol).</span><span class="sxs-lookup"><span data-stu-id="4b63d-198">We strongly recommend that you develop your VHD in the cloud by using Remote Desktop Protocol (RDP).</span></span> <span data-ttu-id="4b63d-199">Vous pouvez vous connecter au bureau à distance à l’aide des nom d’utilisateur et mot de passe spécifiés pendant l’approvisionnement.</span><span class="sxs-lookup"><span data-stu-id="4b63d-199">You connect to RDP with the user name and password specified during provisioning.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="4b63d-200">Si vous développez votre disque dur virtuel sur site (ce qui n’est pas recommandé), consultez la page [Création d’une image de machine virtuelle sur site](marketplace-publishing-vm-image-creation-on-premise.md).</span><span class="sxs-lookup"><span data-stu-id="4b63d-200">If you develop your VHD on-premises (which is not recommended), see [Creating a virtual machine image on-premises](marketplace-publishing-vm-image-creation-on-premise.md).</span></span> <span data-ttu-id="4b63d-201">Il est inutile de télécharger votre disque dur virtuel si vous développez dans le cloud.</span><span class="sxs-lookup"><span data-stu-id="4b63d-201">Downloading your VHD is not necessary if you are developing in the cloud.</span></span>
>
>

<span data-ttu-id="4b63d-202">**Se connecter via RDP à l’aide du [Portail Microsoft Azure][link-azure-portal]**</span><span class="sxs-lookup"><span data-stu-id="4b63d-202">**Connect via RDP using the [Microsoft Azure portal][link-azure-portal]**</span></span>

1. <span data-ttu-id="4b63d-203">Sélectionnez **Parcourir** > **Machines virtuelles**.</span><span class="sxs-lookup"><span data-stu-id="4b63d-203">Select **Browse** > **VMs**.</span></span>
2. <span data-ttu-id="4b63d-204">Le panneau Machines virtuelles s’ouvre.</span><span class="sxs-lookup"><span data-stu-id="4b63d-204">The Virtual machines blade opens.</span></span> <span data-ttu-id="4b63d-205">Assurez-vous que la machine virtuelle à laquelle vous voulez vous connecter est en cours d’exécution, puis sélectionnez-la dans la liste des machines virtuelles déployées.</span><span class="sxs-lookup"><span data-stu-id="4b63d-205">Ensure that the VM that you want to connect with is running, and then select it from the list of deployed VMs.</span></span>
3. <span data-ttu-id="4b63d-206">Un panneau s’ouvre, qui décrit la machine virtuelle sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="4b63d-206">A blade opens that describes the selected VM.</span></span> <span data-ttu-id="4b63d-207">Dans la partie supérieure, cliquez sur **Se connecter**.</span><span class="sxs-lookup"><span data-stu-id="4b63d-207">At the top, click **Connect**.</span></span>
4. <span data-ttu-id="4b63d-208">Vous êtes invité à entrer les nom d’utilisateur et mot de passe que vous avez spécifiés lors du déploiement.</span><span class="sxs-lookup"><span data-stu-id="4b63d-208">You are prompted to enter the user name and password that you specified during provisioning.</span></span>

<span data-ttu-id="4b63d-209">**Se connecter via RDP à l’aide de PowerShell**</span><span class="sxs-lookup"><span data-stu-id="4b63d-209">**Connect via RDP using PowerShell**</span></span>

<span data-ttu-id="4b63d-210">Pour télécharger un fichier de bureau à distance sur une machine locale, utilisez l’[applet de commande Get-AzureRemoteDesktopFile][link-technet-2].</span><span class="sxs-lookup"><span data-stu-id="4b63d-210">To download a remote desktop file to a local machine, use the [Get-AzureRemoteDesktopFile cmdlet][link-technet-2].</span></span> <span data-ttu-id="4b63d-211">Pour utiliser cette applet de commande, vous devez connaître les noms du service et de la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="4b63d-211">In order to use this cmdlet, you need to know the name of the service and name of the VM.</span></span> <span data-ttu-id="4b63d-212">Si vous avez créé la machine virtuelle à partir du [Portail Microsoft Azure][link-azure-portal], ces informations sont disponibles sous Propriétés de la machine virtuelle :</span><span class="sxs-lookup"><span data-stu-id="4b63d-212">If you created the VM from the [Microsoft Azure portal][link-azure-portal], you can find this information under VM properties:</span></span>

1. <span data-ttu-id="4b63d-213">Dans le Portail Microsoft Azure, sélectionnez **Parcourir** > **Machines virtuelles**.</span><span class="sxs-lookup"><span data-stu-id="4b63d-213">In the Microsoft Azure portal, select **Browse** > **VMs**.</span></span>
2. <span data-ttu-id="4b63d-214">Le panneau Machines virtuelles s’ouvre.</span><span class="sxs-lookup"><span data-stu-id="4b63d-214">The Virtual machines blade opens.</span></span> <span data-ttu-id="4b63d-215">Sélectionnez la machine virtuelle que vous avez déployée.</span><span class="sxs-lookup"><span data-stu-id="4b63d-215">Select the VM that you deployed.</span></span>
3. <span data-ttu-id="4b63d-216">Un panneau s’ouvre, qui décrit la machine virtuelle sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="4b63d-216">A blade opens that describes the selected VM.</span></span>
4. <span data-ttu-id="4b63d-217">Cliquez sur **Propriétés**.</span><span class="sxs-lookup"><span data-stu-id="4b63d-217">Click **Properties**.</span></span>
5. <span data-ttu-id="4b63d-218">La première portion du nom de domaine est le nom du service.</span><span class="sxs-lookup"><span data-stu-id="4b63d-218">The first portion of the domain name is the service name.</span></span> <span data-ttu-id="4b63d-219">Le nom d’hôte est celui de la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="4b63d-219">The host name is the VM name.</span></span>

    ![dessin][img-portal-vm-rdp]
6. <span data-ttu-id="4b63d-221">L’applet de commande qui permet de télécharger le fichier RDP pour la machine virtuelle créée sur le Bureau local de l’administrateur se présente comme suit.</span><span class="sxs-lookup"><span data-stu-id="4b63d-221">The cmdlet to download the RDP file for the created VM to the administrator's local desktop is as follows.</span></span>

        Get‐AzureRemoteDesktopFile ‐ServiceName “baseimagevm‐6820cq00” ‐Name “BaseImageVM” –LocalPath “C:\Users\Administrator\Desktop\BaseImageVM.rdp”

<span data-ttu-id="4b63d-222">Des informations supplémentaires sont disponibles sur RDP dans l’article [Se connecter à une machine virtuelle Azure avec RDP ou SSH](http://msdn.microsoft.com/library/azure/dn535788.aspx)sur MSDN.</span><span class="sxs-lookup"><span data-stu-id="4b63d-222">More information about RDP can be found on MSDN in the article [Connect to an Azure VM with RDP or SSH](http://msdn.microsoft.com/library/azure/dn535788.aspx).</span></span>

<span data-ttu-id="4b63d-223">**Configurer une machine virtuelle et créer votre référence SKU**</span><span class="sxs-lookup"><span data-stu-id="4b63d-223">**Configure a VM and create your SKU**</span></span>

<span data-ttu-id="4b63d-224">Une fois le disque dur virtuel de système d’exploitation téléchargé, utilisez Hyper-V et configurez une machine virtuelle pour commencer à créer votre référence SKU.</span><span class="sxs-lookup"><span data-stu-id="4b63d-224">After the operating system VHD is downloaded, use Hyper­V and configure a VM to begin creating your SKU.</span></span> <span data-ttu-id="4b63d-225">L’article TechNet [Installer le rôle Hyper-V et configurer un ordinateur virtuel](http://technet.microsoft.com/library/hh846766.aspx)décrit la procédure détaillée.</span><span class="sxs-lookup"><span data-stu-id="4b63d-225">Detailed steps can be found at the following TechNet link: [Install Hyper­V and Configure a VM](http://technet.microsoft.com/library/hh846766.aspx).</span></span>

### <a name="34-choose-the-correct-vhd-size"></a><span data-ttu-id="4b63d-226">3.4 Choisir la taille du disque dur virtuel</span><span class="sxs-lookup"><span data-stu-id="4b63d-226">3.4 Choose the correct VHD size</span></span>
<span data-ttu-id="4b63d-227">Le disque dur virtuel de système d’exploitation Windows de votre image de machine virtuelle doit être créé en tant que disque dur virtuel au format fixe de 128 Go.</span><span class="sxs-lookup"><span data-stu-id="4b63d-227">The Windows operating system VHD in your VM image should be created as a 128-GB fixed-format VHD.</span></span>  

<span data-ttu-id="4b63d-228">Si la taille physique est inférieure à 128 Go, le disque dur virtuel doit être fragmenté.</span><span class="sxs-lookup"><span data-stu-id="4b63d-228">If the physical size is less than 128 GB, the VHD should be sparse.</span></span> <span data-ttu-id="4b63d-229">Les images Windows et SQL Server de base fournies satisfont déjà les exigences requises alors, ne modifiez pas le format ou la taille du disque dur virtuel obtenu.</span><span class="sxs-lookup"><span data-stu-id="4b63d-229">The base Windows and SQL Server images provided already meet these requirements, so do not change the format or the size of the VHD obtained.</span></span>  

<span data-ttu-id="4b63d-230">Les disques de données peuvent avoir une taille maximale de 1 To.</span><span class="sxs-lookup"><span data-stu-id="4b63d-230">Data disks can be as large as 1 TB.</span></span> <span data-ttu-id="4b63d-231">Lorsque vous choisissez la taille du disque, rappelez-vous que les clients ne peuvent pas redimensionner les disques durs virtuels dans une image lors du déploiement.</span><span class="sxs-lookup"><span data-stu-id="4b63d-231">When deciding on the disk size, remember that customers cannot resize VHDs within an image at the time of deployment.</span></span> <span data-ttu-id="4b63d-232">Ce type de disque dur virtuel doit être créé comme disque dur virtuel au format fixe.</span><span class="sxs-lookup"><span data-stu-id="4b63d-232">Data disk VHDs should be created as a fixed-format VHD.</span></span> <span data-ttu-id="4b63d-233">Ils doivent également être fragmentés.</span><span class="sxs-lookup"><span data-stu-id="4b63d-233">They should also be sparse.</span></span> <span data-ttu-id="4b63d-234">Les disques de données peuvent être vides ou contenir des données.</span><span class="sxs-lookup"><span data-stu-id="4b63d-234">Data disks can be empty or contain data.</span></span>

### <a name="35-install-the-latest-windows-patches"></a><span data-ttu-id="4b63d-235">3.5 Installer les derniers correctifs Windows</span><span class="sxs-lookup"><span data-stu-id="4b63d-235">3.5 Install the latest Windows patches</span></span>
<span data-ttu-id="4b63d-236">Les images de base contiennent les derniers correctifs jusqu’à leur date de publication.</span><span class="sxs-lookup"><span data-stu-id="4b63d-236">The base images contain the latest patches up to their published date.</span></span> <span data-ttu-id="4b63d-237">Avant de publier le disque dur virtuel de système d’exploitation que vous avez créé, vérifiez que Windows Update a été exécuté et que les dernières mises à jour de sécurité critiques et importantes ont été installées.</span><span class="sxs-lookup"><span data-stu-id="4b63d-237">Before publishing the operating system VHD you have created, ensure that Windows Update has been run and that all the latest Critical and Important security updates have been installed.</span></span>

### <a name="36-perform-additional-configuration-and-schedule-tasks-as-necessary"></a><span data-ttu-id="4b63d-238">3.6 Effectuer les autres tâches de configuration et de planification utiles</span><span class="sxs-lookup"><span data-stu-id="4b63d-238">3.6 Perform additional configuration and schedule tasks as necessary</span></span>
<span data-ttu-id="4b63d-239">Si d’autres étapes de configuration sont requises, vous pouvez utiliser une tâche planifiée exécutée au démarrage pour apporter des modifications finales à la machine virtuelle après que celle-ci a été déployée :</span><span class="sxs-lookup"><span data-stu-id="4b63d-239">If additional configuration is needed, consider using a scheduled task that runs at startup to make any final changes to the VM after it has been deployed:</span></span>

* <span data-ttu-id="4b63d-240">Il est recommandé de supprimer automatiquement la tâche suite à une exécution réussie.</span><span class="sxs-lookup"><span data-stu-id="4b63d-240">It is a best practice to have the task delete itself upon successful execution.</span></span>
* <span data-ttu-id="4b63d-241">Aucune configuration ne doit utiliser de lecteurs autres que C ou D, car ceux-ci sont les deux seuls qui lecteurs qui existent à coup sûr.</span><span class="sxs-lookup"><span data-stu-id="4b63d-241">No configuration should rely on drives other than drives C or D, because these are the only two drives that are always guaranteed to exist.</span></span> <span data-ttu-id="4b63d-242">Le lecteur C est le disque du système d’exploitation et le lecteur D est le disque local temporaire.</span><span class="sxs-lookup"><span data-stu-id="4b63d-242">Drive C is the operating system disk, and drive D is the temporary local disk.</span></span>

### <a name="37-generalize-the-image"></a><span data-ttu-id="4b63d-243">3.7 Généraliser l’image</span><span class="sxs-lookup"><span data-stu-id="4b63d-243">3.7 Generalize the image</span></span>
<span data-ttu-id="4b63d-244">Toutes les images dans Azure Marketplace doivent être réutilisables de façon générale.</span><span class="sxs-lookup"><span data-stu-id="4b63d-244">All images in the Azure Marketplace must be reusable in a generic fashion.</span></span> <span data-ttu-id="4b63d-245">En d’autres termes, le disque dur virtuel de système d’exploitation doit être généralisé :</span><span class="sxs-lookup"><span data-stu-id="4b63d-245">In other words, the operating system VHD must be generalized:</span></span>

* <span data-ttu-id="4b63d-246">Pour Windows, l’image doit être préparée avec « sysprepped » et les opérations de configuration effectuées doivent toutes prendre en charge la commande **sysprep** .</span><span class="sxs-lookup"><span data-stu-id="4b63d-246">For Windows, the image should be "sysprepped," and no configurations should be done that do not support the **sysprep** command.</span></span>
* <span data-ttu-id="4b63d-247">Vous pouvez exécuter la commande qui suit à partir du répertoire % windir%\System32\Sysprep.</span><span class="sxs-lookup"><span data-stu-id="4b63d-247">You can run the following command from the directory %windir%\System32\Sysprep.</span></span>

        sysprep.exe /generalize /oobe /shutdown

  <span data-ttu-id="4b63d-248">Des instructions sur la préparation du système d’exploitation avec Sysprep sont fournies à l’étape de l’article MSDN intitulée [Création et téléchargement d’un disque dur virtuel Windows Server dans Azure](../virtual-machines/windows/classic/createupload-vhd.md?toc=%2fazure%2fvirtual-machines%2fwindows%2fclassic%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="4b63d-248">Guidance on how to sysprep the operating system is provided in Step of the following MSDN article: [Create and upload a Windows Server VHD to Azure](../virtual-machines/windows/classic/createupload-vhd.md?toc=%2fazure%2fvirtual-machines%2fwindows%2fclassic%2ftoc.json).</span></span>

## <a name="4-deploy-a-vm-from-your-vhds"></a><span data-ttu-id="4b63d-249">4. Déployer une machine virtuelle à partir de vos disques durs virtuels</span><span class="sxs-lookup"><span data-stu-id="4b63d-249">4. Deploy a VM from your VHDs</span></span>
<span data-ttu-id="4b63d-250">Une fois les disques durs virtuels (disque dur virtuel de système d’exploitation généralisé, et zéro ou plusieurs disques durs virtuels de disque de données) téléchargés sur un compte de stockage Azure, vous pouvez les inscrire en tant qu’image de machine virtuelle d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="4b63d-250">After you have uploaded your VHDs (the generalized operating system VHD and zero or more data disk VHDs) to an Azure storage account, you can register them as a user VM image.</span></span> <span data-ttu-id="4b63d-251">Vous pouvez tester cette image.</span><span class="sxs-lookup"><span data-stu-id="4b63d-251">Then you can test that image.</span></span> <span data-ttu-id="4b63d-252">Veuillez noter que, comme votre disque dur virtuel de système d’exploitation est généralisé, vous ne pouvez pas déployer directement la machine virtuelle en fournissant l’URL du disque dur virtuel.</span><span class="sxs-lookup"><span data-stu-id="4b63d-252">Note that because your operating system VHD is generalized, you cannot directly deploy the VM by providing the VHD URL.</span></span>

<span data-ttu-id="4b63d-253">Pour en savoir plus sur les images de machine virtuelle, consultez les articles de blog suivants :</span><span class="sxs-lookup"><span data-stu-id="4b63d-253">To learn more about VM images, review the following blog posts:</span></span>

* [<span data-ttu-id="4b63d-254">VM Image</span><span class="sxs-lookup"><span data-stu-id="4b63d-254">VM Image</span></span>](https://azure.microsoft.com/blog/vm-image-blog-post/)
* [<span data-ttu-id="4b63d-255">VM Image PowerShell How To</span><span class="sxs-lookup"><span data-stu-id="4b63d-255">VM Image PowerShell How To</span></span>](https://azure.microsoft.com/blog/vm-image-powershell-how-to-blog-post/)
* [<span data-ttu-id="4b63d-256">À propos d’images de machines virtuelles dans Azure</span><span class="sxs-lookup"><span data-stu-id="4b63d-256">About VM images in Azure</span></span>](https://msdn.microsoft.com/library/azure/dn790290.aspx)

### <a name="set-up-the-necessary-tools-powershell-and-azure-cli"></a><span data-ttu-id="4b63d-257">Configurer les outils nécessaires, PowerShell et l’interface de ligne de commande Azure</span><span class="sxs-lookup"><span data-stu-id="4b63d-257">Set up the necessary tools, PowerShell and Azure CLI</span></span>
* [<span data-ttu-id="4b63d-258">Guide pratique pour configurer PowerShell</span><span class="sxs-lookup"><span data-stu-id="4b63d-258">How to setup PowerShell</span></span>](/powershell/azure/overview)
* [<span data-ttu-id="4b63d-259">Guide pratique pour configurer l’interface de ligne de commande Azure</span><span class="sxs-lookup"><span data-stu-id="4b63d-259">How to setup Azure CLI</span></span>](../cli-install-nodejs.md)

### <a name="41-create-a-user-vm-image"></a><span data-ttu-id="4b63d-260">4.1 Créer une image de machine virtuelle d’utilisateur</span><span class="sxs-lookup"><span data-stu-id="4b63d-260">4.1 Create a user VM image</span></span>
#### <a name="capture-vm"></a><span data-ttu-id="4b63d-261">Capturer la machine virtuelle</span><span class="sxs-lookup"><span data-stu-id="4b63d-261">Capture VM</span></span>
<span data-ttu-id="4b63d-262">Consultez les liens ci-dessous pour obtenir des conseils sur la capture de la machine virtuelle à l’aide de l’API, de PowerShell ou de l’interface de ligne de commande Azure.</span><span class="sxs-lookup"><span data-stu-id="4b63d-262">Please read the links given below for guidance on capturing the VM using API/PowerShell/Azure CLI.</span></span>

* [<span data-ttu-id="4b63d-263">API</span><span class="sxs-lookup"><span data-stu-id="4b63d-263">API</span></span>](https://msdn.microsoft.com/library/mt163560.aspx)
* [<span data-ttu-id="4b63d-264">PowerShell</span><span class="sxs-lookup"><span data-stu-id="4b63d-264">PowerShell</span></span>](../virtual-machines/windows/capture-image.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)
* [<span data-ttu-id="4b63d-265">interface de ligne de commande Azure</span><span class="sxs-lookup"><span data-stu-id="4b63d-265">Azure CLI</span></span>](../virtual-machines/linux/capture-image.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)

### <a name="generalize-image"></a><span data-ttu-id="4b63d-266">Généraliser une image</span><span class="sxs-lookup"><span data-stu-id="4b63d-266">Generalize Image</span></span>
<span data-ttu-id="4b63d-267">Consultez les liens ci-dessous pour obtenir des conseils sur la capture de la machine virtuelle à l’aide de l’API, de PowerShell ou de l’interface de ligne de commande Azure.</span><span class="sxs-lookup"><span data-stu-id="4b63d-267">Please read the links given below for guidance on capturing the VM using API/PowerShell/Azure CLI.</span></span>

* [<span data-ttu-id="4b63d-268">API</span><span class="sxs-lookup"><span data-stu-id="4b63d-268">API</span></span>](https://msdn.microsoft.com/library/mt269439.aspx)
* [<span data-ttu-id="4b63d-269">PowerShell</span><span class="sxs-lookup"><span data-stu-id="4b63d-269">PowerShell</span></span>](../virtual-machines/windows/capture-image.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)
* [<span data-ttu-id="4b63d-270">interface de ligne de commande Azure</span><span class="sxs-lookup"><span data-stu-id="4b63d-270">Azure CLI</span></span>](../virtual-machines/linux/capture-image.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)

### <a name="42-deploy-a-vm-from-a-user-vm-image"></a><span data-ttu-id="4b63d-271">4.2 Déployer une machine virtuelle à partir d’une image de machine virtuelle d’utilisateur</span><span class="sxs-lookup"><span data-stu-id="4b63d-271">4.2 Deploy a VM from a user VM image</span></span>
<span data-ttu-id="4b63d-272">Pour déployer une machine virtuelle à partir d’une image de machine virtuelle d’utilisateur, vous pouvez utiliser le [Portail Azure](https://manage.windowsazure.com) ou PowerShell actuel.</span><span class="sxs-lookup"><span data-stu-id="4b63d-272">To deploy a VM from a user VM image, you can use the current [Azure portal](https://manage.windowsazure.com) or PowerShell.</span></span>

<span data-ttu-id="4b63d-273">**Déployer une machine virtuelle à partir du portail Azure actuel**</span><span class="sxs-lookup"><span data-stu-id="4b63d-273">**Deploy a VM from the current Azure portal**</span></span>

1. <span data-ttu-id="4b63d-274">Accédez à **Nouveau** > **Calcul** > **Machine virtuelle** > **De la galerie**.</span><span class="sxs-lookup"><span data-stu-id="4b63d-274">Go to **New** > **Compute** > **Virtual machine** > **From gallery**.</span></span>

    ![dessin][img-manage-vm-new]
2. <span data-ttu-id="4b63d-276">Accédez à **Mes images**, puis sélectionnez l’image de machine virtuelle à partir de laquelle déployer une machine virtuelle :</span><span class="sxs-lookup"><span data-stu-id="4b63d-276">Go to **My images**, and then select the VM image from which to deploy a VM:</span></span>

   1. <span data-ttu-id="4b63d-277">Sélectionnez celle-ci avec soin, car l’affichage **Mes images** répertorie les images de système d’exploitation et les images de machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="4b63d-277">Pay close attention to which image you select, because the **My images** view lists both operating system images and VM images.</span></span>
   2. <span data-ttu-id="4b63d-278">L’examen du nombre de disques peut vous aider à déterminer le type d’image que vous déployez, car la majorité des images de machine virtuelle inclut plusieurs disques.</span><span class="sxs-lookup"><span data-stu-id="4b63d-278">Looking at the number of disks can help determine what type of image you are deploying, because the majority of VM images have more than one disk.</span></span> <span data-ttu-id="4b63d-279">Il est toutefois toujours possible d’avoir une image de machine virtuelle avec un seul disque de système d’exploitation dont le **nombre de disques** est défini sur 1.</span><span class="sxs-lookup"><span data-stu-id="4b63d-279">However, it is still possible to have a VM image with only a single operating system disk, which would then have **Number of disks** set to 1.</span></span>

      ![dessin][img-manage-vm-select]
3. <span data-ttu-id="4b63d-281">Suivez les étapes de l’Assistant de création de machine virtuelle en spécifiant le nom de la machine virtuelle, sa taille, son emplacement, ainsi que les nom d’utilisateur et mot de passe.</span><span class="sxs-lookup"><span data-stu-id="4b63d-281">Follow the VM creation wizard and specify the VM name, VM size, location, user name, and password.</span></span>

<span data-ttu-id="4b63d-282">**Déployer une machine virtuelle à partir de vos disques durs virtuels**</span><span class="sxs-lookup"><span data-stu-id="4b63d-282">**Deploy a VM from PowerShell**</span></span>

<span data-ttu-id="4b63d-283">Pour déployer une grande machine virtuelle, vous pouvez utiliser les applets de commande suivantes à partir de l’image de machine virtuelle que vous venez de créer.</span><span class="sxs-lookup"><span data-stu-id="4b63d-283">To deploy a large VM from the generalized VM image just created, you can use the following cmdlets.</span></span>

    $img = Get-AzureVMImage -ImageName "myVMImage"
    $user = "user123"
    $pass = "adminPassword123"
    $myVM = New-AzureVMConfig -Name "VMImageVM" -InstanceSize "Large" -ImageName $img.ImageName | Add-AzureProvisioningConfig -Windows -AdminUsername $user -Password $pass
    New-AzureVM -ServiceName "VMImageCloudService" -VMs $myVM -Location "West US" -WaitForBoot

> [!IMPORTANT]
> <span data-ttu-id="4b63d-284">Pour obtenir une assistance supplémentaire, consultez [Troubleshooting common issues encountered during VHD creation] \(Résolution des problèmes courants rencontrés durant la création du disque dur virtuel).</span><span class="sxs-lookup"><span data-stu-id="4b63d-284">Please refer [Troubleshooting common issues encountered during VHD creation] for additional assistance.</span></span>
>
>

## <a name="5-obtain-certification-for-your-vm-image"></a><span data-ttu-id="4b63d-285">5. Obtenir une certification pour votre image de machine virtuelle</span><span class="sxs-lookup"><span data-stu-id="4b63d-285">5. Obtain certification for your VM image</span></span>
<span data-ttu-id="4b63d-286">L’étape suivante de la préparation de votre image de machine virtuelle pour Azure Marketplace consiste à certifier celle-ci.</span><span class="sxs-lookup"><span data-stu-id="4b63d-286">The next step in preparing your VM image for the Azure Marketplace is to have it certified.</span></span>

<span data-ttu-id="4b63d-287">Dans le cadre de ce processus, vous allez exécuter un outil de certification spécial, télécharger les résultats de la vérification dans le conteneur Azure dans lequel se trouvent vos disques durs virtuels, ajouter une offre, définir votre référence SKU et soumettre votre image de machine virtuelle pour certification.</span><span class="sxs-lookup"><span data-stu-id="4b63d-287">This process includes running a special certification tool, uploading the verification results to the Azure container where your VHDs reside, adding an offer, defining your SKU, and submitting your VM image for certification.</span></span>

### <a name="51-download-and-run-the-certification-test-tool-for-azure-certified"></a><span data-ttu-id="4b63d-288">5.1 Téléchargez exécutez l’outil « Certification Test Tool for Azure Certified »</span><span class="sxs-lookup"><span data-stu-id="4b63d-288">5.1 Download and run the Certification Test Tool for Azure Certified</span></span>
<span data-ttu-id="4b63d-289">L’outil de certification s’exécute sur une machine virtuelle, configurée à partir de votre image de machine virtuelle d’utilisateur, afin de garantir que l’image de machine virtuelle est compatible avec Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="4b63d-289">The certification tool runs on a running VM, provisioned from your user VM image, to ensure that the VM image is compatible with Microsoft Azure.</span></span> <span data-ttu-id="4b63d-290">Celui-ci vérifie que les recommandations et exigences relatives à la préparation de votre disque dur virtuel sont respectées.</span><span class="sxs-lookup"><span data-stu-id="4b63d-290">It will verify that the guidance and requirements about preparing your VHD have been met.</span></span> <span data-ttu-id="4b63d-291">L’outil génère un rapport de compatibilité, qui doit être téléchargé sur le portail de publication lors de la demande de certification.</span><span class="sxs-lookup"><span data-stu-id="4b63d-291">The output of the tool is a compatibility report, which should be uploaded on the Publishing Portal while requesting certification.</span></span>

<span data-ttu-id="4b63d-292">L’outil de certification peut être utilisé avec les machines virtuelles Windows et Linux.</span><span class="sxs-lookup"><span data-stu-id="4b63d-292">The certification tool can be used with both Windows and Linux VMs.</span></span> <span data-ttu-id="4b63d-293">Il se connecte aux machines virtuelles Windows via PowerShell, et se connecte aux machines virtuelles Linux via SSH.Net :</span><span class="sxs-lookup"><span data-stu-id="4b63d-293">It connects to Windows-based VMs via PowerShell and connects to Linux VMs via SSH.Net:</span></span>

1. <span data-ttu-id="4b63d-294">Commencez par télécharger l’outil de certification sur le [site de téléchargement Microsoft][link-msft-download].</span><span class="sxs-lookup"><span data-stu-id="4b63d-294">First, download the certification tool at the [Microsoft download site][link-msft-download].</span></span>
2. <span data-ttu-id="4b63d-295">Ouvrez l’outil de certification, puis cliquez sur le bouton **Start New Test** (Commencer un nouveau test).</span><span class="sxs-lookup"><span data-stu-id="4b63d-295">Open the certification tool, and then click the **Start New Test** button.</span></span>
3. <span data-ttu-id="4b63d-296">Dans l’écran **Test Information** (Informations sur le test), entrez un nom pour la série de tests.</span><span class="sxs-lookup"><span data-stu-id="4b63d-296">From the **Test Information** screen, enter a name for the test run.</span></span>
4. <span data-ttu-id="4b63d-297">Indiquez si votre machine virtuelle est exécutée sous Linux ou Windows.</span><span class="sxs-lookup"><span data-stu-id="4b63d-297">Choose whether your VM is on Linux or Windows.</span></span> <span data-ttu-id="4b63d-298">Selon la valeur choisie, sélectionnez les options suivantes.</span><span class="sxs-lookup"><span data-stu-id="4b63d-298">Depending on which you choose, select the subsequent options.</span></span>

### <a name="connect-the-certification-tool-to-a-linux-vm-image"></a><span data-ttu-id="4b63d-299">**Connexion de l’outil de certification Tool à une image de machine virtuelle Linux**</span><span class="sxs-lookup"><span data-stu-id="4b63d-299">**Connect the certification tool to a Linux VM image**</span></span>
1. <span data-ttu-id="4b63d-300">Sélectionnez le mode d’authentification SSH : mot de passe ou fichier de clé.</span><span class="sxs-lookup"><span data-stu-id="4b63d-300">Select the SSH authentication mode: password or key file.</span></span>
2. <span data-ttu-id="4b63d-301">Si vous utilisez l’authentification basée sur le mot de passe, entrez le nom du système de nom de domaine (DNS), le nom d’utilisateur et le mot de passe.</span><span class="sxs-lookup"><span data-stu-id="4b63d-301">If using password-­based authentication, enter the Domain Name System (DNS) name, user name, and password.</span></span>
3. <span data-ttu-id="4b63d-302">Si vous utilisez l’authentification par fichier de clé, saisissez le nom DNS, le nom d’utilisateur et l’emplacement de la clé privée.</span><span class="sxs-lookup"><span data-stu-id="4b63d-302">If using key file authentication, enter the DNS name, user name, and private key location.</span></span>

   ![Authentification de l’image de machine virtuelle Linux par mot de passe][img-cert-vm-pswd-lnx]

   ![Authentification de l’image de machine virtuelle Linux par fichier de clé][img-cert-vm-key-lnx]

### <a name="connect-the-certification-tool-to-a-windows-based-vm-image"></a><span data-ttu-id="4b63d-305">**Connecter l’outil de certification à une image de machine virtuelle sous Windows**</span><span class="sxs-lookup"><span data-stu-id="4b63d-305">**Connect the certification tool to a Windows-based VM image**</span></span>
1. <span data-ttu-id="4b63d-306">Saisissez le nom de domaine (DNS) complet de la machine virtuelle (par exemple, MyVMName.Cloudapp.net).</span><span class="sxs-lookup"><span data-stu-id="4b63d-306">Enter the fully qualified VM DNS name (for example, MyVMName.Cloudapp.net).</span></span>
2. <span data-ttu-id="4b63d-307">Saisissez le nom d’utilisateur et le mot de passe.</span><span class="sxs-lookup"><span data-stu-id="4b63d-307">Enter the user name and password.</span></span>

   ![Authentification de l’image de machine virtuelle Windows par mot de passe][img-cert-vm-pswd-win]

<span data-ttu-id="4b63d-309">Après avoir sélectionné les options correctes pour votre image de machine virtuelle Linux ou Windows, cliquez sur **Test Connection** (Tester la connexion) pour vérifier que SSH.Net ou PowerShell a une connexion valide pour les tests.</span><span class="sxs-lookup"><span data-stu-id="4b63d-309">After you have selected the correct options for your Linux or Windows-based VM image, select **Test Connection** to ensure that SSH.Net or PowerShell has a valid connection for testing purposes.</span></span> <span data-ttu-id="4b63d-310">Une fois la connexion établie, sélectionnez **Suivant** pour démarrer le test.</span><span class="sxs-lookup"><span data-stu-id="4b63d-310">After a connection is established, select **Next** to start the test.</span></span>

<span data-ttu-id="4b63d-311">Une fois le test terminé, vous recevrez les résultats (Succès/Échec/Avertissement) pour chaque élément du test.</span><span class="sxs-lookup"><span data-stu-id="4b63d-311">When the test is complete, you will receive the results (Pass/Fail/Warning) for each test element.</span></span>

![Scénarios de test pour une image de machine virtuelle Linux][img-cert-vm-test-lnx]

![Scénarios de test pour une image de machine virtuelle Windows][img-cert-vm-test-win]

<span data-ttu-id="4b63d-314">Si l’un des tests échoue, votre image ne sera pas certifiée.</span><span class="sxs-lookup"><span data-stu-id="4b63d-314">If any of the tests fail, your image will not be certified.</span></span> <span data-ttu-id="4b63d-315">Dans de cas, passez en revue la configuration requise et apportez éventuellement les modifications nécessaires.</span><span class="sxs-lookup"><span data-stu-id="4b63d-315">If this occurs, review the requirements and make any necessary changes.</span></span>

<span data-ttu-id="4b63d-316">Après le test automatisé, vous devez fournir des informations supplémentaires sur votre image de machine virtuelle via un écran de questionnaire.</span><span class="sxs-lookup"><span data-stu-id="4b63d-316">After the automated test, you are asked to provide additional input on your VM image via a questionnaire screen.</span></span>  <span data-ttu-id="4b63d-317">Répondez aux questions, puis sélectionnez **Suivant**.</span><span class="sxs-lookup"><span data-stu-id="4b63d-317">Complete the questions, and then select **Next**.</span></span>

![Questionnaire de l’outil de certification][img-cert-vm-questionnaire]

![Questionnaire de l’outil de certification][img-cert-vm-questionnaire-2]

<span data-ttu-id="4b63d-320">Après avoir répondu au questionnaire, vous pouvez fournir des informations supplémentaires, telles que les informations d’accès SSH pour l’image de machine virtuelle Linux, et expliquer les raisons de n’importe quel échec d’évaluation.</span><span class="sxs-lookup"><span data-stu-id="4b63d-320">After you have completed the questionnaire, you can provide additional information such as SSH access information for the Linux VM image and an explanation for any failed assessments.</span></span> <span data-ttu-id="4b63d-321">Vous pouvez télécharger les résultats des tests et les fichiers journaux pour les scénarios de test exécutés, ainsi que vos réponses au questionnaire.</span><span class="sxs-lookup"><span data-stu-id="4b63d-321">You can download the test results and log files for the executed test cases in addition to your answers to the questionnaire.</span></span> <span data-ttu-id="4b63d-322">Enregistrez les résultats dans le même conteneur que vos disques durs virtuels.</span><span class="sxs-lookup"><span data-stu-id="4b63d-322">Save the results in the same container as your VHDs.</span></span>

![Enregistrer les résultats du test de certification][img-cert-vm-results]

### <a name="52-get-the-shared-access-signature-uri-for-your-vm-images"></a><span data-ttu-id="4b63d-324">5.2 Obtenir l’URI de signature d’accès partagé pour vos images de machine virtuelle</span><span class="sxs-lookup"><span data-stu-id="4b63d-324">5.2 Get the shared access signature URI for your VM images</span></span>
<span data-ttu-id="4b63d-325">Dans le cadre du processus de publication, vous devrez spécifier les URI (identificateur de ressource uniforme) qui permettent d’accéder aux disques durs virtuels que vous avez créés pour votre référence SKU.</span><span class="sxs-lookup"><span data-stu-id="4b63d-325">During the publishing process, you specify the uniform resource identifiers (URIs) that lead to each of the VHDs you have created for your SKU.</span></span> <span data-ttu-id="4b63d-326">Microsoft doit accéder à ces disques durs virtuels pendant le processus de certification.</span><span class="sxs-lookup"><span data-stu-id="4b63d-326">Microsoft needs access to these VHDs during the certification process.</span></span> <span data-ttu-id="4b63d-327">Par conséquent, vous devez créer un URI de signature d’accès partagé pour chaque disque dur virtuel.</span><span class="sxs-lookup"><span data-stu-id="4b63d-327">Therefore, you need to create a shared access signature URI for each VHD.</span></span> <span data-ttu-id="4b63d-328">Cet URI doit être saisi dans l’onglet **Images** du Portail de publication.</span><span class="sxs-lookup"><span data-stu-id="4b63d-328">This is the URI that should be entered in the **Images** tab in the Publishing Portal.</span></span>

<span data-ttu-id="4b63d-329">L’URI de signature d’accès partagé créé doit respecter les exigences suivantes :</span><span class="sxs-lookup"><span data-stu-id="4b63d-329">The shared access signature URI created should adhere to the following requirements:</span></span>

* <span data-ttu-id="4b63d-330">Lors de la génération des URI de signature d’accès partagé pour vos disques durs virtuels, les autorisations de liste et de lecture seule sont suffisantes.</span><span class="sxs-lookup"><span data-stu-id="4b63d-330">When generating shared access signature URIs for your VHDs, List and Read­ permissions are sufficient.</span></span> <span data-ttu-id="4b63d-331">Ne fournissez pas d’accès en écriture ou en suppression.</span><span class="sxs-lookup"><span data-stu-id="4b63d-331">Do not provide Write or Delete access.</span></span>
* <span data-ttu-id="4b63d-332">La durée d’accès doit être d’au minimum trois (3) semaines ouvrées à compter de la date de création de l’URI de signature d’accès partagé.</span><span class="sxs-lookup"><span data-stu-id="4b63d-332">The duration for access should be a minimum of three (3) weeks from when the shared access signature URI is created.</span></span>
* <span data-ttu-id="4b63d-333">Afin de préserver l’heure UTC, sélectionnez le jour précédant la date actuelle.</span><span class="sxs-lookup"><span data-stu-id="4b63d-333">To safeguard for UTC time, select the day before the current date.</span></span> <span data-ttu-id="4b63d-334">Par exemple, si la date actuelle est le 6 octobre 2014, sélectionnez 5/10/2014.</span><span class="sxs-lookup"><span data-stu-id="4b63d-334">For example, if the current date is October 6, 2014, select 10/5/2014.</span></span>

<span data-ttu-id="4b63d-335">L’URL SAS peut être générée de plusieurs manières pour partager votre disque dur virtuel sur Azure Marketplace.</span><span class="sxs-lookup"><span data-stu-id="4b63d-335">SAS URL can be generated in multiple ways to share your VHD for Azure Marketplace.</span></span>
<span data-ttu-id="4b63d-336">Voici les 3 outils recommandés :</span><span class="sxs-lookup"><span data-stu-id="4b63d-336">Following are the 3 recommended tools:</span></span>

1.  <span data-ttu-id="4b63d-337">Azure Storage Explorer</span><span class="sxs-lookup"><span data-stu-id="4b63d-337">Azure Storage Explorer</span></span>
2.  <span data-ttu-id="4b63d-338">Explorateur de stockage Microsoft</span><span class="sxs-lookup"><span data-stu-id="4b63d-338">Microsoft Storage Explorer</span></span>
3.  <span data-ttu-id="4b63d-339">Interface de ligne de commande Azure</span><span class="sxs-lookup"><span data-stu-id="4b63d-339">Azure CLI</span></span>

<span data-ttu-id="4b63d-340">**Azure Storage Explorer (recommandé pour les utilisateurs Windows)**</span><span class="sxs-lookup"><span data-stu-id="4b63d-340">**Azure Storage Explorer (Recommended for Windows Users)**</span></span>

<span data-ttu-id="4b63d-341">Voici les étapes pour générer des URL SAS à l’aide d’Azure Storage Explorer</span><span class="sxs-lookup"><span data-stu-id="4b63d-341">Following are the steps for generating SAS URL by using Azure Storage Explorer</span></span>

1. <span data-ttu-id="4b63d-342">Téléchargez [Azure Storage Explorer 6 Preview 3](https://azurestorageexplorer.codeplex.com/) à partir de CodePlex.</span><span class="sxs-lookup"><span data-stu-id="4b63d-342">Download [Azure Storage Explorer 6 Preview 3](https://azurestorageexplorer.codeplex.com/) from CodePlex.</span></span> <span data-ttu-id="4b63d-343">Accédez à [Azure Storage Explorer 6 Preview](https://azurestorageexplorer.codeplex.com/), puis cliquez sur **« Téléchargements »**.</span><span class="sxs-lookup"><span data-stu-id="4b63d-343">Go to [Azure Storage Explorer 6 Preview](https://azurestorageexplorer.codeplex.com/) and click **"Downloads"**.</span></span>

    ![dessin](media/marketplace-publishing-vm-image-creation/img5.2_01.png)

2. <span data-ttu-id="4b63d-345">Téléchargez [AzureStorageExplorer6Preview3.zip](https://azurestorageexplorer.codeplex.com/downloads/get/891668) et installez après avoir décompressé l’archive.</span><span class="sxs-lookup"><span data-stu-id="4b63d-345">Download [AzureStorageExplorer6Preview3.zip](https://azurestorageexplorer.codeplex.com/downloads/get/891668) and install after unzipping it.</span></span>

    ![dessin](media/marketplace-publishing-vm-image-creation/img5.2_02.png)

3. <span data-ttu-id="4b63d-347">Après l’installation, ouvrez l’application.</span><span class="sxs-lookup"><span data-stu-id="4b63d-347">After it is installed, open the application.</span></span>
4. <span data-ttu-id="4b63d-348">Cliquez sur **Ajouter un compte**.</span><span class="sxs-lookup"><span data-stu-id="4b63d-348">Click **Add Account**.</span></span>

    ![dessin](media/marketplace-publishing-vm-image-creation/img5.2_03.png)

5. <span data-ttu-id="4b63d-350">Spécifiez le nom du compte de stockage, la clé du compte de stockage et le domaine des points de terminaison de stockage.</span><span class="sxs-lookup"><span data-stu-id="4b63d-350">Specify the storage account name, storage account key, and storage endpoints domain.</span></span> <span data-ttu-id="4b63d-351">Il s’agit du compte de stockage dans votre abonnement Azure pour lequel vous avez conservé votre disque dur virtuel sur le portail Azure.</span><span class="sxs-lookup"><span data-stu-id="4b63d-351">This is the storage account in your Azure subscription where you have kept your VHD on Azure portal.</span></span>

    ![dessin](media/marketplace-publishing-vm-image-creation/img5.2_04.png)

6. <span data-ttu-id="4b63d-353">Une fois qu’Azure Storage Explorer est connecté à votre compte de stockage spécifique, il démarrera pour afficher tout le contenu du compte de stockage.</span><span class="sxs-lookup"><span data-stu-id="4b63d-353">Once Azure Storage Explorer is connected to your specific storage account, it will start showing all of the contains within the storage account.</span></span> <span data-ttu-id="4b63d-354">Sélectionnez le conteneur dans lequel vous avez copié le fichier de disque dur virtuel du système d’exploitation (et les disques de données, s’ils s’appliquent à votre scénario).</span><span class="sxs-lookup"><span data-stu-id="4b63d-354">Select the container where you copied the operating system disk VHD file (also data disks if they are applicable for your scenario).</span></span>

    ![dessin](media/marketplace-publishing-vm-image-creation/img5.2_05.png)

7. <span data-ttu-id="4b63d-356">Après avoir sélectionné le conteneur d’objets Blobs, Azure Storage Explorer démarrera en affichant les fichiers associés au conteneur.</span><span class="sxs-lookup"><span data-stu-id="4b63d-356">After selecting the blob container, Azure Storage Explorer starts showing the files within the container.</span></span> <span data-ttu-id="4b63d-357">Sélectionnez le fichier image (.vhd) qui doit être soumis.</span><span class="sxs-lookup"><span data-stu-id="4b63d-357">Select the image file (.vhd) that needs to be submitted.</span></span>

    ![dessin](media/marketplace-publishing-vm-image-creation/img5.2_06.png)

8.  <span data-ttu-id="4b63d-359">Après avoir sélectionné le fichier .vhd dans le conteneur, cliquez sur l’onglet **Security** (Sécurité).</span><span class="sxs-lookup"><span data-stu-id="4b63d-359">After selecting the .vhd file in the container, click the **Security** tab.</span></span>

    ![dessin](media/marketplace-publishing-vm-image-creation/img5.2_07.png)

9.  <span data-ttu-id="4b63d-361">Dans la boîte de dialogue **Blob Container Security** (Sécurité du conteneur d’objets blob), conservez les valeurs par défaut de l’onglet **Access Level** (Niveau d’accès), puis cliquez sur l’onglet **Shared Access Signatures** (Signatures d’accès partagé).</span><span class="sxs-lookup"><span data-stu-id="4b63d-361">In the **Blob Container Security** dialog box, leave the defaults on the **Access Level** tab, and then click **Shared Access Signatures** tab.</span></span>

    ![dessin](media/marketplace-publishing-vm-image-creation/img5.2_08.png)

10. <span data-ttu-id="4b63d-363">Suivez les étapes ci-dessous pour générer une signature d’accès partagé URI de l’image .vhd :</span><span class="sxs-lookup"><span data-stu-id="4b63d-363">Follow the steps below to generate a shared access signature URI for the .vhd image:</span></span>

    ![dessin](media/marketplace-publishing-vm-image-creation/img5.2_09.png)

    <span data-ttu-id="4b63d-365">a.</span><span class="sxs-lookup"><span data-stu-id="4b63d-365">a.</span></span> <span data-ttu-id="4b63d-366">**Accès autorisé à partir de** : afin de préserver l’heure UTC, sélectionnez le jour précédant la date actuelle.</span><span class="sxs-lookup"><span data-stu-id="4b63d-366">**Access permitted from:** To safeguard for UTC time, select the day before the current date.</span></span> <span data-ttu-id="4b63d-367">Par exemple, si la date actuelle est le 6 octobre 2014, sélectionnez 5/10/2014.</span><span class="sxs-lookup"><span data-stu-id="4b63d-367">For example, if the current date is October 6, 2014, select 10/5/2014.</span></span>

    <span data-ttu-id="4b63d-368">b.</span><span class="sxs-lookup"><span data-stu-id="4b63d-368">b.</span></span> <span data-ttu-id="4b63d-369">**Access permitted to** (Accès autorisé jusqu’à) : sélectionnez une date située au moins 3 semaines après la date **Access permitted from** (Accès autorisé à partir de).</span><span class="sxs-lookup"><span data-stu-id="4b63d-369">**Access permitted to:** Select a date that is at least 3 weeks after the **Access permitted from** date.</span></span>

    <span data-ttu-id="4b63d-370">c.</span><span class="sxs-lookup"><span data-stu-id="4b63d-370">c.</span></span> <span data-ttu-id="4b63d-371">**Actions permitted** (Actions autorisées) : sélectionnez les autorisations **List** (Lister) et **Read** (Lire).</span><span class="sxs-lookup"><span data-stu-id="4b63d-371">**Actions permitted:** Select the **List** and **Read** permissions.</span></span>

    <span data-ttu-id="4b63d-372">d.</span><span class="sxs-lookup"><span data-stu-id="4b63d-372">d.</span></span> <span data-ttu-id="4b63d-373">Si vous avez correctement sélectionné votre fichier .vhd, ce dernier apparaît dans **Blob name to access** (Nom d’objet Blob auquel accéder) avec l’extension .vhd.</span><span class="sxs-lookup"><span data-stu-id="4b63d-373">If you have selected your .vhd file correctly, then your file appears in **Blob name to access** with extension .vhd.</span></span>

    <span data-ttu-id="4b63d-374">e.</span><span class="sxs-lookup"><span data-stu-id="4b63d-374">e.</span></span> <span data-ttu-id="4b63d-375">Cliquez sur **Generate Signature**(Générer la signature).</span><span class="sxs-lookup"><span data-stu-id="4b63d-375">Click **Generate Signature**.</span></span>

    <span data-ttu-id="4b63d-376">f.</span><span class="sxs-lookup"><span data-stu-id="4b63d-376">f.</span></span> <span data-ttu-id="4b63d-377">Dans l’ **URI de signature d’accès partagé ainsi généré de ce conteneur**, vérifiez les points suivants comme indiqué ci-dessus :</span><span class="sxs-lookup"><span data-stu-id="4b63d-377">In **Generated Shared Access Signature URI of this container**, check for the following as highlighted above:</span></span>

       - <span data-ttu-id="4b63d-378">Assurez-vous que votre nom de fichier d’image et le **« .vhd »** sont dans l’URI.</span><span class="sxs-lookup"><span data-stu-id="4b63d-378">Make sure that your image file name and **".vhd"** are in the URI.</span></span>
       - <span data-ttu-id="4b63d-379">À la fin de la signature, assurez-vous que **« =rl »** s’affiche.</span><span class="sxs-lookup"><span data-stu-id="4b63d-379">At the end of the signature, make sure that **"=rl"** appears.</span></span> <span data-ttu-id="4b63d-380">Cela montre qu’un accès en lecture seule et de liste a été fourni avec succès.</span><span class="sxs-lookup"><span data-stu-id="4b63d-380">This demonstrates that Read and List access was provided successfully.</span></span>
       - <span data-ttu-id="4b63d-381">Au milieu de la signature, assurez-vous que **« sr=c »** s’affiche.</span><span class="sxs-lookup"><span data-stu-id="4b63d-381">In middle of the signature, make sure that **"sr=c"** appears.</span></span> <span data-ttu-id="4b63d-382">Cela montre que vous avez l’accès de niveau conteneur</span><span class="sxs-lookup"><span data-stu-id="4b63d-382">This demonstrates that you have container level access</span></span>

11. <span data-ttu-id="4b63d-383">Pour vous assurer que l’URI de signature d’accès partagé fonctionne, cliquez sur **Test in Browser**(Test dans le navigateur).</span><span class="sxs-lookup"><span data-stu-id="4b63d-383">To ensure that the generated shared access signature URI works, click **Test in Browser**.</span></span> <span data-ttu-id="4b63d-384">Le téléchargement doit normalement démarrer.</span><span class="sxs-lookup"><span data-stu-id="4b63d-384">It should start the download process.</span></span>

12. <span data-ttu-id="4b63d-385">Copiez l’URI de signature d’accès partagé.</span><span class="sxs-lookup"><span data-stu-id="4b63d-385">Copy the shared access signature URI.</span></span> <span data-ttu-id="4b63d-386">Cet URI doit être copié dans le Portail de publication.</span><span class="sxs-lookup"><span data-stu-id="4b63d-386">This is the URI to paste into the Publishing Portal.</span></span>

13. <span data-ttu-id="4b63d-387">Répétez les étapes 6 à 10 pour chaque disque dur virtuel de la référence SKU.</span><span class="sxs-lookup"><span data-stu-id="4b63d-387">Repeat steps 6-10 for each VHD in the SKU.</span></span>

<span data-ttu-id="4b63d-388">**Explorateur de stockage Microsoft Azure (Windows/MAC/Linux)**</span><span class="sxs-lookup"><span data-stu-id="4b63d-388">**Microsoft Azure Storage Explorer (Windows/MAC/Linux)**</span></span>

<span data-ttu-id="4b63d-389">Voici les étapes pour générer des URL SAS à l’aide de Microsoft Azure Storage Explorer</span><span class="sxs-lookup"><span data-stu-id="4b63d-389">Following are the steps for generating SAS URL by using Microsoft Azure Storage Explorer</span></span>

1.  <span data-ttu-id="4b63d-390">Téléchargez Microsoft Azure Storage Explorer depuis le site web [http://storageexplorer.com/](http://storageexplorer.com/).</span><span class="sxs-lookup"><span data-stu-id="4b63d-390">Download Microsoft Azure Storage Explorer form [http://storageexplorer.com/](http://storageexplorer.com/) website.</span></span> <span data-ttu-id="4b63d-391">Accédez à [Microsoft Azure Storage Explorer](http://storageexplorer.com/releasenotes.html) et cliquez sur **Download for Windows**.</span><span class="sxs-lookup"><span data-stu-id="4b63d-391">Go to [Microsoft Azure Storage Explorer](http://storageexplorer.com/releasenotes.html) and click **“Download for Windows”**.</span></span>

    ![dessin](media/marketplace-publishing-vm-image-creation/img5.2_10.png)

2.  <span data-ttu-id="4b63d-393">Après l’installation, ouvrez l’application.</span><span class="sxs-lookup"><span data-stu-id="4b63d-393">After it is installed, open the application.</span></span>

3.  <span data-ttu-id="4b63d-394">Cliquez sur **Ajouter un compte**.</span><span class="sxs-lookup"><span data-stu-id="4b63d-394">Click **Add Account**.</span></span>

4.  <span data-ttu-id="4b63d-395">Configurez Microsoft Azure Storage Explorer pour votre abonnement en vous connectant à votre compte</span><span class="sxs-lookup"><span data-stu-id="4b63d-395">Configure Microsoft Azure Storage Explorer to your subscription by sign in to your account</span></span>

    ![dessin](media/marketplace-publishing-vm-image-creation/img5.2_11.png)

5.  <span data-ttu-id="4b63d-397">Accédez au compte de stockage et sélectionnez le conteneur</span><span class="sxs-lookup"><span data-stu-id="4b63d-397">Go to storage account and select the Container</span></span>

6.  <span data-ttu-id="4b63d-398">Sélectionnez **« Obtenir la signature de partage d’accès... »**</span><span class="sxs-lookup"><span data-stu-id="4b63d-398">Select **“Get Share Access Signature..”**</span></span> <span data-ttu-id="4b63d-399">en cliquant avec le bouton droit de la souris sur le **conteneur**</span><span class="sxs-lookup"><span data-stu-id="4b63d-399">by using Right Click of the **container**</span></span>

    ![dessin](media/marketplace-publishing-vm-image-creation/img5.2_12.png)

7.  <span data-ttu-id="4b63d-401">Date de début, date d’expiration et autorisations de la mise à jour comme suit</span><span class="sxs-lookup"><span data-stu-id="4b63d-401">Update Start time, Expiry time and Permissions as per following</span></span>

    ![dessin](media/marketplace-publishing-vm-image-creation/img5.2_13.png)

    <span data-ttu-id="4b63d-403">a.</span><span class="sxs-lookup"><span data-stu-id="4b63d-403">a.</span></span>  <span data-ttu-id="4b63d-404">**Start Time** (Date de début) : Afin de préserver l’heure UTC, sélectionnez le jour précédant la date actuelle.</span><span class="sxs-lookup"><span data-stu-id="4b63d-404">**Start Time:** To safeguard for UTC time, select the day before the current date.</span></span> <span data-ttu-id="4b63d-405">Par exemple, si la date actuelle est le 6 octobre 2014, sélectionnez 5/10/2014.</span><span class="sxs-lookup"><span data-stu-id="4b63d-405">For example, if the current date is October 6, 2014, select 10/5/2014.</span></span>

    <span data-ttu-id="4b63d-406">b.</span><span class="sxs-lookup"><span data-stu-id="4b63d-406">b.</span></span>  <span data-ttu-id="4b63d-407">**Date d’expiration :** sélectionnez une date au moins 3 semaines après la **Date de début**.</span><span class="sxs-lookup"><span data-stu-id="4b63d-407">**Expiry Time:** Select a date that is at least 3 weeks after the **Start Time** date.</span></span>

    <span data-ttu-id="4b63d-408">c.</span><span class="sxs-lookup"><span data-stu-id="4b63d-408">c.</span></span>  <span data-ttu-id="4b63d-409">**Permissions** (Autorisations) : sélectionnez les autorisations **List** (Lister) et **Read** (Lire)</span><span class="sxs-lookup"><span data-stu-id="4b63d-409">**Permissions:** Select the **List** and **Read** permissions</span></span>

8.  <span data-ttu-id="4b63d-410">Copiez l’URI de signature d’accès partagé du conteneur</span><span class="sxs-lookup"><span data-stu-id="4b63d-410">Copy Container shared access signature URI</span></span>

    ![dessin](media/marketplace-publishing-vm-image-creation/img5.2_14.png)

    <span data-ttu-id="4b63d-412">L’URL SAS générée représente le niveau de conteneur, et nous devons maintenant y ajouter le nom du disque dur virtuel.</span><span class="sxs-lookup"><span data-stu-id="4b63d-412">Generated SAS URL is for container Level and now we need to add VHD name in it.</span></span>

    <span data-ttu-id="4b63d-413">Format d’URL SAS de niveau de conteneur :`https://testrg009.blob.core.windows.net/vhds?st=2016-04-22T23%3A05%3A00Z&se=2016-04-30T23%3A05%3A00Z&sp=rl&sv=2015-04-05&sr=c&sig=J3twCQZv4L4EurvugRW2klE2l2EFB9XyM6K9FkuVB58%3D`</span><span class="sxs-lookup"><span data-stu-id="4b63d-413">Format of Container Level SAS URL: `https://testrg009.blob.core.windows.net/vhds?st=2016-04-22T23%3A05%3A00Z&se=2016-04-30T23%3A05%3A00Z&sp=rl&sv=2015-04-05&sr=c&sig=J3twCQZv4L4EurvugRW2klE2l2EFB9XyM6K9FkuVB58%3D`</span></span>

    <span data-ttu-id="4b63d-414">Insérez le nom du disque dur virtuel après le nom du conteneur dans l’URL SAS comme indiqué ci-dessous`https://testrg009.blob.core.windows.net/vhds/<VHD NAME>?st=2016-04-22T23%3A05%3A00Z&se=2016-04-30T23%3A05%3A00Z&sp=rl&sv=2015-04-05&sr=c&sig=J3twCQZv4L4EurvugRW2klE2l2EFB9XyM6K9FkuVB58%3D`</span><span class="sxs-lookup"><span data-stu-id="4b63d-414">Insert VHD name after the container name in SAS URL as below `https://testrg009.blob.core.windows.net/vhds/<VHD NAME>?st=2016-04-22T23%3A05%3A00Z&se=2016-04-30T23%3A05%3A00Z&sp=rl&sv=2015-04-05&sr=c&sig=J3twCQZv4L4EurvugRW2klE2l2EFB9XyM6K9FkuVB58%3D`</span></span>

    <span data-ttu-id="4b63d-415">Exemple :</span><span class="sxs-lookup"><span data-stu-id="4b63d-415">Example:</span></span>

    ![dessin](media/marketplace-publishing-vm-image-creation/img5.2_15.png)

    <span data-ttu-id="4b63d-417">TestRGVM201631920152.vhd est le nom du disque dur virtuel, alors l’URL SAS du disque dur virtuel sera `https://testrg009.blob.core.windows.net/vhds/TestRGVM201631920152.vhd?st=2016-04-22T23%3A05%3A00Z&se=2016-04-30T23%3A05%3A00Z&sp=rl&sv=2015-04-05&sr=c&sig=J3twCQZv4L4EurvugRW2klE2l2EFB9XyM6K9FkuVB58%3D`</span><span class="sxs-lookup"><span data-stu-id="4b63d-417">TestRGVM201631920152.vhd is the VHD Name then VHD SAS URL will be `https://testrg009.blob.core.windows.net/vhds/TestRGVM201631920152.vhd?st=2016-04-22T23%3A05%3A00Z&se=2016-04-30T23%3A05%3A00Z&sp=rl&sv=2015-04-05&sr=c&sig=J3twCQZv4L4EurvugRW2klE2l2EFB9XyM6K9FkuVB58%3D`</span></span>

    - <span data-ttu-id="4b63d-418">Assurez-vous que votre nom de fichier d’image et le **« .vhd »** sont dans l’URI.</span><span class="sxs-lookup"><span data-stu-id="4b63d-418">Make sure that your image file name and **".vhd"** are in the URI.</span></span>
    - <span data-ttu-id="4b63d-419">Au milieu de la signature, assurez-vous que **« sp=rl »** s’affiche.</span><span class="sxs-lookup"><span data-stu-id="4b63d-419">In middle of the signature, make sure that **"sp=rl"** appears.</span></span> <span data-ttu-id="4b63d-420">Cela montre qu’un accès en lecture seule et de liste a été fourni avec succès.</span><span class="sxs-lookup"><span data-stu-id="4b63d-420">This demonstrates that Read and List access was provided successfully.</span></span>
    - <span data-ttu-id="4b63d-421">Au milieu de la signature, assurez-vous que **« sr=c »** s’affiche.</span><span class="sxs-lookup"><span data-stu-id="4b63d-421">In middle of the signature, make sure that **"sr=c"** appears.</span></span> <span data-ttu-id="4b63d-422">Cela montre que vous avez l’accès de niveau conteneur</span><span class="sxs-lookup"><span data-stu-id="4b63d-422">This demonstrates that you have container level access</span></span>

9.  <span data-ttu-id="4b63d-423">Pour vous assurer que l’URI de signature d’accès partagé fonctionne, testez-la dans le navigateur.</span><span class="sxs-lookup"><span data-stu-id="4b63d-423">To ensure that the generated shared access signature URI works, test it in browser.</span></span> <span data-ttu-id="4b63d-424">Le téléchargement doit normalement démarrer</span><span class="sxs-lookup"><span data-stu-id="4b63d-424">It should start the download process</span></span>

10. <span data-ttu-id="4b63d-425">Copiez l’URI de signature d’accès partagé.</span><span class="sxs-lookup"><span data-stu-id="4b63d-425">Copy the shared access signature URI.</span></span> <span data-ttu-id="4b63d-426">Cet URI doit être copié dans le Portail de publication.</span><span class="sxs-lookup"><span data-stu-id="4b63d-426">This is the URI to paste into the Publishing Portal.</span></span>

11. <span data-ttu-id="4b63d-427">Répétez ces étapes pour chaque disque dur virtuel de la référence SKU.</span><span class="sxs-lookup"><span data-stu-id="4b63d-427">Repeat these steps for each VHD in the SKU.</span></span>

<span data-ttu-id="4b63d-428">**Interface de ligne de commande Azure (méthode recommandée pour l’intégration continue/non Windows)**</span><span class="sxs-lookup"><span data-stu-id="4b63d-428">**Azure CLI (Recommended for Non-Windows & Continuous Integration)**</span></span>

<span data-ttu-id="4b63d-429">Voici les étapes pour générer des URL SAS à l’aide de l’interface de ligne de commande Azure</span><span class="sxs-lookup"><span data-stu-id="4b63d-429">Following are the steps for generating SAS URL by using Azure CLI</span></span>

1.  <span data-ttu-id="4b63d-430">Téléchargez l’interface de ligne de commande Microsoft Azure [ici](https://azure.microsoft.com/en-in/documentation/articles/xplat-cli-install/).</span><span class="sxs-lookup"><span data-stu-id="4b63d-430">Download Microsoft Azure CLI from [here](https://azure.microsoft.com/en-in/documentation/articles/xplat-cli-install/).</span></span> <span data-ttu-id="4b63d-431">Vous y trouverez également les différents liens pour  **[Windows](http://aka.ms/webpi-azure-cli)**  et  **[Mac OS](http://aka.ms/mac-azure-cli)**.</span><span class="sxs-lookup"><span data-stu-id="4b63d-431">You can also find different links for **[Windows](http://aka.ms/webpi-azure-cli)** and **[MAC OS](http://aka.ms/mac-azure-cli)**.</span></span>

2.  <span data-ttu-id="4b63d-432">Après le téléchargement, veuillez effectuer l’installation</span><span class="sxs-lookup"><span data-stu-id="4b63d-432">Once it is downloaded, please install</span></span>

3.  <span data-ttu-id="4b63d-433">Créez un fichier PowerShell avec le code suivant et enregistrez-le en local</span><span class="sxs-lookup"><span data-stu-id="4b63d-433">Create a PowerShell file with following code and save it in local</span></span>

          $conn="DefaultEndpointsProtocol=https;AccountName=<StorageAccountName>;AccountKey=<Storage Account Key>"
          azure storage container list vhds -c $conn
          azure storage container sas create vhds rl <Permission End Date> -c $conn --start <Permission Start Date>  

    <span data-ttu-id="4b63d-434">Mettez à jour les paramètres suivants</span><span class="sxs-lookup"><span data-stu-id="4b63d-434">Update the following parameters in above</span></span>

    <span data-ttu-id="4b63d-435">a.</span><span class="sxs-lookup"><span data-stu-id="4b63d-435">a.</span></span> <span data-ttu-id="4b63d-436">**`<StorageAccountName>`** : indiquez le nom de votre compte de stockage</span><span class="sxs-lookup"><span data-stu-id="4b63d-436">**`<StorageAccountName>`**: Give your storage account name</span></span>

    <span data-ttu-id="4b63d-437">b.</span><span class="sxs-lookup"><span data-stu-id="4b63d-437">b.</span></span> <span data-ttu-id="4b63d-438">**`<Storage Account Key>`** : indiquez la clé de votre compte de stockage</span><span class="sxs-lookup"><span data-stu-id="4b63d-438">**`<Storage Account Key>`**: Give your storage account key</span></span>

    <span data-ttu-id="4b63d-439">c.</span><span class="sxs-lookup"><span data-stu-id="4b63d-439">c.</span></span> <span data-ttu-id="4b63d-440">**`<Permission Start Date>`** : afin de préserver l’heure UTC, sélectionnez le jour précédant la date actuelle.</span><span class="sxs-lookup"><span data-stu-id="4b63d-440">**`<Permission Start Date>`**: To safeguard for UTC time, select the day before the current date.</span></span> <span data-ttu-id="4b63d-441">Par exemple, si la date actuelle est le 26 octobre 2016, la valeur doit être 25/10/2016</span><span class="sxs-lookup"><span data-stu-id="4b63d-441">For example, if the current date is October 26, 2016, then value should be 10/25/2016</span></span>

    <span data-ttu-id="4b63d-442">d.</span><span class="sxs-lookup"><span data-stu-id="4b63d-442">d.</span></span> <span data-ttu-id="4b63d-443">**`<Permission End Date>`** : sélectionnez une date au moins 3 semaines après la **Date de début**.</span><span class="sxs-lookup"><span data-stu-id="4b63d-443">**`<Permission End Date>`**: Select a date that is at least 3 weeks after the **Start Date**.</span></span> <span data-ttu-id="4b63d-444">La valeur doit donc être **11/02/2016**.</span><span class="sxs-lookup"><span data-stu-id="4b63d-444">Then value should be **11/02/2016**.</span></span>

    <span data-ttu-id="4b63d-445">Voici l’exemple de code après la mise à jour des bons paramètres</span><span class="sxs-lookup"><span data-stu-id="4b63d-445">Following is the example code after updating proper parameters</span></span>

          $conn="DefaultEndpointsProtocol=https;AccountName=st20151;AccountKey=TIQE5QWMKHpT5q2VnF1bb+NUV7NVMY2xmzVx1rdgIVsw7h0pcI5nMM6+DVFO65i4bQevx21dmrflA91r0Vh2Yw=="
          azure storage container list vhds -c $conn
          azure storage container sas create vhds rl 11/02/2016 -c $conn --start 10/25/2016  

4.  <span data-ttu-id="4b63d-446">Ouvrez l’éditeur PowerShell avec le mode « Exécuter en tant qu’administrateur » et ouvrez le fichier de l’étape 3.</span><span class="sxs-lookup"><span data-stu-id="4b63d-446">Open Powershell editor with “Run as Administrator” mode and open file in step #3.</span></span>

5.  <span data-ttu-id="4b63d-447">Exécutez le script, il vous fournira l’URL SAS pour l’accès au niveau conteneur</span><span class="sxs-lookup"><span data-stu-id="4b63d-447">Run the script and it will provide you the SAS URL for container level access</span></span>

    <span data-ttu-id="4b63d-448">La sortie de la signature SAS suivra. Copiez la partie en surbrillance dans un bloc-notes</span><span class="sxs-lookup"><span data-stu-id="4b63d-448">Following will be the output of the SAS Signature and copy the highlighted part in a notepad</span></span>

    ![dessin](media/marketplace-publishing-vm-image-creation/img5.2_16.png)

6.  <span data-ttu-id="4b63d-450">Maintenant, vous obtenez l’URL SAS au niveau conteneur et vous devez lui ajouter le nom du disque dur virtuel.</span><span class="sxs-lookup"><span data-stu-id="4b63d-450">Now you will get container level SAS URL and you need to add VHD name in it.</span></span>

    <span data-ttu-id="4b63d-451">URL SAS de niveau de conteneur</span><span class="sxs-lookup"><span data-stu-id="4b63d-451">Container level SAS URL #</span></span>

    `https://st20151.blob.core.windows.net/vhds?st=2016-10-25T07%3A00%3A00Z&se=2016-11-02T07%3A00%3A00Z&sp=rl&sv=2015-12-11&sr=c&sig=wnEw9RfVKeSmVgqDfsDvC9IHhis4x0fc9Hu%2FW4yvBxk%3D`

7.  <span data-ttu-id="4b63d-452">Insérez le nom du disque dur virtuel après le nom du conteneur dans l’URL SAS comme indiqué ci-dessous`https://st20151.blob.core.windows.net/vhds/<VHDName>?st=2016-10-25T07%3A00%3A00Z&se=2016-11-02T07%3A00%3A00Z&sp=rl&sv=2015-12-11&sr=c&sig=wnEw9RfVKeSmVgqDfsDvC9IHhis4x0fc9Hu%2FW4yvBxk%3D`</span><span class="sxs-lookup"><span data-stu-id="4b63d-452">Insert VHD name after the container name in SAS URL as shown below `https://st20151.blob.core.windows.net/vhds/<VHDName>?st=2016-10-25T07%3A00%3A00Z&se=2016-11-02T07%3A00%3A00Z&sp=rl&sv=2015-12-11&sr=c&sig=wnEw9RfVKeSmVgqDfsDvC9IHhis4x0fc9Hu%2FW4yvBxk%3D`</span></span>

    <span data-ttu-id="4b63d-453">Exemple :</span><span class="sxs-lookup"><span data-stu-id="4b63d-453">Example:</span></span>

    <span data-ttu-id="4b63d-454">TestRGVM201631920152.vhd est le nom du disque dur virtuel, alors l’URL SAS du disque dur virtuel sera</span><span class="sxs-lookup"><span data-stu-id="4b63d-454">TestRGVM201631920152.vhd is the VHD Name then VHD SAS URL will be</span></span>

    `https://st20151.blob.core.windows.net/vhds/ TestRGVM201631920152.vhd?st=2016-10-25T07%3A00%3A00Z&se=2016-11-02T07%3A00%3A00Z&sp=rl&sv=2015-12-11&sr=c&sig=wnEw9RfVKeSmVgqDfsDvC9IHhis4x0fc9Hu%2FW4yvBxk%3D`

    - <span data-ttu-id="4b63d-455">Assurez-vous que votre nom de fichier d’image et le « .vhd » sont dans l’URI.</span><span class="sxs-lookup"><span data-stu-id="4b63d-455">Make sure that your image file name and ".vhd" are in the URI.</span></span>
    -   <span data-ttu-id="4b63d-456">Au milieu de la signature, assurez-vous que « sp=rl » s’affiche.</span><span class="sxs-lookup"><span data-stu-id="4b63d-456">In middle of the signature, make sure that "sp=rl" appears.</span></span> <span data-ttu-id="4b63d-457">Cela montre qu’un accès en lecture seule et de liste a été fourni avec succès.</span><span class="sxs-lookup"><span data-stu-id="4b63d-457">This demonstrates that Read and List access was provided successfully.</span></span>
    -   <span data-ttu-id="4b63d-458">Au milieu de la signature, assurez-vous que « sr=c » s’affiche.</span><span class="sxs-lookup"><span data-stu-id="4b63d-458">In middle of the signature, make sure that "sr=c" appears.</span></span> <span data-ttu-id="4b63d-459">Cela montre que vous avez l’accès de niveau conteneur</span><span class="sxs-lookup"><span data-stu-id="4b63d-459">This demonstrates that you have container level access</span></span>

8.  <span data-ttu-id="4b63d-460">Pour vous assurer que l’URI de signature d’accès partagé fonctionne, testez-la dans le navigateur.</span><span class="sxs-lookup"><span data-stu-id="4b63d-460">To ensure that the generated shared access signature URI works, test it in browser.</span></span> <span data-ttu-id="4b63d-461">Le téléchargement doit normalement démarrer</span><span class="sxs-lookup"><span data-stu-id="4b63d-461">It should start the download process</span></span>

9.  <span data-ttu-id="4b63d-462">Copiez l’URI de signature d’accès partagé.</span><span class="sxs-lookup"><span data-stu-id="4b63d-462">Copy the shared access signature URI.</span></span> <span data-ttu-id="4b63d-463">Cet URI doit être copié dans le Portail de publication.</span><span class="sxs-lookup"><span data-stu-id="4b63d-463">This is the URI to paste into the Publishing Portal.</span></span>

10. <span data-ttu-id="4b63d-464">Répétez ces étapes pour chaque disque dur virtuel de la référence SKU.</span><span class="sxs-lookup"><span data-stu-id="4b63d-464">Repeat these steps for each VHD in the SKU.</span></span>


### <a name="53-provide-information-about-the-vm-image-and-request-certification-in-the-publishing-portal"></a><span data-ttu-id="4b63d-465">5.3 Fournir des informations sur l’image de machine virtuelle et demander une certification dans le Portail de publication</span><span class="sxs-lookup"><span data-stu-id="4b63d-465">5.3 Provide information about the VM image and request certification in the Publishing Portal</span></span>
<span data-ttu-id="4b63d-466">Une fois que vous avez créé votre offre et votre référence SKU, vous devez renseigner les détails de l’image associés à la référence en question.</span><span class="sxs-lookup"><span data-stu-id="4b63d-466">After you have created your offer and SKU, you should enter the image details associated with that SKU:</span></span>

1. <span data-ttu-id="4b63d-467">Accédez au [Portail de publication][link-pubportal] et connectez-vous à votre compte de vendeur.</span><span class="sxs-lookup"><span data-stu-id="4b63d-467">Go to the [Publishing Portal][link-pubportal], and then sign in with your seller account.</span></span>
2. <span data-ttu-id="4b63d-468">Sélectionnez l’onglet **VM Images** (Images de machine virtuelle)</span><span class="sxs-lookup"><span data-stu-id="4b63d-468">Select the **VM images** tab.</span></span>
3. <span data-ttu-id="4b63d-469">L’identificateur figurant en haut de la page est en fait l’identificateur de l’offre et non l’identificateur de la référence SKU.</span><span class="sxs-lookup"><span data-stu-id="4b63d-469">The identifier listed at the top of the page is actually the offer identifier and not the SKU identifier.</span></span>
4. <span data-ttu-id="4b63d-470">Renseignez les propriétés sous la section **SKU** (Références SKU).</span><span class="sxs-lookup"><span data-stu-id="4b63d-470">Fill out the properties under the **SKUs** section.</span></span>
5. <span data-ttu-id="4b63d-471">Sous **Famille de système d’exploitation**, sélectionnez le type de système d’exploitation associé au disque dur virtuel du système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="4b63d-471">Under **Operating system family**, click the operating system type associated with the operating system VHD.</span></span>
6. <span data-ttu-id="4b63d-472">Sous **Système d’exploitation**, décrivez le système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="4b63d-472">In the **Operating system** box, describe the operating system.</span></span> <span data-ttu-id="4b63d-473">Envisagez un format du type Famille de systèmes d’exploitation, Type, Version et Mises à jour,</span><span class="sxs-lookup"><span data-stu-id="4b63d-473">Consider a format such as operating system family, type, version, and updates.</span></span> <span data-ttu-id="4b63d-474">Par exemple, « Windows Server Datacenter 2014 R2 ».</span><span class="sxs-lookup"><span data-stu-id="4b63d-474">An example is "Windows Server Datacenter 2014 R2."</span></span>
7. <span data-ttu-id="4b63d-475">Sélectionnez jusqu’à six tailles de machine virtuelle recommandées.</span><span class="sxs-lookup"><span data-stu-id="4b63d-475">Select up to six recommended virtual machine sizes.</span></span> <span data-ttu-id="4b63d-476">Ces recommandations sont présentées à l’utilisateur dans le panneau Niveau tarifaire du portail de gestion Azure s’il décide d’acheter et de déployer votre image.</span><span class="sxs-lookup"><span data-stu-id="4b63d-476">These are recommendations that get displayed to the customer in the Pricing tier blade in the Azure Portal when they decide to purchase and deploy your image.</span></span> <span data-ttu-id="4b63d-477">**Il s’agit uniquement de recommandations. Le client peut sélectionner n’importe quelle taille de machine virtuelle prenant en charge les disques spécifiés dans votre image.**</span><span class="sxs-lookup"><span data-stu-id="4b63d-477">**These are only recommendations. The customer is able to select any VM size that accommodates the disks specified in your image.**</span></span>
8. <span data-ttu-id="4b63d-478">Indiquez la version.</span><span class="sxs-lookup"><span data-stu-id="4b63d-478">Enter the version.</span></span> <span data-ttu-id="4b63d-479">Le champ version encapsule une version sémantique pour identifier le produit et ses mises à jour :</span><span class="sxs-lookup"><span data-stu-id="4b63d-479">The version field encapsulates a semantic version to identify the product and its updates:</span></span>
   * <span data-ttu-id="4b63d-480">Les versions doivent être au format X.Y.Z, où X, Y et Z sont des entiers.</span><span class="sxs-lookup"><span data-stu-id="4b63d-480">Versions should be of the form X.Y.Z, where X, Y, and Z are integers.</span></span>
   * <span data-ttu-id="4b63d-481">Les images contenues dans des références SKU différentes peuvent avoir différentes versions majeures et mineures.</span><span class="sxs-lookup"><span data-stu-id="4b63d-481">Images in different SKUs can have different major and minor versions.</span></span>
   * <span data-ttu-id="4b63d-482">Les versions au sein d’une même référence SKU ne doivent impliquer que des modifications incrémentielles, qui augmentent la version du correctif (Z de X.Y.Z).</span><span class="sxs-lookup"><span data-stu-id="4b63d-482">Versions within a SKU should only be incremental changes, which increase the patch version (Z from X.Y.Z).</span></span>
9. <span data-ttu-id="4b63d-483">Dans la zone **URL de disque dur virtuel de système d’exploitation** , saisissez la signature d’accès partagé créée pour le disque dur virtuel du système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="4b63d-483">In the **OS VHD URL** box, enter the shared access signature URI created for the operating system VHD.</span></span>
10. <span data-ttu-id="4b63d-484">Si des disques de données sont associés à cette référence SKU, sélectionnez le numéro d’unité logique que vous voulez utiliser pour le montage de ce disque de données lors du déploiement.</span><span class="sxs-lookup"><span data-stu-id="4b63d-484">If there are data disks associated with this SKU, select the logical unit number (LUN) to which you would like this data disk to be mounted upon deployment.</span></span>
11. <span data-ttu-id="4b63d-485">Dans la zone **URL de disque dur virtuel LUN X** entrez la signature d’accès partagé créée pour les données du premier disque dur virtuel.</span><span class="sxs-lookup"><span data-stu-id="4b63d-485">In the **LUN X VHD URL** box, enter the shared access signature URI created for the first data VHD.</span></span>

    ![dessin](media/marketplace-publishing-vm-image-creation/vm-image-pubportal-skus-3.png)


## <a name="common-sas-url-issues--fixes"></a><span data-ttu-id="4b63d-487">Problèmes communs avec les URL SAS et résolution</span><span class="sxs-lookup"><span data-stu-id="4b63d-487">Common SAS URL issues & fixes</span></span>

|<span data-ttu-id="4b63d-488">Problème</span><span class="sxs-lookup"><span data-stu-id="4b63d-488">Issue</span></span>|<span data-ttu-id="4b63d-489">Message d’échec</span><span class="sxs-lookup"><span data-stu-id="4b63d-489">Failure Message</span></span>|<span data-ttu-id="4b63d-490">Correctif</span><span class="sxs-lookup"><span data-stu-id="4b63d-490">Fix</span></span>|<span data-ttu-id="4b63d-491">Lien vers la documentation</span><span class="sxs-lookup"><span data-stu-id="4b63d-491">Documentation Link</span></span>|
|---|---|---|---|
|<span data-ttu-id="4b63d-492">Échec lors de la copie d’images : « ? » est introuvable dans l’URL SAS</span><span class="sxs-lookup"><span data-stu-id="4b63d-492">Failure in copying images - "?" is not found in SAS url</span></span>|<span data-ttu-id="4b63d-493">Échec : copie d’images.</span><span class="sxs-lookup"><span data-stu-id="4b63d-493">Failure: Copying Images.</span></span> <span data-ttu-id="4b63d-494">Impossible de télécharger l’objet blob avec l’URI SAS fournie.</span><span class="sxs-lookup"><span data-stu-id="4b63d-494">Not able to download blob using provided SAS Uri.</span></span>|<span data-ttu-id="4b63d-495">Mettez à jour l’URL SAS avec les outils recommandés</span><span class="sxs-lookup"><span data-stu-id="4b63d-495">Update the SAS Url using recommended tools</span></span>|[<span data-ttu-id="4b63d-496">https://azure.microsoft.com/en-us/documentation/articles/storage-dotnet-shared-access-signature-part-1/</span><span class="sxs-lookup"><span data-stu-id="4b63d-496">https://azure.microsoft.com/en-us/documentation/articles/storage-dotnet-shared-access-signature-part-1/</span></span>](https://azure.microsoft.com/en-us/documentation/articles/storage-dotnet-shared-access-signature-part-1/)|
|<span data-ttu-id="4b63d-497">Échec lors de la copie d’images : les paramètres « st » et « se » ne sont pas présents dans l’URL SAS</span><span class="sxs-lookup"><span data-stu-id="4b63d-497">Failure in copying images - “st” and “se” parameters not in SAS url</span></span>|<span data-ttu-id="4b63d-498">Échec : copie d’images.</span><span class="sxs-lookup"><span data-stu-id="4b63d-498">Failure: Copying Images.</span></span> <span data-ttu-id="4b63d-499">Impossible de télécharger l’objet blob avec l’URI SAS fournie.</span><span class="sxs-lookup"><span data-stu-id="4b63d-499">Not able to download blob using provided SAS Uri.</span></span>|<span data-ttu-id="4b63d-500">Mettez à jour l’URL SAS en ajoutant les dates de début et de fin</span><span class="sxs-lookup"><span data-stu-id="4b63d-500">Update the SAS Url with Start and End dates on it</span></span>|[<span data-ttu-id="4b63d-501">https://azure.microsoft.com/en-us/documentation/articles/storage-dotnet-shared-access-signature-part-1/</span><span class="sxs-lookup"><span data-stu-id="4b63d-501">https://azure.microsoft.com/en-us/documentation/articles/storage-dotnet-shared-access-signature-part-1/</span></span>](https://azure.microsoft.com/en-us/documentation/articles/storage-dotnet-shared-access-signature-part-1/)|
|<span data-ttu-id="4b63d-502">Échec lors de la copie d’images : « sp=rl » n’est pas présent dans l’URL SAS</span><span class="sxs-lookup"><span data-stu-id="4b63d-502">Failure in copying images - “sp=rl” not in SAS url</span></span>|<span data-ttu-id="4b63d-503">Échec : copie d’images.</span><span class="sxs-lookup"><span data-stu-id="4b63d-503">Failure: Copying Images.</span></span> <span data-ttu-id="4b63d-504">Impossible de télécharger l’objet blob avec l’URI SAS fournie</span><span class="sxs-lookup"><span data-stu-id="4b63d-504">Not able to download blob using provided SAS Uri</span></span>|<span data-ttu-id="4b63d-505">Mettez à jour l’URL SAS avec les autorisations définies sur « Lecture » et « Liste »</span><span class="sxs-lookup"><span data-stu-id="4b63d-505">Update the SAS Url with permissions set as “Read” & “List</span></span>|[<span data-ttu-id="4b63d-506">https://azure.microsoft.com/en-us/documentation/articles/storage-dotnet-shared-access-signature-part-1/</span><span class="sxs-lookup"><span data-stu-id="4b63d-506">https://azure.microsoft.com/en-us/documentation/articles/storage-dotnet-shared-access-signature-part-1/</span></span>](https://azure.microsoft.com/en-us/documentation/articles/storage-dotnet-shared-access-signature-part-1/)|
|<span data-ttu-id="4b63d-507">Échec lors de la copie d’images : l’URL SAS contient des espaces blancs dans le nom du disque dur virtuel</span><span class="sxs-lookup"><span data-stu-id="4b63d-507">Failure in copying images - SAS url have white spaces in vhd name</span></span>|<span data-ttu-id="4b63d-508">Échec : copie d’images.</span><span class="sxs-lookup"><span data-stu-id="4b63d-508">Failure: Copying Images.</span></span> <span data-ttu-id="4b63d-509">Impossible de télécharger l’objet blob avec l’URI SAS fournie.</span><span class="sxs-lookup"><span data-stu-id="4b63d-509">Not able to download blob using provided SAS Uri.</span></span>|<span data-ttu-id="4b63d-510">Mettez à jour l’URL SAS sans espaces blancs</span><span class="sxs-lookup"><span data-stu-id="4b63d-510">Update the SAS Url without white spaces</span></span>|[<span data-ttu-id="4b63d-511">https://azure.microsoft.com/en-us/documentation/articles/storage-dotnet-shared-access-signature-part-1/</span><span class="sxs-lookup"><span data-stu-id="4b63d-511">https://azure.microsoft.com/en-us/documentation/articles/storage-dotnet-shared-access-signature-part-1/</span></span>](https://azure.microsoft.com/en-us/documentation/articles/storage-dotnet-shared-access-signature-part-1/)|
|<span data-ttu-id="4b63d-512">Échec lors de la copie d’images : erreur d’autorisation d’URL SAS</span><span class="sxs-lookup"><span data-stu-id="4b63d-512">Failure in copying images – SAS Url Authorization error</span></span>|<span data-ttu-id="4b63d-513">Échec : copie d’images.</span><span class="sxs-lookup"><span data-stu-id="4b63d-513">Failure: Copying Images.</span></span> <span data-ttu-id="4b63d-514">Impossible de télécharger l’objet blob en raison d’une erreur d’autorisation</span><span class="sxs-lookup"><span data-stu-id="4b63d-514">Not able to download blob due to authorization error</span></span>|<span data-ttu-id="4b63d-515">Générez à nouveau l’URL SAS</span><span class="sxs-lookup"><span data-stu-id="4b63d-515">Regenerate the SAS Url</span></span>|[<span data-ttu-id="4b63d-516">https://azure.microsoft.com/en-us/documentation/articles/storage-dotnet-shared-access-signature-part-1/</span><span class="sxs-lookup"><span data-stu-id="4b63d-516">https://azure.microsoft.com/en-us/documentation/articles/storage-dotnet-shared-access-signature-part-1/</span></span>](https://azure.microsoft.com/en-us/documentation/articles/storage-dotnet-shared-access-signature-part-1/)|


## <a name="next-step"></a><span data-ttu-id="4b63d-517">Étape suivante</span><span class="sxs-lookup"><span data-stu-id="4b63d-517">Next step</span></span>
<span data-ttu-id="4b63d-518">Une fois que vous avez terminé avec les détails de la référence SKU, vous pouvez consulter le [Guide de contenu marketing Azure Marketplace][link-pushstaging].</span><span class="sxs-lookup"><span data-stu-id="4b63d-518">After you are done with the SKU details, you can move forward to the [Azure Marketplace marketing content guide][link-pushstaging].</span></span> <span data-ttu-id="4b63d-519">Dans cette étape du processus de publication, vous devez fournir le contenu marketing, la tarification et d’autres informations nécessaires avant l’ **étape 3 : test de votre machine virtuelle en mode intermédiaire**, où vous testez divers scénarios de cas d’utilisation avant de déployer l’offre sur Azure Marketplace pour une visibilité publique et l’achat.</span><span class="sxs-lookup"><span data-stu-id="4b63d-519">In that step of the publishing process, you provide the marketing content, pricing, and other information necessary prior to **Step 3: Testing your VM offer in staging**, where you test various use-case scenarios before deploying the offer to the Azure Marketplace for public visibility and purchase.</span></span>  

## <a name="see-also"></a><span data-ttu-id="4b63d-520">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="4b63d-520">See also</span></span>
* [<span data-ttu-id="4b63d-521">Mise en route : publication d’une offre dans Azure Marketplace</span><span class="sxs-lookup"><span data-stu-id="4b63d-521">Getting started: How to publish an offer to the Azure Marketplace</span></span>](marketplace-publishing-getting-started.md)

[img-acom-1]:media/marketplace-publishing-vm-image-creation/vm-image-acom-datacenter.png
[img-portal-vm-size]:media/marketplace-publishing-vm-image-creation/vm-image-portal-size.png
[img-portal-vm-create]:media/marketplace-publishing-vm-image-creation/vm-image-portal-create-vm.png
[img-portal-vm-location]:media/marketplace-publishing-vm-image-creation/vm-image-portal-location.png
[img-portal-vm-rdp]:media/marketplace-publishing-vm-image-creation/vm-image-portal-rdp.png
[img-azstg-add]:media/marketplace-publishing-vm-image-creation/vm-image-storage-add.png
[img-manage-vm-new]:media/marketplace-publishing-vm-image-creation/vm-image-manage-new.png
[img-manage-vm-select]:media/marketplace-publishing-vm-image-creation/vm-image-manage-select.png
[img-cert-vm-key-lnx]:media/marketplace-publishing-vm-image-creation/vm-image-certification-keyfile-linux.png
[img-cert-vm-pswd-lnx]:media/marketplace-publishing-vm-image-creation/vm-image-certification-password-linux.png
[img-cert-vm-pswd-win]:media/marketplace-publishing-vm-image-creation/vm-image-certification-password-win.png
[img-cert-vm-test-lnx]:media/marketplace-publishing-vm-image-creation/vm-image-certification-test-sample-linux.png
[img-cert-vm-test-win]:media/marketplace-publishing-vm-image-creation/vm-image-certification-test-sample-win.png
[img-cert-vm-results]:media/marketplace-publishing-vm-image-creation/vm-image-certification-results.png
[img-cert-vm-questionnaire]:media/marketplace-publishing-vm-image-creation/vm-image-certification-questionnaire.png
[img-cert-vm-questionnaire-2]:media/marketplace-publishing-vm-image-creation/vm-image-certification-questionnaire-2.png
[img-pubportal-vm-skus]:media/marketplace-publishing-vm-image-creation/vm-image-pubportal-skus.png
[img-pubportal-vm-skus-2]:media/marketplace-publishing-vm-image-creation/vm-image-pubportal-skus-2.png

[link-pushstaging]:marketplace-publishing-push-to-staging.md
[link-github-waagent]:https://github.com/Azure/WALinuxAgent
[link-azure-codeplex]:https://azurestorageexplorer.codeplex.com/
[link-azure-2]:../storage/blobs/storage-dotnet-shared-access-signature-part-2.md
[link-azure-1]:../storage/common/storage-dotnet-shared-access-signature-part-1.md
[link-msft-download]:http://www.microsoft.com/download/details.aspx?id=44299
[link-technet-3]:https://technet.microsoft.com/library/hh846766.aspx
[link-technet-2]:https://msdn.microsoft.com/library/dn495261.aspx
[link-azure-portal]:https://portal.azure.com
[link-pubportal]:https://publish.windowsazure.com
[link-sql-2014-ent]:http://azure.microsoft.com/marketplace/partners/microsoft/sqlserver2014enterprisewindowsserver2012r2/
[link-sql-2014-std]:http://azure.microsoft.com/marketplace/partners/microsoft/sqlserver2014standardwindowsserver2012r2/
[link-sql-2014-web]:http://azure.microsoft.com/marketplace/partners/microsoft/sqlserver2014webwindowsserver2012r2/
[link-sql-2012-ent]:http://azure.microsoft.com/marketplace/partners/microsoft/sqlserver2012sp2enterprisewindowsserver2012/
[link-sql-2012-std]:http://azure.microsoft.com/marketplace/partners/microsoft/sqlserver2012sp2standardwindowsserver2012/
[link-sql-2012-web]:http://azure.microsoft.com/marketplace/partners/microsoft/sqlserver2012sp2webwindowsserver2012/
[link-datactr-2012-r2]:http://azure.microsoft.com/marketplace/partners/microsoft/windowsserver2012r2datacenter/
[link-datactr-2012]:http://azure.microsoft.com/marketplace/partners/microsoft/windowsserver2012datacenter/
[link-datactr-2008-r2]:http://azure.microsoft.com/marketplace/partners/microsoft/windowsserver2008r2sp1/
[link-acct-creation]:marketplace-publishing-accounts-creation-registration.md
[link-technet-1]:https://technet.microsoft.com/library/hh848454.aspx
[link-azure-vm-2]:./virtual-machines-linux-agent-user-guide/
[link-openssl]:https://www.openssl.org/
[link-intsvc]:http://www.microsoft.com/download/details.aspx?id=41554
[link-python]:https://www.python.org/
