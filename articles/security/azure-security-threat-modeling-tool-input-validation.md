---
title: "Validation des entrées - Outil Microsoft de modélisation des menaces - Azure | Microsoft Docs"
description: "Mesures de correction des menaces exposées dans l’outil de modélisation des menaces"
services: security
documentationcenter: na
author: RodSan
manager: RodSan
editor: RodSan
ms.assetid: na
ms.service: security
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/17/2017
ms.author: rodsan
ms.openlocfilehash: b7ce6f353cf8cf48d5fb038ee77b0d3fdae16fb7
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/29/2017
---
# <a name="security-frame-input-validation--mitigations"></a><span data-ttu-id="4d2c2-103">Infrastructure de sécurité : validation des entrées | Mesures de correction</span><span class="sxs-lookup"><span data-stu-id="4d2c2-103">Security Frame: Input Validation | Mitigations</span></span> 
| <span data-ttu-id="4d2c2-104">Produit/Service</span><span class="sxs-lookup"><span data-stu-id="4d2c2-104">Product/Service</span></span> | <span data-ttu-id="4d2c2-105">Article</span><span class="sxs-lookup"><span data-stu-id="4d2c2-105">Article</span></span> |
| --------------- | ------- |
| <span data-ttu-id="4d2c2-106">**Application web**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-106">**Web Application**</span></span> | <ul><li>[<span data-ttu-id="4d2c2-107">Désactiver les scripts XSLT pour toutes les transformations à l’aide de feuilles de style non approuvées</span><span class="sxs-lookup"><span data-stu-id="4d2c2-107">Disable XSLT scripting for all transforms using untrusted style sheets</span></span>](#disable-xslt)</li><li>[<span data-ttu-id="4d2c2-108">S’assurer que chaque page susceptible de comporter du contenu contrôlable par l’utilisateur refuse la détection MIME automatique</span><span class="sxs-lookup"><span data-stu-id="4d2c2-108">Ensure that each page that could contain user controllable content opts out of automatic MIME sniffing</span></span>](#out-sniffing)</li><li>[<span data-ttu-id="4d2c2-109">Renforcer ou désactiver la résolution d’entité XML</span><span class="sxs-lookup"><span data-stu-id="4d2c2-109">Harden or Disable XML Entity Resolution</span></span>](#xml-resolution)</li><li>[<span data-ttu-id="4d2c2-110">Les applications utilisant http.sys doivent procéder à la vérification de la canonisation des URL</span><span class="sxs-lookup"><span data-stu-id="4d2c2-110">Applications utilizing http.sys perform URL canonicalization verification</span></span>](#app-verification)</li><li>[<span data-ttu-id="4d2c2-111">S’assurer que les contrôles appropriés sont en place lors de l’acceptation de fichiers provenant d’utilisateurs</span><span class="sxs-lookup"><span data-stu-id="4d2c2-111">Ensure appropriate controls are in place when accepting files from users</span></span>](#controls-users)</li><li>[<span data-ttu-id="4d2c2-112">S’assurer que des paramètres de type sécurisé sont utilisés dans une application web pour l’accès aux données</span><span class="sxs-lookup"><span data-stu-id="4d2c2-112">Ensure that type-safe parameters are used in Web Application for data access</span></span>](#typesafe)</li><li>[<span data-ttu-id="4d2c2-113">Utiliser des classes de liaison de modèle ou des listes de filtre de liaison distinctes pour empêcher une vulnérabilité d’attribution collective MVC</span><span class="sxs-lookup"><span data-stu-id="4d2c2-113">Use separate model binding classes or binding filter lists to prevent MVC mass assignment vulnerability</span></span>](#binding-mvc)</li><li>[<span data-ttu-id="4d2c2-114">Encoder une sortie web non approuvée avant le rendu</span><span class="sxs-lookup"><span data-stu-id="4d2c2-114">Encode untrusted web output prior to rendering</span></span>](#rendering)</li><li>[<span data-ttu-id="4d2c2-115">Procéder à la validation et au filtrage des entrées sur les propriétés de modèle de tous types de chaînes</span><span class="sxs-lookup"><span data-stu-id="4d2c2-115">Perform input validation and filtering on all string type Model properties</span></span>](#typemodel)</li><li>[<span data-ttu-id="4d2c2-116">Les champs de formulaire acceptant tous les caractères, par exemple dans un éditeur de texte enrichi, doivent être nettoyés</span><span class="sxs-lookup"><span data-stu-id="4d2c2-116">Sanitization should be applied on form fields that accept all characters, e.g, rich text editor</span></span>](#richtext)</li><li>[<span data-ttu-id="4d2c2-117">Ne pas attribuer d’éléments DOM à des récepteurs sans codage intégré</span><span class="sxs-lookup"><span data-stu-id="4d2c2-117">Do not assign DOM elements to sinks that do not have inbuilt encoding</span></span>](#inbuilt-encode)</li><li>[<span data-ttu-id="4d2c2-118">Valider la sécurité de la fermeture ou de l’exécution de toutes les redirections au sein de l’application</span><span class="sxs-lookup"><span data-stu-id="4d2c2-118">Validate all redirects within the application are closed or done safely</span></span>](#redirect-safe)</li><li>[<span data-ttu-id="4d2c2-119">Implémenter la validation des entrées sur tous les paramètres de type de chaîne acceptés par les méthodes de contrôleur</span><span class="sxs-lookup"><span data-stu-id="4d2c2-119">Implement input validation on all string type parameters accepted by Controller methods</span></span>](#string-method)</li><li>[<span data-ttu-id="4d2c2-120">Définir le seuil supérieur du délai d’expiration pour le traitement des expressions régulières afin d’empêcher un déni de service en raison d’expressions régulières incorrectes</span><span class="sxs-lookup"><span data-stu-id="4d2c2-120">Set upper limit timeout for regular expression processing to prevent DoS due to bad regular expressions</span></span>](#dos-expression)</li><li>[<span data-ttu-id="4d2c2-121">Éviter l’utilisation de Html.Raw dans les vues Razor</span><span class="sxs-lookup"><span data-stu-id="4d2c2-121">Avoid using Html.Raw in Razor views</span></span>](#html-razor)</li></ul> | 
| <span data-ttu-id="4d2c2-122">**Base de données**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-122">**Database**</span></span> | <ul><li>[<span data-ttu-id="4d2c2-123">Ne pas utiliser les requêtes dynamiques dans les procédures stockées</span><span class="sxs-lookup"><span data-stu-id="4d2c2-123">Do not use dynamic queries in stored procedures</span></span>](#stored-proc)</li></ul> |
| <span data-ttu-id="4d2c2-124">**API Web**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-124">**Web API**</span></span> | <ul><li>[<span data-ttu-id="4d2c2-125">S’assurer que la validation du modèle est effectuée sur les méthodes d’API Web</span><span class="sxs-lookup"><span data-stu-id="4d2c2-125">Ensure that model validation is done on Web API methods</span></span>](#validation-api)</li><li>[<span data-ttu-id="4d2c2-126">Implémenter la validation des entrées sur tous les paramètres de type de chaîne acceptés par les méthodes d’API Web</span><span class="sxs-lookup"><span data-stu-id="4d2c2-126">Implement input validation on all string type parameters accepted by Web API methods</span></span>](#string-api)</li><li>[<span data-ttu-id="4d2c2-127">S’assurer que les paramètres de type sécurisé sont utilisés dans une API Web pour l’accès aux données</span><span class="sxs-lookup"><span data-stu-id="4d2c2-127">Ensure that type-safe parameters are used in Web API for data access</span></span>](#typesafe-api)</li></ul> | 
| <span data-ttu-id="4d2c2-128">**Azure Document DB**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-128">**Azure Document DB**</span></span> | <ul><li>[<span data-ttu-id="4d2c2-129">Utiliser des requêtes SQL paramétrables pour DocumentDB</span><span class="sxs-lookup"><span data-stu-id="4d2c2-129">Use parametrized SQL queries for DocumentDB</span></span>](#sql-docdb)</li></ul> | 
| <span data-ttu-id="4d2c2-130">**WCF**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-130">**WCF**</span></span> | <ul><li>[<span data-ttu-id="4d2c2-131">Validation des entrées WCF par le biais de la liaison de schéma</span><span class="sxs-lookup"><span data-stu-id="4d2c2-131">WCF Input validation through Schema binding</span></span>](#schema-binding)</li><li>[<span data-ttu-id="4d2c2-132">WCF - Validation des entrées par le biais des inspecteurs de paramètres</span><span class="sxs-lookup"><span data-stu-id="4d2c2-132">WCF- Input validation through Parameter Inspectors</span></span>](#parameters)</li></ul> |

## <span data-ttu-id="4d2c2-133"><a id="disable-xslt"></a>Désactiver les scripts XSLT pour toutes les transformations à l’aide de feuilles de style non approuvées</span><span class="sxs-lookup"><span data-stu-id="4d2c2-133"><a id="disable-xslt"></a>Disable XSLT scripting for all transforms using untrusted style sheets</span></span>

| <span data-ttu-id="4d2c2-134">Intitulé</span><span class="sxs-lookup"><span data-stu-id="4d2c2-134">Title</span></span>                   | <span data-ttu-id="4d2c2-135">Détails</span><span class="sxs-lookup"><span data-stu-id="4d2c2-135">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="4d2c2-136">**Composant**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-136">**Component**</span></span>               | <span data-ttu-id="4d2c2-137">Application web</span><span class="sxs-lookup"><span data-stu-id="4d2c2-137">Web Application</span></span> | 
| <span data-ttu-id="4d2c2-138">**Phase SDL**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-138">**SDL Phase**</span></span>               | <span data-ttu-id="4d2c2-139">Créer</span><span class="sxs-lookup"><span data-stu-id="4d2c2-139">Build</span></span> |  
| <span data-ttu-id="4d2c2-140">**Technologies applicables**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-140">**Applicable Technologies**</span></span> | <span data-ttu-id="4d2c2-141">Générique</span><span class="sxs-lookup"><span data-stu-id="4d2c2-141">Generic</span></span> |
| <span data-ttu-id="4d2c2-142">**Attributs**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-142">**Attributes**</span></span>              | <span data-ttu-id="4d2c2-143">N/A</span><span class="sxs-lookup"><span data-stu-id="4d2c2-143">N/A</span></span>  |
| <span data-ttu-id="4d2c2-144">**Informations de référence**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-144">**References**</span></span>              | <span data-ttu-id="4d2c2-145">[Sécurité XSLT](https://msdn.microsoft.com/library/ms763800(v=vs.85).aspx), [Propriété XsltSettings.EnableScript](http://msdn.microsoft.com/library/system.xml.xsl.xsltsettings.enablescript.aspx)</span><span class="sxs-lookup"><span data-stu-id="4d2c2-145">[XSLT Security](https://msdn.microsoft.com/library/ms763800(v=vs.85).aspx), [XsltSettings.EnableScript Property](http://msdn.microsoft.com/library/system.xml.xsl.xsltsettings.enablescript.aspx)</span></span> |
| <span data-ttu-id="4d2c2-146">**Étapes**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-146">**Steps**</span></span> | <span data-ttu-id="4d2c2-147">XSLT prend en charge les scripts dans les feuilles de style à l’aide de l’élément `<msxml:script>`.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-147">XSLT supports scripting inside style sheets using the `<msxml:script>` element.</span></span> <span data-ttu-id="4d2c2-148">Cela permet d’utiliser des fonctions personnalisées dans une transformation XSLT.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-148">This allows custom functions to be used in an XSLT transformation.</span></span> <span data-ttu-id="4d2c2-149">Le script est exécuté dans le cadre du processus exécutant la transformation.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-149">The script is executed under the context of the process performing the transform.</span></span> <span data-ttu-id="4d2c2-150">Le script XSLT doit être désactivé dans les environnements non approuvés afin d’empêcher l’exécution de code non approuvé.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-150">XSLT script must be disabled when in an untrusted environment to prevent execution of untrusted code.</span></span> <span data-ttu-id="4d2c2-151">*Si vous utilisez .NET :* les scripts XSLT sont désactivés par défaut. Cependant, vous devez vous assurer qu’ils n’ont pas été explicitement activés par le biais de la propriété `XsltSettings.EnableScript`.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-151">*If using .NET:* XSLT scripting is disabled by default; however, you must ensure that it has not been explicitly enabled through the `XsltSettings.EnableScript` property.</span></span>|

### <a name="example"></a><span data-ttu-id="4d2c2-152">Exemple</span><span class="sxs-lookup"><span data-stu-id="4d2c2-152">Example</span></span> 

```C#
XsltSettings settings = new XsltSettings();
settings.EnableScript = true; // WRONG: THIS SHOULD BE SET TO false
```

### <a name="example"></a><span data-ttu-id="4d2c2-153">Exemple</span><span class="sxs-lookup"><span data-stu-id="4d2c2-153">Example</span></span>
<span data-ttu-id="4d2c2-154">Si vous utilisez MSXML 6.0 : les scripts XSLT sont désactivés par défaut. Cependant, vous devez vous assurer qu’ils n’ont pas été explicitement activés par le biais de la propriété d’objet DOM XML AllowXsltScript.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-154">If you are using using MSXML 6.0, XSLT scripting is disabled by default; however, you must ensure that it has not been explicitly enabled through the XML DOM object property AllowXsltScript.</span></span> 

```C#
doc.setProperty("AllowXsltScript", true); // WRONG: THIS SHOULD BE SET TO false
```

### <a name="example"></a><span data-ttu-id="4d2c2-155">Exemple</span><span class="sxs-lookup"><span data-stu-id="4d2c2-155">Example</span></span>
<span data-ttu-id="4d2c2-156">Si vous utilisez MSXML 5 ou une version antérieure, les scripts XSLT sont activés par défaut et vous devez les désactiver explicitement.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-156">If you are using MSXML 5 or below, XSLT scripting is enabled by default and you must explicitly disable it.</span></span> <span data-ttu-id="4d2c2-157">Définissez la propriété de l’objet XML DOM AllowXsltScript sur false.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-157">Set the XML DOM object property AllowXsltScript to false.</span></span> 

```C#
doc.setProperty("AllowXsltScript", false); // CORRECT. Setting to false disables XSLT scripting.
```

## <span data-ttu-id="4d2c2-158"><a id="out-sniffing"></a>S’assurer que chaque page susceptible de comporter du contenu contrôlable par l’utilisateur refuse la détection MIME automatique</span><span class="sxs-lookup"><span data-stu-id="4d2c2-158"><a id="out-sniffing"></a>Ensure that each page that could contain user controllable content opts out of automatic MIME sniffing</span></span>

| <span data-ttu-id="4d2c2-159">Intitulé</span><span class="sxs-lookup"><span data-stu-id="4d2c2-159">Title</span></span>                   | <span data-ttu-id="4d2c2-160">Détails</span><span class="sxs-lookup"><span data-stu-id="4d2c2-160">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="4d2c2-161">**Composant**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-161">**Component**</span></span>               | <span data-ttu-id="4d2c2-162">Application web</span><span class="sxs-lookup"><span data-stu-id="4d2c2-162">Web Application</span></span> | 
| <span data-ttu-id="4d2c2-163">**Phase SDL**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-163">**SDL Phase**</span></span>               | <span data-ttu-id="4d2c2-164">Créer</span><span class="sxs-lookup"><span data-stu-id="4d2c2-164">Build</span></span> |  
| <span data-ttu-id="4d2c2-165">**Technologies applicables**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-165">**Applicable Technologies**</span></span> | <span data-ttu-id="4d2c2-166">Générique</span><span class="sxs-lookup"><span data-stu-id="4d2c2-166">Generic</span></span> |
| <span data-ttu-id="4d2c2-167">**Attributs**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-167">**Attributes**</span></span>              | <span data-ttu-id="4d2c2-168">N/A</span><span class="sxs-lookup"><span data-stu-id="4d2c2-168">N/A</span></span>  |
| <span data-ttu-id="4d2c2-169">**Informations de référence**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-169">**References**</span></span>              | [<span data-ttu-id="4d2c2-170">IE8 Security Part V - Comprehensive Protection (Sécurité IE8 Partie V - Protection complète)</span><span class="sxs-lookup"><span data-stu-id="4d2c2-170">IE8 Security Part V - Comprehensive Protection</span></span>](http://blogs.msdn.com/ie/archive/2008/07/02/ie8-security-part-v-comprehensive-protection.aspx)  |
| <span data-ttu-id="4d2c2-171">**Étapes**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-171">**Steps**</span></span> | <p><span data-ttu-id="4d2c2-172">Pour chaque page susceptible de comporter du contenu contrôlable par l’utilisateur, vous devez utiliser l’en-tête HTTP `X-Content-Type-Options:nosniff`.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-172">For each page that could contain user controllable content, you must use the HTTP Header `X-Content-Type-Options:nosniff`.</span></span> <span data-ttu-id="4d2c2-173">Pour satisfaire cette exigence, vous pouvez définir l’en-tête requis page par page uniquement pour les pages susceptibles de comporter du contenu contrôlable par l’utilisateur, ou vous pouvez définir un en-tête global pour toutes les pages de l’application.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-173">To comply with this requirement, you can either set the required header page by page for only those pages that might contain user-controllable content, or you can set it globally for all pages in the application.</span></span></p><p><span data-ttu-id="4d2c2-174">Chaque type de fichier provenant d’un serveur web est associé à un [type MIME](http://en.wikipedia.org/wiki/Mime_type) (également appelé *type de contenu*) qui décrit la nature du contenu (image, texte, application, etc.)</span><span class="sxs-lookup"><span data-stu-id="4d2c2-174">Each type of file delivered from a web server has an associated [MIME type](http://en.wikipedia.org/wiki/Mime_type) (also called a *content-type*) that describes the nature of the content (that is, image, text, application, etc.)</span></span></p><p><span data-ttu-id="4d2c2-175">L’en-tête X-Content-Type-Options est un en-tête HTTP permettant aux développeurs de spécifier que leur contenu ne doit pas être détecté par MIME.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-175">The X-Content-Type-Options header is an HTTP header that allows developers to specify that their content should not be MIME-sniffed.</span></span> <span data-ttu-id="4d2c2-176">Cet en-tête est conçu pour limiter les attaques par détection MIME.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-176">This header is designed to mitigate MIME-Sniffing attacks.</span></span> <span data-ttu-id="4d2c2-177">La prise en charge de cet en-tête a été ajoutée dans Internet Explorer 8 (IE8).</span><span class="sxs-lookup"><span data-stu-id="4d2c2-177">Support for this header was added in Internet Explorer 8 (IE8)</span></span></p><p><span data-ttu-id="4d2c2-178">Seuls les utilisateurs d’Internet Explorer 8 (IE8) bénéficient de l’en-tête X-Content-Type-Options.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-178">Only users of Internet Explorer 8 (IE8) will benefit from X-Content-Type-Options.</span></span> <span data-ttu-id="4d2c2-179">À l’heure actuelle, les versions antérieures d’Internet Explorer ne prennent pas en charge l’en-tête X-Content-Type-Options</span><span class="sxs-lookup"><span data-stu-id="4d2c2-179">Previous versions of Internet Explorer do not currently respect the X-Content-Type-Options header</span></span></p><p><span data-ttu-id="4d2c2-180">Internet Explorer 8 (et les versions ultérieures) constitue le seul navigateur majeur permettant d’implémenter une fonctionnalité de refus de la détection MIME.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-180">Internet Explorer 8 (and later) are the only major browsers to implement a MIME-sniffing opt-out feature.</span></span> <span data-ttu-id="4d2c2-181">Si d’autres navigateurs majeurs (Firefox, Safari, Chrome) implémentent des fonctionnalités similaires, cette recommandation sera mise à jour afin d’inclure également la syntaxe de ces navigateurs</span><span class="sxs-lookup"><span data-stu-id="4d2c2-181">If and when other major browsers (Firefox, Safari, Chrome) implement similar features, this recommendation will be updated to include syntax for those browsers as well</span></span></p>|

### <a name="example"></a><span data-ttu-id="4d2c2-182">Exemple</span><span class="sxs-lookup"><span data-stu-id="4d2c2-182">Example</span></span>
<span data-ttu-id="4d2c2-183">Pour activer l’en-tête requis sur toutes les pages de l’application, vous pouvez effectuer l’une des opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="4d2c2-183">To enable the required header globally for all pages in the application, you can do one of the following:</span></span> 

* <span data-ttu-id="4d2c2-184">Ajoutez l’en-tête dans le fichier web.config si l’application est hébergée par Internet Information Services (IIS) 7</span><span class="sxs-lookup"><span data-stu-id="4d2c2-184">Add the header in the web.config file if the application is hosted by Internet Information Services (IIS) 7</span></span> 

```
<system.webServer> 
  <httpProtocol> 
    <customHeaders> 
      <add name=""X-Content-Type-Options"" value=""nosniff""/>
    </customHeaders>
  </httpProtocol>
</system.webServer> 
```

* <span data-ttu-id="4d2c2-185">Ajoutez l’en-tête par le biais de la méthode Global.Application\_BeginRequest</span><span class="sxs-lookup"><span data-stu-id="4d2c2-185">Add the header through the global Application\_BeginRequest</span></span> 

``` 
void Application_BeginRequest(object sender, EventArgs e)
{
  this.Response.Headers[""X-Content-Type-Options""] = ""nosniff"";
} 
```

* <span data-ttu-id="4d2c2-186">Implémentez le module HTTP personnalisé</span><span class="sxs-lookup"><span data-stu-id="4d2c2-186">Implement custom HTTP module</span></span> 

``` 
public class XContentTypeOptionsModule : IHttpModule 
  {
    #region IHttpModule Members 
    public void Dispose() 
    { 

    } 
    public void Init(HttpApplication context)
    { 
      context.PreSendRequestHeaders += newEventHandler(context_PreSendRequestHeaders); 
    } 
    #endregion 
    void context_PreSendRequestHeaders(object sender, EventArgs e) 
      { 
        HttpApplication application = sender as HttpApplication; 
        if (application == null) 
          return; 
        if (application.Response.Headers[""X-Content-Type-Options ""] != null) 
          return; 
        application.Response.Headers.Add(""X-Content-Type-Options "", ""nosniff""); 
      } 
  } 

``` 

* <span data-ttu-id="4d2c2-187">Vous pouvez activer l’en-tête requis uniquement pour des pages spécifiques en l’ajoutant à des réponses individuelles :</span><span class="sxs-lookup"><span data-stu-id="4d2c2-187">You can enable the required header only for specific pages by adding it to individual responses:</span></span> 

```
this.Response.Headers[""X-Content-Type-Options""] = ""nosniff""; 
``` 

## <span data-ttu-id="4d2c2-188"><a id="xml-resolution"></a>Renforcer ou désactiver la résolution d’entité XML</span><span class="sxs-lookup"><span data-stu-id="4d2c2-188"><a id="xml-resolution"></a>Harden or Disable XML Entity Resolution</span></span>

| <span data-ttu-id="4d2c2-189">Intitulé</span><span class="sxs-lookup"><span data-stu-id="4d2c2-189">Title</span></span>                   | <span data-ttu-id="4d2c2-190">Détails</span><span class="sxs-lookup"><span data-stu-id="4d2c2-190">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="4d2c2-191">**Composant**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-191">**Component**</span></span>               | <span data-ttu-id="4d2c2-192">Application web</span><span class="sxs-lookup"><span data-stu-id="4d2c2-192">Web Application</span></span> | 
| <span data-ttu-id="4d2c2-193">**Phase SDL**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-193">**SDL Phase**</span></span>               | <span data-ttu-id="4d2c2-194">Créer</span><span class="sxs-lookup"><span data-stu-id="4d2c2-194">Build</span></span> |  
| <span data-ttu-id="4d2c2-195">**Technologies applicables**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-195">**Applicable Technologies**</span></span> | <span data-ttu-id="4d2c2-196">Générique</span><span class="sxs-lookup"><span data-stu-id="4d2c2-196">Generic</span></span> |
| <span data-ttu-id="4d2c2-197">**Attributs**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-197">**Attributes**</span></span>              | <span data-ttu-id="4d2c2-198">N/A</span><span class="sxs-lookup"><span data-stu-id="4d2c2-198">N/A</span></span>  |
| <span data-ttu-id="4d2c2-199">**Informations de référence**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-199">**References**</span></span>              | <span data-ttu-id="4d2c2-200">[XML Entity Expansion (Extension d’entité XML)](http://capec.mitre.org/data/definitions/197.html), [Attaques par déni de service XML et moyens de défense](http://msdn.microsoft.com/magazine/ee335713.aspx), [Vue d’ensemble de la sécurité MSXML](http://msdn.microsoft.com/library/ms754611(v=VS.85).aspx), [Meilleures pratiques pour la sécurisation du Code MSXML](http://msdn.microsoft.com/library/ms759188(VS.85).aspx), [Référence de protocole NSXMLParserDelegate](http://developer.apple.com/library/ios/#documentation/cocoa/reference/NSXMLParserDelegate_Protocol/Reference/Reference.html), [Résolution des ressources externes](https://msdn.microsoft.com/library/5fcwybb2.aspx)</span><span class="sxs-lookup"><span data-stu-id="4d2c2-200">[XML Entity Expansion](http://capec.mitre.org/data/definitions/197.html), [XML Denial of Service Attacks and Defenses](http://msdn.microsoft.com/magazine/ee335713.aspx), [MSXML Security Overview](http://msdn.microsoft.com/library/ms754611(v=VS.85).aspx), [Best Practices for Securing MSXML Code](http://msdn.microsoft.com/library/ms759188(VS.85).aspx), [NSXMLParserDelegate Protocol Reference](http://developer.apple.com/library/ios/#documentation/cocoa/reference/NSXMLParserDelegate_Protocol/Reference/Reference.html), [Resolving External References](https://msdn.microsoft.com/library/5fcwybb2.aspx)</span></span> |
| <span data-ttu-id="4d2c2-201">**Étapes**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-201">**Steps**</span></span>| <p><span data-ttu-id="4d2c2-202">Bien qu’elle soit peu utilisée, une fonctionnalité XML permet à l’analyseur XML d’étendre des entités de macro avec des valeurs définies dans le document lui-même ou à partir de sources externes.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-202">Although it is not widely used, there is a feature of XML that allows the XML parser to expand macro entities with values defined either within the document itself or from external sources.</span></span> <span data-ttu-id="4d2c2-203">Par exemple, le document peut définir une entité « nomentreprise » avec la valeur « Microsoft ». Ainsi, chaque fois que le texte « &companyname; » apparaît dans le document, il est automatiquement remplacé par le texte « Microsoft ».</span><span class="sxs-lookup"><span data-stu-id="4d2c2-203">For example, the document might define an entity "companyname" with the value "Microsoft," so that every time the text "&companyname;" appears in the document, it is automatically replaced with the text Microsoft.</span></span> <span data-ttu-id="4d2c2-204">Autre solution : le document peut définir une entité « StockMSFT » qui fait référence à un service web externe permettant d’extraire la valeur actuelle du stock Microsoft.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-204">Or, the document might define an entity "MSFTStock" that references an external web service to fetch the current value of Microsoft stock.</span></span></p><p><span data-ttu-id="4d2c2-205">Ainsi, à chaque fois que « &MSFTStock; » apparaît dans le document, il est automatiquement remplacé par le prix actuel du stock.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-205">Then any time "&MSFTStock;" appears in the document, it is automatically replaced with the current stock price.</span></span> <span data-ttu-id="4d2c2-206">Cependant, cette fonctionnalité peut être utilisée abusivement afin de générer un déni de service (DoS).</span><span class="sxs-lookup"><span data-stu-id="4d2c2-206">However, this functionality can be abused to create denial of service (DoS) conditions.</span></span> <span data-ttu-id="4d2c2-207">Une personne malveillante peut imbriquer plusieurs entités pour créer une bombe XML à extension exponentielle, qui consomme toute la mémoire disponible sur le système.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-207">An attacker can nest multiple entities to create an exponential expansion XML bomb that consumes all available memory on the system.</span></span> </p><p><span data-ttu-id="4d2c2-208">Elle peut également créer une référence externe qui diffuse en continu une quantité infinie de données ou bloque simplement le thread.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-208">Alternatively, he can create an external reference that streams back an infinite amount of data or that simply hangs the thread.</span></span> <span data-ttu-id="4d2c2-209">Par conséquent, toutes les équipes doivent entièrement désactiver la résolution d’entité XML interne et/ou externe si leur application ne l’utilise pas, ou limiter manuellement la quantité de mémoire et de temps que l’application peut utiliser pour la résolution d’entité si cette fonctionnalité est indispensable.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-209">As a result, all teams must disable internal and/or external XML entity resolution entirely if their application does not use it, or manually limit the amount of memory and time that the application can consume for entity resolution if this functionality is absolutely necessary.</span></span> <span data-ttu-id="4d2c2-210">Si la résolution d’entité n’est pas requise par votre application, désactivez-la.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-210">If entity resolution is not required by your application, then disable it.</span></span> </p>|

### <a name="example"></a><span data-ttu-id="4d2c2-211">Exemple</span><span class="sxs-lookup"><span data-stu-id="4d2c2-211">Example</span></span>
<span data-ttu-id="4d2c2-212">Pour le code .NET Framework, vous pouvez utiliser les méthodes suivantes :</span><span class="sxs-lookup"><span data-stu-id="4d2c2-212">For .NET Framework code, you can use the following approaches:</span></span>

```C#
XmlTextReader reader = new XmlTextReader(stream);
reader.ProhibitDtd = true;

XmlReaderSettings settings = new XmlReaderSettings();
settings.ProhibitDtd = true;
XmlReader reader = XmlReader.Create(stream, settings);

// for .NET 4
XmlReaderSettings settings = new XmlReaderSettings();
settings.DtdProcessing = DtdProcessing.Prohibit;
XmlReader reader = XmlReader.Create(stream, settings);
```
<span data-ttu-id="4d2c2-213">La valeur par défaut de `ProhibitDtd` dans `XmlReaderSettings` est true, mais elle est false dans `XmlTextReader`.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-213">Note that the default value of `ProhibitDtd` in `XmlReaderSettings` is true, but in `XmlTextReader` it is false.</span></span> <span data-ttu-id="4d2c2-214">Si vous utilisez XmlReaderSettings, vous n’êtes pas obligé de définir explicitement ProhibitDtd sur true, mais ce paramétrage est recommandé pour des raisons de sécurité.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-214">If you are using XmlReaderSettings, you do not need to set ProhibitDtd to true explicitly, but it is recommended for safety sake that you do.</span></span> <span data-ttu-id="4d2c2-215">La classe XmlDocument autorise également la résolution d’entité par défaut.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-215">Also note that the XmlDocument class allows entity resolution by default.</span></span> 

### <a name="example"></a><span data-ttu-id="4d2c2-216">Exemple</span><span class="sxs-lookup"><span data-stu-id="4d2c2-216">Example</span></span>
<span data-ttu-id="4d2c2-217">Pour désactiver la résolution d’entité relative à XmlDocument, utilisez la surcharge `XmlDocument.Load(XmlReader)` de la méthode Load et définissez les propriétés concernées dans l’argument XmlReader, comme illustré dans le code suivant :</span><span class="sxs-lookup"><span data-stu-id="4d2c2-217">To disable entity resolution for XmlDocuments, use the `XmlDocument.Load(XmlReader)` overload of the Load method and set the appropriate properties in the XmlReader argument to disable resolution, as illustrated in the following code:</span></span> 

```C#
XmlReaderSettings settings = new XmlReaderSettings();
settings.ProhibitDtd = true;
XmlReader reader = XmlReader.Create(stream, settings);
XmlDocument doc = new XmlDocument();
doc.Load(reader);
```

### <a name="example"></a><span data-ttu-id="4d2c2-218">Exemple</span><span class="sxs-lookup"><span data-stu-id="4d2c2-218">Example</span></span>
<span data-ttu-id="4d2c2-219">S’il est impossible de désactiver la résolution d’entité pour votre application, définissez la propriété XmlReaderSettings.MaxCharactersFromEntities sur une valeur raisonnable en fonction des besoins de votre application.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-219">If disabling entity resolution is not possible for your application, set the XmlReaderSettings.MaxCharactersFromEntities property to a reasonable value according to your application's needs.</span></span> <span data-ttu-id="4d2c2-220">Cela limitera l’impact des attaques DoS potentielles d’extension exponentielle.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-220">This will limit the impact of potential exponential expansion DoS attacks.</span></span> <span data-ttu-id="4d2c2-221">Le code suivant propose un exemple d’approche :</span><span class="sxs-lookup"><span data-stu-id="4d2c2-221">The following code provides an example of this approach:</span></span> 

```C#
XmlReaderSettings settings = new XmlReaderSettings();
settings.ProhibitDtd = false;
settings.MaxCharactersFromEntities = 1000;
XmlReader reader = XmlReader.Create(stream, settings);
```

### <a name="example"></a><span data-ttu-id="4d2c2-222">Exemple</span><span class="sxs-lookup"><span data-stu-id="4d2c2-222">Example</span></span>
<span data-ttu-id="4d2c2-223">Si vous devez résoudre les entités incorporées, mais pas les entités externes, définissez la propriété XmlReaderSettings.XmlResolver sur null.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-223">If you need to resolve inline entities but do not need to resolve external entities, set the XmlReaderSettings.XmlResolver property to null.</span></span> <span data-ttu-id="4d2c2-224">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="4d2c2-224">For example:</span></span> 

```C#
XmlReaderSettings settings = new XmlReaderSettings();
settings.ProhibitDtd = false;
settings.MaxCharactersFromEntities = 1000;
settings.XmlResolver = null;
XmlReader reader = XmlReader.Create(stream, settings);
```
<span data-ttu-id="4d2c2-225">Dans MSXML6, la valeur ProhibitDTD est définie sur true (ce qui désactive le traitement DTD) par défaut.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-225">Note that in MSXML6, ProhibitDTD is set to true (disabling DTD processing) by default.</span></span> <span data-ttu-id="4d2c2-226">Pour le code Apple OSX/iOS, vous pouvez utiliser deux analyseurs XML : NSXMLParser et libXML2.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-226">For Apple OSX/iOS code, there are two XML parsers you can use: NSXMLParser and libXML2.</span></span> 

## <span data-ttu-id="4d2c2-227"><a id="app-verification"></a>Les applications utilisant http.sys doivent procéder à la vérification de la canonisation des URL</span><span class="sxs-lookup"><span data-stu-id="4d2c2-227"><a id="app-verification"></a>Applications utilizing http.sys perform URL canonicalization verification</span></span>

| <span data-ttu-id="4d2c2-228">Intitulé</span><span class="sxs-lookup"><span data-stu-id="4d2c2-228">Title</span></span>                   | <span data-ttu-id="4d2c2-229">Détails</span><span class="sxs-lookup"><span data-stu-id="4d2c2-229">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="4d2c2-230">**Composant**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-230">**Component**</span></span>               | <span data-ttu-id="4d2c2-231">Application web</span><span class="sxs-lookup"><span data-stu-id="4d2c2-231">Web Application</span></span> | 
| <span data-ttu-id="4d2c2-232">**Phase SDL**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-232">**SDL Phase**</span></span>               | <span data-ttu-id="4d2c2-233">Créer</span><span class="sxs-lookup"><span data-stu-id="4d2c2-233">Build</span></span> |  
| <span data-ttu-id="4d2c2-234">**Technologies applicables**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-234">**Applicable Technologies**</span></span> | <span data-ttu-id="4d2c2-235">Générique</span><span class="sxs-lookup"><span data-stu-id="4d2c2-235">Generic</span></span> |
| <span data-ttu-id="4d2c2-236">**Attributs**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-236">**Attributes**</span></span>              | <span data-ttu-id="4d2c2-237">N/A</span><span class="sxs-lookup"><span data-stu-id="4d2c2-237">N/A</span></span>  |
| <span data-ttu-id="4d2c2-238">**Informations de référence**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-238">**References**</span></span>              | <span data-ttu-id="4d2c2-239">N/A</span><span class="sxs-lookup"><span data-stu-id="4d2c2-239">N/A</span></span>  |
| <span data-ttu-id="4d2c2-240">**Étapes**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-240">**Steps**</span></span> | <p><span data-ttu-id="4d2c2-241">Toutes les applications utilisant http.sys doivent suivre ces instructions :</span><span class="sxs-lookup"><span data-stu-id="4d2c2-241">Any application that uses http.sys should follow these guidelines:</span></span></p><ul><li><span data-ttu-id="4d2c2-242">Limitez la longueur de l’URL à 16 384 caractères maximum (Unicode ou ASCII).</span><span class="sxs-lookup"><span data-stu-id="4d2c2-242">Limit the URL length to no more than 16,384 characters (ASCII or Unicode).</span></span> <span data-ttu-id="4d2c2-243">Il s’agit de la longueur URL maximale absolue selon le paramètre Internet Information Services (IIS) 6 par défaut.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-243">This is the absolute maximum URL length based on the default Internet Information Services (IIS) 6 setting.</span></span> <span data-ttu-id="4d2c2-244">Les sites web doivent, dans la mesure du possible, proposer une longueur inférieure</span><span class="sxs-lookup"><span data-stu-id="4d2c2-244">Websites should strive for a length shorter than this if possible</span></span></li><li><span data-ttu-id="4d2c2-245">Utilisez les classes d’E/S de fichier .NET Framework standard (par exemple, FileStream) qui se serviront des règles de canonisation dans .NET FX</span><span class="sxs-lookup"><span data-stu-id="4d2c2-245">Use the standard .NET Framework file I/O classes (such as FileStream) as these will take advantage of the canonicalization rules in the .NET FX</span></span></li><li><span data-ttu-id="4d2c2-246">Créez explicitement une liste verte des noms de fichiers connus</span><span class="sxs-lookup"><span data-stu-id="4d2c2-246">Explicitly build an allow-list of known filenames</span></span></li><li><span data-ttu-id="4d2c2-247">Refusez explicitement les types de fichiers connus qui ne vous serviront pas et qu’UrlScan refuse : exe, bat, cmd, com, htw, ida, idq, htr, idc, shtm[l], stm, printer, ini, pol et dat</span><span class="sxs-lookup"><span data-stu-id="4d2c2-247">Explicitly reject known filetypes you will not serve UrlScan rejects: exe, bat, cmd, com, htw, ida, idq, htr, idc, shtm[l], stm, printer, ini, pol, dat files</span></span></li><li><span data-ttu-id="4d2c2-248">Interceptez les exceptions suivantes :</span><span class="sxs-lookup"><span data-stu-id="4d2c2-248">Catch the following exceptions:</span></span><ul><li><span data-ttu-id="4d2c2-249">System.ArgumentException (pour les noms d’appareils)</span><span class="sxs-lookup"><span data-stu-id="4d2c2-249">System.ArgumentException (for device names)</span></span></li><li><span data-ttu-id="4d2c2-250">System.NotSupportedException (pour les flux de données)</span><span class="sxs-lookup"><span data-stu-id="4d2c2-250">System.NotSupportedException (for data streams)</span></span></li><li><span data-ttu-id="4d2c2-251">System.IO.FileNotFoundException (pour les noms de fichiers avec séquence d’échappement non valide)</span><span class="sxs-lookup"><span data-stu-id="4d2c2-251">System.IO.FileNotFoundException (for invalid escaped filenames)</span></span></li><li><span data-ttu-id="4d2c2-252">System.IO.FileNotFoundException (pour les noms de répertoires avec séquence d’échappement non valide)</span><span class="sxs-lookup"><span data-stu-id="4d2c2-252">System.IO.DirectoryNotFoundException (for invalid escaped dirs)</span></span></li></ul></li><li><span data-ttu-id="4d2c2-253">*N’appelez pas* d’API E/S de fichier Win32.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-253">*Do not* call out to Win32 file I/O APIs.</span></span> <span data-ttu-id="4d2c2-254">Sur une URL non valide, renvoyez de manière appropriée une erreur 400 vers l’utilisateur et enregistrez l’erreur réelle.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-254">On an invalid URL gracefully return a 400 error to the user, and log the real error.</span></span></li></ul>|

## <span data-ttu-id="4d2c2-255"><a id="controls-users"></a>S’assurer que les contrôles appropriés sont en place lors de l’acceptation de fichiers provenant d’utilisateurs</span><span class="sxs-lookup"><span data-stu-id="4d2c2-255"><a id="controls-users"></a>Ensure appropriate controls are in place when accepting files from users</span></span>

| <span data-ttu-id="4d2c2-256">Intitulé</span><span class="sxs-lookup"><span data-stu-id="4d2c2-256">Title</span></span>                   | <span data-ttu-id="4d2c2-257">Détails</span><span class="sxs-lookup"><span data-stu-id="4d2c2-257">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="4d2c2-258">**Composant**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-258">**Component**</span></span>               | <span data-ttu-id="4d2c2-259">Application web</span><span class="sxs-lookup"><span data-stu-id="4d2c2-259">Web Application</span></span> | 
| <span data-ttu-id="4d2c2-260">**Phase SDL**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-260">**SDL Phase**</span></span>               | <span data-ttu-id="4d2c2-261">Créer</span><span class="sxs-lookup"><span data-stu-id="4d2c2-261">Build</span></span> |  
| <span data-ttu-id="4d2c2-262">**Technologies applicables**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-262">**Applicable Technologies**</span></span> | <span data-ttu-id="4d2c2-263">Générique</span><span class="sxs-lookup"><span data-stu-id="4d2c2-263">Generic</span></span> |
| <span data-ttu-id="4d2c2-264">**Attributs**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-264">**Attributes**</span></span>              | <span data-ttu-id="4d2c2-265">N/A</span><span class="sxs-lookup"><span data-stu-id="4d2c2-265">N/A</span></span>  |
| <span data-ttu-id="4d2c2-266">**Informations de référence**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-266">**References**</span></span>              | <span data-ttu-id="4d2c2-267">[Unrestricted File Upload (Chargement de fichiers sans restriction)](https://www.owasp.org/index.php/Unrestricted_File_Upload), [File Signature Table (Table de signatures de fichier)](http://www.garykessler.net/library/file_sigs.html)</span><span class="sxs-lookup"><span data-stu-id="4d2c2-267">[Unrestricted File Upload](https://www.owasp.org/index.php/Unrestricted_File_Upload), [File Signature Table](http://www.garykessler.net/library/file_sigs.html)</span></span> |
| <span data-ttu-id="4d2c2-268">**Étapes**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-268">**Steps**</span></span> | <p><span data-ttu-id="4d2c2-269">Les fichiers téléchargés constituent un risque significatif pour les applications.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-269">Uploaded files represent a significant risk to applications.</span></span></p><p><span data-ttu-id="4d2c2-270">La première étape de nombreuses attaques consiste à obtenir un code permettant d’attaquer le système.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-270">The first step in many attacks is to get some code to the system to be attacked.</span></span> <span data-ttu-id="4d2c2-271">Il suffit ensuite que l’attaque trouve un moyen d’exécuter le code.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-271">Then the attack only needs to find a way to get the code executed.</span></span> <span data-ttu-id="4d2c2-272">Un téléchargement de fichier permet aux personnes malveillantes d’accomplir la première étape.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-272">Using a file upload helps the attacker accomplish the first step.</span></span> <span data-ttu-id="4d2c2-273">Les conséquences d’un téléchargement de fichier sans restriction peuvent varier, de la prise de contrôle totale du système à la surcharge d’un système de fichiers ou d’une base de données, en passant par le transfert d’attaques vers les systèmes back-end ou la simple dégradation.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-273">The consequences of unrestricted file upload can vary, including complete system takeover, an overloaded file system or database, forwarding attacks to back-end systems, and simple defacement.</span></span></p><p><span data-ttu-id="4d2c2-274">Tout dépend de ce que l’application fait du fichier téléchargé, et surtout de l’emplacement de stockage du fichier.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-274">It depends on what the application does with the uploaded file and especially where it is stored.</span></span> <span data-ttu-id="4d2c2-275">Il manque la validation des téléchargements de fichiers côté serveur.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-275">Server side validation of file uploads is missing.</span></span> <span data-ttu-id="4d2c2-276">Le suivi des contrôles de sécurité doit être implémenté pour la fonctionnalité de téléchargement de fichiers :</span><span class="sxs-lookup"><span data-stu-id="4d2c2-276">Following security controls should be implemented for File Upload functionality:</span></span></p><ul><li><span data-ttu-id="4d2c2-277">Vérification de l’extension du fichier (seul un ensemble valide de types de fichiers autorisés doit être accepté)</span><span class="sxs-lookup"><span data-stu-id="4d2c2-277">File Extension check (only a valid set of allowed file type should be accepted)</span></span></li><li><span data-ttu-id="4d2c2-278">Taille maximale du fichier</span><span class="sxs-lookup"><span data-stu-id="4d2c2-278">Maximum file size limit</span></span></li><li><span data-ttu-id="4d2c2-279">Le fichier ne doit pas être téléchargé sur webroot : l’emplacement choisi doit être un répertoire présent sur un lecteur autre que le lecteur système</span><span class="sxs-lookup"><span data-stu-id="4d2c2-279">File should not be uploaded to webroot; the location should be a directory on non-system drive</span></span></li><li><span data-ttu-id="4d2c2-280">La convention d’affectation de noms doit être suivie : par exemple, le nom du fichier téléchargé doit avoir un caractère aléatoire afin d’éviter l’écrasement du fichier</span><span class="sxs-lookup"><span data-stu-id="4d2c2-280">Naming convention should be followed, such that the uploaded file name have some randomness, so as to prevent file overwrites</span></span></li><li><span data-ttu-id="4d2c2-281">Les fichiers doivent être analysés par un antivirus avant d’être écrits sur le disque</span><span class="sxs-lookup"><span data-stu-id="4d2c2-281">Files should be scanned for anti-virus before writing to the disk</span></span></li><li><span data-ttu-id="4d2c2-282">Assurez-vous que le nom de fichier et toute autre métadonnée (par exemple, chemin d’accès) ne comporte pas de caractère nuisible</span><span class="sxs-lookup"><span data-stu-id="4d2c2-282">Ensure that the file name and any other metadata (e.g., file path) are validated for malicious characters</span></span></li><li><span data-ttu-id="4d2c2-283">La signature de format de fichier doit être vérifiée afin que les utilisateurs ne puissent pas télécharger de fichier déguisé (par exemple, téléchargement d’un fichier exe en remplaçant l’extension par .txt)</span><span class="sxs-lookup"><span data-stu-id="4d2c2-283">File format signature should be checked, to prevent a user from uploading a masqueraded file (e.g., uploading an exe file by changing extension to txt)</span></span></li></ul>| 

### <a name="example"></a><span data-ttu-id="4d2c2-284">Exemple</span><span class="sxs-lookup"><span data-stu-id="4d2c2-284">Example</span></span>
<span data-ttu-id="4d2c2-285">Concernant la validation de la signature de format de fichier, reportez-vous à la classe ci-dessous pour plus d’informations :</span><span class="sxs-lookup"><span data-stu-id="4d2c2-285">For the last point regarding file format signature validation, refer to the class below for details:</span></span> 

```C#
        private static Dictionary<string, List<byte[]>> fileSignature = new Dictionary<string, List<byte[]>>
                    {
                    { ".DOC", new List<byte[]> { new byte[] { 0xD0, 0xCF, 0x11, 0xE0, 0xA1, 0xB1, 0x1A, 0xE1 } } },
                    { ".DOCX", new List<byte[]> { new byte[] { 0x50, 0x4B, 0x03, 0x04 } } },
                    { ".PDF", new List<byte[]> { new byte[] { 0x25, 0x50, 0x44, 0x46 } } },
                    { ".ZIP", new List<byte[]> 
                                            {
                                              new byte[] { 0x50, 0x4B, 0x03, 0x04 },
                                              new byte[] { 0x50, 0x4B, 0x4C, 0x49, 0x54, 0x55 },
                                              new byte[] { 0x50, 0x4B, 0x53, 0x70, 0x58 },
                                              new byte[] { 0x50, 0x4B, 0x05, 0x06 },
                                              new byte[] { 0x50, 0x4B, 0x07, 0x08 },
                                              new byte[] { 0x57, 0x69, 0x6E, 0x5A, 0x69, 0x70 }
                                                }
                                            },
                    { ".PNG", new List<byte[]> { new byte[] { 0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A } } },
                    { ".JPG", new List<byte[]>
                                    {
                                              new byte[] { 0xFF, 0xD8, 0xFF, 0xE0 },
                                              new byte[] { 0xFF, 0xD8, 0xFF, 0xE1 },
                                              new byte[] { 0xFF, 0xD8, 0xFF, 0xE8 }
                                    }
                                    },
                    { ".JPEG", new List<byte[]>
                                        { 
                                            new byte[] { 0xFF, 0xD8, 0xFF, 0xE0 },
                                            new byte[] { 0xFF, 0xD8, 0xFF, 0xE2 },
                                            new byte[] { 0xFF, 0xD8, 0xFF, 0xE3 }
                                        }
                                        },
                    { ".XLS", new List<byte[]>
                                            {
                                              new byte[] { 0xD0, 0xCF, 0x11, 0xE0, 0xA1, 0xB1, 0x1A, 0xE1 },
                                              new byte[] { 0x09, 0x08, 0x10, 0x00, 0x00, 0x06, 0x05, 0x00 },
                                              new byte[] { 0xFD, 0xFF, 0xFF, 0xFF }
                                            }
                                            },
                    { ".XLSX", new List<byte[]> { new byte[] { 0x50, 0x4B, 0x03, 0x04 } } },
                    { ".GIF", new List<byte[]> { new byte[] { 0x47, 0x49, 0x46, 0x38 } } }
                };

        public static bool IsValidFileExtension(string fileName, byte[] fileData, byte[] allowedChars)
        {
            if (string.IsNullOrEmpty(fileName) || fileData == null || fileData.Length == 0)
            {
                return false;
            }

            bool flag = false;
            string ext = Path.GetExtension(fileName);
            if (string.IsNullOrEmpty(ext))
            {
                return false;
            }

            ext = ext.ToUpperInvariant();

            if (ext.Equals(".TXT") || ext.Equals(".CSV") || ext.Equals(".PRN"))
            {
                foreach (byte b in fileData)
                {
                    if (b > 0x7F)
                    {
                        if (allowedChars != null)
                        {
                            if (!allowedChars.Contains(b))
                            {
                                return false;
                            }
                        }
                        else
                        {
                            return false;
                        }
                    }
                }

                return true;
            }

            if (!fileSignature.ContainsKey(ext))
            {
                return true;
            }

            List<byte[]> sig = fileSignature[ext];
            foreach (byte[] b in sig)
            {
                var curFileSig = new byte[b.Length];
                Array.Copy(fileData, curFileSig, b.Length);
                if (curFileSig.SequenceEqual(b))
                {
                    flag = true;
                    break;
                }
            }

            return flag;
        }
```

## <span data-ttu-id="4d2c2-286"><a id="typesafe"></a>S’assurer que des paramètres de type sécurisé sont utilisés dans une application web pour l’accès aux données</span><span class="sxs-lookup"><span data-stu-id="4d2c2-286"><a id="typesafe"></a>Ensure that type-safe parameters are used in Web Application for data access</span></span>

| <span data-ttu-id="4d2c2-287">Intitulé</span><span class="sxs-lookup"><span data-stu-id="4d2c2-287">Title</span></span>                   | <span data-ttu-id="4d2c2-288">Détails</span><span class="sxs-lookup"><span data-stu-id="4d2c2-288">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="4d2c2-289">**Composant**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-289">**Component**</span></span>               | <span data-ttu-id="4d2c2-290">Application web</span><span class="sxs-lookup"><span data-stu-id="4d2c2-290">Web Application</span></span> | 
| <span data-ttu-id="4d2c2-291">**Phase SDL**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-291">**SDL Phase**</span></span>               | <span data-ttu-id="4d2c2-292">Créer</span><span class="sxs-lookup"><span data-stu-id="4d2c2-292">Build</span></span> |  
| <span data-ttu-id="4d2c2-293">**Technologies applicables**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-293">**Applicable Technologies**</span></span> | <span data-ttu-id="4d2c2-294">Générique</span><span class="sxs-lookup"><span data-stu-id="4d2c2-294">Generic</span></span> |
| <span data-ttu-id="4d2c2-295">**Attributs**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-295">**Attributes**</span></span>              | <span data-ttu-id="4d2c2-296">N/A</span><span class="sxs-lookup"><span data-stu-id="4d2c2-296">N/A</span></span>  |
| <span data-ttu-id="4d2c2-297">**Informations de référence**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-297">**References**</span></span>              | <span data-ttu-id="4d2c2-298">N/A</span><span class="sxs-lookup"><span data-stu-id="4d2c2-298">N/A</span></span>  |
| <span data-ttu-id="4d2c2-299">**Étapes**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-299">**Steps**</span></span> | <p><span data-ttu-id="4d2c2-300">Si vous utilisez la collection Parameters, SQL traite l’entrée comme une valeur littérale et non comme du code exécutable.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-300">If you use the Parameters collection, SQL treats the input is as a literal value rather then as executable code.</span></span> <span data-ttu-id="4d2c2-301">La collection Parameters peut être utilisée pour appliquer des contraintes de type et de longueur sur les données d’entrée.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-301">The Parameters collection can be used to enforce type and length constraints on input data.</span></span> <span data-ttu-id="4d2c2-302">Les valeurs situées en dehors de la plage déclenchent une exception.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-302">Values outside of the range trigger an exception.</span></span> <span data-ttu-id="4d2c2-303">En l’absence de paramètres SQL de type sécurisé, des personnes malveillantes peuvent exécuter des attaques par injection, incorporées dans les entrées non filtrées.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-303">If type-safe SQL parameters are not used, attackers might be able to execute injection attacks that are embedded in the unfiltered input.</span></span></p><p><span data-ttu-id="4d2c2-304">Utilisez des paramètres de type sécurisé lors de la création de requêtes SQL afin d’éviter des attaques par injection de code SQL susceptibles de se produire avec des entrées non filtrées.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-304">Use type safe parameters when constructing SQL queries to avoid possible SQL injection attacks that can occur with unfiltered input.</span></span> <span data-ttu-id="4d2c2-305">Vous pouvez utiliser des paramètres de type sécurisé avec des procédures stockées et des instructions SQL dynamiques.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-305">You can use type safe parameters with stored procedures and with dynamic SQL statements.</span></span> <span data-ttu-id="4d2c2-306">Les paramètres sont traités comme des valeurs littérales par la base de données, et non comme du code exécutable.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-306">Parameters are treated as literal values by the database and not as executable code.</span></span> <span data-ttu-id="4d2c2-307">Le type et la longueur sont également vérifiés pour les paramètres.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-307">Parameters are also checked for type and length.</span></span></p>|

### <a name="example"></a><span data-ttu-id="4d2c2-308">Exemple</span><span class="sxs-lookup"><span data-stu-id="4d2c2-308">Example</span></span> 
<span data-ttu-id="4d2c2-309">Le code suivant montre comment utiliser les paramètres de type sécurisé avec SqlParameterCollection lors de l’appel d’une procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-309">The following code shows how to use type safe parameters with the SqlParameterCollection when calling a stored procedure.</span></span> 

```C#
using System.Data;
using System.Data.SqlClient;

using (SqlConnection connection = new SqlConnection(connectionString))
{ 
DataSet userDataset = new DataSet(); 
SqlDataAdapter myCommand = new SqlDataAdapter(LoginStoredProcedure", connection); 
myCommand.SelectCommand.CommandType = CommandType.StoredProcedure; 
myCommand.SelectCommand.Parameters.Add("@au_id", SqlDbType.VarChar, 11); 
myCommand.SelectCommand.Parameters["@au_id"].Value = SSN.Text; 
myCommand.Fill(userDataset);
}  
```
<span data-ttu-id="4d2c2-310">Dans l’exemple de code précédent, la valeur d’entrée ne peut pas être supérieure à 11 caractères.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-310">In the preceding code example, the input value cannot be longer than 11 characters.</span></span> <span data-ttu-id="4d2c2-311">Si les données ne sont pas conformes au type ou à la longueur définis par le paramètre, la classe SqlParameter renvoie une exception.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-311">If the data does not conform to the type or length defined by the parameter, the SqlParameter class throws an exception.</span></span> 

## <span data-ttu-id="4d2c2-312"><a id="binding-mvc"></a>Utiliser des classes de liaison de modèle ou des listes de filtre de liaison distinctes pour empêcher une vulnérabilité d’attribution collective MVC</span><span class="sxs-lookup"><span data-stu-id="4d2c2-312"><a id="binding-mvc"></a>Use separate model binding classes or binding filter lists to prevent MVC mass assignment vulnerability</span></span>

| <span data-ttu-id="4d2c2-313">Intitulé</span><span class="sxs-lookup"><span data-stu-id="4d2c2-313">Title</span></span>                   | <span data-ttu-id="4d2c2-314">Détails</span><span class="sxs-lookup"><span data-stu-id="4d2c2-314">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="4d2c2-315">**Composant**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-315">**Component**</span></span>               | <span data-ttu-id="4d2c2-316">Application web</span><span class="sxs-lookup"><span data-stu-id="4d2c2-316">Web Application</span></span> | 
| <span data-ttu-id="4d2c2-317">**Phase SDL**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-317">**SDL Phase**</span></span>               | <span data-ttu-id="4d2c2-318">Créer</span><span class="sxs-lookup"><span data-stu-id="4d2c2-318">Build</span></span> |  
| <span data-ttu-id="4d2c2-319">**Technologies applicables**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-319">**Applicable Technologies**</span></span> | <span data-ttu-id="4d2c2-320">MVC5, MVC6</span><span class="sxs-lookup"><span data-stu-id="4d2c2-320">MVC5, MVC6</span></span> |
| <span data-ttu-id="4d2c2-321">**Attributs**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-321">**Attributes**</span></span>              | <span data-ttu-id="4d2c2-322">N/A</span><span class="sxs-lookup"><span data-stu-id="4d2c2-322">N/A</span></span>  |
| <span data-ttu-id="4d2c2-323">**Informations de référence**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-323">**References**</span></span>              | <span data-ttu-id="4d2c2-324">[Metadata Attributes (Classe MetadataTypeAttribute)](http://msdn.microsoft.com/library/system.componentmodel.dataannotations.metadatatypeattribute), [Public Key Security Vulnerability And Mitigation (Failles de sécurité des clés publiques et mesures de correction)](https://github.com/blog/1068-public-key-security-vulnerability-and-mitigation), [Complete Guide to Mass Assignment in ASP.NET MVC (Guide complet d’attribution collective dans ASP.NET MVC)](http://odetocode.com/Blogs/scott/archive/2012/03/11/complete-guide-to-mass-assignment-in-asp-net-mvc.aspx), [Getting Started with EF using MVC (Prise en main d’EF à l’aide de MVC)](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-basic-crud-functionality-with-the-entity-framework-in-asp-net-mvc-application#overpost)</span><span class="sxs-lookup"><span data-stu-id="4d2c2-324">[Metadata Attributes](http://msdn.microsoft.com/library/system.componentmodel.dataannotations.metadatatypeattribute), [Public Key Security Vulnerability And Mitigation](https://github.com/blog/1068-public-key-security-vulnerability-and-mitigation), [Complete Guide to Mass Assignment in ASP.NET MVC](http://odetocode.com/Blogs/scott/archive/2012/03/11/complete-guide-to-mass-assignment-in-asp-net-mvc.aspx), [Getting Started with EF using MVC](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-basic-crud-functionality-with-the-entity-framework-in-asp-net-mvc-application#overpost)</span></span> |
| <span data-ttu-id="4d2c2-325">**Étapes**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-325">**Steps**</span></span> | <ul><li><span data-ttu-id="4d2c2-326">**Quand dois-je rechercher les vulnérabilités de survalidation ? -** Les vulnérabilités de survalidation peuvent se produire partout où vous liez des classes de modèle à partir d’entrées utilisateur.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-326">**When should I look for over-posting vulnerabilities? -** Over-posting vulnerabilities can occur any place you bind model classes from user input.</span></span> <span data-ttu-id="4d2c2-327">Les infrastructures telles que MVC peuvent représenter des données utilisateur dans des classes .NET personnalisées, y compris les objets CLR traditionnels (OCT).</span><span class="sxs-lookup"><span data-stu-id="4d2c2-327">Frameworks like MVC can represent user data in custom .NET classes, including Plain Old CLR Objects (POCOs).</span></span> <span data-ttu-id="4d2c2-328">MVC renseigne automatiquement ces classes de modèle avec des données à partir de la requête, ce qui offre une représentation pratique pour la gestion des entrées utilisateur.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-328">MVC automatically populates these model classes with data from the request, providing a convenient representation for dealing with user input.</span></span> <span data-ttu-id="4d2c2-329">Lorsque ces classes incluent des propriétés qui ne doivent pas être définies par l’utilisateur, l’application peut être vulnérable aux attaques de survalidation, qui permettent un contrôle des données utilisateur que l’application n’avait pas prévu.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-329">When these classes include properties that should not be set by the user, the application can be vulnerable to over-posting attacks, which allow user control of data that the application never intended.</span></span> <span data-ttu-id="4d2c2-330">Tout comme la liaison de modèle MVC, les technologies d’accès aux bases de données, telles que les mappeurs d’objets/relationnels du type Entity Framework, prennent aussi souvent en charge l’utilisation d’objets OCT pour représenter les données de la base de données.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-330">Like MVC model binding, database access technologies such as object/relational mappers like Entity Framework often also support using POCO objects to represent database data.</span></span> <span data-ttu-id="4d2c2-331">Ces classes de modèle de données fournissent la même fonctionnalité dans le traitement des données de base de données que MVC dans le traitement des entrées utilisateur.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-331">These data model classes provide the same convenience in dealing with database data as MVC does in dealing with user input.</span></span> <span data-ttu-id="4d2c2-332">Étant donné que MVC et la base de données prennent en charge des modèles similaires, comme les objets OCT, il semble assez facile de réutiliser les mêmes classes pour les deux fonctions.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-332">Because both MVC and the database support similar models, like POCO objects, it seems easy to reuse the same classes for both purposes.</span></span> <span data-ttu-id="4d2c2-333">Cette pratique ne parvient pas à préserver la séparation des intérêts. Il s’agit d’une zone commune où des propriétés inattendues sont exposées à la liaison de modèle, ce qui offre une vulnérabilité aux attaques de survalidation.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-333">This practice fails to preserve separation of concerns, and it is one common area where unintended properties are exposed to model binding, enabling over-posting attacks.</span></span></li><li><span data-ttu-id="4d2c2-334">**Pourquoi ne puis-je pas utiliser mes classes de modèle de base de données non filtrées en tant que paramètres pour mes actions MVC ? -** Parce que la liaison de modèle MVC établit une liaison avec tout ce qui se trouve dans cette classe.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-334">**Why shouldn't I use my unfiltered database model classes as parameters to my MVC actions? -** Because MVC model binding will bind anything in that class.</span></span> <span data-ttu-id="4d2c2-335">Même si vous ne voyez pas les données, un utilisateur malveillant peut envoyer une requête HTTP incluant ces données, et MVC établira une liaison, car votre action indique que la classe de base de données est conforme à la forme des données acceptable pour les entrées utilisateur.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-335">Even if the data does not appear in your view, a malicious user can send an HTTP request with this data included, and MVC will gladly bind it because your action says that database class is the shape of data it should accept for user input.</span></span></li><li><span data-ttu-id="4d2c2-336">**Pourquoi dois-je faire attention à la forme utilisée pour la liaison de modèle ? -** L’utilisation d’une liaison de modèle ASP.NET MVC avec des modèles trop étendus expose une application aux attaques de survalidation.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-336">**Why should I care about the shape used for model binding? -** Using ASP.NET MVC model binding with overly broad models exposes an application to over-posting attacks.</span></span> <span data-ttu-id="4d2c2-337">La survalidation permet aux personnes malveillantes de modifier les données d’application au-delà de ce que le développeur escomptait, comme le remplacement du prix d’un article ou les privilèges de sécurité d’un compte.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-337">Over-posting could enable attackers to change application data beyond what the developer intended, such as overriding the price for an item or the security privileges for an account.</span></span> <span data-ttu-id="4d2c2-338">Les applications doivent utiliser des modèles de liaison spécifiques en fonction des actions (ou des listes de filtres de propriétés autorisés) afin d’indiquer explicitement les entrées non approuvées qui sont autorisées par le biais de la liaison de modèle.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-338">Applications should use action-specific binding models (or specific allowed property filter lists) to provide an explicit contract for what untrusted input to allow via model binding.</span></span></li><li><span data-ttu-id="4d2c2-339">**Le fait de disposer de modèles de liaison distincts équivaut-il simplement à une duplication de code ? -** Non, c’est une question de séparation des intérêts.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-339">**Is having separate binding models just duplicating code? -** No, it is a matter of separation of concerns.</span></span> <span data-ttu-id="4d2c2-340">Si vous réutilisez un modèle de base de données dans les méthodes d’action, vous indiquez que toute propriété (ou sous-propriété) de cette classe peut être définie par l’utilisateur dans une requête HTTP.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-340">If you reuse database models in action methods, you are saying any property (or sub-property) in that class can be set by the user in an HTTP request.</span></span> <span data-ttu-id="4d2c2-341">Si ce n’est pas ce que vous voulez, vous avez besoin d’une liste de filtrage ou d’une forme de classe distincte afin d’indiquer à MVC les données pouvant provenir d’entrées utilisateur.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-341">If that is not what you want MVC to do, you need a filter list or a separate class shape to show MVC what data can come from user input instead.</span></span></li><li><span data-ttu-id="4d2c2-342">**Si j’utilise des modèles de liaison distincts pour les entrées utilisateur, dois-je dupliquer tous les attributs d’annotation de mes données ? -** Pas forcément.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-342">**If I have separate binding models for user input, do I have to duplicate all my data annotation attributes? -** Not necessarily.</span></span> <span data-ttu-id="4d2c2-343">Vous pouvez utiliser MetadataTypeAttribute sur la classe de modèle de base de données afin d’établir un lien vers les métadonnées sur une classe de liaison de modèle.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-343">You can use MetadataTypeAttribute on the database model class to link to the metadata on a model binding class.</span></span> <span data-ttu-id="4d2c2-344">Mais n’oubliez pas que le type référencé par MetadataTypeAttribute doit être un sous-ensemble du type de référencement (il peut comporter moins de propriétés, mais pas plus).</span><span class="sxs-lookup"><span data-stu-id="4d2c2-344">Just note that the type referenced by the MetadataTypeAttribute must be a subset of the referencing type (it can have fewer properties, but not more).</span></span></li><li><span data-ttu-id="4d2c2-345">**Le déplacement des données entre les modèles d’entrée utilisateur et les modèles de base de données s’avère fastidieux. Puis-je simplement copier toutes les propriétés par réflexion ? -** Oui.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-345">**Moving data back and forth between user input models and database models is tedious. Can I just copy over all properties using reflection? -** Yes.</span></span> <span data-ttu-id="4d2c2-346">Les seules propriétés apparaissant dans les modèles de liaison sont celles que vous avez déterminées comme étant sécurisées pour les entrées utilisateur.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-346">The only properties that appear in the binding models are the ones you have determined to be safe for user input.</span></span> <span data-ttu-id="4d2c2-347">Il n’existe aucune raison de sécurité qui empêche l’utilisation de la réflexion pour copier toutes les propriétés communes aux deux modèles.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-347">There is no security reason that prevents using reflection to copy over all properties that exist in common between these two models.</span></span></li><li><span data-ttu-id="4d2c2-348">**Qu’en est-il de [Bind(Exclude ="â€¦")] ? Puis-je l’utiliser à la place de modèles de liaison distincts ? -** Cette approche n’est pas recommandée.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-348">**What about [Bind(Exclude ="â€¦")]. Can I use that instead of having separate binding models? -** This approach is not recommended.</span></span> <span data-ttu-id="4d2c2-349">L’utilisation de [Bind(Exclude ="â€¦")] indique que toute nouvelle propriété peut être liée par défaut.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-349">Using [Bind(Exclude ="â€¦")] means that any new property is bindable by default.</span></span> <span data-ttu-id="4d2c2-350">Lorsqu’une nouvelle propriété est ajoutée, une étape supplémentaire permet de rappeler les principes de base de sécurité, au lieu de présenter une conception sécurisée par défaut.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-350">When a new property is added, there is an extra step to remember to keep things secure, rather than having the design be secure by default.</span></span> <span data-ttu-id="4d2c2-351">Il est risqué de s’appuyer sur le fait que le développeur vérifie cette liste à chaque ajout de propriété.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-351">Depending on the developer checking this list every time a property is added is risky.</span></span></li><li><span data-ttu-id="4d2c2-352">**[Bind(Include ="â€¦")] est-il utile pour les opérations de modification ? -** Non.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-352">**Is [Bind(Include ="â€¦")] useful for Edit operations? -** No.</span></span> <span data-ttu-id="4d2c2-353">[Bind(Include ="â€¦")] convient uniquement aux opérations de style INSERT (ajout de nouvelles données).</span><span class="sxs-lookup"><span data-stu-id="4d2c2-353">[Bind(Include ="â€¦")] is only suitable for INSERT-style operations (adding new data).</span></span> <span data-ttu-id="4d2c2-354">Pour les opérations de style UPDATE (vérification des données existantes), utilisez une autre approche, comme les modèles de liaison séparés ou la transmission d’une liste explicite de propriétés autorisées à UpdateModel ou TryUpdateModel.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-354">For UPDATE-style operations (revising existing data), use another approach, like having separate binding models or passing an explicit list of allowed properties to UpdateModel or TryUpdateModel.</span></span> <span data-ttu-id="4d2c2-355">L’ajout d’un attribut [Bind(Include ="â€¦")] sur une opération de modification signifie que MVC crée une instance d’objet et définit uniquement les propriétés répertoriées, en laissant toutes les autres valeurs par défaut.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-355">Adding a [Bind(Include ="â€¦")] attribute on an Edit operation means that MVC will create an object instance and set only the listed properties, leaving all others at their default values.</span></span> <span data-ttu-id="4d2c2-356">Lorsque les données sont conservées, l’entité existante est entièrement remplacée, ce qui réinitialise les valeurs par défaut de toutes les propriétés omises.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-356">When the data is persisted, it will entirely replace the existing entity, resetting the values for any omitted properties to their defaults.</span></span> <span data-ttu-id="4d2c2-357">Par exemple, si IsAdmin a été omise dans un attribut [Bind(Include ="â€¦")] lors d’une opération de modification, tout utilisateur dont le nom a été modifié par le biais de cette action est réinitialisé comme suit : IsAdmin = false (tout utilisateur modifié perd le statut d’administrateur).</span><span class="sxs-lookup"><span data-stu-id="4d2c2-357">For example, if IsAdmin was omitted from a [Bind(Include ="â€¦")] attribute on an Edit operation, any user whose name was edited via this action would be reset to IsAdmin = false (any edited user would lose administrator status).</span></span> <span data-ttu-id="4d2c2-358">Pour empêcher la mise à jour de certaines propriétés, utilisez l’une des autres approches ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-358">If you want to prevent updates to certain properties, use one of the other approaches above.</span></span> <span data-ttu-id="4d2c2-359">Certaines versions des outils MVC génèrent des classes de contrôleur avec [Bind(Include ="â€¦")] sur les actions de modification et impliquent que la suppression d’une propriété de cette liste empêche les attaques par survalidation.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-359">Note that some versions of MVC tooling generate controller classes with [Bind(Include ="â€¦")] on Edit actions and imply that removing a property from that list will prevent over-posting attacks.</span></span> <span data-ttu-id="4d2c2-360">Toutefois, comme décrit ci-dessus, cette approche ne fonctionne pas comme prévu et réinitialise toutes les valeurs par défaut des propriétés omises.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-360">However, as described above, that approach does not work as intended and instead will reset any data in the omitted properties to their default values.</span></span></li><li><span data-ttu-id="4d2c2-361">**Pour les opérations de création, des mises en garde utilisent-elles [Bind(Include ="â€¦")] au lieu de modèles de liaison distincts ? -** Oui.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-361">**For Create operations, are there any caveats using [Bind(Include ="â€¦")] rather than separate binding models? -** Yes.</span></span> <span data-ttu-id="4d2c2-362">Tout d’abord, cette approche ne fonctionne pas pour les scénarios de modification, qui nécessitent le maintien de deux approches distinctes afin de limiter toutes les vulnérabilités de survalidation.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-362">First this approach does not work for Edit scenarios, requiring maintaining two separate approaches for mitigating all over-posting vulnerabilities.</span></span> <span data-ttu-id="4d2c2-363">Deuxièmement, les modèles de liaison distincts appliquent la séparation des intérêts entre la forme utilisée pour les entrées utilisateur et la forme utilisée pour la persistance, ce que ne fait pas [Bind(Include ="â€¦")].</span><span class="sxs-lookup"><span data-stu-id="4d2c2-363">Second, separate binding models enforce separation of concerns between the shape used for user input and the shape used for persistence, something [Bind(Include ="â€¦")] does not do.</span></span> <span data-ttu-id="4d2c2-364">Troisièmement, [Bind(Include ="â€¦")] peut uniquement gérer les propriétés de niveau supérieur. Vous ne pouvez pas autoriser uniquement des portions de sous-propriétés (par exemple, « Details.Name ») dans l’attribut.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-364">Third, note that [Bind(Include ="â€¦")] can only handle top-level properties; you cannot allow only portions of sub-properties (such as "Details.Name") in the attribute.</span></span> <span data-ttu-id="4d2c2-365">Enfin, et peut-être plus important encore, l’utilisation de [Bind(Include ="â€¦")] ajoute une étape dont il faut se souvenir à chaque fois que la classe est utilisée pour la liaison de modèle.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-365">Finally, and perhaps most importantly, using [Bind(Include ="â€¦")] adds an extra step that must be remembered any time the class is used for model binding.</span></span> <span data-ttu-id="4d2c2-366">Si une nouvelle méthode d’action est directement liée à la classe de données et oublie d’inclure un attribut [Bind(Include ="â€¦")], elle peut être vulnérable à des attaques par survalidation. L’approche [Bind(Include ="â€¦")] est donc moins sécurisée par défaut.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-366">If a new action method binds to the data class directly and forgets to include a [Bind(Include ="â€¦")] attribute, it can be vulnerable to over-posting attacks, so the [Bind(Include ="â€¦")] approach is somewhat less secure by default.</span></span> <span data-ttu-id="4d2c2-367">Si vous utilisez [Bind(Include ="â€¦")], veillez à toujours le spécifier lorsque vos classes de données s’affichent en tant que paramètres de méthode d’action.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-367">If you use [Bind(Include ="â€¦")], take care always to remember to specify it every time your data classes appear as action method parameters.</span></span></li><li><span data-ttu-id="4d2c2-368">**Pour les opérations de création, que se passe-t-il si l’attribut [Bind(Include ="â€¦")] est placé sur la classe de modèle elle-même ? Cette approche n’évite-t-elle pas d’avoir à se souvenir de placer l’attribut sur chaque méthode d’action ? -** Cette approche fonctionne dans certains cas.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-368">**For Create operations, what about putting the [Bind(Include ="â€¦")] attribute on the model class itself? Does not this approach avoid the need to remember putting the attribute on every action method? -** This approach works in some cases.</span></span> <span data-ttu-id="4d2c2-369">L’utilisation de [Bind(Include ="â€¦")] sur le type de modèle proprement dit (plutôt que sur les paramètres d’action utilisant cette classe) évite d’avoir à se souvenir d’inclure l’attribut [Bind(Include ="â€¦")] sur chaque méthode d’action.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-369">Using [Bind(Include ="â€¦")] on the model type itself (rather than on action parameters using this class), does avoid the need to remember to include the [Bind(Include ="â€¦")] attribute on every action method.</span></span> <span data-ttu-id="4d2c2-370">L’utilisation directe de l’attribut sur la classe crée une zone distincte optimale dans cette classe pour la liaison de modèle.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-370">Using the attribute directly on the class effectively creates a separate surface area of this class for model binding purposes.</span></span> <span data-ttu-id="4d2c2-371">Toutefois, cette approche ne permet qu’une seule forme de liaison de modèle par classe de modèle.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-371">However, this approach only allows for one model binding shape per model class.</span></span> <span data-ttu-id="4d2c2-372">Si une méthode d’action doit autoriser la liaison de modèle d’un champ (par exemple, action réservée à l’administrateur pour mettre à jour les rôles d’utilisateur) et si d’autres actions doivent éviter la liaison de modèle de ce champ, cette approche ne fonctionne pas.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-372">If one action method needs to allow model binding of a field (for example, an administrator-only action that updates user roles) and other actions need to prevent model binding of this field, this approach will not work.</span></span> <span data-ttu-id="4d2c2-373">Chaque classe ne peut avoir qu’une seule forme de liaison de modèle. Si différentes actions nécessitent des formes de liaison de modèle différentes, elles doivent représenter ces formes distinctes à l’aide de classes de liaison de modèle distinctes ou d’attributs [Bind(Include ="â€¦")] distincts sur les méthodes d’action.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-373">Each class can only have one model binding shape; if different actions need different model binding shapes, they need to represent these separate shapes using either separate model binding classes or separate [Bind(Include ="â€¦")] attributes on the action methods.</span></span></li><li><span data-ttu-id="4d2c2-374">**Ce que sont les modèles de liaison ? Sont-ils identiques aux modèles de vue ? -** Ce sont deux concepts connexes.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-374">**What are binding models? Are they the same thing as view models? -** These are two related concepts.</span></span> <span data-ttu-id="4d2c2-375">Le terme « modèle de liaison » indique qu’une classe de modèle utilisée dans une action est une liste de paramètres (forme transmise de la liaison de modèle MVC vers la méthode d’action).</span><span class="sxs-lookup"><span data-stu-id="4d2c2-375">The term binding model refers to a model class used in an action is parameter list (the shape passed from MVC model binding to the action method).</span></span> <span data-ttu-id="4d2c2-376">Le terme « modèle de vue » fait référence à une classe de modèle transmise d’une méthode d’action vers une vue.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-376">The term view model refers to a model class passed from an action method to a view.</span></span> <span data-ttu-id="4d2c2-377">L’utilisation d’un modèle spécifique de la vue est une approche courante pour faire passer des données d’une méthode d’action vers une vue.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-377">Using a view-specific model is a common approach for passing data from an action method to a view.</span></span> <span data-ttu-id="4d2c2-378">Très souvent, cette forme est également adaptée à la liaison de modèles, et le terme « modèle de vue » peut faire référence au même modèle utilisé aux deux emplacements.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-378">Often, this shape is also suitable for model binding, and the term view model can be used to refer the same model used in both places.</span></span> <span data-ttu-id="4d2c2-379">Plus précisément, cette procédure traite spécifiquement des modèles de liaison, et notamment de la forme transmise vers l’action, ce qui importe le plus dans l’attribution collective.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-379">To be precise, this procedure talks specifically about binding models, focusing on the shape passed to the action, which is what matters for mass assignment purposes.</span></span></li></ul>| 

## <span data-ttu-id="4d2c2-380"><a id="rendering"></a>Encoder une sortie web non approuvée avant le rendu</span><span class="sxs-lookup"><span data-stu-id="4d2c2-380"><a id="rendering"></a>Encode untrusted web output prior to rendering</span></span>

| <span data-ttu-id="4d2c2-381">Intitulé</span><span class="sxs-lookup"><span data-stu-id="4d2c2-381">Title</span></span>                   | <span data-ttu-id="4d2c2-382">Détails</span><span class="sxs-lookup"><span data-stu-id="4d2c2-382">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="4d2c2-383">**Composant**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-383">**Component**</span></span>               | <span data-ttu-id="4d2c2-384">Application web</span><span class="sxs-lookup"><span data-stu-id="4d2c2-384">Web Application</span></span> | 
| <span data-ttu-id="4d2c2-385">**Phase SDL**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-385">**SDL Phase**</span></span>               | <span data-ttu-id="4d2c2-386">Créer</span><span class="sxs-lookup"><span data-stu-id="4d2c2-386">Build</span></span> |  
| <span data-ttu-id="4d2c2-387">**Technologies applicables**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-387">**Applicable Technologies**</span></span> | <span data-ttu-id="4d2c2-388">Générique, Web Forms, MVC5, MVC6</span><span class="sxs-lookup"><span data-stu-id="4d2c2-388">Generic, Web Forms, MVC5, MVC6</span></span> |
| <span data-ttu-id="4d2c2-389">**Attributs**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-389">**Attributes**</span></span>              | <span data-ttu-id="4d2c2-390">N/A</span><span class="sxs-lookup"><span data-stu-id="4d2c2-390">N/A</span></span>  |
| <span data-ttu-id="4d2c2-391">**Informations de référence**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-391">**References**</span></span>              | <span data-ttu-id="4d2c2-392">[How to prevent Cross-site scripting in ASP.NET (Comment éviter les scripts intersites dans ASP.NET)](http://msdn.microsoft.com/library/ms998274.aspx), [Cross-site Scripting (Scripts intersites)](http://cwe.mitre.org/data/definitions/79.html), [XSS (Cross Site Scripting) Prevention Cheat Sheet (Aide-mémoire sur la prévention des scripts intersites)](https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet)</span><span class="sxs-lookup"><span data-stu-id="4d2c2-392">[How to prevent Cross-site scripting in ASP.NET](http://msdn.microsoft.com/library/ms998274.aspx), [Cross-site Scripting](http://cwe.mitre.org/data/definitions/79.html), [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet)</span></span> |
| <span data-ttu-id="4d2c2-393">**Étapes**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-393">**Steps**</span></span> | <span data-ttu-id="4d2c2-394">Les scripts intersites (XSS, Cross Site Scripting) sont un vecteur d’attaque pour les services en ligne ou toute application/tout composant qui utilise des entrées tirées du web.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-394">Cross-site scripting (commonly abbreviated as XSS) is an attack vector for online services or any application/component that consumes input from the web.</span></span> <span data-ttu-id="4d2c2-395">Les vulnérabilités XSS permettent à une personne malveillante d’exécuter un script sur l’ordinateur d’un autre utilisateur par le biais d’une application web vulnérable.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-395">XSS vulnerabilities may allow an attacker to execute script on another user's machine through a vulnerable web application.</span></span> <span data-ttu-id="4d2c2-396">Les scripts malveillants peuvent servir à dérober des cookies ou à manipuler un ordinateur cible par le biais de JavaScript.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-396">Malicious scripts can be used to steal cookies and otherwise tamper with a victim's machine through JavaScript.</span></span> <span data-ttu-id="4d2c2-397">Pour empêcher les scripts intersites, il faut procéder à la validation des entrées utilisateur, en s’assurant que la forme et l’encodage sont corrects avant le rendu sur une page web.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-397">XSS is prevented by validating user input, ensuring it is well formed and encoding before it is rendered in a web page.</span></span> <span data-ttu-id="4d2c2-398">La validation des entrées et l’encodage des sorties peuvent se faire au moyen de Web Protection Library.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-398">Input validation and output encoding can be done by using Web Protection Library.</span></span> <span data-ttu-id="4d2c2-399">Pour le code géré (C\#, VB.net, etc.), utilisez une ou plusieurs méthodes d’encodage appropriées, tirées de Web Protection (Anti-XSS) Library, en fonction du contexte dans lequel les entrées utilisateur se manifestent :</span><span class="sxs-lookup"><span data-stu-id="4d2c2-399">For Managed code (C\#, VB.net, etc.), use one or more appropriate encoding methods from the Web Protection (Anti-XSS) Library, depending on the context where the user input gets manifested:</span></span>| 

### <a name="example"></a><span data-ttu-id="4d2c2-400">Exemple</span><span class="sxs-lookup"><span data-stu-id="4d2c2-400">Example</span></span>

```C#
* Encoder.HtmlEncode 
* Encoder.HtmlAttributeEncode 
* Encoder.JavaScriptEncode 
* Encoder.UrlEncode
* Encoder.VisualBasicScriptEncode 
* Encoder.XmlEncode 
* Encoder.XmlAttributeEncode 
* Encoder.CssEncode 
* Encoder.LdapEncode 
```

## <span data-ttu-id="4d2c2-401"><a id="typemodel"></a>Procéder à la validation et au filtrage des entrées sur les propriétés de modèle de tous types de chaînes</span><span class="sxs-lookup"><span data-stu-id="4d2c2-401"><a id="typemodel"></a>Perform input validation and filtering on all string type Model properties</span></span>

| <span data-ttu-id="4d2c2-402">Intitulé</span><span class="sxs-lookup"><span data-stu-id="4d2c2-402">Title</span></span>                   | <span data-ttu-id="4d2c2-403">Détails</span><span class="sxs-lookup"><span data-stu-id="4d2c2-403">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="4d2c2-404">**Composant**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-404">**Component**</span></span>               | <span data-ttu-id="4d2c2-405">Application web</span><span class="sxs-lookup"><span data-stu-id="4d2c2-405">Web Application</span></span> | 
| <span data-ttu-id="4d2c2-406">**Phase SDL**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-406">**SDL Phase**</span></span>               | <span data-ttu-id="4d2c2-407">Créer</span><span class="sxs-lookup"><span data-stu-id="4d2c2-407">Build</span></span> |  
| <span data-ttu-id="4d2c2-408">**Technologies applicables**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-408">**Applicable Technologies**</span></span> | <span data-ttu-id="4d2c2-409">Générique, MVC5, MVC6</span><span class="sxs-lookup"><span data-stu-id="4d2c2-409">Generic, MVC5, MVC6</span></span> |
| <span data-ttu-id="4d2c2-410">**Attributs**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-410">**Attributes**</span></span>              | <span data-ttu-id="4d2c2-411">N/A</span><span class="sxs-lookup"><span data-stu-id="4d2c2-411">N/A</span></span>  |
| <span data-ttu-id="4d2c2-412">**Informations de référence**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-412">**References**</span></span>              | <span data-ttu-id="4d2c2-413">[Adding Validation (Ajout d’une validation)](http://www.asp.net/mvc/overview/getting-started/introduction/adding-validation), [Validating Model Data in an MVC Application (Validation des données de modèle dans une application MVC)](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx), [Principes directeurs pour vos applications ASP.NET MVC](http://msdn.microsoft.com/magazine/dd942822.aspx)</span><span class="sxs-lookup"><span data-stu-id="4d2c2-413">[Adding Validation](http://www.asp.net/mvc/overview/getting-started/introduction/adding-validation), [Validating Model Data in an MVC Application](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx), [Guiding Principles For Your ASP.NET MVC Applications](http://msdn.microsoft.com/magazine/dd942822.aspx)</span></span> |
| <span data-ttu-id="4d2c2-414">**Étapes**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-414">**Steps**</span></span> | <p><span data-ttu-id="4d2c2-415">Tous les paramètres d’entrée doivent être validés avant d’être utilisés dans l’application afin de vous assurer que l’application est protégée contre les entrées utilisateur malveillantes.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-415">All the input parameters must be validated before they are used in the application to ensure that the application is safeguarded against malicious user inputs.</span></span> <span data-ttu-id="4d2c2-416">Validez les valeurs d’entrée en recourant à la validation d’expressions régulières côté serveur au moyen d’une stratégie de validation par liste blanche.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-416">Validate the input values using regular expression validations on server side with a whitelist validation strategy.</span></span> <span data-ttu-id="4d2c2-417">Les entrées utilisateur/paramètres non nettoyés et transmis aux méthodes peuvent engendrer des vulnérabilités par injection de code.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-417">Unsanitized user inputs / parameters passed to the methods can cause code injection vulnerabilities.</span></span></p><p><span data-ttu-id="4d2c2-418">Pour les applications web, les points d’entrée peuvent également inclure des champs de formulaire, des chaînes de requête, des cookies, des en-têtes HTTP et des paramètres de service web.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-418">For web applications, entry points can also include form fields, QueryStrings, cookies, HTTP headers, and web service parameters.</span></span></p><p><span data-ttu-id="4d2c2-419">Les contrôles de validation des entrées suivants doivent être effectués lors de la liaison de modèle :</span><span class="sxs-lookup"><span data-stu-id="4d2c2-419">The following input validation checks must be performed upon model binding:</span></span></p><ul><li><span data-ttu-id="4d2c2-420">Les propriétés de modèle doivent être annotées au moyen d’une annotation RegularExpression, ce qui permet d’accepter les caractères autorisés et la longueur maximale autorisée</span><span class="sxs-lookup"><span data-stu-id="4d2c2-420">The model properties should be annotated with RegularExpression annotation, for accepting allowed characters and maximum permissible length</span></span></li><li><span data-ttu-id="4d2c2-421">Les méthodes de contrôleur doivent procéder à la validation de ModelState</span><span class="sxs-lookup"><span data-stu-id="4d2c2-421">The controller methods should perform ModelState validity</span></span></li></ul>|

## <span data-ttu-id="4d2c2-422"><a id="richtext"></a>Les champs de formulaire acceptant tous les caractères, par exemple dans un éditeur de texte enrichi, doivent être nettoyés</span><span class="sxs-lookup"><span data-stu-id="4d2c2-422"><a id="richtext"></a>Sanitization should be applied on form fields that accept all characters, e.g, rich text editor</span></span>

| <span data-ttu-id="4d2c2-423">Intitulé</span><span class="sxs-lookup"><span data-stu-id="4d2c2-423">Title</span></span>                   | <span data-ttu-id="4d2c2-424">Détails</span><span class="sxs-lookup"><span data-stu-id="4d2c2-424">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="4d2c2-425">**Composant**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-425">**Component**</span></span>               | <span data-ttu-id="4d2c2-426">Application web</span><span class="sxs-lookup"><span data-stu-id="4d2c2-426">Web Application</span></span> | 
| <span data-ttu-id="4d2c2-427">**Phase SDL**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-427">**SDL Phase**</span></span>               | <span data-ttu-id="4d2c2-428">Créer</span><span class="sxs-lookup"><span data-stu-id="4d2c2-428">Build</span></span> |  
| <span data-ttu-id="4d2c2-429">**Technologies applicables**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-429">**Applicable Technologies**</span></span> | <span data-ttu-id="4d2c2-430">Générique</span><span class="sxs-lookup"><span data-stu-id="4d2c2-430">Generic</span></span> |
| <span data-ttu-id="4d2c2-431">**Attributs**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-431">**Attributes**</span></span>              | <span data-ttu-id="4d2c2-432">N/A</span><span class="sxs-lookup"><span data-stu-id="4d2c2-432">N/A</span></span>  |
| <span data-ttu-id="4d2c2-433">**Informations de référence**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-433">**References**</span></span>              | <span data-ttu-id="4d2c2-434">[Encode Unsafe Input (Encodage d’entrées à risque)](https://msdn.microsoft.com/library/ff647397.aspx#paght000003_step3), [HTML Sanitizer](https://github.com/mganss/HtmlSanitizer)</span><span class="sxs-lookup"><span data-stu-id="4d2c2-434">[Encode Unsafe Input](https://msdn.microsoft.com/library/ff647397.aspx#paght000003_step3), [HTML Sanitizer](https://github.com/mganss/HtmlSanitizer)</span></span> |
| <span data-ttu-id="4d2c2-435">**Étapes**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-435">**Steps**</span></span> | <p><span data-ttu-id="4d2c2-436">Identifiez toutes les balises statiques que vous souhaitez utiliser.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-436">Identify all static markup tags that you want to use.</span></span> <span data-ttu-id="4d2c2-437">Une pratique courante consiste à limiter la mise en forme des éléments HTML sécurisés, comme `<b>` (gras) et `<i>` (italique).</span><span class="sxs-lookup"><span data-stu-id="4d2c2-437">A common practice is to restrict formatting to safe HTML elements, such as `<b>` (bold) and `<i>` (italic).</span></span></p><p><span data-ttu-id="4d2c2-438">Avant d’écrire les données, encodez-les au format HTML.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-438">Before writing the data, HTML-encode it.</span></span> <span data-ttu-id="4d2c2-439">Cela sécurise n’importe quel script malveillant en le traitant comme du texte, et non comme du code exécutable.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-439">This makes any malicious script safe by causing it to be handled as text, not as executable code.</span></span></p><ol><li><span data-ttu-id="4d2c2-440">Désactivez la validation de requête ASP.NET en ajoutant l’attribut ValidateRequest="false" à la directive @ Page.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-440">Disable ASP.NET request validation by the adding the ValidateRequest="false" attribute to the @ Page directive</span></span></li><li><span data-ttu-id="4d2c2-441">Encodez les données de chaîne avec la méthode HtmlEncode</span><span class="sxs-lookup"><span data-stu-id="4d2c2-441">Encode the string input with the HtmlEncode method</span></span></li><li><span data-ttu-id="4d2c2-442">Utilisez StringBuilder et appelez sa méthode de remplacement pour supprimer de manière sélective l’encodage sur les éléments HTML que vous souhaitez autoriser</span><span class="sxs-lookup"><span data-stu-id="4d2c2-442">Use a StringBuilder and call its Replace method to selectively remove the encoding on the HTML elements that you want to permit</span></span></li></ol><p><span data-ttu-id="4d2c2-443">La page dans les références désactive la validation de requête ASP.NET en définissant `ValidateRequest="false"`.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-443">The page-in the references disables ASP.NET request validation by setting `ValidateRequest="false"`.</span></span> <span data-ttu-id="4d2c2-444">Elle encode les entrées au format HTML et autorise de manière sélective `<b>` et `<i>`. Une bibliothèque .NET pour le nettoyage HTML peut également être utilisée.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-444">It HTML-encodes the input and selectively allows the `<b>` and `<i>` Alternatively, a .NET library for HTML sanitization may also be used.</span></span></p><p><span data-ttu-id="4d2c2-445">HtmlSanitizer est une bibliothèque .NET destinée au nettoyage des documents et fragments HTML provenant de constructions susceptibles d’aboutir à des attaques XSS.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-445">HtmlSanitizer is a .NET library for cleaning HTML fragments and documents from constructs that can lead to XSS attacks.</span></span> <span data-ttu-id="4d2c2-446">Elle utilise AngleSharp pour analyser, manipuler et réaliser le rendu HTML et CSS.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-446">It uses AngleSharp to parse, manipulate, and render HTML and CSS.</span></span> <span data-ttu-id="4d2c2-447">HtmlSanitizer peut être installée en tant que package NuGet, et les entrées utilisateur peuvent être transmises par le biais de méthodes de nettoyage HTML ou CSS appropriées, le cas échéant, côté serveur.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-447">HtmlSanitizer can be installed as a NuGet package, and the user input can be passed through relevant HTML or CSS sanitization methods, as applicable, on the server side.</span></span> <span data-ttu-id="4d2c2-448">Dans le cadre du contrôle de sécurité, le nettoyage doit être envisagé uniquement en dernier recours.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-448">Please note that Sanitization as a security control should be considered only as a last option.</span></span></p><p><span data-ttu-id="4d2c2-449">La validation des entrées et l’encodage des sorties sont considérés comme de meilleurs contrôles de sécurité.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-449">Input validation and Output Encoding are considered better security controls.</span></span></p> |

## <span data-ttu-id="4d2c2-450"><a id="inbuilt-encode"></a>Ne pas attribuer d’éléments DOM à des récepteurs sans codage intégré</span><span class="sxs-lookup"><span data-stu-id="4d2c2-450"><a id="inbuilt-encode"></a>Do not assign DOM elements to sinks that do not have inbuilt encoding</span></span>

| <span data-ttu-id="4d2c2-451">Intitulé</span><span class="sxs-lookup"><span data-stu-id="4d2c2-451">Title</span></span>                   | <span data-ttu-id="4d2c2-452">Détails</span><span class="sxs-lookup"><span data-stu-id="4d2c2-452">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="4d2c2-453">**Composant**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-453">**Component**</span></span>               | <span data-ttu-id="4d2c2-454">Application web</span><span class="sxs-lookup"><span data-stu-id="4d2c2-454">Web Application</span></span> | 
| <span data-ttu-id="4d2c2-455">**Phase SDL**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-455">**SDL Phase**</span></span>               | <span data-ttu-id="4d2c2-456">Créer</span><span class="sxs-lookup"><span data-stu-id="4d2c2-456">Build</span></span> |  
| <span data-ttu-id="4d2c2-457">**Technologies applicables**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-457">**Applicable Technologies**</span></span> | <span data-ttu-id="4d2c2-458">Générique</span><span class="sxs-lookup"><span data-stu-id="4d2c2-458">Generic</span></span> |
| <span data-ttu-id="4d2c2-459">**Attributs**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-459">**Attributes**</span></span>              | <span data-ttu-id="4d2c2-460">N/A</span><span class="sxs-lookup"><span data-stu-id="4d2c2-460">N/A</span></span>  |
| <span data-ttu-id="4d2c2-461">**Informations de référence**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-461">**References**</span></span>              | <span data-ttu-id="4d2c2-462">N/A</span><span class="sxs-lookup"><span data-stu-id="4d2c2-462">N/A</span></span>  |
| <span data-ttu-id="4d2c2-463">**Étapes**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-463">**Steps**</span></span> | <span data-ttu-id="4d2c2-464">De nombreuses fonctions JavaScript ne procèdent pas à l’encodage par défaut.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-464">Many javascript functions don't do encoding by default.</span></span> <span data-ttu-id="4d2c2-465">L’attribution d’entrées non approuvées à des éléments DOM par le biais de ces fonctions risque d’entraîner l’exécution de scripts intersites (XSS).</span><span class="sxs-lookup"><span data-stu-id="4d2c2-465">When assigning untrusted input to DOM elements via such functions, may result in cross site script (XSS) executions.</span></span>| 

### <a name="example"></a><span data-ttu-id="4d2c2-466">Exemple</span><span class="sxs-lookup"><span data-stu-id="4d2c2-466">Example</span></span>
<span data-ttu-id="4d2c2-467">Voici quelques exemples non sécurisés :</span><span class="sxs-lookup"><span data-stu-id="4d2c2-467">Following are insecure examples:</span></span> 

```
document.getElementByID("div1").innerHtml = value;
$("#userName").html(res.Name);
return $('<div/>').html(value)
$('body').append(resHTML);   
```
<span data-ttu-id="4d2c2-468">N’utilisez pas `innerHtml`. Utilisez plutôt `innerText`.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-468">Don't use `innerHtml`; instead use `innerText`.</span></span> <span data-ttu-id="4d2c2-469">De même, au lieu de `$("#elm").html()`, utilisez`$("#elm").text()`</span><span class="sxs-lookup"><span data-stu-id="4d2c2-469">Similarly, instead of `$("#elm").html()`, use `$("#elm").text()`</span></span> 

## <span data-ttu-id="4d2c2-470"><a id="redirect-safe"></a>Valider la sécurité de la fermeture ou de l’exécution de toutes les redirections au sein de l’application</span><span class="sxs-lookup"><span data-stu-id="4d2c2-470"><a id="redirect-safe"></a>Validate all redirects within the application are closed or done safely</span></span>

| <span data-ttu-id="4d2c2-471">Intitulé</span><span class="sxs-lookup"><span data-stu-id="4d2c2-471">Title</span></span>                   | <span data-ttu-id="4d2c2-472">Détails</span><span class="sxs-lookup"><span data-stu-id="4d2c2-472">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="4d2c2-473">**Composant**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-473">**Component**</span></span>               | <span data-ttu-id="4d2c2-474">Application web</span><span class="sxs-lookup"><span data-stu-id="4d2c2-474">Web Application</span></span> | 
| <span data-ttu-id="4d2c2-475">**Phase SDL**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-475">**SDL Phase**</span></span>               | <span data-ttu-id="4d2c2-476">Créer</span><span class="sxs-lookup"><span data-stu-id="4d2c2-476">Build</span></span> |  
| <span data-ttu-id="4d2c2-477">**Technologies applicables**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-477">**Applicable Technologies**</span></span> | <span data-ttu-id="4d2c2-478">Générique</span><span class="sxs-lookup"><span data-stu-id="4d2c2-478">Generic</span></span> |
| <span data-ttu-id="4d2c2-479">**Attributs**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-479">**Attributes**</span></span>              | <span data-ttu-id="4d2c2-480">N/A</span><span class="sxs-lookup"><span data-stu-id="4d2c2-480">N/A</span></span>  |
| <span data-ttu-id="4d2c2-481">**Informations de référence**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-481">**References**</span></span>              | [<span data-ttu-id="4d2c2-482">The OAuth 2.0 Authorization Framework - Open Redirectors (Infrastructure d’autorisation OAuth 2.0 : Redirecteurs ouverts)</span><span class="sxs-lookup"><span data-stu-id="4d2c2-482">The OAuth 2.0 Authorization Framework - Open Redirectors</span></span>](http://tools.ietf.org/html/rfc6749#section-10.15) |
| <span data-ttu-id="4d2c2-483">**Étapes**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-483">**Steps**</span></span> | <p><span data-ttu-id="4d2c2-484">La conception d’applications nécessitant une redirection vers un emplacement fourni par l’utilisateur doit limiter les cibles possibles de redirection à une liste prédéfinie « sécurisée » de sites ou de domaines.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-484">Application design requiring redirection to a user-supplied location must constrain the possible redirection targets to a predefined "safe" list of sites or domains.</span></span> <span data-ttu-id="4d2c2-485">Toutes les redirections au sein de l’application doivent être fermées/sécurisées.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-485">All redirects in the application must be closed/safe.</span></span></p><p><span data-ttu-id="4d2c2-486">Pour ce faire :</span><span class="sxs-lookup"><span data-stu-id="4d2c2-486">To do this:</span></span></p><ul><li><span data-ttu-id="4d2c2-487">Identifiez toutes les redirections</span><span class="sxs-lookup"><span data-stu-id="4d2c2-487">Identify all redirects</span></span></li><li><span data-ttu-id="4d2c2-488">Implémentez une mesure de correction appropriée pour chaque redirection.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-488">Implement an appropriate mitigation for each redirect.</span></span> <span data-ttu-id="4d2c2-489">Les mesures de correction appropriées incluent la confirmation utilisateur ou les listes blanches de redirection.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-489">Appropriate mitigations include redirect whitelist or user confirmation.</span></span> <span data-ttu-id="4d2c2-490">Si un site web ou un service avec vulnérabilité par redirection ouverte utilise les fournisseurs d’identité Facebook/OAuth/OpenID, une personne malveillante peut voler le jeton d’ouverture de session d’un utilisateur et emprunter l’identité de cet utilisateur.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-490">If a web site or service with an open redirect vulnerability uses Facebook/OAuth/OpenID identity providers, an attacker can steal a user's logon token and impersonate that user.</span></span> <span data-ttu-id="4d2c2-491">Il s’agit d’un risque inhérent de l’utilisation d’OAuth, décrit dans le document RFC 6749 « The OAuth 2.0 Authorization Framework » (Infrastructure d’autorisation OAuth 2.0), Section 10.15 « Open Redirects » (Redirecteurs ouverts). De même, les informations d’identification des utilisateurs peuvent être compromises par des attaques par hameçonnage ciblé se servant de redirections ouvertes</span><span class="sxs-lookup"><span data-stu-id="4d2c2-491">This is an inherent risk when using OAuth, which is documented in RFC 6749 "The OAuth 2.0 Authorization Framework", Section 10.15 "Open Redirects" Similarly, users' credentials can be compromised by spear phishing attacks using open redirects</span></span></li></ul>|

## <span data-ttu-id="4d2c2-492"><a id="string-method"></a>Implémenter la validation des entrées sur tous les paramètres de type de chaîne acceptés par les méthodes de contrôleur</span><span class="sxs-lookup"><span data-stu-id="4d2c2-492"><a id="string-method"></a>Implement input validation on all string type parameters accepted by Controller methods</span></span>

| <span data-ttu-id="4d2c2-493">Intitulé</span><span class="sxs-lookup"><span data-stu-id="4d2c2-493">Title</span></span>                   | <span data-ttu-id="4d2c2-494">Détails</span><span class="sxs-lookup"><span data-stu-id="4d2c2-494">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="4d2c2-495">**Composant**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-495">**Component**</span></span>               | <span data-ttu-id="4d2c2-496">Application web</span><span class="sxs-lookup"><span data-stu-id="4d2c2-496">Web Application</span></span> | 
| <span data-ttu-id="4d2c2-497">**Phase SDL**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-497">**SDL Phase**</span></span>               | <span data-ttu-id="4d2c2-498">Créer</span><span class="sxs-lookup"><span data-stu-id="4d2c2-498">Build</span></span> |  
| <span data-ttu-id="4d2c2-499">**Technologies applicables**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-499">**Applicable Technologies**</span></span> | <span data-ttu-id="4d2c2-500">Générique, MVC5, MVC6</span><span class="sxs-lookup"><span data-stu-id="4d2c2-500">Generic, MVC5, MVC6</span></span> |
| <span data-ttu-id="4d2c2-501">**Attributs**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-501">**Attributes**</span></span>              | <span data-ttu-id="4d2c2-502">N/A</span><span class="sxs-lookup"><span data-stu-id="4d2c2-502">N/A</span></span>  |
| <span data-ttu-id="4d2c2-503">**Informations de référence**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-503">**References**</span></span>              | <span data-ttu-id="4d2c2-504">[Validating Model Data in an MVC Application (Validation des données de modèle dans une application MVC)](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx), [Principes directeurs pour vos applications ASP.NET MVC](http://msdn.microsoft.com/magazine/dd942822.aspx)</span><span class="sxs-lookup"><span data-stu-id="4d2c2-504">[Validating Model Data in an MVC Application](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx), [Guiding Principles For Your ASP.NET MVC Applications](http://msdn.microsoft.com/magazine/dd942822.aspx)</span></span> |
| <span data-ttu-id="4d2c2-505">**Étapes**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-505">**Steps**</span></span> | <span data-ttu-id="4d2c2-506">Pour les méthodes qui acceptent uniquement un type de données primitif, et non les modèles en tant qu’argument, la validation des entrées doit être effectuée à l’aide d’expressions régulières.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-506">For methods that just accept primitive data type, and not models as argument,input validation using Regular Expression should be done.</span></span> <span data-ttu-id="4d2c2-507">Dans le cas présent, Regex.IsMatch doit être utilisé avec un modèle d’expression régulière valide.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-507">Here Regex.IsMatch should be used with a valid regex pattern.</span></span> <span data-ttu-id="4d2c2-508">Si l’entrée ne correspond pas à l’expression régulière spécifiée, le contrôle ne doit pas se poursuivre, et un avertissement approprié indiquant l’échec de la validation doit s’afficher.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-508">If the input doesn't match the specified Regular Expression, control should not proceed further, and an adequate warning regarding validation failure should be displayed.</span></span>| 

## <span data-ttu-id="4d2c2-509"><a id="dos-expression"></a>Définir le seuil supérieur du délai d’expiration pour le traitement des expressions régulières afin d’empêcher un déni de service en raison d’expressions régulières incorrectes</span><span class="sxs-lookup"><span data-stu-id="4d2c2-509"><a id="dos-expression"></a>Set upper limit timeout for regular expression processing to prevent DoS due to bad regular expressions</span></span>

| <span data-ttu-id="4d2c2-510">Intitulé</span><span class="sxs-lookup"><span data-stu-id="4d2c2-510">Title</span></span>                   | <span data-ttu-id="4d2c2-511">Détails</span><span class="sxs-lookup"><span data-stu-id="4d2c2-511">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="4d2c2-512">**Composant**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-512">**Component**</span></span>               | <span data-ttu-id="4d2c2-513">Application web</span><span class="sxs-lookup"><span data-stu-id="4d2c2-513">Web Application</span></span> | 
| <span data-ttu-id="4d2c2-514">**Phase SDL**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-514">**SDL Phase**</span></span>               | <span data-ttu-id="4d2c2-515">Créer</span><span class="sxs-lookup"><span data-stu-id="4d2c2-515">Build</span></span> |  
| <span data-ttu-id="4d2c2-516">**Technologies applicables**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-516">**Applicable Technologies**</span></span> | <span data-ttu-id="4d2c2-517">Générique, Web Forms, MVC5, MVC6</span><span class="sxs-lookup"><span data-stu-id="4d2c2-517">Generic, Web Forms, MVC5, MVC6</span></span>  |
| <span data-ttu-id="4d2c2-518">**Attributs**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-518">**Attributes**</span></span>              | <span data-ttu-id="4d2c2-519">N/A</span><span class="sxs-lookup"><span data-stu-id="4d2c2-519">N/A</span></span>  |
| <span data-ttu-id="4d2c2-520">**Informations de référence**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-520">**References**</span></span>              | [<span data-ttu-id="4d2c2-521">Propriété DefaultRegexMatchTimeout</span><span class="sxs-lookup"><span data-stu-id="4d2c2-521">DefaultRegexMatchTimeout Property </span></span>](https://msdn.microsoft.com/library/system.web.configuration.httpruntimesection.defaultregexmatchtimeout.aspx) |
| <span data-ttu-id="4d2c2-522">**Étapes**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-522">**Steps**</span></span> | <span data-ttu-id="4d2c2-523">Pour empêcher les attaques par déni de service contre les expressions régulières incorrectes, qui suscitent de nombreux retours sur trace, définissez le délai d’attente global par défaut.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-523">To ensure denial of service attacks against badly created regular expressions, that cause a lot of backtracking, set the global default timeout.</span></span> <span data-ttu-id="4d2c2-524">Si le temps de traitement excède la limite supérieure définie, une exception d’expiration est générée.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-524">If the processing time takes longer than the defined upper limit, it would throw a Timeout exception.</span></span> <span data-ttu-id="4d2c2-525">Si rien n’est configuré, le délai d’attente est infini.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-525">If nothing is configured, the timeout would be infinite.</span></span>| 

### <a name="example"></a><span data-ttu-id="4d2c2-526">Exemple</span><span class="sxs-lookup"><span data-stu-id="4d2c2-526">Example</span></span>
<span data-ttu-id="4d2c2-527">Par exemple, la configuration suivante génère une exception RegexMatchTimeoutException, si le traitement prend plus de 5 secondes :</span><span class="sxs-lookup"><span data-stu-id="4d2c2-527">For example, the following configuration will throw a RegexMatchTimeoutException, if the processing takes more than 5 seconds:</span></span> 

```C#
<httpRuntime targetFramework="4.5" defaultRegexMatchTimeout="00:00:05" />
```

## <span data-ttu-id="4d2c2-528"><a id="html-razor"></a>Éviter l’utilisation de Html.Raw dans les vues Razor</span><span class="sxs-lookup"><span data-stu-id="4d2c2-528"><a id="html-razor"></a>Avoid using Html.Raw in Razor views</span></span>

| <span data-ttu-id="4d2c2-529">Intitulé</span><span class="sxs-lookup"><span data-stu-id="4d2c2-529">Title</span></span>                   | <span data-ttu-id="4d2c2-530">Détails</span><span class="sxs-lookup"><span data-stu-id="4d2c2-530">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="4d2c2-531">**Composant**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-531">**Component**</span></span>               | <span data-ttu-id="4d2c2-532">Application web</span><span class="sxs-lookup"><span data-stu-id="4d2c2-532">Web Application</span></span> | 
| <span data-ttu-id="4d2c2-533">**Phase SDL**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-533">**SDL Phase**</span></span>               | <span data-ttu-id="4d2c2-534">Créer</span><span class="sxs-lookup"><span data-stu-id="4d2c2-534">Build</span></span> |  
| <span data-ttu-id="4d2c2-535">**Technologies applicables**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-535">**Applicable Technologies**</span></span> | <span data-ttu-id="4d2c2-536">MVC5, MVC6</span><span class="sxs-lookup"><span data-stu-id="4d2c2-536">MVC5, MVC6</span></span> |
| <span data-ttu-id="4d2c2-537">**Attributs**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-537">**Attributes**</span></span>              | <span data-ttu-id="4d2c2-538">N/A</span><span class="sxs-lookup"><span data-stu-id="4d2c2-538">N/A</span></span>  |
| <span data-ttu-id="4d2c2-539">**Informations de référence**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-539">**References**</span></span>              | <span data-ttu-id="4d2c2-540">N/A</span><span class="sxs-lookup"><span data-stu-id="4d2c2-540">N/A</span></span>  |
| <span data-ttu-id="4d2c2-541">Étape</span><span class="sxs-lookup"><span data-stu-id="4d2c2-541">Step</span></span> | <span data-ttu-id="4d2c2-542">ASP.Net WebPages (Razor) procède à un encodage HTML automatique.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-542">ASP.Net WebPages (Razor) perform automatic HTML encoding.</span></span> <span data-ttu-id="4d2c2-543">Toutes les chaînes imprimées par des pépites, ou nuggets, de code (blocs @) sont automatiquement encodées au format HTML.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-543">All strings printed by embedded code nuggets (@ blocks) are automatically HTML-encoded.</span></span> <span data-ttu-id="4d2c2-544">Toutefois, lorsque la méthode `HtmlHelper.Raw` est appelée, elle renvoie un balisage qui n’est pas encodé au format HTML.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-544">However, when `HtmlHelper.Raw` Method is invoked, it returns markup that is not HTML encoded.</span></span> <span data-ttu-id="4d2c2-545">Si la méthode d’assistance `Html.Raw()` est utilisée, elle ignore la protection par encodage automatique fournie par Razor.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-545">If `Html.Raw()` helper method is used, it bypasses the automatic encoding protection that Razor provides.</span></span>|

### <a name="example"></a><span data-ttu-id="4d2c2-546">Exemple</span><span class="sxs-lookup"><span data-stu-id="4d2c2-546">Example</span></span>
<span data-ttu-id="4d2c2-547">Voici un exemple non sécurisé :</span><span class="sxs-lookup"><span data-stu-id="4d2c2-547">Following is an insecure example:</span></span> 

```C#
<div class="form-group">
            @Html.Raw(Model.AccountConfirmText)
        </div>
        <div class="form-group">
            @Html.Raw(Model.PaymentConfirmText)
        </div>
</div>
```
<span data-ttu-id="4d2c2-548">N’utilisez pas `Html.Raw()` sauf si vous devez afficher le balisage.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-548">Do not use `Html.Raw()` unless you need to display markup.</span></span> <span data-ttu-id="4d2c2-549">Cette méthode n’effectue pas de codage implicite en sortie.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-549">This method does not perform output encoding implicitly.</span></span> <span data-ttu-id="4d2c2-550">Utilisez d’autres aides ASP.NET, comme `@Html.DisplayFor()`</span><span class="sxs-lookup"><span data-stu-id="4d2c2-550">Use other ASP.NET helpers e.g., `@Html.DisplayFor()`</span></span> 

## <span data-ttu-id="4d2c2-551"><a id="stored-proc"></a>Ne pas utiliser les requêtes dynamiques dans les procédures stockées</span><span class="sxs-lookup"><span data-stu-id="4d2c2-551"><a id="stored-proc"></a>Do not use dynamic queries in stored procedures</span></span>

| <span data-ttu-id="4d2c2-552">Intitulé</span><span class="sxs-lookup"><span data-stu-id="4d2c2-552">Title</span></span>                   | <span data-ttu-id="4d2c2-553">Détails</span><span class="sxs-lookup"><span data-stu-id="4d2c2-553">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="4d2c2-554">**Composant**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-554">**Component**</span></span>               | <span data-ttu-id="4d2c2-555">Base de données</span><span class="sxs-lookup"><span data-stu-id="4d2c2-555">Database</span></span> | 
| <span data-ttu-id="4d2c2-556">**Phase SDL**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-556">**SDL Phase**</span></span>               | <span data-ttu-id="4d2c2-557">Créer</span><span class="sxs-lookup"><span data-stu-id="4d2c2-557">Build</span></span> |  
| <span data-ttu-id="4d2c2-558">**Technologies applicables**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-558">**Applicable Technologies**</span></span> | <span data-ttu-id="4d2c2-559">Générique</span><span class="sxs-lookup"><span data-stu-id="4d2c2-559">Generic</span></span> |
| <span data-ttu-id="4d2c2-560">**Attributs**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-560">**Attributes**</span></span>              | <span data-ttu-id="4d2c2-561">N/A</span><span class="sxs-lookup"><span data-stu-id="4d2c2-561">N/A</span></span>  |
| <span data-ttu-id="4d2c2-562">**Informations de référence**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-562">**References**</span></span>              | <span data-ttu-id="4d2c2-563">N/A</span><span class="sxs-lookup"><span data-stu-id="4d2c2-563">N/A</span></span>  |
| <span data-ttu-id="4d2c2-564">**Étapes**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-564">**Steps**</span></span> | <p><span data-ttu-id="4d2c2-565">Une attaque par injection de code SQL exploite les vulnérabilités de la validation des entrées afin d’exécuter des commandes arbitraires dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-565">A SQL injection attack exploits vulnerabilities in input validation to run arbitrary commands in the database.</span></span> <span data-ttu-id="4d2c2-566">Cela peut se produire lorsque votre application utilise des entrées pour créer des instructions SQL dynamiques afin d’accéder à la base de données.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-566">It can occur when your application uses input to construct dynamic SQL statements to access the database.</span></span> <span data-ttu-id="4d2c2-567">Cela peut également se produire si votre code utilise des procédures stockées contenant des chaînes transmises qui comportent des entrées utilisateur brutes.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-567">It can also occur if your code uses stored procedures that are passed strings that contain raw user input.</span></span> <span data-ttu-id="4d2c2-568">Grâce aux attaques par injection de code SQL, une personne malveillante peut exécuter des commandes arbitraires dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-568">Using the SQL injection attack, the attacker can execute arbitrary commands in the database.</span></span> <span data-ttu-id="4d2c2-569">Toutes les instructions SQL (y compris les instructions SQL des procédures stockées) doivent être paramétrables.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-569">All SQL statements (including the SQL statements in stored procedures) must be parameterized.</span></span> <span data-ttu-id="4d2c2-570">Les instructions SQL paramétrables acceptent les caractères ayant une signification particulière pour SQL (par exemple, les guillemets simples) sans problème, car ils sont fortement typés.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-570">Parameterized SQL statements will accept characters that have special meaning to SQL (like single quote) without problems because they are strongly typed.</span></span> |

### <a name="example"></a><span data-ttu-id="4d2c2-571">Exemple</span><span class="sxs-lookup"><span data-stu-id="4d2c2-571">Example</span></span>
<span data-ttu-id="4d2c2-572">Voici un exemple de procédure stockée dynamique non sécurisée :</span><span class="sxs-lookup"><span data-stu-id="4d2c2-572">Following is an example of insecure dynamic Stored Procedure:</span></span> 

```C#
CREATE PROCEDURE [dbo].[uspGetProductsByCriteria]
(
  @productName nvarchar(200) = NULL,
  @startPrice float = NULL,
  @endPrice float = NULL
)
AS
 BEGIN
  DECLARE @sql nvarchar(max)
  SELECT @sql = ' SELECT ProductID, ProductName, Description, UnitPrice, ImagePath' +
       ' FROM dbo.Products WHERE 1 = 1 '
       PRINT @sql
  IF @productName IS NOT NULL
     SELECT @sql = @sql + ' AND ProductName LIKE ''%' + @productName + '%'''
  IF @startPrice IS NOT NULL
     SELECT @sql = @sql + ' AND UnitPrice > ''' + CONVERT(VARCHAR(10),@startPrice) + ''''
  IF @endPrice IS NOT NULL
     SELECT @sql = @sql + ' AND UnitPrice < ''' + CONVERT(VARCHAR(10),@endPrice) + ''''

  PRINT @sql
  EXEC(@sql)
 END
```

### <a name="example"></a><span data-ttu-id="4d2c2-573">Exemple</span><span class="sxs-lookup"><span data-stu-id="4d2c2-573">Example</span></span>
<span data-ttu-id="4d2c2-574">Voici la même procédure stockée, implémentée de façon sécurisée :</span><span class="sxs-lookup"><span data-stu-id="4d2c2-574">Following is the same stored procedure implemented securely:</span></span> 
```C#
CREATE PROCEDURE [dbo].[uspGetProductsByCriteriaSecure]
(
             @productName nvarchar(200) = NULL,
             @startPrice float = NULL,
             @endPrice float = NULL
)
AS
       BEGIN
             SELECT ProductID, ProductName, Description, UnitPrice, ImagePath
             FROM dbo.Products where
             (@productName IS NULL or ProductName like '%'+ @productName +'%')
             AND
             (@startPrice IS NULL or UnitPrice > @startPrice)
             AND
             (@endPrice IS NULL or UnitPrice < @endPrice)         
       END
```

## <span data-ttu-id="4d2c2-575"><a id="validation-api"></a>S’assurer que la validation du modèle est effectuée sur les méthodes d’API Web</span><span class="sxs-lookup"><span data-stu-id="4d2c2-575"><a id="validation-api"></a>Ensure that model validation is done on Web API methods</span></span>

| <span data-ttu-id="4d2c2-576">Intitulé</span><span class="sxs-lookup"><span data-stu-id="4d2c2-576">Title</span></span>                   | <span data-ttu-id="4d2c2-577">Détails</span><span class="sxs-lookup"><span data-stu-id="4d2c2-577">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="4d2c2-578">**Composant**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-578">**Component**</span></span>               | <span data-ttu-id="4d2c2-579">API Web</span><span class="sxs-lookup"><span data-stu-id="4d2c2-579">Web API</span></span> | 
| <span data-ttu-id="4d2c2-580">**Phase SDL**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-580">**SDL Phase**</span></span>               | <span data-ttu-id="4d2c2-581">Créer</span><span class="sxs-lookup"><span data-stu-id="4d2c2-581">Build</span></span> |  
| <span data-ttu-id="4d2c2-582">**Technologies applicables**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-582">**Applicable Technologies**</span></span> | <span data-ttu-id="4d2c2-583">MVC5, MVC6</span><span class="sxs-lookup"><span data-stu-id="4d2c2-583">MVC5, MVC6</span></span> |
| <span data-ttu-id="4d2c2-584">**Attributs**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-584">**Attributes**</span></span>              | <span data-ttu-id="4d2c2-585">N/A</span><span class="sxs-lookup"><span data-stu-id="4d2c2-585">N/A</span></span>  |
| <span data-ttu-id="4d2c2-586">**Informations de référence**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-586">**References**</span></span>              | [<span data-ttu-id="4d2c2-587">Model Validation in ASP.NET Web API (Validation du modèle dans l’API Web ASP.NET)</span><span class="sxs-lookup"><span data-stu-id="4d2c2-587">Model Validation in ASP.NET Web API </span></span>](http://www.asp.net/web-api/overview/formats-and-model-binding/model-validation-in-aspnet-web-api) |
| <span data-ttu-id="4d2c2-588">**Étapes**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-588">**Steps**</span></span> | <span data-ttu-id="4d2c2-589">Lorsqu’un client envoie des données vers une API Web, les données doivent être validées avant tout traitement.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-589">When a client sends data to a web API, it is mandatory to validate the data before doing any processing.</span></span> <span data-ttu-id="4d2c2-590">Pour les API Web ASP.NET qui acceptent les modèles en tant qu’entrée, utilisez des annotations de données sur les modèles afin de définir des règles de validation sur les propriétés du modèle.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-590">For ASP.NET Web APIs which accept models as input, use data annotations on models to set validation rules on the properties of the model.</span></span>|

### <a name="example"></a><span data-ttu-id="4d2c2-591">Exemple</span><span class="sxs-lookup"><span data-stu-id="4d2c2-591">Example</span></span>
<span data-ttu-id="4d2c2-592">Le code suivant illustre le même cas :</span><span class="sxs-lookup"><span data-stu-id="4d2c2-592">The following code demonstrates the same:</span></span> 

```C#
using System.ComponentModel.DataAnnotations;

namespace MyApi.Models
{
    public class Product
    {
        public int Id { get; set; }
        [Required]
        [RegularExpression(@"^[a-zA-Z0-9]*$", ErrorMessage="Only alphanumeric characters are allowed.")]
        public string Name { get; set; }
        public decimal Price { get; set; }
        [Range(0, 999)]
        public double Weight { get; set; }
    }
}
```

### <a name="example"></a><span data-ttu-id="4d2c2-593">Exemple</span><span class="sxs-lookup"><span data-stu-id="4d2c2-593">Example</span></span>
<span data-ttu-id="4d2c2-594">Dans la méthode d’action des contrôleurs d’API, la validité du modèle doit être vérifiée explicitement comme indiqué ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="4d2c2-594">In the action method of the API controllers, validity of the model has to be explicitly checked as shown below:</span></span> 

```C#
namespace MyApi.Controllers
{
    public class ProductsController : ApiController
    {
        public HttpResponseMessage Post(Product product)
        {
            if (ModelState.IsValid)
            {
                // Do something with the product (not shown).

                return new HttpResponseMessage(HttpStatusCode.OK);
            }
            else
            {
                return Request.CreateErrorResponse(HttpStatusCode.BadRequest, ModelState);
            }
        }
    }
}
```

## <span data-ttu-id="4d2c2-595"><a id="string-api"></a>Implémenter la validation des entrées sur tous les paramètres de type de chaîne acceptés par les méthodes d’API Web</span><span class="sxs-lookup"><span data-stu-id="4d2c2-595"><a id="string-api"></a>Implement input validation on all string type parameters accepted by Web API methods</span></span>

| <span data-ttu-id="4d2c2-596">Intitulé</span><span class="sxs-lookup"><span data-stu-id="4d2c2-596">Title</span></span>                   | <span data-ttu-id="4d2c2-597">Détails</span><span class="sxs-lookup"><span data-stu-id="4d2c2-597">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="4d2c2-598">**Composant**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-598">**Component**</span></span>               | <span data-ttu-id="4d2c2-599">API Web</span><span class="sxs-lookup"><span data-stu-id="4d2c2-599">Web API</span></span> | 
| <span data-ttu-id="4d2c2-600">**Phase SDL**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-600">**SDL Phase**</span></span>               | <span data-ttu-id="4d2c2-601">Créer</span><span class="sxs-lookup"><span data-stu-id="4d2c2-601">Build</span></span> |  
| <span data-ttu-id="4d2c2-602">**Technologies applicables**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-602">**Applicable Technologies**</span></span> | <span data-ttu-id="4d2c2-603">Générique, MVC 5, MVC 6</span><span class="sxs-lookup"><span data-stu-id="4d2c2-603">Generic, MVC 5, MVC 6</span></span> |
| <span data-ttu-id="4d2c2-604">**Attributs**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-604">**Attributes**</span></span>              | <span data-ttu-id="4d2c2-605">N/A</span><span class="sxs-lookup"><span data-stu-id="4d2c2-605">N/A</span></span>  |
| <span data-ttu-id="4d2c2-606">**Informations de référence**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-606">**References**</span></span>              | <span data-ttu-id="4d2c2-607">[Validating Model Data in an MVC Application (Validation des données de modèle dans une application MVC)](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx), [Principes directeurs pour vos applications ASP.NET MVC](http://msdn.microsoft.com/magazine/dd942822.aspx)</span><span class="sxs-lookup"><span data-stu-id="4d2c2-607">[Validating Model Data in an MVC Application](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx), [Guiding Principles For Your ASP.NET MVC Applications](http://msdn.microsoft.com/magazine/dd942822.aspx)</span></span> |
| <span data-ttu-id="4d2c2-608">**Étapes**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-608">**Steps**</span></span> | <span data-ttu-id="4d2c2-609">Pour les méthodes qui acceptent uniquement un type de données primitif, et non les modèles en tant qu’argument, la validation des entrées doit être effectuée à l’aide d’expressions régulières.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-609">For methods that just accept primitive data type, and not models as argument,input validation using Regular Expression should be done.</span></span> <span data-ttu-id="4d2c2-610">Dans le cas présent, Regex.IsMatch doit être utilisé avec un modèle d’expression régulière valide.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-610">Here Regex.IsMatch should be used with a valid regex pattern.</span></span> <span data-ttu-id="4d2c2-611">Si l’entrée ne correspond pas à l’expression régulière spécifiée, le contrôle ne doit pas se poursuivre, et un avertissement approprié indiquant l’échec de la validation doit s’afficher.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-611">If the input doesn't match the specified Regular Expression, control should not proceed further, and an adequate warning regarding validation failure should be displayed.</span></span>|

## <span data-ttu-id="4d2c2-612"><a id="typesafe-api"></a>S’assurer que les paramètres de type sécurisé sont utilisés dans une API Web pour l’accès aux données</span><span class="sxs-lookup"><span data-stu-id="4d2c2-612"><a id="typesafe-api"></a>Ensure that type-safe parameters are used in Web API for data access</span></span>

| <span data-ttu-id="4d2c2-613">Intitulé</span><span class="sxs-lookup"><span data-stu-id="4d2c2-613">Title</span></span>                   | <span data-ttu-id="4d2c2-614">Détails</span><span class="sxs-lookup"><span data-stu-id="4d2c2-614">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="4d2c2-615">**Composant**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-615">**Component**</span></span>               | <span data-ttu-id="4d2c2-616">API Web</span><span class="sxs-lookup"><span data-stu-id="4d2c2-616">Web API</span></span> | 
| <span data-ttu-id="4d2c2-617">**Phase SDL**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-617">**SDL Phase**</span></span>               | <span data-ttu-id="4d2c2-618">Créer</span><span class="sxs-lookup"><span data-stu-id="4d2c2-618">Build</span></span> |  
| <span data-ttu-id="4d2c2-619">**Technologies applicables**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-619">**Applicable Technologies**</span></span> | <span data-ttu-id="4d2c2-620">Générique</span><span class="sxs-lookup"><span data-stu-id="4d2c2-620">Generic</span></span> |
| <span data-ttu-id="4d2c2-621">**Attributs**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-621">**Attributes**</span></span>              | <span data-ttu-id="4d2c2-622">N/A</span><span class="sxs-lookup"><span data-stu-id="4d2c2-622">N/A</span></span>  |
| <span data-ttu-id="4d2c2-623">**Informations de référence**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-623">**References**</span></span>              | <span data-ttu-id="4d2c2-624">N/A</span><span class="sxs-lookup"><span data-stu-id="4d2c2-624">N/A</span></span>  |
| <span data-ttu-id="4d2c2-625">**Étapes**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-625">**Steps**</span></span> | <p><span data-ttu-id="4d2c2-626">Si vous utilisez la collection Parameters, SQL traite l’entrée comme une valeur littérale et non comme du code exécutable.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-626">If you use the Parameters collection, SQL treats the input is as a literal value rather then as executable code.</span></span> <span data-ttu-id="4d2c2-627">La collection Parameters peut être utilisée pour appliquer des contraintes de type et de longueur sur les données d’entrée.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-627">The Parameters collection can be used to enforce type and length constraints on input data.</span></span> <span data-ttu-id="4d2c2-628">Les valeurs situées en dehors de la plage déclenchent une exception.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-628">Values outside of the range trigger an exception.</span></span> <span data-ttu-id="4d2c2-629">En l’absence de paramètres SQL de type sécurisé, des personnes malveillantes peuvent exécuter des attaques par injection, incorporées dans les entrées non filtrées.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-629">If type-safe SQL parameters are not used, attackers might be able to execute injection attacks that are embedded in the unfiltered input.</span></span></p><p><span data-ttu-id="4d2c2-630">Utilisez des paramètres de type sécurisé lors de la création de requêtes SQL afin d’éviter des attaques par injection de code SQL susceptibles de se produire avec des entrées non filtrées.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-630">Use type safe parameters when constructing SQL queries to avoid possible SQL injection attacks that can occur with unfiltered input.</span></span> <span data-ttu-id="4d2c2-631">Vous pouvez utiliser des paramètres de type sécurisé avec des procédures stockées et des instructions SQL dynamiques.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-631">You can use type safe parameters with stored procedures and with dynamic SQL statements.</span></span> <span data-ttu-id="4d2c2-632">Les paramètres sont traités comme des valeurs littérales par la base de données, et non comme du code exécutable.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-632">Parameters are treated as literal values by the database and not as executable code.</span></span> <span data-ttu-id="4d2c2-633">Le type et la longueur sont également vérifiés pour les paramètres.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-633">Parameters are also checked for type and length.</span></span></p>|

### <a name="example"></a><span data-ttu-id="4d2c2-634">Exemple</span><span class="sxs-lookup"><span data-stu-id="4d2c2-634">Example</span></span>
<span data-ttu-id="4d2c2-635">Le code suivant montre comment utiliser les paramètres de type sécurisé avec SqlParameterCollection lors de l’appel d’une procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-635">The following code shows how to use type safe parameters with the SqlParameterCollection when calling a stored procedure.</span></span> 

```C#
using System.Data;
using System.Data.SqlClient;

using (SqlConnection connection = new SqlConnection(connectionString))
{ 
DataSet userDataset = new DataSet(); 
SqlDataAdapter myCommand = new SqlDataAdapter(LoginStoredProcedure", connection); 
myCommand.SelectCommand.CommandType = CommandType.StoredProcedure; 
myCommand.SelectCommand.Parameters.Add("@au_id", SqlDbType.VarChar, 11); 
myCommand.SelectCommand.Parameters["@au_id"].Value = SSN.Text; 
myCommand.Fill(userDataset);
}  
```
<span data-ttu-id="4d2c2-636">Dans l’exemple de code précédent, la valeur d’entrée ne peut pas être supérieure à 11 caractères.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-636">In the preceding code example, the input value cannot be longer than 11 characters.</span></span> <span data-ttu-id="4d2c2-637">Si les données ne sont pas conformes au type ou à la longueur définis par le paramètre, la classe SqlParameter renvoie une exception.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-637">If the data does not conform to the type or length defined by the parameter, the SqlParameter class throws an exception.</span></span> 

## <span data-ttu-id="4d2c2-638"><a id="sql-docdb"></a>Utiliser des requêtes SQL paramétrables pour Azure Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="4d2c2-638"><a id="sql-docdb"></a>Use parametrized SQL queries for Cosmos DB</span></span>

| <span data-ttu-id="4d2c2-639">Intitulé</span><span class="sxs-lookup"><span data-stu-id="4d2c2-639">Title</span></span>                   | <span data-ttu-id="4d2c2-640">Détails</span><span class="sxs-lookup"><span data-stu-id="4d2c2-640">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="4d2c2-641">**Composant**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-641">**Component**</span></span>               | <span data-ttu-id="4d2c2-642">Azure Document DB</span><span class="sxs-lookup"><span data-stu-id="4d2c2-642">Azure Document DB</span></span> | 
| <span data-ttu-id="4d2c2-643">**Phase SDL**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-643">**SDL Phase**</span></span>               | <span data-ttu-id="4d2c2-644">Créer</span><span class="sxs-lookup"><span data-stu-id="4d2c2-644">Build</span></span> |  
| <span data-ttu-id="4d2c2-645">**Technologies applicables**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-645">**Applicable Technologies**</span></span> | <span data-ttu-id="4d2c2-646">Générique</span><span class="sxs-lookup"><span data-stu-id="4d2c2-646">Generic</span></span> |
| <span data-ttu-id="4d2c2-647">**Attributs**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-647">**Attributes**</span></span>              | <span data-ttu-id="4d2c2-648">N/A</span><span class="sxs-lookup"><span data-stu-id="4d2c2-648">N/A</span></span>  |
| <span data-ttu-id="4d2c2-649">**Informations de référence**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-649">**References**</span></span>              | [<span data-ttu-id="4d2c2-650">Announcing SQL Parameterization in DocumentDB (Annonce de paramétrage SQL dans DocumentDB)</span><span class="sxs-lookup"><span data-stu-id="4d2c2-650">Announcing SQL Parameterization in DocumentDB</span></span>](https://azure.microsoft.com/blog/announcing-sql-parameterization-in-documentdb/) |
| <span data-ttu-id="4d2c2-651">**Étapes**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-651">**Steps**</span></span> | <span data-ttu-id="4d2c2-652">Bien que DocumentDB prenne uniquement en charge les requêtes en lecture seule, l’injection de code SQL reste possible si les requêtes sont construites par concaténation avec les entrées utilisateur.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-652">Although DocumentDB only supports read-only queries, SQL injection is still possible if queries are constructed by concatenating with user input.</span></span> <span data-ttu-id="4d2c2-653">Un utilisateur peut parfois accéder à des données auxquelles il ne devrait pas accéder dans la même collection en créant des requêtes SQL malveillantes.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-653">It might be possible for a user to gain access to data they shouldn’t be accessing within the same collection by crafting malicious SQL queries.</span></span> <span data-ttu-id="4d2c2-654">Utilisez des requêtes SQL paramétrables si les requêtes sont créées à partir d’entrées utilisateur.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-654">Use parameterized SQL queries if queries are constructed based on user input.</span></span> |

## <span data-ttu-id="4d2c2-655"><a id="schema-binding"></a>Validation des entrées WCF par le biais de la liaison de schéma</span><span class="sxs-lookup"><span data-stu-id="4d2c2-655"><a id="schema-binding"></a>WCF Input validation through Schema binding</span></span>

| <span data-ttu-id="4d2c2-656">Intitulé</span><span class="sxs-lookup"><span data-stu-id="4d2c2-656">Title</span></span>                   | <span data-ttu-id="4d2c2-657">Détails</span><span class="sxs-lookup"><span data-stu-id="4d2c2-657">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="4d2c2-658">**Composant**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-658">**Component**</span></span>               | <span data-ttu-id="4d2c2-659">WCF</span><span class="sxs-lookup"><span data-stu-id="4d2c2-659">WCF</span></span> | 
| <span data-ttu-id="4d2c2-660">**Phase SDL**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-660">**SDL Phase**</span></span>               | <span data-ttu-id="4d2c2-661">Créer</span><span class="sxs-lookup"><span data-stu-id="4d2c2-661">Build</span></span> |  
| <span data-ttu-id="4d2c2-662">**Technologies applicables**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-662">**Applicable Technologies**</span></span> | <span data-ttu-id="4d2c2-663">Générique, NET Framework 3</span><span class="sxs-lookup"><span data-stu-id="4d2c2-663">Generic, NET Framework 3</span></span> |
| <span data-ttu-id="4d2c2-664">**Attributs**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-664">**Attributes**</span></span>              | <span data-ttu-id="4d2c2-665">N/A</span><span class="sxs-lookup"><span data-stu-id="4d2c2-665">N/A</span></span>  |
| <span data-ttu-id="4d2c2-666">**Informations de référence**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-666">**References**</span></span>              | [<span data-ttu-id="4d2c2-667">MSDN</span><span class="sxs-lookup"><span data-stu-id="4d2c2-667">MSDN</span></span>](https://msdn.microsoft.com/library/ff647820.aspx) |
| <span data-ttu-id="4d2c2-668">**Étapes**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-668">**Steps**</span></span> | <p><span data-ttu-id="4d2c2-669">Une absence de validation peut entraîner différentes attaques par injection de code.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-669">Lack of validation leads to different type injection attacks.</span></span></p><p><span data-ttu-id="4d2c2-670">La validation des messages représente une ligne de défense spécifique dans la protection de votre application WCF.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-670">Message validation represents one line of defense in the protection of your WCF application.</span></span> <span data-ttu-id="4d2c2-671">Avec cette approche, vous validez des messages à l’aide de schémas pour protéger les opérations de service WCF contre les attaques de clients malveillants.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-671">With this approach, you validate messages using schemas to protect WCF service operations from attack by a malicious client.</span></span> <span data-ttu-id="4d2c2-672">Validez tous les messages reçus par le client pour protéger le client contre des attaques effectuées par un service malveillant.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-672">Validate all messages received by the client to protect the client from attack by a malicious service.</span></span> <span data-ttu-id="4d2c2-673">La validation des messages permet de valider les messages lorsque les opérations utilisent des contrats de messages ou de données, ce qui ne peut pas être fait avec la validation des paramètres.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-673">Message validation makes it possible to validate messages when operations consume message contracts or data contracts, which cannot be done using parameter validation.</span></span> <span data-ttu-id="4d2c2-674">La validation des messages vous permet de créer une logique de validation dans les schémas, offrant ainsi plus de flexibilité et réduisant le temps de développement.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-674">Message validation allows you to create validation logic inside schemas, thereby providing more flexibility and reducing development time.</span></span> <span data-ttu-id="4d2c2-675">Les schémas peuvent être réutilisés dans plusieurs applications de l’organisation, ce qui crée des normes de représentation des données.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-675">Schemas can be reused across different applications inside the organization, creating standards for data representation.</span></span> <span data-ttu-id="4d2c2-676">En outre, la validation des messages vous permet de protéger les opérations lorsqu’elles utilisent des types de données plus complexes impliquant des contrats de logique métier.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-676">Additionally, message validation allows you to protect operations when they consume more complex data types involving contracts representing business logic.</span></span></p><p><span data-ttu-id="4d2c2-677">Pour procéder à la validation des messages, commencez par créer un schéma qui représente les opérations de votre service et les types de données utilisées par ces opérations.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-677">To perform message validation, you first build a schema that represents the operations of your service and the data types consumed by those operations.</span></span> <span data-ttu-id="4d2c2-678">Créez ensuite une classe .NET qui implémente un inspecteur de messages client personnalisé et un inspecteur de messages de répartition personnalisé afin de valider les messages envoyés/reçus à destination/en provenance du service.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-678">You then create a .NET class that implements a custom client message inspector and custom dispatcher message inspector to validate the messages sent/received to/from the service.</span></span> <span data-ttu-id="4d2c2-679">Puis implémentez un comportement de point de terminaison personnalisé afin d’activer la validation des messages sur le client et le service.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-679">Next, you implement a custom endpoint behavior to enable message validation on both the client and the service.</span></span> <span data-ttu-id="4d2c2-680">Enfin, implémentez un élément de configuration personnalisé sur la classe afin d’exposer le comportement de point de terminaison personnalisé étendu dans le fichier de configuration du service ou le client.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-680">Finally, you implement a custom configuration element on the class that allows you to expose the extended custom endpoint behavior in the configuration file of the service or the client"</span></span></p>|

## <span data-ttu-id="4d2c2-681"><a id="parameters"></a>WCF - Validation des entrées par le biais des inspecteurs de paramètres</span><span class="sxs-lookup"><span data-stu-id="4d2c2-681"><a id="parameters"></a>WCF- Input validation through Parameter Inspectors</span></span>

| <span data-ttu-id="4d2c2-682">Intitulé</span><span class="sxs-lookup"><span data-stu-id="4d2c2-682">Title</span></span>                   | <span data-ttu-id="4d2c2-683">Détails</span><span class="sxs-lookup"><span data-stu-id="4d2c2-683">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="4d2c2-684">**Composant**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-684">**Component**</span></span>               | <span data-ttu-id="4d2c2-685">WCF</span><span class="sxs-lookup"><span data-stu-id="4d2c2-685">WCF</span></span> | 
| <span data-ttu-id="4d2c2-686">**Phase SDL**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-686">**SDL Phase**</span></span>               | <span data-ttu-id="4d2c2-687">Créer</span><span class="sxs-lookup"><span data-stu-id="4d2c2-687">Build</span></span> |  
| <span data-ttu-id="4d2c2-688">**Technologies applicables**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-688">**Applicable Technologies**</span></span> | <span data-ttu-id="4d2c2-689">Générique, NET Framework 3</span><span class="sxs-lookup"><span data-stu-id="4d2c2-689">Generic, NET Framework 3</span></span> |
| <span data-ttu-id="4d2c2-690">**Attributs**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-690">**Attributes**</span></span>              | <span data-ttu-id="4d2c2-691">N/A</span><span class="sxs-lookup"><span data-stu-id="4d2c2-691">N/A</span></span>  |
| <span data-ttu-id="4d2c2-692">**Informations de référence**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-692">**References**</span></span>              | [<span data-ttu-id="4d2c2-693">MSDN</span><span class="sxs-lookup"><span data-stu-id="4d2c2-693">MSDN</span></span>](https://msdn.microsoft.com/library/ff647875.aspx) |
| <span data-ttu-id="4d2c2-694">**Étapes**</span><span class="sxs-lookup"><span data-stu-id="4d2c2-694">**Steps**</span></span> | <p><span data-ttu-id="4d2c2-695">La validation des données et des entrées représente une ligne de défense importante de la protection de votre application WCF.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-695">Input and data validation represents one important line of defense in the protection of your WCF application.</span></span> <span data-ttu-id="4d2c2-696">Vous devez valider tous les paramètres exposés dans les opérations de service WCF pour protéger le service des attaques menées par un client malveillant.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-696">You should validate all parameters exposed in WCF service operations to protect the service from attack by a malicious client.</span></span> <span data-ttu-id="4d2c2-697">Inversement, vous devez aussi valider toutes les valeurs de retour reçues par le client pour protéger le client contre les attaques menées par un service malveillant</span><span class="sxs-lookup"><span data-stu-id="4d2c2-697">Conversely, you should also validate all return values received by the client to protect the client from attack by a malicious service</span></span></p><p><span data-ttu-id="4d2c2-698">WCF fournit différents points d’extension qui vous permettent de personnaliser le comportement d’exécution WCF en créant des extensions personnalisées.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-698">WCF provides different extensibility points that allow you to customize the WCF runtime behavior by creating custom extensions.</span></span> <span data-ttu-id="4d2c2-699">Les inspecteurs de messages et les inspecteurs de paramètres sont deux mécanismes d’extension facilitant le contrôle des données échangées entre un client et un service.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-699">Message Inspectors and Parameter Inspectors are two extensibility mechanisms used to gain greater control over the data passing between a client and a service.</span></span> <span data-ttu-id="4d2c2-700">Vous devez utiliser les inspecteurs de paramètres pour la validation des entrées, et les inspecteurs de messages uniquement lorsque vous devez inspecter l’intégralité des messages entrant et sortant d’un service.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-700">You should use parameter inspectors for input validation and use message inspectors only when you need to inspect the entire message flowing in and out of a service.</span></span></p><p><span data-ttu-id="4d2c2-701">Pour procéder à la validation des entrées, créez une classe .NET et implémentez un inspecteur de paramètres personnalisé afin de valider les paramètres sur les opérations dans votre service.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-701">To perform input validation, you will build a .NET class and implement a custom parameter inspector in order to validate parameters on operations in your service.</span></span> <span data-ttu-id="4d2c2-702">Implémentez ensuite un comportement de point de terminaison personnalisé afin d’activer la validation sur le client et le service.</span><span class="sxs-lookup"><span data-stu-id="4d2c2-702">You will then implement a custom endpoint behavior to enable validation on both the client and the service.</span></span> <span data-ttu-id="4d2c2-703">Enfin, implémentez un élément de configuration personnalisé sur la classe afin d’exposer le comportement de point de terminaison personnalisé étendu dans le fichier de configuration du service ou le client</span><span class="sxs-lookup"><span data-stu-id="4d2c2-703">Finally, you will implement a custom configuration element on the class that allows you to expose the extended custom endpoint behavior in the configuration file of the service or the client</span></span></p>|
