---
title: Utilisation de modules Node.js
description: "Découvrez comment utiliser des modules Node.js avec Azure App Service ou Cloud Services."
services: 
documentationcenter: nodejs
author: TomArcher
manager: routlaw
editor: 
ms.assetid: c0e6cd3d-932d-433e-b72d-e513e23b4eb6
ms.service: multiple
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: nodejs
ms.topic: article
ms.date: 08/17/2016
ms.author: tarcher
ms.openlocfilehash: 1418c19594f19a15402d494880514298826445df
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/18/2017
---
# <a name="using-nodejs-modules-with-azure-applications"></a><span data-ttu-id="b0b04-103">Utilisation de modules Node.js avec des applications Azure</span><span class="sxs-lookup"><span data-stu-id="b0b04-103">Using Node.js Modules with Azure applications</span></span>
<span data-ttu-id="b0b04-104">Ce document fournit des instructions sur l'utilisation de modules Node.js avec des applications hébergées sur Azure.</span><span class="sxs-lookup"><span data-stu-id="b0b04-104">This document provides guidance on using Node.js modules with applications hosted on Azure.</span></span> <span data-ttu-id="b0b04-105">Il vous explique comment vous assurer que votre application utilise une version spécifique d'un module et vous présente l'utilisation de modules natifs avec Azure.</span><span class="sxs-lookup"><span data-stu-id="b0b04-105">It provides guidance on ensuring that your application uses a specific version of module as well as using native modules with Azure.</span></span>

<span data-ttu-id="b0b04-106">Si vous savez utiliser les modules Node.js, les fichiers **package.json** et **npm-shrinkwrap.json**, vous trouverez ci-dessous un résumé rapide des sujets abordés dans cet article :</span><span class="sxs-lookup"><span data-stu-id="b0b04-106">If you are already familiar with using Node.js modules, **package.json** and **npm-shrinkwrap.json** files, the following information provides a quick summary of what is discussed in this article:</span></span>

* <span data-ttu-id="b0b04-107">Azure App Service comprend les fichiers **package.json** et **npm-shrinkwrap.json** et peut installer des modules basés sur les entrées de ces fichiers.</span><span class="sxs-lookup"><span data-stu-id="b0b04-107">Azure App Service understands **package.json** and **npm-shrinkwrap.json** files and can install modules based on entries in these files.</span></span>

* <span data-ttu-id="b0b04-108">Azure Cloud Services s'attend à ce que tous les modules soient installés dans l'environnement de développement et que le répertoire **node\_modules** soit inclus dans le déploiement du package.</span><span class="sxs-lookup"><span data-stu-id="b0b04-108">Azure Cloud Services expect all modules to be installed on the development environment, and the **node\_modules** directory to be included as part of the deployment package.</span></span> <span data-ttu-id="b0b04-109">Il est possible d'activer la prise en charge pour l'installation des modules en utilisant les fichiers **package.json** ou **npm-shrinkwrap.json** sur Cloud Services. Néanmoins, cette configuration requiert la personnalisation des scripts par défaut utilisés pour les projets Cloud Services.</span><span class="sxs-lookup"><span data-stu-id="b0b04-109">It is possible to enable support for installing modules using **package.json** or **npm-shrinkwrap.json** files on Cloud Services; however, this configuration requires customization of the default scripts used by Cloud Service projects.</span></span> <span data-ttu-id="b0b04-110">Pour obtenir un exemple de configuration de cet environnement, consultez la page [Tâche de démarrage d'Azure permettant d'exécuter l’installation npm pour éviter le déploiement des modules de nœuds](https://github.com/woloski/nodeonazure-blog/blob/master/articles/startup-task-to-run-npm-in-azure.markdown)</span><span class="sxs-lookup"><span data-stu-id="b0b04-110">For an example of how to configure this environment, see [Azure Startup task to run npm install to avoid deploying node modules](https://github.com/woloski/nodeonazure-blog/blob/master/articles/startup-task-to-run-npm-in-azure.markdown)</span></span>

> [!NOTE]
> <span data-ttu-id="b0b04-111">Les machines virtuelles Azure ne sont pas abordées dans cet article, car l’expérience de déploiement sur une machine virtuelle dépend du système d'exploitation hébergé par cette dernière.</span><span class="sxs-lookup"><span data-stu-id="b0b04-111">Azure Virtual Machines are not discussed in this article, as the deployment experience in a VM is dependent on the operating system hosted by the Virtual Machine.</span></span>
> 
> 

## <a name="nodejs-modules"></a><span data-ttu-id="b0b04-112">Modules Node.js</span><span class="sxs-lookup"><span data-stu-id="b0b04-112">Node.js Modules</span></span>
<span data-ttu-id="b0b04-113">Les modules sont des packages JavaScript chargeables qui fournissent une fonctionnalité spécifique à votre application.</span><span class="sxs-lookup"><span data-stu-id="b0b04-113">Modules are loadable JavaScript packages that provide specific functionality for your application.</span></span> <span data-ttu-id="b0b04-114">Les modules sont habituellement installés à l'aide de l'outil de ligne de commandes **napm**. Néanmoins, certains modules (le module http par exemple) sont intégrés au package Node.js principal.</span><span class="sxs-lookup"><span data-stu-id="b0b04-114">Modules are usually installed using the **npm** command-line tool, however some modules (such as the http module) are provided as part of the core Node.js package.</span></span>

<span data-ttu-id="b0b04-115">Lorsque les modules sont installés, ils sont stockés dans le répertoire **node\_modules** à la racine de la structure de répertoires de votre application.</span><span class="sxs-lookup"><span data-stu-id="b0b04-115">When modules are installed, they are stored in the **node\_modules** directory at the root of your application directory structure.</span></span> <span data-ttu-id="b0b04-116">Chaque module du répertoire **modules\_de nœuds** conserve son propre répertoire **modules\_de nœuds** qui comporte tous les modules dont il dépend. Cette structure se répète pour chaque module, tout au long de la chaîne de dépendance.</span><span class="sxs-lookup"><span data-stu-id="b0b04-116">Each module within the **node\_modules** directory maintains its own **node\_modules** directory that contains any modules that it depends on, and this behavior repeats for every module all the way down the dependency chain.</span></span> <span data-ttu-id="b0b04-117">Cet environnement permet que chaque module installé soit doté de ses propres exigences de version pour les modules dont il dépend, ce qui peut néanmoins résulter en une structure de répertoires assez volumineuse.</span><span class="sxs-lookup"><span data-stu-id="b0b04-117">This environment allows each module installed to have its own version requirements for the modules it depends on, however it can result in quite a large directory structure.</span></span>

<span data-ttu-id="b0b04-118">Lors du déploiement du répertoire **modules\_de nœuds** dans votre application, la taille du déploiement est accrue comparée à l'utilisation d’un fichier **package.json** ou **npm-shrinkwrap.json**. Néanmoins, ce type de déploiement garantit que la version des modules utilisés en production est la même que ceux utilisés en développement.</span><span class="sxs-lookup"><span data-stu-id="b0b04-118">Deploying the **node\_modules** directory as part of your application increases the size of the deployment when compared to using a **package.json** or **npm-shrinkwrap.json** file; however, it does guarantee that the versions of the modules used in production are the same as the modules used in development.</span></span>

### <a name="native-modules"></a><span data-ttu-id="b0b04-119">Modules natifs</span><span class="sxs-lookup"><span data-stu-id="b0b04-119">Native Modules</span></span>
<span data-ttu-id="b0b04-120">Alors que la plupart des modules sont simplement des fichiers JavaScript en texte brut, certains modules sont des images binaires propres à des plateformes.</span><span class="sxs-lookup"><span data-stu-id="b0b04-120">While most modules are simply plain-text JavaScript files, some modules are platform-specific binary images.</span></span> <span data-ttu-id="b0b04-121">Ces modules sont compilés au moment de l'installation, en général à l'aide de Python et node-gyp.</span><span class="sxs-lookup"><span data-stu-id="b0b04-121">These modules are compiled at install time, usually by using Python and node-gyp.</span></span> <span data-ttu-id="b0b04-122">Azure Cloud Services se reposant sur le déploiement du dossier **node\_modules** dans l'application, tout module natif inclus dans les modules installés doit fonctionner dans un service cloud, du moment où il a été installé et compilé dans un système de développement Windows.</span><span class="sxs-lookup"><span data-stu-id="b0b04-122">Since Azure Cloud Services rely on the **node\_modules** folder being deployed as part of the application, any native module included as part of the installed modules should work in a cloud service as long as it was installed and compiled on a Windows development system.</span></span>

<span data-ttu-id="b0b04-123">Azure App Service ne prend pas en charge tous les modules natifs et risque de ne pas pouvoir les compiler si des prérequis spécifiques sont requis.</span><span class="sxs-lookup"><span data-stu-id="b0b04-123">Azure App Service does not support all native modules, and might fail when compiling modules with specific prerequisites.</span></span> <span data-ttu-id="b0b04-124">Alors que certains modules populaires tels que MongoDB ont des dépendances natives facultatives et fonctionnent correctement sans celles-ci, deux solutions se sont avérées opérationnelles avec presque tous les modules natifs disponibles à ce jour :</span><span class="sxs-lookup"><span data-stu-id="b0b04-124">While some popular modules like MongoDB have optional native dependencies and work fine without them, two workarounds proved successful with almost all native modules available today:</span></span>

* <span data-ttu-id="b0b04-125">Exécutez **npm install** sur un ordinateur Windows sur lequel sont installés tous les composants requis du module native.</span><span class="sxs-lookup"><span data-stu-id="b0b04-125">Run **npm install** on a Windows machine that has all the native module's prerequisites installed.</span></span> <span data-ttu-id="b0b04-126">Ensuite, déployez le dossier **node\_modules** créé dans le cadre de l'application sur Azure App Service.</span><span class="sxs-lookup"><span data-stu-id="b0b04-126">Then, deploy the created **node\_modules** folder as part of the application to Azure App Service.</span></span>

  * <span data-ttu-id="b0b04-127">Avant de compiler, vérifiez que votre installation locale de Node.js dispose de la bonne architecture et que la version est aussi proche que possible de celle utilisée dans Azure (les valeurs peuvent être vérifiées lors de l’exécution dans les propriétés **process.arch** et **process.version**).</span><span class="sxs-lookup"><span data-stu-id="b0b04-127">Before compiling, check that your local Node.js installation has matching architecture and the version is as close as possible to the one used in Azure (the current values can be checked on runtime from properties **process.arch** and **process.version**).</span></span>

* <span data-ttu-id="b0b04-128">Azure App Service peut être configuré pour exécuter des scripts Shell ou Bash personnalisés pendant le déploiement, ce qui vous permet d'exécuter des commandes personnalisées et de configurer précisément l'exécution de **npm install** .</span><span class="sxs-lookup"><span data-stu-id="b0b04-128">Azure App Service can be configured to execute custom bash or shell scripts during deployment, giving you the opportunity to execute custom commands and precisely configure the way **npm install** is being run.</span></span> <span data-ttu-id="b0b04-129">Pour afficher une vidéo montrant comment procéder, consultez [Scripts de déploiement de site Web personnalisés avec Kudu].</span><span class="sxs-lookup"><span data-stu-id="b0b04-129">For a video showing how to configure that environment, see [Custom Website Deployment Scripts with Kudu].</span></span>

### <a name="using-a-packagejson-file"></a><span data-ttu-id="b0b04-130">Utilisation du fichier package.json</span><span class="sxs-lookup"><span data-stu-id="b0b04-130">Using a package.json file</span></span>
<span data-ttu-id="b0b04-131">Le fichier **package.json** permet de spécifier les dépendances de niveau supérieur requises par votre application afin que la plateforme d'hébergement puisse installer les dépendances, plutôt que de vous obliger à inclure le dossier **packages\_de nœuds** dans le déploiement.</span><span class="sxs-lookup"><span data-stu-id="b0b04-131">The **package.json** file is a way to specify the top-level dependencies your application requires so that the hosting platform can install the dependencies, rather than requiring you to include the **node\_packages** folder as part of the deployment.</span></span> <span data-ttu-id="b0b04-132">Une fois que l'application a été déployée, la commande **npm install** permet d'analyser le fichier **package.json** et d'installer toutes les dépendances répertoriées.</span><span class="sxs-lookup"><span data-stu-id="b0b04-132">After the application has been deployed, the **npm install** command is used to parse the **package.json** file and install all the dependencies listed.</span></span>

<span data-ttu-id="b0b04-133">Au cours du développement, vous pouvez utiliser les paramètres **--save**, **--save-dev** ou **--save-optional** lors de l'installation de modules afin d'ajouter automatiquement une entrée pour le module à votre fichier **package.json**.</span><span class="sxs-lookup"><span data-stu-id="b0b04-133">During development, you can use the **--save**, **--save-dev**, or **--save-optional** parameters when installing modules to add an entry for the module to your **package.json** file automatically.</span></span> <span data-ttu-id="b0b04-134">Pour plus d'informations, consultez la page [npm-install](https://docs.npmjs.com/cli/install).</span><span class="sxs-lookup"><span data-stu-id="b0b04-134">For more information, see [npm-install](https://docs.npmjs.com/cli/install).</span></span>

<span data-ttu-id="b0b04-135">Un problème potentiel avec le fichier **package.json** est qu'il n'indique la version que pour les dépendances de niveau supérieur.</span><span class="sxs-lookup"><span data-stu-id="b0b04-135">One potential problem with the **package.json** file is that it only specifies the version for top-level dependencies.</span></span> <span data-ttu-id="b0b04-136">Chaque module installé peut spécifier ou non la version des modules dont il dépend. Ainsi, il est possible que vous obteniez une chaîne de dépendance différente de celle utilisée en développement.</span><span class="sxs-lookup"><span data-stu-id="b0b04-136">Each module installed may or may not specify the version of the modules it depends on, and so it is possible that you may end up with a different dependency chain than the one used in development.</span></span>

> [!NOTE]
> <span data-ttu-id="b0b04-137">Pendant le déploiement sur Azure App Service, si votre fichier <b>package.json</b> fait référence à un module natif, une erreur similaire à l’exemple ci-dessous s'affiche au moment de la publication de l'application à l'aide de Git :</span><span class="sxs-lookup"><span data-stu-id="b0b04-137">When deploying to Azure App Service, if your <b>package.json</b> file references a native module you might see an error similar to the following example when publishing the application using Git:</span></span>
> 
> <span data-ttu-id="b0b04-138">npm ERR!</span><span class="sxs-lookup"><span data-stu-id="b0b04-138">npm ERR!</span></span> <span data-ttu-id="b0b04-139">module-name@0.6.0 install: 'node-gyp configure build'</span><span class="sxs-lookup"><span data-stu-id="b0b04-139">module-name@0.6.0 install: 'node-gyp configure build'</span></span>
> 
> <span data-ttu-id="b0b04-140">npm ERR!</span><span class="sxs-lookup"><span data-stu-id="b0b04-140">npm ERR!</span></span> <span data-ttu-id="b0b04-141">'cmd "/c" "node-gyp configure build"' failed with 1</span><span class="sxs-lookup"><span data-stu-id="b0b04-141">'cmd "/c" "node-gyp configure build"' failed with 1</span></span>
> 
> 

### <a name="using-a-npm-shrinkwrapjson-file"></a><span data-ttu-id="b0b04-142">Utilisation d'un fichier npm-shrinkwrap.json</span><span class="sxs-lookup"><span data-stu-id="b0b04-142">Using a npm-shrinkwrap.json file</span></span>
<span data-ttu-id="b0b04-143">Le fichier **npm-shrinkwrap.json** tente de résoudre les limitations de contrôle de version des modules du fichier **package.json**.</span><span class="sxs-lookup"><span data-stu-id="b0b04-143">The **npm-shrinkwrap.json** file is an attempt to address the module versioning limitations of the **package.json** file.</span></span> <span data-ttu-id="b0b04-144">Alors que le fichier **package.json** n'inclut que des versions pour les modules de niveau supérieur, le fichier **npm-shrinkwrap.json** contient les exigences de version pour l'ensemble de la chaîne de dépendance des modules.</span><span class="sxs-lookup"><span data-stu-id="b0b04-144">While the **package.json** file only includes versions for the top-level modules, the **npm-shrinkwrap.json** file contains the version requirements for the full module dependency chain.</span></span>

<span data-ttu-id="b0b04-145">Lorsque votre application est prête pour la production, vous pouvez verrouiller les exigences de version et créer un fichier **npm-shrinkwrap.json** à l'aide de la commande **npm shrinkwrap**.</span><span class="sxs-lookup"><span data-stu-id="b0b04-145">When your application is ready for production, you can lock down version requirements and create an **npm-shrinkwrap.json** file by using the **npm shrinkwrap** command.</span></span> <span data-ttu-id="b0b04-146">Cette commande utilise les versions actuellement installées dans le dossier **modules\_de nœuds** et les enregistre dans le fichier **npm-shrinkwrap.json**.</span><span class="sxs-lookup"><span data-stu-id="b0b04-146">This command will use the versions currently installed in the **node\_modules** folder, and record these versions to the **npm-shrinkwrap.json** file.</span></span> <span data-ttu-id="b0b04-147">Une fois que l'application a été déployée vers l'environnement d'hébergement, la commande **npm install** permet d'analyser le fichier **npm-shrinkwrap.json** et d'installer toutes les dépendances répertoriées.</span><span class="sxs-lookup"><span data-stu-id="b0b04-147">After the application has been deployed to the hosting environment, the **npm install** command is used to parse the **npm-shrinkwrap.json** file and install all the dependencies listed.</span></span> <span data-ttu-id="b0b04-148">Pour plus d’informations, consultez [npm-shrinkwrap](https://docs.npmjs.com/cli/shrinkwrap).</span><span class="sxs-lookup"><span data-stu-id="b0b04-148">For more information, see [npm-shrinkwrap](https://docs.npmjs.com/cli/shrinkwrap).</span></span>

> [!NOTE]
> <span data-ttu-id="b0b04-149">Pendant le déploiement sur Azure App Service, si votre fichier <b>npm-shrinkwrap.json</b> fait référence à un module natif, une erreur similaire à l’exemple ci-dessous s'affiche au moment de la publication de l'application à l'aide de Git :</span><span class="sxs-lookup"><span data-stu-id="b0b04-149">When deploying to Azure App Service, if your <b>npm-shrinkwrap.json</b> file references a native module you might see an error similar to the following example when publishing the application using Git:</span></span>
> 
> <span data-ttu-id="b0b04-150">npm ERR!</span><span class="sxs-lookup"><span data-stu-id="b0b04-150">npm ERR!</span></span> <span data-ttu-id="b0b04-151">module-name@0.6.0 install: 'node-gyp configure build'</span><span class="sxs-lookup"><span data-stu-id="b0b04-151">module-name@0.6.0 install: 'node-gyp configure build'</span></span>
> 
> <span data-ttu-id="b0b04-152">npm ERR!</span><span class="sxs-lookup"><span data-stu-id="b0b04-152">npm ERR!</span></span> <span data-ttu-id="b0b04-153">'cmd "/c" "node-gyp configure build"' failed with 1</span><span class="sxs-lookup"><span data-stu-id="b0b04-153">'cmd "/c" "node-gyp configure build"' failed with 1</span></span>
> 
> 

## <a name="next-steps"></a><span data-ttu-id="b0b04-154">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="b0b04-154">Next steps</span></span>
<span data-ttu-id="b0b04-155">Maintenant que vous savez comment utiliser les modules Node.js avec Azure, découvrez comment [spécifier la version de Node.js], [créer et déployer une application web Node.js](app-service-web/app-service-web-get-started-nodejs.md) et [utiliser l'interface de ligne de commande Azure pour Mac et Linux].</span><span class="sxs-lookup"><span data-stu-id="b0b04-155">Now that you understand how to use Node.js modules with Azure, learn how to [specify the Node.js version], [build and deploy a Node.js web app](app-service-web/app-service-web-get-started-nodejs.md), and [How to use the Azure Command-Line Interface for Mac and Linux].</span></span>

<span data-ttu-id="b0b04-156">Pour plus d’informations, consultez le [Centre pour développeurs Node.js](/nodejs/azure/).</span><span class="sxs-lookup"><span data-stu-id="b0b04-156">For more information, see the [Node.js Developer Center](/nodejs/azure/).</span></span>

<span data-ttu-id="b0b04-157">[spécifier la version de Node.js]: nodejs-specify-node-version-azure-apps.md</span><span class="sxs-lookup"><span data-stu-id="b0b04-157">[specify the Node.js version]: nodejs-specify-node-version-azure-apps.md</span></span>
<span data-ttu-id="b0b04-158">[utiliser l'interface de ligne de commande Azure pour Mac et Linux]:cli-install-nodejs.md</span><span class="sxs-lookup"><span data-stu-id="b0b04-158">[How to use the Azure Command-Line Interface for Mac and Linux]:cli-install-nodejs.md</span></span>
<span data-ttu-id="b0b04-159">[Scripts de déploiement de site Web personnalisés avec Kudu]: https://channel9.msdn.com/Shows/Azure-Friday/Custom-Web-Site-Deployment-Scripts-with-Kudu-with-David-Ebbo</span><span class="sxs-lookup"><span data-stu-id="b0b04-159">[Custom Website Deployment Scripts with Kudu]: https://channel9.msdn.com/Shows/Azure-Friday/Custom-Web-Site-Deployment-Scripts-with-Kudu-with-David-Ebbo</span></span>
