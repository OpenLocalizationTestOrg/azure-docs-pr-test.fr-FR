---
title: "Configurer la stratégie d’autorisation de clé de contenu à l’aide du portail Azure | Microsoft Docs"
description: "Apprenez à configurer une stratégie d’autorisation pour une clé de contenu."
services: media-services
documentationcenter: 
author: juliako
manager: cfowler
editor: 
ms.assetid: ee82a3fa-c34b-48f2-a108-8ba321f1691e
ms.service: media-services
ms.workload: media
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/09/2017
ms.author: juliako
ms.openlocfilehash: 5a35c7255a1c30a693862589c14f6a22a1900790
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/29/2017
---
# <a name="configure-content-key-authorization-policy"></a><span data-ttu-id="3f265-103">Configuration de la stratégie d’autorisation de clé de contenu</span><span class="sxs-lookup"><span data-stu-id="3f265-103">Configure Content Key Authorization Policy</span></span>
[!INCLUDE [media-services-selector-content-key-auth-policy](../../includes/media-services-selector-content-key-auth-policy.md)]

## <a name="overview"></a><span data-ttu-id="3f265-104">Vue d'ensemble</span><span class="sxs-lookup"><span data-stu-id="3f265-104">Overview</span></span>
<span data-ttu-id="3f265-105">Microsoft Azure Media Services vous permet de fournir des flux MPEG-DASH, Smooth Streaming et HLS (HTTP-Live-Streaming) protégés par AES (Advanced Encryption Standard) à l’aide de clés de chiffrement 128 bits ou [Microsoft PlayReady DRM](https://www.microsoft.com/playready/overview/).</span><span class="sxs-lookup"><span data-stu-id="3f265-105">Microsoft Azure Media Services enables you to deliver MPEG-DASH, Smooth Streaming, and HTTP-Live-Streaming (HLS) streams protected with Advanced Encryption Standard (AES) (using 128-bit encryption keys) or [Microsoft PlayReady DRM](https://www.microsoft.com/playready/overview/).</span></span> <span data-ttu-id="3f265-106">AMS vous permet également de diffuser des flux DASH chiffrés avec Widevine DRM.</span><span class="sxs-lookup"><span data-stu-id="3f265-106">AMS also enables you to deliver DASH streams encrypted with Widevine DRM.</span></span> <span data-ttu-id="3f265-107">PlayReady et Widewine sont chiffrés conformément à la spécification de chiffrement commun (ISO/IEC 23001-7 CENC).</span><span class="sxs-lookup"><span data-stu-id="3f265-107">Both PlayReady and Widevine are encrypted per the Common Encryption (ISO/IEC 23001-7 CENC) specification.</span></span>

<span data-ttu-id="3f265-108">Media Services fournit également un **service de remise de clés/de licences** à partir duquel les clients peuvent obtenir des clés AES ou des licences PlayReady/Widevine pour lire le contenu chiffré.</span><span class="sxs-lookup"><span data-stu-id="3f265-108">Media Services also provides a **Key/License Delivery Service** from which clients can obtain AES keys or PlayReady/Widevine licenses to play the encrypted content.</span></span>

<span data-ttu-id="3f265-109">Cette rubrique montre comment utiliser le portail Azure pour configurer la stratégie d’autorisation de clé de contenu.</span><span class="sxs-lookup"><span data-stu-id="3f265-109">This topic shows how to use the Azure portal to configure the content key authorization policy.</span></span> <span data-ttu-id="3f265-110">Elles peuvent ensuite être utilisées pour chiffrer dynamiquement votre contenu.</span><span class="sxs-lookup"><span data-stu-id="3f265-110">The key can later be used to dynamically encrypt your content.</span></span> <span data-ttu-id="3f265-111">Notez que, actuellement, vous pouvez chiffrer les formats de diffusion en continu suivants : HLS, MPEG DASH et Smooth Streaming.</span><span class="sxs-lookup"><span data-stu-id="3f265-111">Note that currently you can encrypt the following streaming formats: HLS, MPEG DASH, and Smooth Streaming.</span></span> <span data-ttu-id="3f265-112">Vous ne pouvez pas chiffrer les téléchargements progressifs.</span><span class="sxs-lookup"><span data-stu-id="3f265-112">You cannot encrypt progressive downloads.</span></span>

<span data-ttu-id="3f265-113">Lorsqu’un lecteur demande un flux de données devant être chiffré dynamiquement, Media Services utilise la clé configurée pour chiffrer dynamiquement votre contenu à l’aide du chiffrement AES ou DRM.</span><span class="sxs-lookup"><span data-stu-id="3f265-113">When a player requests a stream that is set to be dynamically encrypted, Media Services uses the configured key to dynamically encrypt your content using AES or DRM encryption.</span></span> <span data-ttu-id="3f265-114">Pour déchiffrer le flux de données, le lecteur demande la clé au service de remise de clé.</span><span class="sxs-lookup"><span data-stu-id="3f265-114">To decrypt the stream, the player will request the key from the key delivery service.</span></span> <span data-ttu-id="3f265-115">Pour déterminer si l’utilisateur est autorisé à obtenir la clé, le service évalue les stratégies d’autorisation que vous avez spécifiées pour la clé.</span><span class="sxs-lookup"><span data-stu-id="3f265-115">To decide whether or not the user is authorized to get the key, the service evaluates the authorization policies that you specified for the key.</span></span>

<span data-ttu-id="3f265-116">Si vous prévoyez de disposer de plusieurs clés de contenu ou souhaitez spécifier une URL de **service de remise de clés/de licences** autre que le service de remise de clé Media Services, utilisez le Kit de développement logiciel (SDK) .NET Media Services ou des API REST.</span><span class="sxs-lookup"><span data-stu-id="3f265-116">If you plan to have multiple content keys or want to specify a **Key/License Delivery Service** URL other than the Media Services key delivery service, use Media Services .NET SDK or REST APIs.</span></span>

[<span data-ttu-id="3f265-117">Configurer la stratégie d’autorisation de clé de contenu à l’aide du Kit de développement logiciel (SDK).NET Media Services</span><span class="sxs-lookup"><span data-stu-id="3f265-117">Configure Content Key Authorization Policy using Media Services .NET SDK</span></span>](media-services-dotnet-configure-content-key-auth-policy.md)

[<span data-ttu-id="3f265-118">Configurer la stratégie d’autorisation de clé de contenu à l’aide de l’API REST Media Services</span><span class="sxs-lookup"><span data-stu-id="3f265-118">Configure Content Key Authorization Policy using Media Services REST API</span></span>](media-services-rest-configure-content-key-auth-policy.md)

### <a name="some-considerations-apply"></a><span data-ttu-id="3f265-119">Certaines considérations s’appliquent :</span><span class="sxs-lookup"><span data-stu-id="3f265-119">Some considerations apply:</span></span>
* <span data-ttu-id="3f265-120">Une fois votre compte AMS créé, un point de terminaison de streaming **par défaut** est ajouté à votre compte à l’état **Arrêté**.</span><span class="sxs-lookup"><span data-stu-id="3f265-120">When your AMS account is created a **default** streaming endpoint is added  to your account in the **Stopped** state.</span></span> <span data-ttu-id="3f265-121">Pour démarrer la diffusion en continu de votre contenu et tirer parti de l’empaquetage et du chiffrement dynamiques, votre point de terminaison de streaming doit se trouver à l’état **En cours d’exécution**.</span><span class="sxs-lookup"><span data-stu-id="3f265-121">To start streaming your content and take advantage of dynamic packaging and dynamic encryption, your streaming endpoint has to be in the **Running** state.</span></span> 
* <span data-ttu-id="3f265-122">Votre ressource doit contenir un ensemble de MP4 à débit adaptatif ou des fichiers de diffusion en continu lisse à débit adaptatif.</span><span class="sxs-lookup"><span data-stu-id="3f265-122">Your asset must contain a set of adaptive bitrate MP4s or adaptive bitrate Smooth Streaming files.</span></span> <span data-ttu-id="3f265-123">Pour plus d'informations, consultez [Encoder une ressource](media-services-encode-asset.md).</span><span class="sxs-lookup"><span data-stu-id="3f265-123">For more information, see [Encode an asset](media-services-encode-asset.md).</span></span>
* <span data-ttu-id="3f265-124">Le service de remise de clé met en cache ContentKeyAuthorizationPolicy et ses objets connexes (options de stratégie et restrictions) pendant 15 minutes.</span><span class="sxs-lookup"><span data-stu-id="3f265-124">The Key Delivery service caches ContentKeyAuthorizationPolicy and its related objects (policy options and restrictions) for 15 minutes.</span></span>  <span data-ttu-id="3f265-125">Si vous créez une ContentKeyAuthorizationPolicy et que vous spécifiez l’utilisation d’une restriction « Jeton », puis la testez avant de mettre à jour la stratégie de restriction vers « Ouverte », vous devrez attendre environ 15 minutes avant que la stratégie bascule vers la version « Ouverte ».</span><span class="sxs-lookup"><span data-stu-id="3f265-125">If you create a ContentKeyAuthorizationPolicy and specify to use a “Token” restriction, then test it, and then update the policy to “Open” restriction, it will take roughly 15 minutes before the policy switches to the “Open” version of the policy.</span></span>

## <a name="how-to-configure-the-key-authorization-policy"></a><span data-ttu-id="3f265-126">Configuration de la stratégie d’autorisation de clé</span><span class="sxs-lookup"><span data-stu-id="3f265-126">How to: configure the key authorization policy</span></span>
<span data-ttu-id="3f265-127">Pour configurer la stratégie d’autorisation de clé, sélectionnez la page **PROTECTION DU CONTENU** .</span><span class="sxs-lookup"><span data-stu-id="3f265-127">To configure the key authorization policy, select the **CONTENT PROTECTION** page.</span></span>

<span data-ttu-id="3f265-128">Media Services prend en charge plusieurs méthodes d’authentification des utilisateurs effectuant des demandes de clé.</span><span class="sxs-lookup"><span data-stu-id="3f265-128">Media Services supports multiple ways of authenticating users who make key requests.</span></span> <span data-ttu-id="3f265-129">La stratégie d’autorisation de clé de contenu peut disposer de restrictions d’autorisation de type **ouvert**, **jeton** ou **IP** (**l’IP** peut être configurée avec REST ou le Kit de développement logiciel (SDK) .NET).</span><span class="sxs-lookup"><span data-stu-id="3f265-129">The content key authorization policy can have **open**, **token**, or **IP** authorization restrictions (**IP** can be configured with REST or .NET SDK).</span></span>

### <a name="open-restriction"></a><span data-ttu-id="3f265-130">Restriction ouverte</span><span class="sxs-lookup"><span data-stu-id="3f265-130">Open restriction</span></span>
<span data-ttu-id="3f265-131">La restriction **ouverte** signifie que le système fournira la clé à toute personne effectuant une demande de clé.</span><span class="sxs-lookup"><span data-stu-id="3f265-131">The **open** restriction means the system will deliver the key to anyone who makes a key request.</span></span> <span data-ttu-id="3f265-132">Cette restriction peut être utile à des fins de test.</span><span class="sxs-lookup"><span data-stu-id="3f265-132">This restriction might be useful for testing purposes.</span></span>

![OpenPolicy][open_policy]

### <a name="token-restriction"></a><span data-ttu-id="3f265-134">Restriction à jeton</span><span class="sxs-lookup"><span data-stu-id="3f265-134">Token restriction</span></span>
<span data-ttu-id="3f265-135">Pour choisir la stratégie de restriction à jeton, cliquez sur le bouton **JETON** .</span><span class="sxs-lookup"><span data-stu-id="3f265-135">To choose the token restricted policy, press the **TOKEN** button.</span></span>

<span data-ttu-id="3f265-136">La stratégie de restriction à **jeton** doit être accompagnée d’un jeton émis par un **service de jeton sécurisé** (STS).</span><span class="sxs-lookup"><span data-stu-id="3f265-136">The **token** restricted policy must be accompanied by a token issued by a **Secure Token Service** (STS).</span></span> <span data-ttu-id="3f265-137">Media Services prend en charge les jetons aux formats [SWT](https://msdn.microsoft.com/library/gg185950.aspx#BKMK_2) (**Simple Web Tokens**) et JWT (**JSON Web Token**).</span><span class="sxs-lookup"><span data-stu-id="3f265-137">Media Services supports tokens in the **Simple Web Tokens** ([SWT](https://msdn.microsoft.com/library/gg185950.aspx#BKMK_2)) format and **JSON Web Token** (JWT) format.</span></span> <span data-ttu-id="3f265-138">Pour plus d’informations, consultez [Authentification à jeton JWT](http://www.gtrifonov.com/2015/01/03/jwt-token-authentication-in-azure-media-services-and-dynamic-encryption/).</span><span class="sxs-lookup"><span data-stu-id="3f265-138">For information, see [JWT token authentication](http://www.gtrifonov.com/2015/01/03/jwt-token-authentication-in-azure-media-services-and-dynamic-encryption/).</span></span>

<span data-ttu-id="3f265-139">Media Services ne fournit pas de **services de jeton sécurisé**.</span><span class="sxs-lookup"><span data-stu-id="3f265-139">Media Services does not provide **Secure Token Services**.</span></span> <span data-ttu-id="3f265-140">Vous pouvez créer un STS personnalisé ou utiliser l’ACS Microsoft Azure pour émettre des jetons.</span><span class="sxs-lookup"><span data-stu-id="3f265-140">You can create a custom STS or leverage Microsoft Azure ACS to issue tokens.</span></span> <span data-ttu-id="3f265-141">Le STS doit être configuré pour créer un jeton signé avec la clé spécifiée et émettre les revendications spécifiées dans la configuration de restriction de jeton.</span><span class="sxs-lookup"><span data-stu-id="3f265-141">The STS must be configured to create a token signed with the specified key and issue claims that you specified in the token restriction configuration.</span></span> <span data-ttu-id="3f265-142">Le service de remise de clé Media Services retourne la clé de chiffrement pour le client si le jeton est valide et que les revendications du jeton correspondent à celles configurées pour la clé de contenu.</span><span class="sxs-lookup"><span data-stu-id="3f265-142">The Media Services key delivery service will return the encryption key to the client if the token is valid and the claims in the token match those configured for the content key.</span></span> <span data-ttu-id="3f265-143">Pour plus d’informations, consultez [Utilisation de l’ACS Azure pour émettre des jetons](http://mingfeiy.com/acs-with-key-services).</span><span class="sxs-lookup"><span data-stu-id="3f265-143">For more information, see [Use Azure ACS to issue tokens](http://mingfeiy.com/acs-with-key-services).</span></span>

<span data-ttu-id="3f265-144">Lorsque vous configurez la stratégie de restriction **JETON**, vous devez définir des valeurs pour **clé de vérification**, **émetteur** et **public**.</span><span class="sxs-lookup"><span data-stu-id="3f265-144">When configuring the **TOKEN** restricted policy, you must set values for **verification key**, **issuer** and **audience**.</span></span> <span data-ttu-id="3f265-145">La clé de vérification principale contient la clé utilisée pour signer le jeton, l’émetteur est le service de jeton sécurisé qui émet le jeton.</span><span class="sxs-lookup"><span data-stu-id="3f265-145">The primary verification key contains the key that the token was signed with, issuer is the secure token service that issues the token.</span></span> <span data-ttu-id="3f265-146">Le public (parfois appelé l’étendue) décrit l’objectif du jeton ou la ressource à laquelle le jeton autorise l’accès.</span><span class="sxs-lookup"><span data-stu-id="3f265-146">The audience (sometimes called scope) describes the intent of the token or the resource the token authorizes access to.</span></span> <span data-ttu-id="3f265-147">Le service de remise de clé Media Services valide le fait que les valeurs du jeton correspondent aux valeurs du modèle.</span><span class="sxs-lookup"><span data-stu-id="3f265-147">The Media Services key delivery service validates that these values in the token match the values in the template.</span></span>

### <a name="playready"></a><span data-ttu-id="3f265-148">PlayReady</span><span class="sxs-lookup"><span data-stu-id="3f265-148">PlayReady</span></span>
<span data-ttu-id="3f265-149">Quand vous protégez votre contenu avec **PlayReady**, vous devez spécifier dans votre stratégie d'autorisation une chaîne XML qui définisse le modèle de licence PlayReady.</span><span class="sxs-lookup"><span data-stu-id="3f265-149">When protecting your content with **PlayReady**, one of the things you need to specify in your authorization policy is an XML string that defines the PlayReady license template.</span></span> <span data-ttu-id="3f265-150">Par défaut, la stratégie suivante est définie :</span><span class="sxs-lookup"><span data-stu-id="3f265-150">By default, the following policy is set:</span></span>

<span data-ttu-id="3f265-151"><PlayReadyLicenseResponseTemplate xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/Azure/MediaServices/KeyDelivery/PlayReadyTemplate/v1"> <LicenseTemplates> <PlayReadyLicenseTemplate><AllowTestDevices>true</AllowTestDevices> <ContentKey i:type="ContentEncryptionKeyFromHeader" /> <LicenseType>Nonpersistent</LicenseType> <PlayRight> <AllowPassingVideoContentToUnknownOutput>Allowed</AllowPassingVideoContentToUnknownOutput> </PlayRight> </PlayReadyLicenseTemplate> </LicenseTemplates> </PlayReadyLicenseResponseTemplate></span><span class="sxs-lookup"><span data-stu-id="3f265-151"><PlayReadyLicenseResponseTemplate xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/Azure/MediaServices/KeyDelivery/PlayReadyTemplate/v1"> <LicenseTemplates> <PlayReadyLicenseTemplate><AllowTestDevices>true</AllowTestDevices> <ContentKey i:type="ContentEncryptionKeyFromHeader" /> <LicenseType>Nonpersistent</LicenseType> <PlayRight> <AllowPassingVideoContentToUnknownOutput>Allowed</AllowPassingVideoContentToUnknownOutput> </PlayRight> </PlayReadyLicenseTemplate> </LicenseTemplates> </PlayReadyLicenseResponseTemplate></span></span>

<span data-ttu-id="3f265-152">Vous pouvez cliquer sur le bouton **importer le xml de la stratégie** et fournir un autre XML conforme au schéma XML défini [ici](media-services-playready-license-template-overview.md).</span><span class="sxs-lookup"><span data-stu-id="3f265-152">You can click the **import policy xml** button and provide a different XML which conforms to the  XML Schema defined [here](media-services-playready-license-template-overview.md).</span></span>

## <a name="next-step"></a><span data-ttu-id="3f265-153">Étape suivante</span><span class="sxs-lookup"><span data-stu-id="3f265-153">Next step</span></span>
<span data-ttu-id="3f265-154">Consultez les parcours d’apprentissage de Media Services.</span><span class="sxs-lookup"><span data-stu-id="3f265-154">Review Media Services learning paths.</span></span>

[!INCLUDE [media-services-learning-paths-include](../../includes/media-services-learning-paths-include.md)]

## <a name="provide-feedback"></a><span data-ttu-id="3f265-155">Fournir des commentaires</span><span class="sxs-lookup"><span data-stu-id="3f265-155">Provide feedback</span></span>
[!INCLUDE [media-services-user-voice-include](../../includes/media-services-user-voice-include.md)]

[open_policy]: ./media/media-services-portal-configure-content-key-auth-policy/media-services-protect-content-with-open-restriction.png
[token_policy]: ./media/media-services-key-authorization-policy/media-services-protect-content-with-token-restriction.png

