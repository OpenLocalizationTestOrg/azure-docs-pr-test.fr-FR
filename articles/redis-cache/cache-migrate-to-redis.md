---
title: "Migrer les applications du Service de cache géré vers Redis - Azure | Microsoft Docs"
description: "Découvrez comment migrer les applications du Service de cache géré et d’In-Role Cache vers le Cache Redis Azure"
services: redis-cache
documentationcenter: na
author: steved0x
manager: douge
editor: tysonn
ms.assetid: 041f077b-8c8e-4d7c-a3fc-89d334ed70d6
ms.service: cache
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: cache-redis
ms.workload: tbd
ms.date: 05/30/2017
ms.author: sdanie
ms.openlocfilehash: 0fbfb945c66926794721f2ce8cc183dac51ecb27
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/11/2017
---
# <a name="migrate-from-managed-cache-service-to-azure-redis-cache"></a><span data-ttu-id="ce43c-103">Migrer un Service de cache géré vers le Cache Redis Azure</span><span class="sxs-lookup"><span data-stu-id="ce43c-103">Migrate from Managed Cache Service to Azure Redis Cache</span></span>
<span data-ttu-id="ce43c-104">Vous pouvez migrer les applications qui utilisent le Service de cache géré Azure vers le Cache Redis Azure sans modifier outre mesure votre application. Le degré de modification dépend des fonctionnalités du Service de cache géré utilisé par votre application de mise en cache.</span><span class="sxs-lookup"><span data-stu-id="ce43c-104">Migrating your applications that use Azure Managed Cache Service to Azure Redis Cache can be accomplished with minimal changes to your application, depending on the Managed Cache Service features used by your caching application.</span></span> <span data-ttu-id="ce43c-105">Bien que légèrement différentes, les API présentent des similitudes. Vous pouvez ainsi réutiliser, avec un minimum de modifications, une grande partie de votre code existant qui utilise le Service de cache géré pour accéder à un cache.</span><span class="sxs-lookup"><span data-stu-id="ce43c-105">While the APIs are not exactly the same they are similar, and much of your existing code that uses Managed Cache Service to access a cache can be reused with minimal changes.</span></span> <span data-ttu-id="ce43c-106">Cette rubrique montre comment effectuer la configuration requise et modifier les applications pour migrer vos applications de Service de cache géré vers le Cache Redis Azure. Elle explique également comment utiliser certaines fonctionnalités du Cache Redis Azure pour implémenter les fonctionnalités d’un cache du Service de cache géré.</span><span class="sxs-lookup"><span data-stu-id="ce43c-106">This topic shows how to make the necessary configuration and application changes to migrate your Managed Cache Service applications to use Azure Redis Cache, and shows how some of the features of Azure Redis Cache can be used to implement the functionality of a Managed Cache Service cache.</span></span>

>[!NOTE]
><span data-ttu-id="ce43c-107">Le service de cache géré et le In-Role Cache ont été [supprimés](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/) le 30 novembre 2016.</span><span class="sxs-lookup"><span data-stu-id="ce43c-107">Managed Cache Service and In-Role Cache were [retired](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/) November 30, 2016.</span></span> <span data-ttu-id="ce43c-108">Si vous disposez de déploiements pour le In-Role Cache que vous souhaitez faire migrer vers le Cache Redis Azure, vous pouvez suivre les étapes de cet article.</span><span class="sxs-lookup"><span data-stu-id="ce43c-108">If you have any In-Role Cache deployments that you want to migrate to Azure Redis Cache, you can follow the steps in this article.</span></span>

## <a name="migration-steps"></a><span data-ttu-id="ce43c-109">Étapes de la migration</span><span class="sxs-lookup"><span data-stu-id="ce43c-109">Migration Steps</span></span>
<span data-ttu-id="ce43c-110">Vous devez exécuter les étapes suivantes pour migrer une application du Service de cache géré afin d’utiliser le Cache Redis Azure.</span><span class="sxs-lookup"><span data-stu-id="ce43c-110">The following steps are required to migrate a Managed Cache Service application to use Azure Redis Cache.</span></span>

* <span data-ttu-id="ce43c-111">Mappage des fonctionnalités du Service de cache géré au Cache Redis Azure</span><span class="sxs-lookup"><span data-stu-id="ce43c-111">Map Managed Cache Service features to Azure Redis Cache</span></span>
* <span data-ttu-id="ce43c-112">Sélection d’une offre de cache</span><span class="sxs-lookup"><span data-stu-id="ce43c-112">Choose a Cache Offering</span></span>
* <span data-ttu-id="ce43c-113">Création d’un cache</span><span class="sxs-lookup"><span data-stu-id="ce43c-113">Create a Cache</span></span>
* <span data-ttu-id="ce43c-114">Configuration des clients de cache</span><span class="sxs-lookup"><span data-stu-id="ce43c-114">Configure the Cache Clients</span></span>
  * <span data-ttu-id="ce43c-115">Suppression de la configuration du Service de cache géré</span><span class="sxs-lookup"><span data-stu-id="ce43c-115">Remove the Managed Cache Service Configuration</span></span>
  * <span data-ttu-id="ce43c-116">Configuration d’un client de cache à l’aide du package NuGet Package StackExchange.Redis</span><span class="sxs-lookup"><span data-stu-id="ce43c-116">Configure a cache client using the StackExchange.Redis NuGet Package</span></span>
* <span data-ttu-id="ce43c-117">Migration du code du Service de cache géré</span><span class="sxs-lookup"><span data-stu-id="ce43c-117">Migrate Managed Cache Service code</span></span>
  * <span data-ttu-id="ce43c-118">Connexion au cache à l’aide de la classe ConnectionMultiplexer</span><span class="sxs-lookup"><span data-stu-id="ce43c-118">Connect to the cache using the ConnectionMultiplexer class</span></span>
  * <span data-ttu-id="ce43c-119">Accès aux types de données primitifs dans le cache</span><span class="sxs-lookup"><span data-stu-id="ce43c-119">Access primitive data types in the cache</span></span>
  * <span data-ttu-id="ce43c-120">Utilisation des objets .NET dans le cache</span><span class="sxs-lookup"><span data-stu-id="ce43c-120">Work with .NET objects in the cache</span></span>
* <span data-ttu-id="ce43c-121">Migration de l’état de session ASP.NET et des caches de sortie vers le Cache Redis Azure</span><span class="sxs-lookup"><span data-stu-id="ce43c-121">Migrate ASP.NET Session State and Output caching to Azure Redis Cache</span></span> 

## <a name="map-managed-cache-service-features-to-azure-redis-cache"></a><span data-ttu-id="ce43c-122">Mappage des fonctionnalités du Service de cache géré au Cache Redis Azure</span><span class="sxs-lookup"><span data-stu-id="ce43c-122">Map Managed Cache Service features to Azure Redis Cache</span></span>
<span data-ttu-id="ce43c-123">Bien que similaires, le Service de cache géré Azure et le Cache Redis Azure implémentent certaines de leurs fonctionnalités de différentes façons.</span><span class="sxs-lookup"><span data-stu-id="ce43c-123">Azure Managed Cache Service and Azure Redis Cache are similar but implement some of their features in different ways.</span></span> <span data-ttu-id="ce43c-124">Cette section décrit quelques-unes de leurs différences et explique comment implémenter les fonctionnalités du Service de cache géré dans le Cache Redis Azure.</span><span class="sxs-lookup"><span data-stu-id="ce43c-124">This section describes some of the differences and provides guidance on implementing the features of Managed Cache Service in Azure Redis Cache.</span></span>

| <span data-ttu-id="ce43c-125">Fonctionnalité du Service de cache géré</span><span class="sxs-lookup"><span data-stu-id="ce43c-125">Managed Cache Service feature</span></span> | <span data-ttu-id="ce43c-126">Prise en charge du Service de cache géré</span><span class="sxs-lookup"><span data-stu-id="ce43c-126">Managed Cache Service support</span></span> | <span data-ttu-id="ce43c-127">Prise en charge du Cache Redis Azure</span><span class="sxs-lookup"><span data-stu-id="ce43c-127">Azure Redis Cache support</span></span> |
| --- | --- | --- |
| <span data-ttu-id="ce43c-128">Caches nommés</span><span class="sxs-lookup"><span data-stu-id="ce43c-128">Named caches</span></span> |<span data-ttu-id="ce43c-129">Un cache par défaut est configuré et, dans le cache des offres Standard et Premium, vous pouvez, si vous le souhaitez, configurer jusqu’à neuf caches nommés supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="ce43c-129">A default cache is configured, and in the Standard and Premium cache offerings, up to nine additional named caches can be configured if desired.</span></span> |<span data-ttu-id="ce43c-130">Les caches Redis Azure disposent d’un nombre configurable de bases de données (16 par défaut) pouvant être utilisées pour implémenter une fonctionnalité semblable aux caches nommés.</span><span class="sxs-lookup"><span data-stu-id="ce43c-130">Azure Redis caches have a configurable number of databases (default of 16) that can be used to implement a similar functionality to named caches.</span></span> <span data-ttu-id="ce43c-131">Pour plus d’informations, consultez les sections [Que sont les bases de données Redis ?](cache-faq.md#what-are-redis-databases) et [Configuration du serveur Redis par défaut](cache-configure.md#default-redis-server-configuration).</span><span class="sxs-lookup"><span data-stu-id="ce43c-131">For more information, see [What are Redis databases?](cache-faq.md#what-are-redis-databases) and [Default Redis server configuration](cache-configure.md#default-redis-server-configuration).</span></span> |
| <span data-ttu-id="ce43c-132">Haute disponibilité</span><span class="sxs-lookup"><span data-stu-id="ce43c-132">High Availability</span></span> |<span data-ttu-id="ce43c-133">Fournit une haute disponibilité pour les éléments du cache dans le cadre des offres de cache Standard et Premium.</span><span class="sxs-lookup"><span data-stu-id="ce43c-133">Provides high availability for items in the cache in the Standard and Premium cache offerings.</span></span> <span data-ttu-id="ce43c-134">En cas de perte liée à une défaillance, les copies de sauvegarde des éléments du cache demeurent disponibles.</span><span class="sxs-lookup"><span data-stu-id="ce43c-134">If items are lost due to a failure, backup copies of the items in the cache are still available.</span></span> <span data-ttu-id="ce43c-135">Les écritures dans le cache secondaire sont effectuées de façon synchrone.</span><span class="sxs-lookup"><span data-stu-id="ce43c-135">Writes to the secondary cache are made synchronously.</span></span> |<span data-ttu-id="ce43c-136">La fonction de haute disponibilité est incluse dans les offres de cache Standard et Premium, qui reposent sur une configuration à deux nœuds (nœud principal/réplica) où chaque partition d’un cache Premium dispose d’une paire nœud principal/réplica.</span><span class="sxs-lookup"><span data-stu-id="ce43c-136">High availability is available in the Standard and Premium cache offerings, which have a two node Primary/Replica configuration (each shard in a Premium cache has a primary/replica pair).</span></span> <span data-ttu-id="ce43c-137">Les écritures sur le réplica sont effectuées de façon asynchrone.</span><span class="sxs-lookup"><span data-stu-id="ce43c-137">Writes to the replica are made asynchronously.</span></span> <span data-ttu-id="ce43c-138">Pour plus d’informations, consultez [Tarification - Cache Redis Azure](https://azure.microsoft.com/pricing/details/cache/).</span><span class="sxs-lookup"><span data-stu-id="ce43c-138">For more information, see [Azure Redis Cache pricing](https://azure.microsoft.com/pricing/details/cache/).</span></span> |
| <span data-ttu-id="ce43c-139">Notifications</span><span class="sxs-lookup"><span data-stu-id="ce43c-139">Notifications</span></span> |<span data-ttu-id="ce43c-140">Permet aux clients de recevoir des notifications asynchrones lorsque diverses opérations de cache sont exécutées sur un cache nommé.</span><span class="sxs-lookup"><span data-stu-id="ce43c-140">Allows clients to receive asynchronous notifications when a variety of cache operations occur on a named cache.</span></span> |<span data-ttu-id="ce43c-141">Les applications clientes peuvent utiliser Redis pub/sub ou les [notifications de Keyspace](cache-configure.md#keyspace-notifications-advanced-settings) pour obtenir une fonctionnalité similaire aux notifications.</span><span class="sxs-lookup"><span data-stu-id="ce43c-141">Client applications can use Redis pub/sub or [Keyspace notifications](cache-configure.md#keyspace-notifications-advanced-settings) to achieve a similar functionality to notifications.</span></span> |
| <span data-ttu-id="ce43c-142">Cache local</span><span class="sxs-lookup"><span data-stu-id="ce43c-142">Local cache</span></span> |<span data-ttu-id="ce43c-143">Stocke une copie des objets mis en cache en local sur le client pour un accès extrêmement rapide.</span><span class="sxs-lookup"><span data-stu-id="ce43c-143">Stores a copy of cached objects locally on the client for extra-fast access.</span></span> |<span data-ttu-id="ce43c-144">Les applications clientes doivent implémenter cette fonctionnalité à l’aide d’un dictionnaire ou d’une structure de données similaires.</span><span class="sxs-lookup"><span data-stu-id="ce43c-144">Client applications would need to implement this functionality using a dictionary or similar data structure.</span></span> |
| <span data-ttu-id="ce43c-145">Stratégie d’éviction</span><span class="sxs-lookup"><span data-stu-id="ce43c-145">Eviction Policy</span></span> |<span data-ttu-id="ce43c-146">Aucune ou LRU.</span><span class="sxs-lookup"><span data-stu-id="ce43c-146">None or LRU.</span></span> <span data-ttu-id="ce43c-147">La stratégie LRU est utilisée par défaut.</span><span class="sxs-lookup"><span data-stu-id="ce43c-147">The default policy is LRU.</span></span> |<span data-ttu-id="ce43c-148">Le Cache Redis Azure prend en charge les stratégies d’éviction suivante : volatile-lru, allkeys-lru, volatile-random, allkeys-random, volatile-ttl, noeviction.</span><span class="sxs-lookup"><span data-stu-id="ce43c-148">Azure Redis Cache supports the following eviction policies: volatile-lru, allkeys-lru, volatile-random, allkeys-random, volatile-ttl, noeviction.</span></span> <span data-ttu-id="ce43c-149">La stratégie volatile-lru est utilisée par défaut.</span><span class="sxs-lookup"><span data-stu-id="ce43c-149">The default policy is volatile-lru.</span></span> <span data-ttu-id="ce43c-150">Pour plus d’informations, consultez la section [Configuration du serveur Redis par défaut](cache-configure.md#default-redis-server-configuration).</span><span class="sxs-lookup"><span data-stu-id="ce43c-150">For more information, see [Default Redis server configuration](cache-configure.md#default-redis-server-configuration).</span></span> |
| <span data-ttu-id="ce43c-151">Stratégie d’expiration</span><span class="sxs-lookup"><span data-stu-id="ce43c-151">Expiration Policy</span></span> |<span data-ttu-id="ce43c-152">La stratégie d’expiration par défaut est « Absolue » et l’intervalle d’expiration par défaut est de dix minutes.</span><span class="sxs-lookup"><span data-stu-id="ce43c-152">The default expiration policy is Absolute and the default expiration interval is ten minutes.</span></span> <span data-ttu-id="ce43c-153">Les stratégies « Fenêtre coulissante » et « Jamais » sont également disponibles.</span><span class="sxs-lookup"><span data-stu-id="ce43c-153">Sliding and Never policies are also available.</span></span> |<span data-ttu-id="ce43c-154">Par défaut, les éléments du cache n’expirent pas, mais il est possible de configurer un délai d’expiration par écriture en utilisant les surcharges de jeu de cache.</span><span class="sxs-lookup"><span data-stu-id="ce43c-154">By default items in the cache do not expire, but an expiration can be configured on a per write basis using cache set overloads.</span></span> <span data-ttu-id="ce43c-155">Pour plus d’informations, voir [Ajout et récupération d’objets dans le cache](cache-dotnet-how-to-use-azure-redis-cache.md#add-and-retrieve-objects-from-the-cache).</span><span class="sxs-lookup"><span data-stu-id="ce43c-155">For more information, see [Add and retrieve objects from the cache](cache-dotnet-how-to-use-azure-redis-cache.md#add-and-retrieve-objects-from-the-cache).</span></span> |
| <span data-ttu-id="ce43c-156">Régions et balisage</span><span class="sxs-lookup"><span data-stu-id="ce43c-156">Regions and Tagging</span></span> |<span data-ttu-id="ce43c-157">Les régions sont des sous-groupes d’éléments mis en cache.</span><span class="sxs-lookup"><span data-stu-id="ce43c-157">Regions are subgroups for cached items.</span></span> <span data-ttu-id="ce43c-158">Elles prennent également en charge l’annotation des éléments mis en cache avec des chaînes descriptives supplémentaires appelées « balises ».</span><span class="sxs-lookup"><span data-stu-id="ce43c-158">Regions also support the annotation of cached items with additional descriptive strings called tags.</span></span> <span data-ttu-id="ce43c-159">Les régions offrent la possibilité d’effectuer des opérations de recherche sur n’importe quel élément balisé de la région concernée.</span><span class="sxs-lookup"><span data-stu-id="ce43c-159">Regions support the ability to perform search operations on any tagged items in that region.</span></span> <span data-ttu-id="ce43c-160">Tous les éléments d’une région se trouvent dans un seul nœud du cluster de cache.</span><span class="sxs-lookup"><span data-stu-id="ce43c-160">All items within a region are located within a single node of the cache cluster.</span></span> |<span data-ttu-id="ce43c-161">Un Cache Redis se compose d’un seul nœud (à moins que le cluster Redis ne soit activé), ce qui signifie que le concept de régions du Service de Cache géré ne s’applique pas.</span><span class="sxs-lookup"><span data-stu-id="ce43c-161">A Redis cache consists of a single node (unless Redis cluster is enabled) so the concept of Managed Cache Service regions does not apply.</span></span> <span data-ttu-id="ce43c-162">Redis prend en charge la recherche et les opérations génériques lors de la récupération des clés de manière à incorporer des balises descriptives dans les noms de clé dans le but de récupérer les éléments ultérieurement.</span><span class="sxs-lookup"><span data-stu-id="ce43c-162">Redis supports searching and wildcard operations when retrieving keys so descriptive tags can be embedded within the key names and used to retrieve the items later.</span></span> <span data-ttu-id="ce43c-163">Pour obtenir un exemple d’implémentation d’une solution de balisage à l’aide de Redis, voir la page relative à l’ [implémentation de balisage de cache avec Redis](http://stackify.com/implementing-cache-tagging-redis/).</span><span class="sxs-lookup"><span data-stu-id="ce43c-163">For an example of implementing a tagging solution using Redis, see [Implementing cache tagging with Redis](http://stackify.com/implementing-cache-tagging-redis/).</span></span> |
| <span data-ttu-id="ce43c-164">Sérialisation</span><span class="sxs-lookup"><span data-stu-id="ce43c-164">Serialization</span></span> |<span data-ttu-id="ce43c-165">Le Service de cache géré prend en charge NetDataContractSerializer, BinaryFormatter, ainsi que l’utilisation de sérialiseurs personnalisés.</span><span class="sxs-lookup"><span data-stu-id="ce43c-165">Managed Cache supports NetDataContractSerializer, BinaryFormatter, and the use of custom serializers.</span></span> <span data-ttu-id="ce43c-166">La valeur par défaut est NetDataContractSerializer.</span><span class="sxs-lookup"><span data-stu-id="ce43c-166">The default is NetDataContractSerializer.</span></span> |<span data-ttu-id="ce43c-167">L’application cliente doit sérialiser des objets .NET avant de les placer dans le cache ; le choix du sérialiseur appartient en revanche au développeur de l’application cliente.</span><span class="sxs-lookup"><span data-stu-id="ce43c-167">It is the responsibility of the client application to serialize .NET objects before placing them into the cache, with the choice of the serializer up to the client application developer.</span></span> <span data-ttu-id="ce43c-168">Pour plus d’informations et pour obtenir un exemple de code, consultez la section [Utilisation d’objets .NET dans le cache](cache-dotnet-how-to-use-azure-redis-cache.md#work-with-net-objects-in-the-cache).</span><span class="sxs-lookup"><span data-stu-id="ce43c-168">For more information and sample code, see [Work with .NET objects in the cache](cache-dotnet-how-to-use-azure-redis-cache.md#work-with-net-objects-in-the-cache).</span></span> |
| <span data-ttu-id="ce43c-169">Émulateur de cache</span><span class="sxs-lookup"><span data-stu-id="ce43c-169">Cache emulator</span></span> |<span data-ttu-id="ce43c-170">Le cache géré fournit un émulateur de cache local.</span><span class="sxs-lookup"><span data-stu-id="ce43c-170">Managed Cache provides a local cache emulator.</span></span> |<span data-ttu-id="ce43c-171">Le Cache Redis Azure n’a pas d’émulateur, mais vous pouvez [exécuter la génération MSOpenTech de redis-server.exe localement](cache-faq.md#cache-emulator) pour offrir une expérience d’émulateur.</span><span class="sxs-lookup"><span data-stu-id="ce43c-171">Azure Redis Cache does not have an emulator, but you can [run the MSOpenTech build of redis-server.exe locally](cache-faq.md#cache-emulator) to provide an emulator experience.</span></span> |

## <a name="choose-a-cache-offering"></a><span data-ttu-id="ce43c-172">Sélection d’une offre de cache</span><span class="sxs-lookup"><span data-stu-id="ce43c-172">Choose a Cache Offering</span></span>
<span data-ttu-id="ce43c-173">Cache Redis Microsoft Azure est disponible dans les niveaux suivants :</span><span class="sxs-lookup"><span data-stu-id="ce43c-173">Microsoft Azure Redis Cache is available in the following tiers:</span></span>

* <span data-ttu-id="ce43c-174">**De base** , avec un seul nœud.</span><span class="sxs-lookup"><span data-stu-id="ce43c-174">**Basic** – Single node.</span></span> <span data-ttu-id="ce43c-175">Plusieurs tailles jusqu'à 53 Go.</span><span class="sxs-lookup"><span data-stu-id="ce43c-175">Multiple sizes up to 53 GB.</span></span>
* <span data-ttu-id="ce43c-176">**Standard** : avec deux nœuds, principal et réplica.</span><span class="sxs-lookup"><span data-stu-id="ce43c-176">**Standard** – Two-node Primary/Replica.</span></span> <span data-ttu-id="ce43c-177">Plusieurs tailles jusqu'à 53 Go.</span><span class="sxs-lookup"><span data-stu-id="ce43c-177">Multiple sizes up to 53 GB.</span></span> <span data-ttu-id="ce43c-178">Un contrat SLA de 99,9 %.</span><span class="sxs-lookup"><span data-stu-id="ce43c-178">99.9% SLA.</span></span>
* <span data-ttu-id="ce43c-179">**Premium** - Deux nœuds (principal / réplica) contenant jusqu’à 10 partitions.</span><span class="sxs-lookup"><span data-stu-id="ce43c-179">**Premium** – Two-node Primary/Replica with up to 10 shards.</span></span> <span data-ttu-id="ce43c-180">Plusieurs tailles de 6 Go à 530 Go.</span><span class="sxs-lookup"><span data-stu-id="ce43c-180">Multiple sizes from 6 GB to 530 GB.</span></span> <span data-ttu-id="ce43c-181">Toutes les fonctionnalités du niveau Standard et d’autres, y compris la prise en charge du [cluster Redis](cache-how-to-premium-clustering.md), la [persistance Redis](cache-how-to-premium-persistence.md) et le [réseau virtuel Azure](cache-how-to-premium-vnet.md).</span><span class="sxs-lookup"><span data-stu-id="ce43c-181">All Standard tier features and more including support for [Redis cluster](cache-how-to-premium-clustering.md), [Redis persistence](cache-how-to-premium-persistence.md), and [Azure Virtual Network](cache-how-to-premium-vnet.md).</span></span> <span data-ttu-id="ce43c-182">Un contrat SLA de 99,9 %.</span><span class="sxs-lookup"><span data-stu-id="ce43c-182">99.9% SLA.</span></span>

<span data-ttu-id="ce43c-183">Chaque option diffère en termes de fonctionnalités et de tarification.</span><span class="sxs-lookup"><span data-stu-id="ce43c-183">Each tier differs in terms of features and pricing.</span></span> <span data-ttu-id="ce43c-184">Les fonctionnalités sont décrites plus loin dans ce guide ; pour plus d'informations sur la tarification, consultez la page [Tarification - Cache](https://azure.microsoft.com/pricing/details/cache/).</span><span class="sxs-lookup"><span data-stu-id="ce43c-184">The features are covered later in this guide, and for more information on pricing, see [Cache Pricing Details](https://azure.microsoft.com/pricing/details/cache/).</span></span>

<span data-ttu-id="ce43c-185">L’idéal pour commencer la migration consiste à sélectionner une taille correspondant à celle de votre ancien cache de Service de cache géré, puis à l’adapter en fonction des exigences de votre application.</span><span class="sxs-lookup"><span data-stu-id="ce43c-185">A starting point for migration is to pick the size that matches the size of your previous Managed Cache Service cache, and then scale up or down depending on the requirements of your application.</span></span> <span data-ttu-id="ce43c-186">Pour obtenir des recommandations sur le choix de l’offre Cache Redis Azure adaptée à vos besoins, consultez la section [Que propose Cache Redis et quelle taille dois-je utiliser ?](cache-faq.md#what-redis-cache-offering-and-size-should-i-use).</span><span class="sxs-lookup"><span data-stu-id="ce43c-186">For more guidance on choosing the right Azure Redis Cache offering, see [What Redis Cache offering and size should I use?](cache-faq.md#what-redis-cache-offering-and-size-should-i-use).</span></span>

## <a name="create-a-cache"></a><span data-ttu-id="ce43c-187">Création d’un cache</span><span class="sxs-lookup"><span data-stu-id="ce43c-187">Create a Cache</span></span>
[!INCLUDE [redis-cache-create](../../includes/redis-cache-create.md)]

## <a name="configure-the-cache-clients"></a><span data-ttu-id="ce43c-188">Configuration des clients de cache</span><span class="sxs-lookup"><span data-stu-id="ce43c-188">Configure the Cache Clients</span></span>
<span data-ttu-id="ce43c-189">Une fois le cache créé et configuré, vous devez supprimer la configuration du Service de cache géré, puis ajouter la configuration et les références du Cache Redis Azure afin que les clients de cache puissent accéder au cache.</span><span class="sxs-lookup"><span data-stu-id="ce43c-189">Once the cache is created and configured, the next step is to remove the Managed Cache Service configuration, and add the add the Azure Redis Cache configuration and references so that cache clients can access the cache.</span></span>

* <span data-ttu-id="ce43c-190">Suppression de la configuration du Service de cache géré</span><span class="sxs-lookup"><span data-stu-id="ce43c-190">Remove the Managed Cache Service Configuration</span></span>
* <span data-ttu-id="ce43c-191">Configuration d’un client de cache à l’aide du package NuGet Package StackExchange.Redis</span><span class="sxs-lookup"><span data-stu-id="ce43c-191">Configure a cache client using the StackExchange.Redis NuGet Package</span></span>

### <a name="remove-the-managed-cache-service-configuration"></a><span data-ttu-id="ce43c-192">Suppression de la configuration du Service de cache géré</span><span class="sxs-lookup"><span data-stu-id="ce43c-192">Remove the Managed Cache Service Configuration</span></span>
<span data-ttu-id="ce43c-193">Pour pouvoir configurer les applications clientes pour le Cache Redis Azure, vous devez au préalable supprimer la configuration et les références d’assembly existantes du Service de cache géré en désinstallant le package NuGet du Service de cache géré.</span><span class="sxs-lookup"><span data-stu-id="ce43c-193">Before the client applications can be configured for Azure Redis Cache, the existing Managed Cache Service configuration and assembly references must be removed by uninstalling the Managed Cache Service NuGet package.</span></span>

<span data-ttu-id="ce43c-194">Pour désinstaller ce package, cliquez avec le bouton droit sur le projet client dans l’**Explorateur de solutions** et choisissez **Gérer les packages NuGet**.</span><span class="sxs-lookup"><span data-stu-id="ce43c-194">To uninstall the Managed Cache Service NuGet package, right-click the client project in **Solution Explorer** and choose **Manage NuGet Packages**.</span></span> <span data-ttu-id="ce43c-195">Sélectionnez le nœud **Packages installés**, puis entrez W**indowsAzure.Caching** dans la zone de recherche des packages installés.</span><span class="sxs-lookup"><span data-stu-id="ce43c-195">Select the **Installed packages** node, and type W**indowsAzure.Caching** into the Search installed packages box.</span></span> <span data-ttu-id="ce43c-196">Sélectionnez **Cache**  **Microsoft Azure** (ou **Mise en cache** **Microsoft Azure** en fonction de la version du package NuGet), cliquez sur **Désinstaller**, puis sur **Fermer**.</span><span class="sxs-lookup"><span data-stu-id="ce43c-196">Select **Windows** **Azure Cache** (or **Windows** **Azure Caching** depending on the version of the NuGet package), click **Uninstall**, and then click **Close**.</span></span>

![Désinstaller le package NuGet du Service de cache géré Azure](./media/cache-migrate-to-redis/IC757666.jpg)

<span data-ttu-id="ce43c-198">La désinstallation du package NuGet du Service de cache géré a pour effet de supprimer les assemblys du Service de cache géré ainsi que les entrées du Service de cache géré dans le fichier app.config ou web.config de l’application cliente.</span><span class="sxs-lookup"><span data-stu-id="ce43c-198">Uninstalling the Managed Cache Service NuGet package removes the Managed Cache Service assemblies and the Managed Cache Service entries in the app.config or web.config of the client application.</span></span> <span data-ttu-id="ce43c-199">Certains paramètres personnalisés ne peuvent pas être supprimés lors de la désinstallation du package NuGet : vous devez donc ouvrir web.config ou app.config et vérifier les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="ce43c-199">Because some customized settings may not be removed when uninstalling the NuGet package, open web.config or app.config and ensure that the following elements are completely removed.</span></span>

<span data-ttu-id="ce43c-200">Assurez-vous que l’entrée `dataCacheClients` est supprimée de l’élément `configSections`.</span><span class="sxs-lookup"><span data-stu-id="ce43c-200">Ensure that the `dataCacheClients` entry is removed from the `configSections` element.</span></span> <span data-ttu-id="ce43c-201">Ne supprimez pas l’intégralité de l’élément `configSections` ; supprimez simplement l’entrée `dataCacheClients`, le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="ce43c-201">Do not remove the entire `configSections` element; just remove the `dataCacheClients` entry, if it is present.</span></span>

```xml
<configSections>
  <!-- Existing sections omitted for clarity. -->
  <section name="dataCacheClients"type="Microsoft.ApplicationServer.Caching.DataCacheClientsSection, Microsoft.ApplicationServer.Caching.Core" allowLocation="true" allowDefinition="Everywhere"/>
</configSections>
```

<span data-ttu-id="ce43c-202">Vérifiez que la section `dataCacheClients` est supprimée.</span><span class="sxs-lookup"><span data-stu-id="ce43c-202">Ensure that the `dataCacheClients` section is removed.</span></span> <span data-ttu-id="ce43c-203">La section `dataCacheClients` doit avoir un aspect proche de l’exemple ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="ce43c-203">The `dataCacheClients` section will be similar to the following example.</span></span>

```xml
<dataCacheClients>
  <dataCacheClientname="default">
    <!--To use the in-role flavor of Azure Cache, set identifier to be the cache cluster role name -->
    <!--To use the Azure Managed Cache Service, set identifier to be the endpoint of the cache cluster -->
    <autoDiscoverisEnabled="true"identifier="[Cache role name or Service Endpoint]"/>

    <!--<localCache isEnabled="true" sync="TimeoutBased" objectCount="100000" ttlValue="300" />-->
    <!--Use this section to specify security settings for connecting to your cache. This section is not required if your cache is hosted on a role that is a part of your cloud service. -->
    <!--<securityProperties mode="Message" sslEnabled="true">
      <messageSecurity authorizationInfo="[Authentication Key]" />
    </securityProperties>-->
  </dataCacheClient>
</dataCacheClients>
```

<span data-ttu-id="ce43c-204">Une fois que vous avez supprimé la configuration du Service de cache géré, vous pouvez configurer le client de cache comme indiqué dans la section suivante.</span><span class="sxs-lookup"><span data-stu-id="ce43c-204">Once the Managed Cache Service configuration is removed, you can configure the cache client as described in the following section.</span></span>

### <a name="configure-a-cache-client-using-the-stackexchangeredis-nuget-package"></a><span data-ttu-id="ce43c-205">Configuration d’un client de cache à l’aide du package NuGet Package StackExchange.Redis</span><span class="sxs-lookup"><span data-stu-id="ce43c-205">Configure a cache client using the StackExchange.Redis NuGet Package</span></span>
[!INCLUDE [redis-cache-configure](../../includes/redis-cache-configure-stackexchange-redis-nuget.md)]

## <a name="migrate-managed-cache-service-code"></a><span data-ttu-id="ce43c-206">Migration du code du Service de cache géré</span><span class="sxs-lookup"><span data-stu-id="ce43c-206">Migrate Managed Cache Service code</span></span>
<span data-ttu-id="ce43c-207">L’API pour le client de cache StackExchange.Redis est similaire au Service de cache géré.</span><span class="sxs-lookup"><span data-stu-id="ce43c-207">The API for the StackExchange.Redis cache client is similar to the Managed Cache Service.</span></span> <span data-ttu-id="ce43c-208">Cette section en décrit les différences.</span><span class="sxs-lookup"><span data-stu-id="ce43c-208">This section provides an overview of the differences.</span></span>

### <a name="connect-to-the-cache-using-the-connectionmultiplexer-class"></a><span data-ttu-id="ce43c-209">Connexion au cache à l’aide de la classe ConnectionMultiplexer</span><span class="sxs-lookup"><span data-stu-id="ce43c-209">Connect to the cache using the ConnectionMultiplexer class</span></span>
<span data-ttu-id="ce43c-210">Dans le Service de cache géré, les connexions au cache étaient gérées par les classes `DataCacheFactory` et `DataCache`.</span><span class="sxs-lookup"><span data-stu-id="ce43c-210">In Managed Cache Service, connections to the cache were handled by the `DataCacheFactory` and `DataCache` classes.</span></span> <span data-ttu-id="ce43c-211">Dans le Cache Redis Azure, ces connexions sont gérées par la classe `ConnectionMultiplexer` .</span><span class="sxs-lookup"><span data-stu-id="ce43c-211">In Azure Redis Cache, these connections are managed by the `ConnectionMultiplexer` class.</span></span>

<span data-ttu-id="ce43c-212">Ajoutez la déclaration suivante au début de chaque fichier à partir duquel vous souhaitez accéder au cache.</span><span class="sxs-lookup"><span data-stu-id="ce43c-212">Add the following using statement to the top of any file from which you want to access the cache.</span></span>

```c#
using StackExchange.Redis
```

<span data-ttu-id="ce43c-213">Si cet espace de noms ne se résout pas, vérifiez que vous avez bien ajouté le package NuGet StackExchange.Redis comme décrit dans la section [Configuration des clients de cache](cache-dotnet-how-to-use-azure-redis-cache.md#configure-the-cache-clients).</span><span class="sxs-lookup"><span data-stu-id="ce43c-213">If this namespace doesn’t resolve, be sure that you have added the StackExchange.Redis NuGet package as described in [Configure the cache clients](cache-dotnet-how-to-use-azure-redis-cache.md#configure-the-cache-clients).</span></span>

> [!NOTE]
> <span data-ttu-id="ce43c-214">Notez que le client StackExchange.Redis requiert l’installation de .NET Framework version 4 ou ultérieure.</span><span class="sxs-lookup"><span data-stu-id="ce43c-214">Note that the StackExchange.Redis client requires .NET Framework 4 or higher.</span></span>
> 
> 

<span data-ttu-id="ce43c-215">Pour vous connecter à une instance de Cache Redis Azure, appelez la méthode statique `ConnectionMultiplexer.Connect` et passez le point de terminaison et la clé.</span><span class="sxs-lookup"><span data-stu-id="ce43c-215">To connect to an Azure Redis Cache instance, call the static `ConnectionMultiplexer.Connect` method and pass in the endpoint and key.</span></span> <span data-ttu-id="ce43c-216">Pour partager une instance `ConnectionMultiplexer` dans votre application, vous pouvez utiliser une propriété statique qui renvoie une instance connectée, comme dans l’exemple suivant.</span><span class="sxs-lookup"><span data-stu-id="ce43c-216">One approach to sharing a `ConnectionMultiplexer` instance in your application is to have a static property that returns a connected instance, similar to the following example.</span></span> <span data-ttu-id="ce43c-217">Cela fournit une méthode thread-safe permettant d’initialiser une seule instance `ConnectionMultiplexer` connectée.</span><span class="sxs-lookup"><span data-stu-id="ce43c-217">This provides a thread-safe way to initialize only a single connected `ConnectionMultiplexer` instance.</span></span> <span data-ttu-id="ce43c-218">Dans cet exemple, `abortConnect` est défini sur false, ce qui signifie que l’appel réussira même si aucune connexion au cache n’est établie.</span><span class="sxs-lookup"><span data-stu-id="ce43c-218">In this example `abortConnect` is set to false, which means that the call will succeed even if a connection to the cache is not established.</span></span> <span data-ttu-id="ce43c-219">Une fonctionnalité clé de `ConnectionMultiplexer` est qu’il restaure automatiquement la connectivité au cache une fois que le problème réseau ou d’autres causes sont résolus.</span><span class="sxs-lookup"><span data-stu-id="ce43c-219">One key feature of `ConnectionMultiplexer` is that it will automatically restore connectivity to the cache once the network issue or other causes are resolved.</span></span>

```c#
private static Lazy<ConnectionMultiplexer> lazyConnection = new Lazy<ConnectionMultiplexer>(() =>
{
    return ConnectionMultiplexer.Connect("contoso5.redis.cache.windows.net,abortConnect=false,ssl=true,password=...");
});

public static ConnectionMultiplexer Connection
{
    get
    {
        return lazyConnection.Value;
    }
}
```

<span data-ttu-id="ce43c-220">Le point de terminaison, les clés et les ports du cache peuvent être obtenus dans le panneau **Cache Redis** de votre instance de cache.</span><span class="sxs-lookup"><span data-stu-id="ce43c-220">The cache endpoint, keys, and ports can be obtained from the **Redis Cache** blade for your cache instance.</span></span> <span data-ttu-id="ce43c-221">Pour plus d’informations, consultez les [propriétés du Cache Redis](cache-configure.md#properties).</span><span class="sxs-lookup"><span data-stu-id="ce43c-221">For more information, see [Redis Cache properties](cache-configure.md#properties).</span></span>

<span data-ttu-id="ce43c-222">Une fois la connexion établie, renvoyez une référence à la base de données du Cache Redis en appelant la méthode `ConnectionMultiplexer.GetDatabase` .</span><span class="sxs-lookup"><span data-stu-id="ce43c-222">Once the connection is established, return a reference to the Redis cache database by calling the `ConnectionMultiplexer.GetDatabase` method.</span></span> <span data-ttu-id="ce43c-223">L’objet renvoyé à partir de la méthode `GetDatabase` est un objet direct léger qui n’a pas besoin d’être stocké.</span><span class="sxs-lookup"><span data-stu-id="ce43c-223">The object returned from the `GetDatabase` method is a lightweight pass-through object and does not need to be stored.</span></span>

```c#
IDatabase cache = Connection.GetDatabase();

// Perform cache operations using the cache object...
// Simple put of integral data types into the cache
cache.StringSet("key1", "value");
cache.StringSet("key2", 25);

// Simple get of data types from the cache
string key1 = cache.StringGet("key1");
int key2 = (int)cache.StringGet("key2");
```

<span data-ttu-id="ce43c-224">Le client StackExchange.Redis utilise les types `RedisKey` et `RedisValue` pour accéder aux éléments et les stocker dans le cache.</span><span class="sxs-lookup"><span data-stu-id="ce43c-224">The StackExchange.Redis client uses the `RedisKey` and `RedisValue` types for accessing and storing items in the cache.</span></span> <span data-ttu-id="ce43c-225">Ces types correspondent aux types de langages les plus primitifs, y compris les chaînes, et sont rarement utilisés directement.</span><span class="sxs-lookup"><span data-stu-id="ce43c-225">These types map onto most primitive language types, including string, and often are not used directly.</span></span> <span data-ttu-id="ce43c-226">Les chaînes Redis représentent le type de valeur Redis le plus élémentaire et peuvent contenir de nombreux types de données, notamment des flux de données binaires sérialisés. Bien que vous ne puissiez pas utiliser directement le type, vous utiliserez des méthodes contenant la propriété `String` dans le nom.</span><span class="sxs-lookup"><span data-stu-id="ce43c-226">Redis Strings are the most basic kind of Redis value, and can contain many types of data, including serialized binary streams, and while you may not use the type directly, you will use methods that contain `String` in the name.</span></span> <span data-ttu-id="ce43c-227">Pour les types de données les plus primitifs, vous devez stocker et récupérer les éléments du cache à l’aide des méthodes `StringSet` et `StringGet`, sauf si vous stockez des collections ou d’autres types de données Redis dans le cache.</span><span class="sxs-lookup"><span data-stu-id="ce43c-227">For most primitive data types you store and retrieve items from the cache using the `StringSet` and `StringGet` methods, unless you are storing collections or other Redis data types in the cache.</span></span> 

<span data-ttu-id="ce43c-228">`StringSet` et `StringGet` sont très similaires aux méthodes `Put` et `Get` du Service de cache géré. Leur principale différence réside dans le fait que vous devez sérialiser un objet .NET avant de le définir et de le mettre en cache.</span><span class="sxs-lookup"><span data-stu-id="ce43c-228">`StringSet` and `StringGet` are very similar to the Managed Cache Service `Put` and `Get` methods, with one major difference being that before you set and get a .NET object into the cache you must serialize it first.</span></span> 

<span data-ttu-id="ce43c-229">Lors de l’appel de `StringGet`, si l’objet existe, il est renvoyé ; sinon, la valeur Null est renvoyée.</span><span class="sxs-lookup"><span data-stu-id="ce43c-229">When calling `StringGet`, if the object exists, it is returned, and if it does not, null is returned.</span></span> <span data-ttu-id="ce43c-230">Dans ce cas, vous pouvez extraire la valeur de la source de données de votre choix et la stocker dans le cache pour un usage ultérieur.</span><span class="sxs-lookup"><span data-stu-id="ce43c-230">In this case you can retrieve the value from the desired data source and store it in the cache for subsequent use.</span></span> <span data-ttu-id="ce43c-231">On parle alors de modèle de type cache-aside.</span><span class="sxs-lookup"><span data-stu-id="ce43c-231">This is known as the cache-aside pattern.</span></span>

<span data-ttu-id="ce43c-232">Pour spécifier l’expiration d’un élément du cache, utilisez le paramètre `TimeSpan` de `StringSet`.</span><span class="sxs-lookup"><span data-stu-id="ce43c-232">To specify the expiration of an item in the cache, use the `TimeSpan` parameter of `StringSet`.</span></span>

```c#
cache.StringSet("key1", "value1", TimeSpan.FromMinutes(90));
```

<span data-ttu-id="ce43c-233">Le Cache Redis Azure est compatible aussi bien avec les objets .NET qu’avec les types de données primitifs, mais avant qu’un objet .NET puisse être mis en cache, il doit être sérialisé.</span><span class="sxs-lookup"><span data-stu-id="ce43c-233">Azure Redis Cache can work with .NET objects as well as primitive data types, but before a .NET object can be cached it must be serialized.</span></span> <span data-ttu-id="ce43c-234">Cette tâche incombe au développeur de l’application,</span><span class="sxs-lookup"><span data-stu-id="ce43c-234">This is the responsibility of the application developer.</span></span> <span data-ttu-id="ce43c-235">ce qui lui permet de choisir librement son sérialiseur.</span><span class="sxs-lookup"><span data-stu-id="ce43c-235">This gives the developer flexibility in the choice of the serializer.</span></span> <span data-ttu-id="ce43c-236">Pour plus d’informations et pour obtenir un exemple de code, consultez la section [Utilisation d’objets .NET dans le cache](cache-dotnet-how-to-use-azure-redis-cache.md#work-with-net-objects-in-the-cache).</span><span class="sxs-lookup"><span data-stu-id="ce43c-236">For more information and sample code, see [Work with .NET objects in the cache](cache-dotnet-how-to-use-azure-redis-cache.md#work-with-net-objects-in-the-cache).</span></span>

## <a name="migrate-aspnet-session-state-and-output-caching-to-azure-redis-cache"></a><span data-ttu-id="ce43c-237">Migration de l’état de session ASP.NET et des caches de sortie vers le Cache Redis Azure</span><span class="sxs-lookup"><span data-stu-id="ce43c-237">Migrate ASP.NET Session State and Output caching to Azure Redis Cache</span></span>
<span data-ttu-id="ce43c-238">Le Cache Redis Azure dispose de fournisseurs pour l’état de session ASP.NET et pour la mise en cache de sortie de pages.</span><span class="sxs-lookup"><span data-stu-id="ce43c-238">Azure Redis Cache has providers for both ASP.NET Session State and Page Output caching.</span></span> <span data-ttu-id="ce43c-239">Pour migrer une application qui utilise les versions du Service de cache géré de ces fournisseurs, vous devez d’abord supprimer les sections de votre fichier web.config avant de configurer les versions Cache Redis Azure des fournisseurs.</span><span class="sxs-lookup"><span data-stu-id="ce43c-239">To migrate your application that uses the Managed Cache Service versions of these providers, first remove the existing sections from your web.config, and then configure the Azure Redis Cache versions of the providers.</span></span> <span data-ttu-id="ce43c-240">Pour obtenir des instructions sur l’utilisation des fournisseurs ASP.NET du Cache Redis Azure, consultez [Fournisseur d’état de session ASP.NET pour le Cache Redis Azure](cache-aspnet-session-state-provider.md) et [Fournisseur de caches de sortie ASP.NET pour le Cache Redis Azure](cache-aspnet-output-cache-provider.md).</span><span class="sxs-lookup"><span data-stu-id="ce43c-240">For instructions on using the Azure Redis Cache ASP.NET providers, see [ASP.NET Session State Provider for Azure Redis Cache](cache-aspnet-session-state-provider.md) and [ASP.NET Output Cache Provider for Azure Redis Cache](cache-aspnet-output-cache-provider.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="ce43c-241">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="ce43c-241">Next steps</span></span>
<span data-ttu-id="ce43c-242">Explorez la [documentation du Cache Redis Azure](https://azure.microsoft.com/documentation/services/cache/) pour accéder à des didacticiels, des exemples, des vidéos et de nombreuses autres ressources.</span><span class="sxs-lookup"><span data-stu-id="ce43c-242">Explore the [Azure Redis Cache documentation](https://azure.microsoft.com/documentation/services/cache/) for tutorials, samples, videos, and more.</span></span>

