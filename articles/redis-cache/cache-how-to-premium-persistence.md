---
title: "persistance des données aaaHow tooconfigure Premium Azure Redis cache"
description: "Découvrez comment tooconfigure et gérer persistance des données de vos instances de Cache Redis Azure de niveau Premium"
services: redis-cache
documentationcenter: 
author: steved0x
manager: douge
editor: 
ms.assetid: b01cf279-60a0-4711-8c5f-af22d9540d38
ms.service: cache
ms.workload: tbd
ms.tgt_pltfrm: cache-redis
ms.devlang: na
ms.topic: article
ms.date: 08/24/2017
ms.author: sdanie
ms.openlocfilehash: 62feb6f5522e0270487f045eb303bf852434143d
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="how-tooconfigure-data-persistence-for-a-premium-azure-redis-cache"></a><span data-ttu-id="57733-103">La persistance des données tooconfigure Premium Azure Redis cache</span><span class="sxs-lookup"><span data-stu-id="57733-103">How tooconfigure data persistence for a Premium Azure Redis Cache</span></span>
<span data-ttu-id="57733-104">Cache Redis Azure a différentes offres de cache qui fournissent une certaine flexibilité hello les choix de la taille du cache et de fonctionnalités, y compris les fonctionnalités de niveau Premium telles que le clustering, la persistance et la prise en charge du réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="57733-104">Azure Redis Cache has different cache offerings which provide flexibility in hello choice of cache size and features, including Premium tier features such as clustering, persistence, and virtual network support.</span></span> <span data-ttu-id="57733-105">Cet article décrit comment persistance tooconfigure dans une prime Cache Redis Azure instance.</span><span class="sxs-lookup"><span data-stu-id="57733-105">This article describes how tooconfigure persistence in a premium Azure Redis Cache instance.</span></span>

<span data-ttu-id="57733-106">Pour plus d’informations sur d’autres fonctionnalités de cache premium, consultez [couche de présentation toohello Azure Redis Cache Premium](cache-premium-tier-intro.md).</span><span class="sxs-lookup"><span data-stu-id="57733-106">For information on other premium cache features, see [Introduction toohello Azure Redis Cache Premium tier](cache-premium-tier-intro.md).</span></span>

## <a name="what-is-data-persistence"></a><span data-ttu-id="57733-107">Qu’est-ce que la persistance des données ?</span><span class="sxs-lookup"><span data-stu-id="57733-107">What is data persistence?</span></span>
<span data-ttu-id="57733-108">[Persistance de redis](https://redis.io/topics/persistence) vous permet de toopersist les données stockées dans Redis.</span><span class="sxs-lookup"><span data-stu-id="57733-108">[Redis persistence](https://redis.io/topics/persistence) allows you toopersist data stored in Redis.</span></span> <span data-ttu-id="57733-109">Vous pouvez également effectuer des captures instantanées et sauvegarder les données hello, que vous pouvez charger en cas de défaillance matérielle.</span><span class="sxs-lookup"><span data-stu-id="57733-109">You can also take snapshots and back up hello data, which you can load in case of a hardware failure.</span></span> <span data-ttu-id="57733-110">Il s’agit d’un énorme avantage par rapport Basic ou niveau Standard où tous les hello les données est stockée en mémoire et il peut y avoir de perdre des données en cas de défaillance dans lequel les nœuds de Cache sont arrêtés.</span><span class="sxs-lookup"><span data-stu-id="57733-110">This is a huge advantage over Basic or Standard tier where all hello data is stored in memory and there can be potential data loss in case of a failure where Cache nodes are down.</span></span> 

<span data-ttu-id="57733-111">Cache Redis Azure offre la persistance de Redis à l’aide de hello suivant de modèles :</span><span class="sxs-lookup"><span data-stu-id="57733-111">Azure Redis Cache offers Redis persistence using hello following models:</span></span>

* <span data-ttu-id="57733-112">**Persistance de RDB** -persistance de RDB lorsque (base de données Redis) est configuré, le Cache Redis Azure persiste un instantané du cache Redis de hello dans un format binaire toodisk selon une fréquence de sauvegarde peut être configurée de Redis.</span><span class="sxs-lookup"><span data-stu-id="57733-112">**RDB persistence** - When RDB (Redis database) persistence is configured, Azure Redis Cache persists a snapshot of hello Redis cache in a Redis binary format toodisk based on a configurable backup frequency.</span></span> <span data-ttu-id="57733-113">Si un événement catastrophique désactive hello principal et cache de réplica se produit, le cache de hello est reconstruit à l’aide d’instantané le plus récent hello.</span><span class="sxs-lookup"><span data-stu-id="57733-113">If a catastrophic event occurs that disables both hello primary and replica cache, hello cache is reconstructed using hello most recent snapshot.</span></span> <span data-ttu-id="57733-114">En savoir plus sur hello [avantages](https://redis.io/topics/persistence#rdb-advantages) et [inconvénients](https://redis.io/topics/persistence#rdb-disadvantages) de persistance de RDB.</span><span class="sxs-lookup"><span data-stu-id="57733-114">Learn more about hello [advantages](https://redis.io/topics/persistence#rdb-advantages) and [disadvantages](https://redis.io/topics/persistence#rdb-disadvantages) of RDB persistence.</span></span>
* <span data-ttu-id="57733-115">**Persistance d’UNEDE** -persistance d’UNEDE lorsque (ajouter un seul fichier) est configuré, le Cache Redis Azure enregistre chaque journal de tooa écriture opération qui est enregistré au moins une fois par seconde à un compte de stockage Azure.</span><span class="sxs-lookup"><span data-stu-id="57733-115">**AOF persistence** - When AOF (Append only file) persistence is configured, Azure Redis Cache saves every write operation tooa log that is saved at least once per second into an Azure Storage account.</span></span> <span data-ttu-id="57733-116">Si un événement catastrophique désactive hello principal et cache de réplica se produit, le cache de hello est reconstruit à l’aide d’opérations d’écriture stockée hello.</span><span class="sxs-lookup"><span data-stu-id="57733-116">If a catastrophic event occurs that disables both hello primary and replica cache, hello cache is reconstructed using hello stored write operations.</span></span> <span data-ttu-id="57733-117">En savoir plus sur hello [avantages](https://redis.io/topics/persistence#aof-advantages) et [inconvénients](https://redis.io/topics/persistence#aof-disadvantages) de persistance d’UNEDE.</span><span class="sxs-lookup"><span data-stu-id="57733-117">Learn more about hello [advantages](https://redis.io/topics/persistence#aof-advantages) and [disadvantages](https://redis.io/topics/persistence#aof-disadvantages) of AOF persistence.</span></span>

<span data-ttu-id="57733-118">Persistance est configurée de hello **nouveau Cache Redis** panneau pendant la création du cache et sur hello **menu ressource** pour premium existante met en cache.</span><span class="sxs-lookup"><span data-stu-id="57733-118">Persistence is configured from hello **New Redis Cache** blade during cache creation and on hello **Resource menu** for existing premium caches.</span></span>

[!INCLUDE [redis-cache-create](../../includes/redis-cache-premium-create.md)]

<span data-ttu-id="57733-119">Une fois que vous avez sélectionné un niveau tarifaire Premium, cliquez sur **Persistance Redis**.</span><span class="sxs-lookup"><span data-stu-id="57733-119">Once a premium pricing tier is selected, click **Redis persistence**.</span></span>

![Persistance Redis][redis-cache-persistence]

<span data-ttu-id="57733-121">Hello étapes dans la section suivante de hello décrivent comment tooconfigure persistance Redis sur votre nouveau cache premium.</span><span class="sxs-lookup"><span data-stu-id="57733-121">hello steps in hello next section describe how tooconfigure Redis persistence on your new premium cache.</span></span> <span data-ttu-id="57733-122">Une fois que la persistance de Redis est configuré, cliquez sur **créer** toocreate votre premium nouveau cache avec Redis persistance.</span><span class="sxs-lookup"><span data-stu-id="57733-122">Once Redis persistence is configured, click **Create** toocreate your new premium cache with Redis persistence.</span></span>

## <a name="enable-redis-persistence"></a><span data-ttu-id="57733-123">Activation de la persistance Redis</span><span class="sxs-lookup"><span data-stu-id="57733-123">Enable Redis persistence</span></span>

<span data-ttu-id="57733-124">Redis la persistance est activée sur hello **Redis la persistance des données** panneau en choisissant soit **RDB** ou **UNEDE** persistance.</span><span class="sxs-lookup"><span data-stu-id="57733-124">Redis persistence is enabled on hello **Redis data persistence** blade by choosing either **RDB** or **AOF** persistence.</span></span> <span data-ttu-id="57733-125">Pour les nouveaux caches, ce panneau est accessible au cours du processus de création du cache hello, comme décrit dans la section précédente de hello.</span><span class="sxs-lookup"><span data-stu-id="57733-125">For new caches, this blade is accessed during hello cache creation process, as described in hello previous section.</span></span> <span data-ttu-id="57733-126">Pour les caches existants, hello **Redis la persistance des données** lame est accessible à partir de hello **menu ressource** pour votre cache.</span><span class="sxs-lookup"><span data-stu-id="57733-126">For existing caches, hello **Redis data persistence** blade is accessed from hello **Resource menu** for your cache.</span></span>

![Paramètres Redis][redis-cache-settings]


## <a name="configure-rdb-persistence"></a><span data-ttu-id="57733-128">Configuration de la persistance RDB</span><span class="sxs-lookup"><span data-stu-id="57733-128">Configure RDB persistence</span></span>

<span data-ttu-id="57733-129">persistance de RDB tooenable, cliquez sur **RDB**.</span><span class="sxs-lookup"><span data-stu-id="57733-129">tooenable RDB persistence, click **RDB**.</span></span> <span data-ttu-id="57733-130">persistance de RDB toodisable sur un cache premium précédemment activé, cliquez sur **désactivé**.</span><span class="sxs-lookup"><span data-stu-id="57733-130">toodisable RDB persistence on a previously enabled premium cache, click **Disabled**.</span></span>

![Persistance RDB Redis][redis-cache-rdb-persistence]

<span data-ttu-id="57733-132">tooconfigure hello intervalle de sauvegarde, sélectionnez un **fréquence de sauvegarde** à partir de la liste déroulante de hello.</span><span class="sxs-lookup"><span data-stu-id="57733-132">tooconfigure hello backup interval, select a **Backup Frequency** from hello drop-down list.</span></span> <span data-ttu-id="57733-133">Vous avez le choix entre **15 minutes**, **30 minutes**, **60 minutes**, **6 heures**, **12 heures** et **24 heures**.</span><span class="sxs-lookup"><span data-stu-id="57733-133">Choices include **15 Minutes**, **30 minutes**, **60 minutes**, **6 hours**, **12 hours**, and **24 hours**.</span></span> <span data-ttu-id="57733-134">Cet intervalle commence le comptage vers le bas après l’opération de sauvegarde précédente hello terminée avec succès et quand il s’écoule une nouvelle sauvegarde est lancée.</span><span class="sxs-lookup"><span data-stu-id="57733-134">This interval starts counting down after hello previous backup operation successfully completes and when it elapses a new backup is initiated.</span></span>

<span data-ttu-id="57733-135">Cliquez sur **compte de stockage** tooselect hello toouse de compte de stockage et choisissez soit hello **clé primaire** ou **clé secondaire** toouse de hello **stockage Clé** liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="57733-135">Click **Storage Account** tooselect hello storage account toouse, and choose either hello **Primary key** or **Secondary key** toouse from hello **Storage Key** drop-down.</span></span> <span data-ttu-id="57733-136">Vous devez choisir un compte de stockage Bonjour même région que le cache de hello et un **stockage Premium** compte est recommandé, car le stockage premium a un débit plus élevé.</span><span class="sxs-lookup"><span data-stu-id="57733-136">You must choose a storage account in hello same region as hello cache, and a **Premium Storage** account is recommended because premium storage has higher throughput.</span></span> 

> [!IMPORTANT]
> <span data-ttu-id="57733-137">Si la clé de stockage hello pour votre compte de persistance est régénérée, vous devez reconfigurer la clé souhaitée hello hello **clé de stockage** liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="57733-137">If hello storage key for your persistence account is regenerated, you must reconfigure hello desired key from hello **Storage Key** drop-down.</span></span>
> 
> 

<span data-ttu-id="57733-138">Cliquez sur **OK** configuration de persistance toosave hello.</span><span class="sxs-lookup"><span data-stu-id="57733-138">Click **OK** toosave hello persistence configuration.</span></span>

<span data-ttu-id="57733-139">prochaine sauvegarde Hello (ou première sauvegarde pour les nouveaux caches) est lancée une fois que l’intervalle de fréquence de sauvegarde hello est écoulé.</span><span class="sxs-lookup"><span data-stu-id="57733-139">hello next backup (or first backup for new caches) is initiated once hello backup frequency interval elapses.</span></span>

## <a name="configure-aof-persistence"></a><span data-ttu-id="57733-140">Configuration de la persistance AOF</span><span class="sxs-lookup"><span data-stu-id="57733-140">Configure AOF persistence</span></span>

<span data-ttu-id="57733-141">persistance d’UNEDE tooenable, cliquez sur **UNEDE**.</span><span class="sxs-lookup"><span data-stu-id="57733-141">tooenable AOF persistence, click **AOF**.</span></span> <span data-ttu-id="57733-142">persistance d’UNEDE toodisable sur un cache premium précédemment activé, cliquez sur **désactivé**.</span><span class="sxs-lookup"><span data-stu-id="57733-142">toodisable AOF persistence on a previously enabled premium cache, click **Disabled**.</span></span>

![Persistance AOF Redis][redis-cache-aof-persistence]

<span data-ttu-id="57733-144">persistance d’UNEDE tooconfigure, spécifiez un **premier compte de stockage**.</span><span class="sxs-lookup"><span data-stu-id="57733-144">tooconfigure AOF persistence, specify a **First Storage Account**.</span></span> <span data-ttu-id="57733-145">Ce compte de stockage doit être Bonjour même région que le cache de hello et un **stockage Premium** compte est recommandé, car le stockage premium a un débit plus élevé.</span><span class="sxs-lookup"><span data-stu-id="57733-145">This storage account must be in hello same region as hello cache, and a **Premium Storage** account is recommended because premium storage has higher throughput.</span></span> <span data-ttu-id="57733-146">Vous pouvez éventuellement configurer un compte de stockage supplémentaire nommé **Deuxième compte de stockage**.</span><span class="sxs-lookup"><span data-stu-id="57733-146">You can optionally configure an additional storage account named **Second Storage Account**.</span></span> <span data-ttu-id="57733-147">Si un deuxième compte de stockage est configuré, hello écritures toohello réplica cache sont écrites toothis deuxième compte de stockage.</span><span class="sxs-lookup"><span data-stu-id="57733-147">If a second storage account is configured, hello writes toohello replica cache are written toothis second storage account.</span></span> <span data-ttu-id="57733-148">Pour chaque compte de stockage configuré, choisissez soit hello **clé primaire** ou **clé secondaire** toouse de hello **clé de stockage** liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="57733-148">For each configured storage account, choose either hello **Primary key** or **Secondary key** toouse from hello **Storage Key** drop-down.</span></span> 

> [!IMPORTANT]
> <span data-ttu-id="57733-149">Si la clé de stockage hello pour votre compte de persistance est régénérée, vous devez reconfigurer la clé souhaitée hello hello **clé de stockage** liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="57733-149">If hello storage key for your persistence account is regenerated, you must reconfigure hello desired key from hello **Storage Key** drop-down.</span></span>
> 
> 

<span data-ttu-id="57733-150">Lors de la persistance UNEDE est activée, écrire le cache de toohello opérations sont enregistrées toohello désigné du compte de stockage (ou des comptes si vous avez configuré un deuxième compte de stockage).</span><span class="sxs-lookup"><span data-stu-id="57733-150">When AOF persistence is enabled, write operations toohello cache are saved toohello designated storage account (or accounts if you have configured a second storage account).</span></span> <span data-ttu-id="57733-151">En cas de hello d’une défaillance catastrophique que prend deux vers le bas hello principal et le cache de réplica, hello stockée UNEDE journal est utilisé du cache de toorebuild hello.</span><span class="sxs-lookup"><span data-stu-id="57733-151">In hello event of a catastrophic failure that takes down both hello primary and replica cache, hello stored AOF log is used toorebuild hello cache.</span></span>

## <a name="persistence-faq"></a><span data-ttu-id="57733-152">Forum aux questions sur la persistance</span><span class="sxs-lookup"><span data-stu-id="57733-152">Persistence FAQ</span></span>
<span data-ttu-id="57733-153">Hello liste suivante contient toocommonly des réponses aux questions sur la persistance du Cache Redis Azure.</span><span class="sxs-lookup"><span data-stu-id="57733-153">hello following list contains answers toocommonly asked questions about Azure Redis Cache persistence.</span></span>

* [<span data-ttu-id="57733-154">Puis-je activer la persistance sur un cache créé précédemment ?</span><span class="sxs-lookup"><span data-stu-id="57733-154">Can I enable persistence on a previously created cache?</span></span>](#can-i-enable-persistence-on-a-previously-created-cache)
* [<span data-ttu-id="57733-155">Puis-je activer la persistance UNEDE et RDB à hello même temps ?</span><span class="sxs-lookup"><span data-stu-id="57733-155">Can I enable AOF and RDB persistence at hello same time?</span></span>](#can-i-enable-aof-and-rdb-persistence-at-the-same-time)
* [<span data-ttu-id="57733-156">Quel modèle de persistance dois-je choisir ?</span><span class="sxs-lookup"><span data-stu-id="57733-156">Which persistence model should I choose?</span></span>](#which-persistence-model-should-i-choose)
* [<span data-ttu-id="57733-157">Que se passe-t-il si j’ai mis à l’échelle tooa une taille différente et la restauration d’une sauvegarde effectuée avant l’opération de mise à l’échelle de hello ?</span><span class="sxs-lookup"><span data-stu-id="57733-157">What happens if I have scaled tooa different size and a backup is restored that was made before hello scaling operation?</span></span>](#what-happens-if-i-have-scaled-to-a-different-size-and-a-backup-is-restored-that-was-made-before-the-scaling-operation)


### <a name="rdb-persistence"></a><span data-ttu-id="57733-158">Persistance RDB</span><span class="sxs-lookup"><span data-stu-id="57733-158">RDB persistence</span></span>
* [<span data-ttu-id="57733-159">Puis-je modifier la fréquence de sauvegarde RDB hello après avoir créé le cache de hello ?</span><span class="sxs-lookup"><span data-stu-id="57733-159">Can I change hello RDB backup frequency after I create hello cache?</span></span>](#can-i-change-the-rdb-backup-frequency-after-i-create-the-cache)
* [<span data-ttu-id="57733-160">Pourquoi, si la fréquence de sauvegarde RDB est de 60 minutes, y a-t-il un délai supérieur à 60 minutes entre les sauvegardes ?</span><span class="sxs-lookup"><span data-stu-id="57733-160">Why if I have an RDB backup frequency of 60 minutes there is more than 60 minutes between backups?</span></span>](#why-if-i-have-an-rdb-backup-frequency-of-60-minutes-there-is-more-than-60-minutes-between-backups)
* [<span data-ttu-id="57733-161">Que passe-t-il d’anciennes sauvegardes RDB toohello lorsqu’une nouvelle sauvegarde est effectuée ?</span><span class="sxs-lookup"><span data-stu-id="57733-161">What happens toohello old RDB backups when a new backup is made?</span></span>](#what-happens-to-the-old-rdb-backups-when-a-new-backup-is-made)

### <a name="aof-persistence"></a><span data-ttu-id="57733-162">Persistance AOF</span><span class="sxs-lookup"><span data-stu-id="57733-162">AOF persistence</span></span>
* [<span data-ttu-id="57733-163">Quand dois-je utiliser un deuxième compte de stockage ?</span><span class="sxs-lookup"><span data-stu-id="57733-163">When should I use a second storage account?</span></span>](#when-should-i-use-a-second-storage-account)
* [<span data-ttu-id="57733-164">La persistance AOF affecte-t-elle le débit, la latence ou les performances de mon cache ?</span><span class="sxs-lookup"><span data-stu-id="57733-164">Does AOF persistence affect throughout, latency, or performance of my cache?</span></span>](#does-aof-persistence-affect-throughout-latency-or-performance-of-my-cache)
* [<span data-ttu-id="57733-165">Comment puis-je supprimer le compte de stockage deuxième hello ?</span><span class="sxs-lookup"><span data-stu-id="57733-165">How can I remove hello second storage account?</span></span>](#how-can-i-remove-the-second-storage-account)
* [<span data-ttu-id="57733-166">Qu’est-ce qu’une réécriture et comment affecte-t-elle mon cache ?</span><span class="sxs-lookup"><span data-stu-id="57733-166">What is a rewrite and how does it affect my cache?</span></span>](#what-is-a-rewrite-and-how-does-it-affect-my-cache)
* [<span data-ttu-id="57733-167">À quoi dois-je attendre lors de la mise à l’échelle d’un cache avec la persistance AOF activée ?</span><span class="sxs-lookup"><span data-stu-id="57733-167">What should I expect when scaling a cache with AOF enabled?</span></span>](#what-should-i-expect-when-scaling-a-cache-with-aof-enabled)
* [<span data-ttu-id="57733-168">Comment sont organisées mes données AOF dans le stockage ?</span><span class="sxs-lookup"><span data-stu-id="57733-168">How is my AOF data organized in storage?</span></span>](#how-is-my-aof-data-organized-in-storage)


### <a name="can-i-enable-persistence-on-a-previously-created-cache"></a><span data-ttu-id="57733-169">Puis-je activer la persistance sur un cache créé précédemment ?</span><span class="sxs-lookup"><span data-stu-id="57733-169">Can I enable persistence on a previously created cache?</span></span>
<span data-ttu-id="57733-170">Oui, la persistance Redis peut être configurée lors de la création du cache ou sur les caches Premium existants.</span><span class="sxs-lookup"><span data-stu-id="57733-170">Yes, Redis persistence can be configured both at cache creation and on existing premium caches.</span></span>

### <a name="can-i-enable-aof-and-rdb-persistence-at-hello-same-time"></a><span data-ttu-id="57733-171">Puis-je activer la persistance UNEDE et RDB à hello même temps ?</span><span class="sxs-lookup"><span data-stu-id="57733-171">Can I enable AOF and RDB persistence at hello same time?</span></span>

<span data-ttu-id="57733-172">Non, vous pouvez activer uniquement RDB ou UNEDE, mais pas les deux à hello même temps.</span><span class="sxs-lookup"><span data-stu-id="57733-172">No, you can enable only RDB or AOF, but not both at hello same time.</span></span>

### <a name="which-persistence-model-should-i-choose"></a><span data-ttu-id="57733-173">Quel modèle de persistance dois-je choisir ?</span><span class="sxs-lookup"><span data-stu-id="57733-173">Which persistence model should I choose?</span></span>

<span data-ttu-id="57733-174">Persistance d’UNEDE enregistre chaque tooa écriture du journal, qui a un impact sur le débit, persistance qui enregistre les sauvegardes en fonction de hello comparé RDB configuré d’intervalle de sauvegarde, avec un impact minimal sur les performances.</span><span class="sxs-lookup"><span data-stu-id="57733-174">AOF persistence saves every write tooa log, which has some impact on throughput, compared with RDB persistence which saves backups based on hello configured backup interval, with minimal impact on performance.</span></span> <span data-ttu-id="57733-175">Choisissez la persistance d’UNEDE si votre objectif principal est toominimize une perte de données, et vous pouvez gérer une diminution du débit de votre cache.</span><span class="sxs-lookup"><span data-stu-id="57733-175">Choose AOF persistence if your primary goal is toominimize data loss, and you can handle a decrease in throughput for your cache.</span></span> <span data-ttu-id="57733-176">Choisissez la persistance de RDB si vous le souhaitez toomaintain un débit optimal sur votre cache, mais toujours un mécanisme de récupération de données.</span><span class="sxs-lookup"><span data-stu-id="57733-176">Choose RDB persistence if you wish toomaintain optimal throughput on your cache, but still want a mechanism for data recovery.</span></span>

* <span data-ttu-id="57733-177">En savoir plus sur hello [avantages](https://redis.io/topics/persistence#rdb-advantages) et [inconvénients](https://redis.io/topics/persistence#rdb-disadvantages) de persistance de RDB.</span><span class="sxs-lookup"><span data-stu-id="57733-177">Learn more about hello [advantages](https://redis.io/topics/persistence#rdb-advantages) and [disadvantages](https://redis.io/topics/persistence#rdb-disadvantages) of RDB persistence.</span></span>
* <span data-ttu-id="57733-178">En savoir plus sur hello [avantages](https://redis.io/topics/persistence#aof-advantages) et [inconvénients](https://redis.io/topics/persistence#aof-disadvantages) de persistance d’UNEDE.</span><span class="sxs-lookup"><span data-stu-id="57733-178">Learn more about hello [advantages](https://redis.io/topics/persistence#aof-advantages) and [disadvantages](https://redis.io/topics/persistence#aof-disadvantages) of AOF persistence.</span></span>

<span data-ttu-id="57733-179">Pour plus d’informations sur les performances lors de l’utilisation de persistance AOF, consultez [La persistance affecte-t-elle le débit, la latence ou les performances de mon cache ?](#does-aof-persistence-affect-throughout-latency-or-performance-of-my-cache)</span><span class="sxs-lookup"><span data-stu-id="57733-179">For more information on performance when using AOF persistence, see [Does AOF persistence affect throughout, latency, or performance of my cache?](#does-aof-persistence-affect-throughout-latency-or-performance-of-my-cache)</span></span>

### <a name="what-happens-if-i-have-scaled-tooa-different-size-and-a-backup-is-restored-that-was-made-before-hello-scaling-operation"></a><span data-ttu-id="57733-180">Que se passe-t-il si j’ai mis à l’échelle tooa une taille différente et la restauration d’une sauvegarde effectuée avant l’opération de mise à l’échelle de hello ?</span><span class="sxs-lookup"><span data-stu-id="57733-180">What happens if I have scaled tooa different size and a backup is restored that was made before hello scaling operation?</span></span>

<span data-ttu-id="57733-181">Pour la persistance RDB et AOF :</span><span class="sxs-lookup"><span data-stu-id="57733-181">For both RDB and AOF persistence:</span></span>

* <span data-ttu-id="57733-182">Si vous avez mis à l’échelle tooa plus grande taille, il n’existe aucun impact.</span><span class="sxs-lookup"><span data-stu-id="57733-182">If you have scaled tooa larger size, there is no impact.</span></span>
* <span data-ttu-id="57733-183">Si vous avez monté en tooa plus petite taille, et que vous avez personnalisé [bases de données](cache-configure.md#databases) qui est supérieur à hello [limite de bases de données](cache-configure.md#databases) pour votre nouvelle taille, dans les bases de données n’est pas restaurées.</span><span class="sxs-lookup"><span data-stu-id="57733-183">If you have scaled tooa smaller size, and you have a custom [databases](cache-configure.md#databases) setting that is greater than hello [databases limit](cache-configure.md#databases) for your new size, data in those databases isn't restored.</span></span> <span data-ttu-id="57733-184">Pour en savoir plus, voir [Les paramètres personnalisés de mes bases de données sont-ils affectés au cours de la mise à l’échelle ?](cache-how-to-scale.md#is-my-custom-databases-setting-affected-during-scaling)</span><span class="sxs-lookup"><span data-stu-id="57733-184">For more information, see [Is my custom databases setting affected during scaling?](cache-how-to-scale.md#is-my-custom-databases-setting-affected-during-scaling)</span></span>
* <span data-ttu-id="57733-185">Si vous avez à l’échelle tooa plus petite taille, et il n’est pas assez de place dans hello toohold de taille plus petite toutes les données de hello depuis la dernière clés de sauvegarde, hello seront supprimés pendant le processus de restauration hello, généralement à l’aide hello [allkeys-lru](http://redis.io/topics/lru-cache) éviction stratégie.</span><span class="sxs-lookup"><span data-stu-id="57733-185">If you have scaled tooa smaller size, and there isn't enough room in hello smaller size toohold all of hello data from hello last backup, keys will be evicted during hello restore process, typically using hello [allkeys-lru](http://redis.io/topics/lru-cache) eviction policy.</span></span>

### <a name="can-i-change-hello-rdb-backup-frequency-after-i-create-hello-cache"></a><span data-ttu-id="57733-186">Puis-je modifier la fréquence de sauvegarde RDB hello après avoir créé le cache de hello ?</span><span class="sxs-lookup"><span data-stu-id="57733-186">Can I change hello RDB backup frequency after I create hello cache?</span></span>
<span data-ttu-id="57733-187">Oui, vous pouvez modifier la fréquence de sauvegarde hello pour la persistance RDB sur hello **Redis la persistance des données** panneau.</span><span class="sxs-lookup"><span data-stu-id="57733-187">Yes, you can change hello backup frequency for RDB persistence on hello **Redis data persistence** blade.</span></span> <span data-ttu-id="57733-188">Pour obtenir des instructions, consultez la page [Configuration de la persistance Redis](#configure-redis-persistence).</span><span class="sxs-lookup"><span data-stu-id="57733-188">For instructions, see [Configure Redis persistence](#configure-redis-persistence).</span></span>

### <a name="why-if-i-have-an-rdb-backup-frequency-of-60-minutes-there-is-more-than-60-minutes-between-backups"></a><span data-ttu-id="57733-189">Pourquoi, si la fréquence de sauvegarde RDB est de 60 minutes, y a-t-il un délai supérieur à 60 minutes entre les sauvegardes ?</span><span class="sxs-lookup"><span data-stu-id="57733-189">Why if I have an RDB backup frequency of 60 minutes there is more than 60 minutes between backups?</span></span>
<span data-ttu-id="57733-190">intervalle de fréquence de sauvegarde Hello RDB persistance ne démarre pas jusqu'à ce que le processus de sauvegarde précédente hello est bien terminée.</span><span class="sxs-lookup"><span data-stu-id="57733-190">hello RDB persistence backup frequency interval does not start until hello previous backup process has completed successfully.</span></span> <span data-ttu-id="57733-191">Si la fréquence de sauvegarde hello est de 60 minutes, et il prend une toosuccessfully de 15 minutes de processus de sauvegarde complète, de sauvegarde suivant hello ne démarre pas tant que 75 minutes après hello heure de début de sauvegarde précédente de hello.</span><span class="sxs-lookup"><span data-stu-id="57733-191">If hello backup frequency is 60 minutes and it takes a backup process 15 minutes toosuccessfully complete, hello next backup won't start until 75 minutes after hello start time of hello previous backup.</span></span>

### <a name="what-happens-toohello-old-rdb-backups-when-a-new-backup-is-made"></a><span data-ttu-id="57733-192">Que passe-t-il d’anciennes sauvegardes RDB toohello lorsqu’une nouvelle sauvegarde est effectuée ?</span><span class="sxs-lookup"><span data-stu-id="57733-192">What happens toohello old RDB backups when a new backup is made?</span></span>
<span data-ttu-id="57733-193">Toutes les sauvegardes de persistance RDB à l’exception de hello plus récente sont automatiquement supprimés.</span><span class="sxs-lookup"><span data-stu-id="57733-193">All RDB persistence backups except for hello most recent one are automatically deleted.</span></span> <span data-ttu-id="57733-194">Cette suppression peut ne pas avoir lieu immédiatement, mais les anciennes sauvegardes ne sont pas conservées indéfiniment.</span><span class="sxs-lookup"><span data-stu-id="57733-194">This deletion may not happen immediately but older backups are not persisted indefinitely.</span></span>


### <a name="when-should-i-use-a-second-storage-account"></a><span data-ttu-id="57733-195">Quand dois-je utiliser un deuxième compte de stockage ?</span><span class="sxs-lookup"><span data-stu-id="57733-195">When should I use a second storage account?</span></span>

<span data-ttu-id="57733-196">Vous devez utiliser un deuxième compte de stockage pour la persistance d’UNEDE lorsque vous pensez que vous avez le plus élevé que les opérations de jeu attendu sur le cache de hello.</span><span class="sxs-lookup"><span data-stu-id="57733-196">You should use a second storage account for AOF persistence when you believe you have higher than expected set operations on hello cache.</span></span>  <span data-ttu-id="57733-197">La configuration de compte de stockage secondaire hello garantit que votre cache n’atteint pas les limites de bande passante de stockage.</span><span class="sxs-lookup"><span data-stu-id="57733-197">Setting up hello secondary storage account helps ensure your cache doesn't reach storage bandwidth limits.</span></span>

### <a name="does-aof-persistence-affect-throughout-latency-or-performance-of-my-cache"></a><span data-ttu-id="57733-198">La persistance AOF affecte-t-elle le débit, la latence ou les performances de mon cache ?</span><span class="sxs-lookup"><span data-stu-id="57733-198">Does AOF persistence affect throughout, latency, or performance of my cache?</span></span>

<span data-ttu-id="57733-199">Persistance d’UNEDE affecte le débit en environ 15 à 20 % lorsque le cache de hello est sous charge maximale (UC et charge du serveur à la fois sous 90 %).</span><span class="sxs-lookup"><span data-stu-id="57733-199">AOF persistence affects throughput by about 15% – 20% when hello cache is below maximum load (CPU and Server Load both under 90%).</span></span> <span data-ttu-id="57733-200">Il doit être pas les problèmes de latence lorsque le cache de hello est dans ces limites.</span><span class="sxs-lookup"><span data-stu-id="57733-200">There should not be latency issues when hello cache is within these limits.</span></span> <span data-ttu-id="57733-201">Toutefois, le cache de hello atteint ces limites plus tôt avec UNEDE activée.</span><span class="sxs-lookup"><span data-stu-id="57733-201">However, hello cache will reach these limits sooner with AOF enabled.</span></span>

### <a name="how-can-i-remove-hello-second-storage-account"></a><span data-ttu-id="57733-202">Comment puis-je supprimer le compte de stockage deuxième hello ?</span><span class="sxs-lookup"><span data-stu-id="57733-202">How can I remove hello second storage account?</span></span>

<span data-ttu-id="57733-203">Vous pouvez supprimer le compte de stockage secondaire hello UNEDE persistance en définissant le deuxième compte de stockage hello toobe même hello en tant que premier compte de stockage hello.</span><span class="sxs-lookup"><span data-stu-id="57733-203">You can remove hello AOF persistence secondary storage account by setting hello second storage account toobe hello same as hello first storage account.</span></span> <span data-ttu-id="57733-204">Pour obtenir des instructions, consultez la page [Configuration de la persistance AOF](#configure-aof-persistence).</span><span class="sxs-lookup"><span data-stu-id="57733-204">For instructions, see [Configure AOF persistence](#configure-aof-persistence).</span></span>

### <a name="what-is-a-rewrite-and-how-does-it-affect-my-cache"></a><span data-ttu-id="57733-205">Qu’est-ce qu’une réécriture et comment affecte-t-elle mon cache ?</span><span class="sxs-lookup"><span data-stu-id="57733-205">What is a rewrite and how does it affect my cache?</span></span>

<span data-ttu-id="57733-206">Lorsque le fichier UNEDE de hello est suffisante, une réécriture est automatiquement mise en attente sur le cache de hello.</span><span class="sxs-lookup"><span data-stu-id="57733-206">When hello AOF file becomes large enough, a rewrite is automatically queued on hello cache.</span></span> <span data-ttu-id="57733-207">fichier d’UNEDE hello Hello réécriture est redimensionné avec hello nombre minimal de jeu de données en cours d’opérations nécessaires toocreate hello.</span><span class="sxs-lookup"><span data-stu-id="57733-207">hello rewrite resizes hello AOF file with hello minimal set of operations needed toocreate hello current data set.</span></span> <span data-ttu-id="57733-208">Au cours de réécritures, attendre tooreach des limites de performances plus tôt en particulier lors du traitement de grands jeux de données.</span><span class="sxs-lookup"><span data-stu-id="57733-208">During rewrites, expect tooreach performance limits sooner especially when dealing with large datasets.</span></span> <span data-ttu-id="57733-209">Réécritures inférieur produisent souvent comme fichier d’UNEDE hello devient supérieure, mais prendra beaucoup de temps quand il se produit.</span><span class="sxs-lookup"><span data-stu-id="57733-209">Rewrites occur less often as hello AOF file becomes larger, but will take a significant amount of time when it happens.</span></span>

### <a name="what-should-i-expect-when-scaling-a-cache-with-aof-enabled"></a><span data-ttu-id="57733-210">À quoi dois-je attendre lors de la mise à l’échelle d’un cache avec la persistance AOF activée ?</span><span class="sxs-lookup"><span data-stu-id="57733-210">What should I expect when scaling a cache with AOF enabled?</span></span>

<span data-ttu-id="57733-211">Si le fichier d’UNEDE hello au moment de hello de mise à l’échelle est suffisamment importante, puis attendez hello échelle opération tootake plus longtemps que prévu, car il sera recharger les fichiers hello après mise à l’échelle.</span><span class="sxs-lookup"><span data-stu-id="57733-211">If hello AOF file at hello time of scaling is significantly large, then expect hello scale operation tootake longer than expected since it will be reloading hello file after scaling has finished.</span></span>

<span data-ttu-id="57733-212">Pour plus d’informations sur la mise à l’échelle, consultez [que se passe-t-il si j’ai mis à l’échelle tooa une taille différente et la restauration d’une sauvegarde effectuée avant l’opération de mise à l’échelle de hello ?](#what-happens-if-i-have-scaled-to-a-different-size-and-a-backup-is-restored-that-was-made-before-the-scaling-operation)</span><span class="sxs-lookup"><span data-stu-id="57733-212">For more information on scaling, see [What happens if I have scaled tooa different size and a backup is restored that was made before hello scaling operation?](#what-happens-if-i-have-scaled-to-a-different-size-and-a-backup-is-restored-that-was-made-before-the-scaling-operation)</span></span>

### <a name="how-is-my-aof-data-organized-in-storage"></a><span data-ttu-id="57733-213">Comment sont organisées mes données AOF dans le stockage ?</span><span class="sxs-lookup"><span data-stu-id="57733-213">How is my AOF data organized in storage?</span></span>

<span data-ttu-id="57733-214">Les données stockées dans des fichiers UNEDE sont divisées en plusieurs objets BLOB de pages par des performances de l’enregistrement de hello données toostorage tooincrease du nœud.</span><span class="sxs-lookup"><span data-stu-id="57733-214">Data stored in AOF files is divided into multiple page blobs per node tooincrease performance of saving hello data toostorage.</span></span> <span data-ttu-id="57733-215">Hello tableau suivant affiche les objets BLOB de pages combien est utilisés pour chaque niveau de tarification :</span><span class="sxs-lookup"><span data-stu-id="57733-215">hello following table displays how many page blobs are used for each pricing tier:</span></span>

| <span data-ttu-id="57733-216">Niveau Premium</span><span class="sxs-lookup"><span data-stu-id="57733-216">Premium tier</span></span> | <span data-ttu-id="57733-217">Objets blob</span><span class="sxs-lookup"><span data-stu-id="57733-217">Blobs</span></span> |
|--------------|-------|
| <span data-ttu-id="57733-218">P1</span><span class="sxs-lookup"><span data-stu-id="57733-218">P1</span></span>           | <span data-ttu-id="57733-219">4 par partition</span><span class="sxs-lookup"><span data-stu-id="57733-219">4 per shard</span></span>    |
| <span data-ttu-id="57733-220">P2</span><span class="sxs-lookup"><span data-stu-id="57733-220">P2</span></span>           | <span data-ttu-id="57733-221">8 par partition</span><span class="sxs-lookup"><span data-stu-id="57733-221">8 per shard</span></span>    |
| <span data-ttu-id="57733-222">P3</span><span class="sxs-lookup"><span data-stu-id="57733-222">P3</span></span>           | <span data-ttu-id="57733-223">16 par partition</span><span class="sxs-lookup"><span data-stu-id="57733-223">16 per shard</span></span>   |
| <span data-ttu-id="57733-224">P4</span><span class="sxs-lookup"><span data-stu-id="57733-224">P4</span></span>           | <span data-ttu-id="57733-225">20 par partition</span><span class="sxs-lookup"><span data-stu-id="57733-225">20 per shard</span></span>   |

<span data-ttu-id="57733-226">Lorsque le clustering est activé, chaque partition dans le cache de hello possède son propre ensemble d’objets BLOB de page, comme indiqué dans le tableau précédent de hello.</span><span class="sxs-lookup"><span data-stu-id="57733-226">When clustering is enabled, each shard in hello cache has its own set of page blobs, as indicated in hello previous table.</span></span> <span data-ttu-id="57733-227">Par exemple, un cache P2 avec trois partitions distribue son fichier AOF entre 24 objets blob de pages (8 objets blob par partition, avec 3 partitions).</span><span class="sxs-lookup"><span data-stu-id="57733-227">For example, a P2 cache with three shards distributes its AOF file across 24 page blobs (8 blobs per shard, with 3 shards).</span></span>

<span data-ttu-id="57733-228">Après une réécriture, deux jeux de fichiers AOF se trouvent dans le stockage.</span><span class="sxs-lookup"><span data-stu-id="57733-228">After a rewrite, two sets of AOF files exist in storage.</span></span> <span data-ttu-id="57733-229">Réécritures se produisent en arrière-plan de hello et ajoutez toohello premier jeu de fichiers, alors que le jeu qui sont envoyés du cache de toohello au cours de réécriture de hello ajoutent toohello deuxième jeu.</span><span class="sxs-lookup"><span data-stu-id="57733-229">Rewrites occur in hello background and append toohello first set of files, while set operations that are sent toohello cache during hello rewrite append toohello second set.</span></span> <span data-ttu-id="57733-230">Une sauvegarde est temporairement stockée pendant les réécritures en cas d’échec, mais elle est immédiatement supprimée à la fin de la réécriture.</span><span class="sxs-lookup"><span data-stu-id="57733-230">A backup is temporarily stored during rewrites in case of failure, but is promptly deleted after a rewrite finishes.</span></span>


## <a name="next-steps"></a><span data-ttu-id="57733-231">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="57733-231">Next steps</span></span>
<span data-ttu-id="57733-232">Découvrez comment mettre en cache des fonctionnalités par toouse plus premium.</span><span class="sxs-lookup"><span data-stu-id="57733-232">Learn how toouse more premium cache features.</span></span>

* [<span data-ttu-id="57733-233">Couche de présentation toohello Azure Redis Cache Premium</span><span class="sxs-lookup"><span data-stu-id="57733-233">Introduction toohello Azure Redis Cache Premium tier</span></span>](cache-premium-tier-intro.md)

<!-- IMAGES -->

[redis-cache-premium-pricing-tier]: ./media/cache-how-to-premium-persistence/redis-cache-premium-pricing-tier.png

[redis-cache-persistence]: ./media/cache-how-to-premium-persistence/redis-cache-persistence.png

[redis-cache-rdb-persistence]: ./media/cache-how-to-premium-persistence/redis-cache-rdb-persistence.png

[redis-cache-aof-persistence]: ./media/cache-how-to-premium-persistence/redis-cache-aof-persistence.png

[redis-cache-settings]: ./media/cache-how-to-premium-persistence/redis-cache-settings.png
