---
title: "aaaConfigure un réseau virtuel pour un Premium le Cache Redis Azure | Documents Microsoft"
description: "Découvrez comment toocreate et gérer la prise en charge de réseau virtuel pour vos instances de Cache Redis Azure de niveau Premium"
services: redis-cache
documentationcenter: 
author: steved0x
manager: douge
editor: 
ms.assetid: 8b1e43a0-a70e-41e6-8994-0ac246d8bf7f
ms.service: cache
ms.workload: tbd
ms.tgt_pltfrm: cache-redis
ms.devlang: na
ms.topic: article
ms.date: 05/15/2017
ms.author: sdanie
ms.openlocfilehash: fab715f4d9365ee4c2f8b89d2e2e58768c25b671
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="how-tooconfigure-virtual-network-support-for-a-premium-azure-redis-cache"></a><span data-ttu-id="da7b5-103">Comment tooconfigure réseau virtuel prend en charge un Premium Azure Redis cache</span><span class="sxs-lookup"><span data-stu-id="da7b5-103">How tooconfigure Virtual Network Support for a Premium Azure Redis Cache</span></span>
<span data-ttu-id="da7b5-104">Cache Redis Azure a différentes offres de cache, qui fournissent une certaine flexibilité hello les choix de la taille du cache et de fonctionnalités, y compris les fonctionnalités de niveau Premium telles que le clustering, la persistance et la prise en charge du réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="da7b5-104">Azure Redis Cache has different cache offerings, which provide flexibility in hello choice of cache size and features, including Premium tier features such as clustering, persistence, and virtual network support.</span></span> <span data-ttu-id="da7b5-105">Un réseau virtuel est un réseau privé dans le cloud de hello.</span><span class="sxs-lookup"><span data-stu-id="da7b5-105">A VNet is a private network in hello cloud.</span></span> <span data-ttu-id="da7b5-106">Lorsqu’une instance de Cache Redis Azure est configurée avec un réseau virtuel, il n’est pas publiquement adressable et sont accessibles à partir d’ordinateurs virtuels et les applications de hello réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="da7b5-106">When an Azure Redis Cache instance is configured with a VNet, it is not publicly addressable and can only be accessed from virtual machines and applications within hello VNet.</span></span> <span data-ttu-id="da7b5-107">Cet article décrit comment les réseaux virtuels tooconfigure prennent en charge pour une instance de Cache Redis Azure premium.</span><span class="sxs-lookup"><span data-stu-id="da7b5-107">This article describes how tooconfigure virtual network support for a premium Azure Redis Cache instance.</span></span>

> [!NOTE]
> <span data-ttu-id="da7b5-108">Le Cache Redis Azure prend en charge les réseaux virtuels classiques et de Gestionnaire de ressources.</span><span class="sxs-lookup"><span data-stu-id="da7b5-108">Azure Redis Cache supports both classic and Resource Manager VNets.</span></span>
> 
> 

<span data-ttu-id="da7b5-109">Pour plus d’informations sur d’autres fonctionnalités de cache premium, consultez [couche de présentation toohello Azure Redis Cache Premium](cache-premium-tier-intro.md).</span><span class="sxs-lookup"><span data-stu-id="da7b5-109">For information on other premium cache features, see [Introduction toohello Azure Redis Cache Premium tier](cache-premium-tier-intro.md).</span></span>

## <a name="why-vnet"></a><span data-ttu-id="da7b5-110">Pourquoi un réseau virtuel ?</span><span class="sxs-lookup"><span data-stu-id="da7b5-110">Why VNet?</span></span>
<span data-ttu-id="da7b5-111">[Réseau virtuel Azure (VNet)](https://azure.microsoft.com/services/virtual-network/) déploiement offre une sécurité accrue et isolation pour votre Cache Redis Azure, ainsi que des sous-réseaux, les stratégies de contrôle d’accès, et d’autres fonctionnalités toofurther restreindre l’accès.</span><span class="sxs-lookup"><span data-stu-id="da7b5-111">[Azure Virtual Network (VNet)](https://azure.microsoft.com/services/virtual-network/) deployment provides enhanced security and isolation for your Azure Redis Cache, as well as subnets, access control policies, and other features toofurther restrict access.</span></span>

## <a name="virtual-network-support"></a><span data-ttu-id="da7b5-112">Prise en charge des réseaux virtuels</span><span class="sxs-lookup"><span data-stu-id="da7b5-112">Virtual network support</span></span>
<span data-ttu-id="da7b5-113">Prise en charge du réseau virtuel virtuel est configuré sur hello **nouveau Cache Redis** panneau lors de la création du cache.</span><span class="sxs-lookup"><span data-stu-id="da7b5-113">Virtual Network (VNet) support is configured on hello **New Redis Cache** blade during cache creation.</span></span> 

[!INCLUDE [redis-cache-create](../../includes/redis-cache-premium-create.md)]

<span data-ttu-id="da7b5-114">Une fois que vous avez sélectionné un niveau tarifaire premium, vous pouvez configurer l’intégration de réseau virtuel de Redis en sélectionnant un réseau virtuel qui se trouve dans hello même abonnement et l’emplacement que votre cache.</span><span class="sxs-lookup"><span data-stu-id="da7b5-114">Once you have selected a premium pricing tier, you can configure Redis VNet integration by selecting a VNet that is in hello same subscription and location as your cache.</span></span> <span data-ttu-id="da7b5-115">toouse un nouveau réseau virtuel, créez-le tout d’abord en suivant les étapes de hello dans [créer un réseau virtuel à l’aide de hello portail Azure](../virtual-network/virtual-networks-create-vnet-arm-pportal.md) ou [créer un réseau virtuel (classiques) à l’aide de hello portail Azure](../virtual-network/virtual-networks-create-vnet-classic-pportal.md) , puis revenez toohello **Nouveau Cache Redis** panneau toocreate et configurer votre cache premium.</span><span class="sxs-lookup"><span data-stu-id="da7b5-115">toouse a new VNet, create it first by following hello steps in [Create a virtual network using hello Azure portal](../virtual-network/virtual-networks-create-vnet-arm-pportal.md) or [Create a virtual network (classic) by using hello Azure portal](../virtual-network/virtual-networks-create-vnet-classic-pportal.md) and then return toohello **New Redis Cache** blade toocreate and configure your premium cache.</span></span>

<span data-ttu-id="da7b5-116">tooconfigure hello réseau virtuel pour votre nouveau cache, cliquez sur **réseau virtuel** sur hello **nouveau Cache Redis** panneau et sélectionnez hello souhaitée réseau virtuel à partir de la liste déroulante de hello.</span><span class="sxs-lookup"><span data-stu-id="da7b5-116">tooconfigure hello VNet for your new cache, click **Virtual Network** on hello **New Redis Cache** blade, and select hello desired VNet from hello drop-down list.</span></span>

![Réseau virtuel][redis-cache-vnet]

<span data-ttu-id="da7b5-118">Sélectionnez hello sous-réseau souhaité à partir de hello **sous-réseau** déroulante répertorier et spécifiez hello souhaité **adresse IP statique**.</span><span class="sxs-lookup"><span data-stu-id="da7b5-118">Select hello desired subnet from hello **Subnet** drop-down list, and specify hello desired **Static IP address**.</span></span> <span data-ttu-id="da7b5-119">Si vous utilisez un Bonjour de réseau virtuel classique **adresse IP statique** champ est facultatif, et si aucun n’est spécifié, un est choisi de sous-réseau de hello sélectionné.</span><span class="sxs-lookup"><span data-stu-id="da7b5-119">If you are using a classic VNet hello **Static IP address** field is optional, and if none is specified, one is chosen from hello selected subnet.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="da7b5-120">Lorsque vous déployez un tooa de Cache Redis Azure Resource Manager VNet, le cache de hello doit être dans un sous-réseau dédié qui ne contient aucuns autres ressources à l’exception des instances de Cache Redis Azure.</span><span class="sxs-lookup"><span data-stu-id="da7b5-120">When deploying an Azure Redis Cache tooa Resource Manager VNet, hello cache must be in a dedicated subnet that contains no other resources except for Azure Redis Cache instances.</span></span> <span data-ttu-id="da7b5-121">Si une tentative est faite toodeploy un tooa de Cache Redis Azure Resource Manager VNet tooa sous-réseau qui contient d’autres ressources, le déploiement de hello échoue.</span><span class="sxs-lookup"><span data-stu-id="da7b5-121">If an attempt is made toodeploy an Azure Redis Cache tooa Resource Manager VNet tooa subnet that contains other resources, hello deployment fails.</span></span>
> 
> 

![Réseau virtuel][redis-cache-vnet-ip]

> [!IMPORTANT]
> <span data-ttu-id="da7b5-123">Azure réserve dans chaque sous-réseau des adresses IP qui ne peuvent pas être utilisées.</span><span class="sxs-lookup"><span data-stu-id="da7b5-123">Azure reserves some IP addresses within each subnet, and these addresses can't be used.</span></span> <span data-ttu-id="da7b5-124">Hello prénom et adresses IP des sous-réseaux de hello sont réservés pour la conformité de protocole, ainsi que les trois adresses plus utilisé pour les services Azure.</span><span class="sxs-lookup"><span data-stu-id="da7b5-124">hello first and last IP addresses of hello subnets are reserved for protocol conformance, along with three more addresses used for Azure services.</span></span> <span data-ttu-id="da7b5-125">Pour plus d’informations, consultez [Existe-t-il des restrictions sur l’utilisation des adresses IP au sein de ces sous-réseaux ?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span><span class="sxs-lookup"><span data-stu-id="da7b5-125">For more information, see [Are there any restrictions on using IP addresses within these subnets?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span></span>
> 
> <span data-ttu-id="da7b5-126">Ajout des adresses IP toohello utilisé par l’infrastructure de réseau virtuel Azure hello, chaque Redis instance hello sous-réseau utilise deux adresses IP par partition et une adresse IP supplémentaire pour l’équilibrage de charge hello.</span><span class="sxs-lookup"><span data-stu-id="da7b5-126">In addition toohello IP addresses used by hello Azure VNET infrastructure, each Redis instance in hello subnet uses two IP addresses per shard and one additional IP address for hello load balancer.</span></span> <span data-ttu-id="da7b5-127">Un cache non cluster est considéré comme toohave une seule partition.</span><span class="sxs-lookup"><span data-stu-id="da7b5-127">A non-clustered cache is considered toohave one shard.</span></span>
> 
> 

<span data-ttu-id="da7b5-128">Une fois le cache de hello est créé, vous pouvez afficher la configuration hello pour hello réseau virtuel en cliquant sur **réseau virtuel** de hello **menu ressource**.</span><span class="sxs-lookup"><span data-stu-id="da7b5-128">After hello cache is created, you can view hello configuration for hello VNet by clicking **Virtual Network** from hello **Resource menu**.</span></span>

![Réseau virtuel][redis-cache-vnet-info]

<span data-ttu-id="da7b5-130">tooconnect tooyour Azure Redis cache instance lors de l’utilisation d’un réseau virtuel, spécifiez le nom d’hôte hello de votre cache dans la chaîne de connexion hello comme indiqué dans hello l’exemple suivant :</span><span class="sxs-lookup"><span data-stu-id="da7b5-130">tooconnect tooyour Azure Redis cache instance when using a VNet, specify hello host name of your cache in hello connection string as shown in hello following example:</span></span>

    private static Lazy<ConnectionMultiplexer> lazyConnection = new Lazy<ConnectionMultiplexer>(() =>
    {
        return ConnectionMultiplexer.Connect("contoso5premium.redis.cache.windows.net,abortConnect=false,ssl=true,password=password");
    });

    public static ConnectionMultiplexer Connection
    {
        get
        {
            return lazyConnection.Value;
        }
    }

## <a name="azure-redis-cache-vnet-faq"></a><span data-ttu-id="da7b5-131">Forum aux questions sur le réseau virtuel de Cache Redis Azure</span><span class="sxs-lookup"><span data-stu-id="da7b5-131">Azure Redis Cache VNet FAQ</span></span>
<span data-ttu-id="da7b5-132">Hello suivant liste contient toocommonly des réponses aux questions sur la mise à l’échelle du Cache Redis Azure hello.</span><span class="sxs-lookup"><span data-stu-id="da7b5-132">hello following list contains answers toocommonly asked questions about hello Azure Redis Cache scaling.</span></span>

* [<span data-ttu-id="da7b5-133">Quels sont les problèmes de configuration les plus courants au niveau du Cache Redis Azure et des réseaux virtuels ?</span><span class="sxs-lookup"><span data-stu-id="da7b5-133">What are some common misconfiguration issues with Azure Redis Cache and VNets?</span></span>](#what-are-some-common-misconfiguration-issues-with-azure-redis-cache-and-vnets)
* [<span data-ttu-id="da7b5-134">Comment puis-je vérifier que mon cache fonctionne dans un réseau virtuel ?</span><span class="sxs-lookup"><span data-stu-id="da7b5-134">How can I verify that my cache is working in a VNET?</span></span>](#how-can-i-verify-that-my-cache-is-working-in-a-vnet)
* [<span data-ttu-id="da7b5-135">Puis-je utiliser des réseaux virtuels avec un cache De base ou Standard ?</span><span class="sxs-lookup"><span data-stu-id="da7b5-135">Can I use VNets with a standard or basic cache?</span></span>](#can-i-use-vnets-with-a-standard-or-basic-cache)
* [<span data-ttu-id="da7b5-136">Pourquoi la création d’un cache Redis échoue-t-elle dans certains sous-réseaux mais pas d’autres ?</span><span class="sxs-lookup"><span data-stu-id="da7b5-136">Why does creating a Redis cache fail in some subnets but not others?</span></span>](#why-does-creating-a-redis-cache-fail-in-some-subnets-but-not-others)
* [<span data-ttu-id="da7b5-137">Quelles sont les conditions d’espace d’adressage hello sous-réseau ?</span><span class="sxs-lookup"><span data-stu-id="da7b5-137">What are hello subnet address space requirements?</span></span>](#what-are-the-subnet-address-space-requirements)
* [<span data-ttu-id="da7b5-138">Toutes les fonctionnalités fonctionnent-elles lorsque vous hébergez un cache dans un réseau virtuel ?</span><span class="sxs-lookup"><span data-stu-id="da7b5-138">Do all cache features work when hosting a cache in a VNET?</span></span>](#do-all-cache-features-work-when-hosting-a-cache-in-a-vnet)

## <a name="what-are-some-common-misconfiguration-issues-with-azure-redis-cache-and-vnets"></a><span data-ttu-id="da7b5-139">Quels sont les problèmes de configuration les plus courants au niveau du Cache Redis Azure et des réseaux virtuels ?</span><span class="sxs-lookup"><span data-stu-id="da7b5-139">What are some common misconfiguration issues with Azure Redis Cache and VNets?</span></span>
<span data-ttu-id="da7b5-140">Lorsque le Cache Redis Azure est hébergé dans un réseau virtuel, les ports hello Bonjour les tableaux suivants sont utilisés.</span><span class="sxs-lookup"><span data-stu-id="da7b5-140">When Azure Redis Cache is hosted in a VNet, hello ports in hello following tables are used.</span></span> 

>[!IMPORTANT]
><span data-ttu-id="da7b5-141">Si les ports hello Bonjour les tableaux suivants sont bloqués, le cache de hello peut ne pas fonctionne correctement.</span><span class="sxs-lookup"><span data-stu-id="da7b5-141">If hello ports in hello following tables are blocked, hello cache may not function correctly.</span></span> <span data-ttu-id="da7b5-142">Un ou plusieurs de ces ports bloqués est problème de configuration incorrecte hello plus courant lors de l’utilisation du Cache Redis Azure dans un réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="da7b5-142">Having one or more of these ports blocked is hello most common misconfiguration issue when using Azure Redis Cache in a VNet.</span></span>
> 
> 

- [<span data-ttu-id="da7b5-143">Configuration requise de port sortant</span><span class="sxs-lookup"><span data-stu-id="da7b5-143">Outbound port requirements</span></span>](#outbound-port-requirements)
- [<span data-ttu-id="da7b5-144">Configuration requise de port entrant</span><span class="sxs-lookup"><span data-stu-id="da7b5-144">Inbound port requirements</span></span>](#inbound-port-requirements)

### <a name="outbound-port-requirements"></a><span data-ttu-id="da7b5-145">Configuration requise de port sortant</span><span class="sxs-lookup"><span data-stu-id="da7b5-145">Outbound port requirements</span></span>

<span data-ttu-id="da7b5-146">Il existe sept configurations requises de port sortant.</span><span class="sxs-lookup"><span data-stu-id="da7b5-146">There are seven outbound port requirements.</span></span>

- <span data-ttu-id="da7b5-147">Si vous le souhaitez, toutes les connexions sortantes toohello internet peut être effectuées par le biais d’un client audit appareil local.</span><span class="sxs-lookup"><span data-stu-id="da7b5-147">If desired, all outbound connections toohello internet can be made through a client's on-premises auditing device.</span></span>
- <span data-ttu-id="da7b5-148">Trois des ports de hello acheminer les points de terminaison du trafic tooAzure maintenance Azure Storage et Azure DNS.</span><span class="sxs-lookup"><span data-stu-id="da7b5-148">Three of hello ports route traffic tooAzure endpoints servicing Azure Storage and Azure DNS.</span></span>
- <span data-ttu-id="da7b5-149">Hello restant des plages de ports et les communications de sous-réseau internes Redis.</span><span class="sxs-lookup"><span data-stu-id="da7b5-149">hello remaining port ranges and for internal Redis subnet communications.</span></span> <span data-ttu-id="da7b5-150">Aucune règle de groupe de sécurité réseau de sous-réseau n’est requise pour les communications sur sous-réseau Redis interne.</span><span class="sxs-lookup"><span data-stu-id="da7b5-150">No subnet NSG rules are required for internal Redis subnet communications.</span></span>

| <span data-ttu-id="da7b5-151">Port(s)</span><span class="sxs-lookup"><span data-stu-id="da7b5-151">Port(s)</span></span> | <span data-ttu-id="da7b5-152">Direction</span><span class="sxs-lookup"><span data-stu-id="da7b5-152">Direction</span></span> | <span data-ttu-id="da7b5-153">Protocole de transfert</span><span class="sxs-lookup"><span data-stu-id="da7b5-153">Transport Protocol</span></span> | <span data-ttu-id="da7b5-154">Objectif</span><span class="sxs-lookup"><span data-stu-id="da7b5-154">Purpose</span></span> | <span data-ttu-id="da7b5-155">Adresse IP locale</span><span class="sxs-lookup"><span data-stu-id="da7b5-155">Local IP</span></span> | <span data-ttu-id="da7b5-156">Adresse IP distante</span><span class="sxs-lookup"><span data-stu-id="da7b5-156">Remote IP</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="da7b5-157">80, 443</span><span class="sxs-lookup"><span data-stu-id="da7b5-157">80, 443</span></span> |<span data-ttu-id="da7b5-158">Règle de trafic sortant</span><span class="sxs-lookup"><span data-stu-id="da7b5-158">Outbound</span></span> |<span data-ttu-id="da7b5-159">TCP</span><span class="sxs-lookup"><span data-stu-id="da7b5-159">TCP</span></span> |<span data-ttu-id="da7b5-160">Dépendances Redis sur Azure Storage/l’infrastructure à clé publique (Internet)</span><span class="sxs-lookup"><span data-stu-id="da7b5-160">Redis dependencies on Azure Storage/PKI (Internet)</span></span> | <span data-ttu-id="da7b5-161">(sous-réseau Redis)</span><span class="sxs-lookup"><span data-stu-id="da7b5-161">(Redis subnet)</span></span> |* |
| <span data-ttu-id="da7b5-162">53</span><span class="sxs-lookup"><span data-stu-id="da7b5-162">53</span></span> |<span data-ttu-id="da7b5-163">Règle de trafic sortant</span><span class="sxs-lookup"><span data-stu-id="da7b5-163">Outbound</span></span> |<span data-ttu-id="da7b5-164">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="da7b5-164">TCP/UDP</span></span> |<span data-ttu-id="da7b5-165">Dépendances Redis sur le DNS (Internet/réseau virtuel)</span><span class="sxs-lookup"><span data-stu-id="da7b5-165">Redis dependencies on DNS (Internet/VNet)</span></span> | <span data-ttu-id="da7b5-166">(sous-réseau Redis)</span><span class="sxs-lookup"><span data-stu-id="da7b5-166">(Redis subnet)</span></span> |* |
| <span data-ttu-id="da7b5-167">8443</span><span class="sxs-lookup"><span data-stu-id="da7b5-167">8443</span></span> |<span data-ttu-id="da7b5-168">Règle de trafic sortant</span><span class="sxs-lookup"><span data-stu-id="da7b5-168">Outbound</span></span> |<span data-ttu-id="da7b5-169">TCP</span><span class="sxs-lookup"><span data-stu-id="da7b5-169">TCP</span></span> |<span data-ttu-id="da7b5-170">Communications internes pour Redis</span><span class="sxs-lookup"><span data-stu-id="da7b5-170">Internal communications for Redis</span></span> | <span data-ttu-id="da7b5-171">(sous-réseau Redis)</span><span class="sxs-lookup"><span data-stu-id="da7b5-171">(Redis subnet)</span></span> | <span data-ttu-id="da7b5-172">(sous-réseau Redis)</span><span class="sxs-lookup"><span data-stu-id="da7b5-172">(Redis subnet)</span></span> |
| <span data-ttu-id="da7b5-173">10221-10231</span><span class="sxs-lookup"><span data-stu-id="da7b5-173">10221-10231</span></span> |<span data-ttu-id="da7b5-174">Règle de trafic sortant</span><span class="sxs-lookup"><span data-stu-id="da7b5-174">Outbound</span></span> |<span data-ttu-id="da7b5-175">TCP</span><span class="sxs-lookup"><span data-stu-id="da7b5-175">TCP</span></span> |<span data-ttu-id="da7b5-176">Communications internes pour Redis</span><span class="sxs-lookup"><span data-stu-id="da7b5-176">Internal communications for Redis</span></span> | <span data-ttu-id="da7b5-177">(sous-réseau Redis)</span><span class="sxs-lookup"><span data-stu-id="da7b5-177">(Redis subnet)</span></span> | <span data-ttu-id="da7b5-178">(sous-réseau Redis)</span><span class="sxs-lookup"><span data-stu-id="da7b5-178">(Redis subnet)</span></span> |
| <span data-ttu-id="da7b5-179">20226</span><span class="sxs-lookup"><span data-stu-id="da7b5-179">20226</span></span> |<span data-ttu-id="da7b5-180">Règle de trafic sortant</span><span class="sxs-lookup"><span data-stu-id="da7b5-180">Outbound</span></span> |<span data-ttu-id="da7b5-181">TCP</span><span class="sxs-lookup"><span data-stu-id="da7b5-181">TCP</span></span> |<span data-ttu-id="da7b5-182">Communications internes pour Redis</span><span class="sxs-lookup"><span data-stu-id="da7b5-182">Internal communications for Redis</span></span> | <span data-ttu-id="da7b5-183">(sous-réseau Redis)</span><span class="sxs-lookup"><span data-stu-id="da7b5-183">(Redis subnet)</span></span> |<span data-ttu-id="da7b5-184">(sous-réseau Redis)</span><span class="sxs-lookup"><span data-stu-id="da7b5-184">(Redis subnet)</span></span> |
| <span data-ttu-id="da7b5-185">13000-13999</span><span class="sxs-lookup"><span data-stu-id="da7b5-185">13000-13999</span></span> |<span data-ttu-id="da7b5-186">Règle de trafic sortant</span><span class="sxs-lookup"><span data-stu-id="da7b5-186">Outbound</span></span> |<span data-ttu-id="da7b5-187">TCP</span><span class="sxs-lookup"><span data-stu-id="da7b5-187">TCP</span></span> |<span data-ttu-id="da7b5-188">Communications internes pour Redis</span><span class="sxs-lookup"><span data-stu-id="da7b5-188">Internal communications for Redis</span></span> | <span data-ttu-id="da7b5-189">(sous-réseau Redis)</span><span class="sxs-lookup"><span data-stu-id="da7b5-189">(Redis subnet)</span></span> |<span data-ttu-id="da7b5-190">(sous-réseau Redis)</span><span class="sxs-lookup"><span data-stu-id="da7b5-190">(Redis subnet)</span></span> |
| <span data-ttu-id="da7b5-191">15000-15999</span><span class="sxs-lookup"><span data-stu-id="da7b5-191">15000-15999</span></span> |<span data-ttu-id="da7b5-192">Règle de trafic sortant</span><span class="sxs-lookup"><span data-stu-id="da7b5-192">Outbound</span></span> |<span data-ttu-id="da7b5-193">TCP</span><span class="sxs-lookup"><span data-stu-id="da7b5-193">TCP</span></span> |<span data-ttu-id="da7b5-194">Communications internes pour Redis</span><span class="sxs-lookup"><span data-stu-id="da7b5-194">Internal communications for Redis</span></span> | <span data-ttu-id="da7b5-195">(sous-réseau Redis)</span><span class="sxs-lookup"><span data-stu-id="da7b5-195">(Redis subnet)</span></span> |<span data-ttu-id="da7b5-196">(sous-réseau Redis)</span><span class="sxs-lookup"><span data-stu-id="da7b5-196">(Redis subnet)</span></span> |


### <a name="inbound-port-requirements"></a><span data-ttu-id="da7b5-197">Configuration requise des ports entrants</span><span class="sxs-lookup"><span data-stu-id="da7b5-197">Inbound port requirements</span></span>

<span data-ttu-id="da7b5-198">Il existe huit configurations requises de port entrant.</span><span class="sxs-lookup"><span data-stu-id="da7b5-198">There are eight inbound port range requirements.</span></span> <span data-ttu-id="da7b5-199">Les demandes entrantes de ces plages sont entrantes à partir d’autres services hébergés dans hello même réseau virtuel ou interne toohello communications de sous-réseau Redis.</span><span class="sxs-lookup"><span data-stu-id="da7b5-199">Inbound requests in these ranges are either inbound from other services hosted in hello same VNET or internal toohello Redis subnet communications.</span></span>

| <span data-ttu-id="da7b5-200">Port(s)</span><span class="sxs-lookup"><span data-stu-id="da7b5-200">Port(s)</span></span> | <span data-ttu-id="da7b5-201">Direction</span><span class="sxs-lookup"><span data-stu-id="da7b5-201">Direction</span></span> | <span data-ttu-id="da7b5-202">Protocole de transfert</span><span class="sxs-lookup"><span data-stu-id="da7b5-202">Transport Protocol</span></span> | <span data-ttu-id="da7b5-203">Objectif</span><span class="sxs-lookup"><span data-stu-id="da7b5-203">Purpose</span></span> | <span data-ttu-id="da7b5-204">Adresse IP locale</span><span class="sxs-lookup"><span data-stu-id="da7b5-204">Local IP</span></span> | <span data-ttu-id="da7b5-205">Adresse IP distante</span><span class="sxs-lookup"><span data-stu-id="da7b5-205">Remote IP</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="da7b5-206">6379, 6380</span><span class="sxs-lookup"><span data-stu-id="da7b5-206">6379, 6380</span></span> |<span data-ttu-id="da7b5-207">Trafic entrant</span><span class="sxs-lookup"><span data-stu-id="da7b5-207">Inbound</span></span> |<span data-ttu-id="da7b5-208">TCP</span><span class="sxs-lookup"><span data-stu-id="da7b5-208">TCP</span></span> |<span data-ttu-id="da7b5-209">L’équilibrage de charge de Azure tooRedis de communication client,</span><span class="sxs-lookup"><span data-stu-id="da7b5-209">Client communication tooRedis, Azure load balancing</span></span> | <span data-ttu-id="da7b5-210">(sous-réseau Redis)</span><span class="sxs-lookup"><span data-stu-id="da7b5-210">(Redis subnet)</span></span> |<span data-ttu-id="da7b5-211">Réseau virtuel, Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="da7b5-211">Virtual Network, Azure Load Balancer</span></span> |
| <span data-ttu-id="da7b5-212">8443</span><span class="sxs-lookup"><span data-stu-id="da7b5-212">8443</span></span> |<span data-ttu-id="da7b5-213">Trafic entrant</span><span class="sxs-lookup"><span data-stu-id="da7b5-213">Inbound</span></span> |<span data-ttu-id="da7b5-214">TCP</span><span class="sxs-lookup"><span data-stu-id="da7b5-214">TCP</span></span> |<span data-ttu-id="da7b5-215">Communications internes pour Redis</span><span class="sxs-lookup"><span data-stu-id="da7b5-215">Internal communications for Redis</span></span> | <span data-ttu-id="da7b5-216">(sous-réseau Redis)</span><span class="sxs-lookup"><span data-stu-id="da7b5-216">(Redis subnet)</span></span> |<span data-ttu-id="da7b5-217">(sous-réseau Redis)</span><span class="sxs-lookup"><span data-stu-id="da7b5-217">(Redis subnet)</span></span> |
| <span data-ttu-id="da7b5-218">8500</span><span class="sxs-lookup"><span data-stu-id="da7b5-218">8500</span></span> |<span data-ttu-id="da7b5-219">Trafic entrant</span><span class="sxs-lookup"><span data-stu-id="da7b5-219">Inbound</span></span> |<span data-ttu-id="da7b5-220">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="da7b5-220">TCP/UDP</span></span> |<span data-ttu-id="da7b5-221">Équilibrage de charge Azure</span><span class="sxs-lookup"><span data-stu-id="da7b5-221">Azure load balancing</span></span> | <span data-ttu-id="da7b5-222">(sous-réseau Redis)</span><span class="sxs-lookup"><span data-stu-id="da7b5-222">(Redis subnet)</span></span> |<span data-ttu-id="da7b5-223">Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="da7b5-223">Azure Load Balancer</span></span> |
| <span data-ttu-id="da7b5-224">10221-10231</span><span class="sxs-lookup"><span data-stu-id="da7b5-224">10221-10231</span></span> |<span data-ttu-id="da7b5-225">Trafic entrant</span><span class="sxs-lookup"><span data-stu-id="da7b5-225">Inbound</span></span> |<span data-ttu-id="da7b5-226">TCP</span><span class="sxs-lookup"><span data-stu-id="da7b5-226">TCP</span></span> |<span data-ttu-id="da7b5-227">Communications internes pour Redis</span><span class="sxs-lookup"><span data-stu-id="da7b5-227">Internal communications for Redis</span></span> | <span data-ttu-id="da7b5-228">(sous-réseau Redis)</span><span class="sxs-lookup"><span data-stu-id="da7b5-228">(Redis subnet)</span></span> |<span data-ttu-id="da7b5-229">(Sous-réseau Redis) Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="da7b5-229">(Redis subnet), Azure Load Balancer</span></span> |
| <span data-ttu-id="da7b5-230">13000-13999</span><span class="sxs-lookup"><span data-stu-id="da7b5-230">13000-13999</span></span> |<span data-ttu-id="da7b5-231">Trafic entrant</span><span class="sxs-lookup"><span data-stu-id="da7b5-231">Inbound</span></span> |<span data-ttu-id="da7b5-232">TCP</span><span class="sxs-lookup"><span data-stu-id="da7b5-232">TCP</span></span> |<span data-ttu-id="da7b5-233">L’équilibrage de charge de Clusters, Azure tooRedis de communication client</span><span class="sxs-lookup"><span data-stu-id="da7b5-233">Client communication tooRedis Clusters, Azure load balancing</span></span> | <span data-ttu-id="da7b5-234">(sous-réseau Redis)</span><span class="sxs-lookup"><span data-stu-id="da7b5-234">(Redis subnet)</span></span> |<span data-ttu-id="da7b5-235">Réseau virtuel, Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="da7b5-235">Virtual Network, Azure Load Balancer</span></span> |
| <span data-ttu-id="da7b5-236">15000-15999</span><span class="sxs-lookup"><span data-stu-id="da7b5-236">15000-15999</span></span> |<span data-ttu-id="da7b5-237">Trafic entrant</span><span class="sxs-lookup"><span data-stu-id="da7b5-237">Inbound</span></span> |<span data-ttu-id="da7b5-238">TCP</span><span class="sxs-lookup"><span data-stu-id="da7b5-238">TCP</span></span> |<span data-ttu-id="da7b5-239">L’équilibrage de charge de Clusters, Azure tooRedis de communication client</span><span class="sxs-lookup"><span data-stu-id="da7b5-239">Client communication tooRedis Clusters, Azure load Balancing</span></span> | <span data-ttu-id="da7b5-240">(sous-réseau Redis)</span><span class="sxs-lookup"><span data-stu-id="da7b5-240">(Redis subnet)</span></span> |<span data-ttu-id="da7b5-241">Réseau virtuel, Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="da7b5-241">Virtual Network, Azure Load Balancer</span></span> |
| <span data-ttu-id="da7b5-242">16001</span><span class="sxs-lookup"><span data-stu-id="da7b5-242">16001</span></span> |<span data-ttu-id="da7b5-243">Trafic entrant</span><span class="sxs-lookup"><span data-stu-id="da7b5-243">Inbound</span></span> |<span data-ttu-id="da7b5-244">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="da7b5-244">TCP/UDP</span></span> |<span data-ttu-id="da7b5-245">Équilibrage de charge Azure</span><span class="sxs-lookup"><span data-stu-id="da7b5-245">Azure load balancing</span></span> | <span data-ttu-id="da7b5-246">(sous-réseau Redis)</span><span class="sxs-lookup"><span data-stu-id="da7b5-246">(Redis subnet)</span></span> |<span data-ttu-id="da7b5-247">Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="da7b5-247">Azure Load Balancer</span></span> |
| <span data-ttu-id="da7b5-248">20226</span><span class="sxs-lookup"><span data-stu-id="da7b5-248">20226</span></span> |<span data-ttu-id="da7b5-249">Trafic entrant</span><span class="sxs-lookup"><span data-stu-id="da7b5-249">Inbound</span></span> |<span data-ttu-id="da7b5-250">TCP</span><span class="sxs-lookup"><span data-stu-id="da7b5-250">TCP</span></span> |<span data-ttu-id="da7b5-251">Communications internes pour Redis</span><span class="sxs-lookup"><span data-stu-id="da7b5-251">Internal communications for Redis</span></span> | <span data-ttu-id="da7b5-252">(sous-réseau Redis)</span><span class="sxs-lookup"><span data-stu-id="da7b5-252">(Redis subnet)</span></span> |<span data-ttu-id="da7b5-253">(sous-réseau Redis)</span><span class="sxs-lookup"><span data-stu-id="da7b5-253">(Redis subnet)</span></span> |

### <a name="additional-vnet-network-connectivity-requirements"></a><span data-ttu-id="da7b5-254">Conditions supplémentaires pour la connectivité réseau VNET</span><span class="sxs-lookup"><span data-stu-id="da7b5-254">Additional VNET network connectivity requirements</span></span>

<span data-ttu-id="da7b5-255">Il existe des exigences de connectivité réseau pour le Cache Redis Azure qui peuvent ne pas être initialement satisfaites dans un réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="da7b5-255">There are network connectivity requirements for Azure Redis Cache that may not be initially met in a virtual network.</span></span> <span data-ttu-id="da7b5-256">Cache Redis Azure nécessite que tous les hello suivant toofunction éléments correctement lorsqu’il est utilisé dans un réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="da7b5-256">Azure Redis Cache requires all hello following items toofunction properly when used within a virtual network.</span></span>

* <span data-ttu-id="da7b5-257">Réseau sortant connectivité tooAzure stockage points de terminaison dans le monde entier.</span><span class="sxs-lookup"><span data-stu-id="da7b5-257">Outbound network connectivity tooAzure Storage endpoints worldwide.</span></span> <span data-ttu-id="da7b5-258">Cela inclut les points de terminaison situés dans hello même région que l’instance de Cache Redis Azure hello, ainsi que les points de terminaison de stockage situés dans **autres** régions Azure.</span><span class="sxs-lookup"><span data-stu-id="da7b5-258">This includes endpoints located in hello same region as hello Azure Redis Cache instance, as well as storage endpoints located in **other** Azure regions.</span></span> <span data-ttu-id="da7b5-259">Résoudre les points de terminaison de stockage Azure sous hello suivant domaines DNS : *table.core.windows.net*, *blob.core.windows.net*, *queue.core.windows.net*et *file.core.windows.net*.</span><span class="sxs-lookup"><span data-stu-id="da7b5-259">Azure Storage endpoints resolve under hello following DNS domains: *table.core.windows.net*, *blob.core.windows.net*, *queue.core.windows.net*, and *file.core.windows.net*.</span></span> 
* <span data-ttu-id="da7b5-260">Sortant trop de connectivité réseau*ocsp.msocsp.com*, *mscrl.microsoft.com*, et *crl.microsoft.com*. Cette connectivité est une fonctionnalité SSL toosupport nécessaires.</span><span class="sxs-lookup"><span data-stu-id="da7b5-260">Outbound network connectivity too*ocsp.msocsp.com*, *mscrl.microsoft.com*, and *crl.microsoft.com*. This connectivity is needed toosupport SSL functionality.</span></span>
* <span data-ttu-id="da7b5-261">configuration du DNS pour le réseau virtuel de hello Hello doit être capable de résoudre tous les points de terminaison hello et domaines mentionné dans hello points précédents.</span><span class="sxs-lookup"><span data-stu-id="da7b5-261">hello DNS configuration for hello virtual network must be capable of resolving all of hello endpoints and domains mentioned in hello earlier points.</span></span> <span data-ttu-id="da7b5-262">Ces exigences DNS peuvent être remplies en garantissant une infrastructure DNS valide est configurée et gérée pour le réseau virtuel de hello.</span><span class="sxs-lookup"><span data-stu-id="da7b5-262">These DNS requirements can be met by ensuring a valid DNS infrastructure is configured and maintained for hello virtual network.</span></span>
* <span data-ttu-id="da7b5-263">Toohello de connectivité réseau sortant suivant de surveillance Azure points de terminaison résoudre sous hello suivant domaines DNS : shoebox2-black.shoebox2.metrics.nsatc.net, Nord-prod2.prod2.metrics.nsatc.net, azglobal black.azglobal.metrics.nsatc.net, shoebox2-red.shoebox2.metrics.nsatc.net, est-prod2.prod2.metrics.nsatc.net, azglobal-red.azglobal.metrics.nsatc.net.</span><span class="sxs-lookup"><span data-stu-id="da7b5-263">Outbound network connectivity toohello following Azure Monitoring endpoints, which resolve under hello following DNS domains: shoebox2-black.shoebox2.metrics.nsatc.net, north-prod2.prod2.metrics.nsatc.net, azglobal-black.azglobal.metrics.nsatc.net, shoebox2-red.shoebox2.metrics.nsatc.net, east-prod2.prod2.metrics.nsatc.net, azglobal-red.azglobal.metrics.nsatc.net.</span></span>

### <a name="how-can-i-verify-that-my-cache-is-working-in-a-vnet"></a><span data-ttu-id="da7b5-264">Comment puis-je vérifier que mon cache fonctionne dans un réseau virtuel ?</span><span class="sxs-lookup"><span data-stu-id="da7b5-264">How can I verify that my cache is working in a VNET?</span></span>

>[!IMPORTANT]
><span data-ttu-id="da7b5-265">Lors de la connexion d’instance de Cache Redis Azure tooan qui est hébergé dans un réseau virtuel, les clients doivent être dans le cache de votre hello même réseau virtuel, y compris les applications de test ou les outils de diagnostic de test ping.</span><span class="sxs-lookup"><span data-stu-id="da7b5-265">When connecting tooan Azure Redis Cache instance that is hosted in a VNET, your cache clients must be in hello same VNET, including any test applications or diagnostic pinging tools.</span></span>
>
>

<span data-ttu-id="da7b5-266">Une fois les exigences du port hello sont configurés comme décrit dans la section précédente de hello, vous pouvez vérifier que votre cache fonctionne en effectuant hello comme suit.</span><span class="sxs-lookup"><span data-stu-id="da7b5-266">Once hello port requirements are configured as described in hello previous section, you can verify that your cache is working by performing hello following steps.</span></span>

- <span data-ttu-id="da7b5-267">[Redémarrez](cache-administration.md#reboot) hello tous les nœuds de cache.</span><span class="sxs-lookup"><span data-stu-id="da7b5-267">[Reboot](cache-administration.md#reboot) all of hello cache nodes.</span></span> <span data-ttu-id="da7b5-268">Si toutes les Hello requises de dépendances de cache n’est pas accessible (comme décrit dans [entrant des exigences de ports](cache-how-to-premium-vnet.md#inbound-port-requirements) et [les exigences de port de sortie](cache-how-to-premium-vnet.md#outbound-port-requirements)), cache de hello ne pourra plus être en mesure de toorestart avec succès.</span><span class="sxs-lookup"><span data-stu-id="da7b5-268">If all of hello required cache dependencies can't be reached (as documented in [Inbound port requirements](cache-how-to-premium-vnet.md#inbound-port-requirements) and [Outbound port requirements](cache-how-to-premium-vnet.md#outbound-port-requirements)), hello cache won't be able toorestart successfully.</span></span>
- <span data-ttu-id="da7b5-269">Une fois les nœuds de cache hello ont redémarré (comme indiqué par état du cache hello Bonjour portail Azure), vous pouvez effectuer hello suite de tests :</span><span class="sxs-lookup"><span data-stu-id="da7b5-269">Once hello cache nodes have restarted (as reported by hello cache status in hello Azure portal), you can perform hello following tests:</span></span>
  - <span data-ttu-id="da7b5-270">ping hello cache du point de terminaison (à l’aide du port 6380) à partir d’un ordinateur qui se trouve dans hello même réseau virtuel en tant que hello mise en cache, à l’aide de [tcping](https://www.elifulkerson.com/projects/tcping.php).</span><span class="sxs-lookup"><span data-stu-id="da7b5-270">ping hello cache endpoint (using port 6380) from a machine that is within hello same VNET as hello cache, using [tcping](https://www.elifulkerson.com/projects/tcping.php).</span></span> <span data-ttu-id="da7b5-271">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="da7b5-271">For example:</span></span>
    
    `tcping.exe contosocache.redis.cache.windows.net 6380`
    
    <span data-ttu-id="da7b5-272">Si hello `tcping` outil signale que hello port est ouvert, le cache de hello est disponible pour la connexion à partir de clients Bonjour réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="da7b5-272">If hello `tcping` tool reports that hello port is open, hello cache is available for connection from clients in hello VNET.</span></span>

  - <span data-ttu-id="da7b5-273">Une autre façon tootest est toocreate un client de cache de test (qui peut être une simple application console à l’aide de StackExchange.Redis) qui se connecte toohello cache et ajoute et récupère des éléments du cache de hello.</span><span class="sxs-lookup"><span data-stu-id="da7b5-273">Another way tootest is toocreate a test cache client (which could be a simple console application using StackExchange.Redis) that connects toohello cache and adds and retrieves some items from hello cache.</span></span> <span data-ttu-id="da7b5-274">Installer hello exemple d’application cliente sur un ordinateur virtuel qui se trouve dans hello même réseau virtuel en tant que cache de hello et exécutez-le toohello cache de la connectivité tooverify.</span><span class="sxs-lookup"><span data-stu-id="da7b5-274">Install hello sample client application onto a VM that is in hello same VNET as hello cache and run it tooverify connectivity toohello cache.</span></span>


### <a name="can-i-use-vnets-with-a-standard-or-basic-cache"></a><span data-ttu-id="da7b5-275">Puis-je utiliser des réseaux virtuels avec un cache De base ou Standard ?</span><span class="sxs-lookup"><span data-stu-id="da7b5-275">Can I use VNets with a standard or basic cache?</span></span>
<span data-ttu-id="da7b5-276">Vous ne pouvez utiliser des réseaux virtuels qu’avec les caches de niveau Premium.</span><span class="sxs-lookup"><span data-stu-id="da7b5-276">VNets can only be used with premium caches.</span></span>

### <a name="why-does-creating-a-redis-cache-fail-in-some-subnets-but-not-others"></a><span data-ttu-id="da7b5-277">Pourquoi la création d’un cache Redis échoue-t-elle dans certains sous-réseaux mais pas d’autres ?</span><span class="sxs-lookup"><span data-stu-id="da7b5-277">Why does creating a Redis cache fail in some subnets but not others?</span></span>
<span data-ttu-id="da7b5-278">Si vous déployez un tooa de Cache Redis Azure Resource Manager VNet, le cache de hello doit être dans un sous-réseau dédié qui ne contient aucun autre type de ressource.</span><span class="sxs-lookup"><span data-stu-id="da7b5-278">If you are deploying an Azure Redis Cache tooa Resource Manager VNet, hello cache must be in a dedicated subnet that contains no other resource type.</span></span> <span data-ttu-id="da7b5-279">Si une tentative est faite toodeploy un tooa de Cache Redis Azure Resource Manager VNet sous-réseau qui contient d’autres ressources, le déploiement de hello échoue.</span><span class="sxs-lookup"><span data-stu-id="da7b5-279">If an attempt is made toodeploy an Azure Redis Cache tooa Resource Manager VNet subnet that contains other resources, hello deployment fails.</span></span> <span data-ttu-id="da7b5-280">Vous devez supprimer les ressources existantes de hello hello sous-réseau avant de pouvoir créer un nouveau cache Redis.</span><span class="sxs-lookup"><span data-stu-id="da7b5-280">You must delete hello existing resources inside hello subnet before you can create a new Redis cache.</span></span>

<span data-ttu-id="da7b5-281">Vous pouvez déployer plusieurs types de ressources tooa réseau virtuel classique tant que vous disposez d’assez IP adresses disponibles.</span><span class="sxs-lookup"><span data-stu-id="da7b5-281">You can deploy multiple types of resources tooa classic VNet as long as you have enough IP addresses available.</span></span>

### <a name="what-are-hello-subnet-address-space-requirements"></a><span data-ttu-id="da7b5-282">Quelles sont les conditions d’espace d’adressage hello sous-réseau ?</span><span class="sxs-lookup"><span data-stu-id="da7b5-282">What are hello subnet address space requirements?</span></span>
<span data-ttu-id="da7b5-283">Azure réserve dans chaque sous-réseau des adresses IP qui ne peuvent pas être utilisées.</span><span class="sxs-lookup"><span data-stu-id="da7b5-283">Azure reserves some IP addresses within each subnet, and these addresses can't be used.</span></span> <span data-ttu-id="da7b5-284">Hello prénom et adresses IP des sous-réseaux de hello sont réservés pour la conformité de protocole, ainsi que les trois adresses plus utilisé pour les services Azure.</span><span class="sxs-lookup"><span data-stu-id="da7b5-284">hello first and last IP addresses of hello subnets are reserved for protocol conformance, along with three more addresses used for Azure services.</span></span> <span data-ttu-id="da7b5-285">Pour plus d’informations, consultez [Existe-t-il des restrictions sur l’utilisation des adresses IP au sein de ces sous-réseaux ?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span><span class="sxs-lookup"><span data-stu-id="da7b5-285">For more information, see [Are there any restrictions on using IP addresses within these subnets?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span></span>

<span data-ttu-id="da7b5-286">Ajout des adresses IP toohello utilisé par l’infrastructure de réseau virtuel Azure hello, chaque Redis instance hello sous-réseau utilise deux adresses IP par partition et une adresse IP supplémentaire pour l’équilibrage de charge hello.</span><span class="sxs-lookup"><span data-stu-id="da7b5-286">In addition toohello IP addresses used by hello Azure VNET infrastructure, each Redis instance in hello subnet uses two IP addresses per shard and one additional IP address for hello load balancer.</span></span> <span data-ttu-id="da7b5-287">Un cache non cluster est considéré comme toohave une seule partition.</span><span class="sxs-lookup"><span data-stu-id="da7b5-287">A non-clustered cache is considered toohave one shard.</span></span>

### <a name="do-all-cache-features-work-when-hosting-a-cache-in-a-vnet"></a><span data-ttu-id="da7b5-288">Toutes les fonctionnalités fonctionnent-elles lorsque vous hébergez un cache dans un réseau virtuel ?</span><span class="sxs-lookup"><span data-stu-id="da7b5-288">Do all cache features work when hosting a cache in a VNET?</span></span>
<span data-ttu-id="da7b5-289">Lorsque votre cache fait partie d’un réseau virtuel, uniquement les clients Bonjour réseau virtuel peuvent accéder les cache hello.</span><span class="sxs-lookup"><span data-stu-id="da7b5-289">When your cache is part of a VNET, only clients in hello VNET can access hello cache.</span></span> <span data-ttu-id="da7b5-290">Par conséquent, hello des fonctionnalités de gestion de cache suivantes ne fonctionnent pas pour l’instant.</span><span class="sxs-lookup"><span data-stu-id="da7b5-290">As a result, hello following cache management features don't work at this time.</span></span>

* <span data-ttu-id="da7b5-291">Redis Console - Redis la Console s’exécutant dans votre navigateur, qui est en dehors de hello réseau virtuel, il ne peut pas se connecter à tooyour cache.</span><span class="sxs-lookup"><span data-stu-id="da7b5-291">Redis Console - Because Redis Console runs in your local browser, which is outside hello VNET, it can't connect tooyour cache.</span></span>

## <a name="use-expressroute-with-azure-redis-cache"></a><span data-ttu-id="da7b5-292">Utiliser ExpressRoute avec le Cache Redis Azure</span><span class="sxs-lookup"><span data-stu-id="da7b5-292">Use ExpressRoute with Azure Redis Cache</span></span>
<span data-ttu-id="da7b5-293">Les clients peuvent se connecter une [Azure ExpressRoute](https://azure.microsoft.com/services/expressroute/) infrastructure de réseau virtuel tootheir du circuit, en étendant leur tooAzure de réseau local.</span><span class="sxs-lookup"><span data-stu-id="da7b5-293">Customers can connect an [Azure ExpressRoute](https://azure.microsoft.com/services/expressroute/) circuit tootheir virtual network infrastructure, thus extending their on-premises network tooAzure.</span></span> 

<span data-ttu-id="da7b5-294">Par défaut, un circuit ExpressRoute nouvellement créé n’effectue pas de tunneling forcé (publication d’un routage par défaut, 0.0.0.0/0) sur un réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="da7b5-294">By default, a newly created ExpressRoute circuit does not perform forced tunneling (advertisement of a default route, 0.0.0.0/0) on a VNET.</span></span> <span data-ttu-id="da7b5-295">Par conséquent, connectivité Internet sortante est autorisée directement à partir de hello réseau virtuel et les applications clientes sont en mesure de tooconnect tooother Azure points de terminaison, y compris le Cache Redis Azure.</span><span class="sxs-lookup"><span data-stu-id="da7b5-295">As a result, outbound Internet connectivity is allowed directly from hello VNET and client applications are able tooconnect tooother Azure endpoints including Azure Redis Cache.</span></span>

<span data-ttu-id="da7b5-296">Cependant une configuration de client courants est toouse le tunneling forcé (publier un itinéraire par défaut) qui oblige sortant Internet trafic tooinstead flux localement.</span><span class="sxs-lookup"><span data-stu-id="da7b5-296">However a common customer configuration is toouse forced tunneling (advertise a default route) which forces outbound Internet traffic tooinstead flow on-premises.</span></span> <span data-ttu-id="da7b5-297">Ce flux de trafic sauts de connectivité avec le Cache Redis Azure si le trafic sortant de hello est ensuite bloqué locaux tels que hello instance de Cache Redis Azure n’est pas en mesure de toocommunicate avec ses dépendances.</span><span class="sxs-lookup"><span data-stu-id="da7b5-297">This traffic flow breaks connectivity with Azure Redis Cache if hello outbound traffic is then blocked on-premises such that hello Azure Redis Cache instance is not able toocommunicate with its dependencies.</span></span>

<span data-ttu-id="da7b5-298">solution de Hello est toodefine un (ou plusieurs) défini par l’utilisateur itinéraires (UDRs) sur le sous-réseau hello contenant hello du Cache Redis Azure.</span><span class="sxs-lookup"><span data-stu-id="da7b5-298">hello solution is toodefine one (or more) user-defined routes (UDRs) on hello subnet that contains hello Azure Redis Cache.</span></span> <span data-ttu-id="da7b5-299">Un UDR définit les itinéraires de sous-réseau spécifique qui seront respectées au lieu de l’itinéraire par défaut hello.</span><span class="sxs-lookup"><span data-stu-id="da7b5-299">A UDR defines subnet-specific routes that will be honored instead of hello default route.</span></span>

<span data-ttu-id="da7b5-300">Si possible, il est recommandé de hello toouse configuration suivante :</span><span class="sxs-lookup"><span data-stu-id="da7b5-300">If possible, it is recommended toouse hello following configuration:</span></span>

* <span data-ttu-id="da7b5-301">configuration de ExpressRoute Hello annonce 0.0.0.0/0 et par défaut force tunnels tout le trafic sortant sur site.</span><span class="sxs-lookup"><span data-stu-id="da7b5-301">hello ExpressRoute configuration advertises 0.0.0.0/0 and by default force tunnels all outbound traffic on-premises.</span></span>
* <span data-ttu-id="da7b5-302">sous-réseau de toohello UDR appliqué contenant hello du Cache Redis Azure Hello définit 0.0.0.0/0 avec un itinéraire de travail pour toohello de trafic TCP/IP internet public ; par exemple en définissant un hello de tronçon suivant too'Internet de type'.</span><span class="sxs-lookup"><span data-stu-id="da7b5-302">hello UDR applied toohello subnet containing hello Azure Redis Cache defines 0.0.0.0/0 with a working route for TCP/IP traffic toohello public internet; for example by setting hello next hop type too'Internet'.</span></span>

<span data-ttu-id="da7b5-303">Bonjour effets combinés de ces étapes est qu’au niveau du sous-réseau UDR hello est prioritaire sur hello ExpressRoute forcé tunneling, garantissant ainsi un accès Internet sortant à partir de hello du Cache Redis Azure.</span><span class="sxs-lookup"><span data-stu-id="da7b5-303">hello combined effect of these steps is that hello subnet level UDR takes precedence over hello ExpressRoute forced tunneling, thus ensuring outbound Internet access from hello Azure Redis Cache.</span></span>

<span data-ttu-id="da7b5-304">Instance de Cache Redis Azure tooan se connectant à partir d’une application locale à l’aide d’ExpressRoute n’est pas un scénario classique d’utilisation en raison des raisons de tooperformance (pour optimiser les performances du Cache Redis Azure, les clients doivent être Bonjour même région que hello du Cache Redis Azure).</span><span class="sxs-lookup"><span data-stu-id="da7b5-304">Connecting tooan Azure Redis Cache instance from an on-premises application using ExpressRoute is not a typical usage scenario due tooperformance reasons (for best performance Azure Redis Cache clients should be in hello same region as hello Azure Redis Cache).</span></span>

>[!IMPORTANT] 
><span data-ttu-id="da7b5-305">Hello itinéraires définis dans un UDR **doit** être suffisamment spécifique tootake priorité sur les itinéraires annoncés par la configuration de ExpressRoute hello.</span><span class="sxs-lookup"><span data-stu-id="da7b5-305">hello routes defined in a UDR **must** be specific enough tootake precedence over any routes advertised by hello ExpressRoute configuration.</span></span> <span data-ttu-id="da7b5-306">Hello exemple suivant utilise la plage d’adresses 0.0.0.0/0 large hello et par conséquent peut potentiellement être accidentellement remplacée par les annonces d’itinéraires à l’aide de plages d’adresses plus spécifiques.</span><span class="sxs-lookup"><span data-stu-id="da7b5-306">hello following example uses hello broad 0.0.0.0/0 address range, and as such can potentially be accidentally overridden by route advertisements using more specific address ranges.</span></span>

>[!WARNING]  
><span data-ttu-id="da7b5-307">Cache Redis Azure n’est pas pris en charge avec des configurations de ExpressRoute qui **incorrectement cross-publier d’itinéraires de hello publics d’homologation toohello privés d’homologation chemin**.</span><span class="sxs-lookup"><span data-stu-id="da7b5-307">Azure Redis Cache is not supported with ExpressRoute configurations that **incorrectly cross-advertise routes from hello public peering path toohello private peering path**.</span></span> <span data-ttu-id="da7b5-308">Les configurations ExpressRoute ayant une homologation publique configurée reçoivent des annonces de routage en provenance de Microsoft pour un grand ensemble de plages d’adresses IP Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="da7b5-308">ExpressRoute configurations that have public peering configured, receive route advertisements from Microsoft for a large set of Microsoft Azure IP address ranges.</span></span> <span data-ttu-id="da7b5-309">Si ces plages d’adresses sont incorrectement entre publiés sur le chemin d’accès d’homologation privée hello, hello résulte que tous les paquets réseau sortant à partir du sous-réseau de l’instance de Cache Redis Azure hello sont incorrectement en tunnel force le tooa local réseau client infrastructure.</span><span class="sxs-lookup"><span data-stu-id="da7b5-309">If these address ranges are incorrectly cross-advertised on hello private peering path, hello result is that all outbound network packets from hello Azure Redis Cache instance's subnet are incorrectly force-tunneled tooa customer's on-premises network infrastructure.</span></span> <span data-ttu-id="da7b5-310">Ce flux réseau interrompt le Cache Redis Azure.</span><span class="sxs-lookup"><span data-stu-id="da7b5-310">This network flow breaks Azure Redis Cache.</span></span> <span data-ttu-id="da7b5-311">problème de toothis solution Hello est itinéraires de publication entre toostop de hello publics d’homologation toohello privés d’homologation chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="da7b5-311">hello solution toothis problem is toostop cross-advertising routes from hello public peering path toohello private peering path.</span></span>


<span data-ttu-id="da7b5-312">Vous trouverez des informations générales sur les itinéraires définis par l'utilisateur dans cette [présentation](../virtual-network/virtual-networks-udr-overview.md).</span><span class="sxs-lookup"><span data-stu-id="da7b5-312">Background information on user-defined routes is available in this [overview](../virtual-network/virtual-networks-udr-overview.md).</span></span>

<span data-ttu-id="da7b5-313">Pour plus d’informations sur ExpressRoute, voir [Aperçu technique d’ExpressRoute](../expressroute/expressroute-introduction.md).</span><span class="sxs-lookup"><span data-stu-id="da7b5-313">For more information about ExpressRoute, see [ExpressRoute technical overview](../expressroute/expressroute-introduction.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="da7b5-314">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="da7b5-314">Next steps</span></span>
<span data-ttu-id="da7b5-315">Découvrez comment mettre en cache des fonctionnalités par toouse plus premium.</span><span class="sxs-lookup"><span data-stu-id="da7b5-315">Learn how toouse more premium cache features.</span></span>

* [<span data-ttu-id="da7b5-316">Couche de présentation toohello Azure Redis Cache Premium</span><span class="sxs-lookup"><span data-stu-id="da7b5-316">Introduction toohello Azure Redis Cache Premium tier</span></span>](cache-premium-tier-intro.md)

<!-- IMAGES -->

[redis-cache-vnet]: ./media/cache-how-to-premium-vnet/redis-cache-vnet.png

[redis-cache-vnet-ip]: ./media/cache-how-to-premium-vnet/redis-cache-vnet-ip.png

[redis-cache-vnet-info]: ./media/cache-how-to-premium-vnet/redis-cache-vnet-info.png

