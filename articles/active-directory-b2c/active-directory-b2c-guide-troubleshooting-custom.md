---
title: "Azure Active Directory B2C : résoudre les problèmes liés aux stratégies personnalisées | Microsoft Docs"
description: "En savoir plus sur les approches toosolving erreurs lorsque vous travaillez avec des stratégies personnalisées dans Azure Active Directory."
services: active-directory-b2c
documentationcenter: 
author: rojasja
manager: krassk
editor: rojasja
ms.assetid: 
ms.service: active-directory-b2c
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/07/2017
ms.author: joroja
ms.openlocfilehash: b9e1b46df1ddb29cdb90953e4a0d6f1dd085441f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="troubleshoot-azure-ad-b2c-custom-policies-and-identity-experience-framework"></a><span data-ttu-id="8fdf7-103">Résoudre les problèmes liés aux stratégies personnalisées Azure AD B2C et à l’Infrastructure d’expérience d’identité.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-103">Troubleshoot Azure AD B2C custom policies and Identity Experience Framework</span></span>

<span data-ttu-id="8fdf7-104">Si vous utilisez Azure Active Directory B2C (B2C Active Directory de Azure) des stratégies personnalisées, vous risquez de rencontrer les défis configuration hello Framework rencontrer d’identité dans son format XML du langage stratégie.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-104">If you use Azure Active Directory B2C (Azure AD B2C) custom policies, you might experience challenges setting up hello Identity Experience Framework in its policy language XML format.</span></span>  <span data-ttu-id="8fdf7-105">Stratégies personnalisées de formation toowrite peuvent être comme un nouveau langage d’apprentissage.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-105">Learning toowrite custom policies can be like learning a new language.</span></span> <span data-ttu-id="8fdf7-106">Dans cet article, nous décrivons des outils et proposons des conseils qui peuvent vous aider à identifier et résoudre rapidement les problèmes.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-106">In this article, we describe tools and tips that can help you quickly discover and resolve issues.</span></span> 

> [!NOTE]
> <span data-ttu-id="8fdf7-107">Cet article est axé sur la résolution des problèmes de configuration de stratégie personnalisée Azure AD B2C.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-107">This article focuses on troubleshooting your Azure AD B2C custom policy configuration.</span></span> <span data-ttu-id="8fdf7-108">Elle ne répond pas hello application tiers ou sa bibliothèque de l’identité de partie de confiance.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-108">It doesn't address hello relying party application or its identity library.</span></span>

## <a name="xml-editing"></a><span data-ttu-id="8fdf7-109">Édition XML</span><span class="sxs-lookup"><span data-stu-id="8fdf7-109">XML editing</span></span>

<span data-ttu-id="8fdf7-110">Hello erreur la plus courante dans la configuration des stratégies personnalisées n’est pas au format XML.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-110">hello most common error in setting up custom policies is improperly formatted XML.</span></span> <span data-ttu-id="8fdf7-111">Un bon éditeur XML est quasiment essentiel.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-111">A good XML editor is nearly essential.</span></span> <span data-ttu-id="8fdf7-112">Un bon éditeur XML affiche le code XML en mode natif, applique un code couleur au contenu, prérenseigne les termes courants, maintient les éléments indexés et peut valider avec un schéma.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-112">A good XML editor displays XML natively, color-codes content, prefills common terms, keeps XML elements indexed, and can validate with schema.</span></span> <span data-ttu-id="8fdf7-113">Voici deux de nos éditeurs XML préférés :</span><span class="sxs-lookup"><span data-stu-id="8fdf7-113">Here are two of our favorite XML editors:</span></span>

* [<span data-ttu-id="8fdf7-114">Visual Studio Code</span><span class="sxs-lookup"><span data-stu-id="8fdf7-114">Visual Studio Code</span></span>](https://code.visualstudio.com/)
* [<span data-ttu-id="8fdf7-115">Notepad++</span><span class="sxs-lookup"><span data-stu-id="8fdf7-115">Notepad++</span></span>](https://notepad-plus-plus.org/)

<span data-ttu-id="8fdf7-116">La validation du schéma XML identifie les erreurs avant le chargement de votre fichier XML.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-116">XML schema validation identifies errors before you upload your XML file.</span></span> <span data-ttu-id="8fdf7-117">Dans le dossier racine de hello du pack de démarrage hello, obtenir la définition de schéma XML hello TrustFrameworkPolicy_0.3.0.0.xsd.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-117">In hello root folder of hello starter pack, get hello XML schema definition TrustFrameworkPolicy_0.3.0.0.xsd.</span></span> <span data-ttu-id="8fdf7-118">Pour plus d’informations, dans la documentation de hello de votre éditeur XML, recherchez *outils XML* et *validation XML*.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-118">For more information, in hello documentation of your XML editor, look for *XML tools* and *XML validation*.</span></span>

<span data-ttu-id="8fdf7-119">Il peut être utile de passer en revue les règles XML.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-119">You might find a review of XML rules helpful.</span></span> <span data-ttu-id="8fdf7-120">Azure AD B2C rejette toute erreur de mise en forme XML qu’il détecte.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-120">Azure AD B2C rejects any XML formatting errors that it detects.</span></span> <span data-ttu-id="8fdf7-121">Parfois, une mauvaise mise en forme XML peut entraîner des messages d’erreur trompeurs.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-121">Occasionally, incorrectly formatted XML might cause error messages that are misleading.</span></span>

## <a name="upload-policies-and-policy-validation"></a><span data-ttu-id="8fdf7-122">Chargement et validation de stratégies</span><span class="sxs-lookup"><span data-stu-id="8fdf7-122">Upload policies and policy validation</span></span>

 <span data-ttu-id="8fdf7-123">La validation du chargement de fichier XML est automatique.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-123">XML file upload validation is automatic.</span></span> <span data-ttu-id="8fdf7-124">La plupart des erreurs provoquent hello téléchargement toofail.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-124">Most errors cause hello upload toofail.</span></span> <span data-ttu-id="8fdf7-125">Validation inclut un fichier de stratégie hello que vous téléchargez.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-125">Validation includes hello policy file that you are uploading.</span></span> <span data-ttu-id="8fdf7-126">Il inclut également la chaîne hello de téléchargement du fichier hello fait référence trop de fichiers (hello fichier partie de confiance de la stratégie de tiers, fichier des extensions hello et fichier de base hello).</span><span class="sxs-lookup"><span data-stu-id="8fdf7-126">It also includes hello chain of files hello upload file refers too(hello relying party policy file, hello extensions file, and hello base file).</span></span> 
 
 <span data-ttu-id="8fdf7-127">Erreurs de validation courantes suivantes hello.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-127">Common validation errors include hello following.</span></span>

<span data-ttu-id="8fdf7-128">Extrait de code de l’erreur :`... makes a reference tooClaimType with id "displaName" but neither hello policy nor any of its base policies contain such an element`</span><span class="sxs-lookup"><span data-stu-id="8fdf7-128">Error snippet: `... makes a reference tooClaimType with id "displaName" but neither hello policy nor any of its base policies contain such an element`</span></span>
* <span data-ttu-id="8fdf7-129">Hello ClaimType valeur peut être mal orthographié ou n’existe pas dans le schéma de hello.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-129">hello ClaimType value might be misspelled, or does not exist in hello schema.</span></span>
* <span data-ttu-id="8fdf7-130">Les valeurs de ClaimType doivent être définis dans au moins un des fichiers hello dans la stratégie de hello.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-130">ClaimType values must be defined in at least one of hello files in hello policy.</span></span> 
    <span data-ttu-id="8fdf7-131">Par exemple : ` <ClaimType Id="socialIdpUserId">`</span><span class="sxs-lookup"><span data-stu-id="8fdf7-131">For example: ` <ClaimType Id="socialIdpUserId">`</span></span>
* <span data-ttu-id="8fdf7-132">Si ClaimType est défini dans le fichier des extensions hello, mais il est également utilisé dans une valeur TechnicalProfile dans le fichier de base hello, téléchargement du fichier de base hello génère une erreur.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-132">If ClaimType is defined in hello extensions file, but it's also used in a TechnicalProfile value in hello base file, uploading hello base file results in an error.</span></span>

<span data-ttu-id="8fdf7-133">Extrait de code de l’erreur :`...makes a reference tooa ClaimsTransformation with id...`</span><span class="sxs-lookup"><span data-stu-id="8fdf7-133">Error snippet: `...makes a reference tooa ClaimsTransformation with id...`</span></span>
* <span data-ttu-id="8fdf7-134">Bonjour les causes de l’erreur de hello peut être hello même que pour les erreurs de ClaimType hello.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-134">hello causes for hello error might be hello same as for hello ClaimType error.</span></span>

<span data-ttu-id="8fdf7-135">Extrait de code de l’erreur :`Reason: User is currently logged as a user of 'yourtenant.onmicrosoft.com' tenant. In order toomanage 'yourtenant.onmicrosoft.com', please login as a user of 'yourtenant.onmicrosoft.com' tenant`</span><span class="sxs-lookup"><span data-stu-id="8fdf7-135">Error snippet: `Reason: User is currently logged as a user of 'yourtenant.onmicrosoft.com' tenant. In order toomanage 'yourtenant.onmicrosoft.com', please login as a user of 'yourtenant.onmicrosoft.com' tenant`</span></span>
* <span data-ttu-id="8fdf7-136">Vérifiez que hello valeur TenantId Bonjour  **\<TrustFrameworkPolicy\>**  et  **\<BasePolicy\>**  éléments correspondent à votre cible Azure AD B2C client.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-136">Check that hello TenantId value in hello **\<TrustFrameworkPolicy\>** and **\<BasePolicy\>** elements match your target Azure AD B2C tenant.</span></span>  

## <a name="troubleshoot-hello-runtime"></a><span data-ttu-id="8fdf7-137">Résoudre les problèmes de runtime de hello</span><span class="sxs-lookup"><span data-stu-id="8fdf7-137">Troubleshoot hello runtime</span></span>

* <span data-ttu-id="8fdf7-138">Utilisez `Run Now` et `https://jwt.io` tootest vos stratégies indépendamment de votre application mobile ou le web.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-138">Use `Run Now` and `https://jwt.io` tootest your policies independently of your web or mobile application.</span></span> <span data-ttu-id="8fdf7-139">Ce site web agit comme une application par partie de confiance.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-139">This website acts like a relying party application.</span></span> <span data-ttu-id="8fdf7-140">Il affiche le contenu hello Hello jeton Web JSON (JWT) qui est généré par votre stratégie Azure Active Directory B2C.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-140">It displays hello contents of hello JSON Web Token (JWT) that is generated by your Azure AD B2C policy.</span></span> <span data-ttu-id="8fdf7-141">toocreate une application test Framework expérience identité hello utilisez valeurs suivantes :</span><span class="sxs-lookup"><span data-stu-id="8fdf7-141">toocreate a test application in Identity Experience Framework, use hello following values:</span></span>
    * <span data-ttu-id="8fdf7-142">Nom : TestApp</span><span class="sxs-lookup"><span data-stu-id="8fdf7-142">Name: TestApp</span></span>
    * <span data-ttu-id="8fdf7-143">Application/API web : Non</span><span class="sxs-lookup"><span data-stu-id="8fdf7-143">Web App/Web API: No</span></span>
    * <span data-ttu-id="8fdf7-144">Client natif : Non</span><span class="sxs-lookup"><span data-stu-id="8fdf7-144">Native client: No</span></span>

* <span data-ttu-id="8fdf7-145">l’échange hello tootrace de messages entre votre navigateur client et dans Azure AD B2C, utilisez [Fiddler](http://www.telerik.com/fiddler).</span><span class="sxs-lookup"><span data-stu-id="8fdf7-145">tootrace hello exchange of messages between your client browser and Azure AD B2C, use [Fiddler](http://www.telerik.com/fiddler).</span></span> <span data-ttu-id="8fdf7-146">Il peut vous aider à obtenir une indication de l’endroit où vos étapes d’orchestration échouent dans le parcours utilisateur.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-146">It can help you get an indication of where your user journey is failing in your orchestration steps.</span></span>

* <span data-ttu-id="8fdf7-147">Dans **mode de développement**, utilisez **Application Insights** activité de hello tootrace de votre voyage d’utilisateur expérience infrastructure d’identité.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-147">In **Development mode**, use **Application Insights** tootrace hello activity of your Identity Experience Framework user journey.</span></span> <span data-ttu-id="8fdf7-148">Dans **mode de développement**, vous pouvez observer exchange hello de revendications entre hello infrastructure d’identité expérience et hello différentes revendications qui sont définis par les profils de techniques, telles que les fournisseurs d’identité, services basés sur les API, les fournisseurs répertoire de l’utilisateur Hello Azure AD B2C et d’autres services, tels que Azure Multi-Factor-Authentication.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-148">In **Development mode**, you can observe hello exchange of claims between hello Identity Experience Framework and hello various claims providers that are defined by technical profiles, such as identity providers, API-based services, hello Azure AD B2C user directory, and other services, like Azure Multi-Factor-Authentication.</span></span>  

## <a name="recommended-practices"></a><span data-ttu-id="8fdf7-149">Pratiques recommandées</span><span class="sxs-lookup"><span data-stu-id="8fdf7-149">Recommended practices</span></span>

<span data-ttu-id="8fdf7-150">**Conservez plusieurs versions de vos scénarios. Regroupez-les dans un projet avec votre application.**</span><span class="sxs-lookup"><span data-stu-id="8fdf7-150">**Keep multiple versions of your scenarios. Group them in a project with your application.**</span></span> <span data-ttu-id="8fdf7-151">base de Hello, extensions et les fichiers de tiers partie de confiance sont directement dépendantes de l’autre.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-151">hello base, extensions, and relying party files are directly dependent on each other.</span></span> <span data-ttu-id="8fdf7-152">Enregistrez-les en tant que groupe.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-152">Save them as a group.</span></span> <span data-ttu-id="8fdf7-153">Comme les nouvelles fonctionnalités sont ajoutées les stratégies tooyour, conserver des versions de travail distinctes.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-153">As new features are added tooyour policies, keep separate working versions.</span></span> <span data-ttu-id="8fdf7-154">Les versions de travail stade dans votre propre système de fichiers par code de l’application hello avec qu'ils interagissent.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-154">Stage working versions in your own file system with hello application code they interact with.</span></span>  <span data-ttu-id="8fdf7-155">Vos applications peuvent appeler de nombreuses stratégies de partie de confiance différentes dans un locataire.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-155">Your applications might invoke many different relying party policies in a tenant.</span></span> <span data-ttu-id="8fdf7-156">Ils peuvent devenir dépendantes sur les revendications hello qu’ils attendent à partir de vos stratégies d’Azure AD B2C.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-156">They might become dependent on hello claims that they expect from your Azure AD B2C policies.</span></span>

<span data-ttu-id="8fdf7-157">**Développez et testez des profils techniques avec des parcours utilisateur connus.**</span><span class="sxs-lookup"><span data-stu-id="8fdf7-157">**Develop and test technical profiles with known user journeys.**</span></span> <span data-ttu-id="8fdf7-158">Utilisez testé starter pack stratégies tooset vos profils techniques.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-158">Use tested starter pack policies tooset up your technical profiles.</span></span> <span data-ttu-id="8fdf7-159">Testez-les séparément avant de les incorporer à vos propres parcours utilisateur.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-159">Test them separately before you incorporate them into your own user journeys.</span></span>

<span data-ttu-id="8fdf7-160">**Développez et testez des parcours utilisateur avec des profils techniques testés.**</span><span class="sxs-lookup"><span data-stu-id="8fdf7-160">**Develop and test user journeys with tested technical profiles.**</span></span> <span data-ttu-id="8fdf7-161">Modifier les étapes d’orchestration hello d’un parcours de l’utilisateur par incrément.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-161">Change hello orchestration steps of a user journey incrementally.</span></span> <span data-ttu-id="8fdf7-162">Générez progressivement vos scénarios prévus.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-162">Progressively build your intended scenarios.</span></span>

## <a name="next-steps"></a><span data-ttu-id="8fdf7-163">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="8fdf7-163">Next steps</span></span>

* <span data-ttu-id="8fdf7-164">Dans GitHub, téléchargez le fichier .zip (https://github.com/Azure-Samples/active-directory-b2c-custom-policy-starterpack/archive/master.zip) [active-directory-b2c-custom-policy-starterpack] de hello.</span><span class="sxs-lookup"><span data-stu-id="8fdf7-164">In GitHub, download hello [active-directory-b2c-custom-policy-starterpack] (https://github.com/Azure-Samples/active-directory-b2c-custom-policy-starterpack/archive/master.zip) .zip file.</span></span>
