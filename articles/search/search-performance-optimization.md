---
title: "Considérations sur les performances et l’optimisation de Recherche Azure | Microsoft Docs"
description: "Réglage des performances d’Azure Search et configuration d’une mise à l’échelle optimale"
services: search
documentationcenter: 
author: LiamCavanagh
manager: pablocas
editor: 
ms.assetid: 4d3cd864-29d2-4921-be0d-a3f1a819de46
ms.service: search
ms.devlang: rest-api
ms.workload: search
ms.topic: article
ms.tgt_pltfrm: na
ms.date: 05/01/2017
ms.author: liamca
ms.openlocfilehash: f4e371fc16bc57e6963f1ec51c0ea864fa568f0c
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/11/2017
---
# <a name="azure-search-performance-and-optimization-considerations"></a><span data-ttu-id="ba3b9-103">Considérations sur les performances et l’optimisation d’Azure Search</span><span class="sxs-lookup"><span data-stu-id="ba3b9-103">Azure Search performance and optimization considerations</span></span>
<span data-ttu-id="ba3b9-104">Une expérience de recherche optimale est essentielle à la réussite de nombreuses applications mobiles et web.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-104">A great search experience is a key to success for many mobile and web applications.</span></span> <span data-ttu-id="ba3b9-105">Du secteur de l’immobilier à celui des véhicules d’occasion en passant par les catalogues en ligne, une recherche rapide et des résultats pertinents affectent l’expérience du client.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-105">From real estate, to used car marketplaces to online catalogs, fast search and relevant results will affect the customer experience.</span></span> <span data-ttu-id="ba3b9-106">Ce document a pour but de vous présenter les meilleures pratiques permettant de tirer le meilleur parti d’Azure Search, en particulier dans des scénarios avancés avec des exigences plus complexes en matière d’évolutivité, de prise en charge multilingue ou de classement personnalisé.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-106">This document is intended to help you discover best practices for how to get the most out of Azure Search, especially for advanced scenarios with sophisticated requirements for scalability, multi-language support, or custom ranking.</span></span>  <span data-ttu-id="ba3b9-107">En outre, ce document détaille les mécanismes internes et décrit les approches qui fonctionnent efficacement dans les applications clientes réelles.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-107">In addition, this document outlines internals and covers approaches that work effectively in real-world customer apps.</span></span>

## <a name="performance-and-scale-tuning-for-search-services"></a><span data-ttu-id="ba3b9-108">Réglage des performances et de la mise à l’échelle pour les services de recherche</span><span class="sxs-lookup"><span data-stu-id="ba3b9-108">Performance and scale tuning for Search services</span></span>
<span data-ttu-id="ba3b9-109">Nous sommes tous habitués aux moteurs de recherche comme Bing et Google et aux performances élevées qu'ils offrent.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-109">We are all used to search engines such as Bing and Google and the high performance they offer.</span></span>  <span data-ttu-id="ba3b9-110">Par conséquent, lorsque les clients utilisent la fonction de recherche de votre application mobile ou web, ils s’attendent à bénéficier des mêmes performances.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-110">As a result, when customers use your search-enabled web or mobile application, they will expect similar performance characteristics.</span></span>  <span data-ttu-id="ba3b9-111">Lors de l’optimisation des performances de recherche, une des meilleures approches consiste à se concentrer sur la latence, c’est-à-dire la durée nécessaire pour qu’une requête renvoie des résultats.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-111">When optimizing for search performance, one of the best approaches is to focus on latency, which is the time a query takes to complete and return results.</span></span>  <span data-ttu-id="ba3b9-112">Lors de l’optimisation de la latence de recherche, il est important de noter les points suivants :</span><span class="sxs-lookup"><span data-stu-id="ba3b9-112">When optimizing for search latency it is important to:</span></span>

1. <span data-ttu-id="ba3b9-113">Choisissez une latence cible (ou durée maximale) nécessaire à l’exécution d’une recherche standard .</span><span class="sxs-lookup"><span data-stu-id="ba3b9-113">Pick a target latency (or maximum amount of time) that a typical search request should take to complete.</span></span>
2. <span data-ttu-id="ba3b9-114">Créez et testez une charge de travail réelle avec votre service de recherche en utilisant un jeu de données réaliste pour mesurer les taux de latence.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-114">Create and test a real workload against your search service with a realistic dataset to measure these latency rates.</span></span>
3. <span data-ttu-id="ba3b9-115">Commencez par un petit nombre de requêtes par seconde (RPS) puis augmentez le nombre d’exécutions dans le test jusqu'à ce que la latence des requêtes soit inférieure à la latence cible définie.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-115">Start with a low number of queries per second (QPS) and continue to increase the number executed in the test until the query latency drops below the defined target latency.</span></span>  <span data-ttu-id="ba3b9-116">Il s’agit d’un test d’évaluation important qui vous aidera à planifier la mise à l’échelle à mesure que l’utilisation de votre application s’intensifie.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-116">This is an important benchmark to help you plan for scale as your application grows in usage.</span></span>
4. <span data-ttu-id="ba3b9-117">Dans la mesure du possible, réutilisez les connexions HTTP.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-117">Wherever possible, reuse HTTP connections.</span></span>  <span data-ttu-id="ba3b9-118">Si vous utilisez le Kit de développement logiciel (SDK) .NET Azure Search, cela signifie que vous devez réutiliser une instance ou [SearchIndexClient](https://docs.microsoft.com/dotnet/api/microsoft.azure.search.searchindexclient) , et si vous utilisez l’API REST, vous devez réutiliser une instance HttpClient unique.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-118">If you are using the Azure Search .NET SDK, this means you should reuse an instance or [SearchIndexClient](https://docs.microsoft.com/dotnet/api/microsoft.azure.search.searchindexclient) instance, and if you are using the REST API, you should reuse a single HttpClient.</span></span>

<span data-ttu-id="ba3b9-119">Lors de la création de ces charges de travail de test, certaines caractéristiques d’Azure Search doivent être prises en compte :</span><span class="sxs-lookup"><span data-stu-id="ba3b9-119">While creating these test workloads, there are some characteristics of Azure Search to keep in mind:</span></span>

1. <span data-ttu-id="ba3b9-120">Il est possible de lancer un si grand nombre de requêtes en même temps que les ressources disponibles dans votre service Azure Search finissent par être saturées.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-120">It is possible to push so many search queries at one time, that the resources available in your Azure Search service will be overwhelmed.</span></span>  <span data-ttu-id="ba3b9-121">Dans ce cas, vous verrez les codes de réponse HTTP 503.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-121">When this happens, you will see HTTP 503 response codes.</span></span>  <span data-ttu-id="ba3b9-122">Pour cette raison, il est préférable de commencer avec différentes plages de requêtes de recherche pour afficher les différences de taux de latence à mesure que vous ajoutez d’autres requêtes de recherche.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-122">For this reason, it is best to start with various ranges of search requests to see the differences in latency rates as you add more search requests.</span></span>
2. <span data-ttu-id="ba3b9-123">Le téléchargement de contenu vers Azure Search aura un impact sur les performances globales et la latence du service Azure Search.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-123">Uploading of content to Azure Search will impact the overall performance and latency of the Azure Search service.</span></span>  <span data-ttu-id="ba3b9-124">Si vous prévoyez d’envoyer des données pendant que les utilisateurs effectuent des recherches, il est important de prendre en compte cette charge de travail dans vos tests.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-124">If you expect to send data while users are performing searches, it is important to take this workload into account in your tests.</span></span>
3. <span data-ttu-id="ba3b9-125">Les requêtes de recherche n’offrent pas toutes les mêmes niveaux de performances.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-125">Not every search query will perform at the same performance levels.</span></span>  <span data-ttu-id="ba3b9-126">Par exemple, une recherche de document ou une suggestion de recherche s’exécutera plus rapidement qu’une requête comportant un nombre important de facettes et les filtres.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-126">For example, a document lookup or search suggestion will typically perform faster than a query with a significant number of facets and filters.</span></span>  <span data-ttu-id="ba3b9-127">Il est préférable de définir les différentes requêtes que vous compter afficher lors de la génération de vos tests.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-127">It is best to take the various queries you expect to see into account when building your tests.</span></span>  
4. <span data-ttu-id="ba3b9-128">Il est important de choisir différentes requêtes de recherche car si vous exécutez continuellement les mêmes requêtes de recherche, la mise en cache des données semble offrir de meilleures performances qu’avec un jeu de requêtes plus disparates.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-128">Variation of search requests is important because if you continually execute the same search requests, caching of data will start to make performance look better than it might with a more disparate query set.</span></span>

> [!NOTE]
> <span data-ttu-id="ba3b9-129">Le [test de charge Visual Studio](https://www.visualstudio.com/docs/test/performance-testing/run-performance-tests-app-before-release) est un excellent moyen d’exécuter vos tests de performances car il permet d’exécuter des requêtes HTTP comme s’il s’agissait de requêtes dans la Recherche Azure et permet ainsi la parallélisation des requêtes.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-129">[Visual Studio Load Testing](https://www.visualstudio.com/docs/test/performance-testing/run-performance-tests-app-before-release) is a really good way to perform your benchmark tests as it allows you to execute HTTP requests as you would need for executing queries against Azure Search and enables parallelization of requests.</span></span>
> 
> 

## <a name="scaling-azure-search-for-high-query-rates-and-throttled-requests"></a><span data-ttu-id="ba3b9-130">Mise à l’échelle d’Azure Search pour obtenir des taux de requêtes élevés et des requêtes limitées</span><span class="sxs-lookup"><span data-stu-id="ba3b9-130">Scaling Azure Search for high query rates and throttled requests</span></span>
<span data-ttu-id="ba3b9-131">Lorsque vous recevez un trop grand nombre de requêtes limitées ou dépassez votre taux de latence cible suite à une charge de requête accrue, vous pouvez essayer de diminuer les taux de latence de deux manières :</span><span class="sxs-lookup"><span data-stu-id="ba3b9-131">When you are receiving too many throttled requests or exceed your target latency rates from an increased query load, you can look to decrease latency rates in one of two ways:</span></span>

1. <span data-ttu-id="ba3b9-132">**Augmenter les réplicas :** un réplica s’apparente à une copie de vos données et permet à la Recherche Azure d’équilibrer la charge des requêtes sur plusieurs copies.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-132">**Increase Replicas:**  A replica is like a copy of your data allowing Azure Search to load balance requests against the multiple copies.</span></span>  <span data-ttu-id="ba3b9-133">L’intégralité de l’équilibrage de la charge et de la réplication des données entre les réplicas est gérée par Azure Search et vous pouvez à tout moment modifier le nombre de réplicas alloués à votre service.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-133">All load balancing and replication of data across replicas is managed by Azure Search and you can alter the number of replicas allocated for your service at any time.</span></span>  <span data-ttu-id="ba3b9-134">Vous pouvez allouer jusqu'à 12 réplicas dans un service de recherche Standard, et 3 dans un service de recherche de base.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-134">You can allocate up to 12 replicas in a Standard search service and 3 replicas in a Basic search service.</span></span> <span data-ttu-id="ba3b9-135">Les réplicas peuvent être ajustés sur le [portail Azure](search-create-service-portal.md) ou via [PowerShell](search-manage-powershell.md).</span><span class="sxs-lookup"><span data-stu-id="ba3b9-135">Replicas can be adjusted either from the [Azure portal](search-create-service-portal.md) or [PowerShell](search-manage-powershell.md).</span></span>
2. <span data-ttu-id="ba3b9-136">**Augmenter le niveau de recherche :** la Recherche Azure est fournie avec un certain [nombre de niveaux](https://azure.microsoft.com/pricing/details/search/) et chacun de ces niveaux offre différents niveaux de performances.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-136">**Increase Search Tier:**  Azure Search comes in a [number of tiers](https://azure.microsoft.com/pricing/details/search/) and each of these tiers offers different levels of performance.</span></span>  <span data-ttu-id="ba3b9-137">Dans certains cas, vous aurez tant de requêtes que le niveau sélectionné est incapable de fournir des taux de latence suffisamment faibles, même lorsque les réplicas sont optimisés.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-137">In some cases, you may have so many queries that the tier you are on cannot provide sufficiently low latency rates, even when replicas are maxed out.</span></span>  <span data-ttu-id="ba3b9-138">Dans ce cas, vous pouvez passer à l’un des niveaux de recherche supérieurs tel que le niveau Azure Search S3, parfaitement adapté aux scénarios comportant un grand nombre de documents et des charges de travail de requêtes extrêmement élevées.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-138">In this case, you may want to consider leveraging one of the higher search tiers such as the Azure Search S3 tier that is well suited for scenarios with large numbers of documents and extremely high query workloads.</span></span>

## <a name="scaling-azure-search-for-slow-individual-queries"></a><span data-ttu-id="ba3b9-139">Mise à l’échelle d’Azure Search pour des requêtes individuelles lentes</span><span class="sxs-lookup"><span data-stu-id="ba3b9-139">Scaling Azure Search for slow individual queries</span></span>
<span data-ttu-id="ba3b9-140">Une requête unique qui prend trop de temps peut également entraîner de faibles taux de latence.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-140">Another reason why latency rates can be slow is from a single query taking too long to complete.</span></span>  <span data-ttu-id="ba3b9-141">Dans ce cas, l’ajout de réplicas n’améliorera pas les taux de latence.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-141">In this case, adding replicas will not improve latency rates.</span></span>  <span data-ttu-id="ba3b9-142">Il existe alors deux options possibles :</span><span class="sxs-lookup"><span data-stu-id="ba3b9-142">For this case there are two options available:</span></span>

1. <span data-ttu-id="ba3b9-143">**Augmenter les partitions** Une partition est un mécanisme permettant de répartir vos données sur des ressources supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-143">**Increase Partitions** A partition is a mechanism for splitting your data across extra resources.</span></span>  <span data-ttu-id="ba3b9-144">Pour cette raison, lorsque vous ajoutez une deuxième partition, vos données sont divisées en deux.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-144">For this reason, when you add a second partition, your data gets split into two.</span></span>  <span data-ttu-id="ba3b9-145">Une troisième partition divise votre index en trois, etc.  Cette opération a également pour effet que, dans certains cas, les requêtes lentes s’exécuteront plus rapidement en raison de la parallélisation du calcul.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-145">A third partition splits your index into three, etc.  This also has the effect that in some cases, slow queries will perform faster due to the parallelization of computation.</span></span>  <span data-ttu-id="ba3b9-146">Il existe quelques exemples dans lesquels cette parallélisation fonctionne très bien avec des requêtes affichant une faible sélectivité.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-146">There are a few examples of where we have seen this parallelization work extremely well with queries that have low selectivity queries.</span></span>  <span data-ttu-id="ba3b9-147">Il s’agit de requêtes correspondant à de nombreux documents ou lorsque l’utilisation de facettes doit compter un grand nombre de documents.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-147">This consists of queries that match many documents or when faceting needs to provide counts over large numbers of documents.</span></span>  <span data-ttu-id="ba3b9-148">Dans la mesure où de nombreux calculs sont nécessaires pour évaluer la pertinence des documents ou pour compter le nombre de documents, l’ajout de partitions supplémentaires peut contribuer à fournir des calculs supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-148">Since there is a lot of computation needed to score the relevancy of the documents or to count the numbers of documents, adding extra partitions can help to provide additional computation.</span></span>  
   
   <span data-ttu-id="ba3b9-149">Il peut y avoir un maximum de 12 partitions dans le service de recherche standard, et 1 partition dans le service de recherche de base.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-149">There can be a maximum of 12 partitions in Standard search service and 1 partition in the basic search service.</span></span>  <span data-ttu-id="ba3b9-150">Les réplicas peuvent être ajustés sur le [portail Azure](search-create-service-portal.md) ou via [PowerShell](search-manage-powershell.md).</span><span class="sxs-lookup"><span data-stu-id="ba3b9-150">Partitions can be adjusted either from the [Azure portal](search-create-service-portal.md) or [PowerShell](search-manage-powershell.md).</span></span>
2. <span data-ttu-id="ba3b9-151">**Limiter les champs à cardinalité élevée :** Un champ à cardinalité élevée est un champ pouvant être utilisé comme facette ou comme filtre et qui comporte un nombre important de valeurs uniques et, par conséquent, consomme beaucoup de ressources pour calculer les résultats.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-151">**Limit High Cardinality Fields:** A high cardinality field consists of a facetable or filterable field that has a significant number of unique values, and as a result, takes a lot of resources to compute results over.</span></span>   <span data-ttu-id="ba3b9-152">Par exemple, la définition d’un champ ID produit ou Description comme un champ pouvant être utilisé comme facette ou comme filtre peut offrir une cardinalité élevée car la plupart des valeurs sont uniques pour chaque document.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-152">For example, setting a Product ID or Description field as facetable/filterable would make for high cardinality because most of the values from document to document are unique.</span></span> <span data-ttu-id="ba3b9-153">Dans la mesure du possible, limitez le nombre de champs à cardinalité élevée.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-153">Wherever possible, limit the number of high cardinality fields.</span></span>
3. <span data-ttu-id="ba3b9-154">**Augmenter le niveau de recherche :** Choisir un niveau de Recherche Azure supérieur est une autre façon d’améliorer les performances des requêtes lentes.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-154">**Increase Search Tier:**  Moving up to a higher Azure Search tier can be another way to improve performance of slow queries.</span></span>  <span data-ttu-id="ba3b9-155">Chaque niveau supérieur propose également un processeur plus rapide et plus de mémoire, ce qui peut avoir un impact positif sur les performances des requêtes.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-155">Each higher tier also provides faster CPU’s and more memory which can have a positive impact on query performance.</span></span>

## <a name="scaling-for-availability"></a><span data-ttu-id="ba3b9-156">Mise à l’échelle pour la disponibilité</span><span class="sxs-lookup"><span data-stu-id="ba3b9-156">Scaling for availability</span></span>
<span data-ttu-id="ba3b9-157">Les réplicas permettent non seulement de réduire la latence des requêtes mais ils peuvent également offrir une plus grande disponibilité.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-157">Replicas not only help reduce query latency but can also allow for high availability.</span></span>  <span data-ttu-id="ba3b9-158">Avec un seul réplica, attendez-vous à des temps d’arrêt périodiques en raison du redémarrage du serveur après les mises à jour logicielles ou lorsque d’autres événements de maintenance se produisent.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-158">With a single replica, you should expect periodic downtime due to server reboots after software updates or for other maintenance events that will occur.</span></span>  <span data-ttu-id="ba3b9-159">Par conséquent, il est important d’évaluer si votre application requiert une haute disponibilité des recherches (requêtes) ainsi que des écritures (événements d’indexation).</span><span class="sxs-lookup"><span data-stu-id="ba3b9-159">As a result, it is important to consider if your application requires high availability of searches (queries) as well as writes (indexing events).</span></span>  <span data-ttu-id="ba3b9-160">Azure Search offre des options de contrat de niveau de service sur tous les services de recherche payants avec les attributs suivants :</span><span class="sxs-lookup"><span data-stu-id="ba3b9-160">Azure Search offers SLA options on all the paid search offerings with the following attributes:</span></span>

* <span data-ttu-id="ba3b9-161">2 réplicas pour la haute disponibilité des charges de travail en lecture seule (requêtes)</span><span class="sxs-lookup"><span data-stu-id="ba3b9-161">2 replicas for high availability of read-only workloads (queries)</span></span>
* <span data-ttu-id="ba3b9-162">3 réplicas (ou plus) pour la haute disponibilité des charges de travail en lecture-écriture (requêtes et indexation)</span><span class="sxs-lookup"><span data-stu-id="ba3b9-162">3 or more replicas for high availability of read-write workloads (queries and indexing)</span></span>

<span data-ttu-id="ba3b9-163">Pour plus d’informations, consultez le [contrat de niveau de service Azure Search](https://azure.microsoft.com/support/legal/sla/search/v1_0/).</span><span class="sxs-lookup"><span data-stu-id="ba3b9-163">For more details on this, please visit the [Azure Search Service Level Agreement](https://azure.microsoft.com/support/legal/sla/search/v1_0/).</span></span>

<span data-ttu-id="ba3b9-164">Étant donné que les réplicas sont des copies de vos données, avoir plusieurs réplicas permet à Azure Search de gérer les redémarrages et la maintenance de l’ordinateur, réplica par réplica, tout en permettant aux requêtes de continuer à s’exécuter par rapport à d’autres réplicas.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-164">Since replicas are copies of your data, having multiple replicas allows Azure Search to do machine reboots and maintenance against one replica at a time while allowing queries to continue to be executed against the other replicas.</span></span>  <span data-ttu-id="ba3b9-165">Pour cette raison, vous devrez également prendre en compte la façon dont ce temps d’arrêt peut influer sur les requêtes qui doivent désormais être exécutées sur une copie des données.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-165">For that reason, you will also need to consider how this downtime may impact the queries that now have to be executed against one less copy of the data.</span></span>

## <a name="scaling-geo-distributed-workloads-and-provide-geo-redundancy"></a><span data-ttu-id="ba3b9-166">Mise à l’échelle de charges de travail géo-distribuées et géo-redondance</span><span class="sxs-lookup"><span data-stu-id="ba3b9-166">Scaling geo-distributed workloads and provide geo-redundancy</span></span>
<span data-ttu-id="ba3b9-167">Pour les charges de travail géo-distribuées, vous constaterez que les utilisateurs se trouvant loin du centre de données hébergeant votre service Azure Search bénéficieront de taux de latence plus élevées.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-167">For geo-distributed workloads, you will find that users located far from the data center where your Azure Search service is hosted will have higher latency rates.</span></span>  <span data-ttu-id="ba3b9-168">Pour cette raison, il est souvent important de disposer de plusieurs services de recherche dans les régions proches de ces utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-168">For this reason, it is often important to have multiple search services in regions that are in closer proximity to these users.</span></span>  <span data-ttu-id="ba3b9-169">Azure Search n’offre actuellement pas de méthode automatisée de géo-réplication des index Azure Search sur différentes régions, mais quelques techniques permettent d’implémenter et de gérer simplement ce processus.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-169">Azure Search does not currently provide an automated method of geo-replicating Azure Search indexes across regions, but there are some techniques that can be used that can make this process simple to implement and manage.</span></span> <span data-ttu-id="ba3b9-170">Elles sont présentées dans les sections suivantes.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-170">These are outlined in the next few sections.</span></span>

<span data-ttu-id="ba3b9-171">L’objectif d’un jeu géo-distribué de services de recherche est d’avoir plusieurs index disponibles dans deux ou plusieurs régions où l’utilisateur sera redirigé vers le service Azure Search qui offre la plus faible latence, comme illustré dans cet exemple :</span><span class="sxs-lookup"><span data-stu-id="ba3b9-171">The goal of a geo-distributed set of search services is to have two or more indexes available in two or more regions where a user will be routed to the Azure Search service that provides the lowest latency as seen in this example:</span></span>

   ![Tableau croisé des services par région][1]

### <a name="keeping-data-in-sync-across-multiple-azure-search-services"></a><span data-ttu-id="ba3b9-173">Synchronisation des données entre plusieurs services Azure Search</span><span class="sxs-lookup"><span data-stu-id="ba3b9-173">Keeping data in sync across multiple Azure Search services</span></span>
<span data-ttu-id="ba3b9-174">Il existe deux options pour synchroniser vos services de recherche distribués : à l’aide de [l’indexeur de Recherche Azure](search-indexer-overview.md) ou de l’API Push (également appelée [API REST de Recherche Azure](https://docs.microsoft.com/rest/api/searchservice/)).</span><span class="sxs-lookup"><span data-stu-id="ba3b9-174">There are two options for keeping your distributed search services in sync which consist of either using the [Azure Search Indexer](search-indexer-overview.md) or the Push API (also referred to as the [Azure Search REST API](https://docs.microsoft.com/rest/api/searchservice/)).</span></span>  

### <a name="azure-search-indexers"></a><span data-ttu-id="ba3b9-175">Indexeurs Azure Search</span><span class="sxs-lookup"><span data-stu-id="ba3b9-175">Azure Search Indexers</span></span>
<span data-ttu-id="ba3b9-176">Si vous utilisez l’indexeur de Recherche Azure, vous importez déjà les modifications des données à partir d’un magasin de données central comme la base de données SQL Azure ou Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-176">If you are using the Azure Search Indexer, you are already importing data changes from a central datastore such as Azure SQL DB or Azure Cosmos DB.</span></span> <span data-ttu-id="ba3b9-177">Lorsque vous créez un service de recherche, vous créez tout simplement un indexeur Azure Search pour ce service qui pointe vers ce même magasin de données.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-177">When you create a new search Service, you simply also create a new Azure Search Indexer for that service that points to this same datastore.</span></span> <span data-ttu-id="ba3b9-178">De cette façon, chaque fois que de nouvelles modifications sont envoyées au magasin de données, ces informations seront indexées par plusieurs indexeurs.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-178">That way, whenever new changes come into the data store, they will then be indexed by the various Indexers.</span></span>  

<span data-ttu-id="ba3b9-179">Voici à quoi ressemblerait une telle architecture.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-179">Here is an example of what that architecture would look like.</span></span>

   ![Source de données unique avec indexeur distribué et combinaisons de service][2]

### <a name="push-api"></a><span data-ttu-id="ba3b9-181">API push</span><span class="sxs-lookup"><span data-stu-id="ba3b9-181">Push API</span></span>
<span data-ttu-id="ba3b9-182">Si vous utilisez l’API Push Azure Search pour [mettre à jour le contenu de l’index Azure Search](https://docs.microsoft.com/rest/api/searchservice/update-index), vous pouvez synchroniser vos différents services de recherche en envoyant les modifications vers tous les services de recherche chaque fois qu’une mise à jour est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-182">If you are using the Azure Search Push API to [update content in your Azure Search index](https://docs.microsoft.com/rest/api/searchservice/update-index), you can keep your various search services in sync by pushing changes to all search services whenever an update is required.</span></span>  <span data-ttu-id="ba3b9-183">Ce faisant, il est important de veiller à gérer les cas où une mise à jour d’un service de recherche échoue et où une ou plusieurs mises à jour réussissent.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-183">When doing this it is important to make sure to handle cases where an update to one search service fails and one or more updates succeed.</span></span>

## <a name="leveraging-azure-traffic-manager"></a><span data-ttu-id="ba3b9-184">Utilisation d’Azure Traffic Manager</span><span class="sxs-lookup"><span data-stu-id="ba3b9-184">Leveraging Azure Traffic Manager</span></span>
<span data-ttu-id="ba3b9-185">[Azure Traffic Manager](../traffic-manager/traffic-manager-overview.md) vous permet d’acheminer les requêtes vers plusieurs sites géo-localisés et pris en charge par plusieurs services Azure Search.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-185">[Azure Traffic Manager](../traffic-manager/traffic-manager-overview.md) allows you to route requests to multiple geo-located websites that are then backed by multiple Azure Search Services.</span></span>  <span data-ttu-id="ba3b9-186">Traffic Manager offre l’avantage de pouvoir tester Azure Search pour vous assurer qu’il est disponible et de rediriger les utilisateurs vers d’autres services de recherche en cas d’interruption du service.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-186">One advantage of the Traffic Manager is that it can probe Azure Search to ensure that it is available and route users to alternate search services in the event of downtime.</span></span>  <span data-ttu-id="ba3b9-187">En outre, si vous acheminez des requêtes de recherche via des sites Web Azure, Azure Traffic Manager permet d’équilibrer les charges lorsque le site web est opérationnel mais pas Azure Search.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-187">In addition, if you are routing search requests through Azure Web Sites, Azure Traffic Manager allows you to load balance cases where the Website is up but not Azure Search.</span></span>  <span data-ttu-id="ba3b9-188">Voici un exemple d’architecture tirant parti de Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-188">Here is an example of what the architecture that leverages Traffic Manager.</span></span>

   ![Tableau croisé des services par région, avec Traffic Manager central][3]

## <a name="monitoring-performance"></a><span data-ttu-id="ba3b9-190">Analyse des performances</span><span class="sxs-lookup"><span data-stu-id="ba3b9-190">Monitoring performance</span></span>
<span data-ttu-id="ba3b9-191">Azure Search permet d’analyser et de surveiller les performances de votre service via [Search Traffic Analytics (STA)](search-traffic-analytics.md).</span><span class="sxs-lookup"><span data-stu-id="ba3b9-191">Azure Search offers the ability to analyze and monitor the performance of your service through [Search Traffic Analytics (STA)](search-traffic-analytics.md).</span></span> <span data-ttu-id="ba3b9-192">STA vous permet de consigner des opérations de recherche individuelles ainsi que des mesures agrégées sur un compte de stockage Azure, puis de les analyser ou de les visualiser dans Power BI.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-192">Through STA, you can optionally log the individual search operations as well as aggregated metrics to an Azure Storage account that can then be processed for analysis or visualized in Power BI.</span></span>  <span data-ttu-id="ba3b9-193">À l’aide de mesures STA, vous pouvez afficher les statistiques de performances comme le nombre moyen de requêtes ou les temps de réponse.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-193">Using STA metrics, you can review performance statistics such as average number of queries or query response times.</span></span>  <span data-ttu-id="ba3b9-194">En outre, la journalisation des opérations vous permet d’examiner en détail des opérations de recherche spécifique.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-194">In addition, the operation logging allows you to drill into details of specific search operations.</span></span>

<span data-ttu-id="ba3b9-195">STA est un outil précieux pour comprendre les taux de latence du point de vue d’Azure Search.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-195">STA is a valuable tool to understand latency rates from that Azure Search perspective.</span></span>  <span data-ttu-id="ba3b9-196">Comme les mesures de performances des requêtes consignées sont basées sur la durée nécessaire pour qu’une requête soit entièrement traitée dans Azure Search (depuis le moment où elle est demandée jusqu’à son envoi), vous pouvez l’utiliser pour déterminer si les problèmes de latence se produisent du côté du service Azure Search ou à l’extérieur de ce service, par exemple en raison d’une latence du réseau.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-196">Since the query performance metrics logged are based on the time a query takes to be fully processed in Azure Search (from the time it is requested to when it is sent out), you are able to use this to determine if latency issues are from the Azure Search service side or outside of the service, such as from network latency.</span></span>  

## <a name="next-steps"></a><span data-ttu-id="ba3b9-197">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="ba3b9-197">Next steps</span></span>
<span data-ttu-id="ba3b9-198">Pour plus d’informations sur les niveaux tarifaires et les limites de service de chacun d’eux, consultez [Limites de service d’Azure Search](search-limits-quotas-capacity.md).</span><span class="sxs-lookup"><span data-stu-id="ba3b9-198">To learn more about the pricing tiers and services limits for each one, see [Service limits in Azure Search](search-limits-quotas-capacity.md).</span></span>

<span data-ttu-id="ba3b9-199">Consultez la page [Planification des capacités](search-capacity-planning.md) pour en savoir plus sur les combinaisons de partitions et de réplicas.</span><span class="sxs-lookup"><span data-stu-id="ba3b9-199">Visit [Capacity planning](search-capacity-planning.md) to learn more about partition and replica combinations.</span></span>

<span data-ttu-id="ba3b9-200">Pour plus d’informations sur les performances et obtenir des démonstrations sur la façon d’implémenter les optimisations présentées dans cet article, regardez la vidéo suivante :</span><span class="sxs-lookup"><span data-stu-id="ba3b9-200">For more drilldown on performance and to see some demonstrations of how to implement the optimizations discussed in this article, watch the following video:</span></span>

> [!VIDEO https://channel9.msdn.com/Events/Microsoft-Azure/AzureCon-2015/ACON319/player]
> 
> 

<!--Image references-->
[1]: ./media/search-performance-optimization/geo-redundancy.png
[2]: ./media/search-performance-optimization/scale-indexers.png
[3]: ./media/search-performance-optimization/geo-search-traffic-mgr.png
