---
title: "Implémentation de la navigation à facettes dans Recherche Azure | Microsoft Docs"
description: "Ajoutez la navigation à facettes aux applications qui s'intègrent à Azure Search, un service de recherche cloud hébergé sur Microsoft Azure."
services: search
documentationcenter: 
author: HeidiSteen
manager: mblythe
editor: 
ms.assetid: cdf98fd4-63fd-4b50-b0b0-835cb08ad4d3
ms.service: search
ms.devlang: rest-api
ms.workload: search
ms.topic: article
ms.tgt_pltfrm: na
ms.date: 3/10/2017
ms.author: heidist
ms.openlocfilehash: 413f498eeb0bbc9a971c7a65200ed2fd8caa9aaf
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/11/2017
---
# <a name="how-to-implement-faceted-navigation-in-azure-search"></a><span data-ttu-id="f0a5f-103">Implémentation de la navigation à facettes dans Azure Search</span><span class="sxs-lookup"><span data-stu-id="f0a5f-103">How to implement faceted navigation in Azure Search</span></span>
<span data-ttu-id="f0a5f-104">La navigation à facettes est un mécanisme de filtrage qui fournit une navigation autonome d'extraction dans les applications de recherche.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-104">Faceted navigation is a filtering mechanism that provides self-directed drilldown navigation in search applications.</span></span> <span data-ttu-id="f0a5f-105">Le terme « navigation à facettes » peut vous sembler peu familier, mais vous l’avez très certainement déjà utilisé.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-105">The term 'faceted navigation' may be unfamiliar, but you've probably used it before.</span></span> <span data-ttu-id="f0a5f-106">Comme l'indique l'exemple ci-dessous, la navigation à facettes correspond tout simplement aux catégories utilisées pour filtrer les résultats.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-106">As the following example shows, faceted navigation is nothing more than the categories used to filter results.</span></span>

 ![Démonstration du portail de recrutement Recherche Azure][1]

<span data-ttu-id="f0a5f-108">La navigation à facettes constitue un autre point d’entrée pour la recherche.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-108">Faceted navigation is an alternative entry point to search.</span></span> <span data-ttu-id="f0a5f-109">Elle offre une alternative pratique à la saisie manuelle d’expressions de recherche complexes.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-109">It offers a convenient alternative to typing complex search expressions by hand.</span></span> <span data-ttu-id="f0a5f-110">Les facettes peuvent vous aider à trouver ce que vous recherchez, tout en vous assurant d’obtenir au moins un résultat.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-110">Facets can help you find what you're looking for, while ensuring that you don’t get zero results.</span></span> <span data-ttu-id="f0a5f-111">En tant que développeur, les facettes vous permettent d'exposer les critères de recherche les plus utiles pour naviguer dans votre corpus de recherche.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-111">As a developer, facets let you expose the most useful search criteria for navigating your search corpus.</span></span> <span data-ttu-id="f0a5f-112">Dans les applications de vente au détail en ligne, la navigation à facettes repose souvent sur les marques, les catégories (chaussures pour enfants), la taille, le prix, la popularité et les évaluations.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-112">In online retail applications, faceted navigation is often built over brands, departments (kid’s shoes), size, price, popularity, and ratings.</span></span> 

<span data-ttu-id="f0a5f-113">L’implémentation de la navigation par facettes varie en fonction des technologies de recherche.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-113">Implementing faceted navigation differs across search technologies.</span></span> <span data-ttu-id="f0a5f-114">Dans Recherche Azure, la navigation à facettes est créée au moment de la requête, à l’aide de champs précédemment attribués dans votre schéma.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-114">In Azure Search, faceted navigation is built at query time, using fields that you previously attributed in your schema.</span></span>

-   <span data-ttu-id="f0a5f-115">Dans les requêtes créées par votre application, une requête doit envoyer des *paramètres de requête de facette* afin de recevoir les valeurs de filtre de facette disponibles pour ce jeu de résultats du document.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-115">In the queries that your application builds, a query must send *facet query parameters* to get the available facet filter values for that document result set.</span></span>

-   <span data-ttu-id="f0a5f-116">Pour réduire réellement le jeu de résultats du document, l’application doit également appliquer une expression `$filter`.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-116">To actually trim the document result set, the application must also apply a `$filter` expression.</span></span>

<span data-ttu-id="f0a5f-117">Dans le développement de votre application, l’écriture du code qui construit les requêtes constitue la majeure partie du travail.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-117">In your application development, writing code that constructs queries constitutes the bulk of the work.</span></span> <span data-ttu-id="f0a5f-118">La plupart des comportements de l’application que vous attendez de la navigation par facettes sont fournis par le service, y compris la prise en charge intégrée de la définition des plages et la récupération des décomptes pour les résultats de facettes.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-118">Many of the application behaviors that you would expect from faceted navigation are provided by the service, including built-in support for defining ranges and getting counts for facet results.</span></span> <span data-ttu-id="f0a5f-119">Le service comprend également des valeurs par défaut qui vous aident à éviter les structures de navigation difficiles à gérer.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-119">The service also includes sensible defaults that help you avoid unwieldy navigation structures.</span></span> 

## <a name="sample-code-and-demo"></a><span data-ttu-id="f0a5f-120">Exemple de code et démonstration</span><span class="sxs-lookup"><span data-stu-id="f0a5f-120">Sample code and demo</span></span>
<span data-ttu-id="f0a5f-121">Cet article prend l’exemple d’un portail de recrutement.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-121">This article uses a job search portal as an example.</span></span> <span data-ttu-id="f0a5f-122">L’exemple est implémenté en tant qu’application ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-122">The example is implemented as an ASP.NET MVC application.</span></span>

-   <span data-ttu-id="f0a5f-123">Consultez et testez la démonstration en ligne sur la [démonstration du portail de recrutement Recherche Azure](http://azjobsdemo.azurewebsites.net/).</span><span class="sxs-lookup"><span data-stu-id="f0a5f-123">See and test the working demo online at [Azure Search Job Portal Demo](http://azjobsdemo.azurewebsites.net/).</span></span>

-   <span data-ttu-id="f0a5f-124">Téléchargez le code à partir du [référentiel Azure-Samples sur GitHub](https://github.com/Azure-Samples/search-dotnet-asp-net-mvc-jobs).</span><span class="sxs-lookup"><span data-stu-id="f0a5f-124">Download the code from the [Azure-Samples repo on GitHub](https://github.com/Azure-Samples/search-dotnet-asp-net-mvc-jobs).</span></span>

## <a name="get-started"></a><span data-ttu-id="f0a5f-125">Prise en main</span><span class="sxs-lookup"><span data-stu-id="f0a5f-125">Get started</span></span>
<span data-ttu-id="f0a5f-126">Si vous êtes novice en recherche et développement, considérez que la navigation par facettes affiche les possibilités de recherche autonome.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-126">If you're new to search development, the best way to think of faceted navigation is that it shows the possibilities for self-directed search.</span></span> <span data-ttu-id="f0a5f-127">Il s'agit d'un type d'expérience de recherche détaillée, en fonction de filtres prédéfinis, utilisés pour limiter rapidement les résultats de la recherche à l'aide d'actions de type pointer et cliquer.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-127">It’s a type of drill-down search experience, based on predefined filters, used for quickly narrowing down search results through point-and-click actions.</span></span> 

### <a name="interaction-model"></a><span data-ttu-id="f0a5f-128">Modèle d’interaction</span><span class="sxs-lookup"><span data-stu-id="f0a5f-128">Interaction model</span></span>

<span data-ttu-id="f0a5f-129">L'expérience de recherche pour la navigation à facettes est itérative. Donc, essayons de la comprendre comme séquence de requêtes qui se déroulent en réponse aux actions de l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-129">The search experience for faceted navigation is iterative, so let’s start by understanding it as a sequence of queries that unfold in response to user actions.</span></span>

<span data-ttu-id="f0a5f-130">Le point de départ est une page d'application qui offre une navigation à facettes, généralement placée sur la périphérie.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-130">The starting point is an application page that provides faceted navigation, typically placed on the periphery.</span></span> <span data-ttu-id="f0a5f-131">La navigation à facettes est souvent présentée sous forme d'arborescence avec des cases à cocher pour chaque valeur ou du texte interactif.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-131">Faceted navigation is often a tree structure, with checkboxes for each value, or clickable text.</span></span> 

1. <span data-ttu-id="f0a5f-132">Une requête envoyée à Azure Search spécifie la structure de la navigation à facettes par le biais d'un ou plusieurs paramètres de requête de facette.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-132">A query sent to Azure Search specifies the faceted navigation structure via one or more facet query parameters.</span></span> <span data-ttu-id="f0a5f-133">Par exemple, la requête peut inclure `facet=Rating`, éventuellement avec une option `:values` ou `:sort` pour affiner la présentation.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-133">For instance, the query might include `facet=Rating`, perhaps with a `:values` or `:sort` option to further refine the presentation.</span></span>
2. <span data-ttu-id="f0a5f-134">La couche de présentation renvoie une page de recherche qui fournit une navigation à facettes, à l'aide des facettes spécifiées dans la requête.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-134">The presentation layer renders a search page that provides faceted navigation, using the facets specified on the request.</span></span>
3. <span data-ttu-id="f0a5f-135">Face à une structure de navigation à facettes qui inclut le paramètre Évaluation, vous cliquez sur « 4 » pour indiquer que seuls les produits dotés d’une évaluation minimale de 4 doivent être affichés.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-135">Given a faceted navigation structure that includes Rating, you click "4" to indicate that only products with a rating of 4 or higher should be shown.</span></span> 
4. <span data-ttu-id="f0a5f-136">En réponse, l'application envoie une requête qui inclut `$filter=Rating ge 4`</span><span class="sxs-lookup"><span data-stu-id="f0a5f-136">In response, the application sends a query that includes `$filter=Rating ge 4`</span></span> 
5. <span data-ttu-id="f0a5f-137">La couche de présentation met à jour la page en affichant un jeu de résultats réduit, contenant uniquement les éléments qui répondent aux nouveaux critères (dans ce cas, les produits avec une évaluation de 4 et supérieure).</span><span class="sxs-lookup"><span data-stu-id="f0a5f-137">The presentation layer updates the page, showing a reduced result set, containing just those items that satisfy the new criteria (in this case, products rated 4 and up).</span></span>

<span data-ttu-id="f0a5f-138">Une facette est un paramètre de requête, mais ne la confondez pas avec l'entrée de requête.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-138">A facet is a query parameter, but do not confuse it with query input.</span></span> <span data-ttu-id="f0a5f-139">Elle n'est jamais utilisée comme critère de sélection dans une requête.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-139">It is never used as selection criteria in a query.</span></span> <span data-ttu-id="f0a5f-140">Considérez plutôt les paramètres de requête de facette comme des entrées de la structure de navigation qui est renvoyée dans la réponse.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-140">Instead, think of facet query parameters as inputs to the navigation structure that comes back in the response.</span></span> <span data-ttu-id="f0a5f-141">Pour chaque paramètre de requête de facette que vous fournissez, Recherche Azure évalue le nombre de documents dans les résultats partiels pour chaque valeur de la facette.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-141">For each facet query parameter you provide, Azure Search evaluates how many documents are in the partial results for each facet value.</span></span>

<span data-ttu-id="f0a5f-142">Notez le `$filter` à l'étape 4.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-142">Notice the `$filter` in step 4.</span></span> <span data-ttu-id="f0a5f-143">Ce filtre constitue un aspect important de la navigation à facettes.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-143">The filter is an important aspect of faceted navigation.</span></span> <span data-ttu-id="f0a5f-144">Bien que les facettes et les filtres soient indépendants dans l’API, vous avez besoin des deux pour fournir l’expérience attendue.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-144">Although facets and filters are independent in the API, you need both to deliver the experience you intend.</span></span> 

### <a name="app-design-pattern"></a><span data-ttu-id="f0a5f-145">Modèle de conception de l’application</span><span class="sxs-lookup"><span data-stu-id="f0a5f-145">App design pattern</span></span>

<span data-ttu-id="f0a5f-146">Dans le code d’application, le modèle consiste à utiliser les paramètres de requête de facette pour renvoyer la structure de navigation à facettes, ainsi que les résultats de la facette, mais aussi une expression $filter.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-146">In application code, the pattern is to use facet query parameters to return the faceted navigation structure along with facet results, plus a $filter expression.</span></span>  <span data-ttu-id="f0a5f-147">L’expression de filtre gère l’événement clic sur la valeur de facette.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-147">The filter expression handles the click event on the facet value.</span></span> <span data-ttu-id="f0a5f-148">Considérez l'expression `$filter` comme le code derrière la réduction réelle des résultats de la recherche renvoyés à la couche de présentation.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-148">Think of the `$filter` expression as the code behind the actual trimming of search results returned to the presentation layer.</span></span> <span data-ttu-id="f0a5f-149">Dans le cas d'une facette Couleurs, le fait de cliquer sur la couleur Rouge est implémenté par le biais d'une expression `$filter` qui sélectionne uniquement les éléments qui ont une couleur rouge.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-149">Given a Colors facet, clicking the color Red is implemented through a `$filter` expression that selects only those items that have a color of red.</span></span> 

### <a name="query-basics"></a><span data-ttu-id="f0a5f-150">Principes de base des requêtes</span><span class="sxs-lookup"><span data-stu-id="f0a5f-150">Query basics</span></span>

<span data-ttu-id="f0a5f-151">Dans Azure Search, une requête est spécifiée par le biais d'un ou de plusieurs paramètres de requête (consultez [Rechercher des documents](http://msdn.microsoft.com/library/azure/dn798927.aspx) pour obtenir une description de chacun d'eux).</span><span class="sxs-lookup"><span data-stu-id="f0a5f-151">In Azure Search, a request is specified through one or more query parameters (see [Search Documents](http://msdn.microsoft.com/library/azure/dn798927.aspx) for a description of each one).</span></span> <span data-ttu-id="f0a5f-152">Aucun des paramètres de requête n'est requis, mais vous devez en avoir au moins un pour qu'une requête soit valide.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-152">None of the query parameters are required, but you must have at least one in order for a query to be valid.</span></span>

<span data-ttu-id="f0a5f-153">La précision, interprétée comme la possibilité de filtrer les résultats non pertinents, s’effectue par le biais d’une ou de ces deux expressions :</span><span class="sxs-lookup"><span data-stu-id="f0a5f-153">Precision, understood as the ability to filter out irrelevant hits, is achieved through one or both of these expressions:</span></span>

-   <span data-ttu-id="f0a5f-154">**search=**</span><span class="sxs-lookup"><span data-stu-id="f0a5f-154">**search=**</span></span>  
    <span data-ttu-id="f0a5f-155">La valeur de ce paramètre constitue l’expression de recherche.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-155">The value of this parameter constitutes the search expression.</span></span> <span data-ttu-id="f0a5f-156">Il peut s'agir d'une portion de texte unique ou d'une expression de recherche complexe qui comprend plusieurs termes et opérateurs.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-156">It might be a single piece of text, or a complex search expression that includes multiple terms and operators.</span></span> <span data-ttu-id="f0a5f-157">Sur le serveur, une expression de recherche est utilisée pour la recherche en texte intégral. Elle interroge les champs pouvant faire l'objet d'une recherche dans l'index pour la correspondance des termes et renvoie les résultats classés.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-157">On the server, a search expression is used for full-text search, querying searchable fields in the index for matching terms, returning results in rank order.</span></span> <span data-ttu-id="f0a5f-158">Si vous définissez `search` sur null, l'exécution de la requête est effectuée sur la totalité de l'index (c'est-à-dire, `search=*`).</span><span class="sxs-lookup"><span data-stu-id="f0a5f-158">If you set `search` to null, query execution is over the entire index (that is, `search=*`).</span></span> <span data-ttu-id="f0a5f-159">Dans ce cas, d’autres éléments de la requête, comme `$filter` ou un profil de score, sont les principaux facteurs qui influencent les documents renvoyés (`($filter`) ainsi que leur ordre (`scoringProfile` ou `$orderby`).</span><span class="sxs-lookup"><span data-stu-id="f0a5f-159">In this case, other elements of the query, such as a `$filter` or scoring profile, are the primary factors affecting which documents are returned `($filter`) and in what order (`scoringProfile` or `$orderby`).</span></span>

-   <span data-ttu-id="f0a5f-160">**$filter =**</span><span class="sxs-lookup"><span data-stu-id="f0a5f-160">**$filter=**</span></span>  
    <span data-ttu-id="f0a5f-161">Un filtre est un mécanisme puissant pour limiter la taille des résultats de la recherche basés sur les valeurs des attributs de document spécifiques.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-161">A filter is a powerful mechanism for limiting the size of search results based on the values of specific document attributes.</span></span> <span data-ttu-id="f0a5f-162">Un `$filter` est évalué en premier, suivi de la logique de facettes qui génère les valeurs disponibles et les décomptes correspondants pour chaque valeur</span><span class="sxs-lookup"><span data-stu-id="f0a5f-162">A `$filter` is evaluated first, followed by faceting logic that generates the available values and corresponding counts for each value</span></span>

<span data-ttu-id="f0a5f-163">Les expressions de recherche complexes diminuent les performances de la requête.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-163">Complex search expressions decrease the performance of the query.</span></span> <span data-ttu-id="f0a5f-164">Si possible, utilisez des expressions de filtre bien construites pour accroître la précision et améliorer les performances de la requête.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-164">Where possible, use well-constructed filter expressions to increase precision and improve query performance.</span></span>

<span data-ttu-id="f0a5f-165">Pour mieux comprendre comment un filtre ajoute plus de précision, comparez une expression de recherche complexe à une expression qui contient une expression de filtre :</span><span class="sxs-lookup"><span data-stu-id="f0a5f-165">To better understand how a filter adds more precision, compare a complex search expression to one that includes a filter expression:</span></span>

-   `GET /indexes/hotel/docs?search=lodging budget +Seattle –motel +parking`
-   `GET /indexes/hotel/docs?search=lodging&$filter=City eq ‘Seattle’ and Parking and Type ne ‘motel’`

<span data-ttu-id="f0a5f-166">Les deux requêtes sont valides, mais la seconde est préférable si vous cherchez des établissements autres que des « motels » avec stationnement à Seattle.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-166">Both queries are valid, but the second is superior if you’re looking for non-motels with parking in Seattle.</span></span>
-   <span data-ttu-id="f0a5f-167">La première requête repose sur ces mots spécifiques étant mentionnés ou non mentionnés dans des champs de type chaîne comme Nom, Description et tout autre champ contenant des données pouvant faire l'objet d'une recherche.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-167">The first query relies on those specific words being mentioned or not mentioned in string fields like Name, Description, and any other field containing searchable data.</span></span>
-   <span data-ttu-id="f0a5f-168">La deuxième requête recherche des correspondances précises sur des données structurées et est susceptible d'être beaucoup plus précise.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-168">The second query looks for precise matches on structured data and is likely to be much more accurate.</span></span>

<span data-ttu-id="f0a5f-169">Dans les applications qui incluent la navigation à facettes, veillez à ce que chaque action de l’utilisateur sur une structure de navigation à facettes soit accompagnée d’une réduction du champ des résultats de recherche.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-169">In applications that include faceted navigation, make sure that each user action over a faceted navigation structure is accompanied by a narrowing of search results.</span></span> <span data-ttu-id="f0a5f-170">Pour affiner les résultats, utilisez une expression de filtre.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-170">To narrow results, use a filter expression.</span></span>

<a name="howtobuildit"></a>

## <a name="build-a-faceted-navigation-app"></a><span data-ttu-id="f0a5f-171">Créer une application de navigation à facettes</span><span class="sxs-lookup"><span data-stu-id="f0a5f-171">Build a faceted navigation app</span></span>
<span data-ttu-id="f0a5f-172">Vous implémentez la navigation à facettes avec Recherche Azure dans le code d’application qui vous permet de créer la requête de recherche.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-172">You implement faceted navigation with Azure Search in your application code that builds the search request.</span></span> <span data-ttu-id="f0a5f-173">La navigation à facettes repose sur les éléments de schéma que vous avez définis précédemment.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-173">The faceted navigation relies on elements in your schema that you defined previously.</span></span>

<span data-ttu-id="f0a5f-174">L'attribut d'index `Facetable [true|false]` , prédéfini sur votre index de recherche, est défini sur des champs sélectionnés pour activer ou désactiver leur utilisation dans une structure de navigation à facettes.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-174">Predefined in your search index is the `Facetable [true|false]` index attribute, set on selected fields to enable or disable their use in a faceted navigation structure.</span></span> <span data-ttu-id="f0a5f-175">Sans `"Facetable" = true`, un champ ne peut pas être utilisé dans la navigation à facettes.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-175">Without `"Facetable" = true`, a field cannot be used in facet navigation.</span></span>

<span data-ttu-id="f0a5f-176">La couche de présentation dans votre code fournit l'expérience utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-176">The presentation layer in your code provides the user experience.</span></span> <span data-ttu-id="f0a5f-177">Elle doit répertorier les éléments constitutifs de la navigation à facettes, comme l'étiquette, les valeurs, les cases à cocher et le décompte.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-177">It should list the constituent parts of the faceted navigation, such as the label, values, check boxes, and the count.</span></span> <span data-ttu-id="f0a5f-178">L'API REST Azure Search est indépendante de la plateforme. Vous pouvez donc utiliser la langue et la plateforme que vous souhaitez.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-178">The Azure Search REST API is platform agnostic, so use whatever language and platform you want.</span></span> <span data-ttu-id="f0a5f-179">L'important est d'inclure des éléments d'interface utilisateur qui prennent en charge l'actualisation incrémentielle, avec l'état de l'interface utilisateur mis à jour lorsque chaque facette supplémentaire est sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-179">The important thing is to include UI elements that support incremental refresh, with updated UI state as each additional facet is selected.</span></span> 

<span data-ttu-id="f0a5f-180">Au moment de la requête, votre code d'application crée une requête qui inclut `facet=[string]`, un paramètre de requête qui fournit le champ sur lequel baser la facette.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-180">At query time, your application code creates a request that includes `facet=[string]`, a request parameter that provides the field to facet by.</span></span> <span data-ttu-id="f0a5f-181">Une requête peut avoir plusieurs facettes, comme `&facet=color&facet=category&facet=rating`, chaque facette étant séparée par un caractère d'esperluette (&).</span><span class="sxs-lookup"><span data-stu-id="f0a5f-181">A query can have multiple facets, such as `&facet=color&facet=category&facet=rating`, each one separated by an ampersand (&) character.</span></span>

<span data-ttu-id="f0a5f-182">Le code d'application doit également construire une expression `$filter` pour gérer les événements de clic dans la navigation à facettes.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-182">Application code must also construct a `$filter` expression to handle the click events in faceted navigation.</span></span> <span data-ttu-id="f0a5f-183">Un `$filter` réduit les résultats de la recherche, à l'aide de la valeur de facette comme critère de filtre.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-183">A `$filter` reduces the search results, using the facet value as filter criteria.</span></span>

<span data-ttu-id="f0a5f-184">Recherche Azure renvoie les résultats de la recherche en fonction du ou des mots que vous avez saisis, ainsi que les mises à jour de la structure de la navigation à facettes.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-184">Azure Search returns the search results, based on one or more terms that you enter, along with updates to the faceted navigation structure.</span></span> <span data-ttu-id="f0a5f-185">Dans Azure Search, la navigation à facettes est une construction à niveau unique, avec des valeurs de facettes et des décomptes des résultats trouvés pour chaque.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-185">In Azure Search, faceted navigation is a single-level construction, with facet values, and counts of how many results are found for each one.</span></span>

<span data-ttu-id="f0a5f-186">Dans les sections suivantes, nous allons étudier comment générer chaque partie.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-186">In the following sections, we take a closer look at how to build each part.</span></span>

<a name="buildindex"></a>

## <a name="build-the-index"></a><span data-ttu-id="f0a5f-187">Création de l'index</span><span class="sxs-lookup"><span data-stu-id="f0a5f-187">Build the index</span></span>
<span data-ttu-id="f0a5f-188">Les facettes sont activées sur une base de champ par champ dans l'index, au moyen de cet attribut d'index : `"Facetable": true`.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-188">Faceting is enabled on a field-by-field basis in the index, via this index attribute: `"Facetable": true`.</span></span>  
<span data-ttu-id="f0a5f-189">Tous les types de champs pouvant être utilisés dans la navigation à facettes sont `Facetable` par défaut.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-189">All field types that could possibly be used in faceted navigation are `Facetable` by default.</span></span> <span data-ttu-id="f0a5f-190">Ces types de champs incluent `Edm.String`, `Edm.DateTimeOffset` et tous les types de champs numériques (globalement, tous les types de champs peuvent être utilisés comme facettes, sauf `Edm.GeographyPoint` qui ne peut pas être utilisé dans la navigation à facettes).</span><span class="sxs-lookup"><span data-stu-id="f0a5f-190">Such field types include `Edm.String`, `Edm.DateTimeOffset`, and all the numeric field types (essentially, all field types are facetable except `Edm.GeographyPoint`, which can’t be used in faceted navigation).</span></span> 

<span data-ttu-id="f0a5f-191">Lorsque vous créez un index, nous vous recommandons, pour la navigation à facettes, de désactiver explicitement les facettes pour les champs qui ne doivent jamais être utilisés comme facettes.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-191">When building an index, a best practice for faceted navigation is to explicitly turn faceting off for fields that should never be used as a facet.</span></span>  <span data-ttu-id="f0a5f-192">En particulier, les champs de chaîne pour les valeurs singleton, comme un ID ou un nom de produit, doivent être définis sur `"Facetable": false` pour empêcher leur utilisation accidentelle (et inefficace) dans la navigation à facettes.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-192">In particular, string fields for singleton values, such as an ID or product name, should be set to `"Facetable": false` to prevent their accidental (and ineffective) use in faceted navigation.</span></span> <span data-ttu-id="f0a5f-193">Le fait de désactiver les facettes inutiles permet de conserver une taille d’index réduite, ce qui améliore généralement les performances.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-193">Turning faceting off where you don’t need it helps keep the size of the index small, and typically improves performance.</span></span>

<span data-ttu-id="f0a5f-194">Vous trouverez ci-dessous une partie du schéma de l’exemple d’application de démonstration du portail de recrutement, sans certains attributs pour en réduire la taille :</span><span class="sxs-lookup"><span data-stu-id="f0a5f-194">Following is part of the schema for the Job Portal Demo sample app, trimmed of some attributes to reduce the size:</span></span>

```json
{
  ...
  "name": "nycjobs",
  "fields": [
    { “name”: "id",                 "type": "Edm.String",              "searchable": false, "filterable": false, ... "facetable": false, ... },
    { “name”: "job_id",             "type": "Edm.String",              "searchable": false, "filterable": false, ... "facetable": false, ... },
    { “name”: "agency",              "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "posting_type",        "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "num_of_positions",    "type": "Edm.Int32",              "searchable": false, "filterable": true, ...  "facetable": true, ...  },
    { “name”: "business_title",      "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "civil_service_title", "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "title_code_no",       "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "level",               "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "salary_range_from",   "type": "Edm.Int32",              "searchable": false, "filterable": true, ...  "facetable": true, ...  },
    { “name”: "salary_range_to",     "type": "Edm.Int32",              "searchable": false, "filterable": true, ...  "facetable": true, ...  },
    { “name”: "salary_frequency",    "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "work_location",       "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
…
    { “name”: "geo_location",        "type": "Edm.GeographyPoint",     "searchable": false, "filterable": true, ...  "facetable": false, ... },
    { “name”: "tags",                "type": "Collection(Edm.String)", "searchable": true,  "filterable": true, ...  "facetable": true, ...  }
  ],
…
}
```

<span data-ttu-id="f0a5f-195">Conformément à l’exemple de schéma, l’option `Facetable` est désactivée pour les champs de chaîne qui ne doivent pas être utilisés comme facettes, tels que les valeurs d’ID.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-195">As you can see in the sample schema, `Facetable` is turned off for string fields that shouldn’t be used as facets, such as ID values.</span></span> <span data-ttu-id="f0a5f-196">Le fait de désactiver les facettes inutiles permet de conserver une taille d’index réduite, ce qui améliore généralement les performances.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-196">Turning faceting off where you don’t need it helps keep the size of the index small, and typically improves performance.</span></span>

> [!TIP]
> <span data-ttu-id="f0a5f-197">Nous vous recommandons d'inclure l'ensemble des attributs d'index pour chaque champ.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-197">As a best practice, include the full set of index attributes for each field.</span></span> <span data-ttu-id="f0a5f-198">Bien que l'option `Facetable` soit activée par défaut pour presque tous les champs, le fait de configurer volontairement chaque attribut peut vous aider à réfléchir aux implications de chaque décision au sein du schéma.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-198">Although `Facetable` is on by default for almost all fields, purposely setting each attribute can help you think through the implications of each schema decision.</span></span> 

<a name="checkdata"></a>

## <a name="check-the-data"></a><span data-ttu-id="f0a5f-199">Vérifier les données</span><span class="sxs-lookup"><span data-stu-id="f0a5f-199">Check the data</span></span>
<span data-ttu-id="f0a5f-200">La qualité de vos données a un effet direct sur la matérialisation attendue de la structure de la navigation à facettes.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-200">The quality of your data has a direct effect on whether the faceted navigation structure materializes as you expect it to.</span></span> <span data-ttu-id="f0a5f-201">Elle affecte également la facilité de création des filtres afin de limiter le jeu de résultats.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-201">It also affects the ease of constructing filters to reduce the result set.</span></span>

<span data-ttu-id="f0a5f-202">Si vous souhaitez trier selon la marque ou le prix, chaque document doit contenir des valeurs *BrandName* et *ProductPrice* valides, cohérentes et productives en tant qu’option de filtre.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-202">If you want to facet by Brand or Price, each document should contain values for *BrandName* and *ProductPrice* that are valid, consistent, and productive as a filter option.</span></span>

<span data-ttu-id="f0a5f-203">Voici quelques rappels des points à appliquer :</span><span class="sxs-lookup"><span data-stu-id="f0a5f-203">Here are a few reminders of what to scrub for:</span></span>

* <span data-ttu-id="f0a5f-204">Pour chaque champ que vous souhaitez utiliser comme facette, demandez-vous s'il contient des valeurs qui conviennent en tant que filtres dans une recherche autonome.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-204">For every field that you want to facet by, ask yourself whether it contains values that are suitable as filters in self-directed search.</span></span> <span data-ttu-id="f0a5f-205">Les valeurs doivent être courtes, descriptives et suffisamment distinctives pour offrir un choix clair entre les différentes options.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-205">The values should be short, descriptive, and sufficiently distinctive to offer a clear choice between competing options.</span></span>
* <span data-ttu-id="f0a5f-206">Fautes d'orthographe ou valeurs presque correspondantes.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-206">Misspellings or nearly matching values.</span></span> <span data-ttu-id="f0a5f-207">Si vous créez une facette Couleur et que les valeurs de champ incluent Orange et Ornage (faute d'orthographe), une facette basée sur le champ Couleur renverrait les deux options.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-207">If you facet on Color, and field values include Orange and Ornage (a misspelling), a facet based on the Color field would pick up both.</span></span>
* <span data-ttu-id="f0a5f-208">Le texte à casse mixte peut également causer des dégâts dans la navigation à facettes, où orange et Orange s'afficheraient comme deux valeurs différentes.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-208">Mixed case text can also wreak havoc in faceted navigation, with orange and Orange appearing as two different values.</span></span> 
* <span data-ttu-id="f0a5f-209">Les versions au singulier et au pluriel de la même valeur peuvent entraîner une facette distincte pour chacune.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-209">Single and plural versions of the same value can result in a separate facet for each.</span></span>

<span data-ttu-id="f0a5f-210">Comme vous pouvez l'imaginer, la rigueur en termes de préparation des données est un aspect essentiel d'une navigation à facettes efficace.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-210">As you can imagine, diligence in preparing the data is an essential aspect of effective faceted navigation.</span></span>

<a name="presentationlayer"></a>

## <a name="build-the-ui"></a><span data-ttu-id="f0a5f-211">Créer l’interface utilisateur</span><span class="sxs-lookup"><span data-stu-id="f0a5f-211">Build the UI</span></span>
<span data-ttu-id="f0a5f-212">Le fait de travailler à partir de la couche de présentation peut vous aider à découvrir des exigences que vous auriez pu manquer dans le cas contraire et de comprendre les capacités essentielles à l'expérience de recherche.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-212">Working back from the presentation layer can help you uncover requirements that might be missed otherwise, and understand which capabilities are essential to the search experience.</span></span>

<span data-ttu-id="f0a5f-213">En termes de navigation à facettes, votre page Web ou d'application affiche la structure de navigation à facettes, détecte une entrée utilisateur sur la page et insère les éléments modifiés.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-213">In terms of faceted navigation, your web or application page displays the faceted navigation structure, detects user input on the page, and inserts the changed elements.</span></span> 

<span data-ttu-id="f0a5f-214">Pour les applications Web, la méthode AJAX est en général utilisée dans la couche de présentation, car elle vous permet d'actualiser les modifications incrémentielles.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-214">For web applications, AJAX is commonly used in the presentation layer because it allows you to refresh incremental changes.</span></span> <span data-ttu-id="f0a5f-215">Vous pouvez également utiliser ASP.NET MVC ou toute autre plateforme de visualisation qui peut se connecter à un service Azure Search par le biais de HTTP.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-215">You could also use ASP.NET MVC or any other visualization platform that can connect to an Azure Search service over HTTP.</span></span> <span data-ttu-id="f0a5f-216">L’exemple d’application référencé dans cet article (**Démonstration du portail de recrutement Recherche Azure**) est une application ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-216">The sample application referenced throughout this article -- the **Azure Search Job Portal Demo** – happens to be an ASP.NET MVC application.</span></span>

<span data-ttu-id="f0a5f-217">Dans l’exemple fourni, la navigation à facettes est intégrée dans la page de résultats.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-217">In the sample, faceted navigation is built into the search results page.</span></span> <span data-ttu-id="f0a5f-218">L’exemple suivant, extrait du fichier `index.cshtml` de l’exemple d’application, montre la structure HTML statique correspondant à l’affichage de la navigation à facettes sur la page des résultats de la recherche.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-218">The following example, taken from the `index.cshtml` file of the sample application, shows the static HTML structure for displaying faceted navigation on the search results page.</span></span> <span data-ttu-id="f0a5f-219">La liste de facettes est créée ou recréée dynamiquement lorsque vous envoyez un terme de recherche, ou lorsque vous activez ou désactivez une facette.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-219">The list of facets is built or rebuilt dynamically when you submit a search term, or select or clear a facet.</span></span>

```html
<div class="widget sidebar-widget jobs-filter-widget">
  <h5 class="widget-title">Filter Results</h5>
    <p id="filterReset"></p>
    <div class="widget-content">

      <h6 id="businessTitleFacetTitle">Business Title</h6>
      <ul class="filter-list" id="business_title_facets">
      </ul>

      <h6>Location</h6>
      <ul class="filter-list" id="posting_type_facets">
      </ul>

      <h6>Posting Type</h6>
      <ul class="filter-list" id="posting_type_facets"></ul>

      <h6>Minimum Salary</h6>
      <ul class="filter-list" id="salary_range_facets">
      </ul>

  </div>
</div>
```

<span data-ttu-id="f0a5f-220">L’extrait de code suivant, tiré de la page `index.cshtml`, crée dynamiquement le code HTML permettant d’afficher la première facette, Fonction.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-220">The following code snippet from the `index.cshtml` page dynamically builds the HTML to display the first facet, Business Title.</span></span> <span data-ttu-id="f0a5f-221">Des fonctions similaires génèrent dynamiquement le code HTML pour les autres facettes.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-221">Similar functions dynamically build the HTML for the other facets.</span></span> <span data-ttu-id="f0a5f-222">Chaque facette est associée à une étiquette et à un nombre indiquant combien d’éléments ont été trouvés pour ce résultat de facette.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-222">Each facet has a label and a count, which displays the number of items found for that facet result.</span></span>

```js
function UpdateBusinessTitleFacets(data) {
  var facetResultsHTML = '';
  for (var i = 0; i < data.length; i++) {
    facetResultsHTML += '<li><a href="javascript:void(0)" onclick="ChooseBusinessTitleFacet(\'' + data[i].Value + '\');">' + data[i].Value + ' (' + data[i].Count + ')</span></a></li>';
  }

  $("#business_title_facets").html(facetResultsHTML);
}
```

> [!TIP]
> <span data-ttu-id="f0a5f-223">Lorsque vous concevez la page de résultats, pensez à ajouter un mécanisme de suppression des facettes.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-223">When you design the search results page, remember to add a mechanism for clearing facets.</span></span> <span data-ttu-id="f0a5f-224">Si vous ajoutez des cases à cocher, il est facile de savoir comment effacer les filtres.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-224">If you add check boxes, you can easily see how to clear the filters.</span></span> <span data-ttu-id="f0a5f-225">Pour les autres dispositions, vous devrez peut-être utiliser un modèle de navigation ou une autre approche créative.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-225">For other layouts, you might need a breadcrumb pattern or another creative approach.</span></span> <span data-ttu-id="f0a5f-226">Ainsi, dans l’exemple d’application du portail de recrutement, vous pouvez cliquer sur `[X]` situé en regard d’une facette pour effacer cette dernière.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-226">For example, in the Job Search Portal sample application, you can click the `[X]` after a selected facet to clear the facet.</span></span>

<a name="buildquery"></a>

## <a name="build-the-query"></a><span data-ttu-id="f0a5f-227">Création de la requête</span><span class="sxs-lookup"><span data-stu-id="f0a5f-227">Build the query</span></span>
<span data-ttu-id="f0a5f-228">Le code que vous écrivez pour la création de requêtes doit spécifier toutes les parties d'une requête valide, y compris les expressions de recherche, les facettes, les filtres, les profils de score ; tout ce qui sert à formuler une requête.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-228">The code that you write for building queries should specify all parts of a valid query, including search expressions, facets, filters, scoring profiles– anything used to formulate a request.</span></span> <span data-ttu-id="f0a5f-229">Dans cette section, nous allons explorer l’emplacement où les facettes s’intègrent dans une requête, ainsi que la façon dont les filtres sont utilisés avec des facettes pour fournir un jeu de résultats réduit.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-229">In this section, we explore where facets fit into a query, and how filters are used with facets to deliver a reduced result set.</span></span>

<span data-ttu-id="f0a5f-230">Notez que les facettes font partie intégrante de cet exemple d'application.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-230">Notice that facets are integral in this sample application.</span></span> <span data-ttu-id="f0a5f-231">L’expérience de recherche dans la démonstration du portail de recrutement est conçue autour de filtres et de la navigation à facettes.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-231">The search experience in the Job Portal Demo is designed around faceted navigation and filters.</span></span> <span data-ttu-id="f0a5f-232">La position de la navigation à facettes sur la page démontre son importance.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-232">The prominent placement of faceted navigation on the page demonstrates its importance.</span></span> 

<span data-ttu-id="f0a5f-233">Pour commencer, prenons un exemple.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-233">An example is often a good place to begin.</span></span> <span data-ttu-id="f0a5f-234">L’exemple suivant, extrait du fichier `JobsSearch.cs`, construit une requête qui crée une navigation à facettes basée sur la Fonction, le Lieu, le Type de publication et le Salaire minimal.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-234">The following example, taken from the `JobsSearch.cs` file, builds a request that creates facet navigation based on Business Title, Location, Posting Type, and Minimum Salary.</span></span> 

```cs
SearchParameters sp = new SearchParameters()
{
  ...
  // Add facets
  Facets = new List<String>() { "business_title", "posting_type", "level", "salary_range_from,interval:50000" },
};
```

<span data-ttu-id="f0a5f-235">Un paramètre de requête à facettes est défini sur un champ et, selon le type de données, peut être davantage paramétré par une liste délimitée par des virgules qui inclut `count:<integer>`, `sort:<>`, `interval:<integer>` et `values:<list>`.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-235">A facet query parameter is set to a field and depending on the data type, can be further parameterized by comma-delimited list that includes `count:<integer>`, `sort:<>`, `interval:<integer>`, and `values:<list>`.</span></span> <span data-ttu-id="f0a5f-236">Une liste de valeurs est prise en charge pour les données numériques lors de la définition de plages.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-236">A values list is supported for numeric data when setting up ranges.</span></span> <span data-ttu-id="f0a5f-237">Consultez [Rechercher des documents (API Azure Search)](http://msdn.microsoft.com/library/azure/dn798927.aspx) pour obtenir des détails sur l'utilisation.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-237">See [Search Documents (Azure Search API)](http://msdn.microsoft.com/library/azure/dn798927.aspx) for usage details.</span></span>

<span data-ttu-id="f0a5f-238">En plus des facettes, la requête formulée par votre application doit également créer des filtres pour limiter le jeu de documents candidats basés sur une sélection de valeur de facette.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-238">Along with facets, the request formulated by your application should also build filters to narrow down the set of candidate documents based on a facet value selection.</span></span> <span data-ttu-id="f0a5f-239">Pour un magasin de vélos, la navigation à facettes fournit des indications aux questions du type *Quels sont les couleurs, fabricants et types de vélos disponibles ?*.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-239">For a bike store, faceted navigation provides clues to questions like *What colors, manufacturers, and types of bikes are available?*.</span></span> <span data-ttu-id="f0a5f-240">Le filtrage permet de répondre à des questions du type *Quels sont les vélos de type VTT et de couleur rouge dans cette gamme de prix ?*.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-240">Filtering answers questions like *Which exact bikes are red, mountain bikes, in this price range?*.</span></span> <span data-ttu-id="f0a5f-241">Lorsque vous cliquez sur « Rouge » pour indiquer que seuls les produits de couleur rouge doivent s’afficher, la requête suivante envoyée par l’application inclut `$filter=Color eq ‘Red’`.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-241">When you click "Red" to indicate that only Red products should be shown, the next query the application sends includes `$filter=Color eq ‘Red’`.</span></span>

<span data-ttu-id="f0a5f-242">L’extrait de code suivant tiré de la page `JobsSearch.cs` ajoute la Fonction sélectionnée au filtre si vous sélectionnez une valeur de la facette Fonction.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-242">The following code snippet from the `JobsSearch.cs` page adds the selected Business Title to the filter if you select a value from the Business Title facet.</span></span>

```cs
if (businessTitleFacet != "")
  filter = "business_title eq '" + businessTitleFacet + "'";
```

<a name="tips"></a> 

## <a name="tips-and-best-practices"></a><span data-ttu-id="f0a5f-243">Conseils et meilleures pratiques</span><span class="sxs-lookup"><span data-stu-id="f0a5f-243">Tips and best practices</span></span>

### <a name="indexing-tips"></a><span data-ttu-id="f0a5f-244">Conseils d’indexation</span><span class="sxs-lookup"><span data-stu-id="f0a5f-244">Indexing tips</span></span>
<span data-ttu-id="f0a5f-245">**Améliorer l’efficacité des index si vous n’utilisez pas de zone de recherche**</span><span class="sxs-lookup"><span data-stu-id="f0a5f-245">**Improve index efficiency if you don't use a Search box**</span></span>

<span data-ttu-id="f0a5f-246">Si votre application utilise exclusivement la navigation à facettes (autrement dit, aucune zone de recherche), vous pouvez marquer le champ en tant que `searchable=false`, `facetable=true` pour produire un index plus compact.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-246">If your application uses faceted navigation exclusively (that is, no search box), you can mark the field as `searchable=false`, `facetable=true` to produce a more compact index.</span></span> <span data-ttu-id="f0a5f-247">En outre, l'indexation se produit uniquement sur les valeurs de facettes entières, sans césure de mots ou indexation des composants d'une valeur à plusieurs mots.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-247">In addition, indexing occurs only on whole facet values, with no word-break or indexing of the component parts of a multi-word value.</span></span>

<span data-ttu-id="f0a5f-248">**Spécifier les champs qui peuvent servir de facettes**</span><span class="sxs-lookup"><span data-stu-id="f0a5f-248">**Specify which fields can be used as facets**</span></span>

<span data-ttu-id="f0a5f-249">N'oubliez pas que le schéma de l'index détermine quels champs sont disponibles pour être utilisés comme facettes.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-249">Recall that the schema of the index determines which fields are available to use as a facet.</span></span> <span data-ttu-id="f0a5f-250">En supposant qu'un champ puisse être utilisé comme facette, la requête spécifie quels champs utiliser comme facettes.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-250">Assuming a field is facetable, the query specifies which fields to facet by.</span></span> <span data-ttu-id="f0a5f-251">Le champ que vous utilisez comme facette fournit les valeurs qui apparaissent sous l'étiquette.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-251">The field by which you are faceting provides the values that appear below the label.</span></span> 

<span data-ttu-id="f0a5f-252">Les valeurs qui s'affichent sous chaque étiquette sont récupérées à partir de l'index.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-252">The values that appear under each label are retrieved from the index.</span></span> <span data-ttu-id="f0a5f-253">Par exemple, si le champ de facette est *Couleur*, les valeurs disponibles pour le filtrage supplémentaire sont les valeurs de ce champ : Rouge, Noir, etc.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-253">For example, if the facet field is *Color*, the values available for additional filtering are the values for that field - Red, Black, and so forth.</span></span>

<span data-ttu-id="f0a5f-254">Pour les valeurs de type Numérique et DateHeure uniquement, vous pouvez définir explicitement des valeurs sur le champ de facette (par exemple, `facet=Rating,values:1|2|3|4|5`).</span><span class="sxs-lookup"><span data-stu-id="f0a5f-254">For Numeric and DateTime values only, you can explicitly set values on the facet field (for example, `facet=Rating,values:1|2|3|4|5`).</span></span> <span data-ttu-id="f0a5f-255">Une liste de valeurs est autorisée pour ces types de champs afin de simplifier la séparation des résultats de la facette en plages contiguës (plages basées sur des valeurs numériques ou des périodes de temps).</span><span class="sxs-lookup"><span data-stu-id="f0a5f-255">A values list is allowed for these field types to simplify the separation of facet results into contiguous ranges (either ranges based on numeric values or time periods).</span></span> 

<span data-ttu-id="f0a5f-256">**Par défaut, vous ne pouvez avoir qu’un seul niveau de navigation par facettes**</span><span class="sxs-lookup"><span data-stu-id="f0a5f-256">**By default you can only have one level of faceted navigation**</span></span> 

<span data-ttu-id="f0a5f-257">Comme mentionné, il n'existe aucune prise en charge directe de l'imbrication des facettes dans une hiérarchie.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-257">As noted, there is no direct support for nesting facets in a hierarchy.</span></span> <span data-ttu-id="f0a5f-258">Par défaut, la navigation à facettes dans Recherche Azure ne prend en charge qu’un seul niveau de filtres.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-258">By default, faceted navigation in Azure Search only supports one level of filters.</span></span> <span data-ttu-id="f0a5f-259">Toutefois, des solutions de contournement existent.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-259">However, workarounds do exist.</span></span> <span data-ttu-id="f0a5f-260">Vous pouvez encoder une structure hiérarchique de facette dans une `Collection(Edm.String)` avec un point d'entrée par hiérarchie.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-260">You can encode a hierarchical facet structure in a `Collection(Edm.String)` with one entry point per hierarchy.</span></span> <span data-ttu-id="f0a5f-261">L’implémentation de cette solution de contournement n’est pas abordée dans cet article.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-261">Implementing this workaround is beyond the scope of this article.</span></span> 

### <a name="querying-tips"></a><span data-ttu-id="f0a5f-262">Conseils d’interrogation</span><span class="sxs-lookup"><span data-stu-id="f0a5f-262">Querying tips</span></span>
<span data-ttu-id="f0a5f-263">**Validation des champs**</span><span class="sxs-lookup"><span data-stu-id="f0a5f-263">**Validate fields**</span></span>

<span data-ttu-id="f0a5f-264">Si vous générez dynamiquement la liste de facettes en fonction d’une entrée utilisateur non fiable, vérifiez la validité des noms des champs à facettes.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-264">If you build the list of facets dynamically based on untrusted user input, validate that the names of the faceted fields are valid.</span></span> <span data-ttu-id="f0a5f-265">Vous pouvez également contourner les noms lors de la génération d’URL à l’aide de `Uri.EscapeDataString()` dans .NET, ou son équivalent dans la plateforme de votre choix.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-265">Or, escape the names when building URLs by using either `Uri.EscapeDataString()` in .NET, or the equivalent in your platform of choice.</span></span>

### <a name="filtering-tips"></a><span data-ttu-id="f0a5f-266">Conseils de filtrage</span><span class="sxs-lookup"><span data-stu-id="f0a5f-266">Filtering tips</span></span>
<span data-ttu-id="f0a5f-267">**Augmenter la précision de la recherche avec des filtres**</span><span class="sxs-lookup"><span data-stu-id="f0a5f-267">**Increase search precision with filters**</span></span>

<span data-ttu-id="f0a5f-268">Utilisation de filtres.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-268">Use filters.</span></span> <span data-ttu-id="f0a5f-269">Si vous utilisez uniquement les expressions de recherche, la recherche de radical peut entraîner le renvoi d'un document qui ne contient pas la valeur de facette précise dans aucun de ses champs.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-269">If you rely on just search expressions alone, stemming could cause a document to be returned that doesn’t have the precise facet value in any of its fields.</span></span>

<span data-ttu-id="f0a5f-270">**Augmenter les performances de recherche avec des filtres**</span><span class="sxs-lookup"><span data-stu-id="f0a5f-270">**Increase search performance with filters**</span></span>

<span data-ttu-id="f0a5f-271">Les filtres réduisent le jeu de documents candidats pour la recherche et les excluent du classement.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-271">Filters narrow down the set of candidate documents for search and exclude them from ranking.</span></span> <span data-ttu-id="f0a5f-272">Pour les grands jeux de documents, l’utilisation d’une exploration à facettes sélective offre souvent de meilleures performances.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-272">If you have a large set of documents, using a selective facet drill-down often gives you better performance.</span></span>
  
<span data-ttu-id="f0a5f-273">**Filtrer uniquement les champs à facettes**</span><span class="sxs-lookup"><span data-stu-id="f0a5f-273">**Filter only the faceted fields**</span></span>

<span data-ttu-id="f0a5f-274">Dans l’exploration à facettes, vous voulez en général inclure uniquement les documents contenant la valeur de facette dans un champ spécifique (facette), et pas n’importe où dans tous les champs de recherche.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-274">In faceted drill-down, you typically want to only include documents that have the facet value in a specific (faceted) field, not anywhere across all searchable fields.</span></span> <span data-ttu-id="f0a5f-275">L'ajout d'un filtre renforce le champ cible en indiquant au service de rechercher uniquement dans le champ à facette pour trouver une valeur correspondante.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-275">Adding a filter reinforces the target field by directing the service to search only in the faceted field for a matching value.</span></span>

<span data-ttu-id="f0a5f-276">**Tronquer les résultats de facettes avec d’autres filtres**</span><span class="sxs-lookup"><span data-stu-id="f0a5f-276">**Trim facet results with more filters**</span></span>

<span data-ttu-id="f0a5f-277">Les résultats de la facette sont des documents trouvés dans les résultats de la recherche qui correspondent à un terme de la facette.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-277">Facet results are documents found in the search results that match a facet term.</span></span> <span data-ttu-id="f0a5f-278">Dans l’exemple suivant, dans les résultats de la recherche pour *cloud computing*, 254 éléments ont également la *spécification interne* comme type de contenu.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-278">In the following example, in search results for *cloud computing*, 254 items also have *internal specification* as a content type.</span></span> <span data-ttu-id="f0a5f-279">Les éléments ne sont pas nécessairement mutuellement exclusifs.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-279">Items are not necessarily mutually exclusive.</span></span> <span data-ttu-id="f0a5f-280">Si un élément répond aux critères des deux filtres, il est compté dans chacun d'eux.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-280">If an item meets the criteria of both filters, it is counted in each one.</span></span> <span data-ttu-id="f0a5f-281">La duplication est possible lors de l’utilisation des facettes sur les champs `Collection(Edm.String)`, souvent utilisés pour implémenter le balisage de document.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-281">This duplication is possible when faceting on `Collection(Edm.String)` fields, which are often used to implement document tagging.</span></span>

        Search term: "cloud computing"
        Content type
           Internal specification (254)
           Video (10) 

<span data-ttu-id="f0a5f-282">En général, si vous trouvez que les résultats de la facette sont toujours trop volumineux, nous vous recommandons d’ajouter des filtres afin d’apporter aux utilisateurs de votre application plus d’options pour affiner la recherche.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-282">In general, if you find that facet results are consistently too large, we recommend that you add more filters to give users more options for narrowing the search.</span></span>

### <a name="tips-about-result-count"></a><span data-ttu-id="f0a5f-283">Conseils sur le décompte des résultats</span><span class="sxs-lookup"><span data-stu-id="f0a5f-283">Tips about result count</span></span>

<span data-ttu-id="f0a5f-284">**Limiter le nombre d’éléments dans la navigation par facettes**</span><span class="sxs-lookup"><span data-stu-id="f0a5f-284">**Limit the number of items in the facet navigation**</span></span>

<span data-ttu-id="f0a5f-285">Pour chaque champ à facettes dans l'arborescence de navigation, il existe une limite par défaut de 10 valeurs.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-285">For each faceted field in the navigation tree, there is a default limit of 10 values.</span></span> <span data-ttu-id="f0a5f-286">Cette valeur par défaut est judicieuse pour les structures de navigation, car elle permet de conserver une taille gérable pour la liste des valeurs.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-286">This default makes sense for navigation structures because it keeps the values list to a manageable size.</span></span> <span data-ttu-id="f0a5f-287">Vous pouvez remplacer la valeur par défaut en affectant une valeur à compter.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-287">You can override the default by assigning a value to count.</span></span>

* <span data-ttu-id="f0a5f-288">`&facet=city,count:5` spécifie que seules les cinq premières villes trouvées dans les résultats en tête du classement sont renvoyées en tant que résultat de la facette.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-288">`&facet=city,count:5` specifies that only the first five cities found in the top ranked results are returned as a facet result.</span></span> <span data-ttu-id="f0a5f-289">Imaginez un exemple de requête affichant le terme de recherche « aéroport » et 32 correspondances.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-289">Consider a sample query with a search term of “airport” and 32 matches.</span></span> <span data-ttu-id="f0a5f-290">Si la requête spécifie `&facet=city,count:5`, seules les cinq premières villes uniques avec le plus de documents dans les résultats de la recherche sont incluses dans les résultats de la facette.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-290">If the query specifies `&facet=city,count:5`, only the first five unique cities with the most documents in the search results are included in the facet results.</span></span>

<span data-ttu-id="f0a5f-291">Notez la différence entre les résultats de la recherche et les résultats de la facette.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-291">Notice the distinction between facet results and search results.</span></span> <span data-ttu-id="f0a5f-292">Les résultats de la recherche sont tous les documents qui correspondent à la requête.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-292">Search results are all the documents that match the query.</span></span> <span data-ttu-id="f0a5f-293">Les résultats de la facette sont les correspondances pour chaque valeur de facette.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-293">Facet results are the matches for each facet value.</span></span> <span data-ttu-id="f0a5f-294">Dans l’exemple, les résultats de la recherche incluent des noms de villes qui ne se trouvent pas dans la liste de classification de la facette (5, dans notre exemple).</span><span class="sxs-lookup"><span data-stu-id="f0a5f-294">In the example, search results include City names that are not in the facet classification list (5 in our example).</span></span> <span data-ttu-id="f0a5f-295">Les résultats filtrés par le biais de la navigation à facettes deviennent visibles lorsque vous effacez les facettes ou choisissez d’autres facettes en plus de Ville.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-295">Results that are filtered out through faceted navigation become visible when you clear facets, or choose other facets besides City.</span></span> 

> [!NOTE]
> <span data-ttu-id="f0a5f-296">Traiter de `count` lorsqu'il existe plus d'un type peut prêter à confusion.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-296">Discussing `count` when there is more than one type can be confusing.</span></span> <span data-ttu-id="f0a5f-297">Le tableau suivant offre un bref résumé de l'utilisation du terme dans l'API Azure Search, un exemple de code et la documentation.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-297">The following table offers a brief summary of how the term is used in Azure Search API, sample code, and documentation.</span></span> 

* `@colorFacet.count`<br/>
  <span data-ttu-id="f0a5f-298">Dans le code de présentation, un paramètre de décompte doit s’afficher sur la facette. Il est utilisé pour afficher le nombre de résultats de la facette.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-298">In presentation code, you should see a count parameter on the facet, used to display the number of facet results.</span></span> <span data-ttu-id="f0a5f-299">Dans les résultats de la facette, le décompte indique le nombre de documents qui correspondent au terme ou à la plage de la facette.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-299">In facet results, count indicates the number of documents that match on the facet term or range.</span></span>
* `&facet=City,count:12`<br/>
  <span data-ttu-id="f0a5f-300">Dans une requête de facette, vous pouvez définir le décompte sur une valeur.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-300">In a facet query, you can set count to a value.</span></span>  <span data-ttu-id="f0a5f-301">La valeur par défaut est 10, mais vous pouvez définir une valeur supérieure ou inférieure.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-301">The default is 10, but you can set it higher or lower.</span></span> <span data-ttu-id="f0a5f-302">Le paramètre `count:12` renvoie les 12 premières correspondances dans les résultats de la facette selon le décompte de documents.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-302">Setting `count:12` gets the top 12 matches in facet results by document count.</span></span>
* <span data-ttu-id="f0a5f-303">"`@odata.count`"</span><span class="sxs-lookup"><span data-stu-id="f0a5f-303">"`@odata.count`"</span></span><br/>
  <span data-ttu-id="f0a5f-304">Dans la réponse de la requête, cette valeur indique le nombre d'éléments correspondants dans les résultats de la recherche.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-304">In the query response, this value indicates the number of matching items in the search results.</span></span> <span data-ttu-id="f0a5f-305">En moyenne, il est supérieur à la somme de tous les résultats de la facette combinés, en raison de la présence d'éléments qui correspondent au terme de la recherche, mais sans correspondance avec la valeur de la facette.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-305">On average, it’s larger than the sum of all facet results combined, due to the presence of items that match the search term, but have no facet value matches.</span></span>

<span data-ttu-id="f0a5f-306">**Obtenir les décomptes dans les résultats de facettes**</span><span class="sxs-lookup"><span data-stu-id="f0a5f-306">**Get counts in facet results**</span></span>

<span data-ttu-id="f0a5f-307">Lorsque vous ajoutez un filtre à une requête à facettes, il se peut que vous souhaitiez conserver l’instruction de facette (par exemple, `facet=Rating&$filter=Rating ge 4`).</span><span class="sxs-lookup"><span data-stu-id="f0a5f-307">When you add a filter to a faceted query, you might want to retain the facet statement (for example, `facet=Rating&$filter=Rating ge 4`).</span></span> <span data-ttu-id="f0a5f-308">Techniquement, le paramètre facette=Évaluation n'est pas nécessaire, mais le fait de le conserver renvoie les décomptes des valeurs de facettes pour les évaluations de 4 et supérieures.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-308">Technically, facet=Rating isn’t needed, but keeping it returns the counts of facet values for ratings 4 and higher.</span></span> <span data-ttu-id="f0a5f-309">Par exemple, si vous cliquez sur « 4 » et si la requête inclut un filtre pour une valeur supérieure ou égale à « 4 », des décomptes sont renvoyés pour chaque évaluation égale ou supérieure à 4.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-309">For example, if you click "4" and the query includes a filter for greater or equal to "4", counts are returned for each rating that is 4 and higher.</span></span>  

<span data-ttu-id="f0a5f-310">**Vérifier que les nombres de facettes sont exacts**</span><span class="sxs-lookup"><span data-stu-id="f0a5f-310">**Make sure you get accurate facet counts**</span></span>

<span data-ttu-id="f0a5f-311">Dans certaines circonstances, il est possible que les décomptes de facettes ne correspondent pas aux jeux de résultats (consultez [Navigation à facettes dans Azure Search (publication du forum)](https://social.msdn.microsoft.com/Forums/azure/06461173-ea26-4e6a-9545-fbbd7ee61c8f/faceting-on-azure-search?forum=azuresearch)).</span><span class="sxs-lookup"><span data-stu-id="f0a5f-311">Under certain circumstances, you might find that facet counts do not match the result sets (see [Faceted navigation in Azure Search (forum post)](https://social.msdn.microsoft.com/Forums/azure/06461173-ea26-4e6a-9545-fbbd7ee61c8f/faceting-on-azure-search?forum=azuresearch)).</span></span>

<span data-ttu-id="f0a5f-312">Les décomptes de facettes peuvent être erronés en raison de l'architecture de partitionnement.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-312">Facet counts can be inaccurate due to the sharding architecture.</span></span> <span data-ttu-id="f0a5f-313">Chaque index de recherche a plusieurs partitions et chacune d’elles indique les N premières facettes par décompte de document, qui est ensuite combiné en un résultat unique.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-313">Every search index has multiple shards, and each shard reports the top N facets by document count, which is then combined into a single result.</span></span> <span data-ttu-id="f0a5f-314">Si certaines partitions ont beaucoup de valeurs correspondantes, tandis que d’autres en ont moins, il est possible que certaines valeurs de facettes soient manquantes ou sous-comptabilisées dans les résultats.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-314">If some shards have many matching values, while others have fewer, you may find that some facet values are missing or under-counted in the results.</span></span>

<span data-ttu-id="f0a5f-315">Ce comportement peut changer à tout moment mais si vous rencontrez ce problème aujourd’hui, vous pouvez le contourner en gonflant artificiellement le décompte :<number> sur un nombre élevé pour appliquer la déclaration complète à partir de chaque partition.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-315">Although this behavior could change at any time, if you encounter this behavior today, you can work around it by artificially inflating the count:<number> to a large number to enforce full reporting from each shard.</span></span> <span data-ttu-id="f0a5f-316">Si la valeur de décompte : est supérieure ou égale au nombre de valeurs uniques dans le champ, vous êtes sûr d'obtenir des résultats précis.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-316">If the value of count: is greater than or equal to the number of unique values in the field, you are guaranteed accurate results.</span></span> <span data-ttu-id="f0a5f-317">Toutefois, lorsque les décomptes de documents sont élevés, les performances baissent, alors utilisez cette option judicieusement.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-317">However, when document counts are high, there is a performance penalty, so use this option judiciously.</span></span>

### <a name="user-interface-tips"></a><span data-ttu-id="f0a5f-318">Conseils sur l’interface utilisateur</span><span class="sxs-lookup"><span data-stu-id="f0a5f-318">User interface tips</span></span>
<span data-ttu-id="f0a5f-319">**Ajouter des étiquettes pour chaque champ dans la navigation à facettes**</span><span class="sxs-lookup"><span data-stu-id="f0a5f-319">**Add labels for each field in facet navigation**</span></span>

<span data-ttu-id="f0a5f-320">Les étiquettes sont généralement définies dans le code HTML ou le formulaire (`index.cshtml` dans l’exemple d’application).</span><span class="sxs-lookup"><span data-stu-id="f0a5f-320">Labels are typically defined in the HTML or form (`index.cshtml` in the sample application).</span></span> <span data-ttu-id="f0a5f-321">Il n’existe aucune API dans Recherche Azure pour les étiquettes de navigation à facettes ou tout autre type de métadonnées.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-321">There is no API in Azure Search for facet navigation labels or any other metadata.</span></span>

<a name="rangefacets"></a>

## <a name="filter-based-on-a-range"></a><span data-ttu-id="f0a5f-322">Filtrer sur une plage de valeurs</span><span class="sxs-lookup"><span data-stu-id="f0a5f-322">Filter based on a range</span></span>
<span data-ttu-id="f0a5f-323">L’utilisation de facettes sur des plages de valeurs est une condition d’application de recherche courante.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-323">Faceting over ranges of values is a common search application requirement.</span></span> <span data-ttu-id="f0a5f-324">Les plages sont prises en charge pour les données numériques et les valeurs DateHeure.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-324">Ranges are supported for numeric data and DateTime values.</span></span> <span data-ttu-id="f0a5f-325">Vous pouvez en savoir plus sur chaque approche dans [Rechercher des documents (API Azure Search)](http://msdn.microsoft.com/library/azure/dn798927.aspx).</span><span class="sxs-lookup"><span data-stu-id="f0a5f-325">You can read more about each approach in [Search Documents (Azure Search API)](http://msdn.microsoft.com/library/azure/dn798927.aspx).</span></span>

<span data-ttu-id="f0a5f-326">Azure Search simplifie la création de plage en fournissant deux approches pour calculer une plage.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-326">Azure Search simplifies range construction by providing two approaches for computing a range.</span></span> <span data-ttu-id="f0a5f-327">Pour les deux approches, Azure Search crée les plages appropriées avec les entrées que vous avez fournies.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-327">For both approaches, Azure Search creates the appropriate ranges given the inputs you’ve provided.</span></span> <span data-ttu-id="f0a5f-328">Par exemple, si vous spécifiez des valeurs de plage de 10|20|30, Recherche Azure crée automatiquement les plages 0-10, 10-20, 20-30.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-328">For instance, if you specify range values of 10|20|30, it automatically creates ranges of 0-10, 10-20, 20-30.</span></span> <span data-ttu-id="f0a5f-329">Votre application peut éventuellement supprimer les intervalles vides.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-329">Your application can optionally remove any intervals that are empty.</span></span> 

<span data-ttu-id="f0a5f-330">**Approche 1 : utiliser le paramètre d’intervalle**</span><span class="sxs-lookup"><span data-stu-id="f0a5f-330">**Approach 1: Use the interval parameter**</span></span>  
<span data-ttu-id="f0a5f-331">Pour définir les facettes de prix par incréments de 10 $, vous devez spécifier :`&facet=price,interval:10`</span><span class="sxs-lookup"><span data-stu-id="f0a5f-331">To set price facets in $10 increments, you would specify: `&facet=price,interval:10`</span></span>

<span data-ttu-id="f0a5f-332">**Approche 2 : utiliser une liste de valeurs**</span><span class="sxs-lookup"><span data-stu-id="f0a5f-332">**Approach 2: Use a values list**</span></span>  
<span data-ttu-id="f0a5f-333">Pour les données numériques, vous pouvez utiliser une liste de valeurs.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-333">For numeric data, you can use a values list.</span></span>  <span data-ttu-id="f0a5f-334">Prenez en compte la plage de facette pour un champ `listPrice`, indiquée comme suit :</span><span class="sxs-lookup"><span data-stu-id="f0a5f-334">Consider the facet range for a `listPrice` field, rendered as follows:</span></span>

  ![Exemple de liste de valeurs][5]

<span data-ttu-id="f0a5f-336">Pour spécifier une plage de facette comme celle de la capture d’écran précédente, utilisez une liste de valeurs :</span><span class="sxs-lookup"><span data-stu-id="f0a5f-336">To specify a facet range like the one in the preceding screen shot, use a values list:</span></span>

    facet=listPrice,values:10|25|100|500|1000|2500

<span data-ttu-id="f0a5f-337">Chaque plage est créée avec 0 comme point de départ, une valeur de la liste comme point de terminaison, puis la plage précédente en moins pour créer des intervalles discrets.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-337">Each range is built using 0 as a starting point, a value from the list as an endpoint, and then trimmed of the previous range to create discrete intervals.</span></span> <span data-ttu-id="f0a5f-338">Recherche Azure effectue cette opération dans le cadre de la navigation à facettes.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-338">Azure Search does these things as part of faceted navigation.</span></span> <span data-ttu-id="f0a5f-339">Vous n'avez pas à écrire du code pour structurer chaque intervalle.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-339">You do not have to write code for structuring each interval.</span></span>

### <a name="build-a-filter-for-a-range"></a><span data-ttu-id="f0a5f-340">Créer un filtre pour une plage</span><span class="sxs-lookup"><span data-stu-id="f0a5f-340">Build a filter for a range</span></span>
<span data-ttu-id="f0a5f-341">Pour filtrer les documents en fonction d’une plage que vous avez sélectionnée, vous pouvez utiliser les opérateurs de filtre `"ge"` et `"lt"` dans une expression en deux parties qui définit les points de terminaison de la plage.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-341">To filter documents based on a range you select, you can use the `"ge"` and `"lt"` filter operators in a two-part expression that defines the endpoints of the range.</span></span> <span data-ttu-id="f0a5f-342">Par exemple, si vous choisissez la plage 10-25 pour un champ `listPrice`, le filtre sera `$filter=listPrice ge 10 and listPrice lt 25`.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-342">For example, if you choose the range 10-25 for a `listPrice` field, the filter would be `$filter=listPrice ge 10 and listPrice lt 25`.</span></span> <span data-ttu-id="f0a5f-343">Dans l’exemple de code, l’expression de filtre utilise les paramètres **priceFrom** et **priceTo** pour définir les points de terminaison.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-343">In the sample code, the filter expression uses **priceFrom** and **priceTo** parameters to set the endpoints.</span></span> 

  ![Requête pour une plage de valeurs][6]

<a name="geofacets"></a> 

## <a name="filter-based-on-distance"></a><span data-ttu-id="f0a5f-345">Filtrer en fonction de la distance</span><span class="sxs-lookup"><span data-stu-id="f0a5f-345">Filter based on distance</span></span>
<span data-ttu-id="f0a5f-346">Il est courant de voir des filtres qui vous aident à choisir un magasin, un restaurant ou une destination en fonction de sa proximité à votre emplacement actuel.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-346">It’s common to see filters that help you choose a store, restaurant, or destination based on its proximity to your current location.</span></span> <span data-ttu-id="f0a5f-347">Ce type de filtre peut ressembler à la navigation à facettes, mais c’est tout simplement un filtre.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-347">While this type of filter might look like faceted navigation, it’s just a filter.</span></span> <span data-ttu-id="f0a5f-348">Nous le mentionnons ici pour ceux d'entre vous qui recherchent spécifiquement des conseils d'implémentation pour ce problème de conception particulier.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-348">We mention it here for those of you who are specifically looking for implementation advice for that particular design problem.</span></span>

<span data-ttu-id="f0a5f-349">Il existe deux fonctions géospatiales dans la Recherche Azure, **geo.distance** et **geo.intersects**.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-349">There are two Geospatial functions in Azure Search, **geo.distance** and **geo.intersects**.</span></span>

* <span data-ttu-id="f0a5f-350">La fonction **geo.distance** renvoie la distance en kilomètres entre deux points.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-350">The **geo.distance** function returns the distance in kilometers between two points.</span></span> <span data-ttu-id="f0a5f-351">L’un est un champ et l’autre est une constante considérée comme une partie du filtre.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-351">One point is a field and other is a constant passed as part of the filter.</span></span> 
* <span data-ttu-id="f0a5f-352">La fonction **geo.intersects** renvoie true si un point donné se trouve dans un polygone donné.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-352">The **geo.intersects** function returns true if a given point is within a given polygon.</span></span> <span data-ttu-id="f0a5f-353">Le point est un champ et le polygone est spécifié sous forme de liste constante de coordonnées en tant que partie du filtre.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-353">The point is a field and the polygon is specified as a constant list of coordinates passed as part of the filter.</span></span>

<span data-ttu-id="f0a5f-354">Vous trouverez des exemples de filtres dans [Syntaxe d'expression OData (Azure Search)](http://msdn.microsoft.com/library/azure/dn798921.aspx).</span><span class="sxs-lookup"><span data-stu-id="f0a5f-354">You can find filter examples in [OData expression syntax (Azure Search)](http://msdn.microsoft.com/library/azure/dn798921.aspx).</span></span>

<a name="tryitout"></a>

## <a name="try-the-demo"></a><span data-ttu-id="f0a5f-355">Essayer la démonstration</span><span class="sxs-lookup"><span data-stu-id="f0a5f-355">Try the demo</span></span>
<span data-ttu-id="f0a5f-356">La démonstration du portail de recrutement Recherche Azure contient les exemples référencés dans cet article.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-356">The Azure Search Job Portal Demo contains the examples referenced in this article.</span></span>

-   <span data-ttu-id="f0a5f-357">Consultez et testez la démonstration en ligne sur la [démonstration du portail de recrutement Recherche Azure](http://azjobsdemo.azurewebsites.net/).</span><span class="sxs-lookup"><span data-stu-id="f0a5f-357">See and test the working demo online at [Azure Search Job Portal Demo](http://azjobsdemo.azurewebsites.net/).</span></span>

-   <span data-ttu-id="f0a5f-358">Téléchargez le code à partir du [référentiel Azure-Samples sur GitHub](https://github.com/Azure-Samples/search-dotnet-asp-net-mvc-jobs).</span><span class="sxs-lookup"><span data-stu-id="f0a5f-358">Download the code from the [Azure-Samples repo on GitHub](https://github.com/Azure-Samples/search-dotnet-asp-net-mvc-jobs).</span></span>

<span data-ttu-id="f0a5f-359">Lorsque vous utilisez les résultats de la recherche, observez les modifications de construction de la requête dans l'URL.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-359">As you work with search results, watch the URL for changes in query construction.</span></span> <span data-ttu-id="f0a5f-360">Cette application ajoute des facettes à l'URI lors de la sélection de chaque.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-360">This application happens to append facets to the URI as you select each one.</span></span>

1. <span data-ttu-id="f0a5f-361">Pour utiliser la fonctionnalité de mappage de l’application de démonstration, obtenez une clé Bing Maps auprès du [Centre de développement Bing Maps](https://www.bingmapsportal.com/).</span><span class="sxs-lookup"><span data-stu-id="f0a5f-361">To use the mapping functionality of the demo app, get a Bing Maps key from the [Bing Maps Dev Center](https://www.bingmapsportal.com/).</span></span> <span data-ttu-id="f0a5f-362">Collez-la sur la clé existante dans la page `index.cshtml`.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-362">Paste it over the existing key in the `index.cshtml` page.</span></span> <span data-ttu-id="f0a5f-363">Le paramètre `BingApiKey` du fichier `Web.config` n’est pas utilisé.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-363">The `BingApiKey` setting in the `Web.config` file is not used.</span></span> 

2. <span data-ttu-id="f0a5f-364">Exécutez l'application.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-364">Run the application.</span></span> <span data-ttu-id="f0a5f-365">Suivez la visite guidée facultative ou fermez la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-365">Take the optional tour, or dismiss the dialog box.</span></span>
   
3. <span data-ttu-id="f0a5f-366">Saisissez un terme de recherche, comme « analyste », puis cliquez sur l’icône de recherche.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-366">Enter a search term, such as "analyst", and click the Search icon.</span></span> <span data-ttu-id="f0a5f-367">La requête s'exécute rapidement.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-367">The query executes quickly.</span></span>
   
   <span data-ttu-id="f0a5f-368">Une structure de navigation à facettes est également renvoyée avec les résultats de la recherche.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-368">A faceted navigation structure is also returned with the search results.</span></span> <span data-ttu-id="f0a5f-369">Dans la page de résultats de la recherche, la structure de la navigation à facettes inclut des décomptes pour chaque résultat de facette.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-369">In the search result page, the faceted navigation structure includes counts for each facet result.</span></span> <span data-ttu-id="f0a5f-370">Aucune facette n’est sélectionnée : tous les résultats correspondants sont donc renvoyés.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-370">No facets are selected, so all matching results are returned.</span></span>
   
   ![Résultats de recherche avant la sélection des facettes][11]

4. <span data-ttu-id="f0a5f-372">Cliquez sur une Fonction, un Lieu ou un Salaire minimal.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-372">Click a Business Title, Location, or Minimum Salary.</span></span> <span data-ttu-id="f0a5f-373">Les facettes sont égales à « null » pour la recherche initiale, mais lorsqu’elles prennent des valeurs, les éléments qui ne correspondent plus sont supprimés des résultats de la recherche.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-373">Facets were null on the initial search, but as they take on values, the search results are trimmed of items that no longer match.</span></span>
   
   ![Résultats de recherche après la sélection des facettes][12]

5. <span data-ttu-id="f0a5f-375">Pour effacer la requête à facettes afin de tester des comportements de requête différents, cliquez sur `[X]` en regard des facettes sélectionnées dans le but d’effacer ces dernières.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-375">To clear the faceted query so that you can try different query behaviors, click the `[X]` after the selected facets to clear the facets.</span></span>
   
<a name="nextstep"></a>

## <a name="learn-more"></a><span data-ttu-id="f0a5f-376">En savoir plus</span><span class="sxs-lookup"><span data-stu-id="f0a5f-376">Learn more</span></span>
<span data-ttu-id="f0a5f-377">Regardez la [Présentation approfondie de la Recherche Azure](http://channel9.msdn.com/Events/TechEd/Europe/2014/DBI-B410).</span><span class="sxs-lookup"><span data-stu-id="f0a5f-377">Watch [Azure Search Deep Dive](http://channel9.msdn.com/Events/TechEd/Europe/2014/DBI-B410).</span></span> <span data-ttu-id="f0a5f-378">À 45:25 sur la vidéo, vous trouverez une démonstration sur la façon d'implémenter des facettes.</span><span class="sxs-lookup"><span data-stu-id="f0a5f-378">At 45:25, there is a demo on how to implement facets.</span></span>

<span data-ttu-id="f0a5f-379">Pour plus d'informations sur les principes de conception pour la navigation à facettes, nous vous recommandons les liens suivants :</span><span class="sxs-lookup"><span data-stu-id="f0a5f-379">For more insights on design principles for faceted navigation, we recommend the following links:</span></span>

* [<span data-ttu-id="f0a5f-380">Conception pour la recherche à facettes</span><span class="sxs-lookup"><span data-stu-id="f0a5f-380">Designing for Faceted Search</span></span>](http://www.uie.com/articles/faceted_search/)
* [<span data-ttu-id="f0a5f-381">Modèles de conception : navigation à facettes</span><span class="sxs-lookup"><span data-stu-id="f0a5f-381">Design Patterns: Faceted Navigation</span></span>](http://alistapart.com/article/design-patterns-faceted-navigation)


<!--Anchors-->
[How to build it]: #howtobuildit
[Build the presentation layer]: #presentationlayer
[Build the index]: #buildindex
[Check for data quality]: #checkdata
[Build the query]: #buildquery
[Tips on how to control faceted navigation]: #tips
[Faceted navigation based on range values]: #rangefacets
[Faceted navigation based on GeoPoints]: #geofacets
[Try it out]: #tryitout

<!--Image references-->
[1]: ./media/search-faceted-navigation/azure-search-faceting-example.PNG
[2]: ./media/search-faceted-navigation/Facet-2-CSHTML.PNG
[3]: ./media/search-faceted-navigation/Facet-3-schema.PNG
[4]: ./media/search-faceted-navigation/Facet-4-SearchMethod.PNG
[5]: ./media/search-faceted-navigation/Facet-5-Prices.PNG
[6]: ./media/search-faceted-navigation/Facet-6-buildfilter.PNG
[7]: ./media/search-faceted-navigation/Facet-7-appstart.png
[8]: ./media/search-faceted-navigation/Facet-8-appbike.png
[9]: ./media/search-faceted-navigation/Facet-9-appbikefaceted.png
[10]: ./media/search-faceted-navigation/Facet-10-appTitle.png
[11]: ./media/search-faceted-navigation/faceted-search-before-facets.png
[12]: ./media/search-faceted-navigation/faceted-search-after-facets.png

<!--Link references-->
[Designing for Faceted Search]: http://www.uie.com/articles/faceted_search/
[Design Patterns: Faceted Navigation]: http://alistapart.com/article/design-patterns-faceted-navigation
[Create your first application]: search-create-first-solution.md
[OData expression syntax (Azure Search)]: http://msdn.microsoft.com/library/azure/dn798921.aspx
[Azure Search Adventure Works Demo]: https://azuresearchadventureworksdemo.codeplex.com/
[http://www.odata.org/documentation/odata-version-2-0/overview/]: http://www.odata.org/documentation/odata-version-2-0/overview/ 
[Faceting on Azure Search forum post]: ../faceting-on-azure-search.md?forum=azuresearch
[Search Documents (Azure Search API)]: http://msdn.microsoft.com/library/azure/dn798927.aspx

