---
title: "récupération d’urgence de base de données d’aaaSQL | Documents Microsoft"
description: "Découvrez comment toorecover une base de données à partir d’un centre de données régional ou panne avec hello active géo-réplication de base de données SQL Azure et des fonctions de géo-restauration."
services: sql-database
documentationcenter: 
author: anosov1960
manager: jhubbard
editor: monicar
ms.assetid: 4800960e-3f9d-40ce-9e55-fb7f2784c067
ms.service: sql-database
ms.custom: business continuity
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 04/14/2017
ms.author: sashan
ms.openlocfilehash: bae08485863067748107ec4808e52d8e88e2de0d
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="restore-an-azure-sql-database-or-failover-tooa-secondary"></a><span data-ttu-id="99ddb-103">Restaurer une base de données SQL Azure ou le basculement de tooa secondaire</span><span class="sxs-lookup"><span data-stu-id="99ddb-103">Restore an Azure SQL Database or failover tooa secondary</span></span>
<span data-ttu-id="99ddb-104">Base de données SQL Azure offre hello suivant les fonctionnalités de récupération à partir d’une panne :</span><span class="sxs-lookup"><span data-stu-id="99ddb-104">Azure SQL Database offers hello following capabilities for recovering from an outage:</span></span>

* [<span data-ttu-id="99ddb-105">Géo-réplication active</span><span class="sxs-lookup"><span data-stu-id="99ddb-105">Active geo-replication</span></span>](sql-database-geo-replication-overview.md)
* [<span data-ttu-id="99ddb-106">Géorestauration</span><span class="sxs-lookup"><span data-stu-id="99ddb-106">Geo-restore</span></span>](sql-database-recovery-using-backups.md#point-in-time-restore)

<span data-ttu-id="99ddb-107">toolearn sur les scénarios de continuité des activités et les fonctionnalités de hello prenant en charge ces scénarios, consultez [continuité](sql-database-business-continuity.md).</span><span class="sxs-lookup"><span data-stu-id="99ddb-107">toolearn about business continuity scenarios and hello features supporting these scenarios, see [Business continuity](sql-database-business-continuity.md).</span></span>

### <a name="prepare-for-hello-event-of-an-outage"></a><span data-ttu-id="99ddb-108">Préparer pour l’événement hello d’une indisponibilité</span><span class="sxs-lookup"><span data-stu-id="99ddb-108">Prepare for hello event of an outage</span></span>
<span data-ttu-id="99ddb-109">Pour la réussite de région de données tooanother de récupération à l’aide de géo-réplication active ou sauvegardes géo-redondant, vous devez tooprepare un serveur dans un autre données center panne toobecome hello nouveau serveur principal doit hello doivent survenir ainsi que des étapes bien définis tooensure documentée et testée une récupération lisse.</span><span class="sxs-lookup"><span data-stu-id="99ddb-109">For success with recovery tooanother data region using either active geo-replication or geo-redundant backups, you need tooprepare a server in another data center outage toobecome hello new primary server should hello need arise as well as have well-defined steps documented and tested tooensure a smooth recovery.</span></span> <span data-ttu-id="99ddb-110">Les étapes de préparation sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="99ddb-110">These preparation steps include:</span></span>

* <span data-ttu-id="99ddb-111">Identifiez le serveur logique de hello dans une autre région toobecome hello nouveau serveur principal.</span><span class="sxs-lookup"><span data-stu-id="99ddb-111">Identify hello logical server in another region toobecome hello new primary server.</span></span> <span data-ttu-id="99ddb-112">Avec la géo-réplication active, il s’agit d’au moins un et peut-être chacun des serveurs secondaires de hello.</span><span class="sxs-lookup"><span data-stu-id="99ddb-112">With active geo-replication, this will be at least one and perhaps each of hello secondary servers.</span></span> <span data-ttu-id="99ddb-113">Pour la géo-restauration, il s’agira généralement un serveur Bonjour [région associée](../best-practices-availability-paired-regions.md) pour la région de hello dans lequel se trouve votre base de données.</span><span class="sxs-lookup"><span data-stu-id="99ddb-113">For geo-restore, this will generally be a server in hello [paired region](../best-practices-availability-paired-regions.md) for hello region in which your database is located.</span></span>
* <span data-ttu-id="99ddb-114">Identifier et éventuellement définir, les règles de pare-feu de niveau serveur hello nécessaires sur des utilisateurs tooaccess hello nouvelle base de données primaire.</span><span class="sxs-lookup"><span data-stu-id="99ddb-114">Identify, and optionally define, hello server-level firewall rules needed on for users tooaccess hello new primary database.</span></span>
* <span data-ttu-id="99ddb-115">Déterminez comment vous allez tooredirect utilisateurs toohello nouveau serveur principal, par exemple en modifiant des chaînes de connexion ou en modifiant les entrées DNS.</span><span class="sxs-lookup"><span data-stu-id="99ddb-115">Determine how you are going tooredirect users toohello new primary server, such as by changing connection strings or by changing DNS entries.</span></span>
* <span data-ttu-id="99ddb-116">Identifier, vous pouvez également créer, hello connexions qui doivent être présents dans la base de données master hello sur le serveur principal de hello nouvelle, vérifiez que ces connexions disposer des autorisations appropriées dans la base de données master hello, le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="99ddb-116">Identify, and optionally create, hello logins that must be present in hello master database on hello new primary server, and ensure these logins have appropriate permissions in hello master database, if any.</span></span> <span data-ttu-id="99ddb-117">Pour plus d’informations, consultez [Gestion de la sécurité de la base de données SQL après la récupération d’urgence](sql-database-geo-replication-security-config.md)</span><span class="sxs-lookup"><span data-stu-id="99ddb-117">For more information, see [SQL Database security after disaster recovery](sql-database-geo-replication-security-config.md)</span></span>
* <span data-ttu-id="99ddb-118">Identifier les règles d’alerte qui devront toobe toomap mis à jour toohello nouvelle base de données primaire.</span><span class="sxs-lookup"><span data-stu-id="99ddb-118">Identify alert rules that will need toobe updated toomap toohello new primary database.</span></span>
* <span data-ttu-id="99ddb-119">Configuration de l’audit hello document sur la base de données primaire actuelle hello</span><span class="sxs-lookup"><span data-stu-id="99ddb-119">Document hello auditing configuration on hello current primary database</span></span>
* <span data-ttu-id="99ddb-120">Effectuez une [simulation d’une récupération d'urgence](sql-database-disaster-recovery-drills.md).</span><span class="sxs-lookup"><span data-stu-id="99ddb-120">Perform a [disaster recovery drill](sql-database-disaster-recovery-drills.md).</span></span> <span data-ttu-id="99ddb-121">toosimulate une interruption de géo-restauration, vous pouvez supprimer ou renommer l’échec de connectivité d’application toocause hello source de base de données.</span><span class="sxs-lookup"><span data-stu-id="99ddb-121">toosimulate an outage for geo-restore, you can delete or rename hello source database toocause application connectivity failure.</span></span> <span data-ttu-id="99ddb-122">toosimulate une interruption de géo-réplication active, vous pouvez désactiver hello web défaillances des applications ou ordinateur virtuel connecté toohello base de données ou de basculement hello de base de données toocause application connectivité.</span><span class="sxs-lookup"><span data-stu-id="99ddb-122">toosimulate an outage for active geo-replication, you can disable hello web application or virtual machine connected toohello database or failover hello database toocause application connectivity failures.</span></span>

## <a name="when-tooinitiate-recovery"></a><span data-ttu-id="99ddb-123">Lors de la récupération de tooinitiate</span><span class="sxs-lookup"><span data-stu-id="99ddb-123">When tooinitiate recovery</span></span>
<span data-ttu-id="99ddb-124">opération de récupération Hello affecte l’application hello.</span><span class="sxs-lookup"><span data-stu-id="99ddb-124">hello recovery operation impacts hello application.</span></span> <span data-ttu-id="99ddb-125">Il nécessite la modification de la chaîne de connexion SQL hello ou une redirection à l’aide de DNS et peut entraîner une perte de données permanentes.</span><span class="sxs-lookup"><span data-stu-id="99ddb-125">It requires changing hello SQL connection string or redirection using DNS and could result in permanent data loss.</span></span> <span data-ttu-id="99ddb-126">Par conséquent, il doit être effectuée uniquement lors de la panne de hello est probablement toolast plu de l’objectif de temps de récupération de votre application.</span><span class="sxs-lookup"><span data-stu-id="99ddb-126">Therefore, it should be done only when hello outage is likely toolast longer than your application's recovery time objective.</span></span> <span data-ttu-id="99ddb-127">Lors de l’application hello est tooproduction déployée, vous devez effectuer une surveillance régulière d’intégrité d’application hello et utiliser hello tooassert points qui hello récupération est garantie des données suivantes :</span><span class="sxs-lookup"><span data-stu-id="99ddb-127">When hello application is deployed tooproduction you should perform regular monitoring of hello application health and use hello following data points tooassert that hello recovery is warranted:</span></span>

1. <span data-ttu-id="99ddb-128">Échec de la connexion permanente à partir de la base de données toohello application hello.</span><span class="sxs-lookup"><span data-stu-id="99ddb-128">Permanent connectivity failure from hello application tier toohello database.</span></span>
2. <span data-ttu-id="99ddb-129">Hello portail Azure affiche une alerte sur un incident dans la région de hello avec un large impact.</span><span class="sxs-lookup"><span data-stu-id="99ddb-129">hello Azure portal shows an alert about an incident in hello region with broad impact.</span></span>
3. <span data-ttu-id="99ddb-130">serveur de base de données SQL Azure Hello est marqué comme étant dégradé.</span><span class="sxs-lookup"><span data-stu-id="99ddb-130">hello Azure SQL Database server is marked as degraded.</span></span>

<span data-ttu-id="99ddb-131">En fonction de votre responsabilité de business application tolérance toodowntime et possible, vous pouvez envisager hello suivant les options de récupération.</span><span class="sxs-lookup"><span data-stu-id="99ddb-131">Depending on your application tolerance toodowntime and possible business liability you can consider hello following recovery options.</span></span>

<span data-ttu-id="99ddb-132">Hello d’utilisation [obtenir une base de données récupérables](https://msdn.microsoft.com/library/dn800985.aspx) (*LastAvailableBackupDate*) tooget hello géo-répliquées de restauration les plus récentes.</span><span class="sxs-lookup"><span data-stu-id="99ddb-132">Use hello [Get Recoverable Database](https://msdn.microsoft.com/library/dn800985.aspx) (*LastAvailableBackupDate*) tooget hello latest Geo-replicated restore point.</span></span>

## <a name="wait-for-service-recovery"></a><span data-ttu-id="99ddb-133">Attendre le rétablissement du service</span><span class="sxs-lookup"><span data-stu-id="99ddb-133">Wait for service recovery</span></span>
<span data-ttu-id="99ddb-134">Bonjour Azure équipes travaillent soigneusement toorestore disponibilité du service comme rapidement que possible, mais en fonction de la cause première hello peut prendre heures ou jours.</span><span class="sxs-lookup"><span data-stu-id="99ddb-134">hello Azure teams work diligently toorestore service availability as quickly as possible but depending on hello root cause it can take hours or days.</span></span>  <span data-ttu-id="99ddb-135">Si votre application peut tolérer des temps d’arrêt important, vous pouvez simplement attendre hello récupération toocomplete.</span><span class="sxs-lookup"><span data-stu-id="99ddb-135">If your application can tolerate significant downtime you can simply wait for hello recovery toocomplete.</span></span> <span data-ttu-id="99ddb-136">Dans ce cas, aucune action n’est requise de votre part.</span><span class="sxs-lookup"><span data-stu-id="99ddb-136">In this case, no action on your part is required.</span></span> <span data-ttu-id="99ddb-137">Vous pouvez voir l’état du service actuel hello sur notre [tableau de bord d’intégrité de Service Azure](https://azure.microsoft.com/status/).</span><span class="sxs-lookup"><span data-stu-id="99ddb-137">You can see hello current service status on our [Azure Service Health Dashboard](https://azure.microsoft.com/status/).</span></span> <span data-ttu-id="99ddb-138">Après la récupération de hello de région de hello disponibilité de votre application sera restaurée.</span><span class="sxs-lookup"><span data-stu-id="99ddb-138">After hello recovery of hello region your application’s availability will be restored.</span></span>

## <a name="fail-over-toogeo-replicated-secondary-database"></a><span data-ttu-id="99ddb-139">Basculer répliqué toogeo la base de données secondaire</span><span class="sxs-lookup"><span data-stu-id="99ddb-139">Fail over toogeo-replicated secondary database</span></span>
<span data-ttu-id="99ddb-140">Si les temps d’arrêt peuvent mettre en cause la responsabilité de votre entreprise, vous devez utiliser des bases de données géo-répliquées dans votre application.</span><span class="sxs-lookup"><span data-stu-id="99ddb-140">If your application’s downtime can result in business liability you should be using geo-replicated database(s) in your application.</span></span> <span data-ttu-id="99ddb-141">Cela activera la disponibilité de restauration hello application tooquickly dans une région différente en cas de panne.</span><span class="sxs-lookup"><span data-stu-id="99ddb-141">It will enable hello application tooquickly restore availability in a different region in case of an outage.</span></span> <span data-ttu-id="99ddb-142">Découvrez comment trop[configurer la géo-réplication](sql-database-geo-replication-portal.md).</span><span class="sxs-lookup"><span data-stu-id="99ddb-142">Learn how too[configure geo-replication](sql-database-geo-replication-portal.md).</span></span>

<span data-ttu-id="99ddb-143">disponibilité toorestore Hello bases de données vous devez tooinitiate hello basculement toohello géorépliqué base de données secondaire à l’aide d’une des méthodes de hello pris en charge.</span><span class="sxs-lookup"><span data-stu-id="99ddb-143">toorestore availability of hello database(s) you need tooinitiate hello failover toohello geo-replicated secondary using one of hello supported methods.</span></span>

<span data-ttu-id="99ddb-144">Utilisez une des hello suivant toofail de guides sur tooa géorépliqué base de données secondaire :</span><span class="sxs-lookup"><span data-stu-id="99ddb-144">Use one of hello following guides toofail over tooa geo-replicated secondary database:</span></span>

* [<span data-ttu-id="99ddb-145">Basculer tooa géorépliqué base de données secondaire à l’aide du portail Azure</span><span class="sxs-lookup"><span data-stu-id="99ddb-145">Fail over tooa geo-replicated secondary using Azure Portal</span></span>](sql-database-geo-replication-portal.md)
* [<span data-ttu-id="99ddb-146">Basculer secondaire de géo-répliquées tooa à l’aide de PowerShell</span><span class="sxs-lookup"><span data-stu-id="99ddb-146">Fail over tooa geo-replicated secondary using PowerShell</span></span>](scripts/sql-database-setup-geodr-and-failover-database-powershell.md)
* [<span data-ttu-id="99ddb-147">Basculer tooa géorépliqué base de données secondaire à l’aide de T-SQL</span><span class="sxs-lookup"><span data-stu-id="99ddb-147">Fail over tooa geo-replicated secondary using T-SQL</span></span>](sql-database-geo-replication-transact-sql.md)

## <a name="recover-using-geo-restore"></a><span data-ttu-id="99ddb-148">Récupérer à l’aide de la géorestauration</span><span class="sxs-lookup"><span data-stu-id="99ddb-148">Recover using geo-restore</span></span>
<span data-ttu-id="99ddb-149">Si le temps d’arrêt de votre application n’entraîne pas de la responsabilité de l’entreprise, vous pouvez utiliser [géo-restauration](sql-database-recovery-using-backups.md) comme une méthode toorecover vos bases de données d’application.</span><span class="sxs-lookup"><span data-stu-id="99ddb-149">If your application’s downtime does not result in business liability you can use [geo-restore](sql-database-recovery-using-backups.md) as a method toorecover your application database(s).</span></span> <span data-ttu-id="99ddb-150">Il crée une copie de base de données hello à partir de sa dernière sauvegarde géo-redondant.</span><span class="sxs-lookup"><span data-stu-id="99ddb-150">It creates a copy of hello database from its latest geo-redundant backup.</span></span>

## <a name="configure-your-database-after-recovery"></a><span data-ttu-id="99ddb-151">Configurer votre base de données après récupération</span><span class="sxs-lookup"><span data-stu-id="99ddb-151">Configure your database after recovery</span></span>
<span data-ttu-id="99ddb-152">Si vous utilisez la géo-réplication de basculement ou de toorecover géo-restauration en cas de panne, il se peut que vous devez vous assurer que hello connectivité toohello nouvelles bases de données est correctement configuré afin que la fonction d’application normal hello peut être reprise.</span><span class="sxs-lookup"><span data-stu-id="99ddb-152">If you are using either geo-replication failover or geo-restore toorecover from an outage, you must make sure that hello connectivity toohello new databases is properly configured so that hello normal application function can be resumed.</span></span> <span data-ttu-id="99ddb-153">Ceci est une liste des tâches tooget votre prêt de production de base de données récupérée.</span><span class="sxs-lookup"><span data-stu-id="99ddb-153">This is a checklist of tasks tooget your recovered database production ready.</span></span>

### <a name="update-connection-strings"></a><span data-ttu-id="99ddb-154">Mettre à jour les chaînes de connexion</span><span class="sxs-lookup"><span data-stu-id="99ddb-154">Update connection strings</span></span>
<span data-ttu-id="99ddb-155">Étant donné que votre base de données récupérée résident dans un autre serveur, vous devez tooupdate de connexion chaîne toopoint toothat du serveur de votre application.</span><span class="sxs-lookup"><span data-stu-id="99ddb-155">Because your recovered database will reside in a different server, you need tooupdate your application’s connection string toopoint toothat server.</span></span>

<span data-ttu-id="99ddb-156">Pour plus d’informations sur la modification des chaînes de connexion, consultez le langage de développement appropriée hello pour votre [bibliothèque de connexions de](sql-database-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="99ddb-156">For more information about changing connection strings, see hello appropriate development language for your [connection library](sql-database-libraries.md).</span></span>

### <a name="configure-firewall-rules"></a><span data-ttu-id="99ddb-157">Configurer les règles de pare-feu</span><span class="sxs-lookup"><span data-stu-id="99ddb-157">Configure Firewall Rules</span></span>
<span data-ttu-id="99ddb-158">Vous devez toomake que les règles de pare-feu hello configuré sur le serveur et sur la correspondance de base de données hello ceux qui ont été configurées sur le serveur principal de hello et de la base de données primaire.</span><span class="sxs-lookup"><span data-stu-id="99ddb-158">You need toomake sure that hello firewall rules configured on server and on hello database match those that were configured on hello primary server and primary database.</span></span> <span data-ttu-id="99ddb-159">Pour plus d’informations, voir [Procédure : configuration des paramètres du pare-feu (Base de données SQL Azure)](sql-database-configure-firewall-settings.md).</span><span class="sxs-lookup"><span data-stu-id="99ddb-159">For more information, see [How to: Configure Firewall Settings (Azure SQL Database)](sql-database-configure-firewall-settings.md).</span></span>

### <a name="configure-logins-and-database-users"></a><span data-ttu-id="99ddb-160">Configurer les identifiants de connexion et les utilisateurs de la base de données</span><span class="sxs-lookup"><span data-stu-id="99ddb-160">Configure logins and database users</span></span>
<span data-ttu-id="99ddb-161">Vous devez toomake que toutes les connexions hello sont utilisées par votre application existent sur le serveur hello qui héberge votre base de données récupérée.</span><span class="sxs-lookup"><span data-stu-id="99ddb-161">You need toomake sure that all hello logins used by your application exist on hello server which is hosting your recovered database.</span></span> <span data-ttu-id="99ddb-162">Pour plus d’informations, voir [Configuration de la sécurité de la géoréplication](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="99ddb-162">For more information, see [Security Configuration for geo-replication](sql-database-geo-replication-security-config.md).</span></span>

> [!NOTE]
> <span data-ttu-id="99ddb-163">Vous devez configurer et tester les règles et les connexions (et leurs autorisations) du pare-feu de votre serveur pendant un exercice de récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="99ddb-163">You should configure and test your server firewall rules and logins (and their permissions) during a disaster recovery drill.</span></span> <span data-ttu-id="99ddb-164">Ces objets au niveau du serveur et leur configuration peut-être pas disponibles pendant une panne de hello.</span><span class="sxs-lookup"><span data-stu-id="99ddb-164">These server-level objects and their configuration may not be available during hello outage.</span></span>
> 
> 

### <a name="setup-telemetry-alerts"></a><span data-ttu-id="99ddb-165">Configurer les alertes de télémétrie</span><span class="sxs-lookup"><span data-stu-id="99ddb-165">Setup telemetry alerts</span></span>
<span data-ttu-id="99ddb-166">Vous devez toomake que vos paramètres de règle d’alerte existants sont mis à jour toomap toohello hello et base de données différents serveur récupéré.</span><span class="sxs-lookup"><span data-stu-id="99ddb-166">You need toomake sure your existing alert rule settings are updated toomap toohello recovered database and hello different server.</span></span>

<span data-ttu-id="99ddb-167">Pour en savoir plus, voir [Réception de notifications d’alerte](../monitoring-and-diagnostics/insights-receive-alert-notifications.md) et [Suivi de l’intégrité du service](../monitoring-and-diagnostics/insights-service-health.md).</span><span class="sxs-lookup"><span data-stu-id="99ddb-167">For more information about database alert rules, see [Receive Alert Notifications](../monitoring-and-diagnostics/insights-receive-alert-notifications.md) and [Track Service Health](../monitoring-and-diagnostics/insights-service-health.md).</span></span>

### <a name="enable-auditing"></a><span data-ttu-id="99ddb-168">Activer la fonction d’audit</span><span class="sxs-lookup"><span data-stu-id="99ddb-168">Enable auditing</span></span>
<span data-ttu-id="99ddb-169">Si l’audit est requis tooaccess votre base de données, vous devez tooenable l’audit après la récupération de base de données hello.</span><span class="sxs-lookup"><span data-stu-id="99ddb-169">If auditing is required tooaccess your database, you need tooenable Auditing after hello database recovery.</span></span> <span data-ttu-id="99ddb-170">Pour plus d’informations, consultez [Audit de base de données](sql-database-auditing.md).</span><span class="sxs-lookup"><span data-stu-id="99ddb-170">For more information, see [Database auditing](sql-database-auditing.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="99ddb-171">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="99ddb-171">Next steps</span></span>
* <span data-ttu-id="99ddb-172">toolearn sur les sauvegardes de base de données SQL Azure automatisée, consultez [sauvegardes automatisées de base de données SQL](sql-database-automated-backups.md)</span><span class="sxs-lookup"><span data-stu-id="99ddb-172">toolearn about Azure SQL Database automated backups, see [SQL Database automated backups](sql-database-automated-backups.md)</span></span>
* <span data-ttu-id="99ddb-173">toolearn sur les scénarios conception et de restauration de la continuité des activités métier, consultez [des scénarios de continuité des activités](sql-database-business-continuity.md)</span><span class="sxs-lookup"><span data-stu-id="99ddb-173">toolearn about business continuity design and recovery scenarios, see [Continuity scenarios](sql-database-business-continuity.md)</span></span>
* <span data-ttu-id="99ddb-174">toolearn sur l’utilisation des sauvegardes automatisées pour la récupération, consultez [restaurer une base de données à partir de sauvegardes de hello initiées par le service](sql-database-recovery-using-backups.md)</span><span class="sxs-lookup"><span data-stu-id="99ddb-174">toolearn about using automated backups for recovery, see [restore a database from hello service-initiated backups](sql-database-recovery-using-backups.md)</span></span>

