---
title: "Azure SQL Database : groupes de basculement et géo-réplication active | Documents Microsoft"
description: "Les groupes de basculement automatique avec géo-réplication active vous permettent de configurer quatre réplicas de votre base de données dans un des centres de données Azure et d’effectuer un basculement automatique en cas de panne."
services: sql-database
documentationcenter: na
author: anosov1960
manager: jhubbard
editor: monicar
ms.assetid: 2a29f657-82fb-4283-9a83-e14a144bfd93
ms.service: sql-database
ms.custom: business continuity
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: NA
ms.date: 07/10/2017
ms.author: sashan
ms.openlocfilehash: 9a2171f59c6192115dc1820e7f033fd783c9e077
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/29/2017
---
# <a name="overview-failover-groups-and-active-geo-replication"></a><span data-ttu-id="cb47f-103">Vue d’ensemble : groupes de basculement et géo-réplication active</span><span class="sxs-lookup"><span data-stu-id="cb47f-103">Overview: Failover groups and active geo-replication</span></span>
<span data-ttu-id="cb47f-104">La géo-réplication active vous permet de configurer jusqu'à quatre bases de données secondaires accessibles en lecture dans des emplacements de centres de données identiques ou différents (régions).</span><span class="sxs-lookup"><span data-stu-id="cb47f-104">Active geo-replication enables you to configure up to four readable secondary databases in the same or different data center locations (regions).</span></span> <span data-ttu-id="cb47f-105">Les bases de données secondaires sont disponibles pour l’interrogation et le basculement en cas d’indisponibilité d’un centre de données ou l’incapacité à se connecter à la base de données primaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-105">Secondary databases are available for querying and for failover in the case of a data center outage or the inability to connect to the primary database.</span></span> <span data-ttu-id="cb47f-106">Le basculement doit être lancé manuellement par l’application de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="cb47f-106">The failover must be initiated manually by the application of the user.</span></span> <span data-ttu-id="cb47f-107">Après le basculement, la nouvelle base de données primaire présente un point de terminaison de connexion différent.</span><span class="sxs-lookup"><span data-stu-id="cb47f-107">After failover, the new primary has a different connection end-point.</span></span> 

> [!NOTE]
> <span data-ttu-id="cb47f-108">La géo-réplication active est disponible pour toutes les bases de données de tous les niveaux de service, dans toutes les régions.</span><span class="sxs-lookup"><span data-stu-id="cb47f-108">Active geo-replication is available for all databases in all service tiers in all regions.</span></span>
>  

<span data-ttu-id="cb47f-109">Les groupes de basculement automatique Azure SQL Database (en préversion) sont une fonctionnalité de SQL Database conçue pour gérer automatiquement une relation de géo-réplication, la connectivité et le basculement à grande échelle.</span><span class="sxs-lookup"><span data-stu-id="cb47f-109">Azure SQL Database auto-failover groups (in-preview) is a SQL Database feature designed to automatically manage geo-replication relationship, connectivity, and failover at scale.</span></span> <span data-ttu-id="cb47f-110">Grâce à cette fonctionnalité, les clients ont la possibilité de récupérer automatiquement plusieurs bases de données associées dans la région secondaire après des défaillances régionales graves ou d’autres événements non planifiés qui entraînent une perte totale ou partielle de la disponibilité du service SQL Database dans la région primaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-110">With it, the customers gain the ability to automatically recover multiple related databases in the secondary region after catastrophic regional failures or other unplanned events that result in full or partial loss of the SQL Database service’s availability in the primary region.</span></span> <span data-ttu-id="cb47f-111">En outre, ils peuvent utiliser des bases de données secondaires accessibles en lecture pour décharger les charges de travail en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="cb47f-111">Additionally, they can use the readable secondary databases to offload read-only workloads.</span></span>  <span data-ttu-id="cb47f-112">Comme les groupes de basculement automatique impliquent de nombreuses bases de données, ils doivent être configurés sur le serveur principal.</span><span class="sxs-lookup"><span data-stu-id="cb47f-112">Because auto-failover groups involve multiple databases they must be configured on the primary server.</span></span> <span data-ttu-id="cb47f-113">Les serveurs primaire et secondaire doivent faire partie du même abonnement.</span><span class="sxs-lookup"><span data-stu-id="cb47f-113">Both primary and secondary servers must be in the same subscription.</span></span> <span data-ttu-id="cb47f-114">Les groupes de basculement automatique prennent en charge la réplication de toutes les bases de données du groupe vers un seul serveur secondaire situé dans une autre région,</span><span class="sxs-lookup"><span data-stu-id="cb47f-114">Auto-failover groups support replication of all databases in the group to only one secondary server in a different region.</span></span> <span data-ttu-id="cb47f-115">La géo-réplication active, sans les groupes de basculement automatique, permet d’utiliser jusqu’à 4 bases de données secondaires dans n’importe quelle région.</span><span class="sxs-lookup"><span data-stu-id="cb47f-115">Active geo-replication, without auto-failover groups, allows up to 4 secondaries in any region.</span></span>

<span data-ttu-id="cb47f-116">Si vous utilisez la géo-réplication active et que, pour une raison quelconque, votre base de données principale échoue ou nécessite simplement d’être déconnectée, vous pouvez lancer le basculement sur une de vos bases de données secondaires.</span><span class="sxs-lookup"><span data-stu-id="cb47f-116">If you are using active geo-replication and for any reason your primary database fails, or simply needs to be taken offline, you can initiate failover to any of your secondary databases.</span></span> <span data-ttu-id="cb47f-117">Lorsque le basculement est activé pour l’une des bases de données secondaires, toutes les autres bases de données secondaires sont automatiquement liées à la nouvelle base de données primaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-117">When failover is activated to one of the secondary databases, all other secondaries are automatically linked to the new primary.</span></span> <span data-ttu-id="cb47f-118">Si vous utilisez des groupes de basculement automatique (en préversion) pour gérer la récupération de base de données, toute panne qui affecte une ou plusieurs bases de données du groupe donne lieu à un basculement automatique.</span><span class="sxs-lookup"><span data-stu-id="cb47f-118">If you are using auto-failover groups (in-preview) to manage database recovery and any outage that impacts one or several of the databases in the group results in automatic failover.</span></span> <span data-ttu-id="cb47f-119">Vous pouvez configurer la stratégie de basculement automatique qui répond le mieux aux besoins de votre application ou l’annuler et utiliser l’activation manuelle.</span><span class="sxs-lookup"><span data-stu-id="cb47f-119">You can configure the auto-failover policy that best meets your application needs, or you can opt out and use manual activation.</span></span> <span data-ttu-id="cb47f-120">D’autre part, les groupes de basculement automatique (en préversion) fournissent des points de terminaison d’écouteur de lecture-écriture et de lecture seule qui restent inchangés lors des basculements.</span><span class="sxs-lookup"><span data-stu-id="cb47f-120">In addition, auto-failover groups (in-preview) provide read-write and read-only listener end-points that remain unchanged during failovers.</span></span> <span data-ttu-id="cb47f-121">Que vous utilisiez l’activation manuelle ou automatique du basculement, ce dernier bascule toutes les bases de données secondaires du groupe en bases de données primaires.</span><span class="sxs-lookup"><span data-stu-id="cb47f-121">Whether you use manual or automatic failover activation, failover switches all secondary databases in the group to primary.</span></span> <span data-ttu-id="cb47f-122">Une fois le basculement des bases de données terminé, l’enregistrement DNS est automatiquement mis à jour pour rediriger les points de terminaison vers la nouvelle région.</span><span class="sxs-lookup"><span data-stu-id="cb47f-122">After the database failover is completed, the DNS record is automatically updated to redirect the end-points to the new region.</span></span>

<span data-ttu-id="cb47f-123">Vous pouvez gérer la réplication et le basculement d’une base de données individuelle ou d’un ensemble de bases de données sur un serveur ou dans un pool élastique à l’aide de la géo-réplication active.</span><span class="sxs-lookup"><span data-stu-id="cb47f-123">You can manage replication and failover of an individual database or a set of databases on a server or in an elastic pool using active geo-replication.</span></span> <span data-ttu-id="cb47f-124">Pour ce faire, vous pouvez utiliser le [portail Azure](sql-database-geo-replication-portal.md), [PowerShell](sql-database-geo-replication-powershell.md), [Transact-SQL](sql-database-geo-replication-transact-sql.md) ou l’[API REST](https://msdn.microsoft.com/library/azure/mt163685.aspx).</span><span class="sxs-lookup"><span data-stu-id="cb47f-124">You can do that using the [Azure portal](sql-database-geo-replication-portal.md), [PowerShell](sql-database-geo-replication-powershell.md), [Transact-SQL](sql-database-geo-replication-transact-sql.md), or the [REST API](https://msdn.microsoft.com/library/azure/mt163685.aspx).</span></span> <span data-ttu-id="cb47f-125">Après le basculement, assurez-vous que les exigences d’authentification de votre serveur et de votre base de données sont configurées sur la nouvelle base de données primaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-125">After failover, ensure the authentication requirements for your server and database are configured on the new primary.</span></span> <span data-ttu-id="cb47f-126">Pour plus d’informations, consultez [Gestion de la sécurité de la base de données SQL Azure après la récupération d’urgence](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="cb47f-126">For details, see [SQL Database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span> <span data-ttu-id="cb47f-127">Cela s’applique à la fois à la géo-réplication active et aux groupes de basculement automatique (en préversion).</span><span class="sxs-lookup"><span data-stu-id="cb47f-127">This applies both to active geo-replication and auto-failover groups (in-preview).</span></span>

<span data-ttu-id="cb47f-128">La géo-réplication active optimise la technologie [Always On](https://docs.microsoft.com/sql/database-engine/availability-groups/windows/overview-of-always-on-availability-groups-sql-server) de SQL Server pour répliquer de manière asynchrone les transactions validées sur la base de données primaire vers une base de données secondaire, à l’aide de l’isolement de capture instantanée à lecture validée (RCSI).</span><span class="sxs-lookup"><span data-stu-id="cb47f-128">Active geo-replication leverages the [Always On](https://docs.microsoft.com/sql/database-engine/availability-groups/windows/overview-of-always-on-availability-groups-sql-server) technology of SQL Server to asynchronously replicate committed transactions on the primary database to a secondary database using read committed snapshot isolation (RCSI).</span></span> <span data-ttu-id="cb47f-129">Les groupes de basculement automatique fournissent la sémantique de groupe en plus de la géo-réplication active. Cependant, le même mécanisme de réplication asynchrone est utilisé.</span><span class="sxs-lookup"><span data-stu-id="cb47f-129">Auto-failover groups provide the group semantics on top of active geo-replication but the same asynchronous replication mechanism is used.</span></span> <span data-ttu-id="cb47f-130">À un moment donné, la base de données secondaire peut être légèrement en retard sur la base de données primaire, mais les données secondaire ne peuvent jamais contenir de transactions partielles.</span><span class="sxs-lookup"><span data-stu-id="cb47f-130">While at any given point, the secondary database might be slightly behind the primary database, the secondary data is guaranteed to never have partial transactions.</span></span> <span data-ttu-id="cb47f-131">Grâce à la redondance entre régions, les applications peuvent récupérer rapidement d’une perte permanente de tout ou partie d’un centre de données résultant de catastrophes naturelles, de graves erreurs humaines ou d’actes de malveillance.</span><span class="sxs-lookup"><span data-stu-id="cb47f-131">Cross-region redundancy enables applications to quickly recover from a permanent loss of an entire datacenter or parts of a datacenter caused by natural disasters, catastrophic human errors, or malicious acts.</span></span> <span data-ttu-id="cb47f-132">Vous trouverez les données d’objectif de point de récupération dans [Vue d’ensemble de la continuité des activités](sql-database-business-continuity.md).</span><span class="sxs-lookup"><span data-stu-id="cb47f-132">The specific RPO data can be found at [Overview of Business Continuity](sql-database-business-continuity.md).</span></span>

<span data-ttu-id="cb47f-133">La figure suivante présente un exemple de géo-réplication active configurée avec une base de données primaire située dans la région nord du centre des États-Unis, ainsi qu’une base de données secondaire située dans la région sud du centre des États-Unis.</span><span class="sxs-lookup"><span data-stu-id="cb47f-133">The following figure shows an example of active geo-replication configured with a primary in the North Central US region and secondary in the South Central US region.</span></span>

![Relation de géo-réplication](./media/sql-database-active-geo-replication/geo-replication-relationship.png)

<span data-ttu-id="cb47f-135">Comme les bases de données secondaires sont accessibles en lecture, elles peuvent être utilisées pour décharger des charges de travail en lecture seule, telles que des travaux de génération de rapports.</span><span class="sxs-lookup"><span data-stu-id="cb47f-135">Because the secondary databases are readable, they can be used to offload read-only workloads such as reporting jobs.</span></span> <span data-ttu-id="cb47f-136">Si vous utilisez la géo-réplication active, il est possible de créer la base de données secondaire dans la même région que la base de données primaire, mais cela n’augmente pas la résistance de l’application aux défaillances graves.</span><span class="sxs-lookup"><span data-stu-id="cb47f-136">If you are using active geo-replication, it is possible to create the secondary database in the same region with the primary, but it does not increase the application's resilience to catastrophic failures.</span></span> <span data-ttu-id="cb47f-137">Si vous utilisez des groupes de basculement automatique (en préversion), votre base de données secondaire est toujours créée dans une région différente.</span><span class="sxs-lookup"><span data-stu-id="cb47f-137">If you are using auto-failover groups (in-preview), your secondary database is always created in a different region.</span></span>

<span data-ttu-id="cb47f-138">En plus de la récupération d’urgence, la géo-réplication active peut être utilisée dans les scénarios suivants :</span><span class="sxs-lookup"><span data-stu-id="cb47f-138">In addition to disaster recovery active geo-replication can be used in the following scenarios:</span></span>

* <span data-ttu-id="cb47f-139">**Migration de base de données** : vous pouvez vous servir de la géo-réplication active pour migrer une base de données d’un serveur vers un autre serveur en ligne avec un temps d’arrêt minimal.</span><span class="sxs-lookup"><span data-stu-id="cb47f-139">**Database migration**: You can use active geo-replication to migrate a database from one server to another online with minimum downtime.</span></span>
* <span data-ttu-id="cb47f-140">**Mises à niveau de l’application**: vous pouvez créer une base de données secondaire supplémentaire faisant office de copie de restauration automatique lors des mises à niveau de l’application.</span><span class="sxs-lookup"><span data-stu-id="cb47f-140">**Application upgrades**: You can create an extra secondary as a fail back copy during application upgrades.</span></span>

<span data-ttu-id="cb47f-141">Pour assurer vraiment la continuité des activités, l’ajout d’une redondance de base de données entre les centres de données n’est qu’une partie de la solution.</span><span class="sxs-lookup"><span data-stu-id="cb47f-141">To achieve real business continuity, adding database redundancy between datacenters is only part of the solution.</span></span> <span data-ttu-id="cb47f-142">La récupération d’une application (service) de bout en bout après une défaillance catastrophique implique la récupération de tous les composants constituant le service et tous les services dépendants.</span><span class="sxs-lookup"><span data-stu-id="cb47f-142">Recovering an application (service) end-to-end after a catastrophic failure requires recovery of all components that constitute the service and any dependent services.</span></span> <span data-ttu-id="cb47f-143">En voici quelques exemples : logiciel client (il peut s’agir par exemple d’un navigateur avec un code JavaScript personnalisé), serveurs web frontaux, ressources de stockage et DNS.</span><span class="sxs-lookup"><span data-stu-id="cb47f-143">Examples of these components include the client software (for example, a browser with a custom JavaScript), web front ends, storage, and DNS.</span></span> <span data-ttu-id="cb47f-144">Il est essentiel que tous les composants résistent aux mêmes défaillances et redeviennent disponibles dans l’objectif de délai de récupération (RTO) de votre application.</span><span class="sxs-lookup"><span data-stu-id="cb47f-144">It is critical that all components are resilient to the same failures and become available within the recovery time objective (RTO) of your application.</span></span> <span data-ttu-id="cb47f-145">Par conséquent, vous devez identifier tous les services dépendants et comprendre les garanties et les fonctionnalités qu’ils fournissent.</span><span class="sxs-lookup"><span data-stu-id="cb47f-145">Therefore, you need to identify all dependent services and understand the guarantees and capabilities they provide.</span></span> <span data-ttu-id="cb47f-146">Ensuite, vous devez prendre les mesures appropriées pour vous assurer que votre service fonctionne pendant le basculement des services dont il dépend.</span><span class="sxs-lookup"><span data-stu-id="cb47f-146">Then, you must take adequate steps to ensure that your service functions during the failover of the services on which it depends.</span></span> <span data-ttu-id="cb47f-147">Pour plus d’informations sur la conception de solutions pour la récupération d’urgence, consultez la page [Designing Cloud Solutions for Disaster Recovery Using active geo-replication](sql-database-designing-cloud-solutions-for-disaster-recovery.md) (Conception de solutions cloud pour la récupération d’urgence à l’aide de la géo-réplication active).</span><span class="sxs-lookup"><span data-stu-id="cb47f-147">For more information about designing solutions for disaster recovery, see [Designing Cloud Solutions for Disaster Recovery Using active geo-replication](sql-database-designing-cloud-solutions-for-disaster-recovery.md).</span></span>

## <a name="active-geo-replication-capabilities"></a><span data-ttu-id="cb47f-148">Fonctionnalités de la géo-réplication active</span><span class="sxs-lookup"><span data-stu-id="cb47f-148">Active geo-replication capabilities</span></span>
<span data-ttu-id="cb47f-149">La fonction de géo-réplication active fournit les capacités essentielles suivantes :</span><span class="sxs-lookup"><span data-stu-id="cb47f-149">The active geo-replication feature provides the following essential capabilities:</span></span>
* <span data-ttu-id="cb47f-150">**Réplication asynchrone automatique**: vous pouvez créer une base de données secondaire uniquement par un ajout à une base de données existante.</span><span class="sxs-lookup"><span data-stu-id="cb47f-150">**Automatic Asynchronous Replication**: You can only create a secondary database by adding to an existing database.</span></span> <span data-ttu-id="cb47f-151">La base de données secondaire peut être créée sur n’importe quel serveur Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="cb47f-151">The secondary can be created in any Azure SQL Database server.</span></span> <span data-ttu-id="cb47f-152">Une fois créée, la base de données secondaire est remplie avec les données copiées à partir de la base de données primaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-152">Once created, the secondary database is populated with the data copied from the primary database.</span></span> <span data-ttu-id="cb47f-153">Ce processus est appelé amorçage.</span><span class="sxs-lookup"><span data-stu-id="cb47f-153">This process is known as seeding.</span></span> <span data-ttu-id="cb47f-154">Une fois la base de données secondaire créée et amorcée, les mises à jour de la base de données primaire sont automatiquement répliquées de manière asynchrone sur la base de données secondaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-154">After secondary database has been created and seeded, updates to the primary database are asynchronously replicated to the secondary database automatically.</span></span> <span data-ttu-id="cb47f-155">La réplication asynchrone signifie que les transactions sont validées sur la base de données primaire avant leur réplication sur la base de données secondaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-155">Asynchronous replication means that transactions are committed on the primary database before they are replicated to the secondary database.</span></span> 
* <span data-ttu-id="cb47f-156">**Bases de données secondaires accessibles en lecture**: une application peut accéder à une base de données secondaire pour des opérations en lecture seule avec des entités de sécurité qui peuvent différer de celles utilisées pour accéder à la base de données primaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-156">**Readable secondary databases**: An application can access a secondary database for read-only operations using the same or different security principals used for accessing the primary database.</span></span> <span data-ttu-id="cb47f-157">Les bases de données secondaires fonctionnent en mode d’isolement d’instantané pour garantir que la réplication des mises à jour de la base de données primaire n’est pas retardée par des requêtes exécutées sur la base de données secondaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-157">The secondary databases operate in snapshot isolation mode to ensure replication of the updates of the primary (log replay) is not delayed by queries executed on the secondary.</span></span>

   > [!NOTE]
   > <span data-ttu-id="cb47f-158">La relecture du journal est retardée sur la base de données secondaire si celle-ci reçoit de la base de données primaire des mises à jour de schéma, car cette opération nécessite un verrou de schéma sur la base de données secondaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-158">The log replay is delayed on the secondary database if there are schema updates that it is receiving from the Primary that require a schema lock on the secondary database.</span></span> 
   > 

* <span data-ttu-id="cb47f-159">**Plusieurs bases de données secondaires accessibles en lecture** : l’utilisation d’au moins deux bases de données secondaires permet d’améliorer la redondance et le niveau de protection de la base de données primaire et de l’application.</span><span class="sxs-lookup"><span data-stu-id="cb47f-159">**Multiple readable secondaries**: Two or more secondary databases increase redundancy and level of protection for the primary database and application.</span></span> <span data-ttu-id="cb47f-160">S’il existe plusieurs bases de données secondaires, l’application reste protégée même en cas d’échec de l’une des bases de données secondaires.</span><span class="sxs-lookup"><span data-stu-id="cb47f-160">If multiple secondary databases exist, the application remains protected even if one of the secondary databases fails.</span></span> <span data-ttu-id="cb47f-161">S’il n’existe qu’une seule base de données secondaire, en cas d’échec de celle-ci, l’application est exposée à un risque plus élevé jusqu’à la création d’une nouvelle base de données secondaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-161">If there is only one secondary database, and it fails, the application is exposed to higher risk until a new secondary database is created.</span></span>

   > [!NOTE]
   > <span data-ttu-id="cb47f-162">Si vous utilisez la géo-réplication active pour créer une application mondialement distribuée et avez besoin de fournir un accès en lecture seule aux données dans plus de quatre régions, vous pouvez créer la base de données secondaire d’une base de données secondaire (processus connu sous le nom de chaînage).</span><span class="sxs-lookup"><span data-stu-id="cb47f-162">If you are using active geo-replication to build a globally distributed application and need to provide read-only access to data in more than 4 regions, you can create secondary of a secondary (a process known as chaining).</span></span> <span data-ttu-id="cb47f-163">De cette manière, vous pouvez assurer une mise à l’échelle quasiment illimitée pour la réplication de base de données.</span><span class="sxs-lookup"><span data-stu-id="cb47f-163">This way you can achieve virtually unlimited scale of database replication.</span></span> <span data-ttu-id="cb47f-164">En outre, le chaînage réduit la charge de réplication qui pèse sur la base de données primaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-164">In addition, chaining reduces the overhead of replication from the primary database.</span></span> <span data-ttu-id="cb47f-165">Le compromis est l’augmentation du décalage de réplication sur les bases de données secondaires situées aux extrémités.</span><span class="sxs-lookup"><span data-stu-id="cb47f-165">The trade-off is the increased replication lag on the leaf-most secondary databases.</span></span> <span data-ttu-id="cb47f-166">.</span><span class="sxs-lookup"><span data-stu-id="cb47f-166">.</span></span> 
   >

* <span data-ttu-id="cb47f-167">**Prise en charge des bases de données de pool élastique** : la géo-réplication active peut être configurée pour toute base de données faisant partie d’un pool élastique.</span><span class="sxs-lookup"><span data-stu-id="cb47f-167">**Support of elastic pool databases**: Active geo-replication can be configured for any database in any elastic pool.</span></span> <span data-ttu-id="cb47f-168">La base de données secondaire peut se trouver dans un autre pool élastique.</span><span class="sxs-lookup"><span data-stu-id="cb47f-168">The secondary database can be in another elastic pool.</span></span> <span data-ttu-id="cb47f-169">Pour des bases de données ordinaires, la base de données secondaire peut être un pool élastiques, et inversement, pour autant que les niveaux de service soient identiques.</span><span class="sxs-lookup"><span data-stu-id="cb47f-169">For regular databases, the secondary can be an elastic pool and vice versa as long as the service tiers are the same.</span></span> 
* <span data-ttu-id="cb47f-170">**Niveau de performances configurable de la base de données secondaire**: une base de données secondaire peut être créée avec un niveau de performances inférieur à celui de la base de données primaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-170">**Configurable performance level of the secondary database**: A secondary database can be created with lower performance level than the primary.</span></span> <span data-ttu-id="cb47f-171">Les bases de données primaire et secondaire doivent offrir le même niveau de service.</span><span class="sxs-lookup"><span data-stu-id="cb47f-171">Both primary and secondary databases are required to have the same service tier.</span></span> <span data-ttu-id="cb47f-172">Cette option n’est pas recommandée pour les applications dont l’activité d’écriture de base de données est importante, car elle risque d’entraîner un décalage de réplication accru et, par conséquent, d’exposer à un risque élevé de perte substantielle de données après basculement.</span><span class="sxs-lookup"><span data-stu-id="cb47f-172">This option is not recommended for applications with high database write activity because the increased replication lag increases the risk of substantial data loss after a failover.</span></span> <span data-ttu-id="cb47f-173">En outre, après basculement, les performances de l’application sont affectées jusqu’à ce que la nouvelle base de données primaire soit mise à niveau vers un niveau de performances supérieur.</span><span class="sxs-lookup"><span data-stu-id="cb47f-173">In addition, after failover the application’s performance is impacted until the new primary is upgraded to a higher performance level.</span></span> <span data-ttu-id="cb47f-174">Le graphique de pourcentage d’E/S du journal sur le portail Azure permet d’estimer le niveau de performances minimal de la base de données secondaire requis pour supporter la charge de réplication.</span><span class="sxs-lookup"><span data-stu-id="cb47f-174">The log IO percentage chart on Azure portal provides a good way to estimate the minimal performance level of the secondary that is required to sustain the replication load.</span></span> <span data-ttu-id="cb47f-175">Par exemple, si votre base de données primaire est P6 (1 000 DTU) et si son pourcentage d’E/S du journal est de 50 %, la base de données secondaire doit être au moins P4 (500 DTU).</span><span class="sxs-lookup"><span data-stu-id="cb47f-175">For example, if your Primary database is P6 (1000 DTU) and its log IO percent is 50% the secondary needs to be at least P4 (500 DTU).</span></span> <span data-ttu-id="cb47f-176">Vous pouvez également récupérer les données d’E/S du journal à l’aide des vues de base de données [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) ou [sys.dm_db_resource_stats](https://msdn.microsoft.com/library/dn800981.aspx).</span><span class="sxs-lookup"><span data-stu-id="cb47f-176">You can also retrieve the log IO data using [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) or [sys.dm_db_resource_stats](https://msdn.microsoft.com/library/dn800981.aspx) database views.</span></span>  <span data-ttu-id="cb47f-177">Pour plus d’informations sur les niveaux de performances des bases de données SQL, voir [Options et performances de la base de données SQL](sql-database-service-tiers.md).</span><span class="sxs-lookup"><span data-stu-id="cb47f-177">For more information on the SQL Database performance levels, see [SQL Database options and performance](sql-database-service-tiers.md).</span></span> 
* <span data-ttu-id="cb47f-178">**Basculement et restauration automatique contrôlés par l’utilisateur**: une base de données secondaire peut être basculée à tout moment vers le rôle primaire sur une action explicite de l’application ou de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="cb47f-178">**User-controlled failover and failback**: A secondary database can explicitly be switched to the primary role at any time by the application or the user.</span></span> <span data-ttu-id="cb47f-179">Pendant une panne réelle, l’option « non planifiée » doit être utilisée, qui promeut immédiatement une base de données secondaire en base de données primaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-179">During a real outage the “unplanned” option should be used, which immediately promotes a secondary to be the primary.</span></span> <span data-ttu-id="cb47f-180">Lorsque la base de données primaire en échec récupère et redevient disponible, le système marque automatiquement la base de données primaire récupérée comme base de données secondaire, et la met à jour par rapport à la nouvelle base de données primaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-180">When the failed primary recovers and is available again, the system automatically marks the recovered primary as a secondary and bring it up-to-date with the new primary.</span></span> <span data-ttu-id="cb47f-181">En raison de la nature asynchrone de la réplication, une petite quantité de données peut être perdue lors de basculements non planifiés si une base de données primaire échoue avant la réplication des modifications les plus récentes sur la base de données secondaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-181">Due to the asynchronous nature of replication, a small amount of data can be lost during unplanned failovers if a primary fails before it replicates the most recent changes to the secondary.</span></span> <span data-ttu-id="cb47f-182">Quand une base de données primaire avec plusieurs bases de données secondaires bascule, le système reconfigure automatiquement les relations de réplication et lie les bases de données secondaires restantes à la base de données nouvellement promue comme primaire sans aucune intervention de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="cb47f-182">When a primary with multiple secondaries fails over, the system automatically reconfigures the replication relationships and links the remaining secondaries to the newly promoted primary without requiring any user intervention.</span></span> <span data-ttu-id="cb47f-183">Une fois la panne à l’origine du basculement résolue, il peut être judicieux de rétablir l’application dans la région primaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-183">After the outage that caused the failover is mitigated, it may be desirable to return the application to the primary region.</span></span> <span data-ttu-id="cb47f-184">Pour ce faire, la commande de basculement doit être appelée avec l’option « planifiée ».</span><span class="sxs-lookup"><span data-stu-id="cb47f-184">To do that, the failover command should be invoked with the “planned” option.</span></span> 
* <span data-ttu-id="cb47f-185">**Synchronisation des informations d’identification et des règles de pare-feu** : nous recommandons d’utiliser des [règles de pare-feu de base de données](sql-database-firewall-configure.md) pour les bases de données géorépliquées de façon à ce que ces règles puissent être répliquées avec la base de données pour s’assurer que toutes les bases de données secondaires ont les mêmes règles de pare-feu que la base de données primaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-185">**Keeping credentials and firewall rules in sync**: We recommend using [database firewall rules](sql-database-firewall-configure.md) for geo-replicated databases so these rules can be replicated with the database to ensure all secondary databases have the same firewall rules as the primary.</span></span> <span data-ttu-id="cb47f-186">Cette approche évite aux clients de devoir configurer et tenir à jour manuellement les règles de pare-feu sur les serveurs hébergeant les bases de données primaire et secondaires.</span><span class="sxs-lookup"><span data-stu-id="cb47f-186">This approach eliminates the need for customers to manually configure and maintain firewall rules on servers hosting both the primary and secondary databases.</span></span> <span data-ttu-id="cb47f-187">De même, le recours à des [utilisateurs de base de données contenus](sql-database-manage-logins.md) pour l’accès aux données garantit que les bases de données primaires et secondaires ont toujours les mêmes informations d’identification d’utilisateur afin qu’un basculement n’entraîne aucune interruption due à une discordance d’ID de connexion et de mots de passe.</span><span class="sxs-lookup"><span data-stu-id="cb47f-187">Similarly, using [contained database users](sql-database-manage-logins.md) for data access ensures both primary and secondary databases always have the same user credentials so during a failover, there is no disruptions due to mismatches with logins and passwords.</span></span> <span data-ttu-id="cb47f-188">Avec l’ajout [d’Azure Active Directory](../active-directory/active-directory-whatis.md), les clients peuvent gérer l’accès utilisateur aux bases de données primaires et secondaires. Cela élimine également la nécessité de gérer les informations d’identification dans l’ensemble des bases de données.</span><span class="sxs-lookup"><span data-stu-id="cb47f-188">With the addition of [Azure Active Directory](../active-directory/active-directory-whatis.md), customers can manage user access to both primary and secondary databases and eliminating the need for managing credentials in databases altogether.</span></span>

## <a name="auto-failover-group-capabilities"></a><span data-ttu-id="cb47f-189">Fonctionnalités des groupes de basculement automatique</span><span class="sxs-lookup"><span data-stu-id="cb47f-189">Auto-failover group capabilities</span></span>

<span data-ttu-id="cb47f-190">La fonction de groupes de basculement automatique fournit une abstraction puissante de la géo-réplication active en prenant en charge la réplication et le basculement automatique au niveau du groupe.</span><span class="sxs-lookup"><span data-stu-id="cb47f-190">Auto-failover groups feature provides a powerful abstraction of active geo-replication by supporting group level replication and automatic failover.</span></span> <span data-ttu-id="cb47f-191">En outre, elle élimine la nécessité de modifier la chaîne de connexion SQL après le basculement en fournissant les points de terminaison d’écouteur supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="cb47f-191">In addition, it removes the necessity to change the SQL connection string after failover by providing the additional listener end-points.</span></span> 

* <span data-ttu-id="cb47f-192">**Groupe de basculement** : un ou plusieurs groupes de basculement peuvent être créés entre deux serveurs situés dans des régions différentes (serveurs primaire et secondaire).</span><span class="sxs-lookup"><span data-stu-id="cb47f-192">**Failover group**: One or many failover groups can be created between two servers in different regions (primary and secondary servers).</span></span> <span data-ttu-id="cb47f-193">Chaque groupe peut inclure une ou plusieurs bases de données qui sont récupérées ensemble dans le cas où une partie ou la totalité des bases de données primaires deviennent indisponibles en raison d’une panne dans la région principale.</span><span class="sxs-lookup"><span data-stu-id="cb47f-193">Each group can include one or several databases that are recovered as a unit in case all or some primary databases become unavailable due to an outage in the primary region.</span></span>  
* <span data-ttu-id="cb47f-194">**Serveur principal** : un serveur qui héberge les bases de données primaires dans le groupe de basculement.</span><span class="sxs-lookup"><span data-stu-id="cb47f-194">**Primary server**: A server that hosts the primary databases in the failover group.</span></span>
* <span data-ttu-id="cb47f-195">**Serveur secondaire** : un serveur qui héberge les bases de données secondaires dans le groupe de basculement.</span><span class="sxs-lookup"><span data-stu-id="cb47f-195">**Secondary server**: A server that hosts the secondary databases in the failover group.</span></span> <span data-ttu-id="cb47f-196">Le serveur secondaire ne peut pas être situé dans la même région que le serveur principal.</span><span class="sxs-lookup"><span data-stu-id="cb47f-196">The secondary server cannot be in the same region as the primary server.</span></span>
* <span data-ttu-id="cb47f-197">**Ajout de bases de données au groupe de basculement** : vous pouvez placer plusieurs bases de données d’un serveur ou d’un pool élastique dans le même groupe de basculement.</span><span class="sxs-lookup"><span data-stu-id="cb47f-197">**Adding databases to failover group**: You can put several databases within a server or within an elastic pool into the same failover group.</span></span> <span data-ttu-id="cb47f-198">Si vous ajoutez une base de données autonome au groupe, ce groupe crée automatiquement une base de données secondaire en utilisant la même édition et le niveau de performance.</span><span class="sxs-lookup"><span data-stu-id="cb47f-198">If you add a standalone database to the group, it automatically creates a secondary database using the same edition and performance level.</span></span> <span data-ttu-id="cb47f-199">Si la base de données primaire se trouve dans un pool élastique, la base de données secondaire est automatiquement créée dans le pool élastique avec le même nom.</span><span class="sxs-lookup"><span data-stu-id="cb47f-199">If the primary database is in an elastic pool, the secondary is automatically created in the elastic pool with the same name.</span></span> <span data-ttu-id="cb47f-200">Si vous ajoutez une base de données qui présente déjà une base de données secondaire dans le serveur secondaire, cette géo-réplication est héritée par le groupe.</span><span class="sxs-lookup"><span data-stu-id="cb47f-200">If you add a database that already has a secondary database in the secondary server, that geo-replication is inherited by the group.</span></span>

   > [!NOTE]
   > <span data-ttu-id="cb47f-201">Lors de l’ajout d’une base de données qui présente déjà une base de données secondaire sur un serveur qui ne fait pas partie du groupe de basculement, une nouvelle base de données secondaire est créée sur le serveur secondaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-201">When adding a database that already has a secondary database in a server that is not part of the failover group, a new secondary is created in the secondary server.</span></span> 
   >

* <span data-ttu-id="cb47f-202">**Écouteur de lecture-écriture de groupe de basculement** : un enregistrement DNS CNAME formé comme suit : **&lt;nom du groupe de basculement&gt;.database.windows.net** et qui pointe vers l’URL actuelle du serveur primaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-202">**Failover group read-write listener**: A DNS CNAME record formed as **&lt;failover-group-name&gt;.database.windows.net** that points to the current primary server URL.</span></span> <span data-ttu-id="cb47f-203">Il permet aux applications SQL en lecture-écriture de se reconnecter en toute transparence à la base de données primaire lorsqu’elle est modifiée après le basculement.</span><span class="sxs-lookup"><span data-stu-id="cb47f-203">It allows the read-write SQL applications to transparently reconnect to the primary database when the primary changes after failover.</span></span> 
* <span data-ttu-id="cb47f-204">**Écouteur de lecture-écriture de groupe de basculement** : un enregistrement DNS CNAME formé comme suit : **&lt;nom du groupe de basculement&gt;.database.windows.net** et qui pointe vers l’URL actuelle du serveur primaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-204">**Failover group read-only listener**: A DNS CNAME record formed as **&lt;failover-group-name&gt;.secondary.database.windows.net** that points to the secondary server’s URL.</span></span> <span data-ttu-id="cb47f-205">Il permet aux applications SQL en lecture seule de se connecter en toute transparence à la base de données secondaire à l’aide des règles d’équilibrage de charge spécifiées.</span><span class="sxs-lookup"><span data-stu-id="cb47f-205">It allows the read-only SQL applications to transparently connect to the secondary database using the specified load-balancing rules.</span></span> <span data-ttu-id="cb47f-206">Si vous le souhaitez, vous pouvez choisir de rediriger automatiquement le trafic en lecture seule vers le serveur primaire lorsque le serveur secondaire n’est pas disponible.</span><span class="sxs-lookup"><span data-stu-id="cb47f-206">Optionally you can specify if you want the read-only traffic to be automatically re-directed to the primary server when the secondary server is not available.</span></span>
* <span data-ttu-id="cb47f-207">**Stratégie de basculement automatique** : par défaut, le groupe de basculement est configuré avec une stratégie de basculement automatique.</span><span class="sxs-lookup"><span data-stu-id="cb47f-207">**Automatic failover policy**: By default, the failover group is configured with an automatic failover policy.</span></span> <span data-ttu-id="cb47f-208">Le système déclenche le basculement dès qu’une défaillance est détectée.</span><span class="sxs-lookup"><span data-stu-id="cb47f-208">The system triggers failover as soon as the failure is detected.</span></span> <span data-ttu-id="cb47f-209">Si vous souhaitez contrôler le flux de travail de basculement à partir de l’application, vous pouvez désactiver le basculement automatique.</span><span class="sxs-lookup"><span data-stu-id="cb47f-209">If you want to control the failover workflow from the application, you can turn off automatic failover.</span></span> 
* <span data-ttu-id="cb47f-210">**Basculement manuel** : vous pouvez initialiser manuellement le basculement à tout moment, peu importe la configuration de basculement automatique.</span><span class="sxs-lookup"><span data-stu-id="cb47f-210">**Manual failover**: You can initiate failover manually at any time regardless of the automatic failover configuration.</span></span> <span data-ttu-id="cb47f-211">Si la stratégie de basculement automatique n’est pas configurée, un basculement manuel est nécessaire pour récupérer les bases de données dans le groupe de basculement.</span><span class="sxs-lookup"><span data-stu-id="cb47f-211">If automatic failover policy is not configured manual failover is required to recover databases in the failover group.</span></span> <span data-ttu-id="cb47f-212">Vous pouvez lancer un basculement forcé ou convivial (avec synchronisation complète des données).</span><span class="sxs-lookup"><span data-stu-id="cb47f-212">You can initiate forced or friendly failover (with full data synchronization).</span></span> <span data-ttu-id="cb47f-213">Ce dernier peut être utilisé pour relocaliser le serveur actif dans la région primaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-213">The latter could be used to relocate the active server to the primary region.</span></span> <span data-ttu-id="cb47f-214">Une fois le basculement terminé, les enregistrements DNS sont automatiquement mis à jour pour garantir la connexion au serveur approprié.</span><span class="sxs-lookup"><span data-stu-id="cb47f-214">When failover is completed the DNS records are automatically updated to ensure connectivity to the correct server.</span></span>
* <span data-ttu-id="cb47f-215">**Période de grâce en cas de risque de perte de données** : étant donné que les bases de données primaires et secondaires sont synchronisées à l’aide de la réplication asynchrone, le basculement peut entraîner une perte de données.</span><span class="sxs-lookup"><span data-stu-id="cb47f-215">**Grace period with data loss**: Because the primary and secondary databases are synchronized using asynchronous replication the failover may result in data loss.</span></span> <span data-ttu-id="cb47f-216">Vous pouvez personnaliser la stratégie de basculement automatique en fonction de la tolérance de votre application aux pertes de données.</span><span class="sxs-lookup"><span data-stu-id="cb47f-216">You can customize the automatic failover policy to reflect your application’s tolerance to data loss.</span></span> <span data-ttu-id="cb47f-217">En configurant la commande **GracePeriodWithDataLossHours**, vous pouvez contrôler le délai observé par le système avant d’initialiser le basculement qui est susceptible d’entraîner une perte de données.</span><span class="sxs-lookup"><span data-stu-id="cb47f-217">By configuring **GracePeriodWithDataLossHours**, you can control how long the system waits before initiating the failover that is likely to result data loss.</span></span> 

   > [!NOTE]
   > <span data-ttu-id="cb47f-218">Lorsque le système détecte que les bases de données au sein du groupe sont toujours en ligne (si la panne a affecté uniquement le plan de contrôle des services, par exemple), il active immédiatement le basculement avec synchronisation complète des données (basculement convivial), quelle que soit la valeur définie par la commande **GracePeriodWithDataLossHours**.</span><span class="sxs-lookup"><span data-stu-id="cb47f-218">When system detects that the databases in the group are still online (for example, the outage only impacted the service control plane), it immediately activates the failover with full data synchronization (friendly failover) regardless of the value set by **GracePeriodWithDataLossHours**.</span></span> <span data-ttu-id="cb47f-219">Ce comportement garantit que les données ne seront pas perdues lors de la récupération.</span><span class="sxs-lookup"><span data-stu-id="cb47f-219">This behavior ensures that there is no data loss during the recovery.</span></span> <span data-ttu-id="cb47f-220">La période de grâce prend effet uniquement lorsqu’un basculement convivial n’est pas possible.</span><span class="sxs-lookup"><span data-stu-id="cb47f-220">The grace period takes effect only when a friendly failover is not possible.</span></span> <span data-ttu-id="cb47f-221">Si la panne est résolue avant l’expiration de la période de grâce, le basculement n’est pas activé.</span><span class="sxs-lookup"><span data-stu-id="cb47f-221">If the outage is mitigated before the grace period expires, the failover is not activated.</span></span>
   >

* <span data-ttu-id="cb47f-222">**Plusieurs groupes de basculement** : vous pouvez configurer plusieurs groupes de basculement pour la même paire de serveurs afin de contrôler l’échelle des basculements.</span><span class="sxs-lookup"><span data-stu-id="cb47f-222">**Multiple failover groups**: You can configure multiple failover groups for the same pair of servers to control the scale of failovers.</span></span> <span data-ttu-id="cb47f-223">Chaque groupe bascule indépendamment.</span><span class="sxs-lookup"><span data-stu-id="cb47f-223">Each group fails over independently.</span></span> <span data-ttu-id="cb47f-224">Si votre application mutualisée fait appel à des pools élastiques, vous pouvez utiliser cette fonctionnalité pour combiner des bases de données primaires et secondaires dans chaque pool.</span><span class="sxs-lookup"><span data-stu-id="cb47f-224">If your multi-tenant application uses elastic pools, you can use this capability to mix primary and secondary databases in each pool.</span></span> <span data-ttu-id="cb47f-225">De cette manière, vous pouvez réduire l’impact d’une panne à la moitié seulement des locataires.</span><span class="sxs-lookup"><span data-stu-id="cb47f-225">This way you can reduce the impact of an outage to only half of the tenants.</span></span>

## <a name="best-practices-of-building-highly-available-service"></a><span data-ttu-id="cb47f-226">Meilleures pratiques de création de service hautement disponible</span><span class="sxs-lookup"><span data-stu-id="cb47f-226">Best practices of building highly available service</span></span>

<span data-ttu-id="cb47f-227">Pour créer un service hautement disponible qui utilise Azure SQL Database, les clients doivent suivre ces instructions :</span><span class="sxs-lookup"><span data-stu-id="cb47f-227">To build a highly available service that uses Azure SQL database the customers should follow these guidelines:</span></span>
- <span data-ttu-id="cb47f-228">**Utiliser un groupe de basculement** : un ou plusieurs groupes de basculement peuvent être créés entre deux serveurs situés dans des régions différentes (serveurs primaires et secondaires).</span><span class="sxs-lookup"><span data-stu-id="cb47f-228">**Use failover group**: One or many failover groups can be created between two servers in different regions (primary and secondary servers).</span></span> <span data-ttu-id="cb47f-229">Chaque groupe peut inclure une ou plusieurs bases de données qui sont récupérées ensemble dans le cas où une partie ou la totalité des bases de données primaires deviennent indisponibles en raison d’une panne dans la région principale.</span><span class="sxs-lookup"><span data-stu-id="cb47f-229">Each group can include one or several databases that are recovered as a unit in case all or some primary databases become unavailable due to an outage in the primary region.</span></span> <span data-ttu-id="cb47f-230">Le groupe de basculement crée une base de données géo-secondaire avec le même objectif de service que la base de données primaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-230">The failover group creates geo-secondary database with the same service objective as the primary.</span></span> <span data-ttu-id="cb47f-231">Si vous ajoutez une relation de géo-réplication existante au groupe de basculement, vérifiez que la base de données géo-secondaire est configurée au même niveau d’objectif de service que la base de données primaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-231">If you add an existing geo-replication relationship to the failover group make sure the geo-secondary is configured with the same service level objective as the primary.</span></span>
- <span data-ttu-id="cb47f-232">**Utiliser l’écouteur de lecture-écriture pour les charges de travail OLTP** : lorsque vous effectuez des opérations OLTP, utilisez  **&lt;failover-group-name&gt;.database.windows.net** étant donné que le serveur d’URL et les connexions seront automatiquement dirigées vers le serveur principal.</span><span class="sxs-lookup"><span data-stu-id="cb47f-232">**Use read-write listener for OLTP workload**: When performing OLTP operations use **&lt;failover-group-name&gt;.database.windows.net** as the server URL and the connections will be automatically directed to the primary.</span></span> <span data-ttu-id="cb47f-233">Cet URL ne changera pas après le basculement.</span><span class="sxs-lookup"><span data-stu-id="cb47f-233">This URL will not change after the failover.</span></span>  
<span data-ttu-id="cb47f-234">Notez que le basculement implique la mise à jour de l’enregistrement DNS de façon à ce que les connexions clients soient redirigées vers le nouveau serveur primaire seulement après l’actualisation du cache DNS.</span><span class="sxs-lookup"><span data-stu-id="cb47f-234">Note the failover involves updating the DNS record so the client connections will be redirected to the new primary only after the client DNS cache is refreshed.</span></span>
- <span data-ttu-id="cb47f-235">**Utilisez l’écouteur en lecture seule pour les charges de travail en lecture seule** : si vous avez une charge de travail en lecture seule isolée logiquement et qui est tolérante à une certaine obsolescence des données, vous pouvez utiliser la base de données secondaire dans l’application.</span><span class="sxs-lookup"><span data-stu-id="cb47f-235">**Use read-only listener for read-only workload**: If you have a logically isolated read-only workload that is tolerant to certain staleness of data, you can use the secondary database in the application.</span></span> <span data-ttu-id="cb47f-236">Pour les sessions en lecture seule utilisez **&lt;failover-group-name&gt;.secondary.database.windows.net** en tant qu’URL du serveur et la connexion sera automatiquement dirigée vers la base de données secondaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-236">For read-only sessions use **&lt;failover-group-name&gt;.secondary.database.windows.net** as the server URL and the connection will be automatically directed to the secondary.</span></span> <span data-ttu-id="cb47f-237">Il est également recommandé d’indiquer dans la tentative de lecture de la chaîne de connexion à l’aide de **ApplicationIntent = ReadOnly**.</span><span class="sxs-lookup"><span data-stu-id="cb47f-237">It is also recommended that you indicate in connection string read intent by using **ApplicationIntent=ReadOnly**.</span></span> 
- <span data-ttu-id="cb47f-238">**Attendez-vous à une dégradation des performances** : la décision de basculement SQL est indépendante du reste de l’application ou des autres services utilisés.</span><span class="sxs-lookup"><span data-stu-id="cb47f-238">**Be prepared for perf degradation**: SQL failover decision is independent from the rest of the application or other services used.</span></span> <span data-ttu-id="cb47f-239">L’application peut être mélangée à certains composants dans une région et d’autres composants dans une région différente.</span><span class="sxs-lookup"><span data-stu-id="cb47f-239">The application may be “mixed” with some components in one region and some in another.</span></span> <span data-ttu-id="cb47f-240">Afin d’éviter la dégradation, assurez le déploiement redondant d’applications dans la région de récupération d’urgence et suivez les instructions de cet article.</span><span class="sxs-lookup"><span data-stu-id="cb47f-240">To avoid the degradation, ensure the redundant application deployment in the DR region and follow the guidelines in this article.</span></span>  
<span data-ttu-id="cb47f-241">Notez qu’il n’est pas obligatoire pour l’application dans la région de récupération d’urgence d’utiliser une chaîne de connexion différente.</span><span class="sxs-lookup"><span data-stu-id="cb47f-241">Note the application in the DR region does not have to use a different connection string.</span></span>  
- <span data-ttu-id="cb47f-242">**Anticipez la perte de données** : lorsqu’une panne est détectée, SQL déclenche automatiquement un basculement en lecture-écriture s’il n’y a aucune perte de données à notre connaissance.</span><span class="sxs-lookup"><span data-stu-id="cb47f-242">**Prepare for data loss**: If an outage is detected, SQL automatically triggers read-write failover if there is zero data loss to the best of our knowledge.</span></span> <span data-ttu-id="cb47f-243">Le cas contraire, SQL patiente pendant le temps que vous avez défini à l’aide de la commande **GracePeriodWithDataLossHours**.</span><span class="sxs-lookup"><span data-stu-id="cb47f-243">Otherwise, it waits for the period you specified by **GracePeriodWithDataLossHours**.</span></span> <span data-ttu-id="cb47f-244">Si vous avez spécifié **GracePeriodWithDataLossHours**, attendez-vous à une perte de données.</span><span class="sxs-lookup"><span data-stu-id="cb47f-244">If you specified **GracePeriodWithDataLossHours**, be prepared for data loss.</span></span> <span data-ttu-id="cb47f-245">En général, en cas de panne, Azure favorise la disponibilité.</span><span class="sxs-lookup"><span data-stu-id="cb47f-245">In general, during outages, Azure favors availability.</span></span> <span data-ttu-id="cb47f-246">Si vous ne pouvez pas vous permettre de perdre des données, veillez à définir dans la commande **GracePeriodWithDataLossHours** un nombre suffisamment grand, par exemple, 24 heures.</span><span class="sxs-lookup"><span data-stu-id="cb47f-246">If you cannot afford data loss, make sure to set **GracePeriodWithDataLossHours** to a sufficiently large number, such as 24 hours.</span></span> 


## <a name="upgrading-or-downgrading-a-primary-database"></a><span data-ttu-id="cb47f-247">Mise à niveau ou rétrogradation d’une base de données primaire</span><span class="sxs-lookup"><span data-stu-id="cb47f-247">Upgrading or downgrading a primary database</span></span>
<span data-ttu-id="cb47f-248">Vous pouvez mettre à niveau ou rétrograder une base de données primaire à un niveau de performance différent (avec le même niveau de service) sans déconnecter les bases de données secondaires.</span><span class="sxs-lookup"><span data-stu-id="cb47f-248">You can upgrade or downgrade a primary database to a different performance level (within the same service tier) without disconnecting any secondary databases.</span></span> <span data-ttu-id="cb47f-249">Lors d’une mise à niveau, nous vous recommandons de mettre à niveau la base de données secondaire dans un premier temps, avant de mettre à niveau la base de données primaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-249">When upgrading, we recommend that you upgrade the secondary database first, and then upgrade the primary.</span></span> <span data-ttu-id="cb47f-250">Lors d’une rétrogradation, inversez l’ordre : rétrogradez tout d’abord la base de données primaire, puis dans un second temps la base de données secondaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-250">When downgrading, reverse the order: downgrade the primary first, and then downgrade the secondary.</span></span> <span data-ttu-id="cb47f-251">Lorsque vous passez la base de données à un niveau de service supérieur ou inférieur, cette recommandation est appliquée.</span><span class="sxs-lookup"><span data-stu-id="cb47f-251">When you upgrade or downgrade the database to a different service tier this recommendation is enforced.</span></span> 

> [!NOTE]
> <span data-ttu-id="cb47f-252">Si vous avez créé une base de données secondaire dans le cadre de la configuration des groupes de basculement, il n’est pas conseillé de passer la base de données secondaire à un niveau de service inférieur.</span><span class="sxs-lookup"><span data-stu-id="cb47f-252">If you created secondary database as part of the failover group configuration it is not recommended to downgrade the secondary database.</span></span> <span data-ttu-id="cb47f-253">En effet, votre couche Données pourrait manquer de capacité pour traiter votre charge de travail normale après l’activation du basculement.</span><span class="sxs-lookup"><span data-stu-id="cb47f-253">This is to ensure your data tier has sufficient capacity to process your regular workload after failover is activated.</span></span> 
>

## <a name="preventing-the-loss-of-critical-data"></a><span data-ttu-id="cb47f-254">Prévention de la perte de données critiques</span><span class="sxs-lookup"><span data-stu-id="cb47f-254">Preventing the loss of critical data</span></span>
<span data-ttu-id="cb47f-255">En raison de la latence élevée des réseaux étendus, la copie continue utilise un mécanisme de réplication asynchrone.</span><span class="sxs-lookup"><span data-stu-id="cb47f-255">Due to the high latency of wide area networks, continuous copy uses an asynchronous replication mechanism.</span></span> <span data-ttu-id="cb47f-256">La perte de certaines données reste donc inévitable en cas de défaillance.</span><span class="sxs-lookup"><span data-stu-id="cb47f-256">Asynchronous replication makes some data loss unavoidable if a failure occurs.</span></span> <span data-ttu-id="cb47f-257">Or, pour certaines applications, une perte de données est inacceptable.</span><span class="sxs-lookup"><span data-stu-id="cb47f-257">However, some applications may require no data loss.</span></span> <span data-ttu-id="cb47f-258">Pour protéger ces mises à jour critiques, un développeur d’applications peut appeler la procédure système [sp_wait_for_database_copy_sync](https://msdn.microsoft.com/library/dn467644.aspx) immédiatement après la validation de la transaction.</span><span class="sxs-lookup"><span data-stu-id="cb47f-258">To protect these critical updates, an application developer can call the [sp_wait_for_database_copy_sync](https://msdn.microsoft.com/library/dn467644.aspx) system procedure immediately after committing the transaction.</span></span> <span data-ttu-id="cb47f-259">L’appel de **sp_wait_for_database_copy_sync** bloque le thread appelant jusqu’à ce que la dernière transaction validée ait été transmise à la base de données secondaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-259">Calling **sp_wait_for_database_copy_sync** blocks the calling thread until the last committed transaction has been transmitted to the secondary database.</span></span> <span data-ttu-id="cb47f-260">Toutefois, il n’attend pas que les transactions transmises soient relues et validées sur la base de données secondaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-260">However, it does not wait for the transmitted transactions to be replayed and committed on the secondary.</span></span> <span data-ttu-id="cb47f-261">**sp_wait_for_database_copy_sync** est limité à une relation de copie continue spécifique.</span><span class="sxs-lookup"><span data-stu-id="cb47f-261">**sp_wait_for_database_copy_sync** is scoped to a specific continuous copy link.</span></span> <span data-ttu-id="cb47f-262">Tout utilisateur disposant de droits de connexion à la base de données primaire peut appeler cette procédure.</span><span class="sxs-lookup"><span data-stu-id="cb47f-262">Any user with the connection rights to the primary database can call this procedure.</span></span>

> [!NOTE]
> <span data-ttu-id="cb47f-263">**sp_wait_for_database_copy_sync** empêchera la perte de données après un basculement, mais il ne garantira pas la synchronisation complète pour l’accès en lecture.</span><span class="sxs-lookup"><span data-stu-id="cb47f-263">**sp_wait_for_database_copy_sync** will prevent data loss after failover, but it will not guarantee full synchronization for read access.</span></span> <span data-ttu-id="cb47f-264">Le délai causé par un appel de procédure **sp_wait_for_database_copy_sync** peut être significatif et dépend de la taille du journal des transactions au moment de l’appel.</span><span class="sxs-lookup"><span data-stu-id="cb47f-264">The delay caused by a **sp_wait_for_database_copy_sync** procedure call can be significant and depends on the size of the transaction log at the time of the call.</span></span> 
> 

## <a name="programmatically-managing-failover-groups-and-active-geo-replication"></a><span data-ttu-id="cb47f-265">Gestion de la géo-réplication active et des groupes de basculement par programmation</span><span class="sxs-lookup"><span data-stu-id="cb47f-265">Programmatically managing failover groups and active geo-replication</span></span>
<span data-ttu-id="cb47f-266">Comme indiqué précédemment, les groupes de basculement automatique (en préversion) et la géo-réplication active peuvent aussi être gérés par programmation à l’aide d’Azure PowerShell et de l’API REST.</span><span class="sxs-lookup"><span data-stu-id="cb47f-266">As discussed previously, auto-failover groups (in-preview) and active geo-replication can also be managed programmatically using Azure PowerShell and the REST API.</span></span> <span data-ttu-id="cb47f-267">Les tableaux ci-dessous décrivent l’ensemble des commandes disponibles.</span><span class="sxs-lookup"><span data-stu-id="cb47f-267">The following tables describe the set of commands available.</span></span>

<span data-ttu-id="cb47f-268">**API Azure Resource Manager et sécurité basée sur les rôles** : la géoréplication active comprend un ensemble d’API Azure Resource Manager pour la gestion, notamment l[’API REST Azure SQL Database](https://docs.microsoft.com/rest/api/sql/) et les [applets de commande Azure PowerShell](https://docs.microsoft.com/powershell/azure/overview).</span><span class="sxs-lookup"><span data-stu-id="cb47f-268">**Azure Resource Manager API and role-based security**: Active geo-replication includes a set of Azure Resource Manager APIs for management, including the [Azure SQL Database REST API](https://docs.microsoft.com/rest/api/sql/) and [Azure PowerShell cmdlets](https://docs.microsoft.com/powershell/azure/overview).</span></span> <span data-ttu-id="cb47f-269">Ces API nécessitent l’utilisation de groupes de ressources et la prise en charge de la sécurité basée sur les rôles (RBAC).</span><span class="sxs-lookup"><span data-stu-id="cb47f-269">These APIs require the use of resource groups and support role-based security (RBAC).</span></span> <span data-ttu-id="cb47f-270">Pour plus d’informations sur l’implémentation de rôles d’accès, consultez la page sur le [contrôle d’accès en fonction du rôle Azure](../active-directory/role-based-access-control-what-is.md).</span><span class="sxs-lookup"><span data-stu-id="cb47f-270">For more information on how to implement access roles, see [Azure Role-Based Access Control](../active-directory/role-based-access-control-what-is.md).</span></span>

> [!NOTE]
> <span data-ttu-id="cb47f-271">Parmi les nouvelles fonctionnalités de géo-réplication active, plusieurs sont uniquement prises en charge avec [l’API REST de SQL Azure](https://msdn.microsoft.com/library/azure/mt163571.aspx) et les [applets de commande PowerShell d’Azure SQL Database](https://msdn.microsoft.com/library/azure/mt574084.aspx), basées sur [Azure Resource Manager](../azure-resource-manager/resource-group-overview.md).</span><span class="sxs-lookup"><span data-stu-id="cb47f-271">Many new features of active geo-replication are only supported using [Azure Resource Manager](../azure-resource-manager/resource-group-overview.md) based [Azure SQL REST API](https://msdn.microsoft.com/library/azure/mt163571.aspx) and [Azure SQL Database PowerShell cmdlets](https://msdn.microsoft.com/library/azure/mt574084.aspx).</span></span> <span data-ttu-id="cb47f-272">L’[API REST (classique)](https://msdn.microsoft.com/library/azure/dn505719.aspx) et les [applets de commande Azure SQL Database (classique)](https://msdn.microsoft.com/library/azure/dn546723.aspx) sont prises en charge à des fins de compatibilité descendante. L’utilisation des API basées sur Azure Resource Manager est donc recommandée.</span><span class="sxs-lookup"><span data-stu-id="cb47f-272">The [(classic) REST API](https://msdn.microsoft.com/library/azure/dn505719.aspx) and [Azure SQL Database (classic) cmdlets](https://msdn.microsoft.com/library/azure/dn546723.aspx) are supported for backward compatibility so using the Azure Resource Manager-based APIs are recommended.</span></span> 
> 

## <a name="manage-sql-database-failover-using-using-transact-sql"></a><span data-ttu-id="cb47f-273">Gérer SQL de base de données de basculement à l’aide à l’aide de Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="cb47f-273">Manage SQL database failover using using Transact-SQL</span></span>

| <span data-ttu-id="cb47f-274">Commande</span><span class="sxs-lookup"><span data-stu-id="cb47f-274">Command</span></span> | <span data-ttu-id="cb47f-275">Description</span><span class="sxs-lookup"><span data-stu-id="cb47f-275">Description</span></span> |
| --- | --- |
| [<span data-ttu-id="cb47f-276">ALTER DATABASE (Azure SQL Database)</span><span class="sxs-lookup"><span data-stu-id="cb47f-276">ALTER DATABASE (Azure SQL Database)</span></span>](https://msdn.microsoft.com/library/mt574871.aspx) |<span data-ttu-id="cb47f-277">Utilise l’argument ADD SECONDARY ON SERVER afin de créer une base de données secondaire pour une base de données existante puis lance la réplication des données</span><span class="sxs-lookup"><span data-stu-id="cb47f-277">Use ADD SECONDARY ON SERVER argument to create a secondary database for an existing database and starts data replication</span></span> |
| [<span data-ttu-id="cb47f-278">ALTER DATABASE (Azure SQL Database)</span><span class="sxs-lookup"><span data-stu-id="cb47f-278">ALTER DATABASE (Azure SQL Database)</span></span>](https://msdn.microsoft.com/library/mt574871.aspx) |<span data-ttu-id="cb47f-279">Utilise l’argument FAILOVER ou FORCE_FAILOVER_ALLOW_DATA_LOSS pour basculer d’une base de données secondaire à une base de données principale afin de lancer le basculement</span><span class="sxs-lookup"><span data-stu-id="cb47f-279">Use FAILOVER or FORCE_FAILOVER_ALLOW_DATA_LOSS to switch a secondary database to be primary to initiate failover</span></span> |
| [<span data-ttu-id="cb47f-280">ALTER DATABASE (Azure SQL Database)</span><span class="sxs-lookup"><span data-stu-id="cb47f-280">ALTER DATABASE (Azure SQL Database)</span></span>](https://msdn.microsoft.com/library/mt574871.aspx) |<span data-ttu-id="cb47f-281">Utilise l’argument REMOVE SECONDARY ON SERVER pour mettre fin à une réplication de données entre une base de données SQL et la base de données secondaire spécifiée.</span><span class="sxs-lookup"><span data-stu-id="cb47f-281">Use REMOVE SECONDARY ON SERVER to terminate a data replication between a SQL Database and the specified secondary database.</span></span> |
| [<span data-ttu-id="cb47f-282">sys.geo_replication_links (base de données SQL Azure)</span><span class="sxs-lookup"><span data-stu-id="cb47f-282">sys.geo_replication_links (Azure SQL Database)</span></span>](https://msdn.microsoft.com/library/mt575501.aspx) |<span data-ttu-id="cb47f-283">Retourne des informations concernant tous les liens de réplication existants pour chaque base de données sur le serveur logique de base de données SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="cb47f-283">Returns information about all existing replication links for each database on the Azure SQL Database logical server.</span></span> |
| [<span data-ttu-id="cb47f-284">sys.dm_geo_replication_link_status (base de données SQL Azure)</span><span class="sxs-lookup"><span data-stu-id="cb47f-284">sys.dm_geo_replication_link_status (Azure SQL Database)</span></span>](https://msdn.microsoft.com/library/mt575504.aspx) |<span data-ttu-id="cb47f-285">Obtient l’heure de la dernière réplication, le dernier décalage de la réplication et d’autres informations sur le lien de réplication pour une base de données SQL spécifique.</span><span class="sxs-lookup"><span data-stu-id="cb47f-285">Gets the last replication time, last replication lag, and other information about the replication link for a given SQL database.</span></span> |
| [<span data-ttu-id="cb47f-286">sys.dm_operation_status (base de données SQL Azure)</span><span class="sxs-lookup"><span data-stu-id="cb47f-286">sys.dm_operation_status (Azure SQL Database)</span></span>](https://msdn.microsoft.com/library/dn270022.aspx) |<span data-ttu-id="cb47f-287">Affiche l’état de toutes les opérations de base de données, y compris l’état des liens de réplication.</span><span class="sxs-lookup"><span data-stu-id="cb47f-287">Shows the status for all database operations including the status of the replication links.</span></span> |
| [<span data-ttu-id="cb47f-288">sp_wait_for_database_copy_sync (base de données SQL Azure)</span><span class="sxs-lookup"><span data-stu-id="cb47f-288">sp_wait_for_database_copy_sync (Azure SQL Database)</span></span>](https://msdn.microsoft.com/library/dn467644.aspx) |<span data-ttu-id="cb47f-289">oblige l’application à attendre que toutes les transactions validées sont répliquées et acceptées par la base de données secondaire active.</span><span class="sxs-lookup"><span data-stu-id="cb47f-289">causes the application to wait until all committed transactions are replicated and acknowledged by the active secondary database.</span></span> |
|  | |

## <a name="manage-sql-database-failover-using-using-powershell"></a><span data-ttu-id="cb47f-290">Gérer SQL de base de données de basculement à l’aide de l’aide de PowerShell</span><span class="sxs-lookup"><span data-stu-id="cb47f-290">Manage SQL database failover using using PowerShell</span></span>

| <span data-ttu-id="cb47f-291">Applet de commande</span><span class="sxs-lookup"><span data-stu-id="cb47f-291">Cmdlet</span></span> | <span data-ttu-id="cb47f-292">Description</span><span class="sxs-lookup"><span data-stu-id="cb47f-292">Description</span></span> |
| --- | --- |
| [<span data-ttu-id="cb47f-293">Get-AzureRmSqlDatabase</span><span class="sxs-lookup"><span data-stu-id="cb47f-293">Get-AzureRmSqlDatabase</span></span>](/powershell/module/azurerm.sql/get-azurermsqldatabase) |<span data-ttu-id="cb47f-294">Obtient une ou plusieurs bases de données.</span><span class="sxs-lookup"><span data-stu-id="cb47f-294">Gets one or more databases.</span></span> |
| [<span data-ttu-id="cb47f-295">New-AzureRmSqlDatabaseSecondary</span><span class="sxs-lookup"><span data-stu-id="cb47f-295">New-AzureRmSqlDatabaseSecondary</span></span>](/powershell/module/azurerm.sql/new-azurermsqldatabasesecondary) |<span data-ttu-id="cb47f-296">Crée une base de données secondaire pour une base de données existante puis lance la réplication des données.</span><span class="sxs-lookup"><span data-stu-id="cb47f-296">Creates a secondary database for an existing database and starts data replication.</span></span> |
| [<span data-ttu-id="cb47f-297">Set-AzureRmSqlDatabaseSecondary</span><span class="sxs-lookup"><span data-stu-id="cb47f-297">Set-AzureRmSqlDatabaseSecondary</span></span>](/powershell/module/azurerm.sql/set-azurermsqldatabasesecondary) |<span data-ttu-id="cb47f-298">Bascule d’une base de données secondaire à une base de données principale afin de lancer le basculement.</span><span class="sxs-lookup"><span data-stu-id="cb47f-298">Switches a secondary database to be primary to initiate failover.</span></span> |
| [<span data-ttu-id="cb47f-299">Remove-AzureRmSqlDatabaseSecondary</span><span class="sxs-lookup"><span data-stu-id="cb47f-299">Remove-AzureRmSqlDatabaseSecondary</span></span>](/powershell/module/azurerm.sql/remove-azurermsqldatabasesecondary) |<span data-ttu-id="cb47f-300">Met fin à une réplication de données entre une base de données SQL et la base de données secondaire spécifiée.</span><span class="sxs-lookup"><span data-stu-id="cb47f-300">Terminates data replication between a SQL Database and the specified secondary database.</span></span> |
| [<span data-ttu-id="cb47f-301">Get-AzureRmSqlDatabaseReplicationLink</span><span class="sxs-lookup"><span data-stu-id="cb47f-301">Get-AzureRmSqlDatabaseReplicationLink</span></span>](/powershell/module/azurerm.sql/get-azurermsqldatabasereplicationlink) |<span data-ttu-id="cb47f-302">Obtient les liens de géo-réplication entre une base de données SQL Azure et un groupe de ressources ou SQL Server.</span><span class="sxs-lookup"><span data-stu-id="cb47f-302">Gets the geo-replication links between an Azure SQL Database and a resource group or SQL Server.</span></span> |
| [<span data-ttu-id="cb47f-303">New-AzureRmSqlDatabaseFailoverGroup</span><span class="sxs-lookup"><span data-stu-id="cb47f-303">New-AzureRmSqlDatabaseFailoverGroup</span></span>](/powershell/module/azurerm.sql/set-azurermsqldatabasefailovergroup) |   <span data-ttu-id="cb47f-304">Cette commande crée un groupe de basculement et l’enregistre dans les serveurs primaire et secondaire</span><span class="sxs-lookup"><span data-stu-id="cb47f-304">This command creates a failover group and registers it on both primary and secondary servers</span></span>|
| [<span data-ttu-id="cb47f-305">Remove-AzureRmSqlDatabaseFailoverGroup</span><span class="sxs-lookup"><span data-stu-id="cb47f-305">Remove-AzureRmSqlDatabaseFailoverGroup</span></span>](/powershell/module/azurerm.sql/remove-azurermsqldatabasefailovergroup) | <span data-ttu-id="cb47f-306">Supprime le groupe de basculement du serveur et efface toutes les bases de données secondaires incluses dans le groupe.</span><span class="sxs-lookup"><span data-stu-id="cb47f-306">Removes the failover group from the server and deletes all secondary databases included the group</span></span> |
| [<span data-ttu-id="cb47f-307">Get-AzureRmSqlDatabaseFailoverGroup</span><span class="sxs-lookup"><span data-stu-id="cb47f-307">Get-AzureRmSqlDatabaseFailoverGroup</span></span>](/powershell/module/azurerm.sql/get-azurermsqldatabasefailovergroup) | <span data-ttu-id="cb47f-308">Récupère la configuration du groupe de basculement.</span><span class="sxs-lookup"><span data-stu-id="cb47f-308">Retrieves the failover group configuration</span></span> |
| [<span data-ttu-id="cb47f-309">Set-AzureRmSqlDatabaseFailoverGroup</span><span class="sxs-lookup"><span data-stu-id="cb47f-309">Set-AzureRmSqlDatabaseFailoverGroup</span></span>](/powershell/module/azurerm.sql/set-azurermsqldatabasefailovergroup) |   <span data-ttu-id="cb47f-310">Modifie la configuration du groupe de basculement.</span><span class="sxs-lookup"><span data-stu-id="cb47f-310">Modifies the configuration of the failover group</span></span> |
| [<span data-ttu-id="cb47f-311">Switch-AzureRMSqlDatabaseFailoverGroup</span><span class="sxs-lookup"><span data-stu-id="cb47f-311">Switch-AzureRMSqlDatabaseFailoverGroup</span></span>](/powershell/module/azurerm.sql/switch-azurermsqldatabasefailovergroup) | <span data-ttu-id="cb47f-312">Déclenche le basculement du groupe de basculement vers le serveur secondaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-312">Triggers failover of the failover group to the secondary server</span></span> |
|  | |

> [!IMPORTANT]
> <span data-ttu-id="cb47f-313">Pour plus d’exemples de scripts, consultez [Configurer et basculer une base de données unique à l’aide de la géoréplication active](scripts/sql-database-setup-geodr-and-failover-database-powershell.md), [Configurer et basculer une base de données regroupée à l’aide de la géoréplication active](scripts/sql-database-setup-geodr-and-failover-pool-powershell.md), et [Configurer et basculer un groupe de basculement pour une base de données unique (préversion)] (scripts/sql-database-setup-geodr-failover-database-failover-group-powershell.md.</span><span class="sxs-lookup"><span data-stu-id="cb47f-313">For sample scripts, see [Configure and failover a single database using active geo-replication](scripts/sql-database-setup-geodr-and-failover-database-powershell.md), [Configure and failover a pooled database using active geo-replication](scripts/sql-database-setup-geodr-and-failover-pool-powershell.md), and  [Configure and failover a failover group for a single database (preview)](scripts/sql-database-setup-geodr-failover-database-failover-group-powershell.md.</span></span>
>

## <a name="manage-sql-database-failover-using-the-rest-api"></a><span data-ttu-id="cb47f-314">Gérer le basculement de base de données à l’aide de l’API REST</span><span class="sxs-lookup"><span data-stu-id="cb47f-314">Manage SQL database failover using the REST API</span></span>
| <span data-ttu-id="cb47f-315">API</span><span class="sxs-lookup"><span data-stu-id="cb47f-315">API</span></span> | <span data-ttu-id="cb47f-316">Description</span><span class="sxs-lookup"><span data-stu-id="cb47f-316">Description</span></span> |
| --- | --- |
| [<span data-ttu-id="cb47f-317">.Créer ou mettre à jour la base de données (createMode=Restore)</span><span class="sxs-lookup"><span data-stu-id="cb47f-317">Create or Update Database (createMode=Restore)</span></span>](/rest/api/sql/Databases/CreateOrUpdate) |<span data-ttu-id="cb47f-318">Crée, met à jour ou restaure une base de données principale ou secondaire.</span><span class="sxs-lookup"><span data-stu-id="cb47f-318">Creates, updates, or restores a primary or a secondary database.</span></span> |
| [<span data-ttu-id="cb47f-319">Créer ou mettre à jour l’état de la base de données</span><span class="sxs-lookup"><span data-stu-id="cb47f-319">Get Create or Update Database Status</span></span>](/rest/api/sql/Databases/CreateOrUpdate) |<span data-ttu-id="cb47f-320">Retourne l’état durant une opération de création.</span><span class="sxs-lookup"><span data-stu-id="cb47f-320">Returns the status during a create operation.</span></span> |
| [<span data-ttu-id="cb47f-321">Définir la base de données secondaire comme principale (basculement planifié)</span><span class="sxs-lookup"><span data-stu-id="cb47f-321">Set Secondary Database as Primary (Planned Failover)</span></span>](https://docs.microsoft.com/rest/api/sql/replicationlinkss#ReplicationLinks_Failover) |<span data-ttu-id="cb47f-322">Définit la base de données réplica principale en basculant à partir de la base de données réplica principale actuelle.</span><span class="sxs-lookup"><span data-stu-id="cb47f-322">Sets which replica database is primary by failing over from the current primary replica database.</span></span> |
| [<span data-ttu-id="cb47f-323">Définir la base de données secondaire comme principale (basculement non planifié)</span><span class="sxs-lookup"><span data-stu-id="cb47f-323">Set Secondary Database as Primary (Unplanned Failover)</span></span>](https://docs.microsoft.com/rest/api/sql/replicationlinks#ReplicationLinks_FailoverAllowDataLoss) |<span data-ttu-id="cb47f-324">Définit la base de données réplica principale en basculant à partir de la base de données réplica principale actuelle.</span><span class="sxs-lookup"><span data-stu-id="cb47f-324">Sets which replica database is primary by failing over from the current primary replica database.</span></span> <span data-ttu-id="cb47f-325">Cette opération peut entraîner une perte de données.</span><span class="sxs-lookup"><span data-stu-id="cb47f-325">This operation might result in data loss.</span></span> |
| [<span data-ttu-id="cb47f-326">Obtenir un lien de réplication</span><span class="sxs-lookup"><span data-stu-id="cb47f-326">Get Replication Link</span></span>](/rest/api/sql/replicationlinks/get) |<span data-ttu-id="cb47f-327">Obtient un liens de réplication spécifique pour une base de données SQL particulière dans un partenariat de géo-réplication.</span><span class="sxs-lookup"><span data-stu-id="cb47f-327">Gets a specific replication link for a given SQL database in a geo-replication partnership.</span></span> <span data-ttu-id="cb47f-328">Récupère les informations visibles dans la vue de catalogue sys.geo_replication_links.</span><span class="sxs-lookup"><span data-stu-id="cb47f-328">It retrieves the information visible in the sys.geo_replication_links catalog view.</span></span> |
| [<span data-ttu-id="cb47f-329">Liens de réplication - Liste par base de données</span><span class="sxs-lookup"><span data-stu-id="cb47f-329">Replication Links - List By Database</span></span>](/rest/api/sql/replicationlinks/listbydatabase) | <span data-ttu-id="cb47f-330">Obtient tous les liens de réplication pour une base de données SQL donnée dans un partenariat de géo-réplication.</span><span class="sxs-lookup"><span data-stu-id="cb47f-330">Gets all replication links for a given SQL database in a geo-replication partnership.</span></span> <span data-ttu-id="cb47f-331">Récupère les informations visibles dans la vue de catalogue sys.geo_replication_links.</span><span class="sxs-lookup"><span data-stu-id="cb47f-331">It retrieves the information visible in the sys.geo_replication_links catalog view.</span></span> |
| [<span data-ttu-id="cb47f-332">Supprimer un lien de réplication</span><span class="sxs-lookup"><span data-stu-id="cb47f-332">Delete Replication Link</span></span>](/rest/api/sql/databases/delete) | <span data-ttu-id="cb47f-333">Supprime un lien de réplication de base de données.</span><span class="sxs-lookup"><span data-stu-id="cb47f-333">Deletes a database replication link.</span></span> <span data-ttu-id="cb47f-334">Opération impossible pendant le basculement.</span><span class="sxs-lookup"><span data-stu-id="cb47f-334">Cannot be done during failover.</span></span> |
| <span data-ttu-id="cb47f-335">[Créer ou mettre à jour un groupe de basculement]/rest/api/sql/failovergroups/createorupdate)</span><span class="sxs-lookup"><span data-stu-id="cb47f-335">[Create or Update Failover Group]/rest/api/sql/failovergroups/createorupdate)</span></span> | <span data-ttu-id="cb47f-336">Crée ou met à jour un groupe de basculement</span><span class="sxs-lookup"><span data-stu-id="cb47f-336">Creates or updates a failover group</span></span> |
| [<span data-ttu-id="cb47f-337">Supprimer un groupe de basculement</span><span class="sxs-lookup"><span data-stu-id="cb47f-337">Delete Failover Group</span></span>](/rest/api/sql/failovergroups/delete) | <span data-ttu-id="cb47f-338">Supprime un groupe de basculement du serveur</span><span class="sxs-lookup"><span data-stu-id="cb47f-338">Removes the failover group from the server</span></span> |
| [<span data-ttu-id="cb47f-339">Basculement (planifié)</span><span class="sxs-lookup"><span data-stu-id="cb47f-339">Failover (Planned)</span></span>](/rest/api/sql/failovergroups/failover) | <span data-ttu-id="cb47f-340">Bascule du serveur principal actuel vers ce serveur.</span><span class="sxs-lookup"><span data-stu-id="cb47f-340">Fails over from the current primary server to this server.</span></span> |
| [<span data-ttu-id="cb47f-341">Forcer le basculement et autoriser la perte de données</span><span class="sxs-lookup"><span data-stu-id="cb47f-341">Force Failover Allow Data Loss</span></span>](/rest/api/sql/failovergroups/forcefailoverallowdataloss) |<span data-ttu-id="cb47f-342">Bascule du serveur principal actuel vers ce serveur.</span><span class="sxs-lookup"><span data-stu-id="cb47f-342">ails over from the current primary server to this server.</span></span> <span data-ttu-id="cb47f-343">Cette opération peut entraîner une perte de données.</span><span class="sxs-lookup"><span data-stu-id="cb47f-343">This operation might result in data loss.</span></span> |
| <span data-ttu-id="cb47f-344">[Get Failover Group](/rest/api/sql/failovergroups/get) (Obtenir un groupe de basculement)</span><span class="sxs-lookup"><span data-stu-id="cb47f-344">[Get Failover Group](/rest/api/sql/failovergroups/get)</span></span> | <span data-ttu-id="cb47f-345">Obtient un groupe de basculement.</span><span class="sxs-lookup"><span data-stu-id="cb47f-345">Gets a failover group.</span></span> |
| [<span data-ttu-id="cb47f-346">Répertorier les groupes de basculement par serveur</span><span class="sxs-lookup"><span data-stu-id="cb47f-346">List Failover Groups By Server</span></span>](/rest/api/sql/failovergroups/listbyserver) | <span data-ttu-id="cb47f-347">Répertorie les groupes de basculement d’un serveur.</span><span class="sxs-lookup"><span data-stu-id="cb47f-347">Lists the failover groups in a server.</span></span> |
| [<span data-ttu-id="cb47f-348">Mettre à jour un groupe de basculement</span><span class="sxs-lookup"><span data-stu-id="cb47f-348">Update Failover Group</span></span>](/rest/api/sql/failovergroups/update) | <span data-ttu-id="cb47f-349">Met à jour un groupe de basculement.</span><span class="sxs-lookup"><span data-stu-id="cb47f-349">Updates a failover group.</span></span> |
|  | |

## <a name="next-steps"></a><span data-ttu-id="cb47f-350">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="cb47f-350">Next steps</span></span>
* <span data-ttu-id="cb47f-351">Pour obtenir des exemples de scripts, consultez :</span><span class="sxs-lookup"><span data-stu-id="cb47f-351">For sample scripts, see:</span></span>
   - [<span data-ttu-id="cb47f-352">Configurer et basculer une base de données unique à l’aide de la géoréplication active</span><span class="sxs-lookup"><span data-stu-id="cb47f-352">Configure and failover a single database using active geo-replication</span></span>](scripts/sql-database-setup-geodr-and-failover-database-powershell.md)
   - [<span data-ttu-id="cb47f-353">Configurer et basculer une base de données regroupée à l’aide de la géoréplication active</span><span class="sxs-lookup"><span data-stu-id="cb47f-353">Configure and failover a pooled database using active geo-replication</span></span>](scripts/sql-database-setup-geodr-and-failover-pool-powershell.md)
   - [<span data-ttu-id="cb47f-354">Configurer et basculer un groupe de basculement pour une base de données unique (préversion)</span><span class="sxs-lookup"><span data-stu-id="cb47f-354">Configure and failover a failover group for a single database (preview)</span></span>](scripts/sql-database-setup-geodr-failover-database-failover-group-powershell.md)
* <span data-ttu-id="cb47f-355">Pour une vue d’ensemble de la continuité des activités et des scénarios, consultez [Vue d’ensemble de la continuité des activités](sql-database-business-continuity.md)</span><span class="sxs-lookup"><span data-stu-id="cb47f-355">For a business continuity overview and scenarios, see [Business continuity overview](sql-database-business-continuity.md)</span></span>
* <span data-ttu-id="cb47f-356">Pour en savoir plus sur les sauvegardes automatisées Azure SQL Database, consultez [Sauvegardes automatisées d’une base de données SQL](sql-database-automated-backups.md).</span><span class="sxs-lookup"><span data-stu-id="cb47f-356">To learn about Azure SQL Database automated backups, see [SQL Database automated backups](sql-database-automated-backups.md).</span></span>
* <span data-ttu-id="cb47f-357">Pour en savoir plus sur l’utilisation des sauvegardes automatisées pour la récupération, consultez [Restaurer une base de données à partir des sauvegardes initiées par le service](sql-database-recovery-using-backups.md).</span><span class="sxs-lookup"><span data-stu-id="cb47f-357">To learn about using automated backups for recovery, see [Restore a database from the service-initiated backups](sql-database-recovery-using-backups.md).</span></span>
* <span data-ttu-id="cb47f-358">Pour en savoir plus sur les exigences d’authentification pour de nouveaux serveurs et bases de données primaires, consultez [Gestion de la sécurité de la base de données SQL Azure après la récupération d’urgence](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="cb47f-358">To learn about authentication requirements for a new primary server and database, see [SQL Database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>

