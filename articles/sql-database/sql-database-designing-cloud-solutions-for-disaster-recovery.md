---
title: "aaaDesign service hautement disponible à l’aide de la base de données SQL Azure | Documents Microsoft"
description: "Découvrez comment concevoir des applications pour des services hautement disponibles à l’aide d’Azure SQL Database."
keywords: "récupération d’urgence cloud, solutions de récupération d’urgence, sauvegarde de données d’application, géo-réplication, planification de la continuité des activités"
services: sql-database
documentationcenter: 
author: anosov1960
manager: jhubbard
editor: monicar
ms.assetid: e8a346ac-dd08-41e7-9685-46cebca04582
ms.service: sql-database
ms.custom: business continuity
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: data-management
ms.date: 04/21/2017
ms.author: sashan
ms.openlocfilehash: 815f754ba7014cd8a1108a2d84c2a8f71d7030a5
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="designing-highly-available-services-using-azure-sql-database"></a><span data-ttu-id="b2cd3-104">Conception de services hautement disponibles à l’aide d’Azure SQL Database</span><span class="sxs-lookup"><span data-stu-id="b2cd3-104">Designing highly available services using Azure SQL Database</span></span>

<span data-ttu-id="b2cd3-105">Pour créer et déployer des services hautement disponibles sur la base de données SQL Azure, vous utilisez [basculement géo-réplication active et les groupes](sql-database-geo-replication-overview.md) échecs de tooregional tooprovide résilience et les pannes catastrophiques et activer une récupération rapidement toohello des bases de données secondaires.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-105">When building and deploying highly available services on Azure SQL Database, you use [failover groups and active geo-replication](sql-database-geo-replication-overview.md) tooprovide resilience tooregional failures and catastrophic outages and enable fast recovery toohello secondary databases.</span></span> <span data-ttu-id="b2cd3-106">Cet article se concentre sur les modèles d’application courants et explique les avantages de hello et les compromis de chaque option selon les exigences de déploiement application hello, contrat de niveau de service hello vous ciblez, la latence du trafic et les coûts.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-106">This article focuses on common application patterns and discusses hello benefits and trade-offs of each option depending on hello application deployment requirements, hello service level agreement you are targeting, traffic latency, and costs.</span></span> <span data-ttu-id="b2cd3-107">Pour plus d’informations sur la géoréplication active avec des pools élastiques, voir [Stratégies de récupération d’urgence de pool élastique](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span><span class="sxs-lookup"><span data-stu-id="b2cd3-107">For information about active geo-replication with Elastic Pools, see [Elastic Pool disaster recovery strategies](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span></span>

## <a name="design-pattern-1-active-passive-deployment-for-cloud-disaster-recovery-with-a-co-located-database"></a><span data-ttu-id="b2cd3-108">Modèle de conception 1 : Déploiement actif/passif pour la récupération d’urgence cloud avec une base de données colocalisée</span><span class="sxs-lookup"><span data-stu-id="b2cd3-108">Design pattern 1: Active-passive deployment for cloud disaster recovery with a co-located database</span></span>
<span data-ttu-id="b2cd3-109">Cette option est idéale pour les applications avec hello suivant caractéristiques :</span><span class="sxs-lookup"><span data-stu-id="b2cd3-109">This option is best suited for applications with hello following characteristics:</span></span>

* <span data-ttu-id="b2cd3-110">Instance active dans une seule région Azure</span><span class="sxs-lookup"><span data-stu-id="b2cd3-110">Active instance in a single Azure region</span></span>
* <span data-ttu-id="b2cd3-111">Forte dépendance sur toodata d’accès en lecture-écriture (RW)</span><span class="sxs-lookup"><span data-stu-id="b2cd3-111">Strong dependency on read-write (RW) access toodata</span></span>
* <span data-ttu-id="b2cd3-112">Connectivité entre régions entre l’application web hello et de la base de données hello n’est pas acceptable en raison du coût toolatency et le trafic</span><span class="sxs-lookup"><span data-stu-id="b2cd3-112">Cross-region connectivity between hello web application and hello database is not acceptable due toolatency and traffic cost</span></span>    

<span data-ttu-id="b2cd3-113">Dans ce cas, topologie de déploiement d’application hello est optimisée pour la gestion des sinistres régionales lorsque tous les composants d’application sont affectés et doivent toofailover en tant qu’unité.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-113">In this case, hello application deployment topology is optimized for handling regional disasters when all application components are impacted and need toofailover as a unit.</span></span> <span data-ttu-id="b2cd3-114">Pour assurer la redondance géographique, logique de l’application hello et la base de données hello sont répliquées tooanother région, mais elles ne sont utilisées pour la charge de travail application hello dans des conditions normales hello.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-114">For geographic redundancy, hello application logic and hello database are replicated tooanother region but they are not used for hello application workload under hello normal conditions.</span></span> <span data-ttu-id="b2cd3-115">application Hello dans la région secondaire hello doit être configuré toouse SQL connexion chaîne toohello base de données secondaire.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-115">hello application in hello secondary region should be configured toouse a SQL connection string toohello secondary database.</span></span> <span data-ttu-id="b2cd3-116">Gestionnaire de trafic est configuré toouse [méthode de routage de basculement](../traffic-manager/traffic-manager-configure-failover-routing-method.md).</span><span class="sxs-lookup"><span data-stu-id="b2cd3-116">Traffic manager is set up toouse [failover routing method](../traffic-manager/traffic-manager-configure-failover-routing-method.md).</span></span>  

> [!NOTE]
> <span data-ttu-id="b2cd3-117">[Azure Traffic Manager](../traffic-manager/traffic-manager-overview.md) est utilisé dans cet article aux fins d’illustration uniquement.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-117">[Azure traffic manager](../traffic-manager/traffic-manager-overview.md) is used throughout this article for illustration purposes only.</span></span> <span data-ttu-id="b2cd3-118">Vous pouvez utiliser toute solution d’équilibrage de charge qui prend en charge la méthode de routage du trafic par basculement.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-118">You can use any load-balancing solution that supports failover routing method.</span></span>    
>

<span data-ttu-id="b2cd3-119">Hello suivant le diagramme illustre cette configuration avant la panne.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-119">hello following diagram shows this configuration before an outage.</span></span>

![Configuration de la géoréplication de SQL Database.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern1-1.png)

<span data-ttu-id="b2cd3-122">Après une panne dans la région principale de hello, service de base de données SQL hello détecte cette base de données primaire hello n’est pas accessible et déclencher un basculement toohello base de données secondaire basé sur les paramètres de stratégie de basculement automatique hello hello.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-122">After an outage in hello primary region, hello SQL Database service detects that hello primary database is not accessible and trigger a failover toohello secondary database based on hello parameters of hello automatic failover policy.</span></span> <span data-ttu-id="b2cd3-123">Selon le contrat SLA de votre application, vous pouvez décider tooconfigure une période de grâce entre la détection de panne de hello hello et basculement hello lui-même.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-123">Depending on your application SLA, you can decide tooconfigure a grace period between hello detection of hello outage and hello failover itself.</span></span> <span data-ttu-id="b2cd3-124">Configuration d’une période de grâce de réduit le risque de hello de cas de toohello perte données où la panne de hello est grave et la disponibilité dans la région de hello ne peut pas être restaurée rapidement.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-124">Configuring a grace period reduces hello risk of data loss toohello cases where hello outage is catastrophic and availability in hello region cannot be quickly restored.</span></span> <span data-ttu-id="b2cd3-125">Si le basculement de point de terminaison hello est initiée par le Gestionnaire de trafic hello avant que les déclencheurs de groupe de basculement hello hello basculement de base de données hello, application hello n’est pas en mesure de tooreconnect toohello base de données.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-125">If hello endpoint failover is initiated by hello traffic manager before hello failover group triggers hello failover of hello database, hello web application is not able tooreconnect toohello database.</span></span> <span data-ttu-id="b2cd3-126">tooreconnect de tentative de l’application Hello réussit automatiquement dès que le basculement de base de données hello est terminé.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-126">hello application’s attempt tooreconnect automatically succeeds as soon as hello database failover completes.</span></span> 

> [!NOTE]
> <span data-ttu-id="b2cd3-127">tooachieve coordonnée entièrement le basculement d’application hello et bases de données hello, vous devez concevoir votre propre méthode d’analyse et utiliser le basculement manuel de terminaison d’application web hello et bases de données hello.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-127">tooachieve fully coordinated failover of hello application and hello databases, you should devise your own monitoring method and use manual failover of hello web application endpoints and hello databases.</span></span>
>

<span data-ttu-id="b2cd3-128">Après basculement hello de l’application hello points de terminaison et de la base de données hello, application hello redémarre le traitement des demandes d’utilisateur hello dans la région de hello B et restera colocalisée avec la base de données hello, car la base de données primaire hello est désormais dans région B. Ce scénario est illustré dans hello suivant schéma.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-128">After hello failover of both hello application’s endpoints and hello database completes, hello application will re-start processing hello user requests in hello region B and will remain co-located with hello database because hello primary database is now in region B. This scenario is illustrated in hello following diagram.</span></span> <span data-ttu-id="b2cd3-129">Dans tous les diagrammes, des lignes pleines indiquent les connexions actives, des lignes en pointillé indiquent les connexions suspendues et les symboles « stop » indiquent les déclencheurs d’action.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-129">In all diagrams, solid lines indicate active connections, dotted lines indicate suspended connections, and stop signs indicate action triggers.</span></span>

![Géo-réplication : Base de données basculement toosecondary.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern1-2.png)

<span data-ttu-id="b2cd3-132">Si une panne se produit dans la région secondaire hello, hello le lien de réplication entre hello principal et de la base de données secondaire hello est suspendu mais hello basculement n’est pas déclenché, car la base de données primaire hello n’est pas affectée.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-132">If an outage happens in hello secondary region, hello replication link between hello primary and hello secondary database is suspended but hello failover is not triggered because hello primary database is not impacted.</span></span> <span data-ttu-id="b2cd3-133">disponibilité de l’application Hello n’est pas modifiée dans ce cas, mais application hello fonctionne exposé, et par conséquent à des risques plus élevés dans les cas les deux régions échouent à la suite.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-133">hello application's availability is not changed in this case, but hello application operates exposed and therefore at higher risk in case both regions fail in succession.</span></span>

> [!NOTE]
> <span data-ttu-id="b2cd3-134">Récupération d’urgence, nous vous recommandons de configuration hello avec application déploiement limité tootwo régions.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-134">For disaster recovery we recommend hello configuration with application deployment limited tootwo regions.</span></span> <span data-ttu-id="b2cd3-135">C’est parce que la plupart des Hello géographiques Azure ont uniquement deux régions.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-135">This is because most of hello Azure geographies have only two regions.</span></span> <span data-ttu-id="b2cd3-136">Cette configuration ne protège pas votre application d’une défaillance irrémédiable simultanée des deux régions.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-136">This configuration will not protect your application from a simultaneous catastrophic failure of both regions.</span></span>  <span data-ttu-id="b2cd3-137">Dans le cas peu probable d’une telle défaillance, vous pouvez restaurer vos bases de données dans une région tierce à l’aide de [l’opération de géo-restauration](sql-database-disaster-recovery.md#recover-using-geo-restore).</span><span class="sxs-lookup"><span data-stu-id="b2cd3-137">In an unlikely event of such a failure, you can recover your databases in a third region using [geo-restore operation](sql-database-disaster-recovery.md#recover-using-geo-restore).</span></span>
>

<span data-ttu-id="b2cd3-138">Une fois la panne de hello est atténuée, base de données secondaire hello RE-synchronise automatiquement avec hello principal.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-138">Once hello outage is mitigated, hello secondary database will automatically re-synchronize with hello primary.</span></span> <span data-ttu-id="b2cd3-139">Pendant la synchronisation, performances de hello principal pourraient être affectées légèrement en fonction du montant hello de données qui doivent toobe synchronisé.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-139">During synchronization, performance of hello primary could be slightly impacted depending on hello amount of data that needs toobe synchronized.</span></span> <span data-ttu-id="b2cd3-140">Hello diagramme suivant illustre une panne dans la région secondaire hello.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-140">hello following diagram illustrates an outage in hello secondary region.</span></span>

![Synchronisation de la base de données secondaire avec la base de données primaire.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern1-3.png)

<span data-ttu-id="b2cd3-143">clé de Hello **avantages** de ce modèle de conception sont :</span><span class="sxs-lookup"><span data-stu-id="b2cd3-143">hello key **advantages** of this design pattern are:</span></span>

* <span data-ttu-id="b2cd3-144">Bonjour même application web est régions tooboth déployé sans aucune configuration spécifique à la région et aucun basculement ne toohello tooreact une logique supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-144">hello same web application is deployed tooboth regions without any region-specific configuration and no additional logic tooreact toohello failover.</span></span> 
* <span data-ttu-id="b2cd3-145">performances de l’application Hello ne sont pas affecté par le basculement en tant qu’application web de hello et base de données hello sont toujours colocalisés.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-145">hello application's performance is not impacted by failover as hello web application and hello database are always co-located.</span></span>

<span data-ttu-id="b2cd3-146">Hello principal **compromis** qui est l’application redondant hello instance dans la région secondaire hello est uniquement utilisée pour la récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-146">hello main **tradeoff** is that hello redundant application instance in hello secondary region is only used for disaster recovery.</span></span>

## <a name="design-pattern-2-active-active-deployment-for-application-load-balancing"></a><span data-ttu-id="b2cd3-147">Modèle de conception 2 : Déploiement actif / actif pour l’équilibrage de charge d’applications</span><span class="sxs-lookup"><span data-stu-id="b2cd3-147">Design pattern 2: Active-active deployment for application load balancing</span></span>
<span data-ttu-id="b2cd3-148">Cette option de récupération d’urgence cloud est idéale pour les applications avec hello suivant caractéristiques :</span><span class="sxs-lookup"><span data-stu-id="b2cd3-148">This cloud disaster recovery option is best suited for applications with hello following characteristics:</span></span>

* <span data-ttu-id="b2cd3-149">Taux élevé de base de données lit toowrites</span><span class="sxs-lookup"><span data-stu-id="b2cd3-149">High ratio of database reads toowrites</span></span>
* <span data-ttu-id="b2cd3-150">Base de données de latence de lecture est plus importante pour l’utilisateur final hello que la latence d’écriture hello</span><span class="sxs-lookup"><span data-stu-id="b2cd3-150">Database read latency is more critical for hello end-user experience than hello write latency</span></span> 
* <span data-ttu-id="b2cd3-151">La logique de lecture seule peut être séparée de la logique de lecture-écriture à l’aide d’une chaîne de connexion différente.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-151">Read-only logic can be separated from read-write logic by using a different connection string</span></span>
* <span data-ttu-id="b2cd3-152">Logique en lecture seule ne dépend pas de données qui est entièrement synchronisées avec les dernières mises à jour de hello</span><span class="sxs-lookup"><span data-stu-id="b2cd3-152">Read-only logic does not depend on data being fully synchronized with hello latest updates</span></span>  

<span data-ttu-id="b2cd3-153">Si vos applications ont ces caractéristiques, équilibrage de charge les connexions de l’utilisateur final hello sur plusieurs instances d’application dans différentes régions peut améliorer considérablement hello expérience utilisateur globale.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-153">If your applications have these characteristics, load balancing hello end-user connections across multiple application instances in different regions can substantially improve hello overall end-user experience.</span></span> <span data-ttu-id="b2cd3-154">Deux des régions de hello doit être sélectionné en tant que paire de récupération d’urgence de hello et groupe de basculement hello doit inclure des bases de données hello dans ces régions.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-154">Two of hello regions should be selected as hello DR pair and hello failover group should include hello databases in these regions.</span></span> <span data-ttu-id="b2cd3-155">tooimplement équilibrage de charge, chaque région doit avoir une instance active de l’application hello avec hello en lecture-écriture (RW) logique connectée toohello en lecture-écriture écouteur point de terminaison du groupe de basculement hello.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-155">tooimplement load-balancing, each region should have an active instance of hello application with hello read-write (RW) logic connected toohello read-write listener endpoint of hello failover group.</span></span> <span data-ttu-id="b2cd3-156">Il garantit que le basculement hello va être lancé automatiquement si la base de données primaire hello est affectée par une panne.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-156">It will guarantee that hello failover will be automatically initiated if hello primary database is impacted by an outage.</span></span> <span data-ttu-id="b2cd3-157">Hello en lecture seule logique (RO) dans l’application web de hello doit se connecter directement de la base de données toohello dans cette région.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-157">hello read-only logic (RO) in hello web application should connect directly toohello database in that region.</span></span> <span data-ttu-id="b2cd3-158">Traffic manager doit être défini toouse [performances routage](../traffic-manager/traffic-manager-configure-performance-routing-method.md) avec [surveillance de point de terminaison](../traffic-manager/traffic-manager-monitoring.md) activé pour chaque instance d’application.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-158">Traffic manager should be set up toouse [performance routing](../traffic-manager/traffic-manager-configure-performance-routing-method.md) with [end-point monitoring](../traffic-manager/traffic-manager-monitoring.md) enabled for each application instance.</span></span>

<span data-ttu-id="b2cd3-159">Comme dans le modèle 1, vous devez envisager le déploiement d’une application de surveillance similaire.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-159">As in pattern #1, you should consider deploying a similar monitoring application.</span></span> <span data-ttu-id="b2cd3-160">Mais contrairement au modèle #1, hello analyse de l’application ne sera pas chargé de déclencher le basculement de point de terminaison hello.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-160">But unlike pattern #1, hello monitoring application will not be responsible for triggering hello end-point failover.</span></span>

> [!NOTE]
> <span data-ttu-id="b2cd3-161">Bien que ce modèle utilise plusieurs bases de données secondaires, uniquement les hello secondaire dans la région B serait utilisée pour le basculement et doit faire partie du groupe de basculement hello.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-161">While this pattern uses more than one secondary database, only hello secondary in Region B  would be used for failover and should be part of hello failover group.</span></span>
>

<span data-ttu-id="b2cd3-162">Gestionnaire de trafic doit être configuré pour l’emplacement géographique de performances routage toodirect hello connexions toohello application instance le plus proche toohello utilisateur.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-162">Traffic manager should be configured for performance routing toodirect hello user connections toohello application instance closest toohello user's geographic location.</span></span> <span data-ttu-id="b2cd3-163">Hello suivant le diagramme illustre cette configuration avant la panne.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-163">hello following diagram illustrates this configuration before an outage.</span></span>

![Aucune panne : application toonearest routage de performances.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern2-1.png)

<span data-ttu-id="b2cd3-166">Si une panne de la base de données est détectée dans la région de hello A, groupe de basculement hello lance automatiquement le basculement de la base de données primaire hello dans la région A toohello secondaire dans la région B. Il met automatiquement à jour tooregion de point de terminaison en lecture-écriture écouteur hello B pour les connexions en lecture-écriture dans l’application web de hello ne seront pas affectées.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-166">If a database outage is detected in hello region A, hello failover group will automatically initiate failover of hello primary database in region A toohello secondary in region B. It will also automatically update hello read-write listener endpoint tooregion B so read-write connections in hello web application will not be impacted.</span></span> <span data-ttu-id="b2cd3-167">Gestionnaire de trafic Hello exclura point d’arrêt hello hors connexion à partir de la table de routage hello mais continue de routage hello par l’utilisateur le trafic toohello restantes des instances en ligne.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-167">hello traffic manager will exclude hello offline end-point from hello routing table but will continue routing hello end-user traffic toohello remaining online instances.</span></span> <span data-ttu-id="b2cd3-168">Hello en lecture seule des chaînes de connexion SQL ne sont pas affectés car elles pointent toujours de la base de données toohello Bonjour même région.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-168">hello read-only SQL connection strings will not be impacted as they always point toohello database in hello same region.</span></span> 

<span data-ttu-id="b2cd3-169">Hello suivant schéma illustre la nouvelle configuration de hello après le basculement de hello.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-169">hello following diagram illustrates hello new configuration after hello failover.</span></span>

![Configuration après le basculement.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern2-2.png)

<span data-ttu-id="b2cd3-172">En cas de panne de l’une des zones secondaires de hello, Gestionnaire de trafic hello supprimera automatiquement point de terminaison hors connexion hello dans cette région à partir de la table de routage hello.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-172">In case of an outage in one of hello secondary regions, hello traffic manager will automatically remove hello offline end-point in that region from hello routing table.</span></span> <span data-ttu-id="b2cd3-173">Hello réplication canal toohello base de données secondaire dans cette région sera interrompu.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-173">hello replication channel toohello secondary database in that region will be suspended.</span></span> <span data-ttu-id="b2cd3-174">Étant donné que les autres zones de hello obtenir le trafic des utilisateurs supplémentaires dans ce scénario, les performances de l’application hello seront affectés pendant une panne de hello.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-174">Because hello remaining regions get additional user traffic in this scenario, hello application's performance will be impacted during hello outage.</span></span> <span data-ttu-id="b2cd3-175">Une fois la panne de hello est atténuée, hello une base de données secondaire dans la région concernée hello est immédiatement synchronisé avec hello principal.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-175">Once hello outage is mitigated, hello secondary database in hello impacted region will be immediately synchronized with hello primary.</span></span> <span data-ttu-id="b2cd3-176">Au cours de hello des performances de synchronisation de hello principal pourraient être affectées légèrement en fonction du montant hello de données qui doivent toobe synchronisé.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-176">During hello synchronization performance of hello primary could be slightly impacted depending on hello amount of data that needs toobe synchronized.</span></span> <span data-ttu-id="b2cd3-177">Hello suivant schéma illustre une panne dans la région B.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-177">hello following diagram illustrates an outage in region B.</span></span>

![Panne dans une région secondaire.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern2-3.png)

<span data-ttu-id="b2cd3-180">clé de Hello **parti** de cette conception de modèle est que vous pouvez faire évoluer la charge de travail application hello entre les performances optimales de l’utilisateur final de plusieurs bases de données secondaires tooachieve hello.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-180">hello key **advantage** of this design pattern is that you can scale hello application workload across multiple secondaries tooachieve hello optimal end-user performance.</span></span> <span data-ttu-id="b2cd3-181">Hello **compromis** de cette option sont :</span><span class="sxs-lookup"><span data-stu-id="b2cd3-181">hello **tradeoffs** of this option are:</span></span>

* <span data-ttu-id="b2cd3-182">Connexions en lecture-écriture entre les instances de l’application hello et la base de données ont différentes de latence et de coût</span><span class="sxs-lookup"><span data-stu-id="b2cd3-182">Read-write connections between hello application instances and database have varying latency and cost</span></span>
* <span data-ttu-id="b2cd3-183">Panne de hello sont affecte les performances de l’application</span><span class="sxs-lookup"><span data-stu-id="b2cd3-183">Application performance is impacted during hello outage</span></span>

> [!NOTE]
> <span data-ttu-id="b2cd3-184">Une approche similaire peut être utilisée toooffload spécialisé des charges de travail tels que reporting des travaux, les outils d’analyse décisionnelle ou les sauvegardes.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-184">A similar approach can be used toooffload specialized workloads such as reporting jobs, business intelligence tools, or backups.</span></span> <span data-ttu-id="b2cd3-185">En règle générale, ces charges de travail consomment des ressources de base de données importantes par conséquent, il est recommandé de désigner un des hello bases de données secondaires pour les hello performances toohello correspondant au niveau anticipé la charge de travail.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-185">Typically, these workloads consume significant database resources therefore it is recommended that you designate one of hello secondary databases for them with hello performance level matched toohello anticipated workload.</span></span>
>

## <a name="design-pattern-3-active-passive-deployment-for-data-preservation"></a><span data-ttu-id="b2cd3-186">Modèle de conception 3 : Déploiement actif / passif pour la conservation des données</span><span class="sxs-lookup"><span data-stu-id="b2cd3-186">Design pattern 3: Active-passive deployment for data preservation</span></span>
<span data-ttu-id="b2cd3-187">Cette option est idéale pour les applications avec hello suivant caractéristiques :</span><span class="sxs-lookup"><span data-stu-id="b2cd3-187">This option is best suited for applications with hello following characteristics:</span></span>

* <span data-ttu-id="b2cd3-188">Toute perte de données constitue un risque élevé pour l’entreprise.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-188">Any data loss is high business risk.</span></span> <span data-ttu-id="b2cd3-189">basculement de base de données Hello utilisable uniquement en dernier recours si une panne de hello est grave.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-189">hello database failover can only be used as a last resort if hello outage is catastrophic.</span></span>
* <span data-ttu-id="b2cd3-190">application Hello prend en charge les modes lecture seule et en lecture-écriture d’opérations et peut fonctionner en « mode en lecture seule » pendant une période de temps.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-190">hello application supports read-only and read-write modes of operations and can operate in "read-only mode" for a period of time.</span></span>

<span data-ttu-id="b2cd3-191">Dans ce modèle, application hello bascule en mode tooread uniquement lorsque les connexions en lecture-écriture hello commencent à recevoir des erreurs de délai d’attente.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-191">In this pattern, hello application switches tooread-only mode when hello read-write connections start getting time-out errors.</span></span> <span data-ttu-id="b2cd3-192">Hello Application Web est déployée tooboth régions et inclure un point de terminaison de connexion toohello en lecture-écriture écouteur et le point de terminaison de connexion différentes toohello écouteur en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-192">hello Web Application is deployed tooboth regions and include a connection toohello read-write listener endpoint and different connection toohello read-only listener endpoint.</span></span> <span data-ttu-id="b2cd3-193">Hello Traffic manager doit être défini toouse [basculement routage](../traffic-manager/traffic-manager-configure-failover-routing-method.md) avec [surveillance de point de terminaison](../traffic-manager/traffic-manager-monitoring.md) activée pour le point de terminaison application hello dans chaque région.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-193">hello Traffic manager should be set up toouse [failover routing](../traffic-manager/traffic-manager-configure-failover-routing-method.md) with [end-point monitoring](../traffic-manager/traffic-manager-monitoring.md) enabled for hello application endpoint in each region.</span></span>

<span data-ttu-id="b2cd3-194">Hello suivant le diagramme illustre cette configuration avant la panne.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-194">hello following diagram illustrates this configuration before an outage.</span></span>

![Déploiement actif/passif avant le basculement.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern3-1.png)

<span data-ttu-id="b2cd3-197">Lorsque hello traffic manager détecte une tooregion Échec de connectivité A, il bascule automatiquement instance application toohello du trafic utilisateur dans la région B. Avec ce modèle, il est important que vous définissiez période de grâce de hello avec une valeur suffisamment élevée des données perte tooa, par exemple, 24 heures.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-197">When hello traffic manager detects a connectivity failure tooregion A, it automatically switches user traffic toohello application instance in region B. With this pattern, it is important that you set hello grace period with data loss tooa sufficiently high value, e.g. 24 hours.</span></span> <span data-ttu-id="b2cd3-198">Elle ne garantit pas que la perte de données est bloquée si la panne de hello est atténuée dans ce délai.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-198">It will ensure that data loss is prevented if hello outage is mitigated within that time.</span></span> <span data-ttu-id="b2cd3-199">Lorsque hello application Web dans la région de hello B est activé les opérations de lecture-écriture hello mettent à échouer.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-199">When hello Web application in hello region B is activated hello read-write operations will start failing.</span></span> <span data-ttu-id="b2cd3-200">À ce stade, il doit basculer toohello en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-200">At that point, it should switch toohello read-only mode.</span></span> <span data-ttu-id="b2cd3-201">Bonjour de ce mode, les requêtes seront toohello automatiquement vers la base de données secondaire.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-201">In this mode hello requests will be automatically routed toohello secondary database.</span></span> <span data-ttu-id="b2cd3-202">Dans les cas de hello d’un Bonjour défaillance grave panne n’est pas réduit au sein de la période de grâce de hello et groupe de basculement hello déclenchera hello basculement.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-202">In hello case of a catastrophic failure hello outage will not be mitigated within hello grace period and hello failover group will trigger hello failover.</span></span> <span data-ttu-id="b2cd3-203">Après cette hello en lecture-écriture écouteur devient disponible et hello appels tooit arrête échouent.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-203">After that hello read-write listener will become available and hello calls tooit will stop failing.</span></span> <span data-ttu-id="b2cd3-204">Cela est illustré par hello suivant schéma.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-204">This is illustrated by hello following diagram.</span></span>

![Panne : l’application en mode lecture seule.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern3-2.png)

<span data-ttu-id="b2cd3-207">Si la panne hello dans la région principale de hello est atténuée au sein de la période de grâce de hello, traffic manager détecte restauration hello de connectivité dans la région principale de hello et bascule l’instance d’application utilisateur trafic toohello précédent dans la région A. Cette instance de l’application reprend et qu’il fonctionne en mode lecture-écriture à l’aide de la base de données primaire hello dans la région A.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-207">If hello outage in hello primary region is mitigated within hello grace period, traffic manager detects hello restoration of connectivity in hello primary region and switches user traffic back toohello application instance in region A. That application instance resumes and operates in read-write mode using hello primary database in region A.</span></span>

<span data-ttu-id="b2cd3-208">En cas de panne dans la région de hello B, hello traffic manager détecte les échec hello de point de terminaison application hello dans la région B et hello basculement groupe commutateurs hello écouteur en lecture seule tooregion A. Cette panne n’affecte pas l’utilisateur final hello mais la base de données primaire hello sera exposé panne hello.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-208">In case of an outage in hello region B, hello traffic manager detects hello failure of hello application end-point in region B and hello failover group switches hello read-only listener tooregion A. This outage does not impact hello end-user experience but hello primary database will be exposed during hello outage.</span></span> <span data-ttu-id="b2cd3-209">Cela est illustré par hello suivant schéma.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-209">This is illustrated by hello following diagram.</span></span>

![Panne : base de données secondaire.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern3-3.png)

<span data-ttu-id="b2cd3-212">Une fois la panne de hello est atténuée, hello base de données secondaire est immédiatement synchronisé avec hello principal et écouteur en lecture seule de hello est commuté toohello précédent la base de données secondaire dans la région B. Lors de la synchronisation de hello principal peut légèrement affecte les performances en fonction du montant hello de données qui doivent toobe synchronisé.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-212">Once hello outage is mitigated, hello secondary database is immediately synchronized with hello primary and hello read-only listener is switched back toohello secondary database in region B. During synchronization performance of hello primary could be slightly impacted depending on hello amount of data that needs toobe synchronized.</span></span>

<span data-ttu-id="b2cd3-213">Ce modèle de conception offre plusieurs **avantages**:</span><span class="sxs-lookup"><span data-stu-id="b2cd3-213">This design pattern has several **advantages**:</span></span>

* <span data-ttu-id="b2cd3-214">Elle évite la perte de données pendant les pannes temporaires hello.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-214">It avoids data loss during hello temporary outages.</span></span>
* <span data-ttu-id="b2cd3-215">Temps d’arrêt dépend uniquement la rapidité avec laquelle traffic manager détecte la panne de connectivité hello, qui est configurable.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-215">Downtime depends only on how quickly traffic manager detects hello connectivity failure, which is configurable.</span></span>

<span data-ttu-id="b2cd3-216">Hello **compromis** est :</span><span class="sxs-lookup"><span data-stu-id="b2cd3-216">hello **tradeoff** is:</span></span>

* <span data-ttu-id="b2cd3-217">Application doit être en mesure de toooperate en mode lecture seule.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-217">Application must be able toooperate in read-only mode.</span></span>

> [!NOTE]
> <span data-ttu-id="b2cd3-218">En cas de panne de service permanente dans la région de hello, vous manuellement activez le basculement de la base de données et acceptez la perte de données hello.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-218">In case of a permanent service outage in hello region, you manually activate database failover and accept hello data loss.</span></span> <span data-ttu-id="b2cd3-219">application Hello seront fonctionnelle dans la région secondaire hello avec la base de données toohello accès en lecture-écriture.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-219">hello application will be functional in hello secondary region with read-write access toohello database.</span></span>
>

## <a name="business-continuity-planning-choose-an-application-design-for-cloud-disaster-recovery"></a><span data-ttu-id="b2cd3-220">Planification de la continuité des activités : choisir une conception d’application pour la récupération d’urgence cloud</span><span class="sxs-lookup"><span data-stu-id="b2cd3-220">Business continuity planning: Choose an application design for cloud disaster recovery</span></span>
<span data-ttu-id="b2cd3-221">Votre stratégie de récupération d’urgence cloud spécifique peut combiner ou étendre ces modèles de conception toobest les besoins de hello satisfait de votre application.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-221">Your specific cloud disaster recovery strategy can combine or extend these design patterns toobest meet hello needs of your application.</span></span>  <span data-ttu-id="b2cd3-222">Comme indiqué précédemment, les choix de la stratégie hello est basée sur hello SLA vous souhaiter que les clients de tooyour toooffer et hello topologie de déploiement d’application.</span><span class="sxs-lookup"><span data-stu-id="b2cd3-222">As mentioned earlier, hello strategy you choose is based on hello SLA you want toooffer tooyour customers and hello application deployment topology.</span></span> <span data-ttu-id="b2cd3-223">toohelp guider votre décision, hello tableau suivant compare les choix de hello en fonction de hello données estimée perte ou récupération objectif de point (RPO) et le temps de récupération estimé (ERT).</span><span class="sxs-lookup"><span data-stu-id="b2cd3-223">toohelp guide your decision, hello following table compares hello choices based on hello estimated data loss or recovery point objective (RPO) and estimated recovery time (ERT).</span></span>

| <span data-ttu-id="b2cd3-224">Modèle</span><span class="sxs-lookup"><span data-stu-id="b2cd3-224">Pattern</span></span> | <span data-ttu-id="b2cd3-225">RPO</span><span class="sxs-lookup"><span data-stu-id="b2cd3-225">RPO</span></span> | <span data-ttu-id="b2cd3-226">ERT</span><span class="sxs-lookup"><span data-stu-id="b2cd3-226">ERT</span></span> |
|:--- |:--- |:--- |
| <span data-ttu-id="b2cd3-227">Déploiement actif / passif pour la récupération d’urgence avec accès à la base de données colocalisée</span><span class="sxs-lookup"><span data-stu-id="b2cd3-227">Active-passive deployment for disaster recovery with co-located database access</span></span> |<span data-ttu-id="b2cd3-228">Accès en lecture-écriture < 5 s</span><span class="sxs-lookup"><span data-stu-id="b2cd3-228">Read-write access < 5 sec</span></span> |<span data-ttu-id="b2cd3-229">Temps de détection des défaillances + TTL du DNS</span><span class="sxs-lookup"><span data-stu-id="b2cd3-229">Failure detection time + DNS TTL</span></span> |
| <span data-ttu-id="b2cd3-230">Déploiement actif / actif pour l’équilibrage de charge d’applications</span><span class="sxs-lookup"><span data-stu-id="b2cd3-230">Active-active deployment for application load balancing</span></span> |<span data-ttu-id="b2cd3-231">Accès en lecture-écriture < 5 s</span><span class="sxs-lookup"><span data-stu-id="b2cd3-231">Read-write access < 5 sec</span></span> |<span data-ttu-id="b2cd3-232">Temps de détection des défaillances + TTL du DNS</span><span class="sxs-lookup"><span data-stu-id="b2cd3-232">Failure detection time + DNS TTL</span></span> |
| <span data-ttu-id="b2cd3-233">Déploiement actif / passif pour la conservation des données</span><span class="sxs-lookup"><span data-stu-id="b2cd3-233">Active-passive deployment for data preservation</span></span> |<span data-ttu-id="b2cd3-234">Accès en lecture seule < 5 s</span><span class="sxs-lookup"><span data-stu-id="b2cd3-234">Read-only access < 5 sec</span></span> | <span data-ttu-id="b2cd3-235">Accès en lecture seule = 0</span><span class="sxs-lookup"><span data-stu-id="b2cd3-235">Read-only access = 0</span></span> |
||<span data-ttu-id="b2cd3-236">Accès en lecture-écriture = 0</span><span class="sxs-lookup"><span data-stu-id="b2cd3-236">Read-write access = zero</span></span> | <span data-ttu-id="b2cd3-237">Accès en lecture-écriture = temps de détection de défaillances + période de grâce en cas de risque de perte de données</span><span class="sxs-lookup"><span data-stu-id="b2cd3-237">Read-write access = Failure detection time + grace period with data loss</span></span> |
|||

## <a name="next-steps"></a><span data-ttu-id="b2cd3-238">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="b2cd3-238">Next steps</span></span>
* <span data-ttu-id="b2cd3-239">toolearn sur les sauvegardes de base de données SQL Azure automatisée, consultez [sauvegardes automatisées de base de données SQL](sql-database-automated-backups.md)</span><span class="sxs-lookup"><span data-stu-id="b2cd3-239">toolearn about Azure SQL Database automated backups, see [SQL Database automated backups](sql-database-automated-backups.md)</span></span>
* <span data-ttu-id="b2cd3-240">Pour une vue d’ensemble de la continuité des activités et des scénarios, consultez [Vue d’ensemble de la continuité des activités](sql-database-business-continuity.md)</span><span class="sxs-lookup"><span data-stu-id="b2cd3-240">For a business continuity overview and scenarios, see [Business continuity overview](sql-database-business-continuity.md)</span></span>
* <span data-ttu-id="b2cd3-241">toolearn sur l’utilisation des sauvegardes automatisées pour la récupération, consultez [restaurer une base de données à partir de sauvegardes de hello initiées par le service](sql-database-recovery-using-backups.md)</span><span class="sxs-lookup"><span data-stu-id="b2cd3-241">toolearn about using automated backups for recovery, see [restore a database from hello service-initiated backups](sql-database-recovery-using-backups.md)</span></span>
* <span data-ttu-id="b2cd3-242">toolearn sur les options de récupération plus rapides, consultez [géo-réplication active](sql-database-geo-replication-overview.md)</span><span class="sxs-lookup"><span data-stu-id="b2cd3-242">toolearn about faster recovery options, see [active geo-replication](sql-database-geo-replication-overview.md)</span></span>  
* <span data-ttu-id="b2cd3-243">toolearn sur l’utilisation des sauvegardes automatisées pour l’archivage, consultez [copie de base de données](sql-database-copy.md)</span><span class="sxs-lookup"><span data-stu-id="b2cd3-243">toolearn about using automated backups for archiving, see [database copy](sql-database-copy.md)</span></span>
* <span data-ttu-id="b2cd3-244">Pour plus d’informations sur la géoréplication active avec des pools élastiques, voir [Stratégies de récupération d’urgence de pool élastique](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span><span class="sxs-lookup"><span data-stu-id="b2cd3-244">For information about active geo-replication with Elastic Pools, see [Elastic Pool disaster recovery strategies](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span></span>
