---
title: "performances aaaMonitor de nombreuses bases de données SQL Azure dans une application de SaaS mutualisée | Documents Microsoft"
description: "Surveiller et gérer les performances des bases de données et les pools d’application d’Azure SQL de base de données Wingtip SaaS hello"
keywords: "didacticiel sur les bases de données SQL"
services: sql-database
documentationcenter: 
author: stevestein
manager: craigg
editor: 
ms.assetid: 
ms.service: sql-database
ms.custom: scale out apps
ms.workload: data-management
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/26/2017
ms.author: sstein
ms.openlocfilehash: f0d7ba456c485b7de249a56abac3cf4be3857285
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="monitor-performance-of-hello-wingtip-saas-application"></a><span data-ttu-id="43e84-104">Surveiller les performances de hello application Wingtip SaaS</span><span class="sxs-lookup"><span data-stu-id="43e84-104">Monitor performance of hello Wingtip SaaS application</span></span>

<span data-ttu-id="43e84-105">Ce didacticiel aborde plusieurs scénarios de gestion de performance clés utilisés dans les applications SaaS.</span><span class="sxs-lookup"><span data-stu-id="43e84-105">In this tutorial, several key performance management scenarios used in SaaS applications are explored.</span></span> <span data-ttu-id="43e84-106">À l’aide d’une activité toosimulate du Générateur de charge sur toutes les bases de données client, les fonctionnalités d’alerte de base de données SQL et les pools élastiques et de surveillance intégrée hello sont illustrées.</span><span class="sxs-lookup"><span data-stu-id="43e84-106">Using a load generator toosimulate activity across all tenant databases, hello built-in monitoring and alerting features of SQL Database and elastic pools are demonstrated.</span></span>

<span data-ttu-id="43e84-107">application de Wingtip SaaS Hello utilise un modèle de données de locataire unique, où chaque salle (client) a sa propre base de données.</span><span class="sxs-lookup"><span data-stu-id="43e84-107">hello Wingtip SaaS app uses a single-tenant data model, where each venue (tenant) has their own database.</span></span> <span data-ttu-id="43e84-108">Comme de nombreuses applications SaaS, hello anticipées de modèle de charge de travail de client est imprévisible et sporadique.</span><span class="sxs-lookup"><span data-stu-id="43e84-108">Like many SaaS applications, hello anticipated tenant workload pattern is unpredictable and sporadic.</span></span> <span data-ttu-id="43e84-109">En d’autres termes, les ventes de tickets peuvent se produire à tout moment.</span><span class="sxs-lookup"><span data-stu-id="43e84-109">In other words, ticket sales may occur at any time.</span></span> <span data-ttu-id="43e84-110">tootake l’avantage de ce modèle d’utilisation typique de la base de données, bases de données sont déployées dans des pools de base de données élastique de client.</span><span class="sxs-lookup"><span data-stu-id="43e84-110">tootake advantage of this typical database usage pattern, tenant databases are deployed into elastic database pools.</span></span> <span data-ttu-id="43e84-111">Pools élastiques optimiser le coût hello d’une solution en partage de ressources entre plusieurs bases de données.</span><span class="sxs-lookup"><span data-stu-id="43e84-111">Elastic pools optimize hello cost of a solution by sharing resources across many databases.</span></span> <span data-ttu-id="43e84-112">Avec ce type de modèle, il est important de toomonitor de base de données et tooensure de l’utilisation de ressources pool qui charge sont raisonnablement équilibrée entre les pools.</span><span class="sxs-lookup"><span data-stu-id="43e84-112">With this type of pattern, it's important toomonitor database and pool resource usage tooensure that loads are reasonably balanced across pools.</span></span> <span data-ttu-id="43e84-113">Vous devez également tooensure que les bases de données disposent des ressources adéquates et atteint pas de pools de leurs [eDTU](sql-database-what-is-a-dtu.md) limites.</span><span class="sxs-lookup"><span data-stu-id="43e84-113">You also need tooensure that individual databases have adequate resources, and that pools are not hitting their [eDTU](sql-database-what-is-a-dtu.md) limits.</span></span> <span data-ttu-id="43e84-114">Ce didacticiel explore les méthodes toomonitor et gérer des bases de données et des pools et la manière dont une action corrective tootake dans toovariations de réponse dans la charge de travail.</span><span class="sxs-lookup"><span data-stu-id="43e84-114">This tutorial explores ways toomonitor and manage databases and pools, and how tootake corrective action in response toovariations in workload.</span></span>

<span data-ttu-id="43e84-115">Ce didacticiel vous explique comment effectuer les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="43e84-115">In this tutorial you learn how to:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="43e84-116">Simuler l’utilisation de bases de données clientes hello en exécutant un générateur de charge fourni</span><span class="sxs-lookup"><span data-stu-id="43e84-116">Simulate usage on hello tenant databases by running a provided load generator</span></span>
> * <span data-ttu-id="43e84-117">Client de hello analyse des bases de données qu’ils répondent augmentation toohello charge</span><span class="sxs-lookup"><span data-stu-id="43e84-117">Monitor hello tenant databases as they respond toohello increase in load</span></span>
> * <span data-ttu-id="43e84-118">Montée en puissance hello pool élastique dans réponse toohello accrue de la base de données de charge</span><span class="sxs-lookup"><span data-stu-id="43e84-118">Scale up hello Elastic pool in response toohello increased database load</span></span>
> * <span data-ttu-id="43e84-119">Configurer une deuxième activité de base de données du solde tooload pool élastique</span><span class="sxs-lookup"><span data-stu-id="43e84-119">Provision a second Elastic pool tooload balance database activity</span></span>


<span data-ttu-id="43e84-120">toocomplete ce didacticiel, assurez-vous que hello est suivant des conditions préalables requises sont effectuées :</span><span class="sxs-lookup"><span data-stu-id="43e84-120">toocomplete this tutorial, make sure hello following prerequisites are completed:</span></span>

* <span data-ttu-id="43e84-121">Hello Wingtip SaaS application est déployée.</span><span class="sxs-lookup"><span data-stu-id="43e84-121">hello Wingtip SaaS app is deployed.</span></span> <span data-ttu-id="43e84-122">toodeploy en moins de cinq minutes, consultez [déployer et Explorer hello Wingtip SaaS application](sql-database-saas-tutorial.md)</span><span class="sxs-lookup"><span data-stu-id="43e84-122">toodeploy in less than five minutes, see [Deploy and explore hello Wingtip SaaS application](sql-database-saas-tutorial.md)</span></span>
* <span data-ttu-id="43e84-123">Azure PowerShell est installé.</span><span class="sxs-lookup"><span data-stu-id="43e84-123">Azure PowerShell is installed.</span></span> <span data-ttu-id="43e84-124">Pour plus d’informations, consultez [Bien démarrer avec Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps).</span><span class="sxs-lookup"><span data-stu-id="43e84-124">For details, see [Getting started with Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span></span>

## <a name="introduction-toosaas-performance-management-patterns"></a><span data-ttu-id="43e84-125">Modèles de gestion des performances introduction tooSaaS</span><span class="sxs-lookup"><span data-stu-id="43e84-125">Introduction tooSaaS performance management patterns</span></span>

<span data-ttu-id="43e84-126">Gestion des performances de la base de données se compose de la compilation et analyse des données de performances puis réagir toothis données en ajustant les paramètres toomaintain un temps de réponse acceptable pour votre application.</span><span class="sxs-lookup"><span data-stu-id="43e84-126">Managing database performance consists of compiling and analyzing performance data, and then reacting toothis data by adjusting parameters toomaintain an acceptable response time for your application.</span></span> <span data-ttu-id="43e84-127">Lorsque vous hébergez plusieurs clients, pools de bases de données élastiques sont un tooprovide de manière économique et gérer les ressources d’un groupe de bases de données avec les charges de travail imprévisibles.</span><span class="sxs-lookup"><span data-stu-id="43e84-127">When hosting multiple tenants, Elastic database pools are a cost-effective way tooprovide and manage resources for a group of databases with unpredictable workloads.</span></span> <span data-ttu-id="43e84-128">Avec certains modèles de charge de travail, il peut être avantageux de gérer ne serait-ce que 2 bases de données S3 dans un pool.</span><span class="sxs-lookup"><span data-stu-id="43e84-128">With certain workload patterns, as few as two S3 databases can benefit from being managed in a pool.</span></span>

![Médias](./media/sql-database-saas-tutorial-performance-monitoring/app-diagram.png)

<span data-ttu-id="43e84-130">Pools et hello de bases de données dans des pools, doit être analysé tooensure ils restent dans des limites acceptables de performances.</span><span class="sxs-lookup"><span data-stu-id="43e84-130">Pools, and hello databases in pools, should be monitored tooensure they stay within acceptable ranges of performance.</span></span> <span data-ttu-id="43e84-131">Hello pool configuration toomeet hello besoins des charges de travail d’agrégation hello de toutes les bases de données, vous être assuré qu’Edtu de pool hello est appropriées pour hello de paramétrer la charge de travail global.</span><span class="sxs-lookup"><span data-stu-id="43e84-131">Tune hello pool configuration toomeet hello needs of hello aggregate workload of all databases, ensuring that hello pool eDTUs are appropriate for hello overall workload.</span></span> <span data-ttu-id="43e84-132">Ajustez hello par base de données min et par base de données max eDTU valeurs tooappropriate valeurs pour les exigences de votre application spécifique.</span><span class="sxs-lookup"><span data-stu-id="43e84-132">Adjust hello per-database min and per-database max eDTU values tooappropriate values for your specific application requirements.</span></span>

### <a name="performance-management-strategies"></a><span data-ttu-id="43e84-133">Stratégies de gestion des performances</span><span class="sxs-lookup"><span data-stu-id="43e84-133">Performance management strategies</span></span>

* <span data-ttu-id="43e84-134">tooavoid avoir toomanually surveiller les performances, il est plus efficace**définir des alertes qui se déclenchent lorsque les bases de données ou les pools Comète hors des limites normales**.</span><span class="sxs-lookup"><span data-stu-id="43e84-134">tooavoid having toomanually monitor performance, it’s most effective too**set alerts that trigger when databases or pools stray out of normal ranges**.</span></span>
* <span data-ttu-id="43e84-135">toorespond les fluctuations de tooshort à long terme dans le niveau de performances des agrégats hello d’un pool, hello **niveau eDTU de pool peut être monté en haut ou bas**.</span><span class="sxs-lookup"><span data-stu-id="43e84-135">toorespond tooshort-term fluctuations in hello aggregate performance level of a pool, hello **pool eDTU level can be scaled up or down**.</span></span> <span data-ttu-id="43e84-136">Si ce problème se produit sur une base régulière ou prévisible, **mise à l’échelle de pool de hello peut être planifiée toooccur automatiquement**.</span><span class="sxs-lookup"><span data-stu-id="43e84-136">If this fluctuation occurs on a regular or predictable basis, **scaling hello pool can be scheduled toooccur automatically**.</span></span> <span data-ttu-id="43e84-137">Par exemple, diminuez la taille du pool lorsque vous savez que votre charge de travail est faible, disons la nuit ou le week-end.</span><span class="sxs-lookup"><span data-stu-id="43e84-137">For example, scale down when you know your workload is light, maybe overnight, or during weekends.</span></span>
* <span data-ttu-id="43e84-138">fluctuations de toorespond toolonger à long terme, ou les modifications de plusieurs bases de données, de hello **des bases de données peuvent être déplacés dans les autres pools**.</span><span class="sxs-lookup"><span data-stu-id="43e84-138">toorespond toolonger-term fluctuations, or changes in hello number of databases, **individual databases can be moved into other pools**.</span></span>
* <span data-ttu-id="43e84-139">toorespond tooshort terme augmente dans *individuels* charge de la base de données **des bases de données peuvent être extraite d’un pool et affectés un niveau de performances individuels**.</span><span class="sxs-lookup"><span data-stu-id="43e84-139">toorespond tooshort term increases in *individual* database load **individual databases can be taken out of a pool and assigned an individual performance level**.</span></span> <span data-ttu-id="43e84-140">Une fois que la charge de hello est réduite, base de données hello peut ensuite être retournée toohello pool.</span><span class="sxs-lookup"><span data-stu-id="43e84-140">Once hello load is reduced, hello database can then be returned toohello pool.</span></span> <span data-ttu-id="43e84-141">Lorsque cela est connu d’avance, bases de données peuvent être déplacés préventivement base de données tooensure hello a toujours ressources hello que nécessaires et tooavoid impact sur les autres bases de données dans le pool de hello.</span><span class="sxs-lookup"><span data-stu-id="43e84-141">When this is known in advance, databases can be moved pre-emptively tooensure hello database always has hello resources it needs, and tooavoid impact on other databases in hello pool.</span></span> <span data-ttu-id="43e84-142">Si cette exigence est prévisible, par exemple un lieu rencontre un appel de ventes de ticket pour un événement populaires, ce comportement de gestion peut être intégré dans l’application hello.</span><span class="sxs-lookup"><span data-stu-id="43e84-142">If this requirement is predictable, such as a venue experiencing a rush of ticket sales for a popular event, then this management behavior can be integrated into hello application.</span></span>

<span data-ttu-id="43e84-143">Hello [portail Azure](https://portal.azure.com) intégrés de surveillance et de génération d’alertes sur la plupart des ressources.</span><span class="sxs-lookup"><span data-stu-id="43e84-143">hello [Azure portal](https://portal.azure.com) provides built-in monitoring and alerting on most resources.</span></span> <span data-ttu-id="43e84-144">Pour SQL Database, la surveillance et les alertes sont disponibles pour les bases de données et les pools.</span><span class="sxs-lookup"><span data-stu-id="43e84-144">For SQL Database, monitoring and alerting is available on databases and pools.</span></span> <span data-ttu-id="43e84-145">Cette intégrées d’analyse et d’alerte étant propres à la ressource, il est pratique toouse pour un petit nombre de ressources, mais n’est pas très utile lorsque vous travaillez avec nombreuses ressources.</span><span class="sxs-lookup"><span data-stu-id="43e84-145">This built-in monitoring and alerting is resource-specific, so it's convenient toouse for small numbers of resources, but is not very convenient when working with many resources.</span></span>

<span data-ttu-id="43e84-146">Pour les scénarios de volume important où vous travaillez avec nombreuses ressources, [Log Analytics (OMS)](sql-database-saas-tutorial-log-analytics.md) peut être utilisé.</span><span class="sxs-lookup"><span data-stu-id="43e84-146">For high-volume scenarios where you're working with many reources, [Log Analytics (OMS)](sql-database-saas-tutorial-log-analytics.md) can be used.</span></span> <span data-ttu-id="43e84-147">Il s’agit d’un service Azure distinct offrant l’analytique des journaux de diagnostic et des données de télémétrie rassemblés dans un espace de travail Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="43e84-147">This is a separate Azure service that provides analytics over emitted diagnostic logs and telemetry gathered in a log analytics workspace.</span></span> <span data-ttu-id="43e84-148">Analytique de journal peut collecter des données de télémétrie à partir de nombreux services et être tooquery utilisé et définir des alertes.</span><span class="sxs-lookup"><span data-stu-id="43e84-148">Log Analytics can collect telemetry from many services and be used tooquery and set alerts.</span></span>

## <a name="get-hello-wingtip-application-source-code-and-scripts"></a><span data-ttu-id="43e84-149">Obtenir les scripts et le code source des applications Wingtip hello</span><span class="sxs-lookup"><span data-stu-id="43e84-149">Get hello Wingtip application source code and scripts</span></span>

<span data-ttu-id="43e84-150">Hello Wingtip SaaS scripts et code source d’applications sont disponibles dans hello [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) référentiel github.</span><span class="sxs-lookup"><span data-stu-id="43e84-150">hello Wingtip SaaS scripts and application source code are available in hello [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) github repo.</span></span> <span data-ttu-id="43e84-151">[Étapes de scripts de Wingtip SaaS hello toodownload](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span><span class="sxs-lookup"><span data-stu-id="43e84-151">[Steps toodownload hello Wingtip SaaS scripts](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span></span>

## <a name="provision-additional-tenants"></a><span data-ttu-id="43e84-152">Approvisionner des locataires supplémentaires</span><span class="sxs-lookup"><span data-stu-id="43e84-152">Provision additional tenants</span></span>

<span data-ttu-id="43e84-153">Les pools peuvent être économiques avec deux bases de données S3, hello plusieurs bases de données qui se trouvent dans hello de pool hello plus rentable hello moyenne effet devient.</span><span class="sxs-lookup"><span data-stu-id="43e84-153">While pools can be cost-effective with just two S3 databases, hello more databases that are in hello pool hello more cost-effective hello averaging effect becomes.</span></span> <span data-ttu-id="43e84-154">Pour une bonne compréhension du fonctionnement de la gestion et de la surveillance des performances à grande échelle, ce didacticiel requiert le déploiement d’au moins 20 bases de données.</span><span class="sxs-lookup"><span data-stu-id="43e84-154">For a good understanding of how performance monitoring and management works at scale, this tutorial requires you have at least 20 databases deployed.</span></span>

<span data-ttu-id="43e84-155">Si vous déjà configuré un lot de clients dans un didacticiel précédent, ignorer toohello [simuler l’utilisation sur toutes les bases de données clientes](#simulate-usage-on-all-tenant-databases) section.</span><span class="sxs-lookup"><span data-stu-id="43e84-155">If you already provisioned a batch of tenants in a prior tutorial, skip toohello [Simulate usage on all tenant databases](#simulate-usage-on-all-tenant-databases) section.</span></span>

1. <span data-ttu-id="43e84-156">Ouvrir... \\Modules d’apprentissage\\l’analyse des performances et gestion\\*PerformanceMonitoringAndManagement.ps1 de démonstration* Bonjour *PowerShell ISE*.</span><span class="sxs-lookup"><span data-stu-id="43e84-156">Open …\\Learning Modules\\Performance Monitoring and Management\\*Demo-PerformanceMonitoringAndManagement.ps1* in hello *PowerShell ISE*.</span></span> <span data-ttu-id="43e84-157">Gardez ce script ouvert, car vous exécuterez plusieurs scénarios au cours de ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="43e84-157">Keep this script open as you'll run several scenarios during this tutorial.</span></span>
1. <span data-ttu-id="43e84-158">Définissez **$DemoScenario** = **1**, **Approvisionner un lot de locataires**</span><span class="sxs-lookup"><span data-stu-id="43e84-158">Set **$DemoScenario** = **1**, **Provision a batch of tenants**</span></span>
1. <span data-ttu-id="43e84-159">Appuyez sur **F5** script de hello toorun.</span><span class="sxs-lookup"><span data-stu-id="43e84-159">Press **F5** toorun hello script.</span></span>

<span data-ttu-id="43e84-160">script de Hello déploiera 17 locataires en moins de cinq minutes.</span><span class="sxs-lookup"><span data-stu-id="43e84-160">hello script will deploy 17 tenants in less than five minutes.</span></span>

<span data-ttu-id="43e84-161">Hello *New-TenantBatch* script utilise un ensemble d’imbriqués ou lié de [le Gestionnaire de ressources](../azure-resource-manager/index.md) les modèles qui créent un lot de clients, qui, par défaut, copie de base de données hello **basetenantdb** sur hello catalogue server toocreate hello nouvelles bases de données client, puis inscrit dans le catalogue de hello et enfin les initialise avec le type de nom et le lieu de locataire hello.</span><span class="sxs-lookup"><span data-stu-id="43e84-161">hello *New-TenantBatch* script uses a nested or linked set of [Resource Manager](../azure-resource-manager/index.md) templates that create a batch of tenants, which by default copies hello database **basetenantdb** on hello catalog server toocreate hello new tenant databases, then registers these in hello catalog, and finally initializes them with hello tenant name and venue type.</span></span> <span data-ttu-id="43e84-162">Cela est cohérent avec la méthode hello application hello configure un nouveau client.</span><span class="sxs-lookup"><span data-stu-id="43e84-162">This is consistent with hello way hello app provisions a new tenant.</span></span> <span data-ttu-id="43e84-163">Toutes les modifications apportées trop*basetenantdb* est appliqué tooany nouveaux locataires configurés par la suite.</span><span class="sxs-lookup"><span data-stu-id="43e84-163">Any changes made too*basetenantdb* are applied tooany new tenants provisioned thereafter.</span></span> <span data-ttu-id="43e84-164">Consultez hello [didacticiel de la gestion des schémas](sql-database-saas-tutorial-schema-management.md) toosee comment toomake schéma change également*existant* locataire des bases de données (y compris hello *basetenantdb* base de données).</span><span class="sxs-lookup"><span data-stu-id="43e84-164">See hello [Schema Management tutorial](sql-database-saas-tutorial-schema-management.md) toosee how toomake schema changes too*existing* tenant databases (including hello *basetenantdb* database).</span></span>

## <a name="simulate-usage-on-all-tenant-databases"></a><span data-ttu-id="43e84-165">Simuler l’utilisation sur toutes les bases de données de locataire</span><span class="sxs-lookup"><span data-stu-id="43e84-165">Simulate usage on all tenant databases</span></span>

<span data-ttu-id="43e84-166">Hello *PerformanceMonitoringAndManagement.ps1 de démonstration* script est fourni qui simule une charge de travail en cours d’exécution sur toutes les bases de données client.</span><span class="sxs-lookup"><span data-stu-id="43e84-166">hello *Demo-PerformanceMonitoringAndManagement.ps1* script is provided that simulates a workload running against all tenant databases.</span></span> <span data-ttu-id="43e84-167">la charge de Hello est générée à l’aide d’un des scénarios de charge disponibles hello :</span><span class="sxs-lookup"><span data-stu-id="43e84-167">hello load is generated using one of hello available load scenarios:</span></span>

| <span data-ttu-id="43e84-168">Démonstration</span><span class="sxs-lookup"><span data-stu-id="43e84-168">Demo</span></span> | <span data-ttu-id="43e84-169">Scénario</span><span class="sxs-lookup"><span data-stu-id="43e84-169">Scenario</span></span> |
|:--|:--|
| <span data-ttu-id="43e84-170">2</span><span class="sxs-lookup"><span data-stu-id="43e84-170">2</span></span> | <span data-ttu-id="43e84-171">Générer une charge d’intensité normale (environ 40 DTU)</span><span class="sxs-lookup"><span data-stu-id="43e84-171">Generate normal intensity load (approx. 40 DTU)</span></span> |
| <span data-ttu-id="43e84-172">3</span><span class="sxs-lookup"><span data-stu-id="43e84-172">3</span></span> | <span data-ttu-id="43e84-173">Générer une charge avec des pics plus longs et plus fréquents par base de données</span><span class="sxs-lookup"><span data-stu-id="43e84-173">Generate load with longer and more frequent bursts per database</span></span>|
| <span data-ttu-id="43e84-174">4</span><span class="sxs-lookup"><span data-stu-id="43e84-174">4</span></span> | <span data-ttu-id="43e84-175">Générer une charge avec des pics de DTU supérieurs par base de données (environ 80 DTU)</span><span class="sxs-lookup"><span data-stu-id="43e84-175">Generate load with higher DTU bursts per database (approx. 80 DTU)</span></span>|
| <span data-ttu-id="43e84-176">5</span><span class="sxs-lookup"><span data-stu-id="43e84-176">5</span></span> | <span data-ttu-id="43e84-177">Générer une charge normale et une charge élevée sur un seul locataire (environ 95 DTU)</span><span class="sxs-lookup"><span data-stu-id="43e84-177">Generate a normal load plus a high load on a single tenant (approx. 95 DTU)</span></span>|
| <span data-ttu-id="43e84-178">6</span><span class="sxs-lookup"><span data-stu-id="43e84-178">6</span></span> | <span data-ttu-id="43e84-179">Générer une charge déséquilibrée entre plusieurs pools</span><span class="sxs-lookup"><span data-stu-id="43e84-179">Generate unbalanced load across multiple pools</span></span>|

<span data-ttu-id="43e84-180">Générateur de charge Hello applique un *synthétique* base de données de chargement de l’UC uniquement tooevery client.</span><span class="sxs-lookup"><span data-stu-id="43e84-180">hello load generator applies a *synthetic* CPU-only load tooevery tenant database.</span></span> <span data-ttu-id="43e84-181">Générateur de Hello démarre une tâche pour chaque base de données client qui appelle périodiquement une procédure stockée qui génère la charge de hello.</span><span class="sxs-lookup"><span data-stu-id="43e84-181">hello generator starts a job for each tenant database, which calls a stored procedure periodically that generates hello load.</span></span> <span data-ttu-id="43e84-182">intervalles, la durée et les niveaux de charge hello (dans Edtu) sont différentes entre toutes les bases de données, en simulant des activités de client imprévisible.</span><span class="sxs-lookup"><span data-stu-id="43e84-182">hello load levels (in eDTUs), duration, and intervals are varied across all databases, simulating unpredictable tenant activity.</span></span>

1. <span data-ttu-id="43e84-183">Ouvrir... \\Modules d’apprentissage\\l’analyse des performances et gestion\\*PerformanceMonitoringAndManagement.ps1 de démonstration* Bonjour *PowerShell ISE*.</span><span class="sxs-lookup"><span data-stu-id="43e84-183">Open …\\Learning Modules\\Performance Monitoring and Management\\*Demo-PerformanceMonitoringAndManagement.ps1* in hello *PowerShell ISE*.</span></span> <span data-ttu-id="43e84-184">Gardez ce script ouvert, car vous exécuterez plusieurs scénarios au cours de ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="43e84-184">Keep this script open as you'll run several scenarios during this tutorial.</span></span>
1. <span data-ttu-id="43e84-185">Définissez **$DemoScenario** = **2**, *Générer une charge d’intensité normale*.</span><span class="sxs-lookup"><span data-stu-id="43e84-185">Set **$DemoScenario** = **2**, *Generate normal intensity load*.</span></span>
1. <span data-ttu-id="43e84-186">Appuyez sur **F5** tooapply un tooall charge vos bases de données client.</span><span class="sxs-lookup"><span data-stu-id="43e84-186">Press **F5** tooapply a load tooall your tenant databases.</span></span>

<span data-ttu-id="43e84-187">Wingtip est une application SaaS, et charge du monde réel hello sur une application SaaS est généralement sporadique et imprévisibles.</span><span class="sxs-lookup"><span data-stu-id="43e84-187">Wingtip is a SaaS app, and hello real-world load on a SaaS app is typically sporadic and unpredictable.</span></span> <span data-ttu-id="43e84-188">toosimulate cela, hello charge générateur génère une charge aléatoire distribuée sur tous les locataires.</span><span class="sxs-lookup"><span data-stu-id="43e84-188">toosimulate this, hello load generator produces a randomized load distributed across all tenants.</span></span> <span data-ttu-id="43e84-189">Plusieurs minutes sont nécessaires pour tooemerge de modèle de charge hello, exécutez le Générateur de charge hello de 3 à 5 minutes avant de tenter de charger de hello toomonitor Bonjour les sections suivantes.</span><span class="sxs-lookup"><span data-stu-id="43e84-189">Several minutes are needed for hello load pattern tooemerge, so run hello load generator for 3-5 minutes before attempting toomonitor hello load in hello following sections.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="43e84-190">Générateur de charge Hello est en cours d’exécution comme une série de tâches dans votre session PowerShell locale.</span><span class="sxs-lookup"><span data-stu-id="43e84-190">hello load generator is running as a series of jobs in your local PowerShell session.</span></span> <span data-ttu-id="43e84-191">Conserver hello *PerformanceMonitoringAndManagement.ps1 de démonstration* onglet ouvert !</span><span class="sxs-lookup"><span data-stu-id="43e84-191">Keep hello *Demo-PerformanceMonitoringAndManagement.ps1* tab open!</span></span> <span data-ttu-id="43e84-192">Si vous fermez l’onglet de hello ou suspendre votre ordinateur, le Générateur de charge hello s’arrête.</span><span class="sxs-lookup"><span data-stu-id="43e84-192">If you close hello tab, or suspend your machine, hello load generator stops.</span></span> <span data-ttu-id="43e84-193">Générateur de charge Hello reste dans un *appel de travail* état où il génère la charge sur les nouveaux clients sont mis en service après le démarrage du Générateur de hello.</span><span class="sxs-lookup"><span data-stu-id="43e84-193">hello load generator remains in a *job-invoking* state where it generates load on any new tenants that are provisioned after hello generator is started.</span></span> <span data-ttu-id="43e84-194">Utilisez *Ctrl-C* toostop appel de nouvelles tâches et sortie hello script.</span><span class="sxs-lookup"><span data-stu-id="43e84-194">Use *Ctrl-C* toostop invoking new jobs and exit hello script.</span></span> <span data-ttu-id="43e84-195">Générateur de charge Hello continue toorun, mais uniquement sur les clients existants.</span><span class="sxs-lookup"><span data-stu-id="43e84-195">hello load generator will continue toorun, but only on existing tenants.</span></span>

## <a name="monitor-resource-usage-using-hello-azure-portal"></a><span data-ttu-id="43e84-196">Surveiller l’utilisation des ressources à l’aide de hello portail Azure</span><span class="sxs-lookup"><span data-stu-id="43e84-196">Monitor resource usage using hello Azure portal</span></span>

<span data-ttu-id="43e84-197">utilisation des ressources toomonitor hello qui chargent des résultats à partir de hello appliqué, ouvrir le pool de toohello portail hello contenant des bases de données clientes hello :</span><span class="sxs-lookup"><span data-stu-id="43e84-197">toomonitor hello resource usage that results from hello load being applied, open hello portal toohello pool containing hello tenant databases:</span></span>

1. <span data-ttu-id="43e84-198">Ouvrez hello [portail Azure](https://portal.azure.com) et parcourir toohello *tenants1 -&lt;utilisateur&gt;*  server.</span><span class="sxs-lookup"><span data-stu-id="43e84-198">Open hello [Azure portal](https://portal.azure.com) and browse toohello *tenants1-&lt;USER&gt;* server.</span></span>
1. <span data-ttu-id="43e84-199">Faites défiler vers le bas, recherchez les pools élastiques, puis cliquez sur **Pool1**.</span><span class="sxs-lookup"><span data-stu-id="43e84-199">Scroll down and locate elastic pools and click **Pool1**.</span></span> <span data-ttu-id="43e84-200">Ce pool contient toutes les bases de locataire hello créés jusqu'à présent.</span><span class="sxs-lookup"><span data-stu-id="43e84-200">This pool contains all hello tenant databases created so far.</span></span>

<span data-ttu-id="43e84-201">Observez hello **analyse du pool élastique** et **analyse de la base de données élastique** graphiques.</span><span class="sxs-lookup"><span data-stu-id="43e84-201">Observe hello **Elastic pool monitoring** and **Elastic database monitoring** charts.</span></span>

<span data-ttu-id="43e84-202">Bonjour l’utilisation des ressources du pool est l’utilisation de base de données d’agrégation hello pour toutes les bases de données dans le pool de hello.</span><span class="sxs-lookup"><span data-stu-id="43e84-202">hello pool's resource utilization is hello aggregate database utilization for all databases in hello pool.</span></span> <span data-ttu-id="43e84-203">graphique de base de données Hello montre hello cinq bases de données plus sensible :</span><span class="sxs-lookup"><span data-stu-id="43e84-203">hello database chart shows hello five hottest databases:</span></span>

![](./media/sql-database-saas-tutorial-performance-monitoring/pool1.png)

<span data-ttu-id="43e84-204">Étant donné que les bases de données supplémentaires dans le pool hello au-delà de hello les cinq premiers, l’utilisation du pool de hello affiche l’activité qui n’est pas reflétée dans le graphique de cinq bases de données supérieur hello.</span><span class="sxs-lookup"><span data-stu-id="43e84-204">Because there are additional databases in hello pool beyond hello top five, hello pool utilization shows activity that is not reflected in hello top five databases chart.</span></span> <span data-ttu-id="43e84-205">Pour plus de détails, cliquez sur **Utilisation des ressources de base de données** :</span><span class="sxs-lookup"><span data-stu-id="43e84-205">For additional details, click **Database Resource Utilization**:</span></span>

![](./media/sql-database-saas-tutorial-performance-monitoring/database-utilization.png)


## <a name="set-performance-alerts-on-hello-pool"></a><span data-ttu-id="43e84-206">Définir des alertes de performances sur le pool de hello</span><span class="sxs-lookup"><span data-stu-id="43e84-206">Set performance alerts on hello pool</span></span>

<span data-ttu-id="43e84-207">Définir une alerte sur le pool hello qui se déclenche sur \>utilisation de 75 % comme suit :</span><span class="sxs-lookup"><span data-stu-id="43e84-207">Set an alert on hello pool that triggers on \>75% utilization as follows:</span></span>

1. <span data-ttu-id="43e84-208">Ouvrez *Pool1* (sur hello *tenants1 -\<utilisateur\>*  serveur) Bonjour [portail Azure](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="43e84-208">Open *Pool1* (on hello *tenants1-\<user\>* server) in hello [Azure portal](https://portal.azure.com).</span></span>
1. <span data-ttu-id="43e84-209">Cliquez sur **Règles d’alerte**, puis sur **+ Ajouter une alerte**.</span><span class="sxs-lookup"><span data-stu-id="43e84-209">Click **Alert Rules**, and then click **+ Add alert**:</span></span>

   ![ajouter une alerte](media/sql-database-saas-tutorial-performance-monitoring/add-alert.png)

1. <span data-ttu-id="43e84-211">Entrez un nom, par exemple **Nombre élevé de DTU**,</span><span class="sxs-lookup"><span data-stu-id="43e84-211">Provide a name, such as **High DTU**,</span></span>
1. <span data-ttu-id="43e84-212">Hello du jeu de valeurs suivantes :</span><span class="sxs-lookup"><span data-stu-id="43e84-212">Set hello following values:</span></span>
   * <span data-ttu-id="43e84-213">**Métrique = pourcentage eDTU**</span><span class="sxs-lookup"><span data-stu-id="43e84-213">**Metric = eDTU percentage**</span></span>
   * <span data-ttu-id="43e84-214">**Condition = supérieur à**.</span><span class="sxs-lookup"><span data-stu-id="43e84-214">**Condition = greater than**.</span></span>
   * <span data-ttu-id="43e84-215">**Seuil = 75**.</span><span class="sxs-lookup"><span data-stu-id="43e84-215">**Threshold = 75**.</span></span>
   * <span data-ttu-id="43e84-216">**Période = 30 dernières minutes sur hello**.</span><span class="sxs-lookup"><span data-stu-id="43e84-216">**Period = Over hello last 30 minutes**.</span></span>
1. <span data-ttu-id="43e84-217">Ajouter un toohello d’adresse de messagerie *administrateur supplémentaire email(s)* , puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="43e84-217">Add an email address toohello *Additional administrator email(s)* box and click **OK**.</span></span>

   ![définir une alerte](media/sql-database-saas-tutorial-performance-monitoring/alert-rule.png)


## <a name="scale-up-a-busy-pool"></a><span data-ttu-id="43e84-219">Augmenter la taille d’un pool occupé</span><span class="sxs-lookup"><span data-stu-id="43e84-219">Scale up a busy pool</span></span>

<span data-ttu-id="43e84-220">Si au niveau de charge globale hello augmente sur un point de toohello pool qu’il maximise out pool de hello et atteint 100 % eDTU d’utilisation, puis les performances de base de données individuelle sont affecté, ralentir potentiellement des temps de réponse pour toutes les bases de données dans le pool de hello.</span><span class="sxs-lookup"><span data-stu-id="43e84-220">If hello aggregate load level increases on a pool toohello point that it maxes out hello pool and reaches 100% eDTU usage, then individual database performance is affected, potentially slowing query response times for all databases in hello pool.</span></span>

<span data-ttu-id="43e84-221">**À court terme**, mise à l’échelle des ressources supplémentaires de hello pool tooprovide ou supprimez les bases de données à partir du pool de hello (en les déplaçant tooother pools, ou en dehors du niveau de service autonome hello pool tooa).</span><span class="sxs-lookup"><span data-stu-id="43e84-221">**Short term**, consider scaling up hello pool tooprovide additional resources, or removing databases from hello pool (moving them tooother pools, or out of hello pool tooa stand-alone service tier).</span></span>

<span data-ttu-id="43e84-222">**À long terme**, envisagez d’optimiser les requêtes ou les performances d’utilisation de base de données tooimprove d’index.</span><span class="sxs-lookup"><span data-stu-id="43e84-222">**Longer term**, consider optimizing queries or index usage tooimprove database performance.</span></span> <span data-ttu-id="43e84-223">En fonction de hello tooperformance de respect de l’application émet son tooscale pratique meilleures un pool d’avant d’atteindre 100 % eDTU d’utilisation.</span><span class="sxs-lookup"><span data-stu-id="43e84-223">Depending on hello application's sensitivity tooperformance issues its best practice tooscale a pool up before it reaches 100% eDTU usage.</span></span> <span data-ttu-id="43e84-224">Utiliser une alerte toowarn vous à l’avance.</span><span class="sxs-lookup"><span data-stu-id="43e84-224">Use an alert toowarn you in advance.</span></span>

<span data-ttu-id="43e84-225">Vous pouvez simuler un pool occupé par la charge croissante du hello produite par le Générateur de hello.</span><span class="sxs-lookup"><span data-stu-id="43e84-225">You can simulate a busy pool by increasing hello load produced by hello generator.</span></span> <span data-ttu-id="43e84-226">À l’origine tooburst de bases de données hello plus fréquemment et pour la charge d’agrégation hello plus long, croissant sur le pool de hello sans l’évolution des besoins de bases de données individuelles hello hello.</span><span class="sxs-lookup"><span data-stu-id="43e84-226">Causing hello databases tooburst more frequently, and for longer, increasing hello aggregate load on hello pool without changing hello requirements of hello individual databases.</span></span> <span data-ttu-id="43e84-227">Mise à l’échelle d’un pool de hello est facilement effectué dans le portail de hello ou à partir de PowerShell.</span><span class="sxs-lookup"><span data-stu-id="43e84-227">Scaling up hello pool is easily done in hello portal or from PowerShell.</span></span> <span data-ttu-id="43e84-228">Cet exercice utilise un portail de hello.</span><span class="sxs-lookup"><span data-stu-id="43e84-228">This exercise uses hello portal.</span></span>

1. <span data-ttu-id="43e84-229">Définissez *$DemoScenario* = **3**, _charge générer rafales plus long et plus fréquente par base de données_ intensité hello tooincrease charge hello d’agrégation pool Hello sans modifier les pics de charge hello requis par chaque base de données.</span><span class="sxs-lookup"><span data-stu-id="43e84-229">Set *$DemoScenario* = **3**, _Generate load with longer and more frequent bursts per database_ tooincrease hello intensity of hello aggregate load on hello pool without changing hello peak load required by each database.</span></span>
1. <span data-ttu-id="43e84-230">Appuyez sur **F5** tooapply un tooall charge vos bases de données client.</span><span class="sxs-lookup"><span data-stu-id="43e84-230">Press **F5** tooapply a load tooall your tenant databases.</span></span>

1. <span data-ttu-id="43e84-231">Accédez trop**Pool1** Bonjour portail Azure.</span><span class="sxs-lookup"><span data-stu-id="43e84-231">Go too**Pool1** in hello Azure portal.</span></span>

<span data-ttu-id="43e84-232">Hello d’analyse augmente l’utilisation du pool eDTU sur le graphique du haut hello.</span><span class="sxs-lookup"><span data-stu-id="43e84-232">Monitor hello increased pool eDTU usage on hello upper chart.</span></span> <span data-ttu-id="43e84-233">Prend quelques minutes pour hello nouvelle tookick charge plus élevée, mais vous devez voir rapidement les pool hello démarrer l’utilisation de max toohit et comme charge de hello steadies dans le nouveau modèle de hello, elle surcharge rapidement le pool de hello.</span><span class="sxs-lookup"><span data-stu-id="43e84-233">It takes a few minutes for hello new higher load tookick in, but you should quickly see hello pool start toohit max utilization, and as hello load steadies into hello new pattern, it rapidly overloads hello pool.</span></span>

1. <span data-ttu-id="43e84-234">tooscale pool de hello, cliquez sur **configurer pool** haut hello hello **Pool1** page.</span><span class="sxs-lookup"><span data-stu-id="43e84-234">tooscale up hello pool, click **Configure pool** at hello top of hello **Pool1** page.</span></span>
1. <span data-ttu-id="43e84-235">Ajuster hello **eDTU du Pool** aussi un paramètre**100**.</span><span class="sxs-lookup"><span data-stu-id="43e84-235">Adjust hello **Pool eDTU** setting too**100**.</span></span> <span data-ttu-id="43e84-236">Modification des eDTU du pool hello ne modifie pas les paramètres de base de données hello (qui est toujours 50 eDTU par base de données).</span><span class="sxs-lookup"><span data-stu-id="43e84-236">Changing hello pool eDTU does not change hello per-database settings (which is still 50 eDTU max per database).</span></span> <span data-ttu-id="43e84-237">Vous pouvez voir les paramètres de base de données hello sur le côté droit de hello Hello **configurer pool** page.</span><span class="sxs-lookup"><span data-stu-id="43e84-237">You can see hello per-database settings on hello right side of hello **Configure pool** page.</span></span>
1. <span data-ttu-id="43e84-238">Cliquez sur **enregistrer** le pool hello tooscale toosubmit hello demande.</span><span class="sxs-lookup"><span data-stu-id="43e84-238">Click **Save** toosubmit hello request tooscale hello pool.</span></span>

<span data-ttu-id="43e84-239">Revenir en arrière trop**Pool1** > **vue d’ensemble** hello tooview graphiques de surveillance.</span><span class="sxs-lookup"><span data-stu-id="43e84-239">Go back too**Pool1** > **Overview** tooview hello monitoring charts.</span></span> <span data-ttu-id="43e84-240">Analyser l’effet hello d’offrant davantage de ressources de pool de hello (bien qu’avec les bases de données et une charge aléatoire qu’il n’est pas toujours facile toosee ait jusqu'à ce que vous exécutez pendant un certain temps).</span><span class="sxs-lookup"><span data-stu-id="43e84-240">Monitor hello effect of providing hello pool with more resources (although with few databases and a randomized load it’s not always easy toosee conclusively until you run for some time).</span></span> <span data-ttu-id="43e84-241">Lorsque vous examinez hello graphiques portent à l’esprit que 100 % sur hello supérieur maintenant le graphique représente 100 Edtu, sur hello graphique 100 % inférieure est toujours 50 Edtu comme hello par base de données max est toujours 50 Edtu.</span><span class="sxs-lookup"><span data-stu-id="43e84-241">While you are looking at hello charts bear in mind that 100% on hello upper chart now represents 100 eDTUs, while on hello lower chart 100% is still 50 eDTUs as hello per-database max is still 50 eDTUs.</span></span>

<span data-ttu-id="43e84-242">Bases de données restent en ligne et entièrement disponibles tout au long du processus de hello.</span><span class="sxs-lookup"><span data-stu-id="43e84-242">Databases remain online and fully available throughout hello process.</span></span> <span data-ttu-id="43e84-243">À hello dernier moment que chaque base de données est prêt toobe activé avec le nouveau eDTU du pool hello, toutes les connexions actives sont interrompues.</span><span class="sxs-lookup"><span data-stu-id="43e84-243">At hello last moment as each database is ready toobe enabled with hello new pool eDTU, any active connections are broken.</span></span> <span data-ttu-id="43e84-244">Code d’application doit toujours être écrits tooretry supprimé les connexions et donc se reconnectera toohello de base de données dans le pool d’échelle hello.</span><span class="sxs-lookup"><span data-stu-id="43e84-244">Application code should always be written tooretry dropped connections, and so will reconnect toohello database in hello scaled-up pool.</span></span>

## <a name="load-balance-between-pools"></a><span data-ttu-id="43e84-245">Équilibrage de charge entre pools</span><span class="sxs-lookup"><span data-stu-id="43e84-245">Load balance between pools</span></span>

<span data-ttu-id="43e84-246">Comme un autre tooscaling pool de hello, créez un pool deuxième et placer les bases de données toobalance hello charger entre hello deux pools.</span><span class="sxs-lookup"><span data-stu-id="43e84-246">As an alternative tooscaling up hello pool, create a second pool and move databases into it toobalance hello load between hello two pools.</span></span> <span data-ttu-id="43e84-247">toodo ce nouveau pool d’hello doit être créé sur hello même serveur que hello tout d’abord.</span><span class="sxs-lookup"><span data-stu-id="43e84-247">toodo this hello new pool must be created on hello same server as hello first.</span></span>

1. <span data-ttu-id="43e84-248">Bonjour [portail Azure](https://portal.azure.com), ouvrez hello **tenants1 -&lt;utilisateur&gt;**  server.</span><span class="sxs-lookup"><span data-stu-id="43e84-248">In hello [Azure portal](https://portal.azure.com), open hello **tenants1-&lt;USER&gt;** server.</span></span>
1. <span data-ttu-id="43e84-249">Cliquez sur **+ nouveau pool** toocreate un pool sur le serveur en cours de hello.</span><span class="sxs-lookup"><span data-stu-id="43e84-249">Click **+ New pool** toocreate a pool on hello current server.</span></span>
1. <span data-ttu-id="43e84-250">Sur hello **pool élastique** modèle :</span><span class="sxs-lookup"><span data-stu-id="43e84-250">On hello **Elastic database pool** template:</span></span>

    1. <span data-ttu-id="43e84-251">Définissez **nom** trop*Pool2*.</span><span class="sxs-lookup"><span data-stu-id="43e84-251">Set **Name** too*Pool2*.</span></span>
    1. <span data-ttu-id="43e84-252">Laissez hello tarification comme **Pool Standard**.</span><span class="sxs-lookup"><span data-stu-id="43e84-252">Leave hello pricing tier as **Standard Pool**.</span></span>
    1. <span data-ttu-id="43e84-253">Cliquez sur **Configurer le pool**.</span><span class="sxs-lookup"><span data-stu-id="43e84-253">Click **Configure pool**,</span></span>
    1. <span data-ttu-id="43e84-254">Définissez **eDTU du Pool** trop*eDTU 50*.</span><span class="sxs-lookup"><span data-stu-id="43e84-254">Set **Pool eDTU** too*50 eDTU*.</span></span>
    1. <span data-ttu-id="43e84-255">Cliquez sur **ajouter des bases de données** toosee une liste des bases de données serveur hello qui peuvent être ajoutées trop*Pool2*.</span><span class="sxs-lookup"><span data-stu-id="43e84-255">Click **Add databases** toosee a list of databases on hello server that can be added too*Pool2*.</span></span>
    1. <span data-ttu-id="43e84-256">Sélectionnez n’importe quel toomove 10 bases de données de ces toohello nouveau pool, puis cliquez sur **sélectionnez**.</span><span class="sxs-lookup"><span data-stu-id="43e84-256">Select any 10 databases toomove these toohello new pool, and then click **Select**.</span></span> <span data-ttu-id="43e84-257">Si vous avez déjà exécuté Générateur de charge hello, service de hello sait déjà que votre profil de performance requiert un plus grand pool que taille de 50 eDTU hello par défaut et vous conseille de commencer avec un paramètre eDTU 100.</span><span class="sxs-lookup"><span data-stu-id="43e84-257">If you've been running hello load generator, hello service already knows that your performance profile requires a larger pool than hello default 50 eDTU size and recommends starting with a 100 eDTU setting.</span></span>

    ![Recommandation](media/sql-database-saas-tutorial-performance-monitoring/configure-pool.png)

    1. <span data-ttu-id="43e84-259">Pour ce didacticiel, conservez par défaut de hello 50 Edtu, puis cliquez sur **sélectionnez** à nouveau.</span><span class="sxs-lookup"><span data-stu-id="43e84-259">For this tutorial, leave hello default at 50 eDTUs, and click **Select** again.</span></span>
    1. <span data-ttu-id="43e84-260">Sélectionnez **OK** toocreate Bonjour nouveau pool et toomove Bonjour des bases de données sélectionnées dans celui-ci.</span><span class="sxs-lookup"><span data-stu-id="43e84-260">Select **OK** toocreate hello new pool and toomove hello selected databases into it.</span></span>

<span data-ttu-id="43e84-261">Création du pool de hello et le déplacement de bases de données hello prend quelques minutes.</span><span class="sxs-lookup"><span data-stu-id="43e84-261">Creating hello pool and moving hello databases takes a few minutes.</span></span> <span data-ttu-id="43e84-262">Comme les bases de données sont déplacées qu’ils restent en ligne et entièrement accessibles tant que hello très dernier moment, à partir de laquelle toutes les connexions ouvertes sont fermées.</span><span class="sxs-lookup"><span data-stu-id="43e84-262">As databases are moved they remain online and fully accessible until hello very last moment, at which point any open connections are closed.</span></span> <span data-ttu-id="43e84-263">Tant que vous disposez d’une logique de nouvelle tentative, les clients se connecteront puis toohello de base de données dans un nouveau pool de hello.</span><span class="sxs-lookup"><span data-stu-id="43e84-263">As long as you have some retry logic, clients will then connect toohello database in hello new pool.</span></span>

<span data-ttu-id="43e84-264">Parcourir trop**Pool2** (sur hello *tenants1* server) tooopen hello pool et surveiller ses performances.</span><span class="sxs-lookup"><span data-stu-id="43e84-264">Browse too**Pool2** (on hello *tenants1* server) tooopen hello pool and monitor its performance.</span></span> <span data-ttu-id="43e84-265">Si vous ne le voyez pas, attendez que l’approvisionnement de hello nouveau pool toocomplete.</span><span class="sxs-lookup"><span data-stu-id="43e84-265">If you don't see it, wait for provisioning of hello new pool toocomplete.</span></span>

<span data-ttu-id="43e84-266">Vous voyez à présent que l’utilisation des ressources sur le *Pool1* a chuté et que le *Pool2* est chargé dans la même mesure.</span><span class="sxs-lookup"><span data-stu-id="43e84-266">You now see that resource usage on *Pool1* has dropped and that *Pool2* is now similarly loaded.</span></span>

## <a name="manage-performance-of-a-single-database"></a><span data-ttu-id="43e84-267">Gérer les performances d’une base de données</span><span class="sxs-lookup"><span data-stu-id="43e84-267">Manage performance of a single database</span></span>

<span data-ttu-id="43e84-268">Si une base de données dans un pool est confronté à une charge élevée prolongée, selon la configuration de pool hello, il peut généralement des ressources de hello toodominate dans le pool de hello et avoir un impact sur d’autres bases de données.</span><span class="sxs-lookup"><span data-stu-id="43e84-268">If a single database in a pool experiences a sustained high load, depending on hello pool configuration, it may tend toodominate hello resources in hello pool and impact other databases.</span></span> <span data-ttu-id="43e84-269">Si l’activité hello est probablement toocontinue pendant un certain temps, base de données hello peut être temporairement déplacé en dehors du pool de hello.</span><span class="sxs-lookup"><span data-stu-id="43e84-269">If hello activity is likely toocontinue for some time, hello database can be temporarily moved out of hello pool.</span></span> <span data-ttu-id="43e84-270">Ainsi, Bonjour Bonjour de toohave de base de données des ressources supplémentaires, il a besoin et elle isole de hello autres bases de données.</span><span class="sxs-lookup"><span data-stu-id="43e84-270">This allows hello database toohave hello extra resources it needs, and isolates it from hello other databases.</span></span>

<span data-ttu-id="43e84-271">Cet exercice simule l’effet de hello de salle de Concert Contoso subissent une charge élevée lorsque les tickets accédez de vente pour un concert populaires.</span><span class="sxs-lookup"><span data-stu-id="43e84-271">This exercise simulates hello effect of Contoso Concert Hall experiencing a high load when tickets go on sale for a popular concert.</span></span>

1. <span data-ttu-id="43e84-272">Ouvrez hello... \\ *PerformanceMonitoringAndManagement.ps1 de démonstration* script.</span><span class="sxs-lookup"><span data-stu-id="43e84-272">Open hello …\\*Demo-PerformanceMonitoringAndManagement.ps1* script.</span></span>
1. <span data-ttu-id="43e84-273">Définissez **$DemoScenario = 5, Générer une charge normale et une charge élevée sur un seul locataire (environ 95 DTU).**</span><span class="sxs-lookup"><span data-stu-id="43e84-273">Set **$DemoScenario = 5, Generate a normal load plus a high load on a single tenant (approx. 95 DTU).**</span></span>
1. <span data-ttu-id="43e84-274">Définissez **$SingleTenantDatabaseName = contosoconcerthall**</span><span class="sxs-lookup"><span data-stu-id="43e84-274">Set **$SingleTenantDatabaseName = contosoconcerthall**</span></span>
1. <span data-ttu-id="43e84-275">Exécuter à l’aide du script hello **F5**.</span><span class="sxs-lookup"><span data-stu-id="43e84-275">Execute hello script using **F5**.</span></span>


1. <span data-ttu-id="43e84-276">Bonjour [portail Azure](https://portal.azure.com) ouvrir **Pool1**.</span><span class="sxs-lookup"><span data-stu-id="43e84-276">In hello [Azure portal](https://portal.azure.com) open **Pool1**.</span></span>
1. <span data-ttu-id="43e84-277">Inspecter hello **analyse du pool élastique** du graphique et recherchez l’utilisation du pool eDTU hello augmenté.</span><span class="sxs-lookup"><span data-stu-id="43e84-277">Inspect hello **Elastic pool monitoring** chart and look for hello increased pool eDTU usage.</span></span> <span data-ttu-id="43e84-278">Après une ou deux minutes, une charge plus élevée hello doit démarrer tookick dans, et vous devez voir rapidement que le pool de hello atteint 100 % d’utilisation.</span><span class="sxs-lookup"><span data-stu-id="43e84-278">After a minute or two, hello higher load should start tookick in, and you should quickly see that hello pool hits 100% utilization.</span></span>
1. <span data-ttu-id="43e84-279">Inspecter hello **analyse de la base de données élastique** complet qui montre les bases de données plus sensible hello Bonjour dernière heure.</span><span class="sxs-lookup"><span data-stu-id="43e84-279">Inspect hello **Elastic database monitoring** display which shows hello hottest databases in hello past hour.</span></span> <span data-ttu-id="43e84-280">Hello *contosoconcerthall* base de données doit s’afficher dès qu’une des bases de données plus sensible hello cinq.</span><span class="sxs-lookup"><span data-stu-id="43e84-280">hello *contosoconcerthall* database should soon appear as one of hello five hottest databases.</span></span>
1. <span data-ttu-id="43e84-281">**Cliquez sur l’analyse de base de données élastique hello** **graphique** et qu’il ouvre hello **l’utilisation des ressources de base de données** page où vous pouvez surveiller des bases de données hello.</span><span class="sxs-lookup"><span data-stu-id="43e84-281">**Click on hello Elastic database monitoring** **chart** and it opens hello **Database Resource Utilization** page where you can monitor any of hello databases.</span></span> <span data-ttu-id="43e84-282">Cela vous permet d’isoler l’affichage de hello pour hello *contosoconcerthall* base de données.</span><span class="sxs-lookup"><span data-stu-id="43e84-282">This lets you isolate hello display for hello *contosoconcerthall* database.</span></span>
1. <span data-ttu-id="43e84-283">Dans la liste hello des bases de données, cliquez sur **contosoconcerthall**.</span><span class="sxs-lookup"><span data-stu-id="43e84-283">From hello list of databases, click **contosoconcerthall**.</span></span>
1. <span data-ttu-id="43e84-284">Cliquez sur **niveau tarifaire (échelle dtu)** tooopen hello **configuration des performances** page dans laquelle vous pouvez définir un niveau de performance autonome pour la base de données hello.</span><span class="sxs-lookup"><span data-stu-id="43e84-284">Click **Pricing Tier (scale DTUs)** tooopen hello **Configure performance** page where you can set a stand-alone performance level for hello database.</span></span>
1. <span data-ttu-id="43e84-285">Cliquez sur hello **Standard** onglet options d’échelle hello tooopen niveau Standard de hello.</span><span class="sxs-lookup"><span data-stu-id="43e84-285">Click on hello **Standard** tab tooopen hello scale options in hello Standard tier.</span></span>
1. <span data-ttu-id="43e84-286">Faites glisser hello **curseur DTU** tooright tooselect **100** dtu.</span><span class="sxs-lookup"><span data-stu-id="43e84-286">Slide hello **DTU slider** tooright tooselect **100** DTUs.</span></span> <span data-ttu-id="43e84-287">Notez que cela correspond à toohello objectif de service, **S3**.</span><span class="sxs-lookup"><span data-stu-id="43e84-287">Note this corresponds toohello service objective, **S3**.</span></span>
1. <span data-ttu-id="43e84-288">Cliquez sur **appliquer** toomove hello de base de données en dehors du pool de hello et faites-en un *Standard S3* base de données.</span><span class="sxs-lookup"><span data-stu-id="43e84-288">Click **Apply** toomove hello database out of hello pool and make it a *Standard S3* database.</span></span>
1. <span data-ttu-id="43e84-289">Une fois la mise à l’échelle est terminée, effet de hello analyse sur la base de données contosoconcerthall hello et Pool1 sur des panneaux de base de données et le pool élastique hello.</span><span class="sxs-lookup"><span data-stu-id="43e84-289">Once scaling is complete, monitor hello effect on hello contosoconcerthall database and Pool1 on hello elastic pool and database blades.</span></span>

<span data-ttu-id="43e84-290">Une fois qu’une charge élevée sur la base de données contosoconcerthall hello hello disparaisse vous devez retourner rapidement, toohello pool tooreduce son coût.</span><span class="sxs-lookup"><span data-stu-id="43e84-290">Once hello high load on hello contosoconcerthall database subsides you should promptly return it toohello pool tooreduce its cost.</span></span> <span data-ttu-id="43e84-291">S’il est difficile de savoir qui produira lorsque vous pouvez définir une alerte sur la base de données hello déclenchera lorsque son utilisation DTU inférieur hello par base de données max sur le pool de hello.</span><span class="sxs-lookup"><span data-stu-id="43e84-291">If it’s unclear when that will happen you could set an alert on hello database that will trigger when its DTU usage drops below hello per-database max on hello pool.</span></span> <span data-ttu-id="43e84-292">Le déplacement d’une base de données dans un pool est décrite dans l’exercice 5.</span><span class="sxs-lookup"><span data-stu-id="43e84-292">Moving a database into a pool is described in exercise 5.</span></span>

## <a name="other-performance-management-patterns"></a><span data-ttu-id="43e84-293">Autres modèles de gestion des performances</span><span class="sxs-lookup"><span data-stu-id="43e84-293">Other Performance Management Patterns</span></span>

<span data-ttu-id="43e84-294">**Mise à l’échelle préemptives** dans l’exercice hello ci-dessus dans lequel vous exploré comment tooscale une base de données isolé, vous connaissez le toolook de la base de données pour.</span><span class="sxs-lookup"><span data-stu-id="43e84-294">**Pre-emptive scaling** In hello exercise above where you explored how tooscale an isolated database, you knew which database toolook for.</span></span> <span data-ttu-id="43e84-295">Si Gestion hello de salle de Concert Contoso avait informé Wingtips de vente de ticket imminente hello, base de données hello Impossible ont été déplacé en dehors du pool de hello préalablement.</span><span class="sxs-lookup"><span data-stu-id="43e84-295">If hello management of Contoso Concert Hall had informed Wingtips of hello impending ticket sale, hello database could have been moved out of hello pool pre-emptively.</span></span> <span data-ttu-id="43e84-296">Dans le cas contraire, il aurait probablement requis une alerte sur le pool de hello ou toospot de base de données hello que s’est-il passé.</span><span class="sxs-lookup"><span data-stu-id="43e84-296">Otherwise, it would likely have required an alert on hello pool or hello database toospot what was happening.</span></span> <span data-ttu-id="43e84-297">Vous ne voudriez toolearn à ce sujet de hello autres locataires dans hello pool signale que des problèmes de performances.</span><span class="sxs-lookup"><span data-stu-id="43e84-297">You wouldn’t want toolearn about this from hello other tenants in hello pool complaining of degraded performance.</span></span> <span data-ttu-id="43e84-298">Et si le client de hello capable de prédire la durée pendant laquelle ils devront des ressources supplémentaires, vous pouvez définir un Azure Automation runbook toomove hello de base de données en dehors du pool de hello et puis replacer selon une planification définie.</span><span class="sxs-lookup"><span data-stu-id="43e84-298">And if hello tenant can predict how long they will need additional resources you can set up an Azure Automation runbook toomove hello database out of hello pool and then back in again on a defined schedule.</span></span>

<span data-ttu-id="43e84-299">**Client libre-service mise à l’échelle** , car la mise à l’échelle est une tâche appelée facilement via l’API de gestion hello, vous pouvez facilement créer des bases de données clientes tooscale de possibilité de hello dans votre application côté client et il offre une fonctionnalité de votre service SaaS.</span><span class="sxs-lookup"><span data-stu-id="43e84-299">**Tenant self-service scaling** Because scaling is a task easily called via hello management API, you can easily build hello ability tooscale tenant databases into your tenant-facing application, and offer it as a feature of your SaaS service.</span></span> <span data-ttu-id="43e84-300">Par exemple, permettent aux clients administrer l’évolutivité, sans doute lié directement tootheir facturation !</span><span class="sxs-lookup"><span data-stu-id="43e84-300">For example, let tenants self-administer scaling up and down, perhaps linked directly tootheir billing!</span></span>

<span data-ttu-id="43e84-301">**Mise à l’échelle un pool de haut et bas sur des modèles d’utilisation toomatch planification**</span><span class="sxs-lookup"><span data-stu-id="43e84-301">**Scaling a pool up and down on a schedule toomatch usage patterns**</span></span>

<span data-ttu-id="43e84-302">Lorsque l’utilisation d’agrégation clients suit les modèles d’utilisation prévisible, vous pouvez utiliser Azure Automation tooscale un pool de haut et bas selon une planification.</span><span class="sxs-lookup"><span data-stu-id="43e84-302">Where aggregate tenant usage follows predictable usage patterns, you can use Azure Automation tooscale a pool up and down on a schedule.</span></span> <span data-ttu-id="43e84-303">Par exemple, diminuez la taille d’un pool après 18 h et avant 6 h en semaine lorsque vous savez que les besoins en ressources baissent.</span><span class="sxs-lookup"><span data-stu-id="43e84-303">For example, scale a pool down after 6pm and up again before 6am on weekdays when you know there is a drop in resource requirements.</span></span>



## <a name="next-steps"></a><span data-ttu-id="43e84-304">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="43e84-304">Next steps</span></span>

<span data-ttu-id="43e84-305">Ce didacticiel vous explique comment effectuer les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="43e84-305">In this tutorial you learn how to:</span></span>

> [!div class="checklist"]
> * <span data-ttu-id="43e84-306">Simuler l’utilisation de bases de données clientes hello en exécutant un générateur de charge fourni</span><span class="sxs-lookup"><span data-stu-id="43e84-306">Simulate usage on hello tenant databases by running a provided load generator</span></span>
> * <span data-ttu-id="43e84-307">Client de hello analyse des bases de données qu’ils répondent augmentation toohello charge</span><span class="sxs-lookup"><span data-stu-id="43e84-307">Monitor hello tenant databases as they respond toohello increase in load</span></span>
> * <span data-ttu-id="43e84-308">Montée en puissance hello pool élastique dans réponse toohello accrue de la base de données de charge</span><span class="sxs-lookup"><span data-stu-id="43e84-308">Scale up hello Elastic pool in response toohello increased database load</span></span>
> * <span data-ttu-id="43e84-309">Configurer une deuxième activité de base de données d’hello de solde de tooload pool élastique</span><span class="sxs-lookup"><span data-stu-id="43e84-309">Provision a second Elastic pool tooload balance hello database activity</span></span>

[<span data-ttu-id="43e84-310">Didacticiel Restaurer une base de données à locataire unique</span><span class="sxs-lookup"><span data-stu-id="43e84-310">Restore a single tenant tutorial</span></span>](sql-database-saas-tutorial-restore-single-tenant.md)


## <a name="additional-resources"></a><span data-ttu-id="43e84-311">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="43e84-311">Additional resources</span></span>

* <span data-ttu-id="43e84-312">Supplémentaires [didacticiels qui reposent sur hello déploiement d’application Wingtip SaaS](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span><span class="sxs-lookup"><span data-stu-id="43e84-312">Additional [tutorials that build upon hello Wingtip SaaS application deployment](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span></span>
* [<span data-ttu-id="43e84-313">Pools élastiques SQL</span><span class="sxs-lookup"><span data-stu-id="43e84-313">SQL Elastic pools</span></span>](sql-database-elastic-pool.md)
* [<span data-ttu-id="43e84-314">Azure Automation</span><span class="sxs-lookup"><span data-stu-id="43e84-314">Azure automation</span></span>](../automation/automation-intro.md)
* <span data-ttu-id="43e84-315">[Log Analytics](sql-database-saas-tutorial-log-analytics.md) - Didacticiel Configuration et utilisation de Log Analytics</span><span class="sxs-lookup"><span data-stu-id="43e84-315">[Log Analytics](sql-database-saas-tutorial-log-analytics.md) - Setting up and using Log Analytics tutorial</span></span>
