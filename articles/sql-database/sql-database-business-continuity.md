---
title: "continuité des activités aaaCloud - récupération de base de données - base de données SQL | Documents Microsoft"
description: "Découvrez comment Azure SQL Database prend en charge la continuité des activités cloud et la récupération de base de données et vous aide à maintenir les applications cloud opérationnelles."
keywords: "continuité des activités, continuité des activités cloud, récupération d’urgence de base de données, récupération de base de données"
services: sql-database
documentationcenter: 
author: anosov1960
manager: jhubbard
editor: 
ms.assetid: 18e5d3f1-bfe5-4089-b6fd-76988ab29822
ms.service: sql-database
ms.custom: business continuity
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 05/15/2017
ms.author: sashan
ms.openlocfilehash: c9a6ff86fbbc04ce839a4fca79594b573b71644c
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="overview-of-business-continuity-with-azure-sql-database"></a><span data-ttu-id="52617-104">Vue d’ensemble de la continuité de l’activité avec la base de données Azure SQL</span><span class="sxs-lookup"><span data-stu-id="52617-104">Overview of business continuity with Azure SQL Database</span></span>

<span data-ttu-id="52617-105">Cette présentation décrit les fonctions hello servant de base de données SQL Azure pour la continuité d’activité et de récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="52617-105">This overview describes hello capabilities that Azure SQL Database provides for business continuity and disaster recovery.</span></span> <span data-ttu-id="52617-106">En savoir plus sur les options, les recommandations et les didacticiels de récupération à partir des interruptions qui pourraient provoquer une perte de données ou votre toobecome de base de données et d’application non disponible.</span><span class="sxs-lookup"><span data-stu-id="52617-106">Learn about options, recommendations, and tutorials for recovering from disruptive events that could cause data loss or cause your database and application toobecome unavailable.</span></span> <span data-ttu-id="52617-107">Découvrez quels toodo lorsqu’une erreur de l’utilisateur ou l’application affecte l’intégrité des données, une région Azure a une panne ou votre application requiert une maintenance.</span><span class="sxs-lookup"><span data-stu-id="52617-107">Learn what toodo when a user or application error affects data integrity, an Azure region has an outage, or your application requires maintenance.</span></span>

## <a name="sql-database-features-that-you-can-use-tooprovide-business-continuity"></a><span data-ttu-id="52617-108">Fonctionnalités de base de données SQL que vous pouvez utiliser la continuité des activités tooprovide</span><span class="sxs-lookup"><span data-stu-id="52617-108">SQL Database features that you can use tooprovide business continuity</span></span>

<span data-ttu-id="52617-109">La base de données SQL fournit plusieurs fonctionnalités de continuité d’activité, notamment des sauvegardes automatisées et une réplication facultative de la base de données.</span><span class="sxs-lookup"><span data-stu-id="52617-109">SQL Database provides several business continuity features, including automated backups and optional database replication.</span></span> <span data-ttu-id="52617-110">Chacune de ces fonctionnalités possède des caractéristiques spécifiques concernant le temps de récupération estimé (ERT) et le risque de perte de données pour les transactions récentes.</span><span class="sxs-lookup"><span data-stu-id="52617-110">Each has different characteristics for estimated recovery time (ERT) and potential data loss for recent transactions.</span></span> <span data-ttu-id="52617-111">Une fois que vous avez compris ces options, vous pouvez choisir celles qui vous conviennent et, dans la plupart des scénarios, les utiliser ensemble dans différents scénarios.</span><span class="sxs-lookup"><span data-stu-id="52617-111">Once you understand these options, you can choose among them - and, in most scenarios, use them together for different scenarios.</span></span> <span data-ttu-id="52617-112">Lorsque vous développez votre plan de continuité des activités, vous devez toounderstand hello acceptable durée maximale avant que l’application hello récupère entièrement après un événement perturbateur de hello - il s’agit votre objectif de temps de récupération (RTO).</span><span class="sxs-lookup"><span data-stu-id="52617-112">As you develop your business continuity plan, you need toounderstand hello maximum acceptable time before hello application fully recovers after hello disruptive event - this is your recovery time objective (RTO).</span></span> <span data-ttu-id="52617-113">Vous devez également toounderstand quantité maximale de hello d’application de hello récentes données mises à jour (intervalle de temps) peut tolérer perdre lors de la récupération après un événement perturbateur de hello - il s’agit votre objectif de point de récupération (RPO).</span><span class="sxs-lookup"><span data-stu-id="52617-113">You also need toounderstand hello maximum amount of recent data updates (time interval) hello application can tolerate losing when recovering after hello disruptive event - this is your recovery point objective (RPO).</span></span>

<span data-ttu-id="52617-114">Hello suivant compare la table hello ERT et le RPO pour les scénarios les plus courants hello trois.</span><span class="sxs-lookup"><span data-stu-id="52617-114">hello following table compares hello ERT and RPO for hello three most common scenarios.</span></span>

| <span data-ttu-id="52617-115">Fonctionnalité</span><span class="sxs-lookup"><span data-stu-id="52617-115">Capability</span></span> | <span data-ttu-id="52617-116">Niveau de base</span><span class="sxs-lookup"><span data-stu-id="52617-116">Basic tier</span></span> | <span data-ttu-id="52617-117">Niveau standard</span><span class="sxs-lookup"><span data-stu-id="52617-117">Standard tier</span></span> | <span data-ttu-id="52617-118">Niveau Premium</span><span class="sxs-lookup"><span data-stu-id="52617-118">Premium tier</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="52617-119">Limite de restauration dans le temps à partir de la sauvegarde</span><span class="sxs-lookup"><span data-stu-id="52617-119">Point in Time Restore from backup</span></span> |<span data-ttu-id="52617-120">Tout point de restauration dans un délai de 7 jours</span><span class="sxs-lookup"><span data-stu-id="52617-120">Any restore point within 7 days</span></span> |<span data-ttu-id="52617-121">Tout point de restauration dans un délai de 35 jours</span><span class="sxs-lookup"><span data-stu-id="52617-121">Any restore point within 35 days</span></span> |<span data-ttu-id="52617-122">Tout point de restauration dans un délai de 35 jours</span><span class="sxs-lookup"><span data-stu-id="52617-122">Any restore point within 35 days</span></span> |
| <span data-ttu-id="52617-123">Géo-restauration à partir de sauvegardes répliquées géographiquement</span><span class="sxs-lookup"><span data-stu-id="52617-123">Geo-restore from geo-replicated backups</span></span> |<span data-ttu-id="52617-124">ERT < 12 h, RPO < 1 h</span><span class="sxs-lookup"><span data-stu-id="52617-124">ERT < 12h, RPO < 1h</span></span> |<span data-ttu-id="52617-125">ERT < 12 h, RPO < 1 h</span><span class="sxs-lookup"><span data-stu-id="52617-125">ERT < 12h, RPO < 1h</span></span> |<span data-ttu-id="52617-126">ERT < 12 h, RPO < 1 h</span><span class="sxs-lookup"><span data-stu-id="52617-126">ERT < 12h, RPO < 1h</span></span> |
| <span data-ttu-id="52617-127">Restauration à partir d’Azure Backup Vault</span><span class="sxs-lookup"><span data-stu-id="52617-127">Restore from Azure Backup Vault</span></span> |<span data-ttu-id="52617-128">ERT < 12 h, RPO < 1 sem.</span><span class="sxs-lookup"><span data-stu-id="52617-128">ERT < 12h, RPO < 1 wk</span></span> |<span data-ttu-id="52617-129">ERT < 12 h, RPO < 1 sem.</span><span class="sxs-lookup"><span data-stu-id="52617-129">ERT < 12h, RPO < 1 wk</span></span> |<span data-ttu-id="52617-130">ERT < 12 h, RPO < 1 sem.</span><span class="sxs-lookup"><span data-stu-id="52617-130">ERT < 12h, RPO < 1 wk</span></span> |
| <span data-ttu-id="52617-131">Géo-réplication active</span><span class="sxs-lookup"><span data-stu-id="52617-131">Active geo-replication</span></span> |<span data-ttu-id="52617-132">ERT < 30s, RPO < 5s</span><span class="sxs-lookup"><span data-stu-id="52617-132">ERT < 30s, RPO < 5s</span></span> |<span data-ttu-id="52617-133">ERT < 30s, RPO < 5s</span><span class="sxs-lookup"><span data-stu-id="52617-133">ERT < 30s, RPO < 5s</span></span> |<span data-ttu-id="52617-134">ERT < 30s, RPO < 5s</span><span class="sxs-lookup"><span data-stu-id="52617-134">ERT < 30s, RPO < 5s</span></span> |

### <a name="use-database-backups-toorecover-a-database"></a><span data-ttu-id="52617-135">Utilisez des sauvegardes de base de données toorecover une base de données</span><span class="sxs-lookup"><span data-stu-id="52617-135">Use database backups toorecover a database</span></span>

<span data-ttu-id="52617-136">Base de données SQL effectue automatiquement une combinaison de sauvegardes de base de données complète une fois par semaine, toutes les heures des sauvegardes différentielles de base de données, journaux des transactions et sauvegardes de toutes les cinq-dix minutes tooprotect votre entreprise contre la perte de données.</span><span class="sxs-lookup"><span data-stu-id="52617-136">SQL Database automatically performs a combination of full database backups weekly, differential database backups hourly, and transaction log backups every five - ten minutes tooprotect your business from data loss.</span></span> <span data-ttu-id="52617-137">Ces sauvegardes sont stockées dans le stockage géo-redondant de 35 jours pour les bases de données dans les niveaux de service Standard et Premium hello et 7 jours pour les bases de données de niveau de service Basic de hello.</span><span class="sxs-lookup"><span data-stu-id="52617-137">These backups are stored in geo-redundant storage for 35 days for databases in hello Standard and Premium service tiers and 7 days for databases in hello Basic service tier.</span></span> <span data-ttu-id="52617-138">Pour en savoir plus, consultez les [niveaux de service](sql-database-service-tiers.md).</span><span class="sxs-lookup"><span data-stu-id="52617-138">For more information, see [service tiers](sql-database-service-tiers.md).</span></span> <span data-ttu-id="52617-139">Si la période de rétention hello pour votre niveau de service ne répond pas à vos besoins, vous pouvez augmenter la période de rétention hello en [la modification du niveau de service hello](sql-database-service-tiers.md).</span><span class="sxs-lookup"><span data-stu-id="52617-139">If hello retention period for your service tier does not meet your business requirements, you can increase hello retention period by [changing hello service tier](sql-database-service-tiers.md).</span></span> <span data-ttu-id="52617-140">Hello sauvegardes complètes et différentielles de base de données sont également répliquée tooa [centre de données associés](../best-practices-availability-paired-regions.md) pour la protection contre la panne du centre de données.</span><span class="sxs-lookup"><span data-stu-id="52617-140">hello full and differential database backups are also replicated tooa [paired data center](../best-practices-availability-paired-regions.md) for protection against a data center outage.</span></span> <span data-ttu-id="52617-141">Pour plus d’informations, consultez la rubrique concernant les [sauvegardes de base de données automatiques](sql-database-automated-backups.md).</span><span class="sxs-lookup"><span data-stu-id="52617-141">For more information, see [automatic database backups](sql-database-automated-backups.md).</span></span>

<span data-ttu-id="52617-142">Si la période de rétention intégrés hello n’est pas suffisante pour votre application, vous pouvez l’étendre en configurant une stratégie de rétention à long terme de base de données.</span><span class="sxs-lookup"><span data-stu-id="52617-142">If hello built-in retention period is not sufficient for your application, you can extend it by configuring a database long-term retention policy.</span></span> <span data-ttu-id="52617-143">Pour plus d’informations, consultez [rétention à long terme](sql-database-long-term-retention.md).</span><span class="sxs-lookup"><span data-stu-id="52617-143">For more information, see [long-term retention](sql-database-long-term-retention.md).</span></span>

<span data-ttu-id="52617-144">Vous pouvez utiliser ces toorecover de sauvegardes de base de données automatique une base de données à partir de divers événements d’interruption de service, à la fois au sein de votre centre de données et le centre de données tooanother.</span><span class="sxs-lookup"><span data-stu-id="52617-144">You can use these automatic database backups toorecover a database from various disruptive events, both within your data center and tooanother data center.</span></span> <span data-ttu-id="52617-145">À l’aide de sauvegardes de base de données automatique, hello estimé temps de récupération dépend de plusieurs facteurs, notamment le nombre total de hello de bases de données de récupération Bonjour même région de hello en même temps, hello la taille de la base de données, taille du journal de transactions de hello et la bande passante réseau.</span><span class="sxs-lookup"><span data-stu-id="52617-145">Using automatic database backups, hello estimated time of recovery depends on several factors including hello total number of databases recovering in hello same region at hello same time, hello database size, hello transaction log size, and network bandwidth.</span></span> <span data-ttu-id="52617-146">temps de récupération Hello est généralement inférieure à 12 heures.</span><span class="sxs-lookup"><span data-stu-id="52617-146">hello recovery time is usually less than 12 hours.</span></span> <span data-ttu-id="52617-147">Lorsque vous récupérez la région de données tooanother, la perte potentielle de données hello est heure too1 limité par le stockage géo-redondant hello des sauvegardes de base de données différentielle toutes les heures.</span><span class="sxs-lookup"><span data-stu-id="52617-147">When recovering tooanother data region, hello potential data loss is limited too1 hour by hello geo-redundant storage of hourly differential database backups.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="52617-148">toorecover à l’aide des sauvegardes automatisées, vous devez être membre du rôle de collaborateur du serveur SQL hello ou propriétaire de l’abonnement hello - voir [RBAC : rôles intégrés](../active-directory/role-based-access-built-in-roles.md).</span><span class="sxs-lookup"><span data-stu-id="52617-148">toorecover using automated backups, you must be a member of hello SQL Server Contributor role or hello subscription owner - see [RBAC: Built-in roles](../active-directory/role-based-access-built-in-roles.md).</span></span> <span data-ttu-id="52617-149">Vous pouvez récupérer à l’aide de hello portail Azure, PowerShell ou hello API REST.</span><span class="sxs-lookup"><span data-stu-id="52617-149">You can recover using hello Azure portal, PowerShell, or hello REST API.</span></span> <span data-ttu-id="52617-150">Vous ne pouvez pas utiliser Transact-SQL.</span><span class="sxs-lookup"><span data-stu-id="52617-150">You cannot use Transact-SQL.</span></span>
>

<span data-ttu-id="52617-151">Utilisez des sauvegardes automatisées comme mécanisme de continuité d’activité et de récupération si votre application :</span><span class="sxs-lookup"><span data-stu-id="52617-151">Use automated backups as your business continuity and recovery mechanism if your application:</span></span>

* <span data-ttu-id="52617-152">N'est pas essentielle.</span><span class="sxs-lookup"><span data-stu-id="52617-152">Is not considered mission critical.</span></span>
* <span data-ttu-id="52617-153">N’a pas de contrat SLA contraignant, une interruption de service de 24 heures ou plus n’entraîne pas la responsabilité financière.</span><span class="sxs-lookup"><span data-stu-id="52617-153">Doesn't have a binding SLA - a downtime of 24 hours or longer does not result in financial liability.</span></span>
* <span data-ttu-id="52617-154">A un faible taux de modification des données (basses transactions par heure) et la perte de tooan heure de modification est une perte de données acceptable.</span><span class="sxs-lookup"><span data-stu-id="52617-154">Has a low rate of data change (low transactions per hour) and losing up tooan hour of change is an acceptable data loss.</span></span>
* <span data-ttu-id="52617-155">Est sensible aux coûts.</span><span class="sxs-lookup"><span data-stu-id="52617-155">Is cost sensitive.</span></span>

<span data-ttu-id="52617-156">Si vous avez besoin d’une récupération plus rapide, utilisez une [géo-réplication active](sql-database-geo-replication-overview.md) (abordée plus loin).</span><span class="sxs-lookup"><span data-stu-id="52617-156">If you need faster recovery, use [active geo-replication](sql-database-geo-replication-overview.md) (discussed next).</span></span> <span data-ttu-id="52617-157">Si vous avez besoin d’une période antérieure à 35 jours toobe toorecover en mesure de données, utilisez [rétention de sauvegarde à long terme](sql-database-long-term-retention.md).</span><span class="sxs-lookup"><span data-stu-id="52617-157">If you need toobe able toorecover data from a period older than 35 days, use [long-term backup retention](sql-database-long-term-retention.md).</span></span> 

### <a name="use-active-geo-replication-and-auto-failover-groups-in-preview-tooreduce-recovery-time-and-limit-data-loss-associated-with-a-recovery"></a><span data-ttu-id="52617-158">Utiliser active géo-réplication et le basculement automatique groupes (en version préliminaire) tooreduce récupération temps et limite de perte de données associée à une récupération</span><span class="sxs-lookup"><span data-stu-id="52617-158">Use active geo-replication and auto-failover groups (in-preview) tooreduce recovery time and limit data loss associated with a recovery</span></span>

<span data-ttu-id="52617-159">En outre toousing les sauvegardes de base de données pour la base de données récupération si une interruption se produit, vous pouvez utiliser [géo-réplication active](sql-database-geo-replication-overview.md) tooconfigure un toohave de base de données toofour lisible secondaire bases de données dans des régions hello de votre choix.</span><span class="sxs-lookup"><span data-stu-id="52617-159">In addition toousing database backups for database recovery if a business disruption occurs, you can use [active geo-replication](sql-database-geo-replication-overview.md) tooconfigure a database toohave up toofour readable secondary databases in hello regions of your choice.</span></span> <span data-ttu-id="52617-160">Ces bases de données secondaires sont synchronisés avec la base de données primaire hello à l’aide d’un mécanisme de réplication asynchrone.</span><span class="sxs-lookup"><span data-stu-id="52617-160">These secondary databases are kept synchronized with hello primary database using an asynchronous replication mechanism.</span></span> <span data-ttu-id="52617-161">Cette fonctionnalité est tooprotect utilisé par rapport à l’interruption de service en cas de panne du centre de données ou une mise à niveau de l’application.</span><span class="sxs-lookup"><span data-stu-id="52617-161">This feature is used tooprotect against business disruption if a data center outage occurs or during an application upgrade.</span></span> <span data-ttu-id="52617-162">Géo-réplication Active peut également être utilisé tooprovide de meilleures performances de requête pour les utilisateurs toogeographically dispersé de requêtes en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="52617-162">Active geo-replication can also be used tooprovide better query performance for read-only queries toogeographically dispersed users.</span></span>

<span data-ttu-id="52617-163">tooenable automatisée et de basculement transparent, vous devez organiser vos bases de données répliquées en groupes à l’aide de hello [groupe de basculement automatique](sql-database-geo-replication-overview.md) fonctionnalité de base de données SQL (en version préliminaire).</span><span class="sxs-lookup"><span data-stu-id="52617-163">tooenable automated and transparent failover you should organize your geo-replicated databases into groups using hello [auto-failover group](sql-database-geo-replication-overview.md) feature of SQL Database (in-preview).</span></span>

<span data-ttu-id="52617-164">Si la base de données primaire hello est mise hors connexion de façon inattendue ou si vous devez tootake hors connexion pour les activités de maintenance, vous pouvez rapidement promouvoir principal hello toobecome secondaire (également appelé un basculement) et de configurer des principal de toohello promue tooconnect applications.</span><span class="sxs-lookup"><span data-stu-id="52617-164">If hello primary database goes offline unexpectedly or you need tootake it offline for maintenance activities, you can quickly promote a secondary toobecome hello primary (also called a failover) and configure applications tooconnect toohello promoted primary.</span></span> <span data-ttu-id="52617-165">Si votre application se connecte toohello de bases de données à l’aide d’écouteur du groupe de basculement hello, vous n’avez pas besoin configuration de chaîne de connexion toochange hello SQL après le basculement.</span><span class="sxs-lookup"><span data-stu-id="52617-165">If your application is connecting toohello databases using hello failover group listener, you don’t need toochange hello SQL connection string configuration after failover.</span></span> <span data-ttu-id="52617-166">Le basculement planifié évite toute perte de données.</span><span class="sxs-lookup"><span data-stu-id="52617-166">With a planned failover, there is no data loss.</span></span> <span data-ttu-id="52617-167">Un basculement non planifié, il peut être d’une petite quantité de perte de données pour les transactions en raison de la nature de toohello très récentes de la réplication asynchrone.</span><span class="sxs-lookup"><span data-stu-id="52617-167">With an unplanned failover, there may be some small amount of data loss for very recent transactions due toohello nature of asynchronous replication.</span></span> <span data-ttu-id="52617-168">À l’aide de groupes de basculement automatique (en version préliminaire), vous pouvez personnaliser hello basculement stratégie toominimize hello perdre des données.</span><span class="sxs-lookup"><span data-stu-id="52617-168">Using auto-failover groups (in-preview), you can customize hello failover policy toominimize hello potential data loss.</span></span> <span data-ttu-id="52617-169">Après un basculement, vous pouvez la restauration ultérieure - conséquente tooa plan ou lorsque du centre de données de hello revient en ligne.</span><span class="sxs-lookup"><span data-stu-id="52617-169">After a failover, you can later failback - either according tooa plan or when hello data center comes back online.</span></span> <span data-ttu-id="52617-170">Dans tous les cas, les utilisateurs rencontrer une petite quantité de temps d’arrêt et doivent tooreconnect.</span><span class="sxs-lookup"><span data-stu-id="52617-170">In all cases, users experience a small amount of downtime and need tooreconnect.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="52617-171">géo-réplication active toouse et les groupes de basculement automatique (en version préliminaire), vous devez être propriétaire de l’abonnement de hello ou disposer des autorisations d’administration dans SQL Server.</span><span class="sxs-lookup"><span data-stu-id="52617-171">toouse active geo-replication and auto-failover groups (in-preview), you must either be hello subscription owner or have administrative permissions in SQL Server.</span></span> <span data-ttu-id="52617-172">Vous pouvez configurer et basculer à l’aide de hello portail Azure, PowerShell ou hello API REST à l’aide d’autorisations d’abonnement Azure ou à l’aide de Transact-SQL avec des autorisations SQL Server.</span><span class="sxs-lookup"><span data-stu-id="52617-172">You can configure and fail over using hello Azure portal, PowerShell, or hello REST API using Azure subscription permissions or using Transact-SQL with SQL Server permissions.</span></span>
> 

<span data-ttu-id="52617-173">Utilisez la géo-réplication active et les groupes de basculement automatique (en version préliminaire) si votre application répond à l’un des critères suivants :</span><span class="sxs-lookup"><span data-stu-id="52617-173">Use active geo-replication and auto-failover groups (in preview) if your application meets any of these criteria:</span></span>

* <span data-ttu-id="52617-174">Est essentielle.</span><span class="sxs-lookup"><span data-stu-id="52617-174">Is mission critical.</span></span>
* <span data-ttu-id="52617-175">A un contrat de niveau de service (SLA) qui n’autorise pas plus de 24 heures d’interruption de service.</span><span class="sxs-lookup"><span data-stu-id="52617-175">Has a service level agreement (SLA) that does not allow for 24 hours or more of downtime.</span></span>
* <span data-ttu-id="52617-176">Toute interruption de service peut engager la responsabilité financière.</span><span class="sxs-lookup"><span data-stu-id="52617-176">Downtime may result in financial liability.</span></span>
* <span data-ttu-id="52617-177">Affiche un taux élevé de données modifiées et la perte d’une heure de données n’est pas acceptable.</span><span class="sxs-lookup"><span data-stu-id="52617-177">Has a high rate of data change is high and losing an hour of data is not acceptable.</span></span>
* <span data-ttu-id="52617-178">coût supplémentaire en Hello géo-réplication active est inférieure à la responsabilité financière hello et entraîne une perte de l’entreprise.</span><span class="sxs-lookup"><span data-stu-id="52617-178">hello additional cost of active geo-replication is lower than hello potential financial liability and associated loss of business.</span></span>

>
> [!VIDEO https://channel9.msdn.com/Blogs/Azure/Azure-SQL-Database-protecting-important-DBs-from-regional-disasters-is-easy/player]
>

## <a name="recover-a-database-after-a-user-or-application-error"></a><span data-ttu-id="52617-179">Récupérer une base de données après une erreur d’utilisateur ou d’application</span><span class="sxs-lookup"><span data-stu-id="52617-179">Recover a database after a user or application error</span></span>
<span data-ttu-id="52617-180">* Personne n’est parfait !</span><span class="sxs-lookup"><span data-stu-id="52617-180">*No one is perfect!</span></span> <span data-ttu-id="52617-181">Un utilisateur peut supprimer par inadvertance des données, un tableau important voire une base de données tout entière.</span><span class="sxs-lookup"><span data-stu-id="52617-181">A user might accidentally delete some data, inadvertently drop an important table, or even drop an entire database.</span></span> <span data-ttu-id="52617-182">Ou bien, une application peut accidentellement bonnes données avec des données erronées en raison de l’erreur d’application tooan.</span><span class="sxs-lookup"><span data-stu-id="52617-182">Or, an application might accidentally overwrite good data with bad data due tooan application defect.</span></span>

<span data-ttu-id="52617-183">Dans ce scénario, voici les options de récupération dont vous disposez.</span><span class="sxs-lookup"><span data-stu-id="52617-183">In this scenario, these are your recovery options.</span></span>

### <a name="perform-a-point-in-time-restore"></a><span data-ttu-id="52617-184">Effectuer une limite de restauration dans le temps</span><span class="sxs-lookup"><span data-stu-id="52617-184">Perform a point-in-time restore</span></span>
<span data-ttu-id="52617-185">Vous pouvez utiliser hello automatisée sauvegardes toorecover une copie de votre tooa de base de données appelée point de référence dans le temps, pour autant que l’heure est au sein de la période de rétention de base de données hello.</span><span class="sxs-lookup"><span data-stu-id="52617-185">You can use hello automated backups toorecover a copy of your database tooa known good point in time, provided that time is within hello database retention period.</span></span> <span data-ttu-id="52617-186">Après la restauration de la base de données hello, vous pouvez remplacer la base de données d’origine hello avec la base de données restaurée de hello ou copier des données de hello nécessité à partir des données de hello restauré dans la base de données d’origine hello.</span><span class="sxs-lookup"><span data-stu-id="52617-186">After hello database is restored, you can either replace hello original database with hello restored database or copy hello needed data from hello restored data into hello original database.</span></span> <span data-ttu-id="52617-187">Si la base de données hello utilise la géo-réplication active, nous vous recommandons de copier les données de hello requis à partir de la copie de hello restauré dans la base de données d’origine hello.</span><span class="sxs-lookup"><span data-stu-id="52617-187">If hello database uses active geo-replication, we recommend copying hello required data from hello restored copy into hello original database.</span></span> <span data-ttu-id="52617-188">Si vous remplacez la base de données d’origine hello avec la base de données restaurée de hello, vous devez tooreconfigure et resynchronisez les géo-réplication active (ce qui peut prendre un certain temps pour une base de données volumineux).</span><span class="sxs-lookup"><span data-stu-id="52617-188">If you replace hello original database with hello restored database, you need tooreconfigure and resynchronize active geo-replication (which can take quite some time for a large database).</span></span>

<span data-ttu-id="52617-189">Pour plus d’informations et pour obtenir des instructions détaillées pour la restauration d’un point de tooa de base de données à l’aide de l’heure hello portail Azure ou à l’aide de PowerShell, consultez [point-à-temps restauration](sql-database-recovery-using-backups.md#point-in-time-restore).</span><span class="sxs-lookup"><span data-stu-id="52617-189">For more information and for detailed steps for restoring a database tooa point in time using hello Azure portal or using PowerShell, see [point-in-time restore](sql-database-recovery-using-backups.md#point-in-time-restore).</span></span> <span data-ttu-id="52617-190">Vous ne pouvez pas effectuer une récupération à l’aide de Transact-SQL.</span><span class="sxs-lookup"><span data-stu-id="52617-190">You cannot recover using Transact-SQL.</span></span>

### <a name="restore-a-deleted-database"></a><span data-ttu-id="52617-191">restauration d’une base de données supprimée.</span><span class="sxs-lookup"><span data-stu-id="52617-191">Restore a deleted database</span></span>
<span data-ttu-id="52617-192">Si hello de base de données est supprimée, mais le serveur logique de hello n’a pas été supprimé, vous pouvez restaurer le point de toohello hello supprimé de base de données à laquelle il a été supprimé.</span><span class="sxs-lookup"><span data-stu-id="52617-192">If hello database is deleted but hello logical server has not been deleted, you can restore hello deleted database toohello point at which it was deleted.</span></span> <span data-ttu-id="52617-193">Cette opération restaure un toohello de sauvegarde de base de données même logique SQL server à partir de laquelle il a été supprimé.</span><span class="sxs-lookup"><span data-stu-id="52617-193">This restores a database backup toohello same logical SQL server from which it was deleted.</span></span> <span data-ttu-id="52617-194">Vous pouvez restaurer à l’aide du nom d’origine de hello ou fournir un nouveau nom ou la base de données restaurée de hello.</span><span class="sxs-lookup"><span data-stu-id="52617-194">You can restore it using hello original name or provide a new name or hello restored database.</span></span>

<span data-ttu-id="52617-195">Pour plus d’informations et pour obtenir des instructions détaillées pour la restauration d’une base de données supprimée à l’aide de hello portail Azure ou à l’aide de PowerShell, consultez [restaurer une base de données supprimée](sql-database-recovery-using-backups.md#deleted-database-restore).</span><span class="sxs-lookup"><span data-stu-id="52617-195">For more information and for detailed steps for restoring a deleted database using hello Azure portal or using PowerShell, see [restore a deleted database](sql-database-recovery-using-backups.md#deleted-database-restore).</span></span> <span data-ttu-id="52617-196">Vous ne pouvez pas restaurer à l’aide de Transact-SQL.</span><span class="sxs-lookup"><span data-stu-id="52617-196">You cannot restore using Transact-SQL.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="52617-197">Si le serveur logique de hello est supprimé, vous ne pouvez pas récupérer une base de données supprimée.</span><span class="sxs-lookup"><span data-stu-id="52617-197">If hello logical server is deleted, you cannot recover a deleted database.</span></span>
>
>

### <a name="restore-from-azure-backup-vault"></a><span data-ttu-id="52617-198">Restauration à partir d’Azure Backup Vault</span><span class="sxs-lookup"><span data-stu-id="52617-198">Restore from Azure Backup Vault</span></span>
<span data-ttu-id="52617-199">Si la perte de données hello s’est produite en dehors de la période de rétention actuelle hello pour les sauvegardes automatisées et votre base de données est configurée pour la rétention à long terme, vous pouvez restaurer à partir d’une sauvegarde hebdomadaire dans le coffre de sauvegarde Azure tooa nouvelle base de données.</span><span class="sxs-lookup"><span data-stu-id="52617-199">If hello data loss occurred outside hello current retention period for automated backups and your database is configured for long-term retention, you can restore from a weekly backup in Azure Backup Vault tooa new database.</span></span> <span data-ttu-id="52617-200">À ce stade, vous pouvez remplacer la base de données d’origine hello avec la base de données restaurée de hello ou copier des données de hello nécessité à partir de la base de données hello restauré dans la base de données d’origine hello.</span><span class="sxs-lookup"><span data-stu-id="52617-200">At this point, you can either replace hello original database with hello restored database or copy hello needed data from hello restored database into hello original database.</span></span> <span data-ttu-id="52617-201">Si vous devez tooretrieve une ancienne version de votre mise à niveau de base de données antérieure tooa application majeures, satisfaire une demande à partir de comptes ou d’un ordre juridique, que vous pouvez créer une base de données à l’aide d’une sauvegarde complète est enregistrée dans hello coffre de sauvegarde Azure.</span><span class="sxs-lookup"><span data-stu-id="52617-201">If you need tooretrieve an old version of your database prior tooa major application upgrade, satisfy a request from auditors or a legal order, you can create a database using a full backup saved in hello Azure Backup Vault.</span></span>  <span data-ttu-id="52617-202">Pour plus d’informations, consultez [Rétention à long terme](sql-database-long-term-retention.md).</span><span class="sxs-lookup"><span data-stu-id="52617-202">For more information, see [Long-term retention](sql-database-long-term-retention.md).</span></span>

## <a name="recover-a-database-tooanother-region-from-an-azure-regional-data-center-outage"></a><span data-ttu-id="52617-203">Récupérer une région tooanother de base de données à partir d’une panne de centre de données régional Azure</span><span class="sxs-lookup"><span data-stu-id="52617-203">Recover a database tooanother region from an Azure regional data center outage</span></span>
<!-- Explain this scenario -->

<span data-ttu-id="52617-204">Bien que le fait soit rare, un centre de données Azure peut subir une panne.</span><span class="sxs-lookup"><span data-stu-id="52617-204">Although rare, an Azure data center can have an outage.</span></span> <span data-ttu-id="52617-205">En cas de panne, il entraîne une interruption de service qui peut durer de quelques minutes à plusieurs heures.</span><span class="sxs-lookup"><span data-stu-id="52617-205">When an outage occurs, it causes a business disruption that might only last a few minutes or might last for hours.</span></span>

* <span data-ttu-id="52617-206">Une option consiste toowait pour votre toocome de la base de données en ligne lors de la panne de centre de données hello.</span><span class="sxs-lookup"><span data-stu-id="52617-206">One option is toowait for your database toocome back online when hello data center outage is over.</span></span> <span data-ttu-id="52617-207">Cela fonctionne pour les applications qui supportent toohave hello de base de données hors connexion.</span><span class="sxs-lookup"><span data-stu-id="52617-207">This works for applications that can afford toohave hello database offline.</span></span> <span data-ttu-id="52617-208">Par exemple, un projet de développement ou de la version d’évaluation gratuite vous n’avez pas besoin toowork sur constamment.</span><span class="sxs-lookup"><span data-stu-id="52617-208">For example, a development project or free trial you don't need toowork on constantly.</span></span> <span data-ttu-id="52617-209">Lorsqu’un centre de données a une panne, vous ne connaissez pas la durée pendant laquelle la panne de hello peut durer, afin que cette option fonctionne uniquement si vous n’avez pas besoin votre base de données pendant un certain temps.</span><span class="sxs-lookup"><span data-stu-id="52617-209">When a data center has an outage, you do not know how long hello outage might last, so this option only works if you don't need your database for a while.</span></span>
* <span data-ttu-id="52617-210">Une autre option consiste tooeither échouent sur la région de données tooanother si vous utilisez géo-réplication active ou hello récupérer une base de données à l’aide de sauvegardes de base de données de géo-redondant (géo-restauration).</span><span class="sxs-lookup"><span data-stu-id="52617-210">Another option is tooeither fail over tooanother data region if you are using active geo-replication or hello recover a database using geo-redundant database backups (geo-restore).</span></span> <span data-ttu-id="52617-211">Un basculement ne prend que quelques secondes, tandis qu’une récupération de base de données à partir de sauvegardes nécessite des heures.</span><span class="sxs-lookup"><span data-stu-id="52617-211">Failover takes only a few seconds while database recovery from backups takes hours.</span></span>

<span data-ttu-id="52617-212">Lorsque vous intervenez, combien de temps cela vous prend toorecover et combien vous entraîner une perte de données dépend de votre décision toouse ces fonctionnalités de continuité d’activité d’entreprise dans votre application.</span><span class="sxs-lookup"><span data-stu-id="52617-212">When you take action, how long it takes you toorecover, and how much data loss you incur depends upon how you decide toouse these business continuity features in your application.</span></span> <span data-ttu-id="52617-213">En effet, vous pouvez choisir toouse une combinaison de sauvegardes de base de données et de géo-réplication active en fonction des exigences de votre application.</span><span class="sxs-lookup"><span data-stu-id="52617-213">Indeed, you may choose toouse a combination of database backups and active geo-replication depending upon your application requirements.</span></span> <span data-ttu-id="52617-214">Pour plus d’informations sur la conception d’applications pour des bases de données autonomes et des pools élastiques à l’aide de ces fonctionnalités de continuité d’activité, consultez [Conception d’applications pour la récupération d’urgence cloud](sql-database-designing-cloud-solutions-for-disaster-recovery.md) et [Stratégies de récupération d’urgence de pool élastique](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span><span class="sxs-lookup"><span data-stu-id="52617-214">For a discussion of application design considerations for stand-alone databases and for elastic pools using these business continuity features, see [Design an application for cloud disaster recovery](sql-database-designing-cloud-solutions-for-disaster-recovery.md) and [Elastic Pool disaster recovery strategies](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span></span>

<span data-ttu-id="52617-215">Hello sections suivantes fournissent une vue d’ensemble de toorecover d’étapes hello à l’aide de sauvegardes de base de données ou de géo-réplication active.</span><span class="sxs-lookup"><span data-stu-id="52617-215">hello following sections provide an overview of hello steps toorecover using either database backups or active geo-replication.</span></span> <span data-ttu-id="52617-216">Pour des instructions détaillées, y compris la planification de la configuration requise, des étapes de récupération post et plus d’informations sur comment toosimulate un tooperform panne une récupération d’urgence permet d’accéder, consultez [récupérer une base de données SQL à partir d’une panne](sql-database-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="52617-216">For detailed steps including planning requirements, post recovery steps, and information about how toosimulate an outage tooperform a disaster recovery drill, see [Recover a SQL Database from an outage](sql-database-disaster-recovery.md).</span></span>

### <a name="prepare-for-an-outage"></a><span data-ttu-id="52617-217">Se préparer à une panne</span><span class="sxs-lookup"><span data-stu-id="52617-217">Prepare for an outage</span></span>
<span data-ttu-id="52617-218">Quelle que soit la fonctionnalité de continuité des activités métier hello que vous utilisez, vous devez :</span><span class="sxs-lookup"><span data-stu-id="52617-218">Regardless of hello business continuity feature you use, you must:</span></span>

* <span data-ttu-id="52617-219">Identifiez et préparer le serveur cible de hello, y compris les règles de pare-feu de niveau serveur, les connexions et les autorisations de niveau base de données master.</span><span class="sxs-lookup"><span data-stu-id="52617-219">Identify and prepare hello target server, including server-level firewall rules, logins, and master database level permissions.</span></span>
* <span data-ttu-id="52617-220">Déterminer comment tooredirect client applications toohello nouveau serveur et les clients</span><span class="sxs-lookup"><span data-stu-id="52617-220">Determine how tooredirect clients and client applications toohello new server</span></span>
* <span data-ttu-id="52617-221">Documenter les autres dépendances, notamment les paramètres d’audit et les alertes</span><span class="sxs-lookup"><span data-stu-id="52617-221">Document other dependencies, such as auditing settings and alerts</span></span>

<span data-ttu-id="52617-222">Si la préparation n’est pas effectuée correctement, la mise en ligne de vos applications après un basculement ou une récupération de base de données prend plus de temps et nécessite probablement de résoudre certains problèmes dans une situation de stress, ce qui constitue une combinaison très risquée.</span><span class="sxs-lookup"><span data-stu-id="52617-222">If you do not prepare properly, bringing your applications online after a failover or a database recovery takes additional time and likely also require troubleshooting at a time of stress - a bad combination.</span></span>

### <a name="fail-over-tooa-geo-replicated-secondary-database"></a><span data-ttu-id="52617-223">Basculer tooa géorépliqué base de données secondaire</span><span class="sxs-lookup"><span data-stu-id="52617-223">Fail over tooa geo-replicated secondary database</span></span>
<span data-ttu-id="52617-224">Si vous utilisez la géo-réplication active et les groupes de basculement automatique (en version préliminaire) comme mécanisme de récupération, vous pouvez configurer une stratégie de basculement automatique ou utiliser le [basculement manuel](sql-database-disaster-recovery.md#fail-over-to-geo-replicated-secondary-database).</span><span class="sxs-lookup"><span data-stu-id="52617-224">If you are using active geo-replication and auto-failover groups (in-preview) as your recovery mechanism, you can configure an automatic failover policy or use [manual failover](sql-database-disaster-recovery.md#fail-over-to-geo-replicated-secondary-database).</span></span> <span data-ttu-id="52617-225">Une fois démarrée, hello basculement causes hello secondaire toobecome hello nouveau principal et prêt toorecord nouvelles transactions et répondre tooqueries - avec perte de données minimale pour les données de salutation n’ont pas encore été répliquées.</span><span class="sxs-lookup"><span data-stu-id="52617-225">Once initiated, hello failover causes hello secondary toobecome hello new primary and ready toorecord new transactions and respond tooqueries - with minimal data loss for hello data not yet replicated.</span></span> <span data-ttu-id="52617-226">Pour plus d’informations sur la conception de processus de basculement hello, consultez [concevoir une application cloud de récupération d’urgence](sql-database-designing-cloud-solutions-for-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="52617-226">For information on designing hello failover process, see [Design an application for cloud disaster recovery](sql-database-designing-cloud-solutions-for-disaster-recovery.md).</span></span>

> [!NOTE]
> <span data-ttu-id="52617-227">Lorsque le centre de données hello revient en ligne indistinctement ancien de hello automatiquement reconnecter toohello nouveau réplica principal et deviennent des bases de données secondaires.</span><span class="sxs-lookup"><span data-stu-id="52617-227">When hello data center comes back online hello old primaries automatically reconnect toohello new primary and become secondary databases.</span></span> <span data-ttu-id="52617-228">Si vous avez besoin de la région d’origine toorelocate hello principal toohello précédent, vous pouvez lancer manuellement un basculement planifié (restauration).</span><span class="sxs-lookup"><span data-stu-id="52617-228">If you need toorelocate hello primary back toohello original region, you can initiate a planned failover manually (failback).</span></span> 
> 

### <a name="perform-a-geo-restore"></a><span data-ttu-id="52617-229">Effectuer une restauration géographique</span><span class="sxs-lookup"><span data-stu-id="52617-229">Perform a geo-restore</span></span>
<span data-ttu-id="52617-230">Si vous utilisez des sauvegardes automatisées avec une réplication de stockage géo-redondant comme mécanisme de récupération, [lancez une récupération de base de données à l’aide de la géo-restauration](sql-database-disaster-recovery.md#recover-using-geo-restore).</span><span class="sxs-lookup"><span data-stu-id="52617-230">If you are using automated backups with geo-redundant storage replication as your recovery mechanism, [initiate a database recovery using geo-restore](sql-database-disaster-recovery.md#recover-using-geo-restore).</span></span> <span data-ttu-id="52617-231">Récupération a généralement lieu dans les 12 heures, avec une perte de données les horaires tooone déterminé par lors hello de la dernière horaire sauvegarde différentielle effectuée et répliquées.</span><span class="sxs-lookup"><span data-stu-id="52617-231">Recovery usually takes place within 12 hours - with data loss of up tooone hour determined by when hello last hourly differential backup with taken and replicated.</span></span> <span data-ttu-id="52617-232">Jusqu'à ce que la récupération de hello terminée, hello ou base de données toorecord Impossible de toutes les transactions répond tooany requêtes.</span><span class="sxs-lookup"><span data-stu-id="52617-232">Until hello recovery completes, hello database is unable toorecord any transactions or respond tooany queries.</span></span> <span data-ttu-id="52617-233">Cette opération restaure un base de données toohello dernier disponible point dans le temps, restauration hello géo-réplication secondaire tooany point dans le temps n'est pas actuellement prise en charge.</span><span class="sxs-lookup"><span data-stu-id="52617-233">While this restores a database toohello last available point in time, restoring hello geo-secondary tooany point in time is not currently supported.</span></span>

> [!NOTE]
> <span data-ttu-id="52617-234">Si le centre de données hello revient en ligne avant de basculer sur la base de données récupérée toohello votre application, vous pouvez annuler la récupération de hello.</span><span class="sxs-lookup"><span data-stu-id="52617-234">If hello data center comes back online before you switch your application over toohello recovered database, you can cancel hello recovery.</span></span>  
>
>

### <a name="perform-post-failover--recovery-tasks"></a><span data-ttu-id="52617-235">Exécution de tâches de post-basculement/récupération</span><span class="sxs-lookup"><span data-stu-id="52617-235">Perform post failover / recovery tasks</span></span>
<span data-ttu-id="52617-236">Après la récupération à partir d’un mécanisme de récupération, vous devez effectuer hello suivant des tâches supplémentaires avant de sauvegarder vos utilisateurs et les applications et en cours d’exécution :</span><span class="sxs-lookup"><span data-stu-id="52617-236">After recovery from either recovery mechanism, you must perform hello following additional tasks before your users and applications are back up and running:</span></span>

* <span data-ttu-id="52617-237">Rediriger les clients et de client applications toohello nouveau serveur et de base de données restaurée</span><span class="sxs-lookup"><span data-stu-id="52617-237">Redirect clients and client applications toohello new server and restored database</span></span>
* <span data-ttu-id="52617-238">Vérifiez les règles de pare-feu au niveau du serveur appropriées sont en place pour les utilisateurs tooconnect (ou utilisez [pare-feu de niveau base de données](sql-database-firewall-configure.md#creating-and-managing-firewall-rules))</span><span class="sxs-lookup"><span data-stu-id="52617-238">Ensure appropriate server-level firewall rules are in place for users tooconnect (or use [database-level firewalls](sql-database-firewall-configure.md#creating-and-managing-firewall-rules))</span></span>
* <span data-ttu-id="52617-239">Vérifier que les connexions et les autorisations appropriées au niveau de la base de données MASTER sont en place (ou utiliser des [utilisateurs contenus](https://msdn.microsoft.com/library/ff929188.aspx))</span><span class="sxs-lookup"><span data-stu-id="52617-239">Ensure appropriate logins and master database level permissions are in place (or use [contained users](https://msdn.microsoft.com/library/ff929188.aspx))</span></span>
* <span data-ttu-id="52617-240">Configurer l’audit, selon les besoins</span><span class="sxs-lookup"><span data-stu-id="52617-240">Configure auditing, as appropriate</span></span>
* <span data-ttu-id="52617-241">Configurer les alertes, selon les besoins</span><span class="sxs-lookup"><span data-stu-id="52617-241">Configure alerts, as appropriate</span></span>

## <a name="upgrade-an-application-with-minimal-downtime"></a><span data-ttu-id="52617-242">Mettre à niveau une application avec un temps d’arrêt minimal</span><span class="sxs-lookup"><span data-stu-id="52617-242">Upgrade an application with minimal downtime</span></span>
<span data-ttu-id="52617-243">Parfois, une application doit être déconnectée en raison d’une maintenance planifiée, par exemple une mise à niveau.</span><span class="sxs-lookup"><span data-stu-id="52617-243">Sometimes an application must be taken offline because of planned maintenance such as an application upgrade.</span></span> <span data-ttu-id="52617-244">[Gérer les mises à niveau de l’application](sql-database-manage-application-rolling-upgrade.md) décrit comment tooenable de géo-réplication active toouse propagée de votre cloud toominimize interruptions de service au cours de mises à niveau et de fournir un chemin de récupération si une erreur survient.</span><span class="sxs-lookup"><span data-stu-id="52617-244">[Manage application upgrades](sql-database-manage-application-rolling-upgrade.md) describes how toouse active geo-replication tooenable rolling upgrades of your cloud application toominimize downtime during upgrades and provide a recovery path if something goes wrong.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="52617-245">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="52617-245">Next steps</span></span>
<span data-ttu-id="52617-246">Pour plus d’informations sur la conception d’applications pour des bases de données autonomes et des pools élastiques, consultez [Conception d’applications pour la récupération d’urgence cloud](sql-database-designing-cloud-solutions-for-disaster-recovery.md) et [Stratégies de récupération d’urgence de pool élastique](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span><span class="sxs-lookup"><span data-stu-id="52617-246">For a discussion of application design considerations for stand-alone databases and for elastic pools, see [Design an application for cloud disaster recovery](sql-database-designing-cloud-solutions-for-disaster-recovery.md) and [Elastic Pool disaster recovery strategies](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span></span>
