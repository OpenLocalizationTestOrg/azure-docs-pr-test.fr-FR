---
title: "aaaMoving des données entre bases de données à grande échelle cloud | Documents Microsoft"
description: "Explique comment les partitions toomanipulate et déplacement des données via un service auto-hébergé à l’aide d’élastique de base de données API."
services: sql-database
documentationcenter: 
manager: jhubbard
author: ddove
ms.assetid: 204fd902-0397-4185-985a-dea3ed7c7d9f
ms.service: sql-database
ms.custom: scale out apps
ms.workload: sql-database
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 10/24/2016
ms.author: ddove
ms.openlocfilehash: 629dee06e22609e9b61edf93ba5c38d997132d8c
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="moving-data-between-scaled-out-cloud-databases"></a><span data-ttu-id="b8b97-103">Déplacement de données entre des bases de données cloud mises à l’échelle</span><span class="sxs-lookup"><span data-stu-id="b8b97-103">Moving data between scaled-out cloud databases</span></span>
<span data-ttu-id="b8b97-104">Si vous êtes un logiciel en tant qu’un développeur de Service, et soudainement votre application subit extraordinaire, vous avez besoin d’une croissance tooaccommodate hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-104">If you are a Software as a Service developer, and suddenly your app undergoes tremendous demand, you need tooaccommodate hello growth.</span></span> <span data-ttu-id="b8b97-105">Vous pouvez donc ajouter d’autres bases de données (partitions).</span><span class="sxs-lookup"><span data-stu-id="b8b97-105">So you add more databases (shards).</span></span> <span data-ttu-id="b8b97-106">Comment vous redistribuez hello données toohello nouvelles bases de données sans interrompre l’intégrité des données hello ?</span><span class="sxs-lookup"><span data-stu-id="b8b97-106">How do you redistribute hello data toohello new databases without disrupting hello data integrity?</span></span> <span data-ttu-id="b8b97-107">Hello d’utilisation **outil de fusion et fractionnement** toomove des données à partir de contrainte toohello nouvelles bases de données des bases de données.</span><span class="sxs-lookup"><span data-stu-id="b8b97-107">Use hello **split-merge tool** toomove data from constrained databases toohello new databases.</span></span>  

<span data-ttu-id="b8b97-108">outil de fusion et fractionnement Hello s’exécute comme un service web Azure.</span><span class="sxs-lookup"><span data-stu-id="b8b97-108">hello split-merge tool runs as an Azure web service.</span></span> <span data-ttu-id="b8b97-109">Un administrateur ou un développeur utilise hello outil toomove shardlets (à partir d’une partition de données) entre les différentes bases de données (partitions).</span><span class="sxs-lookup"><span data-stu-id="b8b97-109">An administrator or developer uses hello tool toomove shardlets (data from a shard) between different databases (shards).</span></span> <span data-ttu-id="b8b97-110">outil de Hello utilise des partitions carte gestion toomaintain hello service métadonnées de base de données et vérifiez les mappages cohérents.</span><span class="sxs-lookup"><span data-stu-id="b8b97-110">hello tool uses shard map management toomaintain hello service metadata database, and ensure consistent mappings.</span></span>

![Vue d'ensemble][1]

## <a name="download"></a><span data-ttu-id="b8b97-112">Télécharger</span><span class="sxs-lookup"><span data-stu-id="b8b97-112">Download</span></span>
[<span data-ttu-id="b8b97-113">Microsoft.Azure.SqlDatabase.ElasticScale.Service.SplitMerge</span><span class="sxs-lookup"><span data-stu-id="b8b97-113">Microsoft.Azure.SqlDatabase.ElasticScale.Service.SplitMerge</span></span>](http://www.nuget.org/packages/Microsoft.Azure.SqlDatabase.ElasticScale.Service.SplitMerge/)

## <a name="documentation"></a><span data-ttu-id="b8b97-114">Documentation</span><span class="sxs-lookup"><span data-stu-id="b8b97-114">Documentation</span></span>
1. [<span data-ttu-id="b8b97-115">Didacticiel d’outil de fusion et de fractionnement de bases de données élastiques</span><span class="sxs-lookup"><span data-stu-id="b8b97-115">Elastic database Split-Merge tool tutorial</span></span>](sql-database-elastic-scale-configure-deploy-split-and-merge.md)
2. [<span data-ttu-id="b8b97-116">Configuration de la sécurité de la fusion et du fractionnement</span><span class="sxs-lookup"><span data-stu-id="b8b97-116">Split-Merge security configuration</span></span>](sql-database-elastic-scale-split-merge-security-configuration.md)
3. [<span data-ttu-id="b8b97-117">Configuration de la sécurité de la fusion et du fractionnement</span><span class="sxs-lookup"><span data-stu-id="b8b97-117">Split-merge security considerations</span></span>](sql-database-elastic-scale-split-merge-security-configuration.md)
4. [<span data-ttu-id="b8b97-118">Gestion des cartes de partitions</span><span class="sxs-lookup"><span data-stu-id="b8b97-118">Shard map management</span></span>](sql-database-elastic-scale-shard-map-management.md)
5. [<span data-ttu-id="b8b97-119">Migrer tooscale-out de bases de données existant</span><span class="sxs-lookup"><span data-stu-id="b8b97-119">Migrate existing databases tooscale-out</span></span>](sql-database-elastic-convert-to-use-elastic-tools.md)
6. [<span data-ttu-id="b8b97-120">Outils de base de données élastique</span><span class="sxs-lookup"><span data-stu-id="b8b97-120">Elastic database tools</span></span>](sql-database-elastic-scale-introduction.md)
7. [<span data-ttu-id="b8b97-121">Glossaire des outils de base de données élastique</span><span class="sxs-lookup"><span data-stu-id="b8b97-121">Elastic Database tools glossary</span></span>](sql-database-elastic-scale-glossary.md)

## <a name="why-use-hello-split-merge-tool"></a><span data-ttu-id="b8b97-122">Pourquoi utiliser outil de fusion et fractionnement hello ?</span><span class="sxs-lookup"><span data-stu-id="b8b97-122">Why use hello split-merge tool?</span></span>
<span data-ttu-id="b8b97-123">**Flexibilité**</span><span class="sxs-lookup"><span data-stu-id="b8b97-123">**Flexibility**</span></span>

<span data-ttu-id="b8b97-124">Les applications doivent toostretch avec souplesse au-delà des limites de hello d’une seule base de données de la base de données SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="b8b97-124">Applications need toostretch flexibly beyond hello limits of a single Azure SQL DB database.</span></span> <span data-ttu-id="b8b97-125">Utilisez toomove données de l’outil hello en tant que bases de données toonew nécessaires tout en conservant l’intégrité.</span><span class="sxs-lookup"><span data-stu-id="b8b97-125">Use hello tool toomove data as needed toonew databases while retaining integrity.</span></span>

<span data-ttu-id="b8b97-126">**Fractionnement toogrow**</span><span class="sxs-lookup"><span data-stu-id="b8b97-126">**Split toogrow**</span></span> 

<span data-ttu-id="b8b97-127">Vous devez tooincrease globale croissance toohandle de capacité.</span><span class="sxs-lookup"><span data-stu-id="b8b97-127">You need tooincrease overall capacity toohandle explosive growth.</span></span> <span data-ttu-id="b8b97-128">toodo, créez une capacité supplémentaire par les données de salutation partitionnement et en distribuant entre bases de données incrémentielle plus jusqu'à ce que les besoins en capacité sont remplies.</span><span class="sxs-lookup"><span data-stu-id="b8b97-128">toodo so, create additional capacity by sharding hello data and by distributing it across incrementally more databases until capacity needs are fulfilled.</span></span> <span data-ttu-id="b8b97-129">Il s’agit d’un exemple de fonctionnalité de « split » hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-129">This is a prime example of hello ‘split’ feature.</span></span> 

<span data-ttu-id="b8b97-130">**Fusion tooshrink**</span><span class="sxs-lookup"><span data-stu-id="b8b97-130">**Merge tooshrink**</span></span>

<span data-ttu-id="b8b97-131">La capacité doit réduire en raison du caractère saisonnier de toohello d’une entreprise.</span><span class="sxs-lookup"><span data-stu-id="b8b97-131">Capacity needs shrink due toohello seasonal nature of a business.</span></span> <span data-ttu-id="b8b97-132">Hello outil vous permet de que développer vers le bas des unités d’échelle toofewer lors de l’activité ralentit.</span><span class="sxs-lookup"><span data-stu-id="b8b97-132">hello tool lets you scale down toofewer scale units when business slows.</span></span> <span data-ttu-id="b8b97-133">fonctionnalité de fusion » et » Hello Bonjour élastique fusion et fractionnement Service traite cette exigence.</span><span class="sxs-lookup"><span data-stu-id="b8b97-133">hello ‘merge’ feature in hello Elastic Scale split-merge Service covers this requirement.</span></span> 

<span data-ttu-id="b8b97-134">**Gérer les zones réactives par déplacement des shardlets**</span><span class="sxs-lookup"><span data-stu-id="b8b97-134">**Manage hotspots by moving shardlets**</span></span>

<span data-ttu-id="b8b97-135">Avec plusieurs locataires par base de données, l’allocation de shardlets tooshards hello peut entraîner des goulots d’étranglement toocapacity sur certaines partitions.</span><span class="sxs-lookup"><span data-stu-id="b8b97-135">With multiple tenants per database, hello allocation of shardlets tooshards can lead toocapacity bottlenecks on some shards.</span></span> <span data-ttu-id="b8b97-136">Cela nécessite de réaffectation des shardlets ou le déplacement des shardlets occupé toonew ou moins partitions utilisées.</span><span class="sxs-lookup"><span data-stu-id="b8b97-136">This requires re-allocating shardlets or moving busy shardlets toonew or less utilized shards.</span></span> 

## <a name="concepts--key-features"></a><span data-ttu-id="b8b97-137">Concepts et fonctionnalités clés</span><span class="sxs-lookup"><span data-stu-id="b8b97-137">Concepts & key features</span></span>
<span data-ttu-id="b8b97-138">**Services hébergés par le client**</span><span class="sxs-lookup"><span data-stu-id="b8b97-138">**Customer-hosted services**</span></span>

<span data-ttu-id="b8b97-139">fusion et fractionnement Hello est fournie sous la forme d’un service hébergé sur le client.</span><span class="sxs-lookup"><span data-stu-id="b8b97-139">hello split-merge is delivered as a customer-hosted service.</span></span> <span data-ttu-id="b8b97-140">Vous devez déployer et héberger le service de hello dans votre abonnement Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="b8b97-140">You must deploy and host hello service in your Microsoft Azure subscription.</span></span> <span data-ttu-id="b8b97-141">Hello que vous téléchargez à partir de NuGet contient un toocomplete de modèle de configuration avec les informations de hello pour votre déploiement spécifique.</span><span class="sxs-lookup"><span data-stu-id="b8b97-141">hello package you download from NuGet contains a configuration template toocomplete with hello information for your specific deployment.</span></span> <span data-ttu-id="b8b97-142">Consultez hello [didacticiel de fusion et fractionnement](sql-database-elastic-scale-configure-deploy-split-and-merge.md) pour plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="b8b97-142">See hello [split-merge tutorial](sql-database-elastic-scale-configure-deploy-split-and-merge.md) for details.</span></span> <span data-ttu-id="b8b97-143">Étant donné que le service de hello s’exécute dans votre abonnement Azure, vous pouvez contrôler et configurer la plupart des aspects de sécurité du service de hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-143">Since hello service runs in your Azure subscription, you can control and configure most security aspects of hello service.</span></span> <span data-ttu-id="b8b97-144">modèle par défaut de Hello inclut hello options tooconfigure SSL, l’authentification du client de certificat, le chiffrement pour les informations d’identification stockées, protégeant un déni de service et les restrictions IP.</span><span class="sxs-lookup"><span data-stu-id="b8b97-144">hello default template includes hello options tooconfigure SSL, certificate-based client authentication, encryption for stored credentials, DoS guarding and IP restrictions.</span></span> <span data-ttu-id="b8b97-145">Vous trouverez plus d’informations sur hello aspects de sécurité Bonjour suivant document [configuration de la sécurité de la fusion et fractionnement](sql-database-elastic-scale-split-merge-security-configuration.md).</span><span class="sxs-lookup"><span data-stu-id="b8b97-145">You can find more information on hello security aspects in hello following document [split-merge security configuration](sql-database-elastic-scale-split-merge-security-configuration.md).</span></span>

<span data-ttu-id="b8b97-146">valeur par défaut Hello déployé le service s’exécute avec un seul worker et un rôle web.</span><span class="sxs-lookup"><span data-stu-id="b8b97-146">hello default deployed service runs with one worker and one web role.</span></span> <span data-ttu-id="b8b97-147">Chacune utilise la taille de machine virtuelle A1 hello dans Azure Cloud Services.</span><span class="sxs-lookup"><span data-stu-id="b8b97-147">Each uses hello A1 VM size in Azure Cloud Services.</span></span> <span data-ttu-id="b8b97-148">Pendant que vous ne pouvez pas modifier ces paramètres lors du déploiement de package de hello, vous pouvez les modifier après un déploiement réussi dans hello service cloud, en cours d’exécution (via hello portail Azure).</span><span class="sxs-lookup"><span data-stu-id="b8b97-148">While you cannot modify these settings when deploying hello package, you could change them after a successful deployment in hello running cloud service, (through hello Azure portal).</span></span> <span data-ttu-id="b8b97-149">Notez que ce rôle de travail hello ne doit pas être configuré pour plus d’informations d’une instance unique pour des raisons techniques.</span><span class="sxs-lookup"><span data-stu-id="b8b97-149">Note that hello worker role must not be configured for more than a single instance for technical reasons.</span></span> 

<span data-ttu-id="b8b97-150">**Intégration des cartes de partitions**</span><span class="sxs-lookup"><span data-stu-id="b8b97-150">**Shard map integration**</span></span>

<span data-ttu-id="b8b97-151">service de fusion et fractionnement de Hello interagit avec la carte de partitions hello de l’application hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-151">hello split-merge service interacts with hello shard map of hello application.</span></span> <span data-ttu-id="b8b97-152">Lorsque vous utilisez toosplit de fusion et fractionnement service hello ou plages de fusion ou toomove shardlets entre les partitions, le service de hello maintient automatiquement carte de partitions hello des toodate.</span><span class="sxs-lookup"><span data-stu-id="b8b97-152">When using hello split-merge service toosplit or merge ranges or toomove shardlets between shards, hello service automatically keeps hello shard map up toodate.</span></span> <span data-ttu-id="b8b97-153">toodo par conséquent, le service de hello se connecte toohello partition manager base de données de l’application hello et gère des plages et des mappages en tant que la progression des demandes de fractionnement/fusion/déplacement.</span><span class="sxs-lookup"><span data-stu-id="b8b97-153">toodo so, hello service connects toohello shard map manager database of hello application and maintains ranges and mappings as split/merge/move requests progress.</span></span> <span data-ttu-id="b8b97-154">Ainsi, cette carte de partitions hello toujours présente une vue à jour lorsque des opérations de fusion et fractionnement se déroulent.</span><span class="sxs-lookup"><span data-stu-id="b8b97-154">This ensures that hello shard map always presents an up-to-date view when split-merge operations are going on.</span></span> <span data-ttu-id="b8b97-155">Opérations de déplacement de fusion et de shardlet fractionné, sont implémentées en déplaçant un lot de shardlets à partir de la partition cible de hello source partition toohello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-155">Split, merge and shardlet movement operations are implemented by moving a batch of shardlets from hello source shard toohello target shard.</span></span> <span data-ttu-id="b8b97-156">Au cours de hello shardlet mouvement opération hello shardlets sujet toohello lot actuel sont marqués comme étant hors connexion dans la carte de partitions hello et ne sont pas disponibles pour les connexions de routage dépendant des données à l’aide de hello **OpenConnectionForKey** API.</span><span class="sxs-lookup"><span data-stu-id="b8b97-156">During hello shardlet movement operation hello shardlets subject toohello current batch are marked as offline in hello shard map and are unavailable for data-dependent routing connections using hello **OpenConnectionForKey** API.</span></span> 

<span data-ttu-id="b8b97-157">**Connexions cohérentes des shardlets**</span><span class="sxs-lookup"><span data-stu-id="b8b97-157">**Consistent shardlet connections**</span></span>

<span data-ttu-id="b8b97-158">Lorsque le déplacement des données démarre un nouveau lot de shardlets, n’importe quel fournie par carte de partitions dépendant des données routage connexions toohello partition stockage hello shardlet sont supprimées et ultérieures des connexions à partir de la carte de partitions hello toohello API ces shardlets sont bloquées pendant le déplacement des données de Hello sont en cours dans des incohérences tooavoid de commande.</span><span class="sxs-lookup"><span data-stu-id="b8b97-158">When data movement starts for a new batch of shardlets, any shard-map provided data-dependent routing connections toohello shard storing hello shardlet are killed and subsequent connections from hello shard map APIs toohello these shardlets are blocked while hello data movement is in progress in order tooavoid inconsistencies.</span></span> <span data-ttu-id="b8b97-159">Connexions des shardlets tooother sur hello même ID de partition est également obtenir arrêtée, mais réussit à nouveau immédiatement lors de la tentative.</span><span class="sxs-lookup"><span data-stu-id="b8b97-159">Connections tooother shardlets on hello same shard will also get killed, but will succeed again immediately on retry.</span></span> <span data-ttu-id="b8b97-160">Une fois le traitement par lots hello est déplacé, hello shardlets sont marqués en ligne pour la partition cible de hello et source de données hello est supprimé de la partition source de hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-160">Once hello batch is moved, hello shardlets are marked online again for hello target shard and hello source data is removed from hello source shard.</span></span> <span data-ttu-id="b8b97-161">service de Hello passe par ces étapes pour chaque lot jusqu'à ce que tous les shardlets ont été déplacés.</span><span class="sxs-lookup"><span data-stu-id="b8b97-161">hello service goes through these steps for every batch until all shardlets have been moved.</span></span> <span data-ttu-id="b8b97-162">Cette tentative génère les opérations de suppression de connexion tooseveral pendant l’opération de fractionnement/fusion/déplacement terminée hello hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-162">This will lead tooseveral connection kill operations during hello course of hello complete split/merge/move operation.</span></span>  

<span data-ttu-id="b8b97-163">**Gestion de la disponibilité des shardlets**</span><span class="sxs-lookup"><span data-stu-id="b8b97-163">**Managing shardlet availability**</span></span>

<span data-ttu-id="b8b97-164">Limitation de connexion hello tuer toohello le lot en cours de shardlets, comme expliqué ci-dessus limite l’étendue hello du lot de tooone d’indisponibilité de shardlets à la fois.</span><span class="sxs-lookup"><span data-stu-id="b8b97-164">Limiting hello connection killing toohello current batch of shardlets as discussed above restricts hello scope of unavailability tooone batch of shardlets at a time.</span></span> <span data-ttu-id="b8b97-165">Cela est préférable à une approche où les partitions complète hello reste hors connexion pour tous les shardlets son hello pendant une opération de fractionnement ou de fusion.</span><span class="sxs-lookup"><span data-stu-id="b8b97-165">This is preferred over an approach where hello complete shard would remain offline for all its shardlets during hello course of a split or merge operation.</span></span> <span data-ttu-id="b8b97-166">taille de Hello d’un lot, défini comme nombre de hello de shardlets distinctes toomove à la fois, est un paramètre de configuration.</span><span class="sxs-lookup"><span data-stu-id="b8b97-166">hello size of a batch, defined as hello number of distinct shardlets toomove at a time, is a configuration parameter.</span></span> <span data-ttu-id="b8b97-167">Elle peut être définie pour chaque opération de fractionnement et de fusion en fonction des besoins de disponibilité et les performances de l’application hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-167">It can be defined for each split and merge operation depending on hello application’s availability and performance needs.</span></span> <span data-ttu-id="b8b97-168">Notez que la plage de hello est verrouillé dans la carte de partitions hello peut être supérieure à la taille de lot hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-168">Note that hello range that is being locked in hello shard map may be larger than hello batch size specified.</span></span> <span data-ttu-id="b8b97-169">Il s’agit, car le service de hello récupère la taille de la plage hello telles que le nombre réel de hello de valeurs de clé de partitionnement dans les données de salutation correspond approximativement à taille de lot hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-169">This is because hello service picks hello range size such that hello actual number of sharding key values in hello data approximately matches hello batch size.</span></span> <span data-ttu-id="b8b97-170">Il s’agit en particulier tooremember important pour les clés de partitionnement peuplées.</span><span class="sxs-lookup"><span data-stu-id="b8b97-170">This is important tooremember in particular for sparsely populated sharding keys.</span></span> 

<span data-ttu-id="b8b97-171">**Stockage des métadonnées**</span><span class="sxs-lookup"><span data-stu-id="b8b97-171">**Metadata storage**</span></span>

<span data-ttu-id="b8b97-172">service de fusion et fractionnement Hello utilise un toomaintain de base de données son état et son tookeep se connecte lors du traitement de la demande.</span><span class="sxs-lookup"><span data-stu-id="b8b97-172">hello split-merge service uses a database toomaintain its status and tookeep logs during request processing.</span></span> <span data-ttu-id="b8b97-173">utilisateur de Hello crée cette base de données dans leur abonnement et fournit la chaîne de connexion hello de dans le fichier de configuration hello pour le déploiement du service hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-173">hello user creates this database in their subscription and provides hello connection string for it in hello configuration file for hello service deployment.</span></span> <span data-ttu-id="b8b97-174">Les administrateurs à partir de l’organisation de l’utilisateur hello peuvent également connecter toothis cours de demande de base de données tooreview et tooinvestigate des informations détaillées sur les erreurs potentielles.</span><span class="sxs-lookup"><span data-stu-id="b8b97-174">Administrators from hello user’s organization can also connect toothis database tooreview request progress and tooinvestigate detailed information regarding potential failures.</span></span>

<span data-ttu-id="b8b97-175">**Détection de partitionnements**</span><span class="sxs-lookup"><span data-stu-id="b8b97-175">**Sharding-awareness**</span></span>

<span data-ttu-id="b8b97-176">service de fusion et fractionnement Hello établit la distinction entre les tables (1) partitionnées, les tables de référence (2) et les tables (3) normales.</span><span class="sxs-lookup"><span data-stu-id="b8b97-176">hello split-merge service differentiates between (1) sharded tables, (2) reference tables, and (3) normal tables.</span></span> <span data-ttu-id="b8b97-177">la sémantique d’une opération de fractionnement/fusion/déplacement Hello dépendre de type hello de table hello utilisée et est définie comme suit :</span><span class="sxs-lookup"><span data-stu-id="b8b97-177">hello semantics of a split/merge/move operation depend on hello type of hello table used and are defined as follows:</span></span> 

* <span data-ttu-id="b8b97-178">**Tables partitionnées**: Split, merge et opérations de déplacement de déplacent les shardlets à partir de la partition de tootarget source.</span><span class="sxs-lookup"><span data-stu-id="b8b97-178">**Sharded tables**: Split, merge, and move operations move shardlets from source tootarget shard.</span></span> <span data-ttu-id="b8b97-179">Après l’achèvement réussi de hello demande générale, les shardlets ne sont plus présentes sur la source de hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-179">After successful completion of hello overall request, those shardlets are no longer present on hello source.</span></span> <span data-ttu-id="b8b97-180">Notez que les tables cible hello doivent tooexist sur la partition cible de hello et qu’il ne doivent pas contenir de données dans hello cible plage tooprocessing préalable de l’opération de hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-180">Note that hello target tables need tooexist on hello target shard and must not contain data in hello target range prior tooprocessing of hello operation.</span></span> 
* <span data-ttu-id="b8b97-181">**Tables de référence**: pour les tables de référence, hello division, fusionner et déplacer des opérations de copier les données de hello à partir de la partition de hello source toohello cible.</span><span class="sxs-lookup"><span data-stu-id="b8b97-181">**Reference tables**: For reference tables, hello split, merge and move operations copy hello data from hello source toohello target shard.</span></span> <span data-ttu-id="b8b97-182">Toutefois, notez qu’aucune modification se produire sur la partition cible de hello pour une table donnée si n’importe quelle ligne est déjà présente dans le tableau de cibles de hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-182">Note, however, that no changes occur on hello target shard for a given table if any row is already present in this table on hello target.</span></span> <span data-ttu-id="b8b97-183">table de Hello a toobe vide pour n’importe quel tableau de référence copie tooget opération traitée.</span><span class="sxs-lookup"><span data-stu-id="b8b97-183">hello table has toobe empty for any reference table copy operation tooget processed.</span></span>
* <span data-ttu-id="b8b97-184">**Autres Tables**: autres tables peuvent être présents sur hello source ou cible hello d’une opération de fractionnement et de fusion.</span><span class="sxs-lookup"><span data-stu-id="b8b97-184">**Other Tables**: Other tables can be present on either hello source or hello target of a split and merge operation.</span></span> <span data-ttu-id="b8b97-185">service de fusion et fractionnement Hello ne tient pas compte de ces tables pour toutes les opérations de copie ou de déplacement des données.</span><span class="sxs-lookup"><span data-stu-id="b8b97-185">hello split-merge service disregards these tables for any data movement or copy operations.</span></span> <span data-ttu-id="b8b97-186">Notez, toutefois, qu’ils peuvent interférer avec ces opérations en cas de contraintes.</span><span class="sxs-lookup"><span data-stu-id="b8b97-186">Note, however, that they can interfere with these operations in case of constraints.</span></span>

<span data-ttu-id="b8b97-187">Hello plus d’informations sur la référence par rapport aux tables partitionnées sont fournies par hello **SchemaInfo** API sur la carte de partitions hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-187">hello information on reference vs. sharded tables is provided by hello **SchemaInfo** APIs on hello shard map.</span></span> <span data-ttu-id="b8b97-188">Hello l’exemple suivant illustre les utiliser hello de ces API sur un smm objet de partition donné carte manager :</span><span class="sxs-lookup"><span data-stu-id="b8b97-188">hello following example illustrates hello use of these APIs on a given shard map manager object smm:</span></span> 

    // Create hello schema annotations 
    SchemaInfo schemaInfo = new SchemaInfo(); 

    // Reference tables 
    schemaInfo.Add(new ReferenceTableInfo("dbo", "region")); 
    schemaInfo.Add(new ReferenceTableInfo("dbo", "nation")); 

    // Sharded tables 
    schemaInfo.Add(new ShardedTableInfo("dbo", "customer", "C_CUSTKEY")); 
    schemaInfo.Add(new ShardedTableInfo("dbo", "orders", "O_CUSTKEY")); 

    // Publish 
    smm.GetSchemaInfoCollection().Add(Configuration.ShardMapName, schemaInfo); 

<span data-ttu-id="b8b97-189">Hello tables « région » et « pays » sont définies en tant que tables de référence et seront copiés avec les opérations de fractionnement/fusion/déplacement.</span><span class="sxs-lookup"><span data-stu-id="b8b97-189">hello tables ‘region’ and ‘nation’ are defined as reference tables and will be copied with split/merge/move operations.</span></span> <span data-ttu-id="b8b97-190">Les « clients » et les « commandes » sont à leur tour définis comme tables partitionnées.</span><span class="sxs-lookup"><span data-stu-id="b8b97-190">‘customer’ and ‘orders’ in turn are defined as sharded tables.</span></span> <span data-ttu-id="b8b97-191">C_CUSTKEY et O_CUSTKEY servent de clé de partitionnement hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-191">C_CUSTKEY and O_CUSTKEY serve as hello sharding key.</span></span> 

<span data-ttu-id="b8b97-192">**Intégrité référentielle**</span><span class="sxs-lookup"><span data-stu-id="b8b97-192">**Referential Integrity**</span></span>

<span data-ttu-id="b8b97-193">service de fusion et fractionnement Hello analyse les dépendances entre les tables et utilise des relations de clé primaire-clé étrangère toostage hello opérations pour déplacer des tables de référence et les shardlets.</span><span class="sxs-lookup"><span data-stu-id="b8b97-193">hello split-merge service analyzes dependencies between tables and uses foreign key-primary key relationships toostage hello operations for moving reference tables and shardlets.</span></span> <span data-ttu-id="b8b97-194">En général, les tables de référence sont d'abord copiées dans l'ordre de dépendance, puis les shardlets sont copiés dans l'ordre de leurs dépendances au sein de chaque lot.</span><span class="sxs-lookup"><span data-stu-id="b8b97-194">In general, reference tables are copied first in dependency order, then shardlets are copied in order of their dependencies within each batch.</span></span> <span data-ttu-id="b8b97-195">Cela est nécessaire afin que les contraintes sur la partition cible de hello PK-FK sont respectés comme hello nouvelles données arrivent.</span><span class="sxs-lookup"><span data-stu-id="b8b97-195">This is necessary so that FK-PK constraints on hello target shard are honored as hello new data arrives.</span></span> 

<span data-ttu-id="b8b97-196">**Cohérence des cartes de partitions et achèvement éventuel**</span><span class="sxs-lookup"><span data-stu-id="b8b97-196">**Shard Map Consistency and Eventual Completion**</span></span>

<span data-ttu-id="b8b97-197">En présence de hello d’échecs, le service de fusion et fractionnement de hello reprend les opérations après toute coupure de courant et vise toocomplete les demandes de progression.</span><span class="sxs-lookup"><span data-stu-id="b8b97-197">In hello presence of failures, hello split-merge service resumes operations after any outage and aims toocomplete any in progress requests.</span></span> <span data-ttu-id="b8b97-198">Toutefois, il peut arriver irrécupérable, par exemple, lors de la partition cible de hello est perdue ou compromise au-delà de réparation.</span><span class="sxs-lookup"><span data-stu-id="b8b97-198">However, there may be unrecoverable situations, e.g., when hello target shard is lost or compromised beyond repair.</span></span> <span data-ttu-id="b8b97-199">Dans ces circonstances, certaines shardlets devait toobe déplacé peut continuer tooreside sur les partitions de source de hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-199">Under those circumstances, some shardlets that were supposed toobe moved may continue tooreside on hello source shard.</span></span> <span data-ttu-id="b8b97-200">service de Hello garantit que les mappages de shardlet sont uniquement mis à jour après que les données nécessaires hello a été correctement copiés toohello cible.</span><span class="sxs-lookup"><span data-stu-id="b8b97-200">hello service ensures that shardlet mappings are only updated after hello necessary data has been successfully copied toohello target.</span></span> <span data-ttu-id="b8b97-201">Shardlets sont supprimés uniquement sur la source de hello une fois que toutes les données ont été copiées toohello cible et les mappages correspondants hello ont été mis à jour avec succès.</span><span class="sxs-lookup"><span data-stu-id="b8b97-201">Shardlets are only deleted on hello source once all their data has been copied toohello target and hello corresponding mappings have been updated successfully.</span></span> <span data-ttu-id="b8b97-202">opération de suppression Hello se produit en arrière-plan de hello lors de la plage de hello est déjà en ligne sur la partition cible de hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-202">hello deletion operation happens in hello background while hello range is already online on hello target shard.</span></span> <span data-ttu-id="b8b97-203">service de fusion et fractionnement Hello garantit toujours l’exactitude des mappages hello stockées dans la carte de partitions hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-203">hello split-merge service always ensures correctness of hello mappings stored in hello shard map.</span></span>

## <a name="hello-split-merge-user-interface"></a><span data-ttu-id="b8b97-204">interface utilisateur de la fusion et fractionnement de Hello</span><span class="sxs-lookup"><span data-stu-id="b8b97-204">hello split-merge user interface</span></span>
<span data-ttu-id="b8b97-205">package de service de fractionnement-fusion Hello inclut un rôle de travail et un rôle web.</span><span class="sxs-lookup"><span data-stu-id="b8b97-205">hello split-merge service package includes a worker role and a web role.</span></span> <span data-ttu-id="b8b97-206">rôle web de Hello est demandes de fusion et fractionnement toosubmit utilisé de manière interactive.</span><span class="sxs-lookup"><span data-stu-id="b8b97-206">hello web role is used toosubmit split-merge requests in an interactive way.</span></span> <span data-ttu-id="b8b97-207">Hello principaux composants d’interface utilisateur de hello sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="b8b97-207">hello main components of hello user interface are as follows:</span></span>

* <span data-ttu-id="b8b97-208">Type d’opération : le type d’opération hello est une case d’option qui contrôle le type de hello d’opération effectuée par service hello pour cette demande.</span><span class="sxs-lookup"><span data-stu-id="b8b97-208">Operation Type: hello operation type is a radio button that controls hello kind of operation performed by hello service for this request.</span></span> <span data-ttu-id="b8b97-209">Vous pouvez choisir entre hello split, merge et déplacez des scénarios.</span><span class="sxs-lookup"><span data-stu-id="b8b97-209">You can choose between hello split, merge and move scenarios.</span></span> <span data-ttu-id="b8b97-210">Vous pouvez également annuler une opération précédemment soumise.</span><span class="sxs-lookup"><span data-stu-id="b8b97-210">You can also cancel a previously submitted operation.</span></span> <span data-ttu-id="b8b97-211">Vous pouvez utiliser les demandes de fractionnement, de fusionnement et de déplacement pour les cartes de partition de plage.</span><span class="sxs-lookup"><span data-stu-id="b8b97-211">You can use split, merge and move requests for range shard maps.</span></span> <span data-ttu-id="b8b97-212">La liste de cartes de partition prend uniquement en charge les opérations de déplacement.</span><span class="sxs-lookup"><span data-stu-id="b8b97-212">List shard maps only support move operations.</span></span>
* <span data-ttu-id="b8b97-213">Carte de partitions : hello section suivante de demander des informations de couverture de paramètres sur carte de partitions hello et hébergement de votre carte de partitions de la base de données hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-213">Shard Map: hello next section of request parameters cover information about hello shard map and hello database hosting your shard map.</span></span> <span data-ttu-id="b8b97-214">En particulier, vous avez besoin de nom de hello tooprovide de serveur de base de données SQL Azure hello et de la base de données d’hébergement hello shardmap, partition de toohello informations d’identification tooconnect mapper la base de données et enfin hello nom de la carte de partitions hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-214">In particular, you need tooprovide hello name of hello Azure SQL Database server and database hosting hello shardmap, credentials tooconnect toohello shard map database, and finally hello name of hello shard map.</span></span> <span data-ttu-id="b8b97-215">Actuellement, opération de hello n’accepte qu’un seul jeu d’informations d’identification.</span><span class="sxs-lookup"><span data-stu-id="b8b97-215">Currently, hello operation only accepts a single set of credentials.</span></span> <span data-ttu-id="b8b97-216">Ces informations d’identification ont besoin d’autorisations suffisantes de toohave tooperform modifie la carte de partitions toohello ainsi que les données d’utilisateur toohello sur les partitions hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-216">These credentials need toohave sufficient permissions tooperform changes toohello shard map as well as toohello user data on hello shards.</span></span>
* <span data-ttu-id="b8b97-217">Plage source (fractionnement et fusion) : une opération de fractionnement et de fusion traite une plage à l’aide de sa clé basse et haute.</span><span class="sxs-lookup"><span data-stu-id="b8b97-217">Source Range (split and merge): A split and merge operation processes a range using its low and high key.</span></span> <span data-ttu-id="b8b97-218">toospecify une opération avec une valeur clée haute unbounded, cocher hello case à cocher « clé haute est max » et laissez le champ de clé haute hello vide.</span><span class="sxs-lookup"><span data-stu-id="b8b97-218">toospecify an operation with an unbounded high key value, check hello “High key is max” check box and leave hello high key field empty.</span></span> <span data-ttu-id="b8b97-219">valeurs clés Hello plage que vous spécifiez ne correspondent pas besoin de tooprecisely à un mappage et ses limites dans votre carte de partitions.</span><span class="sxs-lookup"><span data-stu-id="b8b97-219">hello range key values that you specify do not need tooprecisely match a mapping and its boundaries in your shard map.</span></span> <span data-ttu-id="b8b97-220">Si vous ne spécifiez pas les limites de plage à tout service de hello déduira plage la plus proche hello pour vous automatiquement.</span><span class="sxs-lookup"><span data-stu-id="b8b97-220">If you do not specify any range boundaries at all hello service will infer hello closest range for you automatically.</span></span> <span data-ttu-id="b8b97-221">Vous pouvez utiliser les mappages actuels hello du tooretrieve script hello GetMappings.ps1 PowerShell dans une carte de partitions donné.</span><span class="sxs-lookup"><span data-stu-id="b8b97-221">You can use hello GetMappings.ps1 PowerShell script tooretrieve hello current mappings in a given shard map.</span></span>
* <span data-ttu-id="b8b97-222">Comportement de la Source fractionnement (split) : pour les opérations de division, définir la plage source de hello point toosplit hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-222">Split Source Behavior (split): For split operations, define hello point toosplit hello source range.</span></span> <span data-ttu-id="b8b97-223">Pour cela, en fournissant la clé de partitionnement hello où vous souhaitez hello fractionner toooccur.</span><span class="sxs-lookup"><span data-stu-id="b8b97-223">You do this by providing hello sharding key where you want hello split toooccur.</span></span> <span data-ttu-id="b8b97-224">Bouton d’option utiliser hello spécifier si vous souhaitez que la partie inférieure de hello de hello plage (à l’exclusion de diviser la clé de hello) toomove, ou si vous souhaitez toomove partie supérieure de hello (y compris la clé de fractionnement hello).</span><span class="sxs-lookup"><span data-stu-id="b8b97-224">Use hello radio button specify whether you want hello lower part of hello range (excluding hello split key) toomove, or whether you want hello upper part toomove (including hello split key).</span></span>
* <span data-ttu-id="b8b97-225">Source de Shardlet (déplacer) : déplacer les opérations sont différentes de fractionner ou fusionner les opérations qu’ils ne nécessitent pas une source de hello toodescribe plage.</span><span class="sxs-lookup"><span data-stu-id="b8b97-225">Source Shardlet (move): Move operations are different from split or merge operations as they do not require a range toodescribe hello source.</span></span> <span data-ttu-id="b8b97-226">Une source de déplacement est simplement identifiée par la valeur de clé de partitionnement hello que vous envisagez de toomove.</span><span class="sxs-lookup"><span data-stu-id="b8b97-226">A source for move is simply identified by hello sharding key value that you plan toomove.</span></span>
* <span data-ttu-id="b8b97-227">Cibler la partition (split) : une fois que vous avez fourni les informations de hello sur la source de hello de votre opération de fractionnement, vous devez toodefine où vous souhaitez hello données toobe copié le serveur de base de données SQL Azure tooby fournissant hello et nom de la base de données pour la cible de hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-227">Target Shard (split): Once you have provided hello information on hello source of your split operation, you need toodefine where you want hello data toobe copied tooby providing hello Azure SQL Db server and database name for hello target.</span></span>
* <span data-ttu-id="b8b97-228">Plage de la cible (fusion sans base) : les opérations de fusion déplacement des partitions existantes de shardlets tooan.</span><span class="sxs-lookup"><span data-stu-id="b8b97-228">Target Range (merge): Merge operations move shardlets tooan existing shard.</span></span> <span data-ttu-id="b8b97-229">Vous identifiez les partitions existantes hello en fournissant des limites de plage hello de plage existante hello toomerge avec souhaitées.</span><span class="sxs-lookup"><span data-stu-id="b8b97-229">You identify hello existing shard by providing hello range boundaries of hello existing range that you want toomerge with.</span></span>
* <span data-ttu-id="b8b97-230">Taille du lot : contrôles de taille de lot hello hello nombre de shardlets passera en mode hors connexion à la fois pendant le déplacement des données de hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-230">Batch Size: hello batch size controls hello number of shardlets that will go offline at a time during hello data movement.</span></span> <span data-ttu-id="b8b97-231">Il s’agit d’une valeur entière dans laquelle vous pouvez utiliser plus petites valeurs lorsque vous êtes toolong sensibles des périodes de temps d’arrêt pour les shardlets.</span><span class="sxs-lookup"><span data-stu-id="b8b97-231">This is an integer value where you can use smaller values when you are sensitive toolong periods of downtime for shardlets.</span></span> <span data-ttu-id="b8b97-232">Plus grandes valeurs augmentera le temps de hello un shardlet donné est hors connexion mais peut améliorer les performances.</span><span class="sxs-lookup"><span data-stu-id="b8b97-232">Larger values will increase hello time that a given shardlet is offline but may improve performance.</span></span>
* <span data-ttu-id="b8b97-233">Id d’opération (Annuler) : Si vous avez une opération en cours n’est plus nécessaire, vous pouvez annuler hello en fournissant son ID d’opération dans ce champ.</span><span class="sxs-lookup"><span data-stu-id="b8b97-233">Operation Id (Cancel): If you have an ongoing operation that is no longer needed, you can cancel hello operation by providing its operation ID in this field.</span></span> <span data-ttu-id="b8b97-234">Vous pouvez récupérer l’ID d’opération hello à partir de la table d’état de demande de hello (voir la Section 8.1) ou de sortie hello dans le navigateur web de hello où vous avez envoyé la demande de hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-234">You can retrieve hello operation ID from hello request status table (see Section 8.1) or from hello output in hello web browser where you submitted hello request.</span></span>

## <a name="requirements-and-limitations"></a><span data-ttu-id="b8b97-235">Spécifications et limitations</span><span class="sxs-lookup"><span data-stu-id="b8b97-235">Requirements and Limitations</span></span>
<span data-ttu-id="b8b97-236">mise en œuvre actuelle Hello du service de fusion et fractionnement hello est sujet toohello suivant les spécifications et limitations :</span><span class="sxs-lookup"><span data-stu-id="b8b97-236">hello current implementation of hello split-merge service is subject toohello following requirements and limitations:</span></span> 

* <span data-ttu-id="b8b97-237">les partitions Hello doivent tooexist et être inscrits dans la carte de partitions hello avant de pouvoir effectuer une opération de fusion et fractionnement sur ces partitions.</span><span class="sxs-lookup"><span data-stu-id="b8b97-237">hello shards need tooexist and be registered in hello shard map before a split-merge operation on these shards can be performed.</span></span> 
* <span data-ttu-id="b8b97-238">service de Hello ne crée pas de tables ou autres objets de base de données automatiquement dans le cadre de ses opérations.</span><span class="sxs-lookup"><span data-stu-id="b8b97-238">hello service does not create tables or any other database objects automatically as part of its operations.</span></span> <span data-ttu-id="b8b97-239">Cela signifie que hello de schéma pour les tables partitionnées tout et tables de référence doivent tooexist sur l’opération de fractionnement/fusion/déplacement hello cible partition tooany préalable.</span><span class="sxs-lookup"><span data-stu-id="b8b97-239">This means that hello schema for all sharded tables and reference tables need tooexist on hello target shard prior tooany split/merge/move operation.</span></span> <span data-ttu-id="b8b97-240">En particulier, les tables partitionnées sont requis toobe vide dans la plage hello où les nouveaux shardlets sont toobe ajoutée par une opération de fractionnement/fusion/déplacement.</span><span class="sxs-lookup"><span data-stu-id="b8b97-240">Sharded tables in particular are required toobe empty in hello range where new shardlets are toobe added by a split/merge/move operation.</span></span> <span data-ttu-id="b8b97-241">Dans le cas contraire, hello échoue hello de cohérence initiale de la partition cible de hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-241">Otherwise, hello operation will fail hello initial consistency check on hello target shard.</span></span> <span data-ttu-id="b8b97-242">Notez que les données de référence sont copiées uniquement si la table de référence hello est vide et qu’il n’y a aucune cohérence garantit également avec les opérations d’écriture simultanées tenu tooother sur les tables de référence hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-242">Also note that reference data is only copied if hello reference table is empty and that there are no consistency guarantees with regard tooother concurrent write operations on hello reference tables.</span></span> <span data-ttu-id="b8b97-243">Nous vous recommandons ce : lors de l’exécution des opérations de fractionnement/fusion, aucune autre opération d’écriture n’apporter des modifications des tables de référence toohello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-243">We recommend this: when running split/merge operations, no other write operations make changes toohello reference tables.</span></span>
* <span data-ttu-id="b8b97-244">service de Hello s’appuie sur l’identité de ligne établie par un index unique ou une clé qui inclut des performances de tooimprove clé de partitionnement hello et la fiabilité pour les shardlets de grande taille.</span><span class="sxs-lookup"><span data-stu-id="b8b97-244">hello service relies on row identity established by a unique index or key that includes hello sharding key tooimprove performance and reliability for large shardlets.</span></span> <span data-ttu-id="b8b97-245">Données de toomove de service hello ainsi une granularité encore plus que simplement hello partitionnement par valeur de clé.</span><span class="sxs-lookup"><span data-stu-id="b8b97-245">This allows hello service toomove data at an even finer granularity than just hello sharding key value.</span></span> <span data-ttu-id="b8b97-246">Cela permet de tooreduce hello maximum d’espace du journal et les verrous sont requises pendant l’opération de hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-246">This helps tooreduce hello maximum amount of log space and locks that are required during hello operation.</span></span> <span data-ttu-id="b8b97-247">Envisagez de créer un index unique ou une clé primaire, y compris la clé de partitionnement hello sur une table donnée si vous souhaitez que toouse que la table avec les demandes de fractionnement/fusion/déplacement.</span><span class="sxs-lookup"><span data-stu-id="b8b97-247">Consider creating a unique index or a primary key including hello sharding key on a given table if you want toouse that table with split/merge/move requests.</span></span> <span data-ttu-id="b8b97-248">Pour des raisons de performances, clé de partitionnement hello doit être au début colonne clé de hello ou un index de hello hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-248">For performance reasons, hello sharding key should be hello leading column in hello key or hello index.</span></span>
* <span data-ttu-id="b8b97-249">Au cours de hello de traitement des demandes, certaines données shardlet pouvant être présentes sur la source de hello et la partition cible de hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-249">During hello course of request processing, some shardlet data may be present both on hello source and hello target shard.</span></span> <span data-ttu-id="b8b97-250">Cela est nécessaire tooprotect contre les défaillances pendant le déplacement des shardlets de hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-250">This is necessary tooprotect against failures during hello shardlet movement.</span></span> <span data-ttu-id="b8b97-251">Hello intégration de fusion et fractionnement avec la carte de partitions hello garantit que les connexions via hello données dépendant routage API à l’aide de hello **OpenConnectionForKey** méthode sur la carte de partitions hello ne voyez pas les états intermédiaires incohérents.</span><span class="sxs-lookup"><span data-stu-id="b8b97-251">hello integration of split-merge with hello shard map ensures that connections through hello data dependent routing APIs using hello **OpenConnectionForKey** method on hello shard map do not see any inconsistent intermediate states.</span></span> <span data-ttu-id="b8b97-252">Toutefois, quand connexion toohello source ou hello ciblez partitions sans utiliser de hello **OpenConnectionForKey** (méthode), les états intermédiaires incohérents peuvent être visibles lorsque vous allez les demandes de fractionnement/fusion/déplacement.</span><span class="sxs-lookup"><span data-stu-id="b8b97-252">However, when connecting toohello source or hello target shards without using hello **OpenConnectionForKey** method, inconsistent intermediate states might be visible when split/merge/move requests are going on.</span></span> <span data-ttu-id="b8b97-253">Ces connexions peuvent afficher les résultats de partielles ou en doublons en fonction de minutage de hello ou connexion hello sous-jacente de hello partitions.</span><span class="sxs-lookup"><span data-stu-id="b8b97-253">These connections may show partial or duplicate results depending on hello timing or hello shard underlying hello connection.</span></span> <span data-ttu-id="b8b97-254">Cette limitation comprend actuellement les connexions de hello effectuées par les multiples-Shard-requêtes élastique.</span><span class="sxs-lookup"><span data-stu-id="b8b97-254">This limitation currently includes hello connections made by Elastic Scale Multi-Shard-Queries.</span></span>
* <span data-ttu-id="b8b97-255">base de données de métadonnées Hello pour le service de fusion et fractionnement hello ne doit pas être partagé entre les différents rôles.</span><span class="sxs-lookup"><span data-stu-id="b8b97-255">hello metadata database for hello split-merge service must not be shared between different roles.</span></span> <span data-ttu-id="b8b97-256">Par exemple, un rôle de service de fusion et fractionnement hello en transit nécessaires toopoint tooa des métadonnées différentes base de données au rôle de production hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-256">For example, a role of hello split-merge service running in staging needs toopoint tooa different metadata database than hello production role.</span></span>

## <a name="billing"></a><span data-ttu-id="b8b97-257">Facturation</span><span class="sxs-lookup"><span data-stu-id="b8b97-257">Billing</span></span>
<span data-ttu-id="b8b97-258">service de fusion et fractionnement Hello s’exécute comme un service cloud dans votre abonnement Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="b8b97-258">hello split-merge service runs as a cloud service in your Microsoft Azure subscription.</span></span> <span data-ttu-id="b8b97-259">Par conséquent, les frais pour les services cloud s’appliquent à instance tooyour du service de hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-259">Therefore charges for cloud services apply tooyour instance of hello service.</span></span> <span data-ttu-id="b8b97-260">Sauf si vous effectuez fréquemment des opérations de fractionnement, de fusion et de déplacement, nous vous recommandons de supprimer votre service cloud de fractionnement et de fusion.</span><span class="sxs-lookup"><span data-stu-id="b8b97-260">Unless you frequently perform split/merge/move operations, we recommend you delete your split-merge cloud service.</span></span> <span data-ttu-id="b8b97-261">Vous économiserez ainsi en coûts d'exécution ou de déploiement d'instances de service cloud.</span><span class="sxs-lookup"><span data-stu-id="b8b97-261">That saves costs for running or deployed cloud service instances.</span></span> <span data-ttu-id="b8b97-262">Vous pouvez redéployer et démarrer la configuration de votre exécutable facilement à votre convenance tooperform fractionner ou fusionner les opérations.</span><span class="sxs-lookup"><span data-stu-id="b8b97-262">You can re-deploy and start your readily runnable configuration whenever you need tooperform split or merge operations.</span></span> 

## <a name="monitoring"></a><span data-ttu-id="b8b97-263">Surveillance</span><span class="sxs-lookup"><span data-stu-id="b8b97-263">Monitoring</span></span>
### <a name="status-tables"></a><span data-ttu-id="b8b97-264">Tables d'états</span><span class="sxs-lookup"><span data-stu-id="b8b97-264">Status tables</span></span>
<span data-ttu-id="b8b97-265">Service de fractionnement-fusion Hello fournit hello **RequestStatus** table dans la base de données du magasin de métadonnées hello pour l’analyse des demandes terminées et en cours.</span><span class="sxs-lookup"><span data-stu-id="b8b97-265">hello split-merge Service provides hello **RequestStatus** table in hello metadata store database for monitoring of completed and ongoing requests.</span></span> <span data-ttu-id="b8b97-266">Hello répertorie une ligne pour chaque demande de fusion et fractionnement a été instance toothis envoyé du service de fusion et fractionnement hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-266">hello table lists a row for each split-merge request that has been submitted toothis instance of hello split-merge service.</span></span> <span data-ttu-id="b8b97-267">Il donne hello informations pour chaque demande suivantes :</span><span class="sxs-lookup"><span data-stu-id="b8b97-267">It gives hello following information for each request:</span></span>

* <span data-ttu-id="b8b97-268">**Horodatage**: hello heure et date de début de la demande de hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-268">**Timestamp**: hello time and date when hello request was started.</span></span>
* <span data-ttu-id="b8b97-269">**OperationId**: un GUID qui identifie de façon unique la demande de hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-269">**OperationId**: A GUID that uniquely identifies hello request.</span></span> <span data-ttu-id="b8b97-270">Cette demande peut également être utilisé toocancel hello opération alors qu’il est encore en cours.</span><span class="sxs-lookup"><span data-stu-id="b8b97-270">This request can also be used toocancel hello operation while it is still ongoing.</span></span>
* <span data-ttu-id="b8b97-271">**État**: hello l’état actuel de la demande de hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-271">**Status**: hello current state of hello request.</span></span> <span data-ttu-id="b8b97-272">Pour les demandes en cours, il répertorie également hello phase dans le hello demande est en cours.</span><span class="sxs-lookup"><span data-stu-id="b8b97-272">For ongoing requests, it also lists hello current phase in which hello request is.</span></span>
* <span data-ttu-id="b8b97-273">**CancelRequest**: un indicateur qui indique si la demande de hello a été annulée.</span><span class="sxs-lookup"><span data-stu-id="b8b97-273">**CancelRequest**: A flag that indicates whether hello request has been cancelled.</span></span>
* <span data-ttu-id="b8b97-274">**Progression**: une estimation du pourcentage d’achèvement de l’opération de hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-274">**Progress**: A percentage estimate of completion for hello operation.</span></span> <span data-ttu-id="b8b97-275">Une valeur de 50 indique que les opération hello sont achevée à 50 % environ.</span><span class="sxs-lookup"><span data-stu-id="b8b97-275">A value of 50 indicates that hello operation is approximately 50% complete.</span></span>
* <span data-ttu-id="b8b97-276">**Details**: valeur XML qui fournit un rapport de progression plus détaillé.</span><span class="sxs-lookup"><span data-stu-id="b8b97-276">**Details**: An XML value that provides a more detailed progress report.</span></span> <span data-ttu-id="b8b97-277">rapport de progression Hello est régulièrement mis à jour les ensembles de lignes sont copiées à partir de la source tootarget.</span><span class="sxs-lookup"><span data-stu-id="b8b97-277">hello progress report is periodically updated as sets of rows are copied from source tootarget.</span></span> <span data-ttu-id="b8b97-278">En cas d’erreurs ou exceptions, cette colonne inclut également des informations plus détaillées sur les échecs de hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-278">In case of failures or exceptions, this column also includes more detailed information about hello failure.</span></span>

### <a name="azure-diagnostics"></a><span data-ttu-id="b8b97-279">Azure Diagnostics</span><span class="sxs-lookup"><span data-stu-id="b8b97-279">Azure Diagnostics</span></span>
<span data-ttu-id="b8b97-280">service de fusion et fractionnement Hello utilise des Diagnostics Windows Azure basé sur Azure SDK 2.5 pour la surveillance et de diagnostics.</span><span class="sxs-lookup"><span data-stu-id="b8b97-280">hello split-merge service uses Azure Diagnostics based on Azure SDK 2.5 for monitoring and diagnostics.</span></span> <span data-ttu-id="b8b97-281">Vous contrôlez la configuration des diagnostics hello comme expliqué ici : [activation des Diagnostics dans Azure Cloud Services et Machines virtuelles](../cloud-services/cloud-services-dotnet-diagnostics.md).</span><span class="sxs-lookup"><span data-stu-id="b8b97-281">You control hello diagnostics configuration as explained here: [Enabling Diagnostics in Azure Cloud Services and Virtual Machines](../cloud-services/cloud-services-dotnet-diagnostics.md).</span></span> <span data-ttu-id="b8b97-282">package de téléchargement Hello inclut deux configurations de diagnostics - un pour le rôle web de hello et un pour le rôle de travail hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-282">hello download package includes two diagnostics configurations - one for hello web role and one for hello worker role.</span></span> <span data-ttu-id="b8b97-283">Ces configurations de diagnostics pour le service de hello suivent les instructions de hello de [Cloud Service Fundamentals dans Microsoft Azure](https://code.msdn.microsoft.com/windowsazure/Cloud-Service-Fundamentals-4ca72649).</span><span class="sxs-lookup"><span data-stu-id="b8b97-283">These diagnostics configurations for hello service follow hello guidance from [Cloud Service Fundamentals in Microsoft Azure](https://code.msdn.microsoft.com/windowsazure/Cloud-Service-Fundamentals-4ca72649).</span></span> <span data-ttu-id="b8b97-284">Il inclut hello définitions toolog les compteurs de Performance, les journaux IIS, les journaux des événements Windows et les journaux des événements application de fusion et fractionnement.</span><span class="sxs-lookup"><span data-stu-id="b8b97-284">It includes hello definitions toolog Performance Counters, IIS logs, Windows Event Logs, and split-merge application event logs.</span></span> 

## <a name="deploy-diagnostics"></a><span data-ttu-id="b8b97-285">Déployer des diagnostics</span><span class="sxs-lookup"><span data-stu-id="b8b97-285">Deploy Diagnostics</span></span>
<span data-ttu-id="b8b97-286">tooenable d’analyse et de diagnostics à l’aide de la configuration de diagnostic hello pour les rôles web et worker hello fournis par le package NuGet de hello, exécutez hello suivant de commandes à l’aide d’Azure PowerShell :</span><span class="sxs-lookup"><span data-stu-id="b8b97-286">tooenable monitoring and diagnostics using hello diagnostic configuration for hello web and worker roles provided by hello NuGet package, run hello following commands using Azure PowerShell:</span></span> 

    $storage_name = "<YourAzureStorageAccount>" 

    $key = "<YourAzureStorageAccountKey" 

    $storageContext = New-AzureStorageContext -StorageAccountName $storage_name -StorageAccountKey $key  


    $config_path = "<YourFilePath>\SplitMergeWebContent.diagnostics.xml" 

    $service_name = "<YourCloudServiceName>" 

    Set-AzureServiceDiagnosticsExtension -StorageContext $storageContext -DiagnosticsConfigurationPath $config_path -ServiceName $service_name -Slot Production -Role "SplitMergeWeb" 


    $config_path = "<YourFilePath>\SplitMergeWorkerContent.diagnostics.xml" 

    $service_name = "<YourCloudServiceName>" 

    Set-AzureServiceDiagnosticsExtension -StorageContext $storageContext -DiagnosticsConfigurationPath $config_path -ServiceName $service_name -Slot Production -Role "SplitMergeWorker" 

<span data-ttu-id="b8b97-287">Vous trouverez plus d’informations sur la façon de tooconfigure et déployer des paramètres de diagnostics ici : [activation des Diagnostics dans Azure Cloud Services et Machines virtuelles](../cloud-services/cloud-services-dotnet-diagnostics.md).</span><span class="sxs-lookup"><span data-stu-id="b8b97-287">You can find more information on how tooconfigure and deploy diagnostics settings here: [Enabling Diagnostics in Azure Cloud Services and Virtual Machines](../cloud-services/cloud-services-dotnet-diagnostics.md).</span></span> 

## <a name="retrieve-diagnostics"></a><span data-ttu-id="b8b97-288">Récupérer les diagnostics</span><span class="sxs-lookup"><span data-stu-id="b8b97-288">Retrieve diagnostics</span></span>
<span data-ttu-id="b8b97-289">Vous pouvez accéder facilement vos tests de diagnostic à partir de l’Explorateur de serveurs Visual Studio de hello Bonjour Azure-partie de l’arborescence de l’Explorateur de serveurs hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-289">You can easily access your diagnostics from hello Visual Studio Server Explorer in hello Azure part of hello Server Explorer tree.</span></span> <span data-ttu-id="b8b97-290">Ouvrez une instance de Visual Studio, puis dans la barre de menus hello sur vue et l’Explorateur de serveurs.</span><span class="sxs-lookup"><span data-stu-id="b8b97-290">Open a Visual Studio instance, and in hello menu bar click View, and Server Explorer.</span></span> <span data-ttu-id="b8b97-291">Cliquez sur hello icône Azure tooconnect tooyour abonnement Azure.</span><span class="sxs-lookup"><span data-stu-id="b8b97-291">Click hello Azure icon tooconnect tooyour Azure subscription.</span></span> <span data-ttu-id="b8b97-292">Puis accédez tooAzure -> stockage -> <your storage account> -> Tables -> WADLogsTable.</span><span class="sxs-lookup"><span data-stu-id="b8b97-292">Then navigate tooAzure -> Storage -> <your storage account> -> Tables -> WADLogsTable.</span></span> <span data-ttu-id="b8b97-293">Pour plus d’informations, consultez la page [Consultation des ressources de stockage avec l’Explorateur de serveurs](http://msdn.microsoft.com/library/azure/ff683677.aspx).</span><span class="sxs-lookup"><span data-stu-id="b8b97-293">For more information, see [Browsing Storage Resources with Server Explorer](http://msdn.microsoft.com/library/azure/ff683677.aspx).</span></span> 

![WADLogsTable][2]

<span data-ttu-id="b8b97-295">Hello WADLogsTable mis en surbrillance dans la figure hello ci-dessus contient hello détaillée des événements du journal des applications du service de fusion et fractionnement hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-295">hello WADLogsTable highlighted in hello figure above contains hello detailed events from hello split-merge service’s application log.</span></span> <span data-ttu-id="b8b97-296">Notez que de hello téléchargé de la configuration par défaut hello package est orienté vers un déploiement de production.</span><span class="sxs-lookup"><span data-stu-id="b8b97-296">Note that hello default configuration of hello downloaded package is geared towards a production deployment.</span></span> <span data-ttu-id="b8b97-297">Par conséquent, intervalle de salutation auquel journaux et les compteurs sont extraites à partir d’instances de service hello est volumineux (5 minutes).</span><span class="sxs-lookup"><span data-stu-id="b8b97-297">Therefore hello interval at which logs and counters are pulled from hello service instances is large (5 minutes).</span></span> <span data-ttu-id="b8b97-298">Pour le développement et de test, intervalle de salutation inférieure en ajustant des paramètres de diagnostics hello de web de hello ou tooyour de rôle de travail hello a besoin.</span><span class="sxs-lookup"><span data-stu-id="b8b97-298">For test and development, lower hello interval by adjusting hello diagnostics settings of hello web or hello worker role tooyour needs.</span></span> <span data-ttu-id="b8b97-299">Avec le bouton droit sur le rôle hello Bonjour Explorateur de serveurs Visual Studio (voir ci-dessus), puis ajustez hello période de transfert dans la boîte de dialogue de hello pour les paramètres de configuration de Diagnostics hello :</span><span class="sxs-lookup"><span data-stu-id="b8b97-299">Right-click on hello role in hello Visual Studio Server Explorer (see above) and then adjust hello Transfer Period in hello dialog for hello Diagnostics configuration settings:</span></span> 

![Configuration][3]

## <a name="performance"></a><span data-ttu-id="b8b97-301">Performances</span><span class="sxs-lookup"><span data-stu-id="b8b97-301">Performance</span></span>
<span data-ttu-id="b8b97-302">En général, les meilleures performances sont toobe attendu de hello supérieur, niveaux de service plus performant dans la base de données SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="b8b97-302">In general, better performance is toobe expected from hello higher, more performant service tiers in Azure SQL Database.</span></span> <span data-ttu-id="b8b97-303">Les allocations e/s, processeur et mémoire plus élevées pour les niveaux de service supérieurs hello bénéficient de copie en bloc hello et supprimer des opérations hello fusion et fractionnement service utilise.</span><span class="sxs-lookup"><span data-stu-id="b8b97-303">Higher IO, CPU and memory allocations for hello higher service tiers benefit hello bulk copy and delete operations that hello split-merge service uses.</span></span> <span data-ttu-id="b8b97-304">Pour cette raison, augmentez le niveau de service hello pour ces bases de données pour une période limitée, définie.</span><span class="sxs-lookup"><span data-stu-id="b8b97-304">For that reason, increase hello service tier just for those databases for a defined, limited period of time.</span></span>

<span data-ttu-id="b8b97-305">service de Hello effectue également les requêtes de validation dans le cadre de ses opérations normales.</span><span class="sxs-lookup"><span data-stu-id="b8b97-305">hello service also performs validation queries as part of its normal operations.</span></span> <span data-ttu-id="b8b97-306">Ces requêtes validation vérifier présence inattendue des données dans la plage de cible hello et assurez-vous que toute opération de fractionnement/fusion/déplacement démarre à partir d’un état cohérent.</span><span class="sxs-lookup"><span data-stu-id="b8b97-306">These validation queries check for unexpected presence of data in hello target range and ensure that any split/merge/move operation starts from a consistent state.</span></span> <span data-ttu-id="b8b97-307">Ces requêtes toutes les fonctionnent sur les plages de clés de partitionnement définis par l’étendue de hello d’opération de hello et taille de lot hello fourni dans le cadre de la définition de requête hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-307">These queries all work over sharding key ranges defined by hello scope of hello operation and hello batch size provided as part of hello request definition.</span></span> <span data-ttu-id="b8b97-308">Ces requêtes fonctionnent de manière optimale lorsqu’un index est présent qui possède la clé de partitionnement hello comme hello colonne principale.</span><span class="sxs-lookup"><span data-stu-id="b8b97-308">These queries perform best when an index is present that has hello sharding key as hello leading column.</span></span> 

<span data-ttu-id="b8b97-309">En outre, une propriété de l’unicité avec la clé de partitionnement hello en tant que colonne de début hello permettra hello service toouse une approche optimisée qui limite la consommation des ressources en termes d’espace du journal et de la mémoire.</span><span class="sxs-lookup"><span data-stu-id="b8b97-309">In addition, a uniqueness property with hello sharding key as hello leading column will allow hello service toouse an optimized approach that limits resource consumption in terms of log space and memory.</span></span> <span data-ttu-id="b8b97-310">Cette propriété de l’unicité est toomove requis des tailles de données de grande taille (au-dessus de 1 Go).</span><span class="sxs-lookup"><span data-stu-id="b8b97-310">This uniqueness property is required toomove large data sizes (typically above 1GB).</span></span> 

## <a name="how-tooupgrade"></a><span data-ttu-id="b8b97-311">Comment tooupgrade</span><span class="sxs-lookup"><span data-stu-id="b8b97-311">How tooupgrade</span></span>
1. <span data-ttu-id="b8b97-312">Suivez les étapes de hello dans [déployer un service de fusion et fractionnement](sql-database-elastic-scale-configure-deploy-split-and-merge.md).</span><span class="sxs-lookup"><span data-stu-id="b8b97-312">Follow hello steps in [Deploy a split-merge service](sql-database-elastic-scale-configure-deploy-split-and-merge.md).</span></span>
2. <span data-ttu-id="b8b97-313">Modifier votre fichier de configuration de service cloud pour votre déploiement de fusion et fractionnement tooreflect hello nouveaux paramètres de configuration.</span><span class="sxs-lookup"><span data-stu-id="b8b97-313">Change your cloud service configuration file for your split-merge deployment tooreflect hello new configuration parameters.</span></span> <span data-ttu-id="b8b97-314">Un nouveau paramètre obligatoire est hello plus d’informations sur les certificats hello utilisé pour le chiffrement.</span><span class="sxs-lookup"><span data-stu-id="b8b97-314">A new required parameter is hello information about hello certificate used for encryption.</span></span> <span data-ttu-id="b8b97-315">Un moyen simple de toodo Voici toocompare hello nouveau modèle fichier de configuration à partir de téléchargement hello par rapport à votre configuration existante.</span><span class="sxs-lookup"><span data-stu-id="b8b97-315">An easy way toodo this is toocompare hello new configuration template file from hello download against your existing configuration.</span></span> <span data-ttu-id="b8b97-316">Assurez-vous que vous ajoutez des paramètres hello pour « DataEncryptionPrimaryCertificateThumbprint » et « DataEncryptionPrimary » pour les hello et rôle de travail hello.</span><span class="sxs-lookup"><span data-stu-id="b8b97-316">Make sure you add hello settings for “DataEncryptionPrimaryCertificateThumbprint” and “DataEncryptionPrimary” for both hello web and hello worker role.</span></span>
3. <span data-ttu-id="b8b97-317">Avant de déployer hello mise à jour tooAzure, assurez-vous que toutes les opérations de fusion en cours d’exécution de fractionnement ont terminé.</span><span class="sxs-lookup"><span data-stu-id="b8b97-317">Before deploying hello update tooAzure, ensure that all currently running split-merge operations have finished.</span></span> <span data-ttu-id="b8b97-318">Facilement faire cela en interrogeant les tables RequestStatus et PendingWorkflows hello d’une base de données de métadonnées de fusion et fractionnement hello pour les demandes en cours.</span><span class="sxs-lookup"><span data-stu-id="b8b97-318">You can easily do this by querying hello RequestStatus and PendingWorkflows tables in hello split-merge metadata database for ongoing requests.</span></span>
4. <span data-ttu-id="b8b97-319">Mettre à jour votre déploiement de service cloud existant pour la fusion et fractionnement dans votre abonnement Azure avec le nouveau package de hello et votre fichier de configuration de service mis à jour.</span><span class="sxs-lookup"><span data-stu-id="b8b97-319">Update your existing cloud service deployment for split-merge in your Azure subscription with hello new package and your updated service configuration file.</span></span>

<span data-ttu-id="b8b97-320">Vous n’avez pas besoin de tooprovision une nouvelle base de données de métadonnées pour tooupgrade de fusion et fractionnement.</span><span class="sxs-lookup"><span data-stu-id="b8b97-320">You do not need tooprovision a new metadata database for split-merge tooupgrade.</span></span> <span data-ttu-id="b8b97-321">nouvelle version de Hello met automatiquement à niveau les vos métadonnées de base de données toohello nouvelle version existante.</span><span class="sxs-lookup"><span data-stu-id="b8b97-321">hello new version will automatically upgrade your existing metadata database toohello new version.</span></span> 

## <a name="best-practices--troubleshooting"></a><span data-ttu-id="b8b97-322">Meilleures pratiques et dépannage :</span><span class="sxs-lookup"><span data-stu-id="b8b97-322">Best practices & troubleshooting</span></span>
* <span data-ttu-id="b8b97-323">Définir un locataire de test et tester vos opérations de fractionnement/fusion/déplacement plus importantes avec le client de test hello sur plusieurs partitions.</span><span class="sxs-lookup"><span data-stu-id="b8b97-323">Define a test tenant and exercise your most important split/merge/move operations with hello test tenant across several shards.</span></span> <span data-ttu-id="b8b97-324">Assurez-vous que toutes les métadonnées sont correctement défini dans votre carte de partitions et que les opérations de hello ne violent pas les contraintes ou les clés étrangères.</span><span class="sxs-lookup"><span data-stu-id="b8b97-324">Ensure that all metadata is defined correctly in your shard map and that hello operations do not violate constraints or foreign keys.</span></span>
* <span data-ttu-id="b8b97-325">Taille des données client conserver hello test ci-dessus hello taille maximum de données de votre client plus grande problèmes liés à tooensure vous ne rencontrez pas taille des données.</span><span class="sxs-lookup"><span data-stu-id="b8b97-325">Keep hello test tenant data size above hello maximum data size of your largest tenant tooensure you are not encountering data size related issues.</span></span> <span data-ttu-id="b8b97-326">Cela vous permet d’évaluer une limite supérieure sur hello temps toomove un seul client autour.</span><span class="sxs-lookup"><span data-stu-id="b8b97-326">This helps you assess an upper bound on hello time it takes toomove a single tenant around.</span></span> 
* <span data-ttu-id="b8b97-327">Assurez-vous que votre schéma autorise les suppressions.</span><span class="sxs-lookup"><span data-stu-id="b8b97-327">Make sure that your schema allows deletions.</span></span> <span data-ttu-id="b8b97-328">service de fusion et fractionnement Hello requiert des données de tooremove de capacité hello à partir de la partition source de hello une fois que les données de salutation a été correctement copiés toohello cible.</span><span class="sxs-lookup"><span data-stu-id="b8b97-328">hello split-merge service requires hello ability tooremove data from hello source shard once hello data has been successfully copied toohello target.</span></span> <span data-ttu-id="b8b97-329">Par exemple, **déclencheurs delete** peut empêcher le service de hello à partir de la suppression de données source de hello hello et peut entraîner des opérations toofail.</span><span class="sxs-lookup"><span data-stu-id="b8b97-329">For example, **delete triggers** can prevent hello service from deleting hello data on hello source and may cause operations toofail.</span></span>
* <span data-ttu-id="b8b97-330">clé de partitionnement Hello doit être la colonne de début hello dans votre clé primaire ou la définition de l’index unique.</span><span class="sxs-lookup"><span data-stu-id="b8b97-330">hello sharding key should be hello leading column in your primary key or unique index definition.</span></span> <span data-ttu-id="b8b97-331">Qui garantit des performances optimales hello pour hello requêtes de validation de fractionnement ou de fusion et pour les opérations de déplacement et la suppression de données réelles hello qui fonctionnent toujours sur les plages de clés de partitionnement.</span><span class="sxs-lookup"><span data-stu-id="b8b97-331">That ensures hello best performance for hello split or merge validation queries, and for hello actual data movement and deletion operations which always operate on sharding key ranges.</span></span>
* <span data-ttu-id="b8b97-332">Colocaliser votre service de fusion et fractionnement dans hello région et centre de données où se trouvent vos bases de données.</span><span class="sxs-lookup"><span data-stu-id="b8b97-332">Collocate your split-merge service in hello region and data center where your databases reside.</span></span> 

[!INCLUDE [elastic-scale-include](../../includes/elastic-scale-include.md)]

<!--Anchors-->
<!--Image references-->
[1]:./media/sql-database-elastic-scale-overview-split-and-merge/split-merge-overview.png
[2]:./media/sql-database-elastic-scale-overview-split-and-merge/diagnostics.png
[3]:./media/sql-database-elastic-scale-overview-split-and-merge/diagnostics-config.png

