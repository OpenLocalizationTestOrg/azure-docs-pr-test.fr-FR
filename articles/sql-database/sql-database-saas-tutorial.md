---
title: "Déployer et explorer l’application Wingtip SaaS mutualisée qui utilise SQL Azure Database | Microsoft Docs"
description: "Déployez et explorez l’application Wingtip SaaS mutualisée, qui illustre les modèles SaaS en utilisant SQL Azure Database."
keywords: "didacticiel sur les bases de données SQL"
services: sql-database
documentationcenter: 
author: stevestein
manager: jhubbard
editor: 
ms.assetid: 
ms.service: sql-database
ms.custom: scale out apps
ms.workload: data-management
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/26/2017
ms.author: sstein
ms.openlocfilehash: b09bfa8a5bc22a092e963f351e99c16d0e9a57ba
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/03/2017
---
# <a name="deploy-and-explore-a-multi-tenant-application-that-uses-azure-sql-database---wingtip-saas"></a><span data-ttu-id="ad58c-104">Déployer et explorer une application mutualisée qui utilise Azure SQL Database - Wingtip SaaS</span><span class="sxs-lookup"><span data-stu-id="ad58c-104">Deploy and explore a multi-tenant application that uses Azure SQL Database - Wingtip SaaS</span></span>

<span data-ttu-id="ad58c-105">Dans ce didacticiel, vous déployez et explorez l’application Wingtip SaaS.</span><span class="sxs-lookup"><span data-stu-id="ad58c-105">In this tutorial, you deploy and explore the Wingtip SaaS application.</span></span> <span data-ttu-id="ad58c-106">L’application utilise une base de données par locataire, un modèle d’application SaaS, pour traiter plusieurs locataires.</span><span class="sxs-lookup"><span data-stu-id="ad58c-106">The application uses a database-per-tenant, SaaS application pattern, to service multiple tenants.</span></span> <span data-ttu-id="ad58c-107">L’application est conçue pour tirer parti des fonctionnalités SQL Azure Database qui simplifient l’activation des scénarios SaaS.</span><span class="sxs-lookup"><span data-stu-id="ad58c-107">The application is designed to showcase features of Azure SQL Database that simplify enabling SaaS scenarios.</span></span>

<span data-ttu-id="ad58c-108">Cinq minutes après avoir cliqué sur le bouton *Déployer sur Azure* ci-dessous, vous disposez d’une application SaaS mutualisée et fonctionnelle dans le cloud, utilisant SQL Database.</span><span class="sxs-lookup"><span data-stu-id="ad58c-108">Five minutes after clicking the *Deploy to Azure* button below, you have a multi-tenant SaaS application, using SQL Database, up and running in the cloud.</span></span> <span data-ttu-id="ad58c-109">L’application est déployée avec trois exemples de clients, chacun avec sa propre base de données, et tous déployés dans un pool élastique SQL.</span><span class="sxs-lookup"><span data-stu-id="ad58c-109">The application is deployed with three sample tenants, each with its own database, all deployed into a SQL elastic pool.</span></span> <span data-ttu-id="ad58c-110">L’application est déployée sur votre abonnement Azure, ce qui vous donne un accès complet pour explorer et utiliser les composants d’application individuels.</span><span class="sxs-lookup"><span data-stu-id="ad58c-110">The app is deployed to your Azure subscription, giving you full access to explore and work with the individual application components.</span></span> <span data-ttu-id="ad58c-111">Le code source de l’application et les scripts de gestion sont disponibles dans le référentiel GitHub Wingtip SaaS.</span><span class="sxs-lookup"><span data-stu-id="ad58c-111">The application source code and management scripts are available in the WingtipSaaS GitHub repo.</span></span>


<span data-ttu-id="ad58c-112">Ce didacticiel vous apprend à effectuer les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="ad58c-112">In this tutorial you learn:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="ad58c-113">Déployer l’application Wingtip SaaS</span><span class="sxs-lookup"><span data-stu-id="ad58c-113">How to deploy the Wingtip SaaS application</span></span>
> * <span data-ttu-id="ad58c-114">Obtenir le code source de l’application et les scripts de gestion</span><span class="sxs-lookup"><span data-stu-id="ad58c-114">Where to get the application source code, and management scripts</span></span>
> * <span data-ttu-id="ad58c-115">Explorer les serveurs, les pools et les bases de données qui composent l’application</span><span class="sxs-lookup"><span data-stu-id="ad58c-115">About the servers, pools, and databases that make up the app</span></span>
> * <span data-ttu-id="ad58c-116">Identifier comment les clients sont mappés à leurs données grâce au *catalogue*</span><span class="sxs-lookup"><span data-stu-id="ad58c-116">How tenants are mapped to their data with the *catalog*</span></span>
> * <span data-ttu-id="ad58c-117">Configurer un nouveau client</span><span class="sxs-lookup"><span data-stu-id="ad58c-117">How to provision a new tenant</span></span>
> * <span data-ttu-id="ad58c-118">Surveiller l’activité d’un client dans l’application</span><span class="sxs-lookup"><span data-stu-id="ad58c-118">How to monitor tenant activity in the app</span></span>

<span data-ttu-id="ad58c-119">Pour explorer les différents modèles de gestion et de conception SaaS, une [série de didacticiels associés](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials) reposant sur ce déploiement initial est disponible.</span><span class="sxs-lookup"><span data-stu-id="ad58c-119">To explore various SaaS design and management patterns, a [series of related tutorials](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials) is available that build upon this initial deployment.</span></span> <span data-ttu-id="ad58c-120">Tout en parcourant les didacticiels, découvrez plus en détail les scripts fournis et examinez la façon dont les différents modèles de SaaS sont implémentés.</span><span class="sxs-lookup"><span data-stu-id="ad58c-120">While going through the tutorials, dive into the provided scripts, and examine how the different SaaS patterns are implemented.</span></span> <span data-ttu-id="ad58c-121">Parcourez les scripts de chaque didacticiel pour mieux comprendre comment implémenter les nombreuses fonctionnalités SQL Database qui simplifient le développement des applications SaaS.</span><span class="sxs-lookup"><span data-stu-id="ad58c-121">Step through the scripts in each tutorial to gain a deeper understanding how to implement the many SQL Database features that simplify developing SaaS applications.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="ad58c-122">Prérequis</span><span class="sxs-lookup"><span data-stu-id="ad58c-122">Prerequisites</span></span>

<span data-ttu-id="ad58c-123">Pour suivre ce didacticiel, vérifiez que les prérequis suivants sont remplis :</span><span class="sxs-lookup"><span data-stu-id="ad58c-123">To complete this tutorial, make sure the following prerequisites are completed:</span></span>

* <span data-ttu-id="ad58c-124">Azure PowerShell est installé.</span><span class="sxs-lookup"><span data-stu-id="ad58c-124">Azure PowerShell is installed.</span></span> <span data-ttu-id="ad58c-125">Pour plus d’informations, consultez [Bien démarrer avec Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps).</span><span class="sxs-lookup"><span data-stu-id="ad58c-125">For details, see [Getting started with Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span></span>

## <a name="deploy-the-wingtip-saas-application"></a><span data-ttu-id="ad58c-126">Déployer l’application Wingtip SaaS</span><span class="sxs-lookup"><span data-stu-id="ad58c-126">Deploy the Wingtip SaaS application</span></span>

<span data-ttu-id="ad58c-127">Déployer l’application Wingtip SaaS :</span><span class="sxs-lookup"><span data-stu-id="ad58c-127">Deploy the Wingtip SaaS app:</span></span>

1. <span data-ttu-id="ad58c-128">Cliquez sur le bouton **Déployer vers Azure** pour ouvrir le portail Azure sur le modèle de déploiement Wingtip SaaS.</span><span class="sxs-lookup"><span data-stu-id="ad58c-128">Clicking the **Deploy to Azure** button opens the Azure portal to the Wingtip SaaS deployment template.</span></span> <span data-ttu-id="ad58c-129">Le modèle nécessite deux valeurs de paramètre ; le nom d’un nouveau groupe de ressources et un nom d’utilisateur qui distingue ce déploiement des autres déploiements de l’application Wingtip SaaS.</span><span class="sxs-lookup"><span data-stu-id="ad58c-129">The template requires two parameter values; a name for a new resource group, and a user name that distinguishes this deployment from other deployments of the Wingtip SaaS app.</span></span> <span data-ttu-id="ad58c-130">L’étape suivante fournit des détails sur la définition de ces valeurs.</span><span class="sxs-lookup"><span data-stu-id="ad58c-130">The next step provides details for setting these values.</span></span>

   <span data-ttu-id="ad58c-131">Veillez à noter les valeurs exactes que vous utilisez car vous devrez les entrer plus tard dans un fichier de configuration.</span><span class="sxs-lookup"><span data-stu-id="ad58c-131">Make sure to note the exact values that you use, because you will need to enter them into a configuration file later.</span></span>

   <a href="http://aka.ms/deploywtpapp" target="_blank"><img src="http://azuredeploy.net/deploybutton.png"/></a>

1. <span data-ttu-id="ad58c-132">Entrez les valeurs de paramètre requises pour le déploiement :</span><span class="sxs-lookup"><span data-stu-id="ad58c-132">Enter required parameter values for the deployment:</span></span>

    > [!IMPORTANT]
    > <span data-ttu-id="ad58c-133">Certaines authentifications et pare-feu de serveur sont volontairement non sécurisés à des fins de démonstration.</span><span class="sxs-lookup"><span data-stu-id="ad58c-133">Some authentication, and server firewalls are intentionally unsecured for demonstration purposes.</span></span> <span data-ttu-id="ad58c-134">**Créez un nouveau groupe de ressources** et n’utilisez pas de groupes de ressources, serveurs ou pools existants.</span><span class="sxs-lookup"><span data-stu-id="ad58c-134">**Create a new resource group**, and do not use existing resource groups, servers, or pools.</span></span> <span data-ttu-id="ad58c-135">N’utilisez pas cette application, ni les ressources qu’elle crée, pour la production.</span><span class="sxs-lookup"><span data-stu-id="ad58c-135">Do not use this application, or any resources it creates, for production.</span></span> <span data-ttu-id="ad58c-136">Supprimez ce groupe de ressources lorsque vous en avez terminé avec l’application pour interrompre la facturation associée.</span><span class="sxs-lookup"><span data-stu-id="ad58c-136">Delete this resource group when you are finished with the application to stop related billing.</span></span>

    * <span data-ttu-id="ad58c-137">**Groupe de ressources** : sélectionnez **Création** et indiquez un **Nom** pour le groupe de ressources.</span><span class="sxs-lookup"><span data-stu-id="ad58c-137">**Resource group** - Select **Create new** and provide a **Name** for the resource group.</span></span> <span data-ttu-id="ad58c-138">Sélectionnez un **Emplacement** dans la liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="ad58c-138">Select a **Location** from the drop-down list.</span></span>
    * <span data-ttu-id="ad58c-139">**Utilisateur** : certaines ressources nécessitent des noms globalement uniques.</span><span class="sxs-lookup"><span data-stu-id="ad58c-139">**User** - Some resources require names that are globally unique.</span></span> <span data-ttu-id="ad58c-140">Pour garantir l’unicité, chaque fois que vous déployez l’application, fournissez une valeur pour différencier les ressources que vous créez de celles créées par d’autres déploiements de l’application Wingtip.</span><span class="sxs-lookup"><span data-stu-id="ad58c-140">To ensure uniqueness, each time you deploy the application provide a value to differentiate resources you create, from resources created by any other deployment of the Wingtip application.</span></span> <span data-ttu-id="ad58c-141">Nous vous recommandons d’utiliser un nom **Utilisateur** court, tel que vos initiales plus un chiffre (par exemple, *bg1*) et de l’utiliser ensuite dans le nom du groupe de ressources (par exemple, *wingtip-bg1*).</span><span class="sxs-lookup"><span data-stu-id="ad58c-141">It’s recommended to use a short **User** name, such as your initials plus a number (for example, *bg1*), and then use that in the resource group name (for example, *wingtip-bg1*).</span></span> <span data-ttu-id="ad58c-142">Le paramètre **Utilisateur** peut contenir uniquement des lettres, des chiffres et des traits d’union (sans espaces).</span><span class="sxs-lookup"><span data-stu-id="ad58c-142">The **User** parameter can only contain letters, numbers, and hyphens (no spaces).</span></span> <span data-ttu-id="ad58c-143">Le premier et le dernier caractère doivent être une lettre ou un chiffre (l’utilisation de minuscules est recommandée).</span><span class="sxs-lookup"><span data-stu-id="ad58c-143">The first and last character must be a letter or a number (all lowercase is recommended).</span></span>


1. <span data-ttu-id="ad58c-144">**Déployez l’application**.</span><span class="sxs-lookup"><span data-stu-id="ad58c-144">**Deploy the application**.</span></span>

    * <span data-ttu-id="ad58c-145">Cliquez pour accepter les conditions générales.</span><span class="sxs-lookup"><span data-stu-id="ad58c-145">Click to agree to the terms and conditions.</span></span>
    * <span data-ttu-id="ad58c-146">Cliquez sur **Achat**.</span><span class="sxs-lookup"><span data-stu-id="ad58c-146">Click **Purchase**.</span></span>

1. <span data-ttu-id="ad58c-147">Surveiller l’état du déploiement en cliquant sur **Notifications** (l’icône représentant une cloche à droite de la zone de recherche).</span><span class="sxs-lookup"><span data-stu-id="ad58c-147">Monitor deployment status by clicking **Notifications** (the bell icon right of the search box).</span></span> <span data-ttu-id="ad58c-148">Le déploiement de l’application Wingtip SaaS dure environ cinq minutes.</span><span class="sxs-lookup"><span data-stu-id="ad58c-148">Deploying the Wingtip SaaS app takes approximately five minutes.</span></span>

   ![déploiement réussi](media/sql-database-saas-tutorial/succeeded.png)

## <a name="download-and-unblock-the-wingtip-saas-scripts"></a><span data-ttu-id="ad58c-150">Télécharger et débloquer les scripts Wingtip SaaS</span><span class="sxs-lookup"><span data-stu-id="ad58c-150">Download and unblock the Wingtip SaaS scripts</span></span>

<span data-ttu-id="ad58c-151">Lors du déploiement de l’application, téléchargez le code source et les scripts de gestion.</span><span class="sxs-lookup"><span data-stu-id="ad58c-151">While the application is deploying, download the source code and management scripts.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="ad58c-152">Le contenu exécutable (scripts, DLL) peut être bloqué par Windows lorsque des fichiers zip sont téléchargés à partir d’une source externe puis extraits.</span><span class="sxs-lookup"><span data-stu-id="ad58c-152">Executable contents (scripts, dlls) may be blocked by Windows when zip files are downloaded from an external source and extracted.</span></span> <span data-ttu-id="ad58c-153">Lorsque vous extrayez les scripts d’un fichier zip, suivez les étapes ci-dessous pour débloquer le fichier .zip avant l’extraction.</span><span class="sxs-lookup"><span data-stu-id="ad58c-153">When extracting the scripts from a zip file, follow the steps below to unblock the .zip file before extracting.</span></span> <span data-ttu-id="ad58c-154">Cela garantit que les scripts sont autorisés à s’exécuter.</span><span class="sxs-lookup"><span data-stu-id="ad58c-154">This ensures the scripts are allowed to run.</span></span>

1. <span data-ttu-id="ad58c-155">Accédez au [référentiel github Wingtip SaaS](https://github.com/Microsoft/WingtipSaaS).</span><span class="sxs-lookup"><span data-stu-id="ad58c-155">Browse to [the Wingtip SaaS github repo](https://github.com/Microsoft/WingtipSaaS).</span></span>
1. <span data-ttu-id="ad58c-156">Cliquez sur **Cloner ou télécharger**.</span><span class="sxs-lookup"><span data-stu-id="ad58c-156">Click **Clone or download**.</span></span>
1. <span data-ttu-id="ad58c-157">Cliquez sur **Télécharger ZIP** et enregistrez le fichier.</span><span class="sxs-lookup"><span data-stu-id="ad58c-157">Click **Download ZIP** and save the file.</span></span>
1. <span data-ttu-id="ad58c-158">Cliquez avec le bouton droit sur le fichier **WingtipSaaS-master.zip**, puis sélectionnez **Propriétés**.</span><span class="sxs-lookup"><span data-stu-id="ad58c-158">Right-click the **WingtipSaaS-master.zip** file, and select **Properties**.</span></span>
1. <span data-ttu-id="ad58c-159">Sous l’onglet **Général**, sélectionnez **Débloquer**, puis cliquez sur **Appliquer**.</span><span class="sxs-lookup"><span data-stu-id="ad58c-159">On the **General** tab, select **Unblock**, and click **Apply**.</span></span>
1. <span data-ttu-id="ad58c-160">Cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="ad58c-160">Click **OK**.</span></span>
1. <span data-ttu-id="ad58c-161">Procédez à l’extraction des fichiers.</span><span class="sxs-lookup"><span data-stu-id="ad58c-161">Extract the files.</span></span>

<span data-ttu-id="ad58c-162">Les scripts se trouvent dans le dossier *..\\WingtipSaaS-master\\Learning Modules*.</span><span class="sxs-lookup"><span data-stu-id="ad58c-162">Scripts are located in the *..\\WingtipSaaS-master\\Learning Modules* folder.</span></span>

## <a name="update-the-configuration-file-for-this-deployment"></a><span data-ttu-id="ad58c-163">Mettre à jour le fichier de configuration pour ce déploiement</span><span class="sxs-lookup"><span data-stu-id="ad58c-163">Update the configuration file for this deployment</span></span>

<span data-ttu-id="ad58c-164">Avant d’exécuter des scripts, définissez les valeurs *resource group* et *user* dans **UserConfig.psm1**.</span><span class="sxs-lookup"><span data-stu-id="ad58c-164">Before running any scripts, set the *resource group* and *user* values in **UserConfig.psm1**.</span></span> <span data-ttu-id="ad58c-165">Pour ces variables, utilisez les valeurs que vous avez définies pendant le déploiement.</span><span class="sxs-lookup"><span data-stu-id="ad58c-165">Set these variables to the values you set during deployment.</span></span>

1. <span data-ttu-id="ad58c-166">Ouvrez ...\\Learning Modules\\*UserConfig.psm1* dans *PowerShell ISE*.</span><span class="sxs-lookup"><span data-stu-id="ad58c-166">Open ...\\Learning Modules\\*UserConfig.psm1* in the *PowerShell ISE*</span></span>
1. <span data-ttu-id="ad58c-167">Mettez à jour *ResourceGroupName* et *Name* avec les valeurs spécifiques à votre déploiement (lignes 10 et 11 uniquement).</span><span class="sxs-lookup"><span data-stu-id="ad58c-167">Update *ResourceGroupName* and *Name* with the specific values for your deployment (on lines 10 and 11 only).</span></span>
1. <span data-ttu-id="ad58c-168">Enregistrez les modifications !</span><span class="sxs-lookup"><span data-stu-id="ad58c-168">Save the changes!</span></span>

<span data-ttu-id="ad58c-169">Ici, ce paramètre vous évite d’avoir à mettre à jour ces valeurs spécifiques au déploiement dans chaque script.</span><span class="sxs-lookup"><span data-stu-id="ad58c-169">Setting this here simply keeps you from having to update these deployment-specific values in every script.</span></span>

## <a name="run-the-application"></a><span data-ttu-id="ad58c-170">Exécution de l'application</span><span class="sxs-lookup"><span data-stu-id="ad58c-170">Run the application</span></span>

<span data-ttu-id="ad58c-171">L’application présente des lieux, telles que des salles de concert, des clubs de jazz, des salles de sport, etc. qui accueillent des événements.</span><span class="sxs-lookup"><span data-stu-id="ad58c-171">The app showcases venues, such as concert halls, jazz clubs, sports clubs, that host events.</span></span> <span data-ttu-id="ad58c-172">Les lieux sont inscrits en tant que clients de la plateforme Wingtip, offrant ainsi un moyen simple de répertorier les événements et de vendre des tickets.</span><span class="sxs-lookup"><span data-stu-id="ad58c-172">Venues register as customers (or tenants) of the Wingtip platform, for an easy way to list events and sell tickets.</span></span> <span data-ttu-id="ad58c-173">Chaque lieu obtient une application web personnalisée pour gérer et répertorier ses événements, ainsi que pour vendre des billets indépendamment des autres locataires.</span><span class="sxs-lookup"><span data-stu-id="ad58c-173">Each venue gets a personalized web app to manage and list their events and sell tickets, independent and isolated from other tenants.</span></span> <span data-ttu-id="ad58c-174">En coulisse, chaque client obtient une base de données SQL déployée dans un pool élastique SQL.</span><span class="sxs-lookup"><span data-stu-id="ad58c-174">Under the covers, each tenant gets a SQL database deployed into a SQL elastic pool.</span></span>

<span data-ttu-id="ad58c-175">Un **concentrateur d’événements** central fournit une liste d’URL de locataires spécifiques à votre déploiement.</span><span class="sxs-lookup"><span data-stu-id="ad58c-175">A central **Events Hub** provides a list of tenant URLs specific to your deployment.</span></span>

1. <span data-ttu-id="ad58c-176">Ouvrez _l’Event Hub_ dans votre navigateur web : http://events.wtp.&lt;UTILISATEUR&gt;.trafficmanager.net.(à remplacer par le nom d’utilisateur de votre déploiement) :</span><span class="sxs-lookup"><span data-stu-id="ad58c-176">Open the _Events Hub_ in your web browser: http://events.wtp.&lt;USER&gt;.trafficmanager.net (replace with your deployment's user name):</span></span>

    ![events hub](media/sql-database-saas-tutorial/events-hub.png)

1. <span data-ttu-id="ad58c-178">Cliquez sur **Fabrikam Jazz Club** dans le *concentrateur d’événements*.</span><span class="sxs-lookup"><span data-stu-id="ad58c-178">Click **Fabrikam Jazz Club** in the *Events Hub*.</span></span>

   ![Événements](./media/sql-database-saas-tutorial/fabrikam.png)


<span data-ttu-id="ad58c-180">Pour contrôler la distribution des demandes entrantes, l’application utilise [*Azure Traffic Manager*](https://docs.microsoft.com/azure/traffic-manager/traffic-manager-overview).</span><span class="sxs-lookup"><span data-stu-id="ad58c-180">To control the distribution of incoming requests, the app uses [*Azure Traffic Manager*](https://docs.microsoft.com/azure/traffic-manager/traffic-manager-overview).</span></span> <span data-ttu-id="ad58c-181">Les pages d’événements, qui sont spécifiques au locataire, requièrent que les noms des locataires soient inclus dans les URL.</span><span class="sxs-lookup"><span data-stu-id="ad58c-181">The events pages, which are tenant-specific, require that tenant names are included in the URLs.</span></span> <span data-ttu-id="ad58c-182">Toutes les URL de locataires incluent votre propre valeur *Utilisateur* et respectent le format suivant : http://events.wtp.&lt;UTILISATEUR&gt;.trafficmanager.net/*fabrikamjazzclub*.</span><span class="sxs-lookup"><span data-stu-id="ad58c-182">All the tenant URLs include your specific *User* value and follow this format: http://events.wtp.&lt;USER&gt;.trafficmanager.net/*fabrikamjazzclub*.</span></span> <span data-ttu-id="ad58c-183">L’application d’événements analyse le nom du locataire à partir de l’URL et l’utilise pour créer une clé permettant d’accéder à un catalogue utilisant la [*gestion des cartes de partitions*](https://docs.microsoft.com/azure/sql-database/sql-database-elastic-scale-shard-map-management).</span><span class="sxs-lookup"><span data-stu-id="ad58c-183">The events app parses the tenant name from the URL and uses it to create a key to access a catalog using [*shard map management*](https://docs.microsoft.com/azure/sql-database/sql-database-elastic-scale-shard-map-management).</span></span> <span data-ttu-id="ad58c-184">Le catalogue mappe la clé à l’emplacement de la base de données du locataire.</span><span class="sxs-lookup"><span data-stu-id="ad58c-184">The catalog maps the key to the tenant's database location.</span></span> <span data-ttu-id="ad58c-185">Le **concentrateur d’événements** utilise les métadonnées du catalogue afin de récupérer le nom du locataire associé à chaque base de données pour fournir la liste des URL.</span><span class="sxs-lookup"><span data-stu-id="ad58c-185">The **Events Hub** uses extended metadata in the catalog to retrieve the tenant’s name associated with each database to provide the list of URLs.</span></span>

<span data-ttu-id="ad58c-186">Dans un environnement de production, vous créez généralement un enregistrement DNS CNAME pour [*pointer un domaine Internet d’entreprise*](https://docs.microsoft.com/azure/traffic-manager/traffic-manager-point-internet-domain) vers le profil Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="ad58c-186">In a production environment, you would typically create a CNAME DNS record to [*point a company internet domain*](https://docs.microsoft.com/azure/traffic-manager/traffic-manager-point-internet-domain) to the traffic manager profile.</span></span>

## <a name="start-generating-load-on-the-tenant-databases"></a><span data-ttu-id="ad58c-187">Démarrer la génération de charge sur les bases de données de locataires</span><span class="sxs-lookup"><span data-stu-id="ad58c-187">Start generating load on the tenant databases</span></span>

<span data-ttu-id="ad58c-188">Maintenant que l’application est déployée, nous allons l’exécuter !</span><span class="sxs-lookup"><span data-stu-id="ad58c-188">Now that the app is deployed, let’s put it to work!</span></span> <span data-ttu-id="ad58c-189">Le script PowerShell *Demo-LoadGenerator* démarre une charge de travail qui s’exécute sur toutes les bases de données de locataires.</span><span class="sxs-lookup"><span data-stu-id="ad58c-189">The *Demo-LoadGenerator* PowerShell script starts a workload running against all tenant databases.</span></span> <span data-ttu-id="ad58c-190">La charge réelle sur de nombreuses applications SaaS est généralement sporadique et imprévisible.</span><span class="sxs-lookup"><span data-stu-id="ad58c-190">The real-world load on many SaaS apps is typically sporadic and unpredictable.</span></span> <span data-ttu-id="ad58c-191">Pour simuler ce type de charge, le générateur produit une charge distribuée entre tous les locataires, et des rafales se produisent sur chaque client à intervalles aléatoires.</span><span class="sxs-lookup"><span data-stu-id="ad58c-191">To simulate this type of load, the generator produces a load distributed across all tenants, with randomized bursts on each tenant occurring at randomized intervals.</span></span> <span data-ttu-id="ad58c-192">Pour cette raison, plusieurs minutes sont nécessaires avant que le modèle de charge n’émerge, et il est donc préférable de laisser le générateur s’exécuter pendant au moins trois ou quatre minutes avant d’analyser la charge.</span><span class="sxs-lookup"><span data-stu-id="ad58c-192">Because of this it takes several minutes for the load pattern to emerge, so it’s best to let the generator run for at least three or four minutes before monitoring the load.</span></span>

1. <span data-ttu-id="ad58c-193">Dans *PowerShell ISE*, ouvrez le script... \\Learning Modules\\Utilities\\*Demo-LoadGenerator.ps1*.</span><span class="sxs-lookup"><span data-stu-id="ad58c-193">In the *PowerShell ISE*, open the ...\\Learning Modules\\Utilities\\*Demo-LoadGenerator.ps1* script.</span></span>
1. <span data-ttu-id="ad58c-194">Appuyez sur **F5** pour exécuter le script et démarrer le générateur de charge (laissez les valeurs de paramètre par défaut pour l’instant).</span><span class="sxs-lookup"><span data-stu-id="ad58c-194">Press **F5** to run the script and start the load generator (leave the default parameter values for now).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="ad58c-195">Pour exécuter d’autres scripts, ouvrez une nouvelle fenêtre PowerShell ISE.</span><span class="sxs-lookup"><span data-stu-id="ad58c-195">To run other scripts, open a new PowerShell ISE window.</span></span> <span data-ttu-id="ad58c-196">Le générateur de charge exécute une série de travaux dans votre session PowerShell locale.</span><span class="sxs-lookup"><span data-stu-id="ad58c-196">The load generator is running as a series of jobs in your local PowerShell session.</span></span> <span data-ttu-id="ad58c-197">Le script *Demo-LoadGenerator.ps1* lance le script de générateur de charge réel, qui s’exécute comme une tâche de premier plan, ainsi qu’une série de tâches de génération de charge en arrière-plan.</span><span class="sxs-lookup"><span data-stu-id="ad58c-197">The *Demo-LoadGenerator.ps1* script kicks off the actual load generator script, which runs as a foreground task plus a series of background load-generation jobs.</span></span> <span data-ttu-id="ad58c-198">Une tâche de générateur de charge est appelée pour chaque base de données enregistrée dans le catalogue.</span><span class="sxs-lookup"><span data-stu-id="ad58c-198">A load-generator job is invoked for each database registered in the catalog.</span></span> <span data-ttu-id="ad58c-199">Les tâches sont en cours d’exécution dans votre session PowerShell locale, de sorte que la fermeture de la session PowerShell interrompt tous les travaux.</span><span class="sxs-lookup"><span data-stu-id="ad58c-199">The jobs are running in your local PowerShell session, so closing the PowerShell session stops all jobs.</span></span> <span data-ttu-id="ad58c-200">Si vous mettez en veille l’ordinateur, la génération de la charge est interrompue et reprendra dès la sortie de veille de votre ordinateur.</span><span class="sxs-lookup"><span data-stu-id="ad58c-200">If you suspend your machine, load generation is paused and will resume when you wake up your machine.</span></span>

<span data-ttu-id="ad58c-201">Lorsque le générateur de charge appelle des tâches de génération de charge pour chaque locataire, la tâche de premier plan reste à un état d’appel de tâche, dans lequel elle démarre d’autres tâches en arrière-plan pour les nouveaux locataires configurés par la suite.</span><span class="sxs-lookup"><span data-stu-id="ad58c-201">Once the load generator invokes load-generation jobs for each tenant, the foreground task remains in a job-invoking state, where it starts additional background jobs for any new tenants that are subsequently provisioned.</span></span> <span data-ttu-id="ad58c-202">Vous pouvez utiliser *Ctrl-C* ou appuyer sur le bouton *Stop* pour arrêter la tâche de premier plan, mais les tâches en arrière-plan existantes continueront de générer de la charge sur chaque base de données.</span><span class="sxs-lookup"><span data-stu-id="ad58c-202">You can use *Ctrl-C* or press the *Stop* button to stop the foreground task, but existing background jobs will continue generating load on each database.</span></span> <span data-ttu-id="ad58c-203">Si vous avez besoin de surveiller et de contrôler les tâches en arrière-plan, utilisez *Get-Job*, *Receive-Job* et *Stop-Job*.</span><span class="sxs-lookup"><span data-stu-id="ad58c-203">If you need to monitor and control the background jobs, use *Get-Job*, *Receive-Job* and *Stop-Job*.</span></span> <span data-ttu-id="ad58c-204">Pendant l’exécution de la tâche de premier plan, vous ne pouvez pas utiliser la même session PowerShell pour exécuter d’autres scripts.</span><span class="sxs-lookup"><span data-stu-id="ad58c-204">While the foreground task is running you cannot use the same PowerShell session to execute other scripts.</span></span> <span data-ttu-id="ad58c-205">Pour exécuter d’autres scripts, ouvrez une nouvelle fenêtre PowerShell ISE.</span><span class="sxs-lookup"><span data-stu-id="ad58c-205">To run other scripts, open a new PowerShell ISE window.</span></span>

<span data-ttu-id="ad58c-206">Si vous souhaitez redémarrer la session du générateur de charge, par exemple avec des paramètres différents, vous pouvez arrêter la tâche de premier plan puis réexécuter le script *Demo-LoadGenerator.ps1*.</span><span class="sxs-lookup"><span data-stu-id="ad58c-206">If you want to restart the load generator session, for example with different parameters, you can stop the foreground task and then re-run the *Demo-LoadGenerator.ps1* script.</span></span> <span data-ttu-id="ad58c-207">La réexécution de *Demo-LoadGenerator.ps1* arrête d’abord tout travail en cours puis redémarre le générateur, ce qui lance un nouvel ensemble de tâches en utilisant les paramètres actuels.</span><span class="sxs-lookup"><span data-stu-id="ad58c-207">Re-running *Demo-LoadGenerator.ps1* first stops any currently running jobs, and then restarts the generator, which kicks off a new set of jobs using the current parameters.</span></span>

<span data-ttu-id="ad58c-208">Pour l’instant, laissez le générateur de charge en cours d’exécution dans l’état d’appel de tâche.</span><span class="sxs-lookup"><span data-stu-id="ad58c-208">For now, leave the load generator running in the job-invoking state.</span></span>


## <a name="provision-a-new-tenant"></a><span data-ttu-id="ad58c-209">Approvisionner un nouveau locataire</span><span class="sxs-lookup"><span data-stu-id="ad58c-209">Provision a new tenant</span></span>

<span data-ttu-id="ad58c-210">Le déploiement initial crée trois exemples de locataires, mais nous allons créer une autre locataire pour voir comment cela affecte l’application déployée.</span><span class="sxs-lookup"><span data-stu-id="ad58c-210">The initial deployment creates three sample tenants, but let’s create another tenant to see how this impacts the deployed application.</span></span> <span data-ttu-id="ad58c-211">Le flux de travail d’approvisionnement des locataires Wingtip SaaS est détaillé dans le [didacticiel sur l’approvisionnement et le catalogue](sql-database-saas-tutorial-provision-and-catalog.md).</span><span class="sxs-lookup"><span data-stu-id="ad58c-211">The Wingtip SaaS provisioning-tenants workflow is detailed in the [Provision and catalog tutorial](sql-database-saas-tutorial-provision-and-catalog.md).</span></span> <span data-ttu-id="ad58c-212">Dans cette étape, vous créez rapidement un nouveau locataire.</span><span class="sxs-lookup"><span data-stu-id="ad58c-212">In this step, you quickly create a new tenant.</span></span>

1. <span data-ttu-id="ad58c-213">Ouvrez ...\\Learning Modules\Provision and Catalog\\*Demo-ProvisionAndCatalog.ps1* dans *PowerShell ISE*.</span><span class="sxs-lookup"><span data-stu-id="ad58c-213">Open ...\\Learning Modules\Provision and Catalog\\*Demo-ProvisionAndCatalog.ps1* in the *PowerShell ISE*.</span></span>
1. <span data-ttu-id="ad58c-214">Appuyez sur **F5** pour exécuter le script (laissez les valeurs par défaut pour l’instant).</span><span class="sxs-lookup"><span data-stu-id="ad58c-214">Press **F5** to run the script (leave the default values for now).</span></span>

   > [!NOTE]
   > <span data-ttu-id="ad58c-215">De nombreux scripts Wingtip SaaS utilisent *$PSScriptRoot* pour permettre la navigation dans les dossiers afin d’appeler les fonctions d’autres scripts.</span><span class="sxs-lookup"><span data-stu-id="ad58c-215">Many Wingtip SaaS scripts use *$PSScriptRoot* to allow navigating folders to call functions in other scripts.</span></span> <span data-ttu-id="ad58c-216">Cette variable est évaluée uniquement lorsque le script est exécuté en appuyant sur **F5**.</span><span class="sxs-lookup"><span data-stu-id="ad58c-216">This variable is only evaluated when the script is executed by pressing **F5**.</span></span>  <span data-ttu-id="ad58c-217">La mise en surbrillance et l’exécution d’une sélection (**F8**) pouvant entraîner des erreurs, appuyez sur **F5** lors de l’exécution des scripts.</span><span class="sxs-lookup"><span data-stu-id="ad58c-217">Highlighting and running a selection (**F8**) can result in errors, so press **F5** when running scripts.</span></span>

<span data-ttu-id="ad58c-218">La nouvelle base de données du locataire est créée dans un pool élastique SQL, puis initialisée et enregistrée dans le catalogue.</span><span class="sxs-lookup"><span data-stu-id="ad58c-218">The new tenant database is created in a SQL elastic pool, initialized and registered in the catalog.</span></span> <span data-ttu-id="ad58c-219">Une fois l’approvisionnement réussi, le nouveau site *Événements* de vente de billets du locataire s’affiche dans votre navigateur :</span><span class="sxs-lookup"><span data-stu-id="ad58c-219">After successful provisioning, the new tenant's ticket-selling *Events* site appears in your browser:</span></span>

![Nouveau locataire](./media/sql-database-saas-tutorial/red-maple-racing.png)

<span data-ttu-id="ad58c-221">Actualisez le *concentrateur d’événements* : le nouveau locataire apparaît dans la liste.</span><span class="sxs-lookup"><span data-stu-id="ad58c-221">Refresh the *Events Hub* and the new tenant now appears in the list.</span></span>


## <a name="explore-the-servers-pools-and-tenant-databases"></a><span data-ttu-id="ad58c-222">Explorer les serveurs, les pools et les bases de données de locataires</span><span class="sxs-lookup"><span data-stu-id="ad58c-222">Explore the servers, pools, and tenant databases</span></span>

<span data-ttu-id="ad58c-223">Maintenant que vous avez démarré une charge dans le regroupement de locataires, examinons quelques-unes des ressources qui ont été déployées :</span><span class="sxs-lookup"><span data-stu-id="ad58c-223">Now that you've started running a load against the collection of tenants, let’s look at some of the resources that were deployed:</span></span>

1. <span data-ttu-id="ad58c-224">Dans le [portail Azure](http://portal.azure.com), accédez à la liste des serveurs SQL et ouvrez le serveur **catalog-&lt;UTILISATEUR&gt;**.</span><span class="sxs-lookup"><span data-stu-id="ad58c-224">In the [Azure portal](http://portal.azure.com), browse to your list of SQL servers and open the **catalog-&lt;USER&gt;** server.</span></span> <span data-ttu-id="ad58c-225">Le serveur de catalogue contient deux bases de données :</span><span class="sxs-lookup"><span data-stu-id="ad58c-225">The catalog server contains two databases.</span></span> <span data-ttu-id="ad58c-226">**tenantcatalog** et **basetenantdb** (une base de données vide version *gold* ou un modèle de base de données copié pour créer de nouveaux locataires).</span><span class="sxs-lookup"><span data-stu-id="ad58c-226">The **tenantcatalog**, and the **basetenantdb** (an empty *golden* or template database that is copied to create new tenants).</span></span>

   ![bases de données](./media/sql-database-saas-tutorial/databases.png)

1. <span data-ttu-id="ad58c-228">Revenez à la liste des serveurs SQL et ouvrez le serveur **tenants1-&lt;UTILISATEUR&gt;** qui contient les bases de données de locataires.</span><span class="sxs-lookup"><span data-stu-id="ad58c-228">Go back to your list of SQL servers and open the **tenants1-&lt;USER&gt;** server that holds the tenant databases.</span></span> <span data-ttu-id="ad58c-229">Chaque base de données de locataires est une base de données _élastique standard_ dans un pool standard de 50 eDTU.</span><span class="sxs-lookup"><span data-stu-id="ad58c-229">Each tenant database is an _Elastic Standard_ database in a 50 eDTU standard pool.</span></span> <span data-ttu-id="ad58c-230">Notez également la présence d’une base de données _Red Maple Racing_, la base de données de locataires que vous avez approvisionnée précédemment.</span><span class="sxs-lookup"><span data-stu-id="ad58c-230">Also notice there is a _Red Maple Racing_ database, the tenant database you provisioned previously.</span></span>

   ![server](./media/sql-database-saas-tutorial/server.png)

## <a name="monitor-the-pool"></a><span data-ttu-id="ad58c-232">Surveiller le pool</span><span class="sxs-lookup"><span data-stu-id="ad58c-232">Monitor the pool</span></span>

<span data-ttu-id="ad58c-233">Si le générateur de charge s’exécute depuis plusieurs minutes, suffisamment de données doivent être disponibles pour commencer à rechercher certaines des fonctionnalités de surveillance intégrées aux pools et bases de données.</span><span class="sxs-lookup"><span data-stu-id="ad58c-233">If the load generator has been running for several minutes, enough data should be available to start looking at some of the monitoring capabilities built into pools and databases.</span></span>

1. <span data-ttu-id="ad58c-234">Naviguez jusqu’au serveur **tenants1 -&lt;USER&gt;**, puis cliquez sur **Pool1** pour afficher l’utilisation des ressources du pool (le générateur de charge a été exécuté pendant une heure dans les graphiques suivants) :</span><span class="sxs-lookup"><span data-stu-id="ad58c-234">Browse to the server **tenants1-&lt;USER&gt;**, and click **Pool1** to view resource utilization for the pool (the load generator ran for an hour in the following charts):</span></span>

   ![surveiller un pool](./media/sql-database-saas-tutorial/monitor-pool.png)

<span data-ttu-id="ad58c-236">Ces deux graphiques montrent bien que les pools élastiques et SQL Database sont parfaitement adaptés aux charges de travail de l’application SaaS.</span><span class="sxs-lookup"><span data-stu-id="ad58c-236">What these two charts nicely illustrate, is how well suited elastic pools and SQL Database are for SaaS application workloads.</span></span> <span data-ttu-id="ad58c-237">Quatre bases de données qui migrent chacune jusqu’à 40 eDTU sont facilement prises en charge dans un pool de 50 eDTU.</span><span class="sxs-lookup"><span data-stu-id="ad58c-237">Four databases that are each bursting to as much as 40 eDTUs are easily being supported in a 50 eDTU pool.</span></span> <span data-ttu-id="ad58c-238">Si elles ont été approvisionnées en tant que bases de données autonomes, elles devront être de type S2 (50 DTU) pour pouvoir gérer les pics d’activité.</span><span class="sxs-lookup"><span data-stu-id="ad58c-238">If they were provisioned as standalone databases, they would each need to be an S2 (50 DTU) to support the bursts.</span></span> <span data-ttu-id="ad58c-239">Le coût de 4 bases de données autonomes S2 représente près de 3 fois le prix du pool, et le pool dispose toujours de suffisamment d’espace disponible pour accueillir de nombreuses autres bases de données.</span><span class="sxs-lookup"><span data-stu-id="ad58c-239">The cost of 4 standalone S2 databases would be nearly 3 times the price of the pool, and the pool still has plenty of headroom for many more databases.</span></span> <span data-ttu-id="ad58c-240">Dans des situations réelles, les clients SQL Database exécutent jusqu'à 500 bases de données dans des pools de 200 eDTU.</span><span class="sxs-lookup"><span data-stu-id="ad58c-240">In real-world situations, SQL Database customers are currently running up to 500 databases in 200 eDTU pools.</span></span> <span data-ttu-id="ad58c-241">Pour plus d’informations, consultez le [didacticiel Monitor performance of the WTP sample SaaS application](sql-database-saas-tutorial-performance-monitoring.md) (Surveiller les performances de l’exemple d’application SaaS WTP).</span><span class="sxs-lookup"><span data-stu-id="ad58c-241">For more information, see the [performance monitoring tutorial](sql-database-saas-tutorial-performance-monitoring.md).</span></span>


## <a name="next-steps"></a><span data-ttu-id="ad58c-242">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="ad58c-242">Next steps</span></span>

<span data-ttu-id="ad58c-243">Dans ce didacticiel, vous avez appris à effectuer les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="ad58c-243">In this tutorial you learned:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="ad58c-244">Déployer l’application Wingtip SaaS</span><span class="sxs-lookup"><span data-stu-id="ad58c-244">How to deploy the Wingtip SaaS application</span></span>
> * <span data-ttu-id="ad58c-245">Explorer les serveurs, les pools et les bases de données qui composent l’application</span><span class="sxs-lookup"><span data-stu-id="ad58c-245">About the servers, pools, and databases that make up the app</span></span>
> * <span data-ttu-id="ad58c-246">Explorer les locataires qui sont mappés à leurs données avec le *catalogue*</span><span class="sxs-lookup"><span data-stu-id="ad58c-246">Tenants are mapped to their data with the *catalog*</span></span>
> * <span data-ttu-id="ad58c-247">Approvisionner les nouveaux locataires</span><span class="sxs-lookup"><span data-stu-id="ad58c-247">How to provision new tenants</span></span>
> * <span data-ttu-id="ad58c-248">Afficher l’utilisation du pool pour surveiller l’activité du locataire</span><span class="sxs-lookup"><span data-stu-id="ad58c-248">How to view pool utilization to monitor tenant activity</span></span>
> * <span data-ttu-id="ad58c-249">Supprimer les exemples de ressources pour arrêter la facturation associée</span><span class="sxs-lookup"><span data-stu-id="ad58c-249">How to delete sample resources to stop related billing</span></span>

<span data-ttu-id="ad58c-250">Essayez maintenant le [didacticiel Provision new tenants and register them in the catalog](sql-database-saas-tutorial-provision-and-catalog.md) (Approvisionner de nouveaux locataires et les inscrire dans le catalogue).</span><span class="sxs-lookup"><span data-stu-id="ad58c-250">Now try the [Provision and catalog tutorial](sql-database-saas-tutorial-provision-and-catalog.md)</span></span>



## <a name="additional-resources"></a><span data-ttu-id="ad58c-251">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="ad58c-251">Additional resources</span></span>

* <span data-ttu-id="ad58c-252">Autres [didacticiels qui s’appuient sur l’application Wingtip SaaS](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span><span class="sxs-lookup"><span data-stu-id="ad58c-252">Additional [tutorials that build on the Wingtip SaaS application](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span></span>
* <span data-ttu-id="ad58c-253">Pour de plus amples informations sur les pools élastiques, consultez [*Les pools élastiques vous aident à gérer et à mettre à l’échelle plusieurs bases de données SQL*](https://docs.microsoft.com/azure/sql-database/sql-database-elastic-pool).</span><span class="sxs-lookup"><span data-stu-id="ad58c-253">To learn about elastic pools, see [*What is an Azure SQL elastic pool*](https://docs.microsoft.com/azure/sql-database/sql-database-elastic-pool)</span></span>
* <span data-ttu-id="ad58c-254">Pour de plus amples informations sur les travaux élastiques, consultez [*Gestion des bases de données cloud avec montée en charge*](https://docs.microsoft.com/azure/sql-database/sql-database-elastic-jobs-overview).</span><span class="sxs-lookup"><span data-stu-id="ad58c-254">To learn about elastic jobs, see [*Managing scaled-out cloud databases*](https://docs.microsoft.com/azure/sql-database/sql-database-elastic-jobs-overview)</span></span>
* <span data-ttu-id="ad58c-255">Pour de plus amples informations sur les applications SaaS mutualisées, consultez [*Modèles de conception pour les applications SaaS mutualisées et Base de données SQL Azure*](https://docs.microsoft.com/azure/sql-database/sql-database-design-patterns-multi-tenancy-saas-applications).</span><span class="sxs-lookup"><span data-stu-id="ad58c-255">To learn about multi-tenant SaaS applications, see [*Design patterns for multi-tenant SaaS applications*](https://docs.microsoft.com/azure/sql-database/sql-database-design-patterns-multi-tenancy-saas-applications)</span></span>
