---
title: "aaaCopy une base de données SQL Azure | Documents Microsoft"
description: "Création d'une copie d'une base de données SQL Azure"
services: sql-database
documentationcenter: 
author: CarlRabeler
manager: jhubbard
editor: 
ms.assetid: 5aaf6bcd-3839-49b5-8c77-cbdf786e359b
ms.service: sql-database
ms.custom: load & move data
ms.devlang: NA
ms.date: 06/15/2017
ms.author: carlrab
ms.workload: data-management
ms.topic: article
ms.tgt_pltfrm: NA
ms.openlocfilehash: 64a297d819d6da89600fda60abe8394ae405abfe
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="copy-an-azure-sql-database"></a><span data-ttu-id="1bb0c-103">Copie d'une base de données SQL Azure</span><span class="sxs-lookup"><span data-stu-id="1bb0c-103">Copy an Azure SQL database</span></span>

<span data-ttu-id="1bb0c-104">Base de données SQL Azure fournit plusieurs méthodes pour la création d’une copie cohérente de SQL Azure existantes de base de données sur deux hello même serveur ou un autre serveur.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-104">Azure SQL Database provides several methods for creating a transactionally consistent copy of an existing Azure SQL database on either hello same server or a different server.</span></span> <span data-ttu-id="1bb0c-105">Vous pouvez copier une base de données SQL à l’aide de T-SQL, PowerShell ou hello portail Azure.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-105">You can copy a SQL database by using hello Azure portal, PowerShell, or T-SQL.</span></span> 

## <a name="overview"></a><span data-ttu-id="1bb0c-106">Vue d'ensemble</span><span class="sxs-lookup"><span data-stu-id="1bb0c-106">Overview</span></span>

<span data-ttu-id="1bb0c-107">Une copie de la base de données est un instantané de base de données source hello sien hello de demande de copie hello.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-107">A database copy is a snapshot of hello source database as of hello time of hello copy request.</span></span> <span data-ttu-id="1bb0c-108">Vous pouvez sélectionner hello même serveur ou un autre serveur, son niveau de performances et de la couche de service ou un niveau de performance différents au sein de hello même niveau de service (édition).</span><span class="sxs-lookup"><span data-stu-id="1bb0c-108">You can select hello same server or a different server, its service tier and performance level, or a different performance level within hello same service tier (edition).</span></span> <span data-ttu-id="1bb0c-109">Une fois hello copie terminée, elle devient une base de données totalement opérationnelle et indépendante.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-109">After hello copy is complete, it becomes a fully functional, independent database.</span></span> <span data-ttu-id="1bb0c-110">À ce stade, vous pouvez mettre à niveau ou rétrograder le tooany edition.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-110">At this point, you can upgrade or downgrade it tooany edition.</span></span> <span data-ttu-id="1bb0c-111">les autorisations, les utilisateurs et les connexions de hello peuvent être gérées indépendamment.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-111">hello logins, users, and permissions can be managed independently.</span></span>  

## <a name="logins-in-hello-database-copy"></a><span data-ttu-id="1bb0c-112">Connexions dans la copie de base de données hello</span><span class="sxs-lookup"><span data-stu-id="1bb0c-112">Logins in hello database copy</span></span>

<span data-ttu-id="1bb0c-113">Lorsque vous copiez une base de données toohello même serveur logique, hello mêmes connexions peuvent être utilisées sur les deux bases de données.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-113">When you copy a database toohello same logical server, hello same logins can be used on both databases.</span></span> <span data-ttu-id="1bb0c-114">Hello principal de sécurité que vous utilisez base de données toocopy hello devient propriétaire de base de données hello sur la nouvelle base de données hello.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-114">hello security principal you use toocopy hello database becomes hello database owner on hello new database.</span></span> <span data-ttu-id="1bb0c-115">Tous les utilisateurs de base de données, leurs autorisations et leur sécurité (SID) les identificateurs sont copiés de copie de base de données toohello.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-115">All database users, their permissions, and their security identifiers (SIDs) are copied toohello database copy.</span></span>  

<span data-ttu-id="1bb0c-116">Lorsque vous copiez un base de données tooa autre serveur logique, la sécurité de hello principale sur le nouveau serveur de hello devient propriétaire de base de données hello sur la nouvelle base de données hello.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-116">When you copy a database tooa different logical server, hello security principal on hello new server becomes hello database owner on hello new database.</span></span> <span data-ttu-id="1bb0c-117">Si vous utilisez [contenait des utilisateurs de base de données](sql-database-manage-logins.md) pour accéder aux données, vérifiez que les deux hello principal et bases de données secondaires ont toujours hello mêmes informations d’identification utilisateur, afin qu’après hello copie est terminée, vous peuvent accéder immédiatement à hello même informations d’identification.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-117">If you use [contained database users](sql-database-manage-logins.md) for data access, ensure that both hello primary and secondary databases always have hello same user credentials, so that after hello copy is complete you can immediately access it with hello same credentials.</span></span> 

<span data-ttu-id="1bb0c-118">Si vous utilisez [Azure Active Directory](../active-directory/active-directory-whatis.md), vous pouvez éliminer entièrement besoin hello pour la gestion des informations d’identification dans la copie de hello.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-118">If you use [Azure Active Directory](../active-directory/active-directory-whatis.md), you can completely eliminate hello need for managing credentials in hello copy.</span></span> <span data-ttu-id="1bb0c-119">Toutefois, lorsque vous copiez le nouveau serveur hello de base de données tooa, accès en fonction du compte de connexion de hello pas fonctionnent, car les connexions hello n’existent pas sur le nouveau serveur de hello.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-119">However, when you copy hello database tooa new server, hello login-based access might not work, because hello logins do not exist on hello new server.</span></span> <span data-ttu-id="1bb0c-120">toolearn sur la gestion des connexions lorsque vous copiez un base de données tooa autre serveur logique, consultez [toomanage SQL Azure base de sécurité après la récupération d’urgence](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="1bb0c-120">toolearn about managing logins when you copy a database tooa different logical server, see [How toomanage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span> 

<span data-ttu-id="1bb0c-121">Une fois la copie hello et avant les autres utilisateurs soient remappés, uniquement hello connexion qui a initié hello copie, propriétaire de base de données hello, peut se connecter toohello nouvelle base de données.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-121">After hello copying succeeds and before other users are remapped, only hello login that initiated hello copying, hello database owner, can log in toohello new database.</span></span> <span data-ttu-id="1bb0c-122">connexions tooresolve après hello opération de copie est terminée, consultez [résoudre connexions](#resolve-logins).</span><span class="sxs-lookup"><span data-stu-id="1bb0c-122">tooresolve logins after hello copying operation is complete, see [Resolve logins](#resolve-logins).</span></span>

## <a name="copy-a-database-by-using-hello-azure-portal"></a><span data-ttu-id="1bb0c-123">Copier une base de données à l’aide de hello portail Azure</span><span class="sxs-lookup"><span data-stu-id="1bb0c-123">Copy a database by using hello Azure portal</span></span>

<span data-ttu-id="1bb0c-124">toocopy une base de données à l’aide de hello portail Azure, page hello ouvert pour votre base de données, puis cliquez sur **copie**.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-124">toocopy a database by using hello Azure portal, open hello page for your database, and then click **Copy**.</span></span> 

   ![Copie de base de données](./media/sql-database-copy/database-copy.png)

## <a name="copy-a-database-by-using-powershell"></a><span data-ttu-id="1bb0c-126">Copier une base de données à l’aide de PowerShell</span><span class="sxs-lookup"><span data-stu-id="1bb0c-126">Copy a database by using PowerShell</span></span>

<span data-ttu-id="1bb0c-127">toocopy une base de données à l’aide de PowerShell, utilisez hello [New-AzureRmSqlDatabaseCopy](/powershell/module/azurerm.sql/new-azurermsqldatabasecopy) applet de commande.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-127">toocopy a database by using PowerShell, use hello [New-AzureRmSqlDatabaseCopy](/powershell/module/azurerm.sql/new-azurermsqldatabasecopy) cmdlet.</span></span> 

```PowerShell
New-AzureRmSqlDatabaseCopy -ResourceGroupName "myResourceGroup" `
    -ServerName $sourceserver `
    -DatabaseName "MySampleDatabase" `
    -CopyResourceGroupName "myResourceGroup" `
    -CopyServerName $targetserver `
    -CopyDatabaseName "CopyOfMySampleDatabase"
```

<span data-ttu-id="1bb0c-128">Pour un exemple complet de script, consultez [copier un tooa nouveau serveur de base de données](scripts/sql-database-copy-database-to-new-server-powershell.md).</span><span class="sxs-lookup"><span data-stu-id="1bb0c-128">For a complete sample script, see [Copy a database tooa new server](scripts/sql-database-copy-database-to-new-server-powershell.md).</span></span>

## <a name="copy-a-database-by-using-transact-sql"></a><span data-ttu-id="1bb0c-129">Copier une base de données à l’aide de Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="1bb0c-129">Copy a database by using Transact-SQL</span></span>

<span data-ttu-id="1bb0c-130">Ouvrez une session toohello principale de base de données avec connexion du principal au niveau du serveur hello ou connexion hello créer hello base de données toocopy.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-130">Log in toohello master database with hello server-level principal login or hello login that created hello database you want toocopy.</span></span> <span data-ttu-id="1bb0c-131">Pour la base de données copie toosucceed, les connexions qui ne sont pas hello au niveau du serveur principal doivent être membres du rôle dbmanager de hello.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-131">For database copying toosucceed, logins that are not hello server-level principal must be members of hello dbmanager role.</span></span> <span data-ttu-id="1bb0c-132">Pour plus d’informations sur les connexions et connexion toohello server, consultez [gérer des connexions](sql-database-manage-logins.md).</span><span class="sxs-lookup"><span data-stu-id="1bb0c-132">For more information about logins and connecting toohello server, see [Manage logins](sql-database-manage-logins.md).</span></span>

<span data-ttu-id="1bb0c-133">Commencer la copie de base de données source hello avec hello [CREATE DATABASE](https://msdn.microsoft.com/library/ms176061.aspx) instruction.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-133">Start copying hello source database with hello [CREATE DATABASE](https://msdn.microsoft.com/library/ms176061.aspx) statement.</span></span> <span data-ttu-id="1bb0c-134">L’exécution de cette instruction de lance le processus de copie de la base de données hello.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-134">Executing this statement initiates hello database copying process.</span></span> <span data-ttu-id="1bb0c-135">Étant donné que la copie d’une base de données est un processus asynchrone, hello instruction CREATE DATABASE retourne avant que la copie de base de données hello est terminée.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-135">Because copying a database is an asynchronous process, hello CREATE DATABASE statement returns before hello database copying is complete.</span></span>

### <a name="copy-a-sql-database-toohello-same-server"></a><span data-ttu-id="1bb0c-136">Copier un toohello de la base de données SQL server même</span><span class="sxs-lookup"><span data-stu-id="1bb0c-136">Copy a SQL database toohello same server</span></span>
<span data-ttu-id="1bb0c-137">Ouvrez une session toohello principale de base de données avec connexion du principal au niveau du serveur hello ou connexion hello créer hello base de données toocopy.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-137">Log in toohello master database with hello server-level principal login or hello login that created hello database you want toocopy.</span></span> <span data-ttu-id="1bb0c-138">Pour la base de données copie toosucceed, les connexions qui ne sont pas hello au niveau du serveur principal doivent être membres du rôle dbmanager de hello.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-138">For database copying toosucceed, logins that are not hello server-level principal must be members of hello dbmanager role.</span></span>

<span data-ttu-id="1bb0c-139">Cette commande copie Database1 tooa nouvelle base de données nommée Database2 sur hello même serveur.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-139">This command copies Database1 tooa new database named Database2 on hello same server.</span></span> <span data-ttu-id="1bb0c-140">Selon la taille de hello de votre base de données, hello opération de copie peut prendre quelques toocomplete de temps.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-140">Depending on hello size of your database, hello copying operation might take some time toocomplete.</span></span>

    -- Execute on hello master database.
    -- Start copying.
    CREATE DATABASE Database1_copy AS COPY OF Database1;

### <a name="copy-a-sql-database-tooa-different-server"></a><span data-ttu-id="1bb0c-141">Copier un serveur de différents tooa de base de données SQL</span><span class="sxs-lookup"><span data-stu-id="1bb0c-141">Copy a SQL database tooa different server</span></span>

<span data-ttu-id="1bb0c-142">Connectez-vous toohello principale de base de données du serveur de destination hello, serveur de base de données SQL hello où la nouvelle base de données hello est toobe créé.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-142">Log in toohello master database of hello destination server, hello SQL database server where hello new database is toobe created.</span></span> <span data-ttu-id="1bb0c-143">Utilisez une connexion qui a hello même nom et le mot de passe en tant que propriétaire de base de données hello de base de données source hello sur le serveur de base de données SQL hello source.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-143">Use a login that has hello same name and password as hello database owner of hello source database on hello source SQL database server.</span></span> <span data-ttu-id="1bb0c-144">Hello connexion sur le serveur de destination hello doit également être membre du rôle dbmanager de hello ou être hello connexion du principal au niveau du serveur.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-144">hello login on hello destination server must also be a member of hello dbmanager role or be hello server-level principal login.</span></span>

<span data-ttu-id="1bb0c-145">Cette commande copie Database1 sur server1 tooa nouvelle base de données nommée Database2 sur server2.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-145">This command copies Database1 on server1 tooa new database named Database2 on server2.</span></span> <span data-ttu-id="1bb0c-146">Selon la taille de hello de votre base de données, hello opération de copie peut prendre quelques toocomplete de temps.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-146">Depending on hello size of your database, hello copying operation might take some time toocomplete.</span></span>

    -- Execute on hello master database of hello target server (server2)
    -- Start copying from Server1 tooServer2
    CREATE DATABASE Database1_copy AS COPY OF server1.Database1;


### <a name="monitor-hello-progress-of-hello-copying-operation"></a><span data-ttu-id="1bb0c-147">Surveiller la progression hello Hello opération de copie</span><span class="sxs-lookup"><span data-stu-id="1bb0c-147">Monitor hello progress of hello copying operation</span></span>

<span data-ttu-id="1bb0c-148">Surveiller le processus de copie hello en interrogeant les vues sys.databases et sys.dm_database_copies hello.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-148">Monitor hello copying process by querying hello sys.databases and sys.dm_database_copies views.</span></span> <span data-ttu-id="1bb0c-149">Lors de la copie de hello est en cours, hello **state_desc** le jeu de colonnes de vue de sys.databases hello pour la nouvelle base de données hello est trop**copie**.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-149">While hello copying is in progress, hello **state_desc** column of hello sys.databases view for hello new database is set too**COPYING**.</span></span>

* <span data-ttu-id="1bb0c-150">Si hello copie échoue, hello **state_desc** le jeu de colonnes de vue de sys.databases hello pour la nouvelle base de données hello est trop**SOUPÇONNER**.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-150">If hello copying fails, hello **state_desc** column of hello sys.databases view for hello new database is set too**SUSPECT**.</span></span> <span data-ttu-id="1bb0c-151">Exécutez hello instruction DROP sur la nouvelle base de données hello et réessayez plus tard.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-151">Execute hello DROP statement on hello new database, and try again later.</span></span>
* <span data-ttu-id="1bb0c-152">Si hello copie réussit, hello **state_desc** le jeu de colonnes de vue de sys.databases hello pour la nouvelle base de données hello est trop**ONLINE**.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-152">If hello copying succeeds, hello **state_desc** column of hello sys.databases view for hello new database is set too**ONLINE**.</span></span> <span data-ttu-id="1bb0c-153">Hello la copie est terminée et nouvelle base de données hello est une base de données normale qui peut être modifié indépendamment de la base de données source hello.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-153">hello copying is complete, and hello new database is a regular database that can be changed independent of hello source database.</span></span>

> [!NOTE]
> <span data-ttu-id="1bb0c-154">Si vous décidez de toocancel hello copie alors qu’il est en cours d’exécution, exécutez hello [DROP DATABASE](https://msdn.microsoft.com/library/ms178613.aspx) instruction sur la nouvelle base de données hello.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-154">If you decide toocancel hello copying while it is in progress, execute hello [DROP DATABASE](https://msdn.microsoft.com/library/ms178613.aspx) statement on hello new database.</span></span> <span data-ttu-id="1bb0c-155">Vous pouvez également l’exécution d’instruction DROP DATABASE de hello sur la base de données source hello annule également hello processus de copie.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-155">Alternatively, executing hello DROP DATABASE statement on hello source database also cancels hello copying process.</span></span>
> 

## <a name="resolve-logins"></a><span data-ttu-id="1bb0c-156">Résolution des connexions</span><span class="sxs-lookup"><span data-stu-id="1bb0c-156">Resolve logins</span></span>

<span data-ttu-id="1bb0c-157">Une fois la nouvelle base de données hello en ligne sur le serveur de destination hello, utilisez hello [ALTER USER](https://msdn.microsoft.com/library/ms176060.aspx) instruction tooremap hello les utilisateurs de hello nouvelle base de données toologins sur le serveur de destination hello.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-157">After hello new database is online on hello destination server, use hello [ALTER USER](https://msdn.microsoft.com/library/ms176060.aspx) statement tooremap hello users from hello new database toologins on hello destination server.</span></span> <span data-ttu-id="1bb0c-158">les utilisateurs tooresolve orphelin, voir [dépanner des utilisateurs orphelins](https://msdn.microsoft.com/library/ms175475.aspx).</span><span class="sxs-lookup"><span data-stu-id="1bb0c-158">tooresolve orphaned users, see [Troubleshoot Orphaned Users](https://msdn.microsoft.com/library/ms175475.aspx).</span></span> <span data-ttu-id="1bb0c-159">Voir aussi [toomanage SQL Azure base de sécurité après la récupération d’urgence](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="1bb0c-159">See also [How toomanage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>

<span data-ttu-id="1bb0c-160">Tous les utilisateurs de base de données hello conservent les autorisations de hello qu’ils avaient dans la base de données source hello.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-160">All users in hello new database retain hello permissions that they had in hello source database.</span></span> <span data-ttu-id="1bb0c-161">Hello l’utilisateur qui a initié la copie de base de données hello devient propriétaire de base de données hello de base de données hello et reçoit un nouvel identificateur de sécurité (SID).</span><span class="sxs-lookup"><span data-stu-id="1bb0c-161">hello user who initiated hello database copy becomes hello database owner of hello new database and is assigned a new security identifier (SID).</span></span> <span data-ttu-id="1bb0c-162">Une fois la copie hello et avant les autres utilisateurs soient remappés, uniquement hello connexion qui a initié hello copie, propriétaire de base de données hello, peut se connecter toohello nouvelle base de données.</span><span class="sxs-lookup"><span data-stu-id="1bb0c-162">After hello copying succeeds and before other users are remapped, only hello login that initiated hello copying, hello database owner, can log in toohello new database.</span></span>

<span data-ttu-id="1bb0c-163">toolearn sur la gestion des connexions et les utilisateurs lorsque vous copiez un base de données tooa autre serveur logique, consultez [toomanage SQL Azure base de sécurité après la récupération d’urgence](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="1bb0c-163">toolearn about managing users and logins when you copy a database tooa different logical server, see [How toomanage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="1bb0c-164">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="1bb0c-164">Next steps</span></span>

* <span data-ttu-id="1bb0c-165">Pour plus d’informations sur les connexions, consultez [gérer des connexions](sql-database-manage-logins.md) et [toomanage SQL Azure base de sécurité après la récupération d’urgence](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="1bb0c-165">For information about logins, see [Manage logins](sql-database-manage-logins.md) and [How toomanage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>
* <span data-ttu-id="1bb0c-166">tooexport une base de données, consultez [exporter hello de base de données tooa BACPAC](sql-database-export.md).</span><span class="sxs-lookup"><span data-stu-id="1bb0c-166">tooexport a database, see [Export hello database tooa BACPAC](sql-database-export.md).</span></span>
