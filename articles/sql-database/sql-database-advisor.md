---
title: "Recommandations relatives aux performances - Azure SQL Database | Microsoft Docs"
description: "Azure SQL Database fournit des recommandations pour vos bases de données SQL afin d’améliorer le niveau de performance actuel des requêtes."
services: sql-database
documentationcenter: 
author: stevestein
manager: jhubbard
editor: monicar
ms.assetid: 1db441ff-58f5-45da-8d38-b54dc2aa6145
ms.service: sql-database
ms.custom: monitor & tune
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-management
ms.date: 07/05/2017
ms.author: sstein
ms.openlocfilehash: 357a25a665894c86ddb0f93beeb4dd59d8837489
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/11/2017
---
# <a name="performance-recommendations"></a><span data-ttu-id="51295-103">Recommandations en matière de performances</span><span class="sxs-lookup"><span data-stu-id="51295-103">Performance recommendations</span></span>

<span data-ttu-id="51295-104">Azure SQL Database apprend et s’adapte à votre application afin de vous fournir des recommandations personnalisées qui vous permettront d’optimiser les performances de vos bases de données SQL.</span><span class="sxs-lookup"><span data-stu-id="51295-104">Azure SQL Database learns and adapts with your application and provides customized recommendations enabling you to maximize the performance of your SQL databases.</span></span> <span data-ttu-id="51295-105">Vos performances sont évaluées en permanence grâce à l’analyse de votre historique d’utilisation de SQL Database.</span><span class="sxs-lookup"><span data-stu-id="51295-105">Your performance is continuously assessed by analyzing your SQL Database usage history.</span></span> <span data-ttu-id="51295-106">Les recommandations fournies se fondent sur un modèle unique de charge de travail d’une base de données, et aident à améliorer les performances de la base de données.</span><span class="sxs-lookup"><span data-stu-id="51295-106">The recommendations that are provided are based on a database unique workload pattern and help improve its performance.</span></span>

> [!NOTE]
> <span data-ttu-id="51295-107">Il est conseillé d’utiliser les recommandations en activant l’option de réglage automatique sur votre base de données.</span><span class="sxs-lookup"><span data-stu-id="51295-107">Recommended way of using recommendations is by enabling ‘Automatic tuning’ on your database.</span></span> <span data-ttu-id="51295-108">Pour en savoir plus, consultez la page [Réglage automatique](sql-database-automatic-tuning.md).</span><span class="sxs-lookup"><span data-stu-id="51295-108">For details, see [Automatic tuning](sql-database-automatic-tuning.md).</span></span>
>

## <a name="create-index-recommendations"></a><span data-ttu-id="51295-109">Recommandations relatives à la création d’un index</span><span class="sxs-lookup"><span data-stu-id="51295-109">Create index recommendations</span></span>
<span data-ttu-id="51295-110">Azure SQL Database surveille de manière continue les requêtes exécutées et identifie les index capables d’améliorer le niveau de performance.</span><span class="sxs-lookup"><span data-stu-id="51295-110">Azure SQL Database continuously monitors the queries being executed and identifies the indexes that could improve the performance.</span></span> <span data-ttu-id="51295-111">Dès que la base de données estime qu’un index manque, une recommandation **Créer un index** est créée.</span><span class="sxs-lookup"><span data-stu-id="51295-111">Once enough confidence is built that a certain index is missing, a new **Create index** recommendation will be created.</span></span> <span data-ttu-id="51295-112">Azure SQL Database renforce le climat de confiance en estimant le gain de performances que l’index pourrait apporter au fil du temps.</span><span class="sxs-lookup"><span data-stu-id="51295-112">Azure SQL Database builds confidence by estimating performance gain the index would bring through time.</span></span> <span data-ttu-id="51295-113">Selon le gain de performances estimé, les recommandations sont réparties en trois catégories : Élevée, Moyenne ou Faible.</span><span class="sxs-lookup"><span data-stu-id="51295-113">Depending on the estimated performance gain, recommendations are categorized as High, Medium,  or Low.</span></span> 

<span data-ttu-id="51295-114">Les index créés à l’aide de recommandations portent toujours l’indicateur auto_created.</span><span class="sxs-lookup"><span data-stu-id="51295-114">Indexes created using recommendations are always flagged as auto_created indexes.</span></span> <span data-ttu-id="51295-115">Vous pouvez voir quels index possèdent l’indicateur auto_created en examinant la vue sys.indexes.</span><span class="sxs-lookup"><span data-stu-id="51295-115">You can see which indexes are auto_created by looking at sys.indexes view.</span></span> <span data-ttu-id="51295-116">Les index créés automatiquement ne bloquent pas les commandes ALTER/RENAME.</span><span class="sxs-lookup"><span data-stu-id="51295-116">Auto created indexes don’t block ALTER/RENAME commands.</span></span> <span data-ttu-id="51295-117">Si vous essayez de supprimer la colonne qui possède un index créé automatiquement, la commande est transmise et l’index supprimé en même temps que la commande.</span><span class="sxs-lookup"><span data-stu-id="51295-117">If you try to drop the column that has an auto created index over it, the command passes and the auto created index is dropped with the command as well.</span></span> <span data-ttu-id="51295-118">Les index normaux peuvent bloquer les commandes ALTER/RENAME sur les colonnes indexées.</span><span class="sxs-lookup"><span data-stu-id="51295-118">Regular indexes would block the ALTER/RENAME command on columns that are indexed.</span></span>

<span data-ttu-id="51295-119">Une fois que la recommandation de création de l’index est appliquée, Azure SQL Database compare le niveau de performance des requêtes avec le référentiel de performances.</span><span class="sxs-lookup"><span data-stu-id="51295-119">Once the create index recommendation is applied, Azure SQL Database will compare performance of the queries with the baseline performance.</span></span> <span data-ttu-id="51295-120">Si le niveau de performance est amélioré grâce au nouvel index, la recommandation sera désignée comme réussie et un rapport d’impact sera généré.</span><span class="sxs-lookup"><span data-stu-id="51295-120">If new index brought improvements in the performance, recommendation will be flagged as successful and impact report will be available.</span></span> <span data-ttu-id="51295-121">Si l’index n’apporte aucun avantage, il sera automatiquement restauré.</span><span class="sxs-lookup"><span data-stu-id="51295-121">In case the index didn’t bring the benefits, it will be automatically reverted.</span></span> <span data-ttu-id="51295-122">De cette manière, Azure SQL Database garantit que l’utilisation des recommandations améliore uniquement le niveau de performance.</span><span class="sxs-lookup"><span data-stu-id="51295-122">This way Azure SQL Database ensures that using recommendations will only improve the database performance.</span></span>

<span data-ttu-id="51295-123">N’importe quelle recommandation **Créer un index** possède une stratégie d’abstention. Cette stratégie n’autorise pas l’application d’une recommandation si la base de données ou l’utilisation du DTU de pool atteint 80 % dans les dernières 20 minutes, ou si le stockage atteint un taux d’utilisation de plus de 90 %.</span><span class="sxs-lookup"><span data-stu-id="51295-123">Any **Create index** recommendation has a back off policy that won’t allow applying the recommendation if the database or pool DTU usage was above 80% in last 20 minutes or if the storage is above 90% of usage.</span></span> <span data-ttu-id="51295-124">Dans ce cas, la recommandation est reportée.</span><span class="sxs-lookup"><span data-stu-id="51295-124">In this case, the recommendation will be postponed.</span></span>

## <a name="drop-index-recommendations"></a><span data-ttu-id="51295-125">Recommandations relatives à la suppression d’index</span><span class="sxs-lookup"><span data-stu-id="51295-125">Drop index recommendations</span></span>
<span data-ttu-id="51295-126">En plus de détecter un index manquant, Azure SQL Database analyse continuellement le niveau de performance des index existants.</span><span class="sxs-lookup"><span data-stu-id="51295-126">In addition to detecting a missing index, Azure SQL Database continuously analyzes the performance of existing indexes.</span></span> <span data-ttu-id="51295-127">Si l’index n’est pas utilisé, Azure SQL Database recommande sa suppression.</span><span class="sxs-lookup"><span data-stu-id="51295-127">If index is not used, Azure SQL Database will recommend dropping it.</span></span> <span data-ttu-id="51295-128">Il est recommandé de supprimer un index dans deux cas :</span><span class="sxs-lookup"><span data-stu-id="51295-128">Dropping an index is recommended in two cases:</span></span>
* <span data-ttu-id="51295-129">L’index est un doublon d’un autre index (même colonne, schéma de partition et filtres indexés et inclus)</span><span class="sxs-lookup"><span data-stu-id="51295-129">Index is a duplicate of another index (same indexed and included column, partition schema, and filters)</span></span>
* <span data-ttu-id="51295-130">L’index n’est pas utilisé pendant une période prolongée (93 jours)</span><span class="sxs-lookup"><span data-stu-id="51295-130">Index is unused for a prolonged period (93 days)</span></span>

<span data-ttu-id="51295-131">Les recommandations de suppression d’index passent également par la vérification, suite à l’implémentation.</span><span class="sxs-lookup"><span data-stu-id="51295-131">Drop index recommendations also go through the verification after implementation.</span></span> <span data-ttu-id="51295-132">Si le niveau de performance est amélioré, le rapport d’impact est disponible.</span><span class="sxs-lookup"><span data-stu-id="51295-132">If the performance is improved the impact report will be available.</span></span> <span data-ttu-id="51295-133">Si une dégradation du niveau de performance est détectée, la recommandation est restaurée.</span><span class="sxs-lookup"><span data-stu-id="51295-133">In case performance degradation is detected, recommendation will be reverted.</span></span>


## <a name="parameterize-queries-recommendations"></a><span data-ttu-id="51295-134">Recommandations de paramétrage de requêtes</span><span class="sxs-lookup"><span data-stu-id="51295-134">Parameterize queries recommendations</span></span>
<span data-ttu-id="51295-135">Les recommandations liées au **paramétrage des requêtes** s’affichent lorsque vous disposez d’une ou plusieurs requêtes qui sont constamment recompilées, mais ont en fin de compte le même plan d’exécution de requête.</span><span class="sxs-lookup"><span data-stu-id="51295-135">**Parameterize queries** recommendations appear when you have one or more queries that are constantly being recompiled but end up with the same query execution plan.</span></span> <span data-ttu-id="51295-136">Cela ouvre la possibilité d’appliquer un paramétrage forcé, ce qui permet de mettre en cache les plans de requête et de les réutiliser pour améliorer les performances et réduire l’utilisation des ressources.</span><span class="sxs-lookup"><span data-stu-id="51295-136">This condition opens up an opportunity to apply forced parameterization, which will allow query plans to be cached and reused in the future improving performance and reducing resource usage.</span></span> 

<span data-ttu-id="51295-137">Chaque requête adressée initialement à SQL Server doit être compilée pour générer un plan d’exécution.</span><span class="sxs-lookup"><span data-stu-id="51295-137">Every query issued against SQL Server initially needs to be compiled to generate an execution plan.</span></span> <span data-ttu-id="51295-138">Chaque plan généré est ajouté au cache du plan et les exécutions ultérieures de la même requête peuvent réutiliser ce plan à partir du cache, évitant ainsi toute compilation supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="51295-138">Each generated plan is added to the plan cache and subsequent executions of the same query can reuse this plan from the cache, eliminating the need for additional compilation.</span></span> 

<span data-ttu-id="51295-139">Les applications qui envoient des requêtes incluant des valeurs non paramétrées peuvent entraîner une baisse des performances, car le plan d’exécution est recompilé pour chaque requête de ce type avec des valeurs de paramètres différentes.</span><span class="sxs-lookup"><span data-stu-id="51295-139">Applications that send queries, which include non-parameterized values, can lead to a performance overhead, where for every such query with different parameter values the execution plan is compiled again.</span></span> <span data-ttu-id="51295-140">Dans de nombreux cas, les mêmes requêtes avec différentes valeurs de paramètres génèrent les mêmes plans d’exécution, mais ces plans sont toujours ajoutés séparément au cache du plan.</span><span class="sxs-lookup"><span data-stu-id="51295-140">In many cases the same queries with different parameter values generate the same execution plans, but these plans are still separately added to the plan cache.</span></span> <span data-ttu-id="51295-141">La recompilation des plans d’exécution utilise des ressources de base de données, augmente la durée la requête et dépasse la capacité du cache du plan, entraînant la suppression des plans de ce cache.</span><span class="sxs-lookup"><span data-stu-id="51295-141">Recompiling execution plans use database resources, increase the query duration time and overflow the plan cache causing plans to be evicted from the cache.</span></span> <span data-ttu-id="51295-142">Ce comportement de SQL Server peut être modifié en définissant l’option de paramétrage forcé au niveau de la base de données.</span><span class="sxs-lookup"><span data-stu-id="51295-142">This behavior of SQL Server can be altered by setting the forced parameterization option on the database.</span></span> 

<span data-ttu-id="51295-143">Pour vous aider à évaluer l’impact de cette recommandation, nous vous fournissons une comparaison entre l’utilisation réelle et l’utilisation projetée du processeur (comme si la recommandation avait été appliquée).</span><span class="sxs-lookup"><span data-stu-id="51295-143">To help you estimate the impact of this recommendation, you are provided with a comparison between the actual CPU usage and the projected CPU usage (as if the recommendation was applied).</span></span> <span data-ttu-id="51295-144">Outre le fait que le processeur est moins sollicité, la durée de la requête dans la compilation diminue.</span><span class="sxs-lookup"><span data-stu-id="51295-144">In addition to CPU savings, your query duration decreases for the time spent in compilation.</span></span> <span data-ttu-id="51295-145">La surcharge sur le cache du plan sera également beaucoup moins importante, permettant ainsi à la majorité des plans de rester dans le cache et d’être réutilisés.</span><span class="sxs-lookup"><span data-stu-id="51295-145">There will also be much less overhead on plan cache, allowing majority of the plans to stay in cache and be reused.</span></span> <span data-ttu-id="51295-146">Vous pouvez appliquer cette recommandation rapidement et facilement en cliquant sur la commande **Appliquer**.</span><span class="sxs-lookup"><span data-stu-id="51295-146">You can apply this recommendation quickly and easily by clicking on the **Apply** command.</span></span> 

<span data-ttu-id="51295-147">Une fois appliquée, cette recommandation active en quelques minutes le paramétrage forcé sur votre base de données et démarre le processus de surveillance qui dure environ 24 heures.</span><span class="sxs-lookup"><span data-stu-id="51295-147">Once you apply this recommendation, it will enable forced parameterization within minutes on your database and it starts the monitoring process which approximately lasts for 24 hours.</span></span> <span data-ttu-id="51295-148">Après cette période, vous pourrez consulter le rapport de validation qui indique l’utilisation du processeur de votre base de données 24 heures avant et après l’application de la recommandation.</span><span class="sxs-lookup"><span data-stu-id="51295-148">After this period, you will be able to see the validation report that shows CPU usage of your database 24 hours before and after the recommendation has been applied.</span></span> <span data-ttu-id="51295-149">SQL Database Advisor intègre un mécanisme de sécurité qui annule automatiquement la recommandation appliquée si une baisse des performances est détectée.</span><span class="sxs-lookup"><span data-stu-id="51295-149">SQL Database Advisor has a safety mechanism that automatically reverts the applied recommendation in case a performance regression has been detected.</span></span>

## <a name="fix-schema-issues-recommendations"></a><span data-ttu-id="51295-150">Recommandations de résolution des problèmes de schéma</span><span class="sxs-lookup"><span data-stu-id="51295-150">Fix schema issues recommendations</span></span>
<span data-ttu-id="51295-151">Les recommandations liées à la **résolution des problèmes de schéma** s’affichent lorsque le service SQL Database détecte une anomalie dans le nombre d’erreurs SQL liées au schéma qui se produisent dans Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="51295-151">**Fix schema issues** recommendations appear when the SQL Database service notices an anomaly in the number of schema-related SQL errors happening on your Azure SQL Database.</span></span> <span data-ttu-id="51295-152">Cette recommandation s’affiche généralement lorsque votre base de données rencontre plusieurs erreurs liées au schéma (nom de colonne non valide, nom d’objet non valide, etc.) dans la même heure.</span><span class="sxs-lookup"><span data-stu-id="51295-152">This recommendation typically appears when your database encounters multiple schema-related errors (invalid column name, invalid object name, etc.) within an hour.</span></span>

<span data-ttu-id="51295-153">Les « problèmes de schéma » représentent une catégorie d’erreurs de syntaxe dans SQL Server, qui se produisent lorsque la définition de la requête SQL et la définition du schéma de la base de données ne sont pas alignées.</span><span class="sxs-lookup"><span data-stu-id="51295-153">“Schema issues” are a class of syntax errors in SQL Server that happen when the definition of the SQL query and the definition of the database schema are not aligned.</span></span> <span data-ttu-id="51295-154">Par exemple, une des colonnes attendues par la requête est manquante dans la table cible, ou inversement.</span><span class="sxs-lookup"><span data-stu-id="51295-154">For example, one of the columns expected by the query may be missing in the target table, or vice versa.</span></span> 

<span data-ttu-id="51295-155">Les recommandations « Résoudre les problèmes de schéma » s’affichent lorsque le service Azure SQL Database détecte une anomalie dans le nombre d’erreurs SQL liées au schéma qui se produisent dans Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="51295-155">“Fix schema issue” recommendation appears when Azure SQL Database service notices an anomaly in the number of schema-related SQL errors happening on your Azure SQL Database.</span></span> <span data-ttu-id="51295-156">Le tableau suivant répertorie les erreurs liées à des problèmes de schéma :</span><span class="sxs-lookup"><span data-stu-id="51295-156">The following table shows the errors that are related to schema issues:</span></span>

| <span data-ttu-id="51295-157">Code d'erreur SQL</span><span class="sxs-lookup"><span data-stu-id="51295-157">SQL Error Code</span></span> | <span data-ttu-id="51295-158">Message</span><span class="sxs-lookup"><span data-stu-id="51295-158">Message</span></span> |
| --- | --- |
| <span data-ttu-id="51295-159">201</span><span class="sxs-lookup"><span data-stu-id="51295-159">201</span></span> |<span data-ttu-id="51295-160">La procédure ou fonction '*’ attend le paramètre ’*', qui n’a pas été fourni.</span><span class="sxs-lookup"><span data-stu-id="51295-160">Procedure or function '*' expects parameter '*', which was not supplied.</span></span> |
| <span data-ttu-id="51295-161">207</span><span class="sxs-lookup"><span data-stu-id="51295-161">207</span></span> |<span data-ttu-id="51295-162">Nom de colonne non valide '*'.</span><span class="sxs-lookup"><span data-stu-id="51295-162">Invalid column name '*'.</span></span> |
| <span data-ttu-id="51295-163">208</span><span class="sxs-lookup"><span data-stu-id="51295-163">208</span></span> |<span data-ttu-id="51295-164">Nom d'objet non valide ’*’.</span><span class="sxs-lookup"><span data-stu-id="51295-164">Invalid object name '*'.</span></span> |
| <span data-ttu-id="51295-165">213</span><span class="sxs-lookup"><span data-stu-id="51295-165">213</span></span> |<span data-ttu-id="51295-166">Le nom de la colonne ou le nombre de valeurs fournies ne correspond pas à la définition de la table.</span><span class="sxs-lookup"><span data-stu-id="51295-166">Column name or number of supplied values does not match table definition.</span></span> |
| <span data-ttu-id="51295-167">2812</span><span class="sxs-lookup"><span data-stu-id="51295-167">2812</span></span> |<span data-ttu-id="51295-168">Impossible de trouver la procédure stockée '*'.</span><span class="sxs-lookup"><span data-stu-id="51295-168">Could not find stored procedure '*'.</span></span> |
| <span data-ttu-id="51295-169">8144</span><span class="sxs-lookup"><span data-stu-id="51295-169">8144</span></span> |<span data-ttu-id="51295-170">La procédure ou la fonction * a trop d’arguments spécifiés.</span><span class="sxs-lookup"><span data-stu-id="51295-170">Procedure or function * has too many arguments specified.</span></span> |

## <a name="next-steps"></a><span data-ttu-id="51295-171">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="51295-171">Next steps</span></span>
<span data-ttu-id="51295-172">Surveillez vos recommandations et continuez à les appliquer pour affiner les performances.</span><span class="sxs-lookup"><span data-stu-id="51295-172">Monitor your recommendations and continue to apply them to refine performance.</span></span> <span data-ttu-id="51295-173">Les charges de travail d’une base de données sont dynamiques et évoluent en permanence.</span><span class="sxs-lookup"><span data-stu-id="51295-173">Database workloads are dynamic and change continuously.</span></span> <span data-ttu-id="51295-174">SQL Database Advisor continue à surveiller et à fournir des recommandations pouvant potentiellement améliorer les performances de votre base de données.</span><span class="sxs-lookup"><span data-stu-id="51295-174">SQL Database advisor continues to monitor and provide recommendations that can potentially improve your database's performance.</span></span> 

* <span data-ttu-id="51295-175">Consultez la page [Performance recommendations in the Azure portal](sql-database-advisor-portal.md) (Recommandations en matière de performances dans le portail Azure) afin d’obtenir des instructions sur l’utilisation des recommandations relatives aux performances dans le portail Azure.</span><span class="sxs-lookup"><span data-stu-id="51295-175">See [Performance recommendations in the Azure portal](sql-database-advisor-portal.md) for steps on how to use performance recommendations in the Azure portal.</span></span>
* <span data-ttu-id="51295-176">Pour connaître l’impact de vos principales requêtes sur les performances, consultez [Query Performance Insights](sql-database-query-performance.md) (Analyse des performances des requêtes).</span><span class="sxs-lookup"><span data-stu-id="51295-176">See [Query Performance Insights](sql-database-query-performance.md) to learn about and view the performance impact of your top queries.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="51295-177">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="51295-177">Additional resources</span></span>
* [<span data-ttu-id="51295-178">Magasin de requêtes</span><span class="sxs-lookup"><span data-stu-id="51295-178">Query Store</span></span>](https://msdn.microsoft.com/library/dn817826.aspx)
* [<span data-ttu-id="51295-179">CREATE INDEX</span><span class="sxs-lookup"><span data-stu-id="51295-179">CREATE INDEX</span></span>](https://msdn.microsoft.com/library/ms188783.aspx)
* [<span data-ttu-id="51295-180">Contrôle d’accès en fonction du rôle</span><span class="sxs-lookup"><span data-stu-id="51295-180">Role-based access control</span></span>](../active-directory/role-based-access-control-what-is.md)

