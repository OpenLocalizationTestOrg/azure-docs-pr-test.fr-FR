---
title: "aaaDesign Azure modèles pour les solutions complexes | Documents Microsoft"
description: "Présente les bonnes pratiques de conception des modèles Azure Resource Manager pour les scénarios complexes"
services: azure-resource-manager
documentationcenter: 
author: tfitzmac
manager: timlt
editor: tysonn
ms.assetid: ce1141d6-ece7-4976-acea-1db1f775409e
ms.service: azure-resource-manager
ms.workload: multiple
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 12/19/2016
ms.author: tomfitz
ms.openlocfilehash: aa45e9a46d79a6336b696cff8fd37f65fa449f11
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="design-patterns-for-azure-resource-manager-templates-when-deploying-complex-solutions"></a><span data-ttu-id="21f96-103">Concevoir des modèles pour les modèles Azure Resource Manager lors du déploiement de solutions complexes</span><span class="sxs-lookup"><span data-stu-id="21f96-103">Design patterns for Azure Resource Manager templates when deploying complex solutions</span></span>
<span data-ttu-id="21f96-104">À l’aide d’une approche souple, basée sur des modèles Azure Resource Manager, vous pouvez déployer des topologies complexes rapidement et de manière homogène.</span><span class="sxs-lookup"><span data-stu-id="21f96-104">Using a flexible approach based on Azure Resource Manager templates, you can deploy complex topologies quickly and consistently.</span></span> <span data-ttu-id="21f96-105">Vous pouvez adapter ces déploiements facilement en tant que de faire évoluer les offres de base ou tooaccommodate des variantes des scénarios de valeurs hors norme ou des clients.</span><span class="sxs-lookup"><span data-stu-id="21f96-105">You can adapt these deployments easily as core offerings evolve or tooaccommodate variants for outlier scenarios or customers.</span></span>

<span data-ttu-id="21f96-106">Cette rubrique fait partie d’un livre blanc plus volumineux.</span><span class="sxs-lookup"><span data-stu-id="21f96-106">This topic is part of a larger whitepaper.</span></span> <span data-ttu-id="21f96-107">hello tooread complète papier, téléchargez [World classe Azure Resource Manager modèles et éprouvée méthodes conseillées](http://download.microsoft.com/download/8/E/1/8E1DBEFA-CECE-4DC9-A813-93520A5D7CFE/World Class ARM Templates - Considerations and Proven Practices.pdf).</span><span class="sxs-lookup"><span data-stu-id="21f96-107">tooread hello full paper, download [World Class Azure Resource Manager Templates Considerations and Proven Practices](http://download.microsoft.com/download/8/E/1/8E1DBEFA-CECE-4DC9-A813-93520A5D7CFE/World Class ARM Templates - Considerations and Proven Practices.pdf).</span></span>

<span data-ttu-id="21f96-108">Les modèles contiennent des avantages hello Hello sous-jacent Azure Resource Manager avec capacité d’adaptation hello et la lisibilité de JavaScript Objet Notation (JSON).</span><span class="sxs-lookup"><span data-stu-id="21f96-108">Templates combine hello benefits of hello underlying Azure Resource Manager with hello adaptability and readability of JavaScript Object Notation (JSON).</span></span> <span data-ttu-id="21f96-109">En utilisant des modèles, vous pouvez :</span><span class="sxs-lookup"><span data-stu-id="21f96-109">Using templates, you can:</span></span>

* <span data-ttu-id="21f96-110">déployer des topologies et leurs charges de travail de manière cohérente ;</span><span class="sxs-lookup"><span data-stu-id="21f96-110">Deploy topologies and their workloads consistently.</span></span>
* <span data-ttu-id="21f96-111">gérer l’ensemble de vos ressources dans une application à l’aide de groupes de ressources ;</span><span class="sxs-lookup"><span data-stu-id="21f96-111">Manage all your resources in an application together using resource groups.</span></span>
* <span data-ttu-id="21f96-112">Appliquer l’accès en fonction du rôle (RBAC) de contrôle toogrant accès approprié toousers, des groupes et des services.</span><span class="sxs-lookup"><span data-stu-id="21f96-112">Apply role-based access control (RBAC) toogrant appropriate access toousers, groups, and services.</span></span>
* <span data-ttu-id="21f96-113">Utiliser des tâches de toostreamline associations balises telles que des cumuls de facturation.</span><span class="sxs-lookup"><span data-stu-id="21f96-113">Use tagging associations toostreamline tasks such as billing rollups.</span></span>

<span data-ttu-id="21f96-114">Cet article fournit des détails sur les scénarios de consommation, l’architecture et les modèles d’implémentation identifiés au cours de nos sessions de conception et pendant les implémentations de modèle dans le monde réel auprès des clients AzureCAT (Azure Customer Advisory Team).</span><span class="sxs-lookup"><span data-stu-id="21f96-114">This article provides details on consumption scenarios, architecture, and implementation patterns identified during our design sessions and real-world template implementations with Azure Customer Advisory Team (AzureCAT) customers.</span></span> <span data-ttu-id="21f96-115">Loin d’être éducation, ces approches des pratiques éprouvées par développement hello des modèles de 12 de technologies de systèmes d’exploitation basés sur Linux de haut hello, y compris : Apache Kafka, Apache Spark, Cloudera, Couchbase, Hortonworks HDP, Enterprise DataStax alimenté par Apache Cassandra, Elasticsearch, Jenkins, MongoDB, PostgreSQL, Redis et Nagios.</span><span class="sxs-lookup"><span data-stu-id="21f96-115">Far from academic, these approaches are proven practices informed by hello development of templates for 12 of hello top Linux-based OSS technologies, including: Apache Kafka, Apache Spark, Cloudera, Couchbase, Hortonworks HDP, DataStax Enterprise powered by Apache Cassandra, Elasticsearch, Jenkins, MongoDB, PostgreSQL, Redis, and Nagios.</span></span> 

<span data-ttu-id="21f96-116">Cet article partage ces toohelp pratiques éprouvées architecte de modèles Azure Resource Manager de classe mondiale.</span><span class="sxs-lookup"><span data-stu-id="21f96-116">This article shares these proven practices toohelp you architect world class Azure Resource Manager templates.</span></span>  

<span data-ttu-id="21f96-117">Au cours de notre collaboration avec les clients, nous avons identifié plusieurs expériences de consommation de modèles Resource Manager dans les entreprises, chez les intégrateurs de systèmes et les fournisseurs de services cloud.</span><span class="sxs-lookup"><span data-stu-id="21f96-117">In our work with customers, we have identified several Resource Manager template consumption experiences across enterprises, System Integrators (SI)s, and CSVs.</span></span> <span data-ttu-id="21f96-118">Hello sections suivantes fournissent une vue d’ensemble des scénarios courants et des modèles pour différents types de clients.</span><span class="sxs-lookup"><span data-stu-id="21f96-118">hello following sections provide a high-level overview of common scenarios and patterns for different customer types.</span></span>

## <a name="enterprises-and-system-integrators"></a><span data-ttu-id="21f96-119">Entreprises et intégrateurs de systèmes</span><span class="sxs-lookup"><span data-stu-id="21f96-119">Enterprises and system integrators</span></span>
<span data-ttu-id="21f96-120">Dans les grandes entreprises, il existe généralement deux utilisateurs de modèles Resource Manager : les équipes de développement logiciel internes et les services informatiques.</span><span class="sxs-lookup"><span data-stu-id="21f96-120">Within large organizations, we commonly see two consumers of Resource Manager templates: internal software development teams and corporate IT.</span></span> <span data-ttu-id="21f96-121">Nous avons constaté que les scénarios de hello pour hello SIs mappent toohello scénarios pour les entreprises, c’est le cas hello mêmes considérations s’appliquent.</span><span class="sxs-lookup"><span data-stu-id="21f96-121">We've found that hello scenarios for hello SIs map toohello scenarios for Enterprises, so hello same considerations apply.</span></span>

### <a name="internal-software-development-teams"></a><span data-ttu-id="21f96-122">Équipes de développement logiciel internes</span><span class="sxs-lookup"><span data-stu-id="21f96-122">Internal software development teams</span></span>
<span data-ttu-id="21f96-123">Si votre équipe développe toosupport du logiciel de votre entreprise, modèles fournissent un moyen simple tooquickly déployer des technologies à utiliser dans les solutions d’entreprise spécifiques.</span><span class="sxs-lookup"><span data-stu-id="21f96-123">If your team develops software toosupport your business, templates provide an easy way tooquickly deploy technologies for use in business-specific solutions.</span></span> <span data-ttu-id="21f96-124">Vous pouvez également utiliser des modèles toorapidly créer des environnements de formation qui permettent les compétences nécessaires de toogain de membres de l’équipe.</span><span class="sxs-lookup"><span data-stu-id="21f96-124">You can also use templates toorapidly create training environments that enable team members toogain necessary skills.</span></span>

<span data-ttu-id="21f96-125">Vous pouvez utiliser des modèles en tant que-est ou d’étendre ou de les composer tooaccommodate vos besoins.</span><span class="sxs-lookup"><span data-stu-id="21f96-125">You can use templates as-is or extend or compose them tooaccommodate your needs.</span></span> <span data-ttu-id="21f96-126">En utilisant un marquage dans les modèles, vous pouvez fournir un récapitulatif de facturation avec différentes vues, par exemple équipe, projet, individu et formation.</span><span class="sxs-lookup"><span data-stu-id="21f96-126">Using tagging within templates, you can provide a billing summary with various views such as team, project, individual, and education.</span></span>

<span data-ttu-id="21f96-127">Les entreprises souhaitent souvent un modèle pour un déploiement cohérent d’une solution toocreate des équipes de développement de logiciels.</span><span class="sxs-lookup"><span data-stu-id="21f96-127">Businesses often want software development teams toocreate a template for consistent deployment of a solution.</span></span> <span data-ttu-id="21f96-128">modèle de Hello facilite contraintes afin que certains éléments au sein de cet environnement restent fixes et ne peut pas être substituées.</span><span class="sxs-lookup"><span data-stu-id="21f96-128">hello template facilitates constraints so certain items within that environment remain fixed and can't be overridden.</span></span> <span data-ttu-id="21f96-129">Par exemple, une banque peut nécessiter un tooinclude modèle RBAC, pour un programmeur ne peut pas modifier une solution bancaire compte de stockage personnel tooa toosend données.</span><span class="sxs-lookup"><span data-stu-id="21f96-129">For example, a bank might require a template tooinclude RBAC so a programmer can’t revise a banking solution toosend data tooa personal storage account.</span></span>

### <a name="corporate-it"></a><span data-ttu-id="21f96-130">Services informatiques</span><span class="sxs-lookup"><span data-stu-id="21f96-130">Corporate IT</span></span>
<span data-ttu-id="21f96-131">Les entreprises disposant de services informatiques utilisent généralement des modèles pour fournir une capacité de cloud et des fonctionnalités hébergées dans le cloud.</span><span class="sxs-lookup"><span data-stu-id="21f96-131">Corporate IT organizations typically use templates for delivering cloud capacity and cloud-hosted capabilities.</span></span>

#### <a name="cloud-capacity"></a><span data-ttu-id="21f96-132">Capacité de cloud</span><span class="sxs-lookup"><span data-stu-id="21f96-132">Cloud capacity</span></span>
<span data-ttu-id="21f96-133">Une méthode courante pour l’entreprise informatique groupes tooprovide capacité du cloud pour les équipes est « tailles t-shirt », qui sont standard offre des tailles de petite, moyenne et grande.</span><span class="sxs-lookup"><span data-stu-id="21f96-133">A common way for corporate IT groups tooprovide cloud capacity for teams is with "t-shirt sizes", which are standard offering sizes such as small, medium, and large.</span></span> <span data-ttu-id="21f96-134">offres de taille de t-shirt Hello peuvent combiner différents types de ressources et les quantités tout en offrant un niveau de normalisation qui rend possible toouse modèles.</span><span class="sxs-lookup"><span data-stu-id="21f96-134">hello t-shirt sized offerings can mix different resource types and quantities while providing a level of standardization that makes it possible toouse templates.</span></span> <span data-ttu-id="21f96-135">modèles de Hello offrent des capacités de façon cohérente qui applique les stratégies d’entreprise et utilise des balises tooprovide rétrofacturation tooconsuming organisations.</span><span class="sxs-lookup"><span data-stu-id="21f96-135">hello templates deliver capacity in a consistent way that enforces corporate policies and uses tagging tooprovide chargeback tooconsuming organizations.</span></span>

<span data-ttu-id="21f96-136">Par exemple, vous devrez peut-être tooprovide développement, de test ou les environnements de production dans le hello équipes de développement logiciel peuvent déployer leurs solutions.</span><span class="sxs-lookup"><span data-stu-id="21f96-136">For example, you may need tooprovide development, test, or production environments within which hello software development teams can deploy their solutions.</span></span> <span data-ttu-id="21f96-137">environnement de Hello possède une topologie de réseau prédéfinis et éléments hello équipes de développement logiciel ne peut pas modifier, tels que les règles régissant l’accès toohello publique internet et paquet d’inspection.</span><span class="sxs-lookup"><span data-stu-id="21f96-137">hello environment has a predefined network topology and elements that hello software development teams cannot change, such as rules governing access toohello public internet and packet inspection.</span></span> <span data-ttu-id="21f96-138">Vous pourriez également avoir des rôles spécifiques à l’entreprise pour ces environnements avec des droits d’accès distincts pour les environnement hello.</span><span class="sxs-lookup"><span data-stu-id="21f96-138">You may also have organization-specific roles for these environments with distinct access rights for hello environment.</span></span>

#### <a name="cloud-hosted-capabilities"></a><span data-ttu-id="21f96-139">Fonctionnalités hébergées dans le cloud</span><span class="sxs-lookup"><span data-stu-id="21f96-139">Cloud-hosted capabilities</span></span>
<span data-ttu-id="21f96-140">Vous pouvez utiliser des modèles toosupport hébergé dans le cloud fonctions, y compris des packages logiciels individuels ou des offres de composites qui sont proposés toointernal des secteurs d’activité.</span><span class="sxs-lookup"><span data-stu-id="21f96-140">You can use templates toosupport cloud-hosted capabilities, including individual software packages or composite offerings that are offered toointernal lines of business.</span></span> <span data-ttu-id="21f96-141">Exemple d’une offre composite : analyse proposée en tant que service (analyse, visualisation et autres technologies), transmise dans une configuration optimisée et connectée dans une topologie de réseau prédéfinie.</span><span class="sxs-lookup"><span data-stu-id="21f96-141">An example of a composite offering would be analytics-as-a-service—analytics, visualization, and other technologies—delivered in an optimized, connected configuration on a predefined network topology.</span></span>

<span data-ttu-id="21f96-142">Hébergé dans le cloud de fonctionnalités sont affectées par la sécurité de hello et les considérations de rôle établies par la capacité du cloud hello offre sur lequel elles sont construites.</span><span class="sxs-lookup"><span data-stu-id="21f96-142">Cloud-hosted capabilities are affected by hello security and role considerations established by hello cloud capacity offering on which they’re built.</span></span> <span data-ttu-id="21f96-143">Ces fonctionnalités sont proposées telles quelles ou en tant que service administré.</span><span class="sxs-lookup"><span data-stu-id="21f96-143">These capabilities are offered as is or as a managed service.</span></span> <span data-ttu-id="21f96-144">Pourquoi ce dernier, où l’accès est limité de rôles sont requis accès tooenable dans l’environnement de hello à des fins de gestion.</span><span class="sxs-lookup"><span data-stu-id="21f96-144">For hello latter, access-constrained roles are required tooenable access into hello environment for management purposes.</span></span>

## <a name="cloud-service-vendors"></a><span data-ttu-id="21f96-145">Fournisseurs de services cloud</span><span class="sxs-lookup"><span data-stu-id="21f96-145">Cloud service vendors</span></span>
<span data-ttu-id="21f96-146">Après avoir parlé des volumes partagés de cluster réduire, nous avons identifié plusieurs approches toodeploy des services pour vos clients et les exigences associées.</span><span class="sxs-lookup"><span data-stu-id="21f96-146">After talking toomany CSVs, we identified multiple approaches you can take toodeploy services for your customers and associated requirements.</span></span>

### <a name="csv-hosted-offering"></a><span data-ttu-id="21f96-147">Offre hébergée par un fournisseur de services cloud</span><span class="sxs-lookup"><span data-stu-id="21f96-147">CSV-hosted offering</span></span>
<span data-ttu-id="21f96-148">Si vous hébergez votre offre dans votre abonnement Azure, deux approches d’hébergement sont courantes : un déploiement distinct pour chaque client ou le déploiement d’unités d’échelle qui étayent l’infrastructure partagée utilisée pour tous les clients.</span><span class="sxs-lookup"><span data-stu-id="21f96-148">If you host your offering in your own Azure subscription, two hosting approaches are common: deploying a distinct deployment for every customer or deploying scale units that underpin a shared infrastructure used for all customers.</span></span>

* <span data-ttu-id="21f96-149">**Déploiements distincts pour chaque client.**</span><span class="sxs-lookup"><span data-stu-id="21f96-149">**Distinct deployments for each customer.**</span></span> <span data-ttu-id="21f96-150">Les déploiements distincts par client nécessitent des topologies fixes de différentes configurations connues.</span><span class="sxs-lookup"><span data-stu-id="21f96-150">Distinct deployments per customer require fixed topologies of different known configurations.</span></span> <span data-ttu-id="21f96-151">Ces déploiements peuvent avoir différentes tailles de machine virtuelle, différents nombres de nœuds et différentes quantités de stockage associé.</span><span class="sxs-lookup"><span data-stu-id="21f96-151">These deployments may have different virtual machine (VM) sizes, varying numbers of nodes, and different amounts of associated storage.</span></span> <span data-ttu-id="21f96-152">Le marquage des déploiements est utilisé pour la facturation des cumuls de chaque client.</span><span class="sxs-lookup"><span data-stu-id="21f96-152">Tagging of deployments is used for roll-up billing of each customer.</span></span> <span data-ttu-id="21f96-153">RBAC peut être activé tooallow clients accès tooaspects de leur environnement cloud.</span><span class="sxs-lookup"><span data-stu-id="21f96-153">RBAC may be enabled tooallow customers access tooaspects of their cloud environment.</span></span>
* <span data-ttu-id="21f96-154">**Unités d’échelle dans des environnements partagés mutualisés.**</span><span class="sxs-lookup"><span data-stu-id="21f96-154">**Scale units in shared multi-tenant environments.**</span></span> <span data-ttu-id="21f96-155">Un modèle peut représenter une unité d’échelle pour des environnements mutualisés.</span><span class="sxs-lookup"><span data-stu-id="21f96-155">A template can represent a scale unit for multi-tenant environments.</span></span> <span data-ttu-id="21f96-156">Dans ce cas, hello même infrastructure est toosupport utilisé tous les clients.</span><span class="sxs-lookup"><span data-stu-id="21f96-156">In this case, hello same infrastructure is used toosupport all customers.</span></span> <span data-ttu-id="21f96-157">les déploiements Hello représentent un groupe de ressources qui fournissent un niveau de la capacité hello hébergé offre, telles que le nombre d’utilisateurs et nombre de transactions.</span><span class="sxs-lookup"><span data-stu-id="21f96-157">hello deployments represent a group of resources that deliver a level of capacity for hello hosted offering, such as number of users and number of transactions.</span></span> <span data-ttu-id="21f96-158">Ces unités d’échelle sont augmentées ou réduites en fonction des besoins de la demande.</span><span class="sxs-lookup"><span data-stu-id="21f96-158">These scale units are increased or decreased as demand requires.</span></span>

### <a name="csv-offering-injected-into-customer-subscription"></a><span data-ttu-id="21f96-159">Offre des fournisseurs de services cloud injectée dans l’abonnement client</span><span class="sxs-lookup"><span data-stu-id="21f96-159">CSV offering injected into customer subscription</span></span>
<span data-ttu-id="21f96-160">Vous souhaiterez toodeploy votre logiciel dans les abonnements détenus par les clients.</span><span class="sxs-lookup"><span data-stu-id="21f96-160">You may want toodeploy your software into subscriptions owned by end customers.</span></span> <span data-ttu-id="21f96-161">Vous pouvez utiliser des modèles toodeploy distinctes des déploiements dans Azure compte client.</span><span class="sxs-lookup"><span data-stu-id="21f96-161">You can use templates toodeploy distinct deployments into a customer’s Azure account.</span></span>

<span data-ttu-id="21f96-162">Ces déploiements utilisent RBAC afin de pouvoir mettre à jour et gérer le déploiement hello dans hello du compte client.</span><span class="sxs-lookup"><span data-stu-id="21f96-162">These deployments use RBAC so you can update and manage hello deployment within hello customer’s account.</span></span>

### <a name="azure-marketplace"></a><span data-ttu-id="21f96-163">Azure Marketplace</span><span class="sxs-lookup"><span data-stu-id="21f96-163">Azure Marketplace</span></span>
<span data-ttu-id="21f96-164">tooadvertise et vendre vos offres via un marketplace, tels que Azure Marketplace, vous pouvez développer des modèles toodeliver types de déploiements qui s’exécutent dans le compte Azure d’un client.</span><span class="sxs-lookup"><span data-stu-id="21f96-164">tooadvertise and sell your offerings through a marketplace, such as Azure Marketplace, you can develop templates toodeliver distinct types of deployments that run in a customer’s Azure account.</span></span> <span data-ttu-id="21f96-165">Ces déploiements distincts sont décrits en général d’après leur taille (petite, moyenne, grande), le type de produit/public (communauté, développeur, entreprise) ou le type de fonctionnalité (de base, haute disponibilité).</span><span class="sxs-lookup"><span data-stu-id="21f96-165">These distinct deployments can be typically described as a t-shirt size (small, medium, large), product/audience type (community, developer, enterprise), or feature type (basic, high availability).</span></span>  <span data-ttu-id="21f96-166">Dans certains cas, ces types permettent toospecify certains attributs du déploiement hello, telles que le type de machine virtuelle ou le nombre de disques.</span><span class="sxs-lookup"><span data-stu-id="21f96-166">In some cases, these types allow you toospecify certain attributes of hello deployment, such as VM type or number of disks.</span></span>

## <a name="oss-projects"></a><span data-ttu-id="21f96-167">Projets OSS</span><span class="sxs-lookup"><span data-stu-id="21f96-167">OSS projects</span></span>
<span data-ttu-id="21f96-168">Au sein des projets open source, les modèles de gestionnaire de ressources permettent à un toodeploy Communauté une solution rapidement grâce à des pratiques éprouvées.</span><span class="sxs-lookup"><span data-stu-id="21f96-168">Within open source projects, Resource Manager templates enable a community toodeploy a solution quickly using proven practices.</span></span> <span data-ttu-id="21f96-169">Vous pouvez stocker des modèles dans un référentiel GitHub afin de la Communauté de hello peut les modifier au fil du temps.</span><span class="sxs-lookup"><span data-stu-id="21f96-169">You can store templates in a GitHub repository so hello community can revise them over time.</span></span> <span data-ttu-id="21f96-170">Les utilisateurs déploient ces modèles dans leur propre abonnement Azure.</span><span class="sxs-lookup"><span data-stu-id="21f96-170">Users deploy these templates in their own Azure subscriptions.</span></span>

<span data-ttu-id="21f96-171">Hello sections suivantes identifient hello choses tooconsider avant de concevoir votre solution.</span><span class="sxs-lookup"><span data-stu-id="21f96-171">hello following sections identify hello things you need tooconsider before designing your solution.</span></span>

## <a name="identifying-what-is-outside-and-inside-a-vm"></a><span data-ttu-id="21f96-172">Identification des éléments externes et internes d’une machine virtuelle</span><span class="sxs-lookup"><span data-stu-id="21f96-172">Identifying what is outside and inside a VM</span></span>
<span data-ttu-id="21f96-173">Lorsque vous concevez votre modèle, il est utile toolook exigences hello en termes de ce qui est externe et interne hello virtual machines virtuelles :</span><span class="sxs-lookup"><span data-stu-id="21f96-173">As you design your template, it’s helpful toolook at hello requirements in terms of what's outside and inside hello virtual machines (VMs):</span></span>

* <span data-ttu-id="21f96-174">Extérieur signifie hello des machines virtuelles et autres ressources de votre déploiement, telles que la topologie réseau hello, le balisage, les références toohello certificats/clés secrètes et le contrôle d’accès en fonction du rôle.</span><span class="sxs-lookup"><span data-stu-id="21f96-174">Outside means hello VMs and other resources of your deployment, such as hello network topology, tagging, references toohello certs/secrets, and role-based access control.</span></span> <span data-ttu-id="21f96-175">Toutes ces ressources font partie de votre modèle.</span><span class="sxs-lookup"><span data-stu-id="21f96-175">All these resources are part of your template.</span></span>
* <span data-ttu-id="21f96-176">Configuration d’état à l’intérieur signifie hello logiciels installés et globalement souhaité.</span><span class="sxs-lookup"><span data-stu-id="21f96-176">Inside means hello installed software and overall desired state configuration.</span></span> <span data-ttu-id="21f96-177">Les autres mécanismes, tels que les extensions de machine virtuelle ou les scripts sont utilisés en tout ou partie.</span><span class="sxs-lookup"><span data-stu-id="21f96-177">Other mechanisms, such as VM extensions or scripts, are used in whole or in part.</span></span> <span data-ttu-id="21f96-178">Ces mécanismes peuvent être identifiés et exécutés par le modèle de hello mais ne sont pas qu’il contient.</span><span class="sxs-lookup"><span data-stu-id="21f96-178">These mechanisms may be identified and executed by hello template but aren’t in it.</span></span>

<span data-ttu-id="21f96-179">Des exemples courants d’activités que vous le feriez « à l’intérieur de la zone de hello » sont les suivants :</span><span class="sxs-lookup"><span data-stu-id="21f96-179">Common examples of activities you would do “inside hello box” include -</span></span>  

* <span data-ttu-id="21f96-180">Installer ou supprimer des fonctionnalités et des rôles de serveur</span><span class="sxs-lookup"><span data-stu-id="21f96-180">Install or remove server roles and features</span></span>
* <span data-ttu-id="21f96-181">Installer et configurer le logiciel au niveau de cluster ou nœud hello</span><span class="sxs-lookup"><span data-stu-id="21f96-181">Install and configure software at hello node or cluster level</span></span>
* <span data-ttu-id="21f96-182">Déployer des sites web sur un serveur web</span><span class="sxs-lookup"><span data-stu-id="21f96-182">Deploy websites on a web server</span></span>
* <span data-ttu-id="21f96-183">Déployer des schémas de base de données</span><span class="sxs-lookup"><span data-stu-id="21f96-183">Deploy database schemas</span></span>
* <span data-ttu-id="21f96-184">Gérer le Registre ou d’autres types de paramètre de configuration</span><span class="sxs-lookup"><span data-stu-id="21f96-184">Manage registry or other types of configuration settings</span></span>
* <span data-ttu-id="21f96-185">Gérer les fichiers et répertoires</span><span class="sxs-lookup"><span data-stu-id="21f96-185">Manage files and directories</span></span>
* <span data-ttu-id="21f96-186">Démarrer, arrêter et gérer les processus et services</span><span class="sxs-lookup"><span data-stu-id="21f96-186">Start, stop, and manage processes and services</span></span>
* <span data-ttu-id="21f96-187">Gérer les groupes locaux et comptes d’utilisateur</span><span class="sxs-lookup"><span data-stu-id="21f96-187">Manage local groups and user accounts</span></span>
* <span data-ttu-id="21f96-188">Installer et gérer les packages (.msi, .exe, yum, etc.)</span><span class="sxs-lookup"><span data-stu-id="21f96-188">Install and manage packages (.msi, .exe, yum, etc.)</span></span>
* <span data-ttu-id="21f96-189">Gérer les variables d’environnement</span><span class="sxs-lookup"><span data-stu-id="21f96-189">Manage environment variables</span></span>
* <span data-ttu-id="21f96-190">Exécuter les scripts natifs (Windows PowerShell, bash, etc.)</span><span class="sxs-lookup"><span data-stu-id="21f96-190">Run native scripts (Windows PowerShell, bash, etc.)</span></span>

### <a name="desired-state-configuration-dsc"></a><span data-ttu-id="21f96-191">Configuration d’état souhaité (DSC)</span><span class="sxs-lookup"><span data-stu-id="21f96-191">Desired state configuration (DSC)</span></span>
<span data-ttu-id="21f96-192">Vous réfléchissez à l’état interne de hello de vos machines virtuelles au-delà de déploiement, vous souhaitez toomake que ce déploiement ne » dérive » à partir de la configuration hello que vous avez définie et activée dans le contrôle de code source.</span><span class="sxs-lookup"><span data-stu-id="21f96-192">Thinking about hello internal state of your VMs beyond deployment, you want toomake sure this deployment doesn’t "drift" from hello configuration that you have defined and checked into source control.</span></span> <span data-ttu-id="21f96-193">Cette approche garantit vos développeurs ou personnel chargé des opérations ne faites pas environnement tooan de modifications ad hoc qui ne sont pas approuvés, testé ou enregistrées dans le contrôle de code source.</span><span class="sxs-lookup"><span data-stu-id="21f96-193">This approach ensures your developers or operations staff don’t make ad-hoc changes tooan environment that are not vetted, tested, or recorded in source control.</span></span> <span data-ttu-id="21f96-194">Ce contrôle est important, car les modifications manuelles hello ne se trouvent pas dans le contrôle de code source.</span><span class="sxs-lookup"><span data-stu-id="21f96-194">This control is important, because hello manual changes are not in source control.</span></span> <span data-ttu-id="21f96-195">Ils sont également pas partie du déploiement standard de hello et aura un impact sur les futurs déploiements automatisés de logiciels de hello.</span><span class="sxs-lookup"><span data-stu-id="21f96-195">They are also not part of hello standard deployment and will impact future automated deployments of hello software.</span></span>

<span data-ttu-id="21f96-196">Outre pour vos employés internes, la configuration d’état souhaité est également importante en matière de sécurité.</span><span class="sxs-lookup"><span data-stu-id="21f96-196">Beyond your internal employees, desired state configuration is also important from a security perspective.</span></span> <span data-ttu-id="21f96-197">Les pirates informatiques essaient régulièrement toocompromise et exploitent les systèmes logiciels.</span><span class="sxs-lookup"><span data-stu-id="21f96-197">Hackers are regularly trying toocompromise and exploit software systems.</span></span> <span data-ttu-id="21f96-198">Cas de réussite, il est fichiers tooinstall communs et état hello d’un système compromis.</span><span class="sxs-lookup"><span data-stu-id="21f96-198">When successful, it's common tooinstall files and otherwise change hello state of a compromised system.</span></span> <span data-ttu-id="21f96-199">À l’aide de la configuration de l’état souhaité, vous pouvez identifier les deltas entre hello souhaitée et l’état réel et restaurer une configuration connue.</span><span class="sxs-lookup"><span data-stu-id="21f96-199">Using desired state configuration, you can identify deltas between hello desired and actual state and restore a known configuration.</span></span>

<span data-ttu-id="21f96-200">Il existe des extensions de ressource hello plus populaires mécanismes pour DSC - PowerShell DSC, Chef et Puppet.</span><span class="sxs-lookup"><span data-stu-id="21f96-200">There are resource extensions for hello most popular mechanisms for DSC - PowerShell DSC, Chef, and Puppet.</span></span> <span data-ttu-id="21f96-201">Chacune de ces extensions de déploiement état initial de hello de votre machine virtuelle et également être utilisé toomake vraiment hello souhaité de l’état est maintenu.</span><span class="sxs-lookup"><span data-stu-id="21f96-201">Each of these extensions can deploy hello initial state of your VM and also be used toomake sure hello desired state is maintained.</span></span>

## <a name="common-template-scopes"></a><span data-ttu-id="21f96-202">Étendues courantes de modèle</span><span class="sxs-lookup"><span data-stu-id="21f96-202">Common template scopes</span></span>
<span data-ttu-id="21f96-203">Nous avons vu que trois étendues clés de modèle de solution émergent.</span><span class="sxs-lookup"><span data-stu-id="21f96-203">In our experience, we’ve seen three key solution templates scopes emerge.</span></span> <span data-ttu-id="21f96-204">Ces trois étendues de capacité, fonctionnalité et solution de bout en bout – sont décrits dans les sections suivantes de hello.</span><span class="sxs-lookup"><span data-stu-id="21f96-204">These three scopes – capacity, capability, and end-to-end solution – are described in hello following sections.</span></span>

### <a name="capacity-scope"></a><span data-ttu-id="21f96-205">Étendue de capacité</span><span class="sxs-lookup"><span data-stu-id="21f96-205">Capacity scope</span></span>
<span data-ttu-id="21f96-206">Une étendue de la capacité fournit un ensemble de ressources dans une topologie standard qui est préconfigurée toobe conformément aux réglementations et stratégies.</span><span class="sxs-lookup"><span data-stu-id="21f96-206">A capacity scope delivers a set of resources in a standard topology that is pre-configured toobe in compliance with regulations and policies.</span></span> <span data-ttu-id="21f96-207">exemple Hello le plus courant consiste à déployer un environnement de développement standard dans un scénario informatique d’entreprise ou SI.</span><span class="sxs-lookup"><span data-stu-id="21f96-207">hello most common example is deploying a standard development environment in an Enterprise IT or SI scenario.</span></span>

### <a name="capability-scope"></a><span data-ttu-id="21f96-208">Étendue de fonctionnalité</span><span class="sxs-lookup"><span data-stu-id="21f96-208">Capability scope</span></span>
<span data-ttu-id="21f96-209">Une étendue de fonctionnalité est axée sur le déploiement et la configuration d’une topologie pour une technologie donnée.</span><span class="sxs-lookup"><span data-stu-id="21f96-209">A capability scope is focused on deploying and configuring a topology for a given technology.</span></span> <span data-ttu-id="21f96-210">Les scénarios courants incluent les technologies SQL Server, Cassandra et Hadoop.</span><span class="sxs-lookup"><span data-stu-id="21f96-210">Common scenarios including technologies such as SQL Server, Cassandra, Hadoop.</span></span>

### <a name="end-to-end-solution-scope"></a><span data-ttu-id="21f96-211">Étendue de solution de bout en bout</span><span class="sxs-lookup"><span data-stu-id="21f96-211">End-to-end solution scope</span></span>
<span data-ttu-id="21f96-212">Une portée de bout en bout pour la Solution est ciblée au-delà d’une fonctionnalité unique et à la place le focus sur une solution globale tooend fin constitué de plusieurs fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="21f96-212">An End-to-End Solution Scope is targeted beyond a single capability, and instead focused on delivering an end tooend solution comprised of multiple capabilities.</span></span>  

<span data-ttu-id="21f96-213">Un modèle avec étendue de solution se manifeste comme un ensemble d’un ou plusieurs modèles à étendue de fonctionnalité avec des ressources, une logique et un état souhaité propres à la solution.</span><span class="sxs-lookup"><span data-stu-id="21f96-213">A solution-scoped template scope manifests itself as a set of one or more capability-scoped templates with solution-specific resources, logic, and desired state.</span></span> <span data-ttu-id="21f96-214">Un exemple d’un modèle de solution de portée est un modèle de solution fin tooend données pipeline.</span><span class="sxs-lookup"><span data-stu-id="21f96-214">An example of a solution-scoped template is an end tooend data pipeline solution template.</span></span> <span data-ttu-id="21f96-215">modèle de Hello peut combiner topologie spécifique de la solution et l’état avec plusieurs modèles de solution de capacité étendue comme Kafka, Storm et Hadoop.</span><span class="sxs-lookup"><span data-stu-id="21f96-215">hello template might mix solution-specific topology and state with multiple capability-scoped solution templates such as Kafka, Storm, and Hadoop.</span></span>

## <a name="choosing-free-form-vs-known-configurations"></a><span data-ttu-id="21f96-216">Choix de configurations ouvertes et connues</span><span class="sxs-lookup"><span data-stu-id="21f96-216">Choosing free-form vs. known configurations</span></span>
<span data-ttu-id="21f96-217">Vous pouvez penser initialement un modèle doit fournir aux consommateurs une grande flexibilité de hello, mais plusieurs considérations affectent le choix entre hello toouse des configurations de forme libre et configurations connues.</span><span class="sxs-lookup"><span data-stu-id="21f96-217">You might initially think a template should give consumers hello utmost flexibility, but many considerations affect hello choice of whether toouse free-form configurations vs. known configurations.</span></span> <span data-ttu-id="21f96-218">Cette section identifie les spécifications du client clé hello et les considérations techniques en forme approche hello partagé dans ce document.</span><span class="sxs-lookup"><span data-stu-id="21f96-218">This section identifies hello key customer requirements and technical considerations that shaped hello approach shared in this document.</span></span>

### <a name="free-form-configurations"></a><span data-ttu-id="21f96-219">Configurations ouvertes</span><span class="sxs-lookup"><span data-stu-id="21f96-219">Free-form configurations</span></span>
<span data-ttu-id="21f96-220">Sur la surface de hello, les configurations de forme libre son idéale.</span><span class="sxs-lookup"><span data-stu-id="21f96-220">On hello surface, free-form configurations sound ideal.</span></span> <span data-ttu-id="21f96-221">Ils vous tooselect un type de machine virtuelle et fournir un nombre arbitraire de nœuds et les disques pour les nœuds associés, et faire en tant que modèle tooa de paramètres.</span><span class="sxs-lookup"><span data-stu-id="21f96-221">They allow you tooselect a VM type and provide an arbitrary number of nodes and attached disks for those nodes — and do so as parameters tooa template.</span></span> <span data-ttu-id="21f96-222">Toutefois, cette approche n’est pas idéale pour certains scénarios.</span><span class="sxs-lookup"><span data-stu-id="21f96-222">However, this approach is not ideal for some scenarios.</span></span>

<span data-ttu-id="21f96-223">Dans [tailles des machines virtuelles](../virtual-machines/windows/sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json), types de machine virtuelle hello et tailles disponibles sont identifiés et chaque nombre hello de durabilité disques (2, 4, 8, 16, 32) qui peut être attaché.</span><span class="sxs-lookup"><span data-stu-id="21f96-223">In [Sizes for virtual machines](../virtual-machines/windows/sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json), hello different VM types and available sizes are identified, and each of hello number of durable disks (2, 4, 8, 16, or 32) that can be attached.</span></span> <span data-ttu-id="21f96-224">Chaque disque attaché fournit 500 E/S par seconde, et plusieurs disques peuvent être regroupés pour obtenir un multiplicateur de ce nombre d’E/S par seconde.</span><span class="sxs-lookup"><span data-stu-id="21f96-224">Each attached disk provides 500 IOPS and multiples of these disks can be pooled for a multiplier of that number of IOPS.</span></span> <span data-ttu-id="21f96-225">Par exemple, 16 disques peut être mis en pool tooprovide IOPS 8 000.</span><span class="sxs-lookup"><span data-stu-id="21f96-225">For example, 16 disks can be pooled tooprovide 8,000 IOPS.</span></span> <span data-ttu-id="21f96-226">Le regroupement s’effectue avec la configuration dans le système d’exploitation de hello, à l’aide des espaces de stockage de Microsoft Windows ou une baie redondante de disques (RAID) dans Linux.</span><span class="sxs-lookup"><span data-stu-id="21f96-226">Pooling is done with configuration in hello operating system, using Microsoft Windows Storage Spaces or redundant array of inexpensive disks (RAID) in Linux.</span></span>

<span data-ttu-id="21f96-227">Une configuration de forme libre permet la sélection de hello plusieurs instances de machine virtuelle, VM différents types et tailles pour ces instances, des disques différents pour hello type d’ordinateurs virtuels, et un ou plusieurs scripts de contenu de machine virtuelle tooconfigure hello.</span><span class="sxs-lookup"><span data-stu-id="21f96-227">A free-form configuration enables hello selection several VM instances, various VM types and sizes for those instances, various disks for hello VM type, and one or more scripts tooconfigure hello VM contents.</span></span>

<span data-ttu-id="21f96-228">Il est courant qu’un déploiement comprenne plusieurs types de nœud, tels que les nœuds principaux et de données. Cette flexibilité est donc souvent proposée pour tous les types de nœud.</span><span class="sxs-lookup"><span data-stu-id="21f96-228">It is common that a deployment may have multiple types of nodes, such as master and data nodes, so this flexibility is often provided for every node type.</span></span>

<span data-ttu-id="21f96-229">Lorsque vous commencez clusters toodeploy d’une importance, commencer toowork avec ces scénarios complexes.</span><span class="sxs-lookup"><span data-stu-id="21f96-229">As you start toodeploy clusters of any significance, you begin toowork with these complex scenarios.</span></span> <span data-ttu-id="21f96-230">Si vous déployez un cluster Hadoop, par exemple, avec 8 nœuds principaux et des nœuds de données de 200 et bureaux 4 disques sur chaque nœud principal et les bureaux 16 disques attachés par nœud de données, vous devez 208 machines virtuelles et 3,232 disques toomanage.</span><span class="sxs-lookup"><span data-stu-id="21f96-230">If you were deploying a Hadoop cluster, for example, with 8 master nodes and 200 data nodes, and pooled 4 attached disks on each master node and pooled 16 attached disks per data node, you would have 208 VMs and 3,232 disks toomanage.</span></span>

<span data-ttu-id="21f96-231">Un compte de stockage accélèrera demandes ci-dessus que son identifié de 20 000 transactions par seconde limiter, donc vous devez examiner le partitionnement de compte de stockage et utiliser des calculs nombre approprié de hello toodetermine de stockage des comptes tooaccommodate cette topologie.</span><span class="sxs-lookup"><span data-stu-id="21f96-231">A storage account will throttle requests above its identified 20,000 transactions/second limit, so you should look at storage account partitioning and use calculations toodetermine hello appropriate number of storage accounts tooaccommodate this topology.</span></span> <span data-ttu-id="21f96-232">Étant donné la multitude de hello de combinaisons prises en charge par l’approche de forme libre hello, des calculs dynamiques sont requis toodetermine hello partitionnement appropriée.</span><span class="sxs-lookup"><span data-stu-id="21f96-232">Given hello multitude of combinations supported by hello free-form approach, dynamic calculations are required toodetermine hello appropriate partitioning.</span></span> <span data-ttu-id="21f96-233">Hello langue de modèle de gestionnaire de ressources Azure ne fournit pas actuellement les fonctions mathématiques, vous devez effectuer ces calculs dans le code, la génération d’un modèle unique, codé en dur avec les détails appropriés hello.</span><span class="sxs-lookup"><span data-stu-id="21f96-233">hello Azure Resource Manager Template Language does not presently provide mathematical functions, so you must perform these calculations in code, generating a unique, hard-coded template with hello appropriate details.</span></span>

<span data-ttu-id="21f96-234">Dans l’informatique d’entreprise et les scénarios SI, une personne doit maintenir des modèles de hello et prend en charge les topologies de hello déployé pour une ou plusieurs organisations.</span><span class="sxs-lookup"><span data-stu-id="21f96-234">In enterprise IT and SI scenarios, someone must maintain hello templates and support hello deployed topologies for one or more organizations.</span></span> <span data-ttu-id="21f96-235">Cette surcharge supplémentaire, à savoir différentes configurations et différents modèles pour chaque client, est loin d’être souhaitable.</span><span class="sxs-lookup"><span data-stu-id="21f96-235">This additional overhead — different configurations and templates for each customer — is far from desirable.</span></span>

<span data-ttu-id="21f96-236">Vous pouvez utiliser ces environnements toodeploy de modèles dans un abonnement Azure de votre client, mais les équipes informatiques d’entreprise et volumes partagés de cluster en général les déployer dans leurs propres abonnements, à l’aide d’un toobill de fonction rétrofacturation leurs clients.</span><span class="sxs-lookup"><span data-stu-id="21f96-236">You can use these templates toodeploy environments in your customer’s Azure subscription, but both corporate IT teams and CSVs typically deploy them into their own subscriptions, using a chargeback function toobill their customers.</span></span> <span data-ttu-id="21f96-237">Dans ces scénarios, hello vise capacité toodeploy pour plusieurs clients sur un pool d’abonnements et de conserver les déploiements denses dans hello abonnements toominimize abonnement prolifération : autrement dit, plus toomanage d’abonnements.</span><span class="sxs-lookup"><span data-stu-id="21f96-237">In these scenarios, hello goal is toodeploy capacity for multiple customers across a pool of subscriptions and keep deployments densely populated into hello subscriptions toominimize subscription sprawl—that is, more subscriptions toomanage.</span></span> <span data-ttu-id="21f96-238">Avec des tailles de déploiement véritablement dynamique, pour parvenir à ce type de densité requiert une planification et développement supplémentaires pour le travail de génération de modèles automatique pour le compte d’organisation de hello.</span><span class="sxs-lookup"><span data-stu-id="21f96-238">With truly dynamic deployment sizes, achieving this type of density requires careful planning and additional development for scaffolding work on behalf of hello organization.</span></span>

<span data-ttu-id="21f96-239">En outre, vous ne peut pas créer des abonnements via un appel d’API mais vous devez le faire manuellement via le portail de hello.</span><span class="sxs-lookup"><span data-stu-id="21f96-239">In addition, you can’t create subscriptions via an API call but must do so manually through hello portal.</span></span> <span data-ttu-id="21f96-240">L’augmentation de nombre de hello d’abonnements, toute la prolifération des abonnement résultant nécessite une intervention humaine, elle ne peut pas être automatisée.</span><span class="sxs-lookup"><span data-stu-id="21f96-240">As hello number of subscriptions increases, any resulting subscription sprawl requires human intervention—it can’t be automated.</span></span> <span data-ttu-id="21f96-241">Avec la variabilité bien dans des tailles de hello de déploiements, vous devez toopre-configurer un nombre d’abonnements manuellement tooensure les abonnements sont disponibles.</span><span class="sxs-lookup"><span data-stu-id="21f96-241">With so much variability in hello sizes of deployments, you would have toopre-provision a number of subscriptions manually tooensure subscriptions are available.</span></span>

<span data-ttu-id="21f96-242">Compte tenu de tous ces facteurs, une configuration réellement ouverte est moins intéressante que de prime abord.</span><span class="sxs-lookup"><span data-stu-id="21f96-242">Considering all these factors, a truly free-form configuration is less appealing than at first blush.</span></span>

### <a name="known-configurations--hello-t-shirt-sizing-approach"></a><span data-ttu-id="21f96-243">Connu configurations : hello approche de taille de t-shirt</span><span class="sxs-lookup"><span data-stu-id="21f96-243">Known configurations — hello t-shirt sizing approach</span></span>
<span data-ttu-id="21f96-244">Plutôt qu’offrent un modèle qui fournit une flexibilité totale et les variations d’innombrables, dans notre expérience est courant tooprovide hello capacité tooselect connu des configurations : en effet, des tailles de t-shirt standard tels que de bac à sable, petite, moyenne et grande.</span><span class="sxs-lookup"><span data-stu-id="21f96-244">Rather than offer a template that provides total flexibility and countless variations, in our experience a common pattern is tooprovide hello ability tooselect known configurations — in effect, standard t-shirt sizes such as sandbox, small, medium, and large.</span></span> <span data-ttu-id="21f96-245">Les autres exemples de taille standard sont des offres de produits, telles que l’édition Community ou Enterprise.</span><span class="sxs-lookup"><span data-stu-id="21f96-245">Other examples of t-shirt sizes are product offerings, such as community edition or enterprise edition.</span></span>  <span data-ttu-id="21f96-246">Dans d’autres cas, il peut s’agir de configurations d’une technologie propres à une charge de travail, par exemple MapReduce ou sans SQL.</span><span class="sxs-lookup"><span data-stu-id="21f96-246">In other cases, it may be workload-specific configurations of a technology – such as map reduce or no sql.</span></span>

<span data-ttu-id="21f96-247">Nombre d’entreprises informatiques, de fournisseurs OSS et d’intégrateurs de systèmes proposent leurs offres aujourd’hui de cette façon dans des environnements locaux, virtualisés (entreprises) ou en tant qu’offres SaaS (fournisseurs de services cloud et de systèmes d’exploitation).</span><span class="sxs-lookup"><span data-stu-id="21f96-247">Many enterprise IT organizations, OSS vendors, and SIs make their offerings available today in this way in on-premises, virtualized environments (enterprises) or as software-as-a-service (SaaS) offerings (CSVs and OSVs).</span></span>

<span data-ttu-id="21f96-248">Cette approche fournit des configurations correctes, connues de différentes tailles qui sont préconfigurées pour les clients.</span><span class="sxs-lookup"><span data-stu-id="21f96-248">This approach provides good, known configurations of varying sizes that are preconfigured for customers.</span></span> <span data-ttu-id="21f96-249">Sans des configurations connues, clients finaux doivent déterminer la taille de cluster sur leurs propres, tenir compte des contraintes de ressources de plateforme et faire mathématiques tooidentify hello résultant partitionnement des comptes de stockage et d’autres ressources (échéance toocluster taille et de ressources contraintes).</span><span class="sxs-lookup"><span data-stu-id="21f96-249">Without known configurations, end customers must determine cluster sizing on their own, factor in platform resource constraints, and do math tooidentify hello resulting partitioning of storage accounts and other resources (due toocluster size and resource constraints).</span></span> <span data-ttu-id="21f96-250">Connu configurations activer une taille de t-shirt droite clients tooeasily sélectionnez hello, autrement dit, un déploiement donné.</span><span class="sxs-lookup"><span data-stu-id="21f96-250">Known configurations enable customers tooeasily select hello right t-shirt size—that is, a given deployment.</span></span> <span data-ttu-id="21f96-251">En outre toomaking une meilleure expérience client de hello, un petit nombre de configurations connues est toosupport plus facile et peut vous aider à assurer un haut niveau de densité.</span><span class="sxs-lookup"><span data-stu-id="21f96-251">In addition toomaking a better experience for hello customer, a small number of known configurations is easier toosupport and can help you deliver a higher level of density.</span></span>

<span data-ttu-id="21f96-252">Une approche de configuration connue axée sur des tailles standard peut également proposer un nombre de nœuds variable par taille.</span><span class="sxs-lookup"><span data-stu-id="21f96-252">A known configuration approach focused on t-shirt sizes may also have varying number of nodes within a size.</span></span> <span data-ttu-id="21f96-253">Par exemple, une petite taille peut comprendre 3 à 10 nœuds.</span><span class="sxs-lookup"><span data-stu-id="21f96-253">For example, a small t-shirt size may be between 3 and 10 nodes.</span></span>  <span data-ttu-id="21f96-254">taille de t-shirt Hello serait conçue tooaccommodate des nœuds de too10 et fournir des sélections de forme libre consommateur hello capacité toomake taille maximale de toohello identifié hello.</span><span class="sxs-lookup"><span data-stu-id="21f96-254">hello t-shirt size would be designed tooaccommodate up too10 nodes and provide hello consumer hello ability toomake free form selections up toohello maximum size identified.</span></span>  

<span data-ttu-id="21f96-255">Une taille de t-shirt selon le type de charge de travail, peut être plus de forme libre dans la nature en termes de nombre hello de nœuds qui peuvent être déployées mais a taille de nœud distinct de la charge de travail et la configuration des logiciels de hello sur le nœud de hello.</span><span class="sxs-lookup"><span data-stu-id="21f96-255">A t-shirt size based on workload type, may be more free form in nature in terms of hello number of nodes that can be deployed but will have workload distinct node size and configuration of hello software on hello node.</span></span>

<span data-ttu-id="21f96-256">Taille de T-shirt basé sur les offres de produits, telles que la Communauté ou entreprise, peuvent avoir des types de ressources distinct et le nombre maximal de nœuds qui peuvent être déployées, liée généralement toolicensing considérations ou la disponibilité des fonctionnalités entre les offres hello.</span><span class="sxs-lookup"><span data-stu-id="21f96-256">T-shirt sizes based on product offerings, such as community or Enterprise, may have distinct resource types and maximum number of nodes that can be deployed, typically tied toolicensing considerations or feature availability across hello different offerings.</span></span>

<span data-ttu-id="21f96-257">Vous pouvez également utiliser des clients avec les variantes uniques à l’aide des modèles JSON hello.</span><span class="sxs-lookup"><span data-stu-id="21f96-257">You can also accommodate customers with unique variants using hello JSON-based templates.</span></span> <span data-ttu-id="21f96-258">Lorsque vous traitez des valeurs hors norme, vous pouvez incorporer la planification appropriée hello et les considérations de développement, la prise en charge et d’évaluation des coûts.</span><span class="sxs-lookup"><span data-stu-id="21f96-258">When dealing with outliers, you can incorporate hello appropriate planning and considerations for development, support, and costing.</span></span>

<span data-ttu-id="21f96-259">En fonction des scénarios de consommation de modèle client hello et des besoins identifiés au début de hello de ce document, nous avons déterminé un modèle pour la décomposition du modèle.</span><span class="sxs-lookup"><span data-stu-id="21f96-259">Based on hello customer template consumption scenarios, and requirements identified at hello start of this document, we identified a pattern for template decomposition.</span></span>

## <a name="capacity-and-capability-scoped-solution-templates"></a><span data-ttu-id="21f96-260">Modèles de solution avec étendue de capacité et de fonctionnalité</span><span class="sxs-lookup"><span data-stu-id="21f96-260">Capacity and capability-scoped solution templates</span></span>
<span data-ttu-id="21f96-261">Décomposition fournit un développement tootemplate approche modulaire qui prend en charge la réutilisation, d’extensibilité, de test et les outils.</span><span class="sxs-lookup"><span data-stu-id="21f96-261">Decomposition provides a modular approach tootemplate development that supports reuse, extensibility, testing, and tooling.</span></span> <span data-ttu-id="21f96-262">Cette section fournit des détails sur comment une approche de décomposition peut être appliqués tootemplates avec une portée de capacité ou la fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="21f96-262">This section provides detail on how a decomposition approach can be applied tootemplates with a Capacity or Capability scope.</span></span>

<span data-ttu-id="21f96-263">Dans cette approche, un modèle principal reçoit des valeurs de paramètre à partir d’un consommateur de modèle, puis lie tooseveral des types de modèles et de scripts en aval, comme indiqué ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="21f96-263">In this approach, a main template receives parameter values from a template consumer, then links tooseveral types of templates and scripts downstream as shown below.</span></span> <span data-ttu-id="21f96-264">Paramètres, les variables statiques et les variables générées sont des valeurs de tooprovide utilisés et les modèles hello lié.</span><span class="sxs-lookup"><span data-stu-id="21f96-264">Parameters, static variables, and generated variables are used tooprovide values in and out of hello linked templates.</span></span>

![Paramètres de modèle](./media/best-practices-resource-manager-design-templates/template-parameters.png)

<span data-ttu-id="21f96-266">**Les paramètres sont transmis les modèles principal tooa puis toolinked modèles**</span><span class="sxs-lookup"><span data-stu-id="21f96-266">**Parameters are passed tooa main template then toolinked templates**</span></span>

<span data-ttu-id="21f96-267">Hello suivant de focus des sections de types hello de modèles et de scripts est décomposé selon un modèle unique.</span><span class="sxs-lookup"><span data-stu-id="21f96-267">hello following sections focus on hello types of templates and scripts that a single template is decomposed into.</span></span> <span data-ttu-id="21f96-268">les sections de Hello présentent des approches permettant de passer des informations d’état entre les modèles hello.</span><span class="sxs-lookup"><span data-stu-id="21f96-268">hello sections present approaches for passing state information among hello templates.</span></span> <span data-ttu-id="21f96-269">Chaque type de script de modèle et hello dans l’image de hello décrits ainsi que des exemples.</span><span class="sxs-lookup"><span data-stu-id="21f96-269">Each template and hello script types in hello image are described along with examples.</span></span> <span data-ttu-id="21f96-270">Pour obtenir un exemple contextuel, consultez la rubrique « Synthèse générale : Exemple d’implémentation » plus loin dans ce document.</span><span class="sxs-lookup"><span data-stu-id="21f96-270">For a contextual example, see "Putting it together: a sample implementation" later in this document.</span></span>

### <a name="template-metadata"></a><span data-ttu-id="21f96-271">Métadonnées de modèle</span><span class="sxs-lookup"><span data-stu-id="21f96-271">Template metadata</span></span>
<span data-ttu-id="21f96-272">Métadonnées du modèle (fichier de metadata.json hello) contient des paires clé/valeur qui décrivent un modèle au format JSON, qui peut être lu par l’homme et les systèmes logiciels.</span><span class="sxs-lookup"><span data-stu-id="21f96-272">Template metadata (hello metadata.json file) contains key/value pairs that describe a template in JSON, which can be read by humans and software systems.</span></span>

![Métadonnées de modèle](./media/best-practices-resource-manager-design-templates/template-metadata.png)

<span data-ttu-id="21f96-274">**Les métadonnées de modèle sont décrite dans le fichier de metadata.json hello**</span><span class="sxs-lookup"><span data-stu-id="21f96-274">**Template metadata is described in hello metadata.json file**</span></span>

<span data-ttu-id="21f96-275">Agents de logiciels peuvent récupérer le fichier de metadata.json hello et publier des informations hello et un modèle de toohello de lien dans une page web ou le répertoire.</span><span class="sxs-lookup"><span data-stu-id="21f96-275">Software agents can retrieve hello metadata.json file and publish hello information and a link toohello template in a web page or directory.</span></span> <span data-ttu-id="21f96-276">Les éléments incluent *itemDisplayName*, *description*, *summary*, *githubUsername* et *dateUpdated*.</span><span class="sxs-lookup"><span data-stu-id="21f96-276">Elements include *itemDisplayName*, *description*, *summary*, *githubUsername*, and *dateUpdated*.</span></span>

<span data-ttu-id="21f96-277">Un exemple de fichier est présenté ci-dessous dans son intégralité.</span><span class="sxs-lookup"><span data-stu-id="21f96-277">An example file is shown below in its entirety.</span></span>

    {
        "itemDisplayName": "PostgreSQL 9.3 on Ubuntu VMs",
        "description": "This template creates a PostgreSQL streaming-replication between a master and one or more slave servers each with 2 striped data disks. hello database servers are deployed into a private-only subnet with one publicly accessible jumpbox VM in a DMZ subnet with public IP.",
        "summary": "PostgreSQL stream-replication with multiple slave servers and a publicly accessible jumpbox VM",
        "githubUsername": "arsenvlad",
        "dateUpdated": "2015-04-24"
    }

### <a name="main-template"></a><span data-ttu-id="21f96-278">Modèle principal</span><span class="sxs-lookup"><span data-stu-id="21f96-278">Main template</span></span>
<span data-ttu-id="21f96-279">les modèles principal Hello reçoit des paramètres d’un utilisateur utilise des variables objet complexe toopopulate plus d’informations et exécute les modèles hello lié.</span><span class="sxs-lookup"><span data-stu-id="21f96-279">hello main template receives parameters from a user, uses that information toopopulate complex object variables, and executes hello linked templates.</span></span>

![Modèle principal](./media/best-practices-resource-manager-design-templates/main-template.png)

<span data-ttu-id="21f96-281">**les modèles principal Hello reçoit des paramètres d’un utilisateur**</span><span class="sxs-lookup"><span data-stu-id="21f96-281">**hello main template receives parameters from a user**</span></span>

<span data-ttu-id="21f96-282">Un paramètre qui est fourni est un type de configuration connue également connu sous les paramètres de taille de t-shirt hello en raison de ses valeurs standardisés tels que de petite, moyenne ou grande.</span><span class="sxs-lookup"><span data-stu-id="21f96-282">One parameter that is provided is a known configuration type also known as hello t-shirt size parameter because of its standardized values such as small, medium, or large.</span></span> <span data-ttu-id="21f96-283">Dans la pratique, vous pouvez utiliser ce paramètre de plusieurs façons.</span><span class="sxs-lookup"><span data-stu-id="21f96-283">In practice, you can use this parameter in multiple ways.</span></span> <span data-ttu-id="21f96-284">Pour plus d’informations, consultez la rubrique « Modèles de ressource de configuration connue », plus loin dans ce document.</span><span class="sxs-lookup"><span data-stu-id="21f96-284">For details, see "Known configuration resources template" later in this document.</span></span>

<span data-ttu-id="21f96-285">Certaines ressources sont déployées, quelle que soit la configuration connue de hello spécifiée par un paramètre utilisateur.</span><span class="sxs-lookup"><span data-stu-id="21f96-285">Some resources are deployed regardless of hello known configuration specified by a user parameter.</span></span> <span data-ttu-id="21f96-286">Ces ressources sont configurés à l’aide d’un modèle de ressource partagée unique et sont partagés par les autres modèles, modèle de ressource partagée hello est exécuté en premier.</span><span class="sxs-lookup"><span data-stu-id="21f96-286">These resources are provisioned using a single shared resource template and are shared by other templates, so hello shared resource template is run first.</span></span>

<span data-ttu-id="21f96-287">Certaines ressources sont déployées si vous le souhaitez, quelle que soit la configuration connue de hello spécifié.</span><span class="sxs-lookup"><span data-stu-id="21f96-287">Some resources are deployed optionally regardless of hello specified known configuration.</span></span>

### <a name="shared-resources-template"></a><span data-ttu-id="21f96-288">Modèle de ressource partagé</span><span class="sxs-lookup"><span data-stu-id="21f96-288">Shared resources template</span></span>
<span data-ttu-id="21f96-289">Ce modèle propose des ressources communes à toutes les configurations connues.</span><span class="sxs-lookup"><span data-stu-id="21f96-289">This template delivers resources that are common across all known configurations.</span></span> <span data-ttu-id="21f96-290">Il contient le réseau virtuel de hello, haute disponibilité et d’autres ressources qui sont requis, quelle que soit le modèle de configuration connues hello qui est déployé.</span><span class="sxs-lookup"><span data-stu-id="21f96-290">It contains hello virtual network, availability sets, and other resources that are required regardless of hello known configuration template that is deployed.</span></span>

![Ressources de modèle](./media/best-practices-resource-manager-design-templates/template-resources.png)

<span data-ttu-id="21f96-292">**Modèle de ressource partagé**</span><span class="sxs-lookup"><span data-stu-id="21f96-292">**Shared resources template**</span></span>

<span data-ttu-id="21f96-293">Les noms de ressources, telles que nom de réseau virtuel hello sont basées sur les modèles principal hello.</span><span class="sxs-lookup"><span data-stu-id="21f96-293">Resource names, such as hello virtual network name, are based on hello main template.</span></span> <span data-ttu-id="21f96-294">Vous pouvez les spécifier comme une variable dans le modèle ou les recevoir en tant que paramètre à partir de l’utilisateur de hello, comme requis par votre organisation.</span><span class="sxs-lookup"><span data-stu-id="21f96-294">You can specify them as a variable within that template or receive them as a parameter from hello user, as required by your organization.</span></span>

### <a name="optional-resources-template"></a><span data-ttu-id="21f96-295">Modèle de ressource facultatif</span><span class="sxs-lookup"><span data-stu-id="21f96-295">Optional resources template</span></span>
<span data-ttu-id="21f96-296">modèle de ressources facultative Hello contient des ressources qui sont déployés par programme en fonction de valeur hello d’une variable ou un paramètre.</span><span class="sxs-lookup"><span data-stu-id="21f96-296">hello optional resources template contains resources that are programmatically deployed based on hello value of a parameter or variable.</span></span>

![Ressources facultatives](./media/best-practices-resource-manager-design-templates/optional-resources.png)

<span data-ttu-id="21f96-298">**Modèle de ressource facultatif**</span><span class="sxs-lookup"><span data-stu-id="21f96-298">**Optional resources template**</span></span>

<span data-ttu-id="21f96-299">Par exemple, vous pouvez utiliser un tooconfigure de modèle de ressources facultative un jumpbox qui permet un accès indirect des environnement de tooa déployé à partir de hello Internet public.</span><span class="sxs-lookup"><span data-stu-id="21f96-299">For example, you can use an optional resources template tooconfigure a jumpbox that enables indirect access tooa deployed environment from hello public Internet.</span></span> <span data-ttu-id="21f96-300">Vous devez utiliser un tooidentify paramètre ou une variable si hello jumpbox doit être activée et hello *concat* toobuild hello cible nom pour le modèle de hello, de la fonction comme *jumpbox_enabled.json*.</span><span class="sxs-lookup"><span data-stu-id="21f96-300">You would use a parameter or variable tooidentify whether hello jumpbox should be enabled and hello *concat* function toobuild hello target name for hello template, such as *jumpbox_enabled.json*.</span></span> <span data-ttu-id="21f96-301">Liaison de modèle utiliserait hello résultant tooinstall variable hello jumpbox.</span><span class="sxs-lookup"><span data-stu-id="21f96-301">Template linking would use hello resulting variable tooinstall hello jumpbox.</span></span>

<span data-ttu-id="21f96-302">Vous pouvez lier le modèle de ressources facultative hello à partir de plusieurs emplacements :</span><span class="sxs-lookup"><span data-stu-id="21f96-302">You can link hello optional resources template from multiple places:</span></span>

* <span data-ttu-id="21f96-303">Lorsque tooevery applicable, déploiement, créez un lien contrôlée par le paramètre de modèle de ressources partagées hello.</span><span class="sxs-lookup"><span data-stu-id="21f96-303">When applicable tooevery deployment, create a parameter-driven link from hello shared resources template.</span></span>
* <span data-ttu-id="21f96-304">Lors de la tooselect applicable connu des configurations, par exemple, installer uniquement sur les déploiements à grandes échelle : créer un lien contrôlée par le paramètre ou variable-driven à partir du modèle de configuration connues hello.</span><span class="sxs-lookup"><span data-stu-id="21f96-304">When applicable tooselect known configurations—for example, only install on large deployments—create a parameter-driven or variable-driven link from hello known configuration template.</span></span>

<span data-ttu-id="21f96-305">Si une ressource donnée est facultative ne peut pas déterminée par les consommateurs de modèle hello mais plutôt par le fournisseur de modèle hello.</span><span class="sxs-lookup"><span data-stu-id="21f96-305">Whether a given resource is optional may not be driven by hello template consumer but instead by hello template provider.</span></span> <span data-ttu-id="21f96-306">Par exemple, vous devrez peut-être toosatisfy une spécification de produit particulière ou un module complémentaire de produit (commun pour les volumes partagés de cluster) ou des stratégies de tooenforce (pour les SIs et de l’informatique d’entreprise groupes).</span><span class="sxs-lookup"><span data-stu-id="21f96-306">For example, you may need toosatisfy a particular product requirement or product add-on (common for CSVs) or tooenforce policies (common for SIs and enterprise IT groups).</span></span> <span data-ttu-id="21f96-307">Dans ce cas, vous pouvez utiliser une variable tooidentify si la ressource de hello doit être déployée.</span><span class="sxs-lookup"><span data-stu-id="21f96-307">In these cases, you can use a variable tooidentify whether hello resource should be deployed.</span></span>

### <a name="known-configuration-resources-template"></a><span data-ttu-id="21f96-308">Modèle de ressource de configuration connue</span><span class="sxs-lookup"><span data-stu-id="21f96-308">Known configuration resources template</span></span>
<span data-ttu-id="21f96-309">Dans le modèle principal de hello, un paramètre peut être exposé tooallow hello modèle consommateur toospecify un toodeploy souhaitée configuration connue.</span><span class="sxs-lookup"><span data-stu-id="21f96-309">In hello main template, a parameter can be exposed tooallow hello template consumer toospecify a desired known configuration toodeploy.</span></span> <span data-ttu-id="21f96-310">Souvent, cette configuration connue utilise une approche de taille standard, avec un ensemble de tailles de configuration fixes, telles que bac à sable, petite, moyenne et grande.</span><span class="sxs-lookup"><span data-stu-id="21f96-310">Often, this known configuration uses a t-shirt size approach with a set of fixed configuration sizes such as sandbox, small, medium, and large.</span></span>

![Ressources de configuration connue](./media/best-practices-resource-manager-design-templates/known-config.png)

<span data-ttu-id="21f96-312">**Modèle de ressource de configuration connue**</span><span class="sxs-lookup"><span data-stu-id="21f96-312">**Known configuration resources template**</span></span>

<span data-ttu-id="21f96-313">approche de taille de t-shirt Hello est couramment utilisé, mais les paramètres hello peuvent représenter n’importe quel jeu de configurations connues.</span><span class="sxs-lookup"><span data-stu-id="21f96-313">hello t-shirt size approach is commonly used, but hello parameters can represent any set of known configurations.</span></span> <span data-ttu-id="21f96-314">Par exemple, vous pouvez spécifier un ensemble d’environnements pour une application d’entreprise comme Développement, Test et Production.</span><span class="sxs-lookup"><span data-stu-id="21f96-314">For example, you can specify a set of environments for an enterprise application such as Development, Test, and Product.</span></span> <span data-ttu-id="21f96-315">Vous pouvez l’utiliser pour un toorepresent de service de cloud différents à l’échelle unités, les versions de produit ou configurations de produits tels que la Communauté, Developer ou Enterprise.</span><span class="sxs-lookup"><span data-stu-id="21f96-315">Or you could use it for a cloud service toorepresent different scale units, product versions, or product configurations such as Community, Developer, or Enterprise.</span></span>

<span data-ttu-id="21f96-316">Comme avec le modèle de ressource partagée hello, les variables sont passées modèle de configurations connues toohello à partir d’un :</span><span class="sxs-lookup"><span data-stu-id="21f96-316">As with hello shared resource template, variables are passed toohello known configurations template from either:</span></span>

* <span data-ttu-id="21f96-317">Un utilisateur final, autrement dit, les paramètres de hello envoyé toohello les modèles principal.</span><span class="sxs-lookup"><span data-stu-id="21f96-317">An end user—that is, hello parameters sent toohello main template.</span></span>
* <span data-ttu-id="21f96-318">Une organisation : hello, autrement dit, les variables dans les modèles principal hello qui représentent des exigences internes ou des stratégies.</span><span class="sxs-lookup"><span data-stu-id="21f96-318">An organization—that is, hello variables in hello main template that represent internal requirements or policies.</span></span>

### <a name="member-resources-template"></a><span data-ttu-id="21f96-319">Modèle de ressource de membre</span><span class="sxs-lookup"><span data-stu-id="21f96-319">Member resources template</span></span>
<span data-ttu-id="21f96-320">Dans une configuration connue, un ou plusieurs types de nœud de membre sont souvent inclus.</span><span class="sxs-lookup"><span data-stu-id="21f96-320">Within a known configuration, one or more member node types are often included.</span></span> <span data-ttu-id="21f96-321">Par exemple, avec Hadoop, vous disposez de nœuds principaux et de nœuds de données.</span><span class="sxs-lookup"><span data-stu-id="21f96-321">For example, with Hadoop you have master nodes and data nodes.</span></span> <span data-ttu-id="21f96-322">Si vous installez MongoDB, vous disposez de nœuds de données et d’un arbitre.</span><span class="sxs-lookup"><span data-stu-id="21f96-322">If you are installing MongoDB, you have data nodes and an arbiter.</span></span> <span data-ttu-id="21f96-323">Si vous déployez DataStax, vous disposez de nœuds de données et d’une machine virtuelle avec OpsCenter installé.</span><span class="sxs-lookup"><span data-stu-id="21f96-323">If you are deploying DataStax, you have data nodes and a VM with OpsCenter installed.</span></span>

![Ressources de membres](./media/best-practices-resource-manager-design-templates/member-resources.png)

<span data-ttu-id="21f96-325">**Modèle de ressource de membre**</span><span class="sxs-lookup"><span data-stu-id="21f96-325">**Member resources template**</span></span>

<span data-ttu-id="21f96-326">Chaque type de nœud peut avoir différentes tailles de machines virtuelles, les numéros de disques attachés, les scripts tooinstall et configurer les nœuds de hello, configurations de port pour les machines virtuelles de hello, nombre d’instances et d’autres détails.</span><span class="sxs-lookup"><span data-stu-id="21f96-326">Each type of nodes can have different sizes of VMs, numbers of attached disks, scripts tooinstall and set up hello nodes, port configurations for hello VMs, number of instances, and other details.</span></span> <span data-ttu-id="21f96-327">Pour chaque type de nœud obtient son propre modèle de ressource de membre, qui contient hello détails pour le déploiement et configuration d’une infrastructure ainsi que l’exécution de scripts toodeploy et configurer les logiciels au sein de la machine virtuelle de hello.</span><span class="sxs-lookup"><span data-stu-id="21f96-327">So each node type gets its own member resource template, which contains hello details for deploying and configuring an infrastructure as well as executing scripts toodeploy and configure software within hello VM.</span></span>

<span data-ttu-id="21f96-328">En général, pour les machines virtuelles, deux types de script sont utilisés : les scripts réutilisables à grande échelle et les scripts personnalisés.</span><span class="sxs-lookup"><span data-stu-id="21f96-328">For VMs, typically two types of scripts are used, widely reusable and custom scripts.</span></span>

### <a name="widely-reusable-scripts"></a><span data-ttu-id="21f96-329">Scripts réutilisables à grande échelle</span><span class="sxs-lookup"><span data-stu-id="21f96-329">Widely reusable scripts</span></span>
<span data-ttu-id="21f96-330">Les scripts réutilisables à grande échelle peuvent être utilisés dans plusieurs types de modèle.</span><span class="sxs-lookup"><span data-stu-id="21f96-330">Widely reusable scripts can be used across multiple types of templates.</span></span> <span data-ttu-id="21f96-331">Un des exemples de meilleures hello de ces scripts réutilisables largement définit RAID sur les disques toopool Linux et obtenir un plus grand nombre d’IOPS.</span><span class="sxs-lookup"><span data-stu-id="21f96-331">One of hello better examples of these widely reusable scripts sets up RAID on Linux toopool disks and gain a greater number of IOPS.</span></span> <span data-ttu-id="21f96-332">Quel que soit le logiciel hello en cours d’installation Bonjour machine virtuelle, ce script offre la réutilisation des pratiques éprouvées pour les scénarios courants.</span><span class="sxs-lookup"><span data-stu-id="21f96-332">Regardless of hello software being installed in hello VM, this script provides reuse of proven practices for common scenarios.</span></span>

![Scripts réutilisables](./media/best-practices-resource-manager-design-templates/reusable-scripts.png)

<span data-ttu-id="21f96-334">**Les modèles de ressource de membre peuvent appeler des scripts réutilisables à grande échelle**</span><span class="sxs-lookup"><span data-stu-id="21f96-334">**Member resources templates can call widely reusable scripts**</span></span>

### <a name="custom-scripts"></a><span data-ttu-id="21f96-335">Scripts personnalisés</span><span class="sxs-lookup"><span data-stu-id="21f96-335">Custom scripts</span></span>
<span data-ttu-id="21f96-336">Les modèles appellent généralement un ou plusieurs scripts qui installent et configurent des logiciels sur les machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="21f96-336">Templates commonly call one or more scripts that install and configure software within VMs.</span></span> <span data-ttu-id="21f96-337">Cette approche est couramment rencontrée dans les topologies de grande taille dans lesquelles plusieurs instances d’un ou plusieurs types de membre sont déployées.</span><span class="sxs-lookup"><span data-stu-id="21f96-337">A common pattern is seen with large topologies where multiple instances of one or more member types are deployed.</span></span> <span data-ttu-id="21f96-338">Un script d’installation pouvant être exécuté en parallèle est lancé pour chaque machine virtuelle, suivi d’un script de configuration qui est appelé à l’issue du déploiement de toutes les machines virtuelles (ou de toutes les machines virtuelles d’un type de membre donné).</span><span class="sxs-lookup"><span data-stu-id="21f96-338">An installation script is initiated for every VM that can be run in parallel, followed by a setup script that is called after all VMs (or all VMs of a given member type) are deployed.</span></span>

![Scripts personnalisés](./media/best-practices-resource-manager-design-templates/custom-scripts.png)

<span data-ttu-id="21f96-340">**Les modèles de ressource de membre peuvent appeler des scripts pour un objectif spécifique, par exemple la configuration d’une machine virtuelle**</span><span class="sxs-lookup"><span data-stu-id="21f96-340">**Member resources templates can call scripts for a specific purpose such as VM configuration**</span></span>

## <a name="capability-scoped-solution-template-example---redis"></a><span data-ttu-id="21f96-341">Exemple de modèle de solution avec étendue de capacité : Redis</span><span class="sxs-lookup"><span data-stu-id="21f96-341">Capability-scoped solution template example - Redis</span></span>
<span data-ttu-id="21f96-342">tooshow comment une implémentation fonctionnent, examinons un exemple pratique de la création d’un modèle qui facilite le déploiement de hello et la configuration de Redis dans des tailles de t-shirt standard.</span><span class="sxs-lookup"><span data-stu-id="21f96-342">tooshow how an implementation might work, let's look at a practical example of building a template that facilitates hello deployment and configuration of Redis in standard t-shirt sizes.</span></span>  

<span data-ttu-id="21f96-343">Pour le déploiement de hello, il existe un ensemble de ressources partagées (réseau virtuel, le compte de stockage, haute disponibilité) et une ressource facultative (jumpbox).</span><span class="sxs-lookup"><span data-stu-id="21f96-343">For hello deployment, there are a set of shared resources (virtual network, storage account, availability sets) and an optional resource (jumpbox).</span></span> <span data-ttu-id="21f96-344">Il existe plusieurs configurations connues représentées par des tailles standard (petite, moyenne, grande), mais chacune dispose d’un type de nœud unique.</span><span class="sxs-lookup"><span data-stu-id="21f96-344">There are multiple known configurations represented as t-shirt sizes (small, medium, large) but each with a single node type.</span></span> <span data-ttu-id="21f96-345">Il existe également deux scripts propres aux besoins (installation et configuration).</span><span class="sxs-lookup"><span data-stu-id="21f96-345">There are also two purpose-specific scripts (installation, configuration).</span></span>

### <a name="creating-hello-template-files"></a><span data-ttu-id="21f96-346">Création des fichiers de modèle hello</span><span class="sxs-lookup"><span data-stu-id="21f96-346">Creating hello template files</span></span>
<span data-ttu-id="21f96-347">Vous allez créer un modèle principal nommé azuredeploy.json.</span><span class="sxs-lookup"><span data-stu-id="21f96-347">You would create a Main Template named azuredeploy.json.</span></span>

<span data-ttu-id="21f96-348">Vous allez créer un modèle de ressource partagé, nommé shared-resources.json.</span><span class="sxs-lookup"><span data-stu-id="21f96-348">You create Shared Resources Template named shared-resources.json</span></span>

<span data-ttu-id="21f96-349">Vous créez un déploiement de hello tooenable facultatif modèle de ressource d’un jumpbox, nommé jumpbox_enabled.json</span><span class="sxs-lookup"><span data-stu-id="21f96-349">You create an Optional Resource Template tooenable hello deployment of a jumpbox, named jumpbox_enabled.json</span></span>

<span data-ttu-id="21f96-350">Comme Redis utilise simplement un type de nœud unique, vous allez créer un modèle de ressource de membre unique, nommé node-resources.json.</span><span class="sxs-lookup"><span data-stu-id="21f96-350">Redis uses just a single node type, so you create a single Member Resource Template named node-resources.json.</span></span>

<span data-ttu-id="21f96-351">Avec Redis, vous souhaitez tooinstall chaque nœud, puis mettez en cluster de hello.</span><span class="sxs-lookup"><span data-stu-id="21f96-351">With Redis, you want tooinstall each individual node, and then set up hello cluster.</span></span>  <span data-ttu-id="21f96-352">Vous avez des scripts tooaccommodate hello installation et configuré, redis-cluster-install.sh et redis-cluster-setup.sh.</span><span class="sxs-lookup"><span data-stu-id="21f96-352">You have scripts tooaccommodate hello installation and set up, redis-cluster-install.sh and redis-cluster-setup.sh.</span></span>

### <a name="linking-hello-templates"></a><span data-ttu-id="21f96-353">Liaison de modèles de hello</span><span class="sxs-lookup"><span data-stu-id="21f96-353">Linking hello templates</span></span>
<span data-ttu-id="21f96-354">Utilisant la liaison de modèle, les modèles principal hello lie modèle toohello des ressources partagées, qui établit le réseau virtuel de hello.</span><span class="sxs-lookup"><span data-stu-id="21f96-354">Using template linking, hello main template links out toohello shared resources template, which establishes hello virtual network.</span></span>

<span data-ttu-id="21f96-355">Logique est ajoutée au sein de hello modèle principal tooenable les consommateurs de hello modèle toospecify si un jumpbox doit être déployé.</span><span class="sxs-lookup"><span data-stu-id="21f96-355">Logic is added within hello main template tooenable consumers of hello template toospecify whether a jumpbox should be deployed.</span></span> <span data-ttu-id="21f96-356">Un *activé* valeur hello *EnableJumpbox* paramètre indique que le client hello veut toodeploy un jumpbox.</span><span class="sxs-lookup"><span data-stu-id="21f96-356">An *enabled* value for hello *EnableJumpbox* parameter indicates that hello customer wants toodeploy a jumpbox.</span></span> <span data-ttu-id="21f96-357">Lorsque cette valeur est fournie, le modèle de hello concatène *_enabled du* comme nom de modèle de base tooa de suffixe pour prendre en charge jumpbox hello.</span><span class="sxs-lookup"><span data-stu-id="21f96-357">When this value is provided, hello template concatenates *_enabled* as a suffix tooa base template name for hello jumpbox capability.</span></span>

<span data-ttu-id="21f96-358">les modèles principal Hello appliquent hello *grand* valeur du paramètre comme un nom de modèle de base de tooa de suffixe pour la taille de t-shirt, puis utilise cette valeur dans une liaison de modèle out trop*technology_on_os_large.json*.</span><span class="sxs-lookup"><span data-stu-id="21f96-358">hello main template applies hello *large* parameter value as a suffix tooa base template name for t-shirt sizes, and then uses that value in a template link out too*technology_on_os_large.json*.</span></span>

<span data-ttu-id="21f96-359">topologie de Hello ressemblerait à cette illustration.</span><span class="sxs-lookup"><span data-stu-id="21f96-359">hello topology would resemble this illustration.</span></span>

![Modèle Redis](./media/best-practices-resource-manager-design-templates/redis-template.png)

<span data-ttu-id="21f96-361">**Structure d’un modèle Redis**</span><span class="sxs-lookup"><span data-stu-id="21f96-361">**Template structure for a Redis template**</span></span>

### <a name="configuring-state"></a><span data-ttu-id="21f96-362">Configuration d’un état</span><span class="sxs-lookup"><span data-stu-id="21f96-362">Configuring state</span></span>
<span data-ttu-id="21f96-363">Pour les nœuds hello dans un cluster de hello, il existe deux étapes état de hello tooconfiguring, représentés par des Scripts spécifiques objectif.</span><span class="sxs-lookup"><span data-stu-id="21f96-363">For hello nodes in hello cluster, there are two steps tooconfiguring hello state, both represented by Purpose Specific Scripts.</span></span>  <span data-ttu-id="21f96-364">« redis-cluster install.sh » installe Redis et « redis-cluster-setup.sh » configure le cluster de hello.</span><span class="sxs-lookup"><span data-stu-id="21f96-364">"redis-cluster-install.sh" installs Redis and "redis-cluster-setup.sh" sets up hello cluster.</span></span>

### <a name="supporting-different-size-deployments"></a><span data-ttu-id="21f96-365">Prise en charge des déploiements de taille différente</span><span class="sxs-lookup"><span data-stu-id="21f96-365">Supporting Different Size Deployments</span></span>
<span data-ttu-id="21f96-366">Dans des variables, modèle de taille de t-shirt hello Spécifie le nombre de hello de nœuds de chaque type toodeploy pour hello de taille spécifiée (*grand*).</span><span class="sxs-lookup"><span data-stu-id="21f96-366">Inside variables, hello t-shirt size template specifies hello number of nodes of each type toodeploy for hello specified size (*large*).</span></span> <span data-ttu-id="21f96-367">Il déploie ensuite ce nombre d’instances de machine virtuelle à l’aide de boucles de ressource, en fournissant des noms uniques tooresources en ajoutant un nom de nœud avec un numéro de séquence numérique de *copyIndex()*.</span><span class="sxs-lookup"><span data-stu-id="21f96-367">It then deploys that number of VM instances using resource loops, providing unique names tooresources by appending a node name with a numeric sequence number from *copyIndex()*.</span></span> <span data-ttu-id="21f96-368">Il le fait ces étapes pour les deux machines virtuelles de zone à chaud, tel que défini dans le modèle de nom hello t-shirt</span><span class="sxs-lookup"><span data-stu-id="21f96-368">It does these steps for both hot and warm zone VMs, as defined in hello t-shirt name template</span></span>

## <a name="decomposition-and-end-to-end-solution-scoped-templates"></a><span data-ttu-id="21f96-369">Modèles de décomposition et avec étendue de solution de bout en bout</span><span class="sxs-lookup"><span data-stu-id="21f96-369">Decomposition and end-to-end solution scoped templates</span></span>
<span data-ttu-id="21f96-370">Un modèle de solution avec étendue de solution de bout en bout est destiné à fournir une solution de bout en bout.</span><span class="sxs-lookup"><span data-stu-id="21f96-370">A solution template with an end-to-end solution scope is focused on delivering an end-to-end solution.</span></span>  <span data-ttu-id="21f96-371">Cette approche repose généralement sur la composition de plusieurs modèles avec étendue de fonctionnalité avec des ressources supplémentaires, une logique et un état.</span><span class="sxs-lookup"><span data-stu-id="21f96-371">This approach is typically a composition of multiple capability-scoped templates with additional resources, logic, and state.</span></span>

<span data-ttu-id="21f96-372">Mise en évidence dans l’image hello ci-dessous, hello même modèle utilisé pour les modèles de la fonctionnalité d’une étendue est étendu pour les modèles avec une portée de bout en bout pour la Solution.</span><span class="sxs-lookup"><span data-stu-id="21f96-372">As highlighted in hello image below, hello same model used for capability scoped templates is extended for templates with an End-to-End Solution Scope.</span></span>

<span data-ttu-id="21f96-373">Un modèle de ressources partagées et les modèles de ressources facultative servent hello même fonction que dans la capacité de hello et des fonctionnalités des approches de modèle d’une étendue, mais sont limités pour les solutions tooend hello.</span><span class="sxs-lookup"><span data-stu-id="21f96-373">A Shared Resources Template and Optional Resources Templates serve hello same function as in hello capacity and capability scoped template approaches, but are scoped for hello end tooend solution.</span></span>

<span data-ttu-id="21f96-374">Comme solution de tooend de fin d’une étendue modèles peuvent avoir également généralement des tailles de t-shirt, modèle de ressources de Configuration connu hello reflète ce qui est requis pour une configuration donnée connue de solution de hello.</span><span class="sxs-lookup"><span data-stu-id="21f96-374">As end tooend solution scoped templates also can typically have t-shirt sizes, hello Known Configuration Resources template reflects what is required for a given known configuration of hello solution.</span></span>

<span data-ttu-id="21f96-375">Hello connu un modèle de ressources de Configuration des liens tooone ou plus grande capacité de portée des modèles de solution qui sont pertinentes toohello tooend solutions ainsi que hello des modèles de ressources de membres qui sont requis pour une solution complète tooend hello.</span><span class="sxs-lookup"><span data-stu-id="21f96-375">hello Known Configuration Resources Template links tooone or more capability scoped solution templates that are relevant toohello end tooend solution as well as hello Member Resource Templates that are required for hello end tooend solution.</span></span>

<span data-ttu-id="21f96-376">Taille de t-shirt hello de solution de hello peut-être être différente de modèle d’étendue de la fonctionnalité hello individuels, les variables dans hello connu un modèle de ressources de Configuration sont hello tooprovide utilisé les valeurs appropriées pour la solution de capacité en aval d’une étendue modèles toodeploy hello t-shirt taille appropriée.</span><span class="sxs-lookup"><span data-stu-id="21f96-376">As hello t-shirt size of hello solution may be different than hello individual capability-scoped template, variables within hello Known Configuration Resources Template are used tooprovide hello appropriate values for downstream capability scoped solution templates toodeploy hello appropriate t-shirt size.</span></span>

![Bout en bout](./media/best-practices-resource-manager-design-templates/end-to-end.png)

<span data-ttu-id="21f96-378">**modèle de Hello utilisé pour la capacité ou une étendue de la fonctionnalité des modèles de solution peuvent être facilement étendues pour les étendues de modèle de solution tooend fin**</span><span class="sxs-lookup"><span data-stu-id="21f96-378">**hello model used for capacity or capability scoped solution templates can be readily extended for end tooend solution template scopes**</span></span>

## <a name="preparing-templates-for-hello-marketplace"></a><span data-ttu-id="21f96-379">Préparation des modèles hello Marketplace</span><span class="sxs-lookup"><span data-stu-id="21f96-379">Preparing templates for hello Marketplace</span></span>
<span data-ttu-id="21f96-380">Hello précédant approche facilement prend en charge les scénarios où les entreprises, SIs et volumes partagés de cluster tooeither de que vous souhaitez déployer des modèles de hello eux-mêmes ou activer leur toodeploy de clients sur leur propre.</span><span class="sxs-lookup"><span data-stu-id="21f96-380">hello preceding approach readily accommodates scenarios where Enterprises, SIs, and CSVs want tooeither deploy hello templates themselves or enable their customers toodeploy on their own.</span></span>

<span data-ttu-id="21f96-381">Un autre scénario consiste à déployer un modèle via le marketplace de hello.</span><span class="sxs-lookup"><span data-stu-id="21f96-381">Another desired scenario is deploying a template via hello marketplace.</span></span>  <span data-ttu-id="21f96-382">Cette approche de décomposition fonctionne pour marketplace hello, avec quelques changements mineurs.</span><span class="sxs-lookup"><span data-stu-id="21f96-382">This decomposition approach works for hello marketplace as well, with some minor changes.</span></span>

<span data-ttu-id="21f96-383">Comme mentionné précédemment, modèles peuvent être des types de déploiement distinct de toooffer utilisé pour la vente dans marketplace de hello.</span><span class="sxs-lookup"><span data-stu-id="21f96-383">As mentioned previously, templates can be used toooffer distinct deployment types for sale in hello marketplace.</span></span> <span data-ttu-id="21f96-384">Les types de déploiement distinct peuvent être des tailles standard (petite, moyenne, grande), le type de produit/public (communauté, développeur, entreprise) ou le type de fonctionnalité (de base, haute disponibilité).</span><span class="sxs-lookup"><span data-stu-id="21f96-384">Distinct deployment types may be t-shirt sizes (small, medium, large), product/audience type (community, developer, enterprise), or feature type (basic, high availability).</span></span>

<span data-ttu-id="21f96-385">Comme illustré ci-dessous, hello existant fin tooend solution ou modèles étendues peuvent être facilement utilisées toolist hello différentes configurations connues dans marketplace de hello.</span><span class="sxs-lookup"><span data-stu-id="21f96-385">As shown below, hello existing end tooend solution or capability scoped templates can be readily utilized toolist hello different known configurations in hello marketplace.</span></span>

<span data-ttu-id="21f96-386">Hello paramètres toohello principal modèle sont tout d’abord modifié tooremove hello entrant paramètre nommé tshirtSize.</span><span class="sxs-lookup"><span data-stu-id="21f96-386">hello parameters toohello main template are first modified tooremove hello inbound parameter named tshirtSize.</span></span>

<span data-ttu-id="21f96-387">Alors que les types de déploiement distinct hello mappent toohello connu un modèle de ressources de Configuration, ils doivent également des ressources communes hello et configuration trouvée dans hello modèle de ressources partagées et potentiellement celles figurant dans les modèles de ressources facultative.</span><span class="sxs-lookup"><span data-stu-id="21f96-387">While hello distinct deployment types map toohello Known Configuration Resources Template, they also need hello common resources and configuration found in hello Shared Resources Template and potentially those in Optional Resource Templates.</span></span>

<span data-ttu-id="21f96-388">Si vous souhaitez toopublish votre marketplace toohello de modèle, vous établissez des copies distinctes de votre modèle principal qui remplace hello précédemment disponible paramètre entrant de tshirtSize tooa variable incorporé dans le modèle de hello.</span><span class="sxs-lookup"><span data-stu-id="21f96-388">If you want toopublish your template toohello marketplace, you establish distinct copies of your Main template that replaces hello previously available inbound parameter of tshirtSize tooa variable embedded within hello template.</span></span>

![Marketplace](./media/best-practices-resource-manager-design-templates/marketplace.png)

<span data-ttu-id="21f96-390">**Adaptation d’une solution de modèle pour le marketplace de hello d’une étendue**</span><span class="sxs-lookup"><span data-stu-id="21f96-390">**Adapting a solution scoped template for hello marketplace**</span></span>

## <a name="next-steps"></a><span data-ttu-id="21f96-391">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="21f96-391">Next steps</span></span>
* <span data-ttu-id="21f96-392">toolearn sur le partage d’état vers et depuis des modèles, consultez [partager l’état sur les modèles Azure Resource Manager](best-practices-resource-manager-state.md).</span><span class="sxs-lookup"><span data-stu-id="21f96-392">toolearn about sharing state into and out of templates, see [Sharing state in Azure Resource Manager templates](best-practices-resource-manager-state.md).</span></span>
* <span data-ttu-id="21f96-393">Pour obtenir des conseils comment les entreprises peuvent utiliser le Gestionnaire de ressources tooeffectively gérer les abonnements, consultez [une vue de structure Azure enterprise - gouvernance de l’abonnement normative](resource-manager-subscription-governance.md).</span><span class="sxs-lookup"><span data-stu-id="21f96-393">For guidance on how enterprises can use Resource Manager tooeffectively manage subscriptions, see [Azure enterprise scaffold - prescriptive subscription governance](resource-manager-subscription-governance.md).</span></span>

