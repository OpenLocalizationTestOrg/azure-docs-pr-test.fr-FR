---
title: "aaaTroubleshoot les Services de Cloud à l’aide d’Application Insights | Documents Microsoft"
description: "Découvrez comment le service de cloud computing tootroubleshoot problèmes à l’aide de données de tooprocess Application Insights à partir d’Azure Diagnostics."
services: cloud-services
documentationcenter: .net
author: sbtron
manager: timlt
editor: tysonn
ms.assetid: e93f387b-ef29-4731-ae41-0676722accb6
ms.service: cloud-services
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 05/23/2017
ms.author: saurabh
ms.openlocfilehash: 972924d9e6d1fe33d5c19b006d482de52ffb0ef7
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="troubleshoot-cloud-services-using-application-insights"></a><span data-ttu-id="fedae-103">Résoudre les problèmes de Cloud Services à l’aide d’Application Insights</span><span class="sxs-lookup"><span data-stu-id="fedae-103">Troubleshoot Cloud Services using Application Insights</span></span>
<span data-ttu-id="fedae-104">Avec [Azure SDK 2.8](https://azure.microsoft.com/downloads/) et extension des diagnostics Windows Azure 1.5, vous pouvez envoyer des données de Diagnostics Windows Azure pour votre Service Cloud directement tooApplication Insights.</span><span class="sxs-lookup"><span data-stu-id="fedae-104">With [Azure SDK 2.8](https://azure.microsoft.com/downloads/) and Azure diagnostics extension 1.5, you can send Azure Diagnostics data for your Cloud Service directly tooApplication Insights.</span></span> <span data-ttu-id="fedae-105">Hello journaux collectés par les Diagnostics Azure&mdash;, y compris les journaux des applications, les journaux des événements Windows, les journaux ETW et les compteurs de performance&mdash;peuvent être envoyés tooApplication Insights.</span><span class="sxs-lookup"><span data-stu-id="fedae-105">hello logs collected by Azure Diagnostics&mdash;including application logs, Windows Event Logs, ETW Logs, and performance counters&mdash;can be sent tooApplication Insights.</span></span> <span data-ttu-id="fedae-106">Vous pouvez ensuite visualiser ces informations dans l’interface utilisateur du portail Application Insights hello.</span><span class="sxs-lookup"><span data-stu-id="fedae-106">You can then visualize this information in hello Application Insights portal UI.</span></span> <span data-ttu-id="fedae-107">Vous pouvez ensuite utiliser hello Application Insights SDK tooget vue d’ensemble de mesures et les fichiers journaux qui proviennent de votre application, ainsi que de système de hello et de données au niveau de l’infrastructure qui proviennent d’Azure Diagnostics.</span><span class="sxs-lookup"><span data-stu-id="fedae-107">You can then use hello Application Insights SDK tooget insights into metrics and logs that come from your application, as well as hello system and infrastructure-level data that comes from Azure Diagnostics.</span></span>

## <a name="configure-azure-diagnostics-toosend-data-tooapplication-insights"></a><span data-ttu-id="fedae-108">Configurer les Diagnostics Azure toosend données tooApplication Insights</span><span class="sxs-lookup"><span data-stu-id="fedae-108">Configure Azure Diagnostics toosend data tooApplication Insights</span></span>
<span data-ttu-id="fedae-109">Suivez ces tooset étapes de votre tooApplication de données cloud service projet toosend Diagnostics Azure Insights.</span><span class="sxs-lookup"><span data-stu-id="fedae-109">Follow these steps tooset up your cloud service project toosend Azure Diagnostics data tooApplication Insights.</span></span>

1. <span data-ttu-id="fedae-110">Dans l’Explorateur de solutions Visual Studio, cliquez sur un rôle et sélectionnez **propriétés** Concepteur de rôle tooopen hello.</span><span class="sxs-lookup"><span data-stu-id="fedae-110">In Visual Studio Solution Explorer, right-click a role and select **Properties** tooopen hello Role designer.</span></span>

    ![Propriétés de rôle de l'Explorateur de solutions][1]

2. <span data-ttu-id="fedae-112">Bonjour **Diagnostics** section hello du Concepteur de rôle, sélectionnez hello **envoyer des données de diagnostics tooApplication Insights** option.</span><span class="sxs-lookup"><span data-stu-id="fedae-112">In hello **Diagnostics** section of hello Role designer, select hello **Send diagnostics data tooApplication Insights** option.</span></span>

    ![Concepteur de rôle envoyez des diagnostics insights tooapplication de données][2]

3. <span data-ttu-id="fedae-114">Dans la boîte de dialogue hello qui s’affiche, sélectionnez la ressource Application Insights hello que données de diagnostics Windows Azure hello toosend à.</span><span class="sxs-lookup"><span data-stu-id="fedae-114">In hello dialog box that pops up, select hello Application Insights resource that you want toosend hello Azure diagnostics data to.</span></span> <span data-ttu-id="fedae-115">boîte de dialogue Hello vous permet de tooselect une ressource Application Insights existante à partir de votre abonnement ou toomanually spécifier une clé d’instrumentation pour une ressource Application Insights.</span><span class="sxs-lookup"><span data-stu-id="fedae-115">hello dialog box allows you tooselect an existing Application Insights resource from your subscription or toomanually specify an instrumentation key for an Application Insights resource.</span></span> <span data-ttu-id="fedae-116">Pour plus d’informations sur la création d’une ressource Application Insights, consultez [Créer une ressource Application Insights](../application-insights/app-insights-create-new-resource.md).</span><span class="sxs-lookup"><span data-stu-id="fedae-116">For more information on creating an Application Insights resource, see [Create a new Application Insights resource](../application-insights/app-insights-create-new-resource.md).</span></span>

    ![sélectionner une ressource Application Insights][3]

    <span data-ttu-id="fedae-118">Une fois que vous avez ajouté la ressource d’Application Insights hello, clé d’instrumentation hello pour cette ressource est stocké comme un paramètre de configuration de service avec le nom de hello **APPINSIGHTS_INSTRUMENTATIONKEY**.</span><span class="sxs-lookup"><span data-stu-id="fedae-118">Once you have added hello Application Insights resource, hello instrumentation key for that resource is stored as a service configuration setting with hello name **APPINSIGHTS_INSTRUMENTATIONKEY**.</span></span> <span data-ttu-id="fedae-119">Vous pouvez modifier ce paramètre de configuration pour chaque configuration ou environnement de service.</span><span class="sxs-lookup"><span data-stu-id="fedae-119">You can change this configuration setting for each service configuration or environment.</span></span> <span data-ttu-id="fedae-120">toodo, sélectionnez une autre configuration de hello **Configuration du Service** liste et spécifiez une nouvelle clé d’instrumentation pour cette configuration.</span><span class="sxs-lookup"><span data-stu-id="fedae-120">toodo so, select a different configuration from hello **Service Configuration** list and specify a new instrumentation key for that configuration.</span></span>

    ![sélectionner une configuration de service][4]

    <span data-ttu-id="fedae-122">Hello **APPINSIGHTS_INSTRUMENTATIONKEY** paramètre de configuration est utilisé par extension de diagnostics de Visual Studio tooconfigure hello avec les informations de ressource de Application Insights appropriées hello lors de la publication.</span><span class="sxs-lookup"><span data-stu-id="fedae-122">hello **APPINSIGHTS_INSTRUMENTATIONKEY** configuration setting is used by Visual Studio tooconfigure hello diagnostics extension with hello appropriate Application Insights resource information during publishing.</span></span> <span data-ttu-id="fedae-123">paramètre de configuration Hello est un moyen pratique de définir des clés d’instrumentation différentes pour différentes configurations de service.</span><span class="sxs-lookup"><span data-stu-id="fedae-123">hello configuration setting is a convenient way of defining different instrumentation keys for different service configurations.</span></span> <span data-ttu-id="fedae-124">Visual Studio traduire ce paramètre et l’insérer dans la configuration publique d’extension diagnostics hello pendant hello processus de publication.</span><span class="sxs-lookup"><span data-stu-id="fedae-124">Visual Studio will translate that setting and insert it into hello diagnostics extension public configuration during hello publish process.</span></span> <span data-ttu-id="fedae-125">processus de hello toosimplify de configuration de l’extension de diagnostics hello avec PowerShell, sortie hello du package à partir de Visual Studio contient également hello publique XML de configuration avec la clé d’instrumentation hello approprié Application Insights.</span><span class="sxs-lookup"><span data-stu-id="fedae-125">toosimplify hello process of configuring hello diagnostics extension with PowerShell, hello package output from Visual Studio also contains hello public configuration XML with hello appropriate Application Insights instrumentation key.</span></span> <span data-ttu-id="fedae-126">fichiers de configuration publics Hello sont créés dans le dossier d’Extensions hello et suivent le modèle de hello *PaaSDiagnostics.&lt; RoleName&gt;. PubConfig.xml*.</span><span class="sxs-lookup"><span data-stu-id="fedae-126">hello public config files are created in hello Extensions folder and follow hello pattern *PaaSDiagnostics.&lt;RoleName&gt;.PubConfig.xml*.</span></span> <span data-ttu-id="fedae-127">Les déploiements PowerShell peuvent utiliser cette toomap modèle chaque rôle tooa de configuration.</span><span class="sxs-lookup"><span data-stu-id="fedae-127">Any PowerShell-based deployments can use this pattern toomap each configuration tooa role.</span></span>

4) <span data-ttu-id="fedae-128">toosend de diagnostics Azure tooconfigure tous les compteurs de performance et les journaux des erreurs de niveau collectées par tooApplication de l’agent de diagnostics Windows Azure hello Insights, activer hello **envoyer des données de diagnostics tooApplication Insights** option.</span><span class="sxs-lookup"><span data-stu-id="fedae-128">tooconfigure Azure diagnostics toosend all performance counters and error-level logs collected by hello Azure diagnostics agent tooApplication Insights, enable hello **Send diagnostics data tooApplication Insights** option.</span></span> 

    <span data-ttu-id="fedae-129">Si vous souhaitez toofurther configurer les données envoyées tooApplication Insights, vous devez modifier manuellement hello *diagnostics.wadcfgx* fichier pour chaque rôle.</span><span class="sxs-lookup"><span data-stu-id="fedae-129">If you want toofurther configure what data is sent tooApplication Insights, you must manually edit hello *diagnostics.wadcfgx* file for each role.</span></span> <span data-ttu-id="fedae-130">Consultez [tooApplication de données toosend configurer les Diagnostics Azure Insights](#configure-azure-diagnostics-to-send-data-to-application-insights) toolearn plus d’informations sur la mise à jour manuelle de configuration de hello.</span><span class="sxs-lookup"><span data-stu-id="fedae-130">See [Configure Azure Diagnostics toosend data tooApplication Insights](#configure-azure-diagnostics-to-send-data-to-application-insights) toolearn more about manually updating hello configuration.</span></span>

<span data-ttu-id="fedae-131">Lorsque le service cloud hello est toosend configuré les diagnostics Azure données tooapplication insights, vous pouvez la déployer tooAzure normalement, assurant hello extension Azure diagnostics est activée.</span><span class="sxs-lookup"><span data-stu-id="fedae-131">When hello cloud service is configured toosend Azure diagnostics data tooapplication insights, you can deploy it tooAzure normally, making sure hello Azure diagnostics extension is enabled.</span></span> <span data-ttu-id="fedae-132">Pour plus d’informations, consultez [Publication d’un service cloud en utilisant Visual Studio](../vs-azure-tools-publishing-a-cloud-service.md).</span><span class="sxs-lookup"><span data-stu-id="fedae-132">For more information, see  [Publishing a Cloud Service using Visual Studio](../vs-azure-tools-publishing-a-cloud-service.md).</span></span>  

## <a name="viewing-azure-diagnostics-data-in-application-insights"></a><span data-ttu-id="fedae-133">Affichage des données des diagnostics Azure dans Application Insights</span><span class="sxs-lookup"><span data-stu-id="fedae-133">Viewing Azure diagnostics data in Application Insights</span></span>
<span data-ttu-id="fedae-134">Hello télémétrie de diagnostic Azure s’affiche dans hello Application Insights ressource configurée pour votre service cloud.</span><span class="sxs-lookup"><span data-stu-id="fedae-134">hello Azure diagnostic telemetry shows up in hello Application Insights resource configured for your cloud service.</span></span>

<span data-ttu-id="fedae-135">Types de journaux de diagnostics Azure mappent les concepts de Insights tooApplication des façons suivantes :</span><span class="sxs-lookup"><span data-stu-id="fedae-135">Azure diagnostics log types map tooApplication Insights concepts in these ways:</span></span>

* <span data-ttu-id="fedae-136">Les compteurs de performances s’affichent en tant que métriques personnalisées dans Application Insights.</span><span class="sxs-lookup"><span data-stu-id="fedae-136">Performance counters are displayed as Custom Metrics in Application Insights.</span></span>
* <span data-ttu-id="fedae-137">Les journaux des événements Windows s’affichent en tant que traces et événements personnalisés dans Application Insights.</span><span class="sxs-lookup"><span data-stu-id="fedae-137">Windows Event Logs are shown as Traces and Custom Events in Application Insights.</span></span>
* <span data-ttu-id="fedae-138">Les journaux d’applications, les journaux ETW et les journaux d’infrastructure de diagnostics éventuels s’affichent en tant que traces dans Application Insights.</span><span class="sxs-lookup"><span data-stu-id="fedae-138">Application logs, ETW logs, and any Diagnostics Infrastructure logs are shown as Traces in Application Insights.</span></span>

<span data-ttu-id="fedae-139">tooview des données de diagnostics Azure dans Application Insights, effectuez l’une des suivantes de hello :</span><span class="sxs-lookup"><span data-stu-id="fedae-139">tooview Azure diagnostics data in Application Insights, do one of hello following:</span></span>

* <span data-ttu-id="fedae-140">Utilisez [Metrics explorer](../application-insights/app-insights-metrics-explorer.md) toovisualize des performances personnalisées compteurs ou le nombre des différents types d’événements du journal des événements Windows.</span><span class="sxs-lookup"><span data-stu-id="fedae-140">Use [Metrics explorer](../application-insights/app-insights-metrics-explorer.md) toovisualize any custom performance counters or counts of different types of Windows Event Log events.</span></span>

    ![Métriques personnalisées dans Metrics Explorer][5]

* <span data-ttu-id="fedae-142">Utilisez [recherche](../application-insights/app-insights-diagnostic-search.md) toosearch dans les journaux de trace hello envoyés par les Diagnostics Windows Azure.</span><span class="sxs-lookup"><span data-stu-id="fedae-142">Use [Search](../application-insights/app-insights-diagnostic-search.md) toosearch across hello  trace logs sent by Azure Diagnostics.</span></span> <span data-ttu-id="fedae-143">Par exemple, si une exception non gérée a provoqué hello rôle toocrash et recyclage, plus d’informations sur l’exception de hello s’affiche dans hello *Application* canal de *journal des événements Windows*.</span><span class="sxs-lookup"><span data-stu-id="fedae-143">For example, if an unhandled exception has caused hello role toocrash and recycle, information about hello exception shows up in hello *Application* channel of *Windows Event Log*.</span></span> <span data-ttu-id="fedae-144">Vous pouvez utiliser des toolook de recherche à hello erreur du journal des événements Windows et obtenir la trace de pile complet hello pour hello exception toohelp rechercher hello cause du problème de hello.</span><span class="sxs-lookup"><span data-stu-id="fedae-144">You can use search toolook at hello Windows Event Log error and get hello full stack trace for hello exception toohelp find hello cause of hello issue.</span></span>

    ![Rechercher dans les traces][6]

## <a name="next-steps"></a><span data-ttu-id="fedae-146">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="fedae-146">Next Steps</span></span>
* <span data-ttu-id="fedae-147">[Ajouter un service de cloud hello Application Insights SDK tooyour](../application-insights/app-insights-cloudservices.md) toosend des données sur les demandes, les exceptions, les dépendances et les données de télémétrie personnalisées à partir de votre application.</span><span class="sxs-lookup"><span data-stu-id="fedae-147">[Add hello Application Insights SDK tooyour cloud service](../application-insights/app-insights-cloudservices.md) toosend data about requests, exceptions, dependencies, and any custom telemetry from your application.</span></span> <span data-ttu-id="fedae-148">Lorsqu’elles sont combinées avec des données de Diagnostics Windows Azure hello, ces informations vous pouvez obtenir une vue complète de votre application et le système, tout en hello même ressource d’Application Insight.</span><span class="sxs-lookup"><span data-stu-id="fedae-148">When combined with hello Azure Diagnostics data, this information you can get a complete view of your application and system, all in hello same Application Insight resource.</span></span>  

<!--Image references-->
[1]: ./media/cloud-services-dotnet-diagnostics-applicationinsights/solution-explorer-properties.png
[2]: ./media/cloud-services-dotnet-diagnostics-applicationinsights/role-designer-sendtoappinsights.png
[3]: ./media/cloud-services-dotnet-diagnostics-applicationinsights/select-appinsights-resource.png
[4]: ./media/cloud-services-dotnet-diagnostics-applicationinsights/role-designer-appinsights-serviceconfig.png
[5]: ./media/cloud-services-dotnet-diagnostics-applicationinsights/metrics-explorer-custom-metrics.png
[6]: ./media/cloud-services-dotnet-diagnostics-applicationinsights/search-windowseventlog-error.png
