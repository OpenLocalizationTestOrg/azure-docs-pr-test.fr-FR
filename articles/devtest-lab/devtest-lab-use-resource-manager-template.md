---
title: "aaaView et utiliser Azure Resource Manager modèle une machine virtuelle | Documents Microsoft"
description: "Découvrez comment toouse hello modèle Azure Resource Manager à partir d’un ordinateur virtuel de toocreate autres machines virtuelles"
services: devtest-lab,virtual-machines,visual-studio-online
documentationcenter: na
author: tomarcher
manager: douge
editor: 
ms.assetid: a759d9ce-655c-4ac6-8834-cb29dd7d30dd
ms.service: devtest-lab
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/05/2017
ms.author: tarcher
ms.openlocfilehash: b79f7eb4171793681a0b654e6e72a83191c76bde
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="use-a-virtual-machines-azure-resource-manager-template"></a><span data-ttu-id="a2241-103">Utiliser un modèle Azure Resource Manager de machine virtuelle</span><span class="sxs-lookup"><span data-stu-id="a2241-103">Use a virtual machine's Azure Resource Manager template</span></span>

<span data-ttu-id="a2241-104">Lorsque vous créez un ordinateur virtuel (VM) dans DevTest Labs via hello [portail Azure](http://go.microsoft.com/fwlink/p/?LinkID=525040), vous pouvez afficher le modèle de gestionnaire de ressources Azure hello avant de vous enregistrez hello machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="a2241-104">When you are creating a virtual machine (VM) in DevTest Labs through hello [Azure portal](http://go.microsoft.com/fwlink/p/?LinkID=525040), you can view hello Azure Resource Manager template before you save hello VM.</span></span> <span data-ttu-id="a2241-105">Hello modèle peut ensuite être utilisé comme un toocreate base plus ordinateurs virtuels du laboratoire avec hello les mêmes paramètres.</span><span class="sxs-lookup"><span data-stu-id="a2241-105">hello template can then be used as a basis toocreate more lab VMs with hello same settings.</span></span>

<span data-ttu-id="a2241-106">Cet article décrit comment tooview hello modèle du Gestionnaire de ressources lors de la création d’une machine virtuelle et comment toodeploy il ultérieure tooautomate la création de hello même machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="a2241-106">This article describes how tooview hello Resource Manager template when creating a VM, and how toodeploy it later tooautomate creation of hello same VM.</span></span>

## <a name="multi-vm-vs-single-vm-resource-manager-templates"></a><span data-ttu-id="a2241-107">Modèles Resource Manager à plusieurs machines virtuelles ou à machine virtuelle unique</span><span class="sxs-lookup"><span data-stu-id="a2241-107">Multi-VM vs. single-VM Resource Manager templates</span></span>
<span data-ttu-id="a2241-108">Il existe deux façons toocreate VM dans DevTest Labs, à l’aide d’un modèle de gestionnaire de ressources : configurer hello Microsoft.DevTestLab/labs/virtualmachines ressources ou configurer hello Microsoft.Commpute/virtualmachines ressources.</span><span class="sxs-lookup"><span data-stu-id="a2241-108">There are two ways toocreate VMs in DevTest Labs using a Resource Manager template: provision hello Microsoft.DevTestLab/labs/virtualmachines resource or provision hello Microsoft.Commpute/virtualmachines resource.</span></span> <span data-ttu-id="a2241-109">Chaque méthode est utilisée dans des scénarios différents et nécessite des autorisations différentes.</span><span class="sxs-lookup"><span data-stu-id="a2241-109">Each is used in different scenarios and require different permissions.</span></span>

- <span data-ttu-id="a2241-110">Modèles de gestionnaire de ressources qui utilisent un type de ressource Microsoft.DevTestLab/labs/virtualmachines (tel qu’il est déclaré dans la propriété de « ressource » hello dans le modèle de hello) peuvent configurer des ordinateurs virtuels de lab individuels.</span><span class="sxs-lookup"><span data-stu-id="a2241-110">Resource Manager templates that use a Microsoft.DevTestLab/labs/virtualmachines resource type (as declared in hello “resource” property in hello template) can provision individual lab VMs.</span></span> <span data-ttu-id="a2241-111">Chaque ordinateur virtuel puis affiche sous la forme d’un seul élément dans la liste d’ordinateurs virtuels DevTest Labs hello :</span><span class="sxs-lookup"><span data-stu-id="a2241-111">Each VM then shows up as a single item in hello DevTest Labs virtual machines list:</span></span>

   ![Liste des ordinateurs virtuels en tant qu’éléments uniques dans la liste d’ordinateurs virtuels hello DevTest Labs](./media/devtest-lab-use-arm-template/devtestlab-lab-vm-single-item.png)

   <span data-ttu-id="a2241-113">Ce type de modèle de gestionnaire de ressources peut être configuré par hello commande Azure PowerShell **New-AzureRmResourceGroupDeployment** ou via la commande CLI d’Azure de hello **créer de déploiement de groupe az** .</span><span class="sxs-lookup"><span data-stu-id="a2241-113">This type of Resource Manager template can be provisioned through hello Azure PowerShell command **New-AzureRmResourceGroupDeployment** or through hello Azure CLI command **az group deployment create**.</span></span> <span data-ttu-id="a2241-114">Il requiert des autorisations d’administrateur, afin des utilisateurs assignés à un rôle d’utilisateur DevTest Labs ne peut pas effectuer le déploiement de hello.</span><span class="sxs-lookup"><span data-stu-id="a2241-114">It requires administrator permissions, so users who are assigned with a DevTest Labs user role can’t perform hello deployment.</span></span> 

- <span data-ttu-id="a2241-115">Modèles de gestionnaire de ressources qui utilisent un type de ressource Microsoft.Compute/virtualmachines peuvent configurer plusieurs machines virtuelles en tant qu’un seul environnement dans la liste d’ordinateurs virtuels DevTest Labs hello :</span><span class="sxs-lookup"><span data-stu-id="a2241-115">Resource Manager templates that use a Microsoft.Compute/virtualmachines resource type can provision multiple VMs as a single environment in hello DevTest Labs virtual machines list:</span></span>

   ![Liste des ordinateurs virtuels en tant qu’éléments uniques dans la liste d’ordinateurs virtuels hello DevTest Labs](./media/devtest-lab-use-arm-template/devtestlab-lab-vm-single-environment.png)

   <span data-ttu-id="a2241-117">Machines virtuelles dans hello même environnement permettre être géré ensemble et partage hello même cycle de vie.</span><span class="sxs-lookup"><span data-stu-id="a2241-117">VMs in hello same environment can be managed together and share hello same lifecycle.</span></span> <span data-ttu-id="a2241-118">Les utilisateurs sont affectés à un rôle d’utilisateur DevTest Labs peuvent créer des environnements à l’aide de ces modèles tant qu’administrateur de hello a configurés lab de hello de cette façon.</span><span class="sxs-lookup"><span data-stu-id="a2241-118">Users who are assigned with a DevTest Labs user role can create environments using those templates as long as hello administrator has configured hello lab that way.</span></span>

<span data-ttu-id="a2241-119">Hello reste de cet article présente les modèles de gestionnaire de ressources qui utilisent Mirosoft.DevTestLab/labs/virtualmachines.</span><span class="sxs-lookup"><span data-stu-id="a2241-119">hello remainder of this article discusses Resource Manager templates that use Mirosoft.DevTestLab/labs/virtualmachines.</span></span> <span data-ttu-id="a2241-120">Ils sont utilisés par la création d’ordinateurs virtuels lab lab administrateurs tooautomate (par exemple, qui peuvent être réclamés VMs) ou génération de l’image finale (par exemple, en usine image).</span><span class="sxs-lookup"><span data-stu-id="a2241-120">These are used by lab admins tooautomate lab VM creation (for example, claimable VMs) or golden image generation (for example, image factory).</span></span>

<span data-ttu-id="a2241-121">[Meilleures pratiques pour la création de modèles Azure Resource Manager](https://docs.microsoft.com/azure/azure-resource-manager/resource-manager-template-best-practices) offre de nombreux toohelp d’instructions et des suggestions vous créez des modèles Azure Resource Manager sont toouse simple et fiable.</span><span class="sxs-lookup"><span data-stu-id="a2241-121">[Best practices for creating Azure Resource Manager templates](https://docs.microsoft.com/azure/azure-resource-manager/resource-manager-template-best-practices) offers many guidelines and suggestions toohelp you create Azure Resource Manager templates that are reliable and easy toouse.</span></span>

## <a name="view-and-save-a-virtual-machines-resource-manager-template"></a><span data-ttu-id="a2241-122">Afficher et enregistrer un modèle Resource Manager de machine virtuelle</span><span class="sxs-lookup"><span data-stu-id="a2241-122">View and save a virtual machine's Resource Manager template</span></span>
1. <span data-ttu-id="a2241-123">Suivez les étapes de hello à [créer votre première machine virtuelle dans un laboratoire](devtest-lab-create-first-vm.md) toobegin création d’un ordinateur virtuel.</span><span class="sxs-lookup"><span data-stu-id="a2241-123">Follow hello steps at [Create your first VM in a lab](devtest-lab-create-first-vm.md) toobegin creating a virtual machine.</span></span>
1. <span data-ttu-id="a2241-124">Entrez les informations de hello requis pour votre machine virtuelle et ajouter les artefacts que vous souhaitez pour cette machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="a2241-124">Enter hello required information for your virtual machine and add any artifacts you want for this VM.</span></span>
1. <span data-ttu-id="a2241-125">En bas de hello de fenêtre de paramètres de configuration hello, choisissez **modèle vue ARM**.</span><span class="sxs-lookup"><span data-stu-id="a2241-125">At hello bottom of hello Configure settings window, choose **View ARM template**.</span></span>

   ![Bouton Afficher le modèle ARM](./media/devtest-lab-use-arm-template/devtestlab-lab-view-rm-template.png)
1. <span data-ttu-id="a2241-127">Copiez et enregistrez toouse de modèle de gestionnaire de ressources hello ultérieure toocreate une autre machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="a2241-127">Copy and save hello Resource Manager template toouse later toocreate another virtual machine.</span></span>

   ![Toosave de modèle de gestionnaire de ressources pour une utilisation ultérieure](./media/devtest-lab-use-arm-template/devtestlab-lab-copy-rm-template.png)

<span data-ttu-id="a2241-129">Une fois que vous avez enregistré le modèle de gestionnaire de ressources hello, vous devez mettre à jour section des paramètres de modèle de hello hello avant que vous puissiez l’utiliser.</span><span class="sxs-lookup"><span data-stu-id="a2241-129">After you have saved hello Resource Manager template, you must update hello parameters section of hello template before you can use it.</span></span> <span data-ttu-id="a2241-130">Vous pouvez créer un parameter.json qui personnalise simplement les paramètres de hello, en dehors du modèle de gestionnaire de ressources réelle hello.</span><span class="sxs-lookup"><span data-stu-id="a2241-130">You can create a parameter.json that customizes just hello parameters, outside of hello actual Resource Manager template.</span></span> 

![Personnaliser les paramètres à l’aide d’un fichier JSON](./media/devtest-lab-use-arm-template/devtestlab-lab-custom-params.png)

## <a name="deploy-a-resource-manager-template-toocreate-a-vm"></a><span data-ttu-id="a2241-132">Déployer un toocreate de modèle de gestionnaire de ressources une machine virtuelle</span><span class="sxs-lookup"><span data-stu-id="a2241-132">Deploy a Resource Manager template toocreate a VM</span></span>
<span data-ttu-id="a2241-133">Une fois que vous avez enregistré un modèle de gestionnaire de ressources et il adaptés à vos besoins, vous pouvez l’utiliser tooautomate création d’ordinateurs virtuels.</span><span class="sxs-lookup"><span data-stu-id="a2241-133">After you have saved a Resource Manager template and customized it for your needs, you can use it tooautomate VM creation.</span></span> <span data-ttu-id="a2241-134">[Déployer des ressources avec des modèles de gestionnaire de ressources et d’Azure PowerShell](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-template-deploy) décrit comment toouse Azure PowerShell avec le Gestionnaire de ressources modèles toodeploy tooAzure de vos ressources.</span><span class="sxs-lookup"><span data-stu-id="a2241-134">[Deploy resources with Resource Manager templates and Azure PowerShell](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-template-deploy) describes how toouse Azure PowerShell with Resource Manager templates toodeploy your resources tooAzure.</span></span> <span data-ttu-id="a2241-135">[Déployer des ressources avec des modèles de gestionnaire de ressources et CLI d’Azure](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-template-deploy-cli) décrit comment toouse CLI d’Azure avec le Gestionnaire de ressources modèles toodeploy tooAzure de vos ressources.</span><span class="sxs-lookup"><span data-stu-id="a2241-135">[Deploy resources with Resource Manager templates and Azure CLI](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-template-deploy-cli) describes how toouse Azure CLI with Resource Manager templates toodeploy your resources tooAzure.</span></span>

> [!NOTE]
> <span data-ttu-id="a2241-136">Seul un utilisateur disposant des autorisations de propriétaire de laboratoire peut créer des machines virtuelles à partir d’un modèle Resource Manager avec Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="a2241-136">Only a user with lab owner permissions can create VMs from a Resource Manager template by using Azure PowerShell.</span></span> <span data-ttu-id="a2241-137">Si vous voulez tooautomate la création d’ordinateurs virtuels à l’aide d’un modèle de gestionnaire de ressources et si vous disposez uniquement d’autorisations utilisateur, vous pouvez utiliser hello [ **créer des ordinateurs virtuels de lab az** commande hello CLI](https://docs.microsoft.com/cli/azure/lab/vm#create).</span><span class="sxs-lookup"><span data-stu-id="a2241-137">If you want tooautomate VM creation using a Resource Manager template and you only have user permissions, you can use hello [**az lab vm create** command in hello CLI](https://docs.microsoft.com/cli/azure/lab/vm#create).</span></span>

### <a name="next-steps"></a><span data-ttu-id="a2241-138">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="a2241-138">Next steps</span></span>
* <span data-ttu-id="a2241-139">Découvrez comment trop[créer des environnements de multi-VM avec des modèles de gestionnaire de ressources](devtest-lab-create-environment-from-arm.md).</span><span class="sxs-lookup"><span data-stu-id="a2241-139">Learn how too[Create multi-VM environments with Resource Manager templates](devtest-lab-create-environment-from-arm.md).</span></span>
* <span data-ttu-id="a2241-140">Explorer les autres modèles de gestionnaire de ressources de démarrage rapide pour l’automatisation de DevTest Labs de hello [public DevTest Labs GitHub référentiel](https://github.com/Azure/azure-quickstart-templates).</span><span class="sxs-lookup"><span data-stu-id="a2241-140">Explore more quick-start Resource Manager templates for DevTest Labs automation from hello [public DevTest Labs GitHub repo](https://github.com/Azure/azure-quickstart-templates).</span></span>
