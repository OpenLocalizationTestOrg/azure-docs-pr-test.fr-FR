---
title: "Créer un environnement Azure App Service à l’aide d’un modèle Resource Manager"
description: "Explique comment créer un environnement Azure App Service (ASE) externe ou avec équilibreur de charge interne (ILB) à l’aide d’un modèle Resource Manager"
services: app-service
documentationcenter: na
author: ccompy
manager: stefsch
ms.assetid: 6eb7d43d-e820-4a47-818c-80ff7d3b6f8e
ms.service: app-service
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/13/2017
ms.author: ccompy
ms.openlocfilehash: e6b21086488352c1da914b4656ad1d216fd6de85
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/03/2017
---
# <a name="create-an-ase-by-using-an-azure-resource-manager-template"></a><span data-ttu-id="7692c-103">Créer un ASE à l’aide d’un modèle Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="7692c-103">Create an ASE by using an Azure Resource Manager template</span></span>

## <a name="overview"></a><span data-ttu-id="7692c-104">Vue d'ensemble</span><span class="sxs-lookup"><span data-stu-id="7692c-104">Overview</span></span>
<span data-ttu-id="7692c-105">Les environnements Azure App Service (ASE, App Service Environment) peuvent être créés avec un point de terminaison accessible via Internet ou un point de terminaison sur une adresse interne d’un réseau virtuel Azure.</span><span class="sxs-lookup"><span data-stu-id="7692c-105">Azure App Service environments (ASEs) can be created with an internet-accessible endpoint or an endpoint on an internal address in an Azure virtual network (VNet).</span></span> <span data-ttu-id="7692c-106">S’il est créé avec un point de terminaison interne, ce point de terminaison est fourni par un composant Azure appelé équilibreur de charge interne (ILB, Internal Load Balancer).</span><span class="sxs-lookup"><span data-stu-id="7692c-106">When created with an internal endpoint, that endpoint is provided by an Azure component called an internal load balancer (ILB).</span></span> <span data-ttu-id="7692c-107">Un ASE sur une adresse IP interne est appelé ASE ILB.</span><span class="sxs-lookup"><span data-stu-id="7692c-107">The ASE on an internal IP address is called an ILB ASE.</span></span> <span data-ttu-id="7692c-108">Un ASE avec un point de terminaison public est appelé ASE externe.</span><span class="sxs-lookup"><span data-stu-id="7692c-108">The ASE with a public endpoint is called an External ASE.</span></span> 

<span data-ttu-id="7692c-109">Un ASE peut être créé à l’aide du portail Azure ou d’un modèle Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="7692c-109">An ASE can be created by using the Azure portal or an Azure Resource Manager template.</span></span> <span data-ttu-id="7692c-110">Cet article décrit les étapes et la syntaxe nécessaires pour créer un ASE externe ou un ASE ILB à l’aide de modèles Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="7692c-110">This article walks through the steps and syntax you need to create an External ASE or ILB ASE with Resource Manager templates.</span></span> <span data-ttu-id="7692c-111">Pour découvrir comment créer un ASE dans le portail Azure, voir [Créer un environnement App Service Environment externe][MakeExternalASE] ou [Créer et utiliser un équilibreur de charge interne avec un environnement Azure App Service Environment][MakeILBASE].</span><span class="sxs-lookup"><span data-stu-id="7692c-111">To learn how to create an ASE in the Azure portal, see [Make an External ASE][MakeExternalASE] or [Make an ILB ASE][MakeILBASE].</span></span>

<span data-ttu-id="7692c-112">Lorsque vous créez un ASE dans le portail Azure, vous pouvez créer votre réseau virtuel en même temps, ou choisir un réseau virtuel préexistant pour le déploiement.</span><span class="sxs-lookup"><span data-stu-id="7692c-112">When you create an ASE in the Azure portal, you can create your VNet at the same time or choose a preexisting VNet to deploy into.</span></span> <span data-ttu-id="7692c-113">Lorsque vous créez un ASE à partir d’un modèle, vous devez commencer avec :</span><span class="sxs-lookup"><span data-stu-id="7692c-113">When you create an ASE from a template, you must start with:</span></span> 

* <span data-ttu-id="7692c-114">Un réseau virtuel Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="7692c-114">A Resource Manager VNet.</span></span>
* <span data-ttu-id="7692c-115">Un sous-réseau de ce réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="7692c-115">A subnet in that VNet.</span></span> <span data-ttu-id="7692c-116">Pour le sous-réseau ASE, nous recommandons une taille de  `/25` avec des 128 adresses pour s’adapter à la croissance future.</span><span class="sxs-lookup"><span data-stu-id="7692c-116">We recommend an ASE subnet size of `/25` with 128 addresses to accomodate future growth.</span></span> <span data-ttu-id="7692c-117">Une fois l’ASE créé, vous ne pouvez plus en modifier la taille.</span><span class="sxs-lookup"><span data-stu-id="7692c-117">After the ASE is created, you can't change the size.</span></span>
* <span data-ttu-id="7692c-118">L’ID de ressource de votre réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="7692c-118">The resource ID from your VNet.</span></span> <span data-ttu-id="7692c-119">Vous pouvez le trouver sur portail Azure sous les propriétés de votre réseau virtuel Azure.</span><span class="sxs-lookup"><span data-stu-id="7692c-119">You can get this information from the Azure portal under your virtual network properties.</span></span>
* <span data-ttu-id="7692c-120">L’abonnement vers lequel vous souhaitez procéder au déploiement.</span><span class="sxs-lookup"><span data-stu-id="7692c-120">The subscription you want to deploy into.</span></span>
* <span data-ttu-id="7692c-121">L’emplacement dans lequel vous souhaitez procéder au déploiement.</span><span class="sxs-lookup"><span data-stu-id="7692c-121">The location you want to deploy into.</span></span>

<span data-ttu-id="7692c-122">Pour automatiser la création de votre environnement ASE :</span><span class="sxs-lookup"><span data-stu-id="7692c-122">To automate your ASE creation:</span></span>

1. <span data-ttu-id="7692c-123">Créez l’environnement ASE à partir d’un modèle.</span><span class="sxs-lookup"><span data-stu-id="7692c-123">Create the ASE from a template.</span></span> <span data-ttu-id="7692c-124">Si vous créez un ASE externe, vous avez terminé après cette étape.</span><span class="sxs-lookup"><span data-stu-id="7692c-124">If you create an External ASE, you're finished after this step.</span></span> <span data-ttu-id="7692c-125">Si vous créez un ASE ILB, il reste quelques étapes à accomplir.</span><span class="sxs-lookup"><span data-stu-id="7692c-125">If you create an ILB ASE, there are a few more things to do.</span></span>

2. <span data-ttu-id="7692c-126">Une fois votre ASE ILB créé, un certificat SSL correspondant à votre domaine ASE ILB est chargé.</span><span class="sxs-lookup"><span data-stu-id="7692c-126">After your ILB ASE is created, an SSL certificate that matches your ILB ASE domain is uploaded.</span></span>

3. <span data-ttu-id="7692c-127">Le certificat SSL chargé est affecté à l’environnement ASE ILB en tant que certificat SSL « par défaut ».</span><span class="sxs-lookup"><span data-stu-id="7692c-127">The uploaded SSL certificate is assigned to the ILB ASE as its "default" SSL certificate.</span></span>  <span data-ttu-id="7692c-128">Ce certificat est utilisé pour le trafic SSL vers les applications de l’ASE ILB quand celles-ci utilisent le domaine racine commun assigné à l’ASE (par exemple, https://someapp.mycustomrootcomain.com).</span><span class="sxs-lookup"><span data-stu-id="7692c-128">This certificate is used for SSL traffic to apps on the ILB ASE when they use the common root domain that's assigned to the ASE (for example, https://someapp.mycustomrootcomain.com).</span></span>


## <a name="create-the-ase"></a><span data-ttu-id="7692c-129">Créer l’ASE</span><span class="sxs-lookup"><span data-stu-id="7692c-129">Create the ASE</span></span>
<span data-ttu-id="7692c-130">Un modèle Azure Resource Manager permettant de créer un ASE et son fichier de paramètres associé est disponible sous forme d’[exemple][quickstartasev2create] sur GitHub.</span><span class="sxs-lookup"><span data-stu-id="7692c-130">A Resource Manager template that creates an ASE and its associated parameters file is available [in an example][quickstartasev2create] on GitHub.</span></span>

<span data-ttu-id="7692c-131">Si vous souhaitez créer un ASE ILB, utilisez ces [exemples][quickstartilbasecreate] de modèle Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="7692c-131">If you want to make an ILB ASE, use these Resource Manager template [examples][quickstartilbasecreate].</span></span> <span data-ttu-id="7692c-132">Ils sont destinés à ce cas d’usage.</span><span class="sxs-lookup"><span data-stu-id="7692c-132">They cater to that use case.</span></span> <span data-ttu-id="7692c-133">La plupart des paramètres définis dans le fichier *azuredeploy.parameters.json* sont communs à la création des ASE ILB et des ASE externes.</span><span class="sxs-lookup"><span data-stu-id="7692c-133">Most of the parameters in the *azuredeploy.parameters.json* file are common to the creation of ILB ASEs and External ASEs.</span></span> <span data-ttu-id="7692c-134">La liste suivante énonce les paramètres appelant un commentaire particulier ou qui sont uniques, en lien avec la création d’un ASE ILB :</span><span class="sxs-lookup"><span data-stu-id="7692c-134">The following list calls out parameters of special note, or that are unique, when you create an ILB ASE:</span></span>

* <span data-ttu-id="7692c-135">*interalLoadBalancingMode* : dans la plupart des cas, définissez ce paramètre sur 3, ce qui signifie que le trafic HTTP/HTTPS sur les ports 80/443 ainsi que les ports de canaux de contrôle/données écoutés par le service FTP sur l’ASE seront liés à une adresse interne du réseau virtuel allouée à l’ILB.</span><span class="sxs-lookup"><span data-stu-id="7692c-135">*interalLoadBalancingMode*: In most cases, set this to 3, which means both HTTP/HTTPS traffic on ports 80/443, and the control/data channel ports listened to by the FTP service on the ASE, will be bound to an ILB-allocated virtual network internal address.</span></span> <span data-ttu-id="7692c-136">Si ce paramètre est défini sur 2, seuls les ports associés au service FTP (canaux de contrôle et de données) sont liés à une adresse d’ILB.</span><span class="sxs-lookup"><span data-stu-id="7692c-136">If this property is set to 2, only the FTP service-related ports (both control and data channels) are bound to an ILB address.</span></span> <span data-ttu-id="7692c-137">Le trafic HTTP/HTTPS reste sur l’adresse IP virtuelle publique.</span><span class="sxs-lookup"><span data-stu-id="7692c-137">The HTTP/HTTPS traffic remains on the public VIP.</span></span>
* <span data-ttu-id="7692c-138">*dnsSuffix*: ce paramètre définit le domaine racine par défaut affecté à l’ASE.</span><span class="sxs-lookup"><span data-stu-id="7692c-138">*dnsSuffix*: This parameter defines the default root domain that's assigned to the ASE.</span></span> <span data-ttu-id="7692c-139">Dans la version publique d’Azure App Service, le domaine racine par défaut pour toutes les applications web est *azurewebsites.net*.</span><span class="sxs-lookup"><span data-stu-id="7692c-139">In the public variation of Azure App Service, the default root domain for all web apps is *azurewebsites.net*.</span></span> <span data-ttu-id="7692c-140">Étant donné qu’un ASE ILB est interne au réseau virtuel d’un client, il n’est pas pertinent d’utiliser le domaine racine par défaut du service public.</span><span class="sxs-lookup"><span data-stu-id="7692c-140">Because an ILB ASE is internal to a customer's virtual network, it doesn't make sense to use the public service's default root domain.</span></span> <span data-ttu-id="7692c-141">Au lieu de cela, un ILB ASE doit avoir un domaine racine par défaut approprié pour une utilisation au sein du réseau virtuel interne d’une société.</span><span class="sxs-lookup"><span data-stu-id="7692c-141">Instead, an ILB ASE should have a default root domain that makes sense for use within a company's internal virtual network.</span></span> <span data-ttu-id="7692c-142">Par exemple, une société nommée Contoso Corporation peut utiliser le domaine racine par défaut *internal-contoso.com* pour les applications qui sont destinées à être résolues et accessibles uniquement au sein du réseau virtuel de Contoso.</span><span class="sxs-lookup"><span data-stu-id="7692c-142">For example, Contoso Corporation might use a default root domain of *internal-contoso.com* for apps that are intended to be resolvable and accessible only within Contoso's virtual network.</span></span> 
* <span data-ttu-id="7692c-143">*ipSslAddressCount*: ce paramètre est automatiquement défini par défaut sur la valeur 0 dans le fichier *azuredeploy.json*, car les ASE ILB disposent d’une seule adresse d’ILB.</span><span class="sxs-lookup"><span data-stu-id="7692c-143">*ipSslAddressCount*: This parameter automatically defaults to a value of 0 in the *azuredeploy.json* file because ILB ASEs only have a single ILB address.</span></span> <span data-ttu-id="7692c-144">Il n’existe pas d’adresse IP SSL explicite pour un ASE ILB.</span><span class="sxs-lookup"><span data-stu-id="7692c-144">There are no explicit IP-SSL addresses for an ILB ASE.</span></span> <span data-ttu-id="7692c-145">Par conséquent, le pool d’adresses IP SSL pour un ASE ILB doit être défini sur zéro.</span><span class="sxs-lookup"><span data-stu-id="7692c-145">Hence, the IP-SSL address pool for an ILB ASE must be set to zero.</span></span> <span data-ttu-id="7692c-146">Autrement, une erreur d’approvisionnement se produit.</span><span class="sxs-lookup"><span data-stu-id="7692c-146">Otherwise, a provisioning error occurs.</span></span> 

<span data-ttu-id="7692c-147">Une fois le fichier *azuredeploy.parameters.json* complété, créez l’ASE à l’aide de l’extrait de code PowerShell.</span><span class="sxs-lookup"><span data-stu-id="7692c-147">After the *azuredeploy.parameters.json* file is filled in, create the ASE by using the PowerShell code snippet.</span></span> <span data-ttu-id="7692c-148">Modifiez les chemins d’accès des fichiers de façon à ce qu’ils correspondent aux emplacements des fichiers du modèle Resource Manager sur votre ordinateur.</span><span class="sxs-lookup"><span data-stu-id="7692c-148">Change the file paths to match the Resource Manager template-file locations on your machine.</span></span> <span data-ttu-id="7692c-149">Songez à indiquer vos propres valeurs pour les noms de déploiement Resource Manager et de groupe de ressources :</span><span class="sxs-lookup"><span data-stu-id="7692c-149">Remember to supply your own values for the Resource Manager deployment name and the resource group name:</span></span>

    $templatePath="PATH\azuredeploy.json"
    $parameterPath="PATH\azuredeploy.parameters.json"

    New-AzureRmResourceGroupDeployment -Name "CHANGEME" -ResourceGroupName "YOUR-RG-NAME-HERE" -TemplateFile $templatePath -TemplateParameterFile $parameterPath

<span data-ttu-id="7692c-150">La création de l’ASE prend environ une heure.</span><span class="sxs-lookup"><span data-stu-id="7692c-150">It takes about an hour for the ASE to be created.</span></span> <span data-ttu-id="7692c-151">Ensuite, l’ASE apparaît sur le portail dans la liste des ASE pour l’abonnement qui a déclenché le déploiement.</span><span class="sxs-lookup"><span data-stu-id="7692c-151">Then the ASE shows up in the portal in the list of ASEs for the subscription that triggered the deployment.</span></span>

## <a name="upload-and-configure-the-default-ssl-certificate"></a><span data-ttu-id="7692c-152">Charger et configurer le certificat SSL « par défaut »</span><span class="sxs-lookup"><span data-stu-id="7692c-152">Upload and configure the "default" SSL certificate</span></span>
<span data-ttu-id="7692c-153">Un certificat SSL doit être associé à l’ASE en tant que certificat SSL « par défaut » utilisé pour établir les connexions SSL aux applications.</span><span class="sxs-lookup"><span data-stu-id="7692c-153">An SSL certificate must be associated with the ASE as the "default" SSL certificate that's used to establish SSL connections to apps.</span></span> <span data-ttu-id="7692c-154">Si le suffixe DNS par défaut de l’ASE est *internal-contoso.com*, une connexion à https://some-random-app.internal-contoso.com nécessite un certificat SSL valide pour **.internal-contoso.com*.</span><span class="sxs-lookup"><span data-stu-id="7692c-154">If the ASE's default DNS suffix is *internal-contoso.com*, a connection to https://some-random-app.internal-contoso.com requires an SSL certificate that's valid for **.internal-contoso.com*.</span></span> 

<span data-ttu-id="7692c-155">Pour disposer d’un certificat SSL valide, vous pouvez recourir à des autorités de certification internes, acheter un certificat à un émetteur externe, ou utiliser un certificat auto-signé.</span><span class="sxs-lookup"><span data-stu-id="7692c-155">Obtain a valid SSL certificate by using internal certificate authorities, purchasing a certificate from an external issuer, or using a self-signed certificate.</span></span> <span data-ttu-id="7692c-156">Quelle que soit la source du certificat SSL, les attributs de certificat suivants doivent être configurés correctement :</span><span class="sxs-lookup"><span data-stu-id="7692c-156">Regardless of the source of the SSL certificate, the following certificate attributes must be configured properly:</span></span>

* <span data-ttu-id="7692c-157">**Objet** : cet attribut doit être défini sur **.votre-domaine-racine-ici.com*.</span><span class="sxs-lookup"><span data-stu-id="7692c-157">**Subject**: This attribute must be set to **.your-root-domain-here.com*.</span></span>
* <span data-ttu-id="7692c-158">**Autre nom de l’objet** : cet attribut doit inclure à la fois **.votre-domaine-racine-ici.com* et **.scm.votre-domaine-racine-ici.com*.</span><span class="sxs-lookup"><span data-stu-id="7692c-158">**Subject Alternative Name**: This attribute must include both **.your-root-domain-here.com* and **.scm.your-root-domain-here.com*.</span></span> <span data-ttu-id="7692c-159">Les connexions SSL au site SCM/Kudu associé à chaque application utilisent une adresse sous la forme *nom-de-votre-application.scm.votre-domaine-racine-ici.com*.</span><span class="sxs-lookup"><span data-stu-id="7692c-159">SSL connections to the SCM/Kudu site associated with each app use an address of the form *your-app-name.scm.your-root-domain-here.com*.</span></span>

<span data-ttu-id="7692c-160">Une fois le certificat SSL valide obtenu, deux étapes préparatoires supplémentaires sont nécessaires.</span><span class="sxs-lookup"><span data-stu-id="7692c-160">With a valid SSL certificate in hand, two additional preparatory steps are needed.</span></span> <span data-ttu-id="7692c-161">Convertissez/enregistrez le certificat SSL en tant que fichier de format .pfx.</span><span class="sxs-lookup"><span data-stu-id="7692c-161">Convert/save the SSL certificate as a .pfx file.</span></span> <span data-ttu-id="7692c-162">N’oubliez pas que le fichier .pfx doit inclure tous les certificats racines et intermédiaires.</span><span class="sxs-lookup"><span data-stu-id="7692c-162">Remember that the .pfx file must include all intermediate and root certificates.</span></span> <span data-ttu-id="7692c-163">Sécurisez-le avec un mot de passe.</span><span class="sxs-lookup"><span data-stu-id="7692c-163">Secure it with a password.</span></span>

<span data-ttu-id="7692c-164">Le fichier .pfx doit être converti en une chaîne au format base64, car le certificat SSL est chargé à l’aide d’un modèle Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="7692c-164">The .pfx file needs to be converted into a base64 string because the SSL certificate is uploaded by using a Resource Manager template.</span></span> <span data-ttu-id="7692c-165">Étant donné que les modèles Resource Manager sont des fichiers texte, le fichier .pfx doit être converti en chaîne base64.</span><span class="sxs-lookup"><span data-stu-id="7692c-165">Because Resource Manager templates are text files, the .pfx file must be converted into a base64 string.</span></span> <span data-ttu-id="7692c-166">Ainsi, il peut être inclus en tant que paramètre du modèle.</span><span class="sxs-lookup"><span data-stu-id="7692c-166">This way it can be included as a parameter of the template.</span></span>

<span data-ttu-id="7692c-167">Utilisez l’extrait de code PowerShell ci-dessous pour effectuer les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="7692c-167">Use the following PowerShell code snippet to:</span></span>

* <span data-ttu-id="7692c-168">générer un certificat auto-signé ;</span><span class="sxs-lookup"><span data-stu-id="7692c-168">Generate a self-signed certificate.</span></span>
* <span data-ttu-id="7692c-169">exporter le certificat dans un fichier .pfx ;</span><span class="sxs-lookup"><span data-stu-id="7692c-169">Export the certificate as a .pfx file.</span></span>
* <span data-ttu-id="7692c-170">convertir le fichier .pfx en une chaîne codée en base64 ;</span><span class="sxs-lookup"><span data-stu-id="7692c-170">Convert the .pfx file into a base64-encoded string.</span></span>
* <span data-ttu-id="7692c-171">enregistrer la chaîne codée en base64 dans un fichier distinct.</span><span class="sxs-lookup"><span data-stu-id="7692c-171">Save the base64-encoded string to a separate file.</span></span> 

<span data-ttu-id="7692c-172">Le code PowerShell pour l’encodage en base64 à été adapté à partir du [Blog relatif aux scripts PowerShell][examplebase64encoding]:</span><span class="sxs-lookup"><span data-stu-id="7692c-172">This PowerShell code for base64 encoding was adapted from the [PowerShell scripts blog][examplebase64encoding]:</span></span>

        $certificate = New-SelfSignedCertificate -certstorelocation cert:\localmachine\my -dnsname "*.internal-contoso.com","*.scm.internal-contoso.com"

        $certThumbprint = "cert:\localMachine\my\" + $certificate.Thumbprint
        $password = ConvertTo-SecureString -String "CHANGETHISPASSWORD" -Force -AsPlainText

        $fileName = "exportedcert.pfx"
        Export-PfxCertificate -cert $certThumbprint -FilePath $fileName -Password $password     

        $fileContentBytes = get-content -encoding byte $fileName
        $fileContentEncoded = [System.Convert]::ToBase64String($fileContentBytes)
        $fileContentEncoded | set-content ($fileName + ".b64")

<span data-ttu-id="7692c-173">Une fois le certificat SSL généré et converti en chaîne codée en base64, utilisez l’exemple de modèle Azure Resource Manager [Configurer le certificat SSL par défaut][quickstartconfiguressl] disponible sur GitHub.</span><span class="sxs-lookup"><span data-stu-id="7692c-173">After the SSL certificate is successfully generated and converted to a base64-encoded string, use the example Resource Manager template [Configure the default SSL certificate][quickstartconfiguressl] on GitHub.</span></span> 

<span data-ttu-id="7692c-174">Les paramètres figurant dans le fichier *azuredeploy.parameters.json* sont répertoriés ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="7692c-174">The parameters in the *azuredeploy.parameters.json* file are listed here:</span></span>

* <span data-ttu-id="7692c-175">*appServiceEnvironmentName*: nom de l’ILB ASE configuré.</span><span class="sxs-lookup"><span data-stu-id="7692c-175">*appServiceEnvironmentName*: The name of the ILB ASE being configured.</span></span>
* <span data-ttu-id="7692c-176">*existingAseLocation*: chaîne de texte contenant la région Azure où l’ILB ASE a été déployé.</span><span class="sxs-lookup"><span data-stu-id="7692c-176">*existingAseLocation*: Text string containing the Azure region where the ILB ASE was deployed.</span></span>  <span data-ttu-id="7692c-177">Par exemple : « Centre-Sud des États-Unis ».</span><span class="sxs-lookup"><span data-stu-id="7692c-177">For example: "South Central US".</span></span>
* <span data-ttu-id="7692c-178">*pfxBlobString*: représentation sous forme de chaîne codée en base64 du fichier .pfx.</span><span class="sxs-lookup"><span data-stu-id="7692c-178">*pfxBlobString*: The based64-encoded string representation of the .pfx file.</span></span> <span data-ttu-id="7692c-179">Utilisez l’extrait de code présenté précédemment, et copiez la chaîne contenue dans « exportedcert.pfx.b64 ».</span><span class="sxs-lookup"><span data-stu-id="7692c-179">Use the code snippet shown earlier and copy the string contained in "exportedcert.pfx.b64".</span></span> <span data-ttu-id="7692c-180">Collez celle-ci en tant que valeur de l’attribut *pfxBlobString*.</span><span class="sxs-lookup"><span data-stu-id="7692c-180">Paste it in as the value of the *pfxBlobString* attribute.</span></span>
* <span data-ttu-id="7692c-181">*password*: mot de passe utilisé pour sécuriser le fichier .pfx.</span><span class="sxs-lookup"><span data-stu-id="7692c-181">*password*: The password used to secure the .pfx file.</span></span>
* <span data-ttu-id="7692c-182">*certificateThumbprint*: empreinte numérique du certificat.</span><span class="sxs-lookup"><span data-stu-id="7692c-182">*certificateThumbprint*: The certificate's thumbprint.</span></span> <span data-ttu-id="7692c-183">Si vous récupérez cette valeur à partir de Powershell (par exemple, *$certificate.Thumbprint* dans l’extrait de code précédent), vous pouvez utiliser la valeur telle quelle.</span><span class="sxs-lookup"><span data-stu-id="7692c-183">If you retrieve this value from PowerShell (for example, *$certificate.Thumbprint* from the earlier code snippet), you can use the value as is.</span></span> <span data-ttu-id="7692c-184">Si vous copiez la valeur à partir de la boîte de dialogue du certificat Windows, n’oubliez pas de retirer les espaces superflus.</span><span class="sxs-lookup"><span data-stu-id="7692c-184">If you copy the value from the Windows certificate dialog box, remember to strip out the extraneous spaces.</span></span> <span data-ttu-id="7692c-185">La valeur *certificateThumbprint* doit se présenter sous la forme suivante : AF3143EB61D43F6727842115BB7F17BBCECAECAE.</span><span class="sxs-lookup"><span data-stu-id="7692c-185">The *certificateThumbprint* should look something like  AF3143EB61D43F6727842115BB7F17BBCECAECAE.</span></span>
* <span data-ttu-id="7692c-186">*certificateName*: identificateur de chaîne convivial de votre choix permettant d’identifier le certificat.</span><span class="sxs-lookup"><span data-stu-id="7692c-186">*certificateName*: A friendly string identifier of your own choosing used to identity the certificate.</span></span> <span data-ttu-id="7692c-187">Ce nom fait partie de l’identificateur Resource Manager unique pour l’entité *Microsoft.Web/certificates* qui représente le certificat SSL.</span><span class="sxs-lookup"><span data-stu-id="7692c-187">The name is used as part of the unique Resource Manager identifier for the *Microsoft.Web/certificates* entity that represents the SSL certificate.</span></span> <span data-ttu-id="7692c-188">Le nom *doit* se terminer par le suffixe suivant : \_nomdevotreASE_ÉquilibrageChareInterneASE.</span><span class="sxs-lookup"><span data-stu-id="7692c-188">The name *must* end with the following suffix: \_yourASENameHere_InternalLoadBalancingASE.</span></span> <span data-ttu-id="7692c-189">Le portail Azure utilise ce suffixe en tant qu’indicateur signalant que le certificat est utilisé pour sécuriser ASE avec ILB.</span><span class="sxs-lookup"><span data-stu-id="7692c-189">The Azure portal uses this suffix as an indicator that the certificate is used to secure an ILB-enabled ASE.</span></span>

<span data-ttu-id="7692c-190">Un exemple abrégé du fichier *azuredeploy.parameters.json* est présenté ici :</span><span class="sxs-lookup"><span data-stu-id="7692c-190">An abbreviated example of *azuredeploy.parameters.json* is shown here:</span></span>

    {
         "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentParameters.json",
         "contentVersion": "1.0.0.0",
         "parameters": {
              "appServiceEnvironmentName": {
                   "value": "yourASENameHere"
              },
              "existingAseLocation": {
                   "value": "East US 2"
              },
              "pfxBlobString": {
                   "value": "MIIKcAIBAz...snip...snip...pkCAgfQ"
              },
              "password": {
                   "value": "PASSWORDGOESHERE"
              },
              "certificateThumbprint": {
                   "value": "AF3143EB61D43F6727842115BB7F17BBCECAECAE"
              },
              "certificateName": {
                   "value": "DefaultCertificateFor_yourASENameHere_InternalLoadBalancingASE"
              }
         }
    }

<span data-ttu-id="7692c-191">Une fois le fichier *azuredeploy.parameters.json* complété, configurez le certificat SSL par défaut l’aide de l’extrait de code PowerShell.</span><span class="sxs-lookup"><span data-stu-id="7692c-191">After the *azuredeploy.parameters.json* file is filled in, configure the default SSL certificate by using the PowerShell code snippet.</span></span> <span data-ttu-id="7692c-192">Modifiez les chemins d’accès aux fichiers pour qu’ils correspondent aux emplacements où se trouvent les fichiers du modèle Azure Resource Manager sur votre ordinateur.</span><span class="sxs-lookup"><span data-stu-id="7692c-192">Change the file paths to match where the Resource Manager template files are located on your machine.</span></span> <span data-ttu-id="7692c-193">Songez à indiquer vos propres valeurs pour les noms de déploiement Resource Manager et de groupe de ressources :</span><span class="sxs-lookup"><span data-stu-id="7692c-193">Remember to supply your own values for the Resource Manager deployment name and the resource group name:</span></span>

     $templatePath="PATH\azuredeploy.json"
     $parameterPath="PATH\azuredeploy.parameters.json"

     New-AzureRmResourceGroupDeployment -Name "CHANGEME" -ResourceGroupName "YOUR-RG-NAME-HERE" -TemplateFile $templatePath -TemplateParameterFile $parameterPath

<span data-ttu-id="7692c-194">L’application de la modification prend environ 40 minutes par serveur frontal ASE.</span><span class="sxs-lookup"><span data-stu-id="7692c-194">It takes roughly 40 minutes per ASE front end to apply the change.</span></span> <span data-ttu-id="7692c-195">Par exemple, pour un ASE dimensionné par défaut utilisant deux serveurs frontaux, l’application du modèle prend environ une heure et vingt minutes.</span><span class="sxs-lookup"><span data-stu-id="7692c-195">For example, for a default-sized ASE that uses two front ends, the template takes around one hour and 20 minutes to complete.</span></span> <span data-ttu-id="7692c-196">Lorsque le modèle est en cours d’exécution, l’ASE ne peut pas mettre à l’échelle.</span><span class="sxs-lookup"><span data-stu-id="7692c-196">While the template is running, the ASE can't scale.</span></span>  

<span data-ttu-id="7692c-197">Une fois l’exécution du modèle terminé, les applications sur l’ILB ASE est accessible via le protocole HTTPS.</span><span class="sxs-lookup"><span data-stu-id="7692c-197">After the template finishes, apps on the ILB ASE can be accessed over HTTPS.</span></span> <span data-ttu-id="7692c-198">Les connexions sont sécurisées à l’aide du certificat SSL par défaut.</span><span class="sxs-lookup"><span data-stu-id="7692c-198">The connections are secured by using the default SSL certificate.</span></span> <span data-ttu-id="7692c-199">Le certificat SSL par défaut est utilisé lorsque des applications sur l’ASE ILB sont adressée à l’aide d’une combinaison de leur nom et du nom d’hôte par défaut.</span><span class="sxs-lookup"><span data-stu-id="7692c-199">The default SSL certificate is used when apps on the ILB ASE are addressed by using a combination of the application name plus the default host name.</span></span> <span data-ttu-id="7692c-200">Par exemple, *https://mycustomapp.internal-contoso.com* utilise le certificat SSL par défaut pour *.internal-contoso.com.</span><span class="sxs-lookup"><span data-stu-id="7692c-200">For example, https://mycustomapp.internal-contoso.com uses the default SSL certificate for **.internal-contoso.com*.</span></span>

<span data-ttu-id="7692c-201">Cependant, comme pour les applications qui s’exécutent sur le service mutualisé public, les développeurs peuvent configurer des noms d’hôtes personnalisés pour des applications individuelles.</span><span class="sxs-lookup"><span data-stu-id="7692c-201">However, just like apps that run on the public multitenant service, developers can configure custom host names for individual apps.</span></span> <span data-ttu-id="7692c-202">Ils peuvent également configurer des liaisons de certificat SNI SSL uniques pour différentes applications.</span><span class="sxs-lookup"><span data-stu-id="7692c-202">They also can configure unique SNI SSL certificate bindings for individual apps.</span></span>

## <a name="app-service-environment-v1"></a><span data-ttu-id="7692c-203">Environnement App Service v1</span><span class="sxs-lookup"><span data-stu-id="7692c-203">App Service Environment v1</span></span> ##
<span data-ttu-id="7692c-204">L’environnement App Service est disponible en deux versions : ASEv1 et ASEv2.</span><span class="sxs-lookup"><span data-stu-id="7692c-204">App Service Environment has two versions: ASEv1 and ASEv2.</span></span> <span data-ttu-id="7692c-205">Les informations précédentes sont basées sur ASEv2.</span><span class="sxs-lookup"><span data-stu-id="7692c-205">The preceding information was based on ASEv2.</span></span> <span data-ttu-id="7692c-206">Cette section montre les différences entre ASEv1 et ASEv2.</span><span class="sxs-lookup"><span data-stu-id="7692c-206">This section shows you the differences between ASEv1 and ASEv2.</span></span>

<span data-ttu-id="7692c-207">Dans ASEv1, vous gérez toutes les ressources manuellement.</span><span class="sxs-lookup"><span data-stu-id="7692c-207">In ASEv1, you manage all of the resources manually.</span></span> <span data-ttu-id="7692c-208">Celles-ci incluent les serveurs frontaux, les workers et les adresses IP utilisées pour le protocole SSL basé sur IP.</span><span class="sxs-lookup"><span data-stu-id="7692c-208">That includes the front ends, workers, and IP addresses used for IP-based SSL.</span></span> <span data-ttu-id="7692c-209">Pour pouvoir augmenter la taille des instances de votre plan App Service, vous devez commencer par augmenter la taille des instances du pool de workers dans lequel vous voulez héberger le plan.</span><span class="sxs-lookup"><span data-stu-id="7692c-209">Before you can scale out your App Service plan, you must scale out the worker pool that you want to host it.</span></span>

<span data-ttu-id="7692c-210">Les versions ASEv1 et ASEv2 utilisent un modèle de tarification différent.</span><span class="sxs-lookup"><span data-stu-id="7692c-210">ASEv1 uses a different pricing model from ASEv2.</span></span> <span data-ttu-id="7692c-211">Dans ASEv1, vous payez pour chaque cœur alloué.</span><span class="sxs-lookup"><span data-stu-id="7692c-211">In ASEv1, you pay for each core allocated.</span></span> <span data-ttu-id="7692c-212">Cela inclut les cœurs utilisés pour les serveurs frontaux ou les workers qui n’hébergent pas de charge de travail.</span><span class="sxs-lookup"><span data-stu-id="7692c-212">That includes cores that are used for front ends or workers that aren't hosting any workloads.</span></span> <span data-ttu-id="7692c-213">Dans la version ASEv1, la taille d’échelle maximale par défaut d’un environnement App Service correspond à un total de 55 hôtes,</span><span class="sxs-lookup"><span data-stu-id="7692c-213">In ASEv1, the default maximum-scale size of an ASE is 55 total hosts.</span></span> <span data-ttu-id="7692c-214">dont les workers et les frontends.</span><span class="sxs-lookup"><span data-stu-id="7692c-214">That includes workers and front ends.</span></span> <span data-ttu-id="7692c-215">L’un des avantages d’un ASEv1 est qu’il peut être déployé sur un réseau virtuel classique et sur un réseau virtuel Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="7692c-215">One advantage to ASEv1 is that it can be deployed in a classic virtual network and a Resource Manager virtual network.</span></span> <span data-ttu-id="7692c-216">Pour plus d’informations sur ASEv1, voir [Présentation d’App Service Environment v1][ASEv1Intro].</span><span class="sxs-lookup"><span data-stu-id="7692c-216">To learn more about ASEv1, see [App Service Environment v1 introduction][ASEv1Intro].</span></span>

<span data-ttu-id="7692c-217">Pour créer un ASEv1 à l’aide d’un modèle Resource Manager, voir [Comment créer un ILB ASE à l’aide des modèles Azure Resource Manager][ILBASEv1Template].</span><span class="sxs-lookup"><span data-stu-id="7692c-217">To create an ASEv1 by using a Resource Manager template, see [Create an ILB ASE v1 with a Resource Manager template][ILBASEv1Template].</span></span>


<!--Links-->
[quickstartilbasecreate]: http://azure.microsoft.com/documentation/templates/201-web-app-asev2-ilb-create
[quickstartasev2create]: http://azure.microsoft.com/documentation/templates/201-web-app-asev2-create
[quickstartconfiguressl]: http://azure.microsoft.com/documentation/templates/201-web-app-ase-ilb-configure-default-ssl
[quickstartwebapponasev2create]: http://azure.microsoft.com/documentation/templates/201-web-app-asp-app-on-asev2-create
[examplebase64encoding]: http://powershellscripts.blogspot.com/2007/02/base64-encode-file.html 
[configuringDefaultSSLCertificate]: https://azure.microsoft.com/documentation/templates/201-web-app-ase-ilb-configure-default-ssl/
[Intro]: ./intro.md
[MakeExternalASE]: ./create-external-ase.md
[MakeASEfromTemplate]: ./create-from-template.md
[MakeILBASE]: ./create-ilb-ase.md
[ASENetwork]: ./network-info.md
[ASEReadme]: ./readme.md
[UsingASE]: ./using-an-ase.md
[UDRs]: ../../virtual-network/virtual-networks-udr-overview.md
[NSGs]: ../../virtual-network/virtual-networks-nsg.md
[ConfigureASEv1]: ../../app-service-web/app-service-web-configure-an-app-service-environment.md
[ASEv1Intro]: ../../app-service-web/app-service-app-service-environment-intro.md
[webapps]: ../../app-service-web/app-service-web-overview.md
[mobileapps]: ../../app-service-mobile/app-service-mobile-value-prop.md
[APIapps]: ../../app-service-api/app-service-api-apps-why-best-platform.md
[Functions]: ../../azure-functions/index.yml
[Pricing]: http://azure.microsoft.com/pricing/details/app-service/
[ARMOverview]: ../../azure-resource-manager/resource-group-overview.md
[ConfigureSSL]: ../../app-service-web/web-sites-purchase-ssl-web-site.md
[Kudu]: http://azure.microsoft.com/resources/videos/super-secret-kudu-debug-console-for-azure-web-sites/
[AppDeploy]: ../../app-service-web/web-sites-deploy.md
[ASEWAF]: ../../app-service-web/app-service-app-service-environment-web-application-firewall.md
[AppGW]: ../../application-gateway/application-gateway-web-application-firewall-overview.md
[ILBASEv1Template]: ../../app-service-web/app-service-app-service-environment-create-ilb-ase-resourcemanager.md
