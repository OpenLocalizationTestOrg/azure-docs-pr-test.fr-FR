---
title: "Considérations relatives à l’aaaNetworking avec un environnement Azure App Service"
description: "Explique le trafic réseau de hello ASE et comment tooset UDRs avec votre ASE et les groupes de sécurité réseau"
services: app-service
documentationcenter: na
author: ccompy
manager: stefsch
ms.assetid: 955a4d84-94ca-418d-aa79-b57a5eb8cb85
ms.service: app-service
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/08/2017
ms.author: ccompy
ms.openlocfilehash: d4d3000f4d4d75814b1e6d47079d967334eb1a3b
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="networking-considerations-for-an-app-service-environment"></a><span data-ttu-id="bc290-103">Considérations relatives à la mise en réseau pour un environnement App Service</span><span class="sxs-lookup"><span data-stu-id="bc290-103">Networking considerations for an App Service environment</span></span> #

## <a name="overview"></a><span data-ttu-id="bc290-104">Vue d'ensemble</span><span class="sxs-lookup"><span data-stu-id="bc290-104">Overview</span></span> ##

 <span data-ttu-id="bc290-105">[App Service Environment Azure][Intro] est un déploiement d’Azure App Service dans un sous-réseau d’un réseau virtuel Azure (VNet).</span><span class="sxs-lookup"><span data-stu-id="bc290-105">Azure [App Service Environment][Intro] is a deployment of Azure App Service into a subnet in your Azure virtual network (VNet).</span></span> <span data-ttu-id="bc290-106">Il existe deux types de déploiement pour un environnement App Service (ASE) :</span><span class="sxs-lookup"><span data-stu-id="bc290-106">There are two deployment types for an App Service environment (ASE):</span></span>

- <span data-ttu-id="bc290-107">**ASE externe**: expose hello ASE hébergeant des applications sur une adresse IP accessible via internet.</span><span class="sxs-lookup"><span data-stu-id="bc290-107">**External ASE**: Exposes hello ASE-hosted apps on an internet-accessible IP address.</span></span> <span data-ttu-id="bc290-108">Pour plus d’informations, consultez [Créer un environnement App Service externe][MakeExternalASE].</span><span class="sxs-lookup"><span data-stu-id="bc290-108">For more information, see [Create an External ASE][MakeExternalASE].</span></span>
- <span data-ttu-id="bc290-109">**Équilibrage de charge interne ASE**: expose hello ASE hébergeant des applications sur une adresse IP à l’intérieur de votre réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="bc290-109">**ILB ASE**: Exposes hello ASE-hosted apps on an IP address inside your VNet.</span></span> <span data-ttu-id="bc290-110">point de terminaison interne Hello est un équilibreur de charge interne (ILB), c’est pourquoi il s’agit d’un environnement app service Équilibrage de charge interne.</span><span class="sxs-lookup"><span data-stu-id="bc290-110">hello internal endpoint is an internal load balancer (ILB), which is why it's called an ILB ASE.</span></span> <span data-ttu-id="bc290-111">Pour plus d’informations, consultez [Create and use an ILB ASE][MakeILBASE] (Créer et utiliser un ASE ILB).</span><span class="sxs-lookup"><span data-stu-id="bc290-111">For more information, see [Create and use an ILB ASE][MakeILBASE].</span></span>

<span data-ttu-id="bc290-112">Il existe deux versions de l’application App Service : ASEv1 et ASEv2.</span><span class="sxs-lookup"><span data-stu-id="bc290-112">There are now two versions of App Service Environment: ASEv1 and ASEv2.</span></span> <span data-ttu-id="bc290-113">Pour plus d’informations sur ASEv1, consultez [Introduction tooApp environnement Service v1][ASEv1Intro].</span><span class="sxs-lookup"><span data-stu-id="bc290-113">For information on ASEv1, see [Introduction tooApp Service Environment v1][ASEv1Intro].</span></span> <span data-ttu-id="bc290-114">Un ASEv1 peut être déployé dans un réseau virtuel classique ou Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="bc290-114">ASEv1 can be deployed in a classic or Resource Manager VNet.</span></span> <span data-ttu-id="bc290-115">Un ASEv2 peut uniquement être déployé dans un réseau virtuel Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="bc290-115">ASEv2 can only be deployed into a Resource Manager VNet.</span></span>

<span data-ttu-id="bc290-116">Tous les appels à partir d’un environnement app service qui vont toohello internet laisser hello réseau virtuel via une adresse IP virtuelle affectée pour hello ASE.</span><span class="sxs-lookup"><span data-stu-id="bc290-116">All calls from an ASE that go toohello internet leave hello VNet through a VIP assigned for hello ASE.</span></span> <span data-ttu-id="bc290-117">Hello adresse IP publique de cette adresse IP virtuelle est ensuite hello IP source pour tous les appels à partir de hello ASE qui vont toohello internet.</span><span class="sxs-lookup"><span data-stu-id="bc290-117">hello public IP of this VIP is then hello source IP for all calls from hello ASE that go toohello internet.</span></span> <span data-ttu-id="bc290-118">Si les applications hello dans votre ASE apportez tooresources d’appels dans votre réseau virtuel ou sur un réseau privé virtuel, hello IP source est un des hello des adresses IP de sous-réseau hello utilisé par votre ASE.</span><span class="sxs-lookup"><span data-stu-id="bc290-118">If hello apps in your ASE make calls tooresources in your VNet or across a VPN, hello source IP is one of hello IPs in hello subnet used by your ASE.</span></span> <span data-ttu-id="bc290-119">Hello ASE étant dans hello réseau virtuel, il peut également accéder aux ressources au sein de hello réseau virtuel sans aucune configuration supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="bc290-119">Because hello ASE is within hello VNet, it can also access resources within hello VNet without any additional configuration.</span></span> <span data-ttu-id="bc290-120">Si hello réseau virtuel est connecté tooyour local du réseau, les applications dans votre ASE ont également accès tooresources il.</span><span class="sxs-lookup"><span data-stu-id="bc290-120">If hello VNet is connected tooyour on-premises network, apps in your ASE also have access tooresources there.</span></span> <span data-ttu-id="bc290-121">Vous n’avez pas besoin tooconfigure hello ASE ou votre application tous les autres.</span><span class="sxs-lookup"><span data-stu-id="bc290-121">You don't need tooconfigure hello ASE or your app any further.</span></span>

![ASE externe][1] 

<span data-ttu-id="bc290-123">Si vous avez un environnement app service externe, adresse IP virtuelle publique de hello est également hello point de terminaison que vos applications ASE résoudre toofor :</span><span class="sxs-lookup"><span data-stu-id="bc290-123">If you have an External ASE, hello public VIP is also hello endpoint that your ASE apps resolve toofor:</span></span>

* <span data-ttu-id="bc290-124">HTTP/S.</span><span class="sxs-lookup"><span data-stu-id="bc290-124">HTTP/S.</span></span> 
* <span data-ttu-id="bc290-125">FTP/S.</span><span class="sxs-lookup"><span data-stu-id="bc290-125">FTP/S.</span></span> 
* <span data-ttu-id="bc290-126">Déploiement Web.</span><span class="sxs-lookup"><span data-stu-id="bc290-126">Web deployment.</span></span>
* <span data-ttu-id="bc290-127">Débogage à distance.</span><span class="sxs-lookup"><span data-stu-id="bc290-127">Remote debugging.</span></span>

![ASE ILB][2]

<span data-ttu-id="bc290-129">Si vous avez un environnement app service Équilibrage de charge interne, adresse IP hello hello équilibrage de charge interne est hello de point de terminaison pour HTTP/S, FTP/S, le déploiement web et le débogage distant.</span><span class="sxs-lookup"><span data-stu-id="bc290-129">If you have an ILB ASE, hello IP address of hello ILB is hello endpoint for HTTP/S, FTP/S, web deployment, and remote debugging.</span></span>

<span data-ttu-id="bc290-130">ports d’accès application normal Hello sont :</span><span class="sxs-lookup"><span data-stu-id="bc290-130">hello normal app access ports are:</span></span>

| <span data-ttu-id="bc290-131">Utilisation</span><span class="sxs-lookup"><span data-stu-id="bc290-131">Use</span></span> | <span data-ttu-id="bc290-132">À partir</span><span class="sxs-lookup"><span data-stu-id="bc290-132">From</span></span> | <span data-ttu-id="bc290-133">trop</span><span class="sxs-lookup"><span data-stu-id="bc290-133">too</span></span>|
|----------|---------|-------------|
|  <span data-ttu-id="bc290-134">HTTP/HTTPS</span><span class="sxs-lookup"><span data-stu-id="bc290-134">HTTP/HTTPS</span></span>  | <span data-ttu-id="bc290-135">Configurable par l’utilisateur</span><span class="sxs-lookup"><span data-stu-id="bc290-135">User configurable</span></span> |  <span data-ttu-id="bc290-136">80, 443</span><span class="sxs-lookup"><span data-stu-id="bc290-136">80, 443</span></span> |
|  <span data-ttu-id="bc290-137">FTP/FTPS</span><span class="sxs-lookup"><span data-stu-id="bc290-137">FTP/FTPS</span></span>    | <span data-ttu-id="bc290-138">Configurable par l’utilisateur</span><span class="sxs-lookup"><span data-stu-id="bc290-138">User configurable</span></span> |  <span data-ttu-id="bc290-139">21, 990, 10001-10020</span><span class="sxs-lookup"><span data-stu-id="bc290-139">21, 990, 10001-10020</span></span> |
|  <span data-ttu-id="bc290-140">Débogage distant de Visual Studio</span><span class="sxs-lookup"><span data-stu-id="bc290-140">Visual Studio remote debugging</span></span>  |  <span data-ttu-id="bc290-141">Configurable par l’utilisateur</span><span class="sxs-lookup"><span data-stu-id="bc290-141">User configurable</span></span> |  <span data-ttu-id="bc290-142">4016, 4018, 4020, 4022</span><span class="sxs-lookup"><span data-stu-id="bc290-142">4016, 4018, 4020, 4022</span></span> |

<span data-ttu-id="bc290-143">Ces ports s’appliquent aussi bien pour un ASE externe que pour un ASE ILB.</span><span class="sxs-lookup"><span data-stu-id="bc290-143">This is true if you're on an External ASE or on an ILB ASE.</span></span> <span data-ttu-id="bc290-144">Si vous êtes dans un environnement app service externe, vous appuyer sur ces ports sur l’adresse IP virtuelle publique de hello.</span><span class="sxs-lookup"><span data-stu-id="bc290-144">If you're on an External ASE, you hit those ports on hello public VIP.</span></span> <span data-ttu-id="bc290-145">Si vous êtes dans un environnement app service Équilibrage de charge interne, vous appuyer sur ces ports sur hello équilibrage de charge interne.</span><span class="sxs-lookup"><span data-stu-id="bc290-145">If you're on an ILB ASE, you hit those ports on hello ILB.</span></span> <span data-ttu-id="bc290-146">Si vous verrouillez le port 443, il peut y avoir une incidence sur certaines fonctionnalités exposées dans le portail de hello.</span><span class="sxs-lookup"><span data-stu-id="bc290-146">If you lock down port 443, there can be an effect on some features exposed in hello portal.</span></span> <span data-ttu-id="bc290-147">Pour plus d’informations, consultez la section [Dépendances du portail](#portaldep).</span><span class="sxs-lookup"><span data-stu-id="bc290-147">For more information, see [Portal dependencies](#portaldep).</span></span>

## <a name="ase-dependencies"></a><span data-ttu-id="bc290-148">Dépendances d’un ASE</span><span class="sxs-lookup"><span data-stu-id="bc290-148">ASE dependencies</span></span> ##

<span data-ttu-id="bc290-149">Un ASE présente la dépendance d’accès entrant suivante :</span><span class="sxs-lookup"><span data-stu-id="bc290-149">An ASE inbound access dependency is:</span></span>

| <span data-ttu-id="bc290-150">Utilisation</span><span class="sxs-lookup"><span data-stu-id="bc290-150">Use</span></span> | <span data-ttu-id="bc290-151">À partir</span><span class="sxs-lookup"><span data-stu-id="bc290-151">From</span></span> | <span data-ttu-id="bc290-152">trop</span><span class="sxs-lookup"><span data-stu-id="bc290-152">too</span></span>|
|-----|------|----|
| <span data-ttu-id="bc290-153">Gestion</span><span class="sxs-lookup"><span data-stu-id="bc290-153">Management</span></span> | <span data-ttu-id="bc290-154">Adresses de gestion App Service</span><span class="sxs-lookup"><span data-stu-id="bc290-154">App Service management addresses</span></span> | <span data-ttu-id="bc290-155">Sous-réseau de l’ASE : 454, 455</span><span class="sxs-lookup"><span data-stu-id="bc290-155">ASE subnet: 454, 455</span></span> |
|  <span data-ttu-id="bc290-156">Communications internes de l’ASE</span><span class="sxs-lookup"><span data-stu-id="bc290-156">ASE internal communication</span></span> | <span data-ttu-id="bc290-157">Sous-réseau de l’ASE : tous les ports</span><span class="sxs-lookup"><span data-stu-id="bc290-157">ASE subnet: All ports</span></span> | <span data-ttu-id="bc290-158">Sous-réseau de l’ASE : tous les ports</span><span class="sxs-lookup"><span data-stu-id="bc290-158">ASE subnet: All ports</span></span>
|  <span data-ttu-id="bc290-159">Autoriser le trafic entrant provenant d’Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="bc290-159">Allow Azure load balancer inbound</span></span> | <span data-ttu-id="bc290-160">Équilibrage de charge Azure</span><span class="sxs-lookup"><span data-stu-id="bc290-160">Azure load balancer</span></span> | <span data-ttu-id="bc290-161">Sous-réseau de l’ASE : tous les ports</span><span class="sxs-lookup"><span data-stu-id="bc290-161">ASE subnet: All ports</span></span>
|  <span data-ttu-id="bc290-162">Adresses IP affectées par l’application</span><span class="sxs-lookup"><span data-stu-id="bc290-162">App assigned IP addresses</span></span> | <span data-ttu-id="bc290-163">Adresses affectées par l’application</span><span class="sxs-lookup"><span data-stu-id="bc290-163">App assigned addresses</span></span> | <span data-ttu-id="bc290-164">Sous-réseau de l’ASE : tous les ports</span><span class="sxs-lookup"><span data-stu-id="bc290-164">ASE subnet: All ports</span></span>

<span data-ttu-id="bc290-165">Hello le trafic entrant fournit commande et contrôle de ASE hello dans l’analyse des toosystem d’addition.</span><span class="sxs-lookup"><span data-stu-id="bc290-165">hello inbound traffic provides command and control of hello ASE in addition toosystem monitoring.</span></span> <span data-ttu-id="bc290-166">source de Hello des adresses IP pour ce trafic sont répertoriées dans hello [ASE gestion des adresses] [ ASEManagement] document.</span><span class="sxs-lookup"><span data-stu-id="bc290-166">hello source IPs for this traffic are listed in hello [ASE Management addresses][ASEManagement] document.</span></span> <span data-ttu-id="bc290-167">configuration de la sécurité réseau Hello doit tooallow l’accès à partir de toutes les adresses IP sur les ports 454 et 455.</span><span class="sxs-lookup"><span data-stu-id="bc290-167">hello network security configuration needs tooallow access from all IPs on ports 454 and 455.</span></span>

<span data-ttu-id="bc290-168">Au sein du sous-réseau hello ASE sont grand nombre de ports utilisés pour la communication de composant interne et elles peuvent changer.</span><span class="sxs-lookup"><span data-stu-id="bc290-168">Within hello ASE subnet there are many ports used for internal component communication and they can change.</span></span>  <span data-ttu-id="bc290-169">Cela nécessite tous les ports hello dans hello ASE sous-réseau toobe accessible à partir du sous-réseau de ASE hello.</span><span class="sxs-lookup"><span data-stu-id="bc290-169">This requires all of hello ports in hello ASE subnet toobe accessible from hello ASE subnet.</span></span> 

<span data-ttu-id="bc290-170">Pour la communication hello entre l’équilibrage de charge Azure hello et hello ASE hello minimale les ports du sous-réseau que toobe besoin ouvert sont 454 et 455 de 16001.</span><span class="sxs-lookup"><span data-stu-id="bc290-170">For hello communication between hello Azure load balancer and hello ASE subnet hello minimum ports that need toobe open are 454, 455 and 16001.</span></span> <span data-ttu-id="bc290-171">port de 16001 Hello est utilisé pour conserver le trafic actif entre l’équilibrage de charge hello et hello ASE.</span><span class="sxs-lookup"><span data-stu-id="bc290-171">hello 16001 port is used for keep alive traffic between hello load balancer and hello ASE.</span></span> <span data-ttu-id="bc290-172">Si vous utilisez un environnement app service Équilibrage de charge interne vous pouvez verrouiller le trafic vers le bas toojust hello 454, 455, 16001 ports.</span><span class="sxs-lookup"><span data-stu-id="bc290-172">If you are using an ILB ASE then you can lock traffic down toojust hello 454, 455, 16001 ports.</span></span>  <span data-ttu-id="bc290-173">Si vous utilisez un environnement app service externe vous devez tootake dans les ports d’accès de compte hello application normal.</span><span class="sxs-lookup"><span data-stu-id="bc290-173">If you are using an External ASE then you need tootake into account hello normal app access ports.</span></span>  <span data-ttu-id="bc290-174">Si vous utilisez des adresses d’application affectée vous devez tooopen il tooall ports.</span><span class="sxs-lookup"><span data-stu-id="bc290-174">If you are using app assigned addresses you need tooopen it tooall ports.</span></span>  <span data-ttu-id="bc290-175">Lorsqu’une adresse est assignée application spécifique de tooa, équilibrage de charge hello utilisera les ports qui ne sont pas connus d’avance toosend HTTP et HTTPS traffic toohello ASE.</span><span class="sxs-lookup"><span data-stu-id="bc290-175">When an address is assigned tooa specific app, then hello load balancer will use ports that are not known of in advance toosend HTTP and HTTPS traffic toohello ASE.</span></span>

<span data-ttu-id="bc290-176">Si vous utilisez des adresses IP application affectée, vous devez tooallow trafic hello que des adresses IP affectées sous-réseau de ASE toohello tooyour applications.</span><span class="sxs-lookup"><span data-stu-id="bc290-176">If you are using app assigned IP addresses you need tooallow traffic from hello IPs assigned tooyour apps toohello ASE subnet.</span></span>

<span data-ttu-id="bc290-177">Pour l’accès sortant, un ASE dépend de plusieurs systèmes externes.</span><span class="sxs-lookup"><span data-stu-id="bc290-177">For outbound access, an ASE depends on multiple external systems.</span></span> <span data-ttu-id="bc290-178">Ces dépendances système sont définis avec des noms DNS et ne sont pas tooa ensemble fixé d’adresses IP.</span><span class="sxs-lookup"><span data-stu-id="bc290-178">Those system dependencies are defined with DNS names and don't map tooa fixed set of IP addresses.</span></span> <span data-ttu-id="bc290-179">Par conséquent, hello ASE requiert un accès sortant à partir de hello ASE sous-réseau tooall des adresses IP externes dans une gamme de ports.</span><span class="sxs-lookup"><span data-stu-id="bc290-179">Thus, hello ASE requires outbound access from hello ASE subnet tooall external IPs across a variety of ports.</span></span> <span data-ttu-id="bc290-180">Un environnement app service a hello suivant dépendances sortantes :</span><span class="sxs-lookup"><span data-stu-id="bc290-180">An ASE has hello following outbound dependencies:</span></span>

| <span data-ttu-id="bc290-181">Utilisation</span><span class="sxs-lookup"><span data-stu-id="bc290-181">Use</span></span> | <span data-ttu-id="bc290-182">À partir</span><span class="sxs-lookup"><span data-stu-id="bc290-182">From</span></span> | <span data-ttu-id="bc290-183">trop</span><span class="sxs-lookup"><span data-stu-id="bc290-183">too</span></span>|
|-----|------|----|
| <span data-ttu-id="bc290-184">Azure Storage</span><span class="sxs-lookup"><span data-stu-id="bc290-184">Azure Storage</span></span> | <span data-ttu-id="bc290-185">Sous-réseau de l’ASE</span><span class="sxs-lookup"><span data-stu-id="bc290-185">ASE subnet</span></span> | <span data-ttu-id="bc290-186">table.core.windows.net, blob.core.windows.net, queue.core.windows.net, file.core.windows.net : 80, 443, 445 (le port 445 est requis uniquement pour ASEv1)</span><span class="sxs-lookup"><span data-stu-id="bc290-186">table.core.windows.net, blob.core.windows.net, queue.core.windows.net, file.core.windows.net: 80, 443, 445 (445 is only needed for ASEv1.)</span></span> |
| <span data-ttu-id="bc290-187">Azure SQL Database</span><span class="sxs-lookup"><span data-stu-id="bc290-187">Azure SQL Database</span></span> | <span data-ttu-id="bc290-188">Sous-réseau de l’ASE</span><span class="sxs-lookup"><span data-stu-id="bc290-188">ASE subnet</span></span> | <span data-ttu-id="bc290-189">database.windows.net : 1433, 11000-11999, 14000-14999 (pour plus d’informations, consultez [Port utilisé par SQL Database V12](../../sql-database/sql-database-develop-direct-route-ports-adonet-v12.md).)</span><span class="sxs-lookup"><span data-stu-id="bc290-189">database.windows.net: 1433, 11000-11999, 14000-14999 (For more information, see [SQL Database V12 port usage](../../sql-database/sql-database-develop-direct-route-ports-adonet-v12.md).)</span></span>|
| <span data-ttu-id="bc290-190">Gestion d’Azure</span><span class="sxs-lookup"><span data-stu-id="bc290-190">Azure management</span></span> | <span data-ttu-id="bc290-191">Sous-réseau de l’ASE</span><span class="sxs-lookup"><span data-stu-id="bc290-191">ASE subnet</span></span> | <span data-ttu-id="bc290-192">management.core.windows.net, management.azure.com : 443</span><span class="sxs-lookup"><span data-stu-id="bc290-192">management.core.windows.net, management.azure.com: 443</span></span> 
| <span data-ttu-id="bc290-193">Vérification du certificat SSL</span><span class="sxs-lookup"><span data-stu-id="bc290-193">SSL certificate verification</span></span> |  <span data-ttu-id="bc290-194">Sous-réseau de l’ASE</span><span class="sxs-lookup"><span data-stu-id="bc290-194">ASE subnet</span></span>            |  <span data-ttu-id="bc290-195">ocsp.msocsp.com, mscrl.microsoft.com, crl.microsoft.com : 443</span><span class="sxs-lookup"><span data-stu-id="bc290-195">ocsp.msocsp.com, mscrl.microsoft.com, crl.microsoft.com: 443</span></span>
| <span data-ttu-id="bc290-196">Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="bc290-196">Azure Active Directory</span></span>        | <span data-ttu-id="bc290-197">Sous-réseau de l’ASE</span><span class="sxs-lookup"><span data-stu-id="bc290-197">ASE subnet</span></span>            |  <span data-ttu-id="bc290-198">Internet : 443</span><span class="sxs-lookup"><span data-stu-id="bc290-198">Internet: 443</span></span>
| <span data-ttu-id="bc290-199">Gestion d’App Service</span><span class="sxs-lookup"><span data-stu-id="bc290-199">App Service management</span></span>        | <span data-ttu-id="bc290-200">Sous-réseau de l’ASE</span><span class="sxs-lookup"><span data-stu-id="bc290-200">ASE subnet</span></span>            |  <span data-ttu-id="bc290-201">Internet : 443</span><span class="sxs-lookup"><span data-stu-id="bc290-201">Internet: 443</span></span>
| <span data-ttu-id="bc290-202">DNS Azure</span><span class="sxs-lookup"><span data-stu-id="bc290-202">Azure DNS</span></span>                     | <span data-ttu-id="bc290-203">Sous-réseau de l’ASE</span><span class="sxs-lookup"><span data-stu-id="bc290-203">ASE subnet</span></span>            |  <span data-ttu-id="bc290-204">Internet : 53</span><span class="sxs-lookup"><span data-stu-id="bc290-204">Internet: 53</span></span>
| <span data-ttu-id="bc290-205">Communications internes de l’ASE</span><span class="sxs-lookup"><span data-stu-id="bc290-205">ASE internal communication</span></span>    | <span data-ttu-id="bc290-206">Sous-réseau de l’ASE : tous les ports</span><span class="sxs-lookup"><span data-stu-id="bc290-206">ASE subnet: All ports</span></span> |  <span data-ttu-id="bc290-207">Sous-réseau de l’ASE : tous les ports</span><span class="sxs-lookup"><span data-stu-id="bc290-207">ASE subnet: All ports</span></span>

<span data-ttu-id="bc290-208">Si hello ASE perd l’accès des dépendances de toothese, il cesse de fonctionner.</span><span class="sxs-lookup"><span data-stu-id="bc290-208">If hello ASE loses access toothese dependencies, it stops working.</span></span> <span data-ttu-id="bc290-209">Lorsque cela produit long suffisamment, hello ASE est suspendue.</span><span class="sxs-lookup"><span data-stu-id="bc290-209">When that happens long enough, hello ASE is suspended.</span></span>

### <a name="customer-dns"></a><span data-ttu-id="bc290-210">DNS client</span><span class="sxs-lookup"><span data-stu-id="bc290-210">Customer DNS</span></span> ###

<span data-ttu-id="bc290-211">Si hello réseau virtuel est configuré avec un serveur DNS défini par le client, les charges de travail clientes hello l’utiliser.</span><span class="sxs-lookup"><span data-stu-id="bc290-211">If hello VNet is configured with a customer-defined DNS server, hello tenant workloads use it.</span></span> <span data-ttu-id="bc290-212">Hello ASE doit toujours toocommunicate avec Azure DNS à des fins de gestion.</span><span class="sxs-lookup"><span data-stu-id="bc290-212">hello ASE still needs toocommunicate with Azure DNS for management purposes.</span></span> 

<span data-ttu-id="bc290-213">Si hello réseau virtuel est configuré avec un client DNS sur hello autre côté d’un réseau VPN, serveur DNS de hello doit être accessible à partir du sous-réseau hello contenant hello ASE.</span><span class="sxs-lookup"><span data-stu-id="bc290-213">If hello VNet is configured with a customer DNS on hello other side of a VPN, hello DNS server must be reachable from hello subnet that contains hello ASE.</span></span>

<a name="portaldep"></a>

## <a name="portal-dependencies"></a><span data-ttu-id="bc290-214">Dépendances du portail</span><span class="sxs-lookup"><span data-stu-id="bc290-214">Portal dependencies</span></span> ##

<span data-ttu-id="bc290-215">Dans dépendances fonctionnelles toohello ASE de plus, il existe quelques éléments supplémentaires associées toohello portail expérience.</span><span class="sxs-lookup"><span data-stu-id="bc290-215">In addition toohello ASE functional dependencies, there are a few extra items related toohello portal experience.</span></span> <span data-ttu-id="bc290-216">Certaines des fonctionnalités hello Bonjour portail Azure dépendent site_ de too_SCM un accès direct.</span><span class="sxs-lookup"><span data-stu-id="bc290-216">Some of hello capabilities in hello Azure portal depend on direct access too_SCM site_.</span></span> <span data-ttu-id="bc290-217">Pour chaque application dans Azure App Service, il existe deux URL.</span><span class="sxs-lookup"><span data-stu-id="bc290-217">For every app in Azure App Service, there are two URLs.</span></span> <span data-ttu-id="bc290-218">Hello première URL est tooaccess votre application.</span><span class="sxs-lookup"><span data-stu-id="bc290-218">hello first URL is tooaccess your app.</span></span> <span data-ttu-id="bc290-219">URL du deuxième Hello est tooaccess hello SCM site, ce qui est également appelé hello _console de Kudu_.</span><span class="sxs-lookup"><span data-stu-id="bc290-219">hello second URL is tooaccess hello SCM site, which is also called hello _Kudu console_.</span></span> <span data-ttu-id="bc290-220">Les fonctionnalités qui utilisent le site SCM hello :</span><span class="sxs-lookup"><span data-stu-id="bc290-220">Features that use hello SCM site include:</span></span>

-   <span data-ttu-id="bc290-221">Tâches web</span><span class="sxs-lookup"><span data-stu-id="bc290-221">Web jobs</span></span>
-   <span data-ttu-id="bc290-222">Fonctions</span><span class="sxs-lookup"><span data-stu-id="bc290-222">Functions</span></span>
-   <span data-ttu-id="bc290-223">Diffusion de journaux</span><span class="sxs-lookup"><span data-stu-id="bc290-223">Log streaming</span></span>
-   <span data-ttu-id="bc290-224">Kudu</span><span class="sxs-lookup"><span data-stu-id="bc290-224">Kudu</span></span>
-   <span data-ttu-id="bc290-225">Extensions</span><span class="sxs-lookup"><span data-stu-id="bc290-225">Extensions</span></span>
-   <span data-ttu-id="bc290-226">Process Explorer</span><span class="sxs-lookup"><span data-stu-id="bc290-226">Process Explorer</span></span>
-   <span data-ttu-id="bc290-227">Console</span><span class="sxs-lookup"><span data-stu-id="bc290-227">Console</span></span>

<span data-ttu-id="bc290-228">Lorsque vous utilisez un environnement app service Équilibrage de charge interne, site SCM hello n’est pas accessible depuis l’extérieur hello réseau virtuel d’internet.</span><span class="sxs-lookup"><span data-stu-id="bc290-228">When you use an ILB ASE, hello SCM site isn't internet accessible from outside hello VNet.</span></span> <span data-ttu-id="bc290-229">Lorsque votre application est hébergée sur un environnement app service Équilibrage de charge interne, certaines fonctionnalités ne fonctionneront pas à partir du portail de hello.</span><span class="sxs-lookup"><span data-stu-id="bc290-229">When your app is hosted on an ILB ASE, some capabilities will not work from hello portal.</span></span>  

<span data-ttu-id="bc290-230">La plupart de ces fonctions qui varient en fonction du site SCM hello sont également disponibles directement dans la console de Kudu hello.</span><span class="sxs-lookup"><span data-stu-id="bc290-230">Many of those capabilities that depend upon hello SCM site are also available directly in hello Kudu console.</span></span> <span data-ttu-id="bc290-231">Vous pouvez vous connecter tooit directement, plutôt qu’en utilisant le portail de hello.</span><span class="sxs-lookup"><span data-stu-id="bc290-231">You can connect tooit directly rather than by using hello portal.</span></span> <span data-ttu-id="bc290-232">Si votre application est hébergée dans un environnement app service Équilibrage de charge interne, utilisez votre publication toosign d’informations d’identification dans.</span><span class="sxs-lookup"><span data-stu-id="bc290-232">If your app is hosted in an ILB ASE, use your publishing credentials toosign in.</span></span> <span data-ttu-id="bc290-233">Hello URL tooaccess hello SCM site d’une application hébergée dans un environnement app service Équilibrage de charge interne a hello suivant le format :</span><span class="sxs-lookup"><span data-stu-id="bc290-233">hello URL tooaccess hello SCM site of an app hosted in an ILB ASE has hello following format:</span></span> 

```
<appname>.scm.<domain name hello ILB ASE was created with> 
```

<span data-ttu-id="bc290-234">Si votre ASE d’équilibrage de charge interne est le nom de domaine hello *contoso.net* et le nom de votre application est *testapp*, application hello est atteinte au *testapp.contoso.net*.</span><span class="sxs-lookup"><span data-stu-id="bc290-234">If your ILB ASE is hello domain name *contoso.net* and your app name is *testapp*, hello app is reached at *testapp.contoso.net*.</span></span> <span data-ttu-id="bc290-235">site SCM Hello qui le suit est atteinte au *testapp.scm.contoso.net*.</span><span class="sxs-lookup"><span data-stu-id="bc290-235">hello SCM site that goes with it is reached at *testapp.scm.contoso.net*.</span></span>

### <a name="functions-and-web-jobs"></a><span data-ttu-id="bc290-236">Fonctions et tâches web</span><span class="sxs-lookup"><span data-stu-id="bc290-236">Functions and Web jobs</span></span> ###

<span data-ttu-id="bc290-237">Les fonctions et Web travaux dépendent de hello SCM site mais sont prises en charge pour une utilisation dans le portail de hello, même si vos applications sont dans un environnement app service Équilibrage de charge interne, tant que votre navigateur peut atteindre le site SCM hello.</span><span class="sxs-lookup"><span data-stu-id="bc290-237">Both Functions and Web jobs depend on hello SCM site but are supported for use in hello portal, even if your apps are in an ILB ASE, so long as your browser can reach hello SCM site.</span></span>  <span data-ttu-id="bc290-238">Si vous utilisez un certificat auto-signé avec votre ASE d’équilibrage de charge interne, vous devez tooenable votre tootrust de navigateur de certificat.</span><span class="sxs-lookup"><span data-stu-id="bc290-238">If you are using a self-signed certificate with your ILB ASE, you will need tooenable your browser tootrust that certificate.</span></span>  <span data-ttu-id="bc290-239">Pour Internet Explorer ou Edge qui signifie que le certificat de hello a toobe en mode de confiance ordinateur hello stocker.</span><span class="sxs-lookup"><span data-stu-id="bc290-239">For IE and Edge that means hello certificate has toobe in hello computer trust store.</span></span>  <span data-ttu-id="bc290-240">Si vous utilisez Chrome qui signifie que vous avez accepté certificat hello dans le navigateur de hello précédemment en vraisemblablement appuyant directement sur site de scm hello.</span><span class="sxs-lookup"><span data-stu-id="bc290-240">If you are using Chrome then that means you accepted hello certificate in hello browser earlier by presumably hitting hello scm site directly.</span></span>  <span data-ttu-id="bc290-241">Hello meilleure solution consiste toouse un certificat commercial qui se trouve dans la chaîne du navigateur hello d’approbation.</span><span class="sxs-lookup"><span data-stu-id="bc290-241">hello best solution is toouse a commercial certificate that is in hello browser chain of trust.</span></span>  

## <a name="ase-ip-addresses"></a><span data-ttu-id="bc290-242">Adresses IP d’un ASE</span><span class="sxs-lookup"><span data-stu-id="bc290-242">ASE IP addresses</span></span> ##

<span data-ttu-id="bc290-243">Un environnement app service a quelques toobe adresses IP prenant en charge de.</span><span class="sxs-lookup"><span data-stu-id="bc290-243">An ASE has a few IP addresses toobe aware of.</span></span> <span data-ttu-id="bc290-244">Il s'agit de :</span><span class="sxs-lookup"><span data-stu-id="bc290-244">They are:</span></span>

- <span data-ttu-id="bc290-245">**Adresse IP entrante publique** : utilisée pour le trafic d’applications dans un ASE externe et pour le trafic de gestion aussi bien dans un ASE externe que dans un ASE ILB.</span><span class="sxs-lookup"><span data-stu-id="bc290-245">**Public inbound IP address**: Used for app traffic in an External ASE, and management traffic in both an External ASE and an ILB ASE.</span></span>
- <span data-ttu-id="bc290-246">**Adresse IP publique sortant**: utilisé comme hello IP « de » pour les connexions sortantes à partir de hello ASE que hello laissez réseau virtuel, qui ne sont pas routé vers un réseau privé virtuel.</span><span class="sxs-lookup"><span data-stu-id="bc290-246">**Outbound public IP**: Used as hello "from" IP for outbound connections from hello ASE that leave hello VNet, which aren't routed down a VPN.</span></span>
- <span data-ttu-id="bc290-247">**Adresse IP ILB** : si vous utilisez un ASE ILB.</span><span class="sxs-lookup"><span data-stu-id="bc290-247">**ILB IP address**: If you use an ILB ASE.</span></span>
- <span data-ttu-id="bc290-248">**Adresse SSL basée sur IP attribuée par l’application** : uniquement possibles avec un ASE externe et lorsque le mode SSL basé sur IP est configuré.</span><span class="sxs-lookup"><span data-stu-id="bc290-248">**App-assigned IP-based SSL addresses**: Only possible with an External ASE and when IP-based SSL is configured.</span></span>

<span data-ttu-id="bc290-249">Toutes ces adresses IP sont facilement visibles dans un ASEv2 Bonjour portail Azure à partir de hello ASE UI.</span><span class="sxs-lookup"><span data-stu-id="bc290-249">All these IP addresses are easily visible in an ASEv2 in hello Azure portal from hello ASE UI.</span></span> <span data-ttu-id="bc290-250">Si vous avez un environnement app service Équilibrage de charge interne, IP hello pour hello équilibrage de charge interne est répertorié.</span><span class="sxs-lookup"><span data-stu-id="bc290-250">If you have an ILB ASE, hello IP for hello ILB is listed.</span></span>

![Adresses IP][3]

### <a name="app-assigned-ip-addresses"></a><span data-ttu-id="bc290-252">Adresses IP attribuées par l’application</span><span class="sxs-lookup"><span data-stu-id="bc290-252">App-assigned IP addresses</span></span> ###

<span data-ttu-id="bc290-253">Avec un environnement app service externe, vous pouvez affecter des adresses IP tooindividual applications.</span><span class="sxs-lookup"><span data-stu-id="bc290-253">With an External ASE, you can assign IP addresses tooindividual apps.</span></span> <span data-ttu-id="bc290-254">Ce n’est pas possible avec un ASE ILB.</span><span class="sxs-lookup"><span data-stu-id="bc290-254">You can't do that with an ILB ASE.</span></span> <span data-ttu-id="bc290-255">Pour plus d’informations sur la façon de tooconfigure toohave de votre application sa propre adresse IP, consultez [lier un existant SSL certificat tooAzure web applications personnalisées](../../app-service-web/app-service-web-tutorial-custom-ssl.md).</span><span class="sxs-lookup"><span data-stu-id="bc290-255">For more information on how tooconfigure your app toohave its own IP address, see [Bind an existing custom SSL certificate tooAzure web apps](../../app-service-web/app-service-web-tutorial-custom-ssl.md).</span></span>

<span data-ttu-id="bc290-256">Lorsqu’une application possède sa propre adresse SSL basé sur IP, hello ASE réserve adresse IP de deux ports toomap toothat.</span><span class="sxs-lookup"><span data-stu-id="bc290-256">When an app has its own IP-based SSL address, hello ASE reserves two ports toomap toothat IP address.</span></span> <span data-ttu-id="bc290-257">Un port pour le trafic HTTP, et hello autre port est pour le protocole HTTPS.</span><span class="sxs-lookup"><span data-stu-id="bc290-257">One port is for HTTP traffic, and hello other port is for HTTPS.</span></span> <span data-ttu-id="bc290-258">Ces ports sont répertoriés dans hello UI ASE dans la section d’adresses IP hello.</span><span class="sxs-lookup"><span data-stu-id="bc290-258">Those ports are listed in hello ASE UI in hello IP addresses section.</span></span> <span data-ttu-id="bc290-259">Le trafic doit être en mesure de tooreach ces ports à partir de hello VIP ou les applications de hello sont inaccessibles.</span><span class="sxs-lookup"><span data-stu-id="bc290-259">Traffic must be able tooreach those ports from hello VIP or hello apps are inaccessible.</span></span> <span data-ttu-id="bc290-260">Cette exigence est tooremember important lorsque vous configurez des groupes de sécurité réseau (NSG).</span><span class="sxs-lookup"><span data-stu-id="bc290-260">This requirement is important tooremember when you configure Network Security Groups (NSGs).</span></span>

## <a name="network-security-groups"></a><span data-ttu-id="bc290-261">Network Security Group</span><span class="sxs-lookup"><span data-stu-id="bc290-261">Network Security Groups</span></span> ##

<span data-ttu-id="bc290-262">[Groupes de sécurité réseau] [ NSGs] hello capacité toocontrol l’accès d’un réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="bc290-262">[Network Security Groups][NSGs] provide hello ability toocontrol network access within a VNet.</span></span> <span data-ttu-id="bc290-263">Lorsque vous utilisez le portail de hello, il est implicite deny de règle à hello la plus basse priorité toodeny tous les éléments.</span><span class="sxs-lookup"><span data-stu-id="bc290-263">When you use hello portal, there's an implicit deny rule at hello lowest priority toodeny everything.</span></span> <span data-ttu-id="bc290-264">Ce que vous créez sont vos règles d’autorisation.</span><span class="sxs-lookup"><span data-stu-id="bc290-264">What you build are your allow rules.</span></span>

<span data-ttu-id="bc290-265">Dans un environnement app service, vous n’avez accès toohello machines virtuelles utilisées toohost hello ASE lui-même.</span><span class="sxs-lookup"><span data-stu-id="bc290-265">In an ASE, you don't have access toohello VMs used toohost hello ASE itself.</span></span> <span data-ttu-id="bc290-266">Elles se trouvent dans un abonnement géré par Microsoft.</span><span class="sxs-lookup"><span data-stu-id="bc290-266">They're in a Microsoft-managed subscription.</span></span> <span data-ttu-id="bc290-267">Si vous souhaitez que les applications toohello toorestrict accès sur hello ASE, définir des groupes de sécurité réseau sur le sous-réseau de ASE hello.</span><span class="sxs-lookup"><span data-stu-id="bc290-267">If you want toorestrict access toohello apps on hello ASE, set NSGs on hello ASE subnet.</span></span> <span data-ttu-id="bc290-268">Ce faisant, soyez très attentif dépendances de ASE toohello.</span><span class="sxs-lookup"><span data-stu-id="bc290-268">In doing so, pay careful attention toohello ASE dependencies.</span></span> <span data-ttu-id="bc290-269">Si vous bloquez toutes les dépendances, hello ASE cesse de fonctionner.</span><span class="sxs-lookup"><span data-stu-id="bc290-269">If you block any dependencies, hello ASE stops working.</span></span>

<span data-ttu-id="bc290-270">Groupes de sécurité réseau peuvent être configurés via hello portail Azure ou via PowerShell.</span><span class="sxs-lookup"><span data-stu-id="bc290-270">NSGs can be configured through hello Azure portal or via PowerShell.</span></span> <span data-ttu-id="bc290-271">informations Hello ici montrent hello portail Azure.</span><span class="sxs-lookup"><span data-stu-id="bc290-271">hello information here shows hello Azure portal.</span></span> <span data-ttu-id="bc290-272">Vous créez et gérez des groupes de sécurité réseau dans le portail de hello comme une ressource de niveau supérieur sous **réseau**.</span><span class="sxs-lookup"><span data-stu-id="bc290-272">You create and manage NSGs in hello portal as a top-level resource under **Networking**.</span></span>

<span data-ttu-id="bc290-273">Hello exigences entrantes et sortantes sont prises en compte, hello groupes de sécurité réseau doit se présenter comme toohello groupes de sécurité réseau illustrés dans cet exemple.</span><span class="sxs-lookup"><span data-stu-id="bc290-273">When hello inbound and outbound requirements are taken into account, hello NSGs should look similar toohello NSGs shown in this example.</span></span> <span data-ttu-id="bc290-274">Hello, plage d’adresses réseau virtuel est _192.168.250.0/16_, et le sous-réseau hello hello ASE dans est _192.168.251.128/25_.</span><span class="sxs-lookup"><span data-stu-id="bc290-274">hello VNet address range is _192.168.250.0/16_, and hello subnet that hello ASE is in is _192.168.251.128/25_.</span></span>

<span data-ttu-id="bc290-275">Hello tout d’abord deux entrant conditions hello ASE toofunction sont affichées en haut de hello de liste de hello dans cet exemple.</span><span class="sxs-lookup"><span data-stu-id="bc290-275">hello first two inbound requirements for hello ASE toofunction are shown at hello top of hello list in this example.</span></span> <span data-ttu-id="bc290-276">Ils activer la gestion de ASE et autoriser toocommunicate ASE de hello avec lui-même.</span><span class="sxs-lookup"><span data-stu-id="bc290-276">They enable ASE management and allow hello ASE toocommunicate with itself.</span></span> <span data-ttu-id="bc290-277">Bonjour autres entrées sont tous les locataires configurable et peuvent contrôler les applications réseau accès toohello ASE hébergé.</span><span class="sxs-lookup"><span data-stu-id="bc290-277">hello other entries are all tenant configurable and can govern network access toohello ASE-hosted applications.</span></span> 

![Règles de sécurité de trafic entrant][4]

<span data-ttu-id="bc290-279">Une règle par défaut permet de hello des adresses IP dans le sous-réseau ASE toohello hello réseau virtuel tootalk.</span><span class="sxs-lookup"><span data-stu-id="bc290-279">A default rule enables hello IPs in hello VNet tootalk toohello ASE subnet.</span></span> <span data-ttu-id="bc290-280">Une autre règle par défaut permet l’équilibrage de charge hello, également appelée adresse IP virtuelle publique de hello, toocommunicate avec hello ASE.</span><span class="sxs-lookup"><span data-stu-id="bc290-280">Another default rule enables hello load balancer, also known as hello public VIP, toocommunicate with hello ASE.</span></span> <span data-ttu-id="bc290-281">Sélectionnez des règles par défaut de hello toosee, **règles par défaut** toohello suivant **ajouter** icône.</span><span class="sxs-lookup"><span data-stu-id="bc290-281">toosee hello default rules, select **Default rules** next toohello **Add** icon.</span></span> <span data-ttu-id="bc290-282">Si vous placez une instruction deny tout le reste de règles une fois hello NSG règles affichées, vous empêchez le trafic entre les adresses IP virtuelles hello et hello ASE.</span><span class="sxs-lookup"><span data-stu-id="bc290-282">If you put a deny everything else rule after hello NSG rules shown, you prevent traffic between hello VIP and hello ASE.</span></span> <span data-ttu-id="bc290-283">le trafic tooprevent d’à l’intérieur de hello réseau virtuel, ajoutez vos propres tooallow règle entrante.</span><span class="sxs-lookup"><span data-stu-id="bc290-283">tooprevent traffic coming from inside hello VNet, add your own rule tooallow inbound.</span></span> <span data-ttu-id="bc290-284">Utiliser un tooAzureLoadBalancer égal source avec une destination **tout** et une plage de ports de  **\*** .</span><span class="sxs-lookup"><span data-stu-id="bc290-284">Use a source equal tooAzureLoadBalancer with a destination of **Any** and a port range of **\***.</span></span> <span data-ttu-id="bc290-285">Règle de groupe de sécurité réseau hello étant appliqués toohello ASE sous-réseau, vous n’avez pas besoin spécifique de toobe dans la destination de hello.</span><span class="sxs-lookup"><span data-stu-id="bc290-285">Because hello NSG rule is applied toohello ASE subnet, you don't need toobe specific in hello destination.</span></span>

<span data-ttu-id="bc290-286">Si vous avez affecté à une application de tooyour d’adresses IP, assurez-vous que vous conservez hello ports ouverts.</span><span class="sxs-lookup"><span data-stu-id="bc290-286">If you assigned an IP address tooyour app, make sure you keep hello ports open.</span></span> <span data-ttu-id="bc290-287">sélectionner des ports de hello toosee, **environnement App Service** > **des adresses IP**.</span><span class="sxs-lookup"><span data-stu-id="bc290-287">toosee hello ports, select **App Service Environment** > **IP addresses**.</span></span>  

<span data-ttu-id="bc290-288">Tous les éléments hello illustrés hello suivant les règles de trafic sortant sont nécessaires à l’exception du dernier élément de hello.</span><span class="sxs-lookup"><span data-stu-id="bc290-288">All hello items shown in hello following outbound rules are needed, except for hello last item.</span></span> <span data-ttu-id="bc290-289">Elles permettent de réseau accès toohello ASE dépendances qui ont été notées précédemment dans cet article.</span><span class="sxs-lookup"><span data-stu-id="bc290-289">They enable network access toohello ASE dependencies that were noted earlier in this article.</span></span> <span data-ttu-id="bc290-290">Si vous bloquez un d'entre eux, votre ASE cesse de fonctionner.</span><span class="sxs-lookup"><span data-stu-id="bc290-290">If you block any of them, your ASE stops working.</span></span> <span data-ttu-id="bc290-291">Hello dernier élément de liste de hello permet à votre toocommunicate ASE avec d’autres ressources dans votre réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="bc290-291">hello last item in hello list enables your ASE toocommunicate with other resources in your VNet.</span></span>

![Règles de sécurité de trafic entrant][5]

<span data-ttu-id="bc290-293">Une fois vos groupes de sécurité réseau sont définies, affectez-les sous-réseau toohello votre ASE sur.</span><span class="sxs-lookup"><span data-stu-id="bc290-293">After your NSGs are defined, assign them toohello subnet that your ASE is on.</span></span> <span data-ttu-id="bc290-294">Si vous ne connaissez pas hello ASE réseaux ou sous-réseaux, vous pouvez le voir à partir du portail de gestion ASE hello.</span><span class="sxs-lookup"><span data-stu-id="bc290-294">If you don’t remember hello ASE VNet or subnet, you can see it from hello ASE management portal.</span></span> <span data-ttu-id="bc290-295">tooassign hello sous-réseau tooyour de groupe de sécurité réseau, le sous-réseau toohello l’interface utilisateur, sélectionnez hello groupe de sécurité réseau.</span><span class="sxs-lookup"><span data-stu-id="bc290-295">tooassign hello NSG tooyour subnet, go toohello subnet UI and select hello NSG.</span></span>

## <a name="routes"></a><span data-ttu-id="bc290-296">Itinéraires</span><span class="sxs-lookup"><span data-stu-id="bc290-296">Routes</span></span> ##

<span data-ttu-id="bc290-297">Les itinéraires posent le plus souvent problème lorsque vous configurez votre réseau virtuel avec Azure ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="bc290-297">Routes become problematic most commonly when you configure your VNet with Azure ExpressRoute.</span></span> <span data-ttu-id="bc290-298">Il existe trois types d’itinéraires dans un réseau virtuel :</span><span class="sxs-lookup"><span data-stu-id="bc290-298">There are three types of routes in a VNet:</span></span>

-   <span data-ttu-id="bc290-299">Itinéraires système</span><span class="sxs-lookup"><span data-stu-id="bc290-299">System routes</span></span>
-   <span data-ttu-id="bc290-300">Itinéraires BGP</span><span class="sxs-lookup"><span data-stu-id="bc290-300">BGP routes</span></span>
-   <span data-ttu-id="bc290-301">Itinéraires définis par l’utilisateur (UDR)</span><span class="sxs-lookup"><span data-stu-id="bc290-301">User-defined routes (UDRs)</span></span>

<span data-ttu-id="bc290-302">Les itinéraires BGP prennent le pas sur les itinéraires système.</span><span class="sxs-lookup"><span data-stu-id="bc290-302">BGP routes override system routes.</span></span> <span data-ttu-id="bc290-303">Les UDR prennent le pas sur les itinéraires BGP.</span><span class="sxs-lookup"><span data-stu-id="bc290-303">UDRs override BGP routes.</span></span> <span data-ttu-id="bc290-304">Pour plus d’informations sur les itinéraires dans les réseaux virtuels Azure, consultez [Présentation des itinéraires définis par l’utilisateur][UDRs].</span><span class="sxs-lookup"><span data-stu-id="bc290-304">For more information about routes in Azure virtual networks, see [User-defined routes overview][UDRs].</span></span>

<span data-ttu-id="bc290-305">base de données SQL Azure Hello que hello ASE utilise un système de hello toomanage doté d’un pare-feu.</span><span class="sxs-lookup"><span data-stu-id="bc290-305">hello Azure SQL database that hello ASE uses toomanage hello system has a firewall.</span></span> <span data-ttu-id="bc290-306">Il requiert toooriginate de communication à partir de hello ASE publique VIP.</span><span class="sxs-lookup"><span data-stu-id="bc290-306">It requires communication toooriginate from hello ASE public VIP.</span></span> <span data-ttu-id="bc290-307">Connexions toohello base de données SQL hello ASE sera refusé si elles sont envoyées vers le bas hello connexion ExpressRoute et une autre adresse IP.</span><span class="sxs-lookup"><span data-stu-id="bc290-307">Connections toohello SQL database from hello ASE will be denied if they are sent down hello ExpressRoute connection and out another IP address.</span></span>

<span data-ttu-id="bc290-308">Si les demandes de gestion des réponses tooincoming sont envoyées vers le bas hello ExpressRoute, adresse de réponse hello est différent de celui de destination d’origine de hello.</span><span class="sxs-lookup"><span data-stu-id="bc290-308">If replies tooincoming management requests are sent down hello ExpressRoute, hello reply address is different than hello original destination.</span></span> <span data-ttu-id="bc290-309">Cette incompatibilité interrompt les communications TCP hello.</span><span class="sxs-lookup"><span data-stu-id="bc290-309">This mismatch breaks hello TCP communication.</span></span>

<span data-ttu-id="bc290-310">Pour votre toowork ASE pendant la configuration de votre réseau virtuel avec un ExpressRoute, hello plus simple chose toodo est :</span><span class="sxs-lookup"><span data-stu-id="bc290-310">For your ASE toowork while your VNet is configured with an ExpressRoute, hello easiest thing toodo is:</span></span>

-   <span data-ttu-id="bc290-311">Configurer ExpressRoute tooadvertise _0.0.0.0/0_.</span><span class="sxs-lookup"><span data-stu-id="bc290-311">Configure ExpressRoute tooadvertise _0.0.0.0/0_.</span></span> <span data-ttu-id="bc290-312">Par défaut, il tunnélise de force tout le trafic sortant local.</span><span class="sxs-lookup"><span data-stu-id="bc290-312">By default, it force tunnels all outbound traffic on-premises.</span></span>
-   <span data-ttu-id="bc290-313">Créer un UDR.</span><span class="sxs-lookup"><span data-stu-id="bc290-313">Create a UDR.</span></span> <span data-ttu-id="bc290-314">Sous-réseau toohello contenant ASE hello avec un préfixe d’adresse de l’appliquer _0.0.0.0/0_ et en regard de type de tronçon _Internet_.</span><span class="sxs-lookup"><span data-stu-id="bc290-314">Apply it toohello subnet that contains hello ASE with an address prefix of _0.0.0.0/0_ and a next hop type of _Internet_.</span></span>

<span data-ttu-id="bc290-315">Si vous modifiez ces deux, destinés à l’internet le trafic en provenance du sous-réseau de ASE hello n’est pas forcé hello ExpressRoute et hello ASE fonctionne.</span><span class="sxs-lookup"><span data-stu-id="bc290-315">If you make these two changes, internet-destined traffic that originates from hello ASE subnet isn't forced down hello ExpressRoute and hello ASE works.</span></span> 

> [!IMPORTANT]
> <span data-ttu-id="bc290-316">itinéraires Hello définis dans un UDR doivent être suffisamment spécifique tootake priorité sur les itinéraires annoncés par la configuration de ExpressRoute hello.</span><span class="sxs-lookup"><span data-stu-id="bc290-316">hello routes defined in a UDR must be specific enough tootake precedence over any routes advertised by hello ExpressRoute configuration.</span></span> <span data-ttu-id="bc290-317">Hello exemple précédent utilise plage d’adresses 0.0.0.0/0 large hello.</span><span class="sxs-lookup"><span data-stu-id="bc290-317">hello preceding example uses hello broad 0.0.0.0/0 address range.</span></span> <span data-ttu-id="bc290-318">Il peut potentiellement être remplacé accidentellement par des annonces de routage utilisant des plages d’adresses plus spécifiques.</span><span class="sxs-lookup"><span data-stu-id="bc290-318">It can potentially be accidentally overridden by route advertisements that use more specific address ranges.</span></span>
>
> <span data-ttu-id="bc290-319">ASEs ne sont pas pris en charge avec des configurations ExpressRoute entre-publier des routes de hello d’homologation publique toohello d’homologation privée chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="bc290-319">ASEs aren't supported with ExpressRoute configurations that cross-advertise routes from hello public-peering path toohello private-peering path.</span></span> <span data-ttu-id="bc290-320">Les configurations ExpressRoute ayant une homologation publique configurée reçoivent les publications de routage de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="bc290-320">ExpressRoute configurations with public peering configured receive route advertisements from Microsoft.</span></span> <span data-ttu-id="bc290-321">les publications Hello contiennent un grand ensemble de plages d’adresses IP de Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="bc290-321">hello advertisements contain a large set of Microsoft Azure IP address ranges.</span></span> <span data-ttu-id="bc290-322">Si les plages d’adresses hello sont publiés entre sur le chemin d’accès de hello d’homologation privée, tous les paquets réseau sortant à partir du sous-réseau de hello de ASE sont infrastructure de réseau local du client force tooa tunnel.</span><span class="sxs-lookup"><span data-stu-id="bc290-322">If hello address ranges are cross-advertised on hello private-peering path, all outbound network packets from hello ASE's subnet are force tunneled tooa customer's on-premises network infrastructure.</span></span> <span data-ttu-id="bc290-323">Ce flux de réseau n’est actuellement pas pris en charge par les environnements App Service.</span><span class="sxs-lookup"><span data-stu-id="bc290-323">This network flow is currently not supported with ASEs.</span></span> <span data-ttu-id="bc290-324">Un problème de toothis de solution est toostop les itinéraires de publication croisée de hello d’homologation publique toohello d’homologation privée chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="bc290-324">One solution toothis problem is toostop cross-advertising routes from hello public-peering path toohello private-peering path.</span></span>

<span data-ttu-id="bc290-325">toocreate un UDR, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="bc290-325">toocreate a UDR, follow these steps:</span></span>

1. <span data-ttu-id="bc290-326">Accédez toohello portail Azure.</span><span class="sxs-lookup"><span data-stu-id="bc290-326">Go toohello Azure portal.</span></span> <span data-ttu-id="bc290-327">Sélectionnez **Mise en réseau** > **Tables d’itinéraires**.</span><span class="sxs-lookup"><span data-stu-id="bc290-327">Select **Networking** > **Route Tables**.</span></span>

2. <span data-ttu-id="bc290-328">Créer une table de routage Bonjour même région que votre réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="bc290-328">Create a new route table in hello same region as your VNet.</span></span>

3. <span data-ttu-id="bc290-329">À partir de l’interface utilisateur de votre table d’itinéraires, sélectionnez **Itinéraires** > **Ajouter**.</span><span class="sxs-lookup"><span data-stu-id="bc290-329">From within your route table UI, select **Routes** > **Add**.</span></span>

4. <span data-ttu-id="bc290-330">Ensemble hello **type de tronçon suivant** trop**Internet** et hello **préfixe d’adresse** trop**0.0.0.0/0**.</span><span class="sxs-lookup"><span data-stu-id="bc290-330">Set hello **Next hop type** too**Internet** and hello **Address prefix** too**0.0.0.0/0**.</span></span> <span data-ttu-id="bc290-331">Sélectionnez **Enregistrer**.</span><span class="sxs-lookup"><span data-stu-id="bc290-331">Select **Save**.</span></span>

    <span data-ttu-id="bc290-332">Vous voyez alors hello suivant :</span><span class="sxs-lookup"><span data-stu-id="bc290-332">You then see something like hello following:</span></span>

    ![Itinéraires fonctionnels][6]

5. <span data-ttu-id="bc290-334">Après avoir créé une nouvelle table d’itinéraires hello, accédez sous-réseau toohello qui contient votre ASE.</span><span class="sxs-lookup"><span data-stu-id="bc290-334">After you create hello new route table, go toohello subnet that contains your ASE.</span></span> <span data-ttu-id="bc290-335">Sélectionnez votre table de routage à partir de la liste de hello dans le portail de hello.</span><span class="sxs-lookup"><span data-stu-id="bc290-335">Select your route table from hello list in hello portal.</span></span> <span data-ttu-id="bc290-336">Après avoir enregistré les modifications de hello, vous devez puis Voir groupes de sécurité réseau hello et itinéraires notées avec votre sous-réseau.</span><span class="sxs-lookup"><span data-stu-id="bc290-336">After you save hello change, you should then see hello NSGs and routes noted with your subnet.</span></span>

    ![Itinéraires et groupes de sécurité réseau][7]

### <a name="deploy-into-existing-azure-virtual-networks-that-are-integrated-with-expressroute"></a><span data-ttu-id="bc290-338">Déploiement dans des réseaux virtuels Azure existants intégrés à ExpressRoute</span><span class="sxs-lookup"><span data-stu-id="bc290-338">Deploy into existing Azure virtual networks that are integrated with ExpressRoute</span></span> ###

<span data-ttu-id="bc290-339">toodeploy votre ASE dans un réseau virtuel qui est intégré à ExpressRoute, préconfigurer sous-réseau hello où vous souhaitez ASE hello déployé.</span><span class="sxs-lookup"><span data-stu-id="bc290-339">toodeploy your ASE into a VNet that's integrated with ExpressRoute, preconfigure hello subnet where you want hello ASE deployed.</span></span> <span data-ttu-id="bc290-340">Utilisez ensuite une toodeploy de modèle de gestionnaire de ressources qu’il.</span><span class="sxs-lookup"><span data-stu-id="bc290-340">Then use a Resource Manager template toodeploy it.</span></span> <span data-ttu-id="bc290-341">toocreate ASE dans un réseau virtuel qui a déjà ExpressRoute configuré :</span><span class="sxs-lookup"><span data-stu-id="bc290-341">toocreate an ASE in a VNet that already has ExpressRoute configured:</span></span>

- <span data-ttu-id="bc290-342">Créer un Bonjour toohost de sous-réseau ASE.</span><span class="sxs-lookup"><span data-stu-id="bc290-342">Create a subnet toohost hello ASE.</span></span>

    > [!NOTE]
    > <span data-ttu-id="bc290-343">Rien d’autre ne peut être dans le sous-réseau de hello mais hello ASE.</span><span class="sxs-lookup"><span data-stu-id="bc290-343">Nothing else can be in hello subnet but hello ASE.</span></span> <span data-ttu-id="bc290-344">Être toochoose qu’un espace d’adressage qui permet une croissance future.</span><span class="sxs-lookup"><span data-stu-id="bc290-344">Be sure toochoose an address space that allows for future growth.</span></span> <span data-ttu-id="bc290-345">Vous ne pouvez pas modifier ce paramètre par la suite.</span><span class="sxs-lookup"><span data-stu-id="bc290-345">You can't change this setting later.</span></span> <span data-ttu-id="bc290-346">Nous vous recommandons une taille de `/25` avec 128 adresses.</span><span class="sxs-lookup"><span data-stu-id="bc290-346">We recommend a size of `/25` with 128 addresses.</span></span>

- <span data-ttu-id="bc290-347">Créez UDRs (par exemple, les tables d’itinéraires) comme décrit précédemment et le définir sur le sous-réseau de hello.</span><span class="sxs-lookup"><span data-stu-id="bc290-347">Create UDRs (for example, route tables) as described earlier, and set that on hello subnet.</span></span>
- <span data-ttu-id="bc290-348">Créer hello ASE à l’aide d’un modèle de gestionnaire de ressources comme décrit dans [créer un environnement app service à l’aide d’un modèle de gestionnaire de ressources][MakeASEfromTemplate].</span><span class="sxs-lookup"><span data-stu-id="bc290-348">Create hello ASE by using a Resource Manager template as described in [Create an ASE by using a Resource Manager template][MakeASEfromTemplate].</span></span>

<!--Image references-->
[1]: ./media/network_considerations_with_an_app_service_environment/networkase-overflow.png
[2]: ./media/network_considerations_with_an_app_service_environment/networkase-overflow2.png
[3]: ./media/network_considerations_with_an_app_service_environment/networkase-ipaddresses.png
[4]: ./media/network_considerations_with_an_app_service_environment/networkase-inboundnsg.png
[5]: ./media/network_considerations_with_an_app_service_environment/networkase-outboundnsg.png
[6]: ./media/network_considerations_with_an_app_service_environment/networkase-udr.png
[7]: ./media/network_considerations_with_an_app_service_environment/networkase-subnet.png

<!--Links-->
[Intro]: ./intro.md
[MakeExternalASE]: ./create-external-ase.md
[MakeASEfromTemplate]: ./create-from-template.md
[MakeILBASE]: ./create-ilb-ase.md
[ASENetwork]: ./network-info.md
[ASEReadme]: ./readme.md
[UsingASE]: ./using-an-ase.md
[UDRs]: ../../virtual-network/virtual-networks-udr-overview.md
[NSGs]: ../../virtual-network/virtual-networks-nsg.md
[ConfigureASEv1]: ../../app-service-web/app-service-web-configure-an-app-service-environment.md
[ASEv1Intro]: ../../app-service-web/app-service-app-service-environment-intro.md
[webapps]: ../../app-service-web/app-service-web-overview.md
[mobileapps]: ../../app-service-mobile/app-service-mobile-value-prop.md
[APIapps]: ../../app-service-api/app-service-api-apps-why-best-platform.md
[Functions]: ../../azure-functions/index.yml
[Pricing]: http://azure.microsoft.com/pricing/details/app-service/
[ARMOverview]: ../../azure-resource-manager/resource-group-overview.md
[ConfigureSSL]: ../../app-service-web/web-sites-purchase-ssl-web-site.md
[Kudu]: http://azure.microsoft.com/resources/videos/super-secret-kudu-debug-console-for-azure-web-sites/
[AppDeploy]: ../../app-service-web/web-sites-deploy.md
[ASEWAF]: ../../app-service-web/app-service-app-service-environment-web-application-firewall.md
[AppGW]: ../../application-gateway/application-gateway-web-application-firewall-overview.md
[ASEManagement]: ./management-addresses.md
