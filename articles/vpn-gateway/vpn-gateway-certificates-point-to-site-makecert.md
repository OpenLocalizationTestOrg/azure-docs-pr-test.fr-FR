---
title: "Générer et exporter des certificats pour les connexions de point à site : MakeCert : Azure | Microsoft Docs"
description: "Cet article contient les étapes toocreate un certificat racine auto-signé, exporter la clé publique de hello et générer des certificats de client à l’aide de MakeCert."
services: vpn-gateway
documentationcenter: na
author: cherylmc
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 
ms.service: vpn-gateway
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 08/09/2017
ms.author: cherylmc
ms.openlocfilehash: 0b795ccf74f1f97fbd3de8a0dc339f9cb0b48183
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="generate-and-export-certificates-for-point-to-site-connections-using-makecert"></a><span data-ttu-id="9c1fe-103">Générer et exporter des certificats pour les connexions de point à site à l’aide de MakeCert</span><span class="sxs-lookup"><span data-stu-id="9c1fe-103">Generate and export certificates for Point-to-Site connections using MakeCert</span></span>

<span data-ttu-id="9c1fe-104">Connexions de point-to-Site utilisent des certificats tooauthenticate.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-104">Point-to-Site connections use certificates tooauthenticate.</span></span> <span data-ttu-id="9c1fe-105">Cet article vous montre comment toocreate un auto-signé certificat racine et générer des certificats de client à l’aide de MakeCert.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-105">This article shows you how toocreate a self-signed root certificate and generate client certificates using MakeCert.</span></span> <span data-ttu-id="9c1fe-106">Si vous recherchez des étapes de configuration de Point-to-Site, telles que comment la liste de certificats racines de tooupload, sélectionnez un des articles hello ' configurer Point-to-Site' à partir de hello suivant :</span><span class="sxs-lookup"><span data-stu-id="9c1fe-106">If you are looking for Point-to-Site configuration steps, such as how tooupload root certificates, select one of hello 'Configure Point-to-Site' articles from hello following list:</span></span>

> [!div class="op_single_selector"]
> * [<span data-ttu-id="9c1fe-107">Création de certificat auto-signés - PowerShell</span><span class="sxs-lookup"><span data-stu-id="9c1fe-107">Create self-signed certificates - PowerShell</span></span>](vpn-gateway-certificates-point-to-site.md)
> * [<span data-ttu-id="9c1fe-108">Création de certificat auto-signés - Makecert</span><span class="sxs-lookup"><span data-stu-id="9c1fe-108">Create self-signed certificates - MakeCert</span></span>](vpn-gateway-certificates-point-to-site-makecert.md)
> * [<span data-ttu-id="9c1fe-109">Configuration d’une connexion de point à site à un réseau virtuel - Resource Manager - Portail Azure</span><span class="sxs-lookup"><span data-stu-id="9c1fe-109">Configure Point-to-Site - Resource Manager - Azure portal</span></span>](vpn-gateway-howto-point-to-site-resource-manager-portal.md)
> * [<span data-ttu-id="9c1fe-110">Configuration d’une connexion point à site à un réseau virtuel - Resource Manager - PowerShell</span><span class="sxs-lookup"><span data-stu-id="9c1fe-110">Configure Point-to-Site - Resource Manager - PowerShell</span></span>](vpn-gateway-howto-point-to-site-rm-ps.md)
> * [<span data-ttu-id="9c1fe-111">Configuration d’une connexion de point à site à un réseau virtuel - Classic - Portail Azure</span><span class="sxs-lookup"><span data-stu-id="9c1fe-111">Configure Point-to-Site - Classic - Azure portal</span></span>](vpn-gateway-howto-point-to-site-classic-azure-portal.md)
> 
> 

<span data-ttu-id="9c1fe-112">Pendant que nous recommandons d’utiliser hello [Windows PowerShell de 10 étapes](vpn-gateway-certificates-point-to-site.md) toocreate vos certificats, nous fournir ces instructions MakeCert comme une méthode facultative.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-112">While we recommend using hello [Windows 10 PowerShell steps](vpn-gateway-certificates-point-to-site.md) toocreate your certificates, we provide these MakeCert instructions as an optional method.</span></span> <span data-ttu-id="9c1fe-113">les certificats de Hello que vous générez à l’aide de ces deux méthodes peuvent être installés sur [n’importe quel système d’exploitation client pris en charge](vpn-gateway-howto-point-to-site-resource-manager-portal.md#faq).</span><span class="sxs-lookup"><span data-stu-id="9c1fe-113">hello certificates that you generate using either method can be installed on [any supported client operating system](vpn-gateway-howto-point-to-site-resource-manager-portal.md#faq).</span></span> <span data-ttu-id="9c1fe-114">Toutefois, MakeCert a hello après limitation :</span><span class="sxs-lookup"><span data-stu-id="9c1fe-114">However, MakeCert has hello following limitation:</span></span>

* <span data-ttu-id="9c1fe-115">MakeCert est déconseillé.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-115">MakeCert is deprecated.</span></span> <span data-ttu-id="9c1fe-116">Cela signifie que cet outil pourrait être supprimé à tout moment.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-116">This means that this tool could be removed at any point.</span></span> <span data-ttu-id="9c1fe-117">Les certificats que vous avez déjà générés à l’aide de MakeCert ne sont pas affectés quand MakeCert n’est plus disponible.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-117">Any certificates that you already generated using MakeCert won't be affected when MakeCert is no longer available.</span></span> <span data-ttu-id="9c1fe-118">MakeCert fait uniquement les certificats hello toogenerate utilisées, pas comme un mécanisme de validation.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-118">MakeCert is only used toogenerate hello certificates, not as a validating mechanism.</span></span>

## <span data-ttu-id="9c1fe-119"><a name="rootcert"></a>Créer un certificat racine auto-signé</span><span class="sxs-lookup"><span data-stu-id="9c1fe-119"><a name="rootcert"></a>Create a self-signed root certificate</span></span>

<span data-ttu-id="9c1fe-120">Hello suit vous montre comment toocreate un auto-signé certificat à l’aide de MakeCert.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-120">hello following steps show you how toocreate a self-signed certificate using MakeCert.</span></span> <span data-ttu-id="9c1fe-121">Ces étapes ne sont pas spécifiques au modèle de déploiement.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-121">These steps are not deployment-model specific.</span></span> <span data-ttu-id="9c1fe-122">Elles sont valides pour le modèle Resource Manager et classique.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-122">They are valid for both Resource Manager and classic.</span></span>

1. <span data-ttu-id="9c1fe-123">Téléchargez et installez [MakeCert](https://msdn.microsoft.com/library/windows/desktop/aa386968(v=vs.85).aspx).</span><span class="sxs-lookup"><span data-stu-id="9c1fe-123">Download and install [MakeCert](https://msdn.microsoft.com/library/windows/desktop/aa386968(v=vs.85).aspx).</span></span>
2. <span data-ttu-id="9c1fe-124">Après l’installation, vous trouverez généralement utilitaire makecert.exe de hello sous ce chemin d’accès : « C:\Program Files (x86) \Windows Kits\10\bin\<arch >'.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-124">After installation, you can typically find hello makecert.exe utility under this path: 'C:\Program Files (x86)\Windows Kits\10\bin\<arch>'.</span></span> <span data-ttu-id="9c1fe-125">Toutefois, il est possible qu’il a été installé tooanother emplacement.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-125">Although, it's possible that it was installed tooanother location.</span></span> <span data-ttu-id="9c1fe-126">Ouvrez une invite de commandes en tant qu’administrateur et accédez emplacement toohello Hello utilitaire MakeCert.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-126">Open a command prompt as administrator and navigate toohello location of hello MakeCert utility.</span></span> <span data-ttu-id="9c1fe-127">Vous pouvez utiliser hello l’exemple suivant, l’ajustement de l’emplacement approprié de hello :</span><span class="sxs-lookup"><span data-stu-id="9c1fe-127">You can use hello following example, adjusting for hello proper location:</span></span>

  ```cmd
  cd C:\Program Files (x86)\Windows Kits\10\bin\x64
  ```
3. <span data-ttu-id="9c1fe-128">Créez et installez un certificat dans le magasin de certificats personnel hello sur votre ordinateur.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-128">Create and install a certificate in hello Personal certificate store on your computer.</span></span> <span data-ttu-id="9c1fe-129">Hello exemple suivant crée un correspondant *.cer* fichier que vous téléchargez tooAzure lors de la configuration P2S.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-129">hello following example creates a corresponding *.cer* file that you upload tooAzure when configuring P2S.</span></span> <span data-ttu-id="9c1fe-130">Remplacez 'P2SRootCert' et 'P2SRootCert.cer' nom hello que vous souhaitez toouse pour le certificat de hello.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-130">Replace 'P2SRootCert' and 'P2SRootCert.cer' with hello name that you want toouse for hello certificate.</span></span> <span data-ttu-id="9c1fe-131">certificat de Hello se trouve dans votre 'certificats - actuel\Personnel\Certificats'.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-131">hello certificate is located in your 'Certificates - Current User\Personal\Certificates'.</span></span>

  ```cmd
  makecert -sky exchange -r -n "CN=P2SRootCert" -pe -a sha256 -len 2048 -ss My
  ```

## <span data-ttu-id="9c1fe-132"><a name="cer"></a>Exporter la clé publique de hello (.cer)</span><span class="sxs-lookup"><span data-stu-id="9c1fe-132"><a name="cer"></a>Export hello public key (.cer)</span></span>

[!INCLUDE [Export public key](../../includes/vpn-gateway-certificates-export-public-key-include.md)]

<span data-ttu-id="9c1fe-133">fichier de exported.cer Hello doit être téléchargé tooAzure.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-133">hello exported.cer file must be uploaded tooAzure.</span></span> <span data-ttu-id="9c1fe-134">Pour obtenir des instructions, consultez [Configurer une connexion de point à site](vpn-gateway-howto-point-to-site-resource-manager-portal.md#uploadfile).</span><span class="sxs-lookup"><span data-stu-id="9c1fe-134">For instructions, see [Configure a Point-to-Site connection](vpn-gateway-howto-point-to-site-resource-manager-portal.md#uploadfile).</span></span> <span data-ttu-id="9c1fe-135">tooadd un certificat racine de confiance supplémentaires, consultez [cette section](vpn-gateway-howto-point-to-site-resource-manager-portal.md#add) d’article de hello.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-135">tooadd an additional trusted root certificate, see [this section](vpn-gateway-howto-point-to-site-resource-manager-portal.md#add) of hello article.</span></span>

### <a name="export-hello-self-signed-certificate-and-private-key-toostore-it-optional"></a><span data-ttu-id="9c1fe-136">Exporter hello un certificat auto-signé et toostore clé privée il (facultatif)</span><span class="sxs-lookup"><span data-stu-id="9c1fe-136">Export hello self-signed certificate and private key toostore it (optional)</span></span>

<span data-ttu-id="9c1fe-137">Vous souhaiterez peut-être tooexport hello racine certificat auto-signé et stocker en toute sécurité.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-137">You may want tooexport hello self-signed root certificate and store it safely.</span></span> <span data-ttu-id="9c1fe-138">Si besoin est, vous pouvez l’installer ultérieurement sur un autre ordinateur et générer davantage de certificats clients ou exporter un autre fichier .cer.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-138">If need be, you can later install it on another computer and generate more client certificates, or export another .cer file.</span></span> <span data-ttu-id="9c1fe-139">tooexport hello auto-signé certificat racine un .pfx, le certificat racine de hello select et l’utilisation hello mêmes étapes comme décrit dans [exporter un certificat client](#clientexport).</span><span class="sxs-lookup"><span data-stu-id="9c1fe-139">tooexport hello self-signed root certificate as a .pfx, select hello root certificate and use hello same steps as described in [Export a client certificate](#clientexport).</span></span>

## <a name="create-and-install-client-certificates"></a><span data-ttu-id="9c1fe-140">Créer et installer des certificats clients</span><span class="sxs-lookup"><span data-stu-id="9c1fe-140">Create and install client certificates</span></span>

<span data-ttu-id="9c1fe-141">Vous n’installez hello un certificat auto-signé directement sur l’ordinateur client de hello.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-141">You don't install hello self-signed certificate directly on hello client computer.</span></span> <span data-ttu-id="9c1fe-142">Vous devez toogenerate un certificat client à partir de hello un certificat auto-signé.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-142">You need toogenerate a client certificate from hello self-signed certificate.</span></span> <span data-ttu-id="9c1fe-143">Vous exportez et installez l’ordinateur client de hello client certificat toohello.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-143">You then export and install hello client certificate toohello client computer.</span></span> <span data-ttu-id="9c1fe-144">Hello suit n’est pas spécifiques du modèle de déploiement.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-144">hello following steps are not deployment-model specific.</span></span> <span data-ttu-id="9c1fe-145">Elles sont valides pour le modèle Resource Manager et classique.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-145">They are valid for both Resource Manager and classic.</span></span>

### <span data-ttu-id="9c1fe-146"><a name="clientcert"></a>Générer un certificat client</span><span class="sxs-lookup"><span data-stu-id="9c1fe-146"><a name="clientcert"></a>Generate a client certificate</span></span>

<span data-ttu-id="9c1fe-147">Chaque ordinateur client qui se connecte tooa virtuel à l’aide de Point-to-Site doit avoir un certificat client est installé.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-147">Each client computer that connects tooa VNet using Point-to-Site must have a client certificate installed.</span></span> <span data-ttu-id="9c1fe-148">Vous générez un certificat client à partir du certificat racine auto-signé hello et puis exportez et installez le certificat de client hello.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-148">You generate a client certificate from hello self-signed root certificate, and then export and install hello client certificate.</span></span> <span data-ttu-id="9c1fe-149">Si le certificat de client hello n’est pas installé, l’authentification échoue.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-149">If hello client certificate is not installed, authentication fails.</span></span> 

<span data-ttu-id="9c1fe-150">Hello étapes suivantes vous guident génération d’un certificat client à partir d’un certificat racine auto-signé.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-150">hello following steps walk you through generating a client certificate from a self-signed root certificate.</span></span> <span data-ttu-id="9c1fe-151">Vous pouvez générer plusieurs certificats de client à partir de hello même certificat racine.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-151">You may generate multiple client certificates from hello same root certificate.</span></span> <span data-ttu-id="9c1fe-152">Lorsque vous générez les certificats de client à l’aide des étapes hello ci-dessous, hello client certificat est automatiquement installé sur l’ordinateur de hello que vous avez utilisé le certificat de hello toogenerate.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-152">When you generate client certificates using hello steps below, hello client certificate is automatically installed on hello computer that you used toogenerate hello certificate.</span></span> <span data-ttu-id="9c1fe-153">Si vous voulez tooinstall un certificat client sur un autre ordinateur client, vous pouvez exporter le certificat de hello.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-153">If you want tooinstall a client certificate on another client computer, you can export hello certificate.</span></span>
 
1. <span data-ttu-id="9c1fe-154">Sur hello même ordinateur que vous avez utilisé toocreate hello un certificat auto-signé, ouvrez une invite de commandes en tant qu’administrateur.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-154">On hello same computer that you used toocreate hello self-signed certificate, open a command prompt as administrator.</span></span>
2. <span data-ttu-id="9c1fe-155">Modifier et exécuter hello exemple toogenerate un certificat client.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-155">Modify and run hello sample toogenerate a client certificate.</span></span>
  * <span data-ttu-id="9c1fe-156">Modification *« P2SRootCert »* nom toohello de racine auto-signé hello que vous générez un certificat de client hello de.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-156">Change *"P2SRootCert"* toohello name of hello self-signed root that you are generating hello client certificate from.</span></span> <span data-ttu-id="9c1fe-157">Assurez-vous que vous utilisez le nom hello du certificat racine hello, qui est le hello ' CN =' la valeur était que vous avez spécifié lorsque vous avez créé les racine auto-signé hello.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-157">Make sure you are using hello name of hello root certificate, which is whatever hello 'CN=' value was that you specified when you created hello self-signed root.</span></span>
  * <span data-ttu-id="9c1fe-158">Modification *P2SChildCert* nom toohello toogenerate un toobe de certificat client.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-158">Change *P2SChildCert* toohello name you want toogenerate a client certificate toobe.</span></span>

  <span data-ttu-id="9c1fe-159">Si vous exécutez hello exemple suivant sans le modifier, hello en résulte un certificat client appelé P2SChildcert dans votre magasin de certificats personnel qui a été généré à partir du certificat P2SRootCert.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-159">If you run hello following example without modifying it, hello result is a client certificate named P2SChildcert in your Personal certificate store that was generated from root certificate P2SRootCert.</span></span>

  ```cmd
  makecert.exe -n "CN=P2SChildCert" -pe -sky exchange -m 96 -ss My -in "P2SRootCert" -is my -a sha256
  ```

### <span data-ttu-id="9c1fe-160"><a name="clientexport"></a>Exporter un certificat client</span><span class="sxs-lookup"><span data-stu-id="9c1fe-160"><a name="clientexport"></a>Export a client certificate</span></span>

[!INCLUDE [Export client certificate](../../includes/vpn-gateway-certificates-export-client-cert-include.md)]

### <span data-ttu-id="9c1fe-161"><a name="install"></a>Installer un certificat client exporté</span><span class="sxs-lookup"><span data-stu-id="9c1fe-161"><a name="install"></a>Install an exported client certificate</span></span>

[!INCLUDE [Install client certificate](../../includes/vpn-gateway-certificates-install-client-cert-include.md)]

## <a name="next-steps"></a><span data-ttu-id="9c1fe-162">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="9c1fe-162">Next steps</span></span>

<span data-ttu-id="9c1fe-163">Poursuivez votre configuration point à site.</span><span class="sxs-lookup"><span data-stu-id="9c1fe-163">Continue with your Point-to-Site configuration.</span></span> 

* <span data-ttu-id="9c1fe-164">Pour **le Gestionnaire de ressources** étapes du modèle de déploiement, consultez [configurer un tooa de connexion de Point-to-Site réseau virtuel](vpn-gateway-howto-point-to-site-resource-manager-portal.md).</span><span class="sxs-lookup"><span data-stu-id="9c1fe-164">For **Resource Manager** deployment model steps, see [Configure a Point-to-Site connection tooa VNet](vpn-gateway-howto-point-to-site-resource-manager-portal.md).</span></span>
* <span data-ttu-id="9c1fe-165">Pour **classique** étapes du modèle de déploiement, consultez [configurer un tooa de connexion VPN Point à Site réseau virtuel (classiques)](vpn-gateway-howto-point-to-site-classic-azure-portal.md).</span><span class="sxs-lookup"><span data-stu-id="9c1fe-165">For **classic** deployment model steps, see [Configure a Point-to-Site VPN connection tooa VNet (classic)](vpn-gateway-howto-point-to-site-classic-azure-portal.md).</span></span>
