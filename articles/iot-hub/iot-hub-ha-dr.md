---
title: "Haute disponibilité et récupération d’urgence Azure IoT Hub | Microsoft Docs"
description: "Décrit les options Azure et IoT Hub qui vous aident à créer des solutions Azure IoT à haute disponibilité dotées de fonctionnalités de récupération d’urgence."
services: iot-hub
documentationcenter: 
author: fsautomata
manager: timlt
editor: 
ms.assetid: ae320e58-aa20-45b9-abdc-fa4faae8e6dd
ms.service: iot-hub
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 11/16/2016
ms.author: elioda
ms.openlocfilehash: 76c3187549e1821908263c30e394db26ee6f75e6
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/11/2017
---
# <a name="iot-hub-high-availability-and-disaster-recovery"></a><span data-ttu-id="502db-103">Haute disponibilité et récupération d’urgence IoT Hub :</span><span class="sxs-lookup"><span data-stu-id="502db-103">IoT Hub high availability and disaster recovery</span></span>
<span data-ttu-id="502db-104">En tant que service Azure, IoT Hub offre la haute disponibilité à l’aide de redondances au niveau de la région Azure, sans aucun travail supplémentaire requis par la solution.</span><span class="sxs-lookup"><span data-stu-id="502db-104">As an Azure service, IoT Hub provides high availability (HA) using redundancies at the Azure region level, without any additional work required by the solution.</span></span> <span data-ttu-id="502db-105">La plateforme Microsoft Azure inclut également des fonctionnalités pour vous aider à générer des solutions offrant des fonctionnalités de récupération d’urgence ou une disponibilité inter-régions.</span><span class="sxs-lookup"><span data-stu-id="502db-105">The Microsoft Azure platform also includes features to help you build solutions with disaster recovery (DR) capabilities or cross-region availability.</span></span> <span data-ttu-id="502db-106">Si vous voulez fournir une haute disponibilité globale inter-régions aux appareils et aux utilisateurs, vous devez concevoir et préparer vos solutions de manière à tirer parti de ces fonctionnalités de récupération d’urgence d’Azure.</span><span class="sxs-lookup"><span data-stu-id="502db-106">If you want to provide global, cross-region high availability for devices or users, design and prepare your solutions to take advantage of these Azure DR features.</span></span> <span data-ttu-id="502db-107">L’article [Guide technique de la résilience Azure](../resiliency/resiliency-technical-guidance.md) décrit les fonctionnalités intégrées Azure permettant la continuité d’activité et la récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="502db-107">The article [Azure Business Continuity Technical Guidance](../resiliency/resiliency-technical-guidance.md) describes the built-in features in Azure for business continuity and DR.</span></span> <span data-ttu-id="502db-108">Le document [Récupération d’urgence et haute disponibilité pour les applications Azure][Disaster recovery and high availability for Azure applications] contient des recommandations d’architecture concernant les stratégies pour les applications Azure, permettant de bénéficier de la haute disponibilité et de la récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="502db-108">The [Disaster recovery and high availability for Azure applications][Disaster recovery and high availability for Azure applications] paper provides architecture guidance on strategies for Azure applications to achieve HA and DR.</span></span>

## <a name="azure-iot-hub-dr"></a><span data-ttu-id="502db-109">Récupération d’urgence Azure IoT Hub</span><span class="sxs-lookup"><span data-stu-id="502db-109">Azure IoT Hub DR</span></span>
<span data-ttu-id="502db-110">En plus de la haute disponibilité intra-région, IoT Hub implémente des mécanismes de basculement pour la récupération d’urgence qui ne nécessitent aucune intervention de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="502db-110">In addition to intra-region HA, IoT Hub implements failover mechanisms for disaster recovery that require no intervention from the user.</span></span> <span data-ttu-id="502db-111">La récupération d’urgence IoT Hub est lancée automatiquement et a un objectif de temps de récupération (RTO) de 2 à 26 heures, ainsi que les objectifs de point de récupération (RPO) suivants.</span><span class="sxs-lookup"><span data-stu-id="502db-111">IoT Hub DR is self-initiated and has a recovery time objective (RTO) of 2-26 hours, and the following recovery point objectives (RPOs).</span></span>

| <span data-ttu-id="502db-112">Fonctionnalités</span><span class="sxs-lookup"><span data-stu-id="502db-112">Functionality</span></span> | <span data-ttu-id="502db-113">RPO</span><span class="sxs-lookup"><span data-stu-id="502db-113">RPO</span></span> |
| --- | --- |
| <span data-ttu-id="502db-114">Disponibilité du service pour les opérations de Registre et de communication</span><span class="sxs-lookup"><span data-stu-id="502db-114">Service availability for registry and communication operations</span></span> |<span data-ttu-id="502db-115">Perte éventuelle du CName</span><span class="sxs-lookup"><span data-stu-id="502db-115">Possible CName loss</span></span> |
| <span data-ttu-id="502db-116">Données d’identité dans le registre des identités</span><span class="sxs-lookup"><span data-stu-id="502db-116">Identity data in identity registry</span></span> |<span data-ttu-id="502db-117">Perte de données entre 0 et 5 minutes</span><span class="sxs-lookup"><span data-stu-id="502db-117">0-5 mins data loss</span></span> |
| <span data-ttu-id="502db-118">Messages appareil-à-cloud</span><span class="sxs-lookup"><span data-stu-id="502db-118">Device-to-cloud messages</span></span> |<span data-ttu-id="502db-119">Perte de tous les messages non lus</span><span class="sxs-lookup"><span data-stu-id="502db-119">All unread messages are lost</span></span> |
| <span data-ttu-id="502db-120">Messages de surveillance des opérations</span><span class="sxs-lookup"><span data-stu-id="502db-120">Operations monitoring messages</span></span> |<span data-ttu-id="502db-121">Perte de tous les messages non lus</span><span class="sxs-lookup"><span data-stu-id="502db-121">All unread messages are lost</span></span> |
| <span data-ttu-id="502db-122">Messages cloud-à-appareil</span><span class="sxs-lookup"><span data-stu-id="502db-122">Cloud-to-device messages</span></span> |<span data-ttu-id="502db-123">Perte de données entre 0 et 5 minutes</span><span class="sxs-lookup"><span data-stu-id="502db-123">0-5 mins data loss</span></span> |
| <span data-ttu-id="502db-124">File d’attente de rétroaction cloud-à-appareil</span><span class="sxs-lookup"><span data-stu-id="502db-124">Cloud-to-device feedback queue</span></span> |<span data-ttu-id="502db-125">Perte de tous les messages non lus</span><span class="sxs-lookup"><span data-stu-id="502db-125">All unread messages are lost</span></span> |

## <a name="regional-failover-with-iot-hub"></a><span data-ttu-id="502db-126">Basculement régional avec IoT Hub</span><span class="sxs-lookup"><span data-stu-id="502db-126">Regional failover with IoT Hub</span></span>
<span data-ttu-id="502db-127">Un traitement complet des topologies de déploiement dans des solutions IoT dépasserait la portée de cet article.</span><span class="sxs-lookup"><span data-stu-id="502db-127">A complete treatment of deployment topologies in IoT solutions is outside the scope of this article.</span></span> <span data-ttu-id="502db-128">L’article traite du modèle de déploiement avec *basculement régional* pour les besoins de haute disponibilité et de récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="502db-128">The article discusses the *regional failover* deployment model for the purpose of high availability and disaster recovery.</span></span>

<span data-ttu-id="502db-129">Dans un modèle de basculement régional, le serveur principal de solution s’exécute essentiellement dans un emplacement de centre de données, tandis qu’un IoT Hub et un serveur secondaires sont déployés dans un autre emplacement de centre de données.</span><span class="sxs-lookup"><span data-stu-id="502db-129">In a regional failover model, the solution back end runs primarily in one datacenter location, and a secondary IoT hub and back end are deployed in another datacenter location.</span></span> <span data-ttu-id="502db-130">Si l’IoT Hub du centre de données principal subit une panne ou si la connectivité réseau de l’appareil au centre de données principal est interrompue.</span><span class="sxs-lookup"><span data-stu-id="502db-130">If the IoT hub in the primary datacenter suffers an outage or the network connectivity from the device to the primary datacenter is interrupted.</span></span> <span data-ttu-id="502db-131">Les appareils utilisent un point de terminaison secondaire à chaque fois que la passerelle principale ne peut pas être atteinte.</span><span class="sxs-lookup"><span data-stu-id="502db-131">Devices use a secondary service endpoint whenever the primary gateway cannot be reached.</span></span> <span data-ttu-id="502db-132">Grâce à la capacité de basculement entre régions, il est possible d’améliorer la disponibilité de la solution au-delà de la haute disponibilité au niveau d’une seule région.</span><span class="sxs-lookup"><span data-stu-id="502db-132">With a cross-region failover capability, the solution availability can be improved beyond the high availability of a single region.</span></span>

<span data-ttu-id="502db-133">À un niveau supérieur, pour implémenter un modèle de basculement régional avec IoT Hub, vous avez besoin des éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="502db-133">At a high level, to implement a regional failover model with IoT Hub, you need the following:</span></span>

* <span data-ttu-id="502db-134">**Un hub IoT secondaire et un appareil logique de routage secondaire**: en cas d’interruption de service dans votre région principale, les appareils doivent commencer à se connecter à votre région secondaire.</span><span class="sxs-lookup"><span data-stu-id="502db-134">**A secondary IoT hub and device routing logic**: In the case of a service disruption in your primary region, devices must start connecting to your secondary region.</span></span> <span data-ttu-id="502db-135">Étant donné l’état de la plupart des services impliqués, il est courant pour les administrateurs de solution de déclencher le processus de basculement inter-régions.</span><span class="sxs-lookup"><span data-stu-id="502db-135">Given the state-aware nature of most services involved, it is common for solution administrators to trigger the inter-region failover process.</span></span> <span data-ttu-id="502db-136">La meilleure façon de communiquer le nouveau point de terminaison aux appareils tout en conservant le contrôle du processus consiste à consulter régulièrement un service de *conciergerie* pour connaître le point de terminaison actif en cours.</span><span class="sxs-lookup"><span data-stu-id="502db-136">The best way to communicate the new endpoint to devices, while maintaining control of the process, is to have them regularly check a *concierge* service for the current active endpoint.</span></span> <span data-ttu-id="502db-137">Le service de concierge peut être une application web répliquée accessible à l’aide de techniques de redirection DNS (par exemple, l’utilisation d’[Azure Traffic Manager][Azure Traffic Manager]).</span><span class="sxs-lookup"><span data-stu-id="502db-137">The concierge service can be a web application that is replicated and kept reachable using DNS-redirection techniques (for example, using [Azure Traffic Manager][Azure Traffic Manager]).</span></span>
* <span data-ttu-id="502db-138">**Réplication du registre des identités** : pour être utilisable, l’IoT Hub secondaire doit contenir toutes les identités des appareils pouvant se connecter à la solution.</span><span class="sxs-lookup"><span data-stu-id="502db-138">**Identity registry replication** - To be usable, the secondary IoT hub must contain all device identities that can connect to the solution.</span></span> <span data-ttu-id="502db-139">La solution doit conserver des sauvegardes géo-répliquées d’identités d’appareils et les télécharger dans le hub IoT secondaire avant de basculer le point de terminaison actif des appareils.</span><span class="sxs-lookup"><span data-stu-id="502db-139">The solution should keep geo-replicated backups of device identities, and upload them to the secondary IoT hub before switching the active endpoint for the devices.</span></span> <span data-ttu-id="502db-140">La fonctionnalité d’exportation des identités d’appareil d’IoT Hub est utile dans ce contexte.</span><span class="sxs-lookup"><span data-stu-id="502db-140">The device identity export functionality of IoT Hub is useful in this context.</span></span> <span data-ttu-id="502db-141">Pour plus d’informations, consultez[Guide du développeur IoT Hub - Registre des identités][IoT Hub developer guide - identity registry].</span><span class="sxs-lookup"><span data-stu-id="502db-141">For more information, see [IoT Hub developer guide - identity registry][IoT Hub developer guide - identity registry].</span></span>
* <span data-ttu-id="502db-142">**Fusion logique** : lorsque la région principale redevient disponible, l’ensemble des états et des données qui ont été créés dans le site secondaire doit revenir à la région primaire.</span><span class="sxs-lookup"><span data-stu-id="502db-142">**Merging logic** - When the primary region becomes available again, all the state and data that have been created in the secondary site must be migrated back to the primary region.</span></span> <span data-ttu-id="502db-143">Ces états et ces données ont essentiellement trait aux identités des appareils et aux métadonnées d’application qui doivent être fusionnées avec l’IoT Hub principal et d’autres magasins spécifiques de l’application dans la région primaire.</span><span class="sxs-lookup"><span data-stu-id="502db-143">This state and data mostly relates to device identities and application metadata, which must be merged with the primary IoT hub and any other application-specific stores in the primary region.</span></span> <span data-ttu-id="502db-144">Pour simplifier cette étape, vous devez utiliser des opérations idempotentes.</span><span class="sxs-lookup"><span data-stu-id="502db-144">To simplify this step, you should use idempotent operations.</span></span> <span data-ttu-id="502db-145">Des opérations idempotentes minimisent les effets indésirables de la distribution cohérente éventuelle d’événements, et des doublons ou des livraisons d’événements hors d’usage.</span><span class="sxs-lookup"><span data-stu-id="502db-145">Idempotent operations minimize the side-effects from the eventual consistent distribution of events, and from duplicates or out-of-order delivery of events.</span></span> <span data-ttu-id="502db-146">En outre, la logique d’application doit être conçue pour tolérer les éventuelles incohérences ou de légers retards.</span><span class="sxs-lookup"><span data-stu-id="502db-146">In addition, the application logic should be designed to tolerate potential inconsistencies or "slightly" out of date-state.</span></span> <span data-ttu-id="502db-147">Cette situation peut se produire en raison du temps additionnel que le système prend pour se réparer en fonction des objectifs de points de récupération (RPO).</span><span class="sxs-lookup"><span data-stu-id="502db-147">This situation can occur due to the additional time it takes for the system to "heal" based on recovery point objectives (RPO).</span></span>

## <a name="next-steps"></a><span data-ttu-id="502db-148">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="502db-148">Next steps</span></span>
<span data-ttu-id="502db-149">Suivez ces liens pour en savoir plus sur Azure IoT Hub :</span><span class="sxs-lookup"><span data-stu-id="502db-149">Follow these links to learn more about Azure IoT Hub:</span></span>

* <span data-ttu-id="502db-150">[Prise en main des IoT Hubs (didacticiel)][lnk-get-started]</span><span class="sxs-lookup"><span data-stu-id="502db-150">[Get started with IoT Hubs (Tutorial)][lnk-get-started]</span></span>
* <span data-ttu-id="502db-151">[Qu’est-ce qu’Azure IoT Hub ?][What is Azure IoT Hub?]</span><span class="sxs-lookup"><span data-stu-id="502db-151">[What is Azure IoT Hub?][What is Azure IoT Hub?]</span></span>

[Disaster recovery and high availability for Azure applications]: ../resiliency/resiliency-disaster-recovery-high-availability-azure-applications.md
[Azure Business Continuity Technical Guidance]: https://azure.microsoft.com/documentation/articles/resiliency-technical-guidance/
[Azure Traffic Manager]: https://azure.microsoft.com/documentation/services/traffic-manager/
[IoT Hub developer guide - identity registry]: iot-hub-devguide-identity-registry.md

[lnk-get-started]: iot-hub-csharp-csharp-getstarted.md
[What is Azure IoT Hub?]: iot-hub-what-is-iot-hub.md
