---
title: "Comprendre le registre des identités d’Azure IoT Hub | Microsoft Docs"
description: "Guide du développeur - Description du registre des identités IoT Hub et de la manière de l’utiliser pour gérer vos appareils. Contient des informations sur l’importation et l’exportation d’identités d’appareils en bloc."
services: iot-hub
documentationcenter: .net
author: dominicbetts
manager: timlt
editor: 
ms.assetid: 0706eccd-e84c-4ae7-bbd4-2b1a22241147
ms.service: iot-hub
ms.devlang: multiple
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 08/08/2017
ms.author: dobett
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: b6e9c7b71fa6fc78f97c0144c735fc44778181d8
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/18/2017
---
# <a name="understand-the-identity-registry-in-your-iot-hub"></a><span data-ttu-id="46b9e-104">Comprendre le registre des identités dans votre IoT Hub</span><span class="sxs-lookup"><span data-stu-id="46b9e-104">Understand the identity registry in your IoT hub</span></span>

<span data-ttu-id="46b9e-105">Chaque IoT Hub a un registre des identités contenant des informations sur les appareils autorisés à se connecter à l’IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="46b9e-105">Every IoT hub has an identity registry that stores information about the devices permitted to connect to the IoT hub.</span></span> <span data-ttu-id="46b9e-106">Pour qu’un appareil puisse se connecter à un Hub, une entrée correspondant à cet appareil doit figurer dans le registre des identités de l’IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="46b9e-106">Before a device can connect to an IoT hub, there must be an entry for that device in the IoT hub's identity registry.</span></span> <span data-ttu-id="46b9e-107">Un appareil doit également s’authentifier auprès de l’IoT Hub à l’aide des informations d’identification stockées dans le registre des identités.</span><span class="sxs-lookup"><span data-stu-id="46b9e-107">A device must also authenticate with the IoT hub based on credentials stored in the identity registry.</span></span>

<span data-ttu-id="46b9e-108">L’ID d’appareil stocké dans le registre des identités respecte la casse.</span><span class="sxs-lookup"><span data-stu-id="46b9e-108">The device ID stored in the identity registry is case-sensitive.</span></span>

<span data-ttu-id="46b9e-109">À un niveau supérieur, le registre des identités est une collection compatible REST de ressources d’identité d’appareil.</span><span class="sxs-lookup"><span data-stu-id="46b9e-109">At a high level, the identity registry is a REST-capable collection of device identity resources.</span></span> <span data-ttu-id="46b9e-110">Lorsque vous ajoutez une entrée au registre des identités, IoT Hub crée un jeu de ressources par appareil, comme une file d’attente contenant des messages cloud vers appareil en transit.</span><span class="sxs-lookup"><span data-stu-id="46b9e-110">When you add an entry in the identity registry, IoT Hub creates a set of per-device resources such as the queue that contains in-flight cloud-to-device messages.</span></span>

### <a name="when-to-use"></a><span data-ttu-id="46b9e-111">Quand utiliser</span><span class="sxs-lookup"><span data-stu-id="46b9e-111">When to use</span></span>

<span data-ttu-id="46b9e-112">Utilisez le registre des identités lorsque vous avez besoin d’effectuer les actions suivantes :</span><span class="sxs-lookup"><span data-stu-id="46b9e-112">Use the identity registry when you need to:</span></span>

* <span data-ttu-id="46b9e-113">Approvisionner des appareils qui se connectent à votre IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="46b9e-113">Provision devices that connect to your IoT hub.</span></span>
* <span data-ttu-id="46b9e-114">Contrôler l’accès par appareil aux points de terminaison côté appareil de votre concentrateur.</span><span class="sxs-lookup"><span data-stu-id="46b9e-114">Control per-device access to your hub's device-facing endpoints.</span></span>

> [!NOTE]
> <span data-ttu-id="46b9e-115">Le registre des identités ne contient pas de métadonnées spécifiques de l’application.</span><span class="sxs-lookup"><span data-stu-id="46b9e-115">The identity registry does not contain any application-specific metadata.</span></span>

## <a name="identity-registry-operations"></a><span data-ttu-id="46b9e-116">Opérations du registre d’identité</span><span class="sxs-lookup"><span data-stu-id="46b9e-116">Identity registry operations</span></span>

<span data-ttu-id="46b9e-117">Le registre des identités IoT Hub expose les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="46b9e-117">The IoT Hub identity registry exposes the following operations:</span></span>

* <span data-ttu-id="46b9e-118">Création d’une identité d’appareil</span><span class="sxs-lookup"><span data-stu-id="46b9e-118">Create device identity</span></span>
* <span data-ttu-id="46b9e-119">Mise à jour d’une identité d’appareil</span><span class="sxs-lookup"><span data-stu-id="46b9e-119">Update device identity</span></span>
* <span data-ttu-id="46b9e-120">Récupération d’une identité d’appareil par ID</span><span class="sxs-lookup"><span data-stu-id="46b9e-120">Retrieve device identity by ID</span></span>
* <span data-ttu-id="46b9e-121">Suppression d’une identité d’appareil</span><span class="sxs-lookup"><span data-stu-id="46b9e-121">Delete device identity</span></span>
* <span data-ttu-id="46b9e-122">Création de listes contenant jusqu’à 1 000 identités</span><span class="sxs-lookup"><span data-stu-id="46b9e-122">List up to 1000 identities</span></span>
* <span data-ttu-id="46b9e-123">Exportation de toutes les identités vers le stockage Blob Azure</span><span class="sxs-lookup"><span data-stu-id="46b9e-123">Export all identities to Azure blob storage</span></span>
* <span data-ttu-id="46b9e-124">Importation de toutes les identités depuis le stockage Blob Azure</span><span class="sxs-lookup"><span data-stu-id="46b9e-124">Import identities from Azure blob storage</span></span>

<span data-ttu-id="46b9e-125">Toutes ces opérations peuvent utiliser un accès concurrentiel optimiste, comme spécifié dans [RFC7232][lnk-rfc7232].</span><span class="sxs-lookup"><span data-stu-id="46b9e-125">All these operations can use optimistic concurrency, as specified in [RFC7232][lnk-rfc7232].</span></span>

> [!IMPORTANT]
> <span data-ttu-id="46b9e-126">La seule façon de récupérer toutes les identités dans une registre des identités d’IoT Hub consiste à utiliser la fonctionnalité [Exporter][lnk-export].</span><span class="sxs-lookup"><span data-stu-id="46b9e-126">The only way to retrieve all identities in an IoT hub's identity registry is to use the [Export][lnk-export] functionality.</span></span>

<span data-ttu-id="46b9e-127">Un registre des identités IoT Hub :</span><span class="sxs-lookup"><span data-stu-id="46b9e-127">An IoT Hub identity registry:</span></span>

* <span data-ttu-id="46b9e-128">ne contient pas de métadonnées de l’application ;</span><span class="sxs-lookup"><span data-stu-id="46b9e-128">Does not contain any application metadata.</span></span>
* <span data-ttu-id="46b9e-129">est accessible en tant que dictionnaire à l’aide de la clé **deviceId** .</span><span class="sxs-lookup"><span data-stu-id="46b9e-129">Can be accessed like a dictionary, by using the **deviceId** as the key.</span></span>
* <span data-ttu-id="46b9e-130">ne prend pas en charge les requêtes expressives.</span><span class="sxs-lookup"><span data-stu-id="46b9e-130">Does not support expressive queries.</span></span>

<span data-ttu-id="46b9e-131">Une solution IoT possède généralement une zone de stockage distincte spécifique à la solution qui contient les métadonnées propres à l’application.</span><span class="sxs-lookup"><span data-stu-id="46b9e-131">An IoT solution typically has a separate solution-specific store that contains application-specific metadata.</span></span> <span data-ttu-id="46b9e-132">Dans une solution de développement intelligente, par exemple, la zone de stockage spécifique à la solution doit enregistrer l’espace dans lequel un capteur de température sera déployé.</span><span class="sxs-lookup"><span data-stu-id="46b9e-132">For example, the solution-specific store in a smart building solution would record the room in which a temperature sensor is deployed.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="46b9e-133">Utilisez le registre des identités uniquement pour les opérations de gestion et d’approvisionnement.</span><span class="sxs-lookup"><span data-stu-id="46b9e-133">Only use the identity registry for device management and provisioning operations.</span></span> <span data-ttu-id="46b9e-134">Les opérations à haut débit ne doivent pas dépendre de l’exécution d’opérations dans le registre des identités au moment de leur exécution.</span><span class="sxs-lookup"><span data-stu-id="46b9e-134">High throughput operations at run time should not depend on performing operations in the identity registry.</span></span> <span data-ttu-id="46b9e-135">Par exemple, la vérification de l’état de la connexion d’un appareil avant l’envoi d’une commande n’est pas un modèle pris en charge.</span><span class="sxs-lookup"><span data-stu-id="46b9e-135">For example, checking the connection state of a device before sending a command is not a supported pattern.</span></span> <span data-ttu-id="46b9e-136">Veillez à vérifier les [taux de limitation][lnk-quotas] pour le registre des identités et le modèle de [pulsation de l’appareil][lnk-guidance-heartbeat].</span><span class="sxs-lookup"><span data-stu-id="46b9e-136">Make sure to check the [throttling rates][lnk-quotas] for the identity registry, and the [device heartbeat][lnk-guidance-heartbeat] pattern.</span></span>

## <a name="disable-devices"></a><span data-ttu-id="46b9e-137">Désactivation d’appareils</span><span class="sxs-lookup"><span data-stu-id="46b9e-137">Disable devices</span></span>

<span data-ttu-id="46b9e-138">Vous pouvez désactiver les appareils en mettant à jour la propriété **status** d’une identité dans le registre des identités.</span><span class="sxs-lookup"><span data-stu-id="46b9e-138">You can disable devices by updating the **status** property of an identity in the identity registry.</span></span> <span data-ttu-id="46b9e-139">Généralement, cette propriété est utilisée dans deux scénarios :</span><span class="sxs-lookup"><span data-stu-id="46b9e-139">Typically, you use this property in two scenarios:</span></span>

* <span data-ttu-id="46b9e-140">Au cours d’un processus d’orchestration d’approvisionnement.</span><span class="sxs-lookup"><span data-stu-id="46b9e-140">During a provisioning orchestration process.</span></span> <span data-ttu-id="46b9e-141">Pour plus d’informations, voir [Approvisionnement des appareils][lnk-guidance-provisioning].</span><span class="sxs-lookup"><span data-stu-id="46b9e-141">For more information, see [Device Provisioning][lnk-guidance-provisioning].</span></span>
* <span data-ttu-id="46b9e-142">Si, pour une raison quelconque, vous pensez qu’un appareil est compromis ou non autorisé.</span><span class="sxs-lookup"><span data-stu-id="46b9e-142">If, for any reason, you consider a device is compromised or has become unauthorized.</span></span>

## <a name="import-and-export-device-identities"></a><span data-ttu-id="46b9e-143">Importer et exporter les identités des appareils</span><span class="sxs-lookup"><span data-stu-id="46b9e-143">Import and export device identities</span></span>

<span data-ttu-id="46b9e-144">Vous pouvez exporter des identités d’appareils en bloc à partir du registre des identités d’un IoT Hub, par le biais d’opérations asynchrones sur le [point de terminaison d’un fournisseur de ressources IoT Hub][lnk-endpoints].</span><span class="sxs-lookup"><span data-stu-id="46b9e-144">You can export device identities in bulk from an IoT hub's identity registry, by using asynchronous operations on the [IoT Hub resource provider endpoint][lnk-endpoints].</span></span> <span data-ttu-id="46b9e-145">Les exportations sont des tâches à long terme qui utilisent un conteneur d’objets blob fourni par le client pour enregistrer les données relatives à l’identité des appareils lues dans le registre des identités.</span><span class="sxs-lookup"><span data-stu-id="46b9e-145">Exports are long-running jobs that use a customer-supplied blob container to save device identity data read from the identity registry.</span></span>

<span data-ttu-id="46b9e-146">Vous pouvez importer des identités d’appareils en bloc dans le registre des identités d’un IoT Hub, par le biais d’opérations asynchrones sur le [point de terminaison d’un fournisseur de ressources IoT Hub][lnk-endpoints].</span><span class="sxs-lookup"><span data-stu-id="46b9e-146">You can import device identities in bulk to an IoT hub's identity registry, by using asynchronous operations on the [IoT Hub resource provider endpoint][lnk-endpoints].</span></span> <span data-ttu-id="46b9e-147">Les importations sont des tâches à long terme qui utilisent des données dans un conteneur d’objets blob, fourni par le client, pour écrire les données relatives à l’identité des appareils dans le registre des identités.</span><span class="sxs-lookup"><span data-stu-id="46b9e-147">Imports are long-running jobs that use data in a customer-supplied blob container to write device identity data into the identity registry.</span></span>

* <span data-ttu-id="46b9e-148">Pour plus d’informations sur l’importation et l’exportation d’API, voir [IoT Hub - API REST de fournisseur de ressources][lnk-resource-provider-apis].</span><span class="sxs-lookup"><span data-stu-id="46b9e-148">For detailed information about the import and export APIs, see [IoT Hub resource provider REST APIs][lnk-resource-provider-apis].</span></span>
* <span data-ttu-id="46b9e-149">Pour en savoir plus sur l’exécution de tâches d’importation et d’exportation, voir [Gestion en bloc des identités d’appareils IoT Hub][lnk-bulk-identity].</span><span class="sxs-lookup"><span data-stu-id="46b9e-149">To learn more about running import and export jobs, see [Bulk management of IoT Hub device identities][lnk-bulk-identity].</span></span>

## <a name="device-provisioning"></a><span data-ttu-id="46b9e-150">Approvisionnement des appareils</span><span class="sxs-lookup"><span data-stu-id="46b9e-150">Device provisioning</span></span>

<span data-ttu-id="46b9e-151">Les données d’appareil qu’une solution IoT donnée stocke dépendent des exigences spécifiques de cette solution.</span><span class="sxs-lookup"><span data-stu-id="46b9e-151">The device data that a given IoT solution stores depends on the specific requirements of that solution.</span></span> <span data-ttu-id="46b9e-152">Mais une solution doit au minimum stocker les clés d’authentification et les identités des appareils.</span><span class="sxs-lookup"><span data-stu-id="46b9e-152">But, as a minimum, a solution must store device identities and authentication keys.</span></span> <span data-ttu-id="46b9e-153">Azure IoT Hub inclut un registre d’identité qui peut stocker des valeurs pour chaque appareil, comme les ID, les clés d’authentification et les codes d’état.</span><span class="sxs-lookup"><span data-stu-id="46b9e-153">Azure IoT Hub includes an identity registry that can store values for each device such as IDs, authentication keys, and status codes.</span></span> <span data-ttu-id="46b9e-154">Une solution peut utiliser d’autres services Azure, tels que le stockage de tables, le stockage Blob ou Cosmos DB pour stocker des données d’appareil supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="46b9e-154">A solution can use other Azure services such as table storage, blob storage, or Cosmos DB to store any additional device data.</span></span>

<span data-ttu-id="46b9e-155">*Approvisionnement des appareils* est le processus d'ajout des données d'appareil initial aux magasins dans votre solution.</span><span class="sxs-lookup"><span data-stu-id="46b9e-155">*Device provisioning* is the process of adding the initial device data to the stores in your solution.</span></span> <span data-ttu-id="46b9e-156">Pour permettre à un nouvel appareil de se connecter à votre hub, vous devez ajouter un ID et des clés d’appareil au registre des identités d’IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="46b9e-156">To enable a new device to connect to your hub, you must add a device ID and keys to the IoT Hub identity registry.</span></span> <span data-ttu-id="46b9e-157">Dans le cadre du processus d’approvisionnement, vous devrez peut-être initialiser les données spécifiques à l’appareil dans d’autres magasins de la solution.</span><span class="sxs-lookup"><span data-stu-id="46b9e-157">As part of the provisioning process, you might need to initialize device-specific data in other solution stores.</span></span>

## <a name="device-heartbeat"></a><span data-ttu-id="46b9e-158">Pulsation des appareils</span><span class="sxs-lookup"><span data-stu-id="46b9e-158">Device heartbeat</span></span>

<span data-ttu-id="46b9e-159">Le registre des identités IoT Hub contient un champ appelé **connectionState**.</span><span class="sxs-lookup"><span data-stu-id="46b9e-159">The IoT Hub identity registry contains a field called **connectionState**.</span></span> <span data-ttu-id="46b9e-160">Vous ne devez utiliser le champ **connectionState** que pendant le développement et le débogage.</span><span class="sxs-lookup"><span data-stu-id="46b9e-160">Only use the **connectionState** field during development and debugging.</span></span> <span data-ttu-id="46b9e-161">Les solutions IoT ne doivent pas interroger le champ au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="46b9e-161">IoT solutions should not query the field at run time.</span></span> <span data-ttu-id="46b9e-162">Par exemple, n’interrogez pas le champ **connectionState** pour vérifier si un appareil est connecté avant d’envoyer un message cloud vers appareil ou un SMS.</span><span class="sxs-lookup"><span data-stu-id="46b9e-162">For example, do not query the **connectionState** field to check if a device is connected before you send a cloud-to-device message or an SMS.</span></span>

<span data-ttu-id="46b9e-163">Si votre solution IoT a besoin de savoir si un appareil est connecté, vous devez implémenter le *modèle de pulsation*.</span><span class="sxs-lookup"><span data-stu-id="46b9e-163">If your IoT solution needs to know if a device is connected, you should implement the *heartbeat pattern*.</span></span>

<span data-ttu-id="46b9e-164">Dans le modèle par pulsations, l’appareil envoie des messages appareil-à-cloud au moins une fois par durée fixe (par exemple, au moins une fois par heure).</span><span class="sxs-lookup"><span data-stu-id="46b9e-164">In the heartbeat pattern, the device sends device-to-cloud messages at least once every fixed amount of time (for example, at least once every hour).</span></span> <span data-ttu-id="46b9e-165">Ainsi, même si un appareil n’a pas de données à envoyer, il envoie toujours un message appareil-à-cloud vide (généralement avec une propriété qui l’identifie comme pulsation).</span><span class="sxs-lookup"><span data-stu-id="46b9e-165">Therefore, even if a device does not have any data to send, it still sends an empty device-to-cloud message (usually with a property that identifies it as a heartbeat).</span></span> <span data-ttu-id="46b9e-166">Côté service, la solution gère un mappage avec la dernière pulsation reçue pour chaque appareil.</span><span class="sxs-lookup"><span data-stu-id="46b9e-166">On the service side, the solution maintains a map with the last heartbeat received for each device.</span></span> <span data-ttu-id="46b9e-167">Si la solution ne reçoit pas de message de pulsation dans le temps imparti de la part de l’appareil, elle suppose qu’il y a un problème avec l’appareil.</span><span class="sxs-lookup"><span data-stu-id="46b9e-167">If the solution does not receive a heartbeat message within the expected time from the device, it assumes that there is a problem with the device.</span></span>

<span data-ttu-id="46b9e-168">Une implémentation plus complexe pourrait inclure les informations de la [surveillance des opérations][lnk-devguide-opmon] pour identifier les appareils qui ne parviennent pas à se connecter ou à communiquer.</span><span class="sxs-lookup"><span data-stu-id="46b9e-168">A more complex implementation could include the information from [operations monitoring][lnk-devguide-opmon] to identify devices that are trying to connect or communicate but failing.</span></span> <span data-ttu-id="46b9e-169">Quand vous implémentez le modèle par pulsations, veillez à vérifier les [quotas et limitations IoT Hub][lnk-quotas].</span><span class="sxs-lookup"><span data-stu-id="46b9e-169">When you implement the heartbeat pattern, make sure to check [IoT Hub Quotas and Throttles][lnk-quotas].</span></span>

> [!NOTE]
> <span data-ttu-id="46b9e-170">Si une solution IoT utilise uniquement l’état de la connexion de l’appareil pour déterminer si elle doit envoyer des messages cloud vers appareil, et que ces messages ne sont pas diffusés à de larges groupes d’appareils, envisagez d’utiliser un modèle de *délai d’expiration court* plus simple.</span><span class="sxs-lookup"><span data-stu-id="46b9e-170">If an IoT solution uses the connection state solely to determine whether to send cloud-to-device messages, and messages are not broadcast to large sets of devices, consider using the simpler *short expiry time* pattern.</span></span> <span data-ttu-id="46b9e-171">Ce modèle permet d’obtenir le même résultat qu’en maintenant l’état de la connexion de l’appareil avec sa pulsation, tout en étant plus efficace.</span><span class="sxs-lookup"><span data-stu-id="46b9e-171">This pattern achieves the same result as maintaining a device connection state registry using the heartbeat pattern, while being more efficient.</span></span> <span data-ttu-id="46b9e-172">Si vous demandez des accusés de réception des messages, IoT Hub peut vous informer sur les appareils en mesure de recevoir des messages et ceux qui ne le sont pas.</span><span class="sxs-lookup"><span data-stu-id="46b9e-172">If you request message acknowledgements, IoT Hub can notify you about which devices are able to receive messages and which are not.</span></span>

## <a name="device-lifecycle-notifications"></a><span data-ttu-id="46b9e-173">Notifications de cycle de vie des appareils</span><span class="sxs-lookup"><span data-stu-id="46b9e-173">Device lifecycle notifications</span></span>

<span data-ttu-id="46b9e-174">IoT Hub peut avertir votre solution IoT lorsqu’une identité d’appareil est créée ou supprimée, en envoyant des notifications de cycle de vie des appareils.</span><span class="sxs-lookup"><span data-stu-id="46b9e-174">IoT Hub can notify your IoT solution when a device identity is created or deleted by sending device lifecycle notifications.</span></span> <span data-ttu-id="46b9e-175">Pour ce faire, votre solution IoT doit créer un itinéraire et définir la source de données *DeviceLifecycleEvents*.</span><span class="sxs-lookup"><span data-stu-id="46b9e-175">To do so, your IoT solution needs to create a route and to set the Data Source equal to *DeviceLifecycleEvents*.</span></span> <span data-ttu-id="46b9e-176">Par défaut, aucune notification du cycle de vie n’est envoyée. Autrement dit, aucun itinéraire n’existe préalablement.</span><span class="sxs-lookup"><span data-stu-id="46b9e-176">By default, no lifecycle notifications are sent, that is, no such routes pre-exist.</span></span> <span data-ttu-id="46b9e-177">Le message de notification inclut le corps et les propriétés.</span><span class="sxs-lookup"><span data-stu-id="46b9e-177">The notification message includes properties, and body.</span></span>

<span data-ttu-id="46b9e-178">Propriétés : les propriétés système du message ont pour préfixe le symbole `'$'`.</span><span class="sxs-lookup"><span data-stu-id="46b9e-178">Properties: Message system properties are prefixed with the `'$'` symbol.</span></span>

| <span data-ttu-id="46b9e-179">Nom</span><span class="sxs-lookup"><span data-stu-id="46b9e-179">Name</span></span> | <span data-ttu-id="46b9e-180">Valeur</span><span class="sxs-lookup"><span data-stu-id="46b9e-180">Value</span></span> |
| --- | --- |
<span data-ttu-id="46b9e-181">$content-type</span><span class="sxs-lookup"><span data-stu-id="46b9e-181">$content-type</span></span> | <span data-ttu-id="46b9e-182">application/json</span><span class="sxs-lookup"><span data-stu-id="46b9e-182">application/json</span></span> |
<span data-ttu-id="46b9e-183">$iothub-enqueuedtime</span><span class="sxs-lookup"><span data-stu-id="46b9e-183">$iothub-enqueuedtime</span></span> |  <span data-ttu-id="46b9e-184">Heure d’envoi de la notification</span><span class="sxs-lookup"><span data-stu-id="46b9e-184">Time when the notification was sent</span></span> |
<span data-ttu-id="46b9e-185">$iothub-message-source</span><span class="sxs-lookup"><span data-stu-id="46b9e-185">$iothub-message-source</span></span> | <span data-ttu-id="46b9e-186">deviceLifecycleEvents</span><span class="sxs-lookup"><span data-stu-id="46b9e-186">deviceLifecycleEvents</span></span> |
<span data-ttu-id="46b9e-187">$content-encoding</span><span class="sxs-lookup"><span data-stu-id="46b9e-187">$content-encoding</span></span> | <span data-ttu-id="46b9e-188">utf-8</span><span class="sxs-lookup"><span data-stu-id="46b9e-188">utf-8</span></span> |
<span data-ttu-id="46b9e-189">opType</span><span class="sxs-lookup"><span data-stu-id="46b9e-189">opType</span></span> | <span data-ttu-id="46b9e-190">**createDeviceIdentity** ou **deleteDeviceIdentity**</span><span class="sxs-lookup"><span data-stu-id="46b9e-190">**createDeviceIdentity** or **deleteDeviceIdentity**</span></span> |
<span data-ttu-id="46b9e-191">hubName</span><span class="sxs-lookup"><span data-stu-id="46b9e-191">hubName</span></span> | <span data-ttu-id="46b9e-192">Nom de l’IoT Hub</span><span class="sxs-lookup"><span data-stu-id="46b9e-192">Name of IoT Hub</span></span> |
<span data-ttu-id="46b9e-193">deviceId</span><span class="sxs-lookup"><span data-stu-id="46b9e-193">deviceId</span></span> | <span data-ttu-id="46b9e-194">ID de l’appareil</span><span class="sxs-lookup"><span data-stu-id="46b9e-194">ID of the device</span></span> |
<span data-ttu-id="46b9e-195">operationTimestamp</span><span class="sxs-lookup"><span data-stu-id="46b9e-195">operationTimestamp</span></span> | <span data-ttu-id="46b9e-196">Horodatage ISO8601 de l’opération</span><span class="sxs-lookup"><span data-stu-id="46b9e-196">ISO8601 timestamp of operation</span></span> |
<span data-ttu-id="46b9e-197">iothub-message-schema</span><span class="sxs-lookup"><span data-stu-id="46b9e-197">iothub-message-schema</span></span> | <span data-ttu-id="46b9e-198">deviceLifecycleNotification</span><span class="sxs-lookup"><span data-stu-id="46b9e-198">deviceLifecycleNotification</span></span> |

<span data-ttu-id="46b9e-199">Corps : cette section est au format JSON et représente le double de l’identité d’appareil créé.</span><span class="sxs-lookup"><span data-stu-id="46b9e-199">Body: This section is in JSON format and represents the twin of the created device identity.</span></span> <span data-ttu-id="46b9e-200">Par exemple,</span><span class="sxs-lookup"><span data-stu-id="46b9e-200">For example,</span></span>

```json
{
    "deviceId":"11576-ailn-test-0-67333793211",
    "etag":"AAAAAAAAAAE=",
    "properties": {
        "desired": {
            "$metadata": {
                "$lastUpdated": "2016-02-30T16:24:48.789Z"
            },
            "$version": 1
        },
        "reported": {
            "$metadata": {
                "$lastUpdated": "2016-02-30T16:24:48.789Z"
            },
            "$version": 1
        }
    }
}
```

## <a name="reference-topics"></a><span data-ttu-id="46b9e-201">Rubriques de référence :</span><span class="sxs-lookup"><span data-stu-id="46b9e-201">Reference topics:</span></span>

<span data-ttu-id="46b9e-202">Les rubriques de référence suivantes fournissent des informations supplémentaires sur le registre des identités.</span><span class="sxs-lookup"><span data-stu-id="46b9e-202">The following reference topics provide you with more information about the identity registry.</span></span>

## <a name="device-identity-properties"></a><span data-ttu-id="46b9e-203">Propriétés d’identité des appareils</span><span class="sxs-lookup"><span data-stu-id="46b9e-203">Device identity properties</span></span>

<span data-ttu-id="46b9e-204">Les identités des appareils sont représentées sous forme de documents JSON avec les propriétés suivantes :</span><span class="sxs-lookup"><span data-stu-id="46b9e-204">Device identities are represented as JSON documents with the following properties:</span></span>

| <span data-ttu-id="46b9e-205">Propriété</span><span class="sxs-lookup"><span data-stu-id="46b9e-205">Property</span></span> | <span data-ttu-id="46b9e-206">Options</span><span class="sxs-lookup"><span data-stu-id="46b9e-206">Options</span></span> | <span data-ttu-id="46b9e-207">Description</span><span class="sxs-lookup"><span data-stu-id="46b9e-207">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="46b9e-208">deviceId</span><span class="sxs-lookup"><span data-stu-id="46b9e-208">deviceId</span></span> |<span data-ttu-id="46b9e-209">obligatoire, en lecture seule sur les mises à jour</span><span class="sxs-lookup"><span data-stu-id="46b9e-209">required, read-only on updates</span></span> |<span data-ttu-id="46b9e-210">Une chaîne qui respecte la casse (jusqu’à 128 caractères) de caractères alphanumériques 7 bits ASCII + `{'-', ':', '.', '+', '%', '_', '#', '*', '?', '!', '(', ')', ',', '=', '@', ';', '$', '''}`.</span><span class="sxs-lookup"><span data-stu-id="46b9e-210">A case-sensitive string (up to 128 characters long) of ASCII 7-bit alphanumeric characters + `{'-', ':', '.', '+', '%', '_', '#', '*', '?', '!', '(', ')', ',', '=', '@', ';', '$', '''}`.</span></span> |
| <span data-ttu-id="46b9e-211">generationId</span><span class="sxs-lookup"><span data-stu-id="46b9e-211">generationId</span></span> |<span data-ttu-id="46b9e-212">obligatoire, en lecture seule</span><span class="sxs-lookup"><span data-stu-id="46b9e-212">required, read-only</span></span> |<span data-ttu-id="46b9e-213">Une chaîne qui respecte la casse, générée par IoT Hub, d’une longueur maximale de 128 caractères.</span><span class="sxs-lookup"><span data-stu-id="46b9e-213">An IoT hub-generated, case-sensitive string up to 128 characters long.</span></span> <span data-ttu-id="46b9e-214">Cette valeur permet de distinguer les appareils dotés du même **deviceId**lorsqu’ils ont été supprimés et recréés.</span><span class="sxs-lookup"><span data-stu-id="46b9e-214">This value is used to distinguish devices with the same **deviceId**, when they have been deleted and re-created.</span></span> |
| <span data-ttu-id="46b9e-215">etag</span><span class="sxs-lookup"><span data-stu-id="46b9e-215">etag</span></span> |<span data-ttu-id="46b9e-216">obligatoire, en lecture seule</span><span class="sxs-lookup"><span data-stu-id="46b9e-216">required, read-only</span></span> |<span data-ttu-id="46b9e-217">Une chaîne représentant un ETag faible pour l’identité d’appareil, conformément à [RFC7232][lnk-rfc7232].</span><span class="sxs-lookup"><span data-stu-id="46b9e-217">A string representing a weak ETag for the device identity, as per [RFC7232][lnk-rfc7232].</span></span> |
| <span data-ttu-id="46b9e-218">auth</span><span class="sxs-lookup"><span data-stu-id="46b9e-218">auth</span></span> |<span data-ttu-id="46b9e-219">facultatif</span><span class="sxs-lookup"><span data-stu-id="46b9e-219">optional</span></span> |<span data-ttu-id="46b9e-220">Un objet composite contenant des informations d’authentification et des éléments de sécurité.</span><span class="sxs-lookup"><span data-stu-id="46b9e-220">A composite object containing authentication information and security materials.</span></span> |
| <span data-ttu-id="46b9e-221">auth.symkey</span><span class="sxs-lookup"><span data-stu-id="46b9e-221">auth.symkey</span></span> |<span data-ttu-id="46b9e-222">facultatif</span><span class="sxs-lookup"><span data-stu-id="46b9e-222">optional</span></span> |<span data-ttu-id="46b9e-223">Un objet composite contenant une clé primaire et une clé secondaire, stockées au format base64.</span><span class="sxs-lookup"><span data-stu-id="46b9e-223">A composite object containing a primary and a secondary key, stored in base64 format.</span></span> |
| <span data-ttu-id="46b9e-224">status</span><span class="sxs-lookup"><span data-stu-id="46b9e-224">status</span></span> |<span data-ttu-id="46b9e-225">required</span><span class="sxs-lookup"><span data-stu-id="46b9e-225">required</span></span> |<span data-ttu-id="46b9e-226">Un indicateur d’accès.</span><span class="sxs-lookup"><span data-stu-id="46b9e-226">An access indicator.</span></span> <span data-ttu-id="46b9e-227">Peut être **Activé** ou **Désactivé**.</span><span class="sxs-lookup"><span data-stu-id="46b9e-227">Can be **Enabled** or **Disabled**.</span></span> <span data-ttu-id="46b9e-228">Si la propriété est définie sur **Activé**, l’appareil est autorisé à se connecter.</span><span class="sxs-lookup"><span data-stu-id="46b9e-228">If **Enabled**, the device is allowed to connect.</span></span> <span data-ttu-id="46b9e-229">Si la propriété est définie sur **Désactivé**, cet appareil ne peut pas accéder à un point de terminaison de l’appareil.</span><span class="sxs-lookup"><span data-stu-id="46b9e-229">If **Disabled**, this device cannot access any device-facing endpoint.</span></span> |
| <span data-ttu-id="46b9e-230">statusReason</span><span class="sxs-lookup"><span data-stu-id="46b9e-230">statusReason</span></span> |<span data-ttu-id="46b9e-231">facultatif</span><span class="sxs-lookup"><span data-stu-id="46b9e-231">optional</span></span> |<span data-ttu-id="46b9e-232">Une chaîne de 128 caractères qui stocke le motif de l’état de l’identité de l’appareil.</span><span class="sxs-lookup"><span data-stu-id="46b9e-232">A 128 character-long string that stores the reason for the device identity status.</span></span> <span data-ttu-id="46b9e-233">Tous les caractères UTF-8 sont autorisés.</span><span class="sxs-lookup"><span data-stu-id="46b9e-233">All UTF-8 characters are allowed.</span></span> |
| <span data-ttu-id="46b9e-234">statusUpdateTime</span><span class="sxs-lookup"><span data-stu-id="46b9e-234">statusUpdateTime</span></span> |<span data-ttu-id="46b9e-235">en lecture seule</span><span class="sxs-lookup"><span data-stu-id="46b9e-235">read-only</span></span> |<span data-ttu-id="46b9e-236">Un indicateur temporel, indiquant la date et l’heure de la dernière mise à jour de l’état.</span><span class="sxs-lookup"><span data-stu-id="46b9e-236">A temporal indicator, showing the date and time of the last status update.</span></span> |
| <span data-ttu-id="46b9e-237">connectionState</span><span class="sxs-lookup"><span data-stu-id="46b9e-237">connectionState</span></span> |<span data-ttu-id="46b9e-238">en lecture seule</span><span class="sxs-lookup"><span data-stu-id="46b9e-238">read-only</span></span> |<span data-ttu-id="46b9e-239">Un champ indiquant l’état de la connexion : **Connecté** ou **Déconnecté**.</span><span class="sxs-lookup"><span data-stu-id="46b9e-239">A field indicating connection status: either **Connected** or **Disconnected**.</span></span> <span data-ttu-id="46b9e-240">Ce champ représente la vue IoT Hub de l’état de connexion de l’appareil.</span><span class="sxs-lookup"><span data-stu-id="46b9e-240">This field represents the IoT Hub view of the device connection status.</span></span> <span data-ttu-id="46b9e-241">**Important**  : ce champ doit être utilisé uniquement à des fins de développement et de débogage.</span><span class="sxs-lookup"><span data-stu-id="46b9e-241">**Important**: This field should be used only for development/debugging purposes.</span></span> <span data-ttu-id="46b9e-242">L’état de la connexion est mis à jour uniquement pour les appareils utilisant les protocoles AMQP ou MQTT.</span><span class="sxs-lookup"><span data-stu-id="46b9e-242">The connection state is updated only for devices using MQTT or AMQP.</span></span> <span data-ttu-id="46b9e-243">Cet état est basé sur les pings au niveau du protocole (tests ping MQTT ou AMQP) et peut avoir un délai maximum de 5 minutes seulement.</span><span class="sxs-lookup"><span data-stu-id="46b9e-243">Also, it is based on protocol-level pings (MQTT pings, or AMQP pings), and it can have a maximum delay of only 5 minutes.</span></span> <span data-ttu-id="46b9e-244">Pour ces raisons, de faux positifs peuvent survenir. Par exemple : un appareil peut être signalé comme étant connecté, alors qu’il est déconnecté.</span><span class="sxs-lookup"><span data-stu-id="46b9e-244">For these reasons, there can be false positives, such as devices reported as connected but that are disconnected.</span></span> |
| <span data-ttu-id="46b9e-245">connectionStateUpdatedTime</span><span class="sxs-lookup"><span data-stu-id="46b9e-245">connectionStateUpdatedTime</span></span> |<span data-ttu-id="46b9e-246">en lecture seule</span><span class="sxs-lookup"><span data-stu-id="46b9e-246">read-only</span></span> |<span data-ttu-id="46b9e-247">Un indicateur temporel, indiquant la date et la dernière heure de mise à jour de l’état de la connexion.</span><span class="sxs-lookup"><span data-stu-id="46b9e-247">A temporal indicator, showing the date and last time the connection state was updated.</span></span> |
| <span data-ttu-id="46b9e-248">lastActivityTime</span><span class="sxs-lookup"><span data-stu-id="46b9e-248">lastActivityTime</span></span> |<span data-ttu-id="46b9e-249">en lecture seule</span><span class="sxs-lookup"><span data-stu-id="46b9e-249">read-only</span></span> |<span data-ttu-id="46b9e-250">Un indicateur temporel, indiquant la date et la dernière heure de connexion de l’appareil, de réception d’un message ou d’envoi d’un message.</span><span class="sxs-lookup"><span data-stu-id="46b9e-250">A temporal indicator, showing the date and last time the device connected, received, or sent a message.</span></span> |

> [!NOTE]
> <span data-ttu-id="46b9e-251">L’état de la connexion peut uniquement représenter la vue IoT Hub de l’état de la connexion.</span><span class="sxs-lookup"><span data-stu-id="46b9e-251">Connection state can only represent the IoT Hub view of the status of the connection.</span></span> <span data-ttu-id="46b9e-252">Les mises à jour à cet état peuvent être différées en fonction des conditions et des configurations du réseau.</span><span class="sxs-lookup"><span data-stu-id="46b9e-252">Updates to this state may be delayed, depending on network conditions and configurations.</span></span>

## <a name="additional-reference-material"></a><span data-ttu-id="46b9e-253">Matériel de référence supplémentaire</span><span class="sxs-lookup"><span data-stu-id="46b9e-253">Additional reference material</span></span>

<span data-ttu-id="46b9e-254">Les autres rubriques de référence dans le Guide du développeur IoT Hub comprennent :</span><span class="sxs-lookup"><span data-stu-id="46b9e-254">Other reference topics in the IoT Hub developer guide include:</span></span>

* <span data-ttu-id="46b9e-255">La rubrique [Points de terminaison IoT Hub][lnk-endpoints] décrit les différents points de terminaison que chaque IoT Hub expose pour les opérations d’exécution et de gestion.</span><span class="sxs-lookup"><span data-stu-id="46b9e-255">[IoT Hub endpoints][lnk-endpoints] describes the various endpoints that each IoT hub exposes for run-time and management operations.</span></span>
* <span data-ttu-id="46b9e-256">La rubrique [Référence - Quotas et limitation IoT Hub][lnk-quotas] décrit les quotas et le comportement de limitation qui s’appliquent au service IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="46b9e-256">[Throttling and quotas][lnk-quotas] describes the quotas and throttling behaviors that apply to the IoT Hub service.</span></span>
* <span data-ttu-id="46b9e-257">La section [Azure IoT device et service SDK][lnk-sdks] répertorie les Kits de développement logiciel (SDK) en différents langages que vous pouvez utiliser pour le développement d’applications d’appareil et de service qui interagissent avec IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="46b9e-257">[Azure IoT device and service SDKs][lnk-sdks] lists the various language SDKs you can use when you develop both device and service apps that interact with IoT Hub.</span></span>
* <span data-ttu-id="46b9e-258">La rubrique [Référence - Langage de requête IoT Hub pour les jumeaux d’appareil, les travaux et le routage des messages][lnk-query] décrit le langage de requête permettant de récupérer à partir d’IoT Hub des informations sur des jumeaux d’appareil et des travaux.</span><span class="sxs-lookup"><span data-stu-id="46b9e-258">[IoT Hub query language][lnk-query] describes the query language you can use to retrieve information from IoT Hub about your device twins and jobs.</span></span>
* <span data-ttu-id="46b9e-259">La rubrique [Prise en charge de MQTT au niveau d’IoT Hub][lnk-devguide-mqtt] fournit des informations supplémentaires sur la prise en charge du protocole MQTT par IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="46b9e-259">[IoT Hub MQTT support][lnk-devguide-mqtt] provides more information about IoT Hub support for the MQTT protocol.</span></span>

## <a name="next-steps"></a><span data-ttu-id="46b9e-260">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="46b9e-260">Next steps</span></span>

<span data-ttu-id="46b9e-261">À présent que vous savez comment utiliser le registre des identités IoT Hub, vous serez peut-être intéressé par les rubriques suivantes du Guide du développeur Iot Hub :</span><span class="sxs-lookup"><span data-stu-id="46b9e-261">Now you have learned how to use the IoT Hub identity registry, you may be interested in the following IoT Hub developer guide topics:</span></span>

* <span data-ttu-id="46b9e-262">[Contrôler l’accès à IoT Hub][lnk-devguide-security]</span><span class="sxs-lookup"><span data-stu-id="46b9e-262">[Control access to IoT Hub][lnk-devguide-security]</span></span>
* <span data-ttu-id="46b9e-263">[Utiliser des représentations d’appareil pour synchroniser les données d’état et de configuration][lnk-devguide-device-twins]</span><span class="sxs-lookup"><span data-stu-id="46b9e-263">[Use device twins to synchronize state and configurations][lnk-devguide-device-twins]</span></span>
* <span data-ttu-id="46b9e-264">[Appeler une méthode directe sur un appareil][lnk-devguide-directmethods]</span><span class="sxs-lookup"><span data-stu-id="46b9e-264">[Invoke a direct method on a device][lnk-devguide-directmethods]</span></span>
* <span data-ttu-id="46b9e-265">[Planifier des travaux sur plusieurs appareils][lnk-devguide-jobs]</span><span class="sxs-lookup"><span data-stu-id="46b9e-265">[Schedule jobs on multiple devices][lnk-devguide-jobs]</span></span>

<span data-ttu-id="46b9e-266">Si vous souhaitez tenter de mettre en pratique certains des concepts décrits dans cet article, vous serez peut-être intéressé par les didacticiels IoT Hub suivants :</span><span class="sxs-lookup"><span data-stu-id="46b9e-266">If you would like to try out some of the concepts described in this article, you may be interested in the following IoT Hub tutorial:</span></span>

* <span data-ttu-id="46b9e-267">[Mise en route d’Azure IoT Hub][lnk-getstarted-tutorial]</span><span class="sxs-lookup"><span data-stu-id="46b9e-267">[Get started with Azure IoT Hub][lnk-getstarted-tutorial]</span></span>

<!-- Links and images -->

[lnk-endpoints]: iot-hub-devguide-endpoints.md
[lnk-quotas]: iot-hub-devguide-quotas-throttling.md
[lnk-sdks]: iot-hub-devguide-sdks.md
[lnk-query]: iot-hub-devguide-query-language.md
[lnk-devguide-mqtt]: iot-hub-mqtt-support.md
[lnk-resource-provider-apis]: https://docs.microsoft.com/rest/api/iothub/iothubresource
[lnk-guidance-provisioning]: iot-hub-devguide-identity-registry.md#device-provisioning
[lnk-guidance-heartbeat]: iot-hub-devguide-identity-registry.md#device-heartbeat
[lnk-rfc7232]: https://tools.ietf.org/html/rfc7232
[lnk-bulk-identity]: iot-hub-bulk-identity-mgmt.md
[lnk-export]: iot-hub-devguide-identity-registry.md#import-and-export-device-identities
[lnk-devguide-opmon]: iot-hub-operations-monitoring.md

[lnk-devguide-security]: iot-hub-devguide-security.md
[lnk-devguide-device-twins]: iot-hub-devguide-device-twins.md
[lnk-devguide-directmethods]: iot-hub-devguide-direct-methods.md
[lnk-devguide-jobs]: iot-hub-devguide-jobs.md

[lnk-getstarted-tutorial]: iot-hub-csharp-csharp-getstarted.md
