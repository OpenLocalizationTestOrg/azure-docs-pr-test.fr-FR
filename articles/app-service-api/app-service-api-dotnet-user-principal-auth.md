---
title: authentification aaaUser pour API Apps dans Azure App Service | Documents Microsoft
description: "Découvrez comment tooprotect une application API dans Azure App Service en permettant aux tooauthenticated seuls utilisateurs."
services: app-service\api
documentationcenter: .net
author: alexkarcher-msft
manager: erikre
editor: 
ms.assetid: 3896760d-46ff-4b67-b98a-edd233f24758
ms.service: app-service-api
ms.workload: na
ms.tgt_pltfrm: dotnet
ms.devlang: na
ms.topic: article
ms.date: 06/30/2016
ms.author: alkarche
ms.openlocfilehash: 4702fc77fcfe736405e22b033c35d22ae3c5a300
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="user-authentication-for-api-apps-in-azure-app-service"></a><span data-ttu-id="831ea-103">Authentification utilisateur pour API Apps dans Azure App Service</span><span class="sxs-lookup"><span data-stu-id="831ea-103">User authentication for API Apps in Azure App Service</span></span>
## <a name="overview"></a><span data-ttu-id="831ea-104">Vue d'ensemble</span><span class="sxs-lookup"><span data-stu-id="831ea-104">Overview</span></span>
<span data-ttu-id="831ea-105">Cet article explique comment tooprotect une application API Azure afin que seuls les utilisateurs authentifiés permettre appeler.</span><span class="sxs-lookup"><span data-stu-id="831ea-105">This article shows how tooprotect an Azure API app so that only authenticated users can call it.</span></span> <span data-ttu-id="831ea-106">Hello article suppose que vous avez lu hello [vue d’ensemble de l’authentification du Service d’applications Azure](../app-service/app-service-authentication-overview.md).</span><span class="sxs-lookup"><span data-stu-id="831ea-106">hello article assumes that you have read hello [Azure App Service authentication overview](../app-service/app-service-authentication-overview.md).</span></span>

<span data-ttu-id="831ea-107">Vous apprendrez ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="831ea-107">You'll learn:</span></span>

* <span data-ttu-id="831ea-108">Comment tooconfigure un fournisseur d’authentification, avec les détails pour Azure Active Directory (Azure AD).</span><span class="sxs-lookup"><span data-stu-id="831ea-108">How tooconfigure an authentication provider, with details for Azure Active Directory (Azure AD).</span></span>
* <span data-ttu-id="831ea-109">Comment une application API protégée à l’aide de tooconsume hello [Active Directory Authentication Library (ADAL) pour JavaScript](https://github.com/AzureAD/azure-activedirectory-library-for-js).</span><span class="sxs-lookup"><span data-stu-id="831ea-109">How tooconsume a protected API app by using hello [Active Directory Authentication Library (ADAL) for JavaScript](https://github.com/AzureAD/azure-activedirectory-library-for-js).</span></span>

<span data-ttu-id="831ea-110">article de Hello contient deux sections :</span><span class="sxs-lookup"><span data-stu-id="831ea-110">hello article contains two sections:</span></span>

* <span data-ttu-id="831ea-111">Hello [comment l’authentification des utilisateurs dans Azure App Service tooconfigure](#authconfig) section explique de façon générale tooconfigure l’authentification utilisateur pour n’importe quelle application d’API et s’applique aussi bien les infrastructures tooall pris en charge par le Service d’application, y compris .NET, Node.js et Java.</span><span class="sxs-lookup"><span data-stu-id="831ea-111">hello [How tooconfigure user authentication in Azure App Service](#authconfig) section explains in general how tooconfigure user authentication for any API app and applies equally tooall frameworks supported by App Service, including .NET, Node.js, and Java.</span></span>
* <span data-ttu-id="831ea-112">En commençant par hello [continuer didacticiels d’applications d’API .NET hello](#tutorialstart) section, hello guides article vous guide dans la configuration d’un exemple d’application avec un .NET back-end et un frontal AngularJS afin qu’il utilise Azure Active Directory pour l’utilisateur authentification.</span><span class="sxs-lookup"><span data-stu-id="831ea-112">Starting with hello [Continuing hello .NET API Apps tutorials](#tutorialstart) section, hello article guides you through configuring a sample application with a .NET back end and an AngularJS front end so that it uses Azure Active Directory for user authentication.</span></span> 

## <span data-ttu-id="831ea-113"><a id="authconfig"></a>Comment tooconfigure l’authentification des utilisateurs dans Azure App Service</span><span class="sxs-lookup"><span data-stu-id="831ea-113"><a id="authconfig"></a> How tooconfigure user authentication in Azure App Service</span></span>
<span data-ttu-id="831ea-114">Cette section fournit des instructions générales qui s’appliquent tooany API app.</span><span class="sxs-lookup"><span data-stu-id="831ea-114">This section provides general instructions that apply tooany API app.</span></span> <span data-ttu-id="831ea-115">Pour tooDo de toohello spécifique comme exemple d’application .NET de la liste, consultez trop[poursuivre les didacticiels de prise en main de .NET hello](#tutorialstart).</span><span class="sxs-lookup"><span data-stu-id="831ea-115">For steps specific toohello tooDo List .NET sample application, go too[Continuing hello .NET getting-started tutorials](#tutorialstart).</span></span>

1. <span data-ttu-id="831ea-116">Bonjour [portail Azure](https://portal.azure.com/), accédez toohello **paramètres** Panneau de l’application hello API que vous souhaitez tooprotect, rechercher hello **fonctionnalités** section, puis cliquez sur  **L’authentification / autorisation**.</span><span class="sxs-lookup"><span data-stu-id="831ea-116">In hello [Azure portal](https://portal.azure.com/), navigate toohello **Settings** blade of hello API app that you want tooprotect, find hello **Features** section, and then click **Authentication/ Authorization**.</span></span>
   
    ![Authentification/Autorisation du portail Azure](./media/app-service-api-dotnet-user-principal-auth/features.png)
2. <span data-ttu-id="831ea-118">Bonjour **l’authentification / autorisation** panneau, cliquez sur **sur**.</span><span class="sxs-lookup"><span data-stu-id="831ea-118">In hello **Authentication / Authorization** blade, click **On**.</span></span>
3. <span data-ttu-id="831ea-119">Sélectionnez une des options de hello dans hello **tootake Action lors de la demande n’est pas authentifiée** liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="831ea-119">Select one of hello options from hello **Action tootake when request is not authenticated** drop-down list.</span></span>
   
   * <span data-ttu-id="831ea-120">Si vous souhaitez uniquement appels authentifiés tooreach votre application API, choisissez l’une des hello **connexion...**  options.</span><span class="sxs-lookup"><span data-stu-id="831ea-120">If you want only authenticated calls tooreach your API app, choose one of hello **Log in with ...** options.</span></span> <span data-ttu-id="831ea-121">Cette option permet de vous tooprotect hello application API sans écrire de code qui s’exécute qu’elle contient.</span><span class="sxs-lookup"><span data-stu-id="831ea-121">This option enables you tooprotect hello API app without writing any code that runs in it.</span></span>
   * <span data-ttu-id="831ea-122">Si vous souhaitez que tous les appels tooreach votre application API, choisissez **autoriser les requêtes (aucune action)**.</span><span class="sxs-lookup"><span data-stu-id="831ea-122">If you want all calls tooreach your API app, choose **Allow request (no action)**.</span></span> <span data-ttu-id="831ea-123">Vous pouvez utiliser ce choix de tooa option toodirect non authentifié aux appelants de fournisseurs d’authentification.</span><span class="sxs-lookup"><span data-stu-id="831ea-123">You can use this option toodirect unauthenticated callers tooa choice of authentication providers.</span></span> <span data-ttu-id="831ea-124">Avec cette option, vous avez l’autorisation de toohandle toowrite code.</span><span class="sxs-lookup"><span data-stu-id="831ea-124">With this option you have toowrite code toohandle authorization.</span></span>
     
     <span data-ttu-id="831ea-125">Pour plus d’informations, consultez la page [Authentification et autorisation pour API Apps dans Azure App Service](app-service-api-authentication.md#multiple-protection-options).</span><span class="sxs-lookup"><span data-stu-id="831ea-125">For more information, see [Authentication and authorization for API Apps in Azure App Service](app-service-api-authentication.md#multiple-protection-options).</span></span>
4. <span data-ttu-id="831ea-126">Sélectionnez un ou plusieurs des hello **fournisseurs d’authentification**.</span><span class="sxs-lookup"><span data-stu-id="831ea-126">Select one or more of hello **Authentication Providers**.</span></span>
   
    <span data-ttu-id="831ea-127">image de Hello affiche les options qui nécessitent tous les appelants toobe authentifiées par Azure AD.</span><span class="sxs-lookup"><span data-stu-id="831ea-127">hello image shows    choices that require all callers toobe authenticated by Azure AD.</span></span>
   
    ![Panneau Authentification/Autorisation du portail Azure](./media/app-service-api-dotnet-user-principal-auth/authblade.png)
   
    <span data-ttu-id="831ea-129">Lorsque vous choisissez un fournisseur d’authentification, le portail de hello affiche un panneau de configuration pour ce fournisseur.</span><span class="sxs-lookup"><span data-stu-id="831ea-129">When you choose an authentication provider, hello portal displays a configuration blade for that provider.</span></span> 
   
    <span data-ttu-id="831ea-130">Pour obtenir des instructions détaillées qui expliquent comment tooconfigure hello panneaux de configuration de fournisseur d’authentification, consultez [comment tooconfigure votre connexion de Service d’applications application toouse Azure Active Directory](../app-service-mobile/app-service-mobile-how-to-configure-active-directory-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="831ea-130">For detailed instructions that explain how tooconfigure hello authentication provider configuration blades, see [How tooconfigure your App Service application toouse Azure Active Directory login](../app-service-mobile/app-service-mobile-how-to-configure-active-directory-authentication.md).</span></span> <span data-ttu-id="831ea-131">(lien de hello va article tooan sur Azure AD, mais l’article hello lui-même contient des onglets qui lient tooarticles hello pour les autres fournisseurs d’authentification).</span><span class="sxs-lookup"><span data-stu-id="831ea-131">(hello link goes tooan article about Azure AD, but hello article itself contains tabs that link tooarticles for hello other authentication providers.)</span></span>
5. <span data-ttu-id="831ea-132">Lorsque vous avez terminé avec le panneau de configuration de fournisseur d’authentification hello, cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="831ea-132">When you're done with hello authentication provider configuration blade, click **OK**.</span></span>
6. <span data-ttu-id="831ea-133">Bonjour **l’authentification / autorisation** panneau, cliquez sur **enregistrer**.</span><span class="sxs-lookup"><span data-stu-id="831ea-133">In hello **Authentication / Authorization** blade, click **Save**.</span></span>

<span data-ttu-id="831ea-134">Dans ce cas, du Service d’applications s’authentifie à tous les appels d’API avant qu’ils atteignent l’application d’API hello.</span><span class="sxs-lookup"><span data-stu-id="831ea-134">When this is done, App Service authenticates all API calls before they reach hello API app.</span></span> <span data-ttu-id="831ea-135">travail des services d’authentification Hello hello identique pour toutes les langues qui prend en charge du service d’applications, y compris .NET, Node.js et Java.</span><span class="sxs-lookup"><span data-stu-id="831ea-135">hello authentication services work hello same for all languages that App service supports, including .NET, Node.js, and Java.</span></span> 

<span data-ttu-id="831ea-136">toomake authentifié d’appels d’API, l’appelant de hello inclut un jeton de porteur OAuth 2.0 du fournisseur d’authentification hello dans l’en-tête d’autorisation de hello de requêtes HTTP.</span><span class="sxs-lookup"><span data-stu-id="831ea-136">toomake authenticated API calls, hello caller includes hello authentication provider's OAuth 2.0 bearer token in hello Authorization header of HTTP requests.</span></span> <span data-ttu-id="831ea-137">jeton de Hello peut être obtenu à l’aide du Kit de développement logiciel du fournisseur d’authentification hello.</span><span class="sxs-lookup"><span data-stu-id="831ea-137">hello token can be acquired by using hello authentication provider's SDK.</span></span>

## <span data-ttu-id="831ea-138"><a id="tutorialstart"></a>Didacticiels d’applications d’API .NET hello continues</span><span class="sxs-lookup"><span data-stu-id="831ea-138"><a id="tutorialstart"></a> Continuing hello .NET API Apps tutorials</span></span>
<span data-ttu-id="831ea-139">Si vous suivez des didacticiels de Node.js ou Java hello pour les applications d’API, ignorer l’article suivant de toohello, [l’authentification principale du service pour les applications de l’API](app-service-api-dotnet-service-principal-auth.md).</span><span class="sxs-lookup"><span data-stu-id="831ea-139">If you are following hello Node.js or Java tutorials for API apps, skip toohello next article, [service principal authentication for API apps](app-service-api-dotnet-service-principal-auth.md).</span></span> 

<span data-ttu-id="831ea-140">Si vous sont les suivantes : série de didacticiels .NET hello pour les applications de l’API et que vous avez déjà déployé un exemple d’application hello comme indiqué dans l’hello [première](app-service-api-dotnet-get-started.md) et [deuxième](app-service-api-cors-consume-javascript.md) didacticiels, ignorer toohello [configurer l’authentification dans le Service d’application et Azure AD](#azureauth) section.</span><span class="sxs-lookup"><span data-stu-id="831ea-140">If you are following hello .NET tutorial series for API apps and have already deployed hello sample application as directed in hello [first](app-service-api-dotnet-get-started.md) and [second](app-service-api-cors-consume-javascript.md) tutorials, skip toohello [Set up authentication in App Service and Azure AD](#azureauth) section.</span></span>

<span data-ttu-id="831ea-141">Si vous souhaitez toofollow de ce didacticiel sans passer par les didacticiels de première et deuxième hello, procédez comme hello suivant les étapes qui expliquent comment tooget démarrer à l’aide d’un exemple d’application hello toodeploy processus automatisé.</span><span class="sxs-lookup"><span data-stu-id="831ea-141">If you want toofollow this tutorial without going through hello first and second tutorials, do hello following steps which explain how tooget started by using an automated process toodeploy hello sample application.</span></span>

> [!NOTE]
> <span data-ttu-id="831ea-142">Hello suit obtenir vous toohello à partir du même point comme si vous hello deux premiers didacticiels, à une exception près : Visual Studio ne sont pas informés déjà les application API qui chaque projet est déployé dans l’application web.</span><span class="sxs-lookup"><span data-stu-id="831ea-142">hello following steps get you toohello same starting point as if you did hello first two tutorials, with one exception: Visual Studio won't already know which web app or API app that each project gets deployed to.</span></span> <span data-ttu-id="831ea-143">Cela signifie que vous n’avez pas des instructions précises dans ce didacticiel expliquant comment les cibles de droite toohello toodeploy.</span><span class="sxs-lookup"><span data-stu-id="831ea-143">That means you won't have exact instructions in this tutorial that explain how toodeploy toohello right targets.</span></span> <span data-ttu-id="831ea-144">Si vous n’êtes pas familiarisé avec déterminant comment les étapes sur votre propre déploiement de hello toodo, il est mieux série de didacticiels de hello toofollow de hello [premier didacticiel](app-service-api-dotnet-get-started.md) à toostart avec ce automatisée des processus de déploiement.</span><span class="sxs-lookup"><span data-stu-id="831ea-144">If you're not comfortable with figuring out how toodo hello deployment steps on your own, it's better toofollow hello tutorial series from hello [first tutorial](app-service-api-dotnet-get-started.md) than toostart with this automated deployment process.</span></span>
> 
> 

1. <span data-ttu-id="831ea-145">Assurez-vous que vous disposez de toutes les conditions préalables de hello répertoriées Bonjour [premier didacticiel](app-service-api-dotnet-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="831ea-145">Make sure that you have all of hello prerequisites listed in hello [first tutorial](app-service-api-dotnet-get-started.md).</span></span> <span data-ttu-id="831ea-146">Dans Ajout toohello conditions préalables répertoriées, ces didacticiels authentification supposent que vous avez travaillé avec des applications de Service d’applications web et les API des applications dans Visual Studio et hello portail Azure.</span><span class="sxs-lookup"><span data-stu-id="831ea-146">In addition toohello prerequisites listed, these authentication tutorials assume that you have worked with App Service web apps and API apps in Visual Studio and hello Azure portal.</span></span>
2. <span data-ttu-id="831ea-147">Cliquez sur hello **déployer tooAzure** bouton Bonjour [le fichier Lisez-moi référentiel tooDo liste exemple](https://github.com/azure-samples/app-service-api-dotnet-todo-list/blob/master/readme.md) toodeploy hello API apps et hello web app.</span><span class="sxs-lookup"><span data-stu-id="831ea-147">Click hello **Deploy tooAzure** button in hello [tooDo List sample repository readme file](https://github.com/azure-samples/app-service-api-dotnet-todo-list/blob/master/readme.md) toodeploy hello API apps and hello web app.</span></span> <span data-ttu-id="831ea-148">Prenez note de groupe de ressources Azure hello qui a été créée, vous pouvez utiliser cette toolook ultérieure d’application web et les noms d’application API.</span><span class="sxs-lookup"><span data-stu-id="831ea-148">Make a note of hello Azure resource group that gets created, as you can use this later toolook up web app and API app names.</span></span>
3. <span data-ttu-id="831ea-149">Téléchargement ou hello du clone [dépôt d’exemples liste tooDo](https://github.com/Azure-Samples/app-service-api-dotnet-todo-list) code hello tooget que vous allez utiliser localement dans Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="831ea-149">Download or clone hello [tooDo List sample repository](https://github.com/Azure-Samples/app-service-api-dotnet-todo-list) tooget hello code that you'll work with locally in Visual Studio.</span></span>

## <span data-ttu-id="831ea-150"><a id="azureauth"></a> Configurer l’authentification dans App Service et Azure AD</span><span class="sxs-lookup"><span data-stu-id="831ea-150"><a id="azureauth"></a> Set up authentication in App Service and Azure AD</span></span>
<span data-ttu-id="831ea-151">Vous disposez désormais d’application hello en cours d’exécution dans Azure App Service sans exiger que les utilisateurs soit authentifié.</span><span class="sxs-lookup"><span data-stu-id="831ea-151">You now have hello application running in Azure App Service without requiring that users be authenticated.</span></span> <span data-ttu-id="831ea-152">Dans cette section vous ajoutez l’authentification en procédant comme hello tâches suivantes :</span><span class="sxs-lookup"><span data-stu-id="831ea-152">In this section you add authentication by doing hello following tasks:</span></span>

* <span data-ttu-id="831ea-153">Configurer l’authentification du Service d’applications toorequire Azure Active Directory (Azure AD) pour l’appel d’application de couche intermédiaire API hello.</span><span class="sxs-lookup"><span data-stu-id="831ea-153">Configure App Service toorequire Azure Active Directory (Azure AD) authentication for calling hello middle tier API app.</span></span>
* <span data-ttu-id="831ea-154">Créez une application Azure AD.</span><span class="sxs-lookup"><span data-stu-id="831ea-154">Create an Azure AD application.</span></span>
* <span data-ttu-id="831ea-155">Configurer le jeton de porteur hello de hello Azure AD application toosend après frontal d’ouverture de session toohello AngularJS.</span><span class="sxs-lookup"><span data-stu-id="831ea-155">Configure hello Azure AD application toosend hello bearer token after logon toohello AngularJS front end.</span></span> 

<span data-ttu-id="831ea-156">Si vous rencontrez des problèmes lors des instructions didacticiel hello suivantes, consultez hello [dépannage](#troubleshooting) section à fin hello du didacticiel de hello.</span><span class="sxs-lookup"><span data-stu-id="831ea-156">If you run into problems while following hello tutorial directions, see hello [Troubleshooting](#troubleshooting) section at hello end of hello tutorial.</span></span> 

### <a name="configure-authentication-for-hello-middle-tier-api-app"></a><span data-ttu-id="831ea-157">Configurer l’authentification pour le niveau intermédiaire de hello application API</span><span class="sxs-lookup"><span data-stu-id="831ea-157">Configure authentication for hello middle tier API app</span></span>
1. <span data-ttu-id="831ea-158">Bonjour [portail Azure](https://portal.azure.com/), accédez toohello **paramètres** Panneau de l’application hello API que vous avez créé pour le projet de ToDoListAPI hello, recherche hello **fonctionnalités** section, puis Cliquez sur **l’authentification / autorisation**.</span><span class="sxs-lookup"><span data-stu-id="831ea-158">In hello [Azure portal](https://portal.azure.com/), navigate toohello **Settings** blade of hello API app that you created for hello ToDoListAPI project, find hello **Features** section, and then click **Authentication / Authorization**.</span></span>
   
    ![Authentification/Autorisation du portail Azure](./media/app-service-api-dotnet-user-principal-auth/features.png)
2. <span data-ttu-id="831ea-160">Bonjour **l’authentification / autorisation** panneau, cliquez sur **sur**.</span><span class="sxs-lookup"><span data-stu-id="831ea-160">In hello **Authentication / Authorization** blade, click **On**.</span></span>
3. <span data-ttu-id="831ea-161">Bonjour **tootake Action lors de la demande n’est pas authentifiée** la liste déroulante, sélectionnez **se connecter avec Azure Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="831ea-161">In hello **Action tootake when request is not authenticated** drop-down list, select **Log in with Azure Active Directory**.</span></span>
   
    <span data-ttu-id="831ea-162">Cette option permet de s’assurer qu’aucune demande unauathenticated n’atteindra hello API app.</span><span class="sxs-lookup"><span data-stu-id="831ea-162">This option ensures that no unauathenticated requests will reach hello API app.</span></span> 
4. <span data-ttu-id="831ea-163">Sous **Fournisseurs d’authentification**, cliquez sur **Azure Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="831ea-163">Under **Authentication Providers**, click **Azure Active Directory**.</span></span>
   
    ![Panneau Authentification/Autorisation du portail Azure](./media/app-service-api-dotnet-user-principal-auth/authblade.png)
5. <span data-ttu-id="831ea-165">Bonjour **paramètres Azure Active Directory** panneau, cliquez sur **Express**</span><span class="sxs-lookup"><span data-stu-id="831ea-165">In hello **Azure Active Directory Settings** blade, click **Express**</span></span>
   
    ![Option Express du panneau Authentification/Autorisation du portail Azure](./media/app-service-api-dotnet-user-principal-auth/aadsettings.png)
   
    <span data-ttu-id="831ea-167">Avec hello **Express** option, du Service d’applications peut automatiquement créer une application Azure AD dans votre annuaire Azure AD [client](https://msdn.microsoft.com/en-us/library/azure/jj573650.aspx#BKMK_WhatIsAnAzureADTenant).</span><span class="sxs-lookup"><span data-stu-id="831ea-167">With hello **Express** option, App Service can automatically create an Azure AD application in your Azure AD [tenant](https://msdn.microsoft.com/en-us/library/azure/jj573650.aspx#BKMK_WhatIsAnAzureADTenant).</span></span> 
   
    <span data-ttu-id="831ea-168">Vous n’avez toocreate d’un client, car chaque compte Azure a automatiquement un.</span><span class="sxs-lookup"><span data-stu-id="831ea-168">You don't have toocreate a tenant, because every Azure account automatically has one.</span></span>
6. <span data-ttu-id="831ea-169">Sous **mode de gestion**, cliquez sur **créer une application AD** s’il n’est pas déjà sélectionnée, notez la valeur hello hello **créer application** zone de texte ; vous devez rechercher cette AAD application Bonjour portail classique Azure plus tard.</span><span class="sxs-lookup"><span data-stu-id="831ea-169">Under **Management mode**, click **Create New AD App** if it isn't already selected, and notice hello value that is in hello **Create App** text box; you'll look up this AAD application in hello Azure classic portal later.</span></span>
   
    ![Paramètres Azure AD du portail Azure](./media/app-service-api-dotnet-user-principal-auth/aadsettings2.png)
   
    <span data-ttu-id="831ea-171">Azure crée automatiquement une application Azure AD avec hello le nom indiqué dans votre locataire Azure AD.</span><span class="sxs-lookup"><span data-stu-id="831ea-171">Azure will automatically create an Azure AD application with hello indicated name in your Azure AD tenant.</span></span> <span data-ttu-id="831ea-172">Par défaut, hello application Azure AD est nommé même hello en tant qu’application hello API.</span><span class="sxs-lookup"><span data-stu-id="831ea-172">By default, hello Azure AD application is named hello same as hello API app.</span></span> <span data-ttu-id="831ea-173">Vous pouvez, si vous le souhaitez, choisir un autre nom.</span><span class="sxs-lookup"><span data-stu-id="831ea-173">If you prefer, you can enter a different name.</span></span>
7. <span data-ttu-id="831ea-174">Cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="831ea-174">Click **OK**.</span></span>
8. <span data-ttu-id="831ea-175">Bonjour **l’authentification / autorisation** panneau, cliquez sur **enregistrer**.</span><span class="sxs-lookup"><span data-stu-id="831ea-175">In hello **Authentication / Authorization** blade, click **Save**.</span></span>
   
    ![Cliquez sur Enregistrer.](./media/app-service-api-dotnet-user-principal-auth/authsave.png)

<span data-ttu-id="831ea-177">Maintenant seulement les utilisateurs dans votre locataire Azure AD peuvent appeler application d’API hello.</span><span class="sxs-lookup"><span data-stu-id="831ea-177">Now only users in your Azure AD tenant can call hello API app.</span></span>

### <a name="optional-test-hello-api-app"></a><span data-ttu-id="831ea-178">Facultatif : Application hello API de Test</span><span class="sxs-lookup"><span data-stu-id="831ea-178">Optional: Test hello API app</span></span>
1. <span data-ttu-id="831ea-179">Dans un navigateur, accédez toohello des URL de l’application hello API : Bonjour **application API** panneau Bonjour portail Azure, cliquez sur le lien hello sous **URL**.</span><span class="sxs-lookup"><span data-stu-id="831ea-179">In a browser go toohello URL of hello API app: in hello **API app** blade in hello Azure portal, click hello link under **URL**.</span></span>  
   
    <span data-ttu-id="831ea-180">Vous êtes écran de connexion tooa redirigé, car les demandes non authentifiées ne sont pas autorisées tooreach hello API app.</span><span class="sxs-lookup"><span data-stu-id="831ea-180">You are redirected tooa login screen because unauthenticated requests are not allowed tooreach hello API app.</span></span>
   
    <span data-ttu-id="831ea-181">Si votre navigateur est toohello « a été créé » page, navigateur de hello peut-être déjà être enregistré--dans ce cas, ouvrez une fenêtre de navigation InPrivate ou Incognito et atteindre l’URL de l’application toohello API.</span><span class="sxs-lookup"><span data-stu-id="831ea-181">If your browser goes toohello "successfully created" page, hello browser might already be logged on -- in that case, open an InPrivate or Incognito window and go toohello API app's URL.</span></span>
2. <span data-ttu-id="831ea-182">Connectez-vous avec les informations d’identification d’un utilisateur de votre client Azure AD.</span><span class="sxs-lookup"><span data-stu-id="831ea-182">Log on using credentials for a user in your Azure AD tenant.</span></span>
   
    <span data-ttu-id="831ea-183">Lorsque vous êtes connecté, la page de « correctement créée » de hello s’affiche dans le navigateur de hello.</span><span class="sxs-lookup"><span data-stu-id="831ea-183">When you're logged on, hello "successfully created" page appears in hello browser.</span></span>
3. <span data-ttu-id="831ea-184">Navigateur de fermer hello.</span><span class="sxs-lookup"><span data-stu-id="831ea-184">Close hello browser.</span></span>

### <a name="configure-hello-azure-ad-application"></a><span data-ttu-id="831ea-185">Configurer l’application hello Azure AD</span><span class="sxs-lookup"><span data-stu-id="831ea-185">Configure hello Azure AD application</span></span>
<span data-ttu-id="831ea-186">Lorsque vous avez configuré l’authentification Azure AD, App Service a créé pour vous une application Azure AD.</span><span class="sxs-lookup"><span data-stu-id="831ea-186">When you configured Azure AD authentication, App Service created an Azure AD application for you.</span></span> <span data-ttu-id="831ea-187">Par défaut, application hello nouveau Azure AD a été configuré tooprovide hello PORTEUR jeton toohello API URL de l’application.</span><span class="sxs-lookup"><span data-stu-id="831ea-187">By default hello new Azure AD application was configured tooprovide hello bearer token toohello API app's URL.</span></span> <span data-ttu-id="831ea-188">Dans cette section vous configurerez hello Azure AD application tooprovide hello PORTEUR jeton toohello AngularJS frontal au lieu de l’application de couche intermédiaire API de toohello directement.</span><span class="sxs-lookup"><span data-stu-id="831ea-188">In this section you configure hello Azure AD application tooprovide hello bearer token toohello AngularJS front end instead of directly toohello middle tier API app.</span></span> <span data-ttu-id="831ea-189">serveur frontal AngularJS Hello enverra hello jeton toohello API application lorsqu’il appelle l’application d’API hello.</span><span class="sxs-lookup"><span data-stu-id="831ea-189">hello AngularJS front end will send hello token toohello API app when it calls hello API app.</span></span>

> [!NOTE]
> <span data-ttu-id="831ea-190">processus de hello tookeep aussi simples que possible, ce didacticiel utilise une annonce Azure application frontale hello et application de couche intermédiaire API hello.</span><span class="sxs-lookup"><span data-stu-id="831ea-190">tookeep hello process as simple as possible, this tutorial uses a single Azure AD application for both hello front end and hello middle tier API app.</span></span> <span data-ttu-id="831ea-191">Une autre option consiste à toouse deux des applications Azure AD.</span><span class="sxs-lookup"><span data-stu-id="831ea-191">Another option is toouse two Azure AD applications.</span></span> <span data-ttu-id="831ea-192">Dans ce cas, vous devez de toogive hello frontal Azure AD application autorisation toocall hello d’Azure AD application de couche intermédiaire.</span><span class="sxs-lookup"><span data-stu-id="831ea-192">In that case you would have toogive hello front end's Azure AD application permission toocall hello middle tier's Azure AD application.</span></span> <span data-ttu-id="831ea-193">Cette approche d’application multiples permet d’obtenir un contrôle plus précis de la couche de tooeach d’autorisations.</span><span class="sxs-lookup"><span data-stu-id="831ea-193">This multi-application approach would give you more granular control over permissions tooeach tier.</span></span>
> 
> 

1. <span data-ttu-id="831ea-194">Bonjour [portail Azure classic](https://manage.windowsazure.com/), accédez trop**Azure Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="831ea-194">In hello [Azure classic portal](https://manage.windowsazure.com/), go too**Azure Active Directory**.</span></span>
   
   <span data-ttu-id="831ea-195">Vous avez portail classique de toouse hello, car certains paramètres d’Azure Active Directory dont vous avez besoin d’accéder à tooare pas encore disponible dans le portail Azure actuel de hello.</span><span class="sxs-lookup"><span data-stu-id="831ea-195">You have toouse hello classic portal because certain Azure Active Directory settings that you need access tooare not yet available in hello current Azure portal.</span></span>
2. <span data-ttu-id="831ea-196">Sur hello **répertoire** , cliquez sur votre client AAD.</span><span class="sxs-lookup"><span data-stu-id="831ea-196">On hello **Directory** tab, click your AAD tenant.</span></span>
   
   ![Azure AD dans le portail classique](./media/app-service-api-dotnet-user-principal-auth/selecttenant.png)
3. <span data-ttu-id="831ea-198">Cliquez sur **Applications > Applications que ma société possède**, puis cliquez sur la case à cocher hello.</span><span class="sxs-lookup"><span data-stu-id="831ea-198">Click **Applications > Applications my company owns**, and then click hello check mark.</span></span>
   
   <span data-ttu-id="831ea-199">Vous pouvez également disposer toorefresh hello page toosee hello nouvelle application.</span><span class="sxs-lookup"><span data-stu-id="831ea-199">You might also have toorefresh hello page toosee hello new application.</span></span>
4. <span data-ttu-id="831ea-200">Dans la liste de hello des applications, cliquez sur nom hello hello Azure créée pour vous lorsque vous avez activé l’authentification pour votre application API.</span><span class="sxs-lookup"><span data-stu-id="831ea-200">In hello list of applications, click hello name of hello one that Azure created for you when you enabled authentication for your API app.</span></span>
   
   ![Onglet Applications Azure AD](./media/app-service-api-dotnet-user-principal-auth/appstab.png)
5. <span data-ttu-id="831ea-202">Cliquez sur **Configurer**.</span><span class="sxs-lookup"><span data-stu-id="831ea-202">Click **Configure**.</span></span>
   
   ![Onglet Configurer Azure AD](./media/app-service-api-dotnet-user-principal-auth/configure.png)
6. <span data-ttu-id="831ea-204">Définissez **URL de connexion** toohello des URL pour votre application web AngularJS, aucune barre oblique.</span><span class="sxs-lookup"><span data-stu-id="831ea-204">Set **Sign-on URL** toohello URL for your AngularJS web app, no trailing slash.</span></span>
   
   <span data-ttu-id="831ea-205">Par exemple : https://todolistangular.azurewebsites.net</span><span class="sxs-lookup"><span data-stu-id="831ea-205">For example: https://todolistangular.azurewebsites.net</span></span>
   
   ![URL de connexion](./media/app-service-api-dotnet-user-principal-auth/signonurlazure.png)
7. <span data-ttu-id="831ea-207">Définissez **URL de réponse** toohello des URL pour votre application web, aucune barre oblique.</span><span class="sxs-lookup"><span data-stu-id="831ea-207">Set **Reply URL** toohello URL for your web app, no trailing slash.</span></span>
   
   <span data-ttu-id="831ea-208">Par exemple : https://todolistsangular.azurewebsites.net</span><span class="sxs-lookup"><span data-stu-id="831ea-208">For example: https://todolistsangular.azurewebsites.net</span></span>
8. <span data-ttu-id="831ea-209">Cliquez sur **Enregistrer**.</span><span class="sxs-lookup"><span data-stu-id="831ea-209">Click **Save**.</span></span>
   
   ![URL de réponse](./media/app-service-api-dotnet-user-principal-auth/replyurlazure.png)
9. <span data-ttu-id="831ea-211">Au bas de hello de page de hello, cliquez sur **gérer manifeste > téléchargement manifeste**.</span><span class="sxs-lookup"><span data-stu-id="831ea-211">At hello bottom of hello page, click **Manage manifest > Download manifest**.</span></span>
   
   ![Télécharger le manifeste](./media/app-service-api-dotnet-user-principal-auth/downloadmanifest.png)
10. <span data-ttu-id="831ea-213">Téléchargez hello tooa emplacement_fichier où vous pouvez les modifier.</span><span class="sxs-lookup"><span data-stu-id="831ea-213">Download hello file tooa location where you can edit it.</span></span>
11. <span data-ttu-id="831ea-214">Dans le fichier de manifeste hello téléchargé, recherchez hello `oauth2AllowImplicitFlow` propriété.</span><span class="sxs-lookup"><span data-stu-id="831ea-214">In hello downloaded manifest file, search for hello  `oauth2AllowImplicitFlow` property.</span></span> <span data-ttu-id="831ea-215">Modifier la valeur hello de cette propriété à partir de `false` trop`true`, puis enregistrez le fichier de hello.</span><span class="sxs-lookup"><span data-stu-id="831ea-215">Change hello value of this property from `false` too`true`, and then save hello file.</span></span>
    
    <span data-ttu-id="831ea-216">Ce paramètre est obligatoire pour l’accès depuis une application de page JavaScript unique.</span><span class="sxs-lookup"><span data-stu-id="831ea-216">This setting is required for access from a JavaScript single-page application.</span></span> <span data-ttu-id="831ea-217">Il permet de toobe jeton du porteur Oauth 2.0 hello retournée dans un fragment d’URL hello.</span><span class="sxs-lookup"><span data-stu-id="831ea-217">It enables hello Oauth 2.0 bearer token toobe returned in hello URL fragment.</span></span>
12. <span data-ttu-id="831ea-218">Cliquez sur **gérer manifeste > téléchargement manifeste**et le téléchargement hello fichier mis à jour dans hello précédant l’étape.</span><span class="sxs-lookup"><span data-stu-id="831ea-218">Click **Manage manifest > Upload manifest**, and upload hello file that you updated in hello preceding step.</span></span>
    
    ![Télécharger le manifeste sur le serveur](./media/app-service-api-dotnet-user-principal-auth/uploadmanifest.png)
13. <span data-ttu-id="831ea-220">Hello de copie **ID Client** valeur et l’enregistrer dans un endroit vous pouvez l’obtenir à partir de versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="831ea-220">Copy hello **Client ID** value and save it somewhere you can get it from later.</span></span>

## <a name="configure-hello-todolistangular-project-toouse-authentication"></a><span data-ttu-id="831ea-221">Configurer l’authentification de hello ToDoListAngular projet toouse</span><span class="sxs-lookup"><span data-stu-id="831ea-221">Configure hello ToDoListAngular project toouse authentication</span></span>
<span data-ttu-id="831ea-222">Dans cette section, vous modifiez le frontal AngularJS hello afin qu’il utilise Active Directory Authentication Library (ADAL) pour JS tooacquire un jeton de support pour l’utilisateur connecté hello d’Azure AD.</span><span class="sxs-lookup"><span data-stu-id="831ea-222">In this section you change hello AngularJS front end so that it uses Active Directory Authentication Library (ADAL) for JS tooacquire a bearer token for hello logged-on user from Azure AD.</span></span> <span data-ttu-id="831ea-223">code de Hello inclut hello jeton dans les requêtes HTTP envoyées toohello de couche intermédiaire, comme indiqué dans hello suivant schéma.</span><span class="sxs-lookup"><span data-stu-id="831ea-223">hello code will include hello token in HTTP requests sent toohello middle tier, as shown in hello following diagram.</span></span> 

![Diagramme d’authentification de l’utilisateur](./media/app-service-api-dotnet-user-principal-auth/appdiagram.png)

<span data-ttu-id="831ea-225">Rendre hello suivant toofiles des modifications dans le projet de ToDoListAngular hello.</span><span class="sxs-lookup"><span data-stu-id="831ea-225">Make hello following changes toofiles in hello ToDoListAngular project.</span></span>

1. <span data-ttu-id="831ea-226">Ouvrez hello *index.cshtml* fichier.</span><span class="sxs-lookup"><span data-stu-id="831ea-226">Open hello *index.cshtml* file.</span></span>
2. <span data-ttu-id="831ea-227">Supprimez les commentaires des lignes hello qui font référence à hello Active Directory Authentication Library (ADAL) pour les scripts JS.</span><span class="sxs-lookup"><span data-stu-id="831ea-227">Uncomment hello lines that reference hello Active Directory Authentication Library (ADAL) for JS scripts.</span></span>
   
        <script src="app/scripts/adal.js"></script>
        <script src="app/scripts/adal-angular.js"></script>
3. <span data-ttu-id="831ea-228">Ouvrez hello *app/scripts/app.js* fichier.</span><span class="sxs-lookup"><span data-stu-id="831ea-228">Open hello *app/scripts/app.js* file.</span></span>
4. <span data-ttu-id="831ea-229">Commentez bloc hello de code marqué pour « sans authentification » et supprimez les commentaires de bloc hello de code marqué pour « avec l’authentification ».</span><span class="sxs-lookup"><span data-stu-id="831ea-229">Comment out hello block of code marked for "without authentication" and uncomment hello block of code marked for "with authentication".</span></span>
   
    <span data-ttu-id="831ea-230">Cette modification fait référence à un fournisseur d’authentification ADAL JS hello et fournit des tooit de valeurs de configuration.</span><span class="sxs-lookup"><span data-stu-id="831ea-230">This change references hello ADAL JS authentication provider and provides configuration values tooit.</span></span> <span data-ttu-id="831ea-231">Bonjour, comme suit, vous définir des valeurs de configuration hello pour votre application API et l’application Azure AD.</span><span class="sxs-lookup"><span data-stu-id="831ea-231">In hello following steps you set hello configuration values for your API app and Azure AD application.</span></span>
5. <span data-ttu-id="831ea-232">Dans le code hello qui définit hello `endpoints` hello variable, affectez la valeur URL de l’API toohello URL de l’application hello API que vous avez créé pour le projet de ToDoListAPI hello, définissez hello Azure AD ID toohello client ID d’application que vous avez copié à partir de hello portail Azure classic.</span><span class="sxs-lookup"><span data-stu-id="831ea-232">In hello code that sets hello `endpoints` variable, set hello API URL toohello URL of hello API app that you created for hello ToDoListAPI project, and set hello Azure AD application ID toohello client ID that you copied from hello Azure classic portal.</span></span>
   
    <span data-ttu-id="831ea-233">code de Hello est désormais toohello similaire, l’exemple suivant.</span><span class="sxs-lookup"><span data-stu-id="831ea-233">hello code is now similar toohello following example.</span></span>
   
        var endpoints = {
            "https://todolistapi0121.azurewebsites.net/": "1cf55bc9-9ed8-4df31cf55bc9-9ed8-4df3"
        };
6. <span data-ttu-id="831ea-234">Bonjour, appelez trop`adalProvider.init`, définissez `tenant` tooyour nom_client et `clientId` valeur toosame utilisé à l’étape précédente de hello.</span><span class="sxs-lookup"><span data-stu-id="831ea-234">In hello call too`adalProvider.init`, set `tenant` tooyour tenant name and `clientId` toosame value you used in hello previous step.</span></span>
   
    <span data-ttu-id="831ea-235">code de Hello est désormais toohello similaire, l’exemple suivant.</span><span class="sxs-lookup"><span data-stu-id="831ea-235">hello code is now similar toohello following example.</span></span>
   
        adalProvider.init(
            {
                instance: 'https://login.microsoftonline.com/', 
                tenant: 'contoso.onmicrosoft.com',
                clientId: '1cf55bc9-9ed8-4df31cf55bc9-9ed8-4df3',
                extraQueryParameter: 'nux=1',
                endpoints: endpoints
            },
            $httpProvider
            );
   
    <span data-ttu-id="831ea-236">Ces modifications trop`app.js` spécifier que le code appelant de hello et hello appelé API sont dans l’application hello même instance Azure AD.</span><span class="sxs-lookup"><span data-stu-id="831ea-236">These changes too`app.js` specify that hello calling code and hello called API are in hello same Azure AD application.</span></span>
7. <span data-ttu-id="831ea-237">Ouvrez hello *app/scripts/homeCtrl.js* fichier.</span><span class="sxs-lookup"><span data-stu-id="831ea-237">Open hello *app/scripts/homeCtrl.js* file.</span></span>
8. <span data-ttu-id="831ea-238">Commentez bloc hello de code marqué pour « sans authentification » et supprimez les commentaires de bloc hello de code marqué pour « avec l’authentification ».</span><span class="sxs-lookup"><span data-stu-id="831ea-238">Comment out hello block of code marked for "without authentication" and uncomment hello block of code marked for "with authentication".</span></span>
9. <span data-ttu-id="831ea-239">Ouvrez hello *app/scripts/indexCtrl.js* fichier.</span><span class="sxs-lookup"><span data-stu-id="831ea-239">Open hello *app/scripts/indexCtrl.js* file.</span></span>
10. <span data-ttu-id="831ea-240">Commentez bloc hello de code marqué pour « sans authentification » et supprimez les commentaires de bloc hello de code marqué pour « avec l’authentification ».</span><span class="sxs-lookup"><span data-stu-id="831ea-240">Comment out hello block of code marked for "without authentication" and uncomment hello block of code marked for "with authentication".</span></span>

### <a name="deploy-hello-todolistangular-project-tooazure"></a><span data-ttu-id="831ea-241">Déployer hello ToDoListAngular projet tooAzure</span><span class="sxs-lookup"><span data-stu-id="831ea-241">Deploy hello ToDoListAngular project tooAzure</span></span>
1. <span data-ttu-id="831ea-242">Dans **l’Explorateur de solutions**, cliquez sur le projet de ToDoListAngular hello, puis cliquez sur **publier**.</span><span class="sxs-lookup"><span data-stu-id="831ea-242">In **Solution Explorer**, right-click hello ToDoListAngular project, and then click **Publish**.</span></span>
2. <span data-ttu-id="831ea-243">Cliquez sur **Publier**.</span><span class="sxs-lookup"><span data-stu-id="831ea-243">Click **Publish**.</span></span>
   
    <span data-ttu-id="831ea-244">Visual Studio déploie hello projet et ouvre l’URL de base d’un navigateur toohello application web.</span><span class="sxs-lookup"><span data-stu-id="831ea-244">Visual Studio deploys hello project and opens a browser toohello web app's base URL.</span></span> <span data-ttu-id="831ea-245">Cette opération affiche une page de 403 erreur, ce qui est normale d’une URL base tentative toogo tooa API Web depuis un navigateur.</span><span class="sxs-lookup"><span data-stu-id="831ea-245">This will show a 403 error page, which is normal for an attempt toogo tooa Web API base URL from a browser.</span></span>
   
    <span data-ttu-id="831ea-246">Vous avez toujours toomake une couche intermédiaire de modification toohello application API avant de pouvoir tester application hello.</span><span class="sxs-lookup"><span data-stu-id="831ea-246">You still have toomake a change toohello middle tier API app before you can test hello application.</span></span>
3. <span data-ttu-id="831ea-247">Navigateur de fermer hello.</span><span class="sxs-lookup"><span data-stu-id="831ea-247">Close hello browser.</span></span>

## <a name="configure-hello-todolistapi-project-toouse-authentication"></a><span data-ttu-id="831ea-248">Configurer l’authentification de hello ToDoListAPI projet toouse</span><span class="sxs-lookup"><span data-stu-id="831ea-248">Configure hello ToDoListAPI project toouse authentication</span></span>
<span data-ttu-id="831ea-249">Actuellement hello envoie de projet ToDoListAPI « * » comme hello `owner` tooToDoListDataAPI de valeur.</span><span class="sxs-lookup"><span data-stu-id="831ea-249">Currently hello ToDoListAPI project sends "*" as hello `owner` value tooToDoListDataAPI.</span></span> <span data-ttu-id="831ea-250">Dans cette section vous modifiez hello code toosend hello ID de l’utilisateur connecté hello.</span><span class="sxs-lookup"><span data-stu-id="831ea-250">In this section you change hello code toosend hello ID of hello logged-on user.</span></span>

<span data-ttu-id="831ea-251">Rendre hello suivant modifications hello ToDoListAPI projet.</span><span class="sxs-lookup"><span data-stu-id="831ea-251">Make hello following changes in hello ToDoListAPI project.</span></span>

1. <span data-ttu-id="831ea-252">Ouvrez hello *Controllers/ToDoListController.cs* de fichiers et supprimez les commentaires de la ligne hello dans chaque méthode d’action qui définit `owner` toohello AD Azure `NameIdentifier` valeur de revendication.</span><span class="sxs-lookup"><span data-stu-id="831ea-252">Open hello *Controllers/ToDoListController.cs* file, and uncomment hello line in each action method that sets `owner` toohello Azure AD `NameIdentifier` claim value.</span></span> <span data-ttu-id="831ea-253">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="831ea-253">For example:</span></span>
   
        owner = ((ClaimsIdentity)User.Identity).FindFirst(ClaimTypes.NameIdentifier).Value;
   
    <span data-ttu-id="831ea-254">**Important**: ne supprimez les commentaires de code hello `ToDoListDataAPI` méthode ; vous allez faire ultérieurement pour le didacticiel de l’authentification du principal de service hello.</span><span class="sxs-lookup"><span data-stu-id="831ea-254">**Important**: Don't uncomment code in hello `ToDoListDataAPI` method; you'll do that later for hello service principal authentication tutorial.</span></span>

### <a name="deploy-hello-todolistapi-project-tooazure"></a><span data-ttu-id="831ea-255">Déployer hello ToDoListAPI projet tooAzure</span><span class="sxs-lookup"><span data-stu-id="831ea-255">Deploy hello ToDoListAPI project tooAzure</span></span>
1. <span data-ttu-id="831ea-256">Dans **l’Explorateur de solutions**, cliquez sur le projet de ToDoListAPI hello, puis cliquez sur **publier**.</span><span class="sxs-lookup"><span data-stu-id="831ea-256">In **Solution Explorer**, right-click hello ToDoListAPI project, and then click **Publish**.</span></span>
2. <span data-ttu-id="831ea-257">Cliquez sur **Publier**.</span><span class="sxs-lookup"><span data-stu-id="831ea-257">Click **Publish**.</span></span>
   
    <span data-ttu-id="831ea-258">Visual Studio déploie hello projet et ouvre l’URL de base d’un navigateur toohello API application.</span><span class="sxs-lookup"><span data-stu-id="831ea-258">Visual Studio deploys hello project and opens a browser toohello API app's base URL.</span></span>
3. <span data-ttu-id="831ea-259">Navigateur de fermer hello.</span><span class="sxs-lookup"><span data-stu-id="831ea-259">Close hello browser.</span></span>

### <a name="test-hello-application"></a><span data-ttu-id="831ea-260">Tester l’application hello</span><span class="sxs-lookup"><span data-stu-id="831ea-260">Test hello application</span></span>
1. <span data-ttu-id="831ea-261">Atteindre l’URL toohello de hello web app, **à l’aide de HTTPS, pas HTTP**.</span><span class="sxs-lookup"><span data-stu-id="831ea-261">Go toohello URL of hello web app, **using HTTPS, not HTTP**.</span></span>
2. <span data-ttu-id="831ea-262">Cliquez sur hello **tooDo liste** onglet.</span><span class="sxs-lookup"><span data-stu-id="831ea-262">Click hello **tooDo List** tab.</span></span>
   
    <span data-ttu-id="831ea-263">Vous êtes invité à toolog dans.</span><span class="sxs-lookup"><span data-stu-id="831ea-263">You are prompted toolog in.</span></span>
3. <span data-ttu-id="831ea-264">Connectez-vous avec les informations d’identification hello d’un utilisateur dans votre client AAD.</span><span class="sxs-lookup"><span data-stu-id="831ea-264">Log in with hello credentials of a user in your AAD tenant.</span></span>
4. <span data-ttu-id="831ea-265">Hello **tooDo liste** page s’affiche.</span><span class="sxs-lookup"><span data-stu-id="831ea-265">hello **tooDo List** page appears.</span></span>
   
   ![page de liste tooDo](./media/app-service-api-dotnet-user-principal-auth/webappindex.png)
   
   <span data-ttu-id="831ea-267">Aucune tâche ne s’affiche, car jusqu’ici, elles étaient toutes pour le propriétaire « * ».</span><span class="sxs-lookup"><span data-stu-id="831ea-267">No to-do items are displayed because until now they have all been for owner "*".</span></span> <span data-ttu-id="831ea-268">Maintenant intermédiaire hello est demandant des éléments pour l’utilisateur connecté hello et aucun n’a encore été créée.</span><span class="sxs-lookup"><span data-stu-id="831ea-268">Now hello middle tier is requesting items for hello logged-on user, and none have been created yet.</span></span>
5. <span data-ttu-id="831ea-269">Ajouter un nouveau tooverify d’éléments de tâches hello application fonctionne.</span><span class="sxs-lookup"><span data-stu-id="831ea-269">Add new to-do items tooverify that hello application is working.</span></span>
6. <span data-ttu-id="831ea-270">Dans une autre fenêtre de navigateur, accédez à toohello Swagger une URL de l’interface utilisateur pour l’application d’API de ToDoListDataAPI hello et cliquez sur **ToDoList > obtenir**.</span><span class="sxs-lookup"><span data-stu-id="831ea-270">In another browser window, go toohello Swagger UI URL for hello ToDoListDataAPI API app and click **ToDoList > Get**.</span></span> <span data-ttu-id="831ea-271">Entrez un astérisque pour hello `owner` paramètre, puis cliquez sur **essayez-le**.</span><span class="sxs-lookup"><span data-stu-id="831ea-271">Enter an asterisk for hello `owner` parameter, and then click **Try it out**.</span></span>
   
   <span data-ttu-id="831ea-272">réponse de Hello montre que nouveaux éléments de tâches hello ont des ID d’utilisateur hello AD Azure réel dans la propriété de propriétaire hello.</span><span class="sxs-lookup"><span data-stu-id="831ea-272">hello response shows that hello new to-do items have hello actual Azure AD user ID in hello Owner property.</span></span>
   
   ![ID du propriétaire de la réponse JSON](./media/app-service-api-dotnet-user-principal-auth/todolistapiauth.png)

## <a name="building-hello-projects-from-scratch"></a><span data-ttu-id="831ea-274">Génération de projets hello à partir de zéro</span><span class="sxs-lookup"><span data-stu-id="831ea-274">Building hello projects from scratch</span></span>
<span data-ttu-id="831ea-275">projets d’API Web Hello deux ont été créés à l’aide de hello **application API Azure** modèle et en remplaçant contrôleur de valeurs par défaut hello avec un contrôleur de la liste des tâches de projet.</span><span class="sxs-lookup"><span data-stu-id="831ea-275">hello two Web API projects were created by using hello **Azure API App** project template and replacing hello default Values controller with a ToDoList controller.</span></span> 

<span data-ttu-id="831ea-276">Pour plus d’informations sur la façon de trop de création d’une application de page unique AngularJS avec un API Web 2 serveur principal, consultez [mains sur Lab : générer une Application de Page unique (SPA) avec l’API Web ASP.NET et Angular.js](http://www.asp.net/web-api/overview/getting-started-with-aspnet-web-api/build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs).</span><span class="sxs-lookup"><span data-stu-id="831ea-276">For information about how too create an AngularJS single-page application with a Web API 2 back end, see  [Hands On Lab: Build a Single Page Application (SPA) with ASP.NET Web API and Angular.js](http://www.asp.net/web-api/overview/getting-started-with-aspnet-web-api/build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs).</span></span> <span data-ttu-id="831ea-277">Pour plus d’informations sur la façon tooadd code d’authentification Azure AD, consultez hello suivant des ressources :</span><span class="sxs-lookup"><span data-stu-id="831ea-277">For information about how tooadd Azure AD authentication code, see hello following resources:</span></span>

* <span data-ttu-id="831ea-278">[Sécurisation d’une application à page unique AngularJS avec Azure AD](../active-directory/active-directory-devquickstarts-angular.md).</span><span class="sxs-lookup"><span data-stu-id="831ea-278">[Securing AngularJS Single Page Apps with Azure AD](../active-directory/active-directory-devquickstarts-angular.md).</span></span>
* [<span data-ttu-id="831ea-279">Présentation de JS ADAL v1</span><span class="sxs-lookup"><span data-stu-id="831ea-279">Introducing ADAL JS v1</span></span>](http://www.cloudidentity.com/blog/2015/02/19/introducing-adal-js-v1/)

## <a name="troubleshooting"></a><span data-ttu-id="831ea-280">Résolution de problèmes</span><span class="sxs-lookup"><span data-stu-id="831ea-280">Troubleshooting</span></span>
[!INCLUDE [troubleshooting](../../includes/app-service-api-auth-troubleshooting.md)]

* <span data-ttu-id="831ea-281">Assurez-vous de ne pas confondre ToDoListAPI (niveau intermédiaire) et ToDoListDataAPI (couche de données).</span><span class="sxs-lookup"><span data-stu-id="831ea-281">Make sure that you don't confuse ToDoListAPI (middle tier) and ToDoListDataAPI (data tier).</span></span> <span data-ttu-id="831ea-282">Par exemple, vérifiez que vous avez ajouté l’application d’API intermédiaire authentication toohello, pas le niveau de données hello.</span><span class="sxs-lookup"><span data-stu-id="831ea-282">For example, verify that you added authentication toohello middle tier API app, not hello data tier.</span></span> 
* <span data-ttu-id="831ea-283">Vérifiez que l’URL de l’application hello AngularJS source code références hello intermédiaire API (ToDoListAPI, ToDoListDataAPI pas) et hello corrects ID de client Azure AD.</span><span class="sxs-lookup"><span data-stu-id="831ea-283">Make sure that hello AngularJS source code references hello middle tier API app URL (ToDoListAPI, not ToDoListDataAPI)and hello correct Azure AD client ID.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="831ea-284">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="831ea-284">Next steps</span></span>
<span data-ttu-id="831ea-285">Dans ce didacticiel, vous avez appris comment toouse l’authentification du Service de l’application pour une application API et comment toocall hello application API à l’aide de hello bibliothèque de la bibliothèque ADAL JS.</span><span class="sxs-lookup"><span data-stu-id="831ea-285">In this tutorial you learned how toouse App Service authentication for an API app and how toocall hello API app by using hello ADAL JS library.</span></span> <span data-ttu-id="831ea-286">Dans l’étape suivante du didacticiel hello vous allez apprendre comment trop[application tooyour API de sécuriser l’accès pour les scénarios de service](app-service-api-dotnet-service-principal-auth.md).</span><span class="sxs-lookup"><span data-stu-id="831ea-286">In hello next tutorial you'll learn how too[secure access tooyour API app for service-to-service scenarios](app-service-api-dotnet-service-principal-auth.md).</span></span>

