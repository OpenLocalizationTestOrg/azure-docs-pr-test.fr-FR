---
title: "API de l’utilisation des ressources d’aaaTenant | Documents Microsoft"
description: "Informations de référence sur l’utilisation de ressources API, lesquelles récupèrent des informations relatives à l’utilisation d’Azure Stack."
services: azure-stack
documentationcenter: 
author: AlfredoPizzirani
manager: byronr
editor: 
ms.assetid: b9d7c7ee-e906-4978-92a3-a2c52df16c36
ms.service: azure-stack
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/10/2016
ms.author: alfredop
ms.openlocfilehash: eb826aba87b3b5b79155d9003162f2b5e6871f82
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="tenant-resource-usage-api"></a><span data-ttu-id="7ede2-103">API d’utilisation des ressources de locataire</span><span class="sxs-lookup"><span data-stu-id="7ede2-103">Tenant Resource Usage API</span></span>
<span data-ttu-id="7ede2-104">Un locataire peut utiliser des données d’utilisation de ressources hello API client tooview hello du client.</span><span class="sxs-lookup"><span data-stu-id="7ede2-104">A tenant can use hello Tenant API tooview hello tenant’s own resource usage data.</span></span> <span data-ttu-id="7ede2-105">Cette API méthode est cohérente avec hello API de l’utilisation de Azure (actuellement en aperçu privé).</span><span class="sxs-lookup"><span data-stu-id="7ede2-105">This API is consistent with hello Azure Usage API (currently in private preview).</span></span>

<span data-ttu-id="7ede2-106">Vous pouvez utiliser les applets de commande Windows PowerShell hello **Get-UsageAggregates** tooget les données d’utilisation comme dans Azure.</span><span class="sxs-lookup"><span data-stu-id="7ede2-106">You can use hello Windows PowerShell cmdlet **Get-UsageAggregates** tooget usage data like in Azure.</span></span>

## <a name="api-call"></a><span data-ttu-id="7ede2-107">Appel d’API</span><span class="sxs-lookup"><span data-stu-id="7ede2-107">API call</span></span>
### <a name="request"></a><span data-ttu-id="7ede2-108">Demande</span><span class="sxs-lookup"><span data-stu-id="7ede2-108">Request</span></span>
<span data-ttu-id="7ede2-109">Détails de la consommation Obtient la demande Hello pour hello demandé des abonnements et hello demandée laps de temps.</span><span class="sxs-lookup"><span data-stu-id="7ede2-109">hello request gets consumption details for hello requested subscriptions and for hello requested time frame.</span></span> <span data-ttu-id="7ede2-110">Il n’existe aucun corps de demande.</span><span class="sxs-lookup"><span data-stu-id="7ede2-110">There is no request body.</span></span>

| <span data-ttu-id="7ede2-111">**Méthode**</span><span class="sxs-lookup"><span data-stu-id="7ede2-111">**Method**</span></span> | <span data-ttu-id="7ede2-112">**URI de la requête**</span><span class="sxs-lookup"><span data-stu-id="7ede2-112">**Request URI**</span></span> |
| --- | --- |
| <span data-ttu-id="7ede2-113">GET</span><span class="sxs-lookup"><span data-stu-id="7ede2-113">GET</span></span> |<span data-ttu-id="7ede2-114">https://{armendpoint}/subscriptions/{subId}/providers/Microsoft.Commerce/usageAggregates?reportedStartTime={reportedStartTime}&reportedEndTime={reportedEndTime}&aggregationGranularity={granularity}&api-version=2015-06-01-preview&continuationToken={token-value}</span><span class="sxs-lookup"><span data-stu-id="7ede2-114">https://{armendpoint}/subscriptions/{subId}/providers/Microsoft.Commerce/usageAggregates?reportedStartTime={reportedStartTime}&reportedEndTime={reportedEndTime}&aggregationGranularity={granularity}&api-version=2015-06-01-preview&continuationToken={token-value}</span></span> |

### <a name="arguments"></a><span data-ttu-id="7ede2-115">Arguments</span><span class="sxs-lookup"><span data-stu-id="7ede2-115">Arguments</span></span>
| <span data-ttu-id="7ede2-116">**Argument**</span><span class="sxs-lookup"><span data-stu-id="7ede2-116">**Argument**</span></span> | <span data-ttu-id="7ede2-117">**Description**</span><span class="sxs-lookup"><span data-stu-id="7ede2-117">**Description**</span></span> |
| --- | --- |
| <span data-ttu-id="7ede2-118">*Armendpoint*</span><span class="sxs-lookup"><span data-stu-id="7ede2-118">*Armendpoint*</span></span> |<span data-ttu-id="7ede2-119">Point de terminaison Azure Resource Manager de votre environnement Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="7ede2-119">Azure Resource Manager endpoint of your Azure Stack environment.</span></span> <span data-ttu-id="7ede2-120">Hello convention de Azure pile désigne le nom hello du Gestionnaire de ressources Azure point de terminaison est au format de hello `https://management.{domain-name}`.</span><span class="sxs-lookup"><span data-stu-id="7ede2-120">hello Azure Stack convention is that hello name of Azure Resource Manager endpoint is in hello format `https://management.{domain-name}`.</span></span> <span data-ttu-id="7ede2-121">Par exemple, si hello nom de domaine est local.azurestack.external, hello Gestionnaire de ressources du point de terminaison est `https://management.local.azurestack.external`.</span><span class="sxs-lookup"><span data-stu-id="7ede2-121">For example, if hello domain name is local.azurestack.external, then hello Resource Manager  endpoint is `https://management.local.azurestack.external`.</span></span> |
| <span data-ttu-id="7ede2-122">*subId*</span><span class="sxs-lookup"><span data-stu-id="7ede2-122">*subId*</span></span> |<span data-ttu-id="7ede2-123">ID d’abonnement de l’utilisateur hello appel hello.</span><span class="sxs-lookup"><span data-stu-id="7ede2-123">Subscription ID of hello user who is making hello call.</span></span> <span data-ttu-id="7ede2-124">Vous pouvez utiliser cette tooquery uniquement API à l’usage d’un abonnement unique.</span><span class="sxs-lookup"><span data-stu-id="7ede2-124">You can use this API only tooquery for a single subscription’s usage.</span></span> <span data-ttu-id="7ede2-125">Fournisseurs peuvent utiliser l’utilisation de tooquery hello API de l’utilisation de ressources de fournisseur pour tous les clients.</span><span class="sxs-lookup"><span data-stu-id="7ede2-125">Providers can use hello Provider Resource Usage API tooquery usage for all tenants.</span></span> |
| <span data-ttu-id="7ede2-126">*reportedStartTime*</span><span class="sxs-lookup"><span data-stu-id="7ede2-126">*reportedStartTime*</span></span> |<span data-ttu-id="7ede2-127">Heure de début de requête de hello.</span><span class="sxs-lookup"><span data-stu-id="7ede2-127">Start time of hello query.</span></span> <span data-ttu-id="7ede2-128">Hello valeur pour *DateTime* doit être au format UTC et au début de hello d’heure hello, par exemple, 13:00.</span><span class="sxs-lookup"><span data-stu-id="7ede2-128">hello value for *DateTime* should be in UTC and at hello beginning of hello hour, for example, 13:00.</span></span> <span data-ttu-id="7ede2-129">Pour l’agrégation quotidienne, définissez cette minuit tooUTC de valeur.</span><span class="sxs-lookup"><span data-stu-id="7ede2-129">For daily aggregation, set this value tooUTC midnight.</span></span> <span data-ttu-id="7ede2-130">format de Hello est *échappé* ISO 8601, par exemple, 2015-06-16T18 % 3a53 % 3a11 % 2b00 % 3a00Z, où le signe deux-points sont échappé trop % 3 a et ainsi que la séquence d’échappement trop % 2 b afin qu’il soit URI convivial.</span><span class="sxs-lookup"><span data-stu-id="7ede2-130">hello format is *escaped* ISO 8601, for example, 2015-06-16T18%3a53%3a11%2b00%3a00Z, where colon is escaped too%3a and plus is escaped too%2b so that it is URI friendly.</span></span> |
| <span data-ttu-id="7ede2-131">*reportedEndTime*</span><span class="sxs-lookup"><span data-stu-id="7ede2-131">*reportedEndTime*</span></span> |<span data-ttu-id="7ede2-132">Heure de fin de la requête de hello.</span><span class="sxs-lookup"><span data-stu-id="7ede2-132">End time of hello query.</span></span> <span data-ttu-id="7ede2-133">Hello des contraintes qui s’appliquent trop*reportedStartTime* également appliquer toothis argument.</span><span class="sxs-lookup"><span data-stu-id="7ede2-133">hello constraints that apply too*reportedStartTime* also apply toothis argument.</span></span> <span data-ttu-id="7ede2-134">Hello valeur pour *reportedEndTime* ne peut pas être Bonjour futures.</span><span class="sxs-lookup"><span data-stu-id="7ede2-134">hello value for *reportedEndTime* cannot be in hello future.</span></span> |
| <span data-ttu-id="7ede2-135">*aggregationGranularity*</span><span class="sxs-lookup"><span data-stu-id="7ede2-135">*aggregationGranularity*</span></span> |<span data-ttu-id="7ede2-136">Paramètre facultatif qui a deux valeurs potentielles discrètes : quotidienne et horaire.</span><span class="sxs-lookup"><span data-stu-id="7ede2-136">Optional parameter that has two discrete potential values: daily and hourly.</span></span> <span data-ttu-id="7ede2-137">Comme les valeurs hello suggèrent, un retourne les données de salutation dans une granularité journalière et hello autres est une résolution de toutes les heures.</span><span class="sxs-lookup"><span data-stu-id="7ede2-137">As hello values suggest, one returns hello data in daily granularity, and hello other is an hourly resolution.</span></span> <span data-ttu-id="7ede2-138">quotidien Hello est par défaut de hello.</span><span class="sxs-lookup"><span data-stu-id="7ede2-138">hello daily option is hello default.</span></span> |
| <span data-ttu-id="7ede2-139">*api-version*</span><span class="sxs-lookup"><span data-stu-id="7ede2-139">*api-version*</span></span> |<span data-ttu-id="7ede2-140">Version de protocole hello toomake utilisé cette demande.</span><span class="sxs-lookup"><span data-stu-id="7ede2-140">Version of hello protocol that is used toomake this request.</span></span> <span data-ttu-id="7ede2-141">Vous devez utiliser 2015-06-01-preview.</span><span class="sxs-lookup"><span data-stu-id="7ede2-141">You must use 2015-06-01-preview.</span></span> |
| <span data-ttu-id="7ede2-142">*continuationToken*</span><span class="sxs-lookup"><span data-stu-id="7ede2-142">*continuationToken*</span></span> |<span data-ttu-id="7ede2-143">Jeton récupéré à partir de hello dernier appel toohello utilisation de l’API fournisseur.</span><span class="sxs-lookup"><span data-stu-id="7ede2-143">Token retrieved from hello last call toohello Usage API provider.</span></span> <span data-ttu-id="7ede2-144">Ce jeton est nécessaire quand une réponse comprend plus de 1 000 lignes. Il joue alors le rôle de signet pour la progression.</span><span class="sxs-lookup"><span data-stu-id="7ede2-144">This token is needed when a response is greater than 1,000 lines and it acts as a bookmark for progress.</span></span> <span data-ttu-id="7ede2-145">Si ce n’est pas le cas présent, hello données sont récupérées à partir du début hello hello ou les heures, en fonction de la granularité hello passée dans.</span><span class="sxs-lookup"><span data-stu-id="7ede2-145">If not present, hello data is retrieved from hello beginning of hello day or hour, based on hello granularity passed in.</span></span> |

### <a name="response"></a><span data-ttu-id="7ede2-146">Réponse</span><span class="sxs-lookup"><span data-stu-id="7ede2-146">Response</span></span>
<span data-ttu-id="7ede2-147">GET /subscriptions/sub1/providers/Microsoft.Commerce/UsageAggregates?reportedStartTime=reportedStartTime=2014-05-01T00%3a00%3a00%2b00%3a00&reportedEndTime=2015-06-01T00%3a00%3a00%2b00%3a00&aggregationGranularity=Daily&api-version=1.0</span><span class="sxs-lookup"><span data-stu-id="7ede2-147">GET /subscriptions/sub1/providers/Microsoft.Commerce/UsageAggregates?reportedStartTime=reportedStartTime=2014-05-01T00%3a00%3a00%2b00%3a00&reportedEndTime=2015-06-01T00%3a00%3a00%2b00%3a00&aggregationGranularity=Daily&api-version=1.0</span></span>

<span data-ttu-id="7ede2-148">{</span><span class="sxs-lookup"><span data-stu-id="7ede2-148">{</span></span>

<span data-ttu-id="7ede2-149">"value": \[</span><span class="sxs-lookup"><span data-stu-id="7ede2-149">"value": \[</span></span>

<span data-ttu-id="7ede2-150">{</span><span class="sxs-lookup"><span data-stu-id="7ede2-150">{</span></span>

<span data-ttu-id="7ede2-151">"id": "/subscriptions/sub1/providers/Microsoft.Commerce/UsageAggregate/sub1-meterID1",</span><span class="sxs-lookup"><span data-stu-id="7ede2-151">"id": "/subscriptions/sub1/providers/Microsoft.Commerce/UsageAggregate/sub1-meterID1",</span></span>

<span data-ttu-id="7ede2-152">"name": "sub1-meterID1",</span><span class="sxs-lookup"><span data-stu-id="7ede2-152">"name": "sub1-meterID1",</span></span>

<span data-ttu-id="7ede2-153">"type": "Microsoft.Commerce/UsageAggregate",</span><span class="sxs-lookup"><span data-stu-id="7ede2-153">"type": "Microsoft.Commerce/UsageAggregate",</span></span>

<span data-ttu-id="7ede2-154">"properties": {</span><span class="sxs-lookup"><span data-stu-id="7ede2-154">"properties": {</span></span>

<span data-ttu-id="7ede2-155">"subscriptionId":"sub1",</span><span class="sxs-lookup"><span data-stu-id="7ede2-155">"subscriptionId":"sub1",</span></span>

<span data-ttu-id="7ede2-156">"usageStartTime": "2015-03-03T00:00:00+00:00",</span><span class="sxs-lookup"><span data-stu-id="7ede2-156">"usageStartTime": "2015-03-03T00:00:00+00:00",</span></span>

<span data-ttu-id="7ede2-157">"usageEndTime": "2015-03-04T00:00:00+00:00",</span><span class="sxs-lookup"><span data-stu-id="7ede2-157">"usageEndTime": "2015-03-04T00:00:00+00:00",</span></span>

<span data-ttu-id="7ede2-158">"instanceData":"{\\"Microsoft.Resources\\":{\\"resourceUri\\":\\"resourceUri1\\",\\"location\\":\\"Alaska\\",\\"tags\\":null,\\"additionalInfo\\":null}}",</span><span class="sxs-lookup"><span data-stu-id="7ede2-158">"instanceData":"{\\"Microsoft.Resources\\":{\\"resourceUri\\":\\"resourceUri1\\",\\"location\\":\\"Alaska\\",\\"tags\\":null,\\"additionalInfo\\":null}}",</span></span>

<span data-ttu-id="7ede2-159">"quantity":2.4000000000,</span><span class="sxs-lookup"><span data-stu-id="7ede2-159">"quantity":2.4000000000,</span></span>

<span data-ttu-id="7ede2-160">"meterId":"meterID1"</span><span class="sxs-lookup"><span data-stu-id="7ede2-160">"meterId":"meterID1"</span></span>

<span data-ttu-id="7ede2-161">}</span><span class="sxs-lookup"><span data-stu-id="7ede2-161">}</span></span>

<span data-ttu-id="7ede2-162">},</span><span class="sxs-lookup"><span data-stu-id="7ede2-162">},</span></span>

<span data-ttu-id="7ede2-163">…</span><span class="sxs-lookup"><span data-stu-id="7ede2-163">…</span></span>

### <a name="response-details"></a><span data-ttu-id="7ede2-164">Détails de la réponse</span><span class="sxs-lookup"><span data-stu-id="7ede2-164">Response details</span></span>
| <span data-ttu-id="7ede2-165">**Argument**</span><span class="sxs-lookup"><span data-stu-id="7ede2-165">**Argument**</span></span> | <span data-ttu-id="7ede2-166">**Description**</span><span class="sxs-lookup"><span data-stu-id="7ede2-166">**Description**</span></span> |
| --- | --- |
| <span data-ttu-id="7ede2-167">*id*</span><span class="sxs-lookup"><span data-stu-id="7ede2-167">*id*</span></span> |<span data-ttu-id="7ede2-168">ID unique de l’utilisation de hello d’agrégation</span><span class="sxs-lookup"><span data-stu-id="7ede2-168">Unique ID of hello usage aggregate</span></span> |
| <span data-ttu-id="7ede2-169">*name*</span><span class="sxs-lookup"><span data-stu-id="7ede2-169">*name*</span></span> |<span data-ttu-id="7ede2-170">Nom de l’utilisation de hello d’agrégation</span><span class="sxs-lookup"><span data-stu-id="7ede2-170">Name of hello usage aggregate</span></span> |
| <span data-ttu-id="7ede2-171">*type*</span><span class="sxs-lookup"><span data-stu-id="7ede2-171">*type*</span></span> |<span data-ttu-id="7ede2-172">Définition de la ressource</span><span class="sxs-lookup"><span data-stu-id="7ede2-172">Resource definition</span></span> |
| <span data-ttu-id="7ede2-173">*subscriptionId*</span><span class="sxs-lookup"><span data-stu-id="7ede2-173">*subscriptionId*</span></span> |<span data-ttu-id="7ede2-174">Identificateur d’abonnement de hello utilisateur Azure</span><span class="sxs-lookup"><span data-stu-id="7ede2-174">Subscription identifier of hello Azure user</span></span> |
| <span data-ttu-id="7ede2-175">*usageStartTime*</span><span class="sxs-lookup"><span data-stu-id="7ede2-175">*usageStartTime*</span></span> |<span data-ttu-id="7ede2-176">UTC heure de début de hello utilisation compartiment toowhich cet agrégat d’utilisation appartient</span><span class="sxs-lookup"><span data-stu-id="7ede2-176">UTC start time of hello usage bucket toowhich this usage aggregate belongs</span></span> |
| <span data-ttu-id="7ede2-177">*usageEndTime*</span><span class="sxs-lookup"><span data-stu-id="7ede2-177">*usageEndTime*</span></span> |<span data-ttu-id="7ede2-178">UTC fin de hello utilisation compartiment toowhich cet agrégat d’utilisation appartient</span><span class="sxs-lookup"><span data-stu-id="7ede2-178">UTC end time of hello usage bucket toowhich this usage aggregate belongs</span></span> |
| <span data-ttu-id="7ede2-179">*instanceData*</span><span class="sxs-lookup"><span data-stu-id="7ede2-179">*instanceData*</span></span> |<span data-ttu-id="7ede2-180">Paires clé-valeur des détails de l’instance (dans un nouveau format) :</span><span class="sxs-lookup"><span data-stu-id="7ede2-180">Key-value pairs of instance details (in a new format):</span></span><br>  <span data-ttu-id="7ede2-181">*resourceUri* : ID de ressource complet, notamment les groupes de ressources et le nom de l’instance</span><span class="sxs-lookup"><span data-stu-id="7ede2-181">*resourceUri*: Fully qualified resource ID, including resource groups and instance name</span></span> <br>  <span data-ttu-id="7ede2-182">*location* : région dans laquelle ce service a été exécuté</span><span class="sxs-lookup"><span data-stu-id="7ede2-182">*location*: Region in which this service was run</span></span> <br>  <span data-ttu-id="7ede2-183">*balises*: Spécifie de cet utilisateur hello les balises de ressources</span><span class="sxs-lookup"><span data-stu-id="7ede2-183">*tags*: Resource tags that hello user specifies</span></span> <br>  <span data-ttu-id="7ede2-184">*additionalInfo*: plus d’informations sur la ressource hello consommé, par exemple, le type d’image ou de la version du système d’exploitation</span><span class="sxs-lookup"><span data-stu-id="7ede2-184">*additionalInfo*: More details about hello resource that was consumed, for example, OS version or image type</span></span> |
| <span data-ttu-id="7ede2-185">*quantity*</span><span class="sxs-lookup"><span data-stu-id="7ede2-185">*quantity*</span></span> |<span data-ttu-id="7ede2-186">Quantité de ressources consommées au cours de cette période</span><span class="sxs-lookup"><span data-stu-id="7ede2-186">Amount of resource consumption that occurred in this time frame</span></span> |
| <span data-ttu-id="7ede2-187">*meterId*</span><span class="sxs-lookup"><span data-stu-id="7ede2-187">*meterId*</span></span> |<span data-ttu-id="7ede2-188">ID unique pour la ressource hello qui a été consommée (également appelé *ResourceID*)</span><span class="sxs-lookup"><span data-stu-id="7ede2-188">Unique ID for hello resource that was consumed (also called *ResourceID*)</span></span> |

## <a name="next-steps"></a><span data-ttu-id="7ede2-189">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="7ede2-189">Next steps</span></span>
[<span data-ttu-id="7ede2-190">API Utilisation des ressources de fournisseur</span><span class="sxs-lookup"><span data-stu-id="7ede2-190">Provider resource usage API</span></span>](azure-stack-provider-resource-api.md)

[<span data-ttu-id="7ede2-191">Questions fréquentes (FAQ) relatives à l’utilisation</span><span class="sxs-lookup"><span data-stu-id="7ede2-191">Usage-related FAQ</span></span>](azure-stack-usage-related-faq.md)

