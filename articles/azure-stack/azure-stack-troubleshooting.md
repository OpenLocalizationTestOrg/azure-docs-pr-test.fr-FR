---
title: "Résolution des problèmes de Microsoft Azure Stack | Microsoft Docs"
description: "Résolution des problèmes d’Azure Stack."
services: azure-stack
documentationcenter: 
author: heathl17
manager: byronr
editor: 
ms.assetid: a20bea32-3705-45e8-9168-f198cfac51af
ms.service: azure-stack
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/10/2017
ms.author: helaw
ms.openlocfilehash: a7309693d8f7971e42768a13d12fa0a8bd81925a
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/03/2017
---
# <a name="microsoft-azure-stack-troubleshooting"></a><span data-ttu-id="e1639-103">Résolution des problèmes de Microsoft Azure Stack</span><span class="sxs-lookup"><span data-stu-id="e1639-103">Microsoft Azure Stack troubleshooting</span></span>
<span data-ttu-id="e1639-104">Ce document fournit des informations de résolution des problèmes courants pour Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="e1639-104">This document provides common troubleshooting information for Azure Stack.</span></span> 

<span data-ttu-id="e1639-105">Étant donné que le kit de développement technique Azure Stack est proposé comme environnement d’évaluation, il n’y a aucune prise en charge officielle de la part des services clients Microsoft.</span><span class="sxs-lookup"><span data-stu-id="e1639-105">Because the Azure Stack Technical Development Kit is offered as an evaluation environment, there is no official support from Microsoft Customer Support Services.</span></span>  <span data-ttu-id="e1639-106">Si vous rencontrez un problème non documenté, veillez à consulter le [Forum MSDN Azure Stack](https://social.msdn.microsoft.com/Forums/azure/home?forum=azurestack) pour obtenir une assistance et des informations supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="e1639-106">If you are experiencing an issue not documented, make sure to check the [Azure Stack MSDN Forum](https://social.msdn.microsoft.com/Forums/azure/home?forum=azurestack) for further assistance and information.</span></span>  

<span data-ttu-id="e1639-107">Les recommandations pour la résolution des problèmes qui sont décrites dans cette section proviennent de différentes sources ; elles pourront peut-être résoudre votre problème en particulier.</span><span class="sxs-lookup"><span data-stu-id="e1639-107">The recommendations for troubleshooting issues that are described in this section are derived from several sources and may or may not resolve your particular issue.</span></span> <span data-ttu-id="e1639-108">Les exemples de code sont fournis en l’état et les résultats attendus ne sont pas garantis.</span><span class="sxs-lookup"><span data-stu-id="e1639-108">Code examples are provided as is and expected results cannot be guaranteed.</span></span> <span data-ttu-id="e1639-109">Cette section est susceptible de faire l’objet de modifications et de mises à jour fréquentes au fur et à mesure que des améliorations sont apportées au produit.</span><span class="sxs-lookup"><span data-stu-id="e1639-109">This section is subject to frequent edits and updates as improvements to the product are implemented.</span></span>

## <a name="deployment"></a><span data-ttu-id="e1639-110">Déploiement</span><span class="sxs-lookup"><span data-stu-id="e1639-110">Deployment</span></span>
### <a name="deployment-failure"></a><span data-ttu-id="e1639-111">Échec du déploiement</span><span class="sxs-lookup"><span data-stu-id="e1639-111">Deployment failure</span></span>
<span data-ttu-id="e1639-112">Si vous rencontrez un problème lors de l’installation, vous pouvez utiliser l’option de réexécution du script de déploiement pour relancer le déploiement à partir de l’étape qui n’a pas abouti.</span><span class="sxs-lookup"><span data-stu-id="e1639-112">If you experience a failure during installation, you can use use the rerun option of the deployment script to restart the deployment from the failed step.</span></span>  


### <a name="at-the-end-of-the-deployment-the-powershell-session-is-still-open-and-doesnt-show-any-output"></a><span data-ttu-id="e1639-113">À la fin du déploiement, la session PowerShell est toujours ouverte et ne présente aucune sortie</span><span class="sxs-lookup"><span data-stu-id="e1639-113">At the end of the deployment, the PowerShell session is still open and doesn’t show any output</span></span>
<span data-ttu-id="e1639-114">Ce comportement est probablement tout simplement le résultat du comportement par défaut d’une fenêtre de commande PowerShell, lorsqu’elle a été sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="e1639-114">This behavior is probably just the result of the default behavior of a PowerShell command window, when it has been selected.</span></span> <span data-ttu-id="e1639-115">Le déploiement du kit de développement a en fait réussi, mais le script a été interrompu au moment de la sélection de la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="e1639-115">The development kit deployment has actually succeeded but the script was paused when selecting the window.</span></span> <span data-ttu-id="e1639-116">Vous pouvez vérifier que c’est le cas en recherchant le mot « select » dans la barre de titre de la fenêtre de commande.</span><span class="sxs-lookup"><span data-stu-id="e1639-116">You can verify this is the case by looking for the word "select" in the titlebar of the command window.</span></span>  <span data-ttu-id="e1639-117">Appuyez sur la touche Échap pour la désélectionner ; le message d’achèvement devrait alors s’afficher.</span><span class="sxs-lookup"><span data-stu-id="e1639-117">Press the ESC key to unselect it, and the completion message should be shown after it.</span></span>

## <a name="templates"></a><span data-ttu-id="e1639-118">Modèles</span><span class="sxs-lookup"><span data-stu-id="e1639-118">Templates</span></span>
### <a name="azure-template-wont-deploy-to-azure-stack"></a><span data-ttu-id="e1639-119">Le modèle Azure ne se déploie pas sur Azure Stack</span><span class="sxs-lookup"><span data-stu-id="e1639-119">Azure template won't deploy to Azure Stack</span></span>
<span data-ttu-id="e1639-120">Vérifiez les points suivants :</span><span class="sxs-lookup"><span data-stu-id="e1639-120">Make sure that:</span></span>

* <span data-ttu-id="e1639-121">Le modèle utilise un service Microsoft Azure déjà disponible ou en préversion dans Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="e1639-121">The template must be using a Microsoft Azure service that is already available or in preview in Azure Stack.</span></span>
* <span data-ttu-id="e1639-122">Les API utilisées pour une ressource donnée sont prises en charge par l’instance Azure Stack locale, et vous ciblez un emplacement valide (« local » dans le kit de développement Azure Stack, mais « États-Unis de l’Est » ou « Inde du Sud » dans Azure).</span><span class="sxs-lookup"><span data-stu-id="e1639-122">The APIs used for a specific resource are supported by the local Azure Stack instance, and that you are targeting a valid location (“local” in Azure Stack development kit, vs the “East US” or “South India” in Azure).</span></span>
* <span data-ttu-id="e1639-123">Vous avez lu [cet article](https://github.com/Azure/AzureStack-QuickStart-Templates/blob/master/README.md) sur les cmdlets Test-AzureRmResourceGroupDeployment, qui identifie de petites différences dans la syntaxe Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="e1639-123">You review [this article](https://github.com/Azure/AzureStack-QuickStart-Templates/blob/master/README.md) about the Test-AzureRmResourceGroupDeployment cmdlets, which catch small differences in Azure Resource Manager syntax.</span></span>

<span data-ttu-id="e1639-124">Vous pouvez également utiliser les modèles Azure Stack déjà fournis dans le [référentiel GitHub](http://aka.ms/AzureStackGitHub/) pour commencer.</span><span class="sxs-lookup"><span data-stu-id="e1639-124">You can also use the Azure Stack templates already provided in the [GitHub repository](http://aka.ms/AzureStackGitHub/) to help you get started.</span></span>

## <a name="virtual-machines"></a><span data-ttu-id="e1639-125">Machines virtuelles</span><span class="sxs-lookup"><span data-stu-id="e1639-125">Virtual machines</span></span>
### <a name="default-image-and-gallery-item"></a><span data-ttu-id="e1639-126">Élément de la galerie et image par défaut</span><span class="sxs-lookup"><span data-stu-id="e1639-126">Default image and gallery item</span></span>
<span data-ttu-id="e1639-127">Vous devez d’abord ajouter un élément de la galerie et une image Windows Server pour pouvoir déployer des machines virtuelles dans Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="e1639-127">You must first add a Windows Server image and gallery item before deploying VMs in Azure Stack.</span></span>

### <a name="after-restarting-my-azure-stack-host-some-vms-may-not-automatically-start"></a><span data-ttu-id="e1639-128">Après le redémarrage de l’hôte Azure Stack, certaines machines virtuelles ne démarrent pas automatiquement</span><span class="sxs-lookup"><span data-stu-id="e1639-128">After restarting my Azure Stack host, some VMs may not automatically start.</span></span>
<span data-ttu-id="e1639-129">Vous remarquerez peut-être que les services Azure Stack ne sont pas immédiatement disponibles après le redémarrage de votre hôte.</span><span class="sxs-lookup"><span data-stu-id="e1639-129">After rebooting your host, you may notice Azure Stack services are not immediately available.</span></span>  <span data-ttu-id="e1639-130">C’est parce que la vérification de la cohérence des RP et des [machines virtuelles d’infrastructure](azure-stack-architecture.md#virtual-machine-roles) Azure Stack demande un peu de temps ; toutefois, ils finiront par démarrer automatiquement.</span><span class="sxs-lookup"><span data-stu-id="e1639-130">This is because Azure Stack [infrastructure VMs](azure-stack-architecture.md#virtual-machine-roles) and RPs take a little bit to check consistency, but will eventually start automatically.</span></span>

<span data-ttu-id="e1639-131">Vous remarquerez peut-être aussi que les machines virtuelles clientes ne démarrent pas automatiquement après le redémarrage de l’hôte du kit de développement Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="e1639-131">You may also notice that tenant VMs don't automatically start after a reboot of the Azure Stack development kit host.</span></span>  <span data-ttu-id="e1639-132">Ce problème est connu ; quelques étapes manuelles suffisent pour les mettre en ligne :</span><span class="sxs-lookup"><span data-stu-id="e1639-132">This is a known issue, and just requires a few manual steps to bring them online:</span></span>

1.  <span data-ttu-id="e1639-133">Sur l’hôte du kit de développement Azure Stack, démarrez **Gestionnaire du cluster de basculement** dans le menu Démarrer.</span><span class="sxs-lookup"><span data-stu-id="e1639-133">On the Azure Stack development kit host, start **Failover Cluster Manager** from the Start Menu.</span></span>
2.  <span data-ttu-id="e1639-134">Sélectionnez le cluster **S-Cluster.azurestack.local**.</span><span class="sxs-lookup"><span data-stu-id="e1639-134">Select the cluster **S-Cluster.azurestack.local**.</span></span>
3.  <span data-ttu-id="e1639-135">Sélectionnez **Rôles**.</span><span class="sxs-lookup"><span data-stu-id="e1639-135">Select **Roles**.</span></span>
4.  <span data-ttu-id="e1639-136">Les machines virtuelles clientes apparaîtront avec l’état *enregistré*.</span><span class="sxs-lookup"><span data-stu-id="e1639-136">Tenant VMs will appear in a *saved* state.</span></span>  <span data-ttu-id="e1639-137">Lorsque toutes les machines virtuelles d’infrastructure sont en cours d’exécution, cliquez avec le bouton droit sur les machines virtuelles clientes et sélectionnez **Démarrer** pour reprendre la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="e1639-137">Once all Infrastructure VMs are running, right-click the tenant VMs and select **Start** to resume the VM.</span></span>

### <a name="i-have-deleted-some-virtual-machines-but-still-see-the-vhd-files-on-disk-is-this-behavior-expected"></a><span data-ttu-id="e1639-138">J’ai supprimé des machines virtuelles, mais je vois toujours les fichiers de VHD sur le disque.</span><span class="sxs-lookup"><span data-stu-id="e1639-138">I have deleted some virtual machines, but still see the VHD files on disk.</span></span> <span data-ttu-id="e1639-139">Ce comportement est-il attendu ?</span><span class="sxs-lookup"><span data-stu-id="e1639-139">Is this behavior expected?</span></span>
<span data-ttu-id="e1639-140">Oui, c’est le comportement attendu.</span><span class="sxs-lookup"><span data-stu-id="e1639-140">Yes, this is behavior expected.</span></span> <span data-ttu-id="e1639-141">Il a été conçu ainsi pour les raisons suivantes :</span><span class="sxs-lookup"><span data-stu-id="e1639-141">It was designed this way because:</span></span>

* <span data-ttu-id="e1639-142">La suppression d’une machine virtuelle n’entraîne pas celle des VHD.</span><span class="sxs-lookup"><span data-stu-id="e1639-142">When you delete a VM, VHDs are not deleted.</span></span> <span data-ttu-id="e1639-143">Les disques sont des ressources distinctes dans le groupe de ressources.</span><span class="sxs-lookup"><span data-stu-id="e1639-143">Disks are separate resources in the resource group.</span></span>
* <span data-ttu-id="e1639-144">Lorsqu’un compte de stockage est supprimé, la suppression est visible immédiatement sur Azure Resource Manager (portail, PowerShell), mais les disques qu’il contient éventuellement restent conservés dans le stockage jusqu’à l’exécution du nettoyage de la mémoire.</span><span class="sxs-lookup"><span data-stu-id="e1639-144">When a storage account gets deleted, the deletion is visible immediately through Azure Resource Manager (portal, PowerShell) but the disks it may contain are still kept in storage until garbage collection runs.</span></span>

<span data-ttu-id="e1639-145">Si vous voyez des VHD « orphelins », il est important de savoir s’ils font partie du dossier d’un compte de stockage supprimé.</span><span class="sxs-lookup"><span data-stu-id="e1639-145">If you see "orphan" VHDs, it is important to know if they are part of the folder for a storage account that was deleted.</span></span> <span data-ttu-id="e1639-146">Si le compte de stockage n’a pas été supprimé, il est normal qu’ils soient toujours présents.</span><span class="sxs-lookup"><span data-stu-id="e1639-146">If the storage account was not deleted, it's normal they are still there.</span></span>

<span data-ttu-id="e1639-147">Pour en savoir plus sur la configuration du seuil de rétention et de la récupération à la demande, consultez la page [Gérer les comptes de stockage](azure-stack-manage-storage-accounts.md).</span><span class="sxs-lookup"><span data-stu-id="e1639-147">You can read more about configuring the retention threshold and on-demand reclamation in [manage storage accounts](azure-stack-manage-storage-accounts.md).</span></span>

## <a name="storage"></a><span data-ttu-id="e1639-148">Storage</span><span class="sxs-lookup"><span data-stu-id="e1639-148">Storage</span></span>
### <a name="storage-reclamation"></a><span data-ttu-id="e1639-149">Récupération du stockage</span><span class="sxs-lookup"><span data-stu-id="e1639-149">Storage reclamation</span></span>
<span data-ttu-id="e1639-150">La capacité récupérée peut mettre jusqu’à 14 heures à s’afficher sur le portail.</span><span class="sxs-lookup"><span data-stu-id="e1639-150">It may take up to fourteen hours for reclaimed capacity to show up in the portal.</span></span> <span data-ttu-id="e1639-151">La récupération d’espace dépend de différents facteurs, notamment le pourcentage d’utilisation des fichiers conteneurs internes dans le magasin d’objets blob de blocs.</span><span class="sxs-lookup"><span data-stu-id="e1639-151">Space reclamation depends on various factors including usage percentage of internal container files in block blob store.</span></span> <span data-ttu-id="e1639-152">Par conséquent, selon la quantité de données supprimées, il n’y a pas de garantie quant à la quantité d’espace récupérable lors de l’exécution du récupérateur de mémoire.</span><span class="sxs-lookup"><span data-stu-id="e1639-152">Therefore, depending on how much data is deleted, there is no guarantee on the amount of space that could be reclaimed when garbage collector runs.</span></span>

## <a name="powershell"></a><span data-ttu-id="e1639-153">PowerShell</span><span class="sxs-lookup"><span data-stu-id="e1639-153">PowerShell</span></span>
### <a name="resource-providers-not-registered"></a><span data-ttu-id="e1639-154">Fournisseurs de ressources non enregistrés</span><span class="sxs-lookup"><span data-stu-id="e1639-154">Resource Providers not registered</span></span>
<span data-ttu-id="e1639-155">Vous remarquerez que les fournisseurs de ressources ne sont pas automatiquement enregistrés lorsque vous vous connectez à des abonnements clients avec PowerShell.</span><span class="sxs-lookup"><span data-stu-id="e1639-155">When connecting to tenant subscriptions with PowerShell, you will notice that the resource providers are not automatically registered.</span></span> <span data-ttu-id="e1639-156">Utilisez le [module Connect](https://github.com/Azure/AzureStack-Tools/tree/master/Connect) ou exécutez la commande suivante dans PowerShell (après avoir [effectué l’installation et la connexion](azure-stack-connect-powershell.md) en tant que client) :</span><span class="sxs-lookup"><span data-stu-id="e1639-156">Use the [Connect module](https://github.com/Azure/AzureStack-Tools/tree/master/Connect), or run the following command from PowerShell (after you [install and connect](azure-stack-connect-powershell.md) as a tenant):</span></span> 
  
       Get-AzureRMResourceProvider | Register-AzureRmResourceProvider

## <a name="cli"></a><span data-ttu-id="e1639-157">Interface de ligne de commande</span><span class="sxs-lookup"><span data-stu-id="e1639-157">CLI</span></span>

* <span data-ttu-id="e1639-158">Le mode interactif de l’interface CLI, c’est-à-dire</span><span class="sxs-lookup"><span data-stu-id="e1639-158">The CLI interactive mode i.e</span></span> <span data-ttu-id="e1639-159">la commande `az interactive`, n’est pas encore pris en charge dans Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="e1639-159">the `az interactive` command is not yet supported in Azure Stack.</span></span>
* <span data-ttu-id="e1639-160">Pour obtenir la liste des images de machines virtuelles disponibles dans Azure Stack, utilisez la commande `az vm images list --all` au lieu de la commande `az vm image list`.</span><span class="sxs-lookup"><span data-stu-id="e1639-160">To get the list of virtual machine images available in Azure Stack, use the `az vm images list --all` command instead of the `az vm image list` command.</span></span> <span data-ttu-id="e1639-161">L’option `--all` permet de faire en sorte que la réponse retourne uniquement les images disponibles dans l’environnement Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="e1639-161">Specifying the `--all` option makes sure that response returns only the images that are available in your Azure Stack environment.</span></span> 
* <span data-ttu-id="e1639-162">Les alias d’images de machines virtuelles disponibles dans Azure ne s’appliquent pas forcément à Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="e1639-162">Virtual machine image aliases that are available in Azure may not be applicable to Azure Stack.</span></span> <span data-ttu-id="e1639-163">Si vous utilisez des images de machines virtuelles, vous devez utiliser la totalité du paramètre URN (Canonical:UbuntuServer:14.04.3-LTS:1.0.0) plutôt que l’alias de l’image.</span><span class="sxs-lookup"><span data-stu-id="e1639-163">When using virtual machine images, you must use the entire URN parameter (Canonical:UbuntuServer:14.04.3-LTS:1.0.0) instead of the image alias.</span></span> <span data-ttu-id="e1639-164">Cet URN doit par ailleurs correspondre aux spécifications des images dérivées de la commande `az vm images list`.</span><span class="sxs-lookup"><span data-stu-id="e1639-164">And this URNmust match the image specifications as derived from the `az vm images list` command.</span></span>
* <span data-ttu-id="e1639-165">Par défaut, CLI 2.0 utilise « Standard_DS1_v2 » comme taille d’image de machine virtuelle par défaut.</span><span class="sxs-lookup"><span data-stu-id="e1639-165">By default, CLI 2.0 uses “Standard_DS1_v2” as the default virtual machine image size.</span></span> <span data-ttu-id="e1639-166">Toutefois, cette taille n’est pas encore disponible dans Azure Stack : vous devez donc spécifier le paramètre `--size` explicitement lorsque vous créez une machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="e1639-166">However, this size is not yet available in Azure Stack, so, you need to specify the `--size` parameter explicitly when creating a virtual machine.</span></span> <span data-ttu-id="e1639-167">Vous pouvez obtenir la liste des tailles de machines virtuelles disponibles dans Azure Stack avec la commande `az vm list-sizes --location <locationName>`.</span><span class="sxs-lookup"><span data-stu-id="e1639-167">You can get the list of virtual machine sizes that are available in Azure Stack by using the `az vm list-sizes --location <locationName>` command.</span></span>


## <a name="windows-azure-pack-connector"></a><span data-ttu-id="e1639-168">Connecteur Windows Azure Pack</span><span class="sxs-lookup"><span data-stu-id="e1639-168">Windows Azure Pack Connector</span></span>
* <span data-ttu-id="e1639-169">Si vous modifiez le mot de passe du compte azurestackadmin après avoir déployé le kit de développement Azure Stack, vous ne pourrez plus configurer le mode multicloud.</span><span class="sxs-lookup"><span data-stu-id="e1639-169">If you change the password of the azurestackadmin account after you deploy Azure Stack development kit, you can no longer configure multi-cloud mode.</span></span> <span data-ttu-id="e1639-170">Par conséquent, il ne sera pas possible de se connecter à l’environnement Windows Azure Pack cible.</span><span class="sxs-lookup"><span data-stu-id="e1639-170">Therefore, it won't be possible to connect to the target Windows Azure Pack environment.</span></span>
* <span data-ttu-id="e1639-171">Après avoir configuré le mode multicloud :</span><span class="sxs-lookup"><span data-stu-id="e1639-171">After you set up multi-cloud mode:</span></span>
    * <span data-ttu-id="e1639-172">Un utilisateur ne peut voir le tableau de bord qu’après avoir réinitialisé les paramètres du portail.</span><span class="sxs-lookup"><span data-stu-id="e1639-172">A user can see the dashboard only after they reset the portal settings.</span></span> <span data-ttu-id="e1639-173">(Sur le portail utilisateur, cliquez sur l’icône Paramètres de portail - l’icône d’engrenage dans le coin supérieur droit.</span><span class="sxs-lookup"><span data-stu-id="e1639-173">(In the user portal, click the portal settings icon (gear icon in the top-right corner).</span></span> <span data-ttu-id="e1639-174">Sous **Restaurer les paramètres par défaut**, cliquez sur **Appliquer**.)</span><span class="sxs-lookup"><span data-stu-id="e1639-174">Under **Restore default settings**, click **Apply**.)</span></span>
    * <span data-ttu-id="e1639-175">Il est possible que les titres du tableau de bord n’apparaissent pas.</span><span class="sxs-lookup"><span data-stu-id="e1639-175">The dashboard titles may not appear.</span></span> <span data-ttu-id="e1639-176">Si ce problème se produit, vous devez les rajouter manuellement.</span><span class="sxs-lookup"><span data-stu-id="e1639-176">If this issue occurs, you must manually add them back.</span></span>
    * <span data-ttu-id="e1639-177">Il est possible que certaines vignettes ne s’affichent pas correctement dès l’ajout au tableau de bord.</span><span class="sxs-lookup"><span data-stu-id="e1639-177">Some tiles may not show correctly when you first add them to the dashboard.</span></span> <span data-ttu-id="e1639-178">Pour résoudre ce problème, actualisez le navigateur.</span><span class="sxs-lookup"><span data-stu-id="e1639-178">To fix this issue, refresh the browser.</span></span>



