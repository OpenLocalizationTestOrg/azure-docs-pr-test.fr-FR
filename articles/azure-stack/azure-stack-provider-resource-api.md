---
title: "API de l’utilisation des ressources d’aaaProvider | Documents Microsoft"
description: "Informations de référence sur l’utilisation de ressources API, lesquelles récupèrent des informations relatives à l’utilisation d’Azure Stack."
services: azure-stack
documentationcenter: 
author: AlfredoPizzirani
manager: byronr
editor: 
ms.assetid: b6055923-b6a6-45f0-8979-225b713150ae
ms.service: azure-stack
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/10/2017
ms.author: alfredop
ms.openlocfilehash: 7cc2d7af27e6abc86e247b2ed0ab1bc236fdb1af
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="provider-resource-usage-api"></a><span data-ttu-id="57185-103">API d’utilisation des ressources de fournisseur</span><span class="sxs-lookup"><span data-stu-id="57185-103">Provider Resource Usage API</span></span>
<span data-ttu-id="57185-104">fournisseur de terme Hello s’applique toohello administrateur du service et les fournisseurs de tooany déléguée.</span><span class="sxs-lookup"><span data-stu-id="57185-104">hello term provider applies toohello service administrator and tooany delegated providers.</span></span> <span data-ttu-id="57185-105">Administrateurs de service et les fournisseurs de délégués permet l’utilisation de hello tooview API de fournisseur d’utilisation de leurs clients directs.</span><span class="sxs-lookup"><span data-stu-id="57185-105">Service admins and delegated providers can use the Provider Usage API tooview hello usage of their direct tenants.</span></span> <span data-ttu-id="57185-106">Par exemple, P0 peut appeler des informations sur l’utilisation de hello API fournisseur tooget de P1 et de P2 utilisation directe et P1 peut appeler pour obtenir des informations sur P3 et P4.</span><span class="sxs-lookup"><span data-stu-id="57185-106">For example, P0 can call hello Provider API tooget usage information on P1's and P2's direct usage, and P1 can call for usage information on P3 and P4.</span></span>

![Modèle conceptuel de la hiérarchie des fournisseurs](media/azure-stack-provider-resource-api/image1.png)

## <a name="api-call-reference"></a><span data-ttu-id="57185-108">Référence de l’appel d’API</span><span class="sxs-lookup"><span data-stu-id="57185-108">API call reference</span></span>
### <a name="request"></a><span data-ttu-id="57185-109">Demande</span><span class="sxs-lookup"><span data-stu-id="57185-109">Request</span></span>
<span data-ttu-id="57185-110">Détails de la consommation Obtient la demande Hello pour hello demandé des abonnements et hello demandée laps de temps.</span><span class="sxs-lookup"><span data-stu-id="57185-110">hello request gets consumption details for hello requested subscriptions and for hello requested time frame.</span></span> <span data-ttu-id="57185-111">Il n’existe aucun corps de demande.</span><span class="sxs-lookup"><span data-stu-id="57185-111">There is no request body.</span></span>

<span data-ttu-id="57185-112">L’utilisation de cette API est une API de fournisseur, donc appelant de hello doit être affectée à un rôle de propriétaire, collaborateur ou lecteur dans l’abonnement du fournisseur hello.</span><span class="sxs-lookup"><span data-stu-id="57185-112">This usage API is a Provider API, so hello caller must be assigned an Owner, Contributor, or Reader role in hello provider’s subscription.</span></span>

| <span data-ttu-id="57185-113">**Méthode**</span><span class="sxs-lookup"><span data-stu-id="57185-113">**Method**</span></span> | <span data-ttu-id="57185-114">**URI de la requête**</span><span class="sxs-lookup"><span data-stu-id="57185-114">**Request URI**</span></span> |
| --- | --- |
| <span data-ttu-id="57185-115">GET</span><span class="sxs-lookup"><span data-stu-id="57185-115">GET</span></span> |<span data-ttu-id="57185-116">https://{armendpoint}/subscriptions/{subId}/providers/Microsoft.Commerce/subscriberUsageAggregates?reportedStartTime={reportedStartTime}&reportedEndTime={reportedEndTime}&aggregationGranularity={granularity}&subscriberId={sub1.1}&api-version=2015-06-01-preview&continuationToken={token-value}</span><span class="sxs-lookup"><span data-stu-id="57185-116">https://{armendpoint}/subscriptions/{subId}/providers/Microsoft.Commerce/subscriberUsageAggregates?reportedStartTime={reportedStartTime}&reportedEndTime={reportedEndTime}&aggregationGranularity={granularity}&subscriberId={sub1.1}&api-version=2015-06-01-preview&continuationToken={token-value}</span></span> |

### <a name="arguments"></a><span data-ttu-id="57185-117">Arguments</span><span class="sxs-lookup"><span data-stu-id="57185-117">Arguments</span></span>
| <span data-ttu-id="57185-118">**Argument**</span><span class="sxs-lookup"><span data-stu-id="57185-118">**Argument**</span></span> | <span data-ttu-id="57185-119">**Description**</span><span class="sxs-lookup"><span data-stu-id="57185-119">**Description**</span></span> |
| --- | --- |
| <span data-ttu-id="57185-120">*armendpoint*</span><span class="sxs-lookup"><span data-stu-id="57185-120">*armendpoint*</span></span> |<span data-ttu-id="57185-121">Point de terminaison Azure Resource Manager de votre environnement Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="57185-121">Azure Resource Manager endpoint of your Azure Stack environment.</span></span> <span data-ttu-id="57185-122">Hello convention de Azure pile désigne le nom hello du Gestionnaire de ressources Azure point de terminaison est au format de hello `https://adminmanagement.{domain-name}`.</span><span class="sxs-lookup"><span data-stu-id="57185-122">hello Azure Stack convention is that hello name of Azure Resource Manager endpoint is in hello format `https://adminmanagement.{domain-name}`.</span></span> <span data-ttu-id="57185-123">Par exemple, si hello nom de domaine est local.azurestack.external, hello Gestionnaire de ressources du point de terminaison est `https://adminmanagement.local.azurestack.external`.</span><span class="sxs-lookup"><span data-stu-id="57185-123">For example, if hello domain name is local.azurestack.external, then hello Resource Manager endpoint is `https://adminmanagement.local.azurestack.external`.</span></span> |
| <span data-ttu-id="57185-124">*subId*</span><span class="sxs-lookup"><span data-stu-id="57185-124">*subId*</span></span> |<span data-ttu-id="57185-125">ID d’abonnement de l’utilisateur hello appel hello.</span><span class="sxs-lookup"><span data-stu-id="57185-125">Subscription ID of hello user who is making hello call.</span></span> |
| <span data-ttu-id="57185-126">*reportedStartTime*</span><span class="sxs-lookup"><span data-stu-id="57185-126">*reportedStartTime*</span></span> |<span data-ttu-id="57185-127">Heure de début de requête de hello.</span><span class="sxs-lookup"><span data-stu-id="57185-127">Start time of hello query.</span></span> <span data-ttu-id="57185-128">Hello valeur pour *DateTime* doit être au format UTC et au début de hello d’heure hello, par exemple, 13:00.</span><span class="sxs-lookup"><span data-stu-id="57185-128">hello value for *DateTime* should be in UTC and at hello beginning of hello hour, for example, 13:00.</span></span> <span data-ttu-id="57185-129">Pour l’agrégation quotidienne, définissez cette minuit tooUTC de valeur.</span><span class="sxs-lookup"><span data-stu-id="57185-129">For daily aggregation, set this value tooUTC midnight.</span></span> <span data-ttu-id="57185-130">format de Hello est *échappé* ISO 8601, par exemple, 2015-06-16T18 % 3a53 % 3a11 % 2b00 % 3a00Z, où le signe deux-points sont échappé trop % 3 a et ainsi que la séquence d’échappement trop % 2 b afin qu’il soit URI convivial.</span><span class="sxs-lookup"><span data-stu-id="57185-130">hello format is *escaped* ISO 8601, for example, 2015-06-16T18%3a53%3a11%2b00%3a00Z, where colon is escaped too%3a and plus is escaped too%2b so that it is URI friendly.</span></span> |
| <span data-ttu-id="57185-131">*reportedEndTime*</span><span class="sxs-lookup"><span data-stu-id="57185-131">*reportedEndTime*</span></span> |<span data-ttu-id="57185-132">Heure de fin de la requête de hello.</span><span class="sxs-lookup"><span data-stu-id="57185-132">End time of hello query.</span></span> <span data-ttu-id="57185-133">Hello des contraintes qui s’appliquent trop*reportedStartTime* également appliquer toothis argument.</span><span class="sxs-lookup"><span data-stu-id="57185-133">hello constraints that apply too*reportedStartTime* also apply toothis argument.</span></span> <span data-ttu-id="57185-134">Hello valeur pour *reportedEndTime* ne peut pas être hello futures ou hello date actuelle.</span><span class="sxs-lookup"><span data-stu-id="57185-134">hello value for *reportedEndTime* cannot be in hello future or hello current date.</span></span> <span data-ttu-id="57185-135">S’il s’agit, le résultat de hello est défini trop « traitement ne pas terminée. »</span><span class="sxs-lookup"><span data-stu-id="57185-135">If it is, hello result is set too"processing not complete."</span></span> |
| <span data-ttu-id="57185-136">*aggregationGranularity*</span><span class="sxs-lookup"><span data-stu-id="57185-136">*aggregationGranularity*</span></span> |<span data-ttu-id="57185-137">Paramètre facultatif qui a deux valeurs potentielles discrètes : quotidienne et horaire.</span><span class="sxs-lookup"><span data-stu-id="57185-137">Optional parameter that has two discrete potential values: daily and hourly.</span></span> <span data-ttu-id="57185-138">Comme les valeurs hello suggèrent, un retourne les données de salutation dans une granularité journalière et hello autres est une résolution de toutes les heures.</span><span class="sxs-lookup"><span data-stu-id="57185-138">As hello values suggest, one returns hello data in daily granularity, and hello other is an hourly resolution.</span></span> <span data-ttu-id="57185-139">quotidien Hello est par défaut de hello.</span><span class="sxs-lookup"><span data-stu-id="57185-139">hello daily option is hello default.</span></span> |
| <span data-ttu-id="57185-140">*subscriberId*</span><span class="sxs-lookup"><span data-stu-id="57185-140">*subscriberId*</span></span> |<span data-ttu-id="57185-141">l'ID d'abonnement.</span><span class="sxs-lookup"><span data-stu-id="57185-141">Subscription ID.</span></span> <span data-ttu-id="57185-142">tooget les données filtrées, ID d’abonnement hello d’un locataire direct du fournisseur de hello est requis.</span><span class="sxs-lookup"><span data-stu-id="57185-142">tooget filtered data, hello subscription ID of a direct tenant of hello provider is required.</span></span> <span data-ttu-id="57185-143">Si aucun paramètre de ID d’abonnement est spécifié, appel de hello retourne les données d’utilisation pour les locataires directe du fournisseur du hello.</span><span class="sxs-lookup"><span data-stu-id="57185-143">If no subscription ID parameter is specified, hello call returns usage data for all hello provider’s direct tenants.</span></span> |
| <span data-ttu-id="57185-144">*api-version*</span><span class="sxs-lookup"><span data-stu-id="57185-144">*api-version*</span></span> |<span data-ttu-id="57185-145">Version de protocole hello toomake utilisé cette demande.</span><span class="sxs-lookup"><span data-stu-id="57185-145">Version of hello protocol that is used toomake this request.</span></span> <span data-ttu-id="57185-146">Cette valeur est définie à too2015-06-01-preview.</span><span class="sxs-lookup"><span data-stu-id="57185-146">This value is set too2015-06-01-preview.</span></span> |
| <span data-ttu-id="57185-147">*continuationToken*</span><span class="sxs-lookup"><span data-stu-id="57185-147">*continuationToken*</span></span> |<span data-ttu-id="57185-148">Jeton récupéré à partir de hello dernier appel toohello utilisation de l’API fournisseur.</span><span class="sxs-lookup"><span data-stu-id="57185-148">Token retrieved from hello last call toohello Usage API provider.</span></span> <span data-ttu-id="57185-149">Ce jeton est nécessaire lorsqu’une réponse est supérieure à 1 000 lignes et agit comme un signet pour les cours hello.</span><span class="sxs-lookup"><span data-stu-id="57185-149">This token is needed when a response is greater than 1,000 lines and it acts as a bookmark for hello progress.</span></span> <span data-ttu-id="57185-150">Si ce n’est pas le cas présent, hello données sont récupérées à partir du début hello hello ou les heures, en fonction de la granularité hello passée dans.</span><span class="sxs-lookup"><span data-stu-id="57185-150">If not present, hello data is retrieved from hello beginning of hello day or hour, based on hello granularity passed in.</span></span> |

### <a name="response"></a><span data-ttu-id="57185-151">Réponse</span><span class="sxs-lookup"><span data-stu-id="57185-151">Response</span></span>
<span data-ttu-id="57185-152">GET /subscriptions/sub1/providers/Microsoft.Commerce/subscriberUsageAggregates?reportedStartTime=reportedStartTime=2014-05-01T00%3a00%3a00%2b00%3a00&reportedEndTime=2015-06-01T00%3a00%3a00%2b00%3a00&aggregationGranularity=Daily&subscriberId=sub1.1&api-version=1.0</span><span class="sxs-lookup"><span data-stu-id="57185-152">GET /subscriptions/sub1/providers/Microsoft.Commerce/subscriberUsageAggregates?reportedStartTime=reportedStartTime=2014-05-01T00%3a00%3a00%2b00%3a00&reportedEndTime=2015-06-01T00%3a00%3a00%2b00%3a00&aggregationGranularity=Daily&subscriberId=sub1.1&api-version=1.0</span></span>

<span data-ttu-id="57185-153">{</span><span class="sxs-lookup"><span data-stu-id="57185-153">{</span></span>

<span data-ttu-id="57185-154">"value": \[</span><span class="sxs-lookup"><span data-stu-id="57185-154">"value": \[</span></span>

<span data-ttu-id="57185-155">{</span><span class="sxs-lookup"><span data-stu-id="57185-155">{</span></span>

<span data-ttu-id="57185-156">"id": "/subscriptions/sub1.1/providers/Microsoft.Commerce/UsageAggregate/sub1.1-</span><span class="sxs-lookup"><span data-stu-id="57185-156">"id": "/subscriptions/sub1.1/providers/Microsoft.Commerce/UsageAggregate/sub1.1-</span></span>

<span data-ttu-id="57185-157">meterID1",</span><span class="sxs-lookup"><span data-stu-id="57185-157">meterID1",</span></span>

<span data-ttu-id="57185-158">"name": "sub1.1-meterID1",</span><span class="sxs-lookup"><span data-stu-id="57185-158">"name": "sub1.1-meterID1",</span></span>

<span data-ttu-id="57185-159">"type": "Microsoft.Commerce/UsageAggregate",</span><span class="sxs-lookup"><span data-stu-id="57185-159">"type": "Microsoft.Commerce/UsageAggregate",</span></span>

<span data-ttu-id="57185-160">"properties": {</span><span class="sxs-lookup"><span data-stu-id="57185-160">"properties": {</span></span>

<span data-ttu-id="57185-161">"subscriptionId":"sub1.1",</span><span class="sxs-lookup"><span data-stu-id="57185-161">"subscriptionId":"sub1.1",</span></span>

<span data-ttu-id="57185-162">"usageStartTime": "2015-03-03T00:00:00+00:00",</span><span class="sxs-lookup"><span data-stu-id="57185-162">"usageStartTime": "2015-03-03T00:00:00+00:00",</span></span>

<span data-ttu-id="57185-163">"usageEndTime": "2015-03-04T00:00:00+00:00",</span><span class="sxs-lookup"><span data-stu-id="57185-163">"usageEndTime": "2015-03-04T00:00:00+00:00",</span></span>

<span data-ttu-id="57185-164">"instanceData":"{\\"Microsoft.Resources\\":{\\"resourceUri\\":\\"resourceUri1\\",\\"location\\</span><span class="sxs-lookup"><span data-stu-id="57185-164">"instanceData":"{\\"Microsoft.Resources\\":{\\"resourceUri\\":\\"resourceUri1\\",\\"location\\</span></span>

<span data-ttu-id="57185-165">":\\"Alaska\\",\\"tags\\":null,\\"additionalInfo\\":null}}",</span><span class="sxs-lookup"><span data-stu-id="57185-165">":\\"Alaska\\",\\"tags\\":null,\\"additionalInfo\\":null}}",</span></span>

<span data-ttu-id="57185-166">"quantity":2.4000000000,</span><span class="sxs-lookup"><span data-stu-id="57185-166">"quantity":2.4000000000,</span></span>

<span data-ttu-id="57185-167">"meterId":"meterID1"</span><span class="sxs-lookup"><span data-stu-id="57185-167">"meterId":"meterID1"</span></span>

<span data-ttu-id="57185-168">}</span><span class="sxs-lookup"><span data-stu-id="57185-168">}</span></span>

<span data-ttu-id="57185-169">},</span><span class="sxs-lookup"><span data-stu-id="57185-169">},</span></span>

<span data-ttu-id="57185-170">…</span><span class="sxs-lookup"><span data-stu-id="57185-170">…</span></span>

### <a name="response-details"></a><span data-ttu-id="57185-171">Détails de la réponse</span><span class="sxs-lookup"><span data-stu-id="57185-171">Response details</span></span>
| <span data-ttu-id="57185-172">**Argument**</span><span class="sxs-lookup"><span data-stu-id="57185-172">**Argument**</span></span> | <span data-ttu-id="57185-173">**Description**</span><span class="sxs-lookup"><span data-stu-id="57185-173">**Description**</span></span> |
| --- | --- |
| <span data-ttu-id="57185-174">*id*</span><span class="sxs-lookup"><span data-stu-id="57185-174">*id*</span></span> |<span data-ttu-id="57185-175">ID unique de l’utilisation de hello d’agrégation</span><span class="sxs-lookup"><span data-stu-id="57185-175">Unique ID of hello usage aggregate</span></span> |
| <span data-ttu-id="57185-176">*name*</span><span class="sxs-lookup"><span data-stu-id="57185-176">*name*</span></span> |<span data-ttu-id="57185-177">Nom de l’utilisation de hello d’agrégation</span><span class="sxs-lookup"><span data-stu-id="57185-177">Name of hello usage aggregate</span></span> |
| <span data-ttu-id="57185-178">*type*</span><span class="sxs-lookup"><span data-stu-id="57185-178">*type*</span></span> |<span data-ttu-id="57185-179">Définition de la ressource</span><span class="sxs-lookup"><span data-stu-id="57185-179">Resource definition</span></span> |
| <span data-ttu-id="57185-180">*subscriptionId*</span><span class="sxs-lookup"><span data-stu-id="57185-180">*subscriptionId*</span></span> |<span data-ttu-id="57185-181">Identificateur d’abonnement de l’utilisateur d’Azure pile hello</span><span class="sxs-lookup"><span data-stu-id="57185-181">Subscription identifier of hello Azure Stack user</span></span> |
| <span data-ttu-id="57185-182">*usageStartTime*</span><span class="sxs-lookup"><span data-stu-id="57185-182">*usageStartTime*</span></span> |<span data-ttu-id="57185-183">UTC heure de début de hello utilisation compartiment toowhich cet agrégat d’utilisation appartient</span><span class="sxs-lookup"><span data-stu-id="57185-183">UTC start time of hello usage bucket toowhich this usage aggregate belongs</span></span> |
| <span data-ttu-id="57185-184">*usageEndTime*</span><span class="sxs-lookup"><span data-stu-id="57185-184">*usageEndTime*</span></span> |<span data-ttu-id="57185-185">UTC fin de hello utilisation compartiment toowhich cet agrégat d’utilisation appartient</span><span class="sxs-lookup"><span data-stu-id="57185-185">UTC end time of hello usage bucket toowhich this usage aggregate belongs</span></span> |
| <span data-ttu-id="57185-186">*instanceData*</span><span class="sxs-lookup"><span data-stu-id="57185-186">*instanceData*</span></span> |<span data-ttu-id="57185-187">Paires clé-valeur des détails de l’instance (dans un nouveau format) :</span><span class="sxs-lookup"><span data-stu-id="57185-187">Key-value pairs of instance details (in a new format):</span></span><br> <span data-ttu-id="57185-188">*resourceUri*: complet des ID de ressource, qui inclut les groupes de ressources hello et nom de l’instance hello</span><span class="sxs-lookup"><span data-stu-id="57185-188">*resourceUri*: Fully qualified resource ID, which includes hello resource groups and hello instance name</span></span> <br> <span data-ttu-id="57185-189">*location* : région dans laquelle ce service a été exécuté</span><span class="sxs-lookup"><span data-stu-id="57185-189">*location*: Region in which this service was run</span></span> <br> <span data-ttu-id="57185-190">*balises*: les balises de ressources qui sont spécifiées par l’utilisateur de hello</span><span class="sxs-lookup"><span data-stu-id="57185-190">*tags*: Resource tags that are specified by hello user</span></span> <br> <span data-ttu-id="57185-191">*additionalInfo*: plus d’informations sur la ressource hello consommé, par exemple, le type d’image ou de la version du système d’exploitation</span><span class="sxs-lookup"><span data-stu-id="57185-191">*additionalInfo*: More details about hello resource that was consumed, for example, OS version or image type</span></span> |
| <span data-ttu-id="57185-192">*quantity*</span><span class="sxs-lookup"><span data-stu-id="57185-192">*quantity*</span></span> |<span data-ttu-id="57185-193">Quantité de ressources consommées au cours de cette période</span><span class="sxs-lookup"><span data-stu-id="57185-193">Amount of resource consumption that occurred in this time frame</span></span> |
| <span data-ttu-id="57185-194">*meterId*</span><span class="sxs-lookup"><span data-stu-id="57185-194">*meterId*</span></span> |<span data-ttu-id="57185-195">ID unique pour la ressource hello qui a été consommée (également appelé *ResourceID*)</span><span class="sxs-lookup"><span data-stu-id="57185-195">Unique ID for hello resource that was consumed (also called *ResourceID*)</span></span> |

## <a name="next-steps"></a><span data-ttu-id="57185-196">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="57185-196">Next steps</span></span>
[<span data-ttu-id="57185-197">Informations de référence sur l’API d’utilisation des ressources de locataire</span><span class="sxs-lookup"><span data-stu-id="57185-197">Tenant resource usage API reference</span></span>](azure-stack-tenant-resource-usage-api.md)

[<span data-ttu-id="57185-198">Questions fréquentes (FAQ) relatives à l’utilisation</span><span class="sxs-lookup"><span data-stu-id="57185-198">Usage-related FAQ</span></span>](azure-stack-usage-related-faq.md)

