---
title: "Gérer la stratégie de mise en cache CDN dans Azure Media Services | Microsoft Docs"
description: "Découvrez comment gérer la stratégie de mise en cache CDN dans Azure Media Services."
services: media-services,cdn
documentationcenter: .NET
author: juliako
manager: erikre
editor: 
ms.assetid: be33aecc-6dbe-43d7-a056-10ba911e0e94
ms.service: media-services
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 02/04/2017
ms.author: juliako
ms.openlocfilehash: 0c479a58f4158bb1a72dc43432507160f65d2791
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/11/2017
---
# <a name="manage-azure-cdn-caching-policy-in-azure-media-services"></a><span data-ttu-id="13234-103">Gérer la stratégie de mise en cache CDN dans Azure Media Services</span><span class="sxs-lookup"><span data-stu-id="13234-103">Manage Azure CDN caching policy in Azure Media Services</span></span>
<span data-ttu-id="13234-104">Azure Media Services fournit la diffusion en continu adaptative HTTP et le téléchargement progressif.</span><span class="sxs-lookup"><span data-stu-id="13234-104">Azure Media Services provides HTTP based Adaptive Streaming and progressive download.</span></span> <span data-ttu-id="13234-105">La diffusion en continu HTTP est hautement évolutive de par les avantages de mise en cache dans le proxy et les couches CDN, et la mise en cache côté client.</span><span class="sxs-lookup"><span data-stu-id="13234-105">HTTP based streaming is highly scalable with benefits of caching in proxy and CDN layers as well as client side caching.</span></span> <span data-ttu-id="13234-106">Les points de terminaison de la diffusion en continu fournissent des fonctionnalités générales de diffusion en continu et de configuration pour les en-têtes HTTP du cache.</span><span class="sxs-lookup"><span data-stu-id="13234-106">Streaming endpoints provides general streaming capabilities and also configuration for HTTP cache headers.</span></span> <span data-ttu-id="13234-107">Les points de terminaison de diffusion en continu définissent le contrôle de cache HTTP : les en-têtes max-age et Expires.</span><span class="sxs-lookup"><span data-stu-id="13234-107">Streaming endpoints sets HTTP Cache-Control: max-age and Expires headers.</span></span> <span data-ttu-id="13234-108">Pour plus d'informations sur les en-têtes de cache HTTP, rendez-vous sur le site [W3.org](http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html).</span><span class="sxs-lookup"><span data-stu-id="13234-108">You can get more information for HTTP cache headers from [W3.org](http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html).</span></span>

## <a name="default-caching-headers"></a><span data-ttu-id="13234-109">En-têtes de mise en cache par défaut</span><span class="sxs-lookup"><span data-stu-id="13234-109">Default Caching headers</span></span>
<span data-ttu-id="13234-110">Les points de terminaison de diffusion en continu appliquent par défaut des en-têtes de cache de 3 jours pour les données de diffusion en continu à la demande (fragments/segments de médias réels) et les fichiers manifestes (ou sélections).</span><span class="sxs-lookup"><span data-stu-id="13234-110">By default streaming-endpoints apply 3 day cache headers for on-demand streaming data (actual media fragments/chunks) and manifest(playlist).</span></span> <span data-ttu-id="13234-111">Pour la diffusion en continu en direct, les points de terminaison de diffusion en continu appliquent des en-têtes de cache de 3 jours pour les données (fragments/segments de médias réels) et une en-tête de cache de 2 secondes pour les requêtes de fichier manifeste (ou sélections).</span><span class="sxs-lookup"><span data-stu-id="13234-111">For live streaming, streaming endpoints apply 3 day cache headers for data (actual media fragments/chunks) and 2 seconds cache header for manifest(playlist) requests.</span></span> <span data-ttu-id="13234-112">Lorsque le programme en direct opte pour une diffusion en continu à la demande (archive en direct), les en-têtes de cache de diffusion en continu à la demande s’appliquent.</span><span class="sxs-lookup"><span data-stu-id="13234-112">When live program turns to on-demand (live archive) then on-demand streaming cache headers apply.</span></span>

## <a name="azure-cdn-integration"></a><span data-ttu-id="13234-113">Intégration d’Azure CDN</span><span class="sxs-lookup"><span data-stu-id="13234-113">Azure CDN integration</span></span>
<span data-ttu-id="13234-114">Azure Media Services propose un [CDN intégré](https://azure.microsoft.com/updates/azure-media-services-now-fully-integrated-with-azure-cdn/) pour les points de terminaison de diffusion en continu.</span><span class="sxs-lookup"><span data-stu-id="13234-114">Azure Media Services provides [integrated CDN](https://azure.microsoft.com/updates/azure-media-services-now-fully-integrated-with-azure-cdn/) for streaming-endpoints.</span></span> <span data-ttu-id="13234-115">Les en-têtes de contrôle du cache s'applique aux points de terminaison de diffusion en continu de la même façon qu’aux points de terminaison de diffusion en continu fonctionnant avec CDN.</span><span class="sxs-lookup"><span data-stu-id="13234-115">Cache-control headers applies in the same way as streaming endpoints to CDN enabled streaming endpoints.</span></span> <span data-ttu-id="13234-116">Azure CDN utilise les valeurs configurées de cache de points de terminaison de diffusion en continu pour définir la durée de vie des objets mis en cache en interne, et il utilise également cette valeur pour définir les en-têtes de cache de distribution.</span><span class="sxs-lookup"><span data-stu-id="13234-116">Azure CDN uses streaming endpoint configured cache values to define the life time of the internally cached objects and also uses this value to set the delivery cache headers.</span></span> <span data-ttu-id="13234-117">Lors de l'utilisation des points de terminaison de diffusion en continu fonctionnant avec CDN, il est déconseillé de définir des petites valeurs de cache</span><span class="sxs-lookup"><span data-stu-id="13234-117">When using CDN enabled streaming endpoints it is not recommended to set small cache values.</span></span> <span data-ttu-id="13234-118">Définir de petites valeurs diminue les performances et réduit le profit du CDN.</span><span class="sxs-lookup"><span data-stu-id="13234-118">Setting small values will decrease the performance and reduce the benefit of CDN.</span></span> <span data-ttu-id="13234-119">Il est interdit de définir des en-têtes de cache inférieure à 600 secondes pour les points de terminaison de diffusion en continu fonctionnant avec CDN.</span><span class="sxs-lookup"><span data-stu-id="13234-119">It is not allowed to set cache headers smaller than 600 seconds for CDN enabled streaming endpoints.</span></span>

> [!IMPORTANT]
><span data-ttu-id="13234-120">Azure Media Services est complètement intégré à Azure CDN.</span><span class="sxs-lookup"><span data-stu-id="13234-120">Azure Media Services has complete integration with Azure CDN.</span></span> <span data-ttu-id="13234-121">En un seul clic, vous pouvez intégrer tous les fournisseurs Azure CDN disponibles (Akamai et Verizon) à votre point de terminaison de streaming, y compris les produits CDN Standard et Premium.</span><span class="sxs-lookup"><span data-stu-id="13234-121">With a single click you can integrate all the available Azure CDN providers (Akamai and Verizon) to your streaming endpoint including CDN Standard and Premium products.</span></span> <span data-ttu-id="13234-122">Pour plus d’informations, consultez cette [annonce](https://azure.microsoft.com/blog/standardstreamingendpoint/).</span><span class="sxs-lookup"><span data-stu-id="13234-122">For more information, see this [announcement](https://azure.microsoft.com/blog/standardstreamingendpoint/).</span></span>
> 
> <span data-ttu-id="13234-123">Les frais liés au transfert des données à partir d’un point de terminaison de streaming vers CDN sont désactivés uniquement si le CDN est activé sur les API de point de terminaison de streaming ou s’il utilise la section de point de terminaison de streaming du portail de gestion Azure.</span><span class="sxs-lookup"><span data-stu-id="13234-123">Data charges from streaming endpoint to CDN only gets disabled if the CDN is enabled over streaming endpoint APIs or using Azure management portal's streaming endpoint section.</span></span> <span data-ttu-id="13234-124">L’intégration manuelle ou la création directe d’un point de terminaison CDN à l’aide des API du CDN ou de la section du portail ne désactivent pas les frais de données.</span><span class="sxs-lookup"><span data-stu-id="13234-124">Manual integration or directly creating a CDN endpoint using CDN APIs or portal section will not disable the data charges.</span></span>

## <a name="configuring-cache-headers-with-azure-media-services"></a><span data-ttu-id="13234-125">Configuration des en-têtes de cache avec Azure Media Services</span><span class="sxs-lookup"><span data-stu-id="13234-125">Configuring cache headers with Azure Media Services</span></span>
<span data-ttu-id="13234-126">Vous pouvez utiliser le portail de gestion Azure ou des API d’Azure Media Services pour configurer les valeurs des en-têtes de cache.</span><span class="sxs-lookup"><span data-stu-id="13234-126">You can use Azure Management portal or Azure Media Services APIs to configure cache header values.</span></span>

1. <span data-ttu-id="13234-127">Pour configurer les en-têtes de cache à l'aide du portail de gestion, reportez-vous à la section [Gestion des points de terminaison de diffusion en continu](../media-services/media-services-portal-manage-streaming-endpoints.md) de la page relative à la configuration du point de terminaison de diffusion en continu.</span><span class="sxs-lookup"><span data-stu-id="13234-127">To configure cache headers using management portal please refer to [How to Manage Streaming Endpoints](../media-services/media-services-portal-manage-streaming-endpoints.md) section Configuring the Streaming Endpoint.</span></span>
2. <span data-ttu-id="13234-128">API REST d'Azure Media Services, [StreamingEndpoint](https://msdn.microsoft.com/library/azure/dn783468.aspx#StreamingEndpointCacheControl).</span><span class="sxs-lookup"><span data-stu-id="13234-128">Azure Media Services REST API, [StreamingEndpoint](https://msdn.microsoft.com/library/azure/dn783468.aspx#StreamingEndpointCacheControl).</span></span>
3. <span data-ttu-id="13234-129">Kit de développement logiciel (SDK) .NET Azure Media Services, [Propriétés StreamingEndpointCacheControl](http://go.microsoft.com/fwlink/?LinkId=615302).</span><span class="sxs-lookup"><span data-stu-id="13234-129">Azure Media Services .NET SDK, [StreamingEndpointCacheControl Properties](http://go.microsoft.com/fwlink/?LinkId=615302).</span></span>

## <a name="cache-configuration-precedence-order"></a><span data-ttu-id="13234-130">Ordre de priorité de la configuration du cache</span><span class="sxs-lookup"><span data-stu-id="13234-130">Cache configuration precedence order</span></span>
1. <span data-ttu-id="13234-131">La valeur configurée du cache Azure Media Services remplace la valeur par défaut.</span><span class="sxs-lookup"><span data-stu-id="13234-131">Azure Media Services configured cache value overrides default value.</span></span>
2. <span data-ttu-id="13234-132">S'il n'existe aucune configuration manuelle, les valeurs par défaut s'appliquent.</span><span class="sxs-lookup"><span data-stu-id="13234-132">If there is no manual configuration, default values applies.</span></span>
3. <span data-ttu-id="13234-133">Des en-têtes de cache de 2 secondes s’appliquent par défaut aux fichiers manifestes de diffusion en continu en direct (ou sélections) quelle que soit la configuration d'Azure Media ou d’Azure Storage, et elles sont irremplaçables.</span><span class="sxs-lookup"><span data-stu-id="13234-133">By default 2 seconds cache headers applies to live streaming manifest(playlist) regardless of Azure Media or Azure Storage configuration and overriding of this value is not available.</span></span>

