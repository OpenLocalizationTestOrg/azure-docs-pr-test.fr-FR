---
title: Questions courantes sur Microsoft Azure Service Fabric | Microsoft Docs
description: "Questions fréquentes sur Service Fabric et leurs réponses"
services: service-fabric
documentationcenter: .net
author: chackdan
manager: timlt
editor: 
ms.assetid: 5a179703-ff0c-4b8e-98cd-377253295d12
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 08/18/2017
ms.author: chackdan
ms.openlocfilehash: ee1fe4e83ce796fd50b779c0880701b9dfcefff7
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/18/2017
---
# <a name="commonly-asked-service-fabric-questions"></a><span data-ttu-id="342a9-103">Questions fréquentes sur Service Fabric</span><span class="sxs-lookup"><span data-stu-id="342a9-103">Commonly asked Service Fabric questions</span></span>

<span data-ttu-id="342a9-104">Les utilisateurs posent fréquemment des questions sur l’utilisation et les fonctionnalités de Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="342a9-104">There are many commonly asked questions about what Service Fabric can do and how it should be used.</span></span> <span data-ttu-id="342a9-105">Ce document regroupe un grand nombre de ces questions fréquentes et leurs réponses.</span><span class="sxs-lookup"><span data-stu-id="342a9-105">This document covers many of those common questions and their answers.</span></span>

## <a name="cluster-setup-and-management"></a><span data-ttu-id="342a9-106">Création et gestion de clusters</span><span class="sxs-lookup"><span data-stu-id="342a9-106">Cluster setup and management</span></span>

### <a name="can-i-create-a-cluster-that-spans-multiple-azure-regions-or-my-own-datacenters"></a><span data-ttu-id="342a9-107">Puis-je créer un cluster qui englobe plusieurs régions Azure ou mes propres centres de données ?</span><span class="sxs-lookup"><span data-stu-id="342a9-107">Can I create a cluster that spans multiple Azure regions or my own datacenters?</span></span>

<span data-ttu-id="342a9-108">Oui.</span><span class="sxs-lookup"><span data-stu-id="342a9-108">Yes.</span></span> 

<span data-ttu-id="342a9-109">La technologie de clustering Service Fabric permet de combiner des machines qui s’exécutent partout dans le monde, tant qu’elles sont connectées entre elles par un réseau.</span><span class="sxs-lookup"><span data-stu-id="342a9-109">The core Service Fabric clustering technology can be used to combine machines running anywhere in the world, so long as they have network connectivity to each other.</span></span> <span data-ttu-id="342a9-110">Toutefois, la création et l’exécution d’un tel cluster peuvent être compliquées.</span><span class="sxs-lookup"><span data-stu-id="342a9-110">However, building and running such a cluster can be complicated.</span></span>

<span data-ttu-id="342a9-111">Si vous êtes intéressé par ce scénario, nous vous encourageons à nous contacter via la [Liste de problèmes Service Fabric sur Github](https://github.com/azure/service-fabric-issues) ou via votre technicien de support, afin d’obtenir une aide supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="342a9-111">If you are interested in this scenario, we encourage you to get in contact either through the [Service Fabric Github Issues List](https://github.com/azure/service-fabric-issues) or through your support representative in order to obtain additional guidance.</span></span> <span data-ttu-id="342a9-112">L’équipe Service Fabric travaille à fournir des instructions et des recommandations claires pour ce scénario.</span><span class="sxs-lookup"><span data-stu-id="342a9-112">The Service Fabric team is working to provide additional clarity, guidance, and recommendations for this scenario.</span></span> 

<span data-ttu-id="342a9-113">Voici quelques points importants à prendre en compte :</span><span class="sxs-lookup"><span data-stu-id="342a9-113">Some things to consider:</span></span> 

1. <span data-ttu-id="342a9-114">À l’heure actuelle, la ressource de cluster Service Fabric dans Azure est régionale, comme les groupes de machines virtuelles identiques sur lesquels le cluster est basé.</span><span class="sxs-lookup"><span data-stu-id="342a9-114">The Service Fabric cluster resource in Azure is regional today, as are the virtual machine scale sets that the cluster is built on.</span></span> <span data-ttu-id="342a9-115">De fait, en cas de défaillance régionale, vous risquez de perdre la possibilité de gérer le cluster via Azure Resource Manager ou le portail Azure.</span><span class="sxs-lookup"><span data-stu-id="342a9-115">This means that in the event of a regional failure you may lose the ability to manage the cluster via the Azure Resource Manager or the Azure Portal.</span></span> <span data-ttu-id="342a9-116">Cela peut se produire même si le cluster continue de s’exécuter et que vous pouvez interagir directement avec lui.</span><span class="sxs-lookup"><span data-stu-id="342a9-116">This can happen even though the cluster remains running and you'd be able to interact with it directly.</span></span> <span data-ttu-id="342a9-117">En outre, Azure ne permet pas à un même réseau virtuel d’être utilisé par plusieurs régions.</span><span class="sxs-lookup"><span data-stu-id="342a9-117">In addition, Azure today does not offer the ability to have a single virtual network that is usable across regions.</span></span> <span data-ttu-id="342a9-118">Par conséquent, un cluster Azure à plusieurs régions nécessite soit des [adresses IP publiques pour chaque machine virtuelle dans VM Scale Sets](../virtual-machine-scale-sets/virtual-machine-scale-sets-networking.md#public-ipv4-per-virtual-machine), soit des [passerelles VPN Azure](../vpn-gateway/vpn-gateway-about-vpngateways.md).</span><span class="sxs-lookup"><span data-stu-id="342a9-118">This means that a multi-region cluster in Azure requires either [Public IP Addresses for each VM in the VM Scale Sets](../virtual-machine-scale-sets/virtual-machine-scale-sets-networking.md#public-ipv4-per-virtual-machine) or [Azure VPN Gateways](../vpn-gateway/vpn-gateway-about-vpngateways.md).</span></span> <span data-ttu-id="342a9-119">Toutes ces options de réseau ont un impact différent sur les coûts, les performances, et à un certain degré, sur la conception de l’application. Il est donc nécessaire d’analyser et de planifier avec soin avant de configurer un tel environnement.</span><span class="sxs-lookup"><span data-stu-id="342a9-119">These networking choices have different impacts on costs, performance, and to some degree application design, so careful analysis and planning is required before standing up such an environment.</span></span>
2. <span data-ttu-id="342a9-120">La maintenance, la gestion et la surveillance de ces machines peuvent devenir complexes, en particulier en cas de répartition sur plusieurs _types_ d’environnements, par exemple, entre différents fournisseurs cloud, ou entre des ressources locales et des ressources Azure.</span><span class="sxs-lookup"><span data-stu-id="342a9-120">The maintenance, management, and monitoring of these machines can become complicated, especially when spanned across _types_ of environments, such as between different cloud providers or between on-premises resources and Azure.</span></span> <span data-ttu-id="342a9-121">Vérifiez bien que les mises à niveau, la surveillance, la gestion et les diagnostics ont été compris à la fois pour le cluster et les applications avant d’exécuter les charges de travail de production dans un tel environnement.</span><span class="sxs-lookup"><span data-stu-id="342a9-121">Care must be taken to ensure that upgrades, monitoring, management, and diagnostics are understood for both the cluster and the applications before running production workloads in such an environment.</span></span> <span data-ttu-id="342a9-122">Si vous avez l’habitude de résoudre ces problèmes dans Azure ou dans vos propres centres de données, il est probable que vous puissiez appliquer ces mêmes solutions lors de la création ou de l’exécution de votre cluster Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="342a9-122">If you already have lots of experience solving these problems in Azure or within your own datacenters, then it is likely that those same solutions can be applied when building out or running your Service Fabric cluster.</span></span> 

### <a name="do-service-fabric-nodes-automatically-receive-os-updates"></a><span data-ttu-id="342a9-123">Les nœuds Service Fabric reçoivent-ils automatiquement les mises à jour du système d’exploitation ?</span><span class="sxs-lookup"><span data-stu-id="342a9-123">Do Service Fabric nodes automatically receive OS updates?</span></span>

<span data-ttu-id="342a9-124">Pas encore, mais il s’agit d’une demande courante que nous prévoyons de mettre en œuvre.</span><span class="sxs-lookup"><span data-stu-id="342a9-124">Not today, but this is also a common request that Azure intends to deliver.</span></span>

<span data-ttu-id="342a9-125">En attendant, nous avons [fourni une application](service-fabric-patch-orchestration-application.md) permettant aux systèmes d’exploitation situés sous vos nœuds Service Fabric de rester à jour et d’obtenir les derniers correctifs.</span><span class="sxs-lookup"><span data-stu-id="342a9-125">In the interim, we have [provided an application](service-fabric-patch-orchestration-application.md) that the operating systems underneath your Service Fabric nodes stay patched and up to date.</span></span>

<span data-ttu-id="342a9-126">Avec les mises à jour du système d’exploitation, le défi réside dans le fait qu’elles nécessitent généralement un redémarrage de l’ordinateur, ce qui entraîne une indisponibilité temporaire.</span><span class="sxs-lookup"><span data-stu-id="342a9-126">The challenge with OS updates is that they typically require a reboot of the machine, which results in temporary availability loss.</span></span> <span data-ttu-id="342a9-127">En soi, ce n’est pas un problème, car Service Fabric redirige automatiquement le trafic de ces services vers d’autres nœuds.</span><span class="sxs-lookup"><span data-stu-id="342a9-127">By itself, that is not a problem, since Service Fabric will automatically redirect traffic for those services to other nodes.</span></span> <span data-ttu-id="342a9-128">Toutefois, si les mises à jour du système d’exploitation ne sont pas coordonnées dans le cluster, plusieurs nœuds risquent d’être indisponibles en même temps.</span><span class="sxs-lookup"><span data-stu-id="342a9-128">However, if OS updates are not coordinated across the cluster, there is the potential that many nodes go down at once.</span></span> <span data-ttu-id="342a9-129">Ces redémarrages simultanés peuvent entraîner l’indisponibilité complète d’un service ou, au moins, d’une partition spécifique (pour un service avec état).</span><span class="sxs-lookup"><span data-stu-id="342a9-129">Such simultaneous reboots can cause complete availability loss for a service, or at least for a specific partition (for a stateful service).</span></span>

<span data-ttu-id="342a9-130">À l’avenir, nous prévoyons de prendre en charge une stratégie de mise à jour du système d’exploitation totalement automatisée et coordonnée entre les domaines de mise à jour, ce qui garantit une disponibilité continue malgré les redémarrages et autres défaillances inattendues.</span><span class="sxs-lookup"><span data-stu-id="342a9-130">In the future, we plan to support an OS update policy that is fully automated and coordinated across update domains, ensuring that availability is maintained despite reboots and other unexpected failures.</span></span>

### <a name="can-i-use-large-virtual-machine-scale-sets-in-my-sf-cluster"></a><span data-ttu-id="342a9-131">Puis-je utiliser de grands groupes identiques de machines virtuelles dans mon cluster Service Fabric ?</span><span class="sxs-lookup"><span data-stu-id="342a9-131">Can I use Large Virtual Machine Scale Sets in my SF cluster?</span></span> 

<span data-ttu-id="342a9-132">**Réponse courte** : Non.</span><span class="sxs-lookup"><span data-stu-id="342a9-132">**Short answer** - No.</span></span> 

<span data-ttu-id="342a9-133">**Réponse longue** : Bien que les grands groupes identiques de machines virtuelles puissent évoluer jusqu’à 1000 instances de machines virtuelles, ils utilisent pour cela des groupes de positionnement (PG).</span><span class="sxs-lookup"><span data-stu-id="342a9-133">**Long Answer** - Although the Large Virtual Machine Scale Sets allow you to scale a virtual machine scale set upto 1000 VM instances, it does so by the use of Placement Groups (PGs).</span></span> <span data-ttu-id="342a9-134">Les domaines d’erreur (FD) et les domaines de mise à niveau (UD) ne sont cohérents qu’au sein d’un groupe de placement. Service Fabric utilise des domaines d’erreur et des domaines de mise à niveau pour prendre des décisions de placement de vos instances/réplicas de service.</span><span class="sxs-lookup"><span data-stu-id="342a9-134">Fault domains (FDs) and upgrade domains (UDs) are only consistent within a placement group Service fabric uses FDs and UDs to make placement decisions of your service replicas/Service instances.</span></span> <span data-ttu-id="342a9-135">Étant donné que les domaines d’erreur et de mise à niveau ne sont comparables qu’au sein d’un groupe de placement, Service Fabric ne peut pas les utiliser.</span><span class="sxs-lookup"><span data-stu-id="342a9-135">Since the FDs  and UDs are comparable only within a placement group SF cannot use it.</span></span> <span data-ttu-id="342a9-136">Par exemple, si VM1 dans PG1 a une topologie de FD = 0 et VM9 dans PG2 a une topologie de FD = 4, cela ne signifie pas que VM1 et VM2 se trouvent sur deux racks matériels différents. Par conséquent, Service Fabric ne peut pas dans ce cas utiliser les valeurs FD pour prendre des décisions de placement.</span><span class="sxs-lookup"><span data-stu-id="342a9-136">For example, If VM1 in PG1 has a topology of FD=0 and VM9 in PG2 has a topology of FD=4 , it does not mean that VM1 and VM2 are on two different Hardware Racks, hence SF cannot use the FD values in this case to make placement decisions.</span></span>

<span data-ttu-id="342a9-137">Il y a actuellement d’autres problèmes avec les groupes identiques de machines virtuelles volumineux, notamment l’absence de prise en charge de l’équilibrage de charge de niveau 4.</span><span class="sxs-lookup"><span data-stu-id="342a9-137">There are other issues with Large virtual machine scale sets currently, like the lack of level-4 Load balancing support.</span></span> <span data-ttu-id="342a9-138">Pour plus d’informations, consultez la page [Grands groupes identiques](../virtual-machine-scale-sets/virtual-machine-scale-sets-placement-groups.md)</span><span class="sxs-lookup"><span data-stu-id="342a9-138">Refer to for [details on Large scale sets](../virtual-machine-scale-sets/virtual-machine-scale-sets-placement-groups.md)</span></span>



### <a name="what-is-the-minimum-size-of-a-service-fabric-cluster-why-cant-it-be-smaller"></a><span data-ttu-id="342a9-139">Quelle est la taille minimale d’un cluster Service Fabric ?</span><span class="sxs-lookup"><span data-stu-id="342a9-139">What is the minimum size of a Service Fabric cluster?</span></span> <span data-ttu-id="342a9-140">Pourquoi ne peut-il pas être plus petit ?</span><span class="sxs-lookup"><span data-stu-id="342a9-140">Why can't it be smaller?</span></span>

<span data-ttu-id="342a9-141">La taille minimale prise en charge pour un cluster Service Fabric exécutant des charges de travail de production est de cinq nœuds.</span><span class="sxs-lookup"><span data-stu-id="342a9-141">The minimum supported size for a Service Fabric cluster running production workloads is five nodes.</span></span> <span data-ttu-id="342a9-142">Pour les scénarios de développement/test, nous prenons en charge des clusters à trois nœuds.</span><span class="sxs-lookup"><span data-stu-id="342a9-142">For dev/test scenarios, we support three node clusters.</span></span>

<span data-ttu-id="342a9-143">Ces valeurs minimales existent parce que le cluster Service Fabric exécute un ensemble de services système avec état, dont le service d’affectation de noms et Failover Manager.</span><span class="sxs-lookup"><span data-stu-id="342a9-143">These minimums exist because the Service Fabric cluster runs a set of stateful system services, including the naming service and the failover manager.</span></span> <span data-ttu-id="342a9-144">Ces services, qui suivent les services déployés sur le cluster ainsi que leur emplacement d’hébergement actuel, requièrent une cohérence forte.</span><span class="sxs-lookup"><span data-stu-id="342a9-144">These services, which track what services have been deployed to the cluster and where they're currently hosted, depend on strong consistency.</span></span> <span data-ttu-id="342a9-145">Cette cohérence forte, quant à elle, dépend de la capacité d’atteindre un *quorum* pour une mise à jour donnée de l’état de ces services, ce quorum représentant une majorité stricte des réplicas (N/2 + 1) pour un service donné.</span><span class="sxs-lookup"><span data-stu-id="342a9-145">That strong consistency, in turn, depends on the ability to acquire a *quorum* for any given update to the state of those services, where a quorum represents a strict majority of the replicas (N/2 +1) for a given service.</span></span>

<span data-ttu-id="342a9-146">Dans ce cadre, examinons certaines configurations de cluster possibles :</span><span class="sxs-lookup"><span data-stu-id="342a9-146">With that background, let's examine some possible cluster configurations:</span></span>

<span data-ttu-id="342a9-147">**Un nœud** : cette option n’assure pas une haute disponibilité, car la perte du nœud pour une raison quelconque se traduit par la perte du cluster.</span><span class="sxs-lookup"><span data-stu-id="342a9-147">**One node**: this option does not provide high availability since the loss of the single node for any reason means the loss of the entire cluster.</span></span>

<span data-ttu-id="342a9-148">**Deux nœuds** : le quorum d’un service déployé sur deux nœuds (N = 2) est 2 (2/2 + 1 = 2).</span><span class="sxs-lookup"><span data-stu-id="342a9-148">**Two nodes**: a quorum for a service deployed across two nodes (N = 2) is 2 (2/2 + 1 = 2).</span></span> <span data-ttu-id="342a9-149">En cas de perte d’un réplica, il est impossible d’obtenir un quorum.</span><span class="sxs-lookup"><span data-stu-id="342a9-149">When a single replica is lost, it is impossible to create a quorum.</span></span> <span data-ttu-id="342a9-150">Comme la mise à niveau d’un serveur requiert la mise hors ligne d’un réplica, cette configuration n’a aucune utilité.</span><span class="sxs-lookup"><span data-stu-id="342a9-150">Since performing a service upgrade requires temporarily taking down a replica, this is not a useful configuration.</span></span>

<span data-ttu-id="342a9-151">**Trois nœuds** : avec trois nœuds (N = 3), la condition requise pour créer un quorum reste de deux nœuds (3/2 + 1 = 2).</span><span class="sxs-lookup"><span data-stu-id="342a9-151">**Three nodes**: with three nodes (N=3), the requirement to create a quorum is still two nodes (3/2 + 1 = 2).</span></span> <span data-ttu-id="342a9-152">Cela signifie que vous pouvez perdre un nœud et conserver le quorum.</span><span class="sxs-lookup"><span data-stu-id="342a9-152">This means that you can lose an individual node and still maintain quorum.</span></span>

<span data-ttu-id="342a9-153">La configuration de cluster à trois nœuds est prise en charge pour le développement/test, car vous pouvez en toute sécurité effectuer des mises à niveau et faire face aux défaillances d’un nœud, tant que ces deux événements ne sont pas simultanés.</span><span class="sxs-lookup"><span data-stu-id="342a9-153">The three node cluster configuration is supported for dev/test because you can safely perform upgrades and survive individual node failures, as long as they don't happen simultaneously.</span></span> <span data-ttu-id="342a9-154">Pour les charges de travail de production, vous devez être résilient face à une telle défaillance simultanée. Cinq nœuds sont donc nécessaires.</span><span class="sxs-lookup"><span data-stu-id="342a9-154">For production workloads, you must be resilient to such a simultaneous failure, so five nodes are required.</span></span>

### <a name="can-i-turn-off-my-cluster-at-nightweekends-to-save-costs"></a><span data-ttu-id="342a9-155">Puis-je désactiver mon cluster la nuit et le week-end pour réduire les coûts ?</span><span class="sxs-lookup"><span data-stu-id="342a9-155">Can I turn off my cluster at night/weekends to save costs?</span></span>

<span data-ttu-id="342a9-156">En général, non.</span><span class="sxs-lookup"><span data-stu-id="342a9-156">In general, no.</span></span> <span data-ttu-id="342a9-157">Service Fabric stocke l’état sur des disques éphémères locaux. En d’autres termes, si la machine virtuelle est déplacée vers un hôte différent, les données n’effectuent pas le déplacement.</span><span class="sxs-lookup"><span data-stu-id="342a9-157">Service Fabric stores state on local, ephemeral disks, meaning that if the virtual machine is moved to a different host, the data does not move with it.</span></span> <span data-ttu-id="342a9-158">Normalement, ce n’est pas un problème car le nouveau nœud est mis à jour par d’autres nœuds.</span><span class="sxs-lookup"><span data-stu-id="342a9-158">In normal operation, that is not a problem as the new node is brought up to date by other nodes.</span></span> <span data-ttu-id="342a9-159">Toutefois, si vous arrêtez tous les nœuds et que vous les redémarrez ultérieurement, il est fort probable que la plupart des nœuds démarrent sur de nouveaux hôtes et empêchent la restauration du système.</span><span class="sxs-lookup"><span data-stu-id="342a9-159">However, if you stop all nodes and restart them later, there is a significant possibility that most of the nodes start on new hosts and make the system unable to recover.</span></span>

<span data-ttu-id="342a9-160">Si vous souhaitez créer des clusters pour tester votre application avant de la déployer, nous vous recommandons de les créer dynamiquement dans le cadre de votre [pipeline d’intégration continue/de déploiement continu](service-fabric-set-up-continuous-integration.md).</span><span class="sxs-lookup"><span data-stu-id="342a9-160">If you would like to create clusters for testing your application before it is deployed, we recommend that you dynamically create those clusters as part of your [continuous integration/continuous deployment pipeline](service-fabric-set-up-continuous-integration.md).</span></span>


### <a name="how-do-i-upgrade-my-operating-system-for-example-from-windows-server-2012-to-windows-server-2016"></a><span data-ttu-id="342a9-161">Comment mettre à niveau mon système d’exploitation (par exemple de Windows Server 2012 vers Windows Server 2016) ?</span><span class="sxs-lookup"><span data-stu-id="342a9-161">How do I upgrade my Operating System (for example from Windows Server 2012 to Windows Server 2016)?</span></span>

<span data-ttu-id="342a9-162">Alors que nous travaillons sur une expérience améliorée, vous êtes aujourd’hui chargé de la mise à niveau.</span><span class="sxs-lookup"><span data-stu-id="342a9-162">While we're working on an improved experience, today, you are responsible for the upgrade.</span></span> <span data-ttu-id="342a9-163">Vous devez mettre à niveau l’image du système d’exploitation sur les machines virtuelles du cluster, une machine virtuelle à la fois.</span><span class="sxs-lookup"><span data-stu-id="342a9-163">You must upgrade the OS image on the virtual machines of the cluster one VM at a time.</span></span> 

## <a name="container-support"></a><span data-ttu-id="342a9-164">Support pour les conteneurs</span><span class="sxs-lookup"><span data-stu-id="342a9-164">Container Support</span></span>

### <a name="why-are-my-containers-that-are-deployed-to-sf-unable-to-resolve-dns-addresses"></a><span data-ttu-id="342a9-165">Pourquoi mes conteneurs déployés sur SF ne parviennent-ils pas à résoudre les adresses DNS ?</span><span class="sxs-lookup"><span data-stu-id="342a9-165">Why are my containers that are deployed to SF unable to resolve DNS addresses?</span></span>

<span data-ttu-id="342a9-166">Ce problème a été signalé sur les clusters version 5.6.204.9494</span><span class="sxs-lookup"><span data-stu-id="342a9-166">This issue has been reported on clusters that are on 5.6.204.9494 version</span></span> 

<span data-ttu-id="342a9-167">**Solution de contournement** : suivez les instructions de [ce document](service-fabric-dnsservice.md) pour activer le service DNS de Service Fabric dans votre cluster.</span><span class="sxs-lookup"><span data-stu-id="342a9-167">**Mitigation** :  Follow [this document](service-fabric-dnsservice.md) to enable the DNS service fabric service in your cluster.</span></span>

<span data-ttu-id="342a9-168">**Correction** : mettez le cluster à niveau vers une version prise en charge supérieure à 5.6.204.9494, si une telle version est disponible.</span><span class="sxs-lookup"><span data-stu-id="342a9-168">**Fix** :  Upgrade to a supported cluster version that is higher than 5.6.204.9494, when it is available.</span></span> <span data-ttu-id="342a9-169">Si votre cluster est configuré pour se mettre à niveau automatiquement, le cluster se mettra automatiquement à niveau vers une version pour laquelle ce problème est résolu.</span><span class="sxs-lookup"><span data-stu-id="342a9-169">If your cluster is set to automatic upgrades, then the cluster will automatically upgrade to the version that has this issue fixed.</span></span>

  
## <a name="application-design"></a><span data-ttu-id="342a9-170">Conception des applications</span><span class="sxs-lookup"><span data-stu-id="342a9-170">Application Design</span></span>

### <a name="whats-the-best-way-to-query-data-across-partitions-of-a-reliable-collection"></a><span data-ttu-id="342a9-171">Quel est le meilleur moyen d’interroger des données sur plusieurs partitions d’une collection fiable ?</span><span class="sxs-lookup"><span data-stu-id="342a9-171">What's the best way to query data across partitions of a Reliable Collection?</span></span>

<span data-ttu-id="342a9-172">Les collections fiables sont généralement [partitionnées](service-fabric-concepts-partitioning.md) pour permettre l’extensibilité et augmenter les performances ainsi que le débit.</span><span class="sxs-lookup"><span data-stu-id="342a9-172">Reliable collections are typically [partitioned](service-fabric-concepts-partitioning.md) to enable scale out for greater performance and throughput.</span></span> <span data-ttu-id="342a9-173">Cela signifie que l’état d’un service peut être réparti entre des dizaines voire des centaines d’ordinateurs.</span><span class="sxs-lookup"><span data-stu-id="342a9-173">That means that the state for a given service may be spread across 10s or 100s of machines.</span></span> <span data-ttu-id="342a9-174">Pour effectuer des opérations sur ce jeu de données complet, plusieurs possibilités s’offrent à vous :</span><span class="sxs-lookup"><span data-stu-id="342a9-174">To perform operations over that full data set, you have a few options:</span></span>

- <span data-ttu-id="342a9-175">Créer un service qui interroge toutes les partitions d’un autre service pour extraire les données requises.</span><span class="sxs-lookup"><span data-stu-id="342a9-175">Create a service that queries all partitions of another service to pull in the required data.</span></span>
- <span data-ttu-id="342a9-176">Créer un service capable de recevoir des données provenant de toutes les partitions d’un autre service.</span><span class="sxs-lookup"><span data-stu-id="342a9-176">Create a service that can receive data from all partitions of another service.</span></span>
- <span data-ttu-id="342a9-177">Envoyer régulièrement des données de chaque service à un magasin externe.</span><span class="sxs-lookup"><span data-stu-id="342a9-177">Periodically push data from each service to an external store.</span></span> <span data-ttu-id="342a9-178">Cette approche ne convient que si les requêtes que vous exécutez ne font pas partie de votre logique d’entreprise.</span><span class="sxs-lookup"><span data-stu-id="342a9-178">This approach is only appropriate if the queries you're performing are not part of your core business logic.</span></span>


### <a name="whats-the-best-way-to-query-data-across-my-actors"></a><span data-ttu-id="342a9-179">Quel est le meilleur moyen d’interroger les données entre mes différents acteurs ?</span><span class="sxs-lookup"><span data-stu-id="342a9-179">What's the best way to query data across my actors?</span></span>

<span data-ttu-id="342a9-180">Les acteurs sont conçus comme des unités indépendantes d’état et de calcul. Il n’est pas recommandé d’effectuer des requêtes volumineuses sur l’état des acteurs pendant l’exécution.</span><span class="sxs-lookup"><span data-stu-id="342a9-180">Actors are designed to be independent units of state and compute, so it is not recommended to perform broad queries of actor state at runtime.</span></span> <span data-ttu-id="342a9-181">Si vous devez exécuter une requête sur l’ensemble des états d’acteur, vous devez envisager de :</span><span class="sxs-lookup"><span data-stu-id="342a9-181">If you have a need to query across the full set of actor state, you should consider either:</span></span>

- <span data-ttu-id="342a9-182">Remplacer vos services d’acteur par des services fiables avec état, comme le nombre de requêtes réseau, pour collecter toutes les données, depuis le nombre d’acteurs jusqu’au nombre de partitions de votre service.</span><span class="sxs-lookup"><span data-stu-id="342a9-182">Replacing your actor services with stateful reliable services, such that the number of network requests to gather all data from the number of actors to the number of partitions in your service.</span></span>
- <span data-ttu-id="342a9-183">Concevoir vos acteurs pour qu’ils envoient régulièrement leur état à un magasin externe afin de faciliter les requêtes.</span><span class="sxs-lookup"><span data-stu-id="342a9-183">Designing your actors to periodically push their state to an external store for easier querying.</span></span> <span data-ttu-id="342a9-184">Comme auparavant, cette approche n’est viable que si les requêtes que vous exécutez ne sont pas obligatoires pour votre comportement d’exécution.</span><span class="sxs-lookup"><span data-stu-id="342a9-184">As above, this approach is only viable if the queries you're performing are not required for your runtime behavior.</span></span>

### <a name="how-much-data-can-i-store-in-a-reliable-collection"></a><span data-ttu-id="342a9-185">Quelle quantité de données puis-je stocker dans une collection fiable ?</span><span class="sxs-lookup"><span data-stu-id="342a9-185">How much data can I store in a Reliable Collection?</span></span>

<span data-ttu-id="342a9-186">Les services fiables sont généralement partitionnés. La quantité que vous pouvez stocker n’est donc limitée que par le nombre d’ordinateurs dans votre cluster et par la quantité de mémoire disponible sur ces ordinateurs.</span><span class="sxs-lookup"><span data-stu-id="342a9-186">Reliable services are typically partitioned, so the amount you can store is only limited by the number of machines you have in the cluster, and the amount of memory available on those machines.</span></span>

<span data-ttu-id="342a9-187">Par exemple, supposons que vous ayez une collection fiable dans un service de 100 partitions et 3 réplicas, la taille moyenne des objets stockés est de 1 Ko.</span><span class="sxs-lookup"><span data-stu-id="342a9-187">As an example, suppose that you have a reliable collection in a service with 100 partitions and 3 replicas, storing objects that average 1kb in size.</span></span> <span data-ttu-id="342a9-188">Maintenant, supposons que vous disposiez d’un cluster de 10 ordinateurs avec 16 Go de mémoire par ordinateur.</span><span class="sxs-lookup"><span data-stu-id="342a9-188">Now suppose that you have a 10 machine cluster with 16gb of memory per machine.</span></span> <span data-ttu-id="342a9-189">Par souci de simplicité et pour être très prudent, supposons que le système d’exploitation, les services système, le runtime Service Fabric et vos services consomment 6 Go, ce qui laisse 10 Go disponibles par ordinateur soit 100 Go pour le cluster.</span><span class="sxs-lookup"><span data-stu-id="342a9-189">For simplicity and to be very conservative, assume that the operating system and system services, the Service Fabric runtime, and your services consume 6gb of that, leaving 10gb available per machine, or 100gb for the cluster.</span></span>

<span data-ttu-id="342a9-190">Sachant que chaque objet doit être stocké trois fois (une copie principale et deux réplicas), vous aurez suffisamment de mémoire pour environ 35 millions d’objets dans votre collection lorsqu’elle fonctionnera à pleine capacité.</span><span class="sxs-lookup"><span data-stu-id="342a9-190">Keeping in mind that each object must be stored three times (one primary and two replicas), you would have sufficient memory for approximately 35 million objects in your collection when operating at full capacity.</span></span> <span data-ttu-id="342a9-191">Toutefois, nous vous recommandons d’assurer une résilience à la perte simultanée d’un domaine de défaillance et d’un domaine de mise à niveau, ce qui représente environ 1/3 de la capacité et réduit le nombre à environ 23 millions.</span><span class="sxs-lookup"><span data-stu-id="342a9-191">However, we recommend being resilient to the simultaneous loss of a failure domain and an upgrade domain, which represents about 1/3 of capacity, and would reduce the number to roughly 23 million.</span></span>

<span data-ttu-id="342a9-192">Notez que ce calcul suppose également :</span><span class="sxs-lookup"><span data-stu-id="342a9-192">Note that this calculation also assumes:</span></span>

- <span data-ttu-id="342a9-193">Que la répartition des données entre les partitions est à peu près uniforme ou que vous envoyez des métriques de charge à Cluster Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="342a9-193">That the distribution of data across the partitions is roughly uniform or that you're reporting load metrics to the Cluster Resource Manager.</span></span> <span data-ttu-id="342a9-194">Par défaut, Service Fabric équilibre la charge en fonction du nombre de réplicas.</span><span class="sxs-lookup"><span data-stu-id="342a9-194">By default, Service Fabric will load balance based on replica count.</span></span> <span data-ttu-id="342a9-195">Dans notre exemple ci-dessus, cela placerait 10 réplicas principaux et 20 réplicas secondaires sur chaque nœud du cluster.</span><span class="sxs-lookup"><span data-stu-id="342a9-195">In our example above, that would put 10 primary replicas and 20 secondary replicas on each node in the cluster.</span></span> <span data-ttu-id="342a9-196">Cela fonctionne bien pour la charge répartie équitablement entre les partitions.</span><span class="sxs-lookup"><span data-stu-id="342a9-196">That works well for load that is evenly distributed across the partitions.</span></span> <span data-ttu-id="342a9-197">Si la charge n’est pas équilibrée, vous devez la signaler afin que le Resource Manager puisse regrouper des réplicas plus petits et autoriser des réplicas plus volumineux à consommer davantage de mémoire sur un nœud individuel.</span><span class="sxs-lookup"><span data-stu-id="342a9-197">If load is not even, you must report load so that the Resource Manager can pack smaller replicas together and allow larger replicas to consume more memory on an individual node.</span></span>

- <span data-ttu-id="342a9-198">Que le service fiable en question est le seul à stocker l’état dans le cluster.</span><span class="sxs-lookup"><span data-stu-id="342a9-198">That the reliable service in question is the only one storing state in the cluster.</span></span> <span data-ttu-id="342a9-199">Comme vous pouvez déployer plusieurs services dans un cluster, vous devez être conscient que les ressources de chacun devront exécuter et gérer son état.</span><span class="sxs-lookup"><span data-stu-id="342a9-199">Since you can deploy multiple services to a cluster, you need to be mindful of the resources that each will need to run and manage its state.</span></span>

- <span data-ttu-id="342a9-200">Que le cluster lui-même pas n’augmente pas ou ne diminue pas en taille.</span><span class="sxs-lookup"><span data-stu-id="342a9-200">That the cluster itself is not growing or shrinking.</span></span> <span data-ttu-id="342a9-201">Si vous ajoutez d’autres ordinateurs, Service Fabric rééquilibre vos réplicas en fonction des capacités supplémentaires jusqu’à ce que le nombre d’ordinateurs dépasse le nombre de partitions dans votre service, car un réplica ne peut pas englober plusieurs ordinateurs.</span><span class="sxs-lookup"><span data-stu-id="342a9-201">If you add more machines, Service Fabric will rebalance your replicas to leverage the additional capacity until the number of machines surpasses the number of partitions in your service, since an individual replica cannot span machines.</span></span> <span data-ttu-id="342a9-202">En revanche, si vous réduisez la taille du cluster en supprimant des ordinateurs, vos réplicas seront davantage compressés et auront une capacité moindre.</span><span class="sxs-lookup"><span data-stu-id="342a9-202">By contrast, if you reduce the size of the cluster by removing machines, your replicas will be packed more tightly and have less overall capacity.</span></span>

### <a name="how-much-data-can-i-store-in-an-actor"></a><span data-ttu-id="342a9-203">Quelle quantité de données puis-je stocker dans un acteur ?</span><span class="sxs-lookup"><span data-stu-id="342a9-203">How much data can I store in an actor?</span></span>

<span data-ttu-id="342a9-204">Comme avec les services fiables, la quantité de données que vous pouvez stocker dans un service d’acteur n’est limitée que par l’espace disque total et la mémoire disponible sur les nœuds de votre cluster.</span><span class="sxs-lookup"><span data-stu-id="342a9-204">As with reliable services, the amount of data that you can store in an actor service is only limited by the total disk space and memory available across the nodes in your cluster.</span></span> <span data-ttu-id="342a9-205">Toutefois, les acteurs sont plus efficaces lorsqu’ils sont utilisés pour encapsuler une petite quantité d’état et de logique métier associée.</span><span class="sxs-lookup"><span data-stu-id="342a9-205">However, individual actors are most effective when they are used to encapsulate a small amount of state and associated business logic.</span></span> <span data-ttu-id="342a9-206">En règle générale, un acteur doit avoir l’état qui est mesuré en kilo-octets.</span><span class="sxs-lookup"><span data-stu-id="342a9-206">As a general rule, an individual actor should have state that is measured in kilobytes.</span></span>

## <a name="other-questions"></a><span data-ttu-id="342a9-207">Autres questions</span><span class="sxs-lookup"><span data-stu-id="342a9-207">Other questions</span></span>

### <a name="how-does-service-fabric-relate-to-containers"></a><span data-ttu-id="342a9-208">Quel est le rapport entre Service Fabric et les conteneurs ?</span><span class="sxs-lookup"><span data-stu-id="342a9-208">How does Service Fabric relate to containers?</span></span>

<span data-ttu-id="342a9-209">Les conteneurs constituent un moyen simple d’encapsuler les services et leurs dépendances pour qu’ils s’exécutent de manière cohérente dans tous les environnements et puissent fonctionner de manière isolée sur un seul ordinateur.</span><span class="sxs-lookup"><span data-stu-id="342a9-209">Containers offer a simple way to package services and their dependencies such that they run consistently in all environments and can operate in an isolated fashion on a single machine.</span></span> <span data-ttu-id="342a9-210">Service Fabric vous permet de déployer et gérer des services, notamment des [services encapsulés dans un conteneur](service-fabric-containers-overview.md).</span><span class="sxs-lookup"><span data-stu-id="342a9-210">Service Fabric offers a way to deploy and manage services, including [services that have been packaged in a container](service-fabric-containers-overview.md).</span></span>

### <a name="are-you-planning-to-open-source-service-fabric"></a><span data-ttu-id="342a9-211">Prévoyez-vous de diffuser le code de Service Fabric ?</span><span class="sxs-lookup"><span data-stu-id="342a9-211">Are you planning to open source Service Fabric?</span></span>

<span data-ttu-id="342a9-212">Nous avons l’intention de diffuser le code des infrastructures Reliable Services et Reliable Actors sur GitHub et d’accepter les contributions de la communauté à ces projets.</span><span class="sxs-lookup"><span data-stu-id="342a9-212">We intend to open source the reliable services and reliable actors frameworks on GitHub and will accept community contributions to those projects.</span></span> <span data-ttu-id="342a9-213">Consultez le [blog Service Fabric](https://blogs.msdn.microsoft.com/azureservicefabric/) pour en savoir plus.</span><span class="sxs-lookup"><span data-stu-id="342a9-213">Please follow the [Service Fabric blog](https://blogs.msdn.microsoft.com/azureservicefabric/) for more details as they're announced.</span></span>

<span data-ttu-id="342a9-214">Pour l’instant, il n’est pas prévu de diffuser le code du runtime Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="342a9-214">The are currently no plans to open source the Service Fabric runtime.</span></span>

## <a name="next-steps"></a><span data-ttu-id="342a9-215">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="342a9-215">Next steps</span></span>

- [<span data-ttu-id="342a9-216">En savoir plus sur les principaux concepts et les meilleures pratiques de Service Fabric</span><span class="sxs-lookup"><span data-stu-id="342a9-216">Learn about core Service Fabric concepts and best practices</span></span>](https://mva.microsoft.com/en-us/training-courses/building-microservices-applications-on-azure-service-fabric-16747?l=tbuZM46yC_5206218965)
