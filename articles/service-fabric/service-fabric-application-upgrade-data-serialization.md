---
title: "Mise à niveau d’une application : sérialisation des données | Microsoft Docs"
description: "Meilleures pratiques pour la sérialisation de données et son impact sur le déploiement des mises à niveau d'applications."
services: service-fabric
documentationcenter: .net
author: vturecek
manager: timlt
editor: 
ms.assetid: a5f36366-a2ab-4ae3-bb08-bc2f9533bc5a
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 06/29/2017
ms.author: vturecek
ms.openlocfilehash: 1b65dfd3813423550631490640a81953864f58e3
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="how-data-serialization-affects-an-application-upgrade"></a><span data-ttu-id="dc08f-103">Impact de la sérialisation des données sur la mise à niveau d’une application</span><span class="sxs-lookup"><span data-stu-id="dc08f-103">How data serialization affects an application upgrade</span></span>
<span data-ttu-id="dc08f-104">Dans un [application mise à niveau propagée](service-fabric-application-upgrade.md), mise à niveau hello est appliqué tooa sous-ensemble de nœuds, un seul domaine de mise à niveau à la fois.</span><span class="sxs-lookup"><span data-stu-id="dc08f-104">In a [rolling application upgrade](service-fabric-application-upgrade.md), hello upgrade is applied tooa subset of nodes, one upgrade domain at a time.</span></span> <span data-ttu-id="dc08f-105">Pendant ce processus, certains domaines de mise à niveau se trouvent sur une version plus récente de hello de votre application, et certains domaines de mise à niveau sont hello ancienne version de votre application.</span><span class="sxs-lookup"><span data-stu-id="dc08f-105">During this process, some upgrade domains are on hello newer version of your application, and some upgrade domains are on hello older version of your application.</span></span> <span data-ttu-id="dc08f-106">Lors du déploiement hello, hello nouvelle version de votre application doit être en mesure de tooread hello ancienne version de vos données et hello ancienne version de votre application doit être en mesure de tooread hello nouvelle version de vos données.</span><span class="sxs-lookup"><span data-stu-id="dc08f-106">During hello rollout, hello new version of your application must be able tooread hello old version of your data, and hello old version of your application must be able tooread hello new version of your data.</span></span> <span data-ttu-id="dc08f-107">Si le format de données hello n’est pas mise à niveau vers l’avant et vers l’arrière compatible, hello peuvent échouer ou pire, de données peut être perdue ou corrompue.</span><span class="sxs-lookup"><span data-stu-id="dc08f-107">If hello data format is not forward and backward compatible, hello upgrade may fail, or worse, data may be lost or corrupted.</span></span> <span data-ttu-id="dc08f-108">Cet article explique ce qui constitue le format de données et détaille les méthodes recommandées pour que les données offrent une compatibilité ascendante et descendante.</span><span class="sxs-lookup"><span data-stu-id="dc08f-108">This article discusses what constitutes your data format and offers best practices for ensuring that your data is forward and backward compatible.</span></span>

## <a name="what-makes-up-your-data-format"></a><span data-ttu-id="dc08f-109">Qu'est-ce qui constitue le format de données ?</span><span class="sxs-lookup"><span data-stu-id="dc08f-109">What makes up your data format?</span></span>
<span data-ttu-id="dc08f-110">Dans Azure Service Fabric, les données hello sont persistant et répliquées provient de vos classes c#.</span><span class="sxs-lookup"><span data-stu-id="dc08f-110">In Azure Service Fabric, hello data that is persisted and replicated comes from your C# classes.</span></span> <span data-ttu-id="dc08f-111">Pour les applications qui utilisent [Collections fiable](service-fabric-reliable-services-reliable-collections.md), que les données sont des objets de hello dans les files d’attente et les dictionnaires fiable hello.</span><span class="sxs-lookup"><span data-stu-id="dc08f-111">For applications that use [Reliable Collections](service-fabric-reliable-services-reliable-collections.md), that data is hello objects in hello reliable dictionaries and queues.</span></span> <span data-ttu-id="dc08f-112">Pour les applications qui utilisent [Reliable Actors](service-fabric-reliable-actors-introduction.md), c'est-à-dire les hello sauvegarde l’état d’acteur de hello.</span><span class="sxs-lookup"><span data-stu-id="dc08f-112">For applications that use [Reliable Actors](service-fabric-reliable-actors-introduction.md), that is hello backing state for hello actor.</span></span> <span data-ttu-id="dc08f-113">Ces classes c# doivent être sérialisables toobe persistant et répliqué.</span><span class="sxs-lookup"><span data-stu-id="dc08f-113">These C# classes must be serializable toobe persisted and replicated.</span></span> <span data-ttu-id="dc08f-114">Par conséquent, format de données hello est défini par les champs de hello et les propriétés qui sont sérialisées, ainsi que la manière dont elles sont sérialisées.</span><span class="sxs-lookup"><span data-stu-id="dc08f-114">Therefore, hello data format is defined by hello fields and properties that are serialized, as well as how they are serialized.</span></span> <span data-ttu-id="dc08f-115">Par exemple, dans un `IReliableDictionary<int, MyClass>` les données de salutation sont sérialisée `int` et sérialisée `MyClass`.</span><span class="sxs-lookup"><span data-stu-id="dc08f-115">For example, in an `IReliableDictionary<int, MyClass>` hello data is a serialized `int` and a serialized `MyClass`.</span></span>

### <a name="code-changes-that-result-in-a-data-format-change"></a><span data-ttu-id="dc08f-116">Modifications du code résultant dans une modification du format de données</span><span class="sxs-lookup"><span data-stu-id="dc08f-116">Code changes that result in a data format change</span></span>
<span data-ttu-id="dc08f-117">Format de données hello est déterminée par les classes c#, classes toohello de modifications peuvent entraîner une modification de format de données.</span><span class="sxs-lookup"><span data-stu-id="dc08f-117">Since hello data format is determined by C# classes, changes toohello classes may cause a data format change.</span></span> <span data-ttu-id="dc08f-118">Soyez prudent tooensure une mise à niveau propagée peut gérer les données de salutation du format.</span><span class="sxs-lookup"><span data-stu-id="dc08f-118">Care must be taken tooensure that a rolling upgrade can handle hello data format change.</span></span> <span data-ttu-id="dc08f-119">Exemples d'opérations pouvant entraîner une modification du format de données :</span><span class="sxs-lookup"><span data-stu-id="dc08f-119">Examples that may cause data format changes:</span></span>

* <span data-ttu-id="dc08f-120">Ajout ou suppression de champs ou de propriétés</span><span class="sxs-lookup"><span data-stu-id="dc08f-120">Adding or removing fields or properties</span></span>
* <span data-ttu-id="dc08f-121">Modification du nom d'un champ ou d'une propriété</span><span class="sxs-lookup"><span data-stu-id="dc08f-121">Renaming fields or properties</span></span>
* <span data-ttu-id="dc08f-122">Modification des types de champs ou propriétés hello</span><span class="sxs-lookup"><span data-stu-id="dc08f-122">Changing hello types of fields or properties</span></span>
* <span data-ttu-id="dc08f-123">Modification du nom de classe hello ou espace de noms</span><span class="sxs-lookup"><span data-stu-id="dc08f-123">Changing hello class name or namespace</span></span>

### <a name="data-contract-as-hello-default-serializer"></a><span data-ttu-id="dc08f-124">Contrat de données comme hello sérialiseur par défaut</span><span class="sxs-lookup"><span data-stu-id="dc08f-124">Data Contract as hello default serializer</span></span>
<span data-ttu-id="dc08f-125">sérialiseur de Hello est généralement responsable de la lecture des données de hello, qui la désérialise dans la version actuelle de hello, même si les données de salutation sont dans une version antérieure ou *plus récente* version.</span><span class="sxs-lookup"><span data-stu-id="dc08f-125">hello serializer is generally responsible for reading hello data and deserializing it into hello current version, even if hello data is in an older or *newer* version.</span></span> <span data-ttu-id="dc08f-126">Hello sérialiseur par défaut est hello [sérialiseur de contrat de données](https://msdn.microsoft.com/library/ms733127.aspx), qui a des règles de versioning bien défini.</span><span class="sxs-lookup"><span data-stu-id="dc08f-126">hello default serializer is hello [Data Contract serializer](https://msdn.microsoft.com/library/ms733127.aspx), which has well-defined versioning rules.</span></span> <span data-ttu-id="dc08f-127">Fiable les Collections permettent toobe de sérialiseur hello remplacée, mais Reliable Actors actuellement pas.</span><span class="sxs-lookup"><span data-stu-id="dc08f-127">Reliable Collections allow hello serializer toobe overridden, but Reliable Actors currently do not.</span></span> <span data-ttu-id="dc08f-128">sérialiseur de données Hello joue un rôle important dans l’activation des mises à niveau propagées.</span><span class="sxs-lookup"><span data-stu-id="dc08f-128">hello data serializer plays an important role in enabling rolling upgrades.</span></span> <span data-ttu-id="dc08f-129">sérialiseur de contrat de données Hello est sérialiseur hello que nous recommandons pour les applications de Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="dc08f-129">hello Data Contract serializer is hello serializer that we recommend for Service Fabric applications.</span></span>

## <a name="how-hello-data-format-affects-a-rolling-upgrade"></a><span data-ttu-id="dc08f-130">Comment le format de données hello affecte une mise à niveau propagée</span><span class="sxs-lookup"><span data-stu-id="dc08f-130">How hello data format affects a rolling upgrade</span></span>
<span data-ttu-id="dc08f-131">Pendant une mise à niveau propagée, il existe deux principaux scénarios où le sérialiseur de hello peut rencontrer une ancienne ou *plus récente* version de vos données :</span><span class="sxs-lookup"><span data-stu-id="dc08f-131">During a rolling upgrade, there are two main scenarios where hello serializer may encounter an older or *newer* version of your data:</span></span>

1. <span data-ttu-id="dc08f-132">Une fois un nœud est mis à niveau et démarre sauvegarder, sérialiseur de nouveau hello chargera les données de hello qui a été toodisk persistant par une ancienne version de hello.</span><span class="sxs-lookup"><span data-stu-id="dc08f-132">After a node is upgraded and starts back up, hello new serializer will load hello data that was persisted toodisk by hello old version.</span></span>
2. <span data-ttu-id="dc08f-133">Au cours de la mise à niveau propagée de hello, cluster de hello contient un mélange de versions anciennes et nouvelles de hello de votre code.</span><span class="sxs-lookup"><span data-stu-id="dc08f-133">During hello rolling upgrade, hello cluster will contain a mix of hello old and new versions of your code.</span></span> <span data-ttu-id="dc08f-134">Étant donné que les réplicas peuvent être placés dans différents domaines de mise à niveau et réplicas envoient des données tooeach autres, hello nouveau ou ancien version de vos données peut-être être rencontrée par version de nouveau ou ancien hello de votre sérialiseur.</span><span class="sxs-lookup"><span data-stu-id="dc08f-134">Since replicas may be placed in different upgrade domains, and replicas send data tooeach other, hello new and/or old version of your data may be encountered by hello new and/or old version of your serializer.</span></span>

> [!NOTE]
> <span data-ttu-id="dc08f-135">Hello « nouvelle version » et « version ancienne » ici font référence version toohello de votre code qui est en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="dc08f-135">hello "new version" and "old version" here refer toohello version of your code that is running.</span></span> <span data-ttu-id="dc08f-136">Hello « nouveau sérialiseur » fait référence à code de sérialiseur toohello qui s’exécute dans la nouvelle version de hello de votre application.</span><span class="sxs-lookup"><span data-stu-id="dc08f-136">hello "new serializer" refers toohello serializer code that is executing in hello new version of your application.</span></span> <span data-ttu-id="dc08f-137">Hello « de nouvelles données » fait référence classe c# toohello sérialisé de hello nouvelle version de votre application.</span><span class="sxs-lookup"><span data-stu-id="dc08f-137">hello "new data" refers toohello serialized C# class from hello new version of your application.</span></span>
> 
> 

<span data-ttu-id="dc08f-138">Hello deux versions du code et de format de données doit être vers l’avant et vers l’arrière compatible.</span><span class="sxs-lookup"><span data-stu-id="dc08f-138">hello two versions of code and data format must be both forward and backward compatible.</span></span> <span data-ttu-id="dc08f-139">Si elles ne sont pas compatibles, hello mise à niveau propagée peut échouer ou les données peuvent être perdues.</span><span class="sxs-lookup"><span data-stu-id="dc08f-139">If they are not compatible, hello rolling upgrade may fail or data may be lost.</span></span> <span data-ttu-id="dc08f-140">Hello mise à niveau propagée peut échouer, car le code de hello ou un sérialiseur peut-être lever des exceptions ou une erreur quand il rencontre hello autre version.</span><span class="sxs-lookup"><span data-stu-id="dc08f-140">hello rolling upgrade may fail because hello code or serializer may throw exceptions or a fault when it encounters hello other version.</span></span> <span data-ttu-id="dc08f-141">Données peuvent être perdues si, par exemple, une nouvelle propriété a été ajoutée mais sérialiseur ancien de hello ignore pendant la désérialisation.</span><span class="sxs-lookup"><span data-stu-id="dc08f-141">Data may be lost if, for example, a new property was added but hello old serializer discards it during deserialization.</span></span>

<span data-ttu-id="dc08f-142">Contrat de données est hello solution afin de garantir que vos données sont compatibles recommandée.</span><span class="sxs-lookup"><span data-stu-id="dc08f-142">Data Contract is hello recommended solution for ensuring that your data is compatible.</span></span> <span data-ttu-id="dc08f-143">Il possède des règles de gestion de version bien définies pour l'ajout, la suppression et la modification de champs.</span><span class="sxs-lookup"><span data-stu-id="dc08f-143">It has well-defined versioning rules for adding, removing, and changing fields.</span></span> <span data-ttu-id="dc08f-144">Il est également prise en charge de traitement avec des champs inconnus, se connecter à un processus de sérialisation et désérialisation hello et de gestion d’héritage de classe.</span><span class="sxs-lookup"><span data-stu-id="dc08f-144">It also has support for dealing with unknown fields, hooking into hello serialization and deserialization process, and dealing with class inheritance.</span></span> <span data-ttu-id="dc08f-145">Pour plus d'informations, consultez la page [Utilisation du contrat de données](https://msdn.microsoft.com/library/ms733127.aspx).</span><span class="sxs-lookup"><span data-stu-id="dc08f-145">For more information, see [Using Data Contract](https://msdn.microsoft.com/library/ms733127.aspx).</span></span>

## <a name="next-steps"></a><span data-ttu-id="dc08f-146">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="dc08f-146">Next steps</span></span>
<span data-ttu-id="dc08f-147">[mise à niveau de votre application à l’aide de Visual Studio](service-fabric-application-upgrade-tutorial.md) vous guide à travers une mise à niveau de l’application à l’aide de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="dc08f-147">[Upgrading your Application Using Visual Studio](service-fabric-application-upgrade-tutorial.md) walks you through an application upgrade using Visual Studio.</span></span>

<span data-ttu-id="dc08f-148">[mise à niveau de votre application à l’aide de PowerShell](service-fabric-application-upgrade-tutorial-powershell.md) vous guide à travers une mise à niveau de l’application à l’aide de PowerShell.</span><span class="sxs-lookup"><span data-stu-id="dc08f-148">[Upgrading your Application Using Powershell](service-fabric-application-upgrade-tutorial-powershell.md) walks you through an application upgrade using PowerShell.</span></span>

<span data-ttu-id="dc08f-149">Contrôlez les mises à niveau de votre application à l'aide des [Paramètres de mise à niveau](service-fabric-application-upgrade-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="dc08f-149">Control how your application upgrades by using [Upgrade Parameters](service-fabric-application-upgrade-parameters.md).</span></span>

<span data-ttu-id="dc08f-150">Découvrez comment toouse des fonctionnalités avancées lors de la mise à niveau de votre application en vous reportant trop[rubriques avancées](service-fabric-application-upgrade-advanced.md).</span><span class="sxs-lookup"><span data-stu-id="dc08f-150">Learn how toouse advanced functionality while upgrading your application by referring too[Advanced Topics](service-fabric-application-upgrade-advanced.md).</span></span>

<span data-ttu-id="dc08f-151">Résoudre les problèmes courants dans les mises à niveau de l’application en faisant référence à des étapes de toohello de [résolution des problèmes de mises à niveau Application ](service-fabric-application-upgrade-troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="dc08f-151">Fix common problems in application upgrades by referring toohello steps in [Troubleshooting Application Upgrades ](service-fabric-application-upgrade-troubleshooting.md).</span></span>

