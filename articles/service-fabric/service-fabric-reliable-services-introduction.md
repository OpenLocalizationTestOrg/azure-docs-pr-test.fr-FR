---
title: "Présentation du modèle de programmation Reliable Services de Service Fabric | Microsoft Docs"
description: "Apprenez-en plus sur le modèle de programmation Service fiable de Service Fabric et commencez à écrire vos propres services."
services: Service-Fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: vturecek; mani-ramaswamy
ms.assetid: 0c88a533-73f8-4ae1-a939-67d17456ac06
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 8/9/2017
ms.author: masnider;
ms.openlocfilehash: 601b1c7713c9785d949c1c72000ec7f3f63dd682
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/18/2017
---
# <a name="reliable-services-overview"></a><span data-ttu-id="5efa0-103">Présentation de Reliable Services</span><span class="sxs-lookup"><span data-stu-id="5efa0-103">Reliable Services overview</span></span>
<span data-ttu-id="5efa0-104">Azure Service Fabric simplifie l’écriture et la gestion de Reliable Services avec et sans état.</span><span class="sxs-lookup"><span data-stu-id="5efa0-104">Azure Service Fabric simplifies writing and managing stateless and stateful Reliable Services.</span></span> <span data-ttu-id="5efa0-105">Cette rubrique couvre :</span><span class="sxs-lookup"><span data-stu-id="5efa0-105">This topic covers:</span></span>

* <span data-ttu-id="5efa0-106">Le modèle de programmation Reliable Services pour les services avec et sans état.</span><span class="sxs-lookup"><span data-stu-id="5efa0-106">The Reliable Services programming model for stateless and stateful services.</span></span>
* <span data-ttu-id="5efa0-107">Les choix que vous devez faire lors de l’écriture d’un modèle Reliable Services.</span><span class="sxs-lookup"><span data-stu-id="5efa0-107">The choices you have to make when writing a Reliable Service.</span></span>
* <span data-ttu-id="5efa0-108">Des scénarios et exemples d’utilisation du modèle Reliable Services et de son mode d’écriture.</span><span class="sxs-lookup"><span data-stu-id="5efa0-108">Some scenarios and examples of when to use Reliable Services and how they are written.</span></span>

<span data-ttu-id="5efa0-109">Les Services fiables sont l'un des modèles de programmation disponibles sous Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="5efa0-109">Reliable Services is one of the programming models available on Service Fabric.</span></span> <span data-ttu-id="5efa0-110">L’autre est le modèle de programmation Reliable Actor, qui fournit un modèle de programmation Actor virtuel sur le modèle Reliable Services.</span><span class="sxs-lookup"><span data-stu-id="5efa0-110">The other is the Reliable Actor programming model, which provides a virtual Actor programming model on top of the Reliable Services model.</span></span> <span data-ttu-id="5efa0-111">Pour plus d’informations sur le modèle de programmation Reliable Actors, consultez l’article [Présentation du modèle Reliable Actors de Service Fabric](service-fabric-reliable-actors-introduction.md).</span><span class="sxs-lookup"><span data-stu-id="5efa0-111">For more information on the Reliable Actors programming model, see [Introduction to Service Fabric Reliable Actors](service-fabric-reliable-actors-introduction.md).</span></span>

<span data-ttu-id="5efa0-112">Service Fabric gère la durée de vie des services, depuis l’approvisionnement et le déploiement jusqu’à la mise à niveau et la suppression au moyen de la [gestion des applications Service Fabric](service-fabric-deploy-remove-applications.md).</span><span class="sxs-lookup"><span data-stu-id="5efa0-112">Service Fabric manages the lifetime of services, from provisioning and deployment through upgrade and deletion, via [Service Fabric application management](service-fabric-deploy-remove-applications.md).</span></span>

## <a name="what-are-reliable-services"></a><span data-ttu-id="5efa0-113">Définition de Reliable Services</span><span class="sxs-lookup"><span data-stu-id="5efa0-113">What are Reliable Services?</span></span>
<span data-ttu-id="5efa0-114">Reliable Services vous offre un modèle de programmation global, simple et puissant qui vous aidera à faire ressortir ce qui est important dans votre application.</span><span class="sxs-lookup"><span data-stu-id="5efa0-114">Reliable Services gives you a simple, powerful, top-level programming model to help you express what is important to your application.</span></span> <span data-ttu-id="5efa0-115">Avec le modèle de programmation Reliable Services, vous obtenez :</span><span class="sxs-lookup"><span data-stu-id="5efa0-115">With the Reliable Services programming model, you get:</span></span>

* <span data-ttu-id="5efa0-116">Accès au reste des API de programmation de Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="5efa0-116">Access to the rest of the Service Fabric programming APIs.</span></span> <span data-ttu-id="5efa0-117">Contrairement aux services Service Fabric modélisés en tant [qu’invités exécutables](service-fabric-deploy-existing-app.md), Reliable Services peut utiliser directement les autres API de Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="5efa0-117">Unlike Service Fabric Services modeled as [Guest Executables](service-fabric-deploy-existing-app.md), Reliable Services get to use the rest of the Service Fabric APIs directly.</span></span> <span data-ttu-id="5efa0-118">Les services peuvent ainsi :</span><span class="sxs-lookup"><span data-stu-id="5efa0-118">This allows services to:</span></span>
  * <span data-ttu-id="5efa0-119">interroger le système</span><span class="sxs-lookup"><span data-stu-id="5efa0-119">query the system</span></span>
  * <span data-ttu-id="5efa0-120">créer des rapports sur l’intégrité des entités dans le cluster</span><span class="sxs-lookup"><span data-stu-id="5efa0-120">report health about entities in the cluster</span></span>
  * <span data-ttu-id="5efa0-121">recevoir des notifications sur les modifications de la configuration et du code</span><span class="sxs-lookup"><span data-stu-id="5efa0-121">receive notifications about configuration and code changes</span></span>
  * <span data-ttu-id="5efa0-122">rechercher et communiquer avec d’autres services</span><span class="sxs-lookup"><span data-stu-id="5efa0-122">find and communicate with other services,</span></span>
  * <span data-ttu-id="5efa0-123">(facultatif) utiliser les [Collections fiables](service-fabric-reliable-services-reliable-collections.md)</span><span class="sxs-lookup"><span data-stu-id="5efa0-123">(optionally) use the [Reliable Collections](service-fabric-reliable-services-reliable-collections.md)</span></span>
  * <span data-ttu-id="5efa0-124">...et accéder à de nombreuses autres fonctionnalités, toutes issues d’un modèle de programmation de première classe dans plusieurs langages de programmation.</span><span class="sxs-lookup"><span data-stu-id="5efa0-124">...and giving them access to many other capabilities, all from a first class programming model in several programming languages.</span></span>
* <span data-ttu-id="5efa0-125">Un modèle simple pour exécuter votre propre code qui ressemble aux modèles de programmation auxquels vous êtes habitué.</span><span class="sxs-lookup"><span data-stu-id="5efa0-125">A simple model for running your own code that looks like programming models you are used to.</span></span> <span data-ttu-id="5efa0-126">Votre code comporte un point d’entrée bien défini, et son cycle de vie est facile à gérer.</span><span class="sxs-lookup"><span data-stu-id="5efa0-126">Your code has a well-defined entry point and easily managed lifecycle.</span></span>
* <span data-ttu-id="5efa0-127">Un modèle de communication enfichable.</span><span class="sxs-lookup"><span data-stu-id="5efa0-127">A pluggable communication model.</span></span> <span data-ttu-id="5efa0-128">Utilisez le transport de votre choix, comme HTTP avec [l’API Web](service-fabric-reliable-services-communication-webapi.md), WebSockets, des protocoles TCP personnalisés, etc.</span><span class="sxs-lookup"><span data-stu-id="5efa0-128">Use the transport of your choice, such as HTTP with [Web API](service-fabric-reliable-services-communication-webapi.md), WebSockets, custom TCP protocols, or anything else.</span></span> <span data-ttu-id="5efa0-129">Le modèle Reliable Services fournit de remarquables options prêtes à l’emploi que vous pouvez utiliser. Vous pouvez également définir les vôtres.</span><span class="sxs-lookup"><span data-stu-id="5efa0-129">Reliable Services provide some great out-of-the-box options you can use, or you can provide your own.</span></span>
* <span data-ttu-id="5efa0-130">Pour les services avec état, le modèle de programmation Reliable Services vous permet de stocker de manière cohérente et fiable votre droit d’état dans votre service à l’aide des [Collections fiables](service-fabric-reliable-services-reliable-collections.md).</span><span class="sxs-lookup"><span data-stu-id="5efa0-130">For stateful services, the Reliable Services programming model allows you to consistently and reliably store your state right inside your service by using [Reliable Collections](service-fabric-reliable-services-reliable-collections.md).</span></span> <span data-ttu-id="5efa0-131">Les Collections fiables sont un ensemble simple de classes de collection hautement disponibles et fiables, qui sera familier à tous ceux qui ont utilisé les collections C#.</span><span class="sxs-lookup"><span data-stu-id="5efa0-131">Reliable Collections are a simple set of highly available and reliable collection classes that will be familiar to anyone who has used C# collections.</span></span> <span data-ttu-id="5efa0-132">Traditionnellement, les services nécessitaient des systèmes externes pour la gestion d’état fiable.</span><span class="sxs-lookup"><span data-stu-id="5efa0-132">Traditionally, services needed external systems for Reliable state management.</span></span> <span data-ttu-id="5efa0-133">Avec les Collections fiables, vous pouvez stocker l’état à proximité du calcul avec la disponibilité élevée et la fiabilité que vous attendez de la part de magasins externes hautement disponibles.</span><span class="sxs-lookup"><span data-stu-id="5efa0-133">With Reliable Collections, you can store your state next to your compute with the same high availability and reliability you've come to expect from highly available external stores.</span></span> <span data-ttu-id="5efa0-134">De plus, ce modèle permet d’améliorer la latence, car vous effectuez la colocalisation du calcul et de l’état dont il a besoin pour fonctionner.</span><span class="sxs-lookup"><span data-stu-id="5efa0-134">This model also improves latency because you are co-locating the compute and state it needs to function.</span></span>

<span data-ttu-id="5efa0-135">Regardez cette vidéo Microsoft Virtual Academy pour une vue d’ensemble de Reliable Services : <center>
<a target="_blank" href="https://mva.microsoft.com/en-US/training-courses/building-microservices-applications-on-azure-service-fabric-16747?l=HhD9566yC_4106218965">
<img src="./media/service-fabric-reliable-services-introduction/ReliableServicesVid.png" WIDTH="360" HEIGHT="244" />
</a>
</center></span><span class="sxs-lookup"><span data-stu-id="5efa0-135">Watch this Microsoft Virtual Academy video for an overview of Reliable services: <center>
<a target="_blank" href="https://mva.microsoft.com/en-US/training-courses/building-microservices-applications-on-azure-service-fabric-16747?l=HhD9566yC_4106218965">
<img src="./media/service-fabric-reliable-services-introduction/ReliableServicesVid.png" WIDTH="360" HEIGHT="244" />
</a>
</center></span></span>

## <a name="what-makes-reliable-services-different"></a><span data-ttu-id="5efa0-136">En quoi le modèle Reliable Services est-il différent ?</span><span class="sxs-lookup"><span data-stu-id="5efa0-136">What makes Reliable Services different?</span></span>
<span data-ttu-id="5efa0-137">Les Services fiables dans Service Fabric sont différents des services que vous avez peut-être écrits auparavant.</span><span class="sxs-lookup"><span data-stu-id="5efa0-137">Reliable Services in Service Fabric are different from services you may have written before.</span></span> <span data-ttu-id="5efa0-138">Service Fabric fournit la fiabilité, la disponibilité, la cohérence et l'évolutivité.</span><span class="sxs-lookup"><span data-stu-id="5efa0-138">Service Fabric provides reliability, availability, consistency, and scalability.</span></span>

* <span data-ttu-id="5efa0-139">**Fiabilité** : votre service reste opérationnel même dans des environnements non fiables où vos machines sont confrontées à des pannes ou des problèmes réseau, ou dans le cas où les services eux-mêmes rencontrent des erreurs et subissent un incident ou une panne.</span><span class="sxs-lookup"><span data-stu-id="5efa0-139">**Reliability** - Your service stays up even in unreliable environments where your machines fail or hit network issues, or in cases where the services themselves encounter errors and crash or fail.</span></span> <span data-ttu-id="5efa0-140">Pour les services avec état, l’état est conservé même en cas de panne du réseau ou d’autres incidents.</span><span class="sxs-lookup"><span data-stu-id="5efa0-140">For stateful services, your state is preserved even in the presence of network or other failures.</span></span>
* <span data-ttu-id="5efa0-141">**Disponibilité** : votre service est accessible et réactif.</span><span class="sxs-lookup"><span data-stu-id="5efa0-141">**Availability** - Your service is reachable and responsive.</span></span> <span data-ttu-id="5efa0-142">Service Fabric gère le nombre souhaité de copies en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="5efa0-142">Service Fabric maintains your desired number of running copies.</span></span>
* <span data-ttu-id="5efa0-143">**Évolutivité** : les services sont dissociés du matériel spécifique, et peuvent croître ou diminuer en fonction des besoins au moyen de l’ajout ou de la suppression de matériel ou d’autres ressources.</span><span class="sxs-lookup"><span data-stu-id="5efa0-143">**Scalability** - Services are decoupled from specific hardware, and they can grow or shrink as necessary through the addition or removal of hardware or other resources.</span></span> <span data-ttu-id="5efa0-144">Les services peuvent être facilement partitionnés (surtout dans le cas des services avec état) pour s’assurer que le service peut s’adapter et répondre aux défaillances partielles.</span><span class="sxs-lookup"><span data-stu-id="5efa0-144">Services are easily partitioned (especially in the stateful case) to ensure that the service can scale and handle partial failures.</span></span> <span data-ttu-id="5efa0-145">Les services peuvent être créés et supprimés de manière dynamique à l’aide du code, ce qui permet de lancer autant d’instances que nécessaire, par exemple en réponse aux demandes des clients.</span><span class="sxs-lookup"><span data-stu-id="5efa0-145">Services can be created and deleted dynamically via code, enabling more instances to be spun up as necessary, say in response to customer requests.</span></span> <span data-ttu-id="5efa0-146">Enfin, Service Fabric encourage les services à être légers.</span><span class="sxs-lookup"><span data-stu-id="5efa0-146">Finally, Service Fabric encourages services to be lightweight.</span></span> <span data-ttu-id="5efa0-147">Service Fabric autorise des milliers de services à être configurés dans un processus unique, plutôt que de nécessiter ou de consacrer des instances ou des processus entiers du système d'exploitation à une instance unique d’un service.</span><span class="sxs-lookup"><span data-stu-id="5efa0-147">Service Fabric allows thousands of services to be provisioned within a single process, rather than requiring or dedicating entire OS instances or processes to a single instance of a service.</span></span>
* <span data-ttu-id="5efa0-148">**Cohérence** : toutes les informations stockées dans ce service sont garanties comme étant cohérentes.</span><span class="sxs-lookup"><span data-stu-id="5efa0-148">**Consistency** - Any information stored in this service can be guaranteed to be consistent.</span></span> <span data-ttu-id="5efa0-149">Cela s’applique également à plusieurs collections fiables au sein d’un service.</span><span class="sxs-lookup"><span data-stu-id="5efa0-149">This is true even across multiple reliable collections within a service.</span></span> <span data-ttu-id="5efa0-150">Les modifications dans des collections au sein d’un service peuvent être effectuées de manière atomique au niveau transactionnel.</span><span class="sxs-lookup"><span data-stu-id="5efa0-150">Changes across collections within a service can be made in a transactionally atomic manner.</span></span>

## <a name="service-lifecycle"></a><span data-ttu-id="5efa0-151">Cycle de vie du service</span><span class="sxs-lookup"><span data-stu-id="5efa0-151">Service lifecycle</span></span>
<span data-ttu-id="5efa0-152">Que votre service soit avec état ou sans état, Reliable Services fournit un cycle de vie simple qui vous permet de rattacher rapidement votre code et de vous lancer.</span><span class="sxs-lookup"><span data-stu-id="5efa0-152">Whether your service is stateful or stateless, Reliable Services provide a simple lifecycle that lets you quickly plug in your code and get started.</span></span>  <span data-ttu-id="5efa0-153">Il vous suffit d’implémenter une ou deux méthodes pour que votre service soit opérationnel.</span><span class="sxs-lookup"><span data-stu-id="5efa0-153">There are just one or two methods that you need to implement to get your service up and running.</span></span>

* <span data-ttu-id="5efa0-154">**CreateServiceReplicaListeners/CreateServiceInstanceListeners** : cette méthode correspond à l’emplacement dans lequel le service définit la ou les piles de communication qu’il souhaite utiliser.</span><span class="sxs-lookup"><span data-stu-id="5efa0-154">**CreateServiceReplicaListeners/CreateServiceInstanceListeners** - This method is where the service defines the communication stack(s) that it wants to use.</span></span> <span data-ttu-id="5efa0-155">La pile de communication, par exemple [l’API Web](service-fabric-reliable-services-communication-webapi.md), définit le point de terminaison d’écoute ou les points de terminaison du service (mode d’accès des clients au service).</span><span class="sxs-lookup"><span data-stu-id="5efa0-155">The communication stack, such as [Web API](service-fabric-reliable-services-communication-webapi.md), is what defines the listening endpoint or endpoints for the service (how clients reach the service).</span></span> <span data-ttu-id="5efa0-156">Elle définit également comment les messages qui s’affichent interagissent avec le reste du code de service.</span><span class="sxs-lookup"><span data-stu-id="5efa0-156">It also defines how the messages that appear interact with the rest of the service code.</span></span>
* <span data-ttu-id="5efa0-157">**RunAsync** : cette méthode correspond à l’emplacement dans lequel votre service exécute sa logique métier et où il lance les tâches d’arrière-plan qui doivent s’exécuter pendant toute la durée de vie du service.</span><span class="sxs-lookup"><span data-stu-id="5efa0-157">**RunAsync** - This method is where your service runs its business logic, and where it would kick off any background tasks that should run for the lifetime of the service.</span></span> <span data-ttu-id="5efa0-158">Le jeton d'annulation fourni est un signal indiquant quand ce travail doit s'arrêter.</span><span class="sxs-lookup"><span data-stu-id="5efa0-158">The cancellation token that is provided is a signal for when that work should stop.</span></span> <span data-ttu-id="5efa0-159">Par exemple, si le service doit extraire des messages d’une file d’attente fiable et les traiter, c’est à cet emplacement que se passe ce travail.</span><span class="sxs-lookup"><span data-stu-id="5efa0-159">For example, if the service needs to pull messages out of a Reliable Queue and process them, this is where that work happens.</span></span>

<span data-ttu-id="5efa0-160">Continuez votre lecture si vous débutez dans l’utilisation de Reliable Services.</span><span class="sxs-lookup"><span data-stu-id="5efa0-160">If you're learning about reliable services for the first time, read on!</span></span> <span data-ttu-id="5efa0-161">Si vous recherchez une procédure détaillée du cycle de vie de Reliable Services, vous pouvez consulter [cet article](service-fabric-reliable-services-lifecycle.md).</span><span class="sxs-lookup"><span data-stu-id="5efa0-161">If you're looking for a detailed walkthrough of the lifecycle of reliable services, you can head over to [this article](service-fabric-reliable-services-lifecycle.md).</span></span>

## <a name="example-services"></a><span data-ttu-id="5efa0-162">Exemples de service</span><span class="sxs-lookup"><span data-stu-id="5efa0-162">Example services</span></span>
<span data-ttu-id="5efa0-163">En se basant sur ce modèle de programmation, observons rapidement deux services pour voir comment ces éléments s'imbriquent.</span><span class="sxs-lookup"><span data-stu-id="5efa0-163">Knowing this programming model, let's take a quick look at two different services to see how these pieces fit together.</span></span>

### <a name="stateless-reliable-services"></a><span data-ttu-id="5efa0-164">Services fiables sans état</span><span class="sxs-lookup"><span data-stu-id="5efa0-164">Stateless Reliable Services</span></span>
<span data-ttu-id="5efa0-165">Un service sans état est un service dans lequel l’état n’est pas conservé au sein du service entre les appels.</span><span class="sxs-lookup"><span data-stu-id="5efa0-165">A stateless service is one where there is no state maintained within the service across calls.</span></span> <span data-ttu-id="5efa0-166">Tout état présent est entièrement jetable et ne nécessite aucune synchronisation, réplication, persistance ou haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="5efa0-166">Any state that is present is entirely disposable and doesn't require synchronization, replication, persistence, or high availability.</span></span>

<span data-ttu-id="5efa0-167">Prenons pour exemple une calculatrice dépourvue de mémoire et qui reçoit tous les termes et les opérations à effectuer simultanément.</span><span class="sxs-lookup"><span data-stu-id="5efa0-167">For example, consider a calculator that has no memory and receives all terms and operations to perform at once.</span></span>

<span data-ttu-id="5efa0-168">Dans ce cas, la méthode `RunAsync()` (C#) ou `runAsync()` (Java) du service peut être vide, car ce dernier n’a besoin d’effectuer aucun traitement de tâche en arrière-plan.</span><span class="sxs-lookup"><span data-stu-id="5efa0-168">In this case, the `RunAsync()` (C#) or `runAsync()` (Java) of the service can be empty, since there is no background task-processing that the service needs to do.</span></span> <span data-ttu-id="5efa0-169">Quand le service Calculatrice est créé, il renvoie un `ICommunicationListener` (C#) ou un `CommunicationListener` (Java) (par exemple [API web](service-fabric-reliable-services-communication-webapi.md)) qui ouvre un point de terminaison d’écoute sur un port.</span><span class="sxs-lookup"><span data-stu-id="5efa0-169">When the calculator service is created, it returns an `ICommunicationListener` (C#) or `CommunicationListener` (Java) (for example [Web API](service-fabric-reliable-services-communication-webapi.md)) that opens up a listening endpoint on some port.</span></span> <span data-ttu-id="5efa0-170">Ce point de terminaison d’écoute se raccorde aux différentes méthodes de calcul (exemple : « Add(n1, n2) ») qui définissent l’API publique de la calculatrice.</span><span class="sxs-lookup"><span data-stu-id="5efa0-170">This listening endpoint hooks up to the different calculation methods (example: "Add(n1, n2)") that define the calculator's public API.</span></span>

<span data-ttu-id="5efa0-171">Lorsqu’un appel est effectué à partir d’un client, la méthode appropriée est appelée ; le service Calculatrice effectue les opérations sur les données fournies et renvoie le résultat.</span><span class="sxs-lookup"><span data-stu-id="5efa0-171">When a call is made from a client, the appropriate method is invoked, and the calculator service performs the operations on the data provided and returns the result.</span></span> <span data-ttu-id="5efa0-172">Il ne stocke aucun état.</span><span class="sxs-lookup"><span data-stu-id="5efa0-172">It doesn't store any state.</span></span>

<span data-ttu-id="5efa0-173">Le fait de ne pas stocker d’état interne rend cet exemple de calculatrice simple,</span><span class="sxs-lookup"><span data-stu-id="5efa0-173">Not storing any internal state makes this example calculator simple.</span></span> <span data-ttu-id="5efa0-174">mais la plupart des services ne sont pas réellement sans état.</span><span class="sxs-lookup"><span data-stu-id="5efa0-174">But most services aren't truly stateless.</span></span> <span data-ttu-id="5efa0-175">Ils externalisent leur état vers un autre magasin.</span><span class="sxs-lookup"><span data-stu-id="5efa0-175">Instead, they externalize their state to some other store.</span></span> <span data-ttu-id="5efa0-176">(Par exemple, toute application web qui s’appuie sur la conservation de l’état de session dans un magasin de stockage ou un cache n’est pas sans état.)</span><span class="sxs-lookup"><span data-stu-id="5efa0-176">(For example, any web app that relies on keeping session state in a backing store or cache is not stateless.)</span></span>

<span data-ttu-id="5efa0-177">Un exemple courant illustrant comment les services sans état sont utilisés dans Service Fabric est celui d'un serveur frontal qui expose l'API publique pour une application Web.</span><span class="sxs-lookup"><span data-stu-id="5efa0-177">A common example of how stateless services are used in Service Fabric is as a front-end that exposes the public-facing API for a web application.</span></span> <span data-ttu-id="5efa0-178">Le service frontal communique ensuite avec les services avec état pour terminer une demande d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="5efa0-178">The front-end service then talks to stateful services to complete a user request.</span></span> <span data-ttu-id="5efa0-179">Dans ce cas, les appels des clients sont dirigés vers un port connu, comme le port 80, où le service sans état écoute.</span><span class="sxs-lookup"><span data-stu-id="5efa0-179">In this case, calls from clients are directed to a known port, such as 80, where the stateless service is listening.</span></span> <span data-ttu-id="5efa0-180">Ce service sans état reçoit l’appel et détermine s’il provient d’une partie de confiance, et le service auquel il est destiné.</span><span class="sxs-lookup"><span data-stu-id="5efa0-180">This stateless service receives the call and determines whether the call is from a trusted party and which service it's destined for.</span></span>  <span data-ttu-id="5efa0-181">Le service sans état transfère alors l’appel vers la partition correcte du service avec état et attend une réponse.</span><span class="sxs-lookup"><span data-stu-id="5efa0-181">Then, the stateless service forwards the call to the correct partition of the stateful service and waits for a response.</span></span> <span data-ttu-id="5efa0-182">Lorsqu’il reçoit une réponse, il répond au client d’origine.</span><span class="sxs-lookup"><span data-stu-id="5efa0-182">When the stateless service receives a response, it replies to the original client.</span></span> <span data-ttu-id="5efa0-183">Vous trouverez un exemple de ce type de service dans nos exemples [C#](https://github.com/Azure-Samples/service-fabric-dotnet-getting-started) / [Java](https://github.com/Azure-Samples/service-fabric-java-getting-started/tree/master/Actors/VisualObjectActor/VisualObjectWebService).</span><span class="sxs-lookup"><span data-stu-id="5efa0-183">An example of such a service is in our samples [C#](https://github.com/Azure-Samples/service-fabric-dotnet-getting-started) / [Java](https://github.com/Azure-Samples/service-fabric-java-getting-started/tree/master/Actors/VisualObjectActor/VisualObjectWebService).</span></span> <span data-ttu-id="5efa0-184">Il ne s’agit que d’un seul exemple de ce modèle dans les exemples, vous en trouverez également d’autres dans d’autres exemples.</span><span class="sxs-lookup"><span data-stu-id="5efa0-184">This is only one example of this pattern in the samples, there are others in other samples as well.</span></span>

### <a name="stateful-reliable-services"></a><span data-ttu-id="5efa0-185">Services fiables avec état</span><span class="sxs-lookup"><span data-stu-id="5efa0-185">Stateful Reliable Services</span></span>
<span data-ttu-id="5efa0-186">Un service avec état est un service qui doit avoir une partie de l'état sans cesse cohérente et présente pour que le service fonctionne.</span><span class="sxs-lookup"><span data-stu-id="5efa0-186">A stateful service is one that must have some portion of state kept consistent and present in order for the service to function.</span></span> <span data-ttu-id="5efa0-187">Prenons pour exemple un service qui calcule constamment une moyenne mobile d’une valeur en fonction des mises à jour qu’il reçoit.</span><span class="sxs-lookup"><span data-stu-id="5efa0-187">Consider a service that constantly computes a rolling average of some value based on updates it receives.</span></span> <span data-ttu-id="5efa0-188">Pour ce faire, il doit disposer de l’ensemble actuel des requêtes entrantes qu’il doit traiter et la moyenne actuelle.</span><span class="sxs-lookup"><span data-stu-id="5efa0-188">To do this, it must have the current set of incoming requests it needs to process and the current average.</span></span> <span data-ttu-id="5efa0-189">Tout service qui récupère, traite et stocke des informations dans un magasin externe (comme un magasin de tables ou d’objets blob Azure) est un service avec état.</span><span class="sxs-lookup"><span data-stu-id="5efa0-189">Any service that retrieves, processes, and stores information in an external store (such as an Azure blob or table store today) is stateful.</span></span> <span data-ttu-id="5efa0-190">Il conserve seulement son état dans le magasin d’état externe.</span><span class="sxs-lookup"><span data-stu-id="5efa0-190">It just keeps its state in the external state store.</span></span>

<span data-ttu-id="5efa0-191">Actuellement, la plupart des services stockent leur état en externe, car le magasin externe fournit la fiabilité, la disponibilité, l’évolutivité et la cohérence pour cet état.</span><span class="sxs-lookup"><span data-stu-id="5efa0-191">Most services today store their state externally, since the external store is what provides reliability, availability, scalability, and consistency for that state.</span></span> <span data-ttu-id="5efa0-192">Dans Service Fabric, les services ne sont pas obligés de stocker leur état en externe.</span><span class="sxs-lookup"><span data-stu-id="5efa0-192">In Service Fabric, services aren't required to store their state externally.</span></span> <span data-ttu-id="5efa0-193">Service Fabric s’occupe de ces exigences pour le code de service et l’état du service.</span><span class="sxs-lookup"><span data-stu-id="5efa0-193">Service Fabric takes care of these requirements for both the service code and the service state.</span></span>

> [!NOTE]
> <span data-ttu-id="5efa0-194">La prise en charge de Reliable Services avec état n’est pas encore disponible sur Linux (pour C# ou Java).</span><span class="sxs-lookup"><span data-stu-id="5efa0-194">Support for Stateful Reliable Services is not available on Linux yet (for C# or Java).</span></span>
>

<span data-ttu-id="5efa0-195">Supposons que nous souhaitions écrire un service qui traite des images.</span><span class="sxs-lookup"><span data-stu-id="5efa0-195">Let's say we want to write a service that processes images.</span></span> <span data-ttu-id="5efa0-196">Pour ce faire, le service récupère une image et la série de conversions à effectuer sur cette image.</span><span class="sxs-lookup"><span data-stu-id="5efa0-196">To do this, the service takes in an image and the series of conversions to perform on that image.</span></span> <span data-ttu-id="5efa0-197">Ce service renvoie un écouteur de communication (par exemple, une API Web) qui expose une API telle que `ConvertImage(Image i, IList<Conversion> conversions)`.</span><span class="sxs-lookup"><span data-stu-id="5efa0-197">This service returns a communication listener (let's suppose it's a WebAPI) that exposes an API like `ConvertImage(Image i, IList<Conversion> conversions)`.</span></span> <span data-ttu-id="5efa0-198">Lorsqu’il reçoit une requête, le service la stocke dans une `IReliableQueue` et renvoie un ID au client pour suivre la requête.</span><span class="sxs-lookup"><span data-stu-id="5efa0-198">When it receives a request, the service stores it in a `IReliableQueue`, and returns some id to the client so it can track the request.</span></span>

<span data-ttu-id="5efa0-199">Dans ce service, `RunAsync()` pourrait être plus complexe.</span><span class="sxs-lookup"><span data-stu-id="5efa0-199">In this service, `RunAsync()` could be more complex.</span></span> <span data-ttu-id="5efa0-200">Le service a une boucle à l’intérieur de sa méthode `RunAsync()` qui extrait les requêtes de la `IReliableQueue` et effectue les conversions demandées.</span><span class="sxs-lookup"><span data-stu-id="5efa0-200">The service has a loop inside its `RunAsync()` that pulls requests out of `IReliableQueue` and performs the conversions requested.</span></span> <span data-ttu-id="5efa0-201">Les résultats sont stockés dans un `IReliableDictionary` de sorte que lorsque le client revient, il peut obtenir ses images converties.</span><span class="sxs-lookup"><span data-stu-id="5efa0-201">The results get stored in an `IReliableDictionary` so that when the client comes back they can get their converted images.</span></span> <span data-ttu-id="5efa0-202">Pour garantir que, même en cas de problème, l’image n’est pas perdue, ce Reliable Service se sortirait de la file d’attente, exécuterait les conversions et stockerait le résultat, le tout dans une transaction unique.</span><span class="sxs-lookup"><span data-stu-id="5efa0-202">To ensure that even if something fails the image isn't lost, this Reliable Service would pull out of the queue, perform the conversions, and store the result all in a single transaction.</span></span> <span data-ttu-id="5efa0-203">Dans ce cas, le message est supprimé de la file d’attente et les résultats sont stockés dans le dictionnaire de résultats uniquement lorsque les conversions sont terminées.</span><span class="sxs-lookup"><span data-stu-id="5efa0-203">In this case, the message is removed from the queue and the results are stored in the result dictionary only when the conversions are complete.</span></span> <span data-ttu-id="5efa0-204">Le service peut également extraire l’image de la file d’attente et la stocker immédiatement dans un magasin distant.</span><span class="sxs-lookup"><span data-stu-id="5efa0-204">Alternatively, the service could pull the image out of the queue and immediately store it in a remote store.</span></span> <span data-ttu-id="5efa0-205">Cela réduit la quantité d’état que le service doit gérer, mais augmente la complexité étant donné que le service doit conserver les métadonnées nécessaires pour gérer le magasin distant.</span><span class="sxs-lookup"><span data-stu-id="5efa0-205">This reduces the amount of state the service has to manage, but increases complexity since the service has to keep the necessary metadata to manage the remote store.</span></span> <span data-ttu-id="5efa0-206">Avec les deux approches, si quelque chose échoue au cours du traitement, la requête reste dans la file d’attente en attente d’être traitée.</span><span class="sxs-lookup"><span data-stu-id="5efa0-206">With either approach, if something failed in the middle the request remains in the queue waiting to be processed.</span></span>

<span data-ttu-id="5efa0-207">Concernant ce service, il convient de noter qu’il ressemble à un service .NET normal.</span><span class="sxs-lookup"><span data-stu-id="5efa0-207">One thing to note about this service is that it sounds like a normal .NET service!</span></span> <span data-ttu-id="5efa0-208">La seule différence est que les structures de données utilisées (`IReliableQueue` et `IReliableDictionary`) sont fournies par Service Fabric et sont plus fiables, disponibles et cohérentes.</span><span class="sxs-lookup"><span data-stu-id="5efa0-208">The only difference is that the data structures being used (`IReliableQueue` and `IReliableDictionary`) are provided by Service Fabric, and are highly reliable, available, and consistent.</span></span>

## <a name="when-to-use-reliable-services-apis"></a><span data-ttu-id="5efa0-209">Quand utiliser les API Reliable Services</span><span class="sxs-lookup"><span data-stu-id="5efa0-209">When to use Reliable Services APIs</span></span>
<span data-ttu-id="5efa0-210">Si l’un des éléments suivants correspond aux besoins de votre service d’application, vous devez songer à utiliser les API Reliable Services :</span><span class="sxs-lookup"><span data-stu-id="5efa0-210">If any of the following characterize your application service needs, then you should consider Reliable Services APIs:</span></span>

* <span data-ttu-id="5efa0-211">Vous souhaitez que le code de votre service (et éventuellement l’état) soit hautement disponible et fiable</span><span class="sxs-lookup"><span data-stu-id="5efa0-211">You want your service's code (and optionally state) to be highly available and reliable</span></span>
* <span data-ttu-id="5efa0-212">Vous avez besoin de garanties transactionnelles entre plusieurs unités d’état (par exemple, commandes et éléments de ligne de commande).</span><span class="sxs-lookup"><span data-stu-id="5efa0-212">You need transactional guarantees across multiple units of state (for example, orders and order line items).</span></span>
* <span data-ttu-id="5efa0-213">L’état de votre application peut être naturellement modélisé sous forme de Files d’attente et de Dictionnaires fiables</span><span class="sxs-lookup"><span data-stu-id="5efa0-213">Your application’s state can be naturally modeled as Reliable Dictionaries and Queues.</span></span>
* <span data-ttu-id="5efa0-214">Le code ou l’état de votre application doit être hautement disponible avec des lectures et écritures à faible latence.</span><span class="sxs-lookup"><span data-stu-id="5efa0-214">Your applications code or state needs to be highly available with low latency reads and writes.</span></span>
* <span data-ttu-id="5efa0-215">Votre application doit contrôler la concurrence ou la granularité des opérations traitées dans une ou plusieurs Collections fiables.</span><span class="sxs-lookup"><span data-stu-id="5efa0-215">Your application needs to control the concurrency or granularity of transacted operations across one or more Reliable Collections.</span></span>
* <span data-ttu-id="5efa0-216">Vous souhaitez gérer les communications ou contrôler le schéma de partitionnement de votre service.</span><span class="sxs-lookup"><span data-stu-id="5efa0-216">You want to manage the communications or control the partitioning scheme for your service.</span></span>
* <span data-ttu-id="5efa0-217">Votre code a besoin d’un environnement d’exécution libre de threads.</span><span class="sxs-lookup"><span data-stu-id="5efa0-217">Your code needs a free-threaded runtime environment.</span></span>
* <span data-ttu-id="5efa0-218">Votre application doit créer ou détruire des Files d’attente ou des Dictionnaires fiables ou des Services entiers de manière dynamique lors de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="5efa0-218">Your application needs to dynamically create or destroy Reliable Dictionaries or Queues or whole Services at runtime.</span></span>
* <span data-ttu-id="5efa0-219">Vous devez contrôler par programme les fonctionnalités de sauvegarde et de restauration fournies par Service Fabric pour l’état du service.</span><span class="sxs-lookup"><span data-stu-id="5efa0-219">You need to programmatically control Service Fabric-provided backup and restore features for your service’s state.</span></span>
* <span data-ttu-id="5efa0-220">Votre application doit conserver l’historique des modifications pour ses unités d’état.</span><span class="sxs-lookup"><span data-stu-id="5efa0-220">Your application needs to maintain change history for its units of state.</span></span>
* <span data-ttu-id="5efa0-221">Vous souhaitez développer ou utiliser des fournisseurs d’état personnalisé développés par une tierce partie.</span><span class="sxs-lookup"><span data-stu-id="5efa0-221">You want to develop or consume third-party-developed, custom state providers.</span></span>

## <a name="next-steps"></a><span data-ttu-id="5efa0-222">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="5efa0-222">Next steps</span></span>
* [<span data-ttu-id="5efa0-223">Démarrage rapide de Reliable Services</span><span class="sxs-lookup"><span data-stu-id="5efa0-223">Reliable Services quick start</span></span>](service-fabric-reliable-services-quick-start.md)
* [<span data-ttu-id="5efa0-224">Utilisation avancée de Reliable Services</span><span class="sxs-lookup"><span data-stu-id="5efa0-224">Reliable Services advanced usage</span></span>](service-fabric-reliable-services-advanced-usage.md)
* [<span data-ttu-id="5efa0-225">Modèle de programmation Reliable Actors</span><span class="sxs-lookup"><span data-stu-id="5efa0-225">The Reliable Actors programming model</span></span>](service-fabric-reliable-actors-introduction.md)
