---
title: Architecture du Gestionnaire de ressources | Microsoft Docs
description: "Vue d’ensemble de l’architecture du Gestionnaire de ressources Service Fabric."
services: service-fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: 
ms.assetid: 6c4421f9-834b-450c-939f-1cb4ff456b9b
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 08/18/2017
ms.author: masnider
ms.openlocfilehash: 565c20637fa93ed92bb6c52e585a4b70bdeb6f8c
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/18/2017
---
# <a name="cluster-resource-manager-architecture-overview"></a><span data-ttu-id="40913-103">Vue d’ensemble de l’architecture Cluster Resource Manager</span><span class="sxs-lookup"><span data-stu-id="40913-103">Cluster resource manager architecture overview</span></span>
<span data-ttu-id="40913-104">Service Fabric Cluster Resource Manager est un service central qui s’exécute dans le cluster.</span><span class="sxs-lookup"><span data-stu-id="40913-104">The Service Fabric Cluster Resource Manager is a central service that runs in the cluster.</span></span> <span data-ttu-id="40913-105">Il gère l’état souhaité des services dans le cluster, notamment au niveau de la consommation des ressources et des règles de placement.</span><span class="sxs-lookup"><span data-stu-id="40913-105">It manages the desired state of the services in the cluster, particularly with respect to resource consumption and any placement rules.</span></span> 

<span data-ttu-id="40913-106">Pour gérer les ressources de votre cluster, Service Fabric Cluster Resource Manager doit disposer de plusieurs éléments :</span><span class="sxs-lookup"><span data-stu-id="40913-106">To manage the resources in your cluster, the Service Fabric Cluster Resource Manager must have several pieces of information:</span></span>

- <span data-ttu-id="40913-107">La liste des services existants</span><span class="sxs-lookup"><span data-stu-id="40913-107">Which services currently exist</span></span>
- <span data-ttu-id="40913-108">La consommation de ressources actuelle (ou par défaut) de chaque service</span><span class="sxs-lookup"><span data-stu-id="40913-108">Each service's current (or default) resource consumption</span></span> 
- <span data-ttu-id="40913-109">La capacité restante du cluster</span><span class="sxs-lookup"><span data-stu-id="40913-109">The remaining cluster capacity</span></span> 
- <span data-ttu-id="40913-110">La capacité des nœuds du cluster</span><span class="sxs-lookup"><span data-stu-id="40913-110">The capacity of the nodes in the cluster</span></span> 
- <span data-ttu-id="40913-111">La quantité de ressources consommées sur chaque nœud</span><span class="sxs-lookup"><span data-stu-id="40913-111">The amount of resources consumed on each node</span></span>

<span data-ttu-id="40913-112">La consommation des ressources d’un service donné peut évoluer au fil du temps et les services prennent généralement en charge plusieurs types de ressources.</span><span class="sxs-lookup"><span data-stu-id="40913-112">The resource consumption of a given service can change over time, and services usually care about more than one type of resource.</span></span> <span data-ttu-id="40913-113">Dans différents services, il peut s’agir de ressources physiques réelles et de ressources physiques mesurées.</span><span class="sxs-lookup"><span data-stu-id="40913-113">Across different services, there may be both real physical and physical resources being measured.</span></span> <span data-ttu-id="40913-114">Les services peuvent assurer le suivi des mesures physiques comme la consommation de mémoire et de disque.</span><span class="sxs-lookup"><span data-stu-id="40913-114">Services may track physical metrics like memory and disk consumption.</span></span> <span data-ttu-id="40913-115">En général, les services peuvent se soucier des mesures logiques, comme « WorkQueueDepth » ou « TotalRequests ».</span><span class="sxs-lookup"><span data-stu-id="40913-115">More commonly, services may care about logical metrics - things like "WorkQueueDepth" or "TotalRequests".</span></span> <span data-ttu-id="40913-116">Des mesures logiques et physiques peuvent être utilisées dans le même cluster.</span><span class="sxs-lookup"><span data-stu-id="40913-116">Both logical and physical metrics can be used in the same cluster.</span></span> <span data-ttu-id="40913-117">Les mesures peuvent être partagées entre plusieurs services ou être spécifiques à un service particulier.</span><span class="sxs-lookup"><span data-stu-id="40913-117">Metrics can be shared across many services or be specific to a particular service.</span></span>

## <a name="other-considerations"></a><span data-ttu-id="40913-118">Autres points à considérer</span><span class="sxs-lookup"><span data-stu-id="40913-118">Other considerations</span></span>
<span data-ttu-id="40913-119">Les propriétaires et les opérateurs du cluster peuvent être différents des auteurs du service ou de l’application, ou il s’agit au minimum des mêmes personnes, mais avec des rôles différents.</span><span class="sxs-lookup"><span data-stu-id="40913-119">The owners and operators of the cluster can be different from the service and application authors, or at a minimum are the same people wearing different hats.</span></span> <span data-ttu-id="40913-120">Lorsque vous développez votre application, vous avez quelques informations sur les éléments qu’elle nécessite.</span><span class="sxs-lookup"><span data-stu-id="40913-120">When you develop your application you know a few things about what it requires.</span></span> <span data-ttu-id="40913-121">Vous avez une estimation des ressources qu’elle consomme et comment les différents services doivent être déployés.</span><span class="sxs-lookup"><span data-stu-id="40913-121">You have an estimate of the resources it will consume and how different services should be deployed.</span></span> <span data-ttu-id="40913-122">Par exemple, le niveau web doit s’exécuter sur des nœuds exposés à Internet, ce qui n’est pas le cas des services de base de données.</span><span class="sxs-lookup"><span data-stu-id="40913-122">For example, the web tier needs to run on nodes exposed to the Internet, while the database services should not.</span></span> <span data-ttu-id="40913-123">Autre exemple : les services web sont probablement contraints par le processeur et le réseau, tandis que les services de niveau données s’occupent davantage de la consommation de mémoire et de disque.</span><span class="sxs-lookup"><span data-stu-id="40913-123">As another example, the web services are probably constrained by CPU and network, while the data tier services care more about memory and disk consumption.</span></span> <span data-ttu-id="40913-124">Toutefois, les tâches qui incombent à la personne qui gère un incident sur site pour ce service en production ou une mise à niveau du service, sont différentes et nécessitent des outils différents.</span><span class="sxs-lookup"><span data-stu-id="40913-124">However, the person handling a live-site incident for that service in production, or who is managing an upgrade to the service has a different job to do, and requires different tools.</span></span> 

<span data-ttu-id="40913-125">Le cluster et les services sont dynamiques :</span><span class="sxs-lookup"><span data-stu-id="40913-125">Both the cluster and services are dynamic:</span></span>

- <span data-ttu-id="40913-126">Le nombre de nœuds dans le cluster peut augmenter ou diminuer.</span><span class="sxs-lookup"><span data-stu-id="40913-126">The number of nodes in the cluster can grow and shrink</span></span>
- <span data-ttu-id="40913-127">Des nœuds présentant des tailles et types différents vont et viennent.</span><span class="sxs-lookup"><span data-stu-id="40913-127">Nodes of different sizes and types can come and go</span></span>
- <span data-ttu-id="40913-128">Des services peuvent être créés ou supprimés, et peuvent modifier leur allocation de ressources ainsi que les règles de placement.</span><span class="sxs-lookup"><span data-stu-id="40913-128">Services can be created, removed, and change their desired resource allocations and placement rules</span></span>
- <span data-ttu-id="40913-129">Les mises à niveau ou autres opérations de gestion peuvent avoir un impact sur le cluster lors de l’application sur des niveaux d’infrastructure.</span><span class="sxs-lookup"><span data-stu-id="40913-129">Upgrades or other management operations can roll through the cluster at the application on infrastructure levels</span></span>
- <span data-ttu-id="40913-130">Des échecs peuvent se produire à tout moment.</span><span class="sxs-lookup"><span data-stu-id="40913-130">Failures can happen at any time.</span></span>

## <a name="cluster-resource-manager-components-and-data-flow"></a><span data-ttu-id="40913-131">Composants et flux de données Cluster Resource Manager</span><span class="sxs-lookup"><span data-stu-id="40913-131">Cluster resource manager components and data flow</span></span>
<span data-ttu-id="40913-132">Cluster Resource Manager doit suivre les spécifications de chaque service et la consommation des ressources de chaque objet de service au sein de ces services.</span><span class="sxs-lookup"><span data-stu-id="40913-132">The Cluster Resource Manager has to track the requirements of each service and the consumption of resources by each service object within those services.</span></span> <span data-ttu-id="40913-133">Cluster Resource Manager se compose de deux éléments conceptuels : les agents, qui s’exécutent sur chaque nœud, et un service à haute tolérance face aux pannes.</span><span class="sxs-lookup"><span data-stu-id="40913-133">The Cluster Resource Manager has two conceptual parts: agents that run on each node and a fault-tolerant service.</span></span> <span data-ttu-id="40913-134">Les agents de chaque nœud suivent les rapports de charge des services, les agrègent et envoient des rapports régulièrement.</span><span class="sxs-lookup"><span data-stu-id="40913-134">The agents on each node track load reports from services, aggregate them, and periodically report them.</span></span> <span data-ttu-id="40913-135">Cluster Resource Manager rassemble toutes les informations auprès des agents locaux et réagit en fonction de sa configuration actuelle.</span><span class="sxs-lookup"><span data-stu-id="40913-135">The Cluster Resource Manager service aggregates all the information from the local agents and reacts based on its current configuration.</span></span>

<span data-ttu-id="40913-136">Examinons le schéma suivant :</span><span class="sxs-lookup"><span data-stu-id="40913-136">Let’s look at the following diagram:</span></span>

<span data-ttu-id="40913-137"><center>
![Architecture de l’équilibreur de ressources][Image1]
</center></span><span class="sxs-lookup"><span data-stu-id="40913-137"><center>
![Resource Balancer Architecture][Image1]
</center></span></span>

<span data-ttu-id="40913-138">Pendant l’exécution, de nombreux changements peuvent se produire.</span><span class="sxs-lookup"><span data-stu-id="40913-138">During runtime, there are many changes that could happen.</span></span> <span data-ttu-id="40913-139">Par exemple, supposons que la quantité de ressources que consomment certains services change, que certains services échouent et que certains nœuds se joignent au cluster ou le quittent.</span><span class="sxs-lookup"><span data-stu-id="40913-139">For example, let’s say the amount of resources some services consume changes, some services fail, and some nodes join and leave the cluster.</span></span> <span data-ttu-id="40913-140">Toutes les modifications sur les nœuds sont agrégées et régulièrement envoyées au service Cluster Resource Manager (1,2) où elles sont agrégées à nouveau, analysées et stockées.</span><span class="sxs-lookup"><span data-stu-id="40913-140">All the changes on a node are aggregated and periodically sent to the Cluster Resource Manager service (1,2) where they are aggregated again, analyzed, and stored.</span></span> <span data-ttu-id="40913-141">À une fréquence de quelques secondes, ce service examine les changements et détermine si des actions sont nécessaires (3).</span><span class="sxs-lookup"><span data-stu-id="40913-141">Every few seconds that service looks at the changes and determines if any actions are necessary (3).</span></span> <span data-ttu-id="40913-142">Par exemple, il peut remarquer que des nœuds vides ont été ajoutés au cluster,</span><span class="sxs-lookup"><span data-stu-id="40913-142">For example, it could notice that some empty nodes have been added to the cluster.</span></span> <span data-ttu-id="40913-143">et décider par conséquent de déplacer certains services vers ces nœuds.</span><span class="sxs-lookup"><span data-stu-id="40913-143">As a result, it decides to move some services to those nodes.</span></span> <span data-ttu-id="40913-144">Cluster Resource Manager peut également remarquer qu’un nœud particulier est surchargé ou que certains services ont échoué ou ont été supprimés, en libérant des ressources ailleurs.</span><span class="sxs-lookup"><span data-stu-id="40913-144">The Cluster Resource Manager could also notice that a particular node is overloaded, or that certain services have failed or been deleted, freeing up resources elsewhere.</span></span>

<span data-ttu-id="40913-145">Examinons le schéma suivant pour voir ce qui se passe ensuite.</span><span class="sxs-lookup"><span data-stu-id="40913-145">Let’s look at the following diagram and see what happens next.</span></span> <span data-ttu-id="40913-146">Supposons que Cluster Resource Manager détermine que des modifications sont nécessaires.</span><span class="sxs-lookup"><span data-stu-id="40913-146">Let’s say that the Cluster Resource Manager determines that changes are necessary.</span></span> <span data-ttu-id="40913-147">Il communique avec d’autres services système (en particulier Failover Manager) pour apporter les modifications nécessaires.</span><span class="sxs-lookup"><span data-stu-id="40913-147">It coordinates with other system services (in particular the Failover Manager) to make the necessary changes.</span></span> <span data-ttu-id="40913-148">Les commandes nécessaires sont envoyées aux nœuds appropriés (4).</span><span class="sxs-lookup"><span data-stu-id="40913-148">Then the necessary commands are sent to the appropriate nodes (4).</span></span> <span data-ttu-id="40913-149">Par exemple, supposons que Resource Manager a remarqué que Node5 est surchargé et a donc décidé de déplacer le service B de Node5 à Node4.</span><span class="sxs-lookup"><span data-stu-id="40913-149">For example, let's say the Resource Manager noticed that Node5 was overloaded, and so decided to move service B from Node5 to Node4.</span></span> <span data-ttu-id="40913-150">À la fin de la reconfiguration (5), le cluster a l’aspect suivant :</span><span class="sxs-lookup"><span data-stu-id="40913-150">At the end of the reconfiguration (5), the cluster looks like this:</span></span>

<span data-ttu-id="40913-151"><center>
![Architecture de l’équilibreur de ressources][Image2]
</center></span><span class="sxs-lookup"><span data-stu-id="40913-151"><center>
![Resource Balancer Architecture][Image2]
</center></span></span>

## <a name="next-steps"></a><span data-ttu-id="40913-152">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="40913-152">Next steps</span></span>
- <span data-ttu-id="40913-153">Cluster Resource Manager comporte de nombreuses options permettant de décrire le cluster.</span><span class="sxs-lookup"><span data-stu-id="40913-153">The Cluster Resource Manager has many options for describing the cluster.</span></span> <span data-ttu-id="40913-154">Pour en savoir plus sur celles-ci, consultez cet article sur la [description d’un cluster Service Fabric](./service-fabric-cluster-resource-manager-cluster-description.md).</span><span class="sxs-lookup"><span data-stu-id="40913-154">To find out more about them, check out this article on [describing a Service Fabric cluster](./service-fabric-cluster-resource-manager-cluster-description.md)</span></span>
- <span data-ttu-id="40913-155">Les principales tâches de Cluster Resource Manager sont le rééquilibrage du cluster et l’application des règles de placement.</span><span class="sxs-lookup"><span data-stu-id="40913-155">The Cluster Resource Manager's primary duties are rebalancing the cluster and enforcing placement rules.</span></span> <span data-ttu-id="40913-156">Pour plus d’informations sur la configuration de ces comportements, consultez [Équilibrage de votre cluster Service Fabric](./service-fabric-cluster-resource-manager-balancing.md)</span><span class="sxs-lookup"><span data-stu-id="40913-156">For more information on configuring these behaviors, see [balancing your Service Fabric cluster](./service-fabric-cluster-resource-manager-balancing.md)</span></span>

[Image1]:./media/service-fabric-cluster-resource-manager-architecture/Service-Fabric-Resource-Manager-Architecture-Activity-1.png
[Image2]:./media/service-fabric-cluster-resource-manager-architecture/Service-Fabric-Resource-Manager-Architecture-Activity-2.png
