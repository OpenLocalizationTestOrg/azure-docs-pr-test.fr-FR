---
title: "Didacticiel de mise à niveau d’applications Service Fabric | Microsoft Docs"
description: "Cet article vous présente l'expérience de déploiement d'une application Service Fabric, la modification du code et le déploiement d'une mise à niveau à l'aide de Visual Studio."
services: service-fabric
documentationcenter: .net
author: mani-ramaswamy
manager: timlt
editor: 
ms.assetid: a3181a7a-9ab1-4216-b07a-05b79bd826a4
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 8/9/2017
ms.author: subramar
ms.openlocfilehash: 940440688ec770a4aeb932b574bd6be173f494d4
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/18/2017
---
# <a name="service-fabric-application-upgrade-tutorial-using-visual-studio"></a><span data-ttu-id="d239e-103">Didacticiel sur la mise à niveau d'une application Service Fabric à l'aide de Visual Studio</span><span class="sxs-lookup"><span data-stu-id="d239e-103">Service Fabric application upgrade tutorial using Visual Studio</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="d239e-104">PowerShell</span><span class="sxs-lookup"><span data-stu-id="d239e-104">PowerShell</span></span>](service-fabric-application-upgrade-tutorial-powershell.md)
> * [<span data-ttu-id="d239e-105">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="d239e-105">Visual Studio</span></span>](service-fabric-application-upgrade-tutorial.md)
> 
> 

<br/>

<span data-ttu-id="d239e-106">Azure Service Fabric simplifie le processus de mise à niveau des applications cloud en veillant à ce que seuls les services modifiés soient mis à niveau et que l'intégrité de l'application soit analysée tout au long de la mise à niveau.</span><span class="sxs-lookup"><span data-stu-id="d239e-106">Azure Service Fabric simplifies the process of upgrading cloud applications by ensuring that only changed services are upgraded, and that application health is monitored throughout the upgrade process.</span></span> <span data-ttu-id="d239e-107">Il restaure automatiquement la version précédente de l’application en cas de problème.</span><span class="sxs-lookup"><span data-stu-id="d239e-107">It also automatically rolls back the application to the previous version upon encountering issues.</span></span> <span data-ttu-id="d239e-108">Les mises à niveau des applications Service Fabric s'effectuent *sans interruption de service*, étant donné que l'application peut être mise à niveau sans interruption du service.</span><span class="sxs-lookup"><span data-stu-id="d239e-108">Service Fabric application upgrades are *Zero Downtime*, since the application can be upgraded with no downtime.</span></span> <span data-ttu-id="d239e-109">Ce didacticiel explique comment effectuer une mise à niveau propagée à partir de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="d239e-109">This tutorial covers how to complete a rolling upgrade from Visual Studio.</span></span>

## <a name="step-1-build-and-publish-the-visual-objects-sample"></a><span data-ttu-id="d239e-110">Étape 1 : Créer et publier l'exemple Visual Objects</span><span class="sxs-lookup"><span data-stu-id="d239e-110">Step 1: Build and publish the Visual Objects sample</span></span>
<span data-ttu-id="d239e-111">Tout d’abord, téléchargez l’application [Visual Objects](https://github.com/Azure-Samples/service-fabric-dotnet-getting-started/tree/classic/Actors/VisualObjects) à partir de GitHub.</span><span class="sxs-lookup"><span data-stu-id="d239e-111">First, download the [Visual Objects](https://github.com/Azure-Samples/service-fabric-dotnet-getting-started/tree/classic/Actors/VisualObjects) application from GitHub.</span></span> <span data-ttu-id="d239e-112">Ensuite, générez et publiez l’application en cliquant avec le bouton droit sur le projet d’application, **VisualObjects**, et en sélectionnant la commande **Publier** dans l’élément de menu Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="d239e-112">Then, build and publish the application by right-clicking on the application project, **VisualObjects**, and selecting the **Publish** command in the Service Fabric menu item.</span></span>

![Menu contextuel pour une application Service Fabric][image1]

<span data-ttu-id="d239e-114">La sélection de l’option **Publier** affiche une autre fenêtre. Vous pouvez définir le **Profil cible** sur **PublishProfiles\Local.xml**.</span><span class="sxs-lookup"><span data-stu-id="d239e-114">Selecting **Publish** brings up a popup, and you can set the **Target profile** to **PublishProfiles\Local.xml**.</span></span> <span data-ttu-id="d239e-115">La fenêtre doit ressembler à ce qui suit avant de cliquer sur **Publier**.</span><span class="sxs-lookup"><span data-stu-id="d239e-115">The window should look like the following before you click **Publish**.</span></span>

![Publication d'une application Service Fabric][image2]

<span data-ttu-id="d239e-117">À présent, vous pouvez cliquer sur **Publier** dans la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="d239e-117">Now you can click **Publish** in the dialog box.</span></span> <span data-ttu-id="d239e-118">Vous pouvez utiliser l' [Explorateur de Service Fabric pour afficher le cluster et l'application](service-fabric-visualizing-your-cluster.md).</span><span class="sxs-lookup"><span data-stu-id="d239e-118">You can use [Service Fabric Explorer to view the cluster and the application](service-fabric-visualizing-your-cluster.md).</span></span> <span data-ttu-id="d239e-119">L’application Visual Objects possède un service web accessible en tapant [http://localhost:8081/visualobjects/](http://localhost:8081/visualobjects/) dans la barre d’adresse de votre navigateur.</span><span class="sxs-lookup"><span data-stu-id="d239e-119">The Visual Objects application has a web service that you can go to by typing [http://localhost:8081/visualobjects/](http://localhost:8081/visualobjects/) in the address bar of your browser.</span></span>  <span data-ttu-id="d239e-120">Vous devez normalement voir 10 objets visuels flottants en rotation à l'écran.</span><span class="sxs-lookup"><span data-stu-id="d239e-120">You should see 10 floating visual objects moving around on the screen.</span></span>

<span data-ttu-id="d239e-121">**REMARQUE :** si vous procédez au déploiement vers le profil `Cloud.xml` (Azure Service Fabric), l’application doit alors être disponible à l’adresse **http://{NomServiceFabric}.{Région}.cloudapp.azure.com:8081/visualobjects/**.</span><span class="sxs-lookup"><span data-stu-id="d239e-121">**NOTE:** If deploying to `Cloud.xml` profile (Azure Service Fabric), the application should then be available at **http://{ServiceFabricName}.{Region}.cloudapp.azure.com:8081/visualobjects/**.</span></span> <span data-ttu-id="d239e-122">Assurez-vous d’avoir configuré `8081/TCP` dans l’équilibreur Load Balancer (recherchez l’équilibreur Load Balancer dans le même groupe de ressources que l’instance Service Fabric).</span><span class="sxs-lookup"><span data-stu-id="d239e-122">Make sure you do have `8081/TCP` configured in the Load Balancer (find the Load Balancer in the same resource group as the Service Fabric instance).</span></span>

## <a name="step-2-update-the-visual-objects-sample"></a><span data-ttu-id="d239e-123">Étape 2 : Mettre à jour l'exemple Visual Objects</span><span class="sxs-lookup"><span data-stu-id="d239e-123">Step 2: Update the Visual Objects sample</span></span>
<span data-ttu-id="d239e-124">Vous pouvez remarquer qu'avec la version qui a été déployée à l'étape 1, les objets visuels ne sont pas en rotation.</span><span class="sxs-lookup"><span data-stu-id="d239e-124">You might notice that with the version that was deployed in step 1, the visual objects do not rotate.</span></span> <span data-ttu-id="d239e-125">Mettons à niveau cette application vers une application dans laquelle les objets visuels sont en rotation.</span><span class="sxs-lookup"><span data-stu-id="d239e-125">Let's upgrade this application to one where the visual objects also rotate.</span></span>

<span data-ttu-id="d239e-126">Sélectionnez le projet VisualObjects.ActorService dans la solution VisualObjects et ouvrez le fichier **VisualObjectActor.cs** .</span><span class="sxs-lookup"><span data-stu-id="d239e-126">Select the VisualObjects.ActorService project within the VisualObjects solution, and open the **VisualObjectActor.cs** file.</span></span> <span data-ttu-id="d239e-127">Dans ce fichier, accédez à la méthode `MoveObject`, placez en commentaire `visualObject.Move(false)` et effacez le commentaire de `visualObject.Move(true)`.</span><span class="sxs-lookup"><span data-stu-id="d239e-127">Within that file, go to the method `MoveObject`, comment out `visualObject.Move(false)`, and uncomment `visualObject.Move(true)`.</span></span> <span data-ttu-id="d239e-128">Cette modification du code fait pivoter les objets lorsque le service a été mis à niveau.</span><span class="sxs-lookup"><span data-stu-id="d239e-128">This code change rotates the objects after the service is upgraded.</span></span>  <span data-ttu-id="d239e-129">**Vous pouvez maintenant générer (pas régénérer) la solution**, qui génère les projets modifiés.</span><span class="sxs-lookup"><span data-stu-id="d239e-129">**Now you can build (not rebuild) the solution**, which builds the modified projects.</span></span> <span data-ttu-id="d239e-130">Si vous sélectionnez *Régénérer tout*, vous devez mettre à jour les versions de tous les projets.</span><span class="sxs-lookup"><span data-stu-id="d239e-130">If you select *Rebuild all*, you have to update the versions for all the projects.</span></span>

<span data-ttu-id="d239e-131">Nous devons également attribuer une version à notre application.</span><span class="sxs-lookup"><span data-stu-id="d239e-131">We also need to version our application.</span></span> <span data-ttu-id="d239e-132">Pour modifier la version après avoir cliqué avec le bouton droit sur le projet **VisualObjects**, vous pouvez utiliser l’option **Modifier les versions du manifeste** de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="d239e-132">To make the version changes after you right-click on the **VisualObjects** project, you can use the Visual Studio **Edit Manifest Versions** option.</span></span> <span data-ttu-id="d239e-133">La sélection de cette option affiche la boîte de dialogue des versions d’édition comme suit :</span><span class="sxs-lookup"><span data-stu-id="d239e-133">Selecting this option brings up the dialog box for edition versions as follows:</span></span>

![Boîte de dialogue Contrôle de version][image3]

<span data-ttu-id="d239e-135">Mettez à jour les versions des projets modifiés et leurs packages de code, ainsi que l’application vers la version 2.0.0.</span><span class="sxs-lookup"><span data-stu-id="d239e-135">Update the versions for the modified projects and their code packages, along with the application to version 2.0.0.</span></span> <span data-ttu-id="d239e-136">Une fois les modifications effectuées, le manifeste doit se présenter comme suit (les parties en gras présentent les modifications) :</span><span class="sxs-lookup"><span data-stu-id="d239e-136">After the changes are made, the manifest should look like the following (bold portions show the changes):</span></span>

![Mise à jour des versions][image4]

<span data-ttu-id="d239e-138">Les outils Visual Studio peuvent déployer automatiquement les versions si vous sélectionnez **Mettre à jour automatiquement les versions de l’application et des services**.</span><span class="sxs-lookup"><span data-stu-id="d239e-138">The Visual Studio tools can do automatic rollups of versions upon selecting **Automatically update application and service versions**.</span></span> <span data-ttu-id="d239e-139">Si vous utilisez [SemVer](http://www.semver.org), vous devez mettre à jour le code et/ou la version du package de configuration uniquement si cette option est sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="d239e-139">If you use [SemVer](http://www.semver.org), you need to update the code and/or configuration package version alone if that option is selected.</span></span>

<span data-ttu-id="d239e-140">Enregistrez les modifications et cochez la case **Upgrade the Application** (Mettre à niveau l'application).</span><span class="sxs-lookup"><span data-stu-id="d239e-140">Save the changes, and now check the **Upgrade the Application** box.</span></span>

## <a name="step-3--upgrade-your-application"></a><span data-ttu-id="d239e-141">Étape 3 : Mettre à niveau votre application</span><span class="sxs-lookup"><span data-stu-id="d239e-141">Step 3:  Upgrade your application</span></span>
<span data-ttu-id="d239e-142">Familiarisez-vous avec les [paramètres de mise à niveau d’application](service-fabric-application-upgrade-parameters.md) et le [processus de mise à niveau](service-fabric-application-upgrade.md) pour bien comprendre les différents paramètres de mise à niveau, les délais d’attente et les critères d’intégrité qui peuvent être appliqués.</span><span class="sxs-lookup"><span data-stu-id="d239e-142">Familiarize yourself with the [application upgrade parameters](service-fabric-application-upgrade-parameters.md) and the [upgrade process](service-fabric-application-upgrade.md) to get a good understanding of the various upgrade parameters, time-outs, and health criterion that can be applied.</span></span> <span data-ttu-id="d239e-143">Pour cette procédure pas à pas, le critère d’évaluation de l’intégrité du service est défini sur la valeur par défaut (mode non surveillé).</span><span class="sxs-lookup"><span data-stu-id="d239e-143">For this walkthrough, the service health evaluation criterion is set to the default (unmonitored mode).</span></span> <span data-ttu-id="d239e-144">Vous pouvez configurer ces paramètres en sélectionnant **Configurer les paramètres de mise à niveau** et en les modifiant comme vous le souhaitez.</span><span class="sxs-lookup"><span data-stu-id="d239e-144">You can configure these settings by selecting **Configure Upgrade Settings** and then modifying the parameters as desired.</span></span>

<span data-ttu-id="d239e-145">À présent, nous sommes prêts à démarrer la mise à niveau de l’application en sélectionnant **Publier**.</span><span class="sxs-lookup"><span data-stu-id="d239e-145">Now we are all set to start the application upgrade by selecting **Publish**.</span></span> <span data-ttu-id="d239e-146">Cette option met à niveau votre application vers la version 2.0.0 dans laquelle les objets pivotent.</span><span class="sxs-lookup"><span data-stu-id="d239e-146">This option upgrades your application to version 2.0.0, in which the objects rotate.</span></span> <span data-ttu-id="d239e-147">Service Fabric met à niveau un domaine de mise à jour à la fois (certains objets sont mis à niveau en premier, suivis par d’autres) et le service est accessible pendant la mise à niveau.</span><span class="sxs-lookup"><span data-stu-id="d239e-147">Service Fabric upgrades one update domain at a time (some objects are updated first, followed by others), and the service remains accessible during the upgrade.</span></span> <span data-ttu-id="d239e-148">L’accès au service peut être vérifié par le biais de votre client (navigateur).</span><span class="sxs-lookup"><span data-stu-id="d239e-148">Access to the service can be checked through your client (browser).</span></span>  

<span data-ttu-id="d239e-149">À présent, alors que la mise à niveau de l’application se poursuit, vous pouvez la surveiller à l’aide de Service Fabric Explorer en utilisant l’onglet **Upgrades in Progress** (Mises à niveau en cours) sous les applications.</span><span class="sxs-lookup"><span data-stu-id="d239e-149">Now, as the application upgrade proceeds, you can monitor it with Service Fabric Explorer, by using the **Upgrades in Progress** tab under the applications.</span></span>

<span data-ttu-id="d239e-150">Dans quelques minutes, tous les domaines de mise à jour seront mis à niveau (terminé) et la fenêtre de sortie Visual Studio doit également indiquer que la mise à niveau est terminée.</span><span class="sxs-lookup"><span data-stu-id="d239e-150">In a few minutes, all update domains should be upgraded (completed), and the Visual Studio output window should also state that the upgrade is completed.</span></span> <span data-ttu-id="d239e-151">De plus, vous pouvez normalement noter que *tous* les objets visuels sont désormais en rotation dans la fenêtre de votre navigateur.</span><span class="sxs-lookup"><span data-stu-id="d239e-151">And you should find that *all* the visual objects in your browser window are now rotating!</span></span>

<span data-ttu-id="d239e-152">Vous souhaiterez peut-être essayer de modifier les versions et de passer de la version 2.0.0 à la version 3.0.0 en guise d'exercice, voire même de revenir de la version 2.0.0 à la version 1.0.0.</span><span class="sxs-lookup"><span data-stu-id="d239e-152">You may want to try changing the versions, and moving from version 2.0.0 to version 3.0.0 as an exercise, or even from version 2.0.0 back to version 1.0.0.</span></span> <span data-ttu-id="d239e-153">Amusez-vous avec les délais d'attente et les stratégies de contrôle d'intégrité pour vous familiariser avec ceux-ci.</span><span class="sxs-lookup"><span data-stu-id="d239e-153">Play with time-outs and health policies to make yourself familiar with them.</span></span> <span data-ttu-id="d239e-154">Lors du déploiement sur un cluster Azure par opposition à un cluster local, les paramètres utilisés peuvent être différents.</span><span class="sxs-lookup"><span data-stu-id="d239e-154">When deploying to an Azure cluster as opposed to a local cluster, the parameters used may have to differ.</span></span> <span data-ttu-id="d239e-155">Nous vous recommandons de définir les délais d’attente de manière plus restrictive.</span><span class="sxs-lookup"><span data-stu-id="d239e-155">We recommend that you set the time-outs conservatively.</span></span>

## <a name="next-steps"></a><span data-ttu-id="d239e-156">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="d239e-156">Next steps</span></span>
<span data-ttu-id="d239e-157">[mise à niveau de votre application à l’aide de PowerShell](service-fabric-application-upgrade-tutorial-powershell.md) vous guide à travers une mise à niveau de l’application à l’aide de PowerShell.</span><span class="sxs-lookup"><span data-stu-id="d239e-157">[Upgrading your application using PowerShell](service-fabric-application-upgrade-tutorial-powershell.md) walks you through an application upgrade using PowerShell.</span></span>

<span data-ttu-id="d239e-158">Contrôlez les mises à niveau de votre application à l’aide des [paramètres de mise à niveau](service-fabric-application-upgrade-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="d239e-158">Control how your application is upgraded by using [upgrade parameters](service-fabric-application-upgrade-parameters.md).</span></span>

<span data-ttu-id="d239e-159">Rendez les mises à niveau de votre application compatibles en apprenant à utiliser la [sérialisation des données](service-fabric-application-upgrade-data-serialization.md).</span><span class="sxs-lookup"><span data-stu-id="d239e-159">Make your application upgrades compatible by learning how to use [data serialization](service-fabric-application-upgrade-data-serialization.md).</span></span>

<span data-ttu-id="d239e-160">Apprenez à utiliser les fonctionnalités avancées lors de la mise à niveau de votre application en consultant les [Rubriques avancées](service-fabric-application-upgrade-advanced.md).</span><span class="sxs-lookup"><span data-stu-id="d239e-160">Learn how to use advanced functionality while upgrading your application by referring to [Advanced topics](service-fabric-application-upgrade-advanced.md).</span></span>

<span data-ttu-id="d239e-161">Résolvez les problèmes courants de mise à niveau de l’application en vous reportant aux étapes de [Résolution des problèmes de mise à niveau des applications](service-fabric-application-upgrade-troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="d239e-161">Fix common problems in application upgrades by referring to the steps in [Troubleshooting application upgrades](service-fabric-application-upgrade-troubleshooting.md).</span></span>

[image1]: media/service-fabric-application-upgrade-tutorial/upgrade7.png
[image2]: media/service-fabric-application-upgrade-tutorial/upgrade1.png
[image3]: media/service-fabric-application-upgrade-tutorial/upgrade5.png
[image4]: media/service-fabric-application-upgrade-tutorial/upgrade6.png
