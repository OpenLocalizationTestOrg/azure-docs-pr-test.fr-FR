---
title: "Planification de la capacité du cluster Service Fabric | Microsoft Docs"
description: "Considérations en matière de planification de la capacité du cluster Service Fabric. Types de nœuds, durabilité et niveaux de fiabilité"
services: service-fabric
documentationcenter: .net
author: ChackDan
manager: timlt
editor: 
ms.assetid: 4c584f4a-cb1f-400c-b61f-1f797f11c982
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 07/24/2017
ms.author: chackdan
ms.openlocfilehash: 36b96360fabdcc64ffd2356540c580594637d48e
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/29/2017
---
# <a name="service-fabric-cluster-capacity-planning-considerations"></a><span data-ttu-id="9f910-104">Considérations en matière de planification de la capacité du cluster Service Fabric</span><span class="sxs-lookup"><span data-stu-id="9f910-104">Service Fabric cluster capacity planning considerations</span></span>
<span data-ttu-id="9f910-105">Pour un déploiement de production, la planification de la capacité est une étape importante.</span><span class="sxs-lookup"><span data-stu-id="9f910-105">For any production deployment, capacity planning is an important step.</span></span> <span data-ttu-id="9f910-106">Voici certains éléments que vous devez prendre en compte dans ce processus.</span><span class="sxs-lookup"><span data-stu-id="9f910-106">Here are some of the items that you have to consider as a part of that process.</span></span>

* <span data-ttu-id="9f910-107">Nombre de types de nœuds avec lesquels votre cluster doit démarrer</span><span class="sxs-lookup"><span data-stu-id="9f910-107">The number of node types your cluster needs to start out with</span></span>
* <span data-ttu-id="9f910-108">Propriétés de chaque type de nœud (taille, principal ou non, accessibilité sur Internet, nombre de machines virtuelles, etc.)</span><span class="sxs-lookup"><span data-stu-id="9f910-108">The properties of each of node type (size, primary, internet facing, number of VMs, etc.)</span></span>
* <span data-ttu-id="9f910-109">Caractéristiques de fiabilité et de durabilité du cluster</span><span class="sxs-lookup"><span data-stu-id="9f910-109">The reliability and durability characteristics of the cluster</span></span>

<span data-ttu-id="9f910-110">Nous allons présenter brièvement chacun de ces éléments.</span><span class="sxs-lookup"><span data-stu-id="9f910-110">Let us briefly review each of these items.</span></span>

## <a name="the-number-of-node-types-your-cluster-needs-to-start-out-with"></a><span data-ttu-id="9f910-111">Nombre de types de nœuds avec lesquels votre cluster doit démarrer</span><span class="sxs-lookup"><span data-stu-id="9f910-111">The number of node types your cluster needs to start out with</span></span>
<span data-ttu-id="9f910-112">Tout d’abord, vous devez savoir à quoi va servir le cluster que vous créez et quels sont les types d’applications que vous voulez déployer dans ce cluster.</span><span class="sxs-lookup"><span data-stu-id="9f910-112">First, you need to figure out what the cluster you are creating is going to be used for and what kinds of applications you are planning to deploy into this cluster.</span></span> <span data-ttu-id="9f910-113">Si vous n’êtes pas sûr de ce à quoi va servir le cluster, vous n’êtes probablement pas encore prêt pour le processus de planification de capacité.</span><span class="sxs-lookup"><span data-stu-id="9f910-113">If you are not clear on the purpose of the cluster, you are most likely not yet ready to enter the capacity planning process.</span></span>

<span data-ttu-id="9f910-114">Établissez le nombre de types de nœuds avec lesquels votre cluster doit démarrer.</span><span class="sxs-lookup"><span data-stu-id="9f910-114">Establish the number of node types your cluster needs to start out with.</span></span>  <span data-ttu-id="9f910-115">Chaque type de nœud est mappé à un groupe de machines virtuelles identiques.</span><span class="sxs-lookup"><span data-stu-id="9f910-115">Each node type is mapped to a Virtual Machine Scale Set.</span></span> <span data-ttu-id="9f910-116">Chaque type de nœud peut ensuite faire l’objet d’une montée ou descente en puissance de manière indépendante, avoir différents jeux de ports ouverts et présenter différentes métriques de capacité.</span><span class="sxs-lookup"><span data-stu-id="9f910-116">Each node type can then be scaled up or down independently, have different sets of ports open, and can have different capacity metrics.</span></span> <span data-ttu-id="9f910-117">Par conséquent, pour savoir combien de types de nœud vous avez besoin, vous devez vous poser les questions suivantes :</span><span class="sxs-lookup"><span data-stu-id="9f910-117">So the decision of the number of node types essentially comes down to the following considerations:</span></span>

* <span data-ttu-id="9f910-118">Votre application inclut-elle plusieurs services ? Si oui, ces services doivent-ils être publics ou accessibles sur Internet ?</span><span class="sxs-lookup"><span data-stu-id="9f910-118">Does your application have multiple services, and do any of them need to be public or internet facing?</span></span> <span data-ttu-id="9f910-119">Les applications standard contiennent un service de passerelle frontale qui reçoit des entrées d’un client, et un ou plusieurs services principaux qui communiquent avec les services frontaux.</span><span class="sxs-lookup"><span data-stu-id="9f910-119">Typical applications contain a front-end gateway service that receives input from a client, and one or more back-end services that communicate with the front-end services.</span></span> <span data-ttu-id="9f910-120">Par conséquent, dans ce cas, vous avez besoin d’au moins deux types de nœuds.</span><span class="sxs-lookup"><span data-stu-id="9f910-120">So in this case, you end up having at least two node types.</span></span>
* <span data-ttu-id="9f910-121">Vos services (qui composent votre application) ont-ils des besoins d’infrastructure différents tels qu’une RAM plus volumineuse ou des cycles processeur plus élevés ?</span><span class="sxs-lookup"><span data-stu-id="9f910-121">Do your services (that make up your application) have different infrastructure needs such as greater RAM or higher CPU cycles?</span></span> <span data-ttu-id="9f910-122">Supposons, par exemple, que l’application que vous voulez déployer contient un service frontal et un service principal.</span><span class="sxs-lookup"><span data-stu-id="9f910-122">For example, let us assume that the application that you want to deploy contains a front-end service and a back-end service.</span></span> <span data-ttu-id="9f910-123">Le service frontal peut s’exécuter sur des machines virtuelles plus petites (par exemple, de taille D2) ayant des ports ouverts sur Internet.</span><span class="sxs-lookup"><span data-stu-id="9f910-123">The front-end service can run on smaller VMs (VM sizes like D2) that have ports open to the internet.</span></span>  <span data-ttu-id="9f910-124">Toutefois, le service principal est gourmand en calculs et doit s’exécuter sur des machines virtuelles plus grandes (par exemple, de taille D4, D6, D15) qui ne sont pas connectées à Internet.</span><span class="sxs-lookup"><span data-stu-id="9f910-124">The back-end service, however, is computation intensive and needs to run on larger VMs (with VM sizes like D4, D6, D15) that are not internet facing.</span></span>
  
  <span data-ttu-id="9f910-125">Dans cet exemple, même si vous pouvez décider de placer tous les services sur un seul type de nœud, nous vous recommandons de les placer dans un cluster avec deux types de nœuds.</span><span class="sxs-lookup"><span data-stu-id="9f910-125">In this example, although you can decide to put all the services on one node type, we recommended that you place them in a cluster with two node types.</span></span>  <span data-ttu-id="9f910-126">Ainsi, chaque type de nœud a des propriétés distinctes telles que la connectivité Internet ou la taille de machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="9f910-126">This allows for each node type to have distinct properties such as internet connectivity or VM size.</span></span> <span data-ttu-id="9f910-127">Le nombre de machines virtuelles peut être mis à l’échelle indépendamment, également.</span><span class="sxs-lookup"><span data-stu-id="9f910-127">The number of VMs can be scaled independently, as well.</span></span>  
* <span data-ttu-id="9f910-128">Étant donné que vous ne pouvez pas prédire l’avenir, prenez les informations que vous connaissez et choisissez le nombre de types de nœuds dont vos applications ont besoin pour démarrer.</span><span class="sxs-lookup"><span data-stu-id="9f910-128">Since you cannot predict the future, go with facts you know of and decide on the number of node types that your applications need to start with.</span></span> <span data-ttu-id="9f910-129">Vous pourrez toujours ajouter ou supprimer des types de nœuds ultérieurement.</span><span class="sxs-lookup"><span data-stu-id="9f910-129">You can always add or remove node types later.</span></span> <span data-ttu-id="9f910-130">Un cluster Service Fabric doit comprendre au moins un type de nœud.</span><span class="sxs-lookup"><span data-stu-id="9f910-130">A Service Fabric cluster must have at least one node type.</span></span>

## <a name="the-properties-of-each-node-type"></a><span data-ttu-id="9f910-131">Propriétés de chaque type de nœud</span><span class="sxs-lookup"><span data-stu-id="9f910-131">The properties of each node type</span></span>
<span data-ttu-id="9f910-132">Le **type de nœud** peut être considéré comme l’équivalent des rôles dans Cloud Services.</span><span class="sxs-lookup"><span data-stu-id="9f910-132">The **node type** can be seen as equivalent to roles in Cloud Services.</span></span> <span data-ttu-id="9f910-133">Les types de nœuds définissent les tailles de machine virtuelle, le nombre de machines virtuelles et leurs propriétés.</span><span class="sxs-lookup"><span data-stu-id="9f910-133">Node types define the VM sizes, the number of VMs, and their properties.</span></span> <span data-ttu-id="9f910-134">Chaque type de nœud qui est défini dans un cluster Service Fabric est configuré en tant que groupe de machines virtuelles identiques distinct.</span><span class="sxs-lookup"><span data-stu-id="9f910-134">Every node type that is defined in a Service Fabric cluster is set up as a separate virtual machine scale set.</span></span> <span data-ttu-id="9f910-135">Les groupes de machines virtuelles identiques sont des ressources de calcul Azure que vous pouvez utiliser pour déployer et gérer une collection de machines virtuelles en tant que groupe.</span><span class="sxs-lookup"><span data-stu-id="9f910-135">Virtual machine scale set is an Azure compute resource you can use to deploy and manage a collection of virtual machines as a set.</span></span> <span data-ttu-id="9f910-136">Chaque type de nœud est défini comme un groupe de machines virtuelles identiques distinct et peut faire l’objet d’une montée ou descente en puissance de manière indépendante, avoir différents jeux de ports ouverts et présenter différentes métriques de capacité.</span><span class="sxs-lookup"><span data-stu-id="9f910-136">Being defined as distinct virtual machine scale set, each node type can then be scaled up or down independently, have different sets of ports open, and can have different capacity metrics.</span></span>

<span data-ttu-id="9f910-137">Lisez [ce document](service-fabric-cluster-nodetypes.md) pour plus d’informations sur la relation entre les types de nœuds et les groupes de machines virtuelles identiques, et pour découvrir comment ouvrir une session RDP sur l’une des instances, ouvrir de nouveaux ports, etc.</span><span class="sxs-lookup"><span data-stu-id="9f910-137">Read [this document](service-fabric-cluster-nodetypes.md) for more details on the relationship of Nodetypes to virtual machine scale set, how to RDP into one of the instances, open new ports etc.</span></span>

<span data-ttu-id="9f910-138">Votre cluster peut avoir plusieurs types de nœuds, mais le type de nœud principal (le premier que vous définissez dans le portail) doit avoir au moins cinq machines virtuelles pour les clusters utilisés pour les charges de travail de production (ou au moins trois machines virtuelles pour les clusters de test).</span><span class="sxs-lookup"><span data-stu-id="9f910-138">Your cluster can have more than one node type, but the primary node type (the first one that you define on the portal) must have at least five VMs for clusters used for production workloads (or at least three VMs for test clusters).</span></span> <span data-ttu-id="9f910-139">Si vous créez le cluster à l’aide d’un modèle Resource Manager, recherchez l’attribut **is Primary** sous la définition du type de nœud.</span><span class="sxs-lookup"><span data-stu-id="9f910-139">If you are creating the cluster using a Resource Manager template, then look for **is Primary** attribute under the node type definition.</span></span> <span data-ttu-id="9f910-140">Le type de nœud principal est le type de nœud où sont placés les services système de Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="9f910-140">The primary node type is the node type where Service Fabric system services are placed.</span></span>  

### <a name="primary-node-type"></a><span data-ttu-id="9f910-141">Type de nœud principal</span><span class="sxs-lookup"><span data-stu-id="9f910-141">Primary node type</span></span>
<span data-ttu-id="9f910-142">Pour un cluster avec plusieurs types de nœuds, vous devez définir l’un d’eux comme nœud principal.</span><span class="sxs-lookup"><span data-stu-id="9f910-142">For a cluster with multiple node types, you need to choose one of them to be primary.</span></span> <span data-ttu-id="9f910-143">Voici les caractéristiques d’un type de nœud principal :</span><span class="sxs-lookup"><span data-stu-id="9f910-143">Here are the characteristics of a primary node type:</span></span>

* <span data-ttu-id="9f910-144">La **taille minimale des machines virtuelles** pour le type de nœud principal est déterminée par le **niveau de durabilité** que vous choisissez.</span><span class="sxs-lookup"><span data-stu-id="9f910-144">The **minimum size of VMs** for the primary node type is determined by the **durability tier** you choose.</span></span> <span data-ttu-id="9f910-145">La valeur par défaut du niveau de durabilité est Bronze.</span><span class="sxs-lookup"><span data-stu-id="9f910-145">The default for the durability tier is Bronze.</span></span> <span data-ttu-id="9f910-146">Faites défiler vers le bas pour plus d’informations sur le niveau de durabilité et sur les valeurs qu’il peut prendre.</span><span class="sxs-lookup"><span data-stu-id="9f910-146">Scroll down for details on what the durability tier is and the values it can take.</span></span>  
* <span data-ttu-id="9f910-147">Le **nombre minimal de machines virtuelles** pour le type de nœud principal est déterminé par le **niveau de fiabilité** que vous choisissez.</span><span class="sxs-lookup"><span data-stu-id="9f910-147">The **minimum number of VMs** for the primary node type is determined by the **reliability tier** you choose.</span></span> <span data-ttu-id="9f910-148">La valeur par défaut du niveau de fiabilité est Silver.</span><span class="sxs-lookup"><span data-stu-id="9f910-148">The default for the reliability tier is Silver.</span></span> <span data-ttu-id="9f910-149">Faites défiler vers le bas pour plus d’informations sur le niveau de fiabilité et sur les valeurs qu’il peut prendre.</span><span class="sxs-lookup"><span data-stu-id="9f910-149">Scroll down for details on what the reliability tier is and the values it can take.</span></span> 


* <span data-ttu-id="9f910-150">Les services système de Service Fabric (par exemple, le service Gestionnaire de cluster ou le service Magasin d’images) sont placés sur le type de nœud principal et, par conséquent, la fiabilité et la durabilité du cluster sont déterminées par les valeurs de niveau correspondantes sélectionnées pour le type de nœud principal.</span><span class="sxs-lookup"><span data-stu-id="9f910-150">The Service Fabric system services (for example, the Cluster Manager service or Image Store service) are placed on the primary node type and so the reliability and durability of the cluster is determined by the reliability tier value and durability tier value you select for the primary node type.</span></span>

![<span data-ttu-id="9f910-151">Capture d’écran d’un cluster qui a deux types de nœuds</span><span class="sxs-lookup"><span data-stu-id="9f910-151">Screen shot of a cluster that has two Node Types</span></span> ][SystemServices]

### <a name="non-primary-node-type"></a><span data-ttu-id="9f910-152">Type de nœud non principal</span><span class="sxs-lookup"><span data-stu-id="9f910-152">Non-primary node type</span></span>
<span data-ttu-id="9f910-153">Un cluster avec plusieurs types de nœud comprend un type de nœud principal et les autres types de nœud.</span><span class="sxs-lookup"><span data-stu-id="9f910-153">For a cluster with multiple node types, there is one primary node type and the rest of them are non-primary.</span></span> <span data-ttu-id="9f910-154">Voici les caractéristiques d’un type de nœud non principal :</span><span class="sxs-lookup"><span data-stu-id="9f910-154">Here are the characteristics of a non-primary node type:</span></span>

* <span data-ttu-id="9f910-155">La taille minimale des machines virtuelles pour ce type de nœud est déterminée par le niveau de durabilité que vous choisissez.</span><span class="sxs-lookup"><span data-stu-id="9f910-155">The minimum size of VMs for this node type is determined by the durability tier you choose.</span></span> <span data-ttu-id="9f910-156">La valeur par défaut du niveau de durabilité est Bronze.</span><span class="sxs-lookup"><span data-stu-id="9f910-156">The default for the durability tier is Bronze.</span></span> <span data-ttu-id="9f910-157">Faites défiler vers le bas pour plus d’informations sur le niveau de durabilité et sur les valeurs qu’il peut prendre.</span><span class="sxs-lookup"><span data-stu-id="9f910-157">Scroll down for details on what the durability tier is and the values it can take.</span></span>  
* <span data-ttu-id="9f910-158">Le nombre minimal de machines virtuelles pour ce type de nœud peut être un seul.</span><span class="sxs-lookup"><span data-stu-id="9f910-158">The minimum number of VMs for this node type can be one.</span></span> <span data-ttu-id="9f910-159">Toutefois, vous devez choisir ce nombre en fonction du nombre de réplicas des applications/services que vous voulez exécuter dans ce type de nœud.</span><span class="sxs-lookup"><span data-stu-id="9f910-159">However you should choose this number based on the number of replicas of the application/services that you would like to run in this node type.</span></span> <span data-ttu-id="9f910-160">Le nombre de machines virtuelles dans un type de nœud peut être augmenté une fois le cluster déployé.</span><span class="sxs-lookup"><span data-stu-id="9f910-160">The number of VMs in a node type can be increased after you have deployed the cluster.</span></span>

## <a name="the-durability-characteristics-of-the-cluster"></a><span data-ttu-id="9f910-161">Caractéristiques de durabilité du cluster</span><span class="sxs-lookup"><span data-stu-id="9f910-161">The durability characteristics of the cluster</span></span>
<span data-ttu-id="9f910-162">Le niveau de durabilité est utilisé pour indiquer au système les privilèges dont disposent vos machines virtuelles avec l’infrastructure Azure sous-jacente.</span><span class="sxs-lookup"><span data-stu-id="9f910-162">The durability tier is used to indicate to the system the privileges that your VMs have with the underlying Azure infrastructure.</span></span> <span data-ttu-id="9f910-163">Dans le type de nœud principal, ce privilège permet à Service Fabric de suspendre toute demande de l’infrastructure au niveau de la machine virtuelle (par exemple, un redémarrage de la machine virtuelle, une réinitialisation de la machine virtuelle ou une migration de machine virtuelle) qui influe sur la configuration requise du quorum pour les services système et vos services avec état.</span><span class="sxs-lookup"><span data-stu-id="9f910-163">In the primary node type, this privilege allows Service Fabric to pause any VM level infrastructure request (such as a VM reboot, VM reimage, or VM migration) that impact the quorum requirements for the system services and your stateful services.</span></span> <span data-ttu-id="9f910-164">Dans les types de nœuds non principaux, ce privilège permet à Service Fabric de suspendre toute demande de l’infrastructure au niveau de la machine virtuelle (par exemple, le redémarrage de la machine virtuelle, la réinitialisation de la machine virtuelle, la migration de machine virtuelle, etc.) qui influe sur la configuration requise du quorum pour vos services avec état qui s’y exécutent.</span><span class="sxs-lookup"><span data-stu-id="9f910-164">In the non-primary node types, this privilege allows Service Fabric to pause any VM level infrastructure requests like VM reboot, VM reimage, VM migration etc., that impact the quorum requirements for your stateful services running in it.</span></span>

<span data-ttu-id="9f910-165">Ce privilège est exprimé dans les valeurs suivantes :</span><span class="sxs-lookup"><span data-stu-id="9f910-165">This privilege is expressed in the following values:</span></span>

* <span data-ttu-id="9f910-166">Gold : les travaux d’infrastructure peuvent être suspendus pendant deux heures UD.</span><span class="sxs-lookup"><span data-stu-id="9f910-166">Gold - The infrastructure Jobs can be paused for a duration of two hours per UD.</span></span> <span data-ttu-id="9f910-167">La durabilité Gold ne peut être activée que sur les références de machine virtuelle à nœud complet comme D15_V2, G5, etc.</span><span class="sxs-lookup"><span data-stu-id="9f910-167">Gold durability can be enabled only on full node VM skus like D15_V2, G5 etc.</span></span>
* <span data-ttu-id="9f910-168">Silver : les travaux d’infrastructure peuvent être suspendus pendant 10 minutes par UD, et ce privilège est disponible sur toutes les machines virtuelles standard à cœur unique et versions supérieures.</span><span class="sxs-lookup"><span data-stu-id="9f910-168">Silver - The infrastructure Jobs can be paused for a duration of 10 minutes per UD and is available on all standard VMs of single core and above.</span></span>
* <span data-ttu-id="9f910-169">Bronze : Aucun privilège.</span><span class="sxs-lookup"><span data-stu-id="9f910-169">Bronze - No privileges.</span></span> <span data-ttu-id="9f910-170">Il s’agit de la valeur par défaut.</span><span class="sxs-lookup"><span data-stu-id="9f910-170">This is the default.</span></span> <span data-ttu-id="9f910-171">Réservez ce niveau de durabilité aux types de nœud qui peuvent exécuter _seulement_ des charges de travail sans état.</span><span class="sxs-lookup"><span data-stu-id="9f910-171">Only use this durability level for Node Types that run _only_ stateless workloads.</span></span> 

> [!WARNING]
> <span data-ttu-id="9f910-172">Les types de nœud s’exécutant avec un niveau de durabilité Bronze n’obtiennent _aucun privilège_.</span><span class="sxs-lookup"><span data-stu-id="9f910-172">NodeTypes running with Bronze durability obtain _no privileges_.</span></span> <span data-ttu-id="9f910-173">Cela signifie que les travaux d’infrastructure qui affectent vos charges de travail sans état ne seront ni arrêtés ni différés.</span><span class="sxs-lookup"><span data-stu-id="9f910-173">This means that infrastructure jobs that impact your stateless workloads will not be stopped or delayed.</span></span> <span data-ttu-id="9f910-174">Il est possible que ces travaux continuent d’affecter vos charges de travail, entraînant ainsi des temps d’arrêt ou d’autres problèmes.</span><span class="sxs-lookup"><span data-stu-id="9f910-174">It is possible that such jobs can still impact your workloads, causing downtime or other issues.</span></span> <span data-ttu-id="9f910-175">Pour tout type de charge de travail de production, il est recommandé d’opter pour une exécution avec au moins le niveau Silver.</span><span class="sxs-lookup"><span data-stu-id="9f910-175">For any sort of production workload, running with at least Silver is recommended.</span></span> 
> 

<span data-ttu-id="9f910-176">Vous devez choisir un niveau de durabilité pour chacun de vos types de nœuds. Vous pouvez choisir le niveau de durabilité Gold ou Silver pour un type de nœud, et le niveau Bronze pour l’autre type de nœud au sein du même cluster. **Vous devez conserver un minimum de 5 nœuds pour tout type de nœud avec une durabilité Gold ou Silver**.</span><span class="sxs-lookup"><span data-stu-id="9f910-176">You get to choose durability level for each of your node-types.You can choose one node-type to have a durability level of Gold or silver and the other have Bronze in the same cluster.**You must maintain a minimum count of 5 nodes for any node-type that has a durability of Gold or silver**.</span></span> 

<span data-ttu-id="9f910-177">**Avantages de l’utilisation des niveaux de durabilité Silver ou Gold**</span><span class="sxs-lookup"><span data-stu-id="9f910-177">**Advantages of using Silver or Gold durability levels**</span></span>
 
1. <span data-ttu-id="9f910-178">Réduit le nombre d’étapes requises dans une opération de diminution de la taille des instances (par exemple, les étapes de désactivation du nœud et Remove-ServiceFabricNodeState sont appelées automatiquement).</span><span class="sxs-lookup"><span data-stu-id="9f910-178">Reduces the number of required steps in a scale-in operation (that is, node deactivation and Remove-ServiceFabricNodeState is called automatically)</span></span>
2. <span data-ttu-id="9f910-179">Réduit le risque de perte de données résultant d’une opération de changement de référence (SKU) de machine virtuelle initiée par l’utilisateur, ou d’opérations de l’infrastructure Azure.</span><span class="sxs-lookup"><span data-stu-id="9f910-179">Reduces the risk of data loss due to a customer-initiated in-place VM SKU change operation or Azure infrastructure operations.</span></span>
     
<span data-ttu-id="9f910-180">**Inconvénients de l’utilisation des niveaux de durabilité Silver ou Gold**</span><span class="sxs-lookup"><span data-stu-id="9f910-180">**Disadvantages of using Silver or Gold durability levels**</span></span>
 
1. <span data-ttu-id="9f910-181">Des déploiements vers vos groupes de machines virtuelles identiques et d’autres ressources Azure associées peuvent être retardés, dépasser le délai d’attente, ou être entièrement bloqués par des problèmes au sein de votre cluster ou au niveau de l’infrastructure.</span><span class="sxs-lookup"><span data-stu-id="9f910-181">Deployments to your Virtual Machine Scale Set and other related Azure resources) can be delayed, can time out, or can be blocked entirely by problems in your cluster or at the infrastructure level.</span></span> 
2. <span data-ttu-id="9f910-182">Augmente le nombre d’[événements du cycle de vie d’un réplica](service-fabric-reliable-services-advanced-usage.md#stateful-service-replica-lifecycle ) (par exemple, les permutations principales) en raison de l’automatisation des désactivations de nœud durant les opérations de l’infrastructure Azure.</span><span class="sxs-lookup"><span data-stu-id="9f910-182">Increases the number of [replica lifecycle events](service-fabric-reliable-services-advanced-usage.md#stateful-service-replica-lifecycle ) (for example, primary swaps) due to automated node deactivations during Azure infrastructure operations.</span></span>

### <a name="recommendations-on-when-to-use-silver-or-gold-durability-levels"></a><span data-ttu-id="9f910-183">Recommandations relatives au moment opportun pour utiliser les niveaux de durabilité Silver ou Gold</span><span class="sxs-lookup"><span data-stu-id="9f910-183">Recommendations on when to use Silver or Gold durability levels</span></span>

<span data-ttu-id="9f910-184">Utilisez les niveaux de durabilité Silver ou Gold pour tous les types de nœuds qui hébergent des services avec état dont vous prévoyez une diminution fréquente de la taille des instances (réduction du nombre d’instances de machine virtuelle), si vous préférez que les opérations de déploiement soient retardées au profit d’une simplification de ces opérations de diminution de la taille des instances.</span><span class="sxs-lookup"><span data-stu-id="9f910-184">Use Silver or Gold durability for all node types that host stateful services you expect to scale-in (reduce VM instance count) frequently, and you would prefer that deployment operations be delayed in favor of simplifying these scale-in operations.</span></span> <span data-ttu-id="9f910-185">Les scénarios d’augmentation de la taille des instances (ajout d’instances de machine virtuelle) n’ayant aucune incidence sur le choix du niveau de durabilité, seuls les scénarios de diminution de la taille des instances doivent être pris en considération.</span><span class="sxs-lookup"><span data-stu-id="9f910-185">The scale-out scenarios (adding VMs instances) do not play into your choice of the durability tier, only scale-in does.</span></span>

### <a name="operational-recommendations-for-the-node-type-that-you-have-set-to-silver-or-gold-durability-level"></a><span data-ttu-id="9f910-186">Recommandations opérationnelles concernant le type de nœud que vous avez défini sur le niveau de durabilité Silver ou Gold</span><span class="sxs-lookup"><span data-stu-id="9f910-186">Operational Recommendations for the node type that you have set to silver or gold durability level.</span></span>

1. <span data-ttu-id="9f910-187">Veillez à la permanence de l’intégrité de votre cluster et de vos applications, et assurez-vous que les applications répondent à tous les [événements de cycle de vie de réplica de service](service-fabric-reliable-services-advanced-usage.md#stateful-service-replica-lifecycle) (par exemple, le blocage de la création d’un réplica) en temps opportun.</span><span class="sxs-lookup"><span data-stu-id="9f910-187">Keep your cluster and applications healthy at all times, and make sure that applications respond to all [Service replica lifecycle events](service-fabric-reliable-services-advanced-usage.md#stateful-service-replica-lifecycle) (like replica in build is stuck) in a timely fashion.</span></span>
2. <span data-ttu-id="9f910-188">Adoptez des méthodes plus sûres pour modifier les références SKU de machine virtuelle (montée/descente en puissance) : la modification de la référence SKU de machine virtuelle pour un groupe de machines virtuelles identiques est une opération risquée et doit donc être évitée si possible.</span><span class="sxs-lookup"><span data-stu-id="9f910-188">Adopt safer ways to make a VM SKU change (Scale up/down): Changing the VM SKU of a Virtual Machine Scale Set is inherently an unsafe operation and so should be avoided if possible.</span></span> <span data-ttu-id="9f910-189">Voici la procédure à suivre pour éviter les problèmes les plus courants.</span><span class="sxs-lookup"><span data-stu-id="9f910-189">Here is the process you can follow to avoid common issues.</span></span>
    - <span data-ttu-id="9f910-190">**Pour les types de nœuds non principaux :** il est recommandé de créer un groupe de machines virtuelles identiques, de modifier la contrainte de positionnement de service pour inclure le nouveau groupe de machines virtuelles identiques/type de nœud, puis de réduire le nombre d’instances du groupe de machines virtuelles identiques à 0, un nœud à la fois pour être certain que la suppression des nœuds n’affecte pas la fiabilité du cluster.</span><span class="sxs-lookup"><span data-stu-id="9f910-190">**For non-primary nodetypes:** It is recommended that you create new Virtual Machine Scale Set, modify the service placement constraint to include the new Virtual Machine Scale Set/node type and then reduce the old Virtual Machine Scale Set instance count to 0, one node at a time (this is to make sure that removal of the nodes do not impact the reliability of the cluster).</span></span>
    - <span data-ttu-id="9f910-191">**Pour le type de nœud principal :** notre recommandation est de ne pas modifier la référence SKU de machine virtuelle du type de nœud principal.</span><span class="sxs-lookup"><span data-stu-id="9f910-191">**For the primary nodetype:** Our recommendation is that you do not change VM SKU of the primary node type.</span></span> <span data-ttu-id="9f910-192">Si la raison de la nouvelle référence (SKU) est la capacité, nous recommandons d’ajouter des instances ou, si possible, de créer un cluster.</span><span class="sxs-lookup"><span data-stu-id="9f910-192">If the reason for the new SKU is capacity, we recommend adding more instances or if possible, create a new cluster.</span></span> <span data-ttu-id="9f910-193">Si vous n’avez pas le choix, apportez les modifications à la définition du modèle de groupe de machines virtuelles identiques afin de refléter la nouvelle référence SKU.</span><span class="sxs-lookup"><span data-stu-id="9f910-193">If you have no choice, then make modifications to the Virtual Machine Scale Set Model definition to reflect the new SKU.</span></span> <span data-ttu-id="9f910-194">Si votre cluster n’a qu’un seul type de nœud, assurez-vous que toutes les applications avec état répondent à tous les [événements de cycle de vie de réplica de service](service-fabric-reliable-services-advanced-usage.md#stateful-service-replica-lifecycle) (par exemple, le blocage de la création d’un réplica) en temps opportun, et que la durée de recréation du réplica de service est inférieure à cinq minutes (pour le niveau de durabilité Silver).</span><span class="sxs-lookup"><span data-stu-id="9f910-194">If your cluster has only one nodetype, then make sure that all your stateful applications respond to all [Service replica lifecycle events](service-fabric-reliable-services-advanced-usage.md#stateful-service-replica-lifecycle) (like replica in build is stuck) in a timely fashion and that your service replica rebuild duration is less than five minutes (for Silver durability level).</span></span> 


> [!WARNING]
> <span data-ttu-id="9f910-195">Il est déconseillé de modifier la taille de référence (SKU) des machines virtuelles pour les VM Scale Sets qui n’exécutent pas au moins le niveau de durabilité Silver.</span><span class="sxs-lookup"><span data-stu-id="9f910-195">Changing the VM SKU Size for VM Scale Sets not running at least Silver durability is not recommened.</span></span> <span data-ttu-id="9f910-196">Modifier la taille de référence (SKU) des machines virtuelles est une opération d’infrastructure sur place destructrice de données.</span><span class="sxs-lookup"><span data-stu-id="9f910-196">Changing VM SKU Size is a data-destructive in-place infrastructure operation.</span></span> <span data-ttu-id="9f910-197">Faute de pouvoir ne serait-ce que retarder ou surveiller cette modification, il est possible que l’opération occasionne une perte de données pour les services avec état ou provoque d’autres problèmes opérationnels imprévus, même pour les charges de travail sans état.</span><span class="sxs-lookup"><span data-stu-id="9f910-197">Without at least some ability to delay or monitor this change, it is possible that the operation can cause dataloss for stateful services or cause other unforseen operational issues, even for stateless workloads.</span></span> 
> 
    
3. <span data-ttu-id="9f910-198">Conservez au minimum cinq nœuds pour tout groupe de machines virtuelles identiques sur lequel MR est activé.</span><span class="sxs-lookup"><span data-stu-id="9f910-198">Maintain a minimum count of five nodes for any Virtual Machine Scale Set that has MR enabled</span></span>
4. <span data-ttu-id="9f910-199">Ne supprimez pas d’instances de machine virtuelle aléatoires. Opérez toujours une descente en puissance du groupe de machines virtuelles identiques.</span><span class="sxs-lookup"><span data-stu-id="9f910-199">Do not delete random VM instances, always use Virtual Machine Scale Set scale down feature.</span></span> <span data-ttu-id="9f910-200">La suppression d’instances de machine virtuelle aléatoires risque de créer des déséquilibres au sein de l’instance de machine virtuelle répartie sur UD et FD.</span><span class="sxs-lookup"><span data-stu-id="9f910-200">The deletion of random VM instances has a potential of creating imbalances in the VM instance spread across UD and FD.</span></span> <span data-ttu-id="9f910-201">Ce déséquilibre peut nuire à la capacité du système à équilibrer correctement la charge entre les instances de service/réplicas de service.</span><span class="sxs-lookup"><span data-stu-id="9f910-201">This imbalance could adversely affect the systems ability to properly load balance amongst the service instances/Service replicas.</span></span>
6. <span data-ttu-id="9f910-202">Si vous utilisez la fonctionnalité Mise à l’échelle automatique, définissez les règles de façon à ce que la diminution de la taille des instances (suppression d’instances de machine virtuelle) soit effectuée nœud après nœud.</span><span class="sxs-lookup"><span data-stu-id="9f910-202">If using Autoscale, then set the rules such that scale in (removing of VM instances) are done only one node at a time.</span></span> <span data-ttu-id="9f910-203">La descente en puissance de plusieurs instances en même temps présente des risques.</span><span class="sxs-lookup"><span data-stu-id="9f910-203">Scaling down more than one instance at a time is not safe.</span></span>
7. <span data-ttu-id="9f910-204">Pour la descente en puissance d’un type de nœud principal, vous ne devez jamais aller en dessous du niveau de fiabilité.</span><span class="sxs-lookup"><span data-stu-id="9f910-204">If Scaling down a primary node type, you should never scale it down more than what the reliability tier allows.</span></span>


## <a name="the-reliability-characteristics-of-the-cluster"></a><span data-ttu-id="9f910-205">Caractéristiques de fiabilité du cluster</span><span class="sxs-lookup"><span data-stu-id="9f910-205">The reliability characteristics of the cluster</span></span>
<span data-ttu-id="9f910-206">Le niveau de fiabilité est utilisé pour définir le nombre de réplicas des services système que vous voulez exécuter dans ce cluster sur le type de nœud principal.</span><span class="sxs-lookup"><span data-stu-id="9f910-206">The reliability tier is used to set the number of replicas of the system services that you want to run in this cluster on the primary node type.</span></span> <span data-ttu-id="9f910-207">Plus le nombre de réplicas est important, plus les services système sont fiables dans votre cluster.</span><span class="sxs-lookup"><span data-stu-id="9f910-207">The more the number of replicas, the more reliable the system services are in your cluster.</span></span>  

<span data-ttu-id="9f910-208">Le niveau de fiabilité peut avoir les valeurs suivantes :</span><span class="sxs-lookup"><span data-stu-id="9f910-208">The reliability tier can take the following values:</span></span>

* <span data-ttu-id="9f910-209">Platinum : Exécutez les services système avec un nombre de jeux de réplicas cible égal à 9</span><span class="sxs-lookup"><span data-stu-id="9f910-209">Platinum - Run the System services with a target replica set count of 9</span></span>
* <span data-ttu-id="9f910-210">Gold : Exécutez les services système avec un nombre de jeux de réplicas cible égal à 7</span><span class="sxs-lookup"><span data-stu-id="9f910-210">Gold - Run the System services with a target replica set count of 7</span></span>
* <span data-ttu-id="9f910-211">Silver : Exécutez les services système avec un nombre de jeux de réplicas cible égal à 5</span><span class="sxs-lookup"><span data-stu-id="9f910-211">Silver - Run the System services with a target replica set count of 5</span></span> 
* <span data-ttu-id="9f910-212">Bronze : Exécutez les services système avec un nombre de jeux de réplicas cible égal à 3</span><span class="sxs-lookup"><span data-stu-id="9f910-212">Bronze - Run the System services with a target replica set count of 3</span></span>

> [!NOTE]
> <span data-ttu-id="9f910-213">Le niveau de fiabilité que vous choisissez détermine le nombre minimal de nœuds que doit contenir votre type de nœud principal.</span><span class="sxs-lookup"><span data-stu-id="9f910-213">The reliability tier you choose determines the minimum number of nodes your primary node type must have.</span></span> 
> 
> 


### <a name="recommendations-for-the-reliability-tier"></a><span data-ttu-id="9f910-214">Recommandations pour le niveau de fiabilité.</span><span class="sxs-lookup"><span data-stu-id="9f910-214">Recommendations for the reliability tier.</span></span>

 <span data-ttu-id="9f910-215">Lorsque vous augmentez ou réduisez la taille de votre cluster (la somme des instances de machine virtuelle dans tous les types de nœuds), vous devez mettre à jour la fiabilité de votre cluster d’un niveau à l’autre.</span><span class="sxs-lookup"><span data-stu-id="9f910-215">When you increase or decrease the size of your cluster (the sum of VM instances in all node types), you must update the reliability of your cluster from one tier to another.</span></span> <span data-ttu-id="9f910-216">Cette opération déclenche les mises à niveau de cluster nécessaires pour modifier le nombre de jeux de réplicas des services système.</span><span class="sxs-lookup"><span data-stu-id="9f910-216">Doing this triggers the cluster upgrades needed to change the system services replica set count.</span></span> <span data-ttu-id="9f910-217">Attendez que la mise à niveau en cours se termine avant d’apporter d’autres modifications au cluster, comme l’ajout de nœuds.</span><span class="sxs-lookup"><span data-stu-id="9f910-217">Wait for the upgrade in progress to complete before making any other changes to the cluster, like adding nodes.</span></span>  <span data-ttu-id="9f910-218">Vous pouvez surveiller la progression de la mise à niveau avec Service Fabric Explorer ou en exécutant [Get-ServiceFabricClusterUpgrade](/powershell/module/servicefabric/get-servicefabricclusterupgrade?view=azureservicefabricps)</span><span class="sxs-lookup"><span data-stu-id="9f910-218">You can monitor the progress of the upgrade on Service Fabric Explorer or by running [Get-ServiceFabricClusterUpgrade](/powershell/module/servicefabric/get-servicefabricclusterupgrade?view=azureservicefabricps)</span></span>

<span data-ttu-id="9f910-219">Voici la recommandation sur le choix du niveau de fiabilité.</span><span class="sxs-lookup"><span data-stu-id="9f910-219">Here is the recommendation on choosing the reliability tier.</span></span>

| <span data-ttu-id="9f910-220">**Taille du cluster**</span><span class="sxs-lookup"><span data-stu-id="9f910-220">**Cluster Size**</span></span> | <span data-ttu-id="9f910-221">**Niveau de fiabilité**</span><span class="sxs-lookup"><span data-stu-id="9f910-221">**Reliability Tier**</span></span> |
| --- | --- |
| <span data-ttu-id="9f910-222">1</span><span class="sxs-lookup"><span data-stu-id="9f910-222">1</span></span> |<span data-ttu-id="9f910-223">Ne spécifiez pas le paramètre de niveau de fiabilité. Le système le calcule.</span><span class="sxs-lookup"><span data-stu-id="9f910-223">Do not specify the Reliability Tier parameter, the system calculates it</span></span> |
| <span data-ttu-id="9f910-224">3</span><span class="sxs-lookup"><span data-stu-id="9f910-224">3</span></span> |<span data-ttu-id="9f910-225">Bronze</span><span class="sxs-lookup"><span data-stu-id="9f910-225">Bronze</span></span> |
| <span data-ttu-id="9f910-226">5 ou 6</span><span class="sxs-lookup"><span data-stu-id="9f910-226">5 or 6</span></span>|<span data-ttu-id="9f910-227">Silver</span><span class="sxs-lookup"><span data-stu-id="9f910-227">Silver</span></span> |
| <span data-ttu-id="9f910-228">7 ou 8</span><span class="sxs-lookup"><span data-stu-id="9f910-228">7 or 8</span></span> |<span data-ttu-id="9f910-229">Gold</span><span class="sxs-lookup"><span data-stu-id="9f910-229">Gold</span></span> |
| <span data-ttu-id="9f910-230">9 et plus</span><span class="sxs-lookup"><span data-stu-id="9f910-230">9 and up</span></span> |<span data-ttu-id="9f910-231">Platinum</span><span class="sxs-lookup"><span data-stu-id="9f910-231">Platinum</span></span> |




## <a name="primary-node-type---capacity-guidance"></a><span data-ttu-id="9f910-232">Type de nœud principal - Recommandations en matière de capacité</span><span class="sxs-lookup"><span data-stu-id="9f910-232">Primary node type - Capacity Guidance</span></span>

<span data-ttu-id="9f910-233">Voici nos recommandations pour planifier la capacité du type de nœud principal :</span><span class="sxs-lookup"><span data-stu-id="9f910-233">Here is the guidance for planning the primary node type capacity</span></span>

1. <span data-ttu-id="9f910-234">**Nombre d’instances de machine virtuelle pour exécuter une charge de travail de production dans Azure :**  vous devez définir la taille minimale du type de nœud principal sur 5.</span><span class="sxs-lookup"><span data-stu-id="9f910-234">**Number of VM instances to run any production workload in Azure:** You must specify a minimum Primary Node type size of 5.</span></span> 
2. <span data-ttu-id="9f910-235">**Nombre d’instances de machine virtuelle pour exécuter des charges de travail de test dans Azure :** vous devez définir la taille minimale du type de nœud principal sur 1 ou 3.</span><span class="sxs-lookup"><span data-stu-id="9f910-235">**Number of VM instances to run test workloads in Azure** You can specify a minimum primary node type size of 1 or 3.</span></span> <span data-ttu-id="9f910-236">Le cluster à un nœud s’exécute avec une configuration spéciale. Par conséquent, l’augmentation de la taille des instances de ce cluster n’est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="9f910-236">The one node cluster, runs with a special configuration and so, scale out of that cluster is not supported.</span></span> <span data-ttu-id="9f910-237">Le cluster à un nœud n’est pas fiable. Par conséquent, dans votre modèle Resource Manager, vous devez supprimer / ne pas spécifier cette configuration (ne pas définir la valeur de configuration ne suffit pas).</span><span class="sxs-lookup"><span data-stu-id="9f910-237">The one node cluster, has no reliability and so in your Resource Manager template, you have to remove/not specify that configuration (not setting the configuration value is not enough).</span></span> <span data-ttu-id="9f910-238">Si vous configurez le cluster à un nœud via le portail, la configuration est automatiquement prise en charge.</span><span class="sxs-lookup"><span data-stu-id="9f910-238">If you set up the one node cluster set up via portal, then the configuration is automatically taken care of.</span></span> <span data-ttu-id="9f910-239">Les clusters à 1 et 3 nœuds ne sont pas pris en charge pour l’exécution des charges de travail de production.</span><span class="sxs-lookup"><span data-stu-id="9f910-239">1 and 3 node clusters are not supported for running production workloads.</span></span> 
3. <span data-ttu-id="9f910-240">**Référence de machine virtuelle :** comme les services système s’exécutent sur le type de nœud principal, votre choix de référence de machine virtuelle pour celui-ci doit prendre en compte la charge maximale globale que vous prévoyez de placer dans le cluster.</span><span class="sxs-lookup"><span data-stu-id="9f910-240">**VM SKU:** Primary node type is where the system services run, so the VM SKU you choose for it, must take into account the overall peak load you plan to place into the cluster.</span></span> <span data-ttu-id="9f910-241">Voici une analogie pour illustrer mon propos ici : considérez le type de nœud principal comme vos « poumons », qui alimentent votre cerveau en oxygène ; si le cerveau ne reçoit pas assez d’oxygène, votre corps souffre.</span><span class="sxs-lookup"><span data-stu-id="9f910-241">Here is an analogy to illustrate what I mean here - Think of the primary node type as your "Lungs", it is what provides oxygen to your brain, and so if the brain does not get enough oxygen, your body suffers.</span></span> 

<span data-ttu-id="9f910-242">Les besoins en capacité d’un cluster sont déterminés par la charge de travail que vous prévoyez d’exécuter dans celui-ci. Par conséquent, nous ne pouvons pas fournir de recommandations qualitatives pour votre charge de travail spécifique. Néanmoins, vous trouverez ci-dessous des recommandations générales qui vous aideront à bien démarrer.</span><span class="sxs-lookup"><span data-stu-id="9f910-242">Since the capacity needs of a cluster is determined by workload you plan to run in the cluster, we cannot provide you with qualitative guidance for your specific workload, however here is the broad guidance to help you get started</span></span>

<span data-ttu-id="9f910-243">Pour les charges de travail de production</span><span class="sxs-lookup"><span data-stu-id="9f910-243">For production workloads</span></span> 


- <span data-ttu-id="9f910-244">La référence de machine virtuelle recommandée est Standard D3 ou Standard D3_V2 ou équivalent avec un minimum de 14 Go de mémoire sur disque SSD local.</span><span class="sxs-lookup"><span data-stu-id="9f910-244">The recommended VM SKU is Standard D3 or Standard D3_V2 or equivalent with a minimum of 14 GB of local SSD.</span></span>
- <span data-ttu-id="9f910-245">La référence de machine virtuelle minimale prise en charge est Standard D1 ou Standard D1_V2 ou équivalent avec un minimum de 14 Go de mémoire sur disque SSD local.</span><span class="sxs-lookup"><span data-stu-id="9f910-245">The minimum supported use VM SKU is Standard D1 or Standard D1_V2 or equivalent with a minimum of 14 GB of local SSD.</span></span> 
- <span data-ttu-id="9f910-246">Les références de machine virtuelle à cœur partiel telles que Standard A0 ne sont pas prises en charge pour les charges de travail de production.</span><span class="sxs-lookup"><span data-stu-id="9f910-246">Partial core VM SKUs like Standard A0 are not supported for production workloads.</span></span>
- <span data-ttu-id="9f910-247">La référence Standard A1 n’est pas prise en charge pour les charges de production pour des raisons de performances.</span><span class="sxs-lookup"><span data-stu-id="9f910-247">Standard A1 SKU is not supported for production workloads for performance reasons.</span></span>


## <a name="non-primary-node-type---capacity-guidance-for-stateful-workloads"></a><span data-ttu-id="9f910-248">Type de nœud non principal - Recommandations en matière de capacité pour les charges de travail avec état</span><span class="sxs-lookup"><span data-stu-id="9f910-248">Non-Primary node type - Capacity Guidance for stateful workloads</span></span>

<span data-ttu-id="9f910-249">Ces conseils sont donnés pour les charges de travail avec état utilisant des [collections fiables ou intervenant fiables](service-fabric-choose-framework.md) de structure de service qui sont en cours d’exécution dans le type de nœud principal.</span><span class="sxs-lookup"><span data-stu-id="9f910-249">This guidance is for stateful Workloads using Service fabric [reliable collections or reliable Actors](service-fabric-choose-framework.md) that you are running in the non-primary node type.</span></span>


<span data-ttu-id="9f910-250">**Nombre d’instances de machine virtuelle :** pour les charges de travail de production avec état, il est recommandé de les exécuter avec un nombre de réplicas minimal et cible de 5.</span><span class="sxs-lookup"><span data-stu-id="9f910-250">**Number of VM instances:** For production workloads that are stateful, it is recommended that you run them with a minimum and target replica count of 5.</span></span> <span data-ttu-id="9f910-251">Cela signifie qu’à l’état stationnaire, vous vous retrouvez avec un réplica (issu d’un jeu de réplicas) dans chaque domaine d’erreur et de mise à niveau.</span><span class="sxs-lookup"><span data-stu-id="9f910-251">This means that in steady state you end up with a replica (from a replica set) in each fault domain and upgrade domain.</span></span> <span data-ttu-id="9f910-252">Le concept même de niveau de fiabilité pour le type de nœud principal permet de spécifier ce paramètre pour les services système.</span><span class="sxs-lookup"><span data-stu-id="9f910-252">The whole reliability tier concept for the primary node type is a way to specify this setting for system services.</span></span> <span data-ttu-id="9f910-253">Par conséquent, il en va de même pour vos services avec état.</span><span class="sxs-lookup"><span data-stu-id="9f910-253">So the same consideration applies to your stateful services as well.</span></span>

<span data-ttu-id="9f910-254">Pour les charges de travail de production, la taille minimale recommandée pour le type de nœud non principal est donc de 5 si vous exécutez des charges de travail avec état sur ce dernier.</span><span class="sxs-lookup"><span data-stu-id="9f910-254">So for production workloads, the minimum recommended non-Primary Node type size is 5, if you are running stateful workloads in it.</span></span>


<span data-ttu-id="9f910-255">**Référence de machine virtuelle :** comme il s’agit du type de nœud sur lequel vos services d’application s’exécutent, votre choix de référence de machine virtuelle pour celui-ci doit prendre en compte la charge maximale que vous prévoyez de placer dans chaque nœud.</span><span class="sxs-lookup"><span data-stu-id="9f910-255">**VM SKU:** This is the node type where your application services are running, so the VM SKU you choose for it, must take into account the peak load you plan to place into each Node.</span></span> <span data-ttu-id="9f910-256">Les besoins en capacité du type de nœud sont déterminés par la charge de travail que vous prévoyez d’exécuter dans le cluster. Par conséquent, nous ne pouvons pas fournir de recommandations qualitatives pour votre charge de travail spécifique. Néanmoins, vous trouverez ci-dessous des recommandations générales qui vous aideront à bien démarrer.</span><span class="sxs-lookup"><span data-stu-id="9f910-256">The capacity needs of the nodetype, is determined by workload you plan to run in the cluster, so we cannot provide you with qualitative guidance for your specific workload, however here is the broad guidance to help you get started</span></span>

<span data-ttu-id="9f910-257">Pour les charges de travail de production</span><span class="sxs-lookup"><span data-stu-id="9f910-257">For production workloads</span></span> 

- <span data-ttu-id="9f910-258">La référence de machine virtuelle recommandée est Standard D3 ou Standard D3_V2 ou équivalent avec un minimum de 14 Go de mémoire sur disque SSD local.</span><span class="sxs-lookup"><span data-stu-id="9f910-258">The recommended VM SKU is Standard D3 or Standard D3_V2 or equivalent with a minimum of 14 GB of local SSD.</span></span>
- <span data-ttu-id="9f910-259">La référence de machine virtuelle minimale prise en charge est Standard D1 ou Standard D1_V2 ou équivalent avec un minimum de 14 Go de mémoire sur disque SSD local.</span><span class="sxs-lookup"><span data-stu-id="9f910-259">The minimum supported use VM SKU is Standard D1 or Standard D1_V2 or equivalent with a minimum of 14 GB of local SSD.</span></span> 
- <span data-ttu-id="9f910-260">Les références de machine virtuelle à cœur partiel telles que Standard A0 ne sont pas prises en charge pour les charges de travail de production.</span><span class="sxs-lookup"><span data-stu-id="9f910-260">Partial core VM SKUs like Standard A0 are not supported for production workloads.</span></span>
- <span data-ttu-id="9f910-261">La référence Standard A1 n’est pas non plus prise en charge pour les charges de production pour des raisons de performances.</span><span class="sxs-lookup"><span data-stu-id="9f910-261">Standard A1 SKU is specifically not supported for production workloads for performance reasons.</span></span>


## <a name="non-primary-node-type---capacity-guidance-for-stateless-workloads"></a><span data-ttu-id="9f910-262">Type de nœud non principal - Recommandations en matière de capacité pour les charges de travail sans état</span><span class="sxs-lookup"><span data-stu-id="9f910-262">Non-Primary node type - Capacity Guidance for stateless workloads</span></span>

<span data-ttu-id="9f910-263">Ces conseils sont donnés pour les charges de travail sans état qui sont en cours d’exécution sur le type de nœud non principal.</span><span class="sxs-lookup"><span data-stu-id="9f910-263">This guidance of stateless Workloads that you are running on the non-primary nodetype.</span></span>

<span data-ttu-id="9f910-264">**Nombre d’instances de machines virtuelles :** pour les charges de travail de production sans état, la taille minimale prise en charge pour le type de nœud non principal est égale à 2.</span><span class="sxs-lookup"><span data-stu-id="9f910-264">**Number of VM instances:** For production workloads that are stateless, the minimum supported non-Primary Node type size is 2.</span></span> <span data-ttu-id="9f910-265">Vous pouvez ainsi exécuter deux instances sans état de votre application, ce qui permet à votre service de continuer à fonctionner en cas de perte d’une instance de machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="9f910-265">This allows you to run you two stateless instances of your application and allowing your service to survive the loss of a VM instance.</span></span> 

> [!NOTE]
> <span data-ttu-id="9f910-266">Si votre cluster est exécuté sur une version de Service Fabric antérieure à la version 5.6, en raison d’un défaut dans le runtime (dont la résolution est prévue dans la version 5.6), la diminution de la taille du type de nœud non principal jusqu’à une valeur inférieure à 5 donne lieu à une défaillance sur le plan de l’intégrité du cluster jusqu’à ce que vous appeliez [ServiceFabricNodeState-Remove cmd](https://docs.microsoft.com/powershell/servicefabric/vlatest/Remove-ServiceFabricNodeState) avec le nom de nœud approprié.</span><span class="sxs-lookup"><span data-stu-id="9f910-266">If your cluster is running on a service fabric version less than 5.6, due to a defect in the runtime (this issue is fixed in 5.6), scaling down a non-primary node type to less than 5, results in cluster health turning unhealthy, till you call [Remove-ServiceFabricNodeState cmd](https://docs.microsoft.com/powershell/servicefabric/vlatest/Remove-ServiceFabricNodeState) with the appropriate node name.</span></span> <span data-ttu-id="9f910-267">Pour plus d’informations, consultez [Augmenter ou diminuer la taille des instances d’un cluster Service Fabric](service-fabric-cluster-scale-up-down.md).</span><span class="sxs-lookup"><span data-stu-id="9f910-267">Read [perform Service Fabric cluster in or out](service-fabric-cluster-scale-up-down.md) for more details</span></span>
> 
>

<span data-ttu-id="9f910-268">**Référence de machine virtuelle :** comme il s’agit du type de nœud sur lequel vos services d’application s’exécutent, votre choix de référence de machine virtuelle pour celui-ci doit prendre en compte la charge maximale que vous prévoyez de placer dans chaque nœud.</span><span class="sxs-lookup"><span data-stu-id="9f910-268">**VM SKU:** This is the node type where your application services are running, so the VM SKU you choose for it, must take into account the peak load you plan to place into each Node.</span></span> <span data-ttu-id="9f910-269">Les besoins en capacité du type de nœud sont déterminés par la charge de travail que vous prévoyez d’exécuter dans le cluster. Par conséquent, nous ne pouvons pas fournir de recommandations qualitatives pour votre charge de travail spécifique. Néanmoins, vous trouverez ci-dessous des recommandations générales qui vous aideront à bien démarrer.</span><span class="sxs-lookup"><span data-stu-id="9f910-269">The capacity needs of the nodetype, is determined by workload you plan to run in the cluster, So we cannot provide you with qualitative guidance for your specific workload, however here is the broad guidance to help you get started</span></span>

<span data-ttu-id="9f910-270">Pour les charges de travail de production</span><span class="sxs-lookup"><span data-stu-id="9f910-270">For production workloads</span></span> 


- <span data-ttu-id="9f910-271">La référence de machine virtuelle recommandée est Standard D3 ou Standard D3_V2 ou équivalent.</span><span class="sxs-lookup"><span data-stu-id="9f910-271">The recommended VM SKU is Standard D3 or Standard D3_V2 or equivalent.</span></span> 
- <span data-ttu-id="9f910-272">La référence de machine virtuelle minimale prise en charge est Standard D1 ou Standard D1_V2 ou équivalent.</span><span class="sxs-lookup"><span data-stu-id="9f910-272">The minimum supported use VM SKU is Standard D1 or Standard D1_V2 or equivalent.</span></span> 
- <span data-ttu-id="9f910-273">Les références de machine virtuelle à cœur partiel telles que Standard A0 ne sont pas prises en charge pour les charges de travail de production.</span><span class="sxs-lookup"><span data-stu-id="9f910-273">Partial core VM SKUs like Standard A0 are not supported for production workloads.</span></span>
- <span data-ttu-id="9f910-274">La référence Standard A1 n’est pas prise en charge pour les charges de production pour des raisons de performances.</span><span class="sxs-lookup"><span data-stu-id="9f910-274">Standard A1 SKU is not supported for production workloads for performance reasons.</span></span>

<!--Every topic should have next steps and links to the next logical set of content to keep the customer engaged-->

## <a name="next-steps"></a><span data-ttu-id="9f910-275">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="9f910-275">Next steps</span></span>
<span data-ttu-id="9f910-276">Une fois que vous avez terminé la planification de votre capacité et que vous avez configuré un cluster, lisez ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="9f910-276">Once you finish your capacity planning and set up a cluster, read the following:</span></span>

* [<span data-ttu-id="9f910-277">Sécurité d’un cluster Service Fabric</span><span class="sxs-lookup"><span data-stu-id="9f910-277">Service Fabric cluster security</span></span>](service-fabric-cluster-security.md)
* [<span data-ttu-id="9f910-278">Présentation du modèle d’intégrité de Service Fabric</span><span class="sxs-lookup"><span data-stu-id="9f910-278">Service Fabric health model introduction</span></span>](service-fabric-health-introduction.md)
* [<span data-ttu-id="9f910-279">Relations des types de nœuds avec le groupe de machines virtuelles identiques</span><span class="sxs-lookup"><span data-stu-id="9f910-279">Relationship of Nodetypes to Virtual machine scale set</span></span>](service-fabric-cluster-nodetypes.md)

<!--Image references-->
[SystemServices]: ./media/service-fabric-cluster-capacity/SystemServices.png
