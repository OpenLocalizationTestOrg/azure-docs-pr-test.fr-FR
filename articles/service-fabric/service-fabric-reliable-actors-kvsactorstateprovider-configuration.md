---
title: "Modifier les paramètres de KVSActorStateProvider dans les microservices Azure | Microsoft Docs"
description: "Découvrez comment configurer les acteurs avec état Azure Service Fabric de type KVSActorStateProvider."
services: Service-Fabric
documentationcenter: .net
author: sumukhs
manager: timlt
editor: 
ms.assetid: dbed72f4-dda5-4287-bd56-da492710cd96
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 6/29/2017
ms.author: sumukhs
ms.openlocfilehash: 2af1d21a46cde5ba63c967461a1835b5e34ca3cc
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/11/2017
---
# <a name="configuring-reliable-actors--kvsactorstateprovider"></a><span data-ttu-id="0f33d-103">Configuration de Reliable Actors - KVSActorStateProvider</span><span class="sxs-lookup"><span data-stu-id="0f33d-103">Configuring Reliable Actors--KVSActorStateProvider</span></span>
<span data-ttu-id="0f33d-104">Vous pouvez modifier la configuration par défaut de KVSActorStateProvider en modifiant le fichier settings.xml généré dans la racine du package Microsoft Visual Studio sous le dossier Config de l’acteur spécifié.</span><span class="sxs-lookup"><span data-stu-id="0f33d-104">You can modify the default configuration of KVSActorStateProvider by changing the settings.xml file that is generated in the Microsoft Visual Studio package root under the Config folder for the specified actor.</span></span>

<span data-ttu-id="0f33d-105">Le runtime Azure Service Fabric recherche des noms de sections prédéfinis dans le fichier settings.xml et utilise les valeurs de configuration pendant la création des composants runtime sous-jacents.</span><span class="sxs-lookup"><span data-stu-id="0f33d-105">The Azure Service Fabric runtime looks for predefined section names in the settings.xml file and consumes the configuration values while creating the underlying runtime components.</span></span>

> [!NOTE]
> <span data-ttu-id="0f33d-106">Veillez à **ne pas** supprimer ou modifier les noms de sections des configurations suivantes dans le fichier settings.xml généré dans la solution Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="0f33d-106">Do **not** delete or modify the section names of the following configurations in the settings.xml file that is generated in the Visual Studio solution.</span></span>
> 
> 

## <a name="replicator-security-configuration"></a><span data-ttu-id="0f33d-107">Configuration de la sécurité du réplicateur</span><span class="sxs-lookup"><span data-stu-id="0f33d-107">Replicator security configuration</span></span>
<span data-ttu-id="0f33d-108">Les configurations de sécurité du réplicateur sont utilisées pour sécuriser le canal de communication utilisé pendant la réplication.</span><span class="sxs-lookup"><span data-stu-id="0f33d-108">Replicator security configurations are used to secure the communication channel that is used during replication.</span></span> <span data-ttu-id="0f33d-109">Un service ne peut donc pas afficher le trafic de réplication d’un autre service, ce qui garantit la sécurité des données rendues hautement disponibles.</span><span class="sxs-lookup"><span data-stu-id="0f33d-109">This means that services cannot see each other's replication traffic, ensuring that the data that is made highly available is also secure.</span></span>
<span data-ttu-id="0f33d-110">Par défaut, une section de configuration de sécurité vide empêche de sécuriser la réplication.</span><span class="sxs-lookup"><span data-stu-id="0f33d-110">By default, an empty security configuration section prevents replication security.</span></span>

### <a name="section-name"></a><span data-ttu-id="0f33d-111">Nom de la section</span><span class="sxs-lookup"><span data-stu-id="0f33d-111">Section name</span></span>
<span data-ttu-id="0f33d-112">&lt;ActorName&gt;ServiceReplicatorSecurityConfig</span><span class="sxs-lookup"><span data-stu-id="0f33d-112">&lt;ActorName&gt;ServiceReplicatorSecurityConfig</span></span>

## <a name="replicator-configuration"></a><span data-ttu-id="0f33d-113">Configuration du réplicateur</span><span class="sxs-lookup"><span data-stu-id="0f33d-113">Replicator configuration</span></span>
<span data-ttu-id="0f33d-114">Les configurations de réplicateur servent à configurer le réplicateur responsable de la haute fiabilité de l’état du fournisseur d’état d’acteur.</span><span class="sxs-lookup"><span data-stu-id="0f33d-114">Replicator configurations configure the replicator that is responsible for making the Actor State Provider state highly reliable.</span></span>
<span data-ttu-id="0f33d-115">La configuration par défaut est générée par le modèle Visual Studio et devrait suffire.</span><span class="sxs-lookup"><span data-stu-id="0f33d-115">The default configuration is generated by the Visual Studio template and should suffice.</span></span> <span data-ttu-id="0f33d-116">Cette section décrit les configurations supplémentaires disponibles pour paramétrer le réplicateur.</span><span class="sxs-lookup"><span data-stu-id="0f33d-116">This section talks about additional configurations that are available to tune the replicator.</span></span>

### <a name="section-name"></a><span data-ttu-id="0f33d-117">Nom de la section</span><span class="sxs-lookup"><span data-stu-id="0f33d-117">Section name</span></span>
<span data-ttu-id="0f33d-118">&lt;ActorName&gt;ServiceReplicatorConfig</span><span class="sxs-lookup"><span data-stu-id="0f33d-118">&lt;ActorName&gt;ServiceReplicatorConfig</span></span>

### <a name="configuration-names"></a><span data-ttu-id="0f33d-119">Noms des configurations</span><span class="sxs-lookup"><span data-stu-id="0f33d-119">Configuration names</span></span>
| <span data-ttu-id="0f33d-120">Nom</span><span class="sxs-lookup"><span data-stu-id="0f33d-120">Name</span></span> | <span data-ttu-id="0f33d-121">Unité</span><span class="sxs-lookup"><span data-stu-id="0f33d-121">Unit</span></span> | <span data-ttu-id="0f33d-122">Valeur par défaut</span><span class="sxs-lookup"><span data-stu-id="0f33d-122">Default value</span></span> | <span data-ttu-id="0f33d-123">Remarques</span><span class="sxs-lookup"><span data-stu-id="0f33d-123">Remarks</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="0f33d-124">BatchAcknowledgementInterval</span><span class="sxs-lookup"><span data-stu-id="0f33d-124">BatchAcknowledgementInterval</span></span> |<span data-ttu-id="0f33d-125">Secondes</span><span class="sxs-lookup"><span data-stu-id="0f33d-125">Seconds</span></span> |<span data-ttu-id="0f33d-126">0.015</span><span class="sxs-lookup"><span data-stu-id="0f33d-126">0.015</span></span> |<span data-ttu-id="0f33d-127">Durée d'attente du réplicateur secondaire après la réception d'une opération et avant de renvoyer un accusé de réception au réplicateur principal.</span><span class="sxs-lookup"><span data-stu-id="0f33d-127">Time period for which the replicator at the secondary waits after receiving an operation before sending back an acknowledgement to the primary.</span></span> <span data-ttu-id="0f33d-128">Tous les autres accusés de réception à envoyer pour les opérations traitées durant cet intervalle sont envoyés sous la forme d'une réponse.</span><span class="sxs-lookup"><span data-stu-id="0f33d-128">Any other acknowledgements to be sent for operations processed within this interval are sent as one response.</span></span> |
| <span data-ttu-id="0f33d-129">ReplicatorEndpoint</span><span class="sxs-lookup"><span data-stu-id="0f33d-129">ReplicatorEndpoint</span></span> |<span data-ttu-id="0f33d-130">N/A</span><span class="sxs-lookup"><span data-stu-id="0f33d-130">N/A</span></span> |<span data-ttu-id="0f33d-131">Aucune valeur par défaut (paramètre obligatoire)</span><span class="sxs-lookup"><span data-stu-id="0f33d-131">No default--required parameter</span></span> |<span data-ttu-id="0f33d-132">Adresse IP et port que le réplicateur principal/secondaire utilise pour communiquer avec d'autres réplicateurs dans le jeu de réplicas.</span><span class="sxs-lookup"><span data-stu-id="0f33d-132">IP address and port that the primary/secondary replicator will use to communicate with other replicators in the replica set.</span></span> <span data-ttu-id="0f33d-133">Doit faire référence à un point de terminaison de ressource TCP dans le manifeste de service.</span><span class="sxs-lookup"><span data-stu-id="0f33d-133">This should reference a TCP resource endpoint in the service manifest.</span></span> <span data-ttu-id="0f33d-134">Pour en savoir plus sur la définition de ressources de point de terminaison dans le manifeste de service, consultez [Ressources du manifeste de service](service-fabric-service-manifest-resources.md) .</span><span class="sxs-lookup"><span data-stu-id="0f33d-134">Refer to [Service manifest resources](service-fabric-service-manifest-resources.md) to read more about defining endpoint resources in the service manifest.</span></span> |
| <span data-ttu-id="0f33d-135">RetryInterval</span><span class="sxs-lookup"><span data-stu-id="0f33d-135">RetryInterval</span></span> |<span data-ttu-id="0f33d-136">Secondes</span><span class="sxs-lookup"><span data-stu-id="0f33d-136">Seconds</span></span> |<span data-ttu-id="0f33d-137">5</span><span class="sxs-lookup"><span data-stu-id="0f33d-137">5</span></span> |<span data-ttu-id="0f33d-138">Période après laquelle le réplicateur retransmet un message s'il ne reçoit aucun accusé de réception pour une opération.</span><span class="sxs-lookup"><span data-stu-id="0f33d-138">Time period after which the replicator re-transmits a message if it does not receive an acknowledgement for an operation.</span></span> |
| <span data-ttu-id="0f33d-139">MaxReplicationMessageSize</span><span class="sxs-lookup"><span data-stu-id="0f33d-139">MaxReplicationMessageSize</span></span> |<span data-ttu-id="0f33d-140">Octets</span><span class="sxs-lookup"><span data-stu-id="0f33d-140">Bytes</span></span> |<span data-ttu-id="0f33d-141">50 Mo</span><span class="sxs-lookup"><span data-stu-id="0f33d-141">50 MB</span></span> |<span data-ttu-id="0f33d-142">Taille maximale des données de réplication pouvant être transmises dans un même message.</span><span class="sxs-lookup"><span data-stu-id="0f33d-142">Maximum size of replication data that can be transmitted in a single message.</span></span> |
| <span data-ttu-id="0f33d-143">MaxPrimaryReplicationQueueSize</span><span class="sxs-lookup"><span data-stu-id="0f33d-143">MaxPrimaryReplicationQueueSize</span></span> |<span data-ttu-id="0f33d-144">Nombre d'opérations</span><span class="sxs-lookup"><span data-stu-id="0f33d-144">Number of operations</span></span> |<span data-ttu-id="0f33d-145">1 024</span><span class="sxs-lookup"><span data-stu-id="0f33d-145">1024</span></span> |<span data-ttu-id="0f33d-146">Nombre maximal d'opérations dans la file d'attente principale.</span><span class="sxs-lookup"><span data-stu-id="0f33d-146">Maximum number of operations in the primary queue.</span></span> <span data-ttu-id="0f33d-147">Une opération est libérée quand le réplicateur principal reçoit un accusé de réception de tous les réplicateurs secondaires.</span><span class="sxs-lookup"><span data-stu-id="0f33d-147">An operation is freed up after the primary replicator receives an acknowledgement from all the secondary replicators.</span></span> <span data-ttu-id="0f33d-148">Cette valeur doit être supérieure à 64 et être une puissance de 2.</span><span class="sxs-lookup"><span data-stu-id="0f33d-148">This value must be greater than 64 and a power of 2.</span></span> |
| <span data-ttu-id="0f33d-149">MaxSecondaryReplicationQueueSize</span><span class="sxs-lookup"><span data-stu-id="0f33d-149">MaxSecondaryReplicationQueueSize</span></span> |<span data-ttu-id="0f33d-150">Nombre d'opérations</span><span class="sxs-lookup"><span data-stu-id="0f33d-150">Number of operations</span></span> |<span data-ttu-id="0f33d-151">2 048</span><span class="sxs-lookup"><span data-stu-id="0f33d-151">2048</span></span> |<span data-ttu-id="0f33d-152">Nombre maximal d'opérations dans la file d'attente secondaire.</span><span class="sxs-lookup"><span data-stu-id="0f33d-152">Maximum number of operations in the secondary queue.</span></span> <span data-ttu-id="0f33d-153">Une opération est libérée une fois son état devenu hautement disponible grâce à la persistance.</span><span class="sxs-lookup"><span data-stu-id="0f33d-153">An operation is freed up after making its state highly available through persistence.</span></span> <span data-ttu-id="0f33d-154">Cette valeur doit être supérieure à 64 et être une puissance de 2.</span><span class="sxs-lookup"><span data-stu-id="0f33d-154">This value must be greater than 64 and a power of 2.</span></span> |

## <a name="store-configuration"></a><span data-ttu-id="0f33d-155">Configuration du magasin</span><span class="sxs-lookup"><span data-stu-id="0f33d-155">Store configuration</span></span>
<span data-ttu-id="0f33d-156">Les configurations de magasin permettent de configurer le magasin local utilisé pour conserver l’état en cours de réplication.</span><span class="sxs-lookup"><span data-stu-id="0f33d-156">Store configurations are used to configure the local store that is used to persist the state that is being replicated.</span></span>
<span data-ttu-id="0f33d-157">La configuration par défaut est générée par le modèle Visual Studio et devrait suffire.</span><span class="sxs-lookup"><span data-stu-id="0f33d-157">The default configuration is generated by the Visual Studio template and should suffice.</span></span> <span data-ttu-id="0f33d-158">Cette section décrit les configurations supplémentaires disponibles pour paramétrer le magasin local.</span><span class="sxs-lookup"><span data-stu-id="0f33d-158">This section talks about additional configurations that are available to tune the local store.</span></span>

### <a name="section-name"></a><span data-ttu-id="0f33d-159">Nom de la section</span><span class="sxs-lookup"><span data-stu-id="0f33d-159">Section name</span></span>
<span data-ttu-id="0f33d-160">&lt;ActorName&gt;ServiceLocalStoreConfig</span><span class="sxs-lookup"><span data-stu-id="0f33d-160">&lt;ActorName&gt;ServiceLocalStoreConfig</span></span>

### <a name="configuration-names"></a><span data-ttu-id="0f33d-161">Noms des configurations</span><span class="sxs-lookup"><span data-stu-id="0f33d-161">Configuration names</span></span>
| <span data-ttu-id="0f33d-162">Nom</span><span class="sxs-lookup"><span data-stu-id="0f33d-162">Name</span></span> | <span data-ttu-id="0f33d-163">Unité</span><span class="sxs-lookup"><span data-stu-id="0f33d-163">Unit</span></span> | <span data-ttu-id="0f33d-164">Valeur par défaut</span><span class="sxs-lookup"><span data-stu-id="0f33d-164">Default value</span></span> | <span data-ttu-id="0f33d-165">Remarques</span><span class="sxs-lookup"><span data-stu-id="0f33d-165">Remarks</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="0f33d-166">MaxAsyncCommitDelayInMilliseconds</span><span class="sxs-lookup"><span data-stu-id="0f33d-166">MaxAsyncCommitDelayInMilliseconds</span></span> |<span data-ttu-id="0f33d-167">Millisecondes</span><span class="sxs-lookup"><span data-stu-id="0f33d-167">Milliseconds</span></span> |<span data-ttu-id="0f33d-168">200</span><span class="sxs-lookup"><span data-stu-id="0f33d-168">200</span></span> |<span data-ttu-id="0f33d-169">Définit l'intervalle maximal de traitement par lot pour les validations de magasin local durables.</span><span class="sxs-lookup"><span data-stu-id="0f33d-169">Sets the maximum batching interval for durable local store commits.</span></span> |
| <span data-ttu-id="0f33d-170">MaxVerPages</span><span class="sxs-lookup"><span data-stu-id="0f33d-170">MaxVerPages</span></span> |<span data-ttu-id="0f33d-171">Nombre de pages</span><span class="sxs-lookup"><span data-stu-id="0f33d-171">Number of pages</span></span> |<span data-ttu-id="0f33d-172">16 384</span><span class="sxs-lookup"><span data-stu-id="0f33d-172">16384</span></span> |<span data-ttu-id="0f33d-173">Nombre maximal de pages de version dans la base de données du magasin local.</span><span class="sxs-lookup"><span data-stu-id="0f33d-173">The maximum number of version pages in the local store database.</span></span> <span data-ttu-id="0f33d-174">Il détermine le nombre maximal de transactions en attente.</span><span class="sxs-lookup"><span data-stu-id="0f33d-174">It determines the maximum number of outstanding transactions.</span></span> |

## <a name="sample-configuration-file"></a><span data-ttu-id="0f33d-175">Exemple de fichier de configuration</span><span class="sxs-lookup"><span data-stu-id="0f33d-175">Sample configuration file</span></span>
```xml
<?xml version="1.0" encoding="utf-8"?>
<Settings xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/2011/01/fabric">
   <Section Name="MyActorServiceReplicatorConfig">
      <Parameter Name="ReplicatorEndpoint" Value="MyActorServiceReplicatorEndpoint" />
      <Parameter Name="BatchAcknowledgementInterval" Value="0.05"/>
   </Section>
   <Section Name="MyActorServiceLocalStoreConfig">
      <Parameter Name="MaxVerPages" Value="8192" />
   </Section>
   <Section Name="MyActorServiceReplicatorSecurityConfig">
      <Parameter Name="CredentialType" Value="X509" />
      <Parameter Name="FindType" Value="FindByThumbprint" />
      <Parameter Name="FindValue" Value="9d c9 06 b1 69 dc 4f af fd 16 97 ac 78 1e 80 67 90 74 9d 2f" />
      <Parameter Name="StoreLocation" Value="LocalMachine" />
      <Parameter Name="StoreName" Value="My" />
      <Parameter Name="ProtectionLevel" Value="EncryptAndSign" />
      <Parameter Name="AllowedCommonNames" Value="My-Test-SAN1-Alice,My-Test-SAN1-Bob" />
   </Section>
</Settings>
```
## <a name="remarks"></a><span data-ttu-id="0f33d-176">Remarques</span><span class="sxs-lookup"><span data-stu-id="0f33d-176">Remarks</span></span>
<span data-ttu-id="0f33d-177">Le paramètre BatchAcknowledgementInterval contrôle la latence de la réplication.</span><span class="sxs-lookup"><span data-stu-id="0f33d-177">The BatchAcknowledgementInterval parameter controls replication latency.</span></span> <span data-ttu-id="0f33d-178">La valeur « 0 » entraîne la latence la plus faible possible, au détriment du débit (car davantage de messages d'accusé de réception doivent être envoyés et traités, chacun contenant moins d'accusés de réception).</span><span class="sxs-lookup"><span data-stu-id="0f33d-178">A value of '0' results in the lowest possible latency, at the cost of throughput (as more acknowledgement messages must be sent and processed, each containing fewer acknowledgements).</span></span>
<span data-ttu-id="0f33d-179">Plus la valeur de BatchAcknowledgementInterval est élevée, plus le débit de réplication général est élevé, au détriment d'une plus grande latence de l'opération.</span><span class="sxs-lookup"><span data-stu-id="0f33d-179">The larger the value for BatchAcknowledgementInterval, the higher the overall replication throughput, at the cost of higher operation latency.</span></span> <span data-ttu-id="0f33d-180">Cela se traduit directement par une latence dans la validation des transactions.</span><span class="sxs-lookup"><span data-stu-id="0f33d-180">This directly translates to the latency of transaction commits.</span></span>

