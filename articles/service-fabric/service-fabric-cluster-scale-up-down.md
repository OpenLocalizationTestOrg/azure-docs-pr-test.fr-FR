---
title: "Augmenter ou diminuer la taille des instances d’un cluster Service Fabric | Microsoft Docs"
description: "Augmentez ou diminuez la taille des instances d’un cluster Service Fabric pour répondre à la demande en définissant des règles de mise à l’échelle automatique pour chaque type de nœud/groupe de machines virtuelles identiques. Ajouter ou supprimer des nœuds d’un cluster Service Fabric"
services: service-fabric
documentationcenter: .net
author: ChackDan
manager: timlt
editor: 
ms.assetid: aeb76f63-7303-4753-9c64-46146340b83d
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 06/22/2017
ms.author: chackdan
ms.openlocfilehash: 32d8fca81c20e77db4ed3aae05d017ccc2ce1be3
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/03/2017
---
# <a name="scale-a-service-fabric-cluster-in-or-out-using-auto-scale-rules"></a><span data-ttu-id="7a25d-104">Augmenter ou diminuer la taille des instances d’un cluster Service Fabric à l’aide de règles de mise à l’échelle automatique</span><span class="sxs-lookup"><span data-stu-id="7a25d-104">Scale a Service Fabric cluster in or out using auto-scale rules</span></span>
<span data-ttu-id="7a25d-105">Les jeux de mise à l’échelle de machine virtuelle sont des ressources de calcul Azure que vous pouvez utiliser pour déployer et gérer une collection de machines virtuelles en tant que jeu.</span><span class="sxs-lookup"><span data-stu-id="7a25d-105">Virtual machine scale sets are an Azure compute resource that you can use to deploy and manage a collection of virtual machines as a set.</span></span> <span data-ttu-id="7a25d-106">Chaque type de nœud qui est défini dans un cluster Service Fabric est configuré en tant que groupe de machines virtuelles identiques distinct.</span><span class="sxs-lookup"><span data-stu-id="7a25d-106">Every node type that is defined in a Service Fabric cluster is set up as a separate Virtual Machine scale set.</span></span> <span data-ttu-id="7a25d-107">Chaque type de nœud peut ensuite faire l’objet d’une augmentation ou d’une diminution de la taille des instances de manière indépendante, avoir différents jeux de ports ouverts et présenter différentes métriques de capacité.</span><span class="sxs-lookup"><span data-stu-id="7a25d-107">Each node type can then be scaled in or out independently, have different sets of ports open, and can have different capacity metrics.</span></span> <span data-ttu-id="7a25d-108">Pour en savoir plus, voir le document portant sur les [types de nœuds Service Fabric](service-fabric-cluster-nodetypes.md) .</span><span class="sxs-lookup"><span data-stu-id="7a25d-108">Read more about it in the [Service Fabric nodetypes](service-fabric-cluster-nodetypes.md) document.</span></span> <span data-ttu-id="7a25d-109">Étant donné que les types de nœuds Service Fabric de votre cluster sont constitués de groupes de machines virtuelles identiques sur le serveur principal, vous devez définir des règles de mise à l’échelle automatique pour chaque type de nœud/groupe de machines virtuelles identiques.</span><span class="sxs-lookup"><span data-stu-id="7a25d-109">Since the Service Fabric node types in your cluster are made of Virtual Machine scale sets at the backend, you need to set up auto-scale rules for each node type/Virtual Machine scale set.</span></span>

> [!NOTE]
> <span data-ttu-id="7a25d-110">Votre abonnement doit avoir suffisamment de cœurs pour ajouter les nouvelles machines virtuelles qui composeront ce cluster.</span><span class="sxs-lookup"><span data-stu-id="7a25d-110">Your subscription must have enough cores to add the new VMs that make up this cluster.</span></span> <span data-ttu-id="7a25d-111">Il n’existe actuellement aucune validation de modèle. Vous obtenez donc une erreur liée au temps de déploiement si l’une des limites de quota est atteinte.</span><span class="sxs-lookup"><span data-stu-id="7a25d-111">There is no model validation currently, so you get a deployment time failure, if any of the quota limits are hit.</span></span>
> 
> 

## <a name="choose-the-node-typevirtual-machine-scale-set-to-scale"></a><span data-ttu-id="7a25d-112">Choisir le type de nœud/groupe de machines virtuelles identiques à mettre à l’échelle</span><span class="sxs-lookup"><span data-stu-id="7a25d-112">Choose the node type/Virtual Machine scale set to scale</span></span>
<span data-ttu-id="7a25d-113">Actuellement, vous n’êtes pas en mesure de spécifier les règles de mise à l’échelle automatique pour les groupes de machines virtuelles identiques à l’aide du portail. Nous allons donc utiliser Azure PowerShell (1.0 et versions ultérieures) pour répertorier les types de nœud et leur ajouter des règles de mise à l’échelle automatique.</span><span class="sxs-lookup"><span data-stu-id="7a25d-113">Currently, you are not able to specify the auto-scale rules for Virtual Machine scale sets using the portal, so let us use Azure PowerShell (1.0+) to list the node types and then add auto-scale rules to them.</span></span>

<span data-ttu-id="7a25d-114">Pour obtenir la liste des groupes de machines virtuelles identiques qui composent votre cluster, exécutez les cmdlets suivantes :</span><span class="sxs-lookup"><span data-stu-id="7a25d-114">To get the list of Virtual Machine scale set that make up your cluster, run the following cmdlets:</span></span>

```powershell
Get-AzureRmResource -ResourceGroupName <RGname> -ResourceType Microsoft.Compute/VirtualMachineScaleSets

Get-AzureRmVmss -ResourceGroupName <RGname> -VMScaleSetName <Virtual Machine scale set name>
```

## <a name="set-auto-scale-rules-for-the-node-typevirtual-machine-scale-set"></a><span data-ttu-id="7a25d-115">Définir des règles de mise à l’échelle automatique pour le type de nœud/groupe de machines virtuelles identiques</span><span class="sxs-lookup"><span data-stu-id="7a25d-115">Set auto-scale rules for the node type/Virtual Machine scale set</span></span>
<span data-ttu-id="7a25d-116">Si votre cluster comporte plusieurs types de nœud, vous devez effectuer cette opération pour chaque type de nœud/groupe de machines virtuelles identiques dont vous voulez augmenter ou diminuer la taille des instances.</span><span class="sxs-lookup"><span data-stu-id="7a25d-116">If your cluster has multiple node types, then repeat this for each node types/Virtual Machine scale sets that you want to scale (in or out).</span></span> <span data-ttu-id="7a25d-117">Tenez compte du nombre de nœuds dont vous devez disposer avant de configurer la mise à l’échelle automatique.</span><span class="sxs-lookup"><span data-stu-id="7a25d-117">Take into account the number of nodes that you must have before you set up auto-scaling.</span></span> <span data-ttu-id="7a25d-118">Le nombre de nœuds minimal dont vous devez disposer pour le type de nœud principal est déterminé par le niveau de fiabilité que vous avez choisi.</span><span class="sxs-lookup"><span data-stu-id="7a25d-118">The minimum number of nodes that you must have for the primary node type is driven by the reliability level you have chosen.</span></span> <span data-ttu-id="7a25d-119">En savoir plus sur les [niveaux de fiabilité](service-fabric-cluster-capacity.md).</span><span class="sxs-lookup"><span data-stu-id="7a25d-119">Read more about [reliability levels](service-fabric-cluster-capacity.md).</span></span>

> [!NOTE]
> <span data-ttu-id="7a25d-120">Une descente en puissance du type de nœud principal en deçà du nombre minimal rend le cluster instable ou entraîne son interruption.</span><span class="sxs-lookup"><span data-stu-id="7a25d-120">Scaling down the primary node type to less than the minimum number make the cluster unstable or bring it down.</span></span> <span data-ttu-id="7a25d-121">Cela peut entraîner une perte de données pour vos applications et pour les services système.</span><span class="sxs-lookup"><span data-stu-id="7a25d-121">This could result in data loss for your applications and for the system services.</span></span>
> 
> 

<span data-ttu-id="7a25d-122">Actuellement, la fonctionnalité de mise à l’échelle automatique ne dépend pas des charges que vos applications peuvent signaler à Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="7a25d-122">Currently the auto-scale feature is not driven by the loads that your applications may be reporting to Service Fabric.</span></span> <span data-ttu-id="7a25d-123">Par conséquent, pour le moment, la mise à l’échelle automatique que vous obtenez dépend uniquement des compteurs de performances émis par chaque instance du groupe de machines virtuelles identiques.</span><span class="sxs-lookup"><span data-stu-id="7a25d-123">So at this time the auto-scale you get is purely driven by the performance counters that are emitted by each of the Virtual Machine scale set instances.</span></span>  

<span data-ttu-id="7a25d-124">Suivez ces instructions afin de [configurer la mise à l’échelle automatique pour chaque groupe de machines virtuelles identiques](../virtual-machine-scale-sets/virtual-machine-scale-sets-autoscale-overview.md).</span><span class="sxs-lookup"><span data-stu-id="7a25d-124">Follow these instructions [to set up auto-scale for each Virtual Machine scale set](../virtual-machine-scale-sets/virtual-machine-scale-sets-autoscale-overview.md).</span></span>

> [!NOTE]
> <span data-ttu-id="7a25d-125">Dans un scénario de descente en puissance, à moins que votre type de nœud ne possède un niveau de durabilité Gold ou Silver, vous devez appeler [l’applet de commande Remove-ServiceFabricNodeState](https://msdn.microsoft.com/library/azure/mt125993.aspx) avec le nom de nœud approprié.</span><span class="sxs-lookup"><span data-stu-id="7a25d-125">In a scale down scenario, unless your node type has a durability level of Gold or Silver you need to call the [Remove-ServiceFabricNodeState cmdlet](https://msdn.microsoft.com/library/azure/mt125993.aspx) with the appropriate node name.</span></span>
> 
> 

## <a name="manually-add-vms-to-a-node-typevirtual-machine-scale-set"></a><span data-ttu-id="7a25d-126">Ajouter manuellement des machines virtuelles à un type de nœud/groupe de machines virtuelles identiques</span><span class="sxs-lookup"><span data-stu-id="7a25d-126">Manually add VMs to a node type/Virtual Machine scale set</span></span>
<span data-ttu-id="7a25d-127">Suivez les exemples/les instructions dans la [galerie de modèles de démarrage rapide](https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-scale-existing) pour modifier le nombre de machines virtuelles dans chaque Nodetype.</span><span class="sxs-lookup"><span data-stu-id="7a25d-127">Follow the sample/instructions in the [quick start template gallery](https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-scale-existing) to change the number of VMs in each Nodetype.</span></span> 

> [!NOTE]
> <span data-ttu-id="7a25d-128">L’ajout de machines virtuelles prend du temps, donc ne vous attendez pas à ce que les ajouts soient instantanés.</span><span class="sxs-lookup"><span data-stu-id="7a25d-128">Adding of VMs takes time, so do not expect the additions to be instantaneous.</span></span> <span data-ttu-id="7a25d-129">Par conséquent, envisagez d’ajouter de la capacité bien à l’avance ; plus de 10 minutes sont nécessaires avant que la capacité de la machine virtuelle soit disponible pour les réplicas/instances de service à placer.</span><span class="sxs-lookup"><span data-stu-id="7a25d-129">So plan to add capacity well in time, to allow for over 10 minutes before the VM capacity is available for the replicas/ service instances to get placed.</span></span>
> 
> 

## <a name="manually-remove-vms-from-the-primary-node-typevirtual-machine-scale-set"></a><span data-ttu-id="7a25d-130">Supprimer manuellement des machines virtuelles du type de nœud/groupe de machines virtuelles identiques principal</span><span class="sxs-lookup"><span data-stu-id="7a25d-130">Manually remove VMs from the primary node type/Virtual Machine scale set</span></span>
> [!NOTE]
> <span data-ttu-id="7a25d-131">Les services système Service Fabric s’exécutent sur le type de nœud principal de votre cluster.</span><span class="sxs-lookup"><span data-stu-id="7a25d-131">The service fabric system services run in the Primary node type in your cluster.</span></span> <span data-ttu-id="7a25d-132">Vous ne devez donc jamais arrêter ou faire descendre en puissance le nombre d’instances dans ces types de nœuds sur une valeur inférieure à celle garantie par le niveau de fiabilité.</span><span class="sxs-lookup"><span data-stu-id="7a25d-132">So should never shut down or scale down the number of instances in that node types less than what the reliability tier warrants.</span></span> <span data-ttu-id="7a25d-133">Consultez [les détails sur les niveaux de fiabilité ici](service-fabric-cluster-capacity.md).</span><span class="sxs-lookup"><span data-stu-id="7a25d-133">Refer to [the details on reliability tiers here](service-fabric-cluster-capacity.md).</span></span> 
> 
> 

<span data-ttu-id="7a25d-134">Vous devez exécuter les étapes suivantes sur une instance de machine virtuelle à la fois.</span><span class="sxs-lookup"><span data-stu-id="7a25d-134">You need to execute the following steps one VM instance at a time.</span></span> <span data-ttu-id="7a25d-135">Ceci permet d’arrêter correctement les services système (et vos services avec état) sur l’instance de machine virtuelle que vous supprimez et les nouveaux réplicas créés sur d’autres nœuds.</span><span class="sxs-lookup"><span data-stu-id="7a25d-135">This allows for the system services (and your stateful services) to be shut down gracefully on the VM instance you are removing and new replicas created on other nodes.</span></span>

1. <span data-ttu-id="7a25d-136">Exécutez [Disable-ServiceFabricNode](https://msdn.microsoft.com/library/mt125852.aspx) avec « RemoveNode » pour désactiver le nœud que vous souhaitez supprimer (l’instance la plus élevée dans ce type de nœud).</span><span class="sxs-lookup"><span data-stu-id="7a25d-136">Run [Disable-ServiceFabricNode](https://msdn.microsoft.com/library/mt125852.aspx) with intent ‘RemoveNode’ to disable the node you’re going to remove (the highest instance in that node type).</span></span>
2. <span data-ttu-id="7a25d-137">Exécutez [Get-ServiceFabricNode](https://msdn.microsoft.com/library/mt125856.aspx) pour vous assurer que le nœud est en effet passé à l’état désactivé.</span><span class="sxs-lookup"><span data-stu-id="7a25d-137">Run [Get-ServiceFabricNode](https://msdn.microsoft.com/library/mt125856.aspx) to make sure that the node has indeed transitioned to disabled.</span></span> <span data-ttu-id="7a25d-138">Si ce n’est pas le cas, patientez jusqu'à ce que le nœud soit désactivé.</span><span class="sxs-lookup"><span data-stu-id="7a25d-138">If not, wait until the node is disabled.</span></span> <span data-ttu-id="7a25d-139">Vous ne pouvez pas accélérer cette étape.</span><span class="sxs-lookup"><span data-stu-id="7a25d-139">You cannot hurry this step.</span></span>
3. <span data-ttu-id="7a25d-140">Suivez les exemples/instructions dans la [galerie de modèles de démarrage rapide](https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-scale-existing) pour modifier le nombre de machines virtuelles d’une unité dans ce Nodetype.</span><span class="sxs-lookup"><span data-stu-id="7a25d-140">Follow the sample/instructions in the [quick start template gallery](https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-scale-existing) to change the number of VMs by one in that Nodetype.</span></span> <span data-ttu-id="7a25d-141">L’instance supprimée est l’instance de machine virtuelle la plus élevée.</span><span class="sxs-lookup"><span data-stu-id="7a25d-141">The instance removed is the highest VM instance.</span></span> 
4. <span data-ttu-id="7a25d-142">Répétez les étapes 1 à 3 selon vos besoins, mais ne faites jamais descendre en puissance le nombre d’instances sur les types de nœuds principaux sur une valeur inférieure à celle garantie par le niveau de fiabilité.</span><span class="sxs-lookup"><span data-stu-id="7a25d-142">Repeat steps 1 through 3 as needed, but never scale down the number of instances in the primary node types less than what the reliability tier warrants.</span></span> <span data-ttu-id="7a25d-143">Consultez [les détails sur les niveaux de fiabilité ici](service-fabric-cluster-capacity.md).</span><span class="sxs-lookup"><span data-stu-id="7a25d-143">Refer to [the details on reliability tiers here](service-fabric-cluster-capacity.md).</span></span> 

## <a name="manually-remove-vms-from-the-non-primary-node-typevirtual-machine-scale-set"></a><span data-ttu-id="7a25d-144">Supprimer manuellement des machines virtuelles du type de nœud/groupe de machines virtuelles identiques non principal</span><span class="sxs-lookup"><span data-stu-id="7a25d-144">Manually remove VMs from the non-primary node type/Virtual Machine scale set</span></span>
> [!NOTE]
> <span data-ttu-id="7a25d-145">Pour un service avec état, un certain nombre de nœuds doivent toujours fonctionner afin de maintenir la disponibilité et de conserver l’état de votre service.</span><span class="sxs-lookup"><span data-stu-id="7a25d-145">For a stateful service, you need a certain number of nodes to be always up to maintain availability and preserve state of your service.</span></span> <span data-ttu-id="7a25d-146">Au minimum, le nombre de nœuds doit être égal au nombre de jeux de réplicas cibles du service/de la partition.</span><span class="sxs-lookup"><span data-stu-id="7a25d-146">At the very minimum, you need the number of nodes equal to the target replica set count of the partition/service.</span></span> 
> 
> 

<span data-ttu-id="7a25d-147">Vous devez exécuter les étapes suivantes sur une instance de machine virtuelle à la fois.</span><span class="sxs-lookup"><span data-stu-id="7a25d-147">You need the execute the following steps one VM instance at a time.</span></span> <span data-ttu-id="7a25d-148">Ceci permet d’arrêter correctement les services système (et vos services avec état) sur l’instance de machine virtuelle que vous supprimez et les nouveaux réplicas créés ailleurs.</span><span class="sxs-lookup"><span data-stu-id="7a25d-148">This allows for the system services (and your stateful services) to be shut down gracefully on the VM instance you are removing and new replicas created else where.</span></span>

1. <span data-ttu-id="7a25d-149">Exécutez [Disable-ServiceFabricNode](https://msdn.microsoft.com/library/mt125852.aspx) avec « RemoveNode » pour désactiver le nœud que vous souhaitez supprimer (l’instance la plus élevée dans ce type de nœud).</span><span class="sxs-lookup"><span data-stu-id="7a25d-149">Run [Disable-ServiceFabricNode](https://msdn.microsoft.com/library/mt125852.aspx) with intent ‘RemoveNode’ to disable the node you’re going to remove (the highest instance in that node type).</span></span>
2. <span data-ttu-id="7a25d-150">Exécutez [Get-ServiceFabricNode](https://msdn.microsoft.com/library/mt125856.aspx) pour vous assurer que le nœud est en effet passé à l’état désactivé.</span><span class="sxs-lookup"><span data-stu-id="7a25d-150">Run [Get-ServiceFabricNode](https://msdn.microsoft.com/library/mt125856.aspx) to make sure that the node has indeed transitioned to disabled.</span></span> <span data-ttu-id="7a25d-151">Si ce n’est pas le cas, patientez jusqu'à ce que le nœud soit désactivé.</span><span class="sxs-lookup"><span data-stu-id="7a25d-151">If not wait till the node is disabled.</span></span> <span data-ttu-id="7a25d-152">Vous ne pouvez pas accélérer cette étape.</span><span class="sxs-lookup"><span data-stu-id="7a25d-152">You cannot hurry this step.</span></span>
3. <span data-ttu-id="7a25d-153">Suivez les exemples/instructions dans la [galerie de modèles de démarrage rapide](https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-scale-existing) pour modifier le nombre de machines virtuelles d’une unité dans ce Nodetype.</span><span class="sxs-lookup"><span data-stu-id="7a25d-153">Follow the sample/instructions in the [quick start template gallery](https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-scale-existing) to change the number of VMs by one in that Nodetype.</span></span> <span data-ttu-id="7a25d-154">Ceci supprime l’instance de machine virtuelle la plus élevée.</span><span class="sxs-lookup"><span data-stu-id="7a25d-154">This will now remove the highest VM instance.</span></span> 
4. <span data-ttu-id="7a25d-155">Répétez les étapes 1 à 3 selon vos besoins, mais ne faites jamais descendre en puissance le nombre d’instances sur les types de nœuds principaux sur une valeur inférieure à celle garantie par le niveau de fiabilité.</span><span class="sxs-lookup"><span data-stu-id="7a25d-155">Repeat steps 1 through 3 as needed, but never scale down the number of instances in the primary node types less than what the reliability tier warrants.</span></span> <span data-ttu-id="7a25d-156">Consultez [les détails sur les niveaux de fiabilité ici](service-fabric-cluster-capacity.md).</span><span class="sxs-lookup"><span data-stu-id="7a25d-156">Refer to [the details on reliability tiers here](service-fabric-cluster-capacity.md).</span></span>

## <a name="behaviors-you-may-observe-in-service-fabric-explorer"></a><span data-ttu-id="7a25d-157">Comportements que vous pouvez observer dans Service Fabric Explorer</span><span class="sxs-lookup"><span data-stu-id="7a25d-157">Behaviors you may observe in Service Fabric Explorer</span></span>
<span data-ttu-id="7a25d-158">Lorsque vous faites monter un cluster en puissance, Service Fabric Explorer reflète le nombre de nœuds (instances de groupe de machines virtuelles identiques) qui font partie du cluster.</span><span class="sxs-lookup"><span data-stu-id="7a25d-158">When you scale up a cluster the Service Fabric Explorer will reflect the number of nodes (Virtual Machine scale set instances) that are part of the cluster.</span></span>  <span data-ttu-id="7a25d-159">Toutefois, lorsque vous faites descendre un cluster en puissance, le nœud/l’instance de machine virtuelle supprimé reste affiché avec un état défectueux, sauf si vous appelez la [commande Remove-ServiceFabricNodeState](https://msdn.microsoft.com/library/mt125993.aspx) avec le nom de nœud approprié.</span><span class="sxs-lookup"><span data-stu-id="7a25d-159">However, when you scale a cluster down you will see the removed node/VM instance displayed in an unhealthy state unless you call [Remove-ServiceFabricNodeState cmd](https://msdn.microsoft.com/library/mt125993.aspx) with the appropriate node name.</span></span>   

<span data-ttu-id="7a25d-160">Voici l’explication de ce comportement.</span><span class="sxs-lookup"><span data-stu-id="7a25d-160">Here is the explanation for this behavior.</span></span>

<span data-ttu-id="7a25d-161">Les nœuds répertoriés dans Service Fabric Explorer reflètent ce que savent les services système Service Fabric (FM spécifiquement) quant au nombre de nœuds que possède/possédait le cluster.</span><span class="sxs-lookup"><span data-stu-id="7a25d-161">The nodes listed in Service Fabric Explorer are a reflection of what the Service Fabric system services (FM specifically) knows about the number of nodes the cluster had/has.</span></span> <span data-ttu-id="7a25d-162">Lorsque vous faites descendre en puissance le groupe de machines virtuelles identiques, la machine virtuelle est supprimée mais le service système FM croit toujours que le nœud (mappé à la machine virtuelle qui a été supprimée) reviendra.</span><span class="sxs-lookup"><span data-stu-id="7a25d-162">When you scale the Virtual Machine scale set down, the VM was deleted but FM system service still thinks that the node (that was mapped to the VM that was deleted) will come back.</span></span> <span data-ttu-id="7a25d-163">Par conséquent, Service Fabric Explorer continue d’afficher ce nœud (même si l’état d’intégrité peut être inconnu ou un état d’erreur).</span><span class="sxs-lookup"><span data-stu-id="7a25d-163">So Service Fabric Explorer continues to display that node (though the health state may be error or unknown).</span></span>

<span data-ttu-id="7a25d-164">Pour vous assurer qu’un nœud est supprimé lorsqu’une machine virtuelle est supprimée, vous avez deux possibilités :</span><span class="sxs-lookup"><span data-stu-id="7a25d-164">In order to make sure that a node is removed when a VM is removed, you have two options:</span></span>

1) <span data-ttu-id="7a25d-165">Choisissez un niveau de durabilité Gold ou Silver (disponible prochainement) pour les types de nœuds de votre cluster, ce qui assure l’intégration de l’infrastructure.</span><span class="sxs-lookup"><span data-stu-id="7a25d-165">Choose a durability level of Gold or Silver (available soon) for the node types in your cluster, which gives you the infrastructure integration.</span></span> <span data-ttu-id="7a25d-166">Ceci supprimera automatiquement les nœuds de l’état de nos services système (FM) lors de la descente en puissance.</span><span class="sxs-lookup"><span data-stu-id="7a25d-166">Which will then automatically remove the nodes from our system services (FM) state when you scale down.</span></span>
<span data-ttu-id="7a25d-167">Consultez les [détails sur les niveaux de durabilité ici](service-fabric-cluster-capacity.md)</span><span class="sxs-lookup"><span data-stu-id="7a25d-167">Refer to [the details on durability levels here](service-fabric-cluster-capacity.md)</span></span>

2) <span data-ttu-id="7a25d-168">Après la descente en puissance de l’instance de machine virtuelle, vous devez appeler [l’applet de commande Remove-ServiceFabricNodeState](https://msdn.microsoft.com/library/mt125993.aspx).</span><span class="sxs-lookup"><span data-stu-id="7a25d-168">Once the VM instance has been scaled down, you need to call the [Remove-ServiceFabricNodeState cmdlet](https://msdn.microsoft.com/library/mt125993.aspx).</span></span>

> [!NOTE]
> <span data-ttu-id="7a25d-169">Les clusters Service Fabric nécessitent un certain nombre de nœuds actifs en permanence pour maintenir la disponibilité et préserver l’état, situation appelée « conservation du quorum ».</span><span class="sxs-lookup"><span data-stu-id="7a25d-169">Service Fabric clusters require a certain number of nodes to be up at all the time in order to maintain availability and preserve state - referred to as "maintaining quorum."</span></span> <span data-ttu-id="7a25d-170">Il est donc généralement déconseillé d’arrêter toutes les machines du cluster, sauf si vous avez d’abord effectué une [sauvegarde complète de votre état](service-fabric-reliable-services-backup-restore.md).</span><span class="sxs-lookup"><span data-stu-id="7a25d-170">So, it is typically unsafe to shut down all the machines in the cluster unless you have first performed a [full backup of your state](service-fabric-reliable-services-backup-restore.md).</span></span>
> 
> 

## <a name="next-steps"></a><span data-ttu-id="7a25d-171">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="7a25d-171">Next steps</span></span>
<span data-ttu-id="7a25d-172">Lisez les documents suivants pour en savoir plus sur la planification de la capacité du cluster, la mise à niveau d’un cluster et le partitionnement des services :</span><span class="sxs-lookup"><span data-stu-id="7a25d-172">Read the following to also learn about planning cluster capacity, upgrading a cluster, and partitioning services:</span></span>

* [<span data-ttu-id="7a25d-173">Planification de la capacité de votre cluster</span><span class="sxs-lookup"><span data-stu-id="7a25d-173">Plan your cluster capacity</span></span>](service-fabric-cluster-capacity.md)
* [<span data-ttu-id="7a25d-174">Mise à niveau des clusters</span><span class="sxs-lookup"><span data-stu-id="7a25d-174">Cluster upgrades</span></span>](service-fabric-cluster-upgrade.md)
* [<span data-ttu-id="7a25d-175">Partitionnement des services avec état pour une mise à l’échelle maximale</span><span class="sxs-lookup"><span data-stu-id="7a25d-175">Partition stateful services for maximum scale</span></span>](service-fabric-concepts-partitioning.md)

<!--Image references-->
[BrowseServiceFabricClusterResource]: ./media/service-fabric-cluster-scale-up-down/BrowseServiceFabricClusterResource.png
[ClusterResources]: ./media/service-fabric-cluster-scale-up-down/ClusterResources.png
