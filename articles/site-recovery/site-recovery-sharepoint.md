---
title: "aaaReplicate une application de SharePoint à plusieurs niveaux à l’aide d’Azure Site Recovery | Documents Microsoft"
description: "Cet article décrit comment tooreplicate une application de SharePoint à plusieurs niveaux à l’aide des fonctionnalités d’Azure Site Recovery."
services: site-recovery
documentationcenter: 
author: sujayt
manager: rochakm
editor: 
ms.assetid: 
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/10/2017
ms.author: sutalasi
ms.openlocfilehash: d856034ac2a3c95b0c1f0cf85e62c4e7a5a3210f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="replicate-a-multi-tier-sharepoint-application-for-disaster-recovery-using-azure-site-recovery"></a><span data-ttu-id="faca5-103">Répliquer une application SharePoint multiniveau pour la récupération d’urgence à l’aide d’Azure Site Recovery</span><span class="sxs-lookup"><span data-stu-id="faca5-103">Replicate a multi-tier SharePoint application for disaster recovery using Azure Site Recovery</span></span>

<span data-ttu-id="faca5-104">Cet article décrit en détail comment une application SharePoint à l’aide de tooprotect [Azure Site Recovery](site-recovery-overview.md).</span><span class="sxs-lookup"><span data-stu-id="faca5-104">This article describes in detail how tooprotect a SharePoint application using  [Azure Site Recovery](site-recovery-overview.md).</span></span>


## <a name="overview"></a><span data-ttu-id="faca5-105">Vue d'ensemble</span><span class="sxs-lookup"><span data-stu-id="faca5-105">Overview</span></span>

<span data-ttu-id="faca5-106">Microsoft SharePoint est une application puissante qui peut aider un groupe ou service à s’organiser, à collaborer et à partager des informations.</span><span class="sxs-lookup"><span data-stu-id="faca5-106">Microsoft SharePoint is a powerful application that can help a group or department organize, collaborate, and share information.</span></span> <span data-ttu-id="faca5-107">SharePoint permet les portails intranet, la gestion des documents et fichiers, la collaboration, les réseaux sociaux, les réseaux extranet, les sites web, la recherche de contenu d’entreprise et le décisionnel.</span><span class="sxs-lookup"><span data-stu-id="faca5-107">SharePoint can provide intranet portals, document and file management, collaboration, social networks, extranets, websites, enterprise search, and business intelligence.</span></span> <span data-ttu-id="faca5-108">Elle offre également des capacités d’intégration de système, d’intégration de processus et d’automatisation de flux de travail.</span><span class="sxs-lookup"><span data-stu-id="faca5-108">It also has system integration, process integration, and workflow automation capabilities.</span></span> <span data-ttu-id="faca5-109">En règle générale, les organisations le considérer comme un niveau 1 application sensibles toodowntime des pertes de données.</span><span class="sxs-lookup"><span data-stu-id="faca5-109">Typically, organizations consider it as a Tier-1 application sensitive toodowntime and data loss.</span></span>

<span data-ttu-id="faca5-110">Aujourd'hui, Microsoft SharePoint ne fournit aucune capacité de récupération d’urgence prête à l’emploi.</span><span class="sxs-lookup"><span data-stu-id="faca5-110">Today, Microsoft SharePoint  does not provide any out-of-the-box disaster recovery capabilities.</span></span> <span data-ttu-id="faca5-111">Quel que soit le type de hello et l’échelle d’un incident, récupération implique l’utilisation de hello d’un centre de données de secours que vous pouvez récupérer la batterie de serveurs hello pour.</span><span class="sxs-lookup"><span data-stu-id="faca5-111">Regardless of hello type and scale of a disaster, recovery involves hello use of a standby data center that you can recover hello farm to.</span></span> <span data-ttu-id="faca5-112">Centres de données de secours sont requis pour les scénarios où les systèmes redondants locaux et les sauvegardes ne peut pas récupérer à partir de la panne hello au centre de données principal hello.</span><span class="sxs-lookup"><span data-stu-id="faca5-112">Standby data centers are required for scenarios where local redundant systems and backups cannot recover from hello outage at hello primary data center.</span></span>

<span data-ttu-id="faca5-113">Une solution de récupération d’urgence doit permettre la modélisation des plans de récupération autour des architectures d’application complexe hello tels que SharePoint.</span><span class="sxs-lookup"><span data-stu-id="faca5-113">A good disaster recovery solution should allow modeling of recovery plans around hello  complex application architectures such as SharePoint.</span></span> <span data-ttu-id="faca5-114">Il doit également être hello capacité tooadd personnalisé étapes toohandle application mappages entre les différents niveaux et par conséquent permettent le basculement par simple clic avec une RTO inférieure dans les cas de hello d’urgence.</span><span class="sxs-lookup"><span data-stu-id="faca5-114">It should also have hello ability tooadd customized steps toohandle application mappings between various tiers and hence providing a single-click failover with a lower RTO in hello event of a disaster.</span></span>

<span data-ttu-id="faca5-115">Cet article décrit en détail comment une application SharePoint à l’aide de tooprotect [Azure Site Recovery](site-recovery-overview.md).</span><span class="sxs-lookup"><span data-stu-id="faca5-115">This article describes in detail how tooprotect a SharePoint application using [Azure Site Recovery](site-recovery-overview.md).</span></span> <span data-ttu-id="faca5-116">Cet article traite des meilleures pratiques pour la réplication d’un tooAzure d’application SharePoint à trois niveaux, comment vous pouvez effectuer un exercice de récupération d’urgence, et le mode de basculement hello application tooAzure.</span><span class="sxs-lookup"><span data-stu-id="faca5-116">This article will cover best practices for replicating a three tier SharePoint application tooAzure, how you can do a disaster recovery drill, and how you can failover hello application tooAzure.</span></span>

<span data-ttu-id="faca5-117">Vous pouvez regarder hello sous vidéo sur la récupération d’un tooAzure d’application de couche multiples.</span><span class="sxs-lookup"><span data-stu-id="faca5-117">You can watch hello below video about recovering a multi tier application tooAzure.</span></span>

> [!VIDEO https://channel9.msdn.com/Series/Azure-Site-Recovery/Disaster-Recovery-of-load-balanced-multi-tier-applications-using-Azure-Site-Recovery/player]


## <a name="prerequisites"></a><span data-ttu-id="faca5-118">Composants requis</span><span class="sxs-lookup"><span data-stu-id="faca5-118">Prerequisites</span></span>

<span data-ttu-id="faca5-119">Avant de commencer, assurez-vous que vous comprenez les suivant hello :</span><span class="sxs-lookup"><span data-stu-id="faca5-119">Before you start, make sure you understand hello following:</span></span>

1. [<span data-ttu-id="faca5-120">Réplication d’un tooAzure de machine virtuelle</span><span class="sxs-lookup"><span data-stu-id="faca5-120">Replicating a virtual machine tooAzure</span></span>](site-recovery-vmware-to-azure.md)
2. <span data-ttu-id="faca5-121">Comment trop[concevoir un réseau de récupération](site-recovery-network-design.md)</span><span class="sxs-lookup"><span data-stu-id="faca5-121">How too[design a recovery network](site-recovery-network-design.md)</span></span>
3. [<span data-ttu-id="faca5-122">Effectuer un tooAzure de basculement de test</span><span class="sxs-lookup"><span data-stu-id="faca5-122">Doing a test failover tooAzure</span></span>](site-recovery-test-failover-to-azure.md)
4. [<span data-ttu-id="faca5-123">Effectuer un basculement tooAzure</span><span class="sxs-lookup"><span data-stu-id="faca5-123">Doing a failover tooAzure</span></span>](site-recovery-failover.md)
5. <span data-ttu-id="faca5-124">Comment trop[répliquer un contrôleur de domaine](site-recovery-active-directory.md)</span><span class="sxs-lookup"><span data-stu-id="faca5-124">How too[replicate a domain controller](site-recovery-active-directory.md)</span></span>
6. <span data-ttu-id="faca5-125">Comment trop[répliquer de SQL Server](site-recovery-sql.md)</span><span class="sxs-lookup"><span data-stu-id="faca5-125">How too[replicate SQL Server](site-recovery-sql.md)</span></span>

## <a name="sharepoint-architecture"></a><span data-ttu-id="faca5-126">Architecture SharePoint</span><span class="sxs-lookup"><span data-stu-id="faca5-126">SharePoint architecture</span></span>

<span data-ttu-id="faca5-127">SharePoint peut être déployé sur un ou plusieurs serveurs à l’aide des topologies à plusieurs niveaux et les rôles de serveur tooimplement une conception de batterie de serveurs qui répond à des objectifs spécifiques.</span><span class="sxs-lookup"><span data-stu-id="faca5-127">SharePoint can be deployed on one or more servers using tiered topologies and server roles tooimplement a farm design that meets specific goals and objectives.</span></span> <span data-ttu-id="faca5-128">Une batterie de serveurs SharePoint de grande capacité et à forte demande qui prend en charge un grand nombre d’utilisateurs simultanés et un grand nombre d’éléments de contenu utilise le regroupement de service dans le cadre de sa stratégie d’évolutivité.</span><span class="sxs-lookup"><span data-stu-id="faca5-128">A typical large, high-demand SharePoint server farm that supports a high number of concurrent users and a large number of content items use service grouping as part of their scalability strategy.</span></span> <span data-ttu-id="faca5-129">Cette approche implique l’exécution des services sur des serveurs dédiés, regroupement de ces services et puis montée en puissance parallèle de serveurs de hello en tant que groupe.</span><span class="sxs-lookup"><span data-stu-id="faca5-129">This approach involves running services on dedicated servers, grouping these services together, and then scaling out hello servers as a group.</span></span> <span data-ttu-id="faca5-130">Hello topologie suivante illustre les service hello et serveur pour une batterie de serveurs SharePoint à trois niveaux de regroupement.</span><span class="sxs-lookup"><span data-stu-id="faca5-130">hello following topology illustrates hello service and server grouping for a three tier SharePoint server farm.</span></span> <span data-ttu-id="faca5-131">Pour obtenir des instructions détaillées sur les différentes topologies de SharePoint, consultez tooSharePoint documentation et les architectures de ligne de produit.</span><span class="sxs-lookup"><span data-stu-id="faca5-131">Please refer tooSharePoint documentation and product line architectures for detailed guidance on different SharePoint topologies.</span></span> <span data-ttu-id="faca5-132">Vous trouverez plus d’informations sur le déploiement de SharePoint 2013 dans [ce document](https://technet.microsoft.com/en-us/library/cc303422.aspx).</span><span class="sxs-lookup"><span data-stu-id="faca5-132">You can find more details about SharePoint 2013 deployment in [this document](https://technet.microsoft.com/en-us/library/cc303422.aspx).</span></span>



![Modèle de déploiement 1](./media/site-recovery-sharepoint/sharepointarch.png)


## <a name="site-recovery-support"></a><span data-ttu-id="faca5-134">Prise en charge de Site Recovery</span><span class="sxs-lookup"><span data-stu-id="faca5-134">Site Recovery support</span></span>

<span data-ttu-id="faca5-135">Pour la création de cet article, des machines virtuelles VMware avec Windows Server 2012 R2 Enterprise ont été utilisées.</span><span class="sxs-lookup"><span data-stu-id="faca5-135">For creating this article, VMware virtual machines with Windows Server 2012 R2 Enterprise were used.</span></span> <span data-ttu-id="faca5-136">Les applications SharePoint 2013 Enterprise Edition et SQL Server 2014 Enterprise Edition ont été utilisées.</span><span class="sxs-lookup"><span data-stu-id="faca5-136">SharePoint 2013 Enterprise edition and SQL server 2014 Enterprise edition were used.</span></span> <span data-ttu-id="faca5-137">Comme la réplication de Site Recovery est indépendant de l’application, les recommandations hello fournies ici concernent toohold attendu sur également les scénarios suivants.</span><span class="sxs-lookup"><span data-stu-id="faca5-137">As Site Recovery replication is application agnostic, hello recommendations provided here are expected toohold on for following scenarios as well.</span></span>

### <a name="source-and-target"></a><span data-ttu-id="faca5-138">Source et cible</span><span class="sxs-lookup"><span data-stu-id="faca5-138">Source and target</span></span>

<span data-ttu-id="faca5-139">**Scénario**</span><span class="sxs-lookup"><span data-stu-id="faca5-139">**Scenario**</span></span> | <span data-ttu-id="faca5-140">**site secondaire de tooa**</span><span class="sxs-lookup"><span data-stu-id="faca5-140">**tooa secondary site**</span></span> | <span data-ttu-id="faca5-141">**tooAzure**</span><span class="sxs-lookup"><span data-stu-id="faca5-141">**tooAzure**</span></span>
--- | --- | ---
<span data-ttu-id="faca5-142">**Hyper-V**</span><span class="sxs-lookup"><span data-stu-id="faca5-142">**Hyper-V**</span></span> | <span data-ttu-id="faca5-143">Oui</span><span class="sxs-lookup"><span data-stu-id="faca5-143">Yes</span></span> | <span data-ttu-id="faca5-144">Oui</span><span class="sxs-lookup"><span data-stu-id="faca5-144">Yes</span></span>
<span data-ttu-id="faca5-145">**VMware**</span><span class="sxs-lookup"><span data-stu-id="faca5-145">**VMware**</span></span> | <span data-ttu-id="faca5-146">Oui</span><span class="sxs-lookup"><span data-stu-id="faca5-146">Yes</span></span> | <span data-ttu-id="faca5-147">Oui</span><span class="sxs-lookup"><span data-stu-id="faca5-147">Yes</span></span>
<span data-ttu-id="faca5-148">**Serveur physique**</span><span class="sxs-lookup"><span data-stu-id="faca5-148">**Physical server**</span></span> | <span data-ttu-id="faca5-149">Oui</span><span class="sxs-lookup"><span data-stu-id="faca5-149">Yes</span></span> | <span data-ttu-id="faca5-150">Oui</span><span class="sxs-lookup"><span data-stu-id="faca5-150">Yes</span></span>

### <a name="sharepoint-versions"></a><span data-ttu-id="faca5-151">Versions de SharePoint</span><span class="sxs-lookup"><span data-stu-id="faca5-151">SharePoint Versions</span></span>
<span data-ttu-id="faca5-152">Hello SharePoint server versions suivantes est prises en charge.</span><span class="sxs-lookup"><span data-stu-id="faca5-152">hello following SharePoint server versions are supported.</span></span>

* <span data-ttu-id="faca5-153">SharePoint Server 2013 Standard</span><span class="sxs-lookup"><span data-stu-id="faca5-153">SharePoint server 2013 Standard</span></span>
* <span data-ttu-id="faca5-154">SharePoint Server 2013 Enterprise</span><span class="sxs-lookup"><span data-stu-id="faca5-154">SharePoint server 2013 Enterprise</span></span>
* <span data-ttu-id="faca5-155">SharePoint Server 2016 Standard</span><span class="sxs-lookup"><span data-stu-id="faca5-155">SharePoint server 2016 Standard</span></span>
* <span data-ttu-id="faca5-156">SharePoint Server 2016 Enterprise</span><span class="sxs-lookup"><span data-stu-id="faca5-156">SharePoint server 2016 Enterprise</span></span>

### <a name="things-tookeep-in-mind"></a><span data-ttu-id="faca5-157">Tookeep choses à l’esprit</span><span class="sxs-lookup"><span data-stu-id="faca5-157">Things tookeep in mind</span></span>

<span data-ttu-id="faca5-158">Si vous utilisez un cluster basé sur le disque partagé en tant que n’importe quel niveau dans votre application, puis à ne pas être en mesure de toouse Site Recovery réplication tooreplicate ces ordinateurs virtuels.</span><span class="sxs-lookup"><span data-stu-id="faca5-158">If you are using a shared disk-based cluster as any tier in your application then you will not be able toouse Site Recovery replication tooreplicate those virtual machines.</span></span> <span data-ttu-id="faca5-159">Vous pouvez utiliser la réplication native fournie par l’application hello, puis utiliser un [plan de récupération](site-recovery-create-recovery-plans.md) toofailover tous les niveaux.</span><span class="sxs-lookup"><span data-stu-id="faca5-159">You can use native replication provided by hello application and then use a [recovery plan](site-recovery-create-recovery-plans.md) toofailover all tiers.</span></span>

## <a name="replicating-virtual-machines"></a><span data-ttu-id="faca5-160">Réplication des machines virtuelles</span><span class="sxs-lookup"><span data-stu-id="faca5-160">Replicating virtual machines</span></span>

<span data-ttu-id="faca5-161">Suivez [ce guide](site-recovery-vmware-to-azure.md) toostart tooAzure de machine virtuelle hello de réplication.</span><span class="sxs-lookup"><span data-stu-id="faca5-161">Follow [this guidance](site-recovery-vmware-to-azure.md) toostart replicating hello virtual machine tooAzure.</span></span>

* <span data-ttu-id="faca5-162">Une fois la réplication hello est terminée, assurez-vous que vous ordinateur virtuel de tooeach de chaque couche et sélectionnez le même groupe à haute disponibilité ' répliqué élément > Paramètres > Propriétés > calcul et réseau ».</span><span class="sxs-lookup"><span data-stu-id="faca5-162">Once hello replication is complete, make sure you go tooeach virtual machine of each tier and select same availability set in 'Replicated item > Settings > Properties > Compute and Network'.</span></span> <span data-ttu-id="faca5-163">Par exemple, si votre niveau web a 3 machines virtuelles, assurez-vous de hello toutes les machines 3 virtuelles sont configurés partie toobe du même groupe de disponibilité dans Azure.</span><span class="sxs-lookup"><span data-stu-id="faca5-163">For example, if your web tier has 3 VMs, ensure all hello 3 VMs are configured toobe part of same availability set in Azure.</span></span>

    ![Set-Availability-Set](./media/site-recovery-sharepoint/select-av-set.png)

* <span data-ttu-id="faca5-165">Pour obtenir des conseils sur la protection de Active Directory et DNS, voir la rubrique trop[protéger Active Directory et DNS](site-recovery-active-directory.md) document.</span><span class="sxs-lookup"><span data-stu-id="faca5-165">For guidance on protecting Active Directory and DNS, refer too[Protect Active Directory and DNS](site-recovery-active-directory.md) document.</span></span>

* <span data-ttu-id="faca5-166">Pour obtenir des conseils sur la protection de niveau base de données en cours d’exécution sur SQL server, voir la rubrique trop[protéger SQL Server](site-recovery-active-directory.md) document.</span><span class="sxs-lookup"><span data-stu-id="faca5-166">For guidance on protecting database tier running on SQL server, refer too[Protect SQL Server](site-recovery-active-directory.md) document.</span></span>

## <a name="networking-configuration"></a><span data-ttu-id="faca5-167">Configuration de la mise en réseau</span><span class="sxs-lookup"><span data-stu-id="faca5-167">Networking configuration</span></span>

### <a name="network-properties"></a><span data-ttu-id="faca5-168">Propriétés du réseau</span><span class="sxs-lookup"><span data-stu-id="faca5-168">Network properties</span></span>

* <span data-ttu-id="faca5-169">Pour hello application et le niveau Web machines virtuelles, configurez les paramètres de réseau dans le portail Azure afin que machines virtuelles de hello toohello attaché droite DR réseau après le basculement.</span><span class="sxs-lookup"><span data-stu-id="faca5-169">For hello App and Web tier VMs, configure network settings in Azure portal so that hello VMs get attached toohello right DR network after failover.</span></span>

    ![Sélectionner le réseau](./media/site-recovery-sharepoint/select-network.png)


* <span data-ttu-id="faca5-171">Si vous utilisez une adresse IP statique, puis spécifiez IP hello souhaité hello tootake de machine virtuelle Bonjour **adresse IP cible** champ</span><span class="sxs-lookup"><span data-stu-id="faca5-171">If you are using a static IP, then specify hello IP that you want hello virtual machine tootake in hello **Target IP** field</span></span>

    ![Définir l’adresse IP statique](./media/site-recovery-sharepoint/set-static-ip.png)

### <a name="dns-and-traffic-routing"></a><span data-ttu-id="faca5-173">Routage du trafic et DNS</span><span class="sxs-lookup"><span data-stu-id="faca5-173">DNS and Traffic Routing</span></span>

<span data-ttu-id="faca5-174">Pour internet faisant face à des sites, [créer un profil Traffic Manager de type de 'Priority'](../traffic-manager/traffic-manager-create-profile.md) Bonjour abonnement Azure.</span><span class="sxs-lookup"><span data-stu-id="faca5-174">For internet facing sites, [create a Traffic Manager profile of 'Priority' type](../traffic-manager/traffic-manager-create-profile.md) in hello Azure subscription.</span></span> <span data-ttu-id="faca5-175">Puis configurez votre profil Traffic Manager et de DNS Bonjour suivant manière.</span><span class="sxs-lookup"><span data-stu-id="faca5-175">And then configure your DNS and Traffic Manager profile in hello following manner.</span></span>


| <span data-ttu-id="faca5-176">**Where**</span><span class="sxs-lookup"><span data-stu-id="faca5-176">**Where**</span></span> | <span data-ttu-id="faca5-177">**Source**</span><span class="sxs-lookup"><span data-stu-id="faca5-177">**Source**</span></span> | <span data-ttu-id="faca5-178">**Cible**</span><span class="sxs-lookup"><span data-stu-id="faca5-178">**Target**</span></span>|
| --- | --- | --- |
| <span data-ttu-id="faca5-179">DNS public</span><span class="sxs-lookup"><span data-stu-id="faca5-179">Public DNS</span></span> | <span data-ttu-id="faca5-180">DNS public pour les sites SharePoint</span><span class="sxs-lookup"><span data-stu-id="faca5-180">Public DNS for SharePoint sites</span></span> <br/><br/> <span data-ttu-id="faca5-181">Exemple : sharepoint.contoso.com</span><span class="sxs-lookup"><span data-stu-id="faca5-181">Ex: sharepoint.contoso.com</span></span> | <span data-ttu-id="faca5-182">Traffic Manager</span><span class="sxs-lookup"><span data-stu-id="faca5-182">Traffic Manager</span></span> <br/><br/> <span data-ttu-id="faca5-183">contososharepoint.trafficmanager.net</span><span class="sxs-lookup"><span data-stu-id="faca5-183">contososharepoint.trafficmanager.net</span></span> |
| <span data-ttu-id="faca5-184">DNS local</span><span class="sxs-lookup"><span data-stu-id="faca5-184">On-premises DNS</span></span> | <span data-ttu-id="faca5-185">sharepointonprem.contoso.com</span><span class="sxs-lookup"><span data-stu-id="faca5-185">sharepointonprem.contoso.com</span></span> | <span data-ttu-id="faca5-186">Adresse IP publique sur la batterie de serveurs locale hello</span><span class="sxs-lookup"><span data-stu-id="faca5-186">Public IP on hello on-premises farm</span></span> |


<span data-ttu-id="faca5-187">Bonjour, le profil Traffic Manager [créer des points de terminaison principal et de récupération hello](../traffic-manager/traffic-manager-configure-priority-routing-method.md).</span><span class="sxs-lookup"><span data-stu-id="faca5-187">In hello Traffic Manager profile, [create hello primary and recovery endpoints](../traffic-manager/traffic-manager-configure-priority-routing-method.md).</span></span> <span data-ttu-id="faca5-188">Utilisez le point de terminaison externe hello pour le point de terminaison local et l’adresse IP publique pour le point de terminaison Azure.</span><span class="sxs-lookup"><span data-stu-id="faca5-188">Use hello external endpoint for on-premises endpoint and public IP for Azure endpoint.</span></span> <span data-ttu-id="faca5-189">Assurez-vous que priorité de hello est définie de point de terminaison local tooon plus élevée.</span><span class="sxs-lookup"><span data-stu-id="faca5-189">Ensure that hello priority is set higher tooon-premises endpoint.</span></span>

<span data-ttu-id="faca5-190">Hôte d’une page de test sur un port spécifique (par exemple, 800) de niveau de web SharePoint hello par ordre de Traffic Manager tooautomatically détecter disponibilité après basculement.</span><span class="sxs-lookup"><span data-stu-id="faca5-190">Host a test page on a specific port (for example, 800) in hello SharePoint web tier in order for Traffic Manager tooautomatically detect availability post failover.</span></span> <span data-ttu-id="faca5-191">Il s’agit d’une solution de contournement si vous ne pouvez pas activer l’authentification anonyme sur un de vos sites SharePoint.</span><span class="sxs-lookup"><span data-stu-id="faca5-191">This is a workaround in case you cannot enable anonymous authentication on any of your SharePoint sites.</span></span>

<span data-ttu-id="faca5-192">[Configurer le profil Traffic Manager hello](../traffic-manager/traffic-manager-configure-priority-routing-method.md) avec hello sous les paramètres.</span><span class="sxs-lookup"><span data-stu-id="faca5-192">[Configure hello Traffic Manager profile](../traffic-manager/traffic-manager-configure-priority-routing-method.md) with hello below settings.</span></span>

* <span data-ttu-id="faca5-193">Méthode de routage - « Priorité »</span><span class="sxs-lookup"><span data-stu-id="faca5-193">Routing method - 'Priority'</span></span>
* <span data-ttu-id="faca5-194">DNS heure toolive (TTL) - « 30 secondes'</span><span class="sxs-lookup"><span data-stu-id="faca5-194">DNS time toolive (TTL) - '30 seconds'</span></span>
* <span data-ttu-id="faca5-195">Paramètres d’analyse de point de terminaison - Si vous pouvez activer l’authentification anonyme, vous pouvez donner un point de terminaison de site web spécifique.</span><span class="sxs-lookup"><span data-stu-id="faca5-195">Endpoint monitor settings - If you can enable anonymous authentication, you can give a specific website endpoint.</span></span> <span data-ttu-id="faca5-196">Ou bien, vous pouvez utiliser une page de test sur un port spécifique (800 par exemple).</span><span class="sxs-lookup"><span data-stu-id="faca5-196">Or, you can use a test page on a specific port (for example, 800).</span></span>

## <a name="creating-a-recovery-plan"></a><span data-ttu-id="faca5-197">Création d’un plan de récupération</span><span class="sxs-lookup"><span data-stu-id="faca5-197">Creating a recovery plan</span></span>

<span data-ttu-id="faca5-198">Un plan de récupération permet de séquençage hello de basculement de différents niveaux dans une application multicouche, par conséquent, de maintenir la cohérence des applications.</span><span class="sxs-lookup"><span data-stu-id="faca5-198">A recovery plan allows sequencing hello failover of various tiers in a multi-tier application, hence, maintaining application consistency.</span></span> <span data-ttu-id="faca5-199">Lors de la création d’un plan de récupération pour une application web multicouche, suivez hello étapes ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="faca5-199">Follow hello below steps while creating a recovery plan for a multi-tier web application.</span></span> <span data-ttu-id="faca5-200">[En savoir plus sur la création d’un plan de récupération](site-recovery-runbook-automation.md#customize-the-recovery-plan).</span><span class="sxs-lookup"><span data-stu-id="faca5-200">[Learn more about creating a recovery plan](site-recovery-runbook-automation.md#customize-the-recovery-plan).</span></span>

### <a name="adding-virtual-machines-toofailover-groups"></a><span data-ttu-id="faca5-201">Ajout de groupes de machines virtuelles toofailover</span><span class="sxs-lookup"><span data-stu-id="faca5-201">Adding virtual machines toofailover groups</span></span>

1. <span data-ttu-id="faca5-202">Créer un plan de récupération en ajoutant hello application et le niveau Web machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="faca5-202">Create a recovery plan by adding hello App and Web tier VMs.</span></span>
2. <span data-ttu-id="faca5-203">Cliquez sur « Personnaliser » toogroup hello machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="faca5-203">Click on 'Customize' toogroup hello VMs.</span></span> <span data-ttu-id="faca5-204">Par défaut, toutes les machines virtuelles font partie du « Groupe 1 ».</span><span class="sxs-lookup"><span data-stu-id="faca5-204">By default, all VMs are part of 'Group 1'.</span></span>

    ![Personnaliser un RP](./media/site-recovery-sharepoint/rp-groups.png)

3. <span data-ttu-id="faca5-206">Créer un autre groupe (groupe 2) et déplacer le niveau Web de hello machines virtuelles dans le nouveau groupe de hello.</span><span class="sxs-lookup"><span data-stu-id="faca5-206">Create another Group (Group 2) and move hello Web tier VMs into hello new group.</span></span> <span data-ttu-id="faca5-207">Vos machines virtuelles de niveau application doivent faire partie du « Groupe 1 » tandis que les machines virtuelles de niveau web doivent faire partie du « Groupe 2 ».</span><span class="sxs-lookup"><span data-stu-id="faca5-207">Your App tier VMs should be part of 'Group 1' and Web tier VMs should be part of 'Group 2'.</span></span> <span data-ttu-id="faca5-208">Il s’agit de tooensure qui hello application machines virtuelles de couche démarrer tout d’abord suivi par les ordinateurs virtuels du niveau Web.</span><span class="sxs-lookup"><span data-stu-id="faca5-208">This is tooensure that hello App tier VMs boot up first followed by Web tier VMs.</span></span>


### <a name="adding-scripts-toohello-recovery-plan"></a><span data-ttu-id="faca5-209">Ajout de scripts de plan de récupération toohello</span><span class="sxs-lookup"><span data-stu-id="faca5-209">Adding scripts toohello recovery plan</span></span>

<span data-ttu-id="faca5-210">Vous pouvez déployer les scripts d’Azure Site Recovery hello couramment utilisé dans votre compte Automation bouton hello « Déployer tooAzure » ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="faca5-210">You can deploy hello most commonly used Azure Site Recovery scripts into your Automation account clicking hello 'Deploy tooAzure' button below.</span></span> <span data-ttu-id="faca5-211">Lorsque vous utilisez n’importe quel script publiée, assurez-vous que vous suivez les instructions de hello dans le script de hello.</span><span class="sxs-lookup"><span data-stu-id="faca5-211">When you are using any published script, ensure you follow hello guidance in hello script.</span></span>

<span data-ttu-id="faca5-212">[![Déployer tooAzure](https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/c4803408-340e-49e3-9a1f-0ed3f689813d.png)](https://aka.ms/asr-automationrunbooks-deploy)</span><span class="sxs-lookup"><span data-stu-id="faca5-212">[![Deploy tooAzure](https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/c4803408-340e-49e3-9a1f-0ed3f689813d.png)](https://aka.ms/asr-automationrunbooks-deploy)</span></span>

1. <span data-ttu-id="faca5-213">Ajouter un script de pré too'Group 1' toofailover groupe de disponibilité SQL.</span><span class="sxs-lookup"><span data-stu-id="faca5-213">Add a pre-action script too'Group 1' toofailover SQL Availability group.</span></span> <span data-ttu-id="faca5-214">Utiliser hello 'ASR-SQL-FailoverAG' script est publié dans les exemples de scripts hello.</span><span class="sxs-lookup"><span data-stu-id="faca5-214">Use hello 'ASR-SQL-FailoverAG' script published in hello sample scripts.</span></span> <span data-ttu-id="faca5-215">Assurez-vous de, suivez les instructions de hello de script de hello et apporter des modifications de hello requis dans le script de hello en conséquence.</span><span class="sxs-lookup"><span data-stu-id="faca5-215">Ensure you follow hello guidance in hello script and make hello required changes in hello script appropriately.</span></span>

    ![Add-AG-Script-Step-1](./media/site-recovery-sharepoint/add-ag-script-step1.png)

    ![Add-AG-Script-Step-2](./media/site-recovery-sharepoint/add-ag-script-step2.png)

2. <span data-ttu-id="faca5-218">Ajouter un tooattach de script action post un équilibrage de charge sur hello machines virtuelles ayant basculé de niveau de Web (groupe 2).</span><span class="sxs-lookup"><span data-stu-id="faca5-218">Add a post action script tooattach a load balancer on hello failed over virtual machines of Web tier (Group 2).</span></span> <span data-ttu-id="faca5-219">Utiliser hello 'ASR-AddSingleLoadBalancer' script est publié dans les exemples de scripts hello.</span><span class="sxs-lookup"><span data-stu-id="faca5-219">Use hello 'ASR-AddSingleLoadBalancer' script published in hello sample scripts.</span></span> <span data-ttu-id="faca5-220">Assurez-vous de, suivez les instructions de hello de script de hello et apporter des modifications de hello requis dans le script de hello en conséquence.</span><span class="sxs-lookup"><span data-stu-id="faca5-220">Ensure you follow hello guidance in hello script and make hello required changes in hello script appropriately.</span></span>

    ![Add-LB-Script-Step-1](./media/site-recovery-sharepoint/add-lb-script-step1.png)

    ![Add-LB-Script-Step-2](./media/site-recovery-sharepoint/add-lb-script-step2.png)

3. <span data-ttu-id="faca5-223">Ajoutez une étape manuelle tooupdate hello DNS les enregistrements toopoint toohello nouvelle batterie de serveurs dans Azure.</span><span class="sxs-lookup"><span data-stu-id="faca5-223">Add a manual step tooupdate hello DNS records toopoint toohello new farm in Azure.</span></span>

    * <span data-ttu-id="faca5-224">Pour les sites accessibles sur Internet, aucune mise à jour des DNS n’est obligatoire après le basculement.</span><span class="sxs-lookup"><span data-stu-id="faca5-224">For internet facing sites, no DNS updates are required post failover.</span></span> <span data-ttu-id="faca5-225">Hello les étapes décrites dans la section tooconfigure Traffic Manager de hello « Guide de mise en réseau ».</span><span class="sxs-lookup"><span data-stu-id="faca5-225">Follow hello steps described in hello 'Networking guidance' section tooconfigure Traffic Manager.</span></span> <span data-ttu-id="faca5-226">Si hello profil Traffic Manager a été configuré comme décrit dans la section précédente de hello, ajoutez un port de factice de tooopen (800 dans l’exemple de hello) de script sur hello machine virtuelle Azure.</span><span class="sxs-lookup"><span data-stu-id="faca5-226">If hello Traffic Manager profile has been set up as described in hello previous section, add a script tooopen dummy port (800 in hello example) on hello Azure VM.</span></span>

    * <span data-ttu-id="faca5-227">Pour les sites internes exposés à ajouter charge équilibrage IP d’une étape manuelle tooupdate hello DNS toopoint enregistrement toohello Web niveau machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="faca5-227">For internal facing sites, add a manual step tooupdate hello DNS record toopoint toohello new Web tier VM’s load balancer IP.</span></span>

4. <span data-ttu-id="faca5-228">Ajouter une application de recherche toorestore étape manuelle à partir d’une sauvegarde ou démarrer un nouveau service de recherche.</span><span class="sxs-lookup"><span data-stu-id="faca5-228">Add a manual step toorestore search application from a backup or start a new search service.</span></span>

5. <span data-ttu-id="faca5-229">Pour restaurer l’application de service de recherche à partir d’une sauvegarde, suivez les étapes ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="faca5-229">For restoring Search service application from a backup, follow below steps.</span></span>

    * <span data-ttu-id="faca5-230">Cette méthode suppose qu’une sauvegarde de hello Application de Service de recherche a été effectuée avant les événements graves hello et que la sauvegarde hello est disponible sur le site de récupération d’urgence de hello.</span><span class="sxs-lookup"><span data-stu-id="faca5-230">This method assumes that a backup of hello Search Service Application was performed before hello catastrophic event and that hello backup is available at hello DR site.</span></span>
    * <span data-ttu-id="faca5-231">Peut facilement être cela par la planification de sauvegarde de hello (par exemple, une fois par jour) et à l’aide d’une sauvegarde de copie procédure tooplace hello sur site de récupération d’urgence de hello.</span><span class="sxs-lookup"><span data-stu-id="faca5-231">This can easily be achieved by scheduling hello backup (for example, once daily) and using a copy procedure tooplace hello backup at hello DR site.</span></span> <span data-ttu-id="faca5-232">Les procédures de copie peuvent inclure des programmes par script comme AzCopy (Azure Copy) ou la configuration de DFSR (Distributed File Services Replication).</span><span class="sxs-lookup"><span data-stu-id="faca5-232">Copy procedures could include scripted programs such as AzCopy (Azure Copy) or setting up DFSR (Distributed File Services Replication).</span></span>
    * <span data-ttu-id="faca5-233">Maintenant que hello SharePoint batterie de serveurs est en cours d’exécution, accédez hello l’Administration centrale, « Sauvegarde et restauration » et sélectionnez Restaurer.</span><span class="sxs-lookup"><span data-stu-id="faca5-233">Now that hello SharePoint farm is running, navigate hello Central Administration, 'Backup and Restore' and select Restore.</span></span> <span data-ttu-id="faca5-234">emplacement de sauvegarde hello spécifié interroge Hello restauration (vous devrez peut-être valeur hello de tooupdate).</span><span class="sxs-lookup"><span data-stu-id="faca5-234">hello restore interrogates hello backup location specified (you may need tooupdate hello value).</span></span> <span data-ttu-id="faca5-235">Sélectionnez la sauvegarde de l’Application de Service de recherche hello toorestore voulue.</span><span class="sxs-lookup"><span data-stu-id="faca5-235">Select hello Search Service Application backup you would like toorestore.</span></span>
    * <span data-ttu-id="faca5-236">La recherche est restaurée.</span><span class="sxs-lookup"><span data-stu-id="faca5-236">Search is restored.</span></span> <span data-ttu-id="faca5-237">N’oubliez pas que hello restauration attend toofind hello même topologie (même nombre de serveurs) et le même disque dur lettres affectées toothose serveurs.</span><span class="sxs-lookup"><span data-stu-id="faca5-237">Keep in mind that hello restore expects toofind hello same topology (same number of servers) and same hard drive letters assigned toothose servers.</span></span> <span data-ttu-id="faca5-238">Pour plus d’informations, consultez le document [« Restaurer une application de service de recherche dans SharePoint 2013 »](https://technet.microsoft.com/library/ee748654.aspx).</span><span class="sxs-lookup"><span data-stu-id="faca5-238">For more information, see ['Restore Search service application in SharePoint 2013'](https://technet.microsoft.com/library/ee748654.aspx) document.</span></span>


6. <span data-ttu-id="faca5-239">Pour démarrer avec une nouvelle application de service de recherche, suivez les étapes ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="faca5-239">For starting with a new Search service application, follow below steps.</span></span>

    * <span data-ttu-id="faca5-240">Cette méthode suppose qu’une sauvegarde de base de données « Administration de la recherche » hello est disponible sur le site de récupération d’urgence de hello.</span><span class="sxs-lookup"><span data-stu-id="faca5-240">This method assumes that a backup of hello “Search Administration” database is available at hello DR site.</span></span>
    * <span data-ttu-id="faca5-241">Hello autres bases de données d’Application de Service de recherche ne sont pas répliqués, ils doivent toobe recréée.</span><span class="sxs-lookup"><span data-stu-id="faca5-241">Since hello other Search Service Application databases are not replicated, they need toobe re-created.</span></span> <span data-ttu-id="faca5-242">Par conséquent, les toodo accédez tooCentral Administration et supprimer l’Application de Service de recherche de hello.</span><span class="sxs-lookup"><span data-stu-id="faca5-242">toodo so, navigate tooCentral Administration and delete hello Search Service Application.</span></span> <span data-ttu-id="faca5-243">Sur les serveurs qui hello hôte Index de recherche, supprimer les fichiers d’index hello.</span><span class="sxs-lookup"><span data-stu-id="faca5-243">On any servers which host hello Search Index, delete hello index files.</span></span>
    * <span data-ttu-id="faca5-244">Recréer hello Application de Service de recherche et il recrée les bases de données hello.</span><span class="sxs-lookup"><span data-stu-id="faca5-244">Re-create hello Search Service Application and this re-creates hello databases.</span></span> <span data-ttu-id="faca5-245">Il est recommandé de toohave préparée un script qui crée de nouveau cette application de service, car il n’est pas possible de tooperform toutes les actions via l’interface utilisateur graphique de hello.</span><span class="sxs-lookup"><span data-stu-id="faca5-245">It is recommended toohave a prepared script that re-creates this service application since it is not possible tooperform all actions via hello GUI.</span></span> <span data-ttu-id="faca5-246">Par exemple, emplacement de lecteur d’index hello et la configuration de topologie de recherche hello sont uniquement possibles à l’aide des applets de commande PowerShell de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="faca5-246">For example, setting hello index drive location and configuring hello search topology are only possible by using SharePoint PowerShell cmdlets.</span></span> <span data-ttu-id="faca5-247">Utilisez l’applet de commande Windows PowerShell hello SPEnterpriseSearchServiceApplication de restauration et spécifiez hello de journaux et la réplication de base de données de l’Administration de la recherche, Search_Service__DB.</span><span class="sxs-lookup"><span data-stu-id="faca5-247">Use hello Windows PowerShell cmdlet Restore-SPEnterpriseSearchServiceApplication and specify hello log-shipped and replicated Search Administration database, Search_Service__DB.</span></span> <span data-ttu-id="faca5-248">Cette applet de commande permet la configuration de la recherche hello, schéma, les propriétés gérées, règles et sources et crée un ensemble par défaut de hello autres composants.</span><span class="sxs-lookup"><span data-stu-id="faca5-248">This cmdlet gives hello search configuration, schema, managed properties, rules, and sources and creates a default set of hello other components.</span></span>
    * <span data-ttu-id="faca5-249">Une fois que hello Qu'application de Service de recherche a être recréé, vous devez démarrer une analyse complète pour chaque hello toorestore de source du contenu du Service de recherche.</span><span class="sxs-lookup"><span data-stu-id="faca5-249">Once hello Search Service Application has be re-created, you must start a full crawl for each content source toorestore hello Search Service.</span></span> <span data-ttu-id="faca5-250">Vous perdrez quelques informations analytique de batterie de local hello, telles que des recommandations de la recherche.</span><span class="sxs-lookup"><span data-stu-id="faca5-250">You lose some analytics information from hello on-premises farm, such as search recommendations.</span></span>

7. <span data-ttu-id="faca5-251">Une fois toutes les étapes de hello sont effectuées, enregistrez le plan de récupération hello et plan de récupération final hello doit ressembler à la suivante.</span><span class="sxs-lookup"><span data-stu-id="faca5-251">Once all hello steps are completed, save hello recovery plan and hello final recovery plan will look like following.</span></span>

    ![RP enregistré](./media/site-recovery-sharepoint/saved-rp.png)

## <a name="doing-a-test-failover"></a><span data-ttu-id="faca5-253">Exécution d’un test de basculement</span><span class="sxs-lookup"><span data-stu-id="faca5-253">Doing a test failover</span></span>
<span data-ttu-id="faca5-254">Suivez [ce guide](site-recovery-test-failover-to-azure.md) toodo un test de basculement.</span><span class="sxs-lookup"><span data-stu-id="faca5-254">Follow [this guidance](site-recovery-test-failover-to-azure.md) toodo a test failover.</span></span>

1.  <span data-ttu-id="faca5-255">TooAzure portail, sélectionnez le coffre de votre Service de récupération.</span><span class="sxs-lookup"><span data-stu-id="faca5-255">Go tooAzure portal and select your Recovery Service vault.</span></span>
2.  <span data-ttu-id="faca5-256">Cliquez sur le plan de récupération hello créé pour l’application SharePoint.</span><span class="sxs-lookup"><span data-stu-id="faca5-256">Click on hello recovery plan created for SharePoint application.</span></span>
3.  <span data-ttu-id="faca5-257">Cliquez sur Test de basculement.</span><span class="sxs-lookup"><span data-stu-id="faca5-257">Click on 'Test Failover'.</span></span>
4.  <span data-ttu-id="faca5-258">Sélectionnez le point de récupération et le processus de basculement de test de réseau virtuel Azure toostart hello.</span><span class="sxs-lookup"><span data-stu-id="faca5-258">Select recovery point and Azure virtual network toostart hello test failover process.</span></span>
5.  <span data-ttu-id="faca5-259">Une fois les environnement secondaire hello, vous pouvez effectuer vos validations.</span><span class="sxs-lookup"><span data-stu-id="faca5-259">Once hello secondary environment is up, you can perform your validations.</span></span>
6.  <span data-ttu-id="faca5-260">Une fois les validations hello sont terminées, vous pouvez cliquer sur « Test de basculement nettoyage » sur le plan de récupération hello et environnement de test de basculement hello est nettoyé.</span><span class="sxs-lookup"><span data-stu-id="faca5-260">Once hello validations are complete, you can click 'Cleanup test failover' on hello recovery plan and hello test failover environment is cleaned.</span></span>

<span data-ttu-id="faca5-261">Pour obtenir des conseils sur effectuant un test de basculement pour Active Directory et DNS, consultez trop[tester des considérations relatives au basculement pour Active Directory et DNS](site-recovery-active-directory.md#test-failover-considerations) document.</span><span class="sxs-lookup"><span data-stu-id="faca5-261">For guidance on doing test failover for AD and DNS, refer too[Test failover considerations for AD and DNS](site-recovery-active-directory.md#test-failover-considerations) document.</span></span>

<span data-ttu-id="faca5-262">Pour obtenir des conseils sur la création de test de basculement pour SQL toujours sur les groupes de disponibilité, consultez trop[effectuer le Test du basculement de SQL Server Always On](site-recovery-sql.md#steps-to-do-a-test-failover) document.</span><span class="sxs-lookup"><span data-stu-id="faca5-262">For guidance on doing test failover for SQL Always ON availability groups, refer too[Doing Test failover for SQL Server Always On](site-recovery-sql.md#steps-to-do-a-test-failover) document.</span></span>

## <a name="doing-a-failover"></a><span data-ttu-id="faca5-263">Exécution d’un basculement</span><span class="sxs-lookup"><span data-stu-id="faca5-263">Doing a failover</span></span>
<span data-ttu-id="faca5-264">Suivez [ce guide](site-recovery-failover.md) pour réaliser un basculement.</span><span class="sxs-lookup"><span data-stu-id="faca5-264">Follow [this guidance](site-recovery-failover.md) for doing a failover.</span></span>

1.  <span data-ttu-id="faca5-265">TooAzure portail, sélectionnez votre coffre Recovery Services.</span><span class="sxs-lookup"><span data-stu-id="faca5-265">Go tooAzure portal and select your Recovery Services vault.</span></span>
2.  <span data-ttu-id="faca5-266">Cliquez sur le plan de récupération hello créé pour l’application SharePoint.</span><span class="sxs-lookup"><span data-stu-id="faca5-266">Click on hello recovery plan created for SharePoint application.</span></span>
3.  <span data-ttu-id="faca5-267">Cliquez sur « Basculement ».</span><span class="sxs-lookup"><span data-stu-id="faca5-267">Click on 'Failover'.</span></span>
4.  <span data-ttu-id="faca5-268">Sélectionnez le processus de basculement de hello toostart de point de récupération.</span><span class="sxs-lookup"><span data-stu-id="faca5-268">Select recovery point toostart hello failover process.</span></span>

## <a name="next-steps"></a><span data-ttu-id="faca5-269">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="faca5-269">Next steps</span></span>
<span data-ttu-id="faca5-270">Vous pouvez en savoir plus sur la [réplication d’autres applications](site-recovery-workload.md) à l’aide de Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="faca5-270">You can learn more about [replicating other applications](site-recovery-workload.md) using Site Recovery.</span></span>
