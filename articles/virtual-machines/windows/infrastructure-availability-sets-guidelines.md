---
title: "Groupes à haute disponibilité pour les machines virtuelles Windows dans Azure | Microsoft Docs"
description: "Découvrez-en plus sur les principales instructions de conception et d’implémentation pour le déploiement de groupes à haute disponibilité dans des services d’infrastructure Azure."
documentationcenter: 
services: virtual-machines-windows
author: iainfoulds
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: f9449f58-664b-4d5d-82f6-84c5d083047f
ms.service: virtual-machines-windows
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-windows
ms.devlang: na
ms.topic: article
ms.date: 06/26/2017
ms.author: iainfou
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: f94004fbd32dcc8a2394fcdfe2ac61519364f176
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/11/2017
---
# <a name="azure-availability-sets-guidelines-for-windows-vms"></a><span data-ttu-id="ed6bf-103">Instructions pour les groupes à haute disponibilité Azure pour les machines virtuelles Windows</span><span class="sxs-lookup"><span data-stu-id="ed6bf-103">Azure availability sets guidelines for Windows VMs</span></span>

[!INCLUDE [virtual-machines-windows-infrastructure-guidelines-intro](../../../includes/virtual-machines-windows-infrastructure-guidelines-intro.md)]

<span data-ttu-id="ed6bf-104">Cet article se concentre sur la compréhension des étapes de planification requises pour les groupes à haute disponibilité afin d’assurer que vos applications restent accessibles aux cours des événements planifiés et non planifiés.</span><span class="sxs-lookup"><span data-stu-id="ed6bf-104">This article focuses on understanding the required planning steps for availability sets to ensure your applications remains accessible during planned or unplanned events.</span></span>

## <a name="implementation-guidelines-for-availability-sets"></a><span data-ttu-id="ed6bf-105">Instructions d’implémentation pour groupes à haute disponibilité</span><span class="sxs-lookup"><span data-stu-id="ed6bf-105">Implementation guidelines for availability sets</span></span>
<span data-ttu-id="ed6bf-106">Décisions :</span><span class="sxs-lookup"><span data-stu-id="ed6bf-106">Decisions:</span></span>

* <span data-ttu-id="ed6bf-107">De combien de groupes à haute disponibilité avez-vous besoin pour les différents rôles et niveaux de votre infrastructure d’application ?</span><span class="sxs-lookup"><span data-stu-id="ed6bf-107">How many availability sets do you need for the various roles and tiers in your application infrastructure?</span></span>

<span data-ttu-id="ed6bf-108">Tâches :</span><span class="sxs-lookup"><span data-stu-id="ed6bf-108">Tasks:</span></span>

* <span data-ttu-id="ed6bf-109">Définissez le nombre de machines virtuelles requises pour chaque niveau d’application.</span><span class="sxs-lookup"><span data-stu-id="ed6bf-109">Define the number of VMs in each application tier you require.</span></span>
* <span data-ttu-id="ed6bf-110">Déterminez si vous devez ajuster le nombre de domaines d’erreur ou de mise à jour à utiliser pour votre application.</span><span class="sxs-lookup"><span data-stu-id="ed6bf-110">Determine if you need to adjust the number of fault or update domains to be used for your application.</span></span>
* <span data-ttu-id="ed6bf-111">Définissez les groupes à haute disponibilité requis à l’aide de votre convention de dénomination et des machines virtuelles qui s’y trouvent.</span><span class="sxs-lookup"><span data-stu-id="ed6bf-111">Define the required availability sets using your naming convention and what VMs reside in them.</span></span> <span data-ttu-id="ed6bf-112">Une machine virtuelle ne peut résider que dans un seul groupe à haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="ed6bf-112">A VM can only reside in one availability set.</span></span>

## <a name="availability-sets"></a><span data-ttu-id="ed6bf-113">Groupes à haute disponibilité</span><span class="sxs-lookup"><span data-stu-id="ed6bf-113">Availability sets</span></span>
<span data-ttu-id="ed6bf-114">Dans Azure, les machines virtuelles peuvent être placées dans un groupement logique appelé groupe à haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="ed6bf-114">In Azure, virtual machines (VMs) can be placed in to a logical grouping called an availability set.</span></span> <span data-ttu-id="ed6bf-115">Lorsque vous créez des machines virtuelles au sein d’un groupe à haute disponibilité, la plateforme Azure répartit le placement de ces machines virtuelles sur l’infrastructure sous-jacente.</span><span class="sxs-lookup"><span data-stu-id="ed6bf-115">When you create VMs within an availability set, the Azure platform distributes the placement of those VMs across the underlying infrastructure.</span></span> <span data-ttu-id="ed6bf-116">En cas d’événement de maintenance planifiée pour la plateforme Azure ou de panne de l’infrastructure ou du matériel sous-jacent, l’utilisation des groupes à haute disponibilité assure qu’au moins une machine virtuelle est en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="ed6bf-116">Should there be a planned maintenance event to the Azure platform or an underlying hardware / infrastructure fault, the use of availability sets ensures that at least one VM remains running.</span></span>

<span data-ttu-id="ed6bf-117">En tant que meilleure pratique, les applications ne doivent pas résider sur une seule machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="ed6bf-117">As a best practice, applications should not reside on a single VM.</span></span> <span data-ttu-id="ed6bf-118">Un groupe à haute disponibilité qui contient une seule machine virtuelle ne gagne aucune protection contre les événements planifiés ou non planifiés dans la plateforme Azure.</span><span class="sxs-lookup"><span data-stu-id="ed6bf-118">An availability set that contains a single VM doesn't gain any protection from planned or unplanned events within the Azure platform.</span></span> <span data-ttu-id="ed6bf-119">Le [Contrat de niveau de service Azure](https://azure.microsoft.com/support/legal/sla/virtual-machines) nécessite deux machines virtuelles ou plus au sein d’un groupe à haute disponibilité défini afin de permettre la distribution des machines virtuelles sur l’infrastructure sous-jacente.</span><span class="sxs-lookup"><span data-stu-id="ed6bf-119">The [Azure SLA](https://azure.microsoft.com/support/legal/sla/virtual-machines) requires two or more VMs within an availability set to allow the distribution of VMs across the underlying infrastructure.</span></span> <span data-ttu-id="ed6bf-120">Si vous utilisez [Stockage Premium Azure](../../storage/storage-premium-storage.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json), le contrat SLA Azure s’applique à une seule machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="ed6bf-120">If you are using [Azure Premium Storage](../../storage/storage-premium-storage.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json), the Azure SLA applies to a single VM.</span></span>

<span data-ttu-id="ed6bf-121">L’infrastructure sous-jacente dans Azure est divisée en plusieurs clusters de matériel.</span><span class="sxs-lookup"><span data-stu-id="ed6bf-121">The underlying infrastructure in Azure is divided in to multiple hardware clusters.</span></span> <span data-ttu-id="ed6bf-122">Chaque cluster de matériel peut prendre en charge une plage de tailles de machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="ed6bf-122">Each hardware cluster can support a range of VM sizes.</span></span> <span data-ttu-id="ed6bf-123">Un groupe à haute disponibilité ne peut être hébergé que sur un seul cluster de matériel à la fois.</span><span class="sxs-lookup"><span data-stu-id="ed6bf-123">An availability set can only be hosted on a single hardware cluster at any point in time.</span></span> <span data-ttu-id="ed6bf-124">Par conséquent, les tailles des machines virtuelles qui peuvent exister dans un groupe à haute disponibilité sont limitées aux tailles des machines virtuelles prises en charge par le cluster de matériel.</span><span class="sxs-lookup"><span data-stu-id="ed6bf-124">Therefore, the range of VM sizes that can exist in a single availability set is limited to the range of VM sizes supported by the hardware cluster.</span></span> <span data-ttu-id="ed6bf-125">Le cluster de matériel pour le groupe à haute disponibilité est sélectionné lorsque la première machine virtuelle du groupe à haute disponibilité est déployée ou lors du démarrage de la première machine virtuelle dans un groupe à haute disponibilité où toutes les machines virtuelles se trouvent actuellement en état arrêté-libéré.</span><span class="sxs-lookup"><span data-stu-id="ed6bf-125">The hardware cluster for the availability set is selected when the first VM in the availability set is deployed or when starting the first VM in an availability set where all VMs are currently in the stopped-deallocated state.</span></span> <span data-ttu-id="ed6bf-126">La commande PowerShell suivante peut être utilisée pour déterminer les tailles des machines virtuelles disponibles pour une haute disponibilité : "Get-AzureRmVMSize -ResourceGroupName \<string\> -AvailabilitySetName \<string\>"</span><span class="sxs-lookup"><span data-stu-id="ed6bf-126">The following PowerShell command can be used to determine the range of VM sizes available for an availability set: "Get-AzureRmVMSize -ResourceGroupName \<string\> -AvailabilitySetName \<string\>"</span></span>

<span data-ttu-id="ed6bf-127">Chaque cluster matériel est divisé en plusieurs domaines de mise à jour et d’erreur.</span><span class="sxs-lookup"><span data-stu-id="ed6bf-127">Each hardware cluster is divided in to multiple update domains and fault domains.</span></span> <span data-ttu-id="ed6bf-128">Ces domaines sont définis par les hôtes qui partagent un cycle de mise à jour commun, ou une infrastructure physique similaire, comme l’alimentation ou la mise en réseau.</span><span class="sxs-lookup"><span data-stu-id="ed6bf-128">These domains are defined by what hosts share a common update cycle, or share similar physical infrastructure such as power and networking.</span></span> <span data-ttu-id="ed6bf-129">Azure distribue automatiquement vos machines virtuelles au sein d’un groupe à haute disponibilité sur plusieurs domaines pour assurer la disponibilité et la tolérance aux pannes.</span><span class="sxs-lookup"><span data-stu-id="ed6bf-129">Azure automatically distributes your VMs within an availability set across domains to maintain availability and fault tolerance.</span></span> <span data-ttu-id="ed6bf-130">Selon la taille de votre application et le nombre de machines virtuelles au sein d’un groupe à haute disponibilité, vous pouvez régler le nombre de domaines que vous souhaitez utiliser.</span><span class="sxs-lookup"><span data-stu-id="ed6bf-130">Depending on the size of your application and the number of VMs within an availability set, you can adjust the number of domains you wish to use.</span></span> <span data-ttu-id="ed6bf-131">Vous pouvez en savoir plus sur [la gestion de la disponibilité et l’utilisation des domaines d’erreur et de mise à jour](manage-availability.md).</span><span class="sxs-lookup"><span data-stu-id="ed6bf-131">You can read more about [managing availability and use of update and fault domains](manage-availability.md).</span></span>

<span data-ttu-id="ed6bf-132">Lorsque vous concevez l’infrastructure de votre application, vous devez également planifier les couches Application que vous utilisez.</span><span class="sxs-lookup"><span data-stu-id="ed6bf-132">When designing your application infrastructure, plan the application tiers that you use.</span></span> <span data-ttu-id="ed6bf-133">Groupez les machines virtuelles qui ont la même fonction dans des groupes à haute disponibilité définis, comme un groupe à haute disponibilité pour vos machines virtuelles frontales exécutant IIS.</span><span class="sxs-lookup"><span data-stu-id="ed6bf-133">Group VMs that serve the same purpose in to availability sets, such as an availability set for your front-end VMs running IIS.</span></span> <span data-ttu-id="ed6bf-134">Créez un groupe à haute disponibilité distinct pour les machines virtuelles principales exécutant SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ed6bf-134">Create a separate availability set for your back-end VMs running SQL Server.</span></span> <span data-ttu-id="ed6bf-135">L’objectif est de vous assurer que chaque composant de votre application est protégé par un groupe à haute disponibilité et qu’au moins une instance est toujours exécutée.</span><span class="sxs-lookup"><span data-stu-id="ed6bf-135">The goal is to ensure that each component of your application is protected by an availability set and at least once instance always remains running.</span></span>

<span data-ttu-id="ed6bf-136">Les équilibreurs de charge peuvent être utilisés devant chaque couche d’application pour fonctionner avec un groupe à haute disponibilité et assurer que le trafic peut être acheminé vers une instance en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="ed6bf-136">Load balancers can be utilized in front of each application tier to work alongside an availability set and ensure traffic can always be routed to a running instance.</span></span> <span data-ttu-id="ed6bf-137">Sans équilibrage de charge, vos machines virtuelles peuvent continuer à s’exécuter dans l’ensemble des événements de maintenance planifiée et non planifiée, mais il se peut alors que vos utilisateurs finaux ne puissent pas les résoudre si la machine virtuelle principale n’est pas disponible à ce moment précis.</span><span class="sxs-lookup"><span data-stu-id="ed6bf-137">Without a load balancer, your VMs may continue running throughout planned and unplanned maintenance events, but your end user may not be able to resolve them if the primary VM is unavailable.</span></span>

<span data-ttu-id="ed6bf-138">Concevez votre application à des fins de haute disponibilité au niveau de la couche de stockage.</span><span class="sxs-lookup"><span data-stu-id="ed6bf-138">Design your application for high availability at storage layer.</span></span> <span data-ttu-id="ed6bf-139">La meilleure pratique en vigueur consiste à [utiliser des disques managés pour les machines virtuelles dans un groupe à haute disponibilité](manage-availability.md#use-managed-disks-for-vms-in-an-availability-set).</span><span class="sxs-lookup"><span data-stu-id="ed6bf-139">The best practice is to [use Managed Disks for VMs in an Availability Set](manage-availability.md#use-managed-disks-for-vms-in-an-availability-set).</span></span> <span data-ttu-id="ed6bf-140">Si vous utilisez actuellement des disques non managés, nous vous recommandons fortement de [convertir les machines virtuelles du groupe à haute disponibilité pour utiliser les disques managés](convert-unmanaged-to-managed-disks.md#convert-vms-in-an-availability-set).</span><span class="sxs-lookup"><span data-stu-id="ed6bf-140">If you are currently using unmanaged disks, we highly recommend you to [convert VMs in Availability Set to use Managed Disks](convert-unmanaged-to-managed-disks.md#convert-vms-in-an-availability-set).</span></span>

## <a name="next-steps"></a><span data-ttu-id="ed6bf-141">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="ed6bf-141">Next steps</span></span>
[!INCLUDE [virtual-machines-windows-infrastructure-guidelines-next-steps](../../../includes/virtual-machines-windows-infrastructure-guidelines-next-steps.md)]
