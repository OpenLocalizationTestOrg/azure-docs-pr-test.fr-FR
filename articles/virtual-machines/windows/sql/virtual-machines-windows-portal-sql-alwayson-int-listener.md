---
title: "aaaCreate un écouteur de groupe de disponibilité de SQL Server dans des machines virtuelles | Documents Microsoft"
description: "Instructions pas à pas pour la création d’un écouteur pour un groupe de disponibilité AlwaysOn pour SQL Server dans des machines virtuelles Azure"
services: virtual-machines
documentationcenter: na
author: MikeRayMSFT
manager: jhubbard
editor: monicar
ms.assetid: d1f291e9-9af2-41ba-9d29-9541e3adcfcf
ms.service: virtual-machines-sql
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows-sql-server
ms.workload: iaas-sql-server
ms.date: 05/01/2017
ms.author: mikeray
ms.openlocfilehash: c6a44dc5c7c18b572c2bf5772b4651b7210aacbd
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="configure-a-load-balancer-for-an-always-on-availability-group-in-azure"></a><span data-ttu-id="a3163-103">Configurer un équilibreur de charge pour un groupe de disponibilité AlwaysOn dans Azure</span><span class="sxs-lookup"><span data-stu-id="a3163-103">Configure a load balancer for an Always On availability group in Azure</span></span>
<span data-ttu-id="a3163-104">Cet article explique comment toocreate un équilibreur de charge pour un groupe de disponibilité SQL Server Always On dans Azure virtual machines qui sont en cours d’exécution avec Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="a3163-104">This article explains how toocreate a load balancer for a SQL Server Always On availability group in Azure virtual machines that are running with Azure Resource Manager.</span></span> <span data-ttu-id="a3163-105">Un groupe de disponibilité requiert un équilibrage de charge lorsque les instances de SQL Server de hello se trouvent sur des machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="a3163-105">An availability group requires a load balancer when hello SQL Server instances are on Azure virtual machines.</span></span> <span data-ttu-id="a3163-106">équilibrage de charge Hello stocke l’adresse IP hello écouteur hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-106">hello load balancer stores hello IP address for hello availability group listener.</span></span> <span data-ttu-id="a3163-107">Si un groupe de disponibilité englobe plusieurs régions, chaque région a besoin d’un équilibreur de charge.</span><span class="sxs-lookup"><span data-stu-id="a3163-107">If an availability group spans multiple regions, each region needs a load balancer.</span></span>

<span data-ttu-id="a3163-108">toocomplete cette tâche, vous devez toohave un groupe de disponibilité de SQL Server est déployé sur les machines virtuelles qui s’exécutent avec le Gestionnaire de ressources.</span><span class="sxs-lookup"><span data-stu-id="a3163-108">toocomplete this task, you need toohave a SQL Server availability group deployed on Azure virtual machines that are running with Resource Manager.</span></span> <span data-ttu-id="a3163-109">Les deux machines virtuelles de SQL Server doit appartenir toohello même groupe à haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="a3163-109">Both SQL Server virtual machines must belong toohello same availability set.</span></span> <span data-ttu-id="a3163-110">Vous pouvez utiliser hello [modèle Microsoft](virtual-machines-windows-portal-sql-alwayson-availability-groups.md) tooautomatically créer le groupe de disponibilité hello dans le Gestionnaire de ressources.</span><span class="sxs-lookup"><span data-stu-id="a3163-110">You can use hello [Microsoft template](virtual-machines-windows-portal-sql-alwayson-availability-groups.md) tooautomatically create hello availability group in Resource Manager.</span></span> <span data-ttu-id="a3163-111">Ce modèle crée automatiquement un équilibreur de charge interne.</span><span class="sxs-lookup"><span data-stu-id="a3163-111">This template automatically creates an internal load balancer for you.</span></span> 

<span data-ttu-id="a3163-112">Si vous préférez, vous pouvez [configurer manuellement un groupe de disponibilité](virtual-machines-windows-portal-sql-alwayson-availability-groups-manual.md).</span><span class="sxs-lookup"><span data-stu-id="a3163-112">If you prefer, you can [manually configure an availability group](virtual-machines-windows-portal-sql-alwayson-availability-groups-manual.md).</span></span>

<span data-ttu-id="a3163-113">Cet article nécessite que vos groupes de disponibilité soient déjà configurés.</span><span class="sxs-lookup"><span data-stu-id="a3163-113">This article requires that your availability groups are already configured.</span></span>  

<span data-ttu-id="a3163-114">Rubriques connexes :</span><span class="sxs-lookup"><span data-stu-id="a3163-114">Related topics include:</span></span>

* [<span data-ttu-id="a3163-115">Configurer des groupes de disponibilité AlwaysOn dans une machine virtuelle Azure (GUI)</span><span class="sxs-lookup"><span data-stu-id="a3163-115">Configure Always On availability groups in Azure VM (GUI)</span></span>](virtual-machines-windows-portal-sql-alwayson-availability-groups-manual.md)   
* [<span data-ttu-id="a3163-116">Configurer une connexion de réseau virtuel à réseau virtuel à l’aide d’Azure Resource Manager et de PowerShell</span><span class="sxs-lookup"><span data-stu-id="a3163-116">Configure a VNet-to-VNet connection by using Azure Resource Manager and PowerShell</span></span>](../../../vpn-gateway/vpn-gateway-vnet-vnet-rm-ps.md)

<span data-ttu-id="a3163-117">En progressant dans cet article, vous créez et configurez un équilibreur de charge Bonjour portail Azure.</span><span class="sxs-lookup"><span data-stu-id="a3163-117">By walking through this article, you create and configure a load balancer in hello Azure portal.</span></span> <span data-ttu-id="a3163-118">Après hello est terminée, vous configurez hello toouse hello adresse IP du cluster d’équilibrage de charge hello pour l’écouteur du groupe de disponibilité hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-118">After hello process is complete, you configure hello cluster toouse hello IP address from hello load balancer for hello availability group listener.</span></span>

## <a name="create-and-configure-hello-load-balancer-in-hello-azure-portal"></a><span data-ttu-id="a3163-119">Créer et configurer l’équilibrage de charge hello Bonjour portail Azure</span><span class="sxs-lookup"><span data-stu-id="a3163-119">Create and configure hello load balancer in hello Azure portal</span></span>
<span data-ttu-id="a3163-120">Dans cette partie de la tâche hello, procédez comme hello suivant :</span><span class="sxs-lookup"><span data-stu-id="a3163-120">In this portion of hello task, do hello following:</span></span>

1. <span data-ttu-id="a3163-121">Bonjour portail Azure, équilibrage de charge hello de créer et configurer une adresse IP de hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-121">In hello Azure portal, create hello load balancer and configure hello IP address.</span></span>
2. <span data-ttu-id="a3163-122">Configurer le pool principal d’hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-122">Configure hello back-end pool.</span></span>
3. <span data-ttu-id="a3163-123">Création de la sonde de hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-123">Create hello probe.</span></span> 
4. <span data-ttu-id="a3163-124">Définir des règles d’équilibrage de charge hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-124">Set hello load balancing rules.</span></span>

> [!NOTE]
> <span data-ttu-id="a3163-125">Si les instances de SQL Server hello se trouvent dans plusieurs groupes de ressources et les régions, effectuer chaque étape à deux reprises, une fois dans chaque groupe de ressources.</span><span class="sxs-lookup"><span data-stu-id="a3163-125">If hello SQL Server instances are in multiple resource groups and regions, perform each step twice, once in each resource group.</span></span>
> 
> 

### <a name="step-1-create-hello-load-balancer-and-configure-hello-ip-address"></a><span data-ttu-id="a3163-126">Étape 1 : Créer l’équilibreur de charge hello et configurer une adresse IP de hello</span><span class="sxs-lookup"><span data-stu-id="a3163-126">Step 1: Create hello load balancer and configure hello IP address</span></span>
<span data-ttu-id="a3163-127">Commencez par créer équilibrage de charge hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-127">First, create hello load balancer.</span></span> 

1. <span data-ttu-id="a3163-128">Bonjour portail Azure, ouvrez le groupe de ressources hello qui contient des machines virtuelles de SQL Server hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-128">In hello Azure portal, open hello resource group that contains hello SQL Server virtual machines.</span></span> 

2. <span data-ttu-id="a3163-129">Dans le groupe de ressources hello, cliquez sur **ajouter**.</span><span class="sxs-lookup"><span data-stu-id="a3163-129">In hello resource group, click **Add**.</span></span>

3. <span data-ttu-id="a3163-130">Recherchez **l’équilibrage de charge** puis, dans les résultats de recherche hello **équilibrage de charge**, qui est publié par **Microsoft**.</span><span class="sxs-lookup"><span data-stu-id="a3163-130">Search for **load balancer** and then, in hello search results, select **Load Balancer**, which is published by **Microsoft**.</span></span>

4. <span data-ttu-id="a3163-131">Sur hello **équilibrage de charge** panneau, cliquez sur **créer**.</span><span class="sxs-lookup"><span data-stu-id="a3163-131">On hello **Load Balancer** blade, click **Create**.</span></span>

5. <span data-ttu-id="a3163-132">Bonjour **équilibrage de charge créer** boîte de dialogue zone, configurer équilibrage de charge hello comme suit :</span><span class="sxs-lookup"><span data-stu-id="a3163-132">In hello **Create load balancer** dialog box, configure hello load balancer as follows:</span></span>

   | <span data-ttu-id="a3163-133">Paramètre</span><span class="sxs-lookup"><span data-stu-id="a3163-133">Setting</span></span> | <span data-ttu-id="a3163-134">Valeur</span><span class="sxs-lookup"><span data-stu-id="a3163-134">Value</span></span> |
   | --- | --- |
   | <span data-ttu-id="a3163-135">**Name**</span><span class="sxs-lookup"><span data-stu-id="a3163-135">**Name**</span></span> |<span data-ttu-id="a3163-136">Un nom représentant l’équilibrage de charge hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-136">A text name representing hello load balancer.</span></span> <span data-ttu-id="a3163-137">Par exemple, **sqlLB**.</span><span class="sxs-lookup"><span data-stu-id="a3163-137">For example, **sqlLB**.</span></span> |
   | <span data-ttu-id="a3163-138">**Type**</span><span class="sxs-lookup"><span data-stu-id="a3163-138">**Type**</span></span> |<span data-ttu-id="a3163-139">**Interne**: la plupart des implémentations utilisent un équilibreur de charge interne, ce qui permet aux applications dans hello même groupe de disponibilité toohello tooconnect réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="a3163-139">**Internal**: Most implementations use an internal load balancer, which allows applications within hello same virtual network tooconnect toohello availability group.</span></span>  </br> <span data-ttu-id="a3163-140">**Externe**: autorise le groupe de disponibilité applications tooconnect toohello via une connexion Internet publique.</span><span class="sxs-lookup"><span data-stu-id="a3163-140">**External**: Allows applications tooconnect toohello availability group through a public Internet connection.</span></span> |
   | <span data-ttu-id="a3163-141">**Réseau virtuel**</span><span class="sxs-lookup"><span data-stu-id="a3163-141">**Virtual network**</span></span> |<span data-ttu-id="a3163-142">Sélectionnez le réseau virtuel hello qui sont des instances de SQL Server hello dans.</span><span class="sxs-lookup"><span data-stu-id="a3163-142">Select hello virtual network that hello SQL Server intances are in.</span></span> |
   | <span data-ttu-id="a3163-143">**Sous-réseau**</span><span class="sxs-lookup"><span data-stu-id="a3163-143">**Subnet**</span></span> |<span data-ttu-id="a3163-144">Sélectionnez sous-réseau hello qui sont des instances de SQL Server hello dans.</span><span class="sxs-lookup"><span data-stu-id="a3163-144">Select hello subnet that hello SQL Server instances are in.</span></span> |
   | <span data-ttu-id="a3163-145">**Affectation d’adresses IP**</span><span class="sxs-lookup"><span data-stu-id="a3163-145">**IP address assignment**</span></span> |<span data-ttu-id="a3163-146">**Statique**</span><span class="sxs-lookup"><span data-stu-id="a3163-146">**Static**</span></span> |
   | <span data-ttu-id="a3163-147">**Adresse IP privée**</span><span class="sxs-lookup"><span data-stu-id="a3163-147">**Private IP address**</span></span> |<span data-ttu-id="a3163-148">Spécifiez une adresse IP disponible à partir du sous-réseau de hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-148">Specify an available IP address from hello subnet.</span></span> <span data-ttu-id="a3163-149">Utilisez cette adresse IP lorsque vous créez un écouteur sur le cluster de hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-149">Use this IP address when you create a listener on hello cluster.</span></span> <span data-ttu-id="a3163-150">Dans un script PowerShell, plus loin dans cet article, utilisez cette adresse pour hello `$ILBIP` variable.</span><span class="sxs-lookup"><span data-stu-id="a3163-150">In a PowerShell script, later in this article, use this address for hello `$ILBIP` variable.</span></span> |
   | <span data-ttu-id="a3163-151">**Abonnement**</span><span class="sxs-lookup"><span data-stu-id="a3163-151">**Subscription**</span></span> |<span data-ttu-id="a3163-152">Si vous avez plusieurs abonnements, ce champ doit normalement apparaître.</span><span class="sxs-lookup"><span data-stu-id="a3163-152">If you have multiple subscriptions, this field might appear.</span></span> <span data-ttu-id="a3163-153">Sélectionnez l’abonnement hello que vous souhaitez tooassociate avec cette ressource.</span><span class="sxs-lookup"><span data-stu-id="a3163-153">Select hello subscription that you want tooassociate with this resource.</span></span> <span data-ttu-id="a3163-154">Il est normalement hello même abonnement que toutes les ressources de hello pour le groupe de disponibilité hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-154">It is normally hello same subscription as all hello resources for hello availability group.</span></span> |
   | <span data-ttu-id="a3163-155">**Groupe de ressources**</span><span class="sxs-lookup"><span data-stu-id="a3163-155">**Resource group**</span></span> |<span data-ttu-id="a3163-156">Sélectionnez le groupe de ressources hello qui sont des instances de SQL Server hello dans.</span><span class="sxs-lookup"><span data-stu-id="a3163-156">Select hello resource group that hello SQL Server instances are in.</span></span> |
   | <span data-ttu-id="a3163-157">**Emplacement**</span><span class="sxs-lookup"><span data-stu-id="a3163-157">**Location**</span></span> |<span data-ttu-id="a3163-158">Sélectionnez hello emplacement Azure qui sont des instances de SQL Server hello dans.</span><span class="sxs-lookup"><span data-stu-id="a3163-158">Select hello Azure location that hello SQL Server instances are in.</span></span> |

6. <span data-ttu-id="a3163-159">Cliquez sur **Créer**.</span><span class="sxs-lookup"><span data-stu-id="a3163-159">Click **Create**.</span></span> 

<span data-ttu-id="a3163-160">Azure crée un équilibreur de charge hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-160">Azure creates hello load balancer.</span></span> <span data-ttu-id="a3163-161">équilibrage de charge Hello appartient tooa réseau, de sous-réseau, de groupe de ressources et d’emplacement.</span><span class="sxs-lookup"><span data-stu-id="a3163-161">hello load balancer belongs tooa specific network, subnet, resource group, and location.</span></span> <span data-ttu-id="a3163-162">Une fois la tâche hello terminée, vérifiez les paramètres d’équilibrage de charge hello dans Azure.</span><span class="sxs-lookup"><span data-stu-id="a3163-162">After Azure completes hello task, verify hello load balancer settings in Azure.</span></span> 

### <a name="step-2-configure-hello-back-end-pool"></a><span data-ttu-id="a3163-163">Étape 2 : Configurer le pool principal de hello</span><span class="sxs-lookup"><span data-stu-id="a3163-163">Step 2: Configure hello back-end pool</span></span>
<span data-ttu-id="a3163-164">Appels Azure hello pool d’adresses de serveur principal *pool principal*.</span><span class="sxs-lookup"><span data-stu-id="a3163-164">Azure calls hello back-end address pool *backend pool*.</span></span> <span data-ttu-id="a3163-165">Dans ce cas, le pool de principaux de hello est adresses hello de deux instances de SQL Server hello dans votre groupe de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="a3163-165">In this case, hello back-end pool is hello addresses of hello two SQL Server instances in your availability group.</span></span> 

1. <span data-ttu-id="a3163-166">Dans votre groupe de ressources, cliquez sur l’équilibrage de charge hello que vous avez créé.</span><span class="sxs-lookup"><span data-stu-id="a3163-166">In your resource group, click hello load balancer that you created.</span></span> 

2. <span data-ttu-id="a3163-167">Dans **Paramètres**, cliquez sur **Pools principaux**.</span><span class="sxs-lookup"><span data-stu-id="a3163-167">On **Settings**, click **Backend pools**.</span></span>

3. <span data-ttu-id="a3163-168">Sur **pools principaux**, cliquez sur **ajouter** toocreate un pool d’adresses du serveur principal.</span><span class="sxs-lookup"><span data-stu-id="a3163-168">On **Backend pools**, click **Add** toocreate a back-end address pool.</span></span> 

4. <span data-ttu-id="a3163-169">Sur **ajouter le pool principal**, sous **nom**, tapez un nom pour le pool principal d’hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-169">On **Add backend pool**, under **Name**, type a name for hello back-end pool.</span></span>

5. <span data-ttu-id="a3163-170">Sous **Machines virtuelles**, cliquez sur **Ajouter une machine virtuelle**.</span><span class="sxs-lookup"><span data-stu-id="a3163-170">Under **Virtual machines**, click **Add a virtual machine**.</span></span> 

6. <span data-ttu-id="a3163-171">Sous **choisir les machines virtuelles**, cliquez sur **choisir un ensemble de disponibilité**, puis spécifiez que les machines virtuelles de SQL Server hello appartiennent au groupe à haute disponibilité de hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-171">Under **Choose virtual machines**, click **Choose an availability set**, and then specify hello availability set that hello SQL Server virtual machines belong to.</span></span>

7. <span data-ttu-id="a3163-172">Une fois que vous avez choisi hello à haute disponibilité, cliquez sur **choisissez hello virtuels**, sélectionnez hello deux machines virtuelles qui hébergent des instances de SQL Server hello hello groupe de disponibilité, puis cliquez sur **sélectionnez**.</span><span class="sxs-lookup"><span data-stu-id="a3163-172">After you have chosen hello availability set, click **Choose hello virtual machines**, select hello two virtual machines that host hello SQL Server instances in hello availability group, and then click **Select**.</span></span> 

8. <span data-ttu-id="a3163-173">Cliquez sur **OK** tooclose des panneaux de hello pour **choisir les machines virtuelles**, et **ajouter le pool principal**.</span><span class="sxs-lookup"><span data-stu-id="a3163-173">Click **OK** tooclose hello blades for **Choose virtual machines**, and **Add backend pool**.</span></span> 

<span data-ttu-id="a3163-174">Azure met à jour les paramètres de hello pour le pool d’adresses principal hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-174">Azure updates hello settings for hello back-end address pool.</span></span> <span data-ttu-id="a3163-175">Votre groupe à haute disponibilité a maintenant un pool de deux instances de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a3163-175">Now your availability set has a pool of two SQL Server instances.</span></span>

### <a name="step-3-create-a-probe"></a><span data-ttu-id="a3163-176">Étape 3 : Créer une sonde</span><span class="sxs-lookup"><span data-stu-id="a3163-176">Step 3: Create a probe</span></span>
<span data-ttu-id="a3163-177">Sonde de Hello définit comment Azure vérifie à qui des instances de SQL Server hello possède actuellement écouteur hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-177">hello probe defines how Azure verifies which of hello SQL Server instances currently owns hello availability group listener.</span></span> <span data-ttu-id="a3163-178">Les tests de Azure service hello basé sur l’adresse IP de hello sur un port que vous définissez lors de la création de la sonde de hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-178">Azure probes hello service based on hello IP address on a port that you define when you create hello probe.</span></span>

1. <span data-ttu-id="a3163-179">L’équilibrage de charge sur hello **paramètres** panneau, cliquez sur **sondes d’intégrité**.</span><span class="sxs-lookup"><span data-stu-id="a3163-179">On hello load balancer **Settings** blade, click **Health probes**.</span></span> 

2. <span data-ttu-id="a3163-180">Sur hello **sondes d’intégrité** panneau, cliquez sur **ajouter**.</span><span class="sxs-lookup"><span data-stu-id="a3163-180">On hello **Health probes** blade, click **Add**.</span></span>

3. <span data-ttu-id="a3163-181">Configurer la sonde de hello sur hello **ajouter sonde** panneau.</span><span class="sxs-lookup"><span data-stu-id="a3163-181">Configure hello probe on hello **Add probe** blade.</span></span> <span data-ttu-id="a3163-182">Sonde de hello tooconfigure les valeurs hello utilisation suivant :</span><span class="sxs-lookup"><span data-stu-id="a3163-182">Use hello following values tooconfigure hello probe:</span></span>

   | <span data-ttu-id="a3163-183">Paramètre</span><span class="sxs-lookup"><span data-stu-id="a3163-183">Setting</span></span> | <span data-ttu-id="a3163-184">Valeur</span><span class="sxs-lookup"><span data-stu-id="a3163-184">Value</span></span> |
   | --- | --- |
   | <span data-ttu-id="a3163-185">**Name**</span><span class="sxs-lookup"><span data-stu-id="a3163-185">**Name**</span></span> |<span data-ttu-id="a3163-186">Un nom représentant la sonde de hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-186">A text name representing hello probe.</span></span> <span data-ttu-id="a3163-187">Par exemple, **SQLAlwaysOnEndPointProbe**.</span><span class="sxs-lookup"><span data-stu-id="a3163-187">For example, **SQLAlwaysOnEndPointProbe**.</span></span> |
   | <span data-ttu-id="a3163-188">**Protocole**</span><span class="sxs-lookup"><span data-stu-id="a3163-188">**Protocol**</span></span> |<span data-ttu-id="a3163-189">**TCP**</span><span class="sxs-lookup"><span data-stu-id="a3163-189">**TCP**</span></span> |
   | <span data-ttu-id="a3163-190">**Port**</span><span class="sxs-lookup"><span data-stu-id="a3163-190">**Port**</span></span> |<span data-ttu-id="a3163-191">Vous pouvez utiliser n’importe quel port disponible.</span><span class="sxs-lookup"><span data-stu-id="a3163-191">You can use any available port.</span></span> <span data-ttu-id="a3163-192">Par exemple, *59999*.</span><span class="sxs-lookup"><span data-stu-id="a3163-192">For example, *59999*.</span></span> |
   | <span data-ttu-id="a3163-193">**Intervalle**</span><span class="sxs-lookup"><span data-stu-id="a3163-193">**Interval**</span></span> |<span data-ttu-id="a3163-194">*5*</span><span class="sxs-lookup"><span data-stu-id="a3163-194">*5*</span></span> |
   | <span data-ttu-id="a3163-195">**Seuil de défaillance sur le plan de l’intégrité**</span><span class="sxs-lookup"><span data-stu-id="a3163-195">**Unhealthy threshold**</span></span> |<span data-ttu-id="a3163-196">*2*</span><span class="sxs-lookup"><span data-stu-id="a3163-196">*2*</span></span> |

4.  <span data-ttu-id="a3163-197">Cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="a3163-197">Click **OK**.</span></span> 

> [!NOTE]
> <span data-ttu-id="a3163-198">Assurez-vous que le port hello que vous spécifiez est ouvert sur les pare-feu hello des deux instances de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a3163-198">Make sure that hello port you specify is open on hello firewall of both SQL Server instances.</span></span> <span data-ttu-id="a3163-199">Les deux instances nécessitent une règle de trafic entrant pour hello le port TCP que vous utilisez.</span><span class="sxs-lookup"><span data-stu-id="a3163-199">Both instances require an inbound rule for hello TCP port that you use.</span></span> <span data-ttu-id="a3163-200">Pour plus d’informations, consultez [Ajouter ou modifier une règle de pare-feu](http://technet.microsoft.com/library/cc753558.aspx).</span><span class="sxs-lookup"><span data-stu-id="a3163-200">For more information, see [Add or Edit Firewall Rule](http://technet.microsoft.com/library/cc753558.aspx).</span></span> 
> 
> 

<span data-ttu-id="a3163-201">Azure crée hello sonde, puis il utilise tootest quelle instance de SQL Server a écouteur hello pour le groupe de disponibilité hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-201">Azure creates hello probe and then uses it tootest which SQL Server instance has hello listener for hello availability group.</span></span>

### <a name="step-4-set-hello-load-balancing-rules"></a><span data-ttu-id="a3163-202">Étape 4 : Définir des règles d’équilibrage de charge de hello</span><span class="sxs-lookup"><span data-stu-id="a3163-202">Step 4: Set hello load balancing rules</span></span>
<span data-ttu-id="a3163-203">règles d’équilibrage de charge Hello configurer comment équilibrage de charge hello route les instances de SQL Server toohello le trafic.</span><span class="sxs-lookup"><span data-stu-id="a3163-203">hello load balancing rules configure how hello load balancer routes traffic toohello SQL Server instances.</span></span> <span data-ttu-id="a3163-204">Pour cet équilibrage de charge, vous activez retour direct du serveur, car seul l’un des deux instances de SQL Server hello possède la ressource de port d’écoute du groupe de disponibilité hello à la fois.</span><span class="sxs-lookup"><span data-stu-id="a3163-204">For this load balancer, you enable direct server return because only one of hello two SQL Server instances owns hello availability group listener resource at a time.</span></span>

1. <span data-ttu-id="a3163-205">L’équilibrage de charge sur hello **paramètres** panneau, cliquez sur **règles d’équilibrage de charge**.</span><span class="sxs-lookup"><span data-stu-id="a3163-205">On hello load balancer **Settings** blade, click **Load balancing rules**.</span></span> 

2. <span data-ttu-id="a3163-206">Sur hello **règles d’équilibrage de charge** panneau, cliquez sur **ajouter**.</span><span class="sxs-lookup"><span data-stu-id="a3163-206">On hello **Load balancing rules** blade, click **Add**.</span></span>

3. <span data-ttu-id="a3163-207">Sur hello **ajouter équilibrage des règles** panneau, configurer la règle d’équilibrage de charge hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-207">On hello **Add load balancing rules** blade, configure hello load balancing rule.</span></span> <span data-ttu-id="a3163-208">Utilisez hello suivant les paramètres :</span><span class="sxs-lookup"><span data-stu-id="a3163-208">Use hello following settings:</span></span> 

   | <span data-ttu-id="a3163-209">Paramètre</span><span class="sxs-lookup"><span data-stu-id="a3163-209">Setting</span></span> | <span data-ttu-id="a3163-210">Valeur</span><span class="sxs-lookup"><span data-stu-id="a3163-210">Value</span></span> |
   | --- | --- |
   | <span data-ttu-id="a3163-211">**Name**</span><span class="sxs-lookup"><span data-stu-id="a3163-211">**Name**</span></span> |<span data-ttu-id="a3163-212">Un nom de texte représentant les règles d’équilibrage de charge hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-212">A text name representing hello load balancing rules.</span></span> <span data-ttu-id="a3163-213">Par exemple, **SQLAlwaysOnEndPointListener**.</span><span class="sxs-lookup"><span data-stu-id="a3163-213">For example, **SQLAlwaysOnEndPointListener**.</span></span> |
   | <span data-ttu-id="a3163-214">**Protocole**</span><span class="sxs-lookup"><span data-stu-id="a3163-214">**Protocol**</span></span> |<span data-ttu-id="a3163-215">**TCP**</span><span class="sxs-lookup"><span data-stu-id="a3163-215">**TCP**</span></span> |
   | <span data-ttu-id="a3163-216">**Port**</span><span class="sxs-lookup"><span data-stu-id="a3163-216">**Port**</span></span> |<span data-ttu-id="a3163-217">*1433*</span><span class="sxs-lookup"><span data-stu-id="a3163-217">*1433*</span></span> |
   | <span data-ttu-id="a3163-218">**Port principal**</span><span class="sxs-lookup"><span data-stu-id="a3163-218">**Backend Port**</span></span> |<span data-ttu-id="a3163-219">*1433*. Cette valeur est ignorée, car cette règle utilise **Adresse IP flottante (retour direct du serveur)**.</span><span class="sxs-lookup"><span data-stu-id="a3163-219">*1433*. This value is ignored because this rule uses **Floating IP (direct server return)**.</span></span> |
   | <span data-ttu-id="a3163-220">**Sonde**</span><span class="sxs-lookup"><span data-stu-id="a3163-220">**Probe**</span></span> |<span data-ttu-id="a3163-221">Utiliser le nom hello de sonde hello que vous avez créé pour cet équilibrage de charge.</span><span class="sxs-lookup"><span data-stu-id="a3163-221">Use hello name of hello probe that you created for this load balancer.</span></span> |
   | <span data-ttu-id="a3163-222">**Persistance de session**</span><span class="sxs-lookup"><span data-stu-id="a3163-222">**Session persistence**</span></span> |<span data-ttu-id="a3163-223">**Aucun**</span><span class="sxs-lookup"><span data-stu-id="a3163-223">**None**</span></span> |
   | <span data-ttu-id="a3163-224">**Délai d’inactivité (minutes).**</span><span class="sxs-lookup"><span data-stu-id="a3163-224">**Idle timeout (minutes)**</span></span> |<span data-ttu-id="a3163-225">*4*</span><span class="sxs-lookup"><span data-stu-id="a3163-225">*4*</span></span> |
   | <span data-ttu-id="a3163-226">**Adresse IP flottante (retour serveur direct)**</span><span class="sxs-lookup"><span data-stu-id="a3163-226">**Floating IP (direct server return)**</span></span> |<span data-ttu-id="a3163-227">**Activé**</span><span class="sxs-lookup"><span data-stu-id="a3163-227">**Enabled**</span></span> |

   > [!NOTE]
   > <span data-ttu-id="a3163-228">Vous pouvez avoir tooscroll vers le bas hello panneau tooview tous les paramètres de hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-228">You might have tooscroll down hello blade tooview all hello settings.</span></span>
   > 

4. <span data-ttu-id="a3163-229">Cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="a3163-229">Click **OK**.</span></span> 
5. <span data-ttu-id="a3163-230">Azure configure la règle d’équilibrage de charge hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-230">Azure configures hello load balancing rule.</span></span> <span data-ttu-id="a3163-231">Équilibrage de charge hello est maintenant une instance tooroute configuré le trafic toohello SQL Server qui héberge l’écoute hello pour le groupe de disponibilité hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-231">Now hello load balancer is configured tooroute traffic toohello SQL Server instance that hosts hello listener for hello availability group.</span></span> 

<span data-ttu-id="a3163-232">À ce stade, groupe de ressources hello possède un équilibreur de charge qui se connecte les ordinateurs SQL Server tooboth.</span><span class="sxs-lookup"><span data-stu-id="a3163-232">At this point, hello resource group has a load balancer that connects tooboth SQL Server machines.</span></span> <span data-ttu-id="a3163-233">équilibrage de charge Hello contient également une adresse IP pour hello SQL Server Always On écouteur, afin que l’ordinateur peut répondre toorequests hello groupes de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="a3163-233">hello load balancer also contains an IP address for hello SQL Server Always On availability group listener, so that either machine can respond toorequests for hello availability groups.</span></span>

> [!NOTE]
> <span data-ttu-id="a3163-234">Si vos instances de SQL Server se trouvent dans deux régions distinctes, répétez les étapes de hello Bonjour autre région.</span><span class="sxs-lookup"><span data-stu-id="a3163-234">If your SQL Server instances are in two separate regions, repeat hello steps in hello other region.</span></span> <span data-ttu-id="a3163-235">Chaque région nécessite un équilibrage de charge.</span><span class="sxs-lookup"><span data-stu-id="a3163-235">Each region requires a load balancer.</span></span> 
> 
> 

## <a name="configure-hello-cluster-toouse-hello-load-balancer-ip-address"></a><span data-ttu-id="a3163-236">Configurer l’adresse IP équilibrage de la charge hello cluster toouse hello</span><span class="sxs-lookup"><span data-stu-id="a3163-236">Configure hello cluster toouse hello load balancer IP address</span></span>
<span data-ttu-id="a3163-237">étape suivante de Hello est tooconfigure hello écouter le cluster de hello et mettez écouteur hello en ligne.</span><span class="sxs-lookup"><span data-stu-id="a3163-237">hello next step is tooconfigure hello listener on hello cluster, and bring hello listener online.</span></span> <span data-ttu-id="a3163-238">Hello suivant :</span><span class="sxs-lookup"><span data-stu-id="a3163-238">Do hello following:</span></span> 

1. <span data-ttu-id="a3163-239">Créer l’écouteur hello sur le cluster de basculement hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-239">Create hello availability group listener on hello failover cluster.</span></span> 

2. <span data-ttu-id="a3163-240">Mettez l’écouteur hello en ligne.</span><span class="sxs-lookup"><span data-stu-id="a3163-240">Bring hello listener online.</span></span>

### <a name="step-5-create-hello-availability-group-listener-on-hello-failover-cluster"></a><span data-ttu-id="a3163-241">Étape 5 : Créer un écouteur du groupe de disponibilité hello sur le cluster de basculement hello</span><span class="sxs-lookup"><span data-stu-id="a3163-241">Step 5: Create hello availability group listener on hello failover cluster</span></span>
<span data-ttu-id="a3163-242">Dans cette étape, vous créez manuellement l’écouteur du groupe de disponibilité hello dans le Gestionnaire du Cluster de basculement et de SQL Server Management Studio.</span><span class="sxs-lookup"><span data-stu-id="a3163-242">In this step, you manually create hello availability group listener in Failover Cluster Manager and SQL Server Management Studio.</span></span>

[!INCLUDE [ag-listener-configure](../../../../includes/virtual-machines-ag-listener-configure.md)]

### <a name="verify-hello-configuration-of-hello-listener"></a><span data-ttu-id="a3163-243">Vérifier la configuration de hello d’écouteur de hello</span><span class="sxs-lookup"><span data-stu-id="a3163-243">Verify hello configuration of hello listener</span></span>

<span data-ttu-id="a3163-244">Si les dépendances et les ressources de cluster hello sont correctement configurés, vous devez être en mesure de tooview un écouteur de hello dans SQL Server Management Studio.</span><span class="sxs-lookup"><span data-stu-id="a3163-244">If hello cluster resources and dependencies are correctly configured, you should be able tooview hello listener in SQL Server Management Studio.</span></span> <span data-ttu-id="a3163-245">tooset hello du port d’écoute, hello suivant :</span><span class="sxs-lookup"><span data-stu-id="a3163-245">tooset hello listener port, do hello following:</span></span>

1. <span data-ttu-id="a3163-246">Démarrez SQL Server Management Studio, puis connectez-vous toohello le réplica principal.</span><span class="sxs-lookup"><span data-stu-id="a3163-246">Start SQL Server Management Studio, and then connect toohello primary replica.</span></span>

2. <span data-ttu-id="a3163-247">Accédez trop**haute disponibilité AlwaysOn** > **groupes de disponibilité** > **écouteurs de groupe de disponibilité**.</span><span class="sxs-lookup"><span data-stu-id="a3163-247">Go too**AlwaysOn High Availability** > **Availability Groups** > **Availability Group Listeners**.</span></span>  
    <span data-ttu-id="a3163-248">Vous devez maintenant voir le nom de l’écouteur hello que vous avez créé dans le Gestionnaire de Cluster de basculement.</span><span class="sxs-lookup"><span data-stu-id="a3163-248">You should now see hello listener name that you created in Failover Cluster Manager.</span></span> 

3. <span data-ttu-id="a3163-249">Cliquez sur le nom d’écouteur hello, puis cliquez sur **propriétés**.</span><span class="sxs-lookup"><span data-stu-id="a3163-249">Right-click hello listener name, and then click **Properties**.</span></span>

4. <span data-ttu-id="a3163-250">Bonjour **Port** , spécifiez un numéro de port hello écouteur hello à l’aide de hello $EndpointPort utilisé précédemment (1433 était la valeur par défaut hello), puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="a3163-250">In hello **Port** box, specify hello port number for hello availability group listener by using hello $EndpointPort you used earlier (1433 was hello default), and then click **OK**.</span></span>

<span data-ttu-id="a3163-251">Vous disposez maintenant d’un groupe de disponibilité dans des machines virtuelles Azure s’exécutant en mode Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="a3163-251">You now have an availability group in Azure virtual machines running in Resource Manager mode.</span></span> 

## <a name="test-hello-connection-toohello-listener"></a><span data-ttu-id="a3163-252">Écouteur de toohello connexion test hello</span><span class="sxs-lookup"><span data-stu-id="a3163-252">Test hello connection toohello listener</span></span>
<span data-ttu-id="a3163-253">Tester la connexion hello de manière hello suivante :</span><span class="sxs-lookup"><span data-stu-id="a3163-253">Test hello connection by doing hello following:</span></span>

1. <span data-ttu-id="a3163-254">Instance de SQL Server de tooa RDP est Bonjour virtuel même réseau, mais ne pas les réplicas hello propre.</span><span class="sxs-lookup"><span data-stu-id="a3163-254">RDP tooa SQL Server instance that is in hello same virtual network, but does not own hello replica.</span></span> <span data-ttu-id="a3163-255">Ce serveur peut être hello autre instance SQL Server dans un cluster de hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-255">This server can be hello other SQL Server instance in hello cluster.</span></span>

2. <span data-ttu-id="a3163-256">Utilisez **sqlcmd** connexion de hello tootest utilitaire.</span><span class="sxs-lookup"><span data-stu-id="a3163-256">Use **sqlcmd** utility tootest hello connection.</span></span> <span data-ttu-id="a3163-257">Par exemple, hello script suivant établit une **sqlcmd** réplica principal de connexion toohello via écouteur hello avec l’authentification Windows :</span><span class="sxs-lookup"><span data-stu-id="a3163-257">For example, hello following script establishes a **sqlcmd** connection toohello primary replica through hello listener with Windows authentication:</span></span>
   
        sqlcmd -S <listenerName> -E

<span data-ttu-id="a3163-258">Hello connexion de SQLCMD connecte automatiquement à instance toohello SQL Server qui héberge le réplica principal de hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-258">hello SQLCMD connection automatically connects toohello SQL Server instance that hosts hello primary replica.</span></span> 

## <a name="create-an-ip-address-for-an-additional-availability-group"></a><span data-ttu-id="a3163-259">Créer une adresse IP pour un groupe de disponibilité supplémentaire</span><span class="sxs-lookup"><span data-stu-id="a3163-259">Create an IP address for an additional availability group</span></span>

<span data-ttu-id="a3163-260">Chaque groupe de disponibilité utilise un écouteur distinct.</span><span class="sxs-lookup"><span data-stu-id="a3163-260">Each availability group uses a separate listener.</span></span> <span data-ttu-id="a3163-261">Chaque écouteur possède sa propre adresse IP.</span><span class="sxs-lookup"><span data-stu-id="a3163-261">Each listener has its own IP address.</span></span> <span data-ttu-id="a3163-262">Utilisez hello identique à l’adresse IP toohold hello équilibrage de charge pour les écouteurs supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="a3163-262">Use hello same load balancer toohold hello IP address for additional listeners.</span></span> <span data-ttu-id="a3163-263">Après avoir créé un groupe de disponibilité, ajoutez l’équilibrage de charge hello toohello de l’adresse IP, puis configurez port d’écoute hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-263">After you create an availability group, add hello IP address toohello load balancer, and then configure hello listener.</span></span>

<span data-ttu-id="a3163-264">tooadd un équilibrage de charge de tooa d’adresse IP avec hello portail Azure, procédez comme hello suivant :</span><span class="sxs-lookup"><span data-stu-id="a3163-264">tooadd an IP address tooa load balancer with hello Azure portal, do hello following:</span></span>

1. <span data-ttu-id="a3163-265">Bonjour portail Azure, ouvrez le groupe de ressources hello qui contient l’équilibrage de charge hello, puis cliquez sur équilibrage de charge hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-265">In hello Azure portal, open hello resource group that contains hello load balancer, and then click hello load balancer.</span></span> 

2. <span data-ttu-id="a3163-266">Sous **PARAMÈTRES**, cliquez sur **Pool d’adresses IP frontales** puis cliquez sur **Ajouter**.</span><span class="sxs-lookup"><span data-stu-id="a3163-266">Under **SETTINGS**, click **Frontend IP pool**, and then click **Add**.</span></span> 

3. <span data-ttu-id="a3163-267">Sous **ajouter une adresse IP de serveur frontal**, attribuez un nom de serveur frontal hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-267">Under **Add frontend IP address**, assign a name for hello front end.</span></span> 

4. <span data-ttu-id="a3163-268">Vérifiez que hello **réseau virtuel** et hello **sous-réseau** sont hello identique hello des instances de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a3163-268">Verify that hello **Virtual network** and hello **Subnet** are hello same as hello SQL Server instances.</span></span>

5. <span data-ttu-id="a3163-269">Définissez adresse IP hello écouteur de hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-269">Set hello IP address for hello listener.</span></span> 
   
   >[!TIP]
   ><span data-ttu-id="a3163-270">Vous pouvez définir hello IP adresse toostatic et tapez une adresse qui n’est pas utilisée actuellement dans le sous-réseau de hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-270">You can set hello IP address toostatic and type an address that is not currently used in hello subnet.</span></span> <span data-ttu-id="a3163-271">Ou bien, vous pouvez définir des hello IP adresse toodynamic et enregistrer le nouveau pool IP frontale hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-271">Alternatively, you can set hello IP address toodynamic and save hello new front-end IP pool.</span></span> <span data-ttu-id="a3163-272">Lorsque vous procédez ainsi, hello portail Azure affecte automatiquement un pool de toohello d’adresses IP disponible.</span><span class="sxs-lookup"><span data-stu-id="a3163-272">When you do so, hello Azure portal automatically assigns an available IP address toohello pool.</span></span> <span data-ttu-id="a3163-273">Vous pouvez rouvrir le pool d’adresses IP frontal hello et modifier hello affectation toostatic.</span><span class="sxs-lookup"><span data-stu-id="a3163-273">You can then reopen hello front-end IP pool and change hello assignment toostatic.</span></span> 

6. <span data-ttu-id="a3163-274">Enregistrer l’adresse IP de hello pour le port d’écoute hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-274">Save hello IP address for hello listener.</span></span> 

7. <span data-ttu-id="a3163-275">Ajouter une sonde d’intégrité à l’aide de hello suivant les paramètres :</span><span class="sxs-lookup"><span data-stu-id="a3163-275">Add a health probe by using hello following settings:</span></span>

   |<span data-ttu-id="a3163-276">Paramètre</span><span class="sxs-lookup"><span data-stu-id="a3163-276">Setting</span></span> |<span data-ttu-id="a3163-277">Valeur</span><span class="sxs-lookup"><span data-stu-id="a3163-277">Value</span></span>
   |:-----|:----
   |<span data-ttu-id="a3163-278">**Name**</span><span class="sxs-lookup"><span data-stu-id="a3163-278">**Name**</span></span> |<span data-ttu-id="a3163-279">Une sonde de hello tooidentify de nom.</span><span class="sxs-lookup"><span data-stu-id="a3163-279">A name tooidentify hello probe.</span></span>
   |<span data-ttu-id="a3163-280">**Protocole**</span><span class="sxs-lookup"><span data-stu-id="a3163-280">**Protocol**</span></span> |<span data-ttu-id="a3163-281">TCP</span><span class="sxs-lookup"><span data-stu-id="a3163-281">TCP</span></span>
   |<span data-ttu-id="a3163-282">**Port**</span><span class="sxs-lookup"><span data-stu-id="a3163-282">**Port**</span></span> |<span data-ttu-id="a3163-283">Un port TCP non utilisé doit être disponible sur toutes les machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="a3163-283">An unused TCP port, which must be available on all virtual machines.</span></span> <span data-ttu-id="a3163-284">Il ne peut pas être utilisé à d’autres fins.</span><span class="sxs-lookup"><span data-stu-id="a3163-284">It cannot be used for any other purpose.</span></span> <span data-ttu-id="a3163-285">Aucun deux écouteurs ne peuvent utiliser hello même port de la sonde.</span><span class="sxs-lookup"><span data-stu-id="a3163-285">No two listeners can use hello same probe port.</span></span> 
   |<span data-ttu-id="a3163-286">**Intervalle**</span><span class="sxs-lookup"><span data-stu-id="a3163-286">**Interval**</span></span> |<span data-ttu-id="a3163-287">Durée Hello entre sonde tentatives.</span><span class="sxs-lookup"><span data-stu-id="a3163-287">hello amount of time between probe attempts.</span></span> <span data-ttu-id="a3163-288">Utilisez la valeur par défaut de hello (5).</span><span class="sxs-lookup"><span data-stu-id="a3163-288">Use hello default (5).</span></span>
   |<span data-ttu-id="a3163-289">**Seuil de défaillance sur le plan de l’intégrité**</span><span class="sxs-lookup"><span data-stu-id="a3163-289">**Unhealthy threshold**</span></span> |<span data-ttu-id="a3163-290">nombre de Hello de seuils consécutifs qui doivent échouer avant un ordinateur virtuel est considéré comme non intègre.</span><span class="sxs-lookup"><span data-stu-id="a3163-290">hello number of consecutive thresholds that should fail before a virtual machine is considered unhealthy.</span></span>

8. <span data-ttu-id="a3163-291">Cliquez sur **OK** sonde de hello toosave.</span><span class="sxs-lookup"><span data-stu-id="a3163-291">Click **OK** toosave hello probe.</span></span> 

9. <span data-ttu-id="a3163-292">Créez une règle d’équilibrage de charge.</span><span class="sxs-lookup"><span data-stu-id="a3163-292">Create a load balancing rule.</span></span> <span data-ttu-id="a3163-293">Cliquez sur **Règles d’équilibrage de charge** puis sur **Ajouter**.</span><span class="sxs-lookup"><span data-stu-id="a3163-293">Click **Load balancing rules**, and then click **Add**.</span></span>

10. <span data-ttu-id="a3163-294">Configurer hello nouvelle équilibrage de charge règle à l’aide de hello suivant les paramètres :</span><span class="sxs-lookup"><span data-stu-id="a3163-294">Configure hello new load balancing rule by using hello following settings:</span></span>

   |<span data-ttu-id="a3163-295">Paramètre</span><span class="sxs-lookup"><span data-stu-id="a3163-295">Setting</span></span> |<span data-ttu-id="a3163-296">Valeur</span><span class="sxs-lookup"><span data-stu-id="a3163-296">Value</span></span>
   |:-----|:----
   |<span data-ttu-id="a3163-297">**Name**</span><span class="sxs-lookup"><span data-stu-id="a3163-297">**Name**</span></span> |<span data-ttu-id="a3163-298">Un Bonjour tooidentify de nom de règle d’équilibrage de charger.</span><span class="sxs-lookup"><span data-stu-id="a3163-298">A name tooidentify hello load balancing rule.</span></span> 
   |<span data-ttu-id="a3163-299">**Adresse IP du serveur frontal**</span><span class="sxs-lookup"><span data-stu-id="a3163-299">**Frontend IP address**</span></span> |<span data-ttu-id="a3163-300">Sélectionnez l’adresse IP de hello que vous avez créé.</span><span class="sxs-lookup"><span data-stu-id="a3163-300">Select hello IP address you created.</span></span> 
   |<span data-ttu-id="a3163-301">**Protocole**</span><span class="sxs-lookup"><span data-stu-id="a3163-301">**Protocol**</span></span> |<span data-ttu-id="a3163-302">TCP</span><span class="sxs-lookup"><span data-stu-id="a3163-302">TCP</span></span>
   |<span data-ttu-id="a3163-303">**Port**</span><span class="sxs-lookup"><span data-stu-id="a3163-303">**Port**</span></span> |<span data-ttu-id="a3163-304">Utiliser le port hello qui utilisent des instances de SQL Server hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-304">Use hello port that hello SQL Server instances are using.</span></span> <span data-ttu-id="a3163-305">Une instance par défaut utilise le port 1433, à moins que vous l’ayez changé.</span><span class="sxs-lookup"><span data-stu-id="a3163-305">A default instance uses port 1433, unless you changed it.</span></span> 
   |<span data-ttu-id="a3163-306">**Port principal**</span><span class="sxs-lookup"><span data-stu-id="a3163-306">**Backend port**</span></span> |<span data-ttu-id="a3163-307">Hello d’utiliser les mêmes valeurs que **Port**.</span><span class="sxs-lookup"><span data-stu-id="a3163-307">Use hello same value as **Port**.</span></span>
   |<span data-ttu-id="a3163-308">**Pool back-end**</span><span class="sxs-lookup"><span data-stu-id="a3163-308">**Backend pool**</span></span> |<span data-ttu-id="a3163-309">pool Hello qui contient des machines virtuelles de hello avec des instances de SQL Server hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-309">hello pool that contains hello virtual machines with hello SQL Server instances.</span></span> 
   |<span data-ttu-id="a3163-310">**Sonde d’intégrité**</span><span class="sxs-lookup"><span data-stu-id="a3163-310">**Health probe**</span></span> |<span data-ttu-id="a3163-311">Choisissez la sonde hello que vous avez créé.</span><span class="sxs-lookup"><span data-stu-id="a3163-311">Choose hello probe you created.</span></span>
   |<span data-ttu-id="a3163-312">**Persistance de session**</span><span class="sxs-lookup"><span data-stu-id="a3163-312">**Session persistence**</span></span> |<span data-ttu-id="a3163-313">Aucun</span><span class="sxs-lookup"><span data-stu-id="a3163-313">None</span></span>
   |<span data-ttu-id="a3163-314">**Délai d’inactivité (minutes).**</span><span class="sxs-lookup"><span data-stu-id="a3163-314">**Idle timeout (minutes)**</span></span> |<span data-ttu-id="a3163-315">Valeur par défaut (4)</span><span class="sxs-lookup"><span data-stu-id="a3163-315">Default (4)</span></span>
   |<span data-ttu-id="a3163-316">**Adresse IP flottante (retour direct du serveur)**</span><span class="sxs-lookup"><span data-stu-id="a3163-316">**Floating IP (direct server return)**</span></span> | <span data-ttu-id="a3163-317">Activé</span><span class="sxs-lookup"><span data-stu-id="a3163-317">Enabled</span></span>

### <a name="configure-hello-availability-group-toouse-hello-new-ip-address"></a><span data-ttu-id="a3163-318">Configurer hello disponibilité groupe toouse hello nouvelle adresse IP</span><span class="sxs-lookup"><span data-stu-id="a3163-318">Configure hello availability group toouse hello new IP address</span></span>

<span data-ttu-id="a3163-319">toofinish de configuration de cluster de hello, répétition hello étapes lorsque vous avez effectué le premier groupe de disponibilité hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-319">toofinish configuring hello cluster, repeat hello steps that you followed when you made hello first availability group.</span></span> <span data-ttu-id="a3163-320">Autrement dit, configurer hello [toouse hello nouvelle adresse IP de cluster](#configure-the-cluster-to-use-the-load-balancer-ip-address).</span><span class="sxs-lookup"><span data-stu-id="a3163-320">That is, configure hello [cluster toouse hello new IP address](#configure-the-cluster-to-use-the-load-balancer-ip-address).</span></span> 

<span data-ttu-id="a3163-321">Après avoir ajouté une adresse IP pour le port d’écoute hello, configurez le groupe de disponibilité supplémentaires hello en procédant comme suit de hello :</span><span class="sxs-lookup"><span data-stu-id="a3163-321">After you have added an IP address for hello listener, configure hello additional availability group by doing hello following:</span></span> 

1. <span data-ttu-id="a3163-322">Vérifiez que le port de la sonde hello pour la nouvelle adresse IP de hello est ouvert sur les deux machines virtuelles de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a3163-322">Verify that hello probe port for hello new IP address is open on both SQL Server virtual machines.</span></span> 

2. <span data-ttu-id="a3163-323">[Dans le Gestionnaire de Cluster, ajouter le point d’accès client hello](#addcap).</span><span class="sxs-lookup"><span data-stu-id="a3163-323">[In Cluster Manager, add hello client access point](#addcap).</span></span>

3. <span data-ttu-id="a3163-324">[Configurer les ressources IP de hello pour le groupe de disponibilité hello](#congroup).</span><span class="sxs-lookup"><span data-stu-id="a3163-324">[Configure hello IP resource for hello availability group](#congroup).</span></span>

   >[!IMPORTANT]
   ><span data-ttu-id="a3163-325">Lorsque vous créez des adresses IP de hello, utiliser l’adresse IP de hello que vous avez ajouté l’équilibrage de charge toohello.</span><span class="sxs-lookup"><span data-stu-id="a3163-325">When you create hello IP address, use hello IP address that you added toohello load balancer.</span></span>  

4. <span data-ttu-id="a3163-326">[Rendre les ressources de groupe de disponibilité de SQL Server hello dépendante sur le point d’accès client hello](#dependencyGroup).</span><span class="sxs-lookup"><span data-stu-id="a3163-326">[Make hello SQL Server availability group resource dependent on hello client access point](#dependencyGroup).</span></span>

5. <span data-ttu-id="a3163-327">[Hello d’accès client aux ressources dépendant de l’adresse IP de hello de point](#listname).</span><span class="sxs-lookup"><span data-stu-id="a3163-327">[Make hello client access point resource dependent on hello IP address](#listname).</span></span>
 
6. <span data-ttu-id="a3163-328">[Définir les paramètres de cluster hello dans PowerShell](#setparam).</span><span class="sxs-lookup"><span data-stu-id="a3163-328">[Set hello cluster parameters in PowerShell](#setparam).</span></span>

<span data-ttu-id="a3163-329">Après avoir configuré hello disponibilité groupe toouse hello nouvelle adresse IP, configurez l’écouteur de toohello de connexion de hello.</span><span class="sxs-lookup"><span data-stu-id="a3163-329">After you configure hello availability group toouse hello new IP address, configure hello connection toohello listener.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="a3163-330">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="a3163-330">Next steps</span></span>

- [<span data-ttu-id="a3163-331">Configurer un groupe de disponibilité SQL Server AlwaysOn sur des machines virtuelles Azure dans des régions différentes</span><span class="sxs-lookup"><span data-stu-id="a3163-331">Configure a SQL Server Always On availability group on Azure virtual machines in different regions</span></span>](virtual-machines-windows-portal-sql-availability-group-dr.md)
