---
title: "Migrer une base de données SQL Server vers SQL Server sur une machine virtuelle | Microsoft Docs"
description: "Découvrez comment migrer une base de données utilisateur sur site de SQL Server dans une machine virtuelle Azure."
services: virtual-machines-windows
documentationcenter: 
author: sabotta
manager: jhubbard
editor: 
tags: azure-service-management
ms.assetid: 00fd08c6-98fa-4d62-a3b8-ca20aa5246b1
ms.service: virtual-machines-sql
ms.workload: iaas-sql-server
ms.tgt_pltfrm: vm-windows-sql-server
ms.devlang: na
ms.topic: article
ms.date: 07/17/2017
ms.author: carlasab
ms.openlocfilehash: 68767534298783083a441aa295611914d0df9db0
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/29/2017
---
# <a name="migrate-a-sql-server-database-to-sql-server-in-an-azure-vm"></a><span data-ttu-id="d357a-103">Migrer une base de données SQL Server vers SQL Server dans une machine virtuelle Azure</span><span class="sxs-lookup"><span data-stu-id="d357a-103">Migrate a SQL Server database to SQL Server in an Azure VM</span></span>

<span data-ttu-id="d357a-104">Il existe plusieurs méthodes permettant de migrer une base de données utilisateur SQL Server locale vers SQL Server sur une machine virtuelle Azure.</span><span class="sxs-lookup"><span data-stu-id="d357a-104">There are a number of methods to migrate an on-premises SQL Server user database to SQL Server in an Azure VM.</span></span> <span data-ttu-id="d357a-105">Cet article abordera brièvement différentes méthodes et recommandera la mieux adaptée à différents scénarios.</span><span class="sxs-lookup"><span data-stu-id="d357a-105">This article will briefly discuss various methods and recommend the best method for various scenarios.</span></span>

[!INCLUDE [learn-about-deployment-models](../../../../includes/learn-about-deployment-models-both-include.md)]

## <a name="what-are-the-primary-migration-methods"></a><span data-ttu-id="d357a-106">Quelles sont les principales méthodes de migration ?</span><span class="sxs-lookup"><span data-stu-id="d357a-106">What are the primary migration methods?</span></span>
<span data-ttu-id="d357a-107">Les méthodes de migration principales consistent à :</span><span class="sxs-lookup"><span data-stu-id="d357a-107">The primary migration methods are:</span></span>

* <span data-ttu-id="d357a-108">Effectuer une sauvegarde locale par compression et copier manuellement le fichier de sauvegarde dans la machine virtuelle Azure</span><span class="sxs-lookup"><span data-stu-id="d357a-108">Perform on-premises backup using compression and manually copy the backup file into the Azure virtual machine</span></span>
* <span data-ttu-id="d357a-109">Effectuer une sauvegarde vers une URL et exécuter une restauration dans la machine virtuelle Azure à partir de cette URL</span><span class="sxs-lookup"><span data-stu-id="d357a-109">Perform a backup to URL and restore into the Azure virtual machine from the URL</span></span>
* <span data-ttu-id="d357a-110">Détacher, puis copier les fichiers journaux et de données vers le stockage d’objets blob Azure, puis les rattacher à SQL Server dans la machine virtuelle Azure depuis une URL</span><span class="sxs-lookup"><span data-stu-id="d357a-110">Detach and then copy the data and log files to Azure blob storage and then attach to SQL Server in Azure VM from URL</span></span>
* <span data-ttu-id="d357a-111">Convertir une machine physique locale en disque dur virtuel Hyper-V, effectuer un téléchargement vers le stockage d’objets Blob Azure, puis exécuter un déploiement en tant que nouvelle machine virtuelle en utilisant le disque dur virtuel téléchargé</span><span class="sxs-lookup"><span data-stu-id="d357a-111">Convert on-premises physical machine to Hyper-V VHD, upload to Azure Blob storage, and then deploy as new VM using uploaded VHD</span></span>
* <span data-ttu-id="d357a-112">Expédition du disque dur avec le Service d’importation/exportation Windows</span><span class="sxs-lookup"><span data-stu-id="d357a-112">Ship hard drive using Windows Import/Export Service</span></span>
* <span data-ttu-id="d357a-113">Si vous disposez d’un déploiement AlwaysOn local, utilisez l’ [Assistant Ajout d’un réplica Azure](../classic/sql-onprem-availability.md) pour créer un réplica dans Azure, puis basculez en dirigeant les utilisateurs vers l’instance de base de données Azure</span><span class="sxs-lookup"><span data-stu-id="d357a-113">If you have an AlwaysOn deployment on-premises, use the [Add Azure Replica Wizard](../classic/sql-onprem-availability.md) to create a replica in Azure and then failover, pointing users to the Azure database instance</span></span>
* <span data-ttu-id="d357a-114">Utiliser la [réplication transactionnelle](https://msdn.microsoft.com/library/ms151176.aspx) de SQL Server pour configurer l’instance Azure SQL Server en tant qu’abonné, puis désactiver la réplication en dirigeant les utilisateurs vers l’instance de base de données Azure</span><span class="sxs-lookup"><span data-stu-id="d357a-114">Use SQL Server [transactional replication](https://msdn.microsoft.com/library/ms151176.aspx) to configure the Azure SQL Server instance as a subscriber and then disable replication, pointing users to the Azure database instance</span></span>

> [!TIP]
> <span data-ttu-id="d357a-115">Vous pouvez également utiliser ces mêmes techniques pour déplacer des bases de données entre machines virtuelles SQL Server dans Azure.</span><span class="sxs-lookup"><span data-stu-id="d357a-115">You can also use these same techniques to move databases between SQL Server VMs in Azure.</span></span> <span data-ttu-id="d357a-116">Par exemple, il n’existe aucun moyen pris en charge de mettre à niveau une machine virtuelle d’image de la galerie SQL Server d’une version/édition à l’autre.</span><span class="sxs-lookup"><span data-stu-id="d357a-116">For example, there is no supported way to upgrade a SQL Server gallery-image VM from one version/edition to another.</span></span> <span data-ttu-id="d357a-117">Dans ce cas, il vous faut créer une nouvelle machine virtuelle SQL Server avec la nouvelle version/édition, puis utiliser l’une des techniques de migration de cet article pour déplacer vos bases de données.</span><span class="sxs-lookup"><span data-stu-id="d357a-117">In this case, you should create a new SQL Server VM with the new version/edition, and then use one of the migration techniques in this article to move your databases.</span></span> 

## <a name="choosing-your-migration-method"></a><span data-ttu-id="d357a-118">Choix de votre méthode de migration</span><span class="sxs-lookup"><span data-stu-id="d357a-118">Choosing your migration method</span></span>
<span data-ttu-id="d357a-119">Pour obtenir des performances de transfert de données optimales, migrez les fichiers de base de données de la machine virtuelle Azure à l’aide d’un fichier de sauvegarde compressé.</span><span class="sxs-lookup"><span data-stu-id="d357a-119">For optimum data transfer performance, migrate the database files into the Azure VM using a compressed backup file.</span></span>

<span data-ttu-id="d357a-120">Pour réduire le temps d’arrêt pendant la migration de base de données, utilisez l’option AlwaysOn ou l’option de réplication transactionnelle.</span><span class="sxs-lookup"><span data-stu-id="d357a-120">To minimize downtime during the database migration process, use either the AlwaysOn option or the transactional replication option.</span></span>

<span data-ttu-id="d357a-121">S’il n’est pas possible d’utiliser les méthodes décrites ci-dessus, migrez manuellement votre base de données.</span><span class="sxs-lookup"><span data-stu-id="d357a-121">If it is not possible to use the above methods, manually migrate your database.</span></span> <span data-ttu-id="d357a-122">Cette méthode consiste généralement à effectuer une sauvegarde de la base de données, puis une copie de la sauvegarde de la base de données dans Azure, et enfin à effectuer une restauration de la base de données.</span><span class="sxs-lookup"><span data-stu-id="d357a-122">Using this method, you will generally start with a database backup followed by a copy of the database backup into Azure and then perform a database restore.</span></span> <span data-ttu-id="d357a-123">Vous pouvez également copier les fichiers de base de données eux-mêmes dans Azure, puis les joindre.</span><span class="sxs-lookup"><span data-stu-id="d357a-123">You can also copy the database files themselves into Azure and then attach them.</span></span> <span data-ttu-id="d357a-124">Il existe plusieurs méthodes permettant d’effectuer manuellement le processus de migration d’une base de données vers une machine virtuelle Azure.</span><span class="sxs-lookup"><span data-stu-id="d357a-124">There are several methods by which you can accomplish this manual process of migrating a database into an Azure VM.</span></span>

> [!NOTE]
> <span data-ttu-id="d357a-125">Lorsque vous procédez à une mise à niveau vers SQL Server 2014 ou SQL Server 2016 depuis des versions antérieures de SQL Server, vous devez prendre en compte les éventuelles modifications nécessaires.</span><span class="sxs-lookup"><span data-stu-id="d357a-125">When you upgrade to SQL Server 2014 or SQL Server 2016 from older versions of SQL Server, you should consider whether changes are needed.</span></span> <span data-ttu-id="d357a-126">Nous vous recommandons de gérer toutes les dépendances de fonctionnalités non prises en charge par la nouvelle version de SQL Server dans le cadre de votre projet de migration.</span><span class="sxs-lookup"><span data-stu-id="d357a-126">We recommend that you address all dependencies on features not supported by the new version of SQL Server as part of your migration project.</span></span> <span data-ttu-id="d357a-127">Pour plus d’informations sur les éditions et les scénarios pris en charge, consultez [Mise à niveau vers SQL Server](https://msdn.microsoft.com/library/bb677622.aspx).</span><span class="sxs-lookup"><span data-stu-id="d357a-127">For more information on the supported editions and scenarios, see [Upgrade to SQL Server](https://msdn.microsoft.com/library/bb677622.aspx).</span></span>

<span data-ttu-id="d357a-128">Le tableau suivant répertorie les principales méthodes de migration et explique dans quelles circonstances utiliser chacune d’elles.</span><span class="sxs-lookup"><span data-stu-id="d357a-128">The following table lists each of the primary migration methods and discusses when the use of each method is most appropriate.</span></span>

| <span data-ttu-id="d357a-129">Méthode</span><span class="sxs-lookup"><span data-stu-id="d357a-129">Method</span></span> | <span data-ttu-id="d357a-130">Version de base de données source</span><span class="sxs-lookup"><span data-stu-id="d357a-130">Source database version</span></span> | <span data-ttu-id="d357a-131">Version de base de données de destination</span><span class="sxs-lookup"><span data-stu-id="d357a-131">Destination database version</span></span> | <span data-ttu-id="d357a-132">Contrainte de taille pour la sauvegarde de base de données source</span><span class="sxs-lookup"><span data-stu-id="d357a-132">Source database backup size constraint</span></span> | <span data-ttu-id="d357a-133">Remarques</span><span class="sxs-lookup"><span data-stu-id="d357a-133">Notes</span></span> |
| --- | --- | --- | --- | --- |
| [<span data-ttu-id="d357a-134">Effectuer une sauvegarde locale en utilisant la compression et copier manuellement le fichier de sauvegarde dans la machine virtuelle Azure</span><span class="sxs-lookup"><span data-stu-id="d357a-134">Perform on-premises backup using compression and manually copy the backup file into the Azure virtual machine</span></span>](#backup-and-restore) |<span data-ttu-id="d357a-135">SQL Server 2005 ou ultérieur</span><span class="sxs-lookup"><span data-stu-id="d357a-135">SQL Server 2005 or greater</span></span> |<span data-ttu-id="d357a-136">SQL Server 2005 ou ultérieur</span><span class="sxs-lookup"><span data-stu-id="d357a-136">SQL Server 2005 or greater</span></span> |[<span data-ttu-id="d357a-137">Limite de stockage de machine virtuelle Azure</span><span class="sxs-lookup"><span data-stu-id="d357a-137">Azure VM storage limit</span></span>](https://azure.microsoft.com/documentation/articles/azure-subscription-service-limits/) | <span data-ttu-id="d357a-138">Il s’agit d’une technique très simple et éprouvée pour déplacer des bases de données d’une machine à l’autre.</span><span class="sxs-lookup"><span data-stu-id="d357a-138">This is a very simple and well-tested technique for moving databases across machines.</span></span> |
| [<span data-ttu-id="d357a-139">Effectuer une sauvegarde vers l’URL et une restauration dans la machine virtuelle Azure depuis l’URL</span><span class="sxs-lookup"><span data-stu-id="d357a-139">Perform a backup to URL and restore into the Azure virtual machine from the URL</span></span>](#backup-to-url-and-restore) |<span data-ttu-id="d357a-140">SQL Server 2012 SP1 CU2 ou ultérieur</span><span class="sxs-lookup"><span data-stu-id="d357a-140">SQL Server 2012 SP1 CU2 or greater</span></span> |<span data-ttu-id="d357a-141">SQL Server 2012 SP1 CU2 ou ultérieur</span><span class="sxs-lookup"><span data-stu-id="d357a-141">SQL Server 2012 SP1 CU2 or greater</span></span> |<span data-ttu-id="d357a-142">< 12,8 To pour SQL Server 2016, sinon < 1 To</span><span class="sxs-lookup"><span data-stu-id="d357a-142">< 12.8 TB for SQL Server 2016, otherwise < 1 TB</span></span> | <span data-ttu-id="d357a-143">Cette méthode représente simplement une autre façon de déplacer le fichier de sauvegarde sur la machine virtuelle à l’aide du stockage Azure.</span><span class="sxs-lookup"><span data-stu-id="d357a-143">This method is just another way to move the backup file to the VM using Azure storage.</span></span> |
| [<span data-ttu-id="d357a-144">Détacher, puis copier les données et les fichiers journaux dans le stockage d’objets blob Azure et les rattacher à SQL Server dans la machine virtuelle Azure à partir d’URL</span><span class="sxs-lookup"><span data-stu-id="d357a-144">Detach and then copy the data and log files to Azure blob storage and then attach to SQL Server in Azure virtual machine from URL</span></span>](#detach-and-attach-from-url) |<span data-ttu-id="d357a-145">SQL Server 2005 ou ultérieur</span><span class="sxs-lookup"><span data-stu-id="d357a-145">SQL Server 2005 or greater</span></span> |<span data-ttu-id="d357a-146">SQL Server 2014 ou ultérieur</span><span class="sxs-lookup"><span data-stu-id="d357a-146">SQL Server 2014 or greater</span></span> |[<span data-ttu-id="d357a-147">Limite de stockage de machine virtuelle Azure</span><span class="sxs-lookup"><span data-stu-id="d357a-147">Azure VM storage limit</span></span>](https://azure.microsoft.com/documentation/articles/azure-subscription-service-limits/) |<span data-ttu-id="d357a-148">Utilisez cette méthode quand vous envisagez de [stocker ces fichiers à l’aide du service de stockage d’objets Blob Azure](https://msdn.microsoft.com/library/dn385720.aspx) et de les rattacher à SQL Server s’exécutant dans une machine virtuelle Azure, en particulier avec les bases de données très volumineuses.</span><span class="sxs-lookup"><span data-stu-id="d357a-148">Use this method when you plan to [store these files using the Azure Blob storage service](https://msdn.microsoft.com/library/dn385720.aspx) and attach them to SQL Server running in an Azure VM, particularly with very large databases</span></span> |
| [<span data-ttu-id="d357a-149">Convertir l’ordinateur local pour les disques durs virtuels Hyper-V, charger sur le stockage d’objets Blob Azure, puis déployer une nouvelle machine virtuelle en utilisant le disque dur virtuel chargé</span><span class="sxs-lookup"><span data-stu-id="d357a-149">Convert on-premises machine to Hyper-V VHDs, upload to Azure Blob storage, and then deploy a new virtual machine using uploaded VHD</span></span>](#convert-to-vm-and-upload-to-url-and-deploy-as-new-vm) |<span data-ttu-id="d357a-150">SQL Server 2005 ou ultérieur</span><span class="sxs-lookup"><span data-stu-id="d357a-150">SQL Server 2005 or greater</span></span> |<span data-ttu-id="d357a-151">SQL Server 2005 ou ultérieur</span><span class="sxs-lookup"><span data-stu-id="d357a-151">SQL Server 2005 or greater</span></span> |[<span data-ttu-id="d357a-152">Limite de stockage de machine virtuelle Azure</span><span class="sxs-lookup"><span data-stu-id="d357a-152">Azure VM storage limit</span></span>](https://azure.microsoft.com/documentation/articles/azure-subscription-service-limits/) |<span data-ttu-id="d357a-153">À utiliser lors de [la mise en service de votre propre licence SQL Server](../../../sql-database/sql-database-paas-vs-sql-server-iaas.md), lors de la migration d’une base de données que vous allez exécuter sur une version plus ancienne de SQL Server, ou lors de la migration d’un système et de bases de données d’un système utilisateur dans le cadre de la migration de base de données dépendant des autres bases de données utilisateur et/ou bases de données système.</span><span class="sxs-lookup"><span data-stu-id="d357a-153">Use when [bringing your own SQL Server license](../../../sql-database/sql-database-paas-vs-sql-server-iaas.md), when migrating a database that you will run on an older version of SQL Server, or when migrating system and user databases together as part of the migration of database dependent on other user databases and/or system databases.</span></span> |
| [<span data-ttu-id="d357a-154">Expédition du disque dur à l’aide du Service d’importation/exportation Windows</span><span class="sxs-lookup"><span data-stu-id="d357a-154">Ship hard drive using Windows Import/Export Service</span></span>](#ship-hard-drive) |<span data-ttu-id="d357a-155">SQL Server 2005 ou ultérieur</span><span class="sxs-lookup"><span data-stu-id="d357a-155">SQL Server 2005 or greater</span></span> |<span data-ttu-id="d357a-156">SQL Server 2005 ou ultérieur</span><span class="sxs-lookup"><span data-stu-id="d357a-156">SQL Server 2005 or greater</span></span> |[<span data-ttu-id="d357a-157">Limite de stockage de machine virtuelle Azure</span><span class="sxs-lookup"><span data-stu-id="d357a-157">Azure VM storage limit</span></span>](https://azure.microsoft.com/documentation/articles/azure-subscription-service-limits/) |<span data-ttu-id="d357a-158">Utilisez le [Service Import/Export de Windows](../../../storage/common/storage-import-export-service.md) lorsque la méthode de copie manuelle est trop lente, par exemple avec de très grandes bases de données.</span><span class="sxs-lookup"><span data-stu-id="d357a-158">Use the [Windows Import/Export Service](../../../storage/common/storage-import-export-service.md) when manual copy method is too slow, such as with very large databases</span></span> |
| [<span data-ttu-id="d357a-159">Utiliser l’Assistant Ajout d’un réplica Azure</span><span class="sxs-lookup"><span data-stu-id="d357a-159">Use the Add Azure Replica Wizard</span></span>](../classic/sql-onprem-availability.md) |<span data-ttu-id="d357a-160">SQL Server 2012 ou ultérieur</span><span class="sxs-lookup"><span data-stu-id="d357a-160">SQL Server 2012 or greater</span></span> |<span data-ttu-id="d357a-161">SQL Server 2012 ou ultérieur</span><span class="sxs-lookup"><span data-stu-id="d357a-161">SQL Server 2012 or greater</span></span> |[<span data-ttu-id="d357a-162">Limite de stockage de machine virtuelle Azure</span><span class="sxs-lookup"><span data-stu-id="d357a-162">Azure VM storage limit</span></span>](https://azure.microsoft.com/documentation/articles/azure-subscription-service-limits/) |<span data-ttu-id="d357a-163">Réduit le temps d’arrêt ; à utiliser lorsque vous disposez d’un déploiement local AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="d357a-163">Minimizes downtime, use when you have an AlwaysOn on-premises deployment</span></span> |
| [<span data-ttu-id="d357a-164">Utiliser la réplication transactionnelle de SQL Server</span><span class="sxs-lookup"><span data-stu-id="d357a-164">Use SQL Server transactional replication</span></span>](https://msdn.microsoft.com/library/ms151176.aspx) |<span data-ttu-id="d357a-165">SQL Server 2005 ou ultérieur</span><span class="sxs-lookup"><span data-stu-id="d357a-165">SQL Server 2005 or greater</span></span> |<span data-ttu-id="d357a-166">SQL Server 2005 ou ultérieur</span><span class="sxs-lookup"><span data-stu-id="d357a-166">SQL Server 2005 or greater</span></span> |[<span data-ttu-id="d357a-167">Limite de stockage de machine virtuelle Azure</span><span class="sxs-lookup"><span data-stu-id="d357a-167">Azure VM storage limit</span></span>](https://azure.microsoft.com/documentation/articles/azure-subscription-service-limits/) |<span data-ttu-id="d357a-168">À utiliser si vous devez réduire le temps d’arrêt et que vous ne disposez pas d’un déploiement local AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="d357a-168">Use when you need to minimize downtime and do not have an AlwaysOn on-premises deployment</span></span> |

## <a name="backup-and-restore"></a><span data-ttu-id="d357a-169">Sauvegarde et restauration</span><span class="sxs-lookup"><span data-stu-id="d357a-169">Backup and restore</span></span>
<span data-ttu-id="d357a-170">Sauvegardez votre base de données avec compression, copiez la sauvegarde sur la machine virtuelle, puis restaurez la base de données.</span><span class="sxs-lookup"><span data-stu-id="d357a-170">Back up your database with compression, copy the backup to the VM, and then restore the database.</span></span> <span data-ttu-id="d357a-171">Si le volume de votre fichier de sauvegarde est supérieur à 1 To, vous devez le partager parce que la taille maximum d’un disque de machine virtuelle est de 1 To.</span><span class="sxs-lookup"><span data-stu-id="d357a-171">If your backup file is larger than 1 TB, you must stripe it because the maximum size of a VM disk is 1 TB.</span></span> <span data-ttu-id="d357a-172">Utilisez les étapes générales suivantes pour faire migrer une base de données utilisateur à l’aide de cette méthode manuelle :</span><span class="sxs-lookup"><span data-stu-id="d357a-172">Use the following general steps to migrate a user database using this manual method:</span></span>

1. <span data-ttu-id="d357a-173">Effectuez une sauvegarde complète de la base de données vers un emplacement sur site.</span><span class="sxs-lookup"><span data-stu-id="d357a-173">Perform a full database backup to an on-premises location.</span></span>
2. <span data-ttu-id="d357a-174">Créez ou téléchargez une machine virtuelle avec la version de SQL Server souhaitée.</span><span class="sxs-lookup"><span data-stu-id="d357a-174">Create or upload a virtual machine with the version of SQL Server desired.</span></span>
3. <span data-ttu-id="d357a-175">Configurez la connectivité en fonction de vos besoins.</span><span class="sxs-lookup"><span data-stu-id="d357a-175">Setup connectivity based on your requirements.</span></span> <span data-ttu-id="d357a-176">Consultez [Se connecter à une machine virtuelle SQL Server sur Azure (Resource Manager)](virtual-machines-windows-sql-connect.md).</span><span class="sxs-lookup"><span data-stu-id="d357a-176">See [Connect to a SQL Server Virtual Machine on Azure (Resource Manager)](virtual-machines-windows-sql-connect.md).</span></span>
4. <span data-ttu-id="d357a-177">Copiez vos fichiers de sauvegarde à votre machine virtuelle à l’aide du Bureau à distance, de l’Explorateur Windows ou de la commande de copie à partir d’une invite de commandes.</span><span class="sxs-lookup"><span data-stu-id="d357a-177">Copy your backup file(s) to your VM using remote desktop, Windows Explorer or the copy command from a command prompt.</span></span>

## <a name="backup-to-url-and-restore"></a><span data-ttu-id="d357a-178">Sauvegarde vers URL et restauration</span><span class="sxs-lookup"><span data-stu-id="d357a-178">Backup to URL and restore</span></span>
<span data-ttu-id="d357a-179">Au lieu de sauvegarder dans un fichier local, vous pouvez utiliser la [sauvegarde sur URL](https://msdn.microsoft.com/library/dn435916.aspx), puis effectuer la restauration sur la machine virtuelle à partir de l’URL.</span><span class="sxs-lookup"><span data-stu-id="d357a-179">Instead of backing up to a local file, you can use the [backup to URL](https://msdn.microsoft.com/library/dn435916.aspx) and then restore from URL to the VM.</span></span> <span data-ttu-id="d357a-180">Avec SQL Server 2016, les sauvegardes agrégées par bandes sont prises en charge sont recommandés pour les performances et doit dépasser les limites de taille par objet blob.</span><span class="sxs-lookup"><span data-stu-id="d357a-180">With SQL Server 2016, striped backup sets are supported, are recommended for performance, and required to exceed the size limits per blob.</span></span> <span data-ttu-id="d357a-181">Pour les bases de données très volumineuses, il est recommandé d’utiliser le [Service d’importation/exportation Windows](../../../storage/common/storage-import-export-service.md) .</span><span class="sxs-lookup"><span data-stu-id="d357a-181">For very large databases, the use of the [Windows Import/Export Service](../../../storage/common/storage-import-export-service.md) is recommended.</span></span>

## <a name="detach-and-attach-from-url"></a><span data-ttu-id="d357a-182">Détacher et attacher à partir d’une URL</span><span class="sxs-lookup"><span data-stu-id="d357a-182">Detach and attach from URL</span></span>
<span data-ttu-id="d357a-183">Détachez votre base de données et vos fichiers journaux et transférez-les vers le [stockage Blob Azure](https://msdn.microsoft.com/library/dn385720.aspx).</span><span class="sxs-lookup"><span data-stu-id="d357a-183">Detach your database and log files and transfer them to [Azure Blob storage](https://msdn.microsoft.com/library/dn385720.aspx).</span></span> <span data-ttu-id="d357a-184">Puis attachez la base de données sur votre machine virtuelle Azure à partir de l’URL.</span><span class="sxs-lookup"><span data-stu-id="d357a-184">Then attach the database from the URL on your Azure VM.</span></span> <span data-ttu-id="d357a-185">Utilisez cette méthode si vous souhaitez que les fichiers de la base de données physique résident dans le stockage Blob.</span><span class="sxs-lookup"><span data-stu-id="d357a-185">Use this if you want the physical database files to reside in Blob storage.</span></span> <span data-ttu-id="d357a-186">Cela peut être utile pour les bases de données très volumineuses.</span><span class="sxs-lookup"><span data-stu-id="d357a-186">This might be useful for very large databases.</span></span> <span data-ttu-id="d357a-187">Utilisez les étapes générales suivantes pour faire migrer une base de données utilisateur à l’aide de cette méthode manuelle :</span><span class="sxs-lookup"><span data-stu-id="d357a-187">Use the following general steps to migrate a user database using this manual method:</span></span>

1. <span data-ttu-id="d357a-188">Détachez les fichiers de base de données de l’instance de base de données sur site.</span><span class="sxs-lookup"><span data-stu-id="d357a-188">Detach the database files from the on-premises database instance.</span></span>
2. <span data-ttu-id="d357a-189">Copiez les fichiers de la base de données détachée dans le stockage blob Azure à l’aide de l’ [utilitaire de ligne de commande AZCopy](../../../storage/common/storage-use-azcopy.md).</span><span class="sxs-lookup"><span data-stu-id="d357a-189">Copy the detached database files into Azure blob storage using the [AZCopy command-line utility](../../../storage/common/storage-use-azcopy.md).</span></span>
3. <span data-ttu-id="d357a-190">Attachez les fichiers de base de données à partir de l’URL Azure à l’instance de SQL Server dans la machine virtuelle Azure.</span><span class="sxs-lookup"><span data-stu-id="d357a-190">Attach the database files from the Azure URL to the SQL Server instance in the Azure VM.</span></span>

## <a name="convert-to-vm-and-upload-to-url-and-deploy-as-new-vm"></a><span data-ttu-id="d357a-191">Effectuez une conversion vers une machine virtuelle et téléchargez vers une URL et déployez en tant que nouvelle machine virtuelle</span><span class="sxs-lookup"><span data-stu-id="d357a-191">Convert to VM and upload to URL and deploy as new VM</span></span>
<span data-ttu-id="d357a-192">Cette méthode permet de migrer toutes les bases de données système et utilisateur dans une instance de SQL Server sur site vers une machine virtuelle Azure.</span><span class="sxs-lookup"><span data-stu-id="d357a-192">Use this method to migrate all system and user databases in an on-premises SQL Server instance to Azure virtual machine.</span></span> <span data-ttu-id="d357a-193">Utilisez les étapes générales suivantes pour exécuter la migration d’une instance de SQL Server entière à l’aide de cette méthode manuelle :</span><span class="sxs-lookup"><span data-stu-id="d357a-193">Use the following general steps to migrate an entire SQL Server instance using this manual method:</span></span>

1. <span data-ttu-id="d357a-194">Convertissez les machines physiques ou virtuelles en disques durs virtuels Hyper-V à l’aide du [Convertisseur Microsoft Virtual Machine](https://technet.microsoft.com/library/dn874008(v=ws.11).aspx).</span><span class="sxs-lookup"><span data-stu-id="d357a-194">Convert physical or virtual machines to Hyper-V VHDs by using [Microsoft Virtual Machine Converter](https://technet.microsoft.com/library/dn874008(v=ws.11).aspx).</span></span>
2. <span data-ttu-id="d357a-195">Télécharger les fichiers VHD sur Azure Storage à l’aide de l’ [applet de commande Add-AzureVHD](https://msdn.microsoft.com/library/windowsazure/dn495173.aspx).</span><span class="sxs-lookup"><span data-stu-id="d357a-195">Upload VHD files to Azure Storage by using the [Add-AzureVHD cmdlet](https://msdn.microsoft.com/library/windowsazure/dn495173.aspx).</span></span>
3. <span data-ttu-id="d357a-196">Déployer une nouvelle machine virtuelle en utilisant le VHD téléchargé.</span><span class="sxs-lookup"><span data-stu-id="d357a-196">Deploy a new virtual machine by using the uploaded VHD.</span></span>

> [!NOTE]
> <span data-ttu-id="d357a-197">Pour migrer une application entière, envisagez d’utiliser [Azure Site Recovery](../../../site-recovery/site-recovery-overview.md)].</span><span class="sxs-lookup"><span data-stu-id="d357a-197">To migrate an entire application, consider using [Azure Site Recovery](../../../site-recovery/site-recovery-overview.md)].</span></span>

## <a name="ship-hard-drive"></a><span data-ttu-id="d357a-198">Livraison de disque dur</span><span class="sxs-lookup"><span data-stu-id="d357a-198">Ship hard drive</span></span>
<span data-ttu-id="d357a-199">Vous pouvez utiliser la [méthode de service Import/Export Azure](../../../storage/common/storage-import-export-service.md) pour transférer de grandes quantités de données de fichiers vers le stockage d’objets blob Azure lorsque le coût de l’opération de téléchargement via le réseau est prohibitif, voire irréalisable.</span><span class="sxs-lookup"><span data-stu-id="d357a-199">Use the [Windows Import/Export Service method](../../../storage/common/storage-import-export-service.md) to transfer large amounts of file data to Azure Blob storage in situations where uploading over the network is prohibitively expensive or not feasible.</span></span> <span data-ttu-id="d357a-200">Avec ce service, vous envoyez un ou plusieurs disques durs contenant ces données à un centre de données Azure, où vos données seront téléchargées sur votre compte de stockage.</span><span class="sxs-lookup"><span data-stu-id="d357a-200">With this service, you send one or more hard drives containing that data to an Azure data center, where your data will be uploaded to your storage account.</span></span>

## <a name="next-steps"></a><span data-ttu-id="d357a-201">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="d357a-201">Next Steps</span></span>
<span data-ttu-id="d357a-202">Pour plus d’informations sur l’exécution de SQL Server sur des machines virtuelles Azure, voir [SQL Server sur les machines virtuelles Azure](virtual-machines-windows-sql-server-iaas-overview.md).</span><span class="sxs-lookup"><span data-stu-id="d357a-202">For more information about running SQL Server on Azure Virtual Machines, see [SQL Server on Azure Virtual Machines overview](virtual-machines-windows-sql-server-iaas-overview.md).</span></span>

<span data-ttu-id="d357a-203">Pour obtenir des instructions sur la création d’une machine virtuelle Azure SQL Server à partir d’une image capturée, consultez la page [Tips & Tricks on ‘cloning’ Azure SQL virtual machines from captured images](https://blogs.msdn.microsoft.com/psssql/2016/07/06/tips-tricks-on-cloning-azure-sql-virtual-machines-from-captured-images/) (Trucs et astuces sur le « clonage » des machines virtuelles Azure SQL à partir d’images capturées) du blog des ingénieurs CSS SQL Server.</span><span class="sxs-lookup"><span data-stu-id="d357a-203">For instructions on creating an Azure SQL Server Virtual Machine from a captured image, see [Tips & Tricks on ‘cloning’ Azure SQL virtual machines from captured images](https://blogs.msdn.microsoft.com/psssql/2016/07/06/tips-tricks-on-cloning-azure-sql-virtual-machines-from-captured-images/) on the CSS SQL Server Engineers blog.</span></span>

