---
title: "Déploiement de Machines virtuelles Azure pour SAP sur Windows | Microsoft Docs"
description: "Apprenez à déployer des logiciels SAP sur des machines virtuelles Windows dans Azure."
services: virtual-machines-windows
documentationcenter: 
author: MSSedusch
manager: timlt
editor: 
tags: azure-resource-manager
keywords: 
ms.assetid: 22aaa98c-bb9f-472f-b546-0b294e033cda
ms.service: virtual-machines-windows
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: infrastructure-services
ms.date: 11/08/2016
ms.author: sedusch
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: ac7c1e3b015a21fe06f27205b27a53fc4d2f3df7
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/11/2017
---
# <a name="deploy-sap-on-windows-vms-in-azure"></a><span data-ttu-id="7b578-103">Déployer SAP sur des machines virtuelles Windows dans Azure</span><span class="sxs-lookup"><span data-stu-id="7b578-103">Deploy SAP on Windows VMs in Azure</span></span>
[767598]:https://launchpad.support.sap.com/#/notes/767598
[773830]:https://launchpad.support.sap.com/#/notes/773830
[826037]:https://launchpad.support.sap.com/#/notes/826037
[965908]:https://launchpad.support.sap.com/#/notes/965908
<span data-ttu-id="7b578-104">[1031096]:https://launchpad.support.sap.com/#/notes/1031096</span><span class="sxs-lookup"><span data-stu-id="7b578-104">[1031096]:https://launchpad.support.sap.com/#/notes/1031096</span></span>
[1139904]:https://launchpad.support.sap.com/#/notes/1139904
[1173395]:https://launchpad.support.sap.com/#/notes/1173395
[1245200]:https://launchpad.support.sap.com/#/notes/1245200
<span data-ttu-id="7b578-105">[1409604]:https://launchpad.support.sap.com/#/notes/1409604</span><span class="sxs-lookup"><span data-stu-id="7b578-105">[1409604]:https://launchpad.support.sap.com/#/notes/1409604</span></span>
[1558958]:https://launchpad.support.sap.com/#/notes/1558958
[1585981]:https://launchpad.support.sap.com/#/notes/1585981
[1588316]:https://launchpad.support.sap.com/#/notes/1588316
[1590719]:https://launchpad.support.sap.com/#/notes/1590719
[1597355]:https://launchpad.support.sap.com/#/notes/1597355
[1605680]:https://launchpad.support.sap.com/#/notes/1605680
<span data-ttu-id="7b578-106">[1619720]:https://launchpad.support.sap.com/#/notes/1619720</span><span class="sxs-lookup"><span data-stu-id="7b578-106">[1619720]:https://launchpad.support.sap.com/#/notes/1619720</span></span>
[1619726]:https://launchpad.support.sap.com/#/notes/1619726
[1619967]:https://launchpad.support.sap.com/#/notes/1619967
[1750510]:https://launchpad.support.sap.com/#/notes/1750510
[1752266]:https://launchpad.support.sap.com/#/notes/1752266
[1757924]:https://launchpad.support.sap.com/#/notes/1757924
[1757928]:https://launchpad.support.sap.com/#/notes/1757928
[1758182]:https://launchpad.support.sap.com/#/notes/1758182
[1758496]:https://launchpad.support.sap.com/#/notes/1758496
[1772688]:https://launchpad.support.sap.com/#/notes/1772688
[1814258]:https://launchpad.support.sap.com/#/notes/1814258
[1882376]:https://launchpad.support.sap.com/#/notes/1882376
[1909114]:https://launchpad.support.sap.com/#/notes/1909114
[1922555]:https://launchpad.support.sap.com/#/notes/1922555
<span data-ttu-id="7b578-107">[1928533]:https://launchpad.support.sap.com/#/notes/1928533</span><span class="sxs-lookup"><span data-stu-id="7b578-107">[1928533]:https://launchpad.support.sap.com/#/notes/1928533</span></span>
[1941500]:https://launchpad.support.sap.com/#/notes/1941500
[1956005]:https://launchpad.support.sap.com/#/notes/1956005
[1973241]:https://launchpad.support.sap.com/#/notes/1973241
<span data-ttu-id="7b578-108">[1984787]:https://launchpad.support.sap.com/#/notes/1984787</span><span class="sxs-lookup"><span data-stu-id="7b578-108">[1984787]:https://launchpad.support.sap.com/#/notes/1984787</span></span>
<span data-ttu-id="7b578-109">[1999351]:https://launchpad.support.sap.com/#/notes/1999351</span><span class="sxs-lookup"><span data-stu-id="7b578-109">[1999351]:https://launchpad.support.sap.com/#/notes/1999351</span></span>
<span data-ttu-id="7b578-110">[2002167]:https://launchpad.support.sap.com/#/notes/2002167</span><span class="sxs-lookup"><span data-stu-id="7b578-110">[2002167]:https://launchpad.support.sap.com/#/notes/2002167</span></span>
<span data-ttu-id="7b578-111">[2015553]:https://launchpad.support.sap.com/#/notes/2015553</span><span class="sxs-lookup"><span data-stu-id="7b578-111">[2015553]:https://launchpad.support.sap.com/#/notes/2015553</span></span>
[2039619]:https://launchpad.support.sap.com/#/notes/2039619
[2121797]:https://launchpad.support.sap.com/#/notes/2121797
[2134316]:https://launchpad.support.sap.com/#/notes/2134316
<span data-ttu-id="7b578-112">[2178632]:https://launchpad.support.sap.com/#/notes/2178632</span><span class="sxs-lookup"><span data-stu-id="7b578-112">[2178632]:https://launchpad.support.sap.com/#/notes/2178632</span></span>
<span data-ttu-id="7b578-113">[2191498]:https://launchpad.support.sap.com/#/notes/2191498</span><span class="sxs-lookup"><span data-stu-id="7b578-113">[2191498]:https://launchpad.support.sap.com/#/notes/2191498</span></span>
[2233094]:https://launchpad.support.sap.com/#/notes/2233094
<span data-ttu-id="7b578-114">[2243692]:https://launchpad.support.sap.com/#/notes/2243692</span><span class="sxs-lookup"><span data-stu-id="7b578-114">[2243692]:https://launchpad.support.sap.com/#/notes/2243692</span></span>
[2367194]:https://launchpad.support.sap.com/#/notes/2367194

[azure-cli]:../../cli-install-nodejs.md
[azure-portal]:https://portal.azure.com
[azure-ps]:/powershell/azureps-cmdlets-docs
[azure-quickstart-templates-github]:https://github.com/Azure/azure-quickstart-templates
[azure-script-ps]:https://go.microsoft.com/fwlink/p/?LinkID=395017
[azure-subscription-service-limits]:../../azure-subscription-service-limits.md
[azure-subscription-service-limits-subscription]:../../azure-subscription-service-limits.md#subscription-limits

[dbms-guide]:sap-dbms-guide.md (Azure Virtual Machines DBMS deployment for SAP on Windows)
[dbms-guide-2.1]:sap-dbms-guide.md#c7abf1f0-c927-4a7c-9c1d-c7b5b3b7212f (Caching for VMs and VHDs)
[dbms-guide-2.2]:sap-dbms-guide.md#c8e566f9-21b7-4457-9f7f-126036971a91 (Software RAID)
[dbms-guide-2.3]:sap-dbms-guide.md#10b041ef-c177-498a-93ed-44b3441ab152 (Microsoft Azure Storage)
[dbms-guide-2]:sap-dbms-guide.md#65fa79d6-a85f-47ee-890b-22e794f51a64 (Structure of a RDBMS deployment)
[dbms-guide-3]:sap-dbms-guide.md#871dfc27-e509-4222-9370-ab1de77021c3 (High availability and disaster recovery with Azure VMs)
[dbms-guide-5.5.1]:sap-dbms-guide.md#0fef0e79-d3fe-4ae2-85af-73666a6f7268 (SQL Server 2012 SP1 CU4 and later)
[dbms-guide-5.5.2]:sap-dbms-guide.md#f9071eff-9d72-4f47-9da4-1852d782087b (SQL Server 2012 SP1 CU3 and earlier releases)
[dbms-guide-5.6]:sap-dbms-guide.md#1b353e38-21b3-4310-aeb6-a77e7c8e81c8 (Using a SQL Server image from the Azure Marketplace)
[dbms-guide-5.8]:sap-dbms-guide.md#9053f720-6f3b-4483-904d-15dc54141e30 (General SQL Server for SAP on Azure summary)
[dbms-guide-5]:sap-dbms-guide.md#3264829e-075e-4d25-966e-a49dad878737 (Specifics to SQL Server RDBMS)
[dbms-guide-8.4.1]:sap-dbms-guide.md#b48cfe3b-48e9-4f5b-a783-1d29155bd573 (Storage configuration)
[dbms-guide-8.4.2]:sap-dbms-guide.md#23c78d3b-ca5a-4e72-8a24-645d141a3f5d (Backup and restore)
[dbms-guide-8.4.3]:sap-dbms-guide.md#77cd2fbb-307e-4cbf-a65f-745553f72d2c (Performance considerations for backup and restore)
[dbms-guide-8.4.4]:sap-dbms-guide.md#f77c1436-9ad8-44fb-a331-8671342de818 (Other)
[dbms-guide-900-sap-cache-server-on-premises]:sap-dbms-guide.md#642f746c-e4d4-489d-bf63-73e80177a0a8

[dbms-guide-figure-100]:./media/virtual-machines-shared-sap-dbms-guide/100_storage_account_types.png
[dbms-guide-figure-200]:./media/virtual-machines-shared-sap-dbms-guide/200-ha-set-for-dbms-ha.png
[dbms-guide-figure-300]:./media/virtual-machines-shared-sap-dbms-guide/300-reference-config-iaas.png
[dbms-guide-figure-400]:./media/virtual-machines-shared-sap-dbms-guide/400-sql-2012-backup-to-blob-storage.png
[dbms-guide-figure-500]:./media/virtual-machines-shared-sap-dbms-guide/500-sql-2012-backup-to-blob-storage-different-containers.png
[dbms-guide-figure-600]:./media/virtual-machines-shared-sap-dbms-guide/600-iaas-maxdb.png
[dbms-guide-figure-700]:./media/virtual-machines-shared-sap-dbms-guide/700-livecach-prod.png
[dbms-guide-figure-800]:./media/virtual-machines-shared-sap-dbms-guide/800-azure-vm-sap-content-server.png
[dbms-guide-figure-900]:./media/virtual-machines-shared-sap-dbms-guide/900-sap-cache-server-on-premises.png

[deployment-guide]:sap-deployment-guide.md (Azure Virtual Machines deployment for SAP on Windows)
[deployment-guide-2.2]:#42ee2bdb-1efc-4ec7-ab31-fe4c22769b94 (SAP resources)
[deployment-guide-3.1.2]:#3688666f-281f-425b-a312-a77e7db2dfab (Deploying a VM by using a custom image)
[deployment-guide-3.2]:#db477013-9060-4602-9ad4-b0316f8bb281 (Scenario 1: Deploying a VM from the Azure Marketplace for SAP)
[deployment-guide-3.3]:#54a1fc6d-24fd-4feb-9c57-ac588a55dff2 (Scenario 2: Deploying a VM with a custom image for SAP)
[deployment-guide-3.4]:#a9a60133-a763-4de8-8986-ac0fa33aa8c1 (Scenario 3: Moving a VM from on-premises using a non-generalized Azure VHD with SAP)
[deployment-guide-3]:#b3253ee3-d63b-4d74-a49b-185e76c4088e (Deployment scenarios of VMs for SAP on Microsoft Azure)
[deployment-guide-4.1]:#604bcec2-8b6e-48d2-a944-61b0f5dee2f7 (Deploying Azure PowerShell cmdlets)
[deployment-guide-4.2]:#7ccf6c3e-97ae-4a7a-9c75-e82c37beb18e (Download and import SAP-relevant PowerShell cmdlets)
[deployment-guide-4.3]:#31d9ecd6-b136-4c73-b61e-da4a29bbc9cc (Join a VM to an on-premises domain - Windows only)
[deployment-guide-4.4.2]:#6889ff12-eaaf-4f3c-97e1-7c9edc7f7542 (Linux)
[deployment-guide-4.4]:#c7cbb0dc-52a4-49db-8e03-83e7edc2927d (Download, install, and enable the Azure VM Agent)
[deployment-guide-4.5.1]:#987cf279-d713-4b4c-8143-6b11589bb9d4 (Azure PowerShell)
[deployment-guide-4.5.2]:#408f3779-f422-4413-82f8-c57a23b4fc2f (Azure CLI)
[deployment-guide-4.5]:#d98edcd3-f2a1-49f7-b26a-07448ceb60ca (Configure the Azure Enhanced Monitoring Extension for SAP)
[deployment-guide-5.1]:#bb61ce92-8c5c-461f-8c53-39f5e5ed91f2 (Readiness check for Azure Enhanced Monitoring for SAP)
[deployment-guide-5.2]:#e2d592ff-b4ea-4a53-a91a-e5521edb6cd1 (Health check for the Azure monitoring infrastructure)
[deployment-guide-5.3]:#fe25a7da-4e4e-4388-8907-8abc2d33cfd8 (Troubleshooting Azure monitoring for SAP)

[deployment-guide-configure-monitoring-scenario-1]:#ec323ac3-1de9-4c3a-b770-4ff701def65b (Configure monitoring)
[deployment-guide-configure-proxy]:#baccae00-6f79-4307-ade4-40292ce4e02d (Configure the proxy)
[deployment-guide-figure-100]:./media/virtual-machines-shared-sap-deployment-guide/100-deploy-vm-image.png
[deployment-guide-figure-1000]:./media/virtual-machines-shared-sap-deployment-guide/1000-service-properties.png
[deployment-guide-figure-11]:#figure-11
[deployment-guide-figure-1100]:./media/virtual-machines-shared-sap-deployment-guide/1100-azperflib.png
[deployment-guide-figure-1200]:./media/virtual-machines-shared-sap-deployment-guide/1200-cmd-test-login.png
[deployment-guide-figure-1300]:./media/virtual-machines-shared-sap-deployment-guide/1300-cmd-test-executed.png
[deployment-guide-figure-14]:#figure-14
[deployment-guide-figure-1400]:./media/virtual-machines-shared-sap-deployment-guide/1400-azperflib-error-servicenotstarted.png
[deployment-guide-figure-300]:./media/virtual-machines-shared-sap-deployment-guide/300-deploy-private-image.png
[deployment-guide-figure-400]:./media/virtual-machines-shared-sap-deployment-guide/400-deploy-using-disk.png
[deployment-guide-figure-5]:#figure-5
[deployment-guide-figure-50]:./media/virtual-machines-shared-sap-deployment-guide/50-forced-tunneling-suse.png
[deployment-guide-figure-500]:./media/virtual-machines-shared-sap-deployment-guide/500-install-powershell.png
[deployment-guide-figure-6]:#figure-6
[deployment-guide-figure-600]:./media/virtual-machines-shared-sap-deployment-guide/600-powershell-version.png
[deployment-guide-figure-7]:#figure-7
[deployment-guide-figure-700]:./media/virtual-machines-shared-sap-deployment-guide/700-install-powershell-installed.png
[deployment-guide-figure-760]:./media/virtual-machines-shared-sap-deployment-guide/760-azure-cli-version.png
[deployment-guide-figure-900]:./media/virtual-machines-shared-sap-deployment-guide/900-cmd-update-executed.png
[deployment-guide-figure-azure-cli-installed]:#402488e5-f9bb-4b29-8063-1c5f52a892d0
[deployment-guide-figure-azure-cli-version]:#0ad010e6-f9b5-4c21-9c09-bb2e5efb3fda
[deployment-guide-install-vm-agent-windows]:#b2db5c9a-a076-42c6-9835-16945868e866
[deployment-guide-troubleshooting-chapter]:#564adb4f-5c95-4041-9616-6635e83a810b (Checks and troubleshooting for setting up end-to-end monitoring)

[deploy-template-cli]:../../resource-group-template-deploy-cli.md
[deploy-template-portal]:../../resource-group-template-deploy-portal.md
[deploy-template-powershell]:../../resource-group-template-deploy.md

[dr-guide-classic]:http://go.microsoft.com/fwlink/?LinkID=521971

[getting-started]:sap-get-started.md
[getting-started-dbms]:sap-get-started.md#1343ffe1-8021-4ce6-a08d-3a1553a4db82
[getting-started-deployment]:sap-get-started.md#6aadadd2-76b5-46d8-8713-e8d63630e955
[getting-started-planning]:sap-get-started.md#3da0389e-708b-4e82-b2a2-e92f132df89c

[getting-started-windows-classic]:classic/virtual-machines-windows-classic-sap-get-started.md
[getting-started-windows-classic-dbms]:classic/virtual-machines-windows-classic-sap-get-started.md#c5b77a14-f6b4-44e9-acab-4d28ff72a930
[getting-started-windows-classic-deployment]:classic/virtual-machines-windows-classic-sap-get-started.md#f84ea6ce-bbb4-41f7-9965-34d31b0098ea
[getting-started-windows-classic-dr]:classic/virtual-machines-windows-classic-sap-get-started.md#cff10b4a-01a5-4dc3-94b6-afb8e55757d3
[getting-started-windows-classic-ha-sios]:classic/virtual-machines-windows-classic-sap-get-started.md#4bb7512c-0fa0-4227-9853-4004281b1037
[getting-started-windows-classic-planning]:classic/virtual-machines-windows-classic-sap-get-started.md#f2a5e9d8-49e4-419e-9900-af783173481c

[ha-guide-classic]:http://go.microsoft.com/fwlink/?LinkId=613056

[install-extension-cli]:virtual-machines-windows-enable-aem.md

[Logo_Linux]:./media/virtual-machines-shared-sap-shared/Linux.png
[Logo_Windows]:./media/virtual-machines-shared-sap-shared/Windows.png

[msdn-set-azurermvmaemextension]:https://msdn.microsoft.com/library/azure/mt670598.aspx

[planning-guide]:sap-planning-guide.md (Azure Virtual Machines planning and implementation for SAP on Windows)
[planning-guide-1.2]:sap-planning-guide.md#e55d1e22-c2c8-460b-9897-64622a34fdff (Resources)
[planning-guide-11]:sap-planning-guide.md#7cf991a1-badd-40a9-944e-7baae842a058 (High availability and disaster recovery for SAP NetWeaver running on Azure Virtual Machines)
[planning-guide-11.4.1]:sap-planning-guide.md#5d9d36f9-9058-435d-8367-5ad05f00de77 (High availability for SAP Application Servers)
[planning-guide-11.5]:sap-planning-guide.md#4e165b58-74ca-474f-a7f4-5e695a93204f (Using Autostart for SAP instances)
[planning-guide-2.1]:sap-planning-guide.md#1625df66-4cc6-4d60-9202-de8a0b77f803 (Cloud-only - Virtual Machine deployments in Azure without dependencies on the on-premises customer network)
[planning-guide-2.2]:sap-planning-guide.md#f5b3b18c-302c-4bd8-9ab2-c388f1ab3d10 (Cross-premises - Deployment of single or multiple SAP VMs in Azure fully integrated with the on-premises network)
[planning-guide-3.1]:sap-planning-guide.md#be80d1b9-a463-4845-bd35-f4cebdb5424a (Azure regions)
[planning-guide-3.2.1]:sap-planning-guide.md#df49dc09-141b-4f34-a4a2-990913b30358 (Fault domains)
[planning-guide-3.2.2]:sap-planning-guide.md#fc1ac8b2-e54a-487c-8581-d3cc6625e560 (Upgrade domains)
[planning-guide-3.2.3]:sap-planning-guide.md#18810088-f9be-4c97-958a-27996255c665 (Azure availability sets)
[planning-guide-3.2]:sap-planning-guide.md#8d8ad4b8-6093-4b91-ac36-ea56d80dbf77 (Microsoft Azure virtual machines concept)
[planning-guide-3.3.2]:sap-planning-guide.md#ff5ad0f9-f7f4-4022-9102-af07aef3bc92 (Azure Premium Storage)
[planning-guide-5.1.1]:sap-planning-guide.md#4d175f1b-7353-4137-9d2f-817683c26e53 (Moving a VM from on-premises to Azure with a non-generalized disk)
[planning-guide-5.1.2]:sap-planning-guide.md#e18f7839-c0e2-4385-b1e6-4538453a285c (Deploying a VM with a customer specific image)
[planning-guide-5.2.1]:sap-planning-guide.md#1b287330-944b-495d-9ea7-94b83aff73ef (Preparation for moving a VM from on-premises to Azure with a non-generalized disk)
[planning-guide-5.2.2]:sap-planning-guide.md#57f32b1c-0cba-4e57-ab6e-c39fe22b6ec3 (Preparation for deploying a VM with a customer specific image for SAP)
[planning-guide-5.2]:sap-planning-guide.md#6ffb9f41-a292-40bf-9e70-8204448559e7 (Preparing VMs with SAP for Azure)
[planning-guide-5.3.1]:sap-planning-guide.md#6e835de8-40b1-4b71-9f18-d45b20959b79 (Difference between an Azure disk and an Azure image)
[planning-guide-5.3.2]:sap-planning-guide.md#a43e40e6-1acc-4633-9816-8f095d5a7b6a (Uploading a VHD from on-premises to Azure)
[planning-guide-5.4.2]:sap-planning-guide.md#9789b076-2011-4afa-b2fe-b07a8aba58a1 (Copying disks between Azure Storage accounts)
[planning-guide-5.5.1]:sap-planning-guide.md#4efec401-91e0-40c0-8e64-f2dceadff646 (VM/VHD structure for SAP deployments)
[planning-guide-5.5.3]:sap-planning-guide.md#17e0d543-7e8c-4160-a7da-dd7117a1ad9d (Setting automount for attached disks)
[planning-guide-7.1]:sap-planning-guide.md#3e9c3690-da67-421a-bc3f-12c520d99a30 (Single VM with SAP NetWeaver demo/training scenario)
[planning-guide-7]:sap-planning-guide.md#96a77628-a05e-475d-9df3-fb82217e8f14 (Concepts of Cloud-Only deployment of SAP instances)
[planning-guide-9.1]:sap-planning-guide.md#6f0a47f3-a289-4090-a053-2521618a28c3 (Azure Monitoring Solution for SAP)
[planning-guide-azure-premium-storage]:sap-planning-guide.md#ff5ad0f9-f7f4-4022-9102-af07aef3bc92 (Azure Premium Storage)

[planning-guide-figure-100]:./media/virtual-machines-shared-sap-planning-guide/100-single-vm-in-azure.png
[planning-guide-figure-1300]:./media/virtual-machines-shared-sap-planning-guide/1300-ref-config-iaas-for-sap.png
[planning-guide-figure-1400]:./media/virtual-machines-shared-sap-planning-guide/1400-attach-detach-disks.png
[planning-guide-figure-1600]:./media/virtual-machines-shared-sap-planning-guide/1600-firewall-port-rule.png
[planning-guide-figure-1700]:./media/virtual-machines-shared-sap-planning-guide/1700-single-vm-demo.png
[planning-guide-figure-1900]:./media/virtual-machines-shared-sap-planning-guide/1900-vm-set-vnet.png
[planning-guide-figure-200]:./media/virtual-machines-shared-sap-planning-guide/200-multiple-vms-in-azure.png
[planning-guide-figure-2100]:./media/virtual-machines-shared-sap-planning-guide/2100-s2s.png
[planning-guide-figure-2200]:./media/virtual-machines-shared-sap-planning-guide/2200-network-printing.png
[planning-guide-figure-2300]:./media/virtual-machines-shared-sap-planning-guide/2300-sapgui-stms.png
[planning-guide-figure-2400]:./media/virtual-machines-shared-sap-planning-guide/2400-vm-extension-overview.png
[planning-guide-figure-2500]:./media/virtual-machines-shared-sap-planning-guide/2500-vm-extension-details.png
[planning-guide-figure-2600]:./media/virtual-machines-shared-sap-planning-guide/2600-sap-router-connection.png
[planning-guide-figure-2700]:./media/virtual-machines-shared-sap-planning-guide/2700-exposed-sap-portal.png
[planning-guide-figure-2800]:./media/virtual-machines-shared-sap-planning-guide/2800-endpoint-config.png
[planning-guide-figure-2900]:./media/virtual-machines-shared-sap-planning-guide/2900-azure-ha-sap-ha.png
[planning-guide-figure-300]:./media/virtual-machines-shared-sap-planning-guide/300-vpn-s2s.png
[planning-guide-figure-3000]:./media/virtual-machines-shared-sap-planning-guide/3000-sap-ha-on-azure.png
[planning-guide-figure-3200]:./media/virtual-machines-shared-sap-planning-guide/3200-sap-ha-with-sql.png
[planning-guide-figure-400]:./media/virtual-machines-shared-sap-planning-guide/400-vm-services.png
[planning-guide-figure-600]:./media/virtual-machines-shared-sap-planning-guide/600-s2s-details.png
[planning-guide-figure-700]:./media/virtual-machines-shared-sap-planning-guide/700-decision-tree-deploy-to-azure.png
[planning-guide-figure-800]:./media/virtual-machines-shared-sap-planning-guide/800-portal-vm-overview.png
[planning-guide-microsoft-azure-networking]:sap-planning-guide.md#61678387-8868-435d-9f8c-450b2424f5bd (Microsoft Azure networking)
[planning-guide-storage-microsoft-azure-storage-and-data-disks]:sap-planning-guide.md#a72afa26-4bf4-4a25-8cf7-855d6032157f (Storage: Microsoft Azure Storage and data disks)

[powershell-install-configure]:/powershell/azureps-cmdlets-docs
[resource-group-authoring-templates]:../../resource-group-authoring-templates.md
[resource-group-overview]:../../azure-resource-manager/resource-group-overview.md
[resource-groups-networking]:../../virtual-network/resource-groups-networking.md
[sap-pam]:https://support.sap.com/pam (SAP Product Availability Matrix)
[sap-templates-2-tier-marketplace-image]:https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2Fazure-quickstart-templates%2Fmaster%2Fsap-2-tier-marketplace-image%2Fazuredeploy.json
[sap-templates-2-tier-os-disk]:https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2Fazure-quickstart-templates%2Fmaster%2Fsap-2-tier-user-disk%2Fazuredeploy.json
[sap-templates-2-tier-user-image]:https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2Fazure-quickstart-templates%2Fmaster%2Fsap-2-tier-user-image%2Fazuredeploy.json
[sap-templates-3-tier-marketplace-image]:https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2Fazure-quickstart-templates%2Fmaster%2Fsap-3-tier-marketplace-image%2Fazuredeploy.json
[sap-templates-3-tier-user-image]:https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2Fazure-quickstart-templates%2Fmaster%2Fsap-3-tier-user-image%2Fazuredeploy.json
[storage-azure-cli]:../../storage/storage-azure-cli.md
[storage-azure-cli-copy-blobs]:../../storage/storage-azure-cli.md#copy-blobs
[storage-introduction]:../../storage/storage-introduction.md
[storage-powershell-guide-full-copy-vhd]:../../storage/storage-powershell-guide-full.md#how-to-copy-blobs-from-one-storage-container-to-another
[storage-premium-storage-preview-portal]:../../storage/storage-premium-storage.md
[storage-redundancy]:../../storage/storage-redundancy.md
[storage-scalability-targets]:../../storage/storage-scalability-targets.md
[storage-use-azcopy]:../../storage/storage-use-azcopy.md
[template-201-vm-from-specialized-vhd]:https://github.com/Azure/azure-quickstart-templates/tree/master/201-vm-from-specialized-vhd
[templates-101-simple-windows-vm]:https://github.com/Azure/azure-quickstart-templates/tree/master/101-simple-windows-vm
[templates-101-vm-from-user-image]:https://github.com/Azure/azure-quickstart-templates/tree/master/101-vm-from-user-image
[virtual-machines-linux-attach-disk-portal]:../linux/attach-disk-portal.md
[virtual-machines-windows-attach-disk-portal]:../virtual-machines-windows-attach-disk-portal.md
[virtual-machines-azure-resource-manager-architecture]:../../resource-manager-deployment-model.md
[virtual-machines-azurerm-versus-azuresm]:virtual-machines-windows-compare-deployment-models.md
[virtual-machines-windows-classic-configure-oracle-data-guard]:../virtual-machines-windows-classic-configure-oracle-data-guard.md
[virtual-machines-linux-cli-deploy-templates]:../linux/cli-deploy-templates.md (Deploy and manage virtual machines by using Azure Resource Manager templates and the Azure CLI)
[virtual-machines-deploy-rmtemplates-powershell]:../virtual-machines-windows-ps-manage.md (Manage virtual machines using Azure Resource Manager and PowerShell)
[virtual-machines-linux-agent-user-guide]:../linux/agent-user-guide.md
[virtual-machines-linux-agent-user-guide-command-line-options]:../linux/agent-user-guide.md#command-line-options
[virtual-machines-linux-capture-image]:../linux/capture-image.md
[virtual-machines-linux-capture-image-capture]:../linux/capture-image.md#capture-the-vm
[virtual-machines-windows-capture-image]:../virtual-machines-windows-capture-image.md
[virtual-machines-windows-capture-image-capture]:../virtual-machines-windows-capture-image.md#capture-the-vm
[virtual-machines-linux-configure-lvm]:../linux/configure-lvm.md
[virtual-machines-linux-configure-raid]:../linux/configure-raid.md
[virtual-machines-linux-classic-create-upload-vhd-step-1]:../virtual-machines-linux-classic-create-upload-vhd.md#step-1-prepare-the-image-to-be-uploaded
[virtual-machines-linux-create-upload-vhd-suse]:../linux/suse-create-upload-vhd.md
[virtual-machines-linux-redhat-create-upload-vhd]:../linux/redhat-create-upload-vhd.md
[virtual-machines-linux-how-to-attach-disk]:../linux/add-disk.md
[virtual-machines-linux-how-to-attach-disk-how-to-initialize-a-new-data-disk-in-linux]:../linux/add-disk.md#connect-to-the-linux-vm-to-mount-the-new-disk
[virtual-machines-linux-tutorial]:../linux/quick-create-cli.md
[virtual-machines-linux-update-agent]:../linux/update-agent.md
[virtual-machines-manage-availability]:../virtual-machines-windows-manage-availability.md
[virtual-machines-ps-create-preconfigure-windows-resource-manager-vms]:../virtual-machines-windows-ps-create.md
[virtual-machines-sizes]:sizes.md
[virtual-machines-windows-classic-ps-sql-alwayson-availability-groups]:classic/ps-sql-alwayson-availability-groups.md
[virtual-machines-windows-classic-ps-sql-int-listener]:classic/ps-sql-int-listener.md
[virtual-machines-sql-server-high-availability-and-disaster-recovery-solutions]:./sql/virtual-machines-windows-sql-high-availability-dr.md
[virtual-machines-sql-server-infrastructure-services]:./sql/virtual-machines-windows-sql-server-iaas-overview.md
[virtual-machines-sql-server-performance-best-practices]:./sql/virtual-machines-windows-sql-performance.md
[virtual-machines-upload-image-windows-resource-manager]:upload-image.md
[virtual-machines-windows-tutorial]:../virtual-machines-windows-hero-tutorial.md
[virtual-machines-windows-create-vm-specialized]:../virtual-machines-windows-create-vm-specialized.md
[virtual-machines-workload-template-sql-alwayson]:https://azure.microsoft.com/documentation/templates/sql-server-2014-alwayson-dsc/
[virtual-network-deploy-multinic-arm-cli]:../../virtual-network/virtual-network-deploy-multinic-arm-cli.md
[virtual-network-deploy-multinic-arm-ps]:../../virtual-network/virtual-network-deploy-multinic-arm-ps.md
[virtual-network-deploy-multinic-arm-template]:../../virtual-network/virtual-network-deploy-multinic-arm-template.md
[virtual-networks-configure-vnet-to-vnet-connection]:../../vpn-gateway/vpn-gateway-vnet-vnet-rm-ps.md
[virtual-networks-create-vnet-arm-pportal]:../../virtual-network/virtual-networks-create-vnet-arm-pportal.md
[virtual-networks-manage-dns-in-vnet]:../../virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances.md
[virtual-networks-multiple-nics]:../../virtual-network/virtual-networks-multiple-nics.md
[virtual-networks-nsg]:../../virtual-network/virtual-networks-nsg.md
[virtual-networks-reserved-private-ip]:../../virtual-network/virtual-networks-static-private-ip-arm-ps.md
[virtual-networks-static-private-ip-arm-pportal]:../../virtual-network/virtual-networks-static-private-ip-arm-pportal.md
[virtual-networks-udr-overview]:../../virtual-network/virtual-networks-udr-overview.md
[vpn-gateway-about-vpn-devices]:../../vpn-gateway/vpn-gateway-about-vpn-devices.md
[vpn-gateway-create-site-to-site-rm-powershell]:../../vpn-gateway/vpn-gateway-create-site-to-site-rm-powershell.md
[vpn-gateway-cross-premises-options]:../../vpn-gateway/vpn-gateway-plan-design.md
[vpn-gateway-site-to-site-create]:../../vpn-gateway/vpn-gateway-howto-site-to-site-resource-manager-portal.md
[vpn-gateway-vpn-faq]:../../vpn-gateway/vpn-gateway-vpn-faq.md
[xplat-cli]:../../cli-install-nodejs.md
[xplat-cli-azure-resource-manager]:../../xplat-cli-azure-resource-manager.md

<span data-ttu-id="7b578-115">Machines virtuelles Azure est la solution idéale pour les organisations qui ont besoin de ressources de calcul et de stockage rapidement, sans longs cycles d’acquisition.</span><span class="sxs-lookup"><span data-stu-id="7b578-115">Azure Virtual Machines is the solution for organizations that need compute and storage resources, in minimal time, and without lengthy procurement cycles.</span></span> <span data-ttu-id="7b578-116">Vous pouvez utiliser le service Machines virtuelles Azure pour déployer des applications classiques, comme les applications basées sur SAP NetWeaver, dans Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-116">You can use Azure Virtual Machines to deploy classical applications, like SAP NetWeaver-based applications, in Azure.</span></span> <span data-ttu-id="7b578-117">Élargissez la fiabilité et la disponibilité d’une application sans ressources locales supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="7b578-117">Extend an application's reliability and availability without additional on-premises resources.</span></span> <span data-ttu-id="7b578-118">Comme le service Machines virtuelles Azure prend en charge la connectivité intersite, vous pouvez intégrer les machines virtuelles Azure dans les domaines locaux, les clouds privés et le paysage SAP de votre organisation.</span><span class="sxs-lookup"><span data-stu-id="7b578-118">Azure Virtual Machines supports cross-premises connectivity, so you can integrate Azure Virtual Machines into your organization's on-premises domains, private clouds, and SAP system landscape.</span></span>

<span data-ttu-id="7b578-119">Cet article présente les étapes requises pour déployer des applications SAP sur des machines virtuelles Windows dans Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-119">In this article, we cover the steps to deploy SAP applications on Windows virtual machines (VMs) in Azure.</span></span> <span data-ttu-id="7b578-120">Cet article s’appuie sur les informations de [planification et d’implémentation de Machines virtuelles Azure pour SAP sur Windows][planning-guide].</span><span class="sxs-lookup"><span data-stu-id="7b578-120">This article builds on the information in [Azure Virtual Machines planning and implementation for SAP on Windows][planning-guide].</span></span> <span data-ttu-id="7b578-121">Il vient également compléter la documentation d’installation de SAP et les notes SAP, principales ressources pour l’installation et le déploiement des logiciels SAP.</span><span class="sxs-lookup"><span data-stu-id="7b578-121">It also complements SAP installation documentation and SAP Notes, which are the primary resources for installing and deploying SAP software.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="7b578-122">Composants requis</span><span class="sxs-lookup"><span data-stu-id="7b578-122">Prerequisites</span></span>
<span data-ttu-id="7b578-123">La configuration d’une machine virtuelle Azure pour le déploiement des logiciels SAP implique plusieurs étapes et diverses ressources.</span><span class="sxs-lookup"><span data-stu-id="7b578-123">Setting up an Azure virtual machine for SAP software deployment involves multiple steps and resources.</span></span> <span data-ttu-id="7b578-124">Avant de commencer, assurez-vous que vous disposez des composants requis pour l’installation de logiciels SAP sur des machines virtuelles Windows dans Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-124">Before you start, make sure that you meet the prerequisites for installing SAP software on Windows virtual machines in Azure.</span></span>

### <a name="local-computer"></a><span data-ttu-id="7b578-125">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="7b578-125">Local computer</span></span>
<span data-ttu-id="7b578-126">Pour gérer les machines virtuelles Windows ou Linux, vous pouvez utiliser un script PowerShell et le portail Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-126">To manage Windows or Linux VMs, you can use a PowerShell script and the Azure portal.</span></span> <span data-ttu-id="7b578-127">Dans les deux cas, vous devez disposer d’un ordinateur local exécutant Windows 7 ou une version ultérieure de Windows.</span><span class="sxs-lookup"><span data-stu-id="7b578-127">For both tools, you need a local computer running Windows 7 or a later version of Windows.</span></span> <span data-ttu-id="7b578-128">Si vous souhaitez gérer uniquement des machines virtuelles Linux et que vous souhaitez utiliser un ordinateur Linux pour cette tâche, vous pouvez utiliser l’interface de ligne de commande Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-128">If you want to manage only Linux VMs and you want to use a Linux computer for this task, you can use Azure CLI.</span></span>

### <a name="internet-connection"></a><span data-ttu-id="7b578-129">Connexion Internet</span><span class="sxs-lookup"><span data-stu-id="7b578-129">Internet connection</span></span>
<span data-ttu-id="7b578-130">Pour télécharger et exécuter les outils et scripts requis pour le déploiement des logiciels SAP, vous devez être connecté à Internet.</span><span class="sxs-lookup"><span data-stu-id="7b578-130">To download and run the tools and scripts that are required for SAP software deployment, you must be connected to the Internet.</span></span> <span data-ttu-id="7b578-131">La machine virtuelle Azure exécutant l’extension d’analyse améliorée Azure pour SAP doit également être connectée à Internet.</span><span class="sxs-lookup"><span data-stu-id="7b578-131">The Azure VM that is running the Azure Enhanced Monitoring Extension for SAP also needs access to the Internet.</span></span> <span data-ttu-id="7b578-132">Si la machine virtuelle Azure fait partie d’un réseau virtuel Azure ou d’un domaine local, assurez-vous que les paramètres de proxy appropriés sont configurés comme décrit dans le chapitre [Configurer le proxy][deployment-guide-configure-proxy].</span><span class="sxs-lookup"><span data-stu-id="7b578-132">If the Azure VM is part of an Azure virtual network or on-premises domain, make sure that the relevant proxy settings are set, as described in [Configure the proxy][deployment-guide-configure-proxy].</span></span>

### <a name="microsoft-azure-subscription"></a><span data-ttu-id="7b578-133">Abonnement Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="7b578-133">Microsoft Azure subscription</span></span>
<span data-ttu-id="7b578-134">Vous avez besoin d’un compte Azure actif.</span><span class="sxs-lookup"><span data-stu-id="7b578-134">You need an active Azure account.</span></span>

### <a name="topology-and-networking"></a><span data-ttu-id="7b578-135">Topologie et mise en réseau</span><span class="sxs-lookup"><span data-stu-id="7b578-135">Topology and networking</span></span>
<span data-ttu-id="7b578-136">Vous devez définir la topologie et l’architecture du déploiement SAP dans Azure :</span><span class="sxs-lookup"><span data-stu-id="7b578-136">You need to define the topology and architecture of the SAP deployment in Azure:</span></span>

* <span data-ttu-id="7b578-137">Comptes de stockage Azure à utiliser</span><span class="sxs-lookup"><span data-stu-id="7b578-137">Azure storage accounts to be used</span></span>
* <span data-ttu-id="7b578-138">Réseau virtuel dans lequel déployer le système SAP</span><span class="sxs-lookup"><span data-stu-id="7b578-138">Virtual network where you want to deploy the SAP system</span></span>
* <span data-ttu-id="7b578-139">Groupe de ressources dans lequel déployer le système SAP</span><span class="sxs-lookup"><span data-stu-id="7b578-139">Resource group to which you want to deploy the SAP system</span></span>
* <span data-ttu-id="7b578-140">Région Azure dans laquelle déployer le système SAP</span><span class="sxs-lookup"><span data-stu-id="7b578-140">Azure region where you want to deploy the SAP system</span></span>
* <span data-ttu-id="7b578-141">Configuration SAP (à deux ou trois niveaux)</span><span class="sxs-lookup"><span data-stu-id="7b578-141">SAP configuration (two-tier or three-tier)</span></span>
* <span data-ttu-id="7b578-142">Taille des machines virtuelles et nombre de disques durs virtuels (VHD) supplémentaires à monter sur les machines virtuelles</span><span class="sxs-lookup"><span data-stu-id="7b578-142">VM sizes and the number of additional virtual hard disks (VHDs) to be mounted to the VMs</span></span>
* <span data-ttu-id="7b578-143">Configuration du système de transport et correction SAP (CTS)</span><span class="sxs-lookup"><span data-stu-id="7b578-143">SAP Correction and Transport System (CTS) configuration</span></span>

<span data-ttu-id="7b578-144">Créez et configurez des comptes de stockage Azure ou des réseaux virtuels Azure avant de lancer le processus de déploiement de logiciels SAP.</span><span class="sxs-lookup"><span data-stu-id="7b578-144">Create and configure Azure storage accounts or Azure virtual networks before you begin the SAP software deployment process.</span></span> <span data-ttu-id="7b578-145">Pour plus d’informations sur la création et la configuration de ces ressources, consultez [Planification et implémentation de Machines virtuelles Azure pour SAP sur Windows][planning-guide].</span><span class="sxs-lookup"><span data-stu-id="7b578-145">For information about how to create and configure these resources, see [Azure Virtual Machines planning and implementation for SAP on Windows][planning-guide].</span></span>

### <a name="sap-sizing"></a><span data-ttu-id="7b578-146">Dimensionnement SAP</span><span class="sxs-lookup"><span data-stu-id="7b578-146">SAP sizing</span></span>
<span data-ttu-id="7b578-147">Pour le dimensionnement SAP, vous devez connaître les informations suivantes :</span><span class="sxs-lookup"><span data-stu-id="7b578-147">Know the following information, for SAP sizing:</span></span>

* <span data-ttu-id="7b578-148">Charge de travail SAP projetée, par exemple, en utilisant l’outil SAP Quick Sizer, et nombre de SAPS (SAP Application Performance Standard)</span><span class="sxs-lookup"><span data-stu-id="7b578-148">Projected SAP workload, for example, by using the SAP Quick Sizer tool, and the SAP Application Performance Standard (SAPS) number</span></span>
* <span data-ttu-id="7b578-149">Consommation de mémoire et de ressources de processeur requise du système SAP</span><span class="sxs-lookup"><span data-stu-id="7b578-149">Required CPU resource and memory consumption of the SAP system</span></span>
* <span data-ttu-id="7b578-150">Opérations d’entrée/sortie (E/S) par seconde requises</span><span class="sxs-lookup"><span data-stu-id="7b578-150">Required input/output (I/O) operations per second</span></span>
* <span data-ttu-id="7b578-151">Bande passante réseau requise pour la communication éventuelle entre les différentes machines virtuelles dans Azure</span><span class="sxs-lookup"><span data-stu-id="7b578-151">Required network bandwidth of eventual communication between VMs in Azure</span></span>
* <span data-ttu-id="7b578-152">Bande passante réseau requise entre les ressources locales et les systèmes SAP Azure déployés</span><span class="sxs-lookup"><span data-stu-id="7b578-152">Required network bandwidth between on-premises assets and the Azure-deployed SAP system</span></span>

### <a name="resource-groups"></a><span data-ttu-id="7b578-153">Groupes de ressources</span><span class="sxs-lookup"><span data-stu-id="7b578-153">Resource groups</span></span>
<span data-ttu-id="7b578-154">Dans Azure Resource Manager, vous pouvez utiliser des groupes de ressources pour gérer l’ensemble des ressources d’application de votre abonnement Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-154">In Azure Resource Manager, you can use resource groups to manage all the application resources in your Azure subscription.</span></span> <span data-ttu-id="7b578-155">Pour plus d’informations, consultez [Présentation d’Azure Resource Manager][resource-group-overview].</span><span class="sxs-lookup"><span data-stu-id="7b578-155">For more information, see [Azure Resource Manager overview][resource-group-overview].</span></span>

## <a name="resources"></a><span data-ttu-id="7b578-156">Ressources</span><span class="sxs-lookup"><span data-stu-id="7b578-156">Resources</span></span>

### <span data-ttu-id="7b578-157"><a name="42ee2bdb-1efc-4ec7-ab31-fe4c22769b94"></a>Ressources SAP</span><span class="sxs-lookup"><span data-stu-id="7b578-157"><a name="42ee2bdb-1efc-4ec7-ab31-fe4c22769b94"></a>SAP resources</span></span>
<span data-ttu-id="7b578-158">Lorsque vous configurez votre déploiement de logiciels SAP, vous avez besoin des ressources SAP suivantes :</span><span class="sxs-lookup"><span data-stu-id="7b578-158">When you are setting up your SAP software deployment, you need the following SAP resources:</span></span>

* <span data-ttu-id="7b578-159">Note SAP [1928533], qui contient :</span><span class="sxs-lookup"><span data-stu-id="7b578-159">SAP Note [1928533], which has:</span></span>
  * <span data-ttu-id="7b578-160">une liste des tailles de machines virtuelles Azure prises en charge pour le déploiement de logiciels SAP</span><span class="sxs-lookup"><span data-stu-id="7b578-160">List of Azure VM sizes that are supported for the deployment of SAP software</span></span>
  * <span data-ttu-id="7b578-161">des informations importantes sur la capacité en fonction de la taille des machines virtuelles Azure</span><span class="sxs-lookup"><span data-stu-id="7b578-161">Important capacity information for Azure VM sizes</span></span>
  * <span data-ttu-id="7b578-162">les logiciels SAP pris en charge et les combinaisons entre système d’exploitation et base de données</span><span class="sxs-lookup"><span data-stu-id="7b578-162">Supported SAP software, and operating system (OS) and database combinations</span></span>
  * <span data-ttu-id="7b578-163">la version du noyau SAP requise pour Windows et Linux sur Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="7b578-163">Required SAP kernel version for Windows and Linux on Microsoft Azure</span></span>

* <span data-ttu-id="7b578-164">La note SAP [2015553] répertorie les conditions préalables au déploiement de logiciels SAP pris en charge par SAP sur Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-164">SAP Note [2015553] lists prerequisites for SAP-supported SAP software deployments in Azure.</span></span>
* <span data-ttu-id="7b578-165">La note SAP [2178632] contient des informations détaillées sur toutes les métriques de surveillance rapportées pour SAP sur Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-165">SAP Note [2178632] has detailed information about all monitoring metrics reported for SAP in Azure.</span></span>
* <span data-ttu-id="7b578-166">La note SAP [1409604] contient la version requise de l’agent hôte SAP pour Windows sur Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-166">SAP Note [1409604] has the required SAP Host Agent version for Windows in Azure.</span></span>
* <span data-ttu-id="7b578-167">La note SAP [2191498] contient la version requise de l’agent hôte SAP pour Linux sur Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-167">SAP Note [2191498] has the required SAP Host Agent version for Linux in Azure.</span></span>
* <span data-ttu-id="7b578-168">La note SAP [2243692] contient des informations sur les licences SAP sur Linux dans Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-168">SAP Note [2243692] has information about SAP licensing on Linux in Azure.</span></span>
* <span data-ttu-id="7b578-169">La note SAP [1984787] contient des informations sur SUSE Linux Enterprise Server 12.</span><span class="sxs-lookup"><span data-stu-id="7b578-169">SAP Note [1984787] has general information about SUSE Linux Enterprise Server 12.</span></span>
* <span data-ttu-id="7b578-170">La note SAP [2002167] contient des informations sur Red Hat Enterprise Linux 7.x.</span><span class="sxs-lookup"><span data-stu-id="7b578-170">SAP Note [2002167] has general information about Red Hat Enterprise Linux 7.x.</span></span>
* <span data-ttu-id="7b578-171">La note SAP [1999351] contient des informations de dépannage supplémentaires pour l’extension d’analyse Azure améliorée pour SAP.</span><span class="sxs-lookup"><span data-stu-id="7b578-171">SAP Note [1999351] has additional troubleshooting information for the Azure Enhanced Monitoring Extension for SAP.</span></span>
* <span data-ttu-id="7b578-172">Le [WIKI de la communauté SAP](https://wiki.scn.sap.com/wiki/display/HOME/SAPonLinuxNotes) contient toutes les notes SAP requises pour Linux.</span><span class="sxs-lookup"><span data-stu-id="7b578-172">[SAP Community WIKI](https://wiki.scn.sap.com/wiki/display/HOME/SAPonLinuxNotes) has all required SAP Notes for Linux.</span></span>
* <span data-ttu-id="7b578-173">Applets de commande PowerShell spécifiques à SAP qui font partie [d’Azure PowerShell][azure-ps].</span><span class="sxs-lookup"><span data-stu-id="7b578-173">SAP-specific PowerShell cmdlets that are part of [Azure PowerShell][azure-ps].</span></span>
* <span data-ttu-id="7b578-174">Commandes de l’interface de ligne de commande Azure spécifique à SAP faisant partie de [l’interface de ligne de commande Azure][azure-cli].</span><span class="sxs-lookup"><span data-stu-id="7b578-174">SAP-specific Azure CLI commands that are part of [Azure CLI][azure-cli].</span></span>

<span data-ttu-id="7b578-175">[comment]: <> (MSSedusch TODO Add ARM patch level for SAP Host Agent in SAP Note 1409604)</span><span class="sxs-lookup"><span data-stu-id="7b578-175">[comment]: <> (MSSedusch TODO Add ARM patch level for SAP Host Agent in SAP Note 1409604)</span></span>

### <a name="microsoft-resources"></a><span data-ttu-id="7b578-176">Ressources Microsoft</span><span class="sxs-lookup"><span data-stu-id="7b578-176">Microsoft resources</span></span>
<span data-ttu-id="7b578-177">Ces articles Microsoft couvrent les déploiements SAP dans Azure :</span><span class="sxs-lookup"><span data-stu-id="7b578-177">These Microsoft articles cover SAP deployments in Azure:</span></span>

* <span data-ttu-id="7b578-178">[Planification et implémentation de Machines virtuelles Azure pour SAP sur Windows][planning-guide]</span><span class="sxs-lookup"><span data-stu-id="7b578-178">[Azure Virtual Machines planning and implementation for SAP on Windows][planning-guide]</span></span>
* <span data-ttu-id="7b578-179">[Déploiement de Machines virtuelles Azure pour SAP sur Windows (cet article)][deployment-guide]</span><span class="sxs-lookup"><span data-stu-id="7b578-179">[Azure Virtual Machines deployment for SAP on Windows (this article)][deployment-guide]</span></span>
* <span data-ttu-id="7b578-180">[Déploiement SGBD de Machines virtuelles Azure pour SAP sur Windows][dbms-guide]</span><span class="sxs-lookup"><span data-stu-id="7b578-180">[Azure Virtual Machines DBMS deployment for SAP on Windows][dbms-guide]</span></span>
* <span data-ttu-id="7b578-181">[Portail Azure][azure-portal]</span><span class="sxs-lookup"><span data-stu-id="7b578-181">[Azure portal][azure-portal]</span></span>

## <span data-ttu-id="7b578-182"><a name="b3253ee3-d63b-4d74-a49b-185e76c4088e"></a>Scénarios de déploiement de logiciels SAP sur des machines virtuelles Azure</span><span class="sxs-lookup"><span data-stu-id="7b578-182"><a name="b3253ee3-d63b-4d74-a49b-185e76c4088e"></a>Deployment scenarios for SAP software on Azure VMs</span></span>
<span data-ttu-id="7b578-183">Vous avez plusieurs possibilités pour déployer des machines virtuelles et les disques associés dans Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-183">You have multiple options for deploying VMs and associated disks in Azure.</span></span> <span data-ttu-id="7b578-184">Il est important de comprendre les différences entre les options de déploiement, car les étapes de préparation de vos machines virtuelles pour le déploiement dépendront du type de déploiement que vous choisirez.</span><span class="sxs-lookup"><span data-stu-id="7b578-184">It's important to understand the differences between deployment options, because you might take different steps to prepare your VMs for deployment based on the deployment type you choose.</span></span>

### <span data-ttu-id="7b578-185"><a name="db477013-9060-4602-9ad4-b0316f8bb281"></a>Scénario 1 : Déploiement d’une machine virtuelle à partir d’Azure Marketplace pour SAP</span><span class="sxs-lookup"><span data-stu-id="7b578-185"><a name="db477013-9060-4602-9ad4-b0316f8bb281"></a>Scenario 1: Deploying a VM from the Azure Marketplace for SAP</span></span>
<span data-ttu-id="7b578-186">Vous pouvez utiliser une image fournie par Microsoft ou par un tiers dans Azure Marketplace pour déployer votre machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="7b578-186">You can use an image provided by Microsoft or by a third party in the Azure Marketplace to deploy your VM.</span></span> <span data-ttu-id="7b578-187">Marketplace propose certaines images standard de Windows Server et de différentes distributions de Linux.</span><span class="sxs-lookup"><span data-stu-id="7b578-187">The Marketplace offers some standard OS images of Windows Server and different Linux distributions.</span></span> <span data-ttu-id="7b578-188">Vous pouvez également déployer une image qui inclut les SKU du système de gestion de la base de données (SGBD), par exemple Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="7b578-188">You also can deploy an image that includes database management system (DBMS) SKUs, for example, Microsoft SQL Server.</span></span> <span data-ttu-id="7b578-189">Pour plus d’informations sur l’utilisation des images avec les SKU SGBD, consultez [Déploiement SGBD de Machines virtuelles Azure pour SAP sur Linux][dbms-guide].</span><span class="sxs-lookup"><span data-stu-id="7b578-189">For more information about using images with DBMS SKUs, see [Azure Virtual Machines DBMS deployment for SAP on Linux][dbms-guide].</span></span>

<span data-ttu-id="7b578-190">L’organigramme suivant illustre la séquence d’étapes spécifiques à SAP pour le déploiement d’une machine virtuelle à partir d’Azure Marketplace :</span><span class="sxs-lookup"><span data-stu-id="7b578-190">The following flowchart shows the SAP-specific sequence of steps for deploying a VM from the Azure Marketplace:</span></span>

![Organigramme de déploiement de machines virtuelles pour les systèmes SAP à l’aide d’une image de machine virtuelle provenant d’Azure Marketplace][deployment-guide-figure-100]

#### <a name="create-a-virtual-machine-by-using-the-azure-portal"></a><span data-ttu-id="7b578-192">Création d’une machine virtuelle à l’aide du portail Azure</span><span class="sxs-lookup"><span data-stu-id="7b578-192">Create a virtual machine by using the Azure portal</span></span>
<span data-ttu-id="7b578-193">Le moyen le plus simple de créer une machine virtuelle à l’aide d’une image provenant d’Azure Marketplace est d’utiliser le portail Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-193">The easiest way to create a new virtual machine with an image from the Azure Marketplace is by using the Azure portal.</span></span>

1.  <span data-ttu-id="7b578-194">Accédez à <https://portal.azure.com/#create>.</span><span class="sxs-lookup"><span data-stu-id="7b578-194">Go to <https://portal.azure.com/#create>.</span></span>  <span data-ttu-id="7b578-195">Ou, dans le menu du portail Azure, sélectionnez **+ Nouveau**.</span><span class="sxs-lookup"><span data-stu-id="7b578-195">Or, in the Azure portal menu, select **+ New**.</span></span>
2.  <span data-ttu-id="7b578-196">Sélectionnez **Calcul**, puis choisissez le type de système d’exploitation que vous souhaitez déployer.</span><span class="sxs-lookup"><span data-stu-id="7b578-196">Select **Compute**, and then select the type of operating system you want to deploy.</span></span> <span data-ttu-id="7b578-197">Par exemple, Windows Server 2012 R2, SUSE Linux Enterprise Server 12 (SLES 12) ou Red Hat Enterprise Linux 7.2 (RHEL 7.2).</span><span class="sxs-lookup"><span data-stu-id="7b578-197">For example, Windows Server 2012 R2, SUSE Linux Enterprise Server 12 (SLES 12), or Red Hat Enterprise Linux 7.2 (RHEL 7.2).</span></span> <span data-ttu-id="7b578-198">La liste affichée par défaut ne répertorie pas tous les systèmes d’exploitation pris en charge.</span><span class="sxs-lookup"><span data-stu-id="7b578-198">The default list view does not show all supported operating systems.</span></span> <span data-ttu-id="7b578-199">Pour obtenir une liste complète, sélectionnez **Afficher tout**.</span><span class="sxs-lookup"><span data-stu-id="7b578-199">Select **see all** for a full list.</span></span> <span data-ttu-id="7b578-200">Pour plus d’informations sur les systèmes d’exploitation pris en charge pour le déploiement de logiciels SAP, consultez la note SAP [1928533].</span><span class="sxs-lookup"><span data-stu-id="7b578-200">For more information about supported operating systems for SAP software deployment, see SAP Note [1928533].</span></span>
3.  <span data-ttu-id="7b578-201">Sur la page suivante, passez en revue les conditions générales.</span><span class="sxs-lookup"><span data-stu-id="7b578-201">On the next page, review terms and conditions.</span></span>
4.  <span data-ttu-id="7b578-202">Dans la zone **Sélectionner un modèle de déploiement**, sélectionnez **Resource Manager**.</span><span class="sxs-lookup"><span data-stu-id="7b578-202">In the **Select a deployment model** box, select **Resource Manager**.</span></span>
5.  <span data-ttu-id="7b578-203">Sélectionnez **Créer**.</span><span class="sxs-lookup"><span data-stu-id="7b578-203">Select **Create**.</span></span>

<span data-ttu-id="7b578-204">L’assistant vous guide pour configurer les paramètres requis pour créer la machine virtuelle, ainsi que toutes les ressources requises, telles que les interfaces réseau et les comptes de stockage.</span><span class="sxs-lookup"><span data-stu-id="7b578-204">The wizard guides you through setting the required parameters to create the virtual machine, in addition to all required resources, like network interfaces and storage accounts.</span></span> <span data-ttu-id="7b578-205">Voici certains exemples de paramètres :</span><span class="sxs-lookup"><span data-stu-id="7b578-205">Some of these parameters are:</span></span>

1. <span data-ttu-id="7b578-206">**Paramètres de base**:</span><span class="sxs-lookup"><span data-stu-id="7b578-206">**Basics**:</span></span>
  * <span data-ttu-id="7b578-207">**Nom** : nom de la ressource (nom de la machine virtuelle).</span><span class="sxs-lookup"><span data-stu-id="7b578-207">**Name**: The name of the resource (the virtual machine name).</span></span>
 * <span data-ttu-id="7b578-208">**Nom utilisateur et mot de passe** ou **clé publique SSH** : entrez le nom d’utilisateur et le mot de passe de l’utilisateur créé lors de la configuration.</span><span class="sxs-lookup"><span data-stu-id="7b578-208">**Username and password** or **SSH public key**: Enter the username and password of the user that is created during the provisioning.</span></span> <span data-ttu-id="7b578-209">Pour une machine virtuelle Linux, vous pouvez entrer la clé publique Secure Shell (SSH) que vous utilisez pour vous connecter à la machine.</span><span class="sxs-lookup"><span data-stu-id="7b578-209">For a Linux virtual machine, you can enter the public Secure Shell (SSH) key that you use to sign in to the machine.</span></span>
 * <span data-ttu-id="7b578-210">**Abonnement** : sélectionnez l’abonnement à utiliser pour configurer la nouvelle machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="7b578-210">**Subscription**: Select the subscription that you want to use to provision the new virtual machine.</span></span>
 * <span data-ttu-id="7b578-211">**Groupe de ressources** : entrez le nom du groupe de ressources pour la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="7b578-211">**Resource group**: The name of the resource group for the VM.</span></span> <span data-ttu-id="7b578-212">Vous pouvez saisir soit le nom d’un nouveau groupe de ressources, soit celui d’un groupe de ressources existant.</span><span class="sxs-lookup"><span data-stu-id="7b578-212">You can enter either the name of a new resource group or the name of a resource group that already exists.</span></span>
 * <span data-ttu-id="7b578-213">**Emplacement** : emplacement de déploiement de la nouvelle machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="7b578-213">**Location**: Where to deploy the new virtual machine.</span></span> <span data-ttu-id="7b578-214">Si vous voulez connecter la machine virtuelle à votre réseau local, veillez à sélectionner l’emplacement du réseau virtuel qui connecte Azure à votre réseau local.</span><span class="sxs-lookup"><span data-stu-id="7b578-214">If you want to connect the virtual machine to your on-premises network, make sure you select the location of the virtual network that connects Azure to your on-premises network.</span></span> <span data-ttu-id="7b578-215">Pour plus d’informations, consultez [Mise en réseau Microsoft Azure][planning-guide-microsoft-azure-networking] dans [Planification et implémentation de Machines virtuelles Azure pour SAP sur Linux][planning-guide].</span><span class="sxs-lookup"><span data-stu-id="7b578-215">For more information, see [Microsoft Azure networking][planning-guide-microsoft-azure-networking] in [Azure Virtual Machines planning and implementation for SAP on Linux][planning-guide].</span></span>
2. <span data-ttu-id="7b578-216">**Taille**:</span><span class="sxs-lookup"><span data-stu-id="7b578-216">**Size**:</span></span>

     <span data-ttu-id="7b578-217">Pour obtenir la liste des types de machine virtuelle pris en charge, consultez la note SAP [1928533].</span><span class="sxs-lookup"><span data-stu-id="7b578-217">For a list of supported VM types, see SAP Note [1928533].</span></span> <span data-ttu-id="7b578-218">Veillez à sélectionner le type de machine virtuelle approprié si vous voulez utiliser le stockage Premium Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-218">Be sure you select the correct VM type if you want to use Azure Premium Storage.</span></span> <span data-ttu-id="7b578-219">Tous les types de machine virtuelle ne prennent pas en charge le stockage Premium.</span><span class="sxs-lookup"><span data-stu-id="7b578-219">Not all VM types support Premium Storage.</span></span> <span data-ttu-id="7b578-220">Pour plus d’informations, consultez [Stockage : stockage Microsoft Azure et disques de données][planning-guide-storage-microsoft-azure-storage-and-data-disks] et [Mise en réseau Microsoft Azure][planning-guide-azure-premium-storage] dans [Planification et implémentation de Machines virtuelles Azure pour SAP sur Linux][planning-guide].</span><span class="sxs-lookup"><span data-stu-id="7b578-220">For more information, see [Storage: Microsoft Azure Storage and data disks][planning-guide-storage-microsoft-azure-storage-and-data-disks] and [Azure Premium Storage][planning-guide-azure-premium-storage] in [Azure Virtual Machines planning and implementation for SAP on Linux][planning-guide].</span></span>

3. <span data-ttu-id="7b578-221">**Paramètres**:</span><span class="sxs-lookup"><span data-stu-id="7b578-221">**Settings**:</span></span>
   * <span data-ttu-id="7b578-222">**Compte de stockage**: sélectionnez un compte de stockage existant ou créez un nouveau compte de stockage.</span><span class="sxs-lookup"><span data-stu-id="7b578-222">**Storage account**: Select an existing storage account or create a new one.</span></span> <span data-ttu-id="7b578-223">Notez que tous les types de stockage ne peuvent pas être utilisés pour l’exécution d’applications SAP.</span><span class="sxs-lookup"><span data-stu-id="7b578-223">Not all storage types work for running SAP applications.</span></span> <span data-ttu-id="7b578-224">Pour plus d’informations sur les types de stockage, consultez [Stockage Microsoft Azure][dbms-guide-2.3] dans [Déploiement SGBD de Machines virtuelles Azure pour SAP sur Linux][dbms-guide].</span><span class="sxs-lookup"><span data-stu-id="7b578-224">For more information about storage types, see [Microsoft Azure Storage][dbms-guide-2.3] in [Azure Virtual Machines DBMS deployment for SAP on Linux][dbms-guide].</span></span>
   * <span data-ttu-id="7b578-225">**Réseau virtuel** et **Sous-réseau** : pour intégrer la machine virtuelle à votre intranet, sélectionnez le réseau virtuel connecté à votre réseau local.</span><span class="sxs-lookup"><span data-stu-id="7b578-225">**Virtual network** and **Subnet**: To integrate the virtual machine with your intranet, select the virtual network that is connected to your on-premises network.</span></span>
   * <span data-ttu-id="7b578-226">**Adresse IP publique** : sélectionnez l’adresse IP publique que vous voulez utiliser ou entrez les paramètres nécessaires pour en créer une.</span><span class="sxs-lookup"><span data-stu-id="7b578-226">**Public IP address**: Select the public IP address that you want to use, or enter parameters to create a new public IP address.</span></span> <span data-ttu-id="7b578-227">Vous pouvez utiliser une adresse IP publique pour accéder à votre machine virtuelle via Internet.</span><span class="sxs-lookup"><span data-stu-id="7b578-227">You can use a public IP address to access your virtual machine over the Internet.</span></span> <span data-ttu-id="7b578-228">Assurez-vous également de créer un groupe de sécurité réseau pour sécuriser l’accès à votre machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="7b578-228">Make sure that you also create a network security group to help secure access to your virtual machine.</span></span>
   * <span data-ttu-id="7b578-229">**Groupe de sécurité réseau** : pour plus d’informations, consultez [Contrôler le flux de trafic réseau avec les groupes de sécurité réseau][virtual-networks-nsg].</span><span class="sxs-lookup"><span data-stu-id="7b578-229">**Network security group**: For more information, see [Control network traffic flow with network security groups][virtual-networks-nsg].</span></span>
   * <span data-ttu-id="7b578-230">**Disponibilité** : sélectionnez un groupe à haute disponibilité ou entrez les paramètres permettant d’en créer un.</span><span class="sxs-lookup"><span data-stu-id="7b578-230">**Availability**: Select an availability set, or enter the parameters to create a new availability set.</span></span> <span data-ttu-id="7b578-231">Pour plus d’informations, consultez [Groupes à haute disponibilité Azure][planning-guide-3.2.3].</span><span class="sxs-lookup"><span data-stu-id="7b578-231">For more information, see [Azure availability sets][planning-guide-3.2.3].</span></span>
   * <span data-ttu-id="7b578-232">**Analyse** : vous pouvez sélectionner **Désactiver** pour les diagnostics d’analyse.</span><span class="sxs-lookup"><span data-stu-id="7b578-232">**Monitoring**: You can select **Disable** for monitoring diagnostics.</span></span> <span data-ttu-id="7b578-233">Cette option est activée automatiquement lorsque vous exécutez les commandes permettant d’activer l’extension d’analyse Azure améliorée comme décrit dans le chapitre [Configuration de l’analyse][deployment-guide-configure-monitoring-scenario-1].</span><span class="sxs-lookup"><span data-stu-id="7b578-233">It is enabled automatically when you run the commands to enable the Azure Enhanced Monitoring Extension, as described in [Configure monitoring][deployment-guide-configure-monitoring-scenario-1].</span></span>

4. <span data-ttu-id="7b578-234">**Résumé**:</span><span class="sxs-lookup"><span data-stu-id="7b578-234">**Summary**:</span></span>

  <span data-ttu-id="7b578-235">Passez en revue vos sélections, puis sélectionnez **OK**.</span><span class="sxs-lookup"><span data-stu-id="7b578-235">Review your selections, and then select **OK**.</span></span>

<span data-ttu-id="7b578-236">Votre machine virtuelle est déployée dans le groupe de ressources que vous avez sélectionné.</span><span class="sxs-lookup"><span data-stu-id="7b578-236">Your virtual machine is deployed in the resource group you selected.</span></span>

#### <a name="create-a-virtual-machine-by-using-a-template"></a><span data-ttu-id="7b578-237">Création d’une machine virtuelle à l’aide d’un modèle</span><span class="sxs-lookup"><span data-stu-id="7b578-237">Create a virtual machine by using a template</span></span>
<span data-ttu-id="7b578-238">Vous pouvez créer une machine virtuelle à l’aide de l’un des modèles SAP publiés dans le [référentiel GitHub azure-quickstart-templates][azure-quickstart-templates-github].</span><span class="sxs-lookup"><span data-stu-id="7b578-238">You can create a virtual machine by using one of the SAP templates published in the [azure-quickstart-templates GitHub repository][azure-quickstart-templates-github].</span></span> <span data-ttu-id="7b578-239">Vous pouvez également créer une machine virtuelle manuellement à l’aide du [portail Azure][virtual-machines-windows-tutorial], de [PowerShell][virtual-machines-ps-create-preconfigure-windows-resource-manager-vms] ou de [l’interface de ligne de commande Azure][virtual-machines-linux-tutorial].</span><span class="sxs-lookup"><span data-stu-id="7b578-239">You also can manually create a virtual machine by using the [Azure portal][virtual-machines-windows-tutorial], [PowerShell][virtual-machines-ps-create-preconfigure-windows-resource-manager-vms], or [Azure CLI][virtual-machines-linux-tutorial].</span></span>

* <span data-ttu-id="7b578-240">[**Modèle de configuration à deux niveaux (une seule machine virtuelle)** (sap-2-tier-user-disk)][sap-templates-2-tier-marketplace-image]</span><span class="sxs-lookup"><span data-stu-id="7b578-240">[**Two-tier configuration (only one virtual machine) template** (sap-2-tier-marketplace-image)][sap-templates-2-tier-marketplace-image]</span></span>

  <span data-ttu-id="7b578-241">Pour créer un système à deux niveaux avec une seule machine virtuelle, utilisez ce modèle.</span><span class="sxs-lookup"><span data-stu-id="7b578-241">To create a two-tier system by using only one virtual machine, use this template.</span></span>
* <span data-ttu-id="7b578-242">[**Modèle de configuration à trois niveaux (plusieurs machines virtuelles)** (sap-3-tier-marketplace-image)][sap-templates-3-tier-marketplace-image]</span><span class="sxs-lookup"><span data-stu-id="7b578-242">[**Three-tier configuration (multiple virtual machines) template** (sap-3-tier-marketplace-image)][sap-templates-3-tier-marketplace-image]</span></span>

  <span data-ttu-id="7b578-243">Pour créer un système à trois niveaux avec plusieurs machines virtuelles, utilisez ce modèle.</span><span class="sxs-lookup"><span data-stu-id="7b578-243">To create a three-tier system by using multiple virtual machines, use this template.</span></span>

<span data-ttu-id="7b578-244">Dans le portail Azure, entrez les paramètres suivants pour le modèle :</span><span class="sxs-lookup"><span data-stu-id="7b578-244">In the Azure portal, enter the following parameters for the template:</span></span>

1. <span data-ttu-id="7b578-245">**Paramètres de base**:</span><span class="sxs-lookup"><span data-stu-id="7b578-245">**Basics**:</span></span>
  * <span data-ttu-id="7b578-246">**Abonnement** : l’abonnement à utiliser pour déployer le modèle.</span><span class="sxs-lookup"><span data-stu-id="7b578-246">**Subscription**: The subscription to use to deploy the template.</span></span>
  * <span data-ttu-id="7b578-247">**Groupe de ressources** : le groupe de ressources à utiliser pour déployer le modèle.</span><span class="sxs-lookup"><span data-stu-id="7b578-247">**Resource group**: The resource group to use to deploy the template.</span></span> <span data-ttu-id="7b578-248">Vous pouvez créer un groupe de ressources ou sélectionner un groupe de ressources existant dans l’abonnement.</span><span class="sxs-lookup"><span data-stu-id="7b578-248">You can create a new resource group, or you can select an existing resource group in the subscription.</span></span>
  * <span data-ttu-id="7b578-249">**Emplacement** : emplacement où déployer le modèle.</span><span class="sxs-lookup"><span data-stu-id="7b578-249">**Location**: Where to deploy the template.</span></span> <span data-ttu-id="7b578-250">Si vous avez sélectionné un groupe de ressources existant, l’emplacement du groupe de ressources est utilisé.</span><span class="sxs-lookup"><span data-stu-id="7b578-250">If you selected an existing resource group, the location of that resource group is used.</span></span>

2. <span data-ttu-id="7b578-251">**Paramètres**:</span><span class="sxs-lookup"><span data-stu-id="7b578-251">**Settings**:</span></span>
  * <span data-ttu-id="7b578-252">**ID du système SAP** : identifiant du système SAP (SID).</span><span class="sxs-lookup"><span data-stu-id="7b578-252">**SAP System ID**: The SAP System ID (SID).</span></span>
  * <span data-ttu-id="7b578-253">**Type de système d’exploitation** : le système d’exploitation que vous souhaitez déployer, par exemple, Windows Server 2012 R2, SUSE Linux Enterprise Server 12 (SLES 12) ou Red Hat Enterprise Linux 7.2 (RHEL 7.2).</span><span class="sxs-lookup"><span data-stu-id="7b578-253">**OS type**: The operating system you want to deploy, for example, Windows Server 2012 R2, SUSE Linux Enterprise Server 12 (SLES 12), or Red Hat Enterprise Linux 7.2 (RHEL 7.2).</span></span>

    <span data-ttu-id="7b578-254">La liste affichée par défaut ne répertorie pas tous les systèmes d’exploitation pris en charge.</span><span class="sxs-lookup"><span data-stu-id="7b578-254">The default list view does not show all supported operating systems.</span></span> <span data-ttu-id="7b578-255">Pour obtenir une liste complète, sélectionnez **Afficher tout**.</span><span class="sxs-lookup"><span data-stu-id="7b578-255">Select **see all** for a full list.</span></span> <span data-ttu-id="7b578-256">Pour plus d’informations sur les systèmes d’exploitation pris en charge pour le déploiement de logiciels SAP, consultez la note SAP [1928533].</span><span class="sxs-lookup"><span data-stu-id="7b578-256">For more information about supported operating systems for SAP software deployment, see SAP Note [1928533].</span></span>
  * <span data-ttu-id="7b578-257">**Taille du système SAP** : taille du système SAP.</span><span class="sxs-lookup"><span data-stu-id="7b578-257">**SAP system size**: The size of the SAP system.</span></span>

    <span data-ttu-id="7b578-258">Le nombre de SAP fournis par le nouveau système.</span><span class="sxs-lookup"><span data-stu-id="7b578-258">The number of SAPS the new system provides.</span></span> <span data-ttu-id="7b578-259">Si vous ne savez pas combien de SAP sont requis par le système, demandez à votre partenaire technologique SAP ou un intégrateur système.</span><span class="sxs-lookup"><span data-stu-id="7b578-259">If you are not sure how many SAPS the system requires, ask your SAP Technology Partner or System Integrator.</span></span>
  * <span data-ttu-id="7b578-260">**Disponibilité du système** (modèle à trois niveaux uniquement) : disponibilité du système.</span><span class="sxs-lookup"><span data-stu-id="7b578-260">**System availability** (three-tier template only): The system availability.</span></span>

    <span data-ttu-id="7b578-261">Sélectionnez la haute disponibilité (**HA**) si la configuration est adaptée à une installation haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="7b578-261">Select **HA** for a configuration that is suitable for a high-availability installation.</span></span> <span data-ttu-id="7b578-262">Deux serveurs de base de données et deux serveurs pour ABAP SAP Central Services (ASC) sont créés.</span><span class="sxs-lookup"><span data-stu-id="7b578-262">Two database servers and two servers for ABAP SAP Central Services (ASCS) are created.</span></span>
  * <span data-ttu-id="7b578-263">**Type de stockage** (modèle à deux niveaux uniquement) : type de stockage à utiliser.</span><span class="sxs-lookup"><span data-stu-id="7b578-263">**Storage type** (two-tier template only): The type of storage to use.</span></span>

    <span data-ttu-id="7b578-264">Pour les grands systèmes, nous vous recommandons l’utilisation du stockage Premium Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-264">For larger systems, we highly recommend using Azure Premium Storage.</span></span> <span data-ttu-id="7b578-265">Pour plus d’informations sur les types de stockage, consultez ces ressources :</span><span class="sxs-lookup"><span data-stu-id="7b578-265">For more information about storage types, see these resources:</span></span>
      * <span data-ttu-id="7b578-266">[Utilisation du stockage SSD Azure Premium pour l’instance de SGBD SAP][2367194]</span><span class="sxs-lookup"><span data-stu-id="7b578-266">[Use of Azure Premium SSD Storage for SAP DBMS Instance][2367194]</span></span>
      * <span data-ttu-id="7b578-267">[Stockage Microsoft Azure][dbms-guide-2.3] dans [Déploiement SGBD de Machines virtuelles Azure pour SAP sur Linux][dbms-guide]</span><span class="sxs-lookup"><span data-stu-id="7b578-267">[Microsoft Azure Storage][dbms-guide-2.3] in [Azure Virtual Machines DBMS deployment for SAP on Linux][dbms-guide]</span></span>
      * <span data-ttu-id="7b578-268">[Stockage Premium : stockage hautes performances pour les charges de travail des machines virtuelles Azure][storage-premium-storage-preview-portal]</span><span class="sxs-lookup"><span data-stu-id="7b578-268">[Premium Storage: High-performance storage for Azure Virtual Machine workloads][storage-premium-storage-preview-portal]</span></span>
      * <span data-ttu-id="7b578-269">[Présentation du stockage Microsoft Azure][storage-introduction]</span><span class="sxs-lookup"><span data-stu-id="7b578-269">[Introduction to Microsoft Azure Storage][storage-introduction]</span></span>
  * <span data-ttu-id="7b578-270">**Nom d’utilisateur administrateur** et **Mot de passe administrateur** : nom d’utilisateur et mot de passe.</span><span class="sxs-lookup"><span data-stu-id="7b578-270">**Admin username** and **Admin password**: A username and password.</span></span>
    <span data-ttu-id="7b578-271">Un nouvel utilisateur est créé pour la connexion à la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="7b578-271">A new user is created, for signing in to the virtual machine.</span></span>
  * <span data-ttu-id="7b578-272">**Sous-réseau nouveau ou existant** : détermine si un réseau virtuel et un sous-réseau doivent être créés ou si un sous-réseau existant doit être utilisé.</span><span class="sxs-lookup"><span data-stu-id="7b578-272">**New or existing subnet**: Determines whether a new virtual network and subnet are  created or an existing subnet is used.</span></span> <span data-ttu-id="7b578-273">Si vous disposez déjà d’un réseau virtuel connecté à votre réseau local, sélectionnez **Existant**.</span><span class="sxs-lookup"><span data-stu-id="7b578-273">If you already have a virtual network that is connected to your on-premises network, select **Existing**.</span></span>
  * <span data-ttu-id="7b578-274">**ID du sous-réseau** : identifiant du sous-réseau auquel les machines virtuelles seront connectées.</span><span class="sxs-lookup"><span data-stu-id="7b578-274">**Subnet ID**: The ID of the subnet the virtual machines will connect to.</span></span> <span data-ttu-id="7b578-275">Sélectionnez le sous-réseau de votre réseau privé virtuel (VPN) ou réseau virtuel Azure ExpressRoute à utiliser pour connecter la machine virtuelle à votre réseau local.</span><span class="sxs-lookup"><span data-stu-id="7b578-275">Select the subnet of your virtual private network (VPN) or Azure ExpressRoute virtual network to use to connect the virtual machine to your on-premises network.</span></span> <span data-ttu-id="7b578-276">L’ID se présente généralement comme suit : /subscriptions/&lt;id d’abonnement>/resourceGroups/&lt;nom du groupe de ressources>/providers/Microsoft.Network/virtualNetworks/&lt;nom du réseau virtuel>/subnets/&lt;nom du sous-réseau></span><span class="sxs-lookup"><span data-stu-id="7b578-276">The ID usually looks like this: /subscriptions/&lt;subscription id>/resourceGroups/&lt;resource group name>/providers/Microsoft.Network/virtualNetworks/&lt;virtual network name>/subnets/&lt;subnet name></span></span>

3. <span data-ttu-id="7b578-277">**Conditions générales** :</span><span class="sxs-lookup"><span data-stu-id="7b578-277">**Terms and conditions**:</span></span>  
    <span data-ttu-id="7b578-278">Lisez et acceptez les conditions juridiques.</span><span class="sxs-lookup"><span data-stu-id="7b578-278">Review and accept the legal terms.</span></span>

4.  <span data-ttu-id="7b578-279">Sélectionnez **Achat**.</span><span class="sxs-lookup"><span data-stu-id="7b578-279">Select **Purchase**.</span></span>

<span data-ttu-id="7b578-280">L’agent de la machine virtuelle Azure est déployé par défaut lorsque vous utilisez une image provenant d’Azure Marketplace.</span><span class="sxs-lookup"><span data-stu-id="7b578-280">The Azure VM Agent is deployed by default when you use an image from the Azure Marketplace.</span></span>

#### <a name="configure-proxy-settings"></a><span data-ttu-id="7b578-281">Configuration des paramètres de proxy</span><span class="sxs-lookup"><span data-stu-id="7b578-281">Configure proxy settings</span></span>
<span data-ttu-id="7b578-282">Selon la configuration de votre réseau local, vous devrez peut-être configurer le proxy sur votre machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="7b578-282">Depending on how your on-premises network is configured, you might need to set up the proxy on your VM.</span></span> <span data-ttu-id="7b578-283">Si votre machine virtuelle est connectée à votre réseau local via VPN ou ExpressRoute, la machine virtuelle ne sera pas peut-être pas en mesure d’accéder à Internet et de télécharger les extensions nécessaires ou de collecter des données d’analyse.</span><span class="sxs-lookup"><span data-stu-id="7b578-283">If your VM is connected to your on-premises network via VPN or ExpressRoute, the VM might not be able to access the Internet, and won't be able to download the required extensions or collect monitoring data.</span></span> <span data-ttu-id="7b578-284">Pour plus d’informations, voir [Configuration du proxy][deployment-guide-configure-proxy].</span><span class="sxs-lookup"><span data-stu-id="7b578-284">For more information, see [Configure the proxy][deployment-guide-configure-proxy].</span></span>

#### <a name="join-a-domain-windows-only"></a><span data-ttu-id="7b578-285">Joindre un domaine (Windows uniquement)</span><span class="sxs-lookup"><span data-stu-id="7b578-285">Join a domain (Windows only)</span></span>
<span data-ttu-id="7b578-286">Si votre déploiement Azure est connecté à une instance Active Directory ou DNS locale via une connexion VPN de site à site Azure ou via ExpressRoute (connexion *intersite* dans [Planification et implémentation de Machines virtuelles Azure pour SAP sur Linux][planning-guide]), la machine virtuelle doit être jointe à un domaine local.</span><span class="sxs-lookup"><span data-stu-id="7b578-286">If your Azure deployment is connected to an on-premises Active Directory or DNS instance via an Azure site-to-site VPN connection or ExpressRoute (this is called *cross-premises* in [Azure Virtual Machines planning and implementation for SAP on Linux][planning-guide]), it is expected that the VM is joining an on-premises domain.</span></span> <span data-ttu-id="7b578-287">Pour plus d’informations sur les éléments à prendre en compte pour cette tâche, consultez [Joindre une machine virtuelle à un domaine local (Windows uniquement)][deployment-guide-4.3].</span><span class="sxs-lookup"><span data-stu-id="7b578-287">For more information about considerations for this task, see [Join a VM to an on-premises domain (Windows only)][deployment-guide-4.3].</span></span>

#### <span data-ttu-id="7b578-288"><a name="ec323ac3-1de9-4c3a-b770-4ff701def65b"></a>Configuration de l’analyse</span><span class="sxs-lookup"><span data-stu-id="7b578-288"><a name="ec323ac3-1de9-4c3a-b770-4ff701def65b"></a>Configure monitoring</span></span>
<span data-ttu-id="7b578-289">Pour être sûr que votre environnement prenne en charge SAP, configurez l’extension d’analyse Azure pour SAP comme décrit dans [Configurer l’extension d’analyse Azure améliorée pour SAP][deployment-guide-4.5].</span><span class="sxs-lookup"><span data-stu-id="7b578-289">To be sure your environment supports SAP, set up the Azure Monitoring Extension for SAP as described in [Configure the Azure Enhanced Monitoring Extension for SAP][deployment-guide-4.5].</span></span> <span data-ttu-id="7b578-290">Vérifiez la configuration requise pour l’analyse SAP pour connaître les versions minimales requises pour le noyau SAP et l’agent hôte SAP dans les ressources répertoriées dans [Ressources SAP][deployment-guide-2.2].</span><span class="sxs-lookup"><span data-stu-id="7b578-290">Check the prerequisites for SAP monitoring, and required minimum versions of SAP Kernel and SAP Host Agent, in the resources listed in [SAP resources][deployment-guide-2.2].</span></span>

#### <a name="monitoring-check"></a><span data-ttu-id="7b578-291">Vérification de l’analyse</span><span class="sxs-lookup"><span data-stu-id="7b578-291">Monitoring check</span></span>
<span data-ttu-id="7b578-292">Vérifiez si l’analyse fonctionne comme décrit dans [Vérifications et résolution des problèmes pour la configuration de l’analyse de bout en bout][deployment-guide-troubleshooting-chapter].</span><span class="sxs-lookup"><span data-stu-id="7b578-292">Check whether monitoring is working, as described in [Checks and troubleshooting for setting up end-to-end monitoring][deployment-guide-troubleshooting-chapter].</span></span>

#### <a name="post-deployment-steps"></a><span data-ttu-id="7b578-293">Étapes de post-déploiement</span><span class="sxs-lookup"><span data-stu-id="7b578-293">Post-deployment steps</span></span>
<span data-ttu-id="7b578-294">Après avoir créé et déployé la machine virtuelle, vous devez installer les composants logiciels requis dans la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="7b578-294">After you create the VM and the VM is deployed, you need to install the required software components in the VM.</span></span> <span data-ttu-id="7b578-295">En raison de la séquence de déploiement/d’installation de logiciels dans ce type de déploiement de machine virtuelle, le logiciel à installer doit déjà être disponible, soit dans Azure, soit sur une autre machine virtuelle, ou en tant que disque qui peut être lié.</span><span class="sxs-lookup"><span data-stu-id="7b578-295">Because of the deployment/software installation sequence in this type of VM deployment, the software to be installed must already be available, either in Azure, on another VM, or as a disk that can be attached.</span></span> <span data-ttu-id="7b578-296">Sinon, envisagez un scénario intersite dans lequel la connectivité aux ressources locales (partages d’installation) est acquise.</span><span class="sxs-lookup"><span data-stu-id="7b578-296">Or, consider using a cross-premises scenario, in which connectivity to the on-premises assets (installation shares) is given.</span></span>

<span data-ttu-id="7b578-297">Une fois que vous avez déployé votre machine virtuelle dans Azure, utilisez les mêmes instructions et outils pour installer les logiciels SAP sur votre machine virtuelle comme vous le feriez dans un environnement local.</span><span class="sxs-lookup"><span data-stu-id="7b578-297">After you deploy your VM in Azure, follow the same guidelines and tools to install the SAP software on your VM as you would in an on-premises environment.</span></span> <span data-ttu-id="7b578-298">Pour installer les logiciels SAP sur une machine virtuelle Azure, SAP et Microsoft recommandent de télécharger et stocker le support d’installation SAP sur des disques durs virtuels Azure, ou de créer une machine virtuelle Azure faisant office de serveur de fichiers qui contient tous les supports d’installation SAP nécessaires.</span><span class="sxs-lookup"><span data-stu-id="7b578-298">To install SAP software on an Azure VM, both SAP and Microsoft recommend that you upload and store the SAP installation media on Azure VHDs, or that you create an Azure VM that works as a file server that has all the required SAP installation media.</span></span>

<span data-ttu-id="7b578-299">[comment]: <> (MSSedusch TODO why do we need to recommend a file management, for example, File Server or VHD? Is that so different from on-premises?)</span><span class="sxs-lookup"><span data-stu-id="7b578-299">[comment]: <> (MSSedusch TODO why do we need to recommend a file management, for example, File Server or VHD? Is that so different from on-premises?)</span></span>

### <span data-ttu-id="7b578-300"><a name="54a1fc6d-24fd-4feb-9c57-ac588a55dff2"></a>Scénario 2 : Déploiement d’une machine virtuelle avec une image personnalisée pour SAP</span><span class="sxs-lookup"><span data-stu-id="7b578-300"><a name="54a1fc6d-24fd-4feb-9c57-ac588a55dff2"></a>Scenario 2: Deploying a VM with a custom image for SAP</span></span>
<span data-ttu-id="7b578-301">Dans la mesure où les différentes versions d’un système d’exploitation ou d’un SGBD ont des exigences différentes en matière de correctif, les images disponibles dans Azure Marketplace ne répondront peut-être pas à vos besoins.</span><span class="sxs-lookup"><span data-stu-id="7b578-301">Because different versions of an operating system or DBMS have different patch requirements, the images you find in the Azure Marketplace might not meet your needs.</span></span> <span data-ttu-id="7b578-302">Peut-être préférerez-vous créer une machine virtuelle à l’aide de votre propre image de machine virtuelle du système d’exploitation/SGBD, que vous pourrez de nouveau déployer ultérieurement.</span><span class="sxs-lookup"><span data-stu-id="7b578-302">You might instead want to create a VM by using your own OS/DBMS VM image, which you can deploy again later.</span></span>
<span data-ttu-id="7b578-303">Différentes étapes permettent de créer une image privée pour Linux et pour Windows.</span><span class="sxs-lookup"><span data-stu-id="7b578-303">You use different steps to create a private image for Linux than to create one for Windows.</span></span>

- - -
> ![Windows][Logo_Windows] <span data-ttu-id="7b578-305">Windows</span><span class="sxs-lookup"><span data-stu-id="7b578-305">Windows</span></span>
>
> <span data-ttu-id="7b578-306">Pour préparer une image Windows pouvant être utilisée pour déployer plusieurs machines virtuelles, les paramètres Windows (comme le nom d’hôte et le SID Windows) doivent être abstraits ou généralisés sur la machine virtuelle locale.</span><span class="sxs-lookup"><span data-stu-id="7b578-306">To prepare a Windows image that you can use to deploy multiple virtual machines, the Windows settings (like Windows SID and hostname) must be abstracted or generalized on the on-premises VM.</span></span> <span data-ttu-id="7b578-307">Pour ce faire, vous pouvez utiliser la commande [sysprep](https://msdn.microsoft.com/library/hh825084.aspx).</span><span class="sxs-lookup"><span data-stu-id="7b578-307">You can use [sysprep](https://msdn.microsoft.com/library/hh825084.aspx) to do this.</span></span>
>
> ![Linux][Logo_Linux] <span data-ttu-id="7b578-309">Linux</span><span class="sxs-lookup"><span data-stu-id="7b578-309">Linux</span></span>
>
> <span data-ttu-id="7b578-310">Pour préparer une image Linux pouvant être utilisée pour déployer plusieurs machines virtuelles, certains paramètres Linux doivent être abstraits ou généralisés sur la machine virtuelle locale.</span><span class="sxs-lookup"><span data-stu-id="7b578-310">To prepare a Linux image that you can use to deploy multiple virtual machines, some Linux settings must be abstracted or generalized on the on-premises VM.</span></span> <span data-ttu-id="7b578-311">Pour ce faire, vous pouvez utiliser la commande `waagent -deprovision`.</span><span class="sxs-lookup"><span data-stu-id="7b578-311">You can use `waagent -deprovision`  to do this.</span></span> <span data-ttu-id="7b578-312">Pour plus d’informations, consultez [Capture d’une machine virtuelle Linux s’exécutant sur Azure][virtual-machines-linux-capture-image] et le [guide de l’utilisateur de l’agent Linux Azure][virtual-machines-linux-agent-user-guide-command-line-options].</span><span class="sxs-lookup"><span data-stu-id="7b578-312">For more information, see [Capture a Linux virtual machine running on Azure][virtual-machines-linux-capture-image] and the [Azure Linux agent user guide][virtual-machines-linux-agent-user-guide-command-line-options].</span></span>
>
>

- - -
<span data-ttu-id="7b578-313">Vous pouvez préparer et créer une image personnalisée, puis l’utiliser pour créer plusieurs nouvelles machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="7b578-313">You can prepare and create a custom image, and then use it to create multiple new VMs.</span></span> <span data-ttu-id="7b578-314">Cette opération est décrite dans [Planification et implémentation de Machines virtuelles Azure pour SAP sur Linux][planning-guide].</span><span class="sxs-lookup"><span data-stu-id="7b578-314">This is described in [Azure Virtual Machines planning and implementation for SAP on Linux][planning-guide].</span></span> <span data-ttu-id="7b578-315">Configurez le contenu de votre base de données en utilisant le gestionnaire de déploiement de logiciels SAP pour installer un nouveau système SAP (restaure une sauvegarde de base de données à partir d’un disque dur virtuel connecté à la machine virtuelle) ou restaurer directement une sauvegarde de base de données à partir du stockage Azure si votre SGBD le permet.</span><span class="sxs-lookup"><span data-stu-id="7b578-315">Set up your database content either by using SAP Software Provisioning Manager to install a new SAP system (restores a database backup from a VHD that's attached to the virtual machine) or by directly restoring a database backup from Azure storage, if your DBMS supports it.</span></span> <span data-ttu-id="7b578-316">Pour plus d’informations, consultez [Déploiement SGBD de Machines virtuelles Azure pour SAP sur Linux][dbms-guide].</span><span class="sxs-lookup"><span data-stu-id="7b578-316">For more information, see [Azure Virtual Machines DBMS deployment for SAP on Linux][dbms-guide].</span></span> <span data-ttu-id="7b578-317">Si vous avez déjà installé un système SAP sur votre machine virtuelle locale (en particulier pour les systèmes à deux niveaux), vous pouvez adapter les paramètres du système SAP après le déploiement de la machine virtuelle Azure à l’aide de la procédure de renommage système prise en charge par le gestionnaire de déploiement de logiciels SAP (Note SAP [1619720]).</span><span class="sxs-lookup"><span data-stu-id="7b578-317">If you have already installed an SAP system on your on-premises VM (especially for two-tier systems), you can adapt the SAP system settings after the deployment of the Azure VM by using the System Rename procedure supported by SAP Software Provisioning Manager (SAP Note [1619720]).</span></span> <span data-ttu-id="7b578-318">Sinon, vous pouvez installer les logiciels SAP après avoir déployé la machine virtuelle Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-318">Otherwise, you can install the SAP software after you deploy the Azure VM.</span></span>

<span data-ttu-id="7b578-319">L’organigramme suivant illustre la séquence d’étapes spécifiques à SAP pour le déploiement d’une machine virtuelle à partir d’une image personnalisée :</span><span class="sxs-lookup"><span data-stu-id="7b578-319">The following flowchart shows the SAP-specific sequence of steps for deploying a VM from a custom image:</span></span>

![Organigramme de déploiement de machines virtuelles pour les systèmes SAP à l’aide d’une image de machine virtuelle provenant du Marketplace privé][deployment-guide-figure-300]

#### <a name="create-the-virtual-machine"></a><span data-ttu-id="7b578-321">Créer la machine virtuelle</span><span class="sxs-lookup"><span data-stu-id="7b578-321">Create the virtual machine</span></span>
<span data-ttu-id="7b578-322">Pour créer un déploiement à l’aide d’une image privée de système d’exploitation à partir du portail Azure, utilisez l’un des modèles SAP suivants.</span><span class="sxs-lookup"><span data-stu-id="7b578-322">To create a deployment by using a private OS image from the Azure portal, use one of the following SAP templates.</span></span> <span data-ttu-id="7b578-323">Ces modèles sont publiés dans le [référentiel GitHub azure-quickstart-templates][azure-quickstart-templates-github].</span><span class="sxs-lookup"><span data-stu-id="7b578-323">These templates are published in the [azure-quickstart-templates GitHub repository][azure-quickstart-templates-github].</span></span> <span data-ttu-id="7b578-324">Vous pouvez également créer une machine virtuelle manuellement à l’aide de [PowerShell][virtual-machines-upload-image-windows-resource-manager].</span><span class="sxs-lookup"><span data-stu-id="7b578-324">You also can manually create a virtual machine, by using [PowerShell][virtual-machines-upload-image-windows-resource-manager].</span></span>

* <span data-ttu-id="7b578-325">[**Modèle de configuration à deux niveaux (une seule machine virtuelle)** (sap-2-tier-user-image)][sap-templates-2-tier-user-image]</span><span class="sxs-lookup"><span data-stu-id="7b578-325">[**Two-tier configuration (only one virtual machine) template** (sap-2-tier-user-image)][sap-templates-2-tier-user-image]</span></span>

  <span data-ttu-id="7b578-326">Pour créer un système à deux niveaux avec une seule machine virtuelle, utilisez ce modèle.</span><span class="sxs-lookup"><span data-stu-id="7b578-326">To create a two-tier system by using only one virtual machine, use this template.</span></span>
* <span data-ttu-id="7b578-327">[**Modèle de configuration à trois niveaux (plusieurs machines virtuelles)** (sap-3-tier-user-image)][sap-templates-3-tier-user-image]</span><span class="sxs-lookup"><span data-stu-id="7b578-327">[**Three-tier configuration (multiple virtual machines) template** (sap-3-tier-user-image)][sap-templates-3-tier-user-image]</span></span>

  <span data-ttu-id="7b578-328">Pour créer un système à trois niveaux avec plusieurs machines virtuelles ou votre propre image de système d’exploitation, utilisez ce modèle.</span><span class="sxs-lookup"><span data-stu-id="7b578-328">To create a three-tier system by using multiple virtual machines or your own OS image, use this template.</span></span>

<span data-ttu-id="7b578-329">Dans le portail Azure, entrez les paramètres suivants pour le modèle :</span><span class="sxs-lookup"><span data-stu-id="7b578-329">In the Azure portal, enter the following parameters for the template:</span></span>

1. <span data-ttu-id="7b578-330">**Paramètres de base**:</span><span class="sxs-lookup"><span data-stu-id="7b578-330">**Basics**:</span></span>
  * <span data-ttu-id="7b578-331">**Abonnement** : l’abonnement à utiliser pour déployer le modèle.</span><span class="sxs-lookup"><span data-stu-id="7b578-331">**Subscription**: The subscription to use to deploy the template.</span></span>
  * <span data-ttu-id="7b578-332">**Groupe de ressources** : le groupe de ressources à utiliser pour déployer le modèle.</span><span class="sxs-lookup"><span data-stu-id="7b578-332">**Resource group**: The resource group to use to deploy the template.</span></span> <span data-ttu-id="7b578-333">Vous pouvez créer un groupe de ressources ou sélectionner un groupe de ressources existant dans l’abonnement.</span><span class="sxs-lookup"><span data-stu-id="7b578-333">You can create a new resource group or select an existing resource group in the subscription.</span></span>
  * <span data-ttu-id="7b578-334">**Emplacement** : emplacement où déployer le modèle.</span><span class="sxs-lookup"><span data-stu-id="7b578-334">**Location**: Where to deploy the template.</span></span> <span data-ttu-id="7b578-335">Si vous avez sélectionné un groupe de ressources existant, l’emplacement du groupe de ressources est utilisé.</span><span class="sxs-lookup"><span data-stu-id="7b578-335">If you selected an existing resource group, the location of that resource group is used.</span></span>
2. <span data-ttu-id="7b578-336">**Paramètres**:</span><span class="sxs-lookup"><span data-stu-id="7b578-336">**Settings**:</span></span>
  * <span data-ttu-id="7b578-337">**SAP System ID** : identifiant du système SAP.</span><span class="sxs-lookup"><span data-stu-id="7b578-337">**SAP System ID**: The SAP System ID.</span></span>
  * <span data-ttu-id="7b578-338">**Type de système d’exploitation** : type de système d’exploitation à déployer (Windows ou Linux).</span><span class="sxs-lookup"><span data-stu-id="7b578-338">**OS type**: The operating system type you want to deploy (Windows or Linux).</span></span>
  * <span data-ttu-id="7b578-339">**Taille du système SAP** : taille du système SAP.</span><span class="sxs-lookup"><span data-stu-id="7b578-339">**SAP system size**: The size of the SAP system.</span></span>

    <span data-ttu-id="7b578-340">Le nombre de SAP fournis par le nouveau système.</span><span class="sxs-lookup"><span data-stu-id="7b578-340">The number of SAPS the new system provides.</span></span> <span data-ttu-id="7b578-341">Si vous ne savez pas combien de SAP sont requis par le système, demandez à votre partenaire technologique SAP ou un intégrateur système.</span><span class="sxs-lookup"><span data-stu-id="7b578-341">If you are not sure how many SAPS the system requires, ask your SAP Technology Partner or System Integrator.</span></span>
  * <span data-ttu-id="7b578-342">**Disponibilité du système** (modèle à trois niveaux uniquement) : disponibilité du système.</span><span class="sxs-lookup"><span data-stu-id="7b578-342">**System availability** (three-tier template only): The system availability.</span></span>

    <span data-ttu-id="7b578-343">Sélectionnez la haute disponibilité (**HA**) si la configuration est adaptée à une installation haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="7b578-343">Select **HA** for a configuration that is suitable for a high-availability installation.</span></span> <span data-ttu-id="7b578-344">Deux serveurs de base de données et deux serveurs pour l’ASCS sont créés.</span><span class="sxs-lookup"><span data-stu-id="7b578-344">Two database servers and two servers for ASCS are created.</span></span>
  * <span data-ttu-id="7b578-345">**Type de stockage** (modèle à deux niveaux uniquement) : type de stockage à utiliser.</span><span class="sxs-lookup"><span data-stu-id="7b578-345">**Storage type** (two-tier template only): The type of storage to use.</span></span>

    <span data-ttu-id="7b578-346">Pour les grands systèmes, nous vous recommandons l’utilisation du stockage Premium Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-346">For larger systems, we highly recommend using Azure Premium Storage.</span></span> <span data-ttu-id="7b578-347">Pour plus d’informations sur les types de stockage, consultez les ressources suivantes :</span><span class="sxs-lookup"><span data-stu-id="7b578-347">For more information about storage types, see the following resources:</span></span>
      * <span data-ttu-id="7b578-348">[Utilisation du stockage SSD Azure Premium pour l’instance de SGBD SAP][2367194]</span><span class="sxs-lookup"><span data-stu-id="7b578-348">[Use of Azure Premium SSD Storage for SAP DBMS Instance][2367194]</span></span>
      * <span data-ttu-id="7b578-349">[Stockage Microsoft Azure][dbms-guide-2.3] dans [Déploiement SGBD de Machines virtuelles Azure pour SAP sur Linux][dbms-guide]</span><span class="sxs-lookup"><span data-stu-id="7b578-349">[Microsoft Azure Storage][dbms-guide-2.3] in [Azure Virtual Machines DBMS deployment for SAP on Linux][dbms-guide]</span></span>
      * <span data-ttu-id="7b578-350">[Stockage Premium : stockage hautes performances pour les charges de travail des machines virtuelles Azure][storage-premium-storage-preview-portal]</span><span class="sxs-lookup"><span data-stu-id="7b578-350">[Premium Storage: High-performance storage for Azure virtual machine workloads][storage-premium-storage-preview-portal]</span></span>
      * <span data-ttu-id="7b578-351">[Présentation du stockage Microsoft Azure][storage-introduction]</span><span class="sxs-lookup"><span data-stu-id="7b578-351">[Introduction to Microsoft Azure Storage][storage-introduction]</span></span>
  * <span data-ttu-id="7b578-352">**URI du disque dur virtuel de l’image utilisateur** : URI du disque dur virtuel de l’image privée du système d’exploitation, par exemple https://&lt;nom du compte>.blob.core.windows.net/vhds/userimage.vhd.</span><span class="sxs-lookup"><span data-stu-id="7b578-352">**User image VHD URI**: The URI of the private OS image VHD, for example, https://&lt;accountname>.blob.core.windows.net/vhds/userimage.vhd.</span></span>
  * <span data-ttu-id="7b578-353">**Compte de stockage de l’image utilisateur** : nom du compte de stockage où est stockée l’image privée du système d’exploitation, par exemple &lt;nom du compte> dans https://&lt;nom du compte>.blob.core.windows.net/vhds/userimage.vhd.</span><span class="sxs-lookup"><span data-stu-id="7b578-353">**User image storage account**: The name of the storage account where the private OS image is stored, for example, &lt;accountname> in https://&lt;accountname>.blob.core.windows.net/vhds/userimage.vhd.</span></span>
  * <span data-ttu-id="7b578-354">**Nom d’utilisateur administrateur** et **mot de passe administrateur** : nom d’utilisateur et mot de passe.</span><span class="sxs-lookup"><span data-stu-id="7b578-354">**Admin username** and **Admin password**: The username and password.</span></span>

    <span data-ttu-id="7b578-355">Un nouvel utilisateur est créé pour la connexion à la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="7b578-355">A new user is created, for signing in to the virtual machine.</span></span>
  * <span data-ttu-id="7b578-356">**Sous-réseau nouveau ou existant** : détermine si un réseau virtuel et un sous-réseau doivent être créés ou si un sous-réseau existant doit être utilisé.</span><span class="sxs-lookup"><span data-stu-id="7b578-356">**New or existing subnet**: Determines whether a new virtual network and subnet is created or an existing subnet is used.</span></span> <span data-ttu-id="7b578-357">Si vous disposez déjà d’un réseau virtuel connecté à votre réseau local, sélectionnez **Existant**.</span><span class="sxs-lookup"><span data-stu-id="7b578-357">If you already have a virtual network that is connected to your on-premises network, select **Existing**.</span></span>
  * <span data-ttu-id="7b578-358">**ID du sous-réseau** : identifiant du sous-réseau auquel les machines virtuelles seront connectées.</span><span class="sxs-lookup"><span data-stu-id="7b578-358">**Subnet ID**: The ID of the subnet to which the virtual machines will connect to.</span></span> <span data-ttu-id="7b578-359">Sélectionnez le sous-réseau de votre VPN ou réseau virtuel ExpressRoute à utiliser pour connecter la machine virtuelle à votre réseau local.</span><span class="sxs-lookup"><span data-stu-id="7b578-359">Select the subnet of your VPN or ExpressRoute virtual network to use to connect the virtual machine to your on-premises network.</span></span> <span data-ttu-id="7b578-360">L'ID ressemble généralement à ceci :</span><span class="sxs-lookup"><span data-stu-id="7b578-360">The ID usually looks like this:</span></span>

    <span data-ttu-id="7b578-361">/subscriptions/&lt;id d’abonnement>/resourceGroups/&lt;nom du groupe de ressources>/providers/Microsoft.Network/virtualNetworks/&lt;nom du réseau virtuel>/subnets/&lt;nom du sous-réseau></span><span class="sxs-lookup"><span data-stu-id="7b578-361">/subscriptions/&lt;subscription id>/resourceGroups/&lt;resource group name>/providers/Microsoft.Network/virtualNetworks/&lt;virtual network name>/subnets/&lt;subnet name></span></span>

3. <span data-ttu-id="7b578-362">**Conditions générales** :</span><span class="sxs-lookup"><span data-stu-id="7b578-362">**Terms and conditions**:</span></span>  
    <span data-ttu-id="7b578-363">Lisez et acceptez les conditions juridiques.</span><span class="sxs-lookup"><span data-stu-id="7b578-363">Review and accept the legal terms.</span></span>

4.  <span data-ttu-id="7b578-364">Sélectionnez **Achat**.</span><span class="sxs-lookup"><span data-stu-id="7b578-364">Select **Purchase**.</span></span>

#### <a name="install-the-vm-agent-linux-only"></a><span data-ttu-id="7b578-365">Installer l’agent de machine virtuelle (Linux uniquement)</span><span class="sxs-lookup"><span data-stu-id="7b578-365">Install the VM Agent (Linux only)</span></span>
<span data-ttu-id="7b578-366">Pour utiliser les modèles décrits dans la section précédente, l’agent Linux doit déjà être installé sur l’image de l’utilisateur. Dans le cas contraire, le déploiement échoue.</span><span class="sxs-lookup"><span data-stu-id="7b578-366">To use the templates described in the preceding section, the Linux Agent must already be installed in the user image, or the deployment will fail.</span></span> <span data-ttu-id="7b578-367">Téléchargez et installez l’agent de machine virtuelle sur l’image utilisateur, comme décrit dans [Télécharger, installer et activer l’agent de machine virtuelle Azure][deployment-guide-4.4].</span><span class="sxs-lookup"><span data-stu-id="7b578-367">Download and install the VM Agent in the user image as described in [Download, install, and enable the Azure VM Agent][deployment-guide-4.4].</span></span> <span data-ttu-id="7b578-368">Si vous n’utilisez pas les modèles, vous pouvez également installer l’agent de machine virtuelle plus tard.</span><span class="sxs-lookup"><span data-stu-id="7b578-368">If you don’t use the templates, you also can install the VM Agent later.</span></span>

#### <a name="join-a-domain-windows-only"></a><span data-ttu-id="7b578-369">Joindre un domaine (Windows uniquement)</span><span class="sxs-lookup"><span data-stu-id="7b578-369">Join a domain (Windows only)</span></span>
<span data-ttu-id="7b578-370">Si votre déploiement Azure est connecté à une instance Active Directory ou DNS locale via une connexion VPN de site à site Azure ou via Azure ExpressRoute (connexion *intersite* dans [Planification et implémentation de Machines virtuelles Azure pour SAP sur Linux][planning-guide]), la machine virtuelle doit être jointe à un domaine local.</span><span class="sxs-lookup"><span data-stu-id="7b578-370">If your Azure deployment is connected to an on-premises Active Directory or DNS instance via an Azure site-to-site VPN connection or Azure ExpressRoute (this is called *cross-premises* in [Azure Virtual Machines planning and implementation for SAP on Linux][planning-guide]), it is expected that the VM is joining an on-premises domain.</span></span> <span data-ttu-id="7b578-371">Pour plus d’informations sur les éléments à prendre en compte pour cette étape, consultez [Joindre une machine virtuelle à un domaine local (Windows uniquement)][deployment-guide-4.3].</span><span class="sxs-lookup"><span data-stu-id="7b578-371">For more information about considerations for this step, see [Join a VM to an on-premises domain (Windows only)][deployment-guide-4.3].</span></span>

#### <a name="configure-proxy-settings"></a><span data-ttu-id="7b578-372">Configuration des paramètres de proxy</span><span class="sxs-lookup"><span data-stu-id="7b578-372">Configure proxy settings</span></span>
<span data-ttu-id="7b578-373">Selon la configuration de votre réseau local, vous devrez peut-être configurer le proxy sur votre machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="7b578-373">Depending on how your on-premises network is configured, you might need to set up the proxy on your VM.</span></span> <span data-ttu-id="7b578-374">Si votre machine virtuelle est connectée à votre réseau local via VPN ou ExpressRoute, la machine virtuelle ne sera pas peut-être pas en mesure d’accéder à Internet et de télécharger les extensions nécessaires ou de collecter des données d’analyse.</span><span class="sxs-lookup"><span data-stu-id="7b578-374">If your VM is connected to your on-premises network via VPN or ExpressRoute, the VM might not be able to access the Internet, and won't be able to download the required extensions or collect monitoring data.</span></span> <span data-ttu-id="7b578-375">Pour plus d’informations, voir [Configuration du proxy][deployment-guide-configure-proxy].</span><span class="sxs-lookup"><span data-stu-id="7b578-375">For more information, see [Configure the proxy][deployment-guide-configure-proxy].</span></span>

#### <a name="configure-monitoring"></a><span data-ttu-id="7b578-376">Configuration de l’analyse</span><span class="sxs-lookup"><span data-stu-id="7b578-376">Configure monitoring</span></span>
<span data-ttu-id="7b578-377">Pour être sûr que votre environnement prenne en charge SAP, configurez l’extension d’analyse Azure pour SAP comme décrit dans [Configurer l’extension d’analyse Azure améliorée pour SAP][deployment-guide-4.5].</span><span class="sxs-lookup"><span data-stu-id="7b578-377">To be sure your environment supports SAP, set up the Azure Monitoring Extension for SAP as described in [Configure the Azure Enhanced Monitoring Extension for SAP][deployment-guide-4.5].</span></span> <span data-ttu-id="7b578-378">Vérifiez la configuration requise pour l’analyse SAP pour connaître les versions minimales requises pour le noyau SAP et l’agent hôte SAP dans les ressources répertoriées dans [Ressources SAP][deployment-guide-2.2].</span><span class="sxs-lookup"><span data-stu-id="7b578-378">Check the prerequisites for SAP monitoring, and required minimum versions of SAP Kernel and SAP Host Agent, in the resources listed in [SAP resources][deployment-guide-2.2].</span></span>

#### <a name="monitoring-check"></a><span data-ttu-id="7b578-379">Vérification de l’analyse</span><span class="sxs-lookup"><span data-stu-id="7b578-379">Monitoring check</span></span>
<span data-ttu-id="7b578-380">Vérifiez si l’analyse fonctionne comme décrit dans [Vérifications et résolution des problèmes pour la configuration de l’analyse de bout en bout][deployment-guide-troubleshooting-chapter].</span><span class="sxs-lookup"><span data-stu-id="7b578-380">Check whether monitoring is working, as described in [Checks and troubleshooting for setting up end-to-end monitoring][deployment-guide-troubleshooting-chapter].</span></span>




### <span data-ttu-id="7b578-381"><a name="a9a60133-a763-4de8-8986-ac0fa33aa8c1"></a>Scénario 3 : Déplacement d’une machine virtuelle locale à l’aide d’un disque dur virtuel Azure non généralisé avec SAP</span><span class="sxs-lookup"><span data-stu-id="7b578-381"><a name="a9a60133-a763-4de8-8986-ac0fa33aa8c1"></a>Scenario 3: Moving an on-premises VM by using a non-generalized Azure VHD with SAP</span></span>
<span data-ttu-id="7b578-382">Dans ce scénario, vous souhaitez déplacer un système SAP spécifique d’un environnement local vers Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-382">In this scenario, you plan to move a specific SAP system from an on-premises environment to Azure.</span></span> <span data-ttu-id="7b578-383">Pour ce faire, vous pouvez charger le disque dur virtuel qui contient le système d’exploitation, les fichiers binaires SAP et les éventuels fichiers binaires du SGBD, ainsi que les disques durs virtuels contenant les fichiers de données et les fichiers journaux du SGBD vers Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-383">You can do this by uploading the VHD that has the OS, the SAP binaries, and eventually the DBMS binaries, plus the VHDs with the data and log files of the DBMS, to Azure.</span></span> <span data-ttu-id="7b578-384">Contrairement au scénario décrit dans [Scénario 2 : Déploiement d’une machine virtuelle avec une image personnalisée pour SAP][deployment-guide-3.3], dans le cas présent, vous conservez le nom d’hôte, le SID SAP et les comptes d’utilisateur SAP dans la machine virtuelle Azure, dans la mesure où ils ont été configurés dans l’environnement local.</span><span class="sxs-lookup"><span data-stu-id="7b578-384">Unlike the scenario described in [Scenario 2: Deploying a VM with a custom image for SAP][deployment-guide-3.3], in this case, you keep the hostname, SAP SID, and SAP user accounts in the Azure VM, because they were configured in the on-premises environment.</span></span> <span data-ttu-id="7b578-385">Il est inutile de généraliser le système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="7b578-385">You do not need to generalize the OS.</span></span> <span data-ttu-id="7b578-386">Ce scénario s’applique généralement aux scénarios intersites où une partie du paysage SAP s’exécute en local et une autre partie sur Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-386">This scenario applies most often to cross-premises scenarios where part of the SAP landscape runs on-premises and part of it runs on Azure.</span></span>

<span data-ttu-id="7b578-387">Dans ce scénario, l’agent de machine virtuelle n’est pas installé automatiquement lors du déploiement.</span><span class="sxs-lookup"><span data-stu-id="7b578-387">In this scenario, the VM Agent is not automatically installed during deployment.</span></span> <span data-ttu-id="7b578-388">Dans la mesure où l’agent de machine virtuelle et l’extension d’analyse Azure améliorée pour SAP sont nécessaires pour l’exécution de SAP, vous devez télécharger, installer et activer ces deux composants manuellement après avoir créé la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="7b578-388">Because the VM Agent and the Azure Enhanced Monitoring Extension for SAP required for to run SAP, you need to download, install, and enable both components manually after you create the virtual machine.</span></span>

<span data-ttu-id="7b578-389">Pour plus d’informations sur l’agent de machine virtuelle Azure, consultez les ressources suivantes.</span><span class="sxs-lookup"><span data-stu-id="7b578-389">For more information about the Azure VM Agent, see the following resources.</span></span>

<span data-ttu-id="7b578-390">[comment]: <> (MSSedusch TODO Update Windows Link below)</span><span class="sxs-lookup"><span data-stu-id="7b578-390">[comment]: <> (MSSedusch TODO Update Windows Link below)</span></span>

- - -
> ![Windows][Logo_Windows] <span data-ttu-id="7b578-392">Windows</span><span class="sxs-lookup"><span data-stu-id="7b578-392">Windows</span></span>
>
> <span data-ttu-id="7b578-393"><http://blogs.msdn.com/b/wats/archive/2014/02/17/bginfo-guest-agent-extension-for-azure-vms.aspx></span><span class="sxs-lookup"><span data-stu-id="7b578-393"><http://blogs.msdn.com/b/wats/archive/2014/02/17/bginfo-guest-agent-extension-for-azure-vms.aspx></span></span>
>
> ![Linux][Logo_Linux] <span data-ttu-id="7b578-395">Linux</span><span class="sxs-lookup"><span data-stu-id="7b578-395">Linux</span></span>
>
> <span data-ttu-id="7b578-396">[Guide d'utilisateur de l'agent Linux Azure][virtual-machines-linux-agent-user-guide]</span><span class="sxs-lookup"><span data-stu-id="7b578-396">[Azure Linux Agent User Guide][virtual-machines-linux-agent-user-guide]</span></span>
>
>

- - -

<span data-ttu-id="7b578-397">L’organigramme suivant présente la séquence d’étapes permettant de déplacer une machine virtuelle locale à l’aide d’un disque dur virtuel Azure non généralisé :</span><span class="sxs-lookup"><span data-stu-id="7b578-397">The following flowchart shows the sequence of steps for moving an on-premises VM by using a non-generalized Azure VHD:</span></span>

![Organigramme d’un déploiement de machine virtuelle pour les systèmes SAP à l’aide d’un disque de machine virtuelle][deployment-guide-figure-400]

<span data-ttu-id="7b578-399">En supposant que le disque est déjà chargé et défini dans Azure (voir [Planification et implémentation de Machines virtuelles Azure pour SAP sur Linux][planning-guide]), effectuez les tâches décrites dans les sections suivantes.</span><span class="sxs-lookup"><span data-stu-id="7b578-399">Assuming that the disk is already uploaded and defined in Azure (see [Azure Virtual Machines planning and implementation for SAP on Linux][planning-guide]), do the tasks described in the next few sections.</span></span>

#### <a name="create-a-virtual-machine"></a><span data-ttu-id="7b578-400">Création d'une machine virtuelle</span><span class="sxs-lookup"><span data-stu-id="7b578-400">Create a virtual machine</span></span>
<span data-ttu-id="7b578-401">Pour créer un déploiement à l’aide d’un disque privé de système d’exploitation par l’intermédiaire du portail Azure, utilisez le modèle SAP publié dans le [référentiel GitHub azure-quickstart-templates][azure-quickstart-templates-github].</span><span class="sxs-lookup"><span data-stu-id="7b578-401">To create a deployment by using a private OS disk through the Azure portal, use the SAP template published in the [azure-quickstart-templates GitHub repository][azure-quickstart-templates-github].</span></span> <span data-ttu-id="7b578-402">Vous pouvez également créer une machine virtuelle manuellement à l’aide de PowerShell.</span><span class="sxs-lookup"><span data-stu-id="7b578-402">You also can manually create a virtual machine, by using PowerShell.</span></span>

* <span data-ttu-id="7b578-403">[**Modèle de configuration à deux niveaux (une seule machine virtuelle)** (sap-2-tier-user-disk)][sap-templates-2-tier-os-disk]</span><span class="sxs-lookup"><span data-stu-id="7b578-403">[**Two-tier configuration (only one virtual machine) template** (sap-2-tier-user-disk)][sap-templates-2-tier-os-disk]</span></span>

  <span data-ttu-id="7b578-404">Pour créer un système à deux niveaux avec une seule machine virtuelle, utilisez ce modèle.</span><span class="sxs-lookup"><span data-stu-id="7b578-404">To create a two-tier system by using only one virtual machine, use this template.</span></span>

<span data-ttu-id="7b578-405">Dans le portail Azure, entrez les paramètres suivants pour le modèle :</span><span class="sxs-lookup"><span data-stu-id="7b578-405">In the Azure portal, enter the following parameters for the template:</span></span>

1. <span data-ttu-id="7b578-406">**Paramètres de base**:</span><span class="sxs-lookup"><span data-stu-id="7b578-406">**Basics**:</span></span>
  * <span data-ttu-id="7b578-407">**Abonnement** : l’abonnement à utiliser pour déployer le modèle.</span><span class="sxs-lookup"><span data-stu-id="7b578-407">**Subscription**: The subscription to use to deploy the template.</span></span>
  * <span data-ttu-id="7b578-408">**Groupe de ressources** : le groupe de ressources à utiliser pour déployer le modèle.</span><span class="sxs-lookup"><span data-stu-id="7b578-408">**Resource group**: The resource group to use to deploy the template.</span></span> <span data-ttu-id="7b578-409">Vous pouvez créer un groupe de ressources ou sélectionner un groupe de ressources existant dans l’abonnement.</span><span class="sxs-lookup"><span data-stu-id="7b578-409">You can create a new resource group or select an existing resource group in the subscription.</span></span>
  * <span data-ttu-id="7b578-410">**Emplacement** : emplacement où déployer le modèle.</span><span class="sxs-lookup"><span data-stu-id="7b578-410">**Location**: Where to deploy the template.</span></span> <span data-ttu-id="7b578-411">Si vous avez sélectionné un groupe de ressources existant, l’emplacement du groupe de ressources est utilisé.</span><span class="sxs-lookup"><span data-stu-id="7b578-411">If you selected an existing resource group, the location of that resource group is used.</span></span>
2. <span data-ttu-id="7b578-412">**Paramètres**:</span><span class="sxs-lookup"><span data-stu-id="7b578-412">**Settings**:</span></span>
  * <span data-ttu-id="7b578-413">**SAP System ID** : identifiant du système SAP.</span><span class="sxs-lookup"><span data-stu-id="7b578-413">**SAP System ID**: The SAP System ID.</span></span>
  * <span data-ttu-id="7b578-414">**Type de système d’exploitation** : type de système d’exploitation à déployer (Windows ou Linux).</span><span class="sxs-lookup"><span data-stu-id="7b578-414">**OS type**: The operating system type you want to deploy (Windows or Linux).</span></span>
  * <span data-ttu-id="7b578-415">**Taille du système SAP** : taille du système SAP.</span><span class="sxs-lookup"><span data-stu-id="7b578-415">**SAP system size**: The size of the SAP system.</span></span>

    <span data-ttu-id="7b578-416">Le nombre de SAP fournis par le nouveau système.</span><span class="sxs-lookup"><span data-stu-id="7b578-416">The number of SAPS the new system provides.</span></span> <span data-ttu-id="7b578-417">Si vous ne savez pas combien de SAP sont requis par le système, demandez à votre partenaire technologique SAP ou un intégrateur système.</span><span class="sxs-lookup"><span data-stu-id="7b578-417">If you are not sure how many SAPS the system requires, ask your SAP Technology Partner or System Integrator.</span></span>
  * <span data-ttu-id="7b578-418">**Type de stockage** (modèle à deux niveaux uniquement) : type de stockage à utiliser.</span><span class="sxs-lookup"><span data-stu-id="7b578-418">**Storage type** (two-tier template only): The type of storage to use.</span></span>

    <span data-ttu-id="7b578-419">Pour les grands systèmes, nous vous recommandons l’utilisation du stockage Premium Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-419">For larger systems, we highly recommend using Azure Premium Storage.</span></span> <span data-ttu-id="7b578-420">Pour plus d’informations sur les types de stockage, consultez les ressources suivantes :</span><span class="sxs-lookup"><span data-stu-id="7b578-420">For more information about storage types, see the following resources:</span></span>
      * <span data-ttu-id="7b578-421">[Utilisation du stockage SSD Azure Premium pour l’instance de SGBD SAP][2367194]</span><span class="sxs-lookup"><span data-stu-id="7b578-421">[Use of Azure Premium SSD Storage for SAP DBMS Instance][2367194]</span></span>
      * <span data-ttu-id="7b578-422">[Stockage Microsoft Azure][dbms-guide-2.3] dans [Déploiement SGBD de Machines virtuelles Azure pour SAP sur Linux][dbms-guide]</span><span class="sxs-lookup"><span data-stu-id="7b578-422">[Microsoft Azure Storage][dbms-guide-2.3] in [Azure Virtual Machine DBMS deployment for SAP on Linux][dbms-guide]</span></span>
      * <span data-ttu-id="7b578-423">[Stockage Premium : stockage hautes performances pour les charges de travail des machines virtuelles Azure][storage-premium-storage-preview-portal]</span><span class="sxs-lookup"><span data-stu-id="7b578-423">[Premium Storage: High-performance storage for Azure Virtual Machine workloads][storage-premium-storage-preview-portal]</span></span>
      * <span data-ttu-id="7b578-424">[Présentation du stockage Microsoft Azure][storage-introduction]</span><span class="sxs-lookup"><span data-stu-id="7b578-424">[Introduction to Microsoft Azure Storage][storage-introduction]</span></span>
  * <span data-ttu-id="7b578-425">**URI du disque dur virtuel du disque du système d’exploitation** : URI du disque privé du système d’exploitation, par exemple https://&lt;nom du compte>.blob.core.windows.net/vhds/osdisk.vhd.</span><span class="sxs-lookup"><span data-stu-id="7b578-425">**OS disk VHD URI**: The URI of the private OS disk, for example, https://&lt;accountname>.blob.core.windows.net/vhds/osdisk.vhd.</span></span>
  * <span data-ttu-id="7b578-426">**Sous-réseau nouveau ou existant** : détermine si un réseau virtuel et un sous-réseau doivent être créés ou si un sous-réseau existant doit être utilisé.</span><span class="sxs-lookup"><span data-stu-id="7b578-426">**New or existing subnet**: Determines whether a new virtual network and subnet are created, or an existing subnet is used.</span></span> <span data-ttu-id="7b578-427">Si vous disposez déjà d’un réseau virtuel connecté à votre réseau local, sélectionnez **Existant**.</span><span class="sxs-lookup"><span data-stu-id="7b578-427">If you already have a virtual network that is connected to your on-premises network, select **Existing**.</span></span>
  * <span data-ttu-id="7b578-428">**ID du sous-réseau** : identifiant du sous-réseau auquel les machines virtuelles seront connectées.</span><span class="sxs-lookup"><span data-stu-id="7b578-428">**Subnet ID**: The ID of the subnet to which the virtual machines will connect to.</span></span> <span data-ttu-id="7b578-429">Sélectionnez le sous-réseau de votre VPN ou réseau virtuel Azure ExpressRoute à utiliser pour connecter la machine virtuelle à votre réseau local.</span><span class="sxs-lookup"><span data-stu-id="7b578-429">Select the subnet of your VPN or Azure ExpressRoute virtual network to use to connect the virtual machine to your on-premises network.</span></span> <span data-ttu-id="7b578-430">L'ID ressemble généralement à ceci :</span><span class="sxs-lookup"><span data-stu-id="7b578-430">The ID usually looks like this:</span></span>

    <span data-ttu-id="7b578-431">/subscriptions/&lt;id d’abonnement>/resourceGroups/&lt;nom du groupe de ressources>/providers/Microsoft.Network/virtualNetworks/&lt;nom du réseau virtuel>/subnets/&lt;nom du sous-réseau></span><span class="sxs-lookup"><span data-stu-id="7b578-431">/subscriptions/&lt;subscription id>/resourceGroups/&lt;resource group name>/providers/Microsoft.Network/virtualNetworks/&lt;virtual network name>/subnets/&lt;subnet name></span></span>

3. <span data-ttu-id="7b578-432">**Conditions générales** :</span><span class="sxs-lookup"><span data-stu-id="7b578-432">**Terms and conditions**:</span></span>  
    <span data-ttu-id="7b578-433">Lisez et acceptez les conditions juridiques.</span><span class="sxs-lookup"><span data-stu-id="7b578-433">Review and accept the legal terms.</span></span>

4.  <span data-ttu-id="7b578-434">Sélectionnez **Achat**.</span><span class="sxs-lookup"><span data-stu-id="7b578-434">Select **Purchase**.</span></span>

#### <a name="install-the-vm-agent"></a><span data-ttu-id="7b578-435">Installer l'agent de machine virtuelle</span><span class="sxs-lookup"><span data-stu-id="7b578-435">Install the VM Agent</span></span>
<span data-ttu-id="7b578-436">Pour utiliser les modèles décrits dans la section précédente, l’agent de machine virtuelle doit être installé sur le disque du système d’exploitation. Dans le cas contraire, le déploiement échoue.</span><span class="sxs-lookup"><span data-stu-id="7b578-436">To use the templates described in the preceding section, the VM Agent must be installed on the OS disk, or the deployment will fail.</span></span> <span data-ttu-id="7b578-437">Téléchargez et installez l’agent de machine virtuelle sur la machine virtuelle, comme décrit dans [Télécharger, installer et activer l’agent de machine virtuelle Azure][deployment-guide-4.4].</span><span class="sxs-lookup"><span data-stu-id="7b578-437">Download and install the VM Agent in the VM, as described in [Download, install, and enable the Azure VM Agent][deployment-guide-4.4].</span></span>

<span data-ttu-id="7b578-438">Si vous n’utilisez pas les modèles décrits dans la section précédente, vous pouvez également installer l’agent de machine virtuelle plus tard.</span><span class="sxs-lookup"><span data-stu-id="7b578-438">If you don’t use the templates described in the preceding section, you can also install the VM Agent afterwards.</span></span>

#### <a name="join-a-domain-windows-only"></a><span data-ttu-id="7b578-439">Joindre un domaine (Windows uniquement)</span><span class="sxs-lookup"><span data-stu-id="7b578-439">Join a domain (Windows only)</span></span>
<span data-ttu-id="7b578-440">Si votre déploiement Azure est connecté à une instance Active Directory ou DNS locale via une connexion VPN de site à site Azure ou via ExpressRoute (connexion *intersite* dans [Planification et implémentation de Machines virtuelles Azure pour SAP sur Linux][planning-guide]), la machine virtuelle doit être jointe à un domaine local.</span><span class="sxs-lookup"><span data-stu-id="7b578-440">If your Azure deployment is connected to an on-premises Active Directory or DNS instance via an Azure site-to-site VPN connection or ExpressRoute (this is called *cross-premises* in [Azure Virtual Machines planning and implementation for SAP on Linux][planning-guide]), it is expected that the VM is joining an on-premises domain.</span></span> <span data-ttu-id="7b578-441">Pour plus d’informations sur les éléments à prendre en compte pour cette tâche, consultez [Joindre une machine virtuelle à un domaine local (Windows uniquement)][deployment-guide-4.3].</span><span class="sxs-lookup"><span data-stu-id="7b578-441">For more information about considerations for this task, see [Join a VM to an on-premises domain (Windows only)][deployment-guide-4.3].</span></span>

#### <a name="configure-proxy-settings"></a><span data-ttu-id="7b578-442">Configuration des paramètres de proxy</span><span class="sxs-lookup"><span data-stu-id="7b578-442">Configure proxy settings</span></span>
<span data-ttu-id="7b578-443">Selon la configuration de votre réseau local, vous devrez peut-être configurer le proxy sur votre machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="7b578-443">Depending on how your on-premises network is configured, you might need to set up the proxy on your VM.</span></span> <span data-ttu-id="7b578-444">Si votre machine virtuelle est connectée à votre réseau local via VPN ou ExpressRoute, la machine virtuelle ne sera pas peut-être pas en mesure d’accéder à Internet et de télécharger les extensions nécessaires ou de collecter des données d’analyse.</span><span class="sxs-lookup"><span data-stu-id="7b578-444">If your VM is connected to your on-premises network via VPN or ExpressRoute, the VM might not be able to access the Internet, and won't be able to download the required extensions or collect monitoring data.</span></span> <span data-ttu-id="7b578-445">Pour plus d’informations, voir [Configuration du proxy][deployment-guide-configure-proxy].</span><span class="sxs-lookup"><span data-stu-id="7b578-445">For more information, see [Configure the proxy][deployment-guide-configure-proxy].</span></span>

#### <a name="configure-monitoring"></a><span data-ttu-id="7b578-446">Configuration de l’analyse</span><span class="sxs-lookup"><span data-stu-id="7b578-446">Configure monitoring</span></span>
<span data-ttu-id="7b578-447">Pour être sûr que votre environnement prenne en charge SAP, configurez l’extension d’analyse Azure pour SAP comme décrit dans [Configurer l’extension d’analyse Azure améliorée pour SAP][deployment-guide-4.5].</span><span class="sxs-lookup"><span data-stu-id="7b578-447">To be sure your environment supports SAP, set up the Azure Monitoring Extension for SAP as described in [Configure the Azure Enhanced Monitoring Extension for SAP][deployment-guide-4.5].</span></span> <span data-ttu-id="7b578-448">Vérifiez la configuration requise pour l’analyse SAP pour connaître les versions minimales requises pour le noyau SAP et l’agent hôte SAP dans les ressources répertoriées dans [Ressources SAP][deployment-guide-2.2].</span><span class="sxs-lookup"><span data-stu-id="7b578-448">Check the prerequisites for SAP monitoring, and required minimum versions of SAP Kernel and SAP Host Agent, in the resources listed in [SAP resources][deployment-guide-2.2].</span></span>

#### <a name="monitoring-check"></a><span data-ttu-id="7b578-449">Vérification de l’analyse</span><span class="sxs-lookup"><span data-stu-id="7b578-449">Monitoring check</span></span>
<span data-ttu-id="7b578-450">Vérifiez si l’analyse fonctionne comme décrit dans [Vérifications et résolution des problèmes pour la configuration de l’analyse de bout en bout][deployment-guide-troubleshooting-chapter].</span><span class="sxs-lookup"><span data-stu-id="7b578-450">Check whether monitoring is working, as described in [Checks and troubleshooting for setting up end-to-end monitoring][deployment-guide-troubleshooting-chapter].</span></span>

## <a name="update-the-monitoring-configuration-for-sap"></a><span data-ttu-id="7b578-451">Mise à jour de la configuration de l’analyse pour SAP</span><span class="sxs-lookup"><span data-stu-id="7b578-451">Update the monitoring configuration for SAP</span></span>
<span data-ttu-id="7b578-452">Mettez à jour la configuration de l’analyse SAP selon l’un des scénarios suivants :</span><span class="sxs-lookup"><span data-stu-id="7b578-452">Update the SAP monitoring configuration in any of the following scenarios:</span></span>
* <span data-ttu-id="7b578-453">L’équipe Microsoft/SAP a étendu les capacités d’analyse et a décidé d’ajouter ou de supprimer des compteurs.</span><span class="sxs-lookup"><span data-stu-id="7b578-453">The joint Microsoft/SAP team extends the monitoring capabilities and requests more or fewer counters.</span></span>
* <span data-ttu-id="7b578-454">Microsoft introduit une nouvelle version de l’infrastructure Azure sous-jacente qui génère les données d’analyse, et l’extension d’analyse Azure améliorée pour SAP doit s’adapter à ces modifications.</span><span class="sxs-lookup"><span data-stu-id="7b578-454">Microsoft introduces a new version of the underlying Azure infrastructure that delivers the monitoring data, and the Azure Enhanced Monitoring Extension for SAP needs to be adapted to those changes.</span></span>
* <span data-ttu-id="7b578-455">Vous montez des disques durs virtuels supplémentaires sur votre machine virtuelle Azure ou vous supprimez un disque dur virtuel.</span><span class="sxs-lookup"><span data-stu-id="7b578-455">You mount additional VHDs to your Azure VM or you remove a VHD.</span></span> <span data-ttu-id="7b578-456">Dans ce scénario, mettez à jour la collection de données liées au stockage.</span><span class="sxs-lookup"><span data-stu-id="7b578-456">In this scenario, update the collection of storage-related data.</span></span> <span data-ttu-id="7b578-457">L’ajout ou la suppression de points de terminaison, ou l’affectation d’adresses IP à une machine virtuelle n’affecte pas la configuration de l’analyse.</span><span class="sxs-lookup"><span data-stu-id="7b578-457">Changing your configuration by adding or deleting endpoints or by assigning IP addresses to a VM does not affect the monitoring configuration.</span></span>
* <span data-ttu-id="7b578-458">Vous modifiez la taille de votre machine virtuelle Azure, par exemple en passant de la taille A5 à une autre taille de machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="7b578-458">You change the size of your Azure VM, for example, from size A5 to any other VM size.</span></span>
* <span data-ttu-id="7b578-459">Vous ajoutez de nouvelles interfaces de réseau à votre machine virtuelle Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-459">You add new network interfaces to your Azure VM.</span></span>

<span data-ttu-id="7b578-460">Pour mettre à jour les paramètres d’analyse, mettez à jour l’infrastructure d’analyse en suivant les étapes décrites dans [Configurer l’extension d’analyse Azure améliorée pour SAP][deployment-guide-4.5].</span><span class="sxs-lookup"><span data-stu-id="7b578-460">To update monitoring settings, update the monitoring infrastructure by following the steps in [Configure the Azure Enhanced Monitoring Extension for SAP][deployment-guide-4.5].</span></span>

## <a name="detailed-tasks-for-sap-software-deployment-on-a-windows-vm"></a><span data-ttu-id="7b578-461">Détail des tâches pour le déploiement de logiciels SAP sur une machine virtuelle Windows</span><span class="sxs-lookup"><span data-stu-id="7b578-461">Detailed tasks for SAP software deployment on a Windows VM</span></span>
<span data-ttu-id="7b578-462">Cette section détaille les étapes permettant d’effectuer des tâches spécifiques lors du processus de configuration et de déploiement.</span><span class="sxs-lookup"><span data-stu-id="7b578-462">This section has detailed steps for doing specific tasks in the configuration and deployment process.</span></span>

### <span data-ttu-id="7b578-463"><a name="604bcec2-8b6e-48d2-a944-61b0f5dee2f7"></a>Déploiement d’applets de commande Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="7b578-463"><a name="604bcec2-8b6e-48d2-a944-61b0f5dee2f7"></a>Deploy Azure PowerShell cmdlets</span></span>
1.  <span data-ttu-id="7b578-464">Accédez à [Téléchargements Microsoft Azure](https://azure.microsoft.com/downloads/).</span><span class="sxs-lookup"><span data-stu-id="7b578-464">Go to [Microsoft Azure Downloads](https://azure.microsoft.com/downloads/).</span></span>
2.  <span data-ttu-id="7b578-465">Sous **Outils de ligne de commande**, sous **PowerShell**, sélectionnez **Installation Windows**.</span><span class="sxs-lookup"><span data-stu-id="7b578-465">Under **Command-line tools**, under **PowerShell**, select **Windows install**.</span></span>
3.  <span data-ttu-id="7b578-466">Dans la boîte de dialogue Gestionnaire de téléchargement Microsoft, pour le fichier téléchargé (par exemple, WindowsAzurePowershellGet.3f.3f.3fnew.exe), sélectionnez **Exécuter**.</span><span class="sxs-lookup"><span data-stu-id="7b578-466">In the Microsoft Download Manager dialog box, for the downloaded file (for example, WindowsAzurePowershellGet.3f.3f.3fnew.exe), select **Run**.</span></span>
4.  <span data-ttu-id="7b578-467">Pour exécuter Microsoft Web Platform Installer (Microsoft Web PI), sélectionnez **Oui**.</span><span class="sxs-lookup"><span data-stu-id="7b578-467">To run Microsoft Web Platform Installer (Microsoft Web PI), select **Yes**.</span></span>
5.  <span data-ttu-id="7b578-468">Une page ressemblant à ceci s’affiche :</span><span class="sxs-lookup"><span data-stu-id="7b578-468">A page that looks like this appears:</span></span>

  <span data-ttu-id="7b578-469">![Page d’installation pour les applets de commande Azure PowerShell][deployment-guide-figure-500]<a name="figure-5"></a></span><span class="sxs-lookup"><span data-stu-id="7b578-469">![Installation page for Azure PowerShell cmdlets][deployment-guide-figure-500]<a name="figure-5"></a></span></span>

6.  <span data-ttu-id="7b578-470">Sélectionnez **Installer**, puis acceptez les termes du contrat de licence du logiciel Microsoft.</span><span class="sxs-lookup"><span data-stu-id="7b578-470">Select **Install**, and then accept the Microsoft Software License Terms.</span></span>
7.  <span data-ttu-id="7b578-471">Powershell est installé.</span><span class="sxs-lookup"><span data-stu-id="7b578-471">PowerShell is installed.</span></span> <span data-ttu-id="7b578-472">Sélectionnez **Terminer** pour fermer l’assistant d’installation.</span><span class="sxs-lookup"><span data-stu-id="7b578-472">Select **Finish** to close the installation wizard.</span></span>

<span data-ttu-id="7b578-473">Recherchez régulièrement les mises à jour des applets de commande PowerShell, qui sont généralement publiées une fois par mois.</span><span class="sxs-lookup"><span data-stu-id="7b578-473">Check frequently for updates to the PowerShell cmdlets, which usually are updated monthly.</span></span> <span data-ttu-id="7b578-474">Pour rechercher les mises à jour, le plus simple consiste à effectuer les étapes d’installation précédentes jusqu’à la page d’installation représentée à l’étape 5.</span><span class="sxs-lookup"><span data-stu-id="7b578-474">The easiest way to check for updates is to do the preceding installation steps, up to the installation page shown in step 5.</span></span> <span data-ttu-id="7b578-475">La date de publication et le numéro de version des applets de commande sont inclus sur la page représentée à l’étape 5.</span><span class="sxs-lookup"><span data-stu-id="7b578-475">The release date and release number of the cmdlets are included on the page shown in step 5.</span></span> <span data-ttu-id="7b578-476">Sauf indication contraire dans les notes SAP [1928533] ou [2015553], nous vous recommandons d’utiliser la dernière version des applets de commande Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="7b578-476">Unless stated otherwise in SAP Note [1928533] or SAP Note [2015553], we recommend that you work with the latest version of Azure PowerShell cmdlets.</span></span>

<span data-ttu-id="7b578-477">Pour vérifier la version des applets de commande Azure PowerShell installées sur votre ordinateur, exécutez cette commande PowerShell :</span><span class="sxs-lookup"><span data-stu-id="7b578-477">To check the version of the Azure PowerShell cmdlets that are installed on your computer, run this PowerShell command:</span></span>
```powershell
Import-Module Azure
(Get-Module Azure).Version
```
<span data-ttu-id="7b578-478">Le résultat ressemble à :</span><span class="sxs-lookup"><span data-stu-id="7b578-478">The result looks like this:</span></span>

<span data-ttu-id="7b578-479">![Résultat du contrôle de version de l’applet de commande Azure PowerShell][deployment-guide-figure-600]
<a name="figure-6"></a></span><span class="sxs-lookup"><span data-stu-id="7b578-479">![Result of Azure PowerShell cmdlet version check][deployment-guide-figure-600]
<a name="figure-6"></a></span></span>

<span data-ttu-id="7b578-480">Si la version de l’applet de commande Azure installée sur votre ordinateur est la version la plus récente, la première page de l’assistant d’installation l’indique en ajoutant **(Installé)** au titre du produit (voir la capture d’écran suivante).</span><span class="sxs-lookup"><span data-stu-id="7b578-480">If the Azure cmdlet version installed on your computer is the current version, the first page of the installation wizard indicates it by adding **(Installed)** to the product title (see the following screenshot).</span></span> <span data-ttu-id="7b578-481">Vos applets de commande Azure PowerShell sont à jour.</span><span class="sxs-lookup"><span data-stu-id="7b578-481">Your PowerShell Azure cmdlets are up-to-date.</span></span> <span data-ttu-id="7b578-482">Pour fermer l’assistant d’installation, sélectionnez **Quitter**.</span><span class="sxs-lookup"><span data-stu-id="7b578-482">To close the installation wizard, select **Exit**.</span></span>

<span data-ttu-id="7b578-483">![Page d’installation pour les applets de commande Azure PowerShell indiquant que la version la plus récente des applets de commande Azure PowerShell est installée][deployment-guide-figure-700]
<a name="figure-7"></a></span><span class="sxs-lookup"><span data-stu-id="7b578-483">![Installation page for Azure PowerShell cmdlets indicating that the most recent version of Azure PowerShell cmdlets are installed][deployment-guide-figure-700]
<a name="figure-7"></a></span></span>

### <span data-ttu-id="7b578-484"><a name="1ded9453-1330-442a-86ea-e0fd8ae8cab3"></a>Déploiement de l’interface de ligne de commande Azure</span><span class="sxs-lookup"><span data-stu-id="7b578-484"><a name="1ded9453-1330-442a-86ea-e0fd8ae8cab3"></a>Deploy Azure CLI</span></span>
1.  <span data-ttu-id="7b578-485">Accédez à [Téléchargements Microsoft Azure](https://azure.microsoft.com/downloads/).</span><span class="sxs-lookup"><span data-stu-id="7b578-485">Go to [Microsoft Azure Downloads](https://azure.microsoft.com/downloads/).</span></span>
2.  <span data-ttu-id="7b578-486">Sous **Outils de ligne de commande**, sous **Interface de ligne de commande Azure**, sélectionnez le lien **Installer** correspondant à votre système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="7b578-486">Under **Command-line tools**, under **Azure command-line interface**, select the **Install** link for your operating system.</span></span>
3.  <span data-ttu-id="7b578-487">Dans la boîte de dialogue Gestionnaire de téléchargement Microsoft, pour le fichier téléchargé (par exemple, WindowsAzureXPlatCLI.3f.3f.3fnew.exe), sélectionnez **Exécuter**.</span><span class="sxs-lookup"><span data-stu-id="7b578-487">In the Microsoft Download Manager dialog box, for the downloaded file (for example, WindowsAzureXPlatCLI.3f.3f.3fnew.exe), select **Run**.</span></span>
4.  <span data-ttu-id="7b578-488">Pour exécuter Microsoft Web Platform Installer (Microsoft Web PI), sélectionnez **Oui**.</span><span class="sxs-lookup"><span data-stu-id="7b578-488">To run Microsoft Web Platform Installer (Microsoft Web PI), select **Yes**.</span></span>
5.  <span data-ttu-id="7b578-489">Une page ressemblant à ceci s’affiche :</span><span class="sxs-lookup"><span data-stu-id="7b578-489">A page that looks like this appears:</span></span>

  <span data-ttu-id="7b578-490">![Page d’installation pour les applets de commande Azure PowerShell][deployment-guide-figure-500]<a name="figure-5"></a></span><span class="sxs-lookup"><span data-stu-id="7b578-490">![Installation page for Azure PowerShell cmdlets][deployment-guide-figure-500]<a name="figure-5"></a></span></span>

6.  <span data-ttu-id="7b578-491">Sélectionnez **Installer**, puis acceptez les termes du contrat de licence du logiciel Microsoft.</span><span class="sxs-lookup"><span data-stu-id="7b578-491">Select **Install**, and then accept the Microsoft Software License Terms.</span></span>
7.  <span data-ttu-id="7b578-492">L’interface de ligne de commande Azure est installée.</span><span class="sxs-lookup"><span data-stu-id="7b578-492">Azure CLI is installed.</span></span> <span data-ttu-id="7b578-493">Sélectionnez **Terminer** pour fermer l’assistant d’installation.</span><span class="sxs-lookup"><span data-stu-id="7b578-493">Select **Finish** to close the installation wizard.</span></span>

<span data-ttu-id="7b578-494">Recherchez régulièrement les mises à jour de l’interface de ligne de commande Azure, qui sont généralement publiées une fois par mois.</span><span class="sxs-lookup"><span data-stu-id="7b578-494">Check frequently for updates to Azure CLI, which usually is updated monthly.</span></span> <span data-ttu-id="7b578-495">Pour rechercher les mises à jour, le plus simple consiste à effectuer les étapes d’installation précédentes jusqu’à la page d’installation représentée à l’étape 5.</span><span class="sxs-lookup"><span data-stu-id="7b578-495">The easiest way to check for updates is to do the preceding installation steps, up to the installation page shown in step 5.</span></span>


<span data-ttu-id="7b578-496">Pour vérifier la version de l’interface de ligne de commande Azure installée sur votre ordinateur, exécutez cette commande :</span><span class="sxs-lookup"><span data-stu-id="7b578-496">To check the version of Azure CLI that is installed on your computer, run this command:</span></span>
```
azure --version
```

<span data-ttu-id="7b578-497">Le résultat ressemble à :</span><span class="sxs-lookup"><span data-stu-id="7b578-497">The result looks like this:</span></span>

<span data-ttu-id="7b578-498">![Résultat du contrôle de la version de l’interface de ligne de commande Azure][deployment-guide-figure-760]
<a name="0ad010e6-f9b5-4c21-9c09-bb2e5efb3fda"></a></span><span class="sxs-lookup"><span data-stu-id="7b578-498">![Result of Azure CLI version check][deployment-guide-figure-760]
<a name="0ad010e6-f9b5-4c21-9c09-bb2e5efb3fda"></a></span></span>

### <span data-ttu-id="7b578-499"><a name="31d9ecd6-b136-4c73-b61e-da4a29bbc9cc"></a>Joindre une machine virtuelle à un domaine local (Windows uniquement)</span><span class="sxs-lookup"><span data-stu-id="7b578-499"><a name="31d9ecd6-b136-4c73-b61e-da4a29bbc9cc"></a>Join a VM to an on-premises domain (Windows only)</span></span>
<span data-ttu-id="7b578-500">Si vous déployez des machines virtuelles SAP dans le cadre d’un scénario intersite où les instances Active Directory et DNS locales sont étendues dans Azure, les machines virtuelles doivent être jointes à un domaine local.</span><span class="sxs-lookup"><span data-stu-id="7b578-500">If you deploy SAP VMs in a cross-premises scenario, where on-premises Active Directory and DNS are extended in Azure, it is expected that the VMs are joining an on-premises domain.</span></span> <span data-ttu-id="7b578-501">Les étapes détaillées de connexion d’une machine virtuelle à un domaine local et les logiciels supplémentaires requis pour les membres d’un domaine local dépendent du client.</span><span class="sxs-lookup"><span data-stu-id="7b578-501">The detailed steps you take to join a VM to an on-premises domain, and the additional software required to be a member of an on-premises domain, varies by customer.</span></span> <span data-ttu-id="7b578-502">Généralement, pour joindre une machine virtuelle à un domaine local, vous devez installer des logiciels supplémentaires, tels que des logiciels anti-programme malveillant et des logiciels de sauvegarde ou d’analyse.</span><span class="sxs-lookup"><span data-stu-id="7b578-502">Usually, to join a VM to an on-premises domain, you need to install additional software, like antimalware software, and backup or monitoring software.</span></span>

<span data-ttu-id="7b578-503">Dans ce scénario, vous devez également vous assurer que si les paramètres du proxy Internet sont forcés lorsqu’une machine virtuelle rejoint un domaine dans votre environnement, les paramètres de proxy du compte système local Windows (S-1-5-18) de la machine virtuelle invitée sont identiques.</span><span class="sxs-lookup"><span data-stu-id="7b578-503">In this scenario, you also need to make sure that if Internet proxy settings are forced when a VM joins a domain in your environment, the Windows Local System Account (S-1-5-18) in the Guest VM has the same proxy settings.</span></span> <span data-ttu-id="7b578-504">Le plus simple est d’imposer le proxy avec une stratégie de groupe de domaine qui s’applique aux systèmes du domaine.</span><span class="sxs-lookup"><span data-stu-id="7b578-504">The easiest option is to force the proxy by using a domain Group Policy, which applies to systems in the domain.</span></span>

### <span data-ttu-id="7b578-505"><a name="c7cbb0dc-52a4-49db-8e03-83e7edc2927d"></a>Télécharger, installer et activer l’agent de machine virtuelle Azure</span><span class="sxs-lookup"><span data-stu-id="7b578-505"><a name="c7cbb0dc-52a4-49db-8e03-83e7edc2927d"></a>Download, install, and enable the Azure VM Agent</span></span>
<span data-ttu-id="7b578-506">Pour les machines virtuelles qui sont déployées à partir d’une image du système d’exploitation non généralisée (par exemple, une image qui ne provient pas de l’outil de préparation du système Windows, ou sysprep), vous devez télécharger, installer et activer manuellement l’agent de machine virtuelle Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-506">For virtual machines that are deployed from an OS image that is not generalized (for example, an image that doesn't originate in the Windows System Preparation, or sysprep, tool), you need to manually download, install, and enable the Azure VM Agent.</span></span>

<span data-ttu-id="7b578-507">Si vous déployez une machine virtuelle à partir d’Azure Marketplace, cette étape n’est pas nécessaire.</span><span class="sxs-lookup"><span data-stu-id="7b578-507">If you deploy a VM from the Azure Marketplace, this step is not required.</span></span> <span data-ttu-id="7b578-508">Les images provenant d’Azure Marketplace disposent déjà de l’agent de machine virtuelle Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-508">Images from the Azure Marketplace already have the Azure VM Agent.</span></span>

#### <span data-ttu-id="7b578-509"><a name="b2db5c9a-a076-42c6-9835-16945868e866"></a>Windows</span><span class="sxs-lookup"><span data-stu-id="7b578-509"><a name="b2db5c9a-a076-42c6-9835-16945868e866"></a>Windows</span></span>
1.  <span data-ttu-id="7b578-510">Téléchargez l’agent de machine virtuelle Azure :</span><span class="sxs-lookup"><span data-stu-id="7b578-510">Download the Azure VM Agent:</span></span>
  1.  <span data-ttu-id="7b578-511">Téléchargez le [package d’installation de l’agent de machine virtuelle Azure](https://go.microsoft.com/fwlink/?LinkId=394789).</span><span class="sxs-lookup"><span data-stu-id="7b578-511">Download the [Azure VM Agent installer package](https://go.microsoft.com/fwlink/?LinkId=394789).</span></span>
  2.  <span data-ttu-id="7b578-512">Stockez le package MSI de l’agent de machine virtuelle localement sur un serveur ou un ordinateur personnel.</span><span class="sxs-lookup"><span data-stu-id="7b578-512">Store the VM Agent MSI package locally on a personal computer or server.</span></span>
2.  <span data-ttu-id="7b578-513">Installez l’agent de machine virtuelle Azure :</span><span class="sxs-lookup"><span data-stu-id="7b578-513">Install the Azure VM Agent:</span></span>
  1.  <span data-ttu-id="7b578-514">Connectez-vous à la machine virtuelle Azure déployée à l’aide du protocole Remote Desktop Protocol (RDP).</span><span class="sxs-lookup"><span data-stu-id="7b578-514">Connect to the deployed Azure VM by using Remote Desktop Protocol (RDP).</span></span>
  2.  <span data-ttu-id="7b578-515">Ouvrez une fenêtre de l’explorateur Windows sur la machine virtuelle et sélectionnez un répertoire cible pour le fichier MSI de l’agent de machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="7b578-515">Open a Windows Explorer window on the VM and select the target directory for the MSI file of the VM Agent.</span></span>
  3.  <span data-ttu-id="7b578-516">Faites glisser le fichier MSI du programme d’installation de l’agent de machine virtuelle Azure de votre ordinateur/serveur local dans le répertoire cible de l’agent de machine virtuelle dans la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="7b578-516">Drag the Azure VM Agent Installer MSI file from your local computer/server to the target directory of the VM Agent on the VM.</span></span>
  4.  <span data-ttu-id="7b578-517">Double-cliquez sur le fichier MSI dans la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="7b578-517">Double-click the MSI file on the VM.</span></span>
3.  <span data-ttu-id="7b578-518">Pour les machines virtuelles associées à des domaines locaux, veillez à ce que les éventuels paramètres de proxy Internet s’appliquent également au compte système local Windows (S-1-5-18) de la machine virtuelle, comme décrit dans [Configurer le proxy][deployment-guide-configure-proxy].</span><span class="sxs-lookup"><span data-stu-id="7b578-518">For VMs that are joined to on-premises domains, make sure that eventual Internet proxy settings also apply to the Windows Local System account (S-1-5-18) in the VM, as described in [Configure the proxy][deployment-guide-configure-proxy].</span></span> <span data-ttu-id="7b578-519">L’agent de machine virtuelle s’exécute dans ce contexte et doit être en mesure de se connecter à Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-519">The VM Agent runs in this context and needs to be able to connect to Azure.</span></span>

<span data-ttu-id="7b578-520">Aucune interaction de l’utilisateur n’est requise pour mettre à jour l’agent de machine virtuelle Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-520">No user interaction is required to update the Azure VM Agent.</span></span> <span data-ttu-id="7b578-521">L’agent de machine virtuelle est automatiquement mis à jour, sans nécessiter de redémarrage de la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="7b578-521">The VM Agent is automatically updated, and does not require a VM restart.</span></span>

#### <span data-ttu-id="7b578-522"><a name="6889ff12-eaaf-4f3c-97e1-7c9edc7f7542"></a>Linux</span><span class="sxs-lookup"><span data-stu-id="7b578-522"><a name="6889ff12-eaaf-4f3c-97e1-7c9edc7f7542"></a>Linux</span></span>
<span data-ttu-id="7b578-523">Utilisez les commandes suivantes pour installer l’agent de machine virtuelle pour Linux :</span><span class="sxs-lookup"><span data-stu-id="7b578-523">Use the following commands to install the VM Agent for Linux:</span></span>

* <span data-ttu-id="7b578-524">**SUSE Linux Enterprise Server (SLES)**</span><span class="sxs-lookup"><span data-stu-id="7b578-524">**SUSE Linux Enterprise Server (SLES)**</span></span>

  ```
  sudo zypper install WALinuxAgent
  ```

* <span data-ttu-id="7b578-525">**Red Hat Enterprise Linux (RHEL)**</span><span class="sxs-lookup"><span data-stu-id="7b578-525">**Red Hat Enterprise Linux (RHEL)**</span></span>

  ```
  sudo yum install WALinuxAgent
  ```

<span data-ttu-id="7b578-526">Si l’agent est déjà installé, pour mettre à jour l’agent Linux Azure, suivez les étapes décrites dans [Mettre à jour l’agent Linux Azure sur une machine virtuelle vers la dernière version à partir de GitHub][virtual-machines-linux-update-agent].</span><span class="sxs-lookup"><span data-stu-id="7b578-526">If the agent is already installed, to update the Azure Linux Agent, do the steps described in [Update the Azure Linux Agent on a VM to the latest version from GitHub][virtual-machines-linux-update-agent].</span></span>

### <span data-ttu-id="7b578-527"><a name="baccae00-6f79-4307-ade4-40292ce4e02d"></a>Configurer le proxy</span><span class="sxs-lookup"><span data-stu-id="7b578-527"><a name="baccae00-6f79-4307-ade4-40292ce4e02d"></a>Configure the proxy</span></span>
<span data-ttu-id="7b578-528">Les étapes à suivre pour configurer le proxy sous Windows sont différentes de celles utilisées pour configurer le proxy sous Linux.</span><span class="sxs-lookup"><span data-stu-id="7b578-528">The steps you take to configure the proxy in Windows are different from the way you configure the proxy in Linux.</span></span>

#### <a name="windows"></a><span data-ttu-id="7b578-529">Windows</span><span class="sxs-lookup"><span data-stu-id="7b578-529">Windows</span></span>
<span data-ttu-id="7b578-530">Les paramètres de proxy doivent être correctement configurés pour que le compte système local puisse accéder à Internet.</span><span class="sxs-lookup"><span data-stu-id="7b578-530">Proxy settings must be set up correctly for the Local System account to access the Internet.</span></span> <span data-ttu-id="7b578-531">Si vos paramètres de proxy ne sont pas définis par la stratégie de groupe, vous pouvez les configurer pour le compte système local.</span><span class="sxs-lookup"><span data-stu-id="7b578-531">If your proxy settings are not set by Group Policy, you can configure the settings for the Local System account.</span></span>

1. <span data-ttu-id="7b578-532">Accédez à **Démarrer**, entrez **gpedit.msc**, puis appuyez sur **Entrée**.</span><span class="sxs-lookup"><span data-stu-id="7b578-532">Go to **Start**, enter **gpedit.msc**, and then select **Enter**.</span></span>
2. <span data-ttu-id="7b578-533">Sélectionnez **Configuration ordinateur** > **Modèles d’administration** > **Composants Windows** > **Internet Explorer**.</span><span class="sxs-lookup"><span data-stu-id="7b578-533">Select **Computer Configuration** > **Administrative Templates** > **Windows Components** > **Internet Explorer**.</span></span> <span data-ttu-id="7b578-534">Assurez-vous que le paramètre **Paramètres machine du serveur proxy (plutôt que les paramètres individualisés)** est désactivé ou non configuré.</span><span class="sxs-lookup"><span data-stu-id="7b578-534">Make sure that the setting **Make proxy settings per-machine (rather than per-user)** is disabled or not configured.</span></span>
3. <span data-ttu-id="7b578-535">Dans le **panneau de configuration**, accédez à **Centre réseau et partage** > **Options Internet**.</span><span class="sxs-lookup"><span data-stu-id="7b578-535">In **Control Panel**, go to **Network and Sharing Center** > **Internet Options**.</span></span>
4. <span data-ttu-id="7b578-536">Dans l’onglet **Connexions**, sélectionnez le bouton **Paramètres LAN**.</span><span class="sxs-lookup"><span data-stu-id="7b578-536">On the **Connections** tab, select the **LAN settings** button.</span></span>
5. <span data-ttu-id="7b578-537">Décochez la case **Détecter automatiquement les paramètres de connexion**.</span><span class="sxs-lookup"><span data-stu-id="7b578-537">Clear the **Automatically detect settings** check box.</span></span>
6. <span data-ttu-id="7b578-538">Cochez la case **Utiliser un serveur proxy pour votre réseau local** et entrez l’adresse et le port du proxy.</span><span class="sxs-lookup"><span data-stu-id="7b578-538">Select the **Use a proxy server for your LAN** check box, and then enter the proxy address and port.</span></span>
7. <span data-ttu-id="7b578-539">Sélectionnez le bouton **Advanced (Avancé)**.</span><span class="sxs-lookup"><span data-stu-id="7b578-539">Select the **Advanced** button.</span></span>
8. <span data-ttu-id="7b578-540">Dans la zone **Exceptions**, entrez l’adresse IP **168.63.129.16**.</span><span class="sxs-lookup"><span data-stu-id="7b578-540">In the **Exceptions** box, enter the IP address **168.63.129.16**.</span></span> <span data-ttu-id="7b578-541">Sélectionnez **OK**.</span><span class="sxs-lookup"><span data-stu-id="7b578-541">Select **OK**.</span></span>


#### <a name="linux"></a><span data-ttu-id="7b578-542">Linux</span><span class="sxs-lookup"><span data-stu-id="7b578-542">Linux</span></span>
<span data-ttu-id="7b578-543">Configurez le proxy approprié dans le fichier de configuration de l’agent invité Microsoft Azure, qui se trouve dans \\etc\\waagent.conf.</span><span class="sxs-lookup"><span data-stu-id="7b578-543">Configure the correct proxy in the configuration file of the Microsoft Azure Guest Agent, which is located at \\etc\\waagent.conf.</span></span>

<span data-ttu-id="7b578-544">Définissez les paramètres suivants :</span><span class="sxs-lookup"><span data-stu-id="7b578-544">Set the following parameters:</span></span>

1.  <span data-ttu-id="7b578-545">**Hôte proxy HTTP**.</span><span class="sxs-lookup"><span data-stu-id="7b578-545">**HTTP proxy host**.</span></span> <span data-ttu-id="7b578-546">Par exemple, définissez-le sur **proxy.corp.local**.</span><span class="sxs-lookup"><span data-stu-id="7b578-546">For example, set it to **proxy.corp.local**.</span></span>
  ```
  HttpProxy.Host=<proxy host>

  ```
2.  <span data-ttu-id="7b578-547">**Port proxy HTTP**.</span><span class="sxs-lookup"><span data-stu-id="7b578-547">**HTTP proxy port**.</span></span> <span data-ttu-id="7b578-548">Par exemple, définissez-le sur **80**.</span><span class="sxs-lookup"><span data-stu-id="7b578-548">For example, set it to **80**.</span></span>
  ```
  HttpProxy.Port=<port of the proxy host>

  ```
3.  <span data-ttu-id="7b578-549">Redémarrez l’agent.</span><span class="sxs-lookup"><span data-stu-id="7b578-549">Restart the agent.</span></span>

  ```
  sudo service waagent restart
  ```

<span data-ttu-id="7b578-550">Les paramètres de proxy dans \\etc\\waagent.conf s’appliquent également aux extensions de machine virtuelle requises.</span><span class="sxs-lookup"><span data-stu-id="7b578-550">The proxy settings in \\etc\\waagent.conf also apply to the required VM extensions.</span></span> <span data-ttu-id="7b578-551">Si vous voulez utiliser les référentiels Azure, assurez-vous que le trafic vers ces référentiels ne passe pas par l’intranet local.</span><span class="sxs-lookup"><span data-stu-id="7b578-551">If you want to use the Azure repositories, make sure that the traffic to these repositories is not going through your on-premises intranet.</span></span> <span data-ttu-id="7b578-552">Si vous avez créé des itinéraires définis par les utilisateurs pour activer le tunneling forcé, veillez à ajouter un itinéraire qui achemine le trafic vers les référentiels directement vers Internet, et non par le biais de votre connexion VPN de site à site.</span><span class="sxs-lookup"><span data-stu-id="7b578-552">If you created user-defined routes to enable forced tunneling, make sure that you add a route that routes traffic to the repositories directly to the Internet, and not through your site-to-site VPN connection.</span></span>

* <span data-ttu-id="7b578-553">**SLES**</span><span class="sxs-lookup"><span data-stu-id="7b578-553">**SLES**</span></span>

  <span data-ttu-id="7b578-554">Vous devez également ajouter des itinéraires pour les adresses IP répertoriées dans \\etc\\regionserverclnt.cfg.</span><span class="sxs-lookup"><span data-stu-id="7b578-554">You also need to add routes for the IP addresses listed in \\etc\\regionserverclnt.cfg.</span></span> <span data-ttu-id="7b578-555">La figure suivante montre un exemple :</span><span class="sxs-lookup"><span data-stu-id="7b578-555">The following figure shows an example:</span></span>

  ![Tunneling forcé][deployment-guide-figure-50]


* <span data-ttu-id="7b578-557">**RHEL**</span><span class="sxs-lookup"><span data-stu-id="7b578-557">**RHEL**</span></span>

  <span data-ttu-id="7b578-558">Vous devez également ajouter des itinéraires pour les adresses IP des hôtes répertoriés dans \\etc\\yum.repos.d\\rhui-load-balancers.</span><span class="sxs-lookup"><span data-stu-id="7b578-558">You also need to add routes for the IP addresses of the hosts listed in \\etc\\yum.repos.d\\rhui-load-balancers.</span></span> <span data-ttu-id="7b578-559">Pour obtenir un exemple, consultez la figure précédente.</span><span class="sxs-lookup"><span data-stu-id="7b578-559">For an example, see the preceding figure.</span></span>

<span data-ttu-id="7b578-560">Pour plus d’informations sur les itinéraires définis par l’utilisateur, consultez [Itinéraires définis par l’utilisateur et transfert IP][virtual-networks-udr-overview].</span><span class="sxs-lookup"><span data-stu-id="7b578-560">For more information about user-defined routes, see [User-defined routes and IP forwarding][virtual-networks-udr-overview].</span></span>

### <span data-ttu-id="7b578-561"><a name="d98edcd3-f2a1-49f7-b26a-07448ceb60ca"></a>Configurer l’extension d’analyse Azure améliorée pour SAP</span><span class="sxs-lookup"><span data-stu-id="7b578-561"><a name="d98edcd3-f2a1-49f7-b26a-07448ceb60ca"></a>Configure the Azure Enhanced Monitoring Extension for SAP</span></span>
<span data-ttu-id="7b578-562">Une fois que la machine virtuelle est préparée comme décrit dans [Scénarios de déploiement de machines virtuelles pour SAP sur Azure][deployment-guide-3], l’agent de machine virtuelle Azure est installé sur la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="7b578-562">When you've prepared the VM as described in [Deployment scenarios of VMs for SAP on Azure][deployment-guide-3], the Azure VM Agent is installed on the virtual machine.</span></span> <span data-ttu-id="7b578-563">L’étape suivante consiste à déployer l’extension d’analyse Azure améliorée pour SAP, qui est disponible dans le référentiel d’extensions Azure dans les centres de données mondiaux d’Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-563">The next step is to deploy the Azure Enhanced Monitoring Extension for SAP, which is available in the Azure Extension Repository in the global Azure datacenters.</span></span> <span data-ttu-id="7b578-564">Pour plus d’informations, consultez [Planification et implémentation de Machines virtuelles Azure pour SAP sur Linux][planning-guide-9.1].</span><span class="sxs-lookup"><span data-stu-id="7b578-564">For more information, see [Azure Virtual Machines planning and implementation for SAP on Linux][planning-guide-9.1].</span></span>

<span data-ttu-id="7b578-565">Vous pouvez utiliser PowerShell ou l’interface de ligne de commande Azure pour installer et configurer l’extension d’analyse Azure améliorée pour SAP.</span><span class="sxs-lookup"><span data-stu-id="7b578-565">You can use PowerShell or Azure CLI to install and configure the Azure Enhanced Monitoring Extension for SAP.</span></span> <span data-ttu-id="7b578-566">Pour installer l’extension sur une machine virtuelle Windows ou Linux à l’aide d’une machine Windows, consultez [Azure PowerShell][deployment-guide-4.5.1].</span><span class="sxs-lookup"><span data-stu-id="7b578-566">To install the extension on a Windows or Linux VM by using a Windows machine, see [Azure PowerShell][deployment-guide-4.5.1].</span></span> <span data-ttu-id="7b578-567">Pour installer l’extension sur une machine virtuelle Linux à l’aide d’un ordinateur de bureau Linux, consultez [Interface de ligne de commande Azure][deployment-guide-4.5.2].</span><span class="sxs-lookup"><span data-stu-id="7b578-567">To install the extension on a Linux VM by using a Linux desktop, see [Azure CLI][deployment-guide-4.5.2].</span></span>

#### <span data-ttu-id="7b578-568"><a name="987cf279-d713-4b4c-8143-6b11589bb9d4"></a>Azure PowerShell pour les machines virtuelles Linux et Windows</span><span class="sxs-lookup"><span data-stu-id="7b578-568"><a name="987cf279-d713-4b4c-8143-6b11589bb9d4"></a>Azure PowerShell for Linux and Windows VMs</span></span>
<span data-ttu-id="7b578-569">Pour installer l’extension d’analyse Azure améliorée pour SAP à l’aide de PowerShell :</span><span class="sxs-lookup"><span data-stu-id="7b578-569">To install the Azure Enhanced Monitoring Extension for SAP by using PowerShell:</span></span>

1. <span data-ttu-id="7b578-570">Vérifiez que vous avez installé la dernière version de l’applet de commande Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="7b578-570">Make sure that you have installed the latest version of the Azure PowerShell cmdlet.</span></span> <span data-ttu-id="7b578-571">Pour plus d’informations, consultez [Déploiement d’applets de commande Azure PowerShell][deployment-guide-4.1].</span><span class="sxs-lookup"><span data-stu-id="7b578-571">For more information, see [Deploying Azure PowerShell cmdlets][deployment-guide-4.1].</span></span>  
2. <span data-ttu-id="7b578-572">Exécutez l’applet de commande PowerShell suivant.</span><span class="sxs-lookup"><span data-stu-id="7b578-572">Run the following PowerShell cmdlet.</span></span>
  <span data-ttu-id="7b578-573">Pour afficher la liste des environnements disponibles, exécutez `commandlet Get-AzureRmEnvironment` .</span><span class="sxs-lookup"><span data-stu-id="7b578-573">For a list of available environments, run `commandlet Get-AzureRmEnvironment`.</span></span> <span data-ttu-id="7b578-574">Si vous voulez utiliser la version publique d’Azure, votre environnement est **AzureCloud**.</span><span class="sxs-lookup"><span data-stu-id="7b578-574">If you want to use public Azure, your environment is **AzureCloud**.</span></span> <span data-ttu-id="7b578-575">Pour Azure en Chine, sélectionnez **AzureChinaCloud**.</span><span class="sxs-lookup"><span data-stu-id="7b578-575">For Azure in China, select **AzureChinaCloud**.</span></span>


      ```powershell
      $env = Get-AzureRmEnvironment -Name <name of the environment>
      Login-AzureRmAccount -Environment $env
      Set-AzureRmContext -SubscriptionName <subscription name>

      Set-AzureRmVMAEMExtension -ResourceGroupName <resource group name> -VMName <virtual machine name>
      ```

<span data-ttu-id="7b578-576">Une fois que vous avez saisi les données de votre compte et identifié la machine virtuelle Azure, le script déploie les extensions requises et active les fonctionnalités nécessaires.</span><span class="sxs-lookup"><span data-stu-id="7b578-576">After you enter your account data and identify the Azure virtual machine, the script deploys the required extensions and enables the required features.</span></span> <span data-ttu-id="7b578-577">Ceci peut prendre plusieurs minutes.</span><span class="sxs-lookup"><span data-stu-id="7b578-577">This can take several minutes.</span></span>
<span data-ttu-id="7b578-578">Pour plus d’informations sur `Set-AzureRmVMAEMExtension`, consultez [Set-AzureRmVMAEMExtension][msdn-set-azurermvmaemextension].</span><span class="sxs-lookup"><span data-stu-id="7b578-578">For more information about `Set-AzureRmVMAEMExtension`, see [Set-AzureRmVMAEMExtension][msdn-set-azurermvmaemextension].</span></span>

![Exécution réussie de l’applet de commande Azure spécifique à SAP Set-AzureRmVMAEMExtension][deployment-guide-figure-900]

<span data-ttu-id="7b578-580">La configuration `Set-AzureRmVMAEMExtension` effectue toutes les étapes de configuration de l’analyse d’hôte pour SAP.</span><span class="sxs-lookup"><span data-stu-id="7b578-580">The `Set-AzureRmVMAEMExtension` configuration does all the steps to configure host monitoring for SAP.</span></span>

<span data-ttu-id="7b578-581">La sortie du script comprend les informations suivantes :</span><span class="sxs-lookup"><span data-stu-id="7b578-581">The script output includes the following information:</span></span>

* <span data-ttu-id="7b578-582">Confirmation que l’analyse pour le disque dur virtuel de base (contenant le système d’exploitation) ainsi que tous les disques durs virtuels supplémentaires montés sur la machine virtuelle ont été configurés.</span><span class="sxs-lookup"><span data-stu-id="7b578-582">Confirmation that monitoring for the base VHD (with the OS) and all additional VHDs mounted to the VM has been configured.</span></span>
* <span data-ttu-id="7b578-583">Les deux messages suivants confirment la configuration des métriques de stockage pour un compte de stockage spécifique.</span><span class="sxs-lookup"><span data-stu-id="7b578-583">The next two messages confirm the configuration of Storage Metrics for a specific storage account.</span></span>
* <span data-ttu-id="7b578-584">Une des lignes de sortie fournit l’état de la mise à jour réelle de la configuration de l’analyse.</span><span class="sxs-lookup"><span data-stu-id="7b578-584">One line of output gives the status of the actual update of the monitoring configuration.</span></span>
* <span data-ttu-id="7b578-585">Une autre ligne de sortie confirme que la configuration a été déployée ou mise à jour.</span><span class="sxs-lookup"><span data-stu-id="7b578-585">Another line of output confirms that the configuration has been deployed or updated.</span></span>
* <span data-ttu-id="7b578-586">La dernière ligne de sortie est informative.</span><span class="sxs-lookup"><span data-stu-id="7b578-586">The last line of output is informational.</span></span> <span data-ttu-id="7b578-587">Elle répertorie les options permettant de tester la configuration d’analyse.</span><span class="sxs-lookup"><span data-stu-id="7b578-587">It shows your options for testing the monitoring configuration.</span></span>

<span data-ttu-id="7b578-588">Pour vérifier que toutes les étapes de l’analyse Azure améliorée ont été exécutées correctement et que l’infrastructure Azure fournit les données nécessaires, vérifiez la disponibilité de l’extension d’analyse Azure améliorée pour SAP, comme décrit dans [Vérification de la disponibilité de l’analyse Azure améliorée pour SAP][deployment-guide-5.1].</span><span class="sxs-lookup"><span data-stu-id="7b578-588">To check that all steps of Azure Enhanced Monitoring have been executed successfully, and that the Azure Infrastructure provides the necessary data, proceed with the readiness check for the Azure Enhanced Monitoring Extension for SAP, as described in [Readiness check for Azure Enhanced Monitoring for SAP][deployment-guide-5.1].</span></span> <span data-ttu-id="7b578-589">Attendez 15 à 30 minutes pour que les diagnostics Azure collectent les données pertinentes.</span><span class="sxs-lookup"><span data-stu-id="7b578-589">Wait 15-30 minutes for Azure Diagnostics to collect the relevant data.</span></span>

#### <span data-ttu-id="7b578-590"><a name="408f3779-f422-4413-82f8-c57a23b4fc2f"></a>Interface de ligne de commande Azure pour machines virtuelles Linux</span><span class="sxs-lookup"><span data-stu-id="7b578-590"><a name="408f3779-f422-4413-82f8-c57a23b4fc2f"></a>Azure CLI for Linux VMs</span></span>
<span data-ttu-id="7b578-591">Pour installer l’extension d’analyse Azure améliorée pour SAP à l’aide de l’interface de ligne de commande Azure :</span><span class="sxs-lookup"><span data-stu-id="7b578-591">To install the Azure Enhanced Monitoring Extension for SAP by using Azure CLI:</span></span>

1. <span data-ttu-id="7b578-592">Installez l’interface de ligne de commande Azure comme décrit dans [Installer l’interface de ligne de commande Azure][azure-cli].</span><span class="sxs-lookup"><span data-stu-id="7b578-592">Install Azure CLI, as described in [Install the Azure CLI][azure-cli].</span></span>
2. <span data-ttu-id="7b578-593">Connectez-vous à votre compte Azure :</span><span class="sxs-lookup"><span data-stu-id="7b578-593">Sign in with your Azure account:</span></span>

  ```
  azure login
  ```

3. <span data-ttu-id="7b578-594">Basculez en mode Azure Resource Manager :</span><span class="sxs-lookup"><span data-stu-id="7b578-594">Switch to Azure Resource Manager mode:</span></span>

  ```
  azure config mode arm
  ```

4. <span data-ttu-id="7b578-595">Activez la surveillance Azure améliorée :</span><span class="sxs-lookup"><span data-stu-id="7b578-595">Enable Azure Enhanced Monitoring:</span></span>

  ```
  azure vm enable-aem <resource-group-name> <vm-name>
  ```

5. <span data-ttu-id="7b578-596">Vérifiez que l’extension de surveillance Azure améliorée est active sur la machine virtuelle Azure Linux.</span><span class="sxs-lookup"><span data-stu-id="7b578-596">Verify that the Azure Enhanced Monitoring Extension is active on the Azure Linux VM.</span></span> <span data-ttu-id="7b578-597">Vérifiez si le fichier \\var\\lib\\AzureEnhancedMonitor\\PerfCounters existe.</span><span class="sxs-lookup"><span data-stu-id="7b578-597">Check whether the file \\var\\lib\\AzureEnhancedMonitor\\PerfCounters exists.</span></span> <span data-ttu-id="7b578-598">S’il existe, à l’invite de commandes, exécutez cette commande pour afficher les informations collectées par Azure Enhanced Monitor :</span><span class="sxs-lookup"><span data-stu-id="7b578-598">If it exists, at a command prompt, run this command to display information collected by the Azure Enhanced Monitor:</span></span>
```
cat /var/lib/AzureEnhancedMonitor/PerfCounters
```

<span data-ttu-id="7b578-599">Le résultat se présente ainsi :</span><span class="sxs-lookup"><span data-stu-id="7b578-599">The output looks like this:</span></span>
```
2;cpu;Current Hw Frequency;;0;2194.659;MHz;60;1444036656;saplnxmon;
2;cpu;Max Hw Frequency;;0;2194.659;MHz;0;1444036656;saplnxmon;
…
…
```

## <span data-ttu-id="7b578-600"><a name="564adb4f-5c95-4041-9616-6635e83a810b"></a>Vérifications et résolution des problèmes pour la configuration de l’analyse de bout en bout</span><span class="sxs-lookup"><span data-stu-id="7b578-600"><a name="564adb4f-5c95-4041-9616-6635e83a810b"></a>Checks and troubleshooting for end-to-end monitoring</span></span>
<span data-ttu-id="7b578-601">Une fois que vous avez déployé votre machine virtuelle Azure et configuré l’infrastructure d’analyse Azure appropriée, vérifiez si tous les composants de l’analyse Azure améliorée fonctionnent correctement.</span><span class="sxs-lookup"><span data-stu-id="7b578-601">After you have deployed your Azure VM and set up the relevant Azure monitoring infrastructure, check whether all the components of the Azure Enhanced Monitoring Extension are working as expected.</span></span>

<span data-ttu-id="7b578-602">Vérifiez la disponibilité de l’extension d’analyse Azure améliorée pour SAP, comme décrit dans [Vérification de la disponibilité de l’extension d’analyse Azure améliorée pour SAP][deployment-guide-5.1].</span><span class="sxs-lookup"><span data-stu-id="7b578-602">Run the readiness check for the Azure Enhanced Monitoring Extension for SAP as described in [Readiness check for the Azure Enhanced Monitoring Extension for SAP][deployment-guide-5.1].</span></span> <span data-ttu-id="7b578-603">Si tous les résultats de la vérification de disponibilité sont positifs et que tous les compteurs de performances ont le statut OK, l’analyse Azure a été correctement configurée.</span><span class="sxs-lookup"><span data-stu-id="7b578-603">If all readiness check results are positive and all relevant performance counters appear OK, Azure monitoring successfully set up.</span></span> <span data-ttu-id="7b578-604">Vous pouvez poursuivre l’installation de l’agent hôte SAP décrit dans les notes SAP dans [Ressources SAP][deployment-guide-2.2].</span><span class="sxs-lookup"><span data-stu-id="7b578-604">You can proceed with the installation of SAP Host Agent described in the SAP Notes in [SAP resources][deployment-guide-2.2].</span></span> <span data-ttu-id="7b578-605">Si la vérification de disponibilité signale des compteurs manquants, effectuez un contrôle d’intégrité de l’infrastructure d’analyse Azure, comme décrit dans [Contrôle d’intégrité de la configuration de l’infrastructure d’analyse Azure][deployment-guide-5.2].</span><span class="sxs-lookup"><span data-stu-id="7b578-605">If the readiness check indicates that counters are missing, run the health check for the Azure monitoring infrastructure, as described in [Health check for Azure monitoring infrastructure configuration][deployment-guide-5.2].</span></span> <span data-ttu-id="7b578-606">Pour obtenir davantage d’options de résolution des problèmes, consultez [Résolution des problèmes d’analyse Azure pour SAP][deployment-guide-5.3].</span><span class="sxs-lookup"><span data-stu-id="7b578-606">For more troubleshooting options, see [Troubleshooting Azure monitoring for SAP][deployment-guide-5.3].</span></span>

### <span data-ttu-id="7b578-607"><a name="bb61ce92-8c5c-461f-8c53-39f5e5ed91f2"></a>Vérification de disponibilité de l’extension d’analyse Azure améliorée pour SAP</span><span class="sxs-lookup"><span data-stu-id="7b578-607"><a name="bb61ce92-8c5c-461f-8c53-39f5e5ed91f2"></a>Readiness check for the Azure Enhanced Monitoring Extension for SAP</span></span>
<span data-ttu-id="7b578-608">Cette vérification vous assure que tous les indicateurs de performance affichés au sein de votre application SAP sont fournis par l’infrastructure d’analyse Azure sous-jacente.</span><span class="sxs-lookup"><span data-stu-id="7b578-608">This check makes sure that all performance metrics that appear inside your SAP application are provided by the underlying Azure monitoring infrastructure.</span></span>

#### <a name="run-the-readiness-check-on-a-windows-vm"></a><span data-ttu-id="7b578-609">Vérifier la disponibilité d’une machine virtuelle Windows</span><span class="sxs-lookup"><span data-stu-id="7b578-609">Run the readiness check on a Windows VM</span></span>

1.  <span data-ttu-id="7b578-610">Connectez-vous à la machine virtuelle Azure (l’utilisation d’un compte Administrateur n’est pas nécessaire).</span><span class="sxs-lookup"><span data-stu-id="7b578-610">Sign in to the Azure virtual machine (using an admin account is not necessary).</span></span>
2.  <span data-ttu-id="7b578-611">Ouvrez une fenêtre d’invite de commandes.</span><span class="sxs-lookup"><span data-stu-id="7b578-611">Open a Command Prompt window.</span></span>
3.  <span data-ttu-id="7b578-612">À l’invite de commandes, remplacez le référentiel par le dossier d’installation de l’extension d’analyse Azure améliorée pour SAP : C:\\Packages\\Plugins\\Microsoft.AzureCAT.AzureEnhancedMonitoring.AzureCATExtensionHandler\\&lt;version>\\drop</span><span class="sxs-lookup"><span data-stu-id="7b578-612">At the command prompt, change the directory to the installation folder of the Azure Enhanced Monitoring Extension for SAP: C:\\Packages\\Plugins\\Microsoft.AzureCAT.AzureEnhancedMonitoring.AzureCATExtensionHandler\\&lt;version>\\drop</span></span>

  <span data-ttu-id="7b578-613">La *version* figurant dans le chemin d’accès à l’extension d’analyse peut varier.</span><span class="sxs-lookup"><span data-stu-id="7b578-613">The *version* in the path to the monitoring extension might vary.</span></span> <span data-ttu-id="7b578-614">Si vous voyez des dossiers pour plusieurs versions de l’extension d’analyse dans le dossier d’installation, vérifiez la configuration du service Windows AzureEnhancedMonitoring, puis accédez au dossier indiqué en tant que *Chemin d’accès des fichiers exécutables*.</span><span class="sxs-lookup"><span data-stu-id="7b578-614">If you see folders for multiple versions of the monitoring extension in the installation folder, check the configuration of the AzureEnhancedMonitoring Windows service, and then switch to the folder indicated as *Path to executable*.</span></span>

  ![Propriétés du service exécutant l’extension d’analyse Azure améliorée pour SAP][deployment-guide-figure-1000]

4.  <span data-ttu-id="7b578-616">À l’invite de commandes, exécutez **azperflib.exe** sans aucun paramètre.</span><span class="sxs-lookup"><span data-stu-id="7b578-616">At the command prompt, run **azperflib.exe** without any parameters.</span></span>

  > [!NOTE]
  > <span data-ttu-id="7b578-617">Le fichier exécutable azperflib.exe fonctionne en boucle et met à jour les compteurs collectés toutes les 60 secondes.</span><span class="sxs-lookup"><span data-stu-id="7b578-617">Azperflib.exe runs in a loop and updates the collected counters every 60 seconds.</span></span> <span data-ttu-id="7b578-618">Pour mettre fin à la boucle, fermez la fenêtre d’invite de commandes.</span><span class="sxs-lookup"><span data-stu-id="7b578-618">To end the loop, close the Command Prompt window.</span></span>
  >
  >

<span data-ttu-id="7b578-619">Si l’extension d’analyse Azure améliorée n’est pas installée ou que le service AzureEnhancedMonitoring n’est pas en cours d’exécution, cela signifie que l’extension n’a pas été configurée correctement.</span><span class="sxs-lookup"><span data-stu-id="7b578-619">If the Azure Enhanced Monitoring Extension is not installed, or the AzureEnhancedMonitoring service is not running, the extension has not been configured correctly.</span></span> <span data-ttu-id="7b578-620">Pour plus d’informations sur la façon de déployer l’extension, consultez [Résolution de problèmes sur l’infrastructure d’analyse Azure pour SAP][deployment-guide-5.3].</span><span class="sxs-lookup"><span data-stu-id="7b578-620">For detailed information about how to deploy the extension, see [Troubleshooting the Azure monitoring infrastructure for SAP][deployment-guide-5.3].</span></span>

##### <a name="check-the-output-of-azperflibexe"></a><span data-ttu-id="7b578-621">Vérifiez la sortie renvoyée par azperflib.exe</span><span class="sxs-lookup"><span data-stu-id="7b578-621">Check the output of azperflib.exe</span></span>
<span data-ttu-id="7b578-622">La sortie de azperflib.exe indique tous les compteurs de performances Azure remplis pour SAP.</span><span class="sxs-lookup"><span data-stu-id="7b578-622">Azperflib.exe output shows all populated Azure performance counters for SAP.</span></span> <span data-ttu-id="7b578-623">En bas de la liste des compteurs collectés, vous trouverez un résumé et un indicateur d’intégrité, qui indiquent l’état de l’analyse Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-623">At the bottom of the list of collected counters, a summary and health indicator show the status of Azure monitoring.</span></span>

<span data-ttu-id="7b578-624">![Sortie du contrôle d’intégrité effectué avec azperflib.exe indiquant l’absence de problèmes][deployment-guide-figure-1100]
<a name="figure-11"></a></span><span class="sxs-lookup"><span data-stu-id="7b578-624">![Output of health check by executing azperflib.exe, which indicates that no problems exist][deployment-guide-figure-1100]
<a name="figure-11"></a></span></span>

<span data-ttu-id="7b578-625">Vérifiez le résultat renvoyé pour la sortie **Nombre total de compteurs**, qui est indiqué comme étant vide, et pour **État d’intégrité**, comme indiqué à la figure précédente.</span><span class="sxs-lookup"><span data-stu-id="7b578-625">Check the result returned for the **Counters total** output, which is reported as empty, and for **Health status**, shown in the preceding figure.</span></span>

<span data-ttu-id="7b578-626">Interprétez les valeurs obtenues comme suit :</span><span class="sxs-lookup"><span data-stu-id="7b578-626">Interpret the resulting values as follows:</span></span>

| <span data-ttu-id="7b578-627">Résultats du fichier exécutable azperflib.exe</span><span class="sxs-lookup"><span data-stu-id="7b578-627">Azperflib.exe result values</span></span> | <span data-ttu-id="7b578-628">État d’intégrité de l’analyse Azure</span><span class="sxs-lookup"><span data-stu-id="7b578-628">Azure monitoring health status</span></span> |
| --- | --- |
| <span data-ttu-id="7b578-629">**Appels de l’API - non disponibles**</span><span class="sxs-lookup"><span data-stu-id="7b578-629">**API Calls - not available**</span></span> | <span data-ttu-id="7b578-630">Les compteurs qui ne sont pas disponibles peuvent ne pas être concernés par la configuration de la machine virtuelle ou constituent des erreurs.</span><span class="sxs-lookup"><span data-stu-id="7b578-630">Counters that are not available might be either not applicable to the virtual machine configuration, or are errors.</span></span> <span data-ttu-id="7b578-631">Voir **État d’intégrité**.</span><span class="sxs-lookup"><span data-stu-id="7b578-631">See **Health status**.</span></span> |
| <span data-ttu-id="7b578-632">**Nombre total de compteurs : vide**</span><span class="sxs-lookup"><span data-stu-id="7b578-632">**Counters total - empty**</span></span> |<span data-ttu-id="7b578-633">Les deux compteurs suivants de stockage Azure peuvent être vides :</span><span class="sxs-lookup"><span data-stu-id="7b578-633">The following two Azure storage counters can be empty:</span></span> <ul><li><span data-ttu-id="7b578-634">Stockage Lecture Op Latence Serveur msec</span><span class="sxs-lookup"><span data-stu-id="7b578-634">Storage Read Op Latency Server msec</span></span></li><li><span data-ttu-id="7b578-635">Stockage Lecture Op Latence E2E msec</span><span class="sxs-lookup"><span data-stu-id="7b578-635">Storage Read Op Latency E2E msec</span></span></li></ul><span data-ttu-id="7b578-636">Tous les autres compteurs doivent contenir des valeurs.</span><span class="sxs-lookup"><span data-stu-id="7b578-636">All other counters must have values.</span></span> |
| <span data-ttu-id="7b578-637">**État d’intégrité**</span><span class="sxs-lookup"><span data-stu-id="7b578-637">**Health status**</span></span> |<span data-ttu-id="7b578-638">Uniquement OK si l’état renvoyé est **OK**.</span><span class="sxs-lookup"><span data-stu-id="7b578-638">Only OK if return status shows **OK**.</span></span> |
| <span data-ttu-id="7b578-639">**Diagnostics**</span><span class="sxs-lookup"><span data-stu-id="7b578-639">**Diagnostics**</span></span> |<span data-ttu-id="7b578-640">Informations détaillées sur l’état d’intégrité.</span><span class="sxs-lookup"><span data-stu-id="7b578-640">Detailed information about health status.</span></span> |

<span data-ttu-id="7b578-641">Si la valeur **État d’intégrité** n’est pas **OK**, suivez les instructions de [Contrôle d’intégrité de la configuration de l’infrastructure d’analyse Azure][deployment-guide-5.2].</span><span class="sxs-lookup"><span data-stu-id="7b578-641">If the **Health status** value is not **OK**, follow the instructions in [Health check for Azure monitoring infrastructure configuration][deployment-guide-5.2].</span></span>

#### <a name="run-the-readiness-check-on-a-linux-vm"></a><span data-ttu-id="7b578-642">Vérifier la disponibilité d’une machine virtuelle Linux</span><span class="sxs-lookup"><span data-stu-id="7b578-642">Run the readiness check on a Linux VM</span></span>

1.  <span data-ttu-id="7b578-643">Connectez-vous à la machine virtuelle Azure à l’aide de SSH.</span><span class="sxs-lookup"><span data-stu-id="7b578-643">Connect to the Azure Virtual Machine by using SSH.</span></span>

2.  <span data-ttu-id="7b578-644">Vérifiez le résultat de l’extension d’analyse Azure améliorée.</span><span class="sxs-lookup"><span data-stu-id="7b578-644">Check the output of the Azure Enhanced Monitoring Extension.</span></span>

  <span data-ttu-id="7b578-645">a.</span><span class="sxs-lookup"><span data-stu-id="7b578-645">a.</span></span>  <span data-ttu-id="7b578-646">Exécutez `more /var/lib/AzureEnhancedMonitor/PerfCounters`.</span><span class="sxs-lookup"><span data-stu-id="7b578-646">Run `more /var/lib/AzureEnhancedMonitor/PerfCounters`</span></span>

   <span data-ttu-id="7b578-647">**Résultat attendu** : renvoie la liste des compteurs de performances.</span><span class="sxs-lookup"><span data-stu-id="7b578-647">**Expected result**: Returns list of performance counters.</span></span> <span data-ttu-id="7b578-648">Ce fichier ne doit pas être vide.</span><span class="sxs-lookup"><span data-stu-id="7b578-648">The file should not be empty.</span></span>

 <span data-ttu-id="7b578-649">b.</span><span class="sxs-lookup"><span data-stu-id="7b578-649">b.</span></span> <span data-ttu-id="7b578-650">Exécutez `cat /var/lib/AzureEnhancedMonitor/PerfCounters | grep Error`.</span><span class="sxs-lookup"><span data-stu-id="7b578-650">Run `cat /var/lib/AzureEnhancedMonitor/PerfCounters | grep Error`</span></span>

   <span data-ttu-id="7b578-651">**Résultat attendu** : renvoie une ligne où l’erreur est **none**, par exemple **3;config;Error;;0;0;none;0;1456416792;tst-servercs;**</span><span class="sxs-lookup"><span data-stu-id="7b578-651">**Expected result**: Returns one line where the error is **none**, for example, **3;config;Error;;0;0;none;0;1456416792;tst-servercs;**</span></span>

  <span data-ttu-id="7b578-652">c.</span><span class="sxs-lookup"><span data-stu-id="7b578-652">c.</span></span> <span data-ttu-id="7b578-653">Exécutez `more /var/lib/AzureEnhancedMonitor/LatestErrorRecord`.</span><span class="sxs-lookup"><span data-stu-id="7b578-653">Run `more /var/lib/AzureEnhancedMonitor/LatestErrorRecord`</span></span>

    <span data-ttu-id="7b578-654">**Résultat attendu** : revient vide ou n’existe pas.</span><span class="sxs-lookup"><span data-stu-id="7b578-654">**Expected result**: Returns as empty or does not exist.</span></span>

<span data-ttu-id="7b578-655">Si la vérification précédente a échoué, exécutez ces vérifications supplémentaires :</span><span class="sxs-lookup"><span data-stu-id="7b578-655">If the preceding check was not successful, run these additional checks:</span></span>

1.  <span data-ttu-id="7b578-656">Assurez-vous que waagent est installé et démarré.</span><span class="sxs-lookup"><span data-stu-id="7b578-656">Make sure that the waagent is installed and enabled.</span></span>

  <span data-ttu-id="7b578-657">a.</span><span class="sxs-lookup"><span data-stu-id="7b578-657">a.</span></span>  <span data-ttu-id="7b578-658">Exécutez `sudo ls -al /var/lib/waagent/`.</span><span class="sxs-lookup"><span data-stu-id="7b578-658">Run `sudo ls -al /var/lib/waagent/`</span></span>

      <span data-ttu-id="7b578-659">**Résultat attendu** : répertorie le contenu du répertoire waagent.</span><span class="sxs-lookup"><span data-stu-id="7b578-659">**Expected result**: Lists the content of the waagent directory.</span></span>

  <span data-ttu-id="7b578-660">b.</span><span class="sxs-lookup"><span data-stu-id="7b578-660">b.</span></span>  <span data-ttu-id="7b578-661">Exécutez `ps -ax | grep waagent`.</span><span class="sxs-lookup"><span data-stu-id="7b578-661">Run `ps -ax | grep waagent`</span></span>

   <span data-ttu-id="7b578-662">**Résultat attendu** : affiche une entrée similaire à : `python /usr/sbin/waagent -daemon`</span><span class="sxs-lookup"><span data-stu-id="7b578-662">**Expected result**: Displays one entry similar to: `python /usr/sbin/waagent -daemon`</span></span>

2. <span data-ttu-id="7b578-663">Assurez-vous que l’extension de diagnostic Linux est installée et démarrée.</span><span class="sxs-lookup"><span data-stu-id="7b578-663">Make sure that the Linux Diagnostic Extension is installed and enabled.</span></span>

  <span data-ttu-id="7b578-664">a.</span><span class="sxs-lookup"><span data-stu-id="7b578-664">a.</span></span>  <span data-ttu-id="7b578-665">Exécutez `sudo sh -c 'ls -al /var/lib/waagent/Microsoft.OSTCExtensions.LinuxDiagnostic-'`.</span><span class="sxs-lookup"><span data-stu-id="7b578-665">Run `sudo sh -c 'ls -al /var/lib/waagent/Microsoft.OSTCExtensions.LinuxDiagnostic-'`</span></span>

   <span data-ttu-id="7b578-666">**Résultat attendu** : répertorie le contenu du répertoire de l’extension de diagnostic Linux.</span><span class="sxs-lookup"><span data-stu-id="7b578-666">**Expected result**: Lists the content of the Linux Diagnostic Extension directory.</span></span>

 <span data-ttu-id="7b578-667">b.</span><span class="sxs-lookup"><span data-stu-id="7b578-667">b.</span></span> <span data-ttu-id="7b578-668">Exécutez `ps -ax | grep diagnostic`.</span><span class="sxs-lookup"><span data-stu-id="7b578-668">Run `ps -ax | grep diagnostic`</span></span>

   <span data-ttu-id="7b578-669">**Résultat attendu** : affiche une entrée similaire à : `python /var/lib/waagent/Microsoft.OSTCExtensions.LinuxDiagnostic-2.0.92/diagnostic.py -daemon`</span><span class="sxs-lookup"><span data-stu-id="7b578-669">**Expected result**: Displays one entry similar to: `python /var/lib/waagent/Microsoft.OSTCExtensions.LinuxDiagnostic-2.0.92/diagnostic.py -daemon`</span></span>

3.   <span data-ttu-id="7b578-670">Assurez-vous que l’extension d’analyse Azure améliorée est installée et démarrée.</span><span class="sxs-lookup"><span data-stu-id="7b578-670">Make sure that the Azure Enhanced Monitoring Extension is installed and running.</span></span>

  <span data-ttu-id="7b578-671">a.</span><span class="sxs-lookup"><span data-stu-id="7b578-671">a.</span></span>  <span data-ttu-id="7b578-672">Exécutez `sudo sh -c 'ls -al /var/lib/waagent/Microsoft.OSTCExtensions.AzureEnhancedMonitorForLinux-/'`.</span><span class="sxs-lookup"><span data-stu-id="7b578-672">Run `sudo sh -c 'ls -al /var/lib/waagent/Microsoft.OSTCExtensions.AzureEnhancedMonitorForLinux-/'`</span></span>

    <span data-ttu-id="7b578-673">**Résultat attendu** : répertorie le contenu du répertoire de l’extension d’analyse Azure améliorée.</span><span class="sxs-lookup"><span data-stu-id="7b578-673">**Expected result**: Lists the content of the Azure Enhanced Monitoring Extension directory.</span></span>

  <span data-ttu-id="7b578-674">b.</span><span class="sxs-lookup"><span data-stu-id="7b578-674">b.</span></span> <span data-ttu-id="7b578-675">Exécutez `ps -ax | grep AzureEnhanced`.</span><span class="sxs-lookup"><span data-stu-id="7b578-675">Run `ps -ax | grep AzureEnhanced`</span></span>

     <span data-ttu-id="7b578-676">**Résultat attendu** : affiche une entrée similaire à : `python /var/lib/waagent/Microsoft.OSTCExtensions.AzureEnhancedMonitorForLinux-2.0.0.2/handler.py daemon`</span><span class="sxs-lookup"><span data-stu-id="7b578-676">**Expected result**: Displays one entry similar to: `python /var/lib/waagent/Microsoft.OSTCExtensions.AzureEnhancedMonitorForLinux-2.0.0.2/handler.py daemon`</span></span>

3. <span data-ttu-id="7b578-677">Installez l’agent hôte SAP comme décrit dans la note SAP [1031096] et vérifiez le résultat de `saposcol`.</span><span class="sxs-lookup"><span data-stu-id="7b578-677">Install SAP Host Agent as described in SAP Note [1031096], and check the output of `saposcol`.</span></span>

  <span data-ttu-id="7b578-678">a.</span><span class="sxs-lookup"><span data-stu-id="7b578-678">a.</span></span>  <span data-ttu-id="7b578-679">Exécutez `/usr/sap/hostctrl/exe/saposcol -d`.</span><span class="sxs-lookup"><span data-stu-id="7b578-679">Run `/usr/sap/hostctrl/exe/saposcol -d`</span></span>

  <span data-ttu-id="7b578-680">b.</span><span class="sxs-lookup"><span data-stu-id="7b578-680">b.</span></span>  <span data-ttu-id="7b578-681">Exécutez `dump ccm`.</span><span class="sxs-lookup"><span data-stu-id="7b578-681">Run `dump ccm`</span></span>

  <span data-ttu-id="7b578-682">c.</span><span class="sxs-lookup"><span data-stu-id="7b578-682">c.</span></span>  <span data-ttu-id="7b578-683">Vérifiez si la métrique **Virtualization_Configuration\Enhanced Monitoring Access** a la valeur **true**.</span><span class="sxs-lookup"><span data-stu-id="7b578-683">Check whether the **Virtualization_Configuration\Enhanced Monitoring Access** metric is **true**.</span></span>

<span data-ttu-id="7b578-684">Si vous avez déjà installé un serveur d’applications ABAP NetWeaver SAP, ouvrez la transaction ST06 et regardez si l’analyse améliorée est activée.</span><span class="sxs-lookup"><span data-stu-id="7b578-684">If you already have an SAP NetWeaver ABAP application server installed, open transaction ST06 and check whether enhanced monitoring is enabled.</span></span>

<span data-ttu-id="7b578-685">Si l’une de ces vérifications échoue et pour plus d’informations sur la façon de redéployer l’extension, consultez [Résolution de problèmes sur l’infrastructure d’analyse Azure pour SAP][deployment-guide-5.3].</span><span class="sxs-lookup"><span data-stu-id="7b578-685">If any of these checks fail, and for detailed information about how to redeploy the extension, see [Troubleshooting the Azure monitoring infrastructure for SAP][deployment-guide-5.3].</span></span>

### <span data-ttu-id="7b578-686"><a name="e2d592ff-b4ea-4a53-a91a-e5521edb6cd1"></a>Contrôle d’intégrité de la configuration de l’infrastructure d’analyse Azure</span><span class="sxs-lookup"><span data-stu-id="7b578-686"><a name="e2d592ff-b4ea-4a53-a91a-e5521edb6cd1"></a>Health check for the Azure monitoring infrastructure configuration</span></span>
<span data-ttu-id="7b578-687">Si certaines des données d’analyse ne sont pas fournies correctement, comme indiqué par le test décrit dans [Vérification de la disponibilité de l’analyse Azure améliorée pour SAP][deployment-guide-5.1], exécutez l’applet de commande `Test-AzureRmVMAEMExtension` pour tester si l’infrastructure d’analyse Azure et l’extension d’analyse pour SAP sont correctement configurées.</span><span class="sxs-lookup"><span data-stu-id="7b578-687">If some of the monitoring data is not delivered correctly as indicated by the test described in [Readiness check for Azure Enhanced Monitoring for SAP][deployment-guide-5.1], run the `Test-AzureRmVMAEMExtension` cmdlet to check whether the Azure monitoring infrastructure and the monitoring extension for SAP are configured correctly.</span></span>

1.  <span data-ttu-id="7b578-688">Assurez-vous d’avoir installé la dernière version de l’applet de commande Azure PowerShell, comme décrit dans le chapitre [Déploiement d’applets de commande Azure PowerShell][deployment-guide-4.1].</span><span class="sxs-lookup"><span data-stu-id="7b578-688">Make sure that you have installed the latest version of the Azure PowerShell cmdlet, as described in [Deploying Azure PowerShell cmdlets][deployment-guide-4.1].</span></span>
2.  <span data-ttu-id="7b578-689">Exécutez l’applet de commande PowerShell suivant.</span><span class="sxs-lookup"><span data-stu-id="7b578-689">Run the following PowerShell cmdlet.</span></span> <span data-ttu-id="7b578-690">Pour afficher la liste des environnements disponibles, exécutez l’applet de commande `Get-AzureRmEnvironment`.</span><span class="sxs-lookup"><span data-stu-id="7b578-690">For a list of available environments, run the cmdlet `Get-AzureRmEnvironment`.</span></span> <span data-ttu-id="7b578-691">Pour utiliser la version publique d’Azure, sélectionnez l’environnement **AzureCloud**.</span><span class="sxs-lookup"><span data-stu-id="7b578-691">To use public Azure, select the **AzureCloud** environment.</span></span> <span data-ttu-id="7b578-692">Pour Azure en Chine, sélectionnez **AzureChinaCloud**.</span><span class="sxs-lookup"><span data-stu-id="7b578-692">For Azure in China, select **AzureChinaCloud**.</span></span>
  ```powershell
  $env = Get-AzureRmEnvironment -Name <name of the environment>
  Login-AzureRmAccount -Environment $env
  Set-AzureRmContext -SubscriptionName <subscription name>
  Test-AzureRmVMAEMExtension -ResourceGroupName <resource group name> -VMName <virtual machine name>
  ```

3.  <span data-ttu-id="7b578-693">Entrez les données de votre compte et identifiez la machine virtuelle Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-693">Enter your account data and identify the Azure virtual machine.</span></span>

  ![Page d’entrée de l’applet de commande Azure spécifique à SAP Test-VMConfigForSAP_GUI][deployment-guide-figure-1200]

4. <span data-ttu-id="7b578-695">Le script teste la configuration de la machine virtuelle sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="7b578-695">The script tests the configuration of the virtual machine you select.</span></span>

  ![Sortie du test réussi de l’infrastructure d’analyse Azure pour SAP][deployment-guide-figure-1300]

<span data-ttu-id="7b578-697">Assurez-vous que le résultat de chaque vérification d’intégrité est **OK**.</span><span class="sxs-lookup"><span data-stu-id="7b578-697">Make sure that every health check result is **OK**.</span></span> <span data-ttu-id="7b578-698">Si certaines vérifications indiquent un état autre que **OK**, exécutez l’applet de commande update, comme décrit dans [Configurer l’extension d’analyse Azure améliorée pour SAP][deployment-guide-4.5].</span><span class="sxs-lookup"><span data-stu-id="7b578-698">If some checks do not display **OK**, run the update cmdlet as described in [Configure the Azure Enhanced Monitoring Extension for SAP][deployment-guide-4.5].</span></span> <span data-ttu-id="7b578-699">Attendez 15 minutes, puis effectuez de nouveau les vérifications décrites dans [Vérification de la disponibilité de l’analyse Azure améliorée pour SAP][deployment-guide-5.1] et [Contrôle d’intégrité de la configuration de l’infrastructure d’analyse Azure][deployment-guide-5.2].</span><span class="sxs-lookup"><span data-stu-id="7b578-699">Wait 15 minutes, and repeat the checks described in [Readiness check for Azure Enhanced Monitoring for SAP][deployment-guide-5.1] and [Health check for Azure Monitoring Infrastructure Configuration][deployment-guide-5.2].</span></span> <span data-ttu-id="7b578-700">Si les vérifications indiquent encore un problème avec certains ou tous les compteurs, consultez [Résolution de problèmes sur l’infrastructure d’analyse Azure pour SAP][deployment-guide-5.3].</span><span class="sxs-lookup"><span data-stu-id="7b578-700">If the checks still indicate a problem with some or all counters, see [Troubleshooting the Azure monitoring infrastructure for SAP][deployment-guide-5.3].</span></span>

### <span data-ttu-id="7b578-701"><a name="fe25a7da-4e4e-4388-8907-8abc2d33cfd8"></a>Résolution de problèmes sur l’infrastructure d’analyse Azure pour SAP</span><span class="sxs-lookup"><span data-stu-id="7b578-701"><a name="fe25a7da-4e4e-4388-8907-8abc2d33cfd8"></a>Troubleshooting the Azure monitoring infrastructure for SAP</span></span>

#### <a name="windowslogowindows-azure-performance-counters-do-not-show-up-at-all"></a>![Windows][Logo_Windows] <span data-ttu-id="7b578-703">Les compteurs de performances Azure ne s’affichent pas</span><span class="sxs-lookup"><span data-stu-id="7b578-703">Azure performance counters do not show up at all</span></span>
<span data-ttu-id="7b578-704">Le service Windows AzureEnhancedMonitoring recueille les indicateurs de performance dans Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-704">The AzureEnhancedMonitoring Windows service collects performance metrics in Azure.</span></span> <span data-ttu-id="7b578-705">Si le service n’a pas été installé correctement ou s’il n’est pas exécuté sur votre machine virtuelle, aucun indicateur de performance ne peut être collecté.</span><span class="sxs-lookup"><span data-stu-id="7b578-705">If the service has not been installed correctly or if it is not running in your VM, no performance metrics can be collected.</span></span>

##### <a name="the-installation-directory-of-the-azure-enhanced-monitoring-extension-is-empty"></a><span data-ttu-id="7b578-706">Le répertoire d’installation de l’extension d’analyse Azure améliorée est vide.</span><span class="sxs-lookup"><span data-stu-id="7b578-706">The installation directory of the Azure Enhanced Monitoring Extension is empty</span></span>

###### <a name="issue"></a><span data-ttu-id="7b578-707">Problème</span><span class="sxs-lookup"><span data-stu-id="7b578-707">Issue</span></span>
<span data-ttu-id="7b578-708">Le répertoire d’installation C:\\Packages\\Plugins\\Microsoft.AzureCAT.AzureEnhancedMonitoring.AzureCATExtensionHandler\\&lt;version>\\drop est vide.</span><span class="sxs-lookup"><span data-stu-id="7b578-708">The installation directory C:\\Packages\\Plugins\\Microsoft.AzureCAT.AzureEnhancedMonitoring.AzureCATExtensionHandler\\&lt;version>\\drop is empty.</span></span>

###### <a name="solution"></a><span data-ttu-id="7b578-709">Solution</span><span class="sxs-lookup"><span data-stu-id="7b578-709">Solution</span></span>
<span data-ttu-id="7b578-710">L’extension n’est pas installée.</span><span class="sxs-lookup"><span data-stu-id="7b578-710">The extension is not installed.</span></span> <span data-ttu-id="7b578-711">Déterminez s’il s’agit d’un problème de proxy (comme décrit précédemment).</span><span class="sxs-lookup"><span data-stu-id="7b578-711">Determine whether this is a proxy issue (as described earlier).</span></span> <span data-ttu-id="7b578-712">Vous devrez peut-être redémarrer la machine ou réexécuter le script de configuration `Set-AzureRmVMAEMExtension`.</span><span class="sxs-lookup"><span data-stu-id="7b578-712">You might need to restart the machine or rerun the `Set-AzureRmVMAEMExtension` configuration script.</span></span>

##### <a name="service-for-azure-enhanced-monitoring-does-not-exist"></a><span data-ttu-id="7b578-713">Le service d’analyse Azure améliorée n’existe pas.</span><span class="sxs-lookup"><span data-stu-id="7b578-713">Service for Azure Enhanced Monitoring does not exist</span></span>

###### <a name="issue"></a><span data-ttu-id="7b578-714">Problème</span><span class="sxs-lookup"><span data-stu-id="7b578-714">Issue</span></span>
<span data-ttu-id="7b578-715">Le service Windows AzureEnhancedMonitoring n’existe pas.</span><span class="sxs-lookup"><span data-stu-id="7b578-715">The AzureEnhancedMonitoring Windows service does not exist.</span></span>

<span data-ttu-id="7b578-716">La sortie de azperflib.exe génère une erreur :</span><span class="sxs-lookup"><span data-stu-id="7b578-716">Azperflib.exe output throws an error:</span></span>

<span data-ttu-id="7b578-717">![L’exécution d’azperflib.exe indique que le service de l’extension d’analyse Azure améliorée pour SAP n’est pas en cours d’exécution][deployment-guide-figure-1400]
<a name="figure-14"></a></span><span class="sxs-lookup"><span data-stu-id="7b578-717">![Execution of azperflib.exe indicates that the service of the Azure Enhanced Monitoring Extension for SAP is not running][deployment-guide-figure-1400]
<a name="figure-14"></a></span></span>

###### <a name="solution"></a><span data-ttu-id="7b578-718">Solution</span><span class="sxs-lookup"><span data-stu-id="7b578-718">Solution</span></span>
<span data-ttu-id="7b578-719">Si le service n’existe pas, cela signifie que l’extension d’analyse Azure améliorée pour SAP n’a pas été installée correctement.</span><span class="sxs-lookup"><span data-stu-id="7b578-719">If the service does not exist, the Azure Enhanced Monitoring Extension for SAP has not been installed correctly.</span></span> <span data-ttu-id="7b578-720">Redéployez l’extension en suivant la procédure décrite pour votre scénario de déploiement dans [Scénarios de déploiement de machines virtuelles pour SAP sur Azure][deployment-guide-3].</span><span class="sxs-lookup"><span data-stu-id="7b578-720">Redeploy the extension by using the steps described for your deployment scenario in [Deployment scenarios of VMs for SAP in Azure][deployment-guide-3].</span></span>

<span data-ttu-id="7b578-721">Une fois l’extension déployée, vérifiez de nouveau après une heure si les compteurs de performances Azure sont fournis dans la machine virtuelle Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-721">After you deploy the extension, after one hour, check again whether the Azure performance counters are provided in the Azure VM.</span></span>

##### <a name="service-for-azure-enhanced-monitoring-exists-but-fails-to-start"></a><span data-ttu-id="7b578-722">Le service d’analyse Azure améliorée Azure existe, mais ne parvient pas à démarrer</span><span class="sxs-lookup"><span data-stu-id="7b578-722">Service for Azure Enhanced Monitoring exists, but fails to start</span></span>

###### <a name="issue"></a><span data-ttu-id="7b578-723">Problème</span><span class="sxs-lookup"><span data-stu-id="7b578-723">Issue</span></span>
<span data-ttu-id="7b578-724">Le service Windows AzureEnhancedMonitoring existe et est activé, mais ne parvient pas à démarrer.</span><span class="sxs-lookup"><span data-stu-id="7b578-724">The AzureEnhancedMonitoring Windows service exists and is enabled, but fails to start.</span></span> <span data-ttu-id="7b578-725">Pour plus d’informations, consultez le journal des événements de l’application.</span><span class="sxs-lookup"><span data-stu-id="7b578-725">For more information, check the application event log.</span></span>

###### <a name="solution"></a><span data-ttu-id="7b578-726">Solution</span><span class="sxs-lookup"><span data-stu-id="7b578-726">Solution</span></span>
<span data-ttu-id="7b578-727">La configuration est incorrecte.</span><span class="sxs-lookup"><span data-stu-id="7b578-727">The configuration is incorrect.</span></span> <span data-ttu-id="7b578-728">Redémarrez l’extension d’analyse pour la machine virtuelle, comme décrit dans [Configurer l’extension d’analyse Azure améliorée pour SAP][deployment-guide-4.5].</span><span class="sxs-lookup"><span data-stu-id="7b578-728">Restart the monitoring extension for the VM, as described in [Configure the Azure Enhanced Monitoring Extension for SAP][deployment-guide-4.5].</span></span>

#### <a name="windowslogowindows-some-azure-performance-counters-are-missing"></a>![Windows][Logo_Windows] <span data-ttu-id="7b578-730">Certains compteurs de performances Azure sont manquants</span><span class="sxs-lookup"><span data-stu-id="7b578-730">Some Azure performance counters are missing</span></span>
<span data-ttu-id="7b578-731">Le service Windows AzureEnhancedMonitoring recueille les indicateurs de performance dans Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-731">The AzureEnhancedMonitoring Windows service collects performance metrics in Azure.</span></span> <span data-ttu-id="7b578-732">Le service obtient des données provenant de plusieurs sources.</span><span class="sxs-lookup"><span data-stu-id="7b578-732">The service gets data from several sources.</span></span> <span data-ttu-id="7b578-733">Certaines données de configuration sont collectées localement, et certains indicateurs de performance sont lus à partir des diagnostics Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-733">Some configuration data is collected locally, and some performance metrics are read from Azure Diagnostics.</span></span> <span data-ttu-id="7b578-734">Les compteurs de stockage sont utilisés à partir de votre enregistrement au niveau de l’abonnement de stockage.</span><span class="sxs-lookup"><span data-stu-id="7b578-734">Storage counters are used from your logging on the storage subscription level.</span></span>

<span data-ttu-id="7b578-735">Si la résolution des problèmes à l’aide de la note SAP [1999351] ne résout pas le problème, réexécutez le script de configuration `Set-AzureRmVMAEMExtension`.</span><span class="sxs-lookup"><span data-stu-id="7b578-735">If troubleshooting by using SAP Note [1999351] doesn't resolve the issue, rerun the `Set-AzureRmVMAEMExtension` configuration script.</span></span> <span data-ttu-id="7b578-736">Vous devrez peut-être attendre une heure, car il est possible que les compteurs d’analyse ou de diagnostics de stockage ne soient pas créés immédiatement après avoir été activés.</span><span class="sxs-lookup"><span data-stu-id="7b578-736">You might have to wait an hour because storage analytics or diagnostics counters might not be created immediately after they are enabled.</span></span> <span data-ttu-id="7b578-737">Si le problème persiste, ouvrez un message de support client SAP sur le composant BC-OP-NT-AZR pour Windows ou BC-OP-LNX-AZR pour une machine virtuelle Linux.</span><span class="sxs-lookup"><span data-stu-id="7b578-737">If the problem persists, open an SAP customer support message on the component BC-OP-NT-AZR for Windows or BC-OP-LNX-AZR for a Linux virtual machine.</span></span>

#### <a name="linuxlogolinux-azure-performance-counters-do-not-show-up-at-all"></a>![Linux][Logo_Linux] <span data-ttu-id="7b578-739">Les compteurs de performances Azure ne s’affichent pas</span><span class="sxs-lookup"><span data-stu-id="7b578-739">Azure performance counters do not show up at all</span></span>
<span data-ttu-id="7b578-740">Les indicateurs de performance dans Azure sont collectés par un démon.</span><span class="sxs-lookup"><span data-stu-id="7b578-740">Performance metrics in Azure are collected by a daemon.</span></span> <span data-ttu-id="7b578-741">Si le démon ne fonctionne pas, aucun indicateur de performance ne peut être collecté.</span><span class="sxs-lookup"><span data-stu-id="7b578-741">If the daemon is not running, no performance metrics can be collected.</span></span>

##### <a name="the-installation-directory-of-the-azure-enhanced-monitoring-extension-is-empty"></a><span data-ttu-id="7b578-742">Le répertoire d’installation de l’extension d’analyse Azure améliorée est vide.</span><span class="sxs-lookup"><span data-stu-id="7b578-742">The installation directory of the Azure Enhanced Monitoring extension is empty</span></span>

###### <a name="issue"></a><span data-ttu-id="7b578-743">Problème</span><span class="sxs-lookup"><span data-stu-id="7b578-743">Issue</span></span>
<span data-ttu-id="7b578-744">Le répertoire \\var\\lib\\waagent\\ ne contient pas de sous-répertoire pour l’extension d’analyse Azure améliorée.</span><span class="sxs-lookup"><span data-stu-id="7b578-744">The directory \\var\\lib\\waagent\\ does not have a subdirectory for the Azure Enhanced Monitoring extension.</span></span>

###### <a name="solution"></a><span data-ttu-id="7b578-745">Solution</span><span class="sxs-lookup"><span data-stu-id="7b578-745">Solution</span></span>
<span data-ttu-id="7b578-746">L’extension n’est pas installée.</span><span class="sxs-lookup"><span data-stu-id="7b578-746">The extension is not installed.</span></span> <span data-ttu-id="7b578-747">Déterminez s’il s’agit d’un problème de proxy (comme décrit précédemment).</span><span class="sxs-lookup"><span data-stu-id="7b578-747">Determine whether this is a proxy issue (as described earlier).</span></span> <span data-ttu-id="7b578-748">Vous devrez peut-être redémarrer la machine et/ou réexécuter le script de configuration `Set-AzureRmVMAEMExtension`.</span><span class="sxs-lookup"><span data-stu-id="7b578-748">You might need to restart the machine and/or rerun the `Set-AzureRmVMAEMExtension` configuration script.</span></span>

#### <a name="linuxlogolinux-some-azure-performance-counters-are-missing"></a>![Linux][Logo_Linux] <span data-ttu-id="7b578-750">Certains compteurs de performances Azure sont manquants</span><span class="sxs-lookup"><span data-stu-id="7b578-750">Some Azure performance counters are missing</span></span>
<span data-ttu-id="7b578-751">Les indicateurs de performance sur Azure sont collectés par un démon, qui obtient des données de plusieurs sources.</span><span class="sxs-lookup"><span data-stu-id="7b578-751">Performance metrics in Azure are collected by a daemon, which gets data from several sources.</span></span> <span data-ttu-id="7b578-752">Certaines données de configuration sont collectées localement, et certains indicateurs de performance sont lus à partir des diagnostics Azure.</span><span class="sxs-lookup"><span data-stu-id="7b578-752">Some configuration data is collected locally, and some performance metrics are read from Azure Diagnostics.</span></span> <span data-ttu-id="7b578-753">Les compteurs de stockage proviennent des journaux de votre abonnement de stockage.</span><span class="sxs-lookup"><span data-stu-id="7b578-753">Storage counters come from the logs in your storage subscription.</span></span>

<span data-ttu-id="7b578-754">Pour obtenir une liste complète et à jour des problèmes connus, consultez la note SAP [1999351], qui contient des informations de dépannage supplémentaires pour l’analyse Azure améliorée pour SAP.</span><span class="sxs-lookup"><span data-stu-id="7b578-754">For a complete and up-to-date list of known issues, see SAP Note [1999351], which has additional troubleshooting information for Enhanced Azure Monitoring for SAP.</span></span>

<span data-ttu-id="7b578-755">Si le recours à la note SAP [1999351] ne résout pas le problème, réexécutez le script de configuration `Set-AzureRmVMAEMExtension` comme décrit dans [Configurer l’extension d’analyse Azure améliorée pour SAP][deployment-guide-4.5].</span><span class="sxs-lookup"><span data-stu-id="7b578-755">If troubleshooting by using SAP Note [1999351] does not resolve the issue, rerun the `Set-AzureRmVMAEMExtension` configuration script as described in [Configure the Azure Enhanced Monitoring Extension for SAP][deployment-guide-4.5].</span></span> <span data-ttu-id="7b578-756">Vous devrez peut-être attendre une heure, car il est possible que les compteurs d’analyse ou de diagnostics de stockage ne soient pas créés immédiatement après avoir été activés.</span><span class="sxs-lookup"><span data-stu-id="7b578-756">You might have to wait for an hour because storage analytics or diagnostics counters might not be created immediately after they are enabled.</span></span> <span data-ttu-id="7b578-757">Si le problème persiste, ouvrez un message de support client SAP sur le composant BC-OP-NT-AZR pour Windows ou BC-OP-LNX-AZR pour une machine virtuelle Linux.</span><span class="sxs-lookup"><span data-stu-id="7b578-757">If the problem persists, open an SAP customer support message on the component BC-OP-NT-AZR for Windows or BC-OP-LNX-AZR for a Linux virtual machine.</span></span>
