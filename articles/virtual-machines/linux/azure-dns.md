---
title: "Options de résolution de noms DNS pour les machines virtuelles Linux dans Azure"
description: "Scénarios de résolution de noms pour les machines virtuelles Linux dans Azure IaaS, notamment les services DNS fournis, le DNS externe hybride et l’apport de son propre serveur DNS."
services: virtual-machines
documentationcenter: na
author: RicksterCDN
manager: timlt
editor: tysonn
ms.assetid: 787a1e04-cebf-4122-a1b4-1fcf0a2bbf5f
ms.service: virtual-machines-linux
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 10/19/2016
ms.author: rclaus
ms.openlocfilehash: cc06ee9305b4d3034154a0825c1aea53fe446f80
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/11/2017
---
# <a name="dns-name-resolution-options-for-linux-virtual-machines-in-azure"></a><span data-ttu-id="2d1ed-103">Options de résolution de noms DNS pour les machines virtuelles Linux dans Azure</span><span class="sxs-lookup"><span data-stu-id="2d1ed-103">DNS Name Resolution options for Linux virtual machines in Azure</span></span>
<span data-ttu-id="2d1ed-104">Azure fournit une résolution des noms DNS par défaut pour toutes les machines virtuelles d’un même réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-104">Azure provides DNS name resolution by default for all virtual machines that are in a single virtual network.</span></span> <span data-ttu-id="2d1ed-105">Vous pouvez implémenter votre propre solution de résolution de noms DNS en configurant vos propres services DNS sur vos machines virtuelles hébergées sur Azure.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-105">You can implement your own DNS name resolution solution by configuring your own DNS services on your virtual machines that Azure hosts.</span></span> <span data-ttu-id="2d1ed-106">Les scénarios suivants vous aideront à choisir la solution qui fonctionne dans votre situation.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-106">The following scenarios should help you choose the one that works for your situation.</span></span>

* [<span data-ttu-id="2d1ed-107">Résolution de noms fournie par Azure</span><span class="sxs-lookup"><span data-stu-id="2d1ed-107">Name resolution that Azure provides</span></span>](#azure-provided-name-resolution)
* [<span data-ttu-id="2d1ed-108">Résolution de noms à l’aide de votre propre serveur DNS</span><span class="sxs-lookup"><span data-stu-id="2d1ed-108">Name resolution using your own DNS server</span></span>](#name-resolution-using-your-own-dns-server)

<span data-ttu-id="2d1ed-109">Le type de résolution de noms que vous utilisez dépend de la façon dont vos machines virtuelles et vos instances de rôle doivent communiquer entre elles.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-109">The type of name resolution that you use depends on how your virtual machines and role instances need to communicate with each other.</span></span>

<span data-ttu-id="2d1ed-110">Le tableau suivant montre des scénarios et les solutions de résolution de noms correspondantes :</span><span class="sxs-lookup"><span data-stu-id="2d1ed-110">The following table illustrates scenarios and corresponding name resolution solutions:</span></span>

| <span data-ttu-id="2d1ed-111">**Scénario**</span><span class="sxs-lookup"><span data-stu-id="2d1ed-111">**Scenario**</span></span> | <span data-ttu-id="2d1ed-112">**Solution**</span><span class="sxs-lookup"><span data-stu-id="2d1ed-112">**Solution**</span></span> | <span data-ttu-id="2d1ed-113">**Suffixe**</span><span class="sxs-lookup"><span data-stu-id="2d1ed-113">**Suffix**</span></span> |
| --- | --- | --- |
| <span data-ttu-id="2d1ed-114">Résolution de noms entre des instances de rôle ou des machines virtuelles situées dans le même réseau virtuel</span><span class="sxs-lookup"><span data-stu-id="2d1ed-114">Name resolution between role instances or virtual machines in the same virtual network</span></span> |[<span data-ttu-id="2d1ed-115">Résolution de noms fournie par Azure</span><span class="sxs-lookup"><span data-stu-id="2d1ed-115">Name resolution that Azure provides</span></span>](#azure-provided-name-resolution) |<span data-ttu-id="2d1ed-116">nom d’hôte ou nom de domaine complet</span><span class="sxs-lookup"><span data-stu-id="2d1ed-116">hostname or fully-qualified domain name (FQDN)</span></span> |
| <span data-ttu-id="2d1ed-117">Résolution de noms entre des instances de rôle ou des machines virtuelles situées dans des réseaux virtuels différents</span><span class="sxs-lookup"><span data-stu-id="2d1ed-117">Name resolution between role instances or virtual machines in different virtual networks</span></span> |<span data-ttu-id="2d1ed-118">Serveurs DNS gérés par le client qui transfèrent les requêtes entre les réseaux virtuels pour une résolution par Azure (proxy DNS).</span><span class="sxs-lookup"><span data-stu-id="2d1ed-118">Customer-managed DNS servers that forward queries between virtual networks for resolution by Azure (DNS proxy).</span></span> <span data-ttu-id="2d1ed-119">Consultez [Résolution de noms à l’aide de votre propre serveur DNS](#name-resolution-using-your-own-dns-server).</span><span class="sxs-lookup"><span data-stu-id="2d1ed-119">See [Name resolution using your own DNS server](#name-resolution-using-your-own-dns-server).</span></span> |<span data-ttu-id="2d1ed-120">Nom de domaine complet uniquement</span><span class="sxs-lookup"><span data-stu-id="2d1ed-120">FQDN only</span></span> |
| <span data-ttu-id="2d1ed-121">Résolution des noms de service et d’ordinateur locaux à partir des instances de rôle ou des machines virtuelles dans Azure</span><span class="sxs-lookup"><span data-stu-id="2d1ed-121">Resolution of on-premises computers and service names from role instances or virtual machines in Azure</span></span> |<span data-ttu-id="2d1ed-122">Serveurs DNS gérés par le client (par exemple contrôleur de domaine local, contrôleur de domaine en lecture seule local ou serveur DNS secondaire synchronisé via des transferts de zone).</span><span class="sxs-lookup"><span data-stu-id="2d1ed-122">Customer-managed DNS servers (for example, on-premises domain controller, local read-only domain controller, or a DNS secondary synced by using zone transfers).</span></span> <span data-ttu-id="2d1ed-123">Consultez [Résolution de noms à l’aide de votre propre serveur DNS](#name-resolution-using-your-own-dns-server).</span><span class="sxs-lookup"><span data-stu-id="2d1ed-123">See [Name resolution using your own DNS server](#name-resolution-using-your-own-dns-server).</span></span> |<span data-ttu-id="2d1ed-124">Nom de domaine complet uniquement</span><span class="sxs-lookup"><span data-stu-id="2d1ed-124">FQDN only</span></span> |
| <span data-ttu-id="2d1ed-125">Résolution de noms d’hôte Azure à partir d’ordinateurs locaux</span><span class="sxs-lookup"><span data-stu-id="2d1ed-125">Resolution of Azure hostnames from on-premises computers</span></span> |<span data-ttu-id="2d1ed-126">Transfert des requêtes à un serveur proxy DNS géré par le client dans le réseau virtuel correspondant.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-126">Forward queries to a customer-managed DNS proxy server in the corresponding virtual network.</span></span> <span data-ttu-id="2d1ed-127">Le serveur proxy transfère les requêtes à Azure pour résolution.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-127">The proxy server forwards queries to Azure for resolution.</span></span> <span data-ttu-id="2d1ed-128">Consultez [Résolution de noms à l’aide de votre propre serveur DNS](#name-resolution-using-your-own-dns-server).</span><span class="sxs-lookup"><span data-stu-id="2d1ed-128">See [Name resolution using your own DNS server](#name-resolution-using-your-own-dns-server).</span></span> |<span data-ttu-id="2d1ed-129">Nom de domaine complet uniquement</span><span class="sxs-lookup"><span data-stu-id="2d1ed-129">FQDN only</span></span> |
| <span data-ttu-id="2d1ed-130">DNS inversé pour les adresses IP internes</span><span class="sxs-lookup"><span data-stu-id="2d1ed-130">Reverse DNS for internal IPs</span></span> |[<span data-ttu-id="2d1ed-131">Résolution de noms à l’aide de votre propre serveur DNS</span><span class="sxs-lookup"><span data-stu-id="2d1ed-131">Name resolution using your own DNS server</span></span>](#name-resolution-using-your-own-dns-server) |<span data-ttu-id="2d1ed-132">n/a</span><span class="sxs-lookup"><span data-stu-id="2d1ed-132">n/a</span></span> |

## <a name="name-resolution-that-azure-provides"></a><span data-ttu-id="2d1ed-133">Résolution de noms fournie par Azure</span><span class="sxs-lookup"><span data-stu-id="2d1ed-133">Name resolution that Azure provides</span></span>
<span data-ttu-id="2d1ed-134">En plus de la résolution de noms DNS publics, Azure fournit la résolution de noms interne pour les machines virtuelles et les instances de rôle qui se trouvent dans le même réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-134">Along with resolution of public DNS names, Azure provides internal name resolution for virtual machines and role instances that are in the same virtual network.</span></span> <span data-ttu-id="2d1ed-135">Dans les réseaux virtuels basés sur Azure Resource Manager, le suffixe DNS est cohérent à travers le réseau virtuel ; le nom de domaine complet n’est pas nécessaire.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-135">In virtual networks that are based on Azure Resource Manager, the DNS suffix is consistent across the virtual network; the FQDN is not needed.</span></span> <span data-ttu-id="2d1ed-136">Les noms DNS peuvent être affectés à la fois à des cartes réseau et à des machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-136">DNS names can be assigned to both network interface cards (NICs) and virtual machines.</span></span> <span data-ttu-id="2d1ed-137">Bien que la résolution de noms fournie par Azure ne nécessite aucune configuration, elle n’est pas appropriée dans tous les scénarios de déploiement, comme le montre le tableau précédent.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-137">Although the name resolution that Azure provides does not require any configuration, it is not the appropriate choice for all deployment scenarios, as seen on the preceding table.</span></span>

### <a name="features-and-considerations"></a><span data-ttu-id="2d1ed-138">Fonctionnalités et considérations</span><span class="sxs-lookup"><span data-stu-id="2d1ed-138">Features and considerations</span></span>
<span data-ttu-id="2d1ed-139">**Fonctionnalités :**</span><span class="sxs-lookup"><span data-stu-id="2d1ed-139">**Features:**</span></span>

* <span data-ttu-id="2d1ed-140">Aucune configuration n’est nécessaire pour utiliser la résolution de noms fournie par Azure.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-140">No configuration is required to use name resolution that Azure provides.</span></span>
* <span data-ttu-id="2d1ed-141">Le service de résolution de noms fournie par Azure bénéficie d’une haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-141">The name resolution service that Azure provides is highly available.</span></span> <span data-ttu-id="2d1ed-142">Vous n’avez pas besoin de créer et de gérer les clusters de vos propres serveurs DNS.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-142">You don't need to create and manage clusters of your own DNS servers.</span></span>
* <span data-ttu-id="2d1ed-143">Le service de résolution de noms fourni par Azure peut être utilisé avec vos propres serveurs DNS pour résoudre à la fois les noms d’hôte locaux et les noms d’hôte Azure.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-143">The name resolution service that Azure provides can be used along with your own DNS servers to resolve both on-premises and Azure hostnames.</span></span>
* <span data-ttu-id="2d1ed-144">La résolution de noms est effectuée entre les machines virtuelles des réseaux virtuels sans qu’un nom de domaine complet soit nécessaire.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-144">Name resolution is provided between virtual machines in virtual networks without need for the FQDN.</span></span>
* <span data-ttu-id="2d1ed-145">Vous pouvez utiliser des noms d’hôtes qui décrivent vos déploiements de façon plus appropriée, au lieu de noms générés automatiquement.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-145">You can use hostnames that best describe your deployments rather than working with auto-generated names.</span></span>

<span data-ttu-id="2d1ed-146">**Considérations :**</span><span class="sxs-lookup"><span data-stu-id="2d1ed-146">**Considerations:**</span></span>

* <span data-ttu-id="2d1ed-147">Le suffixe DNS créé par Azure ne peut pas être modifié.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-147">The DNS suffix that Azure creates cannot be modified.</span></span>
* <span data-ttu-id="2d1ed-148">Vous ne pouvez pas enregistrer manuellement vos propres enregistrements.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-148">You cannot manually register your own records.</span></span>
* <span data-ttu-id="2d1ed-149">WINS et NetBIOS ne sont pas pris en charge.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-149">WINS and NetBIOS are not supported.</span></span>
* <span data-ttu-id="2d1ed-150">Les noms d’hôte doivent être compatibles avec DNS.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-150">Hostnames must be DNS-compatible.</span></span>
    <span data-ttu-id="2d1ed-151">Les noms doivent comporter uniquement les caractères 0-9, a-z et « - », et ils ne peuvent pas commencer ou se terminer par « - ».</span><span class="sxs-lookup"><span data-stu-id="2d1ed-151">Names must use only 0-9, a-z, and '-', and they cannot start or end with a '-'.</span></span> <span data-ttu-id="2d1ed-152">Consultez RFC 3696 Section 2.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-152">See RFC 3696 Section 2.</span></span>
* <span data-ttu-id="2d1ed-153">Le trafic des requêtes DNS est limité pour chaque machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-153">DNS query traffic is throttled for each virtual machine.</span></span> <span data-ttu-id="2d1ed-154">Cette limitation ne devrait pas avoir d’incidence sur la plupart des applications.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-154">Throttling shouldn't impact most applications.</span></span>  <span data-ttu-id="2d1ed-155">Si la limitation de requêtes est respectée, assurez-vous que la mise en cache côté client est activée.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-155">If request throttling is observed, ensure that client-side caching is enabled.</span></span>  <span data-ttu-id="2d1ed-156">Pour plus d’informations, consultez [Tirer le meilleur parti de la résolution de noms fournie par Azure](#getting-the-most-from-name-resolution-that-azure-provides).</span><span class="sxs-lookup"><span data-stu-id="2d1ed-156">For more information, see [Getting the most from name resolution that Azure provides](#getting-the-most-from-name-resolution-that-azure-provides).</span></span>

### <a name="getting-the-most-from-name-resolution-that-azure-provides"></a><span data-ttu-id="2d1ed-157">Tirer le meilleur parti de la résolution de noms fournie par Azure</span><span class="sxs-lookup"><span data-stu-id="2d1ed-157">Getting the most from name resolution that Azure provides</span></span>
<span data-ttu-id="2d1ed-158">**Mise en cache côté client :**</span><span class="sxs-lookup"><span data-stu-id="2d1ed-158">**Client-side caching:**</span></span>

<span data-ttu-id="2d1ed-159">Certaines requêtes DNS ne sont pas envoyées sur le réseau.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-159">Some DNS queries are not sent across the network.</span></span> <span data-ttu-id="2d1ed-160">La mise en cache côté client permet de réduire la latence et d’améliorer la résilience face aux incohérences réseau en résolvant les requêtes DNS récurrentes à partir d’un cache local.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-160">Client-side caching helps reduce latency and improve resilience to network inconsistencies by resolving recurring DNS queries from a local cache.</span></span> <span data-ttu-id="2d1ed-161">Les enregistrements DNS ont une durée de vie, qui permet au cache de les stocker aussi longtemps que possible sans impact sur leur actualité.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-161">DNS records contain a Time-To-Live (TTL), which enables the cache to store the record for as long as possible without impacting record freshness.</span></span> <span data-ttu-id="2d1ed-162">Pour cette raison, la mise en cache côté client convient donc à la plupart des situations.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-162">As a result, client-side caching is suitable for most situations.</span></span>

<span data-ttu-id="2d1ed-163">Certaines distributions Linux n’incluent pas la mise en cache par défaut.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-163">Some Linux distributions do not include caching by default.</span></span> <span data-ttu-id="2d1ed-164">Nous vous recommandons d’ajouter un cache à chaque machine virtuelle de Linux après avoir vérifié qu’il n’existe pas déjà un cache local.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-164">We recommend that you add a cache to each Linux virtual machine after you check that there isn't a local cache already.</span></span>

<span data-ttu-id="2d1ed-165">Plusieurs packages de mise en cache DNS sont disponibles, comme dnsmasq.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-165">Several different DNS caching packages, such as dnsmasq, are available.</span></span> <span data-ttu-id="2d1ed-166">Voici les étapes nécessaires pour installer dnsmasq sur les distributions plus courantes :</span><span class="sxs-lookup"><span data-stu-id="2d1ed-166">Here are the steps to install dnsmasq on the most common distributions:</span></span>

<span data-ttu-id="2d1ed-167">**Ubuntu (utilise resolvconf)**</span><span class="sxs-lookup"><span data-stu-id="2d1ed-167">**Ubuntu (uses resolvconf)**</span></span>
  * <span data-ttu-id="2d1ed-168">Installez le package dnsmasq (« sudo apt-get install dnsmasq »).</span><span class="sxs-lookup"><span data-stu-id="2d1ed-168">Install the dnsmasq package (“sudo apt-get install dnsmasq”).</span></span>

<span data-ttu-id="2d1ed-169">**SUSE (utilise netconf)**:</span><span class="sxs-lookup"><span data-stu-id="2d1ed-169">**SUSE (uses netconf)**:</span></span>
1. <span data-ttu-id="2d1ed-170">Installez le package dnsmasq (« sudo zypper install dnsmasq »).</span><span class="sxs-lookup"><span data-stu-id="2d1ed-170">Install the dnsmasq package (“sudo zypper install dnsmasq”).</span></span>
2. <span data-ttu-id="2d1ed-171">Activez le service dnsmasq (« systemctl enable dnsmasq.service »).</span><span class="sxs-lookup"><span data-stu-id="2d1ed-171">Enable the dnsmasq service (“systemctl enable dnsmasq.service”).</span></span>
3. <span data-ttu-id="2d1ed-172">Démarrez le service dnsmasq (« systemctl start dnsmasq.service »).</span><span class="sxs-lookup"><span data-stu-id="2d1ed-172">Start the dnsmasq service (“systemctl start dnsmasq.service”).</span></span>
4. <span data-ttu-id="2d1ed-173">Éditez « /etc/sysconfig/network/config » et remplacez NETCONFIG_DNS_FORWARDER="" par NETCONFIG_DNS_FORWARDER="dnsmasq".</span><span class="sxs-lookup"><span data-stu-id="2d1ed-173">Edit “/etc/sysconfig/network/config”, and change NETCONFIG_DNS_FORWARDER="" to ”dnsmasq”.</span></span>
5. <span data-ttu-id="2d1ed-174">Mettez à jour resolv.conf (« netconfig update ») pour définir le cache en tant que résolveur DNS local.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-174">Update resolv.conf ("netconfig update") to set the cache as the local DNS resolver.</span></span>

<span data-ttu-id="2d1ed-175">**CentOS de Rogue Wave Software (anciennement OpenLogic, utilise NetworkManager)**</span><span class="sxs-lookup"><span data-stu-id="2d1ed-175">**CentOS by Rogue Wave Software (formerly OpenLogic; uses NetworkManager)**</span></span>
1. <span data-ttu-id="2d1ed-176">Installez le package dnsmasq (« sudo yum install dnsmasq »).</span><span class="sxs-lookup"><span data-stu-id="2d1ed-176">Install the dnsmasq package (“sudo yum install dnsmasq”).</span></span>
2. <span data-ttu-id="2d1ed-177">Activez le service dnsmasq (« systemctl enable dnsmasq.service »).</span><span class="sxs-lookup"><span data-stu-id="2d1ed-177">Enable the dnsmasq service (“systemctl enable dnsmasq.service”).</span></span>
3. <span data-ttu-id="2d1ed-178">Démarrez le service dnsmasq (« systemctl start dnsmasq.service »).</span><span class="sxs-lookup"><span data-stu-id="2d1ed-178">Start the dnsmasq service (“systemctl start dnsmasq.service”).</span></span>
4. <span data-ttu-id="2d1ed-179">Ajoutez « prepend domain-name-servers 127.0.0.1; » à « /etc/dhclient-eth0.conf ».</span><span class="sxs-lookup"><span data-stu-id="2d1ed-179">Add “prepend domain-name-servers 127.0.0.1;” to “/etc/dhclient-eth0.conf”.</span></span>
5. <span data-ttu-id="2d1ed-180">Redémarrez le service réseau (« service network restart ») pour définir le cache en tant que résolveur DNS local.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-180">Restart the network service (“service network restart”) to set the cache as the local DNS resolver</span></span>

> [!NOTE]
> <span data-ttu-id="2d1ed-181">Le package « dnsmasq » constitue l’un des nombreux caches DNS disponibles pour Linux.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-181">: The 'dnsmasq' package is only one of the many DNS caches that are available for Linux.</span></span> <span data-ttu-id="2d1ed-182">Avant de l’utiliser, vérifiez son adéquation à vos besoins et qu’aucun autre cache n’est installé.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-182">Before you use it, check its suitability for your needs and that no other cache is installed.</span></span>
>
>

<span data-ttu-id="2d1ed-183">**Nouvelles tentatives côté client**</span><span class="sxs-lookup"><span data-stu-id="2d1ed-183">**Client-side retries**</span></span>

<span data-ttu-id="2d1ed-184">DNS est principalement un protocole UDP.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-184">DNS is primarily a UDP protocol.</span></span> <span data-ttu-id="2d1ed-185">Comme le protocole UDP ne garantit pas la remise des messages, le protocole DNS gère lui-même la logique de nouvelle tentative.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-185">Because the UDP protocol doesn't guarantee message delivery, the DNS protocol itself handles retry logic.</span></span> <span data-ttu-id="2d1ed-186">Chaque client DNS (son système d’exploitation) peut appliquer une logique de nouvelle tentative différente selon la préférence de son créateur :</span><span class="sxs-lookup"><span data-stu-id="2d1ed-186">Each DNS client (operating system) can exhibit different retry logic depending on the creator's preference:</span></span>

* <span data-ttu-id="2d1ed-187">Les systèmes d’exploitation Windows effectuent une nouvelle tentative après une seconde, puis à nouveau après deux secondes, quatre secondes et encore quatre secondes.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-187">Windows operating systems retry after one second and then again after another two, four, and another four seconds.</span></span>
* <span data-ttu-id="2d1ed-188">La configuration Linux par défaut effectue une nouvelle tentative après cinq secondes.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-188">The default Linux setup retries after five seconds.</span></span>  <span data-ttu-id="2d1ed-189">Vous devez modifier ce paramètre pour effectuer cinq nouvelles tentatives à des intervalles d’une seconde.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-189">You should change this to retry five times at one-second intervals.</span></span>  

<span data-ttu-id="2d1ed-190">Pour vérifier les paramètres actuels sur une machine virtuelle Linux, exécutez la commande « cat /etc/resolv.conf » et regardez la ligne « options », par exemple :</span><span class="sxs-lookup"><span data-stu-id="2d1ed-190">To check the current settings on a Linux virtual machine, 'cat /etc/resolv.conf', and look at the 'options' line, for example:</span></span>

    options timeout:1 attempts:5

<span data-ttu-id="2d1ed-191">Le fichier resolv.conf est généré automatiquement et ne doit pas être modifié.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-191">The resolv.conf file is auto-generated and should not be edited.</span></span> <span data-ttu-id="2d1ed-192">Les étapes spécifiques pour l’ajout de la ligne « options » varient selon la distribution :</span><span class="sxs-lookup"><span data-stu-id="2d1ed-192">The specific steps that add the 'options' line vary by distribution:</span></span>

<span data-ttu-id="2d1ed-193">**Ubuntu** (utilise resolvconf)</span><span class="sxs-lookup"><span data-stu-id="2d1ed-193">**Ubuntu** (uses resolvconf)</span></span>
1. <span data-ttu-id="2d1ed-194">Ajoutez la ligne « options » à « /etc/resolveconf/resolv.conf.d/head »</span><span class="sxs-lookup"><span data-stu-id="2d1ed-194">Add the options line to '/etc/resolveconf/resolv.conf.d/head'.</span></span>
2. <span data-ttu-id="2d1ed-195">Exécutez « resolvconf -u » pour mettre à jour.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-195">Run 'resolvconf -u' to update.</span></span>

<span data-ttu-id="2d1ed-196">**SUSE** (utilise netconf)</span><span class="sxs-lookup"><span data-stu-id="2d1ed-196">**SUSE** (uses netconf)</span></span>
1. <span data-ttu-id="2d1ed-197">Ajoutez « timeout:1 attempts:5 » au paramètre NETCONFIG_DNS_RESOLVER_OPTIONS="" dans « /etc/sysconfig/network/config ».</span><span class="sxs-lookup"><span data-stu-id="2d1ed-197">Add 'timeout:1 attempts:5' to the NETCONFIG_DNS_RESOLVER_OPTIONS="" parameter in '/etc/sysconfig/network/config'.</span></span>
2. <span data-ttu-id="2d1ed-198">Exécutez « netconfig update » pour mettre à jour.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-198">Run 'netconfig update' to update.</span></span>

<span data-ttu-id="2d1ed-199">**CentOS de Rogue Wave Software (anciennement OpenLogic)** (utilise NetworkManager)</span><span class="sxs-lookup"><span data-stu-id="2d1ed-199">**CentOS by Rogue Wave Software (formerly OpenLogic)** (uses NetworkManager)</span></span>
1. <span data-ttu-id="2d1ed-200">Ajoutez « echo "options timeout:1 attempts:5" » à « /etc/NetworkManager/dispatcher.d/11-dhclient ».</span><span class="sxs-lookup"><span data-stu-id="2d1ed-200">Add 'echo "options timeout:1 attempts:5"' to '/etc/NetworkManager/dispatcher.d/11-dhclient'.</span></span>
2. <span data-ttu-id="2d1ed-201">Exécutez « service network restart » pour mettre à jour.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-201">Run 'service network restart' to update.</span></span>

## <a name="name-resolution-using-your-own-dns-server"></a><span data-ttu-id="2d1ed-202">Résolution de noms à l’aide de votre propre serveur DNS</span><span class="sxs-lookup"><span data-stu-id="2d1ed-202">Name resolution using your own DNS server</span></span>
<span data-ttu-id="2d1ed-203">Vos besoins en matière de résolution de noms peuvent aller au-delà des fonctions fournies par Azure.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-203">Your name resolution needs may go beyond the features that Azure provides.</span></span> <span data-ttu-id="2d1ed-204">Par exemple, vous pouvez avoir besoin d’une résolution DNS entre des réseaux virtuels.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-204">For example, you might require DNS resolution between virtual networks.</span></span> <span data-ttu-id="2d1ed-205">Pour couvrir ce scénario, vous pouvez utiliser vos propres serveurs DNS.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-205">To cover this scenario, you can use your own DNS servers.</span></span>  

<span data-ttu-id="2d1ed-206">Les serveurs DNS dans un réseau virtuel peuvent transférer les requêtes DNS vers les résolveurs récursifs d’Azure pour résoudre les noms d’hôtes qui se trouvent dans le même réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-206">DNS servers within a virtual network can forward DNS queries to recursive resolvers of Azure to resolve hostnames that are in the same virtual network.</span></span> <span data-ttu-id="2d1ed-207">Par exemple, un serveur DNS qui s’exécute dans Azure peut répondre aux requêtes DNS concernant les fichiers de sa propre zone DNS et transférer toutes les autres requêtes à Azure.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-207">For example, a DNS server that runs in Azure can respond to DNS queries for its own DNS zone files and forward all other queries to Azure.</span></span> <span data-ttu-id="2d1ed-208">Cette fonctionnalité permet aux machines virtuelles de voir vos entrées dans les fichiers de votre zone et les noms d’hôtes fournis par Azure (via le redirecteur).</span><span class="sxs-lookup"><span data-stu-id="2d1ed-208">This functionality enables virtual machines to see both your entries in your zone files and hostnames that Azure provides (via the forwarder).</span></span> <span data-ttu-id="2d1ed-209">Les résolveurs récursifs d’Azure sont accessibles via l’adresse IP virtuelle 168.63.129.16.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-209">Access to the recursive resolvers of Azure is provided via the virtual IP 168.63.129.16.</span></span>

<span data-ttu-id="2d1ed-210">Le transfert DNS permet aussi la résolution DNS entre des réseaux virtuels et permet à vos machines locales de résoudre les noms d’hôtes fournis par Azure.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-210">DNS forwarding also enables DNS resolution between virtual networks and enables your on-premises machines to resolve hostnames that Azure provides.</span></span> <span data-ttu-id="2d1ed-211">Pour résoudre le nom d’hôte d’une machine virtuelle, la machine virtuelle du serveur DNS doit se trouver dans le même réseau virtuel et être configurée pour transférer les requêtes de nom d’hôte à Azure.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-211">To resolve a virtual machine's hostname, the DNS server virtual machine must reside in the same virtual network and be configured to forward hostname queries to Azure.</span></span> <span data-ttu-id="2d1ed-212">Comme le suffixe DNS est différent dans chaque réseau virtuel, vous pouvez utiliser des règles de redirection conditionnelles pour envoyer les requêtes DNS au réseau virtuel approprié en vue de la résolution.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-212">Because the DNS suffix is different in each virtual network, you can use conditional forwarding rules to send DNS queries to the correct virtual network for resolution.</span></span> <span data-ttu-id="2d1ed-213">L’image suivante montre deux réseaux virtuels et un réseau local effectuant une résolution DNS entre réseaux virtuels à l’aide de cette méthode :</span><span class="sxs-lookup"><span data-stu-id="2d1ed-213">The following image shows two virtual networks and an on-premises network doing DNS resolution between virtual networks by using this method:</span></span>

![Résolution DNS entre réseaux virtuels](./media/azure-dns/inter-vnet-dns.png)

<span data-ttu-id="2d1ed-215">Quand vous utilisez la résolution de noms fournie par Azure, le suffixe DNS interne est fourni à chaque machine virtuelle via DHCP.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-215">When you use name resolution that Azure provides, the internal DNS suffix is provided to each virtual machine by using DHCP.</span></span> <span data-ttu-id="2d1ed-216">Quand vous utilisez votre propre solution de résolution de noms, ce suffixe n’est pas fourni aux machines virtuelles, car il interfère avec d’autres architectures DNS.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-216">When you use your own name resolution solution, this suffix is not supplied to virtual machines because the suffix interferes with other DNS architectures.</span></span> <span data-ttu-id="2d1ed-217">Pour référencer des machines par le nom de domaine complet ou pour configurer le suffixe sur vos machines virtuelles, vous pouvez utiliser PowerShell ou l’API pour déterminer le suffixe :</span><span class="sxs-lookup"><span data-stu-id="2d1ed-217">To refer to machines by FQDN or to configure the suffix on your virtual machines, you can use PowerShell or the API to determine the suffix:</span></span>

* <span data-ttu-id="2d1ed-218">Pour les réseaux virtuels gérés par Azure Resource Manager, le suffixe est disponible via la ressource de [carte réseau](https://msdn.microsoft.com/library/azure/mt163668.aspx).</span><span class="sxs-lookup"><span data-stu-id="2d1ed-218">For virtual networks that are managed by Azure Resource Manager, the suffix is available via the [network interface card](https://msdn.microsoft.com/library/azure/mt163668.aspx) resource.</span></span> <span data-ttu-id="2d1ed-219">Vous pouvez également exécuter la commande `azure network public-ip show <resource group> <pip name>` pour afficher les détails de votre adresse IP publique, qui inclut le nom de domaine complet de la carte réseau.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-219">You can also run the `azure network public-ip show <resource group> <pip name>` command to display the details of your public IP, which includes the FQDN of the NIC.</span></span>

<span data-ttu-id="2d1ed-220">Si la redirection des requêtes vers Azure ne suffit pas, vous devez fournir votre propre solution DNS.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-220">If forwarding queries to Azure doesn't suit your needs, you need to provide your own DNS solution.</span></span>  <span data-ttu-id="2d1ed-221">Votre solution DNS doit :</span><span class="sxs-lookup"><span data-stu-id="2d1ed-221">Your DNS solution needs to:</span></span>

* <span data-ttu-id="2d1ed-222">Fournir la résolution de nom d’hôte approprié, par exemple par le biais de [DDNS](../../virtual-network/virtual-networks-name-resolution-ddns.md).</span><span class="sxs-lookup"><span data-stu-id="2d1ed-222">Provide appropriate hostname resolution, for example via [DDNS](../../virtual-network/virtual-networks-name-resolution-ddns.md).</span></span> <span data-ttu-id="2d1ed-223">Si vous utilisez DDNS, il peut être nécessaire de désactiver le nettoyage des enregistrements DNS.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-223">If you use DDNS, you might need to disable DNS record scavenging.</span></span> <span data-ttu-id="2d1ed-224">Les baux DHCP d’Azure sont très longs et le nettoyage peut supprimer prématurément des enregistrements DNS.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-224">DHCP leases of Azure are very long and scavenging may remove DNS records prematurely.</span></span>
* <span data-ttu-id="2d1ed-225">Fournir la résolution récursive appropriée pour permettre la résolution de noms de domaines externes.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-225">Provide appropriate recursive resolution to allow resolution of external domain names.</span></span>
* <span data-ttu-id="2d1ed-226">Être accessible (TCP et UDP sur le port 53) à partir des clients dont elle traite les demandes et être en mesure d’accéder à Internet.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-226">Be accessible (TCP and UDP on port 53) from the clients it serves and be able to access the Internet.</span></span>
* <span data-ttu-id="2d1ed-227">Être protégée contre tout accès à partir d’Internet, pour atténuer les menaces posées par les agents externes.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-227">Be secured against access from the Internet to mitigate threats posed by external agents.</span></span>

> [!NOTE]
> <span data-ttu-id="2d1ed-228">Pour de meilleures performances, quand vous utilisez des machines virtuelles sur des serveurs DNS Azure, désactivez IPv6 et affectez une [adresse IP publique de niveau instance](../../virtual-network/virtual-networks-instance-level-public-ip.md) à chaque machine virtuelle du serveur DNS.</span><span class="sxs-lookup"><span data-stu-id="2d1ed-228">For best performance, when you use virtual machines in Azure DNS servers, disable IPv6 and assign an [Instance-Level Public IP](../../virtual-network/virtual-networks-instance-level-public-ip.md) to each DNS server virtual machine.</span></span>  
>
>
