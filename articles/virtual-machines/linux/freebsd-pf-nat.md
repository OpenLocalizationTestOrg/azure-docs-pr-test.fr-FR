---
title: toocreate de filtre de paquets de FreeBSD aaaUse un pare-feu dans Azure | Documents Microsoft
description: "Découvrez comment toodeploy un NAT de pare-feu à l’aide de FreeBSD PF dans Azure."
services: virtual-machines-linux
documentationcenter: 
author: KylieLiang
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 
ms.service: virtual-machines-linux
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-linux
ms.workload: infrastructure-services
ms.date: 02/20/2017
ms.author: kyliel
ms.openlocfilehash: 3d3a5dde2ca03ba6fc384581c786f5eb746e6d92
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="how-toouse-freebsds-packet-filter-toocreate-a-secure-firewall-in-azure"></a><span data-ttu-id="e1e09-103">Comment toocreate de filtre de paquets de FreeBSD toouse pare-feu sécurisé dans Azure</span><span class="sxs-lookup"><span data-stu-id="e1e09-103">How toouse FreeBSD's Packet Filter toocreate a secure firewall in Azure</span></span>
<span data-ttu-id="e1e09-104">Cet article présente comment toodeploy un pare-feu NAT à l’aide du filtre de programme de compression de FreeBSD via le modèle Azure Resource Manager pour le scénario de serveur web courant.</span><span class="sxs-lookup"><span data-stu-id="e1e09-104">This article introduces how toodeploy a NAT firewall using FreeBSD’s Packer Filter through Azure Resource Manager template for common web server scenario.</span></span>

## <a name="what-is-pf"></a><span data-ttu-id="e1e09-105">Qu’est-ce que PF ?</span><span class="sxs-lookup"><span data-stu-id="e1e09-105">What is PF?</span></span>
<span data-ttu-id="e1e09-106">PF (filtre de paquets, également écrit pf) est un filtre de paquets avec état sous licence BSD, un élément central des logiciels de pare-feu.</span><span class="sxs-lookup"><span data-stu-id="e1e09-106">PF (Packet Filter, also written pf) is a BSD licensed stateful packet filter, a central piece of software for firewalling.</span></span> <span data-ttu-id="e1e09-107">PF a évolué rapidement et offre désormais plusieurs avantages par rapport aux autres pare-feu disponibles.</span><span class="sxs-lookup"><span data-stu-id="e1e09-107">PF has since evolved quickly and now has several advantages over other available firewalls.</span></span> <span data-ttu-id="e1e09-108">Traduction d’adresses réseau (NAT) est PF depuis le premier jour, puis le Planificateur de paquets et la gestion de la file d’attente active ont été intégrées à PF, en intégrant des hello ALTQ et ce qui peut être configuré via une configuration de dossiers publics.</span><span class="sxs-lookup"><span data-stu-id="e1e09-108">Network Address Translation (NAT) is in PF since day one, then packet scheduler and active queue management have been integrated into PF, by integrating hello ALTQ and making it configurable through PF's configuration.</span></span> <span data-ttu-id="e1e09-109">Les fonctionnalités telles que pfsync et du protocole CARP pour le basculement et la redondance, authpf d’authentification de la session et de proxy ftp tooease il hello difficile protocole FTP, ont également étendu PF.</span><span class="sxs-lookup"><span data-stu-id="e1e09-109">Features such as pfsync and CARP for failover and redundancy, authpf for session authentication, and ftp-proxy tooease firewalling hello difficult FTP protocol, have also extended PF.</span></span> <span data-ttu-id="e1e09-110">En bref, PF est un pare-feu puissant et riche en fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="e1e09-110">In short, PF is a powerful and feature-rich firewall.</span></span> 

## <a name="get-started"></a><span data-ttu-id="e1e09-111">Prise en main</span><span class="sxs-lookup"><span data-stu-id="e1e09-111">Get started</span></span>
<span data-ttu-id="e1e09-112">Si vous souhaitez configurer un pare-feu sécurisé dans le cloud hello pour vos serveurs web, puis nous pouvons commencer.</span><span class="sxs-lookup"><span data-stu-id="e1e09-112">If you are interested in setting up a secure firewall in hello cloud for your web servers, then let’s get started.</span></span> <span data-ttu-id="e1e09-113">Vous pouvez également appliquer des scripts de hello utilisés dans cette tooset de modèle Azure Resource Manager votre topologie de réseau.</span><span class="sxs-lookup"><span data-stu-id="e1e09-113">You can also apply hello scripts used in this Azure Resource Manager template tooset up your networking topology.</span></span>
<span data-ttu-id="e1e09-114">modèle de gestionnaire de ressources Azure Hello configurer un ordinateur virtuel de FreeBSD qui effectue /redirection NAT à l’aide de dossiers publics deux machines virtuelles et FreeBSD avec serveur de web Nginx hello installé et configuré.</span><span class="sxs-lookup"><span data-stu-id="e1e09-114">hello Azure Resource Manager template set up a FreeBSD virtual machine that performs NAT /redirection using PF and two FreeBSD virtual machines with hello Nginx web server installed and configured.</span></span> <span data-ttu-id="e1e09-115">En outre tooperforming NAT pour deux serveurs web de hello sortie le trafic, ordinateur virtuel de la redirection des NAT/hello intercepte les requêtes HTTP et les redirige toohello deux serveurs web dans tourniquet.</span><span class="sxs-lookup"><span data-stu-id="e1e09-115">In addition tooperforming NAT for hello two web servers egress traffic, hello NAT/redirection virtual machine intercepts HTTP requests and redirect them toohello two web servers in round-robin fashion.</span></span> <span data-ttu-id="e1e09-116">Hello réseau virtuel utilise hello privée non routable IP adresse espace 10.0.0.2/24 et vous pouvez modifier les paramètres du modèle de hello hello.</span><span class="sxs-lookup"><span data-stu-id="e1e09-116">hello VNet uses hello private non-routable IP address space 10.0.0.2/24 and you can modify hello parameters of hello template.</span></span> <span data-ttu-id="e1e09-117">modèle de gestionnaire de ressources Azure Hello définit également une table de routage pour hello réseau virtuel entier, ce qui est une collection d’itinéraires individuelles utilisées toooverride des itinéraires par défaut Azure basés sur l’adresse IP de destination hello.</span><span class="sxs-lookup"><span data-stu-id="e1e09-117">hello Azure Resource Manager template also defines a route table for hello whole VNet, which is a collection of individual routes used toooverride Azure default routes based on hello destination IP address.</span></span> 

![pf_topology](./media/freebsd-pf-nat/pf_topology.jpg)
    
### <a name="deploy-through-azure-cli"></a><span data-ttu-id="e1e09-119">Déploiement avec l’interface de ligne de commande Azure</span><span class="sxs-lookup"><span data-stu-id="e1e09-119">Deploy through Azure CLI</span></span>
<span data-ttu-id="e1e09-120">Vous devez hello dernières [Azure CLI 2.0](/cli/azure/install-az-cli2) installé et connecté à l’aide du compte Azure tooan [ouverture de session az](/cli/azure/#login).</span><span class="sxs-lookup"><span data-stu-id="e1e09-120">You need hello latest [Azure CLI 2.0](/cli/azure/install-az-cli2) installed and logged in tooan Azure account using [az login](/cli/azure/#login).</span></span> <span data-ttu-id="e1e09-121">Créez un groupe de ressources avec la commande [az group create](/cli/azure/group#create).</span><span class="sxs-lookup"><span data-stu-id="e1e09-121">Create a resource group with [az group create](/cli/azure/group#create).</span></span> <span data-ttu-id="e1e09-122">Hello exemple suivant crée un nom de groupe de ressources `myResourceGroup` Bonjour `West US` emplacement.</span><span class="sxs-lookup"><span data-stu-id="e1e09-122">hello following example creates a resource group name `myResourceGroup` in hello `West US` location.</span></span>

```azurecli
az group create --name myResourceGroup --location westus
```

<span data-ttu-id="e1e09-123">Ensuite, déployez le modèle de hello [pf-freebsd-setup](https://github.com/Azure/azure-quickstart-templates/tree/master/pf-freebsd-setup) avec [créer de déploiement de groupe az](/cli/azure/group/deployment#create).</span><span class="sxs-lookup"><span data-stu-id="e1e09-123">Next, deploy hello template [pf-freebsd-setup](https://github.com/Azure/azure-quickstart-templates/tree/master/pf-freebsd-setup) with [az group deployment create](/cli/azure/group/deployment#create).</span></span> <span data-ttu-id="e1e09-124">Télécharger [azuredeploy.parameters.json](https://github.com/Azure/azure-quickstart-templates/blob/master/pf-freebsd-setup/azuredeploy.parameters.json) sous hello même chemin d’accès et définir vos propres valeurs de ressource, telles que `adminPassword`, `networkPrefix`, et `domainNamePrefix`.</span><span class="sxs-lookup"><span data-stu-id="e1e09-124">Download [azuredeploy.parameters.json](https://github.com/Azure/azure-quickstart-templates/blob/master/pf-freebsd-setup/azuredeploy.parameters.json) under hello same path and define your own resource values, such as `adminPassword`, `networkPrefix`, and `domainNamePrefix`.</span></span> 

```azurecli
az group deployment create --resource-group myResourceGroup --name myDeploymentName \
    --template-uri https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/pf-freebsd-setup/azuredeploy.json \
    --parameters '@azuredeploy.parameters.json' --verbose
```

<span data-ttu-id="e1e09-125">Après environ cinq minutes, vous obtenez des informations hello de `"provisioningState": "Succeeded"`.</span><span class="sxs-lookup"><span data-stu-id="e1e09-125">After about five minutes, you will get hello information of `"provisioningState": "Succeeded"`.</span></span> <span data-ttu-id="e1e09-126">Ensuite, vous pouvez ssh toohello frontal VM (NAT) ou d’accéder au serveur de web Nginx dans un navigateur à l’aide de l’adresse IP hello ou nom de domaine complet d’un serveur frontal de hello VM (NAT).</span><span class="sxs-lookup"><span data-stu-id="e1e09-126">Then you can ssh toohello frontend VM (NAT) or access Nginx web server in a browser using hello public IP address or FQDN of hello frontend VM (NAT).</span></span> <span data-ttu-id="e1e09-127">Hello exemple suivant répertorie les nom de domaine complet et l’adresse IP publique affectée toohello frontal VM (NAT) Bonjour `myResourceGroup` groupe de ressources.</span><span class="sxs-lookup"><span data-stu-id="e1e09-127">hello following example lists FQDN and public IP address that assigned toohello frontend VM (NAT) in hello `myResourceGroup` resource group.</span></span> 

```azurecli
az network public-ip list --resource-group myResourceGroup
```
    
## <a name="next-steps"></a><span data-ttu-id="e1e09-128">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="e1e09-128">Next steps</span></span>
<span data-ttu-id="e1e09-129">Voulez-vous tooset des vôtre NAT dans Azure ?</span><span class="sxs-lookup"><span data-stu-id="e1e09-129">Do you want tooset up your own NAT in Azure?</span></span> <span data-ttu-id="e1e09-130">L’Open Source, gratuit mais puissant ?</span><span class="sxs-lookup"><span data-stu-id="e1e09-130">Open Source, free but powerful?</span></span> <span data-ttu-id="e1e09-131">Alors PF est un bon choix.</span><span class="sxs-lookup"><span data-stu-id="e1e09-131">Then PF is a good choice.</span></span> <span data-ttu-id="e1e09-132">À l’aide du modèle de hello [pf-freebsd-setup](https://github.com/Azure/azure-quickstart-templates/tree/master/pf-freebsd-setup), vous devez uniquement tooset de cinq minutes d’un pare-feu NAT avec tourniquet d’équilibrage à l’aide de FreeBSD PF dans Azure pour le scénario de serveur web courant.</span><span class="sxs-lookup"><span data-stu-id="e1e09-132">By using hello template [pf-freebsd-setup](https://github.com/Azure/azure-quickstart-templates/tree/master/pf-freebsd-setup), you only need five minutes tooset up a NAT firewall with round-robin load balancing using FreeBSD's PF in Azure for common web server scenario.</span></span> 

<span data-ttu-id="e1e09-133">Si vous souhaitez offre hello toolearn FreeBSD dans Azure, reportez-vous trop[tooFreeBSD introduction sur Azure](freebsd-intro-on-azure.md).</span><span class="sxs-lookup"><span data-stu-id="e1e09-133">If you want toolearn hello offering of FreeBSD in Azure, refer too[introduction tooFreeBSD on Azure](freebsd-intro-on-azure.md).</span></span>

<span data-ttu-id="e1e09-134">Si vous souhaitez tooknow plus d’informations sur les dossiers publics, reportez-vous trop[FreeBSD manuel](https://www.freebsd.org/doc/handbook/firewalls-pf.html) ou [PF-Guide de](https://www.freebsd.org/doc/handbook/firewalls-pf.html).</span><span class="sxs-lookup"><span data-stu-id="e1e09-134">If you want tooknow more about PF, refer too[FreeBSD handbook](https://www.freebsd.org/doc/handbook/firewalls-pf.html) or [PF-User's Guide](https://www.freebsd.org/doc/handbook/firewalls-pf.html).</span></span>
