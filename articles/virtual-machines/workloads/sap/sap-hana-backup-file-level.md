---
title: aaaSAP HANA Azure Backup sur niveau fichier | Documents Microsoft
description: "Il existe deux grandes méthodes permettant d’effectuer des sauvegardes SAP HANA sur des machines virtuelles Azure. Cet article aborde la sauvegarde SAP HANA sur Azure au niveau fichier."
services: virtual-machines-linux
documentationcenter: 
author: hermanndms
manager: timlt
editor: 
ms.service: virtual-machines-linux
ms.devlang: NA
ms.topic: article
ums.tgt_pltfrm: vm-linux
ms.workload: infrastructure-services
ms.date: 3/13/2017
ms.author: rclaus
ms.openlocfilehash: d5a55de5634ac7724e7fd0fa3760c6c408c3db74
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="sap-hana-azure-backup-on-file-level"></a><span data-ttu-id="3bcec-103">Sauvegarde SAP HANA sur Azure au niveau fichier</span><span class="sxs-lookup"><span data-stu-id="3bcec-103">SAP HANA Azure Backup on file level</span></span>

## <a name="introduction"></a><span data-ttu-id="3bcec-104">Introduction</span><span class="sxs-lookup"><span data-stu-id="3bcec-104">Introduction</span></span>

<span data-ttu-id="3bcec-105">Ce document fait partie d’une série d’articles connexes en trois parties dédiés à la sauvegarde SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="3bcec-105">This is part of a three-part series of related articles on SAP HANA backup.</span></span> <span data-ttu-id="3bcec-106">[Guide de sauvegarde pour SAP HANA sur des Machines virtuelles Azure](./sap-hana-backup-guide.md) fournit une vue d’ensemble et des informations sur la prise en main, et [sauvegarde de SAP HANA basée sur des instantanés de stockage](./sap-hana-backup-storage-snapshots.md) couvre hello basée sur un instantané de sauvegarde option de stockage.</span><span class="sxs-lookup"><span data-stu-id="3bcec-106">[Backup guide for SAP HANA on Azure Virtual Machines](./sap-hana-backup-guide.md) provides an overview and information on getting started, and [SAP HANA backup based on storage snapshots](./sap-hana-backup-storage-snapshots.md) covers hello storage snapshot-based backup option.</span></span>

<span data-ttu-id="3bcec-107">En examinant les tailles de machine virtuelle Azure hello, un peut voir qu’un GS5 autorise 64 disques de données attachés.</span><span class="sxs-lookup"><span data-stu-id="3bcec-107">Looking at hello Azure VM sizes, one can see that a GS5 allows 64 attached data disks.</span></span> <span data-ttu-id="3bcec-108">Pour les grands systèmes SAP HANA, un nombre important de disques peut déjà être utilisé pour les données et les fichiers journaux, éventuellement en association avec un RAID logiciel pour un débit d’E/S de disque optimal.</span><span class="sxs-lookup"><span data-stu-id="3bcec-108">For large SAP HANA systems, a significant number of disks might already be taken for data and log files, possibly in combination with software RAID for optimal disk IO throughput.</span></span> <span data-ttu-id="3bcec-109">question Hello est où toostore SAP HANA sauvegarder les fichiers, ce qui peut se remplir les données de salutation attachée disques au fil du temps ?</span><span class="sxs-lookup"><span data-stu-id="3bcec-109">hello question then is where toostore SAP HANA backup files, which could fill up hello attached data disks over time?</span></span> <span data-ttu-id="3bcec-110">Consultez [tailles pour les ordinateurs virtuels Linux dans Azure](../../linux/sizes.md) pour les tables de taille de machine virtuelle Azure hello.</span><span class="sxs-lookup"><span data-stu-id="3bcec-110">See [Sizes for Linux virtual machines in Azure](../../linux/sizes.md) for hello Azure VM size tables.</span></span>

<span data-ttu-id="3bcec-111">Aucune intégration de sauvegarde SAP HANA n’est disponible avec le service Azure Backup pour l’instant.</span><span class="sxs-lookup"><span data-stu-id="3bcec-111">There is no SAP HANA backup integration available with Azure Backup service at this time.</span></span> <span data-ttu-id="3bcec-112">méthode standard de Hello toomanage sauvegarde/restauration au niveau du fichier hello est avec une sauvegarde de fichiers via SAP HANA Studio ou les instructions SQL de HANA SAP.</span><span class="sxs-lookup"><span data-stu-id="3bcec-112">hello standard way toomanage backup/restore at hello file level is with a file-based backup via SAP HANA Studio or via SAP HANA SQL statements.</span></span> <span data-ttu-id="3bcec-113">Pour plus d’informations, voir [SQL SAP HANA et référence des vues système](https://help.sap.com/hana/SAP_HANA_SQL_and_System_Views_Reference_en.pdf).</span><span class="sxs-lookup"><span data-stu-id="3bcec-113">See [SAP HANA SQL and System Views Reference](https://help.sap.com/hana/SAP_HANA_SQL_and_System_Views_Reference_en.pdf) for more information.</span></span>

![Cette illustration montre la boîte de dialogue de hello d’élément de menu sauvegarde hello dans SAP HANA Studio](media/sap-hana-backup-file-level/image022.png)

<span data-ttu-id="3bcec-115">Cette illustration montre la boîte de dialogue de hello d’élément de menu sauvegarde hello dans SAP HANA Studio.</span><span class="sxs-lookup"><span data-stu-id="3bcec-115">This figure shows hello dialog of hello backup menu item in SAP HANA Studio.</span></span> <span data-ttu-id="3bcec-116">Lors du choix du type &quot;fichier&quot; un a toospecify un chemin d’accès dans le système de fichiers hello où SAP HANA écrit les fichiers de sauvegarde hello.</span><span class="sxs-lookup"><span data-stu-id="3bcec-116">When choosing type &quot;file,&quot; one has toospecify a path in hello file system where SAP HANA writes hello backup files.</span></span> <span data-ttu-id="3bcec-117">Fonctionnement de la restauration hello identique.</span><span class="sxs-lookup"><span data-stu-id="3bcec-117">Restore works hello same way.</span></span>

<span data-ttu-id="3bcec-118">Bien que ce choix semble simple et direct, certains points doivent être pris en compte.</span><span class="sxs-lookup"><span data-stu-id="3bcec-118">While this choice sounds simple and straight forward, there are some considerations.</span></span> <span data-ttu-id="3bcec-119">Comme indiqué précédemment, les machines virtuelles Azure ont une limite en termes de nombre de disques de données qui peuvent être liés.</span><span class="sxs-lookup"><span data-stu-id="3bcec-119">As mentioned before, an Azure VM has a limitation of number of data disks that can be attached.</span></span> <span data-ttu-id="3bcec-120">Peut-être capacité toostore SAP HANA fichiers de sauvegarde sur les systèmes de fichiers hello Hello machine virtuelle, selon la taille de hello de hello de base de données et le disque exigences de débit, ce qui peut impliquer des logiciels RAID à l’aide de la répartition entre les données sur plusieurs disques.</span><span class="sxs-lookup"><span data-stu-id="3bcec-120">There might not be capacity toostore SAP HANA backup files on hello file systems of hello VM, depending on hello size of hello database and disk throughput requirements, which might involve software RAID using striping across multiple data disks.</span></span> <span data-ttu-id="3bcec-121">Plus loin dans cet article, nous aborderons différentes options permettant de déplacer ces fichiers de sauvegarde et de gérer les restrictions concernant la taille des fichiers et les performances lors du traitement de plusieurs téraoctets de données.</span><span class="sxs-lookup"><span data-stu-id="3bcec-121">Various options for moving these backup files, and managing file size restrictions and performance when handling terabytes of data, are provided later in this article.</span></span>

<span data-ttu-id="3bcec-122">Une autre possibilité, qui offre davantage de liberté en ce qui concerne la capacité totale, est le stockage Blob Azure.</span><span class="sxs-lookup"><span data-stu-id="3bcec-122">Another option, which offers more freedom regarding total capacity, is Azure blob storage.</span></span> <span data-ttu-id="3bcec-123">Lors d’un seul objet blob est également limité too1 to, hello capacité totale d’un conteneur d’objet blob unique est actuellement 500 To.</span><span class="sxs-lookup"><span data-stu-id="3bcec-123">While a single blob is also restricted too1 TB, hello total capacity of a single blob container is currently 500 TB.</span></span> <span data-ttu-id="3bcec-124">En outre, elle offre aux clients hello un choix tooselect dite &quot;froid&quot; stockage, qui présente un avantage de coût d’objets blob.</span><span class="sxs-lookup"><span data-stu-id="3bcec-124">Additionally, it gives customers hello choice tooselect so-called &quot;cool&quot; blob storage, which has a cost benefit.</span></span> <span data-ttu-id="3bcec-125">Pour plus d’informations sur le stockage Blob froid, voir [Stockage Blob Azure : niveaux de stockage chauds et froids](../../../storage/blobs/storage-blob-storage-tiers.md).</span><span class="sxs-lookup"><span data-stu-id="3bcec-125">See [Azure Blob Storage: Hot and cool storage tiers](../../../storage/blobs/storage-blob-storage-tiers.md) for details about cool blob storage.</span></span>

<span data-ttu-id="3bcec-126">Pour une sécurité supplémentaire, utilisez une sauvegarde de stockage avec réplication géographique compte toostore hello SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="3bcec-126">For additional safety, use a geo-replicated storage account toostore hello SAP HANA backups.</span></span> <span data-ttu-id="3bcec-127">Pour plus d’informations sur la réplication des comptes de stockage, voir [Réplication Azure Storage](../../../storage/common/storage-redundancy.md).</span><span class="sxs-lookup"><span data-stu-id="3bcec-127">See [Azure Storage replication](../../../storage/common/storage-redundancy.md) for details about storage account replication.</span></span>

<span data-ttu-id="3bcec-128">Vous pouvez placer des disques durs virtuels dédiés aux sauvegardes SAP HANA dans un compte de stockage de sauvegarde dédié géo-répliqué.</span><span class="sxs-lookup"><span data-stu-id="3bcec-128">One could place dedicated VHDs for SAP HANA backups in a dedicated backup storage account that is geo-replicated.</span></span> <span data-ttu-id="3bcec-129">Faute de quoi une pu copier les disques durs virtuels hello conserver les sauvegardes SAP HANA hello compte de stockage avec réplication géographique tooa ou compte de stockage tooa qui se trouve dans une autre région.</span><span class="sxs-lookup"><span data-stu-id="3bcec-129">Or else one could copy hello VHDs that keep hello SAP HANA backups tooa geo-replicated storage account, or tooa storage account that is in a different region.</span></span>

## <a name="azure-backup-agent"></a><span data-ttu-id="3bcec-130">Agent Azure Backup</span><span class="sxs-lookup"><span data-stu-id="3bcec-130">Azure backup agent</span></span>

<span data-ttu-id="3bcec-131">Les offres de sauvegarde Azure hello option toonot uniquement sauvegarder complète machines virtuelles, mais également les fichiers et les répertoires via l’agent de sauvegarde hello, qui a toobe installé sur le système d’exploitation invité de hello.</span><span class="sxs-lookup"><span data-stu-id="3bcec-131">Azure backup offers hello option toonot only back up complete VMs, but also files and directories via hello backup agent, which has toobe installed on hello guest OS.</span></span> <span data-ttu-id="3bcec-132">Mais à compter de 2016 de décembre, cet agent est prise en charge uniquement Windows (consultez [sauvegarder un tooAzure ou client Windows Server à l’aide du modèle de déploiement du Gestionnaire de ressources hello](../../../backup/backup-configure-vault.md)).</span><span class="sxs-lookup"><span data-stu-id="3bcec-132">But as of December 2016, this agent is only supported on Windows (see [Back up a Windows Server or client tooAzure using hello Resource Manager deployment model](../../../backup/backup-configure-vault.md)).</span></span>

<span data-ttu-id="3bcec-133">Une solution de contournement est la copie de toofirst tooa de fichiers de sauvegarde SAP HANA Windows VM sur Azure (par exemple, via le partage SAMBA), puis utilisez hello agent de sauvegarde Azure à partir de là.</span><span class="sxs-lookup"><span data-stu-id="3bcec-133">A workaround is toofirst copy SAP HANA backup files tooa Windows VM on Azure (for example, via SAMBA share) and then use hello Azure backup agent from there.</span></span> <span data-ttu-id="3bcec-134">Bien qu’il soit techniquement possible, il serait renforce la complexité et ralentir la sauvegarde de hello ou de restaurer les processus mal en raison de la copie toohello entre hello Linux et hello machine virtuelle Windows.</span><span class="sxs-lookup"><span data-stu-id="3bcec-134">While it is technically possible, it would add complexity and slow down hello backup or restore process quite a bit due toohello copy between hello Linux and hello Windows VM.</span></span> <span data-ttu-id="3bcec-135">Il n’est pas recommandé toofollow cette approche.</span><span class="sxs-lookup"><span data-stu-id="3bcec-135">It is not recommended toofollow this approach.</span></span>

## <a name="azure-blobxfer-utility-details"></a><span data-ttu-id="3bcec-136">Détails de l’utilitaire blobxfer Azure</span><span class="sxs-lookup"><span data-stu-id="3bcec-136">Azure blobxfer utility details</span></span>

<span data-ttu-id="3bcec-137">toostore répertoires et fichiers sur le stockage Azure, un peut utiliser CLI ou PowerShell, ou développez un outil à l’aide de hello [kits de développement logiciel Azure](https://azure.microsoft.com/downloads/).</span><span class="sxs-lookup"><span data-stu-id="3bcec-137">toostore directories and files on Azure storage, one could use CLI or PowerShell, or develop a tool using one of hello [Azure SDKs](https://azure.microsoft.com/downloads/).</span></span> <span data-ttu-id="3bcec-138">Il existe également un utilitaire prêt à l’emploi, AzCopy, pour la copie de stockage des données tooAzure, mais il est Windows uniquement (consultez [transférer des données avec l’utilitaire de ligne de commande AzCopy de hello](../../../storage/common/storage-use-azcopy.md)).</span><span class="sxs-lookup"><span data-stu-id="3bcec-138">There is also a ready-to-use utility, AzCopy, for copying data tooAzure storage, but it is Windows only (see [Transfer data with hello AzCopy Command-Line Utility](../../../storage/common/storage-use-azcopy.md)).</span></span>

<span data-ttu-id="3bcec-139">Par conséquent, blobxfer a été utilisé pour copier les fichiers de sauvegarde SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="3bcec-139">Therefore blobxfer was used for copying SAP HANA backup files.</span></span> <span data-ttu-id="3bcec-140">Il s’agit d’un outil Open Source utilisé par de nombreux clients dans leur environnement de production. Il est disponible sur [GitHub](https://github.com/Azure/blobxfer).</span><span class="sxs-lookup"><span data-stu-id="3bcec-140">It is open source, used by many customers in production environments, and available on [GitHub](https://github.com/Azure/blobxfer).</span></span> <span data-ttu-id="3bcec-141">Cet outil permet de données toocopy directement tooeither Azure blob storage ou partage de fichiers Azure.</span><span class="sxs-lookup"><span data-stu-id="3bcec-141">This tool allows one toocopy data directly tooeither Azure blob storage or Azure file share.</span></span> <span data-ttu-id="3bcec-142">Il inclut également de nombreuses fonctionnalités utiles, telles que le code de hachage md5 ou le parallélisme automatique lors de la copie d’un répertoire contenant plusieurs fichiers.</span><span class="sxs-lookup"><span data-stu-id="3bcec-142">It also offers a range of useful features, like md5 hash or automatic parallelism when copying a directory with multiple files.</span></span>

## <a name="sap-hana-backup-performance"></a><span data-ttu-id="3bcec-143">Performances de sauvegarde SAP HANA</span><span class="sxs-lookup"><span data-stu-id="3bcec-143">SAP HANA backup performance</span></span>

![Cette capture d’écran est de la console de sauvegarde de SAP HANA hello de SAP HANA Studio](media/sap-hana-backup-file-level/image023.png)

<span data-ttu-id="3bcec-145">Cette capture d’écran est de la console de sauvegarde de SAP HANA hello de SAP HANA Studio.</span><span class="sxs-lookup"><span data-stu-id="3bcec-145">This screenshot is of hello SAP HANA backup console in SAP HANA Studio.</span></span> <span data-ttu-id="3bcec-146">Sauvegarde de minutes environ 42 toodo hello. durée : Hello 230 Go sur un disque de stockage standard Azure unique jointe toohello HANA VM à l’aide du système de fichiers XFS.</span><span class="sxs-lookup"><span data-stu-id="3bcec-146">It took about 42 minutes toodo hello backup of hello 230 GB on a single Azure standard storage disk attached toohello HANA VM using XFS file system.</span></span>

![Cette capture d’écran est de YaST sur la machine virtuelle de test SAP HANA hello](media/sap-hana-backup-file-level/image024.png)

<span data-ttu-id="3bcec-148">Cette capture d’écran est de YaST sur la machine virtuelle de test SAP HANA hello.</span><span class="sxs-lookup"><span data-stu-id="3bcec-148">This screenshot is of YaST on hello SAP HANA test VM.</span></span> <span data-ttu-id="3bcec-149">Un peut voir hello 1 to seul disque pour la sauvegarde de SAP HANA comme mentionné précédemment.</span><span class="sxs-lookup"><span data-stu-id="3bcec-149">One can see hello 1-TB single disk for SAP HANA backup as mentioned before.</span></span> <span data-ttu-id="3bcec-150">Elle a duré environ 42 minutes toobackup 230 Go.</span><span class="sxs-lookup"><span data-stu-id="3bcec-150">It took about 42 minutes toobackup 230 GB.</span></span> <span data-ttu-id="3bcec-151">En outre, cinq disques de 200 Go ont été liés et le RAID logiciel md0 a été créé, avec un entrelacement sur ces cinq disques de données Azure.</span><span class="sxs-lookup"><span data-stu-id="3bcec-151">In addition, five 200-GB disks were attached and software RAID md0 created, with striping on top of these five Azure data disks.</span></span>

![Répétition hello même de sauvegarde sur les volumes RAID logiciels l’agrégation par bandes sur cinq de disques de données de stockage standard Azure associés](media/sap-hana-backup-file-level/image025.png)

<span data-ttu-id="3bcec-153">Hello extensible même de sauvegarde sur les volumes RAID logiciels l’agrégation par bandes sur cinq attaché heure de sauvegarde Azure stockage standard données disques mis hello de 42 minutes vers le bas too10 minutes.</span><span class="sxs-lookup"><span data-stu-id="3bcec-153">Repeating hello same backup on software RAID with striping across five attached Azure standard storage data disks brought hello backup time from 42 minutes down too10 minutes.</span></span> <span data-ttu-id="3bcec-154">les disques Hello ont été attachés sans mise en cache toohello machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="3bcec-154">hello disks were attached without caching toohello VM.</span></span> <span data-ttu-id="3bcec-155">Il est donc évident débit d’écriture disque l’importance est pour l’heure de la sauvegarde hello.</span><span class="sxs-lookup"><span data-stu-id="3bcec-155">So it is obvious how important disk write throughput is for hello backup time.</span></span> <span data-ttu-id="3bcec-156">Un a pu puis commutateur tooAzure premium storage toofurther accélérer hello pour des performances optimales.</span><span class="sxs-lookup"><span data-stu-id="3bcec-156">One could then switch tooAzure premium storage toofurther accelerate hello process for optimal performance.</span></span> <span data-ttu-id="3bcec-157">En général, le stockage Azure Premium doit être utilisé pour les systèmes de production.</span><span class="sxs-lookup"><span data-stu-id="3bcec-157">In general, Azure premium storage should be used for production systems.</span></span>

## <a name="copy-sap-hana-backup-files-tooazure-blob-storage"></a><span data-ttu-id="3bcec-158">Copiez le stockage d’objets blob tooAzure SAP HANA fichiers de sauvegarde</span><span class="sxs-lookup"><span data-stu-id="3bcec-158">Copy SAP HANA backup files tooAzure blob storage</span></span>

<span data-ttu-id="3bcec-159">Comme hello mieux de décembre 2016, fichiers de sauvegarde option tooquickly magasin SAP HANA est stockage d’objets blob Azure.</span><span class="sxs-lookup"><span data-stu-id="3bcec-159">As of December 2016, hello best option tooquickly store SAP HANA backup files is Azure blob storage.</span></span> <span data-ttu-id="3bcec-160">Un conteneur d’objet blob unique a une limite de 500 To, suffisante pour la plupart des systèmes SAP HANA, en cours d’exécution dans une machine virtuelle GS5 sur Azure, les sauvegardes SAP HANA suffisamment tookeep.</span><span class="sxs-lookup"><span data-stu-id="3bcec-160">One single blob container has a limit of 500 TB, enough for most SAP HANA systems, running in a GS5 VM on Azure, tookeep sufficient SAP HANA backups.</span></span> <span data-ttu-id="3bcec-161">Choix de hello entre les clients ont &quot;à chaud&quot; et &quot;à froid&quot; stockage d’objets blob (voir [stockage d’objets Blob Azure : à chaud et refroidir des niveaux de stockage](../../../storage/blobs/storage-blob-storage-tiers.md)).</span><span class="sxs-lookup"><span data-stu-id="3bcec-161">Customers have hello choice between &quot;hot&quot; and &quot;cold&quot; blob storage (see [Azure Blob Storage: Hot and cool storage tiers](../../../storage/blobs/storage-blob-storage-tiers.md)).</span></span>

<span data-ttu-id="3bcec-162">L’outil blobxfer hello toocopy facile hello SAP HANA sauvegarde fichiers sont directement tooAzure stockage d’objets blob.</span><span class="sxs-lookup"><span data-stu-id="3bcec-162">With hello blobxfer tool, it is easy toocopy hello SAP HANA backup files directly tooAzure blob storage.</span></span>

![Ici une peut voir les fichiers de hello d’une sauvegarde de fichier SAP HANA complète](media/sap-hana-backup-file-level/image026.png)

<span data-ttu-id="3bcec-164">Un trouverez ici des fichiers hello d’une sauvegarde de fichier SAP HANA complète.</span><span class="sxs-lookup"><span data-stu-id="3bcec-164">Here one can see hello files of a full SAP HANA file backup.</span></span> <span data-ttu-id="3bcec-165">Il existe quatre fichiers et un plus grand hello a environ 230 Go.</span><span class="sxs-lookup"><span data-stu-id="3bcec-165">There are four files and hello biggest one has roughly 230 GB.</span></span>

![Elle a duré environ 3 000 secondes toocopy hello 230 Go tooan standard compte blob conteneur de stockage Azure](media/sap-hana-backup-file-level/image027.png)

<span data-ttu-id="3bcec-167">Utilisez ne pas le hachage md5 dans le test initial de hello, il a fallu environ 3 000 secondes toocopy hello 230 Go tooan standard compte blob conteneur de stockage Azure.</span><span class="sxs-lookup"><span data-stu-id="3bcec-167">Not using md5 hash in hello initial test, it took roughly 3000 seconds toocopy hello 230 GB tooan Azure standard storage account blob container.</span></span>

![Dans cette capture d’écran, un peut vérifier son fonctionnement sur hello portail Azure](media/sap-hana-backup-file-level/image028.png)

<span data-ttu-id="3bcec-169">Dans cette capture d’écran, un peut vérifier son fonctionnement sur hello portail Azure.</span><span class="sxs-lookup"><span data-stu-id="3bcec-169">In this screenshot, one can see how it looks on hello Azure portal.</span></span> <span data-ttu-id="3bcec-170">Un conteneur d’objets blob nommé &quot;sauvegardes de sap hana&quot; a été créé et inclut des blobs hello quatre, qui représentent les fichiers de sauvegarde de SAP HANA hello.</span><span class="sxs-lookup"><span data-stu-id="3bcec-170">A blob container named &quot;sap-hana-backups&quot; was created and includes hello four blobs, which represent hello SAP HANA backup files.</span></span> <span data-ttu-id="3bcec-171">L’un d’eux fait environ 230 Go.</span><span class="sxs-lookup"><span data-stu-id="3bcec-171">One of them has a size of roughly 230 GB.</span></span>

<span data-ttu-id="3bcec-172">console de sauvegarde Hello HANA Studio permet une taille de fichier maximale hello toorestrict HANA des fichiers de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="3bcec-172">hello HANA Studio backup console allows one toorestrict hello max file size of HANA backup files.</span></span> <span data-ttu-id="3bcec-173">Dans l’environnement d’exemple hello, il des performances accrues en rendant possible toohave les fichiers de sauvegarde plus petit multiples, au lieu d’un seul grand fichier 230 Go.</span><span class="sxs-lookup"><span data-stu-id="3bcec-173">In hello sample environment, it improved performance by making it possible toohave multiple smaller backup files, instead of one large 230-GB file.</span></span>

![Paramètre de limite de taille de fichier de sauvegarde hello sur hello HANA côté n &#39; t améliorer le temps de sauvegarde hello](media/sap-hana-backup-file-level/image029.png)

<span data-ttu-id="3bcec-175">Paramètre de limite de taille de fichier de sauvegarde hello sur hello HANA côté n &#39; t améliorent les temps de sauvegarde hello, car les fichiers hello sont écrits séquentiellement, comme indiqué dans cette illustration.</span><span class="sxs-lookup"><span data-stu-id="3bcec-175">Setting hello backup file size limit on hello HANA side doesn&#39;t improve hello backup time, because hello files are written sequentially as shown in this figure.</span></span> <span data-ttu-id="3bcec-176">limite de taille de fichier Hello a été défini too60 Go, afin de la création de la sauvegarde hello quatre fichiers de données volumineux au lieu de 230 Go hello fichier unique.</span><span class="sxs-lookup"><span data-stu-id="3bcec-176">hello file size limit was set too60 GB, so hello backup created four large data files instead of hello 230-GB single file.</span></span>

![tootest le parallélisme de l’outil de blobxfer hello, taille de fichier maximale hello pour les sauvegardes HANA a ensuite été défini too15 Go](media/sap-hana-backup-file-level/image030.png)

<span data-ttu-id="3bcec-178">tootest le parallélisme de l’outil de blobxfer hello, taille de fichier maximale hello pour les sauvegardes HANA a ensuite été défini too15 Go, ce qui a entraîné des fichiers de sauvegarde 19.</span><span class="sxs-lookup"><span data-stu-id="3bcec-178">tootest parallelism of hello blobxfer tool, hello max file size for HANA backups was then set too15 GB, which resulted in 19 backup files.</span></span> <span data-ttu-id="3bcec-179">Cette configuration mis temps hello pour le stockage d’objets blob tooAzure blobxfer toocopy hello 230 Go à partir de 3 000 secondes too875 secondes.</span><span class="sxs-lookup"><span data-stu-id="3bcec-179">This configuration brought hello time for blobxfer toocopy hello 230 GB tooAzure blob storage from 3000 seconds down too875 seconds.</span></span>

<span data-ttu-id="3bcec-180">Ce résultat est dû limite toohello de 60 Mo/s pour l’écriture d’un objet blob Azure.</span><span class="sxs-lookup"><span data-stu-id="3bcec-180">This result is due toohello limit of 60 MB/sec for writing an Azure blob.</span></span> <span data-ttu-id="3bcec-181">Parallélisme via plusieurs objets BLOB résout goulot d’étranglement hello, mais présente un inconvénient : augmente la performance de hello blobxfer outil toocopy tous les tooAzure de ces fichiers de sauvegarde HANA le stockage d’objets blob place charge sur hello HANA VM et hello réseau.</span><span class="sxs-lookup"><span data-stu-id="3bcec-181">Parallelism via multiple blobs solves hello bottleneck, but there is a downside: increasing performance of hello blobxfer tool toocopy all these HANA backup files tooAzure blob storage puts load on both hello HANA VM and hello network.</span></span> <span data-ttu-id="3bcec-182">Le fonctionnement du système HANA s’en trouve affecté.</span><span class="sxs-lookup"><span data-stu-id="3bcec-182">Operation of HANA system becomes impacted.</span></span>

## <a name="blob-copy-of-dedicated-azure-data-disks-in-backup-software-raid"></a><span data-ttu-id="3bcec-183">Copie blob des disques de données Azure dédiés dans le RAID logiciel de sauvegarde</span><span class="sxs-lookup"><span data-stu-id="3bcec-183">Blob copy of dedicated Azure data disks in backup software RAID</span></span>

<span data-ttu-id="3bcec-184">Contrairement aux hello manuelle VM données sauvegarde sur disque, dans cette approche ne pas sauvegarder tous les disques de données hello sur une machine virtuelle toosave hello toute installation SAP, y compris les données HANA HANA fichiers journaux et fichiers de configuration.</span><span class="sxs-lookup"><span data-stu-id="3bcec-184">Unlike hello manual VM data disk backup, in this approach one does not back up all hello data disks on a VM toosave hello whole SAP installation, including HANA data, HANA log files, and config files.</span></span> <span data-ttu-id="3bcec-185">Au lieu de cela, hello idée est toohave dédié les volumes RAID logiciels l’agrégation par bandes sur plusieurs disques durs virtuels de données Azure pour stocker une sauvegarde de fichier SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="3bcec-185">Instead, hello idea is toohave dedicated software RAID with striping across multiple Azure data VHDs for storing a full SAP HANA file backup.</span></span> <span data-ttu-id="3bcec-186">Une copie uniquement ces disques, qui présentent la sauvegarde de SAP HANA hello.</span><span class="sxs-lookup"><span data-stu-id="3bcec-186">One copies only these disks, which have hello SAP HANA backup.</span></span> <span data-ttu-id="3bcec-187">Ils pourrait facilement être conservées dans un compte de stockage de sauvegarde HANA dédié ou joint tooa dédié &quot;gestion des ordinateurs virtuels de sauvegarde&quot; pour un traitement ultérieur.</span><span class="sxs-lookup"><span data-stu-id="3bcec-187">They could easily be kept in a dedicated HANA backup storage account, or attached tooa dedicated &quot;backup management VM&quot; for further processing.</span></span>

![Tous les disques durs virtuels impliquées ont été copiés à l’aide de hello ** démarrer-azurestorageblobcopy ** commande PowerShell](media/sap-hana-backup-file-level/image031.png)

<span data-ttu-id="3bcec-189">Après l’exécution de logiciels locaux de sauvegarde toohello hello RAID, tous les disques durs virtuels impliquées ont été copiés à l’aide de hello **start-azurestorageblobcopy** commande PowerShell (voir [Start-AzureStorageBlobCopy](/powershell/module/azure.storage/start-azurestorageblobcopy)).</span><span class="sxs-lookup"><span data-stu-id="3bcec-189">After hello backup toohello local software RAID was completed, all VHDs involved were copied using hello **start-azurestorageblobcopy** PowerShell command (see [Start-AzureStorageBlobCopy](/powershell/module/azure.storage/start-azurestorageblobcopy)).</span></span> <span data-ttu-id="3bcec-190">Comme elle n’affecte que le système de fichiers hello dédié pour conserver les fichiers de sauvegarde hello, il n’y a aucun problème sur SAP HANA données ou journaux la cohérence des fichiers sur le disque de hello.</span><span class="sxs-lookup"><span data-stu-id="3bcec-190">As it only affects hello dedicated file system for keeping hello backup files, there are no concerns about SAP HANA data or log file consistency on hello disk.</span></span> <span data-ttu-id="3bcec-191">L’avantage de cette commande est qu’elle fonctionne tandis que hello machine virtuelle reste en ligne.</span><span class="sxs-lookup"><span data-stu-id="3bcec-191">A benefit of this command is that it works while hello VM stays online.</span></span> <span data-ttu-id="3bcec-192">toobe certain qu’aucun processus n’écrit toohello sauvegarde agrégat, être toounmount vraiment avant hello copie d’objets blob et l’installer à nouveau par la suite.</span><span class="sxs-lookup"><span data-stu-id="3bcec-192">toobe certain that no process writes toohello backup stripe set, be sure toounmount it before hello blob copy, and mount it again afterwards.</span></span> <span data-ttu-id="3bcec-193">Ou vous pouvez utiliser une trop&quot;Figer&quot; hello du système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="3bcec-193">Or one could use an appropriate way too&quot;freeze&quot; hello file system.</span></span> <span data-ttu-id="3bcec-194">Par exemple, via xfs\_figer hello XFS système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="3bcec-194">For example, via xfs\_freeze for hello XFS file system.</span></span>

![Cette capture d’écran montre la liste hello d’objets BLOB dans le conteneur de disques durs virtuels hello sur hello portail Azure](media/sap-hana-backup-file-level/image032.png)

<span data-ttu-id="3bcec-196">Cette capture d’écran montre la liste hello d’objets BLOB Bonjour &quot;disques durs virtuels&quot; conteneur sur hello portail Azure.</span><span class="sxs-lookup"><span data-stu-id="3bcec-196">This screenshot shows hello list of blobs in hello &quot;vhds&quot; container on hello Azure portal.</span></span> <span data-ttu-id="3bcec-197">capture d’écran de Hello affiche hello cinq disques durs virtuels, qui ont été joints toohello SAP HANA serveur VM tooserve que hello logiciel RAID tookeep SAP HANA fichiers de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="3bcec-197">hello screenshot shows hello five VHDs, which were attached toohello SAP HANA server VM tooserve as hello software RAID tookeep SAP HANA backup files.</span></span> <span data-ttu-id="3bcec-198">Il montre également hello cinq copies, qui ont été effectuées via la commande de copie d’objet blob hello.</span><span class="sxs-lookup"><span data-stu-id="3bcec-198">It also shows hello five copies, which were taken via hello blob copy command.</span></span>

![À des fins de test, les copies hello de disques RAID de hello SAP HANA logiciel de sauvegarde ont été toohello joint le serveur application machine virtuelle](media/sap-hana-backup-file-level/image033.png)

<span data-ttu-id="3bcec-200">À des fins de test, les copies hello de disques RAID de hello SAP HANA logiciel de sauvegarde ont été toohello joint le serveur application machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="3bcec-200">For testing purposes, hello copies of hello SAP HANA backup software RAID disks were attached toohello app server VM.</span></span>

![le serveur d’application Hello machine virtuelle a été arrêté tooattach hello disque copies](media/sap-hana-backup-file-level/image034.png)

<span data-ttu-id="3bcec-202">le serveur d’application Hello machine virtuelle a été arrêté tooattach hello disque copies.</span><span class="sxs-lookup"><span data-stu-id="3bcec-202">hello app server VM was shut down tooattach hello disk copies.</span></span> <span data-ttu-id="3bcec-203">Après avoir démarré hello machine virtuelle, des disques hello et hello RAID découverts correctement (monté via UUID).</span><span class="sxs-lookup"><span data-stu-id="3bcec-203">After starting hello VM, hello disks and hello RAID were discovered correctly (mounted via UUID).</span></span> <span data-ttu-id="3bcec-204">Seul le point de montage hello est manquant, lequel a été créée par le biais de partitionneur YaST hello.</span><span class="sxs-lookup"><span data-stu-id="3bcec-204">Only hello mount point was missing, which was created via hello YaST partitioner.</span></span> <span data-ttu-id="3bcec-205">Par la suite des copies de fichier de sauvegarde de SAP HANA hello est désormais visibles au niveau du système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="3bcec-205">Afterwards hello SAP HANA backup file copies became visible on OS level.</span></span>

## <a name="copy-sap-hana-backup-files-toonfs-share"></a><span data-ttu-id="3bcec-206">Copiez les fichiers de sauvegarde SAP HANA tooNFS partager</span><span class="sxs-lookup"><span data-stu-id="3bcec-206">Copy SAP HANA backup files tooNFS share</span></span>

<span data-ttu-id="3bcec-207">toolessen hello impact potentiel sur hello système SAP HANA à partir d’une performance ou une perspective d’espace disque, il peut considérer le stockage des fichiers de sauvegarde SAP HANA hello sur un partage NFS.</span><span class="sxs-lookup"><span data-stu-id="3bcec-207">toolessen hello potential impact on hello SAP HANA system from a performance or disk space perspective, one might consider storing hello SAP HANA backup files on an NFS share.</span></span> <span data-ttu-id="3bcec-208">Techniquement, il fonctionne, mais elle signifie à l’aide d’une deuxième machine virtuelle de Azure en tant qu’hôte hello Hello de partage NFS.</span><span class="sxs-lookup"><span data-stu-id="3bcec-208">Technically it works, but it means using a second Azure VM as hello host of hello NFS share.</span></span> <span data-ttu-id="3bcec-209">Ne doit pas être une petite taille de machine virtuelle, en raison de la bande passante du réseau toohello machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="3bcec-209">It should not be a small VM size, due toohello VM network bandwidth.</span></span> <span data-ttu-id="3bcec-210">Il serait logique puis tooshut réduire cette &quot;sauvegarde d’ordinateurs virtuels&quot; et uniquement pour l’exécution de la sauvegarde de SAP HANA hello.</span><span class="sxs-lookup"><span data-stu-id="3bcec-210">It would make sense then tooshut down this &quot;backup VM&quot; and only bring it up for executing hello SAP HANA backup.</span></span> <span data-ttu-id="3bcec-211">L’écriture sur un NFS partage place la charge sur le réseau de hello et impacts hello système de SAP HANA, mais simplement la gestion hello des fichiers de sauvegarde par la suite sur hello &quot;sauvegarde VM&quot; influencerait pas système de SAP HANA hello du tout.</span><span class="sxs-lookup"><span data-stu-id="3bcec-211">Writing on an NFS share puts load on hello network and impacts hello SAP HANA system, but merely managing hello backup files afterwards on hello &quot;backup VM&quot; would not influence hello SAP HANA system at all.</span></span>

![Un partage NFS à partir d’une autre machine virtuelle de Azure a été monté toohello machine virtuelle du serveur SAP HANA](media/sap-hana-backup-file-level/image035.png)

<span data-ttu-id="3bcec-213">cas d’usage tooverify hello NFS, un partage NFS à partir d’une autre machine virtuelle de Azure a été monté toohello machine virtuelle du serveur SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="3bcec-213">tooverify hello NFS use case, an NFS share from another Azure VM was mounted toohello SAP HANA server VM.</span></span> <span data-ttu-id="3bcec-214">Aucun réglage NFS spécifique n’a été effectué.</span><span class="sxs-lookup"><span data-stu-id="3bcec-214">There was no special NFS tuning applied.</span></span>

![Durée : sauvegarde de 1 heure et 46 minutes toodo hello directement](media/sap-hana-backup-file-level/image036.png)

<span data-ttu-id="3bcec-216">partage de Hello NFS a été un agrégat rapide comme hello une sur le serveur de SAP HANA hello.</span><span class="sxs-lookup"><span data-stu-id="3bcec-216">hello NFS share was a fast stripe set, like hello one on hello SAP HANA server.</span></span> <span data-ttu-id="3bcec-217">Néanmoins, il a fallu 1 heure et hello toodo de 46 minutes sauvegarde directement sur un partage NFS de hello au lieu de 10 minutes, lors de l’écriture du jeu de bandes local de tooa.</span><span class="sxs-lookup"><span data-stu-id="3bcec-217">Nevertheless, it took 1 hour and 46 minutes toodo hello backup directly on hello NFS share instead of 10 minutes, when writing tooa local stripe set.</span></span>

![alternative de Hello n’a pas été beaucoup plus rapidement à 1 heure et 43 minutes](media/sap-hana-backup-file-level/image037.png)

<span data-ttu-id="3bcec-219">alternative Hello effectuant un jeu de bandes local de sauvegarde tooa et la copie de toohello de partage NFS au niveau du système d’exploitation (un simple **cp - avr** commande) n’a pas été beaucoup plus rapidement.</span><span class="sxs-lookup"><span data-stu-id="3bcec-219">hello alternative of doing a backup tooa local stripe set and copying toohello NFS share on OS level (a simple **cp -avr** command) wasn't much quicker.</span></span> <span data-ttu-id="3bcec-220">Elle a pris 1 heure et 43 minutes.</span><span class="sxs-lookup"><span data-stu-id="3bcec-220">It took 1 hour and 43 minutes.</span></span>

<span data-ttu-id="3bcec-221">Il fonctionne, mais les performances n’était pas approprié pour le test de sauvegarde hello 230 Go.</span><span class="sxs-lookup"><span data-stu-id="3bcec-221">So it works, but performance wasn't good for hello 230-GB backup test.</span></span> <span data-ttu-id="3bcec-222">La situation serait encore pire pour plusieurs téraoctets.</span><span class="sxs-lookup"><span data-stu-id="3bcec-222">It would look even worse for multi terabytes.</span></span>

## <a name="copy-sap-hana-backup-files-tooazure-file-service"></a><span data-ttu-id="3bcec-223">Copie les fichiers de sauvegarde de SAP HANA tooAzure service de fichier</span><span class="sxs-lookup"><span data-stu-id="3bcec-223">Copy SAP HANA backup files tooAzure file service</span></span>

<span data-ttu-id="3bcec-224">Il est possible de toomount un fichier Azure partager à l’intérieur d’une machine virtuelle Linux de Azure.</span><span class="sxs-lookup"><span data-stu-id="3bcec-224">It is possible toomount an Azure file share inside an Azure Linux VM.</span></span> <span data-ttu-id="3bcec-225">article de Hello [comment toouse stockage Azure files avec Linux](../../../storage/files/storage-how-to-use-files-linux.md) fournit des détails sur la façon de toodo il.</span><span class="sxs-lookup"><span data-stu-id="3bcec-225">hello article [How toouse Azure File storage with Linux](../../../storage/files/storage-how-to-use-files-linux.md) provides details on how toodo it.</span></span> <span data-ttu-id="3bcec-226">N’oubliez pas qu’il existe actuellement une limite de 5 To pour un partage de fichiers Azure, et une limite de taille de fichier de 1 To.</span><span class="sxs-lookup"><span data-stu-id="3bcec-226">Keep in mind that there is currently a 5-TB quota limit of one Azure file share, and a file size limit of 1 TB per file.</span></span> <span data-ttu-id="3bcec-227">Pour plus d’informations sur les limites de stockage, voir [Objectifs de performance et évolutivité du stockage Azure](../../../storage/common/storage-scalability-targets.md).</span><span class="sxs-lookup"><span data-stu-id="3bcec-227">See [Azure Storage Scalability and Performance Targets](../../../storage/common/storage-scalability-targets.md) for information on storage limits.</span></span>

<span data-ttu-id="3bcec-228">Des tests ont toutefois démontré que la sauvegarde SAP HANA ne fonctionne pas directement avec ce type de montage CIFS.</span><span class="sxs-lookup"><span data-stu-id="3bcec-228">Tests have shown, however, that SAP HANA backup doesn&#39;t currently work directly with this kind of CIFS mount.</span></span> <span data-ttu-id="3bcec-229">La [note SAP 1820529](https://launchpad.support.sap.com/#/notes/1820529) indique également que CIFS n’est pas recommandé.</span><span class="sxs-lookup"><span data-stu-id="3bcec-229">It is also stated in [SAP Note 1820529](https://launchpad.support.sap.com/#/notes/1820529) that CIFS is not recommended.</span></span>

![Cette illustration montre une erreur dans la boîte de dialogue sauvegarde hello dans SAP HANA Studio](media/sap-hana-backup-file-level/image038.png)

<span data-ttu-id="3bcec-231">Cette illustration présente une erreur dans la boîte de dialogue sauvegarde hello dans SAP HANA Studio, lors de la tentative de tooback directement le partage de fichiers Azure montés CIFS tooa.</span><span class="sxs-lookup"><span data-stu-id="3bcec-231">This figure shows an error in hello backup dialog in SAP HANA Studio, when trying tooback up directly tooa CIFS-mounted Azure file share.</span></span> <span data-ttu-id="3bcec-232">Ainsi une dispose d’une standard SAP HANA une sauvegarde dans un système de fichiers de machine virtuelle toodo tout d’abord, puis les fichiers de sauvegarde de hello copie à partir de là tooAzure service de fichiers.</span><span class="sxs-lookup"><span data-stu-id="3bcec-232">So one has toodo a standard SAP HANA backup into a VM file system first, and then copy hello backup files from there tooAzure file service.</span></span>

![Cette figure montre qu’il a fallu presque 929 secondes toocopy 19 SAP HANA fichiers de sauvegarde](media/sap-hana-backup-file-level/image039.png)

<span data-ttu-id="3bcec-234">Cette figure montre qu’il a fallu presque 929 secondes toocopy 19 fichiers de sauvegarde SAP HANA avec une taille totale à peu près 230 Go toohello Azure du partage de fichiers.</span><span class="sxs-lookup"><span data-stu-id="3bcec-234">This figure shows that it took about 929 seconds toocopy 19 SAP HANA backup files with a total size of roughly 230 GB toohello Azure file share.</span></span>

![structure de répertoire source Hello sur hello SAP HANA VM a été partage de fichiers Azure toohello copiés](media/sap-hana-backup-file-level/image040.png)

<span data-ttu-id="3bcec-236">Dans cette capture d’écran, un peut voir que structure de répertoire source hello sur hello SAP HANA VM a partage de fichiers Azure toohello copié : un répertoire (hana\_sauvegarde\_personnalisés adaptés\_15 Go) et les fichiers de sauvegarde individuels 19.</span><span class="sxs-lookup"><span data-stu-id="3bcec-236">In this screenshot, one can see that hello source directory structure on hello SAP HANA VM was copied toohello Azure file share: one directory (hana\_backup\_fsl\_15gb) and 19 individual backup files.</span></span>

<span data-ttu-id="3bcec-237">Le stockage des fichiers de sauvegarde SAP HANA sur des fichiers Azure peut être une option intéressante Bonjour futures lors de sauvegardes de fichiers SAP HANA prennent en charge directement.</span><span class="sxs-lookup"><span data-stu-id="3bcec-237">Storing SAP HANA backup files on Azure files could be an interesting option in hello future when SAP HANA file backups support it directly.</span></span> <span data-ttu-id="3bcec-238">Lorsqu’il devient possible toomount Azure fichiers ou via NFS et limite de quota maximale hello est nettement supérieur à 5 To.</span><span class="sxs-lookup"><span data-stu-id="3bcec-238">Or when it becomes possible toomount Azure files via NFS and hello maximum quota limit is considerably higher than 5 TB.</span></span>

## <a name="next-steps"></a><span data-ttu-id="3bcec-239">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="3bcec-239">Next steps</span></span>
* <span data-ttu-id="3bcec-240">L’article [Guide de sauvegarde pour SAP HANA sur les machines virtuelles Azure](sap-hana-backup-guide.md) fournit une vue d’ensemble et des informations sur la mise en route.</span><span class="sxs-lookup"><span data-stu-id="3bcec-240">[Backup guide for SAP HANA on Azure Virtual Machines](sap-hana-backup-guide.md) gives an overview and information on getting started.</span></span>
* <span data-ttu-id="3bcec-241">[Sauvegarde de SAP HANA basée sur des instantanés de stockage](sap-hana-backup-storage-snapshots.md) décrit l’option sauvegarde basée sur un instantané stockage hello.</span><span class="sxs-lookup"><span data-stu-id="3bcec-241">[SAP HANA backup based on storage snapshots](sap-hana-backup-storage-snapshots.md) describes hello storage snapshot-based backup option.</span></span>
* <span data-ttu-id="3bcec-242">toolearn comment tooestablish haute disponibilité et le plan de récupération d’urgence de SAP HANA sur Azure (instances de grande taille), consultez [SAP HANA (instances de grande taille) haute disponibilité et récupération d’urgence sur Azure](hana-overview-high-availability-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="3bcec-242">toolearn how tooestablish high availability and plan for disaster recovery of SAP HANA on Azure (large instances), see [SAP HANA (large instances) high availability and disaster recovery on Azure](hana-overview-high-availability-disaster-recovery.md).</span></span>
