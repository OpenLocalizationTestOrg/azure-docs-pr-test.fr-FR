---
title: "Mise à niveau de l’agent PhoneFactor vers le serveur Azure Multi-Factor Authentication | Microsoft Docs"
description: "Ce document décrit comment prendre en main le serveur Azure Multi-Factor Authentication lors d’une mise à niveau à partir de l’ancien agent PhoneFactor."
services: multi-factor-authentication
documentationcenter: 
author: kgremban
manager: femila
editor: yossib
ms.assetid: 42838ff7-bdf2-4d06-bacc-b3839a00cd76
ms.service: multi-factor-authentication
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 06/06/2017
ms.author: kgremban
ms.openlocfilehash: 7ab7e693909f807781744ae53eed75d425096590
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/11/2017
---
# <a name="upgrade-the-phonefactor-agent-to-azure-multi-factor-authentication-server"></a><span data-ttu-id="8fa7c-103">Mise à niveau de l’agent PhoneFactor vers le serveur Azure Multi-Factor Authentication</span><span class="sxs-lookup"><span data-stu-id="8fa7c-103">Upgrade the PhoneFactor Agent to Azure Multi-Factor Authentication Server</span></span>
<span data-ttu-id="8fa7c-104">Pour mettre à niveau la version 5.x ou une version antérieure de l’agent PhoneFactor vers le serveur Microsoft Azure Multi-Factor Authentication, commencez par désinstaller l’agent PhoneFactor et les composants correspondants.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-104">To upgrade the PhoneFactor Agent v5.x or older to Azure Multi-Factor Authentication Server, uninstall the PhoneFactor Agent and affiliated components first.</span></span> <span data-ttu-id="8fa7c-105">Vous pouvez ensuite installer le serveur Azure Multi-Factor Authentication et les composants associés.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-105">Then the Multi-Factor Authentication Server and its affiliated components can be installed.</span></span>

## <a name="uninstall-the-phonefactor-agent"></a><span data-ttu-id="8fa7c-106">Désinstallation de l’agent PhoneFactor</span><span class="sxs-lookup"><span data-stu-id="8fa7c-106">Uninstall the PhoneFactor Agent</span></span>

1. <span data-ttu-id="8fa7c-107">Tout d'abord, sauvegardez le fichier de données PhoneFactor.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-107">First, back up the PhoneFactor data file.</span></span> <span data-ttu-id="8fa7c-108">L'emplacement d'installation par défaut est C:\Program Files\PhoneFactor\Data\Phonefactor.pfdata.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-108">The default installation location is C:\Program Files\PhoneFactor\Data\Phonefactor.pfdata.</span></span>

2. <span data-ttu-id="8fa7c-109">Si le portail de l'utilisateur est installé :</span><span class="sxs-lookup"><span data-stu-id="8fa7c-109">If the User Portal is installed:</span></span>
  1. <span data-ttu-id="8fa7c-110">Accédez au dossier d'installation et sauvegardez le fichier web.config.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-110">Navigate to the install folder and back up the web.config file.</span></span> <span data-ttu-id="8fa7c-111">L'emplacement d'installation par défaut est C:\inetpub\wwwroot\PhoneFactor.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-111">The default installation location is C:\inetpub\wwwroot\PhoneFactor.</span></span>

  2. <span data-ttu-id="8fa7c-112">Si vous avez ajouté des thèmes personnalisés au portail, sauvegardez votre dossier personnalisé sous le répertoire C:\inetpub\wwwroot\PhoneFactor\App_Themes.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-112">If you have added custom themes to the portal, back up your custom folder below the C:\inetpub\wwwroot\PhoneFactor\App_Themes directory.</span></span>

  3. <span data-ttu-id="8fa7c-113">Désinstallez le portail de l'utilisateur via l’agent PhoneFactor (disponible uniquement s’il est installé sur le même serveur que l’agent PhoneFactor) ou les programmes et fonctionnalités Windows.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-113">Uninstall the User Portal either through the PhoneFactor Agent (only available if installed on the same server as the PhoneFactor Agent) or through Windows Programs and Features.</span></span>

3. <span data-ttu-id="8fa7c-114">Si le service web de l’application mobile est installé :</span><span class="sxs-lookup"><span data-stu-id="8fa7c-114">If the Mobile App Web Service is installed:</span></span>

  1. <span data-ttu-id="8fa7c-115">Accédez au dossier d’installation et sauvegardez le fichier web.config.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-115">Go to the install folder and back up the web.config file.</span></span> <span data-ttu-id="8fa7c-116">L’emplacement d’installation par défaut est C:\inetpub\wwwroot\PhoneFactorPhoneAppWebService.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-116">The default installation location is C:\inetpub\wwwroot\PhoneFactorPhoneAppWebService.</span></span>

  2. <span data-ttu-id="8fa7c-117">Désinstaller le service web de l’application mobile via les programmes et fonctionnalités Windows.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-117">Uninstall the Mobile App Web Service through Windows Programs and Features.</span></span>

4. <span data-ttu-id="8fa7c-118">Si le Kit de développement logiciel (SDK) Web Service est installé, désinstallez-le via l’agent PhoneFactor ou les programmes et fonctionnalités Windows.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-118">If the Web Service SDK is installed, uninstall it either through the PhoneFactor Agent or through Windows Programs and Features.</span></span>

5. <span data-ttu-id="8fa7c-119">Désinstallez l’agent PhoneFactor via les programmes et fonctionnalités Windows.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-119">Uninstall the PhoneFactor Agent through Windows Programs and Features.</span></span>

## <a name="install-the-multi-factor-authentication-server"></a><span data-ttu-id="8fa7c-120">Installation du serveur Azure Multi-Factor Authentication</span><span class="sxs-lookup"><span data-stu-id="8fa7c-120">Install the Multi-Factor Authentication Server</span></span>

<span data-ttu-id="8fa7c-121">Le chemin d’installation est récupéré à partir du Registre de l’installation de l’agent PhoneFactor précédente. Le serveur Multi-Factor Authentication devrait donc s’installer au même emplacement (par exemple, C:\Program Files\PhoneFactor).</span><span class="sxs-lookup"><span data-stu-id="8fa7c-121">The installation path is picked up from the registry from the previous PhoneFactor Agent installation, so it should install in the same location (for example, C:\Program Files\PhoneFactor).</span></span> <span data-ttu-id="8fa7c-122">Les nouvelles installations présentent un chemin d’installation par défaut différent (par exemple, C:\Program Files\Multi-Factor Authentication Server).</span><span class="sxs-lookup"><span data-stu-id="8fa7c-122">New installations have a different default install path (for example, C:\Program Files\Multi-Factor Authentication Server).</span></span> <span data-ttu-id="8fa7c-123">Le fichier de données de l’agent PhoneFactor doit être mis à niveau lors de l'installation pour que vos utilisateurs et les paramètres puissent toujours être présents après l’installation du nouveau serveur Multi-Factor Authentication.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-123">The data file left by the previous PhoneFactor Agent should be upgraded during installation, so your users and settings should still be there after installing the new Multi-Factor Authentication Server.</span></span>

1. <span data-ttu-id="8fa7c-124">Si vous y êtes invité, activez le serveur Multi-Factor Authentication et assurez-vous qu'il est affecté au groupe de réplication approprié.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-124">If prompted, activate the Multi-Factor Authentication Server and ensure it is assigned to the correct replication group.</span></span>

2. <span data-ttu-id="8fa7c-125">Si le Kit de développement logiciel (SDK) Web Service a été précédemment installé, installez le nouveau Kit de développement logiciel (SDK) Web Service via l'Interface utilisateur du serveur Multi-Factor Authentication.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-125">If the Web Service SDK was previously installed, install the new Web Service SDK through the Multi-Factor Authentication Server User Interface.</span></span>

  <span data-ttu-id="8fa7c-126">Le nom de répertoire virtuel par défaut est désormais **MultiFactorAuthWebServiceSdk** au lieu de **PhoneFactorWebServiceSdk**.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-126">The default virtual directory name is now **MultiFactorAuthWebServiceSdk** instead of **PhoneFactorWebServiceSdk**.</span></span> <span data-ttu-id="8fa7c-127">Si vous souhaitez utiliser le nom précédent, vous devez modifier le nom du répertoire virtuel pendant l'installation.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-127">If you want to use the previous name, you must change the name of the virtual directory during installation.</span></span> <span data-ttu-id="8fa7c-128">Dans le cas contraire, si vous autorisez le programme d’installation à utiliser le nouveau nom par défaut, vous devez modifier l’URL dans toutes les applications qui référencent le Kit de développement logiciel (SDK) du service web (telles que le portail de l’utilisateur et le service web de l’application mobile) pour pointer vers l’emplacement correct.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-128">Otherwise, if you allow the install to use the new default name, you have to change the URL in any applications that reference the Web Service SDK (like the User Portal and Mobile App Web Service) to point at the correct location.</span></span>

3. <span data-ttu-id="8fa7c-129">Si le portail de l'utilisateur a été précédemment installé sur le serveur de l'agent PhoneFactor, installez le nouveau portail utilisateur Multi-Factor Authentication via l'Interface Multi-Factor Authentication.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-129">If the User Portal was previously installed on the PhoneFactor Agent Server, install the new Multi-Factor Authentication User Portal through the Multi-Factor Authentication Server User Interface.</span></span>

  <span data-ttu-id="8fa7c-130">Le nom de répertoire virtuel par défaut est désormais **MultiFactorAuth** au lieu de **PhoneFactor**.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-130">The default virtual directory name is now **MultiFactorAuth** instead of **PhoneFactor**.</span></span> <span data-ttu-id="8fa7c-131">Si vous souhaitez utiliser le nom précédent, vous devez modifier le nom du répertoire virtuel pendant l'installation.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-131">If you want to use the previous name, you must change the name of the virtual directory during installation.</span></span> <span data-ttu-id="8fa7c-132">Sinon, si vous autorisez le programme d'installation à utiliser le nouveau nom par défaut, vous cliquez sur l'icône Portail de l'utilisateur sur le serveur Multi-Factor Authentication et mettez à jour l'URL du portail utilisateur sous l'onglet Paramètres.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-132">Otherwise, if you allow the install to use the new default name, you should click the User Portal icon in the Multi-Factor Authentication Server and update the User Portal URL on the Settings tab.</span></span>

4. <span data-ttu-id="8fa7c-133">Si le Portail de l’utilisateur et/ou le service web de l’application mobile ont été installés précédemment sur un serveur différent de l’agent PhoneFactor :</span><span class="sxs-lookup"><span data-stu-id="8fa7c-133">If the User Portal and/or Mobile App Web Service was previously installed on a different server from the PhoneFactor Agent:</span></span>

  1. <span data-ttu-id="8fa7c-134">Accédez à l’emplacement d’installation (par exemple, C:\Program Files\PhoneFactor), puis copiez un ou plusieurs programmes d’installation sur l’autre serveur.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-134">Go to the install location (for example, C:\Program Files\PhoneFactor) and copy one or more installers to the other server.</span></span> <span data-ttu-id="8fa7c-135">Il existe des programmes d'installation 32 bits et 64 bits pour le portail de l'utilisateur et le service web de l'application mobile.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-135">There are 32-bit and 64-bit installers for both the User Portal and Mobile App Web Service.</span></span> <span data-ttu-id="8fa7c-136">Ils sont appelés MultiFactorAuthenticationUserPortalSetupXX.msi et MultiFactorAuthenticationMobileAppWebServiceSetupXX.msi.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-136">They are called MultiFactorAuthenticationUserPortalSetupXX.msi and MultiFactorAuthenticationMobileAppWebServiceSetupXX.msi.</span></span>

  2. <span data-ttu-id="8fa7c-137">Pour installer le portail de l’utilisateur sur le serveur web, ouvrez une invite de commandes en tant qu’administrateur et exécutez MultiFactorAuthenticationUserPortalSetupXX.msi.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-137">To install the User Portal on the web server, open a command prompt as an administrator and run MultiFactorAuthenticationUserPortalSetupXX.msi.</span></span>

    <span data-ttu-id="8fa7c-138">Le nom de répertoire virtuel par défaut est désormais **MultiFactorAuth** au lieu de **PhoneFactor**.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-138">The default virtual directory name is now **MultiFactorAuth** instead of **PhoneFactor**.</span></span> <span data-ttu-id="8fa7c-139">Si vous souhaitez utiliser le nom précédent, vous devez modifier le nom du répertoire virtuel pendant l'installation.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-139">If you want to use the previous name, you must change the name of the virtual directory during installation.</span></span> <span data-ttu-id="8fa7c-140">Sinon, si vous autorisez le programme d'installation à utiliser le nouveau nom par défaut, vous cliquez sur l'icône Portail de l'utilisateur sur le serveur Multi-Factor Authentication et mettez à jour l'URL du portail utilisateur sous l'onglet Paramètres.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-140">Otherwise, if you allow the install to use the new default name, you should click the User Portal icon in the Multi-Factor Authentication Server and update the User Portal URL on the Settings tab.</span></span> <span data-ttu-id="8fa7c-141">Les utilisateurs existants doivent être informés de la nouvelle URL.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-141">Existing users need to be informed of the new URL.</span></span>

  3. <span data-ttu-id="8fa7c-142">Accédez à l’emplacement d’installation du portail de l’utilisateur (par exemple, C:\inetpub\wwwroot\MultiFactorAuth) et modifiez le fichier web.config.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-142">Go to the User Portal install location (for example, C:\inetpub\wwwroot\MultiFactorAuth) and edit the web.config file.</span></span> <span data-ttu-id="8fa7c-143">Copiez dans le nouveau fichier web.config les valeurs des sections appSettings et applicationSettings de votre fichier web.config d’origine qui a été sauvegardé avant la mise à niveau.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-143">Copy the values in the appSettings and applicationSettings sections from your original web.config file that was backed up before the upgrade into the new web.config file.</span></span> <span data-ttu-id="8fa7c-144">Si le nouveau nom de répertoire virtuel par défaut a été conservé lors de l'installation du Kit de développement logiciel (SDK) Web Service, modifiez l'URL dans la section applicationSettings pour pointer vers le bon emplacement.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-144">If the new default virtual directory name was kept when installing the Web Service SDK, change the URL in the applicationSettings section to point to the correct location.</span></span> <span data-ttu-id="8fa7c-145">Si les valeurs par défaut ont été modifiées dans le précédent fichier web.config, appliquez les mêmes modifications au nouveau fichier web.config.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-145">If any other defaults were changed in the previous web.config file, apply those same changes to the new web.config file.</span></span>

  4. <span data-ttu-id="8fa7c-146">Pour installer le service web de l’application mobile sur le serveur web, ouvrez une invite de commandes en tant qu’administrateur et exécutez MultiFactorAuthenticationMobileAppWebServiceSetupXX.msi.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-146">To install the Mobile App Web Service on the web server, open a command prompt as an administrator and run the MultiFactorAuthenticationMobileAppWebServiceSetupXX.msi.</span></span>

    <span data-ttu-id="8fa7c-147">Le nom de répertoire virtuel par défaut est désormais **MultiFactorAuthMobileAppWebService** au lieu de **PhoneFactorPhoneAppWebService**.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-147">The default virtual directory name is now **MultiFactorAuthMobileAppWebService** instead of **PhoneFactorPhoneAppWebService**.</span></span> <span data-ttu-id="8fa7c-148">Si vous souhaitez utiliser le nom précédent, vous devez modifier le nom du répertoire virtuel pendant l'installation.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-148">If you want to use the previous name, you must change the name of the virtual directory during installation.</span></span> <span data-ttu-id="8fa7c-149">Vous devriez probablement choisir un nom plus court pour faciliter la saisie des utilisateurs finaux sur leurs périphériques mobiles.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-149">You may want to choose a shorter name to make it easy for end users to type in on their mobile devices.</span></span> <span data-ttu-id="8fa7c-150">Sinon, si vous autorisez le programme d’installation à utiliser le nouveau nom par défaut, vous cliquez sur l’icône Application mobile sur le serveur Multi-Factor Authentication et mettez à jour l’URL du service web de l’application mobile.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-150">Otherwise, if you allow the install to use the new default name, you should click the Mobile App icon in the Multi-Factor Authentication Server and update the Mobile App Web Service URL.</span></span>

  5. <span data-ttu-id="8fa7c-151">Accédez à l’emplacement d’installation du service web de l’application mobile (par exemple, C:\inetpub\wwwroot\MultiFactorAuthMobileAppWebService) et modifiez le fichier web.config.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-151">Go to the Mobile App Web Service install location (for example, C:\inetpub\wwwroot\MultiFactorAuthMobileAppWebService) and edit the web.config file.</span></span> <span data-ttu-id="8fa7c-152">Copiez dans le nouveau fichier web.config les valeurs des sections appSettings et applicationSettings de votre fichier web.config d’origine qui a été sauvegardé avant la mise à niveau.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-152">Copy the values in the appSettings and applicationSettings sections from your original web.config file that was backed up before the upgrade into the new web.config file.</span></span> <span data-ttu-id="8fa7c-153">Si le nouveau nom de répertoire virtuel par défaut a été conservé lors de l'installation du Kit de développement logiciel (SDK) Web Service, modifiez l'URL dans la section applicationSettings pour pointer vers le bon emplacement.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-153">If the new default virtual directory name was kept when installing the Web Service SDK, change the URL in the applicationSettings section to point to the correct location.</span></span> <span data-ttu-id="8fa7c-154">Si les valeurs par défaut ont été modifiées dans le précédent fichier web.config, appliquez les mêmes modifications au nouveau fichier web.config.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-154">If any other defaults were changed in the previous web.config file, apply those same changes to the new web.config file.</span></span>

## <a name="next-steps"></a><span data-ttu-id="8fa7c-155">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="8fa7c-155">Next steps</span></span>

- <span data-ttu-id="8fa7c-156">[Installez le portail des utilisateurs](multi-factor-authentication-get-started-portal.md) du serveur Azure Multi-Factor Authentication.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-156">[Install the users portal](multi-factor-authentication-get-started-portal.md) for the Azure Multi-Factor Authentication Server.</span></span>

- <span data-ttu-id="8fa7c-157">[Configurez l’authentification Windows](multi-factor-authentication-get-started-server-windows.md) pour vos applications.</span><span class="sxs-lookup"><span data-stu-id="8fa7c-157">[Configure Windows Authentication](multi-factor-authentication-get-started-server-windows.md) for your applications.</span></span> 
