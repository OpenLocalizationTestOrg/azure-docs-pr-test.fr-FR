---
title: "aaaConfigure hello extension d’Azure MFA NPS | Documents Microsoft"
description: "Après l’installation d’extension NPS hello, utilisez ces étapes de configuration avancées telles que la liste des IP approuvées et remplacement de l’UPN."
services: multi-factor-authentication
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: 
ms.service: multi-factor-authentication
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/14/2017
ms.author: kgremban
ms.reviewer: yossib
ms.custom: it-pro
ms.openlocfilehash: c3aed077b23c95f874861eb00c8e6dca668329c1
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="advanced-configuration-options-for-hello-nps-extension-for-multi-factor-authentication"></a><span data-ttu-id="ed29d-103">Configuration des options avancées pour hello extension du serveur NPS pour l’authentification multifacteur</span><span class="sxs-lookup"><span data-stu-id="ed29d-103">Advanced configuration options for hello NPS extension for Multi-Factor Authentication</span></span>

<span data-ttu-id="ed29d-104">Hello, extension de serveur NPS (Network Policy Server) étend vos fonctionnalités d’Azure multi-Factor Authentication sur le cloud dans votre infrastructure locale.</span><span class="sxs-lookup"><span data-stu-id="ed29d-104">hello Network Policy Server (NPS) extension extends your cloud-based Azure Multi-Factor Authentication features into your on-premises infrastructure.</span></span> <span data-ttu-id="ed29d-105">Cet article suppose que vous disposez déjà d’extension hello installée et que vous souhaitez maintenant les tooknow comment toocustomize d’extension hello vous doit.</span><span class="sxs-lookup"><span data-stu-id="ed29d-105">This article assumes that you already have hello extension installed, and now want tooknow how toocustomize hello extension for you needs.</span></span> 

## <a name="alternate-login-id"></a><span data-ttu-id="ed29d-106">ID de connexion de substitution</span><span class="sxs-lookup"><span data-stu-id="ed29d-106">Alternate login ID</span></span>

<span data-ttu-id="ed29d-107">Étant donné que hello extension de serveur NPS connecte tooboth vos locaux et le cloud répertoires, vous pouvez rencontrer un problème où les noms de principal d’utilisateur local (UPN) ne correspondent pas les noms hello dans le cloud de hello.</span><span class="sxs-lookup"><span data-stu-id="ed29d-107">Since hello NPS extension connects tooboth your on-premises and cloud directories, you might encounter an issue where your on-premises user principal names (UPNs) don't match hello names in hello cloud.</span></span> <span data-ttu-id="ed29d-108">toosolve ce problème, utiliser une autre connexion ID.</span><span class="sxs-lookup"><span data-stu-id="ed29d-108">toosolve this problem, use alternate login IDs.</span></span> 

<span data-ttu-id="ed29d-109">Au sein de hello extension du serveur NPS, vous pouvez désigner un toobe d’attribut Active Directory utilisé à la place de hello UPN pour Azure multi-Factor Authentication.</span><span class="sxs-lookup"><span data-stu-id="ed29d-109">Within hello NPS extension, you can designate an Active Directory attribute toobe used in place of hello UPN for Azure Multi-Factor Authentication.</span></span> <span data-ttu-id="ed29d-110">Cela permet à vos ressources locales avec la vérification en deux étapes vous tooprotect sans modifier votre UPN local.</span><span class="sxs-lookup"><span data-stu-id="ed29d-110">This enables you tooprotect your on-premises resources with two-step verification without modifying your on-premises UPNs.</span></span> 

<span data-ttu-id="ed29d-111">la connexion de remplacement tooconfigure ID, accédez trop`HKLM\SOFTWARE\Microsoft\AzureMfa` et modifier hello les valeurs de Registre suivantes :</span><span class="sxs-lookup"><span data-stu-id="ed29d-111">tooconfigure alternate login IDs, go too`HKLM\SOFTWARE\Microsoft\AzureMfa` and edit hello following registry values:</span></span>

| <span data-ttu-id="ed29d-112">Nom</span><span class="sxs-lookup"><span data-stu-id="ed29d-112">Name</span></span> | <span data-ttu-id="ed29d-113">Type</span><span class="sxs-lookup"><span data-stu-id="ed29d-113">Type</span></span> | <span data-ttu-id="ed29d-114">Valeur par défaut</span><span class="sxs-lookup"><span data-stu-id="ed29d-114">Default value</span></span> | <span data-ttu-id="ed29d-115">Description</span><span class="sxs-lookup"><span data-stu-id="ed29d-115">Description</span></span> |
| ---- | ---- | ------------- | ----------- |
| <span data-ttu-id="ed29d-116">LDAP_ALTERNATE_LOGINID_ATTRIBUTE</span><span class="sxs-lookup"><span data-stu-id="ed29d-116">LDAP_ALTERNATE_LOGINID_ATTRIBUTE</span></span> | <span data-ttu-id="ed29d-117">string</span><span class="sxs-lookup"><span data-stu-id="ed29d-117">string</span></span> | <span data-ttu-id="ed29d-118">Vide</span><span class="sxs-lookup"><span data-stu-id="ed29d-118">Empty</span></span> | <span data-ttu-id="ed29d-119">Désigne le nom hello attribut Active Directory que vous souhaitez toouse au lieu de hello UPN.</span><span class="sxs-lookup"><span data-stu-id="ed29d-119">Designate hello name of Active Directory attribute that you want toouse instead of hello UPN.</span></span> <span data-ttu-id="ed29d-120">Cet attribut est utilisé en tant qu’attribut de AlternateLoginId hello.</span><span class="sxs-lookup"><span data-stu-id="ed29d-120">This attribute is used as hello AlternateLoginId attribute.</span></span> <span data-ttu-id="ed29d-121">Si cette valeur de Registre a la valeur tooa [attribut Active Directory valide](https://msdn.microsoft.com/library/ms675090.aspx) (par exemple, la messagerie ou displayName), puis hello valeur d’attribut est utilisé à la place de UPN l’utilisateur hello pour l’authentification.</span><span class="sxs-lookup"><span data-stu-id="ed29d-121">If this registry value is set tooa [valid Active Directory attribute](https://msdn.microsoft.com/library/ms675090.aspx) (for example, mail or displayName), then hello attribute's value is used in place of hello user's UPN for authentication.</span></span> <span data-ttu-id="ed29d-122">Si cette valeur de Registre est vide ou non configuré, puis AlternateLoginId est désactivée et l’UPN de l’utilisateur hello est utilisé pour l’authentification.</span><span class="sxs-lookup"><span data-stu-id="ed29d-122">If this registry value is empty or not configured, then AlternateLoginId is disabled and hello user's UPN is used for authentication.</span></span> |
| <span data-ttu-id="ed29d-123">LDAP_FORCE_GLOBAL_CATALOG</span><span class="sxs-lookup"><span data-stu-id="ed29d-123">LDAP_FORCE_GLOBAL_CATALOG</span></span> | <span data-ttu-id="ed29d-124">booléenne</span><span class="sxs-lookup"><span data-stu-id="ed29d-124">boolean</span></span> | <span data-ttu-id="ed29d-125">False</span><span class="sxs-lookup"><span data-stu-id="ed29d-125">False</span></span> | <span data-ttu-id="ed29d-126">Utilisez cet indicateur tooforce hello de catalogue Global pour les recherches LDAP lorsque vous recherchez AlternateLoginId.</span><span class="sxs-lookup"><span data-stu-id="ed29d-126">Use this flag tooforce hello use of Global Catalog for LDAP searches when looking up AlternateLoginId.</span></span> <span data-ttu-id="ed29d-127">Configurer un contrôleur de domaine en tant que catalogue Global, ajoutez hello AlternateLoginId attribut toohello catalogue Global, puis activer cet indicateur.</span><span class="sxs-lookup"><span data-stu-id="ed29d-127">Configure a domain controller as a Global Catalog, add hello AlternateLoginId attribute toohello Global Catalog, and then enable this flag.</span></span> <br><br> <span data-ttu-id="ed29d-128">Si LDAP_LOOKUP_FORESTS est configuré (n’est pas vide), **cet indicateur est appliqué comme true**, indépendamment de la valeur hello hello du paramètre de Registre.</span><span class="sxs-lookup"><span data-stu-id="ed29d-128">If LDAP_LOOKUP_FORESTS is configured (not empty), **this flag is enforced as true**, regardless of hello value of hello registry setting.</span></span> <span data-ttu-id="ed29d-129">Dans ce cas, hello extension NPS requiert hello toobe de catalogue Global configuré avec l’attribut de AlternateLoginId hello pour chaque forêt.</span><span class="sxs-lookup"><span data-stu-id="ed29d-129">In this case, hello NPS extension requires hello Global Catalog toobe configured with hello AlternateLoginId attribute for each forest.</span></span> |
| <span data-ttu-id="ed29d-130">LDAP_LOOKUP_FORESTS</span><span class="sxs-lookup"><span data-stu-id="ed29d-130">LDAP_LOOKUP_FORESTS</span></span> | <span data-ttu-id="ed29d-131">string</span><span class="sxs-lookup"><span data-stu-id="ed29d-131">string</span></span> | <span data-ttu-id="ed29d-132">Vide</span><span class="sxs-lookup"><span data-stu-id="ed29d-132">Empty</span></span> | <span data-ttu-id="ed29d-133">Fournissez une liste séparés par des points-virgules de forêts toosearch.</span><span class="sxs-lookup"><span data-stu-id="ed29d-133">Provide a semi-colon separated list of forests toosearch.</span></span> <span data-ttu-id="ed29d-134">Par exemple, *contoso.com;foobar.com*. Si cette valeur de Registre est configurée, hello extension du serveur NPS recherche itérative dans toutes les forêts hello dans l’ordre de hello dans lequel ils ont été répertoriés et retourne la première valeur AlternateLoginId réussie hello.</span><span class="sxs-lookup"><span data-stu-id="ed29d-134">For example, *contoso.com;foobar.com*. If this registry value is configured, hello NPS extension iteratively searches all hello forests in hello order in which they were listed, and returns hello first successful AlternateLoginId value.</span></span> <span data-ttu-id="ed29d-135">Si cette valeur de Registre n’est pas configurée, recherche de AlternateLoginId hello est confiné toohello les domaine actuel.</span><span class="sxs-lookup"><span data-stu-id="ed29d-135">If this registry value is not configured, hello AlternateLoginId lookup is confined toohello current domain.</span></span>|

<span data-ttu-id="ed29d-136">problèmes tootroubleshoot avec une autre connexion ID, utilisez hello recommande une procédure de [autres erreurs d’ID de connexion](multi-factor-authentication-nps-errors.md#alternate-login-id-errors).</span><span class="sxs-lookup"><span data-stu-id="ed29d-136">tootroubleshoot problems with alternate login IDs, use hello recommended steps for [Alternate login ID errors](multi-factor-authentication-nps-errors.md#alternate-login-id-errors).</span></span>

## <a name="ip-exceptions"></a><span data-ttu-id="ed29d-137">Exceptions liées aux adresses IP</span><span class="sxs-lookup"><span data-stu-id="ed29d-137">IP exceptions</span></span>

<span data-ttu-id="ed29d-138">Si vous avez besoin de disponibilité du serveur toomonitor, comme si les équilibreurs de charge vérifier quels serveurs sont en cours d’exécution avant l’envoi des charges de travail, vous ne souhaitez pas que ces toobe vérifications bloquées par des demandes de vérification.</span><span class="sxs-lookup"><span data-stu-id="ed29d-138">If you need toomonitor server availability, like if load balancers verify which servers are running before sending workloads, you don't want these checks toobe blocked by verification requests.</span></span> <span data-ttu-id="ed29d-139">Au lieu de cela, créez une liste d’adresses IP utilisées par les comptes de service, puis désactivez les exigences de l’authentification multifacteur pour cette liste.</span><span class="sxs-lookup"><span data-stu-id="ed29d-139">Instead, create a list of IP addresses that you know are used by service accounts, and disable Multi-Factor Authentication requirements for that list.</span></span> 

<span data-ttu-id="ed29d-140">tooconfigure une liste blanche d’adresses IP, accédez trop`HKLM\SOFTWARE\Microsoft\AzureMfa` et configurer hello valeur de Registre suivante :</span><span class="sxs-lookup"><span data-stu-id="ed29d-140">tooconfigure an IP whitelist, go too`HKLM\SOFTWARE\Microsoft\AzureMfa` and configure hello following registry value:</span></span> 

| <span data-ttu-id="ed29d-141">Nom</span><span class="sxs-lookup"><span data-stu-id="ed29d-141">Name</span></span> | <span data-ttu-id="ed29d-142">Type</span><span class="sxs-lookup"><span data-stu-id="ed29d-142">Type</span></span> | <span data-ttu-id="ed29d-143">Valeur par défaut</span><span class="sxs-lookup"><span data-stu-id="ed29d-143">Default value</span></span> | <span data-ttu-id="ed29d-144">Description</span><span class="sxs-lookup"><span data-stu-id="ed29d-144">Description</span></span> |
| ---- | ---- | ------------- | ----------- |
| <span data-ttu-id="ed29d-145">IP_WHITELIST</span><span class="sxs-lookup"><span data-stu-id="ed29d-145">IP_WHITELIST</span></span> | <span data-ttu-id="ed29d-146">string</span><span class="sxs-lookup"><span data-stu-id="ed29d-146">string</span></span> | <span data-ttu-id="ed29d-147">Vide</span><span class="sxs-lookup"><span data-stu-id="ed29d-147">Empty</span></span> | <span data-ttu-id="ed29d-148">Fournissez une liste séparée par des points-virgules pour les adresses IP.</span><span class="sxs-lookup"><span data-stu-id="ed29d-148">Provide a semi-colon separated list of IP addresses.</span></span> <span data-ttu-id="ed29d-149">Inclure les adresses IP de hello d’origine des demandes de service, comme hello serveur NAS/VPN des ordinateurs.</span><span class="sxs-lookup"><span data-stu-id="ed29d-149">Include hello IP addresses of machines where service requests originate, like hello NAS/VPN server.</span></span> <span data-ttu-id="ed29d-150">Les plages d’adresses IP et les sous-réseaux ne sont pas pris en charge.</span><span class="sxs-lookup"><span data-stu-id="ed29d-150">IP ranges are subnets are not supported.</span></span> <br><br> <span data-ttu-id="ed29d-151">Par exemple, *10.0.0.1;10.0.0.2;10.0.0.3*.</span><span class="sxs-lookup"><span data-stu-id="ed29d-151">For example, *10.0.0.1;10.0.0.2;10.0.0.3*.</span></span>

<span data-ttu-id="ed29d-152">Lorsqu’une demande arrive à partir d’une adresse IP qui existe dans la liste verte de hello, vérification en deux étapes est ignorée.</span><span class="sxs-lookup"><span data-stu-id="ed29d-152">When a request comes in from an IP address that exists in hello whitelist, two-step verification is skipped.</span></span> <span data-ttu-id="ed29d-153">adresse IP comparés toohello qui est fourni dans hello est Hello liste blanche d’adresses IP *ratNASIPAddress* attribut de la demande RADIUS hello.</span><span class="sxs-lookup"><span data-stu-id="ed29d-153">hello IP whitelist is compared toohello IP address that is provided in hello *ratNASIPAddress* attribute of hello RADIUS request.</span></span> <span data-ttu-id="ed29d-154">Si une demande RADIUS est fourni sans attribut de ratNASIPAddress hello, hello suivant l’avertissement est consigné : « Liste d’autorisation P_WHITE_LIST_WARNING::IP est ignoré car l’adresse IP source est manquant dans la demande RADIUS dans l’attribut de NasIpAddress. »</span><span class="sxs-lookup"><span data-stu-id="ed29d-154">If a RADIUS request comes in without hello ratNASIPAddress attribute, hello following warning is logged: "P_WHITE_LIST_WARNING::IP Whitelist is being ignored as source IP is missing in RADIUS request in NasIpAddress attribute."</span></span>

## <a name="next-steps"></a><span data-ttu-id="ed29d-155">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="ed29d-155">Next steps</span></span>

[<span data-ttu-id="ed29d-156">Résoudre les messages d’erreur de hello extension du serveur NPS pour Azure multi-Factor Authentication</span><span class="sxs-lookup"><span data-stu-id="ed29d-156">Resolve error messages from hello NPS extension for Azure Multi-Factor Authentication</span></span>](multi-factor-authentication-nps-errors.md)
