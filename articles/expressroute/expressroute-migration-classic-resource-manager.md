---
title: "Migrer des réseaux virtuels associés à ExpressRoute d’un déploiement classique vers Resource Manager - Azure : PowerShell | Microsoft Docs"
description: "Cette page explique comment migrer des réseaux virtuels associés vers Resource Manager après avoir déplacé votre circuit."
documentationcenter: na
services: expressroute
author: ganesr
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 
ms.service: expressroute
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 07/06/2017
ms.author: ganesr;cherylmc
ms.openlocfilehash: 964ea38569062a7127f60dd6309b328db263bf6f
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/03/2017
---
# <a name="migrate-expressroute-associated-virtual-networks-from-classic-to-resource-manager"></a><span data-ttu-id="57fc4-103">Migrer des réseaux virtuels associés à ExpressRoute d’un déploiement classique vers Resource Manager</span><span class="sxs-lookup"><span data-stu-id="57fc4-103">Migrate ExpressRoute associated virtual networks from classic to Resource Manager</span></span>

<span data-ttu-id="57fc4-104">Cet article explique comment migrer des réseaux virtuels associés à ExpressRoute du modèle de déploiement classique au modèle de déploiement Azure Resource Manager après avoir déplacé votre circuit ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="57fc4-104">This article explains how to migrate Azure ExpressRoute associated virtual networks from the classic deployment model to the Azure Resource Manager deployment model after moving your ExpressRoute circuit.</span></span> 


## <a name="before-you-begin"></a><span data-ttu-id="57fc4-105">Avant de commencer</span><span class="sxs-lookup"><span data-stu-id="57fc4-105">Before you begin</span></span>
* <span data-ttu-id="57fc4-106">Vérifiez que vous disposez de la dernière version des modules Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="57fc4-106">Verify that you have the latest version of the Azure PowerShell modules.</span></span> <span data-ttu-id="57fc4-107">Pour plus d’informations, consultez la rubrique [Installation et configuration d’Azure PowerShell](/powershell/azure/overview).</span><span class="sxs-lookup"><span data-stu-id="57fc4-107">For more information, see [How to install and configure Azure PowerShell](/powershell/azure/overview).</span></span>
* <span data-ttu-id="57fc4-108">Veillez à consulter les [conditions préalables](expressroute-prerequisites.md), la [configuration requise pour le routage](expressroute-routing.md) et les [flux de travail](expressroute-workflows.md) avant de commencer la configuration.</span><span class="sxs-lookup"><span data-stu-id="57fc4-108">Make sure that you have reviewed the [prerequisites](expressroute-prerequisites.md), [routing requirements](expressroute-routing.md), and [workflows](expressroute-workflows.md) before you begin configuration.</span></span>
* <span data-ttu-id="57fc4-109">Examinez les informations fournies sous [Transfert des circuits ExpressRoute du modèle de déploiement classique vers le modèle de déploiement Resource Manager](expressroute-move.md).</span><span class="sxs-lookup"><span data-stu-id="57fc4-109">Review the information that is provided under [Moving an ExpressRoute circuit from classic to Resource Manager](expressroute-move.md).</span></span> <span data-ttu-id="57fc4-110">Vous devez avoir bien compris les limites et les limitations.</span><span class="sxs-lookup"><span data-stu-id="57fc4-110">Make sure that you fully understand the limits and limitations.</span></span>
* <span data-ttu-id="57fc4-111">Vérifiez que le circuit est totalement opérationnel dans le modèle de déploiement classique.</span><span class="sxs-lookup"><span data-stu-id="57fc4-111">Verify that the circuit is fully operational in the classic deployment model.</span></span>
* <span data-ttu-id="57fc4-112">Assurez-vous que vous disposez d’un groupe de ressources créé dans le modèle de déploiement Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="57fc4-112">Ensure that you have a resource group that was created in the Resource Manager deployment model.</span></span>
* <span data-ttu-id="57fc4-113">Passez en revue la documentation de migration de ressources suivante :</span><span class="sxs-lookup"><span data-stu-id="57fc4-113">Review the following resource-migration documentation:</span></span>

    * [<span data-ttu-id="57fc4-114">Migration prise en charge par la plateforme de ressources IaaS Classic vers Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="57fc4-114">Platform-supported migration of IaaS resources from classic to Azure Resource Manager</span></span>](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager.md)
    * [<span data-ttu-id="57fc4-115">Étude technique approfondie de la migration prise en charge par la plateforme de ressources Classic vers Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="57fc4-115">Technical deep dive on platform-supported migration from classic to Azure Resource Manager</span></span>](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager-deep-dive.md)
    * [<span data-ttu-id="57fc4-116">FAQ : Migration prise en charge par la plateforme de ressources IaaS Classic vers Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="57fc4-116">FAQs: Platform-supported migration of IaaS resources from classic to Azure Resource Manager</span></span>](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager.md)
    * [<span data-ttu-id="57fc4-117">Passer en revue les erreurs les plus courantes de la migration et leur prévention</span><span class="sxs-lookup"><span data-stu-id="57fc4-117">Review most common migration errors and mitigations</span></span>](../virtual-machines/windows/migration-classic-resource-manager-errors.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)

## <a name="supported-and-unsupported-scenarios"></a><span data-ttu-id="57fc4-118">Scénarios pris en charge et non pris en charge</span><span class="sxs-lookup"><span data-stu-id="57fc4-118">Supported and unsupported scenarios</span></span>

* <span data-ttu-id="57fc4-119">Il est possible de migrer un circuit ExpressRoute de l’environnement classique à l’environnement Resource Manager sans aucun temps d’arrêt.</span><span class="sxs-lookup"><span data-stu-id="57fc4-119">An ExpressRoute circuit can be moved from the classic to the Resource Manager environment without any downtime.</span></span> <span data-ttu-id="57fc4-120">Vous pouvez déplacer n’importe quel circuit ExpressRoute de l’environnement classique à l’environnement Resource Manager sans temps d’arrêt.</span><span class="sxs-lookup"><span data-stu-id="57fc4-120">You can move any ExpressRoute circuit from the classic to the Resource Manager environment with no downtime.</span></span> <span data-ttu-id="57fc4-121">Suivez les instructions relatives au [déplacement des circuits ExpressRoute du modèle de déploiement classique vers le modèle de déploiement Resource Manager à l’aide de PowerShell](expressroute-howto-move-arm.md).</span><span class="sxs-lookup"><span data-stu-id="57fc4-121">Follow the instructions in [moving ExpressRoute circuits from the classic to the Resource Manager deployment model using PowerShell](expressroute-howto-move-arm.md).</span></span> <span data-ttu-id="57fc4-122">C’est une condition requise pour déplacer des ressources connectées au réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="57fc4-122">This is a prerequisite to move resources connected to the virtual network.</span></span>
* <span data-ttu-id="57fc4-123">Il est possible de migrer les réseaux virtuels, les passerelles et les déploiements associés au sein du réseau virtuel qui sont attachés à un circuit ExpressRoute se trouvant dans le même abonnement vers l’environnement Resource Manager sans le moindre temps d’arrêt.</span><span class="sxs-lookup"><span data-stu-id="57fc4-123">Virtual networks, gateways, and associated deployments within the virtual network that are attached to an ExpressRoute circuit in the same subscription can be migrated to the Resource Manager environment without any downtime.</span></span> <span data-ttu-id="57fc4-124">Vous pouvez suivre les étapes décrites plus loin pour migrer des ressources telles que des réseaux virtuels, des passerelles et des machines virtuelles déployées au sein du réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="57fc4-124">You can follow the steps described later to migrate resources such as virtual networks, gateways, and virtual machines deployed within the virtual network.</span></span> <span data-ttu-id="57fc4-125">Vous devez vous assurer que les réseaux virtuels sont configurés correctement avant de les migrer.</span><span class="sxs-lookup"><span data-stu-id="57fc4-125">You must ensure that the virtual networks are configured correctly before they are migrated.</span></span> 
* <span data-ttu-id="57fc4-126">La migration des réseaux virtuels, des passerelles et des déploiements associés au sein du réseau virtuel qui ne se trouvent pas dans le même abonnement que le circuit ExpressRoute nécessite un temps d’arrêt.</span><span class="sxs-lookup"><span data-stu-id="57fc4-126">Virtual networks, gateways, and associated deployments within the virtual network that are not in the same subscription as the ExpressRoute circuit require some downtime to complete the migration.</span></span> <span data-ttu-id="57fc4-127">La dernière section du document décrit les étapes à suivre pour migrer des ressources.</span><span class="sxs-lookup"><span data-stu-id="57fc4-127">The last section of the document describes the steps to be followed to migrate resources.</span></span>
* <span data-ttu-id="57fc4-128">Un réseau virtuel doté d’une passerelle ExpressRoute et d’une passerelle VPN ne peut pas être migré.</span><span class="sxs-lookup"><span data-stu-id="57fc4-128">A virtual network with both ExpressRoute Gateway and VPN Gateway can't be migrated.</span></span>

## <a name="move-an-expressroute-circuit-from-classic-to-resource-manager"></a><span data-ttu-id="57fc4-129">Déplacer un circuit ExpressRoute d’un déploiement classique vers Resource Manager</span><span class="sxs-lookup"><span data-stu-id="57fc4-129">Move an ExpressRoute circuit from classic to Resource Manager</span></span>
<span data-ttu-id="57fc4-130">Vous devez déplacer un circuit ExpressRoute de l’environnement classique à l’environnement Resource Manager avant d’essayer de migrer des ressources attachées au circuit ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="57fc4-130">You must move an ExpressRoute circuit from the classic to the Resource Manager environment before you try to migrate resources that are attached to the ExpressRoute circuit.</span></span> <span data-ttu-id="57fc4-131">Pour accomplir cette tâche, consultez les articles suivants :</span><span class="sxs-lookup"><span data-stu-id="57fc4-131">To accomplish this task, see the following articles:</span></span>

* <span data-ttu-id="57fc4-132">Examinez les informations fournies sous [Transfert des circuits ExpressRoute du modèle de déploiement classique vers le modèle de déploiement Resource Manager](expressroute-move.md).</span><span class="sxs-lookup"><span data-stu-id="57fc4-132">Review the information that is provided under [Moving an ExpressRoute circuit from classic to Resource Manager](expressroute-move.md).</span></span>
* <span data-ttu-id="57fc4-133">[Migrer un circuit d’un déploiement classique vers Resource Manager à l’aide d’Azure PowerShell](expressroute-howto-move-arm.md).</span><span class="sxs-lookup"><span data-stu-id="57fc4-133">[Move a circuit from classic to Resource Manager using Azure PowerShell](expressroute-howto-move-arm.md).</span></span>
* <span data-ttu-id="57fc4-134">Utilisez le portail de gestion des services Azure.</span><span class="sxs-lookup"><span data-stu-id="57fc4-134">Use the Azure Service Management portal.</span></span> <span data-ttu-id="57fc4-135">Vous pouvez suivre le flux de travail pour [créer un circuit ExpressRoute](expressroute-howto-circuit-portal-resource-manager.md) et sélectionner l’option d’importation.</span><span class="sxs-lookup"><span data-stu-id="57fc4-135">You can follow the workflow to [create a new ExpressRoute circuit](expressroute-howto-circuit-portal-resource-manager.md) and select the import option.</span></span> 

<span data-ttu-id="57fc4-136">Cette opération n’implique pas de temps d’arrêt.</span><span class="sxs-lookup"><span data-stu-id="57fc4-136">This operation does not involve downtime.</span></span> <span data-ttu-id="57fc4-137">Vous pouvez continuer à transférer des données entre votre site et Microsoft pendant la migration.</span><span class="sxs-lookup"><span data-stu-id="57fc4-137">You can continue to transfer data between your premises and Microsoft while the migration is in progress.</span></span>

## <a name="migrate-virtual-networks-gateways-and-associated-deployments"></a><span data-ttu-id="57fc4-138">Migrer des réseaux virtuels, des passerelles et les déploiements associés</span><span class="sxs-lookup"><span data-stu-id="57fc4-138">Migrate virtual networks, gateways, and associated deployments</span></span>

<span data-ttu-id="57fc4-139">Les étapes à suivre pour migrer varient selon que vos ressources se trouvent dans le même abonnement, dans des abonnements différents ou les deux.</span><span class="sxs-lookup"><span data-stu-id="57fc4-139">The steps you follow to migrate depend on whether your resources are in the same subscription, different subscriptions, or both.</span></span>

### <a name="migrate-virtual-networks-gateways-and-associated-deployments-in-the-same-subscription-as-the-expressroute-circuit"></a><span data-ttu-id="57fc4-140">Migrer les réseaux virtuels, les passerelles et les déploiements associés se trouvant dans le même abonnement que le circuit ExpressRoute</span><span class="sxs-lookup"><span data-stu-id="57fc4-140">Migrate virtual networks, gateways, and associated deployments in the same subscription as the ExpressRoute circuit</span></span>
<span data-ttu-id="57fc4-141">Cette section décrit les étapes à suivre pour migrer un réseau virtuel, une passerelle et les déploiements associés se trouvant dans le même abonnement que le circuit ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="57fc4-141">This section describes the steps to be followed to migrate a virtual network, gateway, and associated deployments in the same subscription as the ExpressRoute circuit.</span></span> <span data-ttu-id="57fc4-142">Cette migration n’implique aucun temps d’arrêt.</span><span class="sxs-lookup"><span data-stu-id="57fc4-142">No downtime is associated with this migration.</span></span> <span data-ttu-id="57fc4-143">Vous pouvez continuer à utiliser toutes les ressources pendant le processus de migration.</span><span class="sxs-lookup"><span data-stu-id="57fc4-143">You can continue to use all resources through the migration process.</span></span> <span data-ttu-id="57fc4-144">Le plan de gestion est verrouillé pendant la migration.</span><span class="sxs-lookup"><span data-stu-id="57fc4-144">The management plane is locked while the migration is in progress.</span></span> 

1. <span data-ttu-id="57fc4-145">Assurez-vous que le circuit ExpressRoute a été déplacé de l’environnement classique à l’environnement Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="57fc4-145">Ensure that the ExpressRoute circuit has been moved from the classic to the Resource Manager environment.</span></span>
2. <span data-ttu-id="57fc4-146">Assurez-vous que le réseau virtuel a été préparé correctement pour la migration.</span><span class="sxs-lookup"><span data-stu-id="57fc4-146">Ensure that the virtual network has been prepared appropriately for the migration.</span></span>
3. <span data-ttu-id="57fc4-147">Inscrivez votre abonnement pour la migration de ressources.</span><span class="sxs-lookup"><span data-stu-id="57fc4-147">Register your subscription for resource migration.</span></span> <span data-ttu-id="57fc4-148">Pour inscrire votre abonnement pour la migration de ressources, utilisez l’extrait de code PowerShell suivant :</span><span class="sxs-lookup"><span data-stu-id="57fc4-148">To register your subscription for resource migration, use the following PowerShell snippet:</span></span>

  ```powershell 
  Select-AzureRmSubscription -SubscriptionName <Your Subscription Name>
  Register-AzureRmResourceProvider -ProviderNamespace Microsoft.ClassicInfrastructureMigrate
  Get-AzureRmResourceProvider -ProviderNamespace Microsoft.ClassicInfrastructureMigrate
  ```
4. <span data-ttu-id="57fc4-149">Effectuez la validation, la préparation et la migration.</span><span class="sxs-lookup"><span data-stu-id="57fc4-149">Validate, prepare, and migrate.</span></span> <span data-ttu-id="57fc4-150">Pour déplacer le réseau virtuel, utilisez l’extrait de code PowerShell suivant :</span><span class="sxs-lookup"><span data-stu-id="57fc4-150">To move the virtual network, use the following PowerShell snippet:</span></span>

  ```powershell
  Move-AzureVirtualNetwork -Prepare $vnetName  
  Move-AzureVirtualNetwork -Commit $vnetName
  ```

  <span data-ttu-id="57fc4-151">Vous pouvez également abandonner la migration en exécutant l’applet de commande PowerShell suivante :</span><span class="sxs-lookup"><span data-stu-id="57fc4-151">You can also abort migration by running the following PowerShell cmdlet:</span></span>

  ```powershell
  Move-AzureVirtualNetwork -Abort $vnetName
  ```

## <a name="next-steps"></a><span data-ttu-id="57fc4-152">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="57fc4-152">Next steps</span></span>
* [<span data-ttu-id="57fc4-153">Migration prise en charge par la plateforme de ressources IaaS Classic vers Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="57fc4-153">Platform-supported migration of IaaS resources from classic to Azure Resource Manager</span></span>](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager.md)
* [<span data-ttu-id="57fc4-154">Étude technique approfondie de la migration prise en charge par la plateforme de ressources Classic vers Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="57fc4-154">Technical deep dive on platform-supported migration from classic to Azure Resource Manager</span></span>](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager-deep-dive.md)
* [<span data-ttu-id="57fc4-155">FAQ : Migration prise en charge par la plateforme de ressources IaaS Classic vers Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="57fc4-155">FAQs: Platform-supported migration of IaaS resources from classic to Azure Resource Manager</span></span>](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager.md)
* [<span data-ttu-id="57fc4-156">Passer en revue les erreurs les plus courantes de la migration et leur prévention</span><span class="sxs-lookup"><span data-stu-id="57fc4-156">Review most common migration errors and mitigations</span></span>](../virtual-machines/windows/migration-classic-resource-manager-errors.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)
