---
title: "Migrer un réseau virtuel Azure (classique) depuis un groupe d’affinités vers une région | Microsoft Docs"
description: "Découvrez comment migrer un réseau virtuel Azure (classique) depuis un groupe d’affinités vers une région."
services: virtual-network
documentationcenter: na
author: jimdial
manager: timlt
editor: 
tags: azure-service-management
ms.assetid: 84febcb9-bb8b-4e79-ab91-865ad9de41cb
ms.service: virtual-network
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 03/15/2016
ms.author: jdial
ms.openlocfilehash: b9b3bd0f2184ac85261166d5fe2ab67e1bf319d4
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/03/2017
---
# <a name="migrate-a-virtual-network-classic-from-an-affinity-group-to-a-region"></a><span data-ttu-id="c4954-103">Migrer un réseau virtuel Azure (classique) depuis un groupe d’affinités vers une région</span><span class="sxs-lookup"><span data-stu-id="c4954-103">Migrate a virtual network (classic) from an affinity group to a region</span></span>

> [!IMPORTANT]
> <span data-ttu-id="c4954-104">Azure dispose de deux modèles de déploiement différents pour créer et utiliser des ressources : [Resource Manager et classique](../resource-manager-deployment-model.md?toc=%2fazure%2fvirtual-network%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="c4954-104">Azure has two different deployment models for creating and working with resources: [Resource Manager and classic](../resource-manager-deployment-model.md?toc=%2fazure%2fvirtual-network%2ftoc.json).</span></span> <span data-ttu-id="c4954-105">Cet article traite du modèle de déploiement classique.</span><span class="sxs-lookup"><span data-stu-id="c4954-105">This article covers using the classic deployment model.</span></span> <span data-ttu-id="c4954-106">Pour la plupart des nouveaux déploiements, Microsoft recommande d’utiliser le modèle de déploiement Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="c4954-106">Microsoft recommends that most new deployments use the Resource Manager deployment model.</span></span>

<span data-ttu-id="c4954-107">Les groupes d’affinités vous permettent de vous assurer que les ressources créées dans le même groupe d’affinités sont physiquement hébergées par des serveurs proches les uns des autres, ce qui leur permet de communiquer plus rapidement.</span><span class="sxs-lookup"><span data-stu-id="c4954-107">Affinity groups ensure that resources created within the same affinity group are physically hosted by servers that are close together, enabling these resources to communicate quicker.</span></span> <span data-ttu-id="c4954-108">Auparavant, les groupes d’affinités étaient requis pour la création des réseaux virtuels (classiques).</span><span class="sxs-lookup"><span data-stu-id="c4954-108">In the past, affinity groups were a requirement for creating virtual networks (classic).</span></span> <span data-ttu-id="c4954-109">À cette époque, le service de gestionnaire réseau qui gérait les réseaux virtuels (classiques) ne fonctionnait qu’au sein d’un ensemble de serveurs physiques ou d’une unité d’échelle.</span><span class="sxs-lookup"><span data-stu-id="c4954-109">At that time, the network manager service that managed virtual networks (classic) could only work within a set of physical servers or scale unit.</span></span> <span data-ttu-id="c4954-110">Les améliorations architecturales ont augmenté la portée de la gestion réseau à une région.</span><span class="sxs-lookup"><span data-stu-id="c4954-110">Architectural improvements have increased the scope of network management to a region.</span></span>

<span data-ttu-id="c4954-111">Suite à ces améliorations architecturales, les groupes d’affinités ne sont plus recommandés ou requis pour les réseaux virtuels (classiques).</span><span class="sxs-lookup"><span data-stu-id="c4954-111">As a result of these architectural improvements, affinity groups are no longer recommended, or required for virtual networks (classic).</span></span> <span data-ttu-id="c4954-112">L’utilisation de groupes d’affinités pour les réseaux virtuels (classiques) est remplacée par les régions.</span><span class="sxs-lookup"><span data-stu-id="c4954-112">The use of affinity groups for virtual networks (classic) is replaced by regions.</span></span> <span data-ttu-id="c4954-113">Les réseaux virtuels (classiques) qui sont associés à des régions sont appelés réseaux virtuels régionaux.</span><span class="sxs-lookup"><span data-stu-id="c4954-113">Virtual networks (classic) that are associated with regions are called regional virtual networks.</span></span>

<span data-ttu-id="c4954-114">Nous vous recommandons de ne pas utiliser les groupes d’affinités en général.</span><span class="sxs-lookup"><span data-stu-id="c4954-114">We recommend that you don't use affinity groups in general.</span></span> <span data-ttu-id="c4954-115">Outre la spécification du réseau virtuel, les groupes d’affinités étaient également importants pour garantir que des ressources, telles que le calcul (classique) et le stockage (classique), étaient placées proches les unes des autres.</span><span class="sxs-lookup"><span data-stu-id="c4954-115">Aside from the virtual network requirement, affinity groups were also important to use to ensure resources, such as compute (classic) and storage (classic), were placed near each other.</span></span> <span data-ttu-id="c4954-116">Toutefois, avec l’architecture actuelle du réseau Azure, ces exigences de placement ne sont plus nécessaires.</span><span class="sxs-lookup"><span data-stu-id="c4954-116">However, with the current Azure network architecture, these placement requirements are no longer necessary.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="c4954-117">Bien qu’il soit techniquement possible de créer un réseau virtuel associé à un groupe d’affinités, il n’existe aucune raison valable de le faire.</span><span class="sxs-lookup"><span data-stu-id="c4954-117">Although it is still technically possible to create a virtual network that is associated with an affinity group, there is no compelling reason to do so.</span></span> <span data-ttu-id="c4954-118">De nombreuses fonctionnalités de réseau virtuel, telles que les groupes de sécurité réseau, sont disponibles uniquement quand vous utilisez un réseau virtuel régional et ne sont pas disponibles pour les réseaux virtuels associés à des groupes d’affinités.</span><span class="sxs-lookup"><span data-stu-id="c4954-118">Many virtual network features, such as network security groups, are only available when using a regional virtual network, and are not available for virtual networks that are associated with affinity groups.</span></span>
> 
> 

## <a name="edit-the-network-configuration-file"></a><span data-ttu-id="c4954-119">Modifier le fichier de configuration réseau</span><span class="sxs-lookup"><span data-stu-id="c4954-119">Edit the network configuration file</span></span>

1. <span data-ttu-id="c4954-120">Exportez le fichier de configuration réseau.</span><span class="sxs-lookup"><span data-stu-id="c4954-120">Export the network configuration file.</span></span> <span data-ttu-id="c4954-121">Pour savoir comment exporter un fichier de configuration réseau à l’aide de PowerShell ou de l’interface de ligne de commande (CLI 1.0) Azure, consultez la page [Configurer un réseau virtuel (Classic) à l’aide d’un fichier config réseau](virtual-networks-using-network-configuration-file.md#export).</span><span class="sxs-lookup"><span data-stu-id="c4954-121">To learn how to export a network configuration file using PowerShell or the Azure command-line interface (CLI) 1.0, see [Configure a virtual network using a network configuration file](virtual-networks-using-network-configuration-file.md#export).</span></span>
2. <span data-ttu-id="c4954-122">Modifiez le fichier de configuration réseau, en remplaçant le paramètre **AffinityGroup** par **Location**.</span><span class="sxs-lookup"><span data-stu-id="c4954-122">Edit the network configuration file, replacing **AffinityGroup** with **Location**.</span></span> <span data-ttu-id="c4954-123">Spécifiez une [région](https://azure.microsoft.com/regions) Azure pour le paramètre **Location**.</span><span class="sxs-lookup"><span data-stu-id="c4954-123">You specify an Azure [region](https://azure.microsoft.com/regions) for **Location**.</span></span>
   
   > [!NOTE]
   > <span data-ttu-id="c4954-124">Le paramètre **Location** correspond à la région que vous avez spécifiée pour le groupe d’affinités associé à votre réseau virtuel (classique).</span><span class="sxs-lookup"><span data-stu-id="c4954-124">The **Location** is the region that you specified for the affinity group that is associated with your virtual network (classic).</span></span> <span data-ttu-id="c4954-125">Par exemple, si votre réseau virtuel (classique) est associé à un groupe d’affinités qui se trouve dans l’Ouest des États-Unis, votre paramètre **Location** doit pointer sur Ouest des États-Unis pendant la migration.</span><span class="sxs-lookup"><span data-stu-id="c4954-125">For example, if your virtual network (classic) is associated with an affinity group that is located in West US, when you migrate, your **Location** must point to West US.</span></span> 
   > 
   > 
   
    <span data-ttu-id="c4954-126">Modifiez les lignes suivantes dans votre fichier de configuration réseau, en remplaçant les valeurs avec les vôtres :</span><span class="sxs-lookup"><span data-stu-id="c4954-126">Edit the following lines in your network configuration file, replacing the values with your own:</span></span> 
   
    <span data-ttu-id="c4954-127">**Ancienne valeur :** \<VirtualNetworkSitename="VNetUSWest" AffinityGroup="VNetDemoAG"\></span><span class="sxs-lookup"><span data-stu-id="c4954-127">**Old value:** \<VirtualNetworkSitename="VNetUSWest" AffinityGroup="VNetDemoAG"\></span></span> 
   
    <span data-ttu-id="c4954-128">**Nouvelle valeur :** \<VirtualNetworkSitename="VNetUSWest" Location="West US"\></span><span class="sxs-lookup"><span data-stu-id="c4954-128">**New value:** \<VirtualNetworkSitename="VNetUSWest" Location="West US"\></span></span>
3. <span data-ttu-id="c4954-129">Enregistrez vos modifications et [importez](virtual-networks-using-network-configuration-file.md#import) la configuration réseau dans Azure.</span><span class="sxs-lookup"><span data-stu-id="c4954-129">Save your changes and [import](virtual-networks-using-network-configuration-file.md#import) the network configuration to Azure.</span></span>

> [!NOTE]
> <span data-ttu-id="c4954-130">Cette migration n'entraîne PAS de temps d’arrêt de vos services.</span><span class="sxs-lookup"><span data-stu-id="c4954-130">This migration does NOT cause any downtime to your services.</span></span>
> 
> 

## <a name="what-to-do-if-you-have-a-vm-classic-in-an-affinity-group"></a><span data-ttu-id="c4954-131">Marche à suivre en cas de machine virtuelle (classique) dans un groupe d’affinités</span><span class="sxs-lookup"><span data-stu-id="c4954-131">What to do if you have a VM (classic) in an affinity group</span></span>
<span data-ttu-id="c4954-132">Les machines virtuelles (classiques) qui sont actuellement dans un groupe d’affinités n’ont pas besoin d’être supprimées du groupe d’affinités.</span><span class="sxs-lookup"><span data-stu-id="c4954-132">VMs (classic) that are currently in an affinity group do not need to be removed from the affinity group.</span></span> <span data-ttu-id="c4954-133">Une fois qu’une machine virtuelle est déployée, elle l’est sur une seule unité d’échelle.</span><span class="sxs-lookup"><span data-stu-id="c4954-133">Once a VM is deployed, it is deployed to a single scale unit.</span></span> <span data-ttu-id="c4954-134">Les groupes d’affinités peuvent restreindre la taille disponible de l’ensemble des machines virtuelles pour un nouveau déploiement de machines virtuelles, mais les machines virtuelles existantes déployées sont déjà limitées à la taille disponible de l’ensemble des machines virtuelles dans l’unité d’échelle où elles sont déployées.</span><span class="sxs-lookup"><span data-stu-id="c4954-134">Affinity groups can restrict the set of available VM sizes for a new VM deployment, but any existing VM that is deployed is already restricted to the set of VM sizes available in the scale unit in which the VM is deployed.</span></span> <span data-ttu-id="c4954-135">Étant donné que la machine virtuelle est déjà déployée dans une unité d’échelle, la suppression d’une machine virtuelle d’un groupe d’affinités n’a aucun effet sur cette dernière.</span><span class="sxs-lookup"><span data-stu-id="c4954-135">Because the VM is already deployed to a scale unit, removing a VM from an affinity group has no effect on the VM.</span></span>
