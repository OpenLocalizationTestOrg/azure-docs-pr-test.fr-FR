---
title: "Groupes de sécurité réseau dans Azure | Microsoft Docs"
description: "Découvrez comment isoler et contrôler le flux de trafic au sein des réseaux virtuels utilisant le pare-feu distribué dans Azure à l’aide des groupes de sécurité réseau."
services: virtual-network
documentationcenter: na
author: jimdial
manager: timlt
editor: tysonn
ms.assetid: 20e850fc-6456-4b5f-9a3f-a8379b052bc9
ms.service: virtual-network
ms.devlang: na
ms.topic: get-started-article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 02/11/2016
ms.author: jdial
ms.openlocfilehash: fac6ee69b5f0377e0515ac9abeb28788cbef9b79
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/18/2017
---
# <a name="filter-network-traffic-with-network-security-groups"></a><span data-ttu-id="c873b-103">Filtrer le trafic réseau avec les groupes de sécurité réseau</span><span class="sxs-lookup"><span data-stu-id="c873b-103">Filter network traffic with network security groups</span></span>

<span data-ttu-id="c873b-104">Un groupe de sécurité réseau (NSG) contient une liste de règles de sécurité qui autorisent ou rejettent le trafic réseau vers les ressources connectées aux réseaux virtuels Azure (VNet).</span><span class="sxs-lookup"><span data-stu-id="c873b-104">A network security group (NSG) contains a list of security rules that allow or deny network traffic to resources connected to Azure Virtual Networks (VNet).</span></span> <span data-ttu-id="c873b-105">Les NSG peuvent être associés à des sous-réseaux, à des machines virtuelles spécifiques (Classic) ou à des interfaces réseau (NIC) individuelles attachées à des machines virtuelles (Resource Manager).</span><span class="sxs-lookup"><span data-stu-id="c873b-105">NSGs can be associated to subnets, individual VMs (classic), or individual network interfaces (NIC) attached to VMs (Resource Manager).</span></span> <span data-ttu-id="c873b-106">Lorsqu’un NSG est associé à un sous-réseau, les règles s’appliquent à toutes les ressources connectées au sous-réseau.</span><span class="sxs-lookup"><span data-stu-id="c873b-106">When an NSG is associated to a subnet, the rules apply to all resources connected to the subnet.</span></span> <span data-ttu-id="c873b-107">Vous pouvez restreindre davantage le trafic en associant également un NSG à une machine virtuelle ou à une NIC.</span><span class="sxs-lookup"><span data-stu-id="c873b-107">Traffic can further be restricted by also associating an NSG to a VM or NIC.</span></span>

> [!NOTE]
> <span data-ttu-id="c873b-108">Azure dispose de deux modèles de déploiement différents pour créer et utiliser des ressources : [Resource Manager et classique](../resource-manager-deployment-model.md).</span><span class="sxs-lookup"><span data-stu-id="c873b-108">Azure has two different deployment models for creating and working with resources:  [Resource Manager and classic](../resource-manager-deployment-model.md).</span></span> <span data-ttu-id="c873b-109">Cet article traite des deux modèles, mais Microsoft recommande d’utiliser le modèle Resource Manager dans la plupart des nouveaux déploiements.</span><span class="sxs-lookup"><span data-stu-id="c873b-109">This article covers using both models, but Microsoft recommends that most new deployments use the Resource Manager model.</span></span>

## <a name="nsg-resource"></a><span data-ttu-id="c873b-110">Ressource du groupe de sécurité réseau</span><span class="sxs-lookup"><span data-stu-id="c873b-110">NSG resource</span></span>
<span data-ttu-id="c873b-111">Les NSG contiennent les propriétés suivantes :</span><span class="sxs-lookup"><span data-stu-id="c873b-111">NSGs contain the following properties:</span></span>

| <span data-ttu-id="c873b-112">Propriété</span><span class="sxs-lookup"><span data-stu-id="c873b-112">Property</span></span> | <span data-ttu-id="c873b-113">Description</span><span class="sxs-lookup"><span data-stu-id="c873b-113">Description</span></span> | <span data-ttu-id="c873b-114">Contraintes</span><span class="sxs-lookup"><span data-stu-id="c873b-114">Constraints</span></span> | <span data-ttu-id="c873b-115">Considérations</span><span class="sxs-lookup"><span data-stu-id="c873b-115">Considerations</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="c873b-116">Name</span><span class="sxs-lookup"><span data-stu-id="c873b-116">Name</span></span> |<span data-ttu-id="c873b-117">Nom du groupe de sécurité réseau</span><span class="sxs-lookup"><span data-stu-id="c873b-117">Name for the NSG</span></span> |<span data-ttu-id="c873b-118">Doit être unique dans la région.</span><span class="sxs-lookup"><span data-stu-id="c873b-118">Must be unique within the region.</span></span><br/><span data-ttu-id="c873b-119">Peut contenir des lettres, des chiffres, des traits de soulignement, des points et des traits d’union.</span><span class="sxs-lookup"><span data-stu-id="c873b-119">Can contain letters, numbers, underscores, periods, and hyphens.</span></span><br/><span data-ttu-id="c873b-120">Doit commencer par une lettre ou un chiffre.</span><span class="sxs-lookup"><span data-stu-id="c873b-120">Must start with a letter or number.</span></span><br/><span data-ttu-id="c873b-121">Doit se terminer par une lettre, un chiffre ou un trait de soulignement.</span><span class="sxs-lookup"><span data-stu-id="c873b-121">Must end with a letter, number, or underscore.</span></span><br/><span data-ttu-id="c873b-122">Ne doit pas dépasser 80 caractères.</span><span class="sxs-lookup"><span data-stu-id="c873b-122">Cannot exceed 80 characters.</span></span> |<span data-ttu-id="c873b-123">Étant donné que vous devrez peut-être créer plusieurs NSG, assurez-vous que vous disposez d’une convention d’affectation de noms qui facilite l’identification de la fonction de vos NSG.</span><span class="sxs-lookup"><span data-stu-id="c873b-123">Since you may need to create several NSGs, make sure you have a naming convention that makes it easy to identify the function of your NSGs.</span></span> |
| <span data-ttu-id="c873b-124">Région</span><span class="sxs-lookup"><span data-stu-id="c873b-124">Region</span></span> |<span data-ttu-id="c873b-125">[Région](https://azure.microsoft.com/regions) Azure dans laquelle le NSG est créé.</span><span class="sxs-lookup"><span data-stu-id="c873b-125">Azure [region](https://azure.microsoft.com/regions) where the NSG is created.</span></span> |<span data-ttu-id="c873b-126">Les NSG ne peuvent être associés qu’à des ressources figurant dans la même région qu’eux.</span><span class="sxs-lookup"><span data-stu-id="c873b-126">NSGs can only be associated to resources within the same region as the NSG.</span></span> |<span data-ttu-id="c873b-127">Pour plus d’informations sur le nombre de NSG dont vous pouvez disposer par région, consultez l’article relatif aux [limites Azure](../azure-subscription-service-limits.md#virtual-networking-limits-classic).</span><span class="sxs-lookup"><span data-stu-id="c873b-127">To learn about how many NSGs you can have per region, read the [Azure limits](../azure-subscription-service-limits.md#virtual-networking-limits-classic) article.</span></span>|
| <span data-ttu-id="c873b-128">Groupe de ressources</span><span class="sxs-lookup"><span data-stu-id="c873b-128">Resource group</span></span> |<span data-ttu-id="c873b-129">[Groupe de ressources](../azure-resource-manager/resource-group-overview.md#resource-groups) dans lequel le NSG existe.</span><span class="sxs-lookup"><span data-stu-id="c873b-129">The [resource group](../azure-resource-manager/resource-group-overview.md#resource-groups) the NSG exists in.</span></span> |<span data-ttu-id="c873b-130">Même si un NSG existe dans un groupe de ressources, il peut être associé aux ressources de n’importe quel groupe de ressources, tant que ces ressources font partie de la même région Azure que le NSG.</span><span class="sxs-lookup"><span data-stu-id="c873b-130">Although an NSG exists in a resource group, it can be associated to resources in any resource group, as long as the resource is part of the same Azure region as the NSG.</span></span> |<span data-ttu-id="c873b-131">Les groupes de ressources permettent de gérer plusieurs ressources conjointement, telles qu’une unité de déploiement.</span><span class="sxs-lookup"><span data-stu-id="c873b-131">Resource groups are used to manage multiple resources together, as a deployment unit.</span></span><br/><span data-ttu-id="c873b-132">Vous pouvez envisager de regrouper le NSG avec les ressources auxquelles il est associé.</span><span class="sxs-lookup"><span data-stu-id="c873b-132">You may consider grouping the NSG with resources it is associated to.</span></span> |
| <span data-ttu-id="c873b-133">Règles</span><span class="sxs-lookup"><span data-stu-id="c873b-133">Rules</span></span> |<span data-ttu-id="c873b-134">Règles de trafic entrant ou sortant définissant le trafic qui est autorisé ou refusé.</span><span class="sxs-lookup"><span data-stu-id="c873b-134">Inbound or outbound rules that define what traffic is allowed or denied.</span></span> | |<span data-ttu-id="c873b-135">Consultez la section [Règles de groupe de sécurité réseau](#Nsg-rules) de cet article.</span><span class="sxs-lookup"><span data-stu-id="c873b-135">See the [NSG rules](#Nsg-rules) section of this article.</span></span> |

> [!NOTE]
> <span data-ttu-id="c873b-136">Les contrôles d’accès réseau basés sur le point de terminaison et les groupes de sécurité réseau ne sont pas pris en charge sur la même instance de machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="c873b-136">Endpoint-based ACLs and network security groups are not supported on the same VM instance.</span></span> <span data-ttu-id="c873b-137">Si vous souhaitez utiliser un groupe de sécurité réseau et une ACL de point de terminaison déjà en place, supprimez d’abord l’ACL de point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="c873b-137">If you want to use an NSG and have an endpoint ACL already in place, first remove the endpoint ACL.</span></span> <span data-ttu-id="c873b-138">Pour plus d’informations sur la suppression d’une ACL, consultez l’article [Gérer les listes de contrôle d’accès de point de terminaison en utilisant PowerShell](virtual-networks-acl-powershell.md).</span><span class="sxs-lookup"><span data-stu-id="c873b-138">To learn how to remove an ACL, read the [Managing Access Control Lists (ACLs) for Endpoints by using PowerShell](virtual-networks-acl-powershell.md) article.</span></span>
> 

### <a name="nsg-rules"></a><span data-ttu-id="c873b-139">règles de groupe de sécurité réseau</span><span class="sxs-lookup"><span data-stu-id="c873b-139">NSG rules</span></span>
<span data-ttu-id="c873b-140">Les règles de groupe de sécurité réseau contiennent les propriétés suivantes :</span><span class="sxs-lookup"><span data-stu-id="c873b-140">NSG rules contain the following properties:</span></span>

| <span data-ttu-id="c873b-141">Propriété</span><span class="sxs-lookup"><span data-stu-id="c873b-141">Property</span></span> | <span data-ttu-id="c873b-142">Description</span><span class="sxs-lookup"><span data-stu-id="c873b-142">Description</span></span> | <span data-ttu-id="c873b-143">Contraintes</span><span class="sxs-lookup"><span data-stu-id="c873b-143">Constraints</span></span> | <span data-ttu-id="c873b-144">Considérations</span><span class="sxs-lookup"><span data-stu-id="c873b-144">Considerations</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="c873b-145">**Name**</span><span class="sxs-lookup"><span data-stu-id="c873b-145">**Name**</span></span> |<span data-ttu-id="c873b-146">Nom de la règle.</span><span class="sxs-lookup"><span data-stu-id="c873b-146">Name for the rule.</span></span> |<span data-ttu-id="c873b-147">Doit être unique dans la région.</span><span class="sxs-lookup"><span data-stu-id="c873b-147">Must be unique within the region.</span></span><br/><span data-ttu-id="c873b-148">Peut contenir des lettres, des chiffres, des traits de soulignement, des points et des traits d’union.</span><span class="sxs-lookup"><span data-stu-id="c873b-148">Can contain letters, numbers, underscores, periods, and hyphens.</span></span><br/><span data-ttu-id="c873b-149">Doit commencer par une lettre ou un chiffre.</span><span class="sxs-lookup"><span data-stu-id="c873b-149">Must start with a letter or number.</span></span><br/><span data-ttu-id="c873b-150">Doit se terminer par une lettre, un chiffre ou un trait de soulignement.</span><span class="sxs-lookup"><span data-stu-id="c873b-150">Must end with a letter, number, or underscore.</span></span><br/><span data-ttu-id="c873b-151">Ne doit pas dépasser 80 caractères.</span><span class="sxs-lookup"><span data-stu-id="c873b-151">Cannot exceed 80 characters.</span></span> |<span data-ttu-id="c873b-152">Un NSG pouvant contenir plusieurs règles, veillez à respecter une convention d’affectation de noms qui vous permet d’identifier la fonction de votre règle</span><span class="sxs-lookup"><span data-stu-id="c873b-152">You may have several rules within an NSG, so make sure you follow a naming convention that allows you to identify the function of your rule.</span></span> |
| <span data-ttu-id="c873b-153">**Protocole**</span><span class="sxs-lookup"><span data-stu-id="c873b-153">**Protocol**</span></span> |<span data-ttu-id="c873b-154">Protocole à faire correspondre à la règle.</span><span class="sxs-lookup"><span data-stu-id="c873b-154">Protocol to match for the rule.</span></span> |<span data-ttu-id="c873b-155">TCP, UDP ou *</span><span class="sxs-lookup"><span data-stu-id="c873b-155">TCP, UDP, or *</span></span> |<span data-ttu-id="c873b-156">L’utilisation de la valeur * en guise de protocole inclut ICMP (trafic est-ouest uniquement), ainsi qu’UDP et TCP, et peut réduire le nombre de règles dont vous avez besoin.</span><span class="sxs-lookup"><span data-stu-id="c873b-156">Using * as a protocol includes ICMP (East-West traffic only), as well as UDP and TCP, and may reduce the number of rules you need.</span></span><br/><span data-ttu-id="c873b-157">Dans le même temps, l’utilisation de la valeur * peut constituer une approche trop large. Il est donc recommandé de ne l’utiliser qu’en cas de réelle nécessité.</span><span class="sxs-lookup"><span data-stu-id="c873b-157">At the same time, using * might be too broad an approach, so it's recommended that you use * only when necessary.</span></span> |
| <span data-ttu-id="c873b-158">**Plage de ports source**</span><span class="sxs-lookup"><span data-stu-id="c873b-158">**Source port range**</span></span> |<span data-ttu-id="c873b-159">Plage de ports sources à faire correspondre à la règle.</span><span class="sxs-lookup"><span data-stu-id="c873b-159">Source port range to match for the rule.</span></span> |<span data-ttu-id="c873b-160">Numéro de port unique compris entre 1 et 65535, plage de ports (par exemple, 1-65535) ou * (pour tous les ports).</span><span class="sxs-lookup"><span data-stu-id="c873b-160">Single port number from 1 to 65535, port range (example: 1-65535), or * (for all ports).</span></span> |<span data-ttu-id="c873b-161">Les ports source peuvent être éphémères.</span><span class="sxs-lookup"><span data-stu-id="c873b-161">Source ports could be ephemeral.</span></span> <span data-ttu-id="c873b-162">Privilégiez l’utilisation de * dans la plupart des cas, sauf si votre programme client utilise un port spécifique.</span><span class="sxs-lookup"><span data-stu-id="c873b-162">Unless your client program is using a specific port, use * in most cases.</span></span><br/><span data-ttu-id="c873b-163">Dans la mesure du possible, essayez d’utiliser des plages de ports pour éviter d’avoir à disposer de plusieurs règles.</span><span class="sxs-lookup"><span data-stu-id="c873b-163">Try to use port ranges as much as possible to avoid the need for multiple rules.</span></span><br/><span data-ttu-id="c873b-164">Il est impossible de regrouper plusieurs ports ou plages de ports à l’aide d’une virgule.</span><span class="sxs-lookup"><span data-stu-id="c873b-164">Multiple ports or port ranges cannot be grouped by a comma.</span></span> |
| <span data-ttu-id="c873b-165">**Plage de ports de destination**</span><span class="sxs-lookup"><span data-stu-id="c873b-165">**Destination port range**</span></span> |<span data-ttu-id="c873b-166">Plage de ports de destination à faire correspondre à la règle.</span><span class="sxs-lookup"><span data-stu-id="c873b-166">Destination port range to match for the rule.</span></span> |<span data-ttu-id="c873b-167">Numéro de port unique compris entre 1 et 65535, plage de ports (par exemple, 1-65535) ou \* (pour tous les ports).</span><span class="sxs-lookup"><span data-stu-id="c873b-167">Single port number from 1 to 65535, port range (example: 1-65535), or \* (for all ports).</span></span> |<span data-ttu-id="c873b-168">Dans la mesure du possible, essayez d’utiliser des plages de ports pour éviter d’avoir à disposer de plusieurs règles.</span><span class="sxs-lookup"><span data-stu-id="c873b-168">Try to use port ranges as much as possible to avoid the need for multiple rules.</span></span><br/><span data-ttu-id="c873b-169">Il est impossible de regrouper plusieurs ports ou plages de ports à l’aide d’une virgule.</span><span class="sxs-lookup"><span data-stu-id="c873b-169">Multiple ports or port ranges cannot be grouped by a comma.</span></span> |
| <span data-ttu-id="c873b-170">**Préfixe d’adresse source**</span><span class="sxs-lookup"><span data-stu-id="c873b-170">**Source address prefix**</span></span> |<span data-ttu-id="c873b-171">Préfixe d’adresse source ou balise à faire correspondre à la règle.</span><span class="sxs-lookup"><span data-stu-id="c873b-171">Source address prefix or tag to match for the rule.</span></span> |<span data-ttu-id="c873b-172">Adresse IP unique (par exemple, 10.10.10.10), sous-réseau IP (par exemple, 192.168.1.0/24), [balise par défaut](#default-tags) ou * (pour toutes les adresses).</span><span class="sxs-lookup"><span data-stu-id="c873b-172">Single IP address (example: 10.10.10.10), IP subnet (example: 192.168.1.0/24), [default tag](#default-tags), or * (for all addresses).</span></span> |<span data-ttu-id="c873b-173">Envisagez d’utiliser des plages, des balises par défaut et * pour réduire le nombre de règles.</span><span class="sxs-lookup"><span data-stu-id="c873b-173">Consider using ranges, default tags, and * to reduce the number of rules.</span></span> |
| <span data-ttu-id="c873b-174">**Préfixe d’adresse de destination**</span><span class="sxs-lookup"><span data-stu-id="c873b-174">**Destination address prefix**</span></span> |<span data-ttu-id="c873b-175">Préfixe d’adresse de destination ou balise à faire correspondre à la règle.</span><span class="sxs-lookup"><span data-stu-id="c873b-175">Destination address prefix or tag to match for the rule.</span></span> | <span data-ttu-id="c873b-176">Adresse IP unique (par exemple, 10.10.10.10), sous-réseau IP (par exemple, 192.168.1.0/24), [balise par défaut](#default-tags) ou * (pour toutes les adresses).</span><span class="sxs-lookup"><span data-stu-id="c873b-176">Single IP address (example: 10.10.10.10), IP subnet (example: 192.168.1.0/24), [default tag](#default-tags), or * (for all addresses).</span></span> |<span data-ttu-id="c873b-177">Envisagez d’utiliser des plages, des balises par défaut et * pour réduire le nombre de règles.</span><span class="sxs-lookup"><span data-stu-id="c873b-177">Consider using ranges, default tags, and * to reduce the number of rules.</span></span> |
| <span data-ttu-id="c873b-178">**Direction**</span><span class="sxs-lookup"><span data-stu-id="c873b-178">**Direction**</span></span> |<span data-ttu-id="c873b-179">Direction du trafic à faire correspondre à la règle.</span><span class="sxs-lookup"><span data-stu-id="c873b-179">Direction of traffic to match for the rule.</span></span> |<span data-ttu-id="c873b-180">Entrant ou sortant.</span><span class="sxs-lookup"><span data-stu-id="c873b-180">Inbound or outbound.</span></span> |<span data-ttu-id="c873b-181">Les règles de trafic entrant et de trafic sortant sont traitées séparément, en fonction de la direction.</span><span class="sxs-lookup"><span data-stu-id="c873b-181">Inbound and outbound rules are processed separately, based on direction.</span></span> |
| <span data-ttu-id="c873b-182">**Priorité**</span><span class="sxs-lookup"><span data-stu-id="c873b-182">**Priority**</span></span> |<span data-ttu-id="c873b-183">Les règles sont vérifiées dans l’ordre de priorité.</span><span class="sxs-lookup"><span data-stu-id="c873b-183">Rules are checked in the order of priority.</span></span> <span data-ttu-id="c873b-184">Une fois qu’une règle s’applique, plus aucune correspondance de règle n’est testée.</span><span class="sxs-lookup"><span data-stu-id="c873b-184">Once a rule applies, no more rules are tested for matching.</span></span> | <span data-ttu-id="c873b-185">Nombre compris entre 100 et 4096.</span><span class="sxs-lookup"><span data-stu-id="c873b-185">Number between 100 and 4096.</span></span> | <span data-ttu-id="c873b-186">Envisagez de créer des règles de passage des priorités par 100 pour chaque règle afin de laisser de la place pour les règles que vous pourriez créer à l’avenir.</span><span class="sxs-lookup"><span data-stu-id="c873b-186">Consider creating rules jumping priorities by 100 for each rule to leave space for new rules you might create in the future.</span></span> |
| <span data-ttu-id="c873b-187">**Access**</span><span class="sxs-lookup"><span data-stu-id="c873b-187">**Access**</span></span> |<span data-ttu-id="c873b-188">Type d’accès à appliquer si la règle correspond.</span><span class="sxs-lookup"><span data-stu-id="c873b-188">Type of access to apply if the rule matches.</span></span> | <span data-ttu-id="c873b-189">Autoriser ou refuser.</span><span class="sxs-lookup"><span data-stu-id="c873b-189">Allow or deny.</span></span> | <span data-ttu-id="c873b-190">N’oubliez pas que si la règle d’autorisation d’un paquet est introuvable, le paquet est abandonné.</span><span class="sxs-lookup"><span data-stu-id="c873b-190">Keep in mind that if an allow rule is not found for a packet, the packet is dropped.</span></span> |

<span data-ttu-id="c873b-191">Les NSG contiennent deux ensembles de règles : les règles de trafic entrant et les règles de trafic sortant.</span><span class="sxs-lookup"><span data-stu-id="c873b-191">NSGs contain two sets of rules: Inbound and outbound.</span></span> <span data-ttu-id="c873b-192">La priorité d’une règle doit être unique dans chaque ensemble.</span><span class="sxs-lookup"><span data-stu-id="c873b-192">The priority for a rule must be unique within each set.</span></span> 

![Traitement des règles de groupe de sécurité réseau](./media/virtual-network-nsg-overview/figure3.png) 

<span data-ttu-id="c873b-194">La figure ci-dessus illustre le mode de traitement des règles de NSG.</span><span class="sxs-lookup"><span data-stu-id="c873b-194">The previous picture shows how NSG rules are processed.</span></span>

### <a name="default-tags"></a><span data-ttu-id="c873b-195">Balises par défaut</span><span class="sxs-lookup"><span data-stu-id="c873b-195">Default Tags</span></span>
<span data-ttu-id="c873b-196">Les balises par défaut sont des identificateurs fournis par le système pour adresser une catégorie d’adresses IP.</span><span class="sxs-lookup"><span data-stu-id="c873b-196">Default tags are system-provided identifiers to address a category of IP addresses.</span></span> <span data-ttu-id="c873b-197">Vous pouvez utiliser les balises par défaut dans les propriétés du **préfixe d’adresse source** et du **préfixe d’adresse de destination** de toute règle.</span><span class="sxs-lookup"><span data-stu-id="c873b-197">You can use default tags in the **source address prefix** and **destination address prefix** properties of any rule.</span></span> <span data-ttu-id="c873b-198">Les balises par défaut que vous pouvez utiliser sont au nombre de trois :</span><span class="sxs-lookup"><span data-stu-id="c873b-198">There are three default tags you can use:</span></span>

* <span data-ttu-id="c873b-199">**VirtualNetwork** (Resource Manager) (**VIRTUAL_NETWORK** pour Classic) : cette balise inclut l’espace d’adressage du réseau virtuel (plages CIDR définies dans Azure), ainsi que tous les espaces d’adressage locaux connectés et les réseaux virtuels Azure connectés (réseaux locaux).</span><span class="sxs-lookup"><span data-stu-id="c873b-199">**VirtualNetwork** (Resource Manager) (**VIRTUAL_NETWORK** for classic): This tag includes the virtual network address space (CIDR ranges defined in Azure), all connected on-premises address spaces, and connected Azure VNets (local networks).</span></span>
* <span data-ttu-id="c873b-200">**AzureLoadBalancer** (Resource Manager) (**AZURE_LOADBALANCER** pour Classic) : cette balise désigne l’équilibreur de charge de l’infrastructure Azure.</span><span class="sxs-lookup"><span data-stu-id="c873b-200">**AzureLoadBalancer** (Resource Manager) (**AZURE_LOADBALANCER** for classic): This tag denotes Azure’s infrastructure load balancer.</span></span> <span data-ttu-id="c873b-201">Elle convertit en une adresse IP de centre de données Azure l’emplacement d’où proviennent les sondes d’intégrité d’Azure.</span><span class="sxs-lookup"><span data-stu-id="c873b-201">The tag translates to an Azure datacenter IP where Azure’s health probes originate.</span></span>
* <span data-ttu-id="c873b-202">**Internet** (Resource Manager) (**INTERNET** pour Classic) : cette balise indique l’espace d’adressage IP qui se trouve en dehors du réseau virtuel et est accessible par l’Internet public.</span><span class="sxs-lookup"><span data-stu-id="c873b-202">**Internet** (Resource Manager) (**INTERNET** for classic): This tag denotes the IP address space that is outside the virtual network and reachable by public Internet.</span></span> <span data-ttu-id="c873b-203">La plage inclut [l’espace IP public d’Azure](https://www.microsoft.com/download/details.aspx?id=41653).</span><span class="sxs-lookup"><span data-stu-id="c873b-203">The range includes the [Azure owned public IP space](https://www.microsoft.com/download/details.aspx?id=41653).</span></span>

### <a name="default-rules"></a><span data-ttu-id="c873b-204">Règles par défaut</span><span class="sxs-lookup"><span data-stu-id="c873b-204">Default rules</span></span>
<span data-ttu-id="c873b-205">Tous les groupes de ressources réseau contiennent un ensemble de règles par défaut.</span><span class="sxs-lookup"><span data-stu-id="c873b-205">All NSGs contain a set of default rules.</span></span> <span data-ttu-id="c873b-206">Les règles par défaut ne peuvent pas être supprimées, mais comme la priorité la plus basse leur est attribuée, elles peuvent être remplacées par les règles que vous créez.</span><span class="sxs-lookup"><span data-stu-id="c873b-206">The default rules cannot be deleted, but because they are assigned the lowest priority, they can be overridden by the rules that you create.</span></span> 

<span data-ttu-id="c873b-207">Les règles par défaut autorisent et interdisent le trafic comme suit :</span><span class="sxs-lookup"><span data-stu-id="c873b-207">The default rules allow and disallow traffic as follows:</span></span>
- <span data-ttu-id="c873b-208">**Réseau virtuel :** le trafic en provenance et à destination d’un réseau virtuel est autorisé à la fois dans les directions entrante et sortante.</span><span class="sxs-lookup"><span data-stu-id="c873b-208">**Virtual network:** Traffic originating and ending in a virtual network is allowed both in inbound and outbound directions.</span></span>
- <span data-ttu-id="c873b-209">**Internet :** le trafic sortant est autorisé, mais le trafic entrant est bloqué.</span><span class="sxs-lookup"><span data-stu-id="c873b-209">**Internet:** Outbound traffic is allowed, but inbound traffic is blocked.</span></span>
- <span data-ttu-id="c873b-210">**Équilibreur de charge :** l’équilibreur de charge d’Azure est autorisé à tester l’intégrité de vos machines virtuelles et instances de rôle.</span><span class="sxs-lookup"><span data-stu-id="c873b-210">**Load balancer:** Allow Azure’s load balancer to probe the health of your VMs and role instances.</span></span> <span data-ttu-id="c873b-211">Vous pouvez remplacer cette règle si vous n’utilisez pas un jeu d’équilibrage de la charge.</span><span class="sxs-lookup"><span data-stu-id="c873b-211">If you are not using a load balanced set you can override this rule.</span></span>

<span data-ttu-id="c873b-212">**Les règles par défaut sont :**</span><span class="sxs-lookup"><span data-stu-id="c873b-212">**Inbound default rules**</span></span>

| <span data-ttu-id="c873b-213">Name</span><span class="sxs-lookup"><span data-stu-id="c873b-213">Name</span></span> | <span data-ttu-id="c873b-214">Priorité</span><span class="sxs-lookup"><span data-stu-id="c873b-214">Priority</span></span> | <span data-ttu-id="c873b-215">IP Source</span><span class="sxs-lookup"><span data-stu-id="c873b-215">Source IP</span></span> | <span data-ttu-id="c873b-216">Port source</span><span class="sxs-lookup"><span data-stu-id="c873b-216">Source Port</span></span> | <span data-ttu-id="c873b-217">IP de destination</span><span class="sxs-lookup"><span data-stu-id="c873b-217">Destination IP</span></span> | <span data-ttu-id="c873b-218">Port de destination</span><span class="sxs-lookup"><span data-stu-id="c873b-218">Destination Port</span></span> | <span data-ttu-id="c873b-219">Protocole</span><span class="sxs-lookup"><span data-stu-id="c873b-219">Protocol</span></span> | <span data-ttu-id="c873b-220">Access</span><span class="sxs-lookup"><span data-stu-id="c873b-220">Access</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="c873b-221">AllowVNetInBound</span><span class="sxs-lookup"><span data-stu-id="c873b-221">AllowVNetInBound</span></span> |<span data-ttu-id="c873b-222">65 000</span><span class="sxs-lookup"><span data-stu-id="c873b-222">65000</span></span> | <span data-ttu-id="c873b-223">VirtualNetwork</span><span class="sxs-lookup"><span data-stu-id="c873b-223">VirtualNetwork</span></span> | * | <span data-ttu-id="c873b-224">VirtualNetwork</span><span class="sxs-lookup"><span data-stu-id="c873b-224">VirtualNetwork</span></span> | * | * | <span data-ttu-id="c873b-225">AUTORISER</span><span class="sxs-lookup"><span data-stu-id="c873b-225">Allow</span></span> |
| <span data-ttu-id="c873b-226">AllowAzureLoadBalancerInBound</span><span class="sxs-lookup"><span data-stu-id="c873b-226">AllowAzureLoadBalancerInBound</span></span> | <span data-ttu-id="c873b-227">65 001</span><span class="sxs-lookup"><span data-stu-id="c873b-227">65001</span></span> | <span data-ttu-id="c873b-228">AzureLoadBalancer</span><span class="sxs-lookup"><span data-stu-id="c873b-228">AzureLoadBalancer</span></span> | * | * | * | * | <span data-ttu-id="c873b-229">AUTORISER</span><span class="sxs-lookup"><span data-stu-id="c873b-229">Allow</span></span> |
| <span data-ttu-id="c873b-230">DenyAllInBound</span><span class="sxs-lookup"><span data-stu-id="c873b-230">DenyAllInBound</span></span> |<span data-ttu-id="c873b-231">65 500</span><span class="sxs-lookup"><span data-stu-id="c873b-231">65500</span></span> | * | * | * | * | * | <span data-ttu-id="c873b-232">REFUSER</span><span class="sxs-lookup"><span data-stu-id="c873b-232">Deny</span></span> |

<span data-ttu-id="c873b-233">**Les règles sortantes par défaut sont :**</span><span class="sxs-lookup"><span data-stu-id="c873b-233">**Outbound default rules**</span></span>

| <span data-ttu-id="c873b-234">Name</span><span class="sxs-lookup"><span data-stu-id="c873b-234">Name</span></span> | <span data-ttu-id="c873b-235">Priorité</span><span class="sxs-lookup"><span data-stu-id="c873b-235">Priority</span></span> | <span data-ttu-id="c873b-236">IP Source</span><span class="sxs-lookup"><span data-stu-id="c873b-236">Source IP</span></span> | <span data-ttu-id="c873b-237">Port source</span><span class="sxs-lookup"><span data-stu-id="c873b-237">Source Port</span></span> | <span data-ttu-id="c873b-238">IP de destination</span><span class="sxs-lookup"><span data-stu-id="c873b-238">Destination IP</span></span> | <span data-ttu-id="c873b-239">Port de destination</span><span class="sxs-lookup"><span data-stu-id="c873b-239">Destination Port</span></span> | <span data-ttu-id="c873b-240">Protocole</span><span class="sxs-lookup"><span data-stu-id="c873b-240">Protocol</span></span> | <span data-ttu-id="c873b-241">Access</span><span class="sxs-lookup"><span data-stu-id="c873b-241">Access</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="c873b-242">AllowVnetOutBound</span><span class="sxs-lookup"><span data-stu-id="c873b-242">AllowVnetOutBound</span></span> | <span data-ttu-id="c873b-243">65 000</span><span class="sxs-lookup"><span data-stu-id="c873b-243">65000</span></span> | <span data-ttu-id="c873b-244">VirtualNetwork</span><span class="sxs-lookup"><span data-stu-id="c873b-244">VirtualNetwork</span></span> | * | <span data-ttu-id="c873b-245">VirtualNetwork</span><span class="sxs-lookup"><span data-stu-id="c873b-245">VirtualNetwork</span></span> | * | * | <span data-ttu-id="c873b-246">AUTORISER</span><span class="sxs-lookup"><span data-stu-id="c873b-246">Allow</span></span> |
| <span data-ttu-id="c873b-247">AllowInternetOutBound</span><span class="sxs-lookup"><span data-stu-id="c873b-247">AllowInternetOutBound</span></span> | <span data-ttu-id="c873b-248">65 001</span><span class="sxs-lookup"><span data-stu-id="c873b-248">65001</span></span> | * | * | <span data-ttu-id="c873b-249">Internet</span><span class="sxs-lookup"><span data-stu-id="c873b-249">Internet</span></span> | * | * | <span data-ttu-id="c873b-250">AUTORISER</span><span class="sxs-lookup"><span data-stu-id="c873b-250">Allow</span></span> |
| <span data-ttu-id="c873b-251">DenyAllOutBound</span><span class="sxs-lookup"><span data-stu-id="c873b-251">DenyAllOutBound</span></span> | <span data-ttu-id="c873b-252">65 500</span><span class="sxs-lookup"><span data-stu-id="c873b-252">65500</span></span> | * | * | * | * | * | <span data-ttu-id="c873b-253">REFUSER</span><span class="sxs-lookup"><span data-stu-id="c873b-253">Deny</span></span> |

## <a name="associating-nsgs"></a><span data-ttu-id="c873b-254">Association de groupe de sécurité réseau</span><span class="sxs-lookup"><span data-stu-id="c873b-254">Associating NSGs</span></span>
<span data-ttu-id="c873b-255">Vous pouvez associer un NSG à des machines virtuelles, à des NIC et à des sous-réseaux, selon le modèle de déploiement que vous utilisez, en procédant comme suit :</span><span class="sxs-lookup"><span data-stu-id="c873b-255">You can associate an NSG to VMs, NICs, and subnets, depending on the deployment model you are using, as follows:</span></span>

* <span data-ttu-id="c873b-256">**Machine virtuelle (Classic uniquement) :** les règles de sécurité sont appliquées à l’ensemble du trafic à destination/en provenance de la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="c873b-256">**VM (classic only):** Security rules are applied to all traffic to/from the VM.</span></span> 
* <span data-ttu-id="c873b-257">**NIC (Resource Manager uniquement) :** les règles de sécurité sont appliquées à l’ensemble du trafic à destination/en provenance de la NIC à laquelle le NSG est associé.</span><span class="sxs-lookup"><span data-stu-id="c873b-257">**NIC (Resource Manager only):** Security rules are applied to all traffic to/from the NIC the NSG is associated to.</span></span> <span data-ttu-id="c873b-258">Dans une machine virtuelle dotée de plusieurs NIC, vous pouvez appliquer des NSG différents (ou les mêmes NSG) à chaque NIC individuellement.</span><span class="sxs-lookup"><span data-stu-id="c873b-258">In a multi-NIC VM, you can apply different (or the same) NSG to each NIC individually.</span></span> 
* <span data-ttu-id="c873b-259">**Sous-réseau (Resource Manager et Classic) :** les règles de sécurité sont appliquées à l’ensemble du trafic à destination/en provenance des ressources connectées au réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="c873b-259">**Subnet (Resource Manager and classic):** Security rules are applied to any traffic to/from any resources connected to the VNet.</span></span>

<span data-ttu-id="c873b-260">Vous pouvez associer différents NSG à une machine virtuelle (ou à une NIC, selon le modèle de déploiement) et au sous-réseau auquel la NIC ou la machine virtuelle sont connectées.</span><span class="sxs-lookup"><span data-stu-id="c873b-260">You can associate different NSGs to a VM (or NIC, depending on the deployment model) and the subnet that a NIC or VM is connected to.</span></span> <span data-ttu-id="c873b-261">Les règles de sécurité sont appliquées au trafic par priorité dans chaque NSG, dans l’ordre suivant :</span><span class="sxs-lookup"><span data-stu-id="c873b-261">Security rules are applied to the traffic, by priority, in each NSG, in the following order:</span></span>

- <span data-ttu-id="c873b-262">**Trafic entrant**</span><span class="sxs-lookup"><span data-stu-id="c873b-262">**Inbound traffic**</span></span>

  1. <span data-ttu-id="c873b-263">**NSG appliqué à un sous-réseau :** si le NSG du sous-réseau dispose d’une règle de correspondance qui refuse le trafic, le paquet est abandonné.</span><span class="sxs-lookup"><span data-stu-id="c873b-263">**NSG applied to subnet:** If a subnet NSG has a matching rule to deny traffic, the packet is dropped.</span></span>

  2. <span data-ttu-id="c873b-264">**NSG appliqué à une NIC (Resource Manager) ou à une machine virtuelle (Classic) :** si le NSG de la machine virtuelle/NIC dispose d’une règle de correspondance qui refuse le trafic, les paquets sont abandonnés au niveau de la machine virtuelle\NIC, même si le NSG du sous-réseau comporte une règle de correspondance qui autorise le trafic.</span><span class="sxs-lookup"><span data-stu-id="c873b-264">**NSG applied to NIC** (Resource Manager) or VM (classic): If VM\NIC NSG has a matching rule that denies traffic, packets are dropped at the VM\NIC, even if a subnet NSG has a matching rule that allows traffic.</span></span>

- <span data-ttu-id="c873b-265">**Trafic sortant**</span><span class="sxs-lookup"><span data-stu-id="c873b-265">**Outbound traffic**</span></span>

  1. <span data-ttu-id="c873b-266">**NSG appliqué à une NIC (Resource Manager) ou à une machine virtuelle (Classic) :** si le NSG de la machine virtuelle/NIC dispose d’une règle de correspondance qui refuse le trafic, les paquets sont abandonnés.</span><span class="sxs-lookup"><span data-stu-id="c873b-266">**NSG applied to NIC** (Resource Manager) or VM (classic): If a VM\NIC NSG has a matching rule that denies traffic, packets are dropped.</span></span>

  2. <span data-ttu-id="c873b-267">**NSG appliqué à un sous-réseau :** si le NSG du sous-réseau dispose d’une règle de correspondance qui refuse le trafic, les paquets sont abandonnés, même si le NSG de la machine virtuelle/NIC comporte une règle de correspondance qui autorise le trafic.</span><span class="sxs-lookup"><span data-stu-id="c873b-267">**NSG applied to subnet:** If a subnet NSG has a matching rule that denies traffic, packets are dropped, even if a VM\NIC NSG has a matching rule that allows traffic.</span></span>

> [!NOTE]
> <span data-ttu-id="c873b-268">Bien que vous ne puissiez associer qu’un seul groupe de sécurité réseau à un sous-réseau, une machine virtuelle ou une carte d’interface réseau, vous pouvez associer le même groupe de sécurité réseau au nombre de ressources que vous souhaitez.</span><span class="sxs-lookup"><span data-stu-id="c873b-268">Although you can only associate a single NSG to a subnet, VM, or NIC; you can associate the same NSG to as many resources as you want.</span></span>
>

## <a name="implementation"></a><span data-ttu-id="c873b-269">Implémentation</span><span class="sxs-lookup"><span data-stu-id="c873b-269">Implementation</span></span>
<span data-ttu-id="c873b-270">Vous pouvez implémenter des NSG dans les modèles de déploiement Resource Manager ou Classic à l’aide des outils suivants :</span><span class="sxs-lookup"><span data-stu-id="c873b-270">You can implement NSGs in the Resource Manager or classic deployment models using the following tools:</span></span>

| <span data-ttu-id="c873b-271">Outil de déploiement</span><span class="sxs-lookup"><span data-stu-id="c873b-271">Deployment tool</span></span> | <span data-ttu-id="c873b-272">Classique</span><span class="sxs-lookup"><span data-stu-id="c873b-272">Classic</span></span> | <span data-ttu-id="c873b-273">Gestionnaire de ressources</span><span class="sxs-lookup"><span data-stu-id="c873b-273">Resource Manager</span></span> |
| --- | --- | --- |
| <span data-ttu-id="c873b-274">Portail Azure</span><span class="sxs-lookup"><span data-stu-id="c873b-274">Azure portal</span></span>   | <span data-ttu-id="c873b-275">Oui</span><span class="sxs-lookup"><span data-stu-id="c873b-275">Yes</span></span> | [<span data-ttu-id="c873b-276">Oui</span><span class="sxs-lookup"><span data-stu-id="c873b-276">Yes</span></span>](virtual-networks-create-nsg-arm-pportal.md) |
| <span data-ttu-id="c873b-277">PowerShell</span><span class="sxs-lookup"><span data-stu-id="c873b-277">PowerShell</span></span>     | [<span data-ttu-id="c873b-278">Oui</span><span class="sxs-lookup"><span data-stu-id="c873b-278">Yes</span></span>](virtual-networks-create-nsg-classic-ps.md) | [<span data-ttu-id="c873b-279">Oui</span><span class="sxs-lookup"><span data-stu-id="c873b-279">Yes</span></span>](virtual-networks-create-nsg-arm-ps.md) |
| <span data-ttu-id="c873b-280">Azure CLI **V1**</span><span class="sxs-lookup"><span data-stu-id="c873b-280">Azure CLI **V1**</span></span>   | [<span data-ttu-id="c873b-281">Oui</span><span class="sxs-lookup"><span data-stu-id="c873b-281">Yes</span></span>](virtual-networks-create-nsg-classic-cli.md) | [<span data-ttu-id="c873b-282">Oui</span><span class="sxs-lookup"><span data-stu-id="c873b-282">Yes</span></span>](virtual-networks-create-nsg-cli-nodejs.md) |
| <span data-ttu-id="c873b-283">Azure CLI **V2**</span><span class="sxs-lookup"><span data-stu-id="c873b-283">Azure CLI **V2**</span></span>   | <span data-ttu-id="c873b-284">Non</span><span class="sxs-lookup"><span data-stu-id="c873b-284">No</span></span> | [<span data-ttu-id="c873b-285">Oui</span><span class="sxs-lookup"><span data-stu-id="c873b-285">Yes</span></span>](virtual-networks-create-nsg-arm-cli.md) |
| <span data-ttu-id="c873b-286">Modèle Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="c873b-286">Azure Resource Manager template</span></span>   | <span data-ttu-id="c873b-287">Non</span><span class="sxs-lookup"><span data-stu-id="c873b-287">No</span></span>  | [<span data-ttu-id="c873b-288">Oui</span><span class="sxs-lookup"><span data-stu-id="c873b-288">Yes</span></span>](virtual-networks-create-nsg-arm-template.md) |

## <a name="planning"></a><span data-ttu-id="c873b-289">Planification</span><span class="sxs-lookup"><span data-stu-id="c873b-289">Planning</span></span>
<span data-ttu-id="c873b-290">Avant d’implémenter des groupes de sécurité réseau, vous devez répondre aux questions suivantes :</span><span class="sxs-lookup"><span data-stu-id="c873b-290">Before implementing NSGs, you need to answer the following questions:</span></span>

1. <span data-ttu-id="c873b-291">Quels sont les types de ressources à partir ou en direction desquels vous souhaitez filtrer le trafic ?</span><span class="sxs-lookup"><span data-stu-id="c873b-291">What types of resources do you want to filter traffic to or from?</span></span> <span data-ttu-id="c873b-292">Vous pouvez connecter des ressources telles que des NIC (Resource Manager), des machines virtuelles (Classic), des services cloud, des environnements App Service et VM Scale Sets.</span><span class="sxs-lookup"><span data-stu-id="c873b-292">You can connect resources such as NICs (Resource Manager), VMs (classic), Cloud Services, Application Service Environments, and VM Scale Sets.</span></span> 
2. <span data-ttu-id="c873b-293">Les ressources en direction ou à partir desquelles vous voulez filtrer le trafic sont-elles connectées à des sous-réseaux de réseaux virtuels existants ?</span><span class="sxs-lookup"><span data-stu-id="c873b-293">Are the resources you want to filter traffic to/from connected to subnets in existing VNets?</span></span>

<span data-ttu-id="c873b-294">Pour plus d’informations sur la planification de la sécurité réseau dans Azure, consultez l’article [Services cloud et sécurité réseau](../best-practices-network-security.md).</span><span class="sxs-lookup"><span data-stu-id="c873b-294">For more information on planning for network security in Azure, read the [Cloud services and network security](../best-practices-network-security.md) article.</span></span> 

## <a name="design-considerations"></a><span data-ttu-id="c873b-295">Remarques relatives à la conception</span><span class="sxs-lookup"><span data-stu-id="c873b-295">Design considerations</span></span>
<span data-ttu-id="c873b-296">Une fois que vous connaissez les réponses aux questions de la section [Planification](#Planning), consultez les sections ci-après avant de définir vos NSG.</span><span class="sxs-lookup"><span data-stu-id="c873b-296">Once you know the answers to the questions in the [Planning](#Planning) section, review the following sections before defining your NSGs:</span></span>

### <a name="limits"></a><span data-ttu-id="c873b-297">limites</span><span class="sxs-lookup"><span data-stu-id="c873b-297">Limits</span></span>
<span data-ttu-id="c873b-298">Il existe des limites concernant le nombre de NSG dont vous pouvez disposer dans un abonnement et le nombre de règles par NSG.</span><span class="sxs-lookup"><span data-stu-id="c873b-298">There are limits to the number of NSGs you can have in a subscription and number of rules per NSG.</span></span> <span data-ttu-id="c873b-299">Pour plus d’informations sur les limites, voir [Limites d’Azure](../azure-subscription-service-limits.md#networking-limits).</span><span class="sxs-lookup"><span data-stu-id="c873b-299">To learn more about the limits, read the [Azure limits](../azure-subscription-service-limits.md#networking-limits) article.</span></span>

### <a name="vnet-and-subnet-design"></a><span data-ttu-id="c873b-300">Conception de réseau virtuel et de sous-réseau</span><span class="sxs-lookup"><span data-stu-id="c873b-300">VNet and subnet design</span></span>
<span data-ttu-id="c873b-301">Comme les groupes de sécurité réseau peuvent être appliqués à des sous-réseaux, vous pouvez réduire le nombre de groupes de sécurité réseau en regroupant vos ressources par sous-réseau et en appliquant des groupes de sécurité réseau aux sous-réseaux.</span><span class="sxs-lookup"><span data-stu-id="c873b-301">Since NSGs can be applied to subnets, you can minimize the number of NSGs by grouping your resources by subnet, and applying NSGs to subnets.</span></span>  <span data-ttu-id="c873b-302">Si vous décidez d’appliquer des groupes de sécurité réseau à des sous-réseaux, il se peut que vous trouviez des réseaux virtuels et les sous-réseaux existants qui n’ont pas été définis avec des groupes de sécurité réseau à l’esprit.</span><span class="sxs-lookup"><span data-stu-id="c873b-302">If you decide to apply NSGs to subnets, you may find that existing VNets and subnets you have were not defined with NSGs in mind.</span></span> <span data-ttu-id="c873b-303">Vous pouvez avoir besoin de définir de nouveaux réseaux virtuels et sous-réseaux pour prendre en charge votre conception de NSG et déployer vos nouvelles ressources vers les nouveaux sous-réseaux.</span><span class="sxs-lookup"><span data-stu-id="c873b-303">You may need to define new VNets and subnets to support your NSG design and deploy your new resources to your new subnets.</span></span> <span data-ttu-id="c873b-304">Vous pouvez ensuite définir une stratégie de migration pour déplacer des ressources existantes vers les nouveaux sous-réseaux.</span><span class="sxs-lookup"><span data-stu-id="c873b-304">You could then define a migration strategy to move existing resources to the new subnets.</span></span> 

### <a name="special-rules"></a><span data-ttu-id="c873b-305">Règles spéciales</span><span class="sxs-lookup"><span data-stu-id="c873b-305">Special rules</span></span>
<span data-ttu-id="c873b-306">Si vous bloquez le trafic autorisé par les règles ci-après, votre infrastructure ne pourra pas communiquer avec les services Azure essentiels :</span><span class="sxs-lookup"><span data-stu-id="c873b-306">If you block traffic allowed by the following rules, your infrastructure can't communicate with essential Azure services:</span></span>

* <span data-ttu-id="c873b-307">**Adresse IP virtuelle du nœud hôte :** des services d’infrastructure de base tels que DHCP, DNS et l’analyse du fonctionnement sont fournis par le biais de l’adresse IP d’hôte virtualisé 168.63.129.16.</span><span class="sxs-lookup"><span data-stu-id="c873b-307">**Virtual IP of the host node:** Basic infrastructure services such as DHCP, DNS, and health monitoring are provided through the virtualized host IP address 168.63.129.16.</span></span> <span data-ttu-id="c873b-308">Cette adresse IP publique appartient à Microsoft et constitue la seule adresse IP virtualisée utilisée dans toutes les régions à cet effet.</span><span class="sxs-lookup"><span data-stu-id="c873b-308">This public IP address belongs to Microsoft and is the only virtualized IP address used in all regions for this purpose.</span></span> <span data-ttu-id="c873b-309">Cette adresse IP mappe vers l’adresse IP physique de l’ordinateur (nœud hôte) du serveur qui héberge la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="c873b-309">This IP address maps to the physical IP address of the server machine (host node) hosting the VM.</span></span> <span data-ttu-id="c873b-310">Le nœud hôte agit en tant que relais DHCP, le programme de résolution récursif DNS et la sonde source de la sonde d’intégrité de l’équilibreur de charge et de la sonde d’intégrité de la machine.</span><span class="sxs-lookup"><span data-stu-id="c873b-310">The host node acts as the DHCP relay, the DNS recursive resolver, and the probe source for the load balancer health probe and the machine health probe.</span></span> <span data-ttu-id="c873b-311">Les communications vers cette adresse IP ne constituent pas une attaque.</span><span class="sxs-lookup"><span data-stu-id="c873b-311">Communication to this IP address is not an attack.</span></span>
* <span data-ttu-id="c873b-312">**Gestion des licences (Service de gestion de clés) :** les images Windows en cours d’exécution sur les machines virtuelles doivent être acquises sous licence.</span><span class="sxs-lookup"><span data-stu-id="c873b-312">**Licensing (Key Management Service):** Windows images running in VMs must be licensed.</span></span> <span data-ttu-id="c873b-313">Pour assurer la gestion des licences, une requête est envoyée aux serveurs hôtes du Service de gestion de clés qui gèrent les requêtes de ce type.</span><span class="sxs-lookup"><span data-stu-id="c873b-313">To ensure licensing, a request is sent to the Key Management Service host servers that handle such queries.</span></span> <span data-ttu-id="c873b-314">La requête est effectuée en sortie par le biais du port 1688.</span><span class="sxs-lookup"><span data-stu-id="c873b-314">The request is made outbound through port 1688.</span></span>

### <a name="icmp-traffic"></a><span data-ttu-id="c873b-315">Trafic ICMP</span><span class="sxs-lookup"><span data-stu-id="c873b-315">ICMP traffic</span></span>
<span data-ttu-id="c873b-316">Les règles de groupe de sécurité réseau actuelles autorisent uniquement les protocoles *TCP* ou *UDP*.</span><span class="sxs-lookup"><span data-stu-id="c873b-316">The current NSG rules only allow for protocols *TCP* or *UDP*.</span></span> <span data-ttu-id="c873b-317">Il n’existe aucune balise spécifique pour *ICMP*.</span><span class="sxs-lookup"><span data-stu-id="c873b-317">There is not a specific tag for *ICMP*.</span></span> <span data-ttu-id="c873b-318">Toutefois, le trafic ICMP est autorisé dans un réseau virtuel par la règle par défaut AllowVNetInBound, qui autorise le trafic à destination et en provenance de n’importe quel port et protocole à l’intérieur du réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="c873b-318">However, ICMP traffic is allowed within a VNet by the AllowVNetInBound default rule, that allows traffic to and from any port and protocol within the VNet.</span></span>

### <a name="subnets"></a><span data-ttu-id="c873b-319">Sous-réseaux</span><span class="sxs-lookup"><span data-stu-id="c873b-319">Subnets</span></span>
* <span data-ttu-id="c873b-320">Tenez compte du nombre de niveaux que requiert votre charge de travail.</span><span class="sxs-lookup"><span data-stu-id="c873b-320">Consider the number of tiers your workload requires.</span></span> <span data-ttu-id="c873b-321">Chaque niveau peut être isolé à l’aide d’un sous-réseau, avec un groupe de sécurité réseau appliqué au sous-réseau.</span><span class="sxs-lookup"><span data-stu-id="c873b-321">Each tier can be isolated by using a subnet, with an NSG applied to the subnet.</span></span> 
* <span data-ttu-id="c873b-322">Si vous avez besoin d’implémenter un sous-réseau pour une passerelle VPN ou un circuit ExpressRoute, n’appliquez **pas** de NSG à ce sous-réseau.</span><span class="sxs-lookup"><span data-stu-id="c873b-322">If you need to implement a subnet for a VPN gateway, or ExpressRoute circuit, do **not** apply an NSG to that subnet.</span></span> <span data-ttu-id="c873b-323">Si vous le faites, la connectivité entre réseaux virtuels ou entre différents locaux risque de ne pas fonctionner.</span><span class="sxs-lookup"><span data-stu-id="c873b-323">If you do so, cross-VNet or cross-premises connectivity may fail.</span></span> 
* <span data-ttu-id="c873b-324">Si vous avez besoin d’implémenter une appliance virtuelle réseau (NVA), connectez cette dernière à son propre sous-réseau et créez des itinéraires définis par l’utilisateur (UDR) à destination et en provenance de la NVA.</span><span class="sxs-lookup"><span data-stu-id="c873b-324">If you need to implement a network virtual appliance (NVA), connect the NVA to its own subnet and create user-defined routes (UDR) to and from the NVA.</span></span> <span data-ttu-id="c873b-325">Vous pouvez implémenter un niveau de sous-réseau groupe de sécurité réseau pour filtrer le trafic vers et depuis ce sous-réseau.</span><span class="sxs-lookup"><span data-stu-id="c873b-325">You can implement a subnet level NSG to filter traffic in and out of this subnet.</span></span> <span data-ttu-id="c873b-326">Pour plus d’informations sur les UDR, consultez l’article [Itinéraires définis par l’utilisateur](virtual-networks-udr-overview.md).</span><span class="sxs-lookup"><span data-stu-id="c873b-326">To learn more about UDRs, read the [User-defined routes](virtual-networks-udr-overview.md) article.</span></span>

### <a name="load-balancers"></a><span data-ttu-id="c873b-327">Équilibreurs de charge</span><span class="sxs-lookup"><span data-stu-id="c873b-327">Load balancers</span></span>
* <span data-ttu-id="c873b-328">Considérez les règles d’équilibrage de charge et de traduction d’adresses réseau (NAT) relatives à chaque équilibreur de charge utilisé par chacune de vos charges de travail.</span><span class="sxs-lookup"><span data-stu-id="c873b-328">Consider the load balancing and network address translation (NAT) rules for each load balancer used by each of your workloads.</span></span> <span data-ttu-id="c873b-329">Les règles NAT sont liées à un pool principal qui contient des instances de rôle NIC (Resource Manager) ou machines virtuelles/services cloud (Classic).</span><span class="sxs-lookup"><span data-stu-id="c873b-329">NAT rules are bound to a back-end pool that contains NICs (Resource Manager) or VMs/Cloud Services role instances (classic).</span></span> <span data-ttu-id="c873b-330">Envisagez de créer un NSG pour chaque pool principal, ce qui autorise uniquement le trafic mappé par le biais des règles implémentées dans les équilibreurs de charge.</span><span class="sxs-lookup"><span data-stu-id="c873b-330">Consider creating an NSG for each back-end pool, allowing only traffic mapped through the rules implemented in the load balancers.</span></span> <span data-ttu-id="c873b-331">La création d’un NSG pour chaque pool principal garantit que le trafic entrant dans le pool principal directement (plutôt que par l’intermédiaire de l’équilibreur de charge) est également filtré.</span><span class="sxs-lookup"><span data-stu-id="c873b-331">Creating an NSG for each back-end pool guarantees that traffic coming to the back-end pool directly (rather than through the load balancer), is also filtered.</span></span>
* <span data-ttu-id="c873b-332">Dans les déploiements classiques, vous pouvez créer des points de terminaison qui mappent des ports d’un équilibreur de charge sur des ports sur vos machines virtuelles ou instances de rôle.</span><span class="sxs-lookup"><span data-stu-id="c873b-332">In classic deployments, you create endpoints that map ports on a load balancer to ports on your VMs or role instances.</span></span> <span data-ttu-id="c873b-333">Vous pouvez également créer votre propre équilibreur de charge public individuel par le biais de Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="c873b-333">You can also create your own individual public-facing load balancer through Resource Manager.</span></span> <span data-ttu-id="c873b-334">Le port de destination pour le trafic entrant est le port réel de la machine virtuelle ou de l’instance de rôle, et non le port exposé par un équilibreur de charge.</span><span class="sxs-lookup"><span data-stu-id="c873b-334">The destination port for incoming traffic is the actual port in the VM or role instance, not the port exposed by a load balancer.</span></span> <span data-ttu-id="c873b-335">Le port et l’adresse source de connexion à la machine virtuelle sont un port et une adresse sur l’ordinateur distant sur Internet, et non le port et l’adresse exposés par l’équilibreur de charge.</span><span class="sxs-lookup"><span data-stu-id="c873b-335">The source port and address for the connection to the VM is a port and address on the remote computer in the Internet, not the port and address exposed by the load balancer.</span></span>
* <span data-ttu-id="c873b-336">Lorsque vous créez des NSG pour filtrer le trafic transitant par un équilibreur de charge interne, le port et la plage d’adresses sources appliqués sont ceux de l’ordinateur d’origine, et non de l’équilibreur de charge.</span><span class="sxs-lookup"><span data-stu-id="c873b-336">When you create NSGs to filter traffic coming through an internal load balancer (ILB), the source port and address range applied are  from the originating computer, not the load balancer.</span></span> <span data-ttu-id="c873b-337">Le port et la plage d’adresses de destination sont ceux de l’ordinateur de destination, et non de l’équilibrage de charge.</span><span class="sxs-lookup"><span data-stu-id="c873b-337">The destination port and address range are those of the destination computer, not the load balancer.</span></span>

### <a name="other"></a><span data-ttu-id="c873b-338">Autres</span><span class="sxs-lookup"><span data-stu-id="c873b-338">Other</span></span>
* <span data-ttu-id="c873b-339">Les listes de contrôle d’accès (ACL) basées sur le point de terminaison et les NSG ne sont pas pris en charge sur la même instance de machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="c873b-339">Endpoint-based access control lists (ACL) and NSGs are not supported on the same VM instance.</span></span> <span data-ttu-id="c873b-340">Si vous souhaitez utiliser un groupe de sécurité réseau et une ACL de point de terminaison déjà en place, supprimez d’abord l’ACL de point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="c873b-340">If you want to use an NSG and have an endpoint ACL already in place, first remove the endpoint ACL.</span></span> <span data-ttu-id="c873b-341">Pour plus d’informations sur la procédure de suppression d’une ACL de point de terminaison, consultez l’article [Gérer les listes de contrôle d’accès de point de terminaison](virtual-networks-acl-powershell.md).</span><span class="sxs-lookup"><span data-stu-id="c873b-341">For information about how to remove an endpoint ACL, see the [Manage endpoint ACLs](virtual-networks-acl-powershell.md) article.</span></span>
* <span data-ttu-id="c873b-342">Dans Resource Manager, vous pouvez utiliser un NSG associé à une NIC pour les machines virtuelles contenant plusieurs NIC afin d’autoriser une gestion (accès à distance) par NIC.</span><span class="sxs-lookup"><span data-stu-id="c873b-342">In Resource Manager, you can use an NSG associated to a NIC for VMs with multiple NICs to enable management (remote access) on a per NIC basis.</span></span> <span data-ttu-id="c873b-343">L’association de NSG uniques à chaque NIC permet de séparer les types de trafics entre les NIC.</span><span class="sxs-lookup"><span data-stu-id="c873b-343">Associating unique NSGs to each NIC enables separation of traffic types across NICs.</span></span>
* <span data-ttu-id="c873b-344">Comme en cas d’utilisation des équilibreurs de charge, lorsque vous filtrez le trafic vers d’autres réseaux virtuels, vous devez utiliser la plage d’adresses source de l’ordinateur distant, et non la passerelle qui connecte les réseaux virtuels.</span><span class="sxs-lookup"><span data-stu-id="c873b-344">Similar to the use of load balancers, when filtering traffic from other VNets, you must use the source address range of the remote computer, not the gateway connecting the VNets.</span></span>
* <span data-ttu-id="c873b-345">De nombreux services Azure ne peuvent pas être connectés à des réseaux virtuels.</span><span class="sxs-lookup"><span data-stu-id="c873b-345">Many Azure services cannot be connected to VNets.</span></span> <span data-ttu-id="c873b-346">Si une ressource Azure n’est pas connectée à un réseau virtuel, vous ne pouvez pas utiliser de NSG pour filtrer le trafic vers la ressource.</span><span class="sxs-lookup"><span data-stu-id="c873b-346">If an Azure resource is not connected to a VNet, you cannot use an NSG to filter traffic to the resource.</span></span>  <span data-ttu-id="c873b-347">Pour déterminer si les services que vous utilisez peuvent ou non être connectés à un réseau virtuel, consultez la documentation de ces services.</span><span class="sxs-lookup"><span data-stu-id="c873b-347">Read the documentation for the services you use to determine whether the service can be connected to a VNet.</span></span>

## <a name="sample-deployment"></a><span data-ttu-id="c873b-348">Exemple de déploiement</span><span class="sxs-lookup"><span data-stu-id="c873b-348">Sample deployment</span></span>
<span data-ttu-id="c873b-349">Pour illustrer la mise en application des informations de cet article, examinons un scénario courant d’une application à deux niveaux représenté dans la figure ci-après :</span><span class="sxs-lookup"><span data-stu-id="c873b-349">To illustrate the application of the information in this article, consider a common scenario of a two tier application shown in the following picture:</span></span>

![Groupes de sécurité réseau](./media/virtual-network-nsg-overview/figure1.png)

<span data-ttu-id="c873b-351">Comme illustré dans le diagramme, les machines virtuelles *Web1* et *Web2* sont connectées au sous-réseau *FrontEnd*, et les machines virtuelles *DB1* et *DB2* sont connectées au sous-réseau *BackEnd*.</span><span class="sxs-lookup"><span data-stu-id="c873b-351">As shown in the diagram, the *Web1* and *Web2* VMs are connected to the *FrontEnd* subnet, and the *DB1* and *DB2* VMs are connected to the *BackEnd* subnet.</span></span>  <span data-ttu-id="c873b-352">Les deux sous-réseaux font partie du réseau virtuel *TestVNet* .</span><span class="sxs-lookup"><span data-stu-id="c873b-352">Both subnets are part of the *TestVNet* VNet.</span></span> <span data-ttu-id="c873b-353">Chaque composant d’application s’exécute dans une machine virtuelle Azure connectée à un réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="c873b-353">The application components each run within an Azure VM connected to a VNet.</span></span> <span data-ttu-id="c873b-354">Ce scénario comporte les exigences suivantes :</span><span class="sxs-lookup"><span data-stu-id="c873b-354">The scenario has the following requirements:</span></span>

1. <span data-ttu-id="c873b-355">Séparation du trafic entre les serveurs WEB et de base de données (DB)</span><span class="sxs-lookup"><span data-stu-id="c873b-355">Separation of traffic between the WEB and DB servers.</span></span>
2. <span data-ttu-id="c873b-356">Règles d’équilibrage de charge transférant le trafic en provenance de l’équilibreur de charge vers tous les serveurs web sur le port 80</span><span class="sxs-lookup"><span data-stu-id="c873b-356">Load balancing rules forward traffic from the load balancer to all web servers on port 80.</span></span>
3. <span data-ttu-id="c873b-357">Règles NAT d’équilibreur de charge transférant le trafic entrant dans l’équilibreur de charge sur le port 50001 vers le port 3389 de la machine virtuelle WEB1</span><span class="sxs-lookup"><span data-stu-id="c873b-357">Load balancer NAT rules forward traffic coming into the load balancer on port 50001 to port 3389 on the WEB1 VM.</span></span>
4. <span data-ttu-id="c873b-358">Aucun accès aux machines virtuelles frontales ou principales à partir d’Internet, à l’exception des exigences 2 et 3.</span><span class="sxs-lookup"><span data-stu-id="c873b-358">No access to the front-end or back-end VMs from the Internet, except requirements 2 and 3.</span></span>
5. <span data-ttu-id="c873b-359">Aucun accès Internet sortant à partir des serveurs WEB ou de base de données</span><span class="sxs-lookup"><span data-stu-id="c873b-359">No outbound Internet access from the WEB or DB servers.</span></span>
6. <span data-ttu-id="c873b-360">Accès à partir du sous-réseau FrontEnd autorisé vers le port 3389 de n’importe quel serveur web</span><span class="sxs-lookup"><span data-stu-id="c873b-360">Access from the FrontEnd subnet is allowed to port 3389 of any web server.</span></span>
7. <span data-ttu-id="c873b-361">Accès à partir du sous-réseau FrontEnd autorisé vers le port 3389 de n’importe quel serveur de base de données</span><span class="sxs-lookup"><span data-stu-id="c873b-361">Access from the FrontEnd subnet is allowed to port 3389 of any DB server.</span></span>
8. <span data-ttu-id="c873b-362">Accès à partir du sous-réseau FrontEnd autorisé vers le port 1433 de tous les serveurs de base de données</span><span class="sxs-lookup"><span data-stu-id="c873b-362">Access from the FrontEnd subnet is allowed to port 1433 of all DB servers.</span></span>
9. <span data-ttu-id="c873b-363">Séparation du trafic de gestion (port 3389) et du trafic de base de données (1433) sur les différentes NIC des serveurs de base de données</span><span class="sxs-lookup"><span data-stu-id="c873b-363">Separation of management traffic (port 3389) and database traffic (1433) on different NICs in DB servers.</span></span>

<span data-ttu-id="c873b-364">Les exigences 1 à 6 (à l’exception des exigences 3 et 4) sont toutes limitées aux espaces de sous-réseau.</span><span class="sxs-lookup"><span data-stu-id="c873b-364">Requirements 1-6 (except requirements 3 and 4) are all confined to subnet spaces.</span></span> <span data-ttu-id="c873b-365">Les NSG ci-après répondent aux exigences précédentes, tout en minimisant le nombre de NSG requis :</span><span class="sxs-lookup"><span data-stu-id="c873b-365">The following NSGs meet the previous requirements, while minimizing the number of NSGs required:</span></span>

### <a name="frontend"></a><span data-ttu-id="c873b-366">FrontEnd</span><span class="sxs-lookup"><span data-stu-id="c873b-366">FrontEnd</span></span>
<span data-ttu-id="c873b-367">**Règles de trafic entrant**</span><span class="sxs-lookup"><span data-stu-id="c873b-367">**Inbound rules**</span></span>

| <span data-ttu-id="c873b-368">Règle</span><span class="sxs-lookup"><span data-stu-id="c873b-368">Rule</span></span> | <span data-ttu-id="c873b-369">Access</span><span class="sxs-lookup"><span data-stu-id="c873b-369">Access</span></span> | <span data-ttu-id="c873b-370">Priorité</span><span class="sxs-lookup"><span data-stu-id="c873b-370">Priority</span></span> | <span data-ttu-id="c873b-371">Plage d’adresses source</span><span class="sxs-lookup"><span data-stu-id="c873b-371">Source address range</span></span> | <span data-ttu-id="c873b-372">Port source</span><span class="sxs-lookup"><span data-stu-id="c873b-372">Source port</span></span> | <span data-ttu-id="c873b-373">Plage d’adresses de destination</span><span class="sxs-lookup"><span data-stu-id="c873b-373">Destination address range</span></span> | <span data-ttu-id="c873b-374">Port de destination</span><span class="sxs-lookup"><span data-stu-id="c873b-374">Destination port</span></span> | <span data-ttu-id="c873b-375">Protocole</span><span class="sxs-lookup"><span data-stu-id="c873b-375">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="c873b-376">Allow-Inbound-HTTP-Internet</span><span class="sxs-lookup"><span data-stu-id="c873b-376">Allow-Inbound-HTTP-Internet</span></span> | <span data-ttu-id="c873b-377">AUTORISER</span><span class="sxs-lookup"><span data-stu-id="c873b-377">Allow</span></span> | <span data-ttu-id="c873b-378">100</span><span class="sxs-lookup"><span data-stu-id="c873b-378">100</span></span> | <span data-ttu-id="c873b-379">Internet</span><span class="sxs-lookup"><span data-stu-id="c873b-379">Internet</span></span> | * | * | <span data-ttu-id="c873b-380">80</span><span class="sxs-lookup"><span data-stu-id="c873b-380">80</span></span> | <span data-ttu-id="c873b-381">TCP</span><span class="sxs-lookup"><span data-stu-id="c873b-381">TCP</span></span> |
| <span data-ttu-id="c873b-382">Allow-Inbound-RDP-Internet</span><span class="sxs-lookup"><span data-stu-id="c873b-382">Allow-Inbound-RDP-Internet</span></span> | <span data-ttu-id="c873b-383">AUTORISER</span><span class="sxs-lookup"><span data-stu-id="c873b-383">Allow</span></span> | <span data-ttu-id="c873b-384">200</span><span class="sxs-lookup"><span data-stu-id="c873b-384">200</span></span> | <span data-ttu-id="c873b-385">Internet</span><span class="sxs-lookup"><span data-stu-id="c873b-385">Internet</span></span> | * | * | <span data-ttu-id="c873b-386">3389</span><span class="sxs-lookup"><span data-stu-id="c873b-386">3389</span></span> | <span data-ttu-id="c873b-387">TCP</span><span class="sxs-lookup"><span data-stu-id="c873b-387">TCP</span></span> |
| <span data-ttu-id="c873b-388">Deny-Inbound-All</span><span class="sxs-lookup"><span data-stu-id="c873b-388">Deny-Inbound-All</span></span> | <span data-ttu-id="c873b-389">REFUSER</span><span class="sxs-lookup"><span data-stu-id="c873b-389">Deny</span></span> | <span data-ttu-id="c873b-390">300</span><span class="sxs-lookup"><span data-stu-id="c873b-390">300</span></span> | <span data-ttu-id="c873b-391">Internet</span><span class="sxs-lookup"><span data-stu-id="c873b-391">Internet</span></span> | * | * | * | <span data-ttu-id="c873b-392">TCP</span><span class="sxs-lookup"><span data-stu-id="c873b-392">TCP</span></span> |

<span data-ttu-id="c873b-393">**Règles de trafic sortant**</span><span class="sxs-lookup"><span data-stu-id="c873b-393">**Outbound rules**</span></span>

| <span data-ttu-id="c873b-394">Règle</span><span class="sxs-lookup"><span data-stu-id="c873b-394">Rule</span></span> | <span data-ttu-id="c873b-395">Access</span><span class="sxs-lookup"><span data-stu-id="c873b-395">Access</span></span> | <span data-ttu-id="c873b-396">Priorité</span><span class="sxs-lookup"><span data-stu-id="c873b-396">Priority</span></span> | <span data-ttu-id="c873b-397">Plage d’adresses source</span><span class="sxs-lookup"><span data-stu-id="c873b-397">Source address range</span></span> | <span data-ttu-id="c873b-398">Port source</span><span class="sxs-lookup"><span data-stu-id="c873b-398">Source port</span></span> | <span data-ttu-id="c873b-399">Plage d’adresses de destination</span><span class="sxs-lookup"><span data-stu-id="c873b-399">Destination address range</span></span> | <span data-ttu-id="c873b-400">Port de destination</span><span class="sxs-lookup"><span data-stu-id="c873b-400">Destination port</span></span> | <span data-ttu-id="c873b-401">Protocole</span><span class="sxs-lookup"><span data-stu-id="c873b-401">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="c873b-402">Deny-Internet-All</span><span class="sxs-lookup"><span data-stu-id="c873b-402">Deny-Internet-All</span></span> |<span data-ttu-id="c873b-403">REFUSER</span><span class="sxs-lookup"><span data-stu-id="c873b-403">Deny</span></span> |<span data-ttu-id="c873b-404">100</span><span class="sxs-lookup"><span data-stu-id="c873b-404">100</span></span> | * | * | <span data-ttu-id="c873b-405">Internet</span><span class="sxs-lookup"><span data-stu-id="c873b-405">Internet</span></span> | * | * |

### <a name="backend"></a><span data-ttu-id="c873b-406">BackEnd</span><span class="sxs-lookup"><span data-stu-id="c873b-406">BackEnd</span></span>
<span data-ttu-id="c873b-407">**Règles de trafic entrant**</span><span class="sxs-lookup"><span data-stu-id="c873b-407">**Inbound rules**</span></span>

| <span data-ttu-id="c873b-408">Règle</span><span class="sxs-lookup"><span data-stu-id="c873b-408">Rule</span></span> | <span data-ttu-id="c873b-409">Access</span><span class="sxs-lookup"><span data-stu-id="c873b-409">Access</span></span> | <span data-ttu-id="c873b-410">Priorité</span><span class="sxs-lookup"><span data-stu-id="c873b-410">Priority</span></span> | <span data-ttu-id="c873b-411">Plage d’adresses source</span><span class="sxs-lookup"><span data-stu-id="c873b-411">Source address range</span></span> | <span data-ttu-id="c873b-412">Port source</span><span class="sxs-lookup"><span data-stu-id="c873b-412">Source port</span></span> | <span data-ttu-id="c873b-413">Plage d’adresses de destination</span><span class="sxs-lookup"><span data-stu-id="c873b-413">Destination address range</span></span> | <span data-ttu-id="c873b-414">Port de destination</span><span class="sxs-lookup"><span data-stu-id="c873b-414">Destination port</span></span> | <span data-ttu-id="c873b-415">Protocole</span><span class="sxs-lookup"><span data-stu-id="c873b-415">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="c873b-416">Deny-Internet-All</span><span class="sxs-lookup"><span data-stu-id="c873b-416">Deny-Internet-All</span></span> | <span data-ttu-id="c873b-417">REFUSER</span><span class="sxs-lookup"><span data-stu-id="c873b-417">Deny</span></span> | <span data-ttu-id="c873b-418">100</span><span class="sxs-lookup"><span data-stu-id="c873b-418">100</span></span> | <span data-ttu-id="c873b-419">Internet</span><span class="sxs-lookup"><span data-stu-id="c873b-419">Internet</span></span> | * | * | * | * |

<span data-ttu-id="c873b-420">**Règles de trafic sortant**</span><span class="sxs-lookup"><span data-stu-id="c873b-420">**Outbound rules**</span></span>

| <span data-ttu-id="c873b-421">Règle</span><span class="sxs-lookup"><span data-stu-id="c873b-421">Rule</span></span> | <span data-ttu-id="c873b-422">Access</span><span class="sxs-lookup"><span data-stu-id="c873b-422">Access</span></span> | <span data-ttu-id="c873b-423">Priorité</span><span class="sxs-lookup"><span data-stu-id="c873b-423">Priority</span></span> | <span data-ttu-id="c873b-424">Plage d’adresses source</span><span class="sxs-lookup"><span data-stu-id="c873b-424">Source address range</span></span> | <span data-ttu-id="c873b-425">Port source</span><span class="sxs-lookup"><span data-stu-id="c873b-425">Source port</span></span> | <span data-ttu-id="c873b-426">Plage d’adresses de destination</span><span class="sxs-lookup"><span data-stu-id="c873b-426">Destination address range</span></span> | <span data-ttu-id="c873b-427">Port de destination</span><span class="sxs-lookup"><span data-stu-id="c873b-427">Destination port</span></span> | <span data-ttu-id="c873b-428">Protocole</span><span class="sxs-lookup"><span data-stu-id="c873b-428">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="c873b-429">Deny-Internet-All</span><span class="sxs-lookup"><span data-stu-id="c873b-429">Deny-Internet-All</span></span> | <span data-ttu-id="c873b-430">REFUSER</span><span class="sxs-lookup"><span data-stu-id="c873b-430">Deny</span></span> | <span data-ttu-id="c873b-431">100</span><span class="sxs-lookup"><span data-stu-id="c873b-431">100</span></span> | * | * | <span data-ttu-id="c873b-432">Internet</span><span class="sxs-lookup"><span data-stu-id="c873b-432">Internet</span></span> | * | * |

<span data-ttu-id="c873b-433">Les NSG ci-après sont créés et associés aux NIC des machines virtuelles suivantes :</span><span class="sxs-lookup"><span data-stu-id="c873b-433">The following NSGs are created and associated to NICs in the following VMs:</span></span>

### <a name="web1"></a><span data-ttu-id="c873b-434">WEB1</span><span class="sxs-lookup"><span data-stu-id="c873b-434">WEB1</span></span>
<span data-ttu-id="c873b-435">**Règles de trafic entrant**</span><span class="sxs-lookup"><span data-stu-id="c873b-435">**Inbound rules**</span></span>

| <span data-ttu-id="c873b-436">Règle</span><span class="sxs-lookup"><span data-stu-id="c873b-436">Rule</span></span> | <span data-ttu-id="c873b-437">Access</span><span class="sxs-lookup"><span data-stu-id="c873b-437">Access</span></span> | <span data-ttu-id="c873b-438">Priorité</span><span class="sxs-lookup"><span data-stu-id="c873b-438">Priority</span></span> | <span data-ttu-id="c873b-439">Plage d’adresses source</span><span class="sxs-lookup"><span data-stu-id="c873b-439">Source address range</span></span> | <span data-ttu-id="c873b-440">Port source</span><span class="sxs-lookup"><span data-stu-id="c873b-440">Source port</span></span> | <span data-ttu-id="c873b-441">Plage d’adresses de destination</span><span class="sxs-lookup"><span data-stu-id="c873b-441">Destination address range</span></span> | <span data-ttu-id="c873b-442">Port de destination</span><span class="sxs-lookup"><span data-stu-id="c873b-442">Destination port</span></span> | <span data-ttu-id="c873b-443">Protocole</span><span class="sxs-lookup"><span data-stu-id="c873b-443">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="c873b-444">Allow-Inbound-RDP-Internet</span><span class="sxs-lookup"><span data-stu-id="c873b-444">Allow-Inbound-RDP-Internet</span></span> | <span data-ttu-id="c873b-445">AUTORISER</span><span class="sxs-lookup"><span data-stu-id="c873b-445">Allow</span></span> | <span data-ttu-id="c873b-446">100</span><span class="sxs-lookup"><span data-stu-id="c873b-446">100</span></span> | <span data-ttu-id="c873b-447">Internet</span><span class="sxs-lookup"><span data-stu-id="c873b-447">Internet</span></span> | * | * | <span data-ttu-id="c873b-448">3389</span><span class="sxs-lookup"><span data-stu-id="c873b-448">3389</span></span> | <span data-ttu-id="c873b-449">TCP</span><span class="sxs-lookup"><span data-stu-id="c873b-449">TCP</span></span> |
| <span data-ttu-id="c873b-450">Allow-Inbound-HTTP-Internet</span><span class="sxs-lookup"><span data-stu-id="c873b-450">Allow-Inbound-HTTP-Internet</span></span> | <span data-ttu-id="c873b-451">AUTORISER</span><span class="sxs-lookup"><span data-stu-id="c873b-451">Allow</span></span> | <span data-ttu-id="c873b-452">200</span><span class="sxs-lookup"><span data-stu-id="c873b-452">200</span></span> | <span data-ttu-id="c873b-453">Internet</span><span class="sxs-lookup"><span data-stu-id="c873b-453">Internet</span></span> | * | * | <span data-ttu-id="c873b-454">80</span><span class="sxs-lookup"><span data-stu-id="c873b-454">80</span></span> | <span data-ttu-id="c873b-455">TCP</span><span class="sxs-lookup"><span data-stu-id="c873b-455">TCP</span></span> |

> [!NOTE]
> <span data-ttu-id="c873b-456">La plage d’adresses source relative aux règles précédente correspond à **Internet**, et non à l’adresse IP virtuelle de l’équilibreur de charge.</span><span class="sxs-lookup"><span data-stu-id="c873b-456">The source address range for the previous rules is **Internet**, not the virtual IP address of for the load balancer.</span></span> <span data-ttu-id="c873b-457">Le port source est *, et non 500001.</span><span class="sxs-lookup"><span data-stu-id="c873b-457">The source port is *, not 500001.</span></span> <span data-ttu-id="c873b-458">Les règles NAT relatives aux équilibreurs de charge sont différentes des règles de sécurité de NSG.</span><span class="sxs-lookup"><span data-stu-id="c873b-458">NAT rules for load balancers are not the same as NSG security rules.</span></span> <span data-ttu-id="c873b-459">Les règles de sécurité de NSG sont toujours associées à la source d’origine et à la destination finale du trafic, et **NON** à l’équilibreur de charge entre les deux.</span><span class="sxs-lookup"><span data-stu-id="c873b-459">NSG security rules are always related to the original source and final destination of traffic, **not** the load balancer between the two.</span></span> 
> 
> 

### <a name="web2"></a><span data-ttu-id="c873b-460">WEB2</span><span class="sxs-lookup"><span data-stu-id="c873b-460">WEB2</span></span>
<span data-ttu-id="c873b-461">**Règles de trafic entrant**</span><span class="sxs-lookup"><span data-stu-id="c873b-461">**Inbound rules**</span></span>

| <span data-ttu-id="c873b-462">Règle</span><span class="sxs-lookup"><span data-stu-id="c873b-462">Rule</span></span> | <span data-ttu-id="c873b-463">Access</span><span class="sxs-lookup"><span data-stu-id="c873b-463">Access</span></span> | <span data-ttu-id="c873b-464">Priorité</span><span class="sxs-lookup"><span data-stu-id="c873b-464">Priority</span></span> | <span data-ttu-id="c873b-465">Plage d’adresses source</span><span class="sxs-lookup"><span data-stu-id="c873b-465">Source address range</span></span> | <span data-ttu-id="c873b-466">Port source</span><span class="sxs-lookup"><span data-stu-id="c873b-466">Source port</span></span> | <span data-ttu-id="c873b-467">Plage d’adresses de destination</span><span class="sxs-lookup"><span data-stu-id="c873b-467">Destination address range</span></span> | <span data-ttu-id="c873b-468">Port de destination</span><span class="sxs-lookup"><span data-stu-id="c873b-468">Destination port</span></span> | <span data-ttu-id="c873b-469">Protocole</span><span class="sxs-lookup"><span data-stu-id="c873b-469">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="c873b-470">Deny-Inbound-RDP-Internet</span><span class="sxs-lookup"><span data-stu-id="c873b-470">Deny-Inbound-RDP-Internet</span></span> | <span data-ttu-id="c873b-471">REFUSER</span><span class="sxs-lookup"><span data-stu-id="c873b-471">Deny</span></span> | <span data-ttu-id="c873b-472">100</span><span class="sxs-lookup"><span data-stu-id="c873b-472">100</span></span> | <span data-ttu-id="c873b-473">Internet</span><span class="sxs-lookup"><span data-stu-id="c873b-473">Internet</span></span> | * | * | <span data-ttu-id="c873b-474">3389</span><span class="sxs-lookup"><span data-stu-id="c873b-474">3389</span></span> | <span data-ttu-id="c873b-475">TCP</span><span class="sxs-lookup"><span data-stu-id="c873b-475">TCP</span></span> |
| <span data-ttu-id="c873b-476">Allow-Inbound-HTTP-Internet</span><span class="sxs-lookup"><span data-stu-id="c873b-476">Allow-Inbound-HTTP-Internet</span></span> | <span data-ttu-id="c873b-477">AUTORISER</span><span class="sxs-lookup"><span data-stu-id="c873b-477">Allow</span></span> | <span data-ttu-id="c873b-478">200</span><span class="sxs-lookup"><span data-stu-id="c873b-478">200</span></span> | <span data-ttu-id="c873b-479">Internet</span><span class="sxs-lookup"><span data-stu-id="c873b-479">Internet</span></span> | * | * | <span data-ttu-id="c873b-480">80</span><span class="sxs-lookup"><span data-stu-id="c873b-480">80</span></span> | <span data-ttu-id="c873b-481">TCP</span><span class="sxs-lookup"><span data-stu-id="c873b-481">TCP</span></span> |

### <a name="db-servers-management-nic"></a><span data-ttu-id="c873b-482">Serveurs de base de données (NIC de gestion)</span><span class="sxs-lookup"><span data-stu-id="c873b-482">DB servers (Management NIC)</span></span>
<span data-ttu-id="c873b-483">**Règles de trafic entrant**</span><span class="sxs-lookup"><span data-stu-id="c873b-483">**Inbound rules**</span></span>

| <span data-ttu-id="c873b-484">Règle</span><span class="sxs-lookup"><span data-stu-id="c873b-484">Rule</span></span> | <span data-ttu-id="c873b-485">Access</span><span class="sxs-lookup"><span data-stu-id="c873b-485">Access</span></span> | <span data-ttu-id="c873b-486">Priorité</span><span class="sxs-lookup"><span data-stu-id="c873b-486">Priority</span></span> | <span data-ttu-id="c873b-487">Plage d’adresses source</span><span class="sxs-lookup"><span data-stu-id="c873b-487">Source address range</span></span> | <span data-ttu-id="c873b-488">Port source</span><span class="sxs-lookup"><span data-stu-id="c873b-488">Source port</span></span> | <span data-ttu-id="c873b-489">Plage d’adresses de destination</span><span class="sxs-lookup"><span data-stu-id="c873b-489">Destination address range</span></span> | <span data-ttu-id="c873b-490">Port de destination</span><span class="sxs-lookup"><span data-stu-id="c873b-490">Destination port</span></span> | <span data-ttu-id="c873b-491">Protocole</span><span class="sxs-lookup"><span data-stu-id="c873b-491">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="c873b-492">Allow-Inbound-RDP-Front-end</span><span class="sxs-lookup"><span data-stu-id="c873b-492">Allow-Inbound-RDP-Front-end</span></span> | <span data-ttu-id="c873b-493">AUTORISER</span><span class="sxs-lookup"><span data-stu-id="c873b-493">Allow</span></span> | <span data-ttu-id="c873b-494">100</span><span class="sxs-lookup"><span data-stu-id="c873b-494">100</span></span> | <span data-ttu-id="c873b-495">192.168.1.0/24</span><span class="sxs-lookup"><span data-stu-id="c873b-495">192.168.1.0/24</span></span> | * | * | <span data-ttu-id="c873b-496">3389</span><span class="sxs-lookup"><span data-stu-id="c873b-496">3389</span></span> | <span data-ttu-id="c873b-497">TCP</span><span class="sxs-lookup"><span data-stu-id="c873b-497">TCP</span></span> |

### <a name="db-servers-database-traffic-nic"></a><span data-ttu-id="c873b-498">Serveurs de base de données (NIC du trafic de base de données)</span><span class="sxs-lookup"><span data-stu-id="c873b-498">DB servers (Database traffic NIC)</span></span>
<span data-ttu-id="c873b-499">**Règles de trafic entrant**</span><span class="sxs-lookup"><span data-stu-id="c873b-499">**Inbound rules**</span></span>

| <span data-ttu-id="c873b-500">Règle</span><span class="sxs-lookup"><span data-stu-id="c873b-500">Rule</span></span> | <span data-ttu-id="c873b-501">Access</span><span class="sxs-lookup"><span data-stu-id="c873b-501">Access</span></span> | <span data-ttu-id="c873b-502">Priorité</span><span class="sxs-lookup"><span data-stu-id="c873b-502">Priority</span></span> | <span data-ttu-id="c873b-503">Plage d’adresses source</span><span class="sxs-lookup"><span data-stu-id="c873b-503">Source address range</span></span> | <span data-ttu-id="c873b-504">Port source</span><span class="sxs-lookup"><span data-stu-id="c873b-504">Source port</span></span> | <span data-ttu-id="c873b-505">Plage d’adresses de destination</span><span class="sxs-lookup"><span data-stu-id="c873b-505">Destination address range</span></span> | <span data-ttu-id="c873b-506">Port de destination</span><span class="sxs-lookup"><span data-stu-id="c873b-506">Destination port</span></span> | <span data-ttu-id="c873b-507">Protocole</span><span class="sxs-lookup"><span data-stu-id="c873b-507">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="c873b-508">Allow-Inbound-SQL-Front-end</span><span class="sxs-lookup"><span data-stu-id="c873b-508">Allow-Inbound-SQL-Front-end</span></span> | <span data-ttu-id="c873b-509">AUTORISER</span><span class="sxs-lookup"><span data-stu-id="c873b-509">Allow</span></span> | <span data-ttu-id="c873b-510">100</span><span class="sxs-lookup"><span data-stu-id="c873b-510">100</span></span> | <span data-ttu-id="c873b-511">192.168.1.0/24</span><span class="sxs-lookup"><span data-stu-id="c873b-511">192.168.1.0/24</span></span> | * | * | <span data-ttu-id="c873b-512">1433</span><span class="sxs-lookup"><span data-stu-id="c873b-512">1433</span></span> | <span data-ttu-id="c873b-513">TCP</span><span class="sxs-lookup"><span data-stu-id="c873b-513">TCP</span></span> |

<span data-ttu-id="c873b-514">Étant donné que certains NSG sont associés à des NIC spécifiques, les règles s’appliquent aux ressources déployées par le biais de Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="c873b-514">Since some of the NSGs are associated to individual NICs, the rules are for resources deployed through Resource Manager.</span></span> <span data-ttu-id="c873b-515">Les règles sont combinées pour le sous-réseau et la NIC, selon leur mode d’association.</span><span class="sxs-lookup"><span data-stu-id="c873b-515">Rules are combined for subnet and NIC, depending on how they are associated.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="c873b-516">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="c873b-516">Next steps</span></span>
* <span data-ttu-id="c873b-517">[Déployer les NSG (Resource Manager)](virtual-networks-create-nsg-arm-pportal.md)</span><span class="sxs-lookup"><span data-stu-id="c873b-517">[Deploy NSGs (Resource Manager)](virtual-networks-create-nsg-arm-pportal.md).</span></span>
* <span data-ttu-id="c873b-518">[Déployer les NSG (Classic)](virtual-networks-create-nsg-classic-ps.md)</span><span class="sxs-lookup"><span data-stu-id="c873b-518">[Deploy NSGs (classic)](virtual-networks-create-nsg-classic-ps.md).</span></span>
* <span data-ttu-id="c873b-519">[Gestion des journaux de groupe de sécurité réseau](virtual-network-nsg-manage-log.md).</span><span class="sxs-lookup"><span data-stu-id="c873b-519">[Manage NSG logs](virtual-network-nsg-manage-log.md).</span></span>
* <span data-ttu-id="c873b-520">[Résoudre les problèmes relatifs aux NSG] (virtual-network-nsg-troubleshoot-portal.md)</span><span class="sxs-lookup"><span data-stu-id="c873b-520">[Troubleshoot NSGs] (virtual-network-nsg-troubleshoot-portal.md)</span></span>
