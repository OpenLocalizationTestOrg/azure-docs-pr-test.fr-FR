---
title: aaaCreate les applications qui utilisent des rubriques et abonnements Azure Service Bus | Documents Microsoft
description: "Introduction toohello publication-abonnement fonctionnalités offertes par les abonnements et les rubriques Service Bus."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: a48fc9b0-b7b0-464e-8187-a517bf8b4eb4
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 04/07/2017
ms.author: sethm
ms.openlocfilehash: f6d7de46ace7bd5b49de612db213ced789308d91
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="create-applications-that-use-service-bus-topics-and-subscriptions"></a><span data-ttu-id="f03d2-103">Création d’applications qui utilisent des rubriques et des abonnements Service Bus</span><span class="sxs-lookup"><span data-stu-id="f03d2-103">Create applications that use Service Bus topics and subscriptions</span></span>
<span data-ttu-id="f03d2-104">Azure Service Bus prend en charge un ensemble de technologies interlogicielles Cloud orientées messages, notamment une mise en file d'attente des messages fiable et une messagerie de publication/abonnement durable.</span><span class="sxs-lookup"><span data-stu-id="f03d2-104">Azure Service Bus supports a set of cloud-based, message-oriented middleware technologies including reliable message queuing and durable publish/subscribe messaging.</span></span> <span data-ttu-id="f03d2-105">Cet article s’appuie sur les informations de hello fournies dans [créer des applications qui utilisent des files d’attente Service Bus](service-bus-create-queues.md) et offre une introduction toohello des fonctionnalités de publication/abonnement offertes par les rubriques Service Bus.</span><span class="sxs-lookup"><span data-stu-id="f03d2-105">This article builds on hello information provided in [Create applications that use Service Bus queues](service-bus-create-queues.md) and offers an introduction toohello publish/subscribe capabilities offered by Service Bus topics.</span></span>

## <a name="evolving-retail-scenario"></a><span data-ttu-id="f03d2-106">Scénario de vente au détail - La suite</span><span class="sxs-lookup"><span data-stu-id="f03d2-106">Evolving retail scenario</span></span>
<span data-ttu-id="f03d2-107">Cet article poursuit le scénario de vente au détail hello utilisé dans [créer des applications qui utilisent des files d’attente Service Bus](service-bus-create-queues.md).</span><span class="sxs-lookup"><span data-stu-id="f03d2-107">This article continues hello retail scenario used in [Create applications that use Service Bus queues](service-bus-create-queues.md).</span></span> <span data-ttu-id="f03d2-108">Rappelez-vous que les données de vente des terminaux de Point de vente (PDV) individuels doivent être routé tooan inventaire gestion système qui utilise ce toodetermine données quand toobe réapprovisionné.</span><span class="sxs-lookup"><span data-stu-id="f03d2-108">Recall that sales data from individual Point of Sale (POS) terminals must be routed tooan inventory management system which uses that data toodetermine when stock has toobe replenished.</span></span> <span data-ttu-id="f03d2-109">Chaque terminal de PDV fournit ses données de vente en envoyant des messages toohello **DataCollectionQueue** file d’attente, où elles restent jusqu'à ce qu’ils sont reçus par le système de gestion des stocks hello, comme illustré ici :</span><span class="sxs-lookup"><span data-stu-id="f03d2-109">Each POS terminal reports its sales data by sending messages toohello **DataCollectionQueue** queue, where they remain until they are received by hello inventory management system, as shown here:</span></span>

![Service Bus 1](./media/service-bus-create-topics-subscriptions/IC657161.gif)

<span data-ttu-id="f03d2-111">tooevolve ce scénario, une nouvelle spécification a été ajouté toohello système : propriétaire du magasin hello veut toobe toomonitor en mesure de performances de magasin de hello en temps réel.</span><span class="sxs-lookup"><span data-stu-id="f03d2-111">tooevolve this scenario, a new requirement has been added toohello system: hello store owner wants toobe able toomonitor how hello store is performing in real time.</span></span>

<span data-ttu-id="f03d2-112">tooaddress cette exigence, hello système doit « puiser » désactiver le flux de données de ventes hello.</span><span class="sxs-lookup"><span data-stu-id="f03d2-112">tooaddress this requirement, hello system must "tap" off hello sales data stream.</span></span> <span data-ttu-id="f03d2-113">Nous voulons toujours que chaque message envoyé par toobe de terminaux de PDV hello envoyé toohello inventaire système de gestion des, mais nous voulons une autre copie de chaque message que nous pouvons utiliser le propriétaire du magasin vue toohello toopresent hello du tableau de bord.</span><span class="sxs-lookup"><span data-stu-id="f03d2-113">We still want each message sent by hello POS terminals toobe sent toohello inventory management system as before, but we want another copy of each message that we can use toopresent hello dashboard view toohello store owner.</span></span>

<span data-ttu-id="f03d2-114">Dans tous les cas comme celui-ci, dans lequel vous avez besoin de chaque toobe message consommé par plusieurs parties, vous pouvez utiliser Service Bus *rubriques*.</span><span class="sxs-lookup"><span data-stu-id="f03d2-114">In any situation such as this, in which you require each message toobe consumed by multiple parties, you can use Service Bus *topics*.</span></span> <span data-ttu-id="f03d2-115">Rubriques fournissent un modèle de publication/abonnement dans lequel chaque message publié devient disponible tooone ou plusieurs abonnements inscrit auprès de rubrique de hello.</span><span class="sxs-lookup"><span data-stu-id="f03d2-115">Topics provide a publish/subscribe pattern in which each published message is made available tooone or more subscriptions registered with hello topic.</span></span> <span data-ttu-id="f03d2-116">Au contraire, avec les files d'attente, chaque message est reçu par un seul consommateur.</span><span class="sxs-lookup"><span data-stu-id="f03d2-116">In contrast, with queues each message is received by a single consumer.</span></span>

<span data-ttu-id="f03d2-117">Les messages sont envoyés tooa rubrique Bonjour même façon qu’ils sont envoyés à la file d’attente de tooa.</span><span class="sxs-lookup"><span data-stu-id="f03d2-117">Messages are sent tooa topic in hello same way as they are sent tooa queue.</span></span> <span data-ttu-id="f03d2-118">Toutefois, les messages ne sont pas reçues à partir de la rubrique de hello directement ; ils sont reçus à partir d’abonnements.</span><span class="sxs-lookup"><span data-stu-id="f03d2-118">However, messages are not received from hello topic directly; they are received from subscriptions.</span></span> <span data-ttu-id="f03d2-119">Vous pouvez considérer une rubrique de tooa abonnement comme une file d’attente virtuelle qui reçoit des copies de messages hello envoyés toothat rubrique.</span><span class="sxs-lookup"><span data-stu-id="f03d2-119">You can think of a subscription tooa topic as a virtual queue that receives copies of hello messages that are sent toothat topic.</span></span> <span data-ttu-id="f03d2-120">Les messages sont reçus à partir d’un abonnement hello même façon qu’ils sont reçus à partir d’une file d’attente.</span><span class="sxs-lookup"><span data-stu-id="f03d2-120">Messages are received from a subscription hello same way as they are received from a queue.</span></span>

<span data-ttu-id="f03d2-121">Revenons un scénario de vente au détail toohello, file d’attente hello est remplacé par une rubrique et un abonnement est ajouté, le composant de système de gestion hello inventaire peut utiliser.</span><span class="sxs-lookup"><span data-stu-id="f03d2-121">Going back toohello retail scenario, hello queue is replaced by a topic, and a subscription is added, which hello inventory management system component can use.</span></span> <span data-ttu-id="f03d2-122">système de Hello apparaît désormais comme suit :</span><span class="sxs-lookup"><span data-stu-id="f03d2-122">hello system now appears as follows:</span></span>

![Service Bus 2](./media/service-bus-create-topics-subscriptions/IC657165.gif)

<span data-ttu-id="f03d2-124">configuration de Hello ici identique conception basée sur la file d’attente précédente de toohello.</span><span class="sxs-lookup"><span data-stu-id="f03d2-124">hello configuration here performs identically toohello previous queue-based design.</span></span> <span data-ttu-id="f03d2-125">Autrement dit, les messages envoyés toohello rubrique sont routé toohello **inventaire** abonnement, à partir de quels hello **système de gestion des stocks** les consomme.</span><span class="sxs-lookup"><span data-stu-id="f03d2-125">That is, messages sent toohello topic are routed toohello **Inventory** subscription, from which hello **Inventory Management System** consumes them.</span></span>

<span data-ttu-id="f03d2-126">Dans le tableau de bord de gestion de commande toosupport hello, nous créons un deuxième abonnement sur la rubrique de hello, comme indiqué ici :</span><span class="sxs-lookup"><span data-stu-id="f03d2-126">In order toosupport hello management dashboard, we create a second subscription on hello topic, as shown here:</span></span>

![Service Bus 3](./media/service-bus-create-topics-subscriptions/IC657166.gif)

<span data-ttu-id="f03d2-128">Avec cette configuration, chaque message des terminaux de PDV de hello est mis à disposition tooboth hello **tableau de bord** et **inventaire** abonnements.</span><span class="sxs-lookup"><span data-stu-id="f03d2-128">With this configuration, each message from hello POS terminals is made available tooboth hello **Dashboard** and **Inventory** subscriptions.</span></span>

## <a name="show-me-hello-code"></a><span data-ttu-id="f03d2-129">Afficher le code de hello</span><span class="sxs-lookup"><span data-stu-id="f03d2-129">Show me hello code</span></span>
<span data-ttu-id="f03d2-130">article de Hello [créer des applications qui utilisent des files d’attente Service Bus](service-bus-create-queues.md) décrit comment toosign pour un compte Azure et créez un espace de noms de service.</span><span class="sxs-lookup"><span data-stu-id="f03d2-130">hello article [Create applications that use Service Bus queues](service-bus-create-queues.md) describes how toosign up for an Azure account and create a service namespace.</span></span> <span data-ttu-id="f03d2-131">dépendances du Service Bus tooreference Hello plus simple moyen est tooinstall hello Service Bus [package Nuget](https://www.nuget.org/packages/WindowsAzure.ServiceBus/).</span><span class="sxs-lookup"><span data-stu-id="f03d2-131">hello easiest way tooreference Service Bus dependencies is tooinstall hello Service Bus [Nuget package](https://www.nuget.org/packages/WindowsAzure.ServiceBus/).</span></span> <span data-ttu-id="f03d2-132">Vous pouvez également trouver hello bibliothèques Service Bus dans le cadre de hello Azure SDK.</span><span class="sxs-lookup"><span data-stu-id="f03d2-132">You can also find hello Service Bus libraries as part of hello Azure SDK.</span></span> <span data-ttu-id="f03d2-133">Bonjour téléchargement est disponible à l’adresse hello [page de téléchargement de Windows Azure SDK](https://azure.microsoft.com/downloads/).</span><span class="sxs-lookup"><span data-stu-id="f03d2-133">hello download is available at hello [Azure SDK download page](https://azure.microsoft.com/downloads/).</span></span>

### <a name="create-hello-topic-and-subscriptions"></a><span data-ttu-id="f03d2-134">Créer des abonnements et la rubrique de hello</span><span class="sxs-lookup"><span data-stu-id="f03d2-134">Create hello topic and subscriptions</span></span>
<span data-ttu-id="f03d2-135">Opérations de gestion de Service Bus entités de messagerie (files d’attente et publication/abonnement rubriques) sont effectuent via hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) classe.</span><span class="sxs-lookup"><span data-stu-id="f03d2-135">Management operations for Service Bus messaging entities (queues and publish/subscribe topics) are performed via hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) class.</span></span> <span data-ttu-id="f03d2-136">Informations d’identification appropriées sont requises dans la commande toocreate un **NamespaceManager** instance pour un espace de noms particulier.</span><span class="sxs-lookup"><span data-stu-id="f03d2-136">Appropriate credentials are required in order toocreate a **NamespaceManager** instance for a particular namespace.</span></span> <span data-ttu-id="f03d2-137">Service Bus utilise un modèle de sécurité basé sur une [signature d’accès partagé (SAP)](service-bus-sas.md).</span><span class="sxs-lookup"><span data-stu-id="f03d2-137">Service Bus uses a [Shared Access Signature (SAS)](service-bus-sas.md) based security model.</span></span> <span data-ttu-id="f03d2-138">Hello [TokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#microsoft_servicebus_tokenprovider) classe représente un fournisseur de jetons de sécurité avec les méthodes de fabrique intégrées retournant des fournisseurs de jeton bien connus.</span><span class="sxs-lookup"><span data-stu-id="f03d2-138">hello [TokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#microsoft_servicebus_tokenprovider) class represents a security token provider with built-in factory methods returning some well-known token providers.</span></span> <span data-ttu-id="f03d2-139">Nous allons utiliser un [CreateSharedAccessSignatureTokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#Microsoft_ServiceBus_TokenProvider_CreateSharedAccessSignatureTokenProvider_System_String_) informations d’identification de méthode toohold hello SAP.</span><span class="sxs-lookup"><span data-stu-id="f03d2-139">We’ll use a [CreateSharedAccessSignatureTokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#Microsoft_ServiceBus_TokenProvider_CreateSharedAccessSignatureTokenProvider_System_String_) method toohold hello SAS credentials.</span></span> <span data-ttu-id="f03d2-140">Hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) instance est ensuite créée avec l’adresse de base hello d’espace de noms Service Bus hello et le fournisseur de jetons hello.</span><span class="sxs-lookup"><span data-stu-id="f03d2-140">hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) instance is then constructed with hello base address of hello Service Bus namespace and hello token provider.</span></span>

<span data-ttu-id="f03d2-141">Hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) classe fournit des méthodes toocreate, énumérer et supprimer des entités de messagerie.</span><span class="sxs-lookup"><span data-stu-id="f03d2-141">hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) class provides methods toocreate, enumerate and delete messaging entities.</span></span> <span data-ttu-id="f03d2-142">Hello code fourni ici montre comment hello **NamespaceManager** instance est créé et utilisé toocreate hello **DataCollectionTopic** rubrique.</span><span class="sxs-lookup"><span data-stu-id="f03d2-142">hello code that is shown here shows how hello **NamespaceManager** instance is created and used toocreate hello **DataCollectionTopic** topic.</span></span>

```csharp
Uri uri = ServiceBusEnvironment.CreateServiceUri("sb", "test-blog", string.Empty);
string name = "RootManageSharedAccessKey";
string key = "abcdefghijklmopqrstuvwxyz";

TokenProvider tokenProvider = TokenProvider.CreateSharedAccessSignatureTokenProvider(name, key);
NamespaceManager namespaceManager = new NamespaceManager(uri, tokenProvider);

namespaceManager.CreateTopic("DataCollectionTopic");
```

<span data-ttu-id="f03d2-143">Notez qu’il existe des surcharges de hello [CreateTopic](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateTopic_System_String_) méthode qui vous permettent de tooset les propriétés de la rubrique de hello.</span><span class="sxs-lookup"><span data-stu-id="f03d2-143">Note that there are overloads of hello [CreateTopic](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateTopic_System_String_) method that enable you tooset properties of hello topic.</span></span> <span data-ttu-id="f03d2-144">Par exemple, vous pouvez définir hello time-to-live (TTL) par défaut pour les messages envoyés toohello rubrique.</span><span class="sxs-lookup"><span data-stu-id="f03d2-144">For example, you can set hello default time-to-live (TTL) value for messages sent toohello topic.</span></span> <span data-ttu-id="f03d2-145">Ensuite, ajoutez hello **inventaire** et **tableau de bord** abonnements.</span><span class="sxs-lookup"><span data-stu-id="f03d2-145">Next, add hello **Inventory** and **Dashboard** subscriptions.</span></span>

```csharp
namespaceManager.CreateSubscription("DataCollectionTopic", "Inventory");
namespaceManager.CreateSubscription("DataCollectionTopic", "Dashboard");
```

### <a name="send-messages-toohello-topic"></a><span data-ttu-id="f03d2-146">Rubrique toohello de messages d’envoi</span><span class="sxs-lookup"><span data-stu-id="f03d2-146">Send messages toohello topic</span></span>
<span data-ttu-id="f03d2-147">Pour des opérations d’exécution sur les entités Service Bus ; par exemple, pour l’envoi et la réception de messages, une application doit tout d’abord créer un objet [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#microsoft_servicebus_messaging_messagingfactory).</span><span class="sxs-lookup"><span data-stu-id="f03d2-147">For run-time operations on Service Bus entities; for example, sending and receiving messages, an application must first create a [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#microsoft_servicebus_messaging_messagingfactory) object.</span></span> <span data-ttu-id="f03d2-148">Similaire toohello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) classe hello **MessagingFactory** instance est créée à partir de l’adresse de base hello d’espace de noms de service hello et le fournisseur de jetons hello.</span><span class="sxs-lookup"><span data-stu-id="f03d2-148">Similar toohello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) class, hello **MessagingFactory** instance is created from hello base address of hello service namespace and hello token provider.</span></span>

```
MessagingFactory factory = MessagingFactory.Create(uri, tokenProvider);
```

<span data-ttu-id="f03d2-149">Tooand envoyés des messages reçu à partir des rubriques Service Bus, sont des instances de hello [BrokeredMessage](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage) classe.</span><span class="sxs-lookup"><span data-stu-id="f03d2-149">Messages sent tooand received from Service Bus topics, are instances of hello [BrokeredMessage](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage) class.</span></span> <span data-ttu-id="f03d2-150">Cette classe se compose d’un ensemble de propriétés standard (tels que [étiquette](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.label?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label) et [TimeToLive](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.timetolive?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_BrokeredMessage_TimeToLive)), un dictionnaire de propriétés de l’application toohold utilisées et un corps de données d’application arbitraire.</span><span class="sxs-lookup"><span data-stu-id="f03d2-150">This class consists of a set of standard properties (such as [Label](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.label?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label) and [TimeToLive](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.timetolive?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_BrokeredMessage_TimeToLive)), a dictionary that is used toohold application properties, and a body of arbitrary application data.</span></span> <span data-ttu-id="f03d2-151">Une application peut définir le corps de hello en passant tout objet sérialisable (hello exemple suivant passe dans un **SalesData** objet qui représente les données de ventes hello de terminal de PDV de hello), qui sera utilisée hello [ DataContractSerializer](https://msdn.microsoft.com/library/system.runtime.serialization.datacontractserializer.aspx) objet de hello tooserialize.</span><span class="sxs-lookup"><span data-stu-id="f03d2-151">An application can set hello body by passing in any serializable object (hello following example passes in a **SalesData** object that represents hello sales data from hello POS terminal), which will use hello [DataContractSerializer](https://msdn.microsoft.com/library/system.runtime.serialization.datacontractserializer.aspx) tooserialize hello object.</span></span> <span data-ttu-id="f03d2-152">Une autre possibilité consiste à fournir un objet [Stream](https://msdn.microsoft.com/library/system.io.stream.aspx).</span><span class="sxs-lookup"><span data-stu-id="f03d2-152">Alternatively, a [Stream](https://msdn.microsoft.com/library/system.io.stream.aspx) object can be provided.</span></span>

```csharp
BrokeredMessage bm = new BrokeredMessage(salesData);
bm.Label = "SalesReport";
bm.Properties["StoreName"] = "Redmond";
bm.Properties["MachineID"] = "POS_1";
```

<span data-ttu-id="f03d2-153">rubrique de Hello plus simple façon toosend messages toohello est toouse [CreateMessageSender](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageSender_System_String_) toocreate un [MessageSender](/dotnet/api/microsoft.servicebus.messaging.messagesender) objet directement à partir de hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) instance :</span><span class="sxs-lookup"><span data-stu-id="f03d2-153">hello easiest way toosend messages toohello topic is toouse [CreateMessageSender](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageSender_System_String_) toocreate a [MessageSender](/dotnet/api/microsoft.servicebus.messaging.messagesender) object directly from hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) instance:</span></span>

```csharp
MessageSender sender = factory.CreateMessageSender("DataCollectionTopic");
sender.Send(bm);
```

### <a name="receive-messages-from-a-subscription"></a><span data-ttu-id="f03d2-154">Réception des messages d’un abonnement</span><span class="sxs-lookup"><span data-stu-id="f03d2-154">Receive messages from a subscription</span></span>
<span data-ttu-id="f03d2-155">Les files d’attente de toousing similaire, tooreceive des messages à partir d’un abonnement, vous pouvez utiliser un [MessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagereceiver) objet que vous créez directement à partir de hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) à l’aide de [ CreateMessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageReceiver_System_String_).</span><span class="sxs-lookup"><span data-stu-id="f03d2-155">Similar toousing queues, tooreceive messages from a subscription you can use a [MessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagereceiver) object which you create directly from hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) using [CreateMessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageReceiver_System_String_).</span></span> <span data-ttu-id="f03d2-156">Vous pouvez utiliser l’une de hello deux différents modes de réception (**ReceiveAndDelete** et **PeekLock**), comme indiqué dans [créer des applications qui utilisent des files d’attente Service Bus](service-bus-create-queues.md).</span><span class="sxs-lookup"><span data-stu-id="f03d2-156">You can use one of hello two different receive modes (**ReceiveAndDelete** and **PeekLock**), as discussed in [Create applications that use Service Bus queues](service-bus-create-queues.md).</span></span>

<span data-ttu-id="f03d2-157">Notez que lorsque vous créez un **MessageReceiver** pour les abonnements, hello *entityPath* paramètre se présente sous forme de hello `topicPath/subscriptions/subscriptionName`.</span><span class="sxs-lookup"><span data-stu-id="f03d2-157">Note that when you create a **MessageReceiver** for subscriptions, hello *entityPath* parameter is of hello form `topicPath/subscriptions/subscriptionName`.</span></span> <span data-ttu-id="f03d2-158">Par conséquent, toocreate un **MessageReceiver** pour hello **inventaire** abonnement Hello **DataCollectionTopic** rubrique, *entityPath*doit être défini trop`DataCollectionTopic/subscriptions/Inventory`.</span><span class="sxs-lookup"><span data-stu-id="f03d2-158">Therefore, toocreate a **MessageReceiver** for hello **Inventory** subscription of hello **DataCollectionTopic** topic, *entityPath* must be set too`DataCollectionTopic/subscriptions/Inventory`.</span></span> <span data-ttu-id="f03d2-159">code de Hello apparaît comme suit :</span><span class="sxs-lookup"><span data-stu-id="f03d2-159">hello code appears as follows:</span></span>

```csharp
MessageReceiver receiver = factory.CreateMessageReceiver("DataCollectionTopic/subscriptions/Inventory");
BrokeredMessage receivedMessage = receiver.Receive();
try
{
    ProcessMessage(receivedMessage);
    receivedMessage.Complete();
}
catch (Exception e)
{
    receivedMessage.Abandon();
}
```

## <a name="subscription-filters"></a><span data-ttu-id="f03d2-160">Filtres d’abonnement</span><span class="sxs-lookup"><span data-stu-id="f03d2-160">Subscription filters</span></span>
<span data-ttu-id="f03d2-161">Jusqu'à présent, dans ce scénario, tous les messages envoyés toohello rubrique sont effectuées les abonnements disponibles tooall inscrit.</span><span class="sxs-lookup"><span data-stu-id="f03d2-161">So far, in this scenario all messages sent toohello topic are made available tooall registered subscriptions.</span></span> <span data-ttu-id="f03d2-162">expression de clé Hello ici est « accessible. »</span><span class="sxs-lookup"><span data-stu-id="f03d2-162">hello key phrase here is "made available."</span></span> <span data-ttu-id="f03d2-163">Bien que les abonnements Service Bus afficher tous les messages envoyés toohello rubrique, vous pouvez copier uniquement un sous-ensemble de ces files d’attente de messages toohello virtuelle des abonnements.</span><span class="sxs-lookup"><span data-stu-id="f03d2-163">While Service Bus subscriptions see all messages sent toohello topic, you can copy only a subset of those messages toohello virtual subscription queue.</span></span> <span data-ttu-id="f03d2-164">Pour ce faire, il faut utiliser des *filtres* d’abonnement.</span><span class="sxs-lookup"><span data-stu-id="f03d2-164">This is performed using subscription *filters*.</span></span> <span data-ttu-id="f03d2-165">Lorsque vous créez un abonnement, vous pouvez fournir une expression de filtre sous forme de hello d’un prédicat de type SQL92 qui opère sur les propriétés de message de type hello hello, les deux hello propriétés système (par exemple, [étiquette](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label)) et l’application hello propriétés, telles que **StoreName** dans l’exemple précédent de hello.</span><span class="sxs-lookup"><span data-stu-id="f03d2-165">When you create a subscription, you can supply a filter expression in hello form of a SQL92 style predicate that operates over hello properties of hello message, both hello system properties (for example, [Label](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label)) and hello application properties, such as **StoreName** in hello previous example.</span></span>

<span data-ttu-id="f03d2-166">Évolution hello scénario tooillustrate cela, un deuxième magasin est scénario de vente au détail toobe tooour ajouté.</span><span class="sxs-lookup"><span data-stu-id="f03d2-166">Evolving hello scenario tooillustrate this, a second store is toobe added tooour retail scenario.</span></span> <span data-ttu-id="f03d2-167">Chiffres des ventes de tous les terminaux hello POS à partir des deux magasins ont toujours système de gestion du stock toobe routé toohello centralisée, mais un gestionnaire de magasin à l’aide d’outil de tableau de bord hello est uniquement intéressé par les performances de hello de ce magasin.</span><span class="sxs-lookup"><span data-stu-id="f03d2-167">Sales data from all of hello POS terminals from both stores still have toobe routed toohello centralized inventory management system, but a store manager using hello dashboard tool is only interested in hello performance of that store.</span></span> <span data-ttu-id="f03d2-168">Vous pouvez utiliser l’abonnement filtrage tooachieve cela.</span><span class="sxs-lookup"><span data-stu-id="f03d2-168">You can use subscription filtering tooachieve this.</span></span> <span data-ttu-id="f03d2-169">Notez que lorsque les terminaux de PDV de hello publient des messages, ils définir hello **StoreName** propriété d’application sur le message de type hello.</span><span class="sxs-lookup"><span data-stu-id="f03d2-169">Note that when hello POS terminals publish messages, they set hello **StoreName** application property on hello message.</span></span> <span data-ttu-id="f03d2-170">Étant donné deux magasins, par exemple **Redmond** et **Seattle**, terminaux hello POS Bonjour Redmond stockent horodatage leurs données de ventes des messages avec un **StoreName** égal trop **Redmond**, alors que hello Seattle stocker l’utilisation des terminaux de PDV un **StoreName** égal trop**Seattle**.</span><span class="sxs-lookup"><span data-stu-id="f03d2-170">Given two stores, for example **Redmond** and **Seattle**, hello POS terminals in hello Redmond store stamp their sales data messages with a **StoreName** equal too**Redmond**, whereas hello Seattle store POS terminals use a **StoreName** equal too**Seattle**.</span></span> <span data-ttu-id="f03d2-171">le Gestionnaire de magasins Hello Hello Redmond stocker uniquement souhaite toosee des données à partir de ses terminaux de PDV.</span><span class="sxs-lookup"><span data-stu-id="f03d2-171">hello store manager of hello Redmond store only wants toosee data from its POS terminals.</span></span> <span data-ttu-id="f03d2-172">système de Hello apparaît comme suit :</span><span class="sxs-lookup"><span data-stu-id="f03d2-172">hello system appears as follows:</span></span>

![Service-Bus4](./media/service-bus-create-topics-subscriptions/IC657167.gif)

<span data-ttu-id="f03d2-174">tooset ce routage, vous créez hello **tableau de bord** abonnement comme suit :</span><span class="sxs-lookup"><span data-stu-id="f03d2-174">tooset up this routing, you create hello **Dashboard** subscription as follows:</span></span>

```csharp
SqlFilter dashboardFilter = new SqlFilter("StoreName = 'Redmond'");
namespaceManager.CreateSubscription("DataCollectionTopic", "Dashboard", dashboardFilter);
```

<span data-ttu-id="f03d2-175">Avec cette [filtre d’abonnement](/dotnet/api/microsoft.servicebus.messaging.sqlfilter), seuls les messages hello **StoreName** propriété trop**Redmond** sera copié toohello la file d’attente virtuelle pour hello **Tableau de bord** abonnement.</span><span class="sxs-lookup"><span data-stu-id="f03d2-175">With this [subscription filter](/dotnet/api/microsoft.servicebus.messaging.sqlfilter), only messages that have hello **StoreName** property set too**Redmond** will be copied toohello virtual queue for hello **Dashboard** subscription.</span></span> <span data-ttu-id="f03d2-176">Il est beaucoup plus toosubscription le filtrage, toutefois.</span><span class="sxs-lookup"><span data-stu-id="f03d2-176">There is much more toosubscription filtering, however.</span></span> <span data-ttu-id="f03d2-177">Applications peuvent avoir plusieurs règles de filtrage par abonnement dans Ajout toohello capacité toomodify hello les propriétés d’un message lorsqu’il passe de file d’attente virtuelle de l’abonnement tooa.</span><span class="sxs-lookup"><span data-stu-id="f03d2-177">Applications can have multiple filter rules per subscription in addition toohello ability toomodify hello properties of a message as it passes tooa subscription's virtual queue.</span></span>

## <a name="summary"></a><span data-ttu-id="f03d2-178">Résumé</span><span class="sxs-lookup"><span data-stu-id="f03d2-178">Summary</span></span>
<span data-ttu-id="f03d2-179">Tous les hello raisons toouse queuing décrits dans [créer des applications qui utilisent des files d’attente Service Bus](service-bus-create-queues.md) s’appliquent également tootopics, en particulier :</span><span class="sxs-lookup"><span data-stu-id="f03d2-179">All of hello reasons toouse queuing described in [Create applications that use Service Bus queues](service-bus-create-queues.md) also apply tootopics, specifically:</span></span>

* <span data-ttu-id="f03d2-180">Découplage temporel : message producteurs et consommateurs n’ont pas de toobe en ligne à hello même temps.</span><span class="sxs-lookup"><span data-stu-id="f03d2-180">Temporal decoupling – message producers and consumers do not have toobe online at hello same time.</span></span>
* <span data-ttu-id="f03d2-181">Nivellement de charge : les pics de charge sont nivelés par rubrique hello l’activation de consommation toobe d’applications configuré pour une charge moyenne au lieu de pics de charge.</span><span class="sxs-lookup"><span data-stu-id="f03d2-181">Load leveling – peaks in load are smoothed out by hello topic enabling consuming applications toobe provisioned for average load instead of peak load.</span></span>
* <span data-ttu-id="f03d2-182">Équilibrage : file d’attente de tooa similaires, vous pouvez avoir plusieurs consommateurs concurrents à l’écoute sur un seul abonnement avec chaque message remis tooonly un des consommateurs hello, ce qui équilibre la charge.</span><span class="sxs-lookup"><span data-stu-id="f03d2-182">Load balancing – similar tooa queue, you can have multiple competing consumers listening on a single subscription, with each message handed off tooonly one of hello consumers, thereby balancing load.</span></span>
* <span data-ttu-id="f03d2-183">Faible couplage : vous pouvez faire évoluer hello réseau de messagerie sans affecter les points de terminaison existants ; par exemple, ajouter des abonnements ou modifier les filtres tooa rubrique tooallow de nouveaux consommateurs.</span><span class="sxs-lookup"><span data-stu-id="f03d2-183">Loose coupling – you can evolve hello messaging network without affecting existing endpoints; for example, adding subscriptions or changing filters tooa topic tooallow for new consumers.</span></span>

## <a name="next-steps"></a><span data-ttu-id="f03d2-184">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="f03d2-184">Next steps</span></span>

<span data-ttu-id="f03d2-185">Consultez [créer des applications qui utilisent des files d’attente Service Bus](service-bus-create-queues.md) pour plus d’informations sur comment toouse les files d’attente dans un scénario de vente au détail hello POS.</span><span class="sxs-lookup"><span data-stu-id="f03d2-185">See [Create applications that use Service Bus queues](service-bus-create-queues.md) for information about how toouse queues in hello POS retail scenario.</span></span>

