---
title: messagerie asynchrone du Bus aaaService | Documents Microsoft
description: Description de la messagerie asynchrone Azure Service Bus.
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: f1435549-e1f2-40cb-a280-64ea07b39fc7
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 04/19/2017
ms.author: sethm
ms.openlocfilehash: 5ab6ddf052155a9dd975b413cfaf393119c1999d
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="asynchronous-messaging-patterns-and-high-availability"></a><span data-ttu-id="e57df-103">Modèles de messagerie asynchrone et haute disponibilité</span><span class="sxs-lookup"><span data-stu-id="e57df-103">Asynchronous messaging patterns and high availability</span></span>

<span data-ttu-id="e57df-104">Une messagerie asynchrone peut être mise en œuvre de différentes façons.</span><span class="sxs-lookup"><span data-stu-id="e57df-104">Asynchronous messaging can be implemented in a variety of different ways.</span></span> <span data-ttu-id="e57df-105">Avec les files d’attente, rubriques et abonnements, Azure Service Bus prend en charge des opérations asynchrones en utilisant un mécanisme de stockage et de transfert.</span><span class="sxs-lookup"><span data-stu-id="e57df-105">With queues, topics, and subscriptions, Azure Service Bus supports asynchronism via a store and forward mechanism.</span></span> <span data-ttu-id="e57df-106">Dans un fonctionnement normal (synchrone), vous envoyez des rubriques et des messages tooqueues et recevez des messages à partir de files d’attente et les abonnements.</span><span class="sxs-lookup"><span data-stu-id="e57df-106">In normal (synchronous) operation, you send messages tooqueues and topics, and receive messages from queues and subscriptions.</span></span> <span data-ttu-id="e57df-107">Les applications que vous rédigez dépendent de la disponibilité permanente de ces entités.</span><span class="sxs-lookup"><span data-stu-id="e57df-107">Applications you write depend on these entities always being available.</span></span> <span data-ttu-id="e57df-108">Lors de l’intégrité de l’entité hello change, en raison de tooa d’autres circonstances, vous devez un tooprovide de façon une entité de fonctionnalité réduite qui peut satisfaire la plupart des besoins.</span><span class="sxs-lookup"><span data-stu-id="e57df-108">When hello entity health changes, due tooa variety of circumstances, you need a way tooprovide a reduced capability entity that can satisfy most needs.</span></span>

<span data-ttu-id="e57df-109">Les applications utilisent les échanges asynchrones modèles tooenable un nombre de scénarios de communication.</span><span class="sxs-lookup"><span data-stu-id="e57df-109">Applications typically use asynchronous messaging patterns tooenable a number of communication scenarios.</span></span> <span data-ttu-id="e57df-110">Vous pouvez générer des applications dans lequel les clients peuvent envoyer des messages tooservices, même lorsque le service de hello n’est pas en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="e57df-110">You can build applications in which clients can send messages tooservices, even when hello service is not running.</span></span> <span data-ttu-id="e57df-111">Pour les applications qui rencontrent des pics de communications, une file d’attente peut aider à niveau hello charger en fournissant une communication de toobuffer sur place.</span><span class="sxs-lookup"><span data-stu-id="e57df-111">For applications that experience bursts of communications, a queue can help level hello load by providing a place toobuffer communications.</span></span> <span data-ttu-id="e57df-112">Enfin, vous pouvez obtenir une charge simple mais efficace les messages toodistribute équilibrage sur plusieurs ordinateurs.</span><span class="sxs-lookup"><span data-stu-id="e57df-112">Finally, you can get a simple but effective load balancer toodistribute messages across multiple machines.</span></span>

<span data-ttu-id="e57df-113">Commande toomaintain groupe à haute disponibilité d’un de ces entités, envisagez de plusieurs façons différentes, dans lequel ces entités peuvent apparaître non disponibles pour un système de messagerie durable.</span><span class="sxs-lookup"><span data-stu-id="e57df-113">In order toomaintain availability of any of these entities, consider a number of different ways in which these entities can appear unavailable for a durable messaging system.</span></span> <span data-ttu-id="e57df-114">En règle générale, nous voyons les entités hello deviennent indisponibles tooapplications que nous écrivons Bonjour suivant de différentes façons :</span><span class="sxs-lookup"><span data-stu-id="e57df-114">Generally speaking, we see hello entity become unavailable tooapplications we write in hello following different ways:</span></span>

* <span data-ttu-id="e57df-115">Impossible de toosend des messages.</span><span class="sxs-lookup"><span data-stu-id="e57df-115">Unable toosend messages.</span></span>
* <span data-ttu-id="e57df-116">Impossible de tooreceive des messages.</span><span class="sxs-lookup"><span data-stu-id="e57df-116">Unable tooreceive messages.</span></span>
* <span data-ttu-id="e57df-117">Impossible de toomanage entités (créer, récupérer, mettre à jour ou supprimer des entités).</span><span class="sxs-lookup"><span data-stu-id="e57df-117">Unable toomanage entities (create, retrieve, update, or delete entities).</span></span>
* <span data-ttu-id="e57df-118">Service de hello toocontact impossible.</span><span class="sxs-lookup"><span data-stu-id="e57df-118">Unable toocontact hello service.</span></span>

<span data-ttu-id="e57df-119">Pour chacun de ces défaillances, différents modes existent qui permettent un travail tooperform toocontinue de l’application à un niveau de fonctionnalité réduite.</span><span class="sxs-lookup"><span data-stu-id="e57df-119">For each of these failures, different failure modes exist that enable an application toocontinue tooperform work at some level of reduced capability.</span></span> <span data-ttu-id="e57df-120">Par exemple, un système qui peut envoyer des messages mais pas de les recevoir peut encore recevoir des commandes des clients, mais ne peut pas traiter ces commandes.</span><span class="sxs-lookup"><span data-stu-id="e57df-120">For example, a system that can send messages but not receive them can still receive orders from customers but cannot process those orders.</span></span> <span data-ttu-id="e57df-121">Cette rubrique aborde les problèmes qui peuvent se présenter et explique comment y remédier.</span><span class="sxs-lookup"><span data-stu-id="e57df-121">This topic discusses potential issues that can occur, and how those issues are mitigated.</span></span> <span data-ttu-id="e57df-122">Service Bus a introduit un certain nombre de solutions d’atténuation, vous devez adopter, et cette rubrique traite également hello règles régissant hello utilisent ces solutions d’atténuation de participer.</span><span class="sxs-lookup"><span data-stu-id="e57df-122">Service Bus has introduced a number of mitigations which you must opt into, and this topic also discusses hello rules governing hello use of those opt-in mitigations.</span></span>

## <a name="reliability-in-service-bus"></a><span data-ttu-id="e57df-123">Fiabilité de Service Bus</span><span class="sxs-lookup"><span data-stu-id="e57df-123">Reliability in Service Bus</span></span>
<span data-ttu-id="e57df-124">Il existe plusieurs façons de problèmes de messages et d’entités toohandle et des instructions gouvernent l’utilisation appropriée de hello de ces solutions d’atténuation.</span><span class="sxs-lookup"><span data-stu-id="e57df-124">There are several ways toohandle message and entity issues, and there are guidelines governing hello appropriate use of those mitigations.</span></span> <span data-ttu-id="e57df-125">les instructions hello toounderstand, vous devez d’abord comprendre ce que peut échouer dans Service Bus.</span><span class="sxs-lookup"><span data-stu-id="e57df-125">toounderstand hello guidelines, you must first understand what can fail in Service Bus.</span></span> <span data-ttu-id="e57df-126">En raison de la conception toohello des systèmes Azure, tous ces problèmes ont tendance à courte durée de vie de toobe.</span><span class="sxs-lookup"><span data-stu-id="e57df-126">Due toohello design of Azure systems, all of these issues tend toobe short-lived.</span></span> <span data-ttu-id="e57df-127">À un niveau élevé, hello différentes causes d’indisponibilité apparaissent comme suit :</span><span class="sxs-lookup"><span data-stu-id="e57df-127">At a high level, hello different causes of unavailability appear as follows:</span></span>

* <span data-ttu-id="e57df-128">Limitation d’un système externe dont Service Bus dépend.</span><span class="sxs-lookup"><span data-stu-id="e57df-128">Throttling from an external system on which Service Bus depends.</span></span> <span data-ttu-id="e57df-129">La limitation se produit à la suite d’interactions avec les ressources de stockage et de calcul.</span><span class="sxs-lookup"><span data-stu-id="e57df-129">Throttling occurs from interactions with storage and compute resources.</span></span>
* <span data-ttu-id="e57df-130">Problème d’un système dont Service Bus dépend.</span><span class="sxs-lookup"><span data-stu-id="e57df-130">Issue for a system on which Service Bus depends.</span></span> <span data-ttu-id="e57df-131">Par exemple, une partie donnée du stockage peut rencontrer des problèmes.</span><span class="sxs-lookup"><span data-stu-id="e57df-131">For example, a given part of storage can encounter issues.</span></span>
* <span data-ttu-id="e57df-132">Défaillance de Service Bus dans un sous-système unique</span><span class="sxs-lookup"><span data-stu-id="e57df-132">Failure of Service Bus on single subsystem.</span></span> <span data-ttu-id="e57df-133">Dans ce cas, un nœud de calcul peut entrer dans un état incohérent et qu’il doit être redémarré, à l’origine de toutes les entités son solde de tooload tooother nœuds.</span><span class="sxs-lookup"><span data-stu-id="e57df-133">In this situation, a compute node can get into an inconsistent state and must restart itself, causing all entities it serves tooload balance tooother nodes.</span></span> <span data-ttu-id="e57df-134">Pendant un bref laps de temps, le traitement des messages peut se trouver ralenti.</span><span class="sxs-lookup"><span data-stu-id="e57df-134">This in turn can cause a short period of slow message processing.</span></span>
* <span data-ttu-id="e57df-135">Échec de Service Bus dans un centre de données Azure.</span><span class="sxs-lookup"><span data-stu-id="e57df-135">Failure of Service Bus within an Azure datacenter.</span></span> <span data-ttu-id="e57df-136">Il s’agit d’une défaillance grave » » au cours de laquelle hello système est injoignable minutes, voire quelques heures.</span><span class="sxs-lookup"><span data-stu-id="e57df-136">This is a "catastrophic failure" during which hello system is unreachable for many minutes or a few hours.</span></span>

> [!NOTE]
> <span data-ttu-id="e57df-137">terme de Hello **stockage** peut signifier le stockage Azure et SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="e57df-137">hello term **storage** can mean both Azure Storage and SQL Azure.</span></span>
> 
> 

<span data-ttu-id="e57df-138">Service Bus propose un certain nombre de mesures d’atténuation des problèmes mentionnés ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="e57df-138">Service Bus contains a number of mitigations for these issues.</span></span> <span data-ttu-id="e57df-139">Hello les sections suivantes décrivent chaque problème et leurs solutions d’atténuation respectives.</span><span class="sxs-lookup"><span data-stu-id="e57df-139">hello following sections discuss each issue and their respective mitigations.</span></span>

### <a name="throttling"></a><span data-ttu-id="e57df-140">Limitation</span><span class="sxs-lookup"><span data-stu-id="e57df-140">Throttling</span></span>
<span data-ttu-id="e57df-141">Avec Service Bus, la limitation permet une gestion coopérative de la vitesse des messages.</span><span class="sxs-lookup"><span data-stu-id="e57df-141">With Service Bus, throttling enables cooperative message rate management.</span></span> <span data-ttu-id="e57df-142">Chaque nœud Service Bus héberge de nombreuses entités.</span><span class="sxs-lookup"><span data-stu-id="e57df-142">Each individual Service Bus node houses many entities.</span></span> <span data-ttu-id="e57df-143">Chacune de ces entités sollicite système hello en termes de processeur, mémoire, stockage et autres facettes.</span><span class="sxs-lookup"><span data-stu-id="e57df-143">Each of those entities makes demands on hello system in terms of CPU, memory, storage, and other facets.</span></span> <span data-ttu-id="e57df-144">Lorsqu’une de ces facettes détecte une utilisation dépassant les seuils définis, Service Bus peut refuser une demande donnée.</span><span class="sxs-lookup"><span data-stu-id="e57df-144">When any of these facets detects usage that exceeds defined thresholds, Service Bus can deny a given request.</span></span> <span data-ttu-id="e57df-145">Hello appelant reçoit un [ServerBusyException] [ ServerBusyException] et de nouvelles tentatives après 10 secondes.</span><span class="sxs-lookup"><span data-stu-id="e57df-145">hello caller receives a [ServerBusyException][ServerBusyException] and retries after 10 seconds.</span></span>

<span data-ttu-id="e57df-146">Pour atténuer le problème, code de hello doit hello erreur de lecture et interrompre toute nouvelle tentative de message de type hello au moins 10 secondes.</span><span class="sxs-lookup"><span data-stu-id="e57df-146">As a mitigation, hello code must read hello error and halt any retries of hello message for at least 10 seconds.</span></span> <span data-ttu-id="e57df-147">Étant donné que l’erreur de hello peut se produire sur différents composants de l’application de client hello, il est probable que chacun s’exécute indépendamment logique de nouvelle tentative hello.</span><span class="sxs-lookup"><span data-stu-id="e57df-147">Since hello error can happen across pieces of hello customer application, it is expected that each piece independently executes hello retry logic.</span></span> <span data-ttu-id="e57df-148">code de Hello peut réduire la probabilité de hello de limitation en autorisant le partitionnement sur une file d’attente ou une rubrique.</span><span class="sxs-lookup"><span data-stu-id="e57df-148">hello code can reduce hello probability of being throttled by enabling partitioning on a queue or topic.</span></span>

### <a name="issue-for-an-azure-dependency"></a><span data-ttu-id="e57df-149">Problème sur une dépendance Azure</span><span class="sxs-lookup"><span data-stu-id="e57df-149">Issue for an Azure dependency</span></span>
<span data-ttu-id="e57df-150">D’autres composants dans Azure peuvent parfois rencontrer des problèmes de service.</span><span class="sxs-lookup"><span data-stu-id="e57df-150">Other components within Azure can occasionally have service issues.</span></span> <span data-ttu-id="e57df-151">Par exemple, lorsqu’un système Service Bus est en cours de mise à niveau, ce système peut provisoirement présenter des fonctionnalités réduites.</span><span class="sxs-lookup"><span data-stu-id="e57df-151">For example, when a system that Service Bus uses is being upgraded, that system can temporarily experience reduced capabilities.</span></span> <span data-ttu-id="e57df-152">toowork autour de ces types de problèmes, Service Bus régulièrement examine et implémente des solutions d’atténuation.</span><span class="sxs-lookup"><span data-stu-id="e57df-152">toowork around these types of issues, Service Bus regularly investigates and implements mitigations.</span></span> <span data-ttu-id="e57df-153">Des effets secondaires de ces mesures de correction peuvent apparaître.</span><span class="sxs-lookup"><span data-stu-id="e57df-153">Side effects of these mitigations do appear.</span></span> <span data-ttu-id="e57df-154">Par exemple, toohandle temporaire problèmes de stockage, Service Bus implémente un système qui permet de manière cohérente toowork d’opérations d’envoi message.</span><span class="sxs-lookup"><span data-stu-id="e57df-154">For example, toohandle transient issues with storage, Service Bus implements a system that allows message send operations toowork consistently.</span></span> <span data-ttu-id="e57df-155">En raison de la nature toohello d’atténuation de hello, un message envoyé peut occuper tooappear minutes de too15 dans la file d’attente hello affecté ou d’un abonnement et est prêt pour une opération de réception.</span><span class="sxs-lookup"><span data-stu-id="e57df-155">Due toohello nature of hello mitigation, a sent message can take up too15 minutes tooappear in hello affected queue or subscription and be ready for a receive operation.</span></span> <span data-ttu-id="e57df-156">En règle générale, la plupart des entités ne rencontrent pas ce problème.</span><span class="sxs-lookup"><span data-stu-id="e57df-156">Generally speaking, most entities will not experience this issue.</span></span> <span data-ttu-id="e57df-157">Toutefois, étant donné nombre hello d’entités dans le Service Bus dans Azure, cette solution d’atténuation est parfois nécessaire pour un petit sous-ensemble de clients de Service Bus.</span><span class="sxs-lookup"><span data-stu-id="e57df-157">However, given hello number of entities in Service Bus within Azure, this mitigation is sometimes needed for a small subset of Service Bus customers.</span></span>

### <a name="service-bus-failure-on-a-single-subsystem"></a><span data-ttu-id="e57df-158">Défaillance Service Bus dans un sous-système unique</span><span class="sxs-lookup"><span data-stu-id="e57df-158">Service Bus failure on a single subsystem</span></span>
<span data-ttu-id="e57df-159">Avec n’importe quelle application, les circonstances peuvent entraîner un composant interne de toobecome Service Bus incohérent.</span><span class="sxs-lookup"><span data-stu-id="e57df-159">With any application, circumstances can cause an internal component of Service Bus toobecome inconsistent.</span></span> <span data-ttu-id="e57df-160">Lorsque le Service Bus détecte, il collecte les données à partir de tooaid d’application hello pour diagnostiquer ce qui est arrivé.</span><span class="sxs-lookup"><span data-stu-id="e57df-160">When Service Bus detects this, it collects data from hello application tooaid in diagnosing what happened.</span></span> <span data-ttu-id="e57df-161">Une fois la collecte des données de hello, application hello est redémarré dans une tentative tooreturn tooa un état cohérent.</span><span class="sxs-lookup"><span data-stu-id="e57df-161">Once hello data is collected, hello application is restarted in an attempt tooreturn it tooa consistent state.</span></span> <span data-ttu-id="e57df-162">Ce processus se produit assez rapidement et résultats dans une entité toobe non disponible pour les tooa quelques minutes, si classique temps d’inactivité sont beaucoup plus courtes.</span><span class="sxs-lookup"><span data-stu-id="e57df-162">This process happens fairly quickly, and results in an entity appearing toobe unavailable for up tooa few minutes, though typical down times are much shorter.</span></span>

<span data-ttu-id="e57df-163">Dans ce cas, génère l’application cliente de hello un [System.TimeoutException] [ System.TimeoutException] ou [MessagingException] [ MessagingException] exception.</span><span class="sxs-lookup"><span data-stu-id="e57df-163">In these cases, hello client application generates a [System.TimeoutException][System.TimeoutException] or [MessagingException][MessagingException] exception.</span></span> <span data-ttu-id="e57df-164">Bus de service contient une atténuation pour ce problème dans l’écran hello de logique de nouvelle tentative automatisé des clients.</span><span class="sxs-lookup"><span data-stu-id="e57df-164">Service Bus contains a mitigation for this issue in hello form of automated client retry logic.</span></span> <span data-ttu-id="e57df-165">Une fois hello issue du délai de nouvelle tentative et le message de type hello n’est pas remis, vous pouvez Explorer à l’aide d’autres fonctionnalités telles que [associés des espaces de noms][paired namespaces].</span><span class="sxs-lookup"><span data-stu-id="e57df-165">Once hello retry period is exhausted and hello message is not delivered, you can explore using other features such as [paired namespaces][paired namespaces].</span></span> <span data-ttu-id="e57df-166">Les espaces de noms associés génèrent d’autres notifications, qui sont abordées dans cet article.</span><span class="sxs-lookup"><span data-stu-id="e57df-166">Paired namespaces have other caveats that are discussed in that article.</span></span>

### <a name="failure-of-service-bus-within-an-azure-datacenter"></a><span data-ttu-id="e57df-167">Panne de Service Bus dans un centre de données Azure.</span><span class="sxs-lookup"><span data-stu-id="e57df-167">Failure of Service Bus within an Azure datacenter</span></span>
<span data-ttu-id="e57df-168">Hello sont généralement dues d’une défaillance dans un centre de données Azure d’échec du déploiement mise à niveau de Service Bus ou un système qui en dépend.</span><span class="sxs-lookup"><span data-stu-id="e57df-168">hello most probable reason for a failure in an Azure datacenter is a failed upgrade deployment of Service Bus or a dependent system.</span></span> <span data-ttu-id="e57df-169">Plateforme de hello car a évolué, probabilité hello de ce type de défaillance a diminué.</span><span class="sxs-lookup"><span data-stu-id="e57df-169">As hello platform has matured, hello likelihood of this type of failure has diminished.</span></span> <span data-ttu-id="e57df-170">Un centre de données peut également se produire pour les raisons sont hello suivantes :</span><span class="sxs-lookup"><span data-stu-id="e57df-170">A datacenter failure can also happen for reasons that include hello following:</span></span>

* <span data-ttu-id="e57df-171">Panne électrique (l’alimentation électrique et les générateurs de courant sont interrompus).</span><span class="sxs-lookup"><span data-stu-id="e57df-171">Electrical outage (power supply and generating power disappear).</span></span>
* <span data-ttu-id="e57df-172">Connectivité (interruption d’Internet entre vos clients et Azure).</span><span class="sxs-lookup"><span data-stu-id="e57df-172">Connectivity (internet break between your clients and Azure).</span></span>

<span data-ttu-id="e57df-173">Dans les deux cas, une catastrophe naturelle ou humaine a provoqué le problème de hello.</span><span class="sxs-lookup"><span data-stu-id="e57df-173">In both cases, a natural or man-made disaster caused hello issue.</span></span> <span data-ttu-id="e57df-174">toowork contourner ce problème et vous assurer que vous pouvez toujours envoyer des messages, vous pouvez utiliser [associés des espaces de noms] [ paired namespaces] tooenable toobe envoyé tooa deuxième emplacement des messages lors de l’emplacement principal de hello redevient sain.</span><span class="sxs-lookup"><span data-stu-id="e57df-174">toowork around this and make sure that you can still send messages, you can use [paired namespaces][paired namespaces] tooenable messages toobe sent tooa second location while hello primary location is made healthy again.</span></span> <span data-ttu-id="e57df-175">Pour plus d’informations, consultez la section [Meilleures pratiques pour protéger les applications contre les pannes de Service Bus et les sinistres][Best practices for insulating applications against Service Bus outages and disasters].</span><span class="sxs-lookup"><span data-stu-id="e57df-175">For more information, see [Best practices for insulating applications against Service Bus outages and disasters][Best practices for insulating applications against Service Bus outages and disasters].</span></span>

## <a name="paired-namespaces"></a><span data-ttu-id="e57df-176">Espaces de noms associés</span><span class="sxs-lookup"><span data-stu-id="e57df-176">Paired namespaces</span></span>
<span data-ttu-id="e57df-177">Hello [associés des espaces de noms] [ paired namespaces] fonctionnalité prend en charge les scénarios dans lesquels un déploiement dans un centre de données ou une entité de Service Bus n’est plus disponible.</span><span class="sxs-lookup"><span data-stu-id="e57df-177">hello [paired namespaces][paired namespaces] feature supports scenarios in which a Service Bus entity or deployment within a data center becomes unavailable.</span></span> <span data-ttu-id="e57df-178">Alors que cet événement se produit rarement, les systèmes distribués toujours doivent être préparées toohandle pire des scénarios.</span><span class="sxs-lookup"><span data-stu-id="e57df-178">While this event occurs infrequently, distributed systems still must be prepared toohandle worst case scenarios.</span></span> <span data-ttu-id="e57df-179">En règle générale, cet événement se produit lorsque certains éléments dont dépend Service Bus rencontrent un problème de courte durée.</span><span class="sxs-lookup"><span data-stu-id="e57df-179">Typically, this event happens because some element on which Service Bus depends is experiencing a short-term issue.</span></span> <span data-ttu-id="e57df-180">disponibilité des applications toomaintain pendant la panne, les utilisateurs du Bus de Service peuvent utiliser des deux espaces de noms distincts, de préférence dans des centres de données distincts, toohost leurs entités de messagerie.</span><span class="sxs-lookup"><span data-stu-id="e57df-180">toomaintain application availability during an outage, Service Bus users can use two separate namespaces, preferably in separate data centers, toohost their messaging entities.</span></span> <span data-ttu-id="e57df-181">reste Hello de cette section utilise hello suivant la terminologie :</span><span class="sxs-lookup"><span data-stu-id="e57df-181">hello remainder of this section uses hello following terminology:</span></span>

* <span data-ttu-id="e57df-182">Espace de noms principal : hello d’espace de noms avec lequel votre application interagit pour envoyer et recevoir des opérations.</span><span class="sxs-lookup"><span data-stu-id="e57df-182">Primary namespace: hello namespace with which your application interacts, for send and receive operations.</span></span>
* <span data-ttu-id="e57df-183">Espace de noms secondaire : hello d’espace de noms qui agit comme un espace de noms principal toohello de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="e57df-183">Secondary namespace: hello namespace that acts as a backup toohello primary namespace.</span></span> <span data-ttu-id="e57df-184">La logique d’application n’interagit pas avec cet espace de noms.</span><span class="sxs-lookup"><span data-stu-id="e57df-184">Application logic does not interact with this namespace.</span></span>
* <span data-ttu-id="e57df-185">Intervalle de basculement : quantité de hello de temps tooaccept normal d’échecs avant application hello bascule de hello espace de noms principal toohello espace de noms secondaire.</span><span class="sxs-lookup"><span data-stu-id="e57df-185">Failover interval: hello amount of time tooaccept normal failures before hello application switches from hello primary namespace toohello secondary namespace.</span></span>

<span data-ttu-id="e57df-186">Les espaces de noms associés prennent en charge la *disponibilité des fonctions d’envoi*.</span><span class="sxs-lookup"><span data-stu-id="e57df-186">Paired namespaces support *send availability*.</span></span> <span data-ttu-id="e57df-187">Disponibilité conserve les messages toosend hello possibilité d’envoi.</span><span class="sxs-lookup"><span data-stu-id="e57df-187">Send availability preserves hello ability toosend messages.</span></span> <span data-ttu-id="e57df-188">disponibilité d’envoi toouse, votre application doit répondre aux hello suivant les exigences :</span><span class="sxs-lookup"><span data-stu-id="e57df-188">toouse send availability, your application must meet hello following requirements:</span></span>

1. <span data-ttu-id="e57df-189">Les messages sont reçus uniquement à partir de l’espace de noms principal hello.</span><span class="sxs-lookup"><span data-stu-id="e57df-189">Messages are only received from hello primary namespace.</span></span>
2. <span data-ttu-id="e57df-190">Tooa de messages envoyés étant donné la file d’attente ou rubrique peut-être arriver dans le désordre.</span><span class="sxs-lookup"><span data-stu-id="e57df-190">Messages sent tooa given queue or topic might arrive out of order.</span></span>
3. <span data-ttu-id="e57df-191">Les messages au sein d’une session peuvent arriver dans le désordre.</span><span class="sxs-lookup"><span data-stu-id="e57df-191">Messages within a session might arrive out of order.</span></span> <span data-ttu-id="e57df-192">Ce comportement diffère du comportement normal des sessions.</span><span class="sxs-lookup"><span data-stu-id="e57df-192">This is a break from normal functionality of sessions.</span></span> <span data-ttu-id="e57df-193">Cela signifie que votre application utilise des messages de groupe de toologically de sessions.</span><span class="sxs-lookup"><span data-stu-id="e57df-193">This means that your application uses sessions toologically group messages.</span></span>
4. <span data-ttu-id="e57df-194">État de session est conservé uniquement sur l’espace de noms principal hello.</span><span class="sxs-lookup"><span data-stu-id="e57df-194">Session state is only maintained on hello primary namespace.</span></span>
5. <span data-ttu-id="e57df-195">file d’attente principale de Hello permettre se mettre en ligne et commencer à accepter des messages avant de la file d’attente secondaire de hello remet tous les messages en file d’attente principale de hello.</span><span class="sxs-lookup"><span data-stu-id="e57df-195">hello primary queue can come online and start accepting messages before hello secondary queue delivers all messages into hello primary queue.</span></span>

<span data-ttu-id="e57df-196">Hello les sections suivantes abordent hello API, comment hello API sont implémentés et montre exemple de code qui utilise la fonctionnalité de hello.</span><span class="sxs-lookup"><span data-stu-id="e57df-196">hello following sections discuss hello APIs, how hello APIs are implemented, and shows sample code that uses hello feature.</span></span> <span data-ttu-id="e57df-197">Notez que cette fonctionnalité est associée à des coûts.</span><span class="sxs-lookup"><span data-stu-id="e57df-197">Note that there are billing implications associated with this feature.</span></span>

### <a name="hello-messagingfactorypairnamespaceasync-api"></a><span data-ttu-id="e57df-198">Hello les API MessagingFactory.PairNamespaceAsync</span><span class="sxs-lookup"><span data-stu-id="e57df-198">hello MessagingFactory.PairNamespaceAsync API</span></span>
<span data-ttu-id="e57df-199">fonctionnalité des espaces de noms appariés Hello inclut hello [PairNamespaceAsync] [ PairNamespaceAsync] méthode sur hello [Microsoft.ServiceBus.Messaging.MessagingFactory] [ Microsoft.ServiceBus.Messaging.MessagingFactory] classe :</span><span class="sxs-lookup"><span data-stu-id="e57df-199">hello paired namespaces feature includes hello [PairNamespaceAsync][PairNamespaceAsync] method on hello [Microsoft.ServiceBus.Messaging.MessagingFactory][Microsoft.ServiceBus.Messaging.MessagingFactory] class:</span></span>

```csharp
public Task PairNamespaceAsync(PairedNamespaceOptions options);
```

<span data-ttu-id="e57df-200">Lors de la fin de la tâche hello, hello appariement d’espace de noms est également tooact terminé et prêt à pour toute [MessageReceiver][MessageReceiver], [QueueClient] [ QueueClient], ou [TopicClient] [ TopicClient] créé par hello [MessagingFactory] [ MessagingFactory] instance.</span><span class="sxs-lookup"><span data-stu-id="e57df-200">When hello task completes, hello namespace pairing is also complete and ready tooact upon for any [MessageReceiver][MessageReceiver], [QueueClient][QueueClient], or [TopicClient][TopicClient] created with hello [MessagingFactory][MessagingFactory] instance.</span></span> <span data-ttu-id="e57df-201">[Microsoft.ServiceBus.Messaging.PairedNamespaceOptions] [ Microsoft.ServiceBus.Messaging.PairedNamespaceOptions] est la classe de base hello pour hello différents types de correspondance qui sont disponibles avec un [MessagingFactory] [ MessagingFactory] objet.</span><span class="sxs-lookup"><span data-stu-id="e57df-201">[Microsoft.ServiceBus.Messaging.PairedNamespaceOptions][Microsoft.ServiceBus.Messaging.PairedNamespaceOptions] is hello base class for hello different types of pairing that are available with a [MessagingFactory][MessagingFactory] object.</span></span> <span data-ttu-id="e57df-202">Actuellement, hello uniquement de la classe dérivée est un nommé [SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions], qui implémente les exigences de disponibilité d’envoi hello.</span><span class="sxs-lookup"><span data-stu-id="e57df-202">Currently, hello only derived class is one named [SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions], which implements hello send availability requirements.</span></span> <span data-ttu-id="e57df-203">[SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions] possède un ensemble de constructeurs qui s’appuient les uns sur les autres.</span><span class="sxs-lookup"><span data-stu-id="e57df-203">[SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions] has a set of constructors that build on each other.</span></span> <span data-ttu-id="e57df-204">En examinant les constructeur hello avec hello la plupart des paramètres, vous pouvez comprendre comportement hello Hello autres constructeurs.</span><span class="sxs-lookup"><span data-stu-id="e57df-204">Looking at hello constructor with hello most parameters, you can understand hello behavior of hello other constructors.</span></span>

```csharp
public SendAvailabilityPairedNamespaceOptions(
    NamespaceManager secondaryNamespaceManager,
    MessagingFactory messagingFactory,
    int backlogQueueCount,
    TimeSpan failoverInterval,
    bool enableSyphon)
```

<span data-ttu-id="e57df-205">Ces paramètres ont hello suivant significations :</span><span class="sxs-lookup"><span data-stu-id="e57df-205">These parameters have hello following meanings:</span></span>

* <span data-ttu-id="e57df-206">*secondaryNamespaceManager*: initialisé [NamespaceManager] [ NamespaceManager] de l’instance de l’espace de noms secondaire hello que hello [PairNamespaceAsync] [ PairNamespaceAsync] méthode peut utiliser tooset hello espace de noms secondaire.</span><span class="sxs-lookup"><span data-stu-id="e57df-206">*secondaryNamespaceManager*: An initialized [NamespaceManager][NamespaceManager] instance for hello secondary namespace that hello [PairNamespaceAsync][PairNamespaceAsync] method can use tooset up hello secondary namespace.</span></span> <span data-ttu-id="e57df-207">Gestionnaire d’espace de noms Hello est liste de hello tooobtain utilisés de files d’attente dans l’espace de noms hello et toomake que les files d’attente du backlog hello requis existent.</span><span class="sxs-lookup"><span data-stu-id="e57df-207">hello namespace manager is used tooobtain hello list of queues in hello namespace and toomake sure that hello required backlog queues exist.</span></span> <span data-ttu-id="e57df-208">Si ce n’est pas le cas, ces files d’attente sont créées.</span><span class="sxs-lookup"><span data-stu-id="e57df-208">If those queues do not exist, they are created.</span></span> <span data-ttu-id="e57df-209">[NamespaceManager] [ NamespaceManager] requiert hello capacité toocreate un jeton avec hello **gérer** de revendication.</span><span class="sxs-lookup"><span data-stu-id="e57df-209">[NamespaceManager][NamespaceManager] requires hello ability toocreate a token with hello **Manage** claim.</span></span>
* <span data-ttu-id="e57df-210">*messagingFactory*: hello [MessagingFactory] [ MessagingFactory] instance pour l’espace de noms secondaire hello.</span><span class="sxs-lookup"><span data-stu-id="e57df-210">*messagingFactory*: hello [MessagingFactory][MessagingFactory] instance for hello secondary namespace.</span></span> <span data-ttu-id="e57df-211">Hello [MessagingFactory] [ MessagingFactory] objet est toosend utilisé et, si hello [EnableSyphon] [ EnableSyphon] propriété a la valeur trop**true** , recevoir des messages des files d’attente du backlog hello.</span><span class="sxs-lookup"><span data-stu-id="e57df-211">hello [MessagingFactory][MessagingFactory] object is used toosend and, if hello [EnableSyphon][EnableSyphon] property is set too**true**, receive messages from hello backlog queues.</span></span>
* <span data-ttu-id="e57df-212">*backlogQueueCount*: nombre de hello de file d’attente toocreate des files d’attente.</span><span class="sxs-lookup"><span data-stu-id="e57df-212">*backlogQueueCount*: hello number of backlog queues toocreate.</span></span> <span data-ttu-id="e57df-213">La valeur doit être au moins à 1.</span><span class="sxs-lookup"><span data-stu-id="e57df-213">This value must be at least 1.</span></span> <span data-ttu-id="e57df-214">Lors de l’envoi du backlog de messages toohello, une de ces files d’attente est choisie de manière aléatoire.</span><span class="sxs-lookup"><span data-stu-id="e57df-214">When sending messages toohello backlog, one of these queues is randomly chosen.</span></span> <span data-ttu-id="e57df-215">Si vous définissez hello valeur too1, seule file d’attente peut déjà utilisé.</span><span class="sxs-lookup"><span data-stu-id="e57df-215">If you set hello value too1, then only one queue can ever be used.</span></span> <span data-ttu-id="e57df-216">Lorsque cela se produit et hello une file d’attente génère des erreurs, client de hello n’est pas en mesure de tootry une autre file d’attente et peut échouer toosend votre message.</span><span class="sxs-lookup"><span data-stu-id="e57df-216">When this happens and hello one backlog queue generates errors, hello client is not able tootry a different backlog queue and may fail toosend your message.</span></span> <span data-ttu-id="e57df-217">Nous vous recommandons de définir cette valeur toosome plus grande valeur et par défaut hello valeur too10.</span><span class="sxs-lookup"><span data-stu-id="e57df-217">We recommend setting this value toosome larger value and default hello value too10.</span></span> <span data-ttu-id="e57df-218">Vous pouvez modifier cette tooa supérieur ou inférieur en fonction de la quantité de données votre application envoie par jour.</span><span class="sxs-lookup"><span data-stu-id="e57df-218">You can change this tooa higher or lower value depending on how much data your application sends per day.</span></span> <span data-ttu-id="e57df-219">Chaque file d’attente peut contenir jusqu'à Go too5 de messages.</span><span class="sxs-lookup"><span data-stu-id="e57df-219">Each backlog queue can hold up too5 GB of messages.</span></span>
* <span data-ttu-id="e57df-220">*failoverInterval*: durée hello au cours de laquelle vous acceptez les échecs sur l’espace de noms principal hello avant de passer d’une entité unique sur l’espace de noms secondaire toohello.</span><span class="sxs-lookup"><span data-stu-id="e57df-220">*failoverInterval*: hello amount of time during which you will accept failures on hello primary namespace before switching any single entity over toohello secondary namespace.</span></span> <span data-ttu-id="e57df-221">Les basculements se produisent sur la base entité par entité.</span><span class="sxs-lookup"><span data-stu-id="e57df-221">Failovers occur on an entity-by-entity basis.</span></span> <span data-ttu-id="e57df-222">Les entités dans un espace de noms unique résident fréquemment sur différents nœuds au sein de Service Bus.</span><span class="sxs-lookup"><span data-stu-id="e57df-222">Entities in a single namespace frequently live in different nodes within Service Bus.</span></span> <span data-ttu-id="e57df-223">La défaillance d’une entité n’implique pas nécessairement la défaillance d’une autre.</span><span class="sxs-lookup"><span data-stu-id="e57df-223">A failure in one entity does not imply a failure in another.</span></span> <span data-ttu-id="e57df-224">Vous pouvez définir cette valeur trop[System.TimeSpan.Zero] [ System.TimeSpan.Zero] toohello toofailover secondaire immédiatement après votre première défaillance non transitoire.</span><span class="sxs-lookup"><span data-stu-id="e57df-224">You can set this value too[System.TimeSpan.Zero][System.TimeSpan.Zero] toofailover toohello secondary immediately after your first, non-transient failure.</span></span> <span data-ttu-id="e57df-225">Les défaillances qui déclenchent le minuteur de basculement hello sont les [MessagingException] [ MessagingException] les Bonjour [IsTransient] [ IsTransient] propriété est false, ou un [System.TimeoutException][System.TimeoutException].</span><span class="sxs-lookup"><span data-stu-id="e57df-225">Failures that trigger hello failover timer are any [MessagingException][MessagingException] in which hello [IsTransient][IsTransient] property is false, or a [System.TimeoutException][System.TimeoutException].</span></span> <span data-ttu-id="e57df-226">D’autres exceptions, telles que [UnauthorizedAccessException] [ UnauthorizedAccessException] ne provoquent pas de basculement, car ils indiquent que le client hello est incorrecte.</span><span class="sxs-lookup"><span data-stu-id="e57df-226">Other exceptions, such as [UnauthorizedAccessException][UnauthorizedAccessException] do not cause failover, because they indicate that hello client is configured incorrectly.</span></span> <span data-ttu-id="e57df-227">A [ServerBusyException] [ ServerBusyException] n’entraîne pas de basculement, car le modèle correct de hello est toowait 10 secondes, puis renvoyez message de type hello.</span><span class="sxs-lookup"><span data-stu-id="e57df-227">A [ServerBusyException][ServerBusyException] does not cause failover because hello correct pattern is toowait 10 seconds, then send hello message again.</span></span>
* <span data-ttu-id="e57df-228">*enableSyphon*: indique que cet appariement doit également transférer les messages hello espace de noms secondaire toohello précédent espace de noms principal.</span><span class="sxs-lookup"><span data-stu-id="e57df-228">*enableSyphon*: Indicates that this particular pairing should also syphon messages from hello secondary namespace back toohello primary namespace.</span></span> <span data-ttu-id="e57df-229">En règle générale, les applications qui envoient des messages doivent définir cette valeur trop**false**; les applications qui reçoivent des messages doivent définir cette valeur trop**true**.</span><span class="sxs-lookup"><span data-stu-id="e57df-229">In general, applications that send messages should set this value too**false**; applications that receive messages should set this value too**true**.</span></span> <span data-ttu-id="e57df-230">raison Hello est que souvent, il existe moins destinataires expéditeurs de messages.</span><span class="sxs-lookup"><span data-stu-id="e57df-230">hello reason for this is that frequently, there are fewer message receivers than message senders.</span></span> <span data-ttu-id="e57df-231">En fonction du nombre de hello de destinataires, vous pouvez choisir toohave un droits SIPHON hello de handle d’instance application unique.</span><span class="sxs-lookup"><span data-stu-id="e57df-231">Depending on hello number of receivers, you can choose toohave a single application instance handle hello syphon duties.</span></span> <span data-ttu-id="e57df-232">L’utilisation de nombreux destinataires a un coût pour chaque file d’attente backlog.</span><span class="sxs-lookup"><span data-stu-id="e57df-232">Using many receivers has billing implications for each backlog queue.</span></span>

<span data-ttu-id="e57df-233">toouse hello du code, créez un principal [MessagingFactory] [ MessagingFactory] de l’instance, une base de données secondaire [MessagingFactory] [ MessagingFactory] de l’instance, une base de données secondaire [NamespaceManager] [ NamespaceManager] instance et un [SendAvailabilityPairedNamespaceOptions] [ SendAvailabilityPairedNamespaceOptions] instance.</span><span class="sxs-lookup"><span data-stu-id="e57df-233">toouse hello code, create a primary [MessagingFactory][MessagingFactory] instance, a secondary [MessagingFactory][MessagingFactory] instance, a secondary [NamespaceManager][NamespaceManager] instance, and a [SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions] instance.</span></span> <span data-ttu-id="e57df-234">appel de Hello peut être aussi simple que suivant de hello :</span><span class="sxs-lookup"><span data-stu-id="e57df-234">hello call can be as simple as hello following:</span></span>

```csharp
SendAvailabilityPairedNamespaceOptions sendAvailabilityOptions = new SendAvailabilityPairedNamespaceOptions(secondaryNamespaceManager, secondary);
primary.PairNamespaceAsync(sendAvailabilityOptions).Wait();
```

<span data-ttu-id="e57df-235">Lorsque hello tâche retournée par hello [PairNamespaceAsync] [ PairNamespaceAsync] méthode se termine, tout est configuré et prêt toouse.</span><span class="sxs-lookup"><span data-stu-id="e57df-235">When hello task returned by hello [PairNamespaceAsync][PairNamespaceAsync] method completes, everything is set up and ready toouse.</span></span> <span data-ttu-id="e57df-236">Avant de la tâche hello est retournée, ne peut pas avoir tout travail d’arrière-plan hello nécessaire pour hello appariement toowork droite.</span><span class="sxs-lookup"><span data-stu-id="e57df-236">Before hello task is returned, you may not have completed all of hello background work necessary for hello pairing toowork right.</span></span> <span data-ttu-id="e57df-237">Par conséquent, vous ne devez pas commencer l’envoi de messages jusqu'à ce que la tâche hello retourne.</span><span class="sxs-lookup"><span data-stu-id="e57df-237">As a result, you should not start sending messages until hello task returns.</span></span> <span data-ttu-id="e57df-238">Si les échecs se sont produits, telles que les informations d’identification incorrectes ou les files d’attente de défaillance toocreate hello du backlog, ces exceptions seront levées une fois la tâche hello terminée.</span><span class="sxs-lookup"><span data-stu-id="e57df-238">If any failures occurred, such as bad credentials, or failure toocreate hello backlog queues, those exceptions will be thrown once hello task completes.</span></span> <span data-ttu-id="e57df-239">Une fois la tâche hello est retournée, vérifiez que les files d’attente hello ont été trouvés ou créées en examinant hello [BacklogQueueCount] [ BacklogQueueCount] propriété sur votre [SendAvailabilityPairedNamespaceOptions] [ SendAvailabilityPairedNamespaceOptions] instance.</span><span class="sxs-lookup"><span data-stu-id="e57df-239">Once hello task returns, verify that hello queues were found or created by examining hello [BacklogQueueCount][BacklogQueueCount] property on your [SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions] instance.</span></span> <span data-ttu-id="e57df-240">Pourquoi précédant le code, cette opération apparaît comme suit :</span><span class="sxs-lookup"><span data-stu-id="e57df-240">For hello preceding code, that operation appears as follows:</span></span>

```csharp
if (sendAvailabilityOptions.BacklogQueueCount < 1)
{
    // Handle case where no queues were created.
}
```

## <a name="next-steps"></a><span data-ttu-id="e57df-241">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="e57df-241">Next steps</span></span>
<span data-ttu-id="e57df-242">Maintenant que vous avez appris les notions de base de hello de la messagerie asynchrone dans le Bus de Service, en savoir plus sur [associés des espaces de noms][paired namespaces].</span><span class="sxs-lookup"><span data-stu-id="e57df-242">Now that you've learned hello basics of asynchronous messaging in Service Bus, read more details about [paired namespaces][paired namespaces].</span></span>

[ServerBusyException]: /dotnet/api/microsoft.servicebus.messaging.serverbusyexception
[System.TimeoutException]: https://msdn.microsoft.com/library/system.timeoutexception.aspx
[MessagingException]: /dotnet/api/microsoft.servicebus.messaging.messagingexception
[Best practices for insulating applications against Service Bus outages and disasters]: service-bus-outages-disasters.md
[Microsoft.ServiceBus.Messaging.MessagingFactory]: /dotnet/api/microsoft.servicebus.messaging.messagingfactory
[MessageReceiver]: /dotnet/api/microsoft.servicebus.messaging.messagereceiver
[QueueClient]: /dotnet/api/microsoft.servicebus.messaging.queueclient
[TopicClient]: /dotnet/api/microsoft.servicebus.messaging.topicclient
[Microsoft.ServiceBus.Messaging.PairedNamespaceOptions]: /dotnet/api/microsoft.servicebus.messaging.pairednamespaceoptions
[MessagingFactory]: /dotnet/api/microsoft.servicebus.messaging.messagingfactory
[SendAvailabilityPairedNamespaceOptions]: /dotnet/api/microsoft.servicebus.messaging.sendavailabilitypairednamespaceoptions
[NamespaceManager]: /dotnet/api/microsoft.servicebus.namespacemanager
[PairNamespaceAsync]: /dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_PairNamespaceAsync_Microsoft_ServiceBus_Messaging_PairedNamespaceOptions_
[EnableSyphon]: /dotnet/api/microsoft.servicebus.messaging.sendavailabilitypairednamespaceoptions#Microsoft_ServiceBus_Messaging_SendAvailabilityPairedNamespaceOptions_EnableSyphon
[System.TimeSpan.Zero]: https://msdn.microsoft.com/library/system.timespan.zero.aspx
[IsTransient]: /dotnet/api/microsoft.servicebus.messaging.messagingexception#Microsoft_ServiceBus_Messaging_MessagingException_IsTransient
[UnauthorizedAccessException]: https://msdn.microsoft.com/library/system.unauthorizedaccessexception.aspx
[BacklogQueueCount]: /dotnet/api/microsoft.servicebus.messaging.sendavailabilitypairednamespaceoptions?redirectedfrom=MSDN#Microsoft_ServiceBus_Messaging_SendAvailabilityPairedNamespaceOptions_BacklogQueueCount
[paired namespaces]: service-bus-paired-namespaces.md
