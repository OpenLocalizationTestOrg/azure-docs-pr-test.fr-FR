---
title: "Créer des rubriques et des files d’attente Azure Service Bus partitionnées | Microsoft Docs"
description: "Décrit comment partitionner des files d’attente et des rubriques Service Bus à l’aide de plusieurs courtiers de messages."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: a0c7d5a2-4876-42cb-8344-a1fc988746e7
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 08/07/2017
ms.author: sethm;hillaryc
ms.openlocfilehash: 5a4e69ea7e13cb017f8fb432c524c6a8ce9228a8
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/18/2017
---
# <a name="partitioned-queues-and-topics"></a><span data-ttu-id="46803-103">Files d’attente et rubriques partitionnées</span><span class="sxs-lookup"><span data-stu-id="46803-103">Partitioned queues and topics</span></span>
<span data-ttu-id="46803-104">Azure Service Bus utilise plusieurs courtiers de messages pour traiter les messages et plusieurs banques de messagerie pour stocker les messages.</span><span class="sxs-lookup"><span data-stu-id="46803-104">Azure Service Bus employs multiple message brokers to process messages and multiple messaging stores to store messages.</span></span> <span data-ttu-id="46803-105">Une file d’attente ou une rubrique classique est gérée par un seul courtier de messages et stockée dans une seule banque de messagerie.</span><span class="sxs-lookup"><span data-stu-id="46803-105">A conventional queue or topic is handled by a single message broker and stored in one messaging store.</span></span> <span data-ttu-id="46803-106">Service Bus permet également le *partitionnement* des files d’attente et des rubriques, ou des *entités de messagerie* entre plusieurs courtiers de messages et banques de messagerie.</span><span class="sxs-lookup"><span data-stu-id="46803-106">Service Bus *partitions* enable queues and topics, or *messaging entities*, to be partitioned across multiple message brokers and messaging stores.</span></span> <span data-ttu-id="46803-107">Cela signifie que le débit global d’une entité partitionnée n’est plus limité par les performances d’un seul courtier de messages ou d’une seule banque de messagerie.</span><span class="sxs-lookup"><span data-stu-id="46803-107">This means that the overall throughput of a partitioned entity is no longer limited by the performance of a single message broker or messaging store.</span></span> <span data-ttu-id="46803-108">En outre, la panne temporaire d’une banque de messagerie ne rend pas une rubrique ou une file d’attente partitionnée indisponible.</span><span class="sxs-lookup"><span data-stu-id="46803-108">In addition, a temporary outage of a messaging store does not render a partitioned queue or topic unavailable.</span></span> <span data-ttu-id="46803-109">Les rubriques et les files d’attente partitionnées peuvent contenir toutes les fonctionnalités avancées de Service Bus, comme la prise en charge des transactions et des sessions.</span><span class="sxs-lookup"><span data-stu-id="46803-109">Partitioned queues and topics can contain all advanced Service Bus features, such as support for transactions and sessions.</span></span>

<span data-ttu-id="46803-110">Pour plus d’informations sur les éléments internes de Service Bus, consultez l’article [Architecture de Service Bus][Service Bus architecture].</span><span class="sxs-lookup"><span data-stu-id="46803-110">For information about Service Bus internals, see the [Service Bus architecture][Service Bus architecture] article.</span></span>

<span data-ttu-id="46803-111">Le partitionnement est activé par défaut lors de la création d’entités sur toutes les files d’attente et rubriques à la fois dans la messagerie Standard et Premium.</span><span class="sxs-lookup"><span data-stu-id="46803-111">Partitioning is enabled by default at entity creation on all queues and topics in both Standard and Premium messaging.</span></span> <span data-ttu-id="46803-112">Vous pouvez créer des entités de niveau de messagerie Standard sans partitionnement, mais les files d’attente et les rubriques dans un espace de noms Premium sont toujours partitionnées ; cette option ne peut pas être désactivée.</span><span class="sxs-lookup"><span data-stu-id="46803-112">You can create Standard messaging tier entities without partitioning, but queues and topics in a Premium namespace are always partitioned; this option cannot be disabled.</span></span> 

<span data-ttu-id="46803-113">Il n’est pas possible de modifier l’option de partitionnement dans une file d’attente ou une rubrique existante dans les niveaux Standard ou Premium. Vous pouvez uniquement définir l’option lorsque vous créez l’entité.</span><span class="sxs-lookup"><span data-stu-id="46803-113">It is not possible to change the partitioning option on an existing queue or topic in either Standard or Premium tiers, you can only set the option when you create the entity.</span></span>

## <a name="how-it-works"></a><span data-ttu-id="46803-114">Fonctionnement</span><span class="sxs-lookup"><span data-stu-id="46803-114">How it works</span></span>

<span data-ttu-id="46803-115">Chaque file d’attente ou rubrique partitionnée est constituée de plusieurs fragments.</span><span class="sxs-lookup"><span data-stu-id="46803-115">Each partitioned queue or topic consists of multiple fragments.</span></span> <span data-ttu-id="46803-116">Chaque fragment est stocké dans une banque de messagerie différente et géré par un courtier de messages différent.</span><span class="sxs-lookup"><span data-stu-id="46803-116">Each fragment is stored in a different messaging store and handled by a different message broker.</span></span> <span data-ttu-id="46803-117">Lorsqu’un message est envoyé à une file d’attente ou une rubrique partitionnée, Service Bus affecte le message à l’un des fragments.</span><span class="sxs-lookup"><span data-stu-id="46803-117">When a message is sent to a partitioned queue or topic, Service Bus assigns the message to one of the fragments.</span></span> <span data-ttu-id="46803-118">La sélection est effectuée au hasard par Service Bus ou à l’aide d’une clé de partition que l’expéditeur peut spécifier.</span><span class="sxs-lookup"><span data-stu-id="46803-118">The selection is done randomly by Service Bus or by using a partition key that the sender can specify.</span></span>

<span data-ttu-id="46803-119">Lorsqu’un client souhaite recevoir un message à partir d’une file d’attente partitionnée ou à partir d’un abonnement à une rubrique partitionnée, Service Bus interroge tous les fragments des messages, puis retourne le premier message qui est obtenu à partir de l’une des banques de messagerie au destinataire.</span><span class="sxs-lookup"><span data-stu-id="46803-119">When a client wants to receive a message from a partitioned queue, or from a subscription to a partitioned topic, Service Bus queries all fragments for messages, then returns the first message that is obtained from any of the messaging stores to the receiver.</span></span> <span data-ttu-id="46803-120">Service Bus place les autres messages en cache pour les retourner quand il reçoit d'autres requêtes de réception.</span><span class="sxs-lookup"><span data-stu-id="46803-120">Service Bus caches the other messages and returns them when it receives additional receive requests.</span></span> <span data-ttu-id="46803-121">Un client destinataire n’est pas conscient de ce partitionnement ; le comportement côté client d’une file d’attente ou d’une rubrique partitionnée (par exemple, lecture, exécution, report, rebut, préchargement) est identique à celui d’une entité ordinaire.</span><span class="sxs-lookup"><span data-stu-id="46803-121">A receiving client is not aware of the partitioning; the client-facing behavior of a partitioned queue or topic (for example, read, complete, defer, deadletter, prefetching) is identical to the behavior of a regular entity.</span></span>

<span data-ttu-id="46803-122">Il n’existe aucun coût supplémentaire lors de l’envoi d’un message à, ou lors de la réception d’un message depuis, une file d’attente ou une rubrique partitionnée.</span><span class="sxs-lookup"><span data-stu-id="46803-122">There is no additional cost when sending a message to, or receiving a message from, a partitioned queue or topic.</span></span>

## <a name="enable-partitioning"></a><span data-ttu-id="46803-123">Activation du partitionnement</span><span class="sxs-lookup"><span data-stu-id="46803-123">Enable partitioning</span></span>

<span data-ttu-id="46803-124">Pour utiliser des rubriques et des files d’attente partitionnées avec Azure Service Bus, utilisez le Kit de développement logiciel (SDK) Microsoft Azure version 2.2 ou version ultérieure, ou spécifiez `api-version=2013-10` dans vos requêtes HTTP.</span><span class="sxs-lookup"><span data-stu-id="46803-124">To use partitioned queues and topics with Azure Service Bus, use the Azure SDK version 2.2 or later, or specify `api-version=2013-10` in your HTTP requests.</span></span>

### <a name="standard"></a><span data-ttu-id="46803-125">Standard</span><span class="sxs-lookup"><span data-stu-id="46803-125">Standard</span></span>

<span data-ttu-id="46803-126">Dans le niveau de messagerie Standard, vous pouvez créer des files d'attente et des rubriques Service Bus avec des tailles de 1, 2, 3, 4 ou 5 Go (la valeur par défaut est 1 Go).</span><span class="sxs-lookup"><span data-stu-id="46803-126">In the Standard messaging tier, you can create Service Bus queues and topics in 1, 2, 3, 4, or 5 GB sizes (the default is 1 GB).</span></span> <span data-ttu-id="46803-127">Si le partitionnement est activé, Service Bus crée 16 copies (16 partitions) de l’entité pour chaque Go que vous spécifiez.</span><span class="sxs-lookup"><span data-stu-id="46803-127">With partitioning enabled, Service Bus creates 16 copies (16 partitions) of the entity for each GB you specify.</span></span> <span data-ttu-id="46803-128">Par conséquent, si vous créez une file d’attente de 5 Go, avec 16 partitions, la taille maximale de la file d’attente est (5 \* 16) = 80 Go.</span><span class="sxs-lookup"><span data-stu-id="46803-128">As such, if you create a queue that's 5 GB in size, with 16 partitions the maximum queue size becomes (5 \* 16) = 80 GB.</span></span> <span data-ttu-id="46803-129">Vous pouvez voir la taille maximale de votre file d’attente ou rubrique partitionnée en examinant son entrée sur le [portail Azure][Azure portal], dans le panneau **Aperçu** de cette entité.</span><span class="sxs-lookup"><span data-stu-id="46803-129">You can see the maximum size of your partitioned queue or topic by looking at its entry on the [Azure portal][Azure portal], in the **Overview** blade for that entity.</span></span>

### <a name="premium"></a><span data-ttu-id="46803-130">Premium</span><span class="sxs-lookup"><span data-stu-id="46803-130">Premium</span></span>

<span data-ttu-id="46803-131">Dans un espace de noms de niveau Premium, vous pouvez créer des files d’attente et des rubriques Service Bus avec des tailles de 1, 2, 3, 4, 5, 10, 20, 40 ou 80 Go (la valeur par défaut est 1 Go).</span><span class="sxs-lookup"><span data-stu-id="46803-131">In a Premium tier namespace, you can create Service Bus queues and topics in 1, 2, 3, 4, 5, 10, 20, 40, or 80 GB sizes (the default is 1 GB).</span></span> <span data-ttu-id="46803-132">Avec le partitionnement activé par défaut, Service Bus crée deux partitions par entité.</span><span class="sxs-lookup"><span data-stu-id="46803-132">With partitioning enabled by default, Service Bus creates two partitions per entity.</span></span> <span data-ttu-id="46803-133">Vous pouvez voir la taille maximale de votre file d’attente ou rubrique partitionnée en examinant son entrée sur le [portail Azure][Azure portal], dans le panneau **Aperçu** de cette entité.</span><span class="sxs-lookup"><span data-stu-id="46803-133">You can see the maximum size of your partitioned queue or topic by looking at its entry on the [Azure portal][Azure portal], in the **Overview** blade for that entity.</span></span>

<span data-ttu-id="46803-134">Pour plus d’informations sur le partitionnement dans la couche de messagerie Premium, consultez [Couches messagerie Service Bus Premium et Standard](service-bus-premium-messaging.md).</span><span class="sxs-lookup"><span data-stu-id="46803-134">For more information about partitioning in the Premium messaging tier, see [Service Bus Premium and Standard messaging tiers](service-bus-premium-messaging.md).</span></span> 

### <a name="create-a-partitioned-entity"></a><span data-ttu-id="46803-135">Créer une entité partitionnée</span><span class="sxs-lookup"><span data-stu-id="46803-135">Create a partitioned entity</span></span>

<span data-ttu-id="46803-136">Il existe plusieurs façons de créer une file d’attente ou une rubrique partitionnée.</span><span class="sxs-lookup"><span data-stu-id="46803-136">There are several ways to create a partitioned queue or topic.</span></span> <span data-ttu-id="46803-137">Lorsque vous créez la file d’attente ou la rubrique à partir de votre application, vous pouvez activer le partitionnement de la file d’attente ou de la rubrique en définissant respectivement la propriété [QueueDescription.EnablePartitioning][QueueDescription.EnablePartitioning] ou [TopicDescription.EnablePartitioning][TopicDescription.EnablePartitioning] sur **true**.</span><span class="sxs-lookup"><span data-stu-id="46803-137">When you create the queue or topic from your application, you can enable partitioning for the queue or topic by respectively setting the [QueueDescription.EnablePartitioning][QueueDescription.EnablePartitioning] or [TopicDescription.EnablePartitioning][TopicDescription.EnablePartitioning] property to **true**.</span></span> <span data-ttu-id="46803-138">Ces propriétés doivent être définies au moment où la file d’attente ou la rubrique est créée.</span><span class="sxs-lookup"><span data-stu-id="46803-138">These properties must be set at the time the queue or topic is created.</span></span> <span data-ttu-id="46803-139">Comme indiqué précédemment, il n’est pas possible de modifier ces propriétés dans une file d’attente ou une rubrique existante.</span><span class="sxs-lookup"><span data-stu-id="46803-139">As stated previously, it is not possible to change these properties on an existing queue or topic.</span></span> <span data-ttu-id="46803-140">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="46803-140">For example:</span></span>

```csharp
// Create partitioned topic
NamespaceManager ns = NamespaceManager.CreateFromConnectionString(myConnectionString);
TopicDescription td = new TopicDescription(TopicName);
td.EnablePartitioning = true;
ns.CreateTopic(td);
```

<span data-ttu-id="46803-141">Vous pouvez également créer une file d’attente ou une rubrique partitionnée dans Visual Studio ou sur le [portail Azure][Azure portal].</span><span class="sxs-lookup"><span data-stu-id="46803-141">Alternatively, you can create a partitioned queue or topic in the [Azure portal][Azure portal] or in Visual Studio.</span></span> <span data-ttu-id="46803-142">Lorsque vous créez une file d’attente ou une rubrique sur le portail, l’option **Activer le partitionnement** dans le panneau **Créer** de la file d’attente ou de la rubrique est activée par défaut.</span><span class="sxs-lookup"><span data-stu-id="46803-142">When you create a queue or topic in the portal, the **Enable partitioning** option in the queue or topic **Create** blade is checked by default.</span></span> <span data-ttu-id="46803-143">Vous pouvez uniquement désactiver cette option dans une entité de niveau Standard ; dans le niveau Premium, le partitionnement est toujours activé.</span><span class="sxs-lookup"><span data-stu-id="46803-143">You can only disable this option in a Standard tier entity; in the Premium tier partitioning is always enabled.</span></span> <span data-ttu-id="46803-144">Dans Visual Studio, cochez la case **Activer le partitionnement** dans la boîte de dialogue **Nouvelle file d’attente** ou **Nouvelle rubrique**.</span><span class="sxs-lookup"><span data-stu-id="46803-144">In Visual Studio, click the **Enable Partitioning** checkbox in the **New Queue** or **New Topic** dialog box.</span></span>

## <a name="use-of-partition-keys"></a><span data-ttu-id="46803-145">Utilisation de clés de partition</span><span class="sxs-lookup"><span data-stu-id="46803-145">Use of partition keys</span></span>
<span data-ttu-id="46803-146">Lorsqu’un message est placé dans une file d’attente ou une rubrique partitionnée, Service Bus vérifie la présence d’une clé de partition.</span><span class="sxs-lookup"><span data-stu-id="46803-146">When a message is enqueued into a partitioned queue or topic, Service Bus checks for the presence of a partition key.</span></span> <span data-ttu-id="46803-147">S'il en trouve une, il sélectionne le fragment basé sur cette clé.</span><span class="sxs-lookup"><span data-stu-id="46803-147">If it finds one, it selects the fragment based on that key.</span></span> <span data-ttu-id="46803-148">S'il ne trouve pas de clé de partition, il sélectionne le fragment basé sur un algorithme interne.</span><span class="sxs-lookup"><span data-stu-id="46803-148">If it does not find a partition key, it selects the fragment based on an internal algorithm.</span></span>

### <a name="using-a-partition-key"></a><span data-ttu-id="46803-149">Utilisation d’une clé de partition</span><span class="sxs-lookup"><span data-stu-id="46803-149">Using a partition key</span></span>
<span data-ttu-id="46803-150">Certains scénarios, tels que les sessions ou les transactions, nécessitent que les messages soient stockés dans un fragment spécifique.</span><span class="sxs-lookup"><span data-stu-id="46803-150">Some scenarios, such as sessions or transactions, require messages to be stored in a specific fragment.</span></span> <span data-ttu-id="46803-151">Tous ces scénarios requièrent l’utilisation d’une clé de partition.</span><span class="sxs-lookup"><span data-stu-id="46803-151">All these scenarios require the use of a partition key.</span></span> <span data-ttu-id="46803-152">Tous les messages qui utilisent la même clé de partition sont affectés au même fragment.</span><span class="sxs-lookup"><span data-stu-id="46803-152">All messages that use the same partition key are assigned to the same fragment.</span></span> <span data-ttu-id="46803-153">Si le fragment est momentanément indisponible, Service Bus renvoie une erreur.</span><span class="sxs-lookup"><span data-stu-id="46803-153">If the fragment is temporarily unavailable, Service Bus returns an error.</span></span>

<span data-ttu-id="46803-154">Selon le scénario, différentes propriétés de messages sont utilisées comme clé de partition :</span><span class="sxs-lookup"><span data-stu-id="46803-154">Depending on the scenario, different message properties are used as a partition key:</span></span>

<span data-ttu-id="46803-155">**SessionId** : si un message a la propriété [BrokeredMessage.SessionId][BrokeredMessage.SessionId] définie, alors Service Bus utilise cette propriété comme clé de partition.</span><span class="sxs-lookup"><span data-stu-id="46803-155">**SessionId**: If a message has the [BrokeredMessage.SessionId][BrokeredMessage.SessionId] property set, then Service Bus uses this property as the partition key.</span></span> <span data-ttu-id="46803-156">De cette façon, tous les messages qui appartiennent à la même session sont gérés par le même courtier de messages.</span><span class="sxs-lookup"><span data-stu-id="46803-156">This way, all messages that belong to the same session are handled by the same message broker.</span></span> <span data-ttu-id="46803-157">Cela permet à Service Bus de garantir l'ordre des messages, ainsi que la cohérence des états de session.</span><span class="sxs-lookup"><span data-stu-id="46803-157">This enables Service Bus to guarantee message ordering as well as the consistency of session states.</span></span>

<span data-ttu-id="46803-158">**PartitionKey** : si un message a la propriété [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] définie mais pas la propriété [BrokeredMessage.SessionId][BrokeredMessage.SessionId], alors Service Bus utilise la propriété [PartitionKey][PartitionKey] comme clé de partition.</span><span class="sxs-lookup"><span data-stu-id="46803-158">**PartitionKey**: If a message has the [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] property but not the [BrokeredMessage.SessionId][BrokeredMessage.SessionId] property set, then Service Bus uses the [PartitionKey][PartitionKey] property as the partition key.</span></span> <span data-ttu-id="46803-159">Si le message a les deux propriétés [SessionId][SessionId] et [PartitionKey][PartitionKey] définies, alors elles doivent être identiques.</span><span class="sxs-lookup"><span data-stu-id="46803-159">If the message has both the [SessionId][SessionId] and the [PartitionKey][PartitionKey] properties set, both properties must be identical.</span></span> <span data-ttu-id="46803-160">Si la propriété [PartitionKey][PartitionKey] est définie sur une valeur différente de celle de la propriété [SessionId][SessionId], Service Bus retourne une exception d’opération non valide.</span><span class="sxs-lookup"><span data-stu-id="46803-160">If the [PartitionKey][PartitionKey] property is set to a different value than the [SessionId][SessionId] property, Service Bus returns an invalid operation exception.</span></span> <span data-ttu-id="46803-161">La propriété [PartitionKey][PartitionKey] doit être utilisée si un expéditeur envoie des messages transactionnels non liés à une session.</span><span class="sxs-lookup"><span data-stu-id="46803-161">The [PartitionKey][PartitionKey] property should be used if a sender sends non-session aware transactional messages.</span></span> <span data-ttu-id="46803-162">La clé de partition garantit que tous les messages qui sont envoyés dans une transaction sont gérés par le même courtier de messages.</span><span class="sxs-lookup"><span data-stu-id="46803-162">The partition key ensures that all messages that are sent within a transaction are handled by the same messaging broker.</span></span>

<span data-ttu-id="46803-163">**MessageId** : si la file d’attente ou la rubrique a la propriété [QueueDescription.RequiresDuplicateDetection][QueueDescription.RequiresDuplicateDetection] définie sur **true** et que les propriétés [BrokeredMessage.SessionId][BrokeredMessage.SessionId] ou [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] ne sont pas définies, la propriété [BrokeredMessage.MessageId][BrokeredMessage.MessageId] sert de clé de partition.</span><span class="sxs-lookup"><span data-stu-id="46803-163">**MessageId**: If the queue or topic has the [QueueDescription.RequiresDuplicateDetection][QueueDescription.RequiresDuplicateDetection] property set to **true** and the [BrokeredMessage.SessionId][BrokeredMessage.SessionId] or [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] properties are not set, then the [BrokeredMessage.MessageId][BrokeredMessage.MessageId] property serves as the partition key.</span></span> <span data-ttu-id="46803-164">(Notez que les bibliothèques Microsoft .NET et AMQP attribuent automatiquement un ID de message si l'application émettrice ne le fait pas.) Dans ce cas, toutes les copies du même message sont gérées par le même courtier de messages.</span><span class="sxs-lookup"><span data-stu-id="46803-164">(Note that the Microsoft .NET and AMQP libraries automatically assign a message ID if the sending application does not.) In this case, all copies of the same message are handled by the same message broker.</span></span> <span data-ttu-id="46803-165">Cela permet à Service Bus de détecter et d’éliminer les messages en double.</span><span class="sxs-lookup"><span data-stu-id="46803-165">This enables Service Bus to detect and eliminate duplicate messages.</span></span> <span data-ttu-id="46803-166">Si la propriété [QueueDescription.RequiresDuplicateDetection][QueueDescription.RequiresDuplicateDetection] n’est pas définie sur **true**, Service Bus ne considère pas la propriété [MessageId][MessageId] comme clé de partition.</span><span class="sxs-lookup"><span data-stu-id="46803-166">If the [QueueDescription.RequiresDuplicateDetection][QueueDescription.RequiresDuplicateDetection] property is not set to **true**, Service Bus does not consider the [MessageId][MessageId] property as a partition key.</span></span>

### <a name="not-using-a-partition-key"></a><span data-ttu-id="46803-167">Non utilisation d'une clé de partition</span><span class="sxs-lookup"><span data-stu-id="46803-167">Not using a partition key</span></span>
<span data-ttu-id="46803-168">En l’absence d’une clé de partition, Service Bus distribue les messages en tourniquet à tous les fragments de la file d’attente ou la rubrique partitionnée.</span><span class="sxs-lookup"><span data-stu-id="46803-168">In the absence of a partition key, Service Bus distributes messages in a round-robin fashion to all the fragments of the partitioned queue or topic.</span></span> <span data-ttu-id="46803-169">Si le fragment choisi n'est pas disponible, Service Bus affecte le message à un fragment différent.</span><span class="sxs-lookup"><span data-stu-id="46803-169">If the chosen fragment is not available, Service Bus assigns the message to a different fragment.</span></span> <span data-ttu-id="46803-170">De cette façon, l'opération d'envoi réussit malgré l'indisponibilité temporaire d'une banque de messagerie.</span><span class="sxs-lookup"><span data-stu-id="46803-170">This way, the send operation succeeds despite the temporary unavailability of a messaging store.</span></span> <span data-ttu-id="46803-171">Cependant, vous obtiendrez pas le classement garanti qui est fourni par une clé de partition.</span><span class="sxs-lookup"><span data-stu-id="46803-171">However, you will not achieve the guaranteed ordering that a partition key provides.</span></span>

<span data-ttu-id="46803-172">Pour une discussion plus approfondie sur le compromis entre la disponibilité (pas de clé de partition) et la cohérence (en utilisant une clé de partition), consultez [cet article](../event-hubs/event-hubs-availability-and-consistency.md).</span><span class="sxs-lookup"><span data-stu-id="46803-172">For a more in-depth discussion of the tradeoff between availability (no partition key) and consistency (using a partition key), see [this article](../event-hubs/event-hubs-availability-and-consistency.md).</span></span> <span data-ttu-id="46803-173">Ces informations s’appliquent également aux entités Service Bus partitionnées et aux partitions Event Hubs.</span><span class="sxs-lookup"><span data-stu-id="46803-173">This information applies equally to partitioned Service Bus entities and Event Hubs partitions.</span></span>

<span data-ttu-id="46803-174">Pour donner à Service Bus assez de temps pour placer le message en file d’attente dans un fragment différent, la valeur [MessagingFactorySettings.OperationTimeout][MessagingFactorySettings.OperationTimeout] spécifiée par le client qui envoie le message doit être supérieure à 15 secondes.</span><span class="sxs-lookup"><span data-stu-id="46803-174">To give Service Bus enough time to enqueue the message into a different fragment, the [MessagingFactorySettings.OperationTimeout][MessagingFactorySettings.OperationTimeout] value specified by the client that sends the message must be greater than 15 seconds.</span></span> <span data-ttu-id="46803-175">Il est recommandé de définir la propriété [OperationTimeout][OperationTimeout] sur la valeur par défaut de 60 secondes.</span><span class="sxs-lookup"><span data-stu-id="46803-175">It is recommended that you set the [OperationTimeout][OperationTimeout] property to the default value of 60 seconds.</span></span>

<span data-ttu-id="46803-176">Notez qu'une clé de partition « épingle » un message à un fragment spécifique.</span><span class="sxs-lookup"><span data-stu-id="46803-176">Note that a partition key "pins" a message to a specific fragment.</span></span> <span data-ttu-id="46803-177">Si la banque de messagerie qui contient ce fragment est indisponible, Service Bus renvoie une erreur.</span><span class="sxs-lookup"><span data-stu-id="46803-177">If the messaging store that holds this fragment is unavailable, Service Bus returns an error.</span></span> <span data-ttu-id="46803-178">En l'absence d'une clé de partition, Service Bus peut choisir un fragment différent et l'opération réussit.</span><span class="sxs-lookup"><span data-stu-id="46803-178">In the absence of a partition key, Service Bus can choose a different fragment and the operation succeeds.</span></span> <span data-ttu-id="46803-179">Par conséquent, il est recommandé de ne pas fournir de clé de partition, sauf si elle est requise.</span><span class="sxs-lookup"><span data-stu-id="46803-179">Therefore, it is recommended that you do not supply a partition key unless it is required.</span></span>

## <a name="advanced-topics-use-transactions-with-partitioned-entities"></a><span data-ttu-id="46803-180">Rubriques avancées : utiliser des transactions avec des entités partitionnées</span><span class="sxs-lookup"><span data-stu-id="46803-180">Advanced topics: use transactions with partitioned entities</span></span>
<span data-ttu-id="46803-181">Les messages envoyés dans le cadre d’une transaction doivent spécifier une clé de partition.</span><span class="sxs-lookup"><span data-stu-id="46803-181">Messages that are sent as part of a transaction must specify a partition key.</span></span> <span data-ttu-id="46803-182">Il peut s’agir de l’une des propriétés suivantes : [BrokeredMessage.SessionId][BrokeredMessage.SessionId], [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] ou [BrokeredMessage.MessageId][BrokeredMessage.MessageId].</span><span class="sxs-lookup"><span data-stu-id="46803-182">This can be one of the following properties: [BrokeredMessage.SessionId][BrokeredMessage.SessionId], [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey], or [BrokeredMessage.MessageId][BrokeredMessage.MessageId].</span></span> <span data-ttu-id="46803-183">Tous les messages envoyés dans le cadre d'une même transaction doivent spécifier la même clé de partition.</span><span class="sxs-lookup"><span data-stu-id="46803-183">All messages that are sent as part of the same transaction must specify the same partition key.</span></span> <span data-ttu-id="46803-184">Si vous essayez d’envoyer un message sans une clé de partition dans une transaction, Service Bus renvoie une exception d’opération non valide.</span><span class="sxs-lookup"><span data-stu-id="46803-184">If you attempt to send a message without a partition key within a transaction, Service Bus returns an invalid operation exception.</span></span> <span data-ttu-id="46803-185">Si vous essayez d’envoyer plusieurs messages dans la même transaction avec des clés de partition différentes, Service Bus renvoie une exception d’opération non valide.</span><span class="sxs-lookup"><span data-stu-id="46803-185">If you attempt to send multiple messages within the same transaction that have different partition keys, Service Bus returns an invalid operation exception.</span></span> <span data-ttu-id="46803-186">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="46803-186">For example:</span></span>

```csharp
CommittableTransaction committableTransaction = new CommittableTransaction();
using (TransactionScope ts = new TransactionScope(committableTransaction))
{
    BrokeredMessage msg = new BrokeredMessage("This is a message");
    msg.PartitionKey = "myPartitionKey";
    messageSender.Send(msg); 
    ts.Complete();
}
committableTransaction.Commit();
```

<span data-ttu-id="46803-187">Si les propriétés qui servent de clé de partition sont définies, Service Bus épingle le message à un fragment spécifique.</span><span class="sxs-lookup"><span data-stu-id="46803-187">If any of the properties that serve as a partition key are set, Service Bus pins the message to a specific fragment.</span></span> <span data-ttu-id="46803-188">Ce comportement se produit qu'une transaction soit utilisée ou non.</span><span class="sxs-lookup"><span data-stu-id="46803-188">This behavior occurs whether or not a transaction is used.</span></span> <span data-ttu-id="46803-189">Il est recommandé de ne pas spécifier de clé de partition si elle n'est pas nécessaire.</span><span class="sxs-lookup"><span data-stu-id="46803-189">It is recommended that you do not specify a partition key if it is not necessary.</span></span>

## <a name="using-sessions-with-partitioned-entities"></a><span data-ttu-id="46803-190">Utilisation de sessions avec les entités partitionnées</span><span class="sxs-lookup"><span data-stu-id="46803-190">Using sessions with partitioned entities</span></span>
<span data-ttu-id="46803-191">Pour envoyer un message transactionnel à une file d’attente ou une rubrique utilisant une session, le message doit contenir la propriété [BrokeredMessage.SessionId][BrokeredMessage.SessionId] définie.</span><span class="sxs-lookup"><span data-stu-id="46803-191">To send a transactional message to a session-aware topic or queue, the message must have the [BrokeredMessage.SessionId][BrokeredMessage.SessionId] property set.</span></span> <span data-ttu-id="46803-192">Si la propriété [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] est également spécifiée, elle doit être identique à la propriété [SessionId][SessionId].</span><span class="sxs-lookup"><span data-stu-id="46803-192">If the [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] property is specified as well, it must be identical to the [SessionId][SessionId] property.</span></span> <span data-ttu-id="46803-193">Si ces propriétés diffèrent, Service Bus renvoie une exception d’opération non valide.</span><span class="sxs-lookup"><span data-stu-id="46803-193">If they differ, Service Bus returns an invalid operation exception.</span></span>

<span data-ttu-id="46803-194">Contrairement aux files d’attente ou rubriques standard (non partitionnées), il n’est pas possible d’utiliser une transaction unique pour envoyer plusieurs messages à différentes sessions.</span><span class="sxs-lookup"><span data-stu-id="46803-194">Unlike regular (non-partitioned) queues or topics, it is not possible to use a single transaction to send multiple messages to different sessions.</span></span> <span data-ttu-id="46803-195">En cas de tentative, Service Bus renvoie une exception d’opération non valide.</span><span class="sxs-lookup"><span data-stu-id="46803-195">If attempted, Service Bus returns an invalid operation exception.</span></span> <span data-ttu-id="46803-196">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="46803-196">For example:</span></span>

```csharp
CommittableTransaction committableTransaction = new CommittableTransaction();
using (TransactionScope ts = new TransactionScope(committableTransaction))
{
    BrokeredMessage msg = new BrokeredMessage("This is a message");
    msg.SessionId = "mySession";
    messageSender.Send(msg); 
    ts.Complete();
}
committableTransaction.Commit();
```

## <a name="automatic-message-forwarding-with-partitioned-entities"></a><span data-ttu-id="46803-197">Transfert automatique des messages avec des entités partitionnées</span><span class="sxs-lookup"><span data-stu-id="46803-197">Automatic message forwarding with partitioned entities</span></span>
<span data-ttu-id="46803-198">Service Bus prend en charge le transfert automatique des messages à partir de, vers ou entre les entités partitionnées.</span><span class="sxs-lookup"><span data-stu-id="46803-198">Service Bus supports automatic message forwarding from, to, or between partitioned entities.</span></span> <span data-ttu-id="46803-199">Pour activer le transfert automatique des messages, définissez la propriété [QueueDescription.ForwardTo][QueueDescription.ForwardTo] de la file d’attente ou de l’abonnement source.</span><span class="sxs-lookup"><span data-stu-id="46803-199">To enable automatic message forwarding, set the [QueueDescription.ForwardTo][QueueDescription.ForwardTo] property on the source queue or subscription.</span></span> <span data-ttu-id="46803-200">Si le message spécifie une clé de partition ([SessionId][SessionId], [PartitionKey][PartitionKey] ou [MessageId][MessageId]), cette clé de partition est utilisée pour l’entité de destination.</span><span class="sxs-lookup"><span data-stu-id="46803-200">If the message specifies a partition key ([SessionId][SessionId], [PartitionKey][PartitionKey], or [MessageId][MessageId]), that partition key is used for the destination entity.</span></span>

## <a name="considerations-and-guidelines"></a><span data-ttu-id="46803-201">Considérations et recommandations</span><span class="sxs-lookup"><span data-stu-id="46803-201">Considerations and guidelines</span></span>
* <span data-ttu-id="46803-202">**Fonctionnalités de cohérence élevée** : si une entité utilise des fonctionnalités telles que des sessions, la détection des doublons ou un contrôle explicite de la clé de partitionnement, les opérations de messagerie sont toujours acheminées vers des fragments spécifiques.</span><span class="sxs-lookup"><span data-stu-id="46803-202">**High consistency features**: If an entity uses features such as sessions, duplicate detection, or explicit control of partitioning key, then the messaging operations are always routed to specific fragments.</span></span> <span data-ttu-id="46803-203">Si le trafic d’un des fragments est élevé ou si le magasin sous-jacent est défectueux, ces opérations échouent et la disponibilité s’en trouve réduite.</span><span class="sxs-lookup"><span data-stu-id="46803-203">If any of the fragments experience high traffic or the underlying store is unhealthy, those operations fail and availability is reduced.</span></span> <span data-ttu-id="46803-204">En général, la cohérence reste plus importante que le nombre d’entités non partitionnées. Seul un sous-ensemble de trafic rencontre des problèmes, et non le trafic tout en entier.</span><span class="sxs-lookup"><span data-stu-id="46803-204">Overall, the consistency is still much higher than non-partitioned entities; only a subset of traffic is experiencing issues, as opposed to all the traffic.</span></span> <span data-ttu-id="46803-205">Pour plus d’informations, consultez cette [discussion sur la disponibilité et la cohérence](../event-hubs/event-hubs-availability-and-consistency.md).</span><span class="sxs-lookup"><span data-stu-id="46803-205">For more information, see this [discussion of availability and consistency](../event-hubs/event-hubs-availability-and-consistency.md).</span></span>
* <span data-ttu-id="46803-206">**Gestion** : des opérations telles que la création, la mise à jour et la suppression doivent être exécutées sur tous les fragments de l’entité.</span><span class="sxs-lookup"><span data-stu-id="46803-206">**Management**: Operations such as Create, Update and Delete must be performed on all the fragments of the entity.</span></span> <span data-ttu-id="46803-207">Si un fragment est défectueux, cela peut entraîner l’échec de ces opérations.</span><span class="sxs-lookup"><span data-stu-id="46803-207">If any fragment is unhealthy it could result in failures for these operations.</span></span> <span data-ttu-id="46803-208">Pour l’opération Get, des informations telles que le nombre de messages doivent être agrégées à partir de tous les fragments.</span><span class="sxs-lookup"><span data-stu-id="46803-208">For the Get operation, information such as message counts must be aggregated from all fragments.</span></span> <span data-ttu-id="46803-209">Si un fragment est défectueux, l’état de disponibilité de l’entité est signalé comme étant limité.</span><span class="sxs-lookup"><span data-stu-id="46803-209">If any fragment is unhealthy, the entity availability status is reported as limited.</span></span>
* <span data-ttu-id="46803-210">**Scénarios de messages à faible volume** : dans ce cas, notamment lorsque vous utilisez le protocole HTTP, vous devez peut-être effectuer plusieurs opérations de réception afin d’obtenir tous les messages.</span><span class="sxs-lookup"><span data-stu-id="46803-210">**Low volume message scenarios**: For such scenarios, especially when using the HTTP protocol, you may have to perform multiple receive operations in order to obtain all the messages.</span></span> <span data-ttu-id="46803-211">Pour les demandes de réception, le serveur frontal effectue une opération de réception sur tous les fragments et met en cache toutes les réponses reçues.</span><span class="sxs-lookup"><span data-stu-id="46803-211">For receive requests, the front end performs a receive on all the fragments and caches all the responses received.</span></span> <span data-ttu-id="46803-212">Une demande de réception ultérieure sur la même connexion profiterait de cette mise en cache et on assisterait à une réduction des latences liées à la réception.</span><span class="sxs-lookup"><span data-stu-id="46803-212">A subsequent receive request on the same connection would benefit from this caching and receive latencies will be lower.</span></span> <span data-ttu-id="46803-213">Toutefois, si vous disposez de plusieurs connexions ou si vous utilisez HTTP, une nouvelle connexion est établie pour chaque demande.</span><span class="sxs-lookup"><span data-stu-id="46803-213">However, if you have multiple connections or use HTTP, that establishes a new connection for each request.</span></span> <span data-ttu-id="46803-214">Par conséquent, l’accès au même nœud n’est pas garanti.</span><span class="sxs-lookup"><span data-stu-id="46803-214">As such, there is no guarantee that it would land on the same node.</span></span> <span data-ttu-id="46803-215">Si tous les messages existants sont verrouillés et mis en cache sur un autre serveur frontal, l’opération de réception renvoie la valeur **null**.</span><span class="sxs-lookup"><span data-stu-id="46803-215">If all existing messages are locked and cached in another front end, the receive operation returns **null**.</span></span> <span data-ttu-id="46803-216">Les messages peuvent arriver à expiration et vous pouvez les recevoir à nouveau.</span><span class="sxs-lookup"><span data-stu-id="46803-216">Messages eventually expire and you can receive them again.</span></span> <span data-ttu-id="46803-217">La persistance du protocole HTTP est recommandée.</span><span class="sxs-lookup"><span data-stu-id="46803-217">HTTP keep-alive is recommended.</span></span>
* <span data-ttu-id="46803-218">**Parcourir/Afficher l’aperçu des messages** : [PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) ne retourne pas toujours le nombre de messages spécifié dans la propriété [MessageCount](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_MessageCount).
</span><span class="sxs-lookup"><span data-stu-id="46803-218">**Browse/Peek messages**: [PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) does not always return the number of messages specified in the [MessageCount](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_MessageCount) property.</span></span> <span data-ttu-id="46803-219">Il existe deux raisons courantes à cela.</span><span class="sxs-lookup"><span data-stu-id="46803-219">There are two common reasons for this.</span></span> <span data-ttu-id="46803-220">L’une des raisons est que la taille agrégée de la collection de messages dépasse la taille maximale de 256 Ko.</span><span class="sxs-lookup"><span data-stu-id="46803-220">One reason is that the aggregated size of the collection of messages exceeds the maximum size of 256KB.</span></span> <span data-ttu-id="46803-221">Une autre raison est que si la [propriété EnablePartitioning](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_EnablePartitioning) de la file d’attente ou de la rubrique est définie sur **true**, il se peut qu’une partition ne dispose pas de suffisamment de messages pour terminer le nombre de messages demandé.</span><span class="sxs-lookup"><span data-stu-id="46803-221">Another reason is that if the queue or topic has the [EnablePartitioning property](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_EnablePartitioning) set to **true**, a partition may not have enough messages to complete the requested number of messages.</span></span> <span data-ttu-id="46803-222">En règle générale, si une application veut recevoir un certain nombre de messages, elle doit appeler [PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) à plusieurs reprises jusqu’à obtenir le nombre de messages voulu à moins qu’il n’y ait plus de messages pour lesquels afficher un aperçu.</span><span class="sxs-lookup"><span data-stu-id="46803-222">In general, if an application wants to receive a specific number of messages, it should call [PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) repeatedly until it gets that number of messages, or there are no more messages to peek.</span></span> <span data-ttu-id="46803-223">Pour plus d’informations, y compris pour obtenir des exemples de code, consultez [QueueClient.PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) ou [SubscriptionClient.PeekBatch](/dotnet/api/microsoft.servicebus.messaging.subscriptionclient#Microsoft_ServiceBus_Messaging_SubscriptionClient_PeekBatch_System_Int32_).</span><span class="sxs-lookup"><span data-stu-id="46803-223">For more information, including code samples, see [QueueClient.PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) or [SubscriptionClient.PeekBatch](/dotnet/api/microsoft.servicebus.messaging.subscriptionclient#Microsoft_ServiceBus_Messaging_SubscriptionClient_PeekBatch_System_Int32_).</span></span>

## <a name="latest-added-features"></a><span data-ttu-id="46803-224">Dernières fonctionnalités ajoutées</span><span class="sxs-lookup"><span data-stu-id="46803-224">Latest added features</span></span>
* <span data-ttu-id="46803-225">L’ajout ou la suppression de règles est désormais pris en charge avec les entités partitionnées.</span><span class="sxs-lookup"><span data-stu-id="46803-225">Add or remove rule is now supported with partitioned entities.</span></span> <span data-ttu-id="46803-226">À la différence des entités non partitionnée, ces opérations ne sont pas prises en charge dans le cadre des transactions.</span><span class="sxs-lookup"><span data-stu-id="46803-226">Different from non-partitioned entities, these operations are not supported under transactions.</span></span> 
* <span data-ttu-id="46803-227">AMQP est désormais pris en charge pour l’envoi et la réception de messages vers et à partir d’une entité partitionnée.</span><span class="sxs-lookup"><span data-stu-id="46803-227">AMQP is now supported for sending and receiving messages to and from a partitioned entity.</span></span>
* <span data-ttu-id="46803-228">AMQP est désormais pris en charge pour les opérations suivantes : [Envoi par lots](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_SendBatch_System_Collections_Generic_IEnumerable_Microsoft_ServiceBus_Messaging_BrokeredMessage__), [Réception par lots](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_ReceiveBatch_System_Int32_), [Réception par numéro de séquence](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_Receive_System_Int64_), [Affichage d’aperçu](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_Peek), [Verrouillage du renouvellement](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_RenewMessageLock_System_Guid_), [Planification des messages](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_ScheduleMessageAsync_Microsoft_ServiceBus_Messaging_BrokeredMessage_System_DateTimeOffset_), [Annulation des messages planifiés](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_CancelScheduledMessageAsync_System_Int64_), [Ajout de règles](/dotnet/api/microsoft.servicebus.messaging.ruledescription), [Suppression de règles](/dotnet/api/microsoft.servicebus.messaging.ruledescription), [Verrouillage de renouvellement de session](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_RenewLock), [Définition de l’état d’une session](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_SetState_System_IO_Stream_), [Obtention de l’état d’une session](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_GetState) et [Énumération des sessions](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_GetMessageSessionsAsync).</span><span class="sxs-lookup"><span data-stu-id="46803-228">AMQP is now supported for the following operations: [Batch Send](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_SendBatch_System_Collections_Generic_IEnumerable_Microsoft_ServiceBus_Messaging_BrokeredMessage__), [Batch Receive](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_ReceiveBatch_System_Int32_), [Receive by Sequence Number](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_Receive_System_Int64_), [Peek](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_Peek), [Renew Lock](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_RenewMessageLock_System_Guid_), [Schedule Message](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_ScheduleMessageAsync_Microsoft_ServiceBus_Messaging_BrokeredMessage_System_DateTimeOffset_), [Cancel Scheduled Message](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_CancelScheduledMessageAsync_System_Int64_), [Add Rule](/dotnet/api/microsoft.servicebus.messaging.ruledescription), [Remove Rule](/dotnet/api/microsoft.servicebus.messaging.ruledescription), [Session Renew Lock](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_RenewLock), [Set Session State](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_SetState_System_IO_Stream_), [Get Session State](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_GetState), and [Enumerate Sessions](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_GetMessageSessionsAsync).</span></span>

## <a name="partitioned-entities-limitations"></a><span data-ttu-id="46803-229">Limites des entités partitionnées</span><span class="sxs-lookup"><span data-stu-id="46803-229">Partitioned entities limitations</span></span>
<span data-ttu-id="46803-230">Actuellement, Service Bus impose les limites suivantes aux files d’attente et rubriques partitionnées :</span><span class="sxs-lookup"><span data-stu-id="46803-230">Currently Service Bus imposes the following limitations on partitioned queues and topics:</span></span>

* <span data-ttu-id="46803-231">Les rubriques et files d’attente partitionnées ne prennent pas en charge l’envoi de messages appartenant à des sessions différentes dans une transaction unique.</span><span class="sxs-lookup"><span data-stu-id="46803-231">Partitioned queues and topics do not support sending messages that belong to different sessions in a single transaction.</span></span>
* <span data-ttu-id="46803-232">Service Bus permet actuellement de disposer jusqu’à 100 rubriques ou files d’attente par espace de noms.</span><span class="sxs-lookup"><span data-stu-id="46803-232">Service Bus currently allows up to 100 partitioned queues or topics per namespace.</span></span> <span data-ttu-id="46803-233">Chaque file d’attente ou rubrique partitionnée est comptabilisée dans le quota de 10 000 entités par espace de noms (non applicable au niveau Premium).</span><span class="sxs-lookup"><span data-stu-id="46803-233">Each partitioned queue or topic counts towards the quota of 10,000 entities per namespace (does not apply to Premium tier).</span></span>

## <a name="next-steps"></a><span data-ttu-id="46803-234">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="46803-234">Next steps</span></span>
<span data-ttu-id="46803-235">Consultez la discussion sur la [prise en charge par AMQP 1.0 des rubriques et files d’attente partitionnées de Service Bus][AMQP 1.0 support for Service Bus partitioned queues and topics] pour en savoir plus sur le partitionnement des entités de messagerie.</span><span class="sxs-lookup"><span data-stu-id="46803-235">See the discussion of [AMQP 1.0 support for Service Bus partitioned queues and topics][AMQP 1.0 support for Service Bus partitioned queues and topics] to learn more about partitioning messaging entities.</span></span> 

[Service Bus architecture]: service-bus-architecture.md
[Azure portal]: https://portal.azure.com
[QueueDescription.EnablePartitioning]: /dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_EnablePartitioning
[TopicDescription.EnablePartitioning]: /dotnet/api/microsoft.servicebus.messaging.topicdescription#Microsoft_ServiceBus_Messaging_TopicDescription_EnablePartitioning
[BrokeredMessage.SessionId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_SessionId
[BrokeredMessage.PartitionKey]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_PartitionKey
[SessionId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_SessionId
[PartitionKey]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_PartitionKey
[QueueDescription.RequiresDuplicateDetection]: /dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_RequiresDuplicateDetection
[BrokeredMessage.MessageId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId
[MessageId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId
[MessagingFactorySettings.OperationTimeout]: /dotnet/api/microsoft.servicebus.messaging.messagingfactorysettings#Microsoft_ServiceBus_Messaging_MessagingFactorySettings_OperationTimeout
[OperationTimeout]: /dotnet/api/microsoft.servicebus.messaging.messagingfactorysettings#Microsoft_ServiceBus_Messaging_MessagingFactorySettings_OperationTimeout
[QueueDescription.ForwardTo]: /dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_ForwardTo
[AMQP 1.0 support for Service Bus partitioned queues and topics]: service-bus-partitioned-queues-and-topics-amqp-overview.md
