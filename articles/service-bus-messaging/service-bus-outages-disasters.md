---
title: applications de Service Bus de Azure aaaInsulating contre les pannes et sinistres | Documents Microsoft
description: "Décrit les techniques que vous pouvez utiliser les applications tooprotect d’une panne de Bus de Service potentielle."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: tysonn
ms.assetid: fd9fa8ab-f4c4-43f7-974f-c876df1614d4
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 04/12/2017
ms.author: sethm
ms.openlocfilehash: 349b4968456c9f15375753d83495246f5a3ddfdb
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="best-practices-for-insulating-applications-against-service-bus-outages-and-disasters"></a><span data-ttu-id="83074-103">Meilleures pratiques pour protéger les applications contre les pannes de Service Bus et les sinistres</span><span class="sxs-lookup"><span data-stu-id="83074-103">Best practices for insulating applications against Service Bus outages and disasters</span></span>
<span data-ttu-id="83074-104">Les applications critiques doivent fonctionner en permanence, même en présence de hello d’arrêts ou de catastrophes naturelles.</span><span class="sxs-lookup"><span data-stu-id="83074-104">Mission-critical applications must operate continuously, even in hello presence of unplanned outages or disasters.</span></span> <span data-ttu-id="83074-105">Cette rubrique décrit les techniques que vous pouvez utiliser des applications de Service Bus tooprotect par rapport à une interruption de service potentielle ou un incident.</span><span class="sxs-lookup"><span data-stu-id="83074-105">This topic describes techniques you can use tooprotect Service Bus applications against a potential service outage or disaster.</span></span>

<span data-ttu-id="83074-106">Une panne est définie comme une indisponibilité temporaire de hello du Bus des services Azure.</span><span class="sxs-lookup"><span data-stu-id="83074-106">An outage is defined as hello temporary unavailability of Azure Service Bus.</span></span> <span data-ttu-id="83074-107">panne de Hello peut affecter certains composants de Service Bus, tel qu’une banque de messages, ou hello même centre de données entier.</span><span class="sxs-lookup"><span data-stu-id="83074-107">hello outage can affect some components of Service Bus, such as a messaging store, or even hello entire datacenter.</span></span> <span data-ttu-id="83074-108">Après avoir réglé le problème de hello, Service Bus est à nouveau disponible.</span><span class="sxs-lookup"><span data-stu-id="83074-108">After hello problem has been fixed, Service Bus becomes available again.</span></span> <span data-ttu-id="83074-109">En règle générale, une panne n'entraîne pas la perte de messages ou autres données.</span><span class="sxs-lookup"><span data-stu-id="83074-109">Typically, an outage does not cause loss of messages or other data.</span></span> <span data-ttu-id="83074-110">Un exemple de défaillance d’un composant est indisponibilité hello d’une banque de messagerie particulier.</span><span class="sxs-lookup"><span data-stu-id="83074-110">An example of a component failure is hello unavailability of a particular messaging store.</span></span> <span data-ttu-id="83074-111">Un exemple d’une panne à l’échelle du centre de données est une panne de courant de centre de données hello ou un commutateur de réseau de centre de données est défectueux.</span><span class="sxs-lookup"><span data-stu-id="83074-111">An example of a datacenter-wide outage is a power failure of hello datacenter, or a faulty datacenter network switch.</span></span> <span data-ttu-id="83074-112">Une panne peut durer quelques minutes tooa quelques jours.</span><span class="sxs-lookup"><span data-stu-id="83074-112">An outage can last from a few minutes tooa few days.</span></span>

<span data-ttu-id="83074-113">Un incident est défini comme la perte définitive de hello d’une unité d’échelle Service Bus ou d’un centre de données.</span><span class="sxs-lookup"><span data-stu-id="83074-113">A disaster is defined as hello permanent loss of a Service Bus scale unit or datacenter.</span></span> <span data-ttu-id="83074-114">Centre de données Hello peut ou ne peut pas devenir disponible à nouveau.</span><span class="sxs-lookup"><span data-stu-id="83074-114">hello datacenter may or may not become available again.</span></span> <span data-ttu-id="83074-115">En général, un sinistre provoque la perte d'une partie ou de l'ensemble des messages ou autres données.</span><span class="sxs-lookup"><span data-stu-id="83074-115">Typically a disaster causes loss of some or all messages or other data.</span></span> <span data-ttu-id="83074-116">Les incendies, les inondations ou les tremblements de terre sont des exemples de sinistres.</span><span class="sxs-lookup"><span data-stu-id="83074-116">Examples of disasters are fire, flooding, or earthquake.</span></span>

## <a name="current-architecture"></a><span data-ttu-id="83074-117">Architecture actuelle</span><span class="sxs-lookup"><span data-stu-id="83074-117">Current architecture</span></span>
<span data-ttu-id="83074-118">Service Bus utilise plusieurs magasins toostore des messages envoyés tooqueues ou rubriques.</span><span class="sxs-lookup"><span data-stu-id="83074-118">Service Bus uses multiple messaging stores toostore messages that are sent tooqueues or topics.</span></span> <span data-ttu-id="83074-119">Une file d’attente de non partitionnée ou une rubrique est assigné tooone banque d’informations.</span><span class="sxs-lookup"><span data-stu-id="83074-119">A non-partitioned queue or topic is assigned tooone messaging store.</span></span> <span data-ttu-id="83074-120">Si cette banque de messagerie n’est pas disponible, toutes les opérations sur cette file d’attente ou rubrique échoueront.</span><span class="sxs-lookup"><span data-stu-id="83074-120">If this messaging store is unavailable, all operations on that queue or topic will fail.</span></span>

<span data-ttu-id="83074-121">Toutes les entités de messagerie Service Bus (files d’attente, rubriques, relais) résident dans un espace de noms de service, qui est affilié à un centre de données.</span><span class="sxs-lookup"><span data-stu-id="83074-121">All Service Bus messaging entities (queues, topics, relays) reside in a service namespace, which is affiliated with a datacenter.</span></span> <span data-ttu-id="83074-122">Service Bus n’active pas la géo-réplication automatique des données, ni ne permet pas qu’un espace de noms toospan plusieurs centres de données.</span><span class="sxs-lookup"><span data-stu-id="83074-122">Service Bus does not enable automatic geo-replication of data, nor does it allow a namespace toospan multiple datacenters.</span></span>

## <a name="protecting-against-acs-outages"></a><span data-ttu-id="83074-123">Protection contre les pannes ACS</span><span class="sxs-lookup"><span data-stu-id="83074-123">Protecting against ACS outages</span></span>
<span data-ttu-id="83074-124">Si vous utilisez des informations d'identification ACS et si ACS devient indisponible, les clients ne peuvent plus obtenir de jetons.</span><span class="sxs-lookup"><span data-stu-id="83074-124">If you are using ACS credentials, and ACS becomes unavailable, clients can no longer obtain tokens.</span></span> <span data-ttu-id="83074-125">Les clients qui ont un jeton au moment de hello ACS tombe en panne peuvent continuer toouse Service Bus jusqu'à l’expiration de jetons de hello.</span><span class="sxs-lookup"><span data-stu-id="83074-125">Clients that have a token at hello time ACS goes down can continue toouse Service Bus until hello tokens expire.</span></span> <span data-ttu-id="83074-126">durée de vie Hello par défaut est de 3 heures.</span><span class="sxs-lookup"><span data-stu-id="83074-126">hello default token lifetime is 3 hours.</span></span>

<span data-ttu-id="83074-127">tooprotect contre les pannes d’ACS, utilisez les jetons de Signature d’accès partagé (SAS).</span><span class="sxs-lookup"><span data-stu-id="83074-127">tooprotect against ACS outages, use Shared Access Signature (SAS) tokens.</span></span> <span data-ttu-id="83074-128">Dans ce cas, hello s’authentifie directement avec le Bus de Service en signant un jeton auto-émis avec une clé de secret principal.</span><span class="sxs-lookup"><span data-stu-id="83074-128">In this case, hello client authenticates directly with Service Bus by signing a self-minted token with a secret key.</span></span> <span data-ttu-id="83074-129">Appels tooACS ne sont plus nécessaires.</span><span class="sxs-lookup"><span data-stu-id="83074-129">Calls tooACS are no longer required.</span></span> <span data-ttu-id="83074-130">Pour plus d’informations sur les jetons SAS, consultez [Authentification Service Bus][Service Bus authentication].</span><span class="sxs-lookup"><span data-stu-id="83074-130">For more information about SAS tokens, see [Service Bus authentication][Service Bus authentication].</span></span>

## <a name="protecting-queues-and-topics-against-messaging-store-failures"></a><span data-ttu-id="83074-131">Protection des files d’attente et des rubriques contre les défaillances de la banque de messagerie</span><span class="sxs-lookup"><span data-stu-id="83074-131">Protecting queues and topics against messaging store failures</span></span>
<span data-ttu-id="83074-132">Une file d’attente de non partitionnée ou une rubrique est assigné tooone banque d’informations.</span><span class="sxs-lookup"><span data-stu-id="83074-132">A non-partitioned queue or topic is assigned tooone messaging store.</span></span> <span data-ttu-id="83074-133">Si cette banque de messagerie n’est pas disponible, toutes les opérations sur cette file d’attente ou rubrique échoueront.</span><span class="sxs-lookup"><span data-stu-id="83074-133">If this messaging store is unavailable, all operations on that queue or topic will fail.</span></span> <span data-ttu-id="83074-134">A partitionné file d’attente, sur hello autre part, se compose de plusieurs fragments.</span><span class="sxs-lookup"><span data-stu-id="83074-134">A partitioned queue, on hello other hand, consists of multiple fragments.</span></span> <span data-ttu-id="83074-135">Chaque fragment est stocké dans une banque de messagerie différente.</span><span class="sxs-lookup"><span data-stu-id="83074-135">Each fragment is stored in a different messaging store.</span></span> <span data-ttu-id="83074-136">Lorsqu’un message est envoyé tooa la file d’attente partitionnée ou une rubrique, Service Bus assigne tooone de message hello de fragments de hello.</span><span class="sxs-lookup"><span data-stu-id="83074-136">When a message is sent tooa partitioned queue or topic, Service Bus assigns hello message tooone of hello fragments.</span></span> <span data-ttu-id="83074-137">Si la banque de messagerie correspondante hello n’est pas disponible, Service Bus écrit hello message tooa autre fragment, si possible.</span><span class="sxs-lookup"><span data-stu-id="83074-137">If hello corresponding messaging store is unavailable, Service Bus writes hello message tooa different fragment, if possible.</span></span> <span data-ttu-id="83074-138">Pour plus d’informations sur les entités partitionnées, consultez [Files d’attente et rubriques partitionnées][Partitioned messaging entities].</span><span class="sxs-lookup"><span data-stu-id="83074-138">For more information about partitioned entities, see [Partitioned messaging entities][Partitioned messaging entities].</span></span>

## <a name="protecting-against-datacenter-outages-or-disasters"></a><span data-ttu-id="83074-139">Protection contre les pannes ou les sinistres du centre de données</span><span class="sxs-lookup"><span data-stu-id="83074-139">Protecting against datacenter outages or disasters</span></span>
<span data-ttu-id="83074-140">tooallow pour un basculement entre deux centres de données, vous pouvez créer un espace de noms service Bus de Service dans chaque centre de données.</span><span class="sxs-lookup"><span data-stu-id="83074-140">tooallow for a failover between two datacenters, you can create a Service Bus service namespace in each datacenter.</span></span> <span data-ttu-id="83074-141">Par exemple, hello espace de noms Service Bus service **contosoPrimary.servicebus.windows.net** peuvent se trouver dans la région Nord-Centre des États-Unis United States hello et **contosoSecondary.servicebus.windows.net**peut se trouver dans la région États-Unis Sud-Centre des États-Unis hello.</span><span class="sxs-lookup"><span data-stu-id="83074-141">For example, hello Service Bus service namespace **contosoPrimary.servicebus.windows.net** might be located in hello United States North/Central region, and **contosoSecondary.servicebus.windows.net** might be located in hello US South/Central region.</span></span> <span data-ttu-id="83074-142">Si une entité de messagerie de Service Bus doit rester accessible en présence de hello d’une panne du centre de données, vous pouvez créer cette entité dans les deux espaces de noms.</span><span class="sxs-lookup"><span data-stu-id="83074-142">If a Service Bus messaging entity must remain accessible in hello presence of a datacenter outage, you can create that entity in both namespaces.</span></span>

<span data-ttu-id="83074-143">Pour plus d’informations, consultez hello section « Défaillance de Service Bus dans un centre de données Azure » dans [asynchrone haute disponibilité et modèles de messagerie][Asynchronous messaging patterns and high availability].</span><span class="sxs-lookup"><span data-stu-id="83074-143">For more information, see hello "Failure of Service Bus within an Azure datacenter" section in [Asynchronous messaging patterns and high availability][Asynchronous messaging patterns and high availability].</span></span>

## <a name="protecting-relay-endpoints-against-datacenter-outages-or-disasters"></a><span data-ttu-id="83074-144">Protection des points de terminaison de relais contre les pannes ou les sinistres du centre de données</span><span class="sxs-lookup"><span data-stu-id="83074-144">Protecting relay endpoints against datacenter outages or disasters</span></span>
<span data-ttu-id="83074-145">Géo-réplication des points de terminaison de relais permet à un service qui expose un toobe de point de terminaison de relais est accessible en présence de hello d’interruptions de Service Bus.</span><span class="sxs-lookup"><span data-stu-id="83074-145">Geo-replication of relay endpoints allows a service that exposes a relay endpoint toobe reachable in hello presence of Service Bus outages.</span></span> <span data-ttu-id="83074-146">tooachieve géo-réplication, service de hello doit créer deux points de terminaison de relais dans différents espaces de noms.</span><span class="sxs-lookup"><span data-stu-id="83074-146">tooachieve geo-replication, hello service must create two relay endpoints in different namespaces.</span></span> <span data-ttu-id="83074-147">espaces de noms Hello doit se trouver dans différents centres de données et deux points de terminaison hello doivent avoir des noms différents.</span><span class="sxs-lookup"><span data-stu-id="83074-147">hello namespaces must reside in different datacenters and hello two endpoints must have different names.</span></span> <span data-ttu-id="83074-148">Par exemple, un point de terminaison principal peut être accessible sous **contosoPrimary.servicebus.windows.net/myPrimaryService**, alors que son homologue secondaire peut être accessible sous **contosoSecondary.servicebus.windows.net/mySecondaryService**.</span><span class="sxs-lookup"><span data-stu-id="83074-148">For example, a primary endpoint can be reached under **contosoPrimary.servicebus.windows.net/myPrimaryService**, while its secondary counterpart can be reached under **contosoSecondary.servicebus.windows.net/mySecondaryService**.</span></span>

<span data-ttu-id="83074-149">Hello service écoute alors les deux points de terminaison, et un client peut appeler le service hello via un point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="83074-149">hello service then listens on both endpoints, and a client can invoke hello service via either endpoint.</span></span> <span data-ttu-id="83074-150">Une application cliente de façon aléatoire choisit l’un des relais de hello comme hello du point de terminaison principal et envoie son point de terminaison demande toohello active.</span><span class="sxs-lookup"><span data-stu-id="83074-150">A client application randomly picks one of hello relays as hello primary endpoint, and sends its request toohello active endpoint.</span></span> <span data-ttu-id="83074-151">Si l’opération de hello échoue avec un code d’erreur, cet échec indique ce point de terminaison de relais hello n’est pas disponible.</span><span class="sxs-lookup"><span data-stu-id="83074-151">If hello operation fails with an error code, this failure indicates that hello relay endpoint is not available.</span></span> <span data-ttu-id="83074-152">l’application Hello ouvre un point de terminaison canal toohello sauvegarde et émet à nouveau la demande de hello.</span><span class="sxs-lookup"><span data-stu-id="83074-152">hello application opens a channel toohello backup endpoint and reissues hello request.</span></span> <span data-ttu-id="83074-153">À ce stade hello active et points de terminaison hello sauvegarde permutent leurs rôles : application de client hello considère hello ancien point de terminaison actif toobe hello nouveau point de terminaison de sauvegarde et hello ancien point de terminaison de sauvegarde toobe hello nouveau point de terminaison actif.</span><span class="sxs-lookup"><span data-stu-id="83074-153">At that point hello active and hello backup endpoints switch roles: hello client application considers hello old active endpoint toobe hello new backup endpoint, and hello old backup endpoint toobe hello new active endpoint.</span></span> <span data-ttu-id="83074-154">Si les deux opérations d’envoi échouent, les rôles hello de deux entités de hello restent inchangés et une erreur est retournée.</span><span class="sxs-lookup"><span data-stu-id="83074-154">If both send operations fail, hello roles of hello two entities remain unchanged and an error is returned.</span></span>

<span data-ttu-id="83074-155">Hello [géo-réplication avec Service Bus relayée messages] [ Geo-replication with Service Bus relayed Messages] exemple illustre comment des relais tooreplicate.</span><span class="sxs-lookup"><span data-stu-id="83074-155">hello [Geo-replication with Service Bus relayed messages][Geo-replication with Service Bus relayed Messages] sample demonstrates how tooreplicate relays.</span></span>

## <a name="protecting-queues-and-topics-against-datacenter-outages-or-disasters"></a><span data-ttu-id="83074-156">Protection des files d’attente et des rubriques contre les pannes ou les sinistres du centre de données</span><span class="sxs-lookup"><span data-stu-id="83074-156">Protecting queues and topics against datacenter outages or disasters</span></span>
<span data-ttu-id="83074-157">tooachieve une tolérance aux pannes de centre de données lors de l’aide de la messagerie répartie, Service Bus prend en charge les deux approches : *active* et *passif* la réplication.</span><span class="sxs-lookup"><span data-stu-id="83074-157">tooachieve resilience against datacenter outages when using brokered messaging, Service Bus supports two approaches: *active* and *passive* replication.</span></span> <span data-ttu-id="83074-158">Pour chaque approche, si une file d’attente ou une rubrique doit rester accessible en présence de hello d’une panne du centre de données, vous pouvez le créer dans les deux espaces de noms.</span><span class="sxs-lookup"><span data-stu-id="83074-158">For each approach, if a given queue or topic must remain accessible in hello presence of a datacenter outage, you can create it in both namespaces.</span></span> <span data-ttu-id="83074-159">Les deux entités peuvent avoir hello même nom.</span><span class="sxs-lookup"><span data-stu-id="83074-159">Both entities can have hello same name.</span></span> <span data-ttu-id="83074-160">Par exemple, une file d’attente principale peut être accessible sous **contosoPrimary.servicebus.windows.net/myQueue**, alors que son homologue secondaire peut être accessible sous **contosoSecondary.servicebus.windows.net/myQueue**.</span><span class="sxs-lookup"><span data-stu-id="83074-160">For example, a primary queue can be reached under **contosoPrimary.servicebus.windows.net/myQueue**, while its secondary counterpart can be reached under **contosoSecondary.servicebus.windows.net/myQueue**.</span></span>

<span data-ttu-id="83074-161">Si l’application hello ne requiert pas de communication permanente de l’expéditeur et le destinataire, application hello peut implémenter une file d’attente côté client durable tooprevent perte et tooshield hello expéditeur d’un message à partir de toutes les erreurs temporaires de Service Bus.</span><span class="sxs-lookup"><span data-stu-id="83074-161">If hello application does not require permanent sender-to-receiver communication, hello application can implement a durable client-side queue tooprevent message loss and tooshield hello sender from any transient Service Bus errors.</span></span>

## <a name="active-replication"></a><span data-ttu-id="83074-162">Réplication active</span><span class="sxs-lookup"><span data-stu-id="83074-162">Active replication</span></span>
<span data-ttu-id="83074-163">La réplication active utilise des entités dans les deux espaces de noms pour chaque opération.</span><span class="sxs-lookup"><span data-stu-id="83074-163">Active replication uses entities in both namespaces for every operation.</span></span> <span data-ttu-id="83074-164">Tout client qui envoie un message envoie deux copies de hello même message.</span><span class="sxs-lookup"><span data-stu-id="83074-164">Any client that sends a message sends two copies of hello same message.</span></span> <span data-ttu-id="83074-165">la première copie Hello est envoyée entité principale de toohello (par exemple, **contosoPrimary.servicebus.windows.net/sales**), et hello seconde copie de message de type hello est envoyé entité secondaire de toohello (par exemple,  **contosoSecondary.servicebus.windows.net/sales**).</span><span class="sxs-lookup"><span data-stu-id="83074-165">hello first copy is sent toohello primary entity (for example, **contosoPrimary.servicebus.windows.net/sales**), and hello second copy of hello message is sent toohello secondary entity (for example, **contosoSecondary.servicebus.windows.net/sales**).</span></span>

<span data-ttu-id="83074-166">Un client reçoit des messages des deux files d'attente.</span><span class="sxs-lookup"><span data-stu-id="83074-166">A client receives messages from both queues.</span></span> <span data-ttu-id="83074-167">processus de récepteur Hello hello première copie d’un message, et copie hello est supprimée.</span><span class="sxs-lookup"><span data-stu-id="83074-167">hello receiver processes hello first copy of a message, and hello second copy is suppressed.</span></span> <span data-ttu-id="83074-168">toosuppress des messages en double, l’expéditeur de hello devez baliser chaque message avec un identificateur unique.</span><span class="sxs-lookup"><span data-stu-id="83074-168">toosuppress duplicate messages, hello sender must tag each message with a unique identifier.</span></span> <span data-ttu-id="83074-169">Les deux copies du message de type hello doivent être balisés avec hello même identificateur.</span><span class="sxs-lookup"><span data-stu-id="83074-169">Both copies of hello message must be tagged with hello same identifier.</span></span> <span data-ttu-id="83074-170">Vous pouvez utiliser hello [BrokeredMessage.MessageId] [ BrokeredMessage.MessageId] ou [BrokeredMessage.Label] [ BrokeredMessage.Label] propriétés, ou un Bonjour tootag de propriété personnalisée Message.</span><span class="sxs-lookup"><span data-stu-id="83074-170">You can use hello [BrokeredMessage.MessageId][BrokeredMessage.MessageId] or [BrokeredMessage.Label][BrokeredMessage.Label] properties, or a custom property tootag hello message.</span></span> <span data-ttu-id="83074-171">récepteur de Hello doit conserver une liste de messages qu’il a déjà reçu.</span><span class="sxs-lookup"><span data-stu-id="83074-171">hello receiver must maintain a list of messages that it has already received.</span></span>

<span data-ttu-id="83074-172">Hello [géo-réplication avec Messages répartie du Service Bus] [ Geo-replication with Service Bus Brokered Messages] exemple illustre la réplication active des entités de messagerie.</span><span class="sxs-lookup"><span data-stu-id="83074-172">hello [Geo-replication with Service Bus Brokered Messages][Geo-replication with Service Bus Brokered Messages] sample demonstrates active replication of messaging entities.</span></span>

> [!NOTE]
> <span data-ttu-id="83074-173">approche de la réplication active Hello double nombre hello d’opérations, par conséquent cette approche peut entraîner des coûts de toohigher.</span><span class="sxs-lookup"><span data-stu-id="83074-173">hello active replication approach doubles hello number of operations, therefore this approach can lead toohigher cost.</span></span>
> 
> 

## <a name="passive-replication"></a><span data-ttu-id="83074-174">Réplication passive</span><span class="sxs-lookup"><span data-stu-id="83074-174">Passive replication</span></span>
<span data-ttu-id="83074-175">Dans le cas d’absence de panne hello, réplication passive utilise un seul hello deux entités de messagerie.</span><span class="sxs-lookup"><span data-stu-id="83074-175">In hello fault-free case, passive replication uses only one of hello two messaging entities.</span></span> <span data-ttu-id="83074-176">Un client envoie l’entité active du toohello message hello.</span><span class="sxs-lookup"><span data-stu-id="83074-176">A client sends hello message toohello active entity.</span></span> <span data-ttu-id="83074-177">Si l’opération hello sur l’entité active de hello échoue avec un code d’erreur qui indique le centre de données hello que l’entité active de hello hôtes peut être indisponible, client de hello envoie une copie de l’entité de sauvegarde toohello message hello.</span><span class="sxs-lookup"><span data-stu-id="83074-177">If hello operation on hello active entity fails with an error code that indicates hello datacenter that hosts hello active entity might be unavailable, hello client sends a copy of hello message toohello backup entity.</span></span> <span data-ttu-id="83074-178">À ce stade hello active et les entités de sauvegarde hello permutent leurs rôles : client d’envoi hello considère hello ancienne entité active toobe hello nouvelle entité de sauvegarde et hello ancien sauvegarde entité est hello nouveau active.</span><span class="sxs-lookup"><span data-stu-id="83074-178">At that point hello active and hello backup entities switch roles: hello sending client considers hello old active entity toobe hello new backup entity, and hello old backup entity is hello new active entity.</span></span> <span data-ttu-id="83074-179">Si les deux opérations d’envoi échouent, les rôles hello de deux entités de hello restent inchangés et une erreur est retournée.</span><span class="sxs-lookup"><span data-stu-id="83074-179">If both send operations fail, hello roles of hello two entities remain unchanged and an error is returned.</span></span>

<span data-ttu-id="83074-180">Un client reçoit des messages des deux files d'attente.</span><span class="sxs-lookup"><span data-stu-id="83074-180">A client receives messages from both queues.</span></span> <span data-ttu-id="83074-181">Car il existe un risque que récepteur hello reçoit deux copies du même message, hello de hello doit supprimer les messages en double.</span><span class="sxs-lookup"><span data-stu-id="83074-181">Because there is a chance that hello receiver receives two copies of hello same message, hello receiver must suppress duplicate messages.</span></span> <span data-ttu-id="83074-182">Vous pouvez supprimer les doublons dans hello même façon que celle décrite pour la réplication active.</span><span class="sxs-lookup"><span data-stu-id="83074-182">You can suppress duplicates in hello same way as described for active replication.</span></span>

<span data-ttu-id="83074-183">En général, la réplication passive est moins onéreuse que la réplication active, car dans la plupart des cas, une seule opération est effectuée.</span><span class="sxs-lookup"><span data-stu-id="83074-183">In general, passive replication is more economical than active replication because in most cases only one operation is performed.</span></span> <span data-ttu-id="83074-184">Latence, le débit et coût monétaire sont scénario de non répliquée toohello identiques.</span><span class="sxs-lookup"><span data-stu-id="83074-184">Latency, throughput, and monetary cost are identical toohello non-replicated scenario.</span></span>

<span data-ttu-id="83074-185">Lorsque vous utilisez la réplication passive, Bonjour messages scénarios suivants peuvent être perdus ou reçus en double :</span><span class="sxs-lookup"><span data-stu-id="83074-185">When using passive replication, in hello following scenarios messages can be lost or received twice:</span></span>

* <span data-ttu-id="83074-186">**Délai de message ou de perte**: supposent que l’expéditeur de hello envoyé à une file d’attente principale toohello message m1, et puis une file d’attente hello devienne indisponible avant la réception de hello m1.</span><span class="sxs-lookup"><span data-stu-id="83074-186">**Message delay or loss**: Assume that hello sender successfully sent a message m1 toohello primary queue, and then hello queue becomes unavailable before hello receiver receives m1.</span></span> <span data-ttu-id="83074-187">expéditeur de Hello envoie une file d’attente secondaire toohello ultérieures message m2.</span><span class="sxs-lookup"><span data-stu-id="83074-187">hello sender sends a subsequent message m2 toohello secondary queue.</span></span> <span data-ttu-id="83074-188">Si la file d’attente principale de hello est temporairement indisponible, hello réception m1 une fois que la file d’attente hello est à nouveau disponible.</span><span class="sxs-lookup"><span data-stu-id="83074-188">If hello primary queue is temporarily unavailable, hello receiver receives m1 after hello queue becomes available again.</span></span> <span data-ttu-id="83074-189">En cas de sinistre, récepteur de hello peut ne jamais recevoir m1.</span><span class="sxs-lookup"><span data-stu-id="83074-189">In case of a disaster, hello receiver may never receive m1.</span></span>
* <span data-ttu-id="83074-190">**Réception de doublons**: supposons que cet expéditeur hello envoie une file d’attente message m toohello principal.</span><span class="sxs-lookup"><span data-stu-id="83074-190">**Duplicate reception**: Assume that hello sender sends a message m toohello primary queue.</span></span> <span data-ttu-id="83074-191">Bus de service traite m avec succès mais échoue toosend une réponse.</span><span class="sxs-lookup"><span data-stu-id="83074-191">Service Bus successfully processes m but fails toosend a response.</span></span> <span data-ttu-id="83074-192">Après hello envoyer l’opération arrive à expiration, l’expéditeur de hello envoie une copie identique de file d’attente secondaire de m toohello.</span><span class="sxs-lookup"><span data-stu-id="83074-192">After hello send operation times out, hello sender sends an identical copy of m toohello secondary queue.</span></span> <span data-ttu-id="83074-193">Si le récepteur de hello est en mesure de tooreceive hello première copie de m avant de la file d’attente principale de hello devienne indisponible, récepteur de hello reçoit les deux copies de m à environ hello même temps.</span><span class="sxs-lookup"><span data-stu-id="83074-193">If hello receiver is able tooreceive hello first copy of m before hello primary queue becomes unavailable, hello receiver receives both copies of m at approximately hello same time.</span></span> <span data-ttu-id="83074-194">Si le récepteur de hello n’est pas en mesure de tooreceive hello première copie de m avant de la file d’attente principale de hello devienne indisponible, récepteur de hello reçoit initialement que hello deuxième copie de m, mais reçoit ensuite une deuxième copie de m lors de la file d’attente principale de hello devienne disponible.</span><span class="sxs-lookup"><span data-stu-id="83074-194">If hello receiver is not able tooreceive hello first copy of m before hello primary queue becomes unavailable, hello receiver initially receives only hello second copy of m, but then receives a second copy of m when hello primary queue becomes available.</span></span>

<span data-ttu-id="83074-195">Hello [géo-réplication avec Service Bus répartie messages] [ Geo-replication with Service Bus Brokered Messages] exemple illustre la réplication passive des entités de messagerie.</span><span class="sxs-lookup"><span data-stu-id="83074-195">hello [Geo-replication with Service Bus brokered messages][Geo-replication with Service Bus Brokered Messages] sample demonstrates passive replication of messaging entities.</span></span>

## <a name="next-steps"></a><span data-ttu-id="83074-196">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="83074-196">Next steps</span></span>
<span data-ttu-id="83074-197">toolearn savoir plus sur la récupération d’urgence, consultez les articles suivants :</span><span class="sxs-lookup"><span data-stu-id="83074-197">toolearn more about disaster recovery, see these articles:</span></span>

* <span data-ttu-id="83074-198">[Continuité de l’activité Azure SQL Database][Azure SQL Database Business Continuity]</span><span class="sxs-lookup"><span data-stu-id="83074-198">[Azure SQL Database Business Continuity][Azure SQL Database Business Continuity]</span></span>
* <span data-ttu-id="83074-199">[Conception d’applications résilientes pour Azure][Azure resiliency technical guidance]</span><span class="sxs-lookup"><span data-stu-id="83074-199">[Designing resilient applications for Azure][Azure resiliency technical guidance]</span></span>

[Service Bus Authentication]: service-bus-authentication-and-authorization.md
[Partitioned messaging entities]: service-bus-partitioning.md
[Asynchronous messaging patterns and high availability]: service-bus-async-messaging.md#failure-of-service-bus-within-an-azure-datacenter
[Geo-replication with Service Bus Relayed Messages]: http://code.msdn.microsoft.com/Geo-replication-with-16dbfecd
[BrokeredMessage.MessageId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId
[BrokeredMessage.Label]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label
[Geo-replication with Service Bus Brokered Messages]: http://code.msdn.microsoft.com/Geo-replication-with-f5688664
[Azure SQL Database Business Continuity]: ../sql-database/sql-database-business-continuity.md
[Azure resiliency technical guidance]: /azure/architecture/resiliency
