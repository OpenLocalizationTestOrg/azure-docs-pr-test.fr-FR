---
title: "aaaWorking avec de grands ensembles d’échelle de Machine virtuelle Azure | Documents Microsoft"
description: "Vous devez tooknow toouse grand machine virtuelle Azure mise à l’échelle de jeux"
services: virtual-machine-scale-sets
documentationcenter: 
author: gbowerman
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 76ac7fd7-2e05-4762-88ca-3b499e87906e
ms.service: virtual-machine-scale-sets
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 2/7/2017
ms.author: guybo
ms.openlocfilehash: a39aab25925d7fc50763f0a20148b1f2213b492f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="working-with-large-virtual-machine-scale-sets"></a><span data-ttu-id="d4d6e-103">Utilisation de grands groupes de machines virtuelles identiques</span><span class="sxs-lookup"><span data-stu-id="d4d6e-103">Working with large virtual machine scale sets</span></span>
<span data-ttu-id="d4d6e-104">Vous pouvez désormais créer Azure [machines virtuelles identiques](/azure/virtual-machine-scale-sets/) avec une capacité de configuration too1, 000 machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-104">You can now create Azure [virtual machine scale sets](/azure/virtual-machine-scale-sets/) with a capacity of up too1,000 VMs.</span></span> <span data-ttu-id="d4d6e-105">Dans ce document, un _grand machines virtuelles identiques_ est défini comme une échelle définie capable d’évoluer toogreater à 100 machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-105">In this document, a _large virtual machine scale set_ is defined as a scale set capable of scaling toogreater than 100 VMs.</span></span> <span data-ttu-id="d4d6e-106">Cette fonctionnalité est définie par une propriété de groupe identique (_singlePlacementGroup=False_).</span><span class="sxs-lookup"><span data-stu-id="d4d6e-106">This capability is set by a scale set property (_singlePlacementGroup=False_).</span></span> 

<span data-ttu-id="d4d6e-107">Définit certains aspects d’à grande échelle, tels que les domaines et l’équilibrage de charge comportent différemment tooa un ensemble d’échelle standard.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-107">Certain aspects of large scale sets, such as load balancing and fault domains behave differently tooa standard scale set.</span></span> <span data-ttu-id="d4d6e-108">Ce document explique les caractéristiques hello de grands jeux d’et décrit ce que vous avez besoin de tooknow toosuccessfully les utiliser dans vos applications.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-108">This document explains hello characteristics of large scale sets, and describes what you need tooknow toosuccessfully use them in your applications.</span></span> 

<span data-ttu-id="d4d6e-109">Une approche commune pour le déploiement d’infrastructure cloud à grande échelle est toocreate un ensemble de _mettre à l’échelle des unités_, par exemple, en créant plusieurs machines virtuelles, l’échelle jeux sur plusieurs réseaux virtuels et les comptes de stockage.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-109">A common approach for deploying cloud infrastructure at large scale is toocreate a set of _scale units_, for example by creating multiple VMs scale sets across multiple VNETs and storage accounts.</span></span> <span data-ttu-id="d4d6e-110">Cette approche offre plus facile par rapport de gestion toosingle machines virtuelles, et plusieurs unités d’échelle sont utiles pour de nombreuses applications, notamment ceux qui nécessitent d’autres composants empilables comme plusieurs réseaux virtuels et les points de terminaison.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-110">This approach provides easier management compared toosingle VMs, and multiple scale units are useful for many applications, particularly those that require other stackable components like multiple virtual networks and endpoints.</span></span> <span data-ttu-id="d4d6e-111">Si votre application nécessite un seul cluster volumineux Toutefois, il peut être plus simple toodeploy une seule échelle configurer de too1, 000 machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-111">If your application requires a single large cluster however, it can be more straightforward toodeploy a single scale set of up too1,000 VMs.</span></span> <span data-ttu-id="d4d6e-112">Des exemples de scénarios incluent des déploiements de Big Data centralisés ou des grilles de calcul nécessitant la gestion simple d’un grand pool de nœuds de travail.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-112">Example scenarios include centralized big data deployments, or compute grids requiring simple management of a large pool of worker nodes.</span></span> <span data-ttu-id="d4d6e-113">Combiné avec un ensemble d’échelle de machine virtuelle [disques de données associés](virtual-machine-scale-sets-attached-disks.md), les jeux à grande échelle permettent toodeploy une infrastructure évolutive comprenant des milliers de cœurs et plusieurs pétaoctets de stockage, comme une seule opération.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-113">Combined with VM scale set [attached data disks](virtual-machine-scale-sets-attached-disks.md), large scale sets enable you toodeploy a scalable infrastructure consisting of thousands of cores and petabytes of storage, as a single operation.</span></span>

## <a name="placement-groups"></a><span data-ttu-id="d4d6e-114">Groupes de placement</span><span class="sxs-lookup"><span data-stu-id="d4d6e-114">Placement groups</span></span> 
<span data-ttu-id="d4d6e-115">Ce qui rend une _grand_ échelle définie spécial n’est pas nombre hello d’ordinateurs virtuels, mais nombre hello de _groupes de la sélection élective_ qu’il contient.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-115">What makes a _large_ scale set special is not hello number of VMs, but hello number of _placement groups_ it contains.</span></span> <span data-ttu-id="d4d6e-116">Un groupe de la sélection élective est un ensemble de disponibilité Azure tooan de construction similaire, avec ses propres domaines d’erreur et les domaines de mise à niveau.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-116">A placement group is a construct similar tooan Azure availability set, with its own fault domains and upgrade domains.</span></span> <span data-ttu-id="d4d6e-117">Par défaut, un groupe identique se compose d’un seul groupe de placement contenant au maximum 100 machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-117">By default, a scale set consists of a single placement group with a maximum size of 100 VMs.</span></span> <span data-ttu-id="d4d6e-118">Si la valeur de propriété appelée par une échelle _singlePlacementGroup_ a la valeur too_false_, hello identiques peuvent être composées de plusieurs groupes de la sélection élective et a une plage de 0 à 1 000 machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-118">If a scale set property called _singlePlacementGroup_ is set too_false_, hello scale set can be composed of multiple placement groups and has a range of 0-1,000 VMs.</span></span> <span data-ttu-id="d4d6e-119">Lorsque la valeur par défaut toohello de _true_, un ensemble d’échelle est composé d’un groupe de la sélection élective unique et a une plage de 0 à 100 machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-119">When set toohello default value of _true_, a scale set is composed of a single placement group, and has a range of 0-100 VMs.</span></span>

## <a name="checklist-for-using-large-scale-sets"></a><span data-ttu-id="d4d6e-120">Liste de contrôle pour l’utilisation de grands groupes identiques</span><span class="sxs-lookup"><span data-stu-id="d4d6e-120">Checklist for using large scale sets</span></span>
<span data-ttu-id="d4d6e-121">toodecide si votre application peut utiliser efficacement les jeux à grande échelle, tenez compte hello suivant les exigences :</span><span class="sxs-lookup"><span data-stu-id="d4d6e-121">toodecide whether your application can make effective use of large scale sets, consider hello following requirements:</span></span>

- <span data-ttu-id="d4d6e-122">Les grands groupes identiques requièrent Azure Managed Disks.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-122">Large scale sets require Azure Managed Disks.</span></span> <span data-ttu-id="d4d6e-123">Les groupes identiques qui ne sont pas créés avec Managed Disks nécessitent plusieurs comptes de stockage (un toutes les 20 machines virtuelles).</span><span class="sxs-lookup"><span data-stu-id="d4d6e-123">Scale sets that are not created with Managed Disks require multiple storage accounts (one for every 20 VMs).</span></span> <span data-ttu-id="d4d6e-124">Les jeux à grande échelle sont toowork conçue exclusivement avec tooreduce de disques gérés des limites de votre stockage surcharge de gestion et tooavoid hello des risques de l’exécution dans un abonnement pour les comptes de stockage.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-124">Large scale sets are designed toowork exclusively with Managed Disks tooreduce your storage management overhead, and tooavoid hello risk of running into subscription limits for storage accounts.</span></span> <span data-ttu-id="d4d6e-125">Si vous n’utilisez pas de disques gérés, votre jeu de mise à l’échelle est limitée too100 VMs.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-125">If you do not use Managed Disks, your scale set is limited too100 VMs.</span></span>
- <span data-ttu-id="d4d6e-126">Définit l’échelle créé à partir d’images Azure Marketplace peut évoluer too1, 000 machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-126">Scale sets created from Azure Marketplace images can scale up too1,000 VMs.</span></span>
- <span data-ttu-id="d4d6e-127">Définit l’échelle créé à partir d’images personnalisées (images de machine virtuelle vous créez et chargez vous-même) capable d’évoluer actuellement too100 VMs.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-127">Scale sets created from custom images (VM images you create and upload yourself) can currently scale up too100 VMs.</span></span>
- <span data-ttu-id="d4d6e-128">Couche 4 équilibrage de charge avec hello équilibrage de charge Azure n'est pas encore prises en charge l’échelle composé de plusieurs groupes de la sélection élective.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-128">Layer-4 load balancing with hello Azure Load Balancer is not yet supported for scale sets composed of multiple placement groups.</span></span> <span data-ttu-id="d4d6e-129">Si vous avez besoin hello toouse équilibrage de charge Azure que l’échelle de hello que jeu est toouse configuré un groupe de la sélection élective unique, qui est par défaut hello.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-129">If you need toouse hello Azure Load Balancer make sure hello scale set is configured toouse a single placement group, which is hello default setting.</span></span>
- <span data-ttu-id="d4d6e-130">Couche 7 équilibrage de charge avec hello passerelle d’Application Azure est prise en charge pour tous les jeux de mise à l’échelle.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-130">Layer-7 load balancing with hello Azure Application Gateway is supported for all scale sets.</span></span>
- <span data-ttu-id="d4d6e-131">Un ensemble d’échelle est défini avec un seul sous-réseau - Assurez-vous que votre sous-réseau dispose d’un espace d’adressage suffisant pour toutes les machines virtuelles de hello vous avez besoin.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-131">A scale set is defined with a single subnet - make sure your subnet has an address space large enough for all hello VMs you need.</span></span> <span data-ttu-id="d4d6e-132">Par défaut, une échelle définie overprovisions (crée des machines virtuelles supplémentaires au moment du déploiement ou de la montée en puissance parallèle, ce qui vous n’êtes pas facturé pour) tooimprove déploiement fiabilité et les performances.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-132">By default a scale set overprovisions (creates extra VMs at deployment time or when scaling out, which you are not charged for) tooimprove deployment reliability and performance.</span></span> <span data-ttu-id="d4d6e-133">Autoriser une adresse espace 20 % supérieur au nombre de hello d’ordinateurs virtuels que vous envisagez de tooscale à.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-133">Allow for an address space 20% greater than hello number of VMs you plan tooscale to.</span></span>
- <span data-ttu-id="d4d6e-134">Si vous envisagez de toodeploy de machines virtuelles, les limites des quotas core calcul peut-être toobe augmenté.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-134">If you are planning toodeploy many VMs, your Compute core quota limits may need toobe increased.</span></span>
- <span data-ttu-id="d4d6e-135">Les domaines d’erreur et de mise à niveau sont cohérents uniquement au sein d’un groupe de placement.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-135">Fault domains and upgrade domains are only consistent within a placement group.</span></span> <span data-ttu-id="d4d6e-136">Cette architecture ne change pas hello globale d’une échelle de haute disponibilité, comme les machines virtuelles sont réparties uniformément sur un matériel physique distinct, mais c’est le cas signifie que si vous avez besoin de tooguarantee sont de deux machines virtuelles sur un matériel différent, assurez-vous qu’ils sont dans une autre erreur domaines de hello même groupe de sélection élective.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-136">This architecture does not change hello overall availability of a scale set, as VMs are evenly distributed across distinct physical hardware, but it does means that if you need tooguarantee two VMs are on different hardware, make sure they are in different fault domains in hello same placement group.</span></span> <span data-ttu-id="d4d6e-137">ID du groupe de domaine et la sélection élective erreur sont affichés dans hello _affichage de l’instance_ d’une échelle de jeu de machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-137">Fault domain and placement group ID are shown in hello _instance view_ of a scale set VM.</span></span> <span data-ttu-id="d4d6e-138">Vous pouvez afficher la vue d’instance hello d’un ensemble d’échelle de machine virtuelle Bonjour [Explorateur de ressources Azure](https://resources.azure.com/).</span><span class="sxs-lookup"><span data-stu-id="d4d6e-138">You can view hello instance view of a scale set VM in hello [Azure Resource Explorer](https://resources.azure.com/).</span></span>


## <a name="creating-a-large-scale-set"></a><span data-ttu-id="d4d6e-139">Création d’un grand groupe identique</span><span class="sxs-lookup"><span data-stu-id="d4d6e-139">Creating a large scale set</span></span>
<span data-ttu-id="d4d6e-140">Lorsque vous créez une échelle définie dans hello portail Azure, vous pouvez autoriser son groupes de la sélection élective tooscale toomultiple en définissant un hello _limite tooa unique de groupe positionnement_ too_False_ option Bonjour _notions de base_ panneau.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-140">When you create a scale set in hello Azure portal, you can allow it tooscale toomultiple placement groups by setting hello _Limit tooa single placement group_ option too_False_ in hello _Basics_ blade.</span></span> <span data-ttu-id="d4d6e-141">Avec cette too_False_ ensemble option, vous pouvez spécifier une _le nombre d’instances_ la valeur de configuration too1, 000.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-141">With this option set too_False_, you can specify an _Instance count_ value of up too1,000.</span></span>

![](./media/virtual-machine-scale-sets-placement-groups/portal-large-scale.png)

<span data-ttu-id="d4d6e-142">Vous pouvez créer une à grande échelle de la machine virtuelle à l’aide de hello [CLI d’Azure](https://github.com/Azure/azure-cli) _az mise créer_ commande.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-142">You can create a large VM scale set using hello [Azure CLI](https://github.com/Azure/azure-cli) _az vmss create_ command.</span></span> <span data-ttu-id="d4d6e-143">Cette commande définit les valeurs par défaut intelligents comme taille de sous-réseau en fonction de hello _-nombre d’instances_ argument :</span><span class="sxs-lookup"><span data-stu-id="d4d6e-143">This command sets intelligent defaults such as subnet size based on hello _instance-count_ argument:</span></span>

```bash
az group create -l southcentralus -n biginfra
az vmss create -g biginfra -n bigvmss --image ubuntults --instance-count 1000
```
<span data-ttu-id="d4d6e-144">Notez que hello _mise créer_ commande par défaut de certaines valeurs de configuration si vous ne spécifiez pas les.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-144">Note that hello _vmss create_ command defaults certain configuration values if you do not specify them.</span></span> <span data-ttu-id="d4d6e-145">options disponibles toosee hello que vous pouvez remplacer, essayez :</span><span class="sxs-lookup"><span data-stu-id="d4d6e-145">toosee hello available options that you can override, try:</span></span>
```bash
az vmss create --help
```

<span data-ttu-id="d4d6e-146">Si vous créez une grande échelle définie par la composition d’un modèle Azure Resource Manager, assurez-vous que le modèle de hello crée un jeu de mise à l’échelle basé sur des disques gérés Azure.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-146">If you are creating a large scale set by composing an Azure Resource Manager template, make sure hello template creates a scale set based on Azure Managed Disks.</span></span> <span data-ttu-id="d4d6e-147">Vous pouvez définir hello _singlePlacementGroup_ too_false_ propriété Bonjour _propriétés_ section Hello _Microsoft.Compute/virtualMAchineScaleSets_ ressource.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-147">You can set hello _singlePlacementGroup_ property too_false_ in hello _properties_ section of hello _Microsoft.Compute/virtualMAchineScaleSets_ resource.</span></span> <span data-ttu-id="d4d6e-148">Hello fragment JSON suivant illustre début hello d’un modèle de jeu de mise à l’échelle, y compris la capacité de machine virtuelle hello 1 000 et hello _« singlePlacementGroup » : false_ paramètre :</span><span class="sxs-lookup"><span data-stu-id="d4d6e-148">hello following JSON fragment shows hello beginning of a scale set template, including hello 1,000 VM capacity and hello _"singlePlacementGroup" : false_ setting:</span></span>
```json
{
  "type": "Microsoft.Compute/virtualMachineScaleSets",
  "location": "australiaeast",
  "name": "bigvmss",
  "sku": {
    "name": "Standard_DS1_v2",
    "tier": "Standard",
    "capacity": 1000
  },
  "properties": {
    "singlePlacementGroup": false,
    "upgradePolicy": {
      "mode": "Automatic"
    }
```
<span data-ttu-id="d4d6e-149">Pour obtenir un exemple complet de grande échelle définir le modèle, consultez trop[https://github.com/gbowerman/azure-myriad/blob/master/bigtest/bigbottle.json](https://github.com/gbowerman/azure-myriad/blob/master/bigtest/bigbottle.json).</span><span class="sxs-lookup"><span data-stu-id="d4d6e-149">For a complete example of a large scale set template, refer too[https://github.com/gbowerman/azure-myriad/blob/master/bigtest/bigbottle.json](https://github.com/gbowerman/azure-myriad/blob/master/bigtest/bigbottle.json).</span></span>

## <a name="converting-an-existing-scale-set-toospan-multiple-placement-groups"></a><span data-ttu-id="d4d6e-150">Conversion d’une échelle existante définie toospan plusieurs groupes de la sélection élective</span><span class="sxs-lookup"><span data-stu-id="d4d6e-150">Converting an existing scale set toospan multiple placement groups</span></span>
<span data-ttu-id="d4d6e-151">toomake une échelle de machine virtuelle existante définie capable d’évoluer toomore à 100 machines virtuelles, vous devez toochange hello _singplePlacementGroup_ too_false_ de propriété dans l’échelle de hello définir le modèle.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-151">toomake an existing VM scale set capable of scaling toomore than 100 VMs, you need toochange hello _singplePlacementGroup_ property too_false_ in hello scale set model.</span></span> <span data-ttu-id="d4d6e-152">Vous pouvez tester la modification de cette propriété avec hello [Explorateur de ressources Azure](https://resources.azure.com/).</span><span class="sxs-lookup"><span data-stu-id="d4d6e-152">You can test changing this property with hello [Azure Resource Explorer](https://resources.azure.com/).</span></span> <span data-ttu-id="d4d6e-153">Rechercher un ensemble existant de l’échelle, sélectionnez _modifier_ et modifiez hello _singlePlacementGroup_ propriété.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-153">Find an existing scale set, select _Edit_ and change hello _singlePlacementGroup_ property.</span></span> <span data-ttu-id="d4d6e-154">Si vous ne voyez pas cette propriété, vous pouvez consulter à l’échelle de hello définie avec une version antérieure de hello Microsoft.Compute API.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-154">If you do not see this property, you may be viewing hello scale set with an older version of hello Microsoft.Compute API.</span></span>

>[!NOTE] 
<span data-ttu-id="d4d6e-155">Vous pouvez modifier une échelle définie à partir d’un emplacement unique groupe uniquement (comportement par défaut de hello) tooa prise en charge de plusieurs groupes de la sélection élective de prise en charge, mais vous ne pouvez pas convertir hello inverse.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-155">You can change a scale set from supporting a single placement group only (hello default behavior) tooa supporting multiple placement groups, but you cannot convert hello other way around.</span></span> <span data-ttu-id="d4d6e-156">Par conséquent Assurez-vous que vous comprenez les propriétés de hello de jeux à grande échelle avant la conversion.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-156">Therefore make sure you understand hello properties of large scale sets before converting.</span></span> <span data-ttu-id="d4d6e-157">Vérifiez en particulier, que vous n’avez pas besoin de couche 4 équilibrage de charge avec hello équilibrage de charge Azure.</span><span class="sxs-lookup"><span data-stu-id="d4d6e-157">In particular, make sure you do not need layer-4 load balancing with hello Azure Load Balancer.</span></span>


