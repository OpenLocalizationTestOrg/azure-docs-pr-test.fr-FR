---
title: "architecture de Azure HDInsight appartenant à un aaaDomain | Documents Microsoft"
description: "Découvrez comment tooplan appartenant au domaine HDInsight."
services: hdinsight
documentationcenter: 
author: saurinsh
manager: jhubbard
editor: cgronlun
tags: azure-portal
ms.assetid: 7dc6847d-10d4-4b5c-9c83-cc513cf91965
ms.service: hdinsight
ms.custom: hdinsightactive
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 02/03/2017
ms.author: saurinsh
ms.openlocfilehash: 1c3ecedf3739b4f8fa54160225be9c1d6e2ca6cc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="plan-azure-domain-joined-hadoop-clusters-in-hdinsight"></a><span data-ttu-id="a0a5e-103">Planifier des clusters Hadoop Azure joints à un domaine dans HDInsight</span><span class="sxs-lookup"><span data-stu-id="a0a5e-103">Plan Azure domain-joined Hadoop clusters in HDInsight</span></span>

<span data-ttu-id="a0a5e-104">Hello Hadoop traditionnel est un cluster à utilisateur unique.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-104">hello traditional Hadoop is a single-user cluster.</span></span> <span data-ttu-id="a0a5e-105">Il convient à la plupart des entreprises qui font appel à des équipes d’application plus petites pour créer leurs charges de travail de données importantes.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-105">It is suitable for most companies that have smaller application teams building large data workloads.</span></span> <span data-ttu-id="a0a5e-106">À mesure qu’Hadoop gagne en popularité, nombre d’entreprises font la transition vers un modèle dans lequel les clusters sont gérés par les équipes informatiques et partagés par plusieurs équipes d’application.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-106">As Hadoop gains popularity, many enterprises are moving toward a model in which clusters are managed by IT teams and multiple application teams share clusters.</span></span> <span data-ttu-id="a0a5e-107">Par conséquent, des clusters multi-utilisateur impliquant font partie des fonctionnalités hello plus fonctionnalités dans Azure HDInsight.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-107">Thus, functionalities involving multiuser clusters are among hello most requested functionalities in Azure HDInsight.</span></span>

<span data-ttu-id="a0a5e-108">Au lieu de générer son propre authentification multi-utilisateur et l’autorisation, HDInsight s’appuie sur les plus populaires fournisseur d’identité hello--Active Directory (AD).</span><span class="sxs-lookup"><span data-stu-id="a0a5e-108">Instead of building its own multiuser authentication and authorization, HDInsight relies on hello most popular identity provider--Active Directory (AD).</span></span> <span data-ttu-id="a0a5e-109">fonctionnalités de sécurité puissant Hello dans Active Directory peuvent être utilisé toomanage des autorisation multi-utilisateur dans HDInsight.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-109">hello powerful security functionality in AD can be used toomanage multiuser authorization in HDInsight.</span></span> <span data-ttu-id="a0a5e-110">En intégrant HDInsight avec Active Directory, vous pouvez communiquer avec des clusters de hello à l’aide de vos informations d’identification Active Directory.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-110">By integrating HDInsight with AD, you can communicate with hello clusters by using your AD credentials.</span></span> <span data-ttu-id="a0a5e-111">HDInsight mappe un utilisateur Hadoop AD utilisateur tooa local, donc tous hello services s’exécutant sur HDInsight (Ambari, Hive Spark thrift de serveur, Ranger, serveur, etc.) fonctionnent en toute transparence pour l’utilisateur de hello authentifié.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-111">HDInsight maps an AD user tooa local Hadoop user, so all hello services running on HDInsight (Ambari, Hive server, Ranger, Spark thrift server, and others) work seamlessly for hello authenticated user.</span></span>

## <a name="integrate-hdinsight-with-ad-and-ad-on-iaas-vm"></a><span data-ttu-id="a0a5e-112">Intégrer HDInsight à AD et AD sur la machine virtuelle IaaS</span><span class="sxs-lookup"><span data-stu-id="a0a5e-112">Integrate HDInsight with AD and AD on IaaS VM</span></span>

<span data-ttu-id="a0a5e-113">En intégrant HDInsight avec Azure AD ou AD sur Iaas VM, nœuds de cluster HDInsight hello sont joints au domaine de tooa domaine.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-113">By integrating HDInsight with Azure AD or AD on Iaas VM, hello HDInsight cluster nodes are domain-joined tooa domain.</span></span> <span data-ttu-id="a0a5e-114">HDInsight crée des principaux de service pour hello services Hadoop en cours d’exécution sur le cluster de hello et les place dans une unité d’organisation (UO) spécifiée dans Azure AD ou AD sur IaaS VM.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-114">HDInsight creates service principals for hello Hadoop services running on hello cluster and places them within a specified organizational unit (OU) in Azure AD or AD on IaaS VM.</span></span> <span data-ttu-id="a0a5e-115">HDInsight crée également les mappages DNS inverses dans le domaine hello pour hello adresses IP des nœuds hello toohello joint à un domaine.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-115">HDInsight also creates reverse DNS mappings in hello domain for hello IP addresses of hello nodes that are joined toohello domain.</span></span>

<span data-ttu-id="a0a5e-116">Vous pouvez obtenir cette configuration en utilisant plusieurs architectures.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-116">You can achieve this setup by using multiple architectures.</span></span> <span data-ttu-id="a0a5e-117">Vous pouvez choisir parmi hello suivant des architectures.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-117">You can choose from hello following architectures.</span></span>

<span data-ttu-id="a0a5e-118">**HDInsight intégré à AD fonctionnant sur Azure IaaS**</span><span class="sxs-lookup"><span data-stu-id="a0a5e-118">**HDInsight integrated with AD running on Azure IaaS**</span></span>

<span data-ttu-id="a0a5e-119">Il s’agit d’architecture de la plus simple de hello pour l’intégration de HDInsight avec Active Directory.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-119">This is hello simplest architecture for integrating HDInsight with Active Directory.</span></span> <span data-ttu-id="a0a5e-120">Hello, contrôleur de domaine Active Directory s’exécute sur un (ou plusieurs) virtual machines virtuelles dans Azure.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-120">hello AD domain controller runs on one (or multiple) virtual machines (VMs) in Azure.</span></span> <span data-ttu-id="a0a5e-121">En général, ces machines virtuelles se trouvent sur un réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-121">These VMs are usually in a virtual network.</span></span> <span data-ttu-id="a0a5e-122">Permet de paramétrer un autre réseau virtuel pour le cluster HDInsight de hello.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-122">You set up another virtual network for hello HDInsight cluster.</span></span> <span data-ttu-id="a0a5e-123">Pour HDInsight toohave un tooActive de ligne de vue active, vous devez toopeer ces réseaux virtuels à l’aide de [au réseau d’homologation](../virtual-network/virtual-network-create-peering.md).</span><span class="sxs-lookup"><span data-stu-id="a0a5e-123">For HDInsight toohave a line of sight tooActive Directory, you need toopeer these virtual networks by using [VNet-to-VNet peering](../virtual-network/virtual-network-create-peering.md).</span></span> <span data-ttu-id="a0a5e-124">Si vous créez hello ARM, Active Directory, vous pouvez créer des hello Active Directory et HDInsight dans hello même réseau virtuel et vous n’avez pas besoin d’homologation de toodo.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-124">If you create hello Active Directory in ARM, then you can create hello Active Directory and HDInsight in hello same VNet and you don't need toodo peering.</span></span> 

![Topologie du cluster HDInsight joint à un domaine](./media/hdinsight-domain-joined-architecture/hdinsight-domain-joined-architecture_1.png)

> [!NOTE]
> <span data-ttu-id="a0a5e-126">Dans cette architecture, vous ne pouvez pas utiliser Azure Data Lake Store avec le cluster HDInsight de hello.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-126">In this architecture, you cannot use Azure Data Lake Store with hello HDInsight cluster.</span></span>


<span data-ttu-id="a0a5e-127">Conditions préalables pour Active Directory :</span><span class="sxs-lookup"><span data-stu-id="a0a5e-127">Prerequisites for Active Directory:</span></span>

* <span data-ttu-id="a0a5e-128">Un [unité d’organisation](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md) doivent être créés, dans laquelle vous placez hello des machines virtuelles du cluster HDInsight et hello principaux de service utilisé par le cluster de hello.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-128">An [organizational unit](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md) must be created, within which you place hello HDInsight cluster VMs and hello service principals used by hello cluster.</span></span>
* <span data-ttu-id="a0a5e-129">Les [protocoles LDAP (Lightweight Directory Access Protocol)](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md) doivent être configurés pour communiquer avec AD.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-129">[Lightweight Directory Access Protocols](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md) (LDAPs) must be set up for communicating with AD.</span></span> <span data-ttu-id="a0a5e-130">tooset du certificat utilisé Hello protocole LDAPS doit être un certificat réel (pas un certificat auto-signé).</span><span class="sxs-lookup"><span data-stu-id="a0a5e-130">hello certificate used tooset up LDAPS must be a real certificate (not a self-signed certificate).</span></span>
* <span data-ttu-id="a0a5e-131">Les zones DNS inverses doivent être créés sur le domaine hello pour la plage d’adresses IP hello du sous-réseau de HDInsight hello (par exemple, 10.2.0.0/24 dans l’image précédente de hello).</span><span class="sxs-lookup"><span data-stu-id="a0a5e-131">Reverse DNS zones must be created on hello domain for hello IP address range of hello HDInsight subnet (for example, 10.2.0.0/24 in hello previous picture).</span></span>
* <span data-ttu-id="a0a5e-132">Un compte de service ou un compte d’utilisateur sont nécessaires.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-132">A service account or a user account is needed.</span></span> <span data-ttu-id="a0a5e-133">Utilisez ce cluster HDInsight de compte toocreate hello.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-133">Use this account toocreate hello HDInsight cluster.</span></span> <span data-ttu-id="a0a5e-134">Ce compte doit disposer de hello les autorisations suivantes :</span><span class="sxs-lookup"><span data-stu-id="a0a5e-134">This account must have hello following permissions:</span></span>

    - <span data-ttu-id="a0a5e-135">Objets principal du service toocreate autorisations et les objets ordinateur dans l’unité d’organisation hello</span><span class="sxs-lookup"><span data-stu-id="a0a5e-135">Permissions toocreate service principal objects and machine objects within hello organizational unit</span></span>
    - <span data-ttu-id="a0a5e-136">Règles de proxy autorisations toocreate inversées DNS</span><span class="sxs-lookup"><span data-stu-id="a0a5e-136">Permissions toocreate reverse DNS proxy rules</span></span>
    - <span data-ttu-id="a0a5e-137">Domaine Active Directory toohello autorisations toojoin machines</span><span class="sxs-lookup"><span data-stu-id="a0a5e-137">Permissions toojoin machines toohello Active Directory domain</span></span>

<span data-ttu-id="a0a5e-138">**HDInsight intégré à Azure AD dans le cloud uniquement**</span><span class="sxs-lookup"><span data-stu-id="a0a5e-138">**HDInsight integrated with cloud-only Azure AD**</span></span>

<span data-ttu-id="a0a5e-139">Pour Azure AD dans le cloud uniquement, configurez un contrôleur de domaine pour que HDInsight puisse être intégré à Azure AD.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-139">For cloud-only Azure AD, configure a domain controller so that HDInsight can be integrated with Azure AD.</span></span> <span data-ttu-id="a0a5e-140">Pour cela, vous devez utiliser [Azure Active Directory Domain Services](../active-directory-domain-services/active-directory-ds-overview.md) (Azure AD DS).</span><span class="sxs-lookup"><span data-stu-id="a0a5e-140">This is achieved by using [Azure Active Directory Domain Services](../active-directory-domain-services/active-directory-ds-overview.md) (Azure AD DS).</span></span> <span data-ttu-id="a0a5e-141">Azure AD DS crée des ordinateurs de contrôleur de domaine sur le cloud de hello et fournit les adresses IP pour eux.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-141">Azure AD DS creates domain controller machines on hello cloud and provides IP addresses for them.</span></span> <span data-ttu-id="a0a5e-142">Il crée deux contrôleurs de domaine pour la haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-142">It creates two domain controllers for high availability.</span></span>

<span data-ttu-id="a0a5e-143">Pour le moment, Azure AD DS existe uniquement dans les réseaux virtuels classiques.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-143">Currently, Azure AD DS exists only in classic virtual networks.</span></span> <span data-ttu-id="a0a5e-144">Il n’est accessible qu’à l’aide de hello portail Azure classic.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-144">It is only accessible by using hello Azure classic portal.</span></span> <span data-ttu-id="a0a5e-145">Hello HDInsight réseau virtuel existe dans le portail Azure, qui doit toobe de hello homologuer avec un réseau virtuel hello classique à l’aide d’homologation de réseau virtuel à réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-145">hello HDInsight virtual network exists in hello Azure portal, which needs toobe peered with hello classic virtual network by using VNet-to-VNet peering.</span></span>

> [!NOTE]
> <span data-ttu-id="a0a5e-146">Pour l’homologation entre un réseau virtuel classique et le réseau virtuel requiert que les deux réseaux virtuels est dans un gestionnaire de ressources Azure hello même région et sous hello même abonnement Azure.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-146">Peering between a classic virtual network and an Azure Resource Manager virtual network requires that both virtual networks are in hello same region and under hello same Azure subscription.</span></span>

![Topologie du cluster HDInsight joint à un domaine](./media/hdinsight-domain-joined-architecture/hdinsight-domain-joined-architecture_2.png)

<span data-ttu-id="a0a5e-148">Composants requis pour Azure AD :</span><span class="sxs-lookup"><span data-stu-id="a0a5e-148">Prerequisites for Azure AD:</span></span>

* <span data-ttu-id="a0a5e-149">Un [unité d’organisation](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md) doivent être créées dans laquelle vous placez hello des machines virtuelles du cluster HDInsight et hello principaux de service utilisé par le cluster de hello.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-149">An [organizational unit](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md) must be created within which you place hello HDInsight cluster VMs and hello service principals used by hello cluster.</span></span>
* <span data-ttu-id="a0a5e-150">Le protocole [LDAPS](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md) doit être paramétré lorsque vous configurez Azure AD DS.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-150">[LDAPS](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md) must be set up when you configure Azure AD DS.</span></span> <span data-ttu-id="a0a5e-151">tooset du certificat utilisé Hello protocole LDAPS doit être un certificat réel (pas un certificat auto-signé).</span><span class="sxs-lookup"><span data-stu-id="a0a5e-151">hello certificate used tooset up LDAPS must be a real certificate (not a self-signed certificate).</span></span>
* <span data-ttu-id="a0a5e-152">Les zones DNS inverses doivent être créés sur le domaine hello pour la plage d’adresses IP hello du sous-réseau de HDInsight hello (par exemple, 10.2.0.0/24 dans l’image précédente de hello).</span><span class="sxs-lookup"><span data-stu-id="a0a5e-152">Reverse DNS zones must be created on hello domain for hello IP address range of hello HDInsight subnet (for example, 10.2.0.0/24 in hello previous picture).</span></span>
* <span data-ttu-id="a0a5e-153">[Les hachages de mot de passe](../active-directory-domain-services/active-directory-ds-getting-started-password-sync.md) doivent être synchronisés à partir d’Azure AD tooAzure les services AD DS.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-153">[Password hashes](../active-directory-domain-services/active-directory-ds-getting-started-password-sync.md) must be synced from Azure AD tooAzure AD DS.</span></span>
* <span data-ttu-id="a0a5e-154">Un compte de service ou un compte d’utilisateur sont nécessaires.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-154">A service account or a user account is needed.</span></span> <span data-ttu-id="a0a5e-155">Utilisez ce cluster HDInsight de compte toocreate hello.</span><span class="sxs-lookup"><span data-stu-id="a0a5e-155">Use this account toocreate hello HDInsight cluster.</span></span> <span data-ttu-id="a0a5e-156">Ce compte doit disposer de hello les autorisations suivantes :</span><span class="sxs-lookup"><span data-stu-id="a0a5e-156">This account must have hello following permissions:</span></span>

    - <span data-ttu-id="a0a5e-157">Objets principal du service toocreate autorisations et les objets ordinateur dans l’unité d’organisation hello</span><span class="sxs-lookup"><span data-stu-id="a0a5e-157">Permissions toocreate service principal objects and machine objects within hello organizational unit</span></span>
    - <span data-ttu-id="a0a5e-158">Règles de proxy autorisations toocreate inversées DNS</span><span class="sxs-lookup"><span data-stu-id="a0a5e-158">Permissions toocreate reverse DNS proxy rules</span></span>
    - <span data-ttu-id="a0a5e-159">Domaine d’autorisations toojoin machines toohello Azure AD</span><span class="sxs-lookup"><span data-stu-id="a0a5e-159">Permissions toojoin machines toohello Azure AD domain</span></span>

## <a name="next-steps"></a><span data-ttu-id="a0a5e-160">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="a0a5e-160">Next steps</span></span>
* <span data-ttu-id="a0a5e-161">tooconfigure un cluster HDInsight à un domaine, consultez [configurer appartenant au domaine des clusters HDInsight](hdinsight-domain-joined-configure.md).</span><span class="sxs-lookup"><span data-stu-id="a0a5e-161">tooconfigure a domain-joined HDInsight cluster, see [Configure domain-joined HDInsight clusters](hdinsight-domain-joined-configure.md).</span></span>
* <span data-ttu-id="a0a5e-162">clusters HDInsight de toomanage appartenant au domaine, consultez [gérer appartenant au domaine des clusters HDInsight](hdinsight-domain-joined-manage.md).</span><span class="sxs-lookup"><span data-stu-id="a0a5e-162">toomanage domain-joined HDInsight clusters, see [Manage domain-joined HDInsight clusters](hdinsight-domain-joined-manage.md).</span></span>
* <span data-ttu-id="a0a5e-163">stratégies de ruche tooconfigure et exécution des requêtes Hive, consultez [Hive de configurer des stratégies pour joints au domaine des clusters HDInsight](hdinsight-domain-joined-run-hive.md).</span><span class="sxs-lookup"><span data-stu-id="a0a5e-163">tooconfigure Hive policies and run Hive queries, see [Configure Hive policies for domain-joined HDInsight clusters](hdinsight-domain-joined-run-hive.md).</span></span>
* <span data-ttu-id="a0a5e-164">les requêtes de ruche toorun à l’aide de SSH sur des clusters HDInsight appartenant à un domaine, consultez [utilisation de SSH avec HDInsight](hdinsight-hadoop-linux-use-ssh-unix.md).</span><span class="sxs-lookup"><span data-stu-id="a0a5e-164">toorun Hive queries by using SSH on domain-joined HDInsight clusters, see [Use SSH with HDInsight](hdinsight-hadoop-linux-use-ssh-unix.md).</span></span>
