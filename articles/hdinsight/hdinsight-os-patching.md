---
title: "Configurer la planification de la mise à jour corrective du système d’exploitation pour les clusters HDInsight Linux - Azure | Microsoft Docs"
description: "Découvrez comment configurer la planification de la mise à jour corrective du système d’exploitation pour les clusters HDInsight sous Linux."
services: hdinsight
documentationcenter: 
author: bprakash
manager: asadk
editor: bprakash
ms.assetid: 
ms.service: hdinsight
ms.custom: hdinsightactive
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 03/21/2017
ms.author: bhanupr
ms.openlocfilehash: af3c5a19ae8e2e606e4b0506f9f6dddb41192e40
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/11/2017
---
# <a name="os-patching-for-hdinsight"></a><span data-ttu-id="baa42-103">Mise à jour corrective du système d’exploitation pour HDInsight</span><span class="sxs-lookup"><span data-stu-id="baa42-103">OS patching for HDInsight</span></span> 
<span data-ttu-id="baa42-104">En tant que service géré Hadoop, HDInsight assure la mise à jour corrective du système d’exploitation des machines virtuelles sous-jacentes utilisées par les clusters HDInsight.</span><span class="sxs-lookup"><span data-stu-id="baa42-104">As a managed Hadoop service, HDInsight takes care of patching the OS of the underlying VMs used by HDInsight clusters.</span></span> <span data-ttu-id="baa42-105">Depuis le 1er août 2016, nous avons modifié la stratégie de gestion des mises à jour correctives du système d’exploitation invité pour les clusters HDInsight sous Linux (version 3.4 ou supérieure).</span><span class="sxs-lookup"><span data-stu-id="baa42-105">As of August 1, 2016, we have changed the guest OS patching policy for Linux-based HDInsight clusters (version 3.4 or greater).</span></span> <span data-ttu-id="baa42-106">L’objectif de la nouvelle stratégie est de réduire considérablement le nombre de redémarrages dus à la mise à jour corrective.</span><span class="sxs-lookup"><span data-stu-id="baa42-106">The goal of the new policy is to significantly reduce the number of reboots due to patching.</span></span> <span data-ttu-id="baa42-107">La nouvelle stratégie exécutera les correctifs sur des machines virtuelles dans des clusters Linux chaque lundi ou un jeudi à partir de minuit (UTC) de manière échelonnée sur les nœuds dans tout cluster donné.</span><span class="sxs-lookup"><span data-stu-id="baa42-107">The new policy will continue to patch virtual machines (VMs) on Linux clusters every Monday or Thursday starting at 12AM UTC in a staggered fashion across nodes in any given cluster.</span></span> <span data-ttu-id="baa42-108">Toutefois, toute machine virtuelle donnée ne redémarrera qu’une fois tous les 30 jours au maximum en raison de la mise à jour corrective du système d’exploitation invité.</span><span class="sxs-lookup"><span data-stu-id="baa42-108">However, any given VM will only reboot at most once every 30 days due to guest OS patching.</span></span> <span data-ttu-id="baa42-109">En outre, le premier redémarrage d’un cluster nouvellement créé aura lieu au plus tôt 30 jours après la date de création du cluster.</span><span class="sxs-lookup"><span data-stu-id="baa42-109">In addition, the first reboot for a newly created cluster will not happen sooner than 30 days from the cluster creation date.</span></span> <span data-ttu-id="baa42-110">Les correctifs seront appliqués une fois les machines virtuelles redémarrées.</span><span class="sxs-lookup"><span data-stu-id="baa42-110">Patches will be effective once the VMs are rebooted.</span></span>

## <a name="how-to-configure-the-os-patching-schedule-for-linux-based-hdinsight-clusters"></a><span data-ttu-id="baa42-111">Comment configurer la planification de la mise à jour corrective du système d’exploitation pour les clusters HDInsight sous Linux</span><span class="sxs-lookup"><span data-stu-id="baa42-111">How to configure the OS patching schedule for Linux-based HDInsight clusters</span></span>
<span data-ttu-id="baa42-112">Les machines virtuelles d’un cluster HDInsight doivent être occasionnellement redémarrées pour assurer l’installation des correctifs de sécurité importants.</span><span class="sxs-lookup"><span data-stu-id="baa42-112">The virtual machines in an HDInsight cluster need to be rebooted occasionally so that important security patches can be installed.</span></span> <span data-ttu-id="baa42-113">Depuis le 1er août 2016, les nouveaux clusters HDInsight sous Linux (version 3.4 ou supérieure) sont redémarrés suivant la planification suivante :</span><span class="sxs-lookup"><span data-stu-id="baa42-113">As of August 1, 2016, new Linux-based HDInsight clusters (version 3.4 or greater,) are rebooted using the following schedule:</span></span>

1. <span data-ttu-id="baa42-114">Une machine virtuelle du cluster peut redémarrer une seule fois sur une période de 30 jours pour l’application des correctifs.</span><span class="sxs-lookup"><span data-stu-id="baa42-114">A virtual machine in the cluster can only reboot for patches at most, once within a 30-day period.</span></span>
2. <span data-ttu-id="baa42-115">Le redémarrage s’effectue à partir de minuit (UTC).</span><span class="sxs-lookup"><span data-stu-id="baa42-115">The reboot occurs starting at 12AM UTC.</span></span>
3. <span data-ttu-id="baa42-116">Le processus de redémarrage est échelonné entre les différentes machines virtuelles du cluster. Ainsi, le cluster reste disponible pendant le processus de redémarrage.</span><span class="sxs-lookup"><span data-stu-id="baa42-116">The reboot process is staggered across virtual machines in the cluster, so the cluster is still available during the reboot process.</span></span>
4. <span data-ttu-id="baa42-117">Le premier redémarrage d’un cluster nouvellement créé aura lieu au plus tôt 30 jours après la date de création du cluster.</span><span class="sxs-lookup"><span data-stu-id="baa42-117">The first reboot for a newly created cluster will not happen sooner than 30 days after the cluster creation date.</span></span>

<span data-ttu-id="baa42-118">À l’aide de l’action de script décrite dans cet article, vous pouvez modifier la planification de la mise à jour corrective du système d’exploitation comme suit :</span><span class="sxs-lookup"><span data-stu-id="baa42-118">Using the script action described in this article, you can modify the OS patching schedule as follows:</span></span>
1. <span data-ttu-id="baa42-119">Activez ou désactivez les redémarrages automatiques.</span><span class="sxs-lookup"><span data-stu-id="baa42-119">Enable or disable automatic reboots</span></span>
2. <span data-ttu-id="baa42-120">Définissez la fréquence de redémarrage (en jours entre les redémarrages).</span><span class="sxs-lookup"><span data-stu-id="baa42-120">Set the frequency of reboots (days between reboots)</span></span>
3. <span data-ttu-id="baa42-121">Définissez le jour de la semaine auquel s’effectue le redémarrage.</span><span class="sxs-lookup"><span data-stu-id="baa42-121">Set the day of the week when a reboot occurs</span></span>

> [!NOTE]
> <span data-ttu-id="baa42-122">Cette action de script fonctionne uniquement avec les clusters HDInsight sous Linux créés après le 1er août 2016.</span><span class="sxs-lookup"><span data-stu-id="baa42-122">This script action will only work with Linux-based HDInsight clusters created after August 1st, 2016.</span></span> <span data-ttu-id="baa42-123">Les correctifs seront appliqués une fois les machines virtuelles redémarrées.</span><span class="sxs-lookup"><span data-stu-id="baa42-123">Patches will be effective only when VMs are rebooted.</span></span> 
>

## <a name="how-to-use-the-script"></a><span data-ttu-id="baa42-124">Utilisation du script</span><span class="sxs-lookup"><span data-stu-id="baa42-124">How to use the script</span></span> 

<span data-ttu-id="baa42-125">L’utilisation de ce script requiert les informations suivantes :</span><span class="sxs-lookup"><span data-stu-id="baa42-125">When using this script requires the following information:</span></span>
1. <span data-ttu-id="baa42-126">L’emplacement du script : https://hdiconfigactions.blob.core.windows.net/linuxospatchingrebootconfigv01/os-patching-reboot-config.sh.</span><span class="sxs-lookup"><span data-stu-id="baa42-126">The script location: https://hdiconfigactions.blob.core.windows.net/linuxospatchingrebootconfigv01/os-patching-reboot-config.sh.</span></span>
    <span data-ttu-id="baa42-127">HDInsight utilise cet URI pour rechercher et exécuter le script sur toutes les machines virtuelles du cluster.</span><span class="sxs-lookup"><span data-stu-id="baa42-127">HDInsight uses this URI to find and run the script on all the virtual machines in the cluster.</span></span>
  
2. <span data-ttu-id="baa42-128">Les types de nœud de cluster auxquels s’applique le script : headnode, workernode, zookeeper.</span><span class="sxs-lookup"><span data-stu-id="baa42-128">The cluster node types that the script is applied to: headnode, workernode, zookeeper.</span></span> <span data-ttu-id="baa42-129">Ce script doit être appliqué à tous les types de nœud du cluster.</span><span class="sxs-lookup"><span data-stu-id="baa42-129">This script must be applied to all node types in the cluster.</span></span> <span data-ttu-id="baa42-130">S’il n’est pas appliqué à un type de nœud, les machines virtuelles associées au type de nœud concerné continueront d’utiliser la planification de mise à jour corrective précédente.</span><span class="sxs-lookup"><span data-stu-id="baa42-130">If it is not applied to a node type, then the virtual machines for that node type will continue to use the previous patching schedule.</span></span>


3.  <span data-ttu-id="baa42-131">Paramètre : ce script accepte trois paramètres numériques :</span><span class="sxs-lookup"><span data-stu-id="baa42-131">Parameter: This script accepts three numeric parameters:</span></span>

    | <span data-ttu-id="baa42-132">Paramètre</span><span class="sxs-lookup"><span data-stu-id="baa42-132">Parameter</span></span> | <span data-ttu-id="baa42-133">Définition</span><span class="sxs-lookup"><span data-stu-id="baa42-133">Definition</span></span> |
    | --- | --- |
    | <span data-ttu-id="baa42-134">Activation ou désactivation des redémarrages automatiques</span><span class="sxs-lookup"><span data-stu-id="baa42-134">Enable/disable automatic reboots</span></span> |<span data-ttu-id="baa42-135">0 ou 1.</span><span class="sxs-lookup"><span data-stu-id="baa42-135">0 or 1.</span></span> <span data-ttu-id="baa42-136">La valeur 0 désactive les redémarrages automatiques et la valeur 1 les active.</span><span class="sxs-lookup"><span data-stu-id="baa42-136">A value of 0 disables automatic reboots while 1 enables automatic reboots.</span></span> |
    | <span data-ttu-id="baa42-137">Fréquence</span><span class="sxs-lookup"><span data-stu-id="baa42-137">Frequency</span></span> |<span data-ttu-id="baa42-138">7 à 90 (valeur inclusive).</span><span class="sxs-lookup"><span data-stu-id="baa42-138">7 to 90 (inclusive).</span></span> <span data-ttu-id="baa42-139">Le nombre de jours d’attente avant le redémarrage des machines virtuelles pour les correctifs qui nécessitent un redémarrage.</span><span class="sxs-lookup"><span data-stu-id="baa42-139">The number of days to wait before rebooting the virtual machines for patches that require a reboot.</span></span> |
    | <span data-ttu-id="baa42-140">Jour de semaine</span><span class="sxs-lookup"><span data-stu-id="baa42-140">Day of week</span></span> |<span data-ttu-id="baa42-141">1 à 7 (valeur inclusive).</span><span class="sxs-lookup"><span data-stu-id="baa42-141">1 to 7 (inclusive).</span></span> <span data-ttu-id="baa42-142">La valeur 1 indique que le redémarrage doit s’effectuer un lundi et la valeur 7 indique qu’il doit s’effectuer un dimanche. Par exemple, avec les paramètres 1 60 2, les redémarrages automatiques s’effectueront tous les 60 jours (au plus) le mardi.</span><span class="sxs-lookup"><span data-stu-id="baa42-142">A value of 1 indicates the reboot should occur on a Monday, and 7 indicates a Sunday.For example, using parameters of 1 60 2 results in automatic reboots every 60 days (at most) on Tuesday.</span></span> |
    | <span data-ttu-id="baa42-143">Persistance</span><span class="sxs-lookup"><span data-stu-id="baa42-143">Persistence</span></span> |<span data-ttu-id="baa42-144">Lorsque vous appliquez une action de script à un cluster existant, vous pouvez marquer le script comme persistant.</span><span class="sxs-lookup"><span data-stu-id="baa42-144">When applying a script action to an existing cluster, you can mark the script as persisted.</span></span> <span data-ttu-id="baa42-145">Les scripts persistants sont appliqués lorsque de nouveaux nœuds de type workernode sont ajoutés au cluster lors d’opérations de mise à l’échelle.</span><span class="sxs-lookup"><span data-stu-id="baa42-145">Persisted scripts are applied when new workernodes are added to the cluster through scaling operations.</span></span> |

> [!NOTE]
> <span data-ttu-id="baa42-146">Vous devez marquer ce script comme persistant lorsqu’il s’applique à un cluster existant.</span><span class="sxs-lookup"><span data-stu-id="baa42-146">You must mark this script as persisted when applying to an existing cluster.</span></span> <span data-ttu-id="baa42-147">Sinon, les nœuds créés lors d’opérations de mise à l’échelle utiliseront la planification de mise à jour corrective par défaut.</span><span class="sxs-lookup"><span data-stu-id="baa42-147">Otherwise, any new nodes created through scaling      operations will use the default patching schedule.</span></span>
<span data-ttu-id="baa42-148">Si vous appliquez le script dans le cadre du processus de création du cluster, il est automatiquement défini comme persistant.</span><span class="sxs-lookup"><span data-stu-id="baa42-148">If you apply the script as part of the cluster creation process, it is persisted automatically.</span></span>
>

## <a name="next-steps"></a><span data-ttu-id="baa42-149">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="baa42-149">Next steps</span></span>

<span data-ttu-id="baa42-150">Pour connaître les étapes spécifiques à l’utilisation de l’action de script, consultez les sections suivantes de l’article [Personnalisation de clusters HDInsight basés sur Linux à l’aide d’une action de script](hdinsight-hadoop-customize-cluster-linux.md) :</span><span class="sxs-lookup"><span data-stu-id="baa42-150">For specific steps on using the script action, see the following sections in the [Customize Linuz-based HDInsight clusters using script action](hdinsight-hadoop-customize-cluster-linux.md):</span></span>

* [<span data-ttu-id="baa42-151">Utiliser une action de script lors de la création du cluster</span><span class="sxs-lookup"><span data-stu-id="baa42-151">Use a script action during cluster creation</span></span>](hdinsight-hadoop-customize-cluster-linux.md#use-a-script-action-during-cluster-creation)
* [<span data-ttu-id="baa42-152">Appliquer une action de script sur un cluster en cours d’exécution</span><span class="sxs-lookup"><span data-stu-id="baa42-152">Apply a script action to a running cluster</span></span>](hdinsight-hadoop-customize-cluster-linux.md#apply-a-script-action-to-a-running-cluster)
