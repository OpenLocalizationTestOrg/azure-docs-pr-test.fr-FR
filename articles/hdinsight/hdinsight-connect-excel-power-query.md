---
title: "Connexion d’Excel à Hadoop à l’aide de Power Query - Azure HDInsight | Microsoft Docs"
description: "Découvrez comment tirer profit des outils décisionnels et utiliser Power Query pour Excel afin d’accéder aux données stockées dans Hadoop sur HDInsight."
services: hdinsight
documentationcenter: 
tags: azure-portal
author: mumian
manager: jhubbard
editor: cgronlun
ms.assetid: 01ad2f90-7520-44d9-8c16-4d936faaff9b
ms.service: hdinsight
ms.custom: hdinsightactive
ms.workload: big-data
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/11/2017
ms.author: jgao
ms.openlocfilehash: 6a15efb091b4faaa7305bb8faa362c62fac595cb
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/03/2017
---
# <a name="connect-excel-to-hadoop-by-using-power-query"></a><span data-ttu-id="0a058-103">Connexion d’Excel à Hadoop à l’aide de Power Query</span><span class="sxs-lookup"><span data-stu-id="0a058-103">Connect Excel to Hadoop by using Power Query</span></span>
<span data-ttu-id="0a058-104">Une fonctionnalité clé de la solution de données volumineuses (« big data ») de Microsoft est l’intégration d’outils décisionnels (BI) Microsoft à des clusters Hadoop dans Azure HDInsight.</span><span class="sxs-lookup"><span data-stu-id="0a058-104">One key feature of the Microsoft big-data solution is the integration of Microsoft business intelligence (BI) components with Hadoop clusters in Azure HDInsight.</span></span> <span data-ttu-id="0a058-105">Un exemple important de cette intégration est la possibilité de connecter Excel au compte Azure Storage contenant les données associées à votre cluster Hadoop en utilisant le complément Microsoft Power Query pour Excel.</span><span class="sxs-lookup"><span data-stu-id="0a058-105">A primary example is the ability to connect Excel to the Azure Storage account that contains the data associated with your Hadoop cluster by using the Microsoft Power Query for Excel add-in.</span></span> <span data-ttu-id="0a058-106">Cet article vous explique comment configurer et utiliser Power Query pour interroger des données associées à un cluster Hadoop géré avec HDInsight.</span><span class="sxs-lookup"><span data-stu-id="0a058-106">This article walks you through how to set up and use Power Query to query data associated with a Hadoop cluster managed with HDInsight.</span></span>

### <a name="prerequisites"></a><span data-ttu-id="0a058-107">Composants requis</span><span class="sxs-lookup"><span data-stu-id="0a058-107">Prerequisites</span></span>
<span data-ttu-id="0a058-108">Avant de commencer cet article, vous devez disposer des éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="0a058-108">Before you begin this article, you must have the following items:</span></span>

* <span data-ttu-id="0a058-109">**Un cluster HDInsight**.</span><span class="sxs-lookup"><span data-stu-id="0a058-109">**An HDInsight cluster**.</span></span> <span data-ttu-id="0a058-110">Pour en configurer un, consultez la page [Prise en main d’Azure HDInsight][hdinsight-get-started].</span><span class="sxs-lookup"><span data-stu-id="0a058-110">To configure one, see [Get started with Azure HDInsight][hdinsight-get-started].</span></span>
* <span data-ttu-id="0a058-111">**Une station de travail** fonctionnant sous Windows 7, Windows Server 2008 R2 ou une version ultérieure.</span><span class="sxs-lookup"><span data-stu-id="0a058-111">**A workstation** that is running Windows 7, Windows Server 2008 R2, or a later operating system.</span></span>
* <span data-ttu-id="0a058-112">**Office 2016, Office 2013 Professionnel Plus, Office 365 ProPlus, Excel 2013 autonome ou Office 2010 Professionnel Plus**.</span><span class="sxs-lookup"><span data-stu-id="0a058-112">**Office 2016, Office 2013 Professional Plus, Office 365 ProPlus, Excel 2013 Standalone, or Office 2010 Professional Plus**.</span></span>

## <a name="install-power-query"></a><span data-ttu-id="0a058-113">Installation de Power Query</span><span class="sxs-lookup"><span data-stu-id="0a058-113">Install Power Query</span></span>
<span data-ttu-id="0a058-114">Power Query permet d'importer des données produites ou générées par un travail Hadoop s'exécutant sur un cluster HDInsight.</span><span class="sxs-lookup"><span data-stu-id="0a058-114">Power Query can import data that has been output or that has been generated by a Hadoop job running on an HDInsight cluster.</span></span>

<span data-ttu-id="0a058-115">Dans Excel 2016, Power Query a été intégré dans le ruban de données sous la section Obtenir et transformer.</span><span class="sxs-lookup"><span data-stu-id="0a058-115">In Excel 2016, Power Query has been integrated into the Data ribbon under the Get & Transform section.</span></span> <span data-ttu-id="0a058-116">Pour les versions Excel plus anciennes, téléchargez Microsoft Power Query pour Excel depuis le [Centre de téléchargement Microsoft][powerquery-download] et installez-le.</span><span class="sxs-lookup"><span data-stu-id="0a058-116">For older Excel versions, download Microsoft Power Query for Excel from the [Microsoft Download Center][powerquery-download] and install it.</span></span>

## <a name="import-hdinsight-data-into-excel"></a><span data-ttu-id="0a058-117">Importation de données HDInsight dans Excel</span><span class="sxs-lookup"><span data-stu-id="0a058-117">Import HDInsight data into Excel</span></span>
<span data-ttu-id="0a058-118">Le complément Power Query pour Excel facilite l’importation de données depuis votre cluster HDInsight dans Excel, où des outils décisionnels tels que PowerPivot et Power Map peuvent être utilisés pour inspecter, analyser et présenter les données.</span><span class="sxs-lookup"><span data-stu-id="0a058-118">The Power Query add-in for Excel makes it easy to import data from your HDInsight cluster into Excel, where BI tools such as PowerPivot and Power Map can be used to inspect, analyze, and present the data.</span></span>

<span data-ttu-id="0a058-119">**Pour importer des données à partir d’un cluster HDInsight**</span><span class="sxs-lookup"><span data-stu-id="0a058-119">**To import data from an HDInsight cluster**</span></span>

1. <span data-ttu-id="0a058-120">Ouvrez Excel.</span><span class="sxs-lookup"><span data-stu-id="0a058-120">Open Excel.</span></span>
2. <span data-ttu-id="0a058-121">Créez un classeur vide.</span><span class="sxs-lookup"><span data-stu-id="0a058-121">Create a new blank workbook.</span></span>
3. <span data-ttu-id="0a058-122">Effectuez les étapes suivantes, selon la version d’Excel :</span><span class="sxs-lookup"><span data-stu-id="0a058-122">Perform the following steps based on the Excel version:</span></span>

    - <span data-ttu-id="0a058-123">Excel 2016</span><span class="sxs-lookup"><span data-stu-id="0a058-123">Excel 2016</span></span>

        - <span data-ttu-id="0a058-124">Cliquez sur le menu **Données**, cliquez sur **Obtenir des données** à partir du ruban **Obtenir et transformer des données**, cliquez sur **Depuis Azure**, puis cliquez sur **Depuis Azure HDInsight(HDFS)**.</span><span class="sxs-lookup"><span data-stu-id="0a058-124">Click the **Data** menu, click **Get Data** from the **Get & Transform Data** ribbon, click **From Azure**, and then click **From Azure HDInsight(HDFS)**.</span></span>

        ![HDI.PowerQuery.SelectHdiSource](./media/hdinsight-connect-excel-power-query/hdi.powerquery.selecthdisource.excel2016.png)

    - <span data-ttu-id="0a058-126">Excel 2013/2010</span><span class="sxs-lookup"><span data-stu-id="0a058-126">Excel 2013/2010</span></span>

        - <span data-ttu-id="0a058-127">Cliquez dans le menu **Power Query**, cliquez sur **À partir d'Azure**, puis sur **Depuis Microsoft Azure HDInsight**.</span><span class="sxs-lookup"><span data-stu-id="0a058-127">Click the **Power Query** menu, click **From Azure**, and then click **From Microsoft Azure HDInsight**.</span></span>
   
        ![HDI.PowerQuery.SelectHdiSource][image-hdi-powerquery-hdi-source]
       
        <span data-ttu-id="0a058-129">**Remarque :** si vous ne voyez pas le menu **Power Query**, cliquez sur **Fichier** > **Options** > **Compléments** et sélectionnez **Compléments COM** dans la zone déroulante **Gestionnaire** en bas de la page.</span><span class="sxs-lookup"><span data-stu-id="0a058-129">**Note:** If you don't see the **Power Query** menu, go to **File** > **Options** > **Add-Ins**, and select **COM Add-ins** from the drop-down **Manage** box at the bottom of the page.</span></span> <span data-ttu-id="0a058-130">Sélectionnez le bouton **OK** et vérifiez que la case correspondant au complément Power Query pour Excel a été cochée.</span><span class="sxs-lookup"><span data-stu-id="0a058-130">Select the **Go...** button and verify that the box for the Power Query for Excel add-in has been checked.</span></span>
       
        <span data-ttu-id="0a058-131">**Remarque :** Power Query vous permet également d'importer des données à partir de HDFS en cliquant sur **À partir d'autres sources**.</span><span class="sxs-lookup"><span data-stu-id="0a058-131">**Note:** Power Query also allows you to import data from HDFS by clicking **From Other Sources**.</span></span>
4. <span data-ttu-id="0a058-132">Pour le champ **Nom du compte**, saisissez le nom du compte de stockage d’objets blob Azure associé à votre cluster, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="0a058-132">For **Account Name**, enter the name of the Azure Blob storage account associated with your cluster, and then click **OK**.</span></span> <span data-ttu-id="0a058-133">Il peut s’agir du [compte de stockage par défaut](hdinsight-administer-use-management-portal.md#find-the-default-storage-account) ou d’un compte de stockage lié.</span><span class="sxs-lookup"><span data-stu-id="0a058-133">This account can be the [default storage account](hdinsight-administer-use-management-portal.md#find-the-default-storage-account) or a linked storage account.</span></span>  <span data-ttu-id="0a058-134">Le format est *https://&lt;StorageAccountName>.blob.core.windows.net/*.</span><span class="sxs-lookup"><span data-stu-id="0a058-134">The format is *https://&lt;StorageAccountName>.blob.core.windows.net/*.</span></span>
5. <span data-ttu-id="0a058-135">Pour le champ **Clé du compte**, saisissez la clé du compte de stockage d’objets blob, puis cliquez sur **Enregistrer**.</span><span class="sxs-lookup"><span data-stu-id="0a058-135">For **Account Key**, enter the key for the Blob storage account, and then click **Save**.</span></span> <span data-ttu-id="0a058-136">(Entrez les informations sur le compte uniquement la première fois que vous accédez à ce Store.)</span><span class="sxs-lookup"><span data-stu-id="0a058-136">(You need to enter the account information only the first time you access this store.)</span></span>
6. <span data-ttu-id="0a058-137">Dans le volet **Navigateur** situé à gauche de l’Éditeur de requête, double-cliquez sur le nom du conteneur de stockage d’objets Blob.</span><span class="sxs-lookup"><span data-stu-id="0a058-137">In the **Navigator** pane on the left of the Query Editor, double-click the Blob storage container name.</span></span> <span data-ttu-id="0a058-138">Par défaut, le nom du conteneur est identique à celui du cluster.</span><span class="sxs-lookup"><span data-stu-id="0a058-138">By default, the container name is the same name as the cluster name.</span></span>
7. <span data-ttu-id="0a058-139">Localisez **HiveSampleData.txt** dans la colonne **Nom** (le chemin du dossier est **../hive/warehouse/hivesampletable/**), puis cliquez sur **Binaire** à gauche de HiveSampleData.txt.</span><span class="sxs-lookup"><span data-stu-id="0a058-139">Locate **HiveSampleData.txt** in the **Name** column (the folder path is **../hive/warehouse/hivesampletable/**), and then click **Binary** on the left of HiveSampleData.txt.</span></span> <span data-ttu-id="0a058-140">HiveSampleData.txt est fourni avec tout le cluster.</span><span class="sxs-lookup"><span data-stu-id="0a058-140">HiveSampleData.txt comes with all the cluster.</span></span> <span data-ttu-id="0a058-141">Si vous le souhaitez, vous pouvez utiliser votre propre fichier.</span><span class="sxs-lookup"><span data-stu-id="0a058-141">Optionally, you can use your own file.</span></span>
   
    ![HDI.PowerQuery.ImportData][image-hdi-powerquery-importdata]
8. <span data-ttu-id="0a058-143">Le cas échéant, vous pouvez renommer le nom des colonnes.</span><span class="sxs-lookup"><span data-stu-id="0a058-143">If you want, you can rename the column names.</span></span> <span data-ttu-id="0a058-144">Lorsque vous êtes prêt, cliquez sur **Fermer et charger**.</span><span class="sxs-lookup"><span data-stu-id="0a058-144">When you are ready, click **Close & Load**.</span></span>  <span data-ttu-id="0a058-145">Les données ont été chargées dans votre classeur :</span><span class="sxs-lookup"><span data-stu-id="0a058-145">The data has been loaded to your workbook:</span></span>
   
    ![HDI.PowerQuery.ImportedTable][image-hdi-powerquery-imported-table]

## <a name="next-steps"></a><span data-ttu-id="0a058-147">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="0a058-147">Next steps</span></span>
<span data-ttu-id="0a058-148">Dans cet article, vous avez appris à utiliser Power Query pour extraire des données de HDInsight et les importer dans Excel.</span><span class="sxs-lookup"><span data-stu-id="0a058-148">In this article, you learned how to use Power Query to retrieve data from HDInsight into Excel.</span></span> <span data-ttu-id="0a058-149">De la même façon, vous pouvez extraire des données de HDInsight et les importer dans une base de données SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="0a058-149">Similarly, you can retrieve data from HDInsight into Azure SQL Database.</span></span> <span data-ttu-id="0a058-150">Il est également possible de télécharger des données dans HDInsight.</span><span class="sxs-lookup"><span data-stu-id="0a058-150">It is also possible to upload data into HDInsight.</span></span> <span data-ttu-id="0a058-151">Pour en savoir plus, consultez les articles suivants :</span><span class="sxs-lookup"><span data-stu-id="0a058-151">To learn more, see the following articles:</span></span>

* <span data-ttu-id="0a058-152">[Connexion d’Excel à HDInsight à l’aide du pilote ODBC Microsoft Hive][hdinsight-ODBC]</span><span class="sxs-lookup"><span data-stu-id="0a058-152">[Connect Excel to HDInsight with the Microsoft Hive ODBC Driver][hdinsight-ODBC]</span></span>
* <span data-ttu-id="0a058-153">[Téléchargement de données vers HDInsight][hdinsight-upload-data]</span><span class="sxs-lookup"><span data-stu-id="0a058-153">[Upload Data to HDInsight][hdinsight-upload-data]</span></span>

[hdinsight-ODBC]: hdinsight-connect-excel-hive-odbc-driver.md
[hdinsight-get-started]: hdinsight-hadoop-linux-tutorial-get-started.md
[hdinsight-upload-data]: hdinsight-upload-data.md

[image-hdi-powerquery-hdi-source]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.selecthdisource.png
[image-hdi-powerquery-importdata]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.importdata.png
[image-hdi-powerquery-imported-table]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.importedtable.PNG

[powerquery-download]: http://go.microsoft.com/fwlink/?LinkID=286689
