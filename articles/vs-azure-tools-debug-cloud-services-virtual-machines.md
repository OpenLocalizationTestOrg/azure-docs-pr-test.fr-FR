---
title: "Débogage d’un service cloud ou d’une machine virtuelle Azure dans Visual Studio | Microsoft Docs"
description: "Débogage d’un service cloud ou d’une machine virtuelle dans Visual Studio"
services: visual-studio-online
documentationcenter: na
author: kraigb
manager: ghogen
editor: 
ms.assetid: 945e06e0-2100-41af-b218-72347367ddab
ms.service: visual-studio-online
ms.devlang: multiple
ms.topic: article
ms.tgt_pltfrm: multiple
ms.workload: na
ms.date: 11/11/2016
ms.author: kraigb
ms.openlocfilehash: 2ea3a9d6b3bdd873c139064b3c400eff5977eda4
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/29/2017
---
# <a name="debugging-an-azure-cloud-service-or-virtual-machine-in-visual-studio"></a><span data-ttu-id="df168-103">Débogage d'un service cloud ou d'une machine virtuelle Azure dans Visual Studio</span><span class="sxs-lookup"><span data-stu-id="df168-103">Debugging an Azure cloud service or virtual machine in Visual Studio</span></span>
<span data-ttu-id="df168-104">Visual Studio vous offre différentes options de débogage des machines virtuelles et services cloud Azure.</span><span class="sxs-lookup"><span data-stu-id="df168-104">Visual Studio gives you different options for debugging Azure cloud services and virtual machines.</span></span>

## <a name="debug-your-cloud-service-on-your-local-computer"></a><span data-ttu-id="df168-105">Déboguer votre service cloud sur votre ordinateur local</span><span class="sxs-lookup"><span data-stu-id="df168-105">Debug your cloud service on your local computer</span></span>
<span data-ttu-id="df168-106">L’utilisation de l’émulateur de calcul Azure pour déboguer votre service cloud sur une machine locale constitue un gain de temps et d’argent.</span><span class="sxs-lookup"><span data-stu-id="df168-106">You can save time and money by using the Azure compute emulator to debug your cloud service on a local machine.</span></span> <span data-ttu-id="df168-107">Déboguer un service localement avant de le déployer vous permet d’améliorer la fiabilité et les performances, tout en évitant les coûts de temps de calcul.</span><span class="sxs-lookup"><span data-stu-id="df168-107">By debugging a service locally before you deploy it, you can improve reliability and performance without paying for compute time.</span></span> <span data-ttu-id="df168-108">Certaines erreurs peuvent toutefois se produire quand vous exécutez un service cloud directement dans Azure.</span><span class="sxs-lookup"><span data-stu-id="df168-108">However, some errors might occur only when you run a cloud service in Azure itself.</span></span> <span data-ttu-id="df168-109">Vous pouvez déboguer ces erreurs si vous activez le débogage distant quand vous publiez votre service, puis attachez le débogueur à une instance de rôle.</span><span class="sxs-lookup"><span data-stu-id="df168-109">You can debug these errors if you enable remote debugging when you publish your service and then attach the debugger to a role instance.</span></span>

<span data-ttu-id="df168-110">L’émulateur simule le service de calcul Azure et s’exécute dans votre environnement local pour vous permettre de tester et déboguer votre service cloud avant son déploiement.</span><span class="sxs-lookup"><span data-stu-id="df168-110">The emulator simulates the Azure Compute service and runs in your local environment so that you can test and debug your cloud service before you deploy it.</span></span> <span data-ttu-id="df168-111">Il gère le cycle de vie de vos instances de rôle et donne accès aux ressources simulées, telles que le stockage local.</span><span class="sxs-lookup"><span data-stu-id="df168-111">The emulator handles the lifecycle of your role instances and provides access to simulated resources, such as local storage.</span></span> <span data-ttu-id="df168-112">Quand vous déboguez ou exécutez votre service à partir de Visual Studio, le programme démarre automatiquement l’émulateur comme une application d’arrière-plan, puis déploie votre service vers l’émulateur.</span><span class="sxs-lookup"><span data-stu-id="df168-112">When you debug or run your service from Visual Studio, it automatically starts the emulator as a background application and then deploys your service to the emulator.</span></span> <span data-ttu-id="df168-113">Vous pouvez utiliser l’émulateur pour voir votre service en cours d’exécution dans l’environnement local.</span><span class="sxs-lookup"><span data-stu-id="df168-113">You can use the emulator to view your service when it runs in the local environment.</span></span> <span data-ttu-id="df168-114">Vous pouvez exécuter la version complète ou express de l’émulateur.</span><span class="sxs-lookup"><span data-stu-id="df168-114">You can run the full version or the express version of the emulator.</span></span> <span data-ttu-id="df168-115">(À partir d’Azure 2.3, la version express de l’émulateur est celle par défaut.) Consultez [Utilisation de l’émulateur express pour exécuter et déboguer un service cloud localement](https://msdn.microsoft.com/library/dn339018.aspx).</span><span class="sxs-lookup"><span data-stu-id="df168-115">(Starting with Azure 2.3, the express version of the emulator is the default.) See [Using Emulator Express to Run and Debug a Cloud Service Locally](https://msdn.microsoft.com/library/dn339018.aspx).</span></span>

### <a name="to-debug-your-cloud-service-on-your-local-computer"></a><span data-ttu-id="df168-116">Pour déboguer votre service cloud sur votre ordinateur local</span><span class="sxs-lookup"><span data-stu-id="df168-116">To debug your cloud service on your local computer</span></span>
1. <span data-ttu-id="df168-117">Dans la barre de menus, sélectionnez **Déboguer**, **Démarrer le débogage** pour exécuter votre projet de service cloud Azure.</span><span class="sxs-lookup"><span data-stu-id="df168-117">On the menu bar, choose **Debug**, **Start Debugging** to run your Azure cloud service project.</span></span> <span data-ttu-id="df168-118">Vous pouvez aussi appuyer sur F5.</span><span class="sxs-lookup"><span data-stu-id="df168-118">As an alternative, you can press F5.</span></span> <span data-ttu-id="df168-119">Un message s’affiche, indiquant que l’émulateur de calcul est en cours de démarrage.</span><span class="sxs-lookup"><span data-stu-id="df168-119">You’ll see a message that the Compute Emulator is starting.</span></span> <span data-ttu-id="df168-120">Une icône s’affiche dans la zone de notification pour confirmer le démarrage de l’émulateur.</span><span class="sxs-lookup"><span data-stu-id="df168-120">When the emulator starts, the system tray icon confirms it.</span></span>

    ![Émulateur Azure dans la zone de notification](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC783828.png)
2. <span data-ttu-id="df168-122">Affichez l’interface utilisateur de l’émulateur de calcul en ouvrant le menu contextuel de l’icône Azure dans la zone de notification, puis en sélectionnant **Afficher l’interface utilisateur de l’émulateur de calcul**.</span><span class="sxs-lookup"><span data-stu-id="df168-122">Display the user interface for the compute emulator by opening the shortcut menu for the Azure icon in the notification area, and then select **Show Compute Emulator UI**.</span></span>

    <span data-ttu-id="df168-123">Le volet gauche de l'interface utilisateur montre les services actuellement déployés sur l'émulateur de calcul et les instances de rôle en cours d'exécution sur chaque service.</span><span class="sxs-lookup"><span data-stu-id="df168-123">The left pane of the UI shows the services that are currently deployed to the compute emulator and the role instances that each service is running.</span></span> <span data-ttu-id="df168-124">Vous pouvez sélectionner le service ou des rôles pour afficher les informations liées au cycle de vie, aux journaux et aux diagnostics dans le volet de droite.</span><span class="sxs-lookup"><span data-stu-id="df168-124">You can choose the service or roles to display lifecycle, logging, and diagnostic information in the right pane.</span></span> <span data-ttu-id="df168-125">Si vous placez le focus dans la marge supérieure d’une fenêtre incluse, celle-ci se développe pour remplir le volet droit.</span><span class="sxs-lookup"><span data-stu-id="df168-125">If you put the focus in the top margin of an included window, it expands to fill the right pane.</span></span>
3. <span data-ttu-id="df168-126">Parcourez l’application en sélectionnant les commandes du menu **Déboguer** et en définissant des points d’arrêt dans votre code.</span><span class="sxs-lookup"><span data-stu-id="df168-126">Step through the application by selecting commands on the **Debug** menu and setting breakpoints in your code.</span></span> <span data-ttu-id="df168-127">À mesure que vous parcourez l'application dans le débogueur, les volets sont mis à jour avec l'état actuel de l'application.</span><span class="sxs-lookup"><span data-stu-id="df168-127">As you step through the application in the debugger, the panes are updated with the current status of the application.</span></span> <span data-ttu-id="df168-128">Lorsque vous arrêtez le débogage, le déploiement de l’application est supprimé.</span><span class="sxs-lookup"><span data-stu-id="df168-128">When you stop debugging, the application deployment is deleted.</span></span> <span data-ttu-id="df168-129">Si votre application inclut un rôle web et que vous avez réglé la propriété Action de démarrage pour démarrer le navigateur web, Visual Studio démarre votre application web dans le navigateur.</span><span class="sxs-lookup"><span data-stu-id="df168-129">If your application includes a web role and you've set the Startup action property to start the web browser, Visual Studio starts your web application in the browser.</span></span> <span data-ttu-id="df168-130">Si vous modifiez le nombre d’instances d’un rôle dans la configuration du service, vous devez arrêter votre service cloud, puis redémarrer le débogage afin de pouvoir déboguer ces nouvelles instances du rôle.</span><span class="sxs-lookup"><span data-stu-id="df168-130">If you change the number of instances of a role in the service configuration, you must stop your cloud service and then restart debugging so that you can debug these new instances of the role.</span></span>

    <span data-ttu-id="df168-131">**Remarque** : quand vous arrêtez l’exécution ou le débogage de votre service, l’émulateur de calcul et l’émulateur de stockage locaux ne sont pas interrompus.</span><span class="sxs-lookup"><span data-stu-id="df168-131">**Note:** When you stop running or debugging your service, the local compute emulator and storage emulator aren't stopped.</span></span> <span data-ttu-id="df168-132">Vous devez les arrêter explicitement à partir de la zone de notification.</span><span class="sxs-lookup"><span data-stu-id="df168-132">You must stop them explicitly from the notification area.</span></span>

## <a name="debug-a-cloud-service-in-azure"></a><span data-ttu-id="df168-133">Déboguer un service cloud dans Azure</span><span class="sxs-lookup"><span data-stu-id="df168-133">Debug a cloud service in Azure</span></span>
<span data-ttu-id="df168-134">Pour déboguer un service cloud à partir d’une machine distante, vous devez activer cette fonctionnalité de façon explicite au moment du déploiement de ce service. Tous les services nécessaires (msvsmon.exe, par exemple) sont alors installés sur les machines virtuelles qui exécutent vos instances de rôle.</span><span class="sxs-lookup"><span data-stu-id="df168-134">To debug a cloud service from a remote machine, you must enable that functionality explicitly when you deploy your cloud service so that required services (msvsmon.exe, for example) are installed on the virtual machines that run your role instances.</span></span> <span data-ttu-id="df168-135">Si vous n’avez pas activé le débogage distant quand vous avez publié le service, vous devez republier ce service avec le débogage distant activé.</span><span class="sxs-lookup"><span data-stu-id="df168-135">If you didn't enable remote debugging when you published the service, you have to republish the service with remote debugging enabled.</span></span>

<span data-ttu-id="df168-136">L’activation du débogage distant pour un service cloud n’entraîne pas de baisse des performances, ni de coûts supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="df168-136">If you enable remote debugging for a cloud service, it doesn't exhibit degraded performance or incur additional charges.</span></span> <span data-ttu-id="df168-137">Vous ne devez pas utiliser le débogage distant pour un service de production, car cela peut avoir un impact pour les clients qui utilisent ce service.</span><span class="sxs-lookup"><span data-stu-id="df168-137">You shouldn't use remote debugging on a production service, because clients who use the service might be adversely affected.</span></span>

> [!NOTE]
> <span data-ttu-id="df168-138">Quand vous publiez un service cloud à partir de Visual Studio, vous pouvez activer **IntelliTrace** pour tous les rôles de ce service qui ciblent .NET Framework 4 ou .NET Framework 4.5.</span><span class="sxs-lookup"><span data-stu-id="df168-138">When you publish a cloud service from Visual Studio, you can enable **IntelliTrace** for any roles in that service that target the .NET Framework 4 or the .NET Framework 4.5.</span></span> <span data-ttu-id="df168-139">Avec **IntelliTrace**, vous pouvez examiner des événements qui se sont déjà produits dans une instance de rôle et reproduire le contexte de ce moment-là.</span><span class="sxs-lookup"><span data-stu-id="df168-139">By using **IntelliTrace**, you can examine events that occurred in a role instance in the past and reproduce the context from that time.</span></span> <span data-ttu-id="df168-140">Consultez [Débogage d’un service cloud publié avec IntelliTrace et Visual Studio](http://go.microsoft.com/fwlink/?LinkID=623016) et [Utilisation d’IntelliTrace](https://msdn.microsoft.com/library/dd264915.aspx).</span><span class="sxs-lookup"><span data-stu-id="df168-140">See [Debugging a published cloud service with IntelliTrace and Visual Studio](http://go.microsoft.com/fwlink/?LinkID=623016) and [Using IntelliTrace](https://msdn.microsoft.com/library/dd264915.aspx).</span></span>
>
>

### <a name="to-enable-remote-debugging-for-a-cloud-service"></a><span data-ttu-id="df168-141">Pour activer le débogage distant pour un service cloud</span><span class="sxs-lookup"><span data-stu-id="df168-141">To enable remote debugging for a cloud service</span></span>
1. <span data-ttu-id="df168-142">Ouvrez le menu contextuel du projet Azure, puis sélectionnez **Publier**.</span><span class="sxs-lookup"><span data-stu-id="df168-142">Open the shortcut menu for the Azure project, and then select **Publish**.</span></span>
2. <span data-ttu-id="df168-143">Sélectionnez l’environnement **Intermédiaire** et la configuration **Débogage**.</span><span class="sxs-lookup"><span data-stu-id="df168-143">Select the **Staging** environment and the **Debug** configuration.</span></span>

    <span data-ttu-id="df168-144">Il s’agit simplement d’une indication.</span><span class="sxs-lookup"><span data-stu-id="df168-144">This is only a guideline.</span></span> <span data-ttu-id="df168-145">Vous pouvez choisir d’exécuter vos environnements de test dans un environnement de production.</span><span class="sxs-lookup"><span data-stu-id="df168-145">You can opt to run your test environments in a Production environment.</span></span> <span data-ttu-id="df168-146">L’activation du débogage distant sur l’environnement de production risque toutefois d’avoir un impact pour les utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="df168-146">However, you may adversely affect users if you enable remote debugging on the Production environment.</span></span> <span data-ttu-id="df168-147">Vous pouvez choisir la configuration Release, mais la configuration Debug présente l’avantage de simplifier le débogage.</span><span class="sxs-lookup"><span data-stu-id="df168-147">You can choose the Release configuration, but the Debug configuration makes debugging easier.</span></span>

    ![Choisir la configuration Debug](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC746717.gif)
3. <span data-ttu-id="df168-149">Suivez les étapes habituelles, en veillant à cocher la case **Activer le débogueur distant pour tous les rôles** dans l’onglet **Paramètres avancés**.</span><span class="sxs-lookup"><span data-stu-id="df168-149">Follow the usual steps, but select the **Enable Remote Debugger for all roles** check box on the **Advanced Settings** tab.</span></span>

    ![Configuration Debug](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC746718.gif)

### <a name="to-attach-the-debugger-to-a-cloud-service-in-azure"></a><span data-ttu-id="df168-151">Pour attacher le débogueur à un service cloud dans Azure</span><span class="sxs-lookup"><span data-stu-id="df168-151">To attach the debugger to a cloud service in Azure</span></span>
1. <span data-ttu-id="df168-152">Dans l’Explorateur de serveurs, développez le nœud de votre service cloud.</span><span class="sxs-lookup"><span data-stu-id="df168-152">In Server Explorer, expand the node for your cloud service.</span></span>
2. <span data-ttu-id="df168-153">Ouvrez le menu contextuel du rôle ou de l’instance de rôle auquel vous souhaitez joindre le débogueur, puis sélectionnez **Attacher le débogueur**.</span><span class="sxs-lookup"><span data-stu-id="df168-153">Open the shortcut menu for the role or role instance to which you want to attach, and then select **Attach Debugger**.</span></span>

    <span data-ttu-id="df168-154">Si vous déboguez un rôle, le débogueur Visual Studio s'attache à chaque instance de ce rôle.</span><span class="sxs-lookup"><span data-stu-id="df168-154">If you debug a role, the Visual Studio debugger attaches to each instance of that role.</span></span> <span data-ttu-id="df168-155">Le débogueur s’arrêtera sur un point d’arrêt pour la première instance de rôle qui exécute cette ligne de code et remplit les conditions de ce point d’arrêt.</span><span class="sxs-lookup"><span data-stu-id="df168-155">The debugger will break on a breakpoint for the first role instance that runs that line of code and meets any conditions of that breakpoint.</span></span> <span data-ttu-id="df168-156">Si vous déboguez une instance, le débogueur est attaché uniquement à cette instance, et s’arrête sur un point d’arrêt quand cette instance spécifique exécute cette ligne de code et remplit les conditions du point d’arrêt.</span><span class="sxs-lookup"><span data-stu-id="df168-156">If you debug an instance, the debugger attaches to only that instance and breaks on a breakpoint only when that specific instance runs that line of code and meets the breakpoint's conditions.</span></span>

    ![Attacher le débogueur](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC746719.gif)
3. <span data-ttu-id="df168-158">Une fois que le débogueur est joint à une instance, déboguez comme vous le feriez normalement.</span><span class="sxs-lookup"><span data-stu-id="df168-158">After the debugger attaches to an instance, debug as usual.</span></span> <span data-ttu-id="df168-159">Le débogueur se joint automatiquement au processus hôte approprié pour votre rôle.</span><span class="sxs-lookup"><span data-stu-id="df168-159">The debugger automatically attaches to the appropriate host process for your role.</span></span> <span data-ttu-id="df168-160">Selon le rôle, le débogueur est attaché à w3wp.exe, WaWorkerHost.exe ou WaIISHost.exe.</span><span class="sxs-lookup"><span data-stu-id="df168-160">Depending on what the role is, the debugger attaches to w3wp.exe, WaWorkerHost.exe, or WaIISHost.exe.</span></span> <span data-ttu-id="df168-161">Pour identifier le processus auquel le débogueur est attaché, développez le nœud de l’instance dans l’Explorateur de serveurs.</span><span class="sxs-lookup"><span data-stu-id="df168-161">To verify the process to which the debugger is attached, expand the instance node in Server Explorer.</span></span> <span data-ttu-id="df168-162">Pour plus d’informations sur les processus Azure, consultez [Architecture de rôle Azure](http://blogs.msdn.com/b/kwill/archive/2011/05/05/windows-azure-role-architecture.aspx).</span><span class="sxs-lookup"><span data-stu-id="df168-162">See [Azure Role Architecture](http://blogs.msdn.com/b/kwill/archive/2011/05/05/windows-azure-role-architecture.aspx) for more information about Azure processes.</span></span>

    ![Boîte de dialogue Sélectionner le type de code](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC718346.png)
4. <span data-ttu-id="df168-164">Pour identifier les processus auxquels le débogueur est attaché, sélectionnez Déboguer, Windows, Processus dans la barre de menus pour ouvrir la boîte de dialogue Processus (ou appuyez sur Ctrl+Alt+Z).</span><span class="sxs-lookup"><span data-stu-id="df168-164">To identify the processes to which the debugger is attached, open the Processes dialog box by, on the menu bar, choosing Debug, Windows, Processes.</span></span> <span data-ttu-id="df168-165">Pour détacher un processus spécifique, ouvrez son menu contextuel, puis sélectionnez **Détacher le processus**.</span><span class="sxs-lookup"><span data-stu-id="df168-165">(Keyboard: Ctrl+Alt+Z)To detach a specific process, open its shortcut menu, and then select **Detach Process**.</span></span> <span data-ttu-id="df168-166">Vous pouvez aussi afficher le nœud d’instance dans l’Explorateur de serveurs, rechercher le processus et ouvrir son menu contextuel, puis sélectionnez **Détacher le processus**.</span><span class="sxs-lookup"><span data-stu-id="df168-166">Or, locate the instance node in Server Explorer, find the process, open its shortcut menu, and then select **Detach Process**.</span></span>

    ![Processus de débogage](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC690787.gif)

> [!WARNING]
> <span data-ttu-id="df168-168">Évitez les arrêts longs aux points d'arrêt avec le débogage à distance.</span><span class="sxs-lookup"><span data-stu-id="df168-168">Avoid long stops at breakpoints when remote debugging.</span></span> <span data-ttu-id="df168-169">Azure considère qu’un processus arrêté depuis plusieurs minutes ne répond pas, et cesse d’envoyer du trafic vers cette instance.</span><span class="sxs-lookup"><span data-stu-id="df168-169">Azure treats a process that's stopped for longer than a few minutes as unresponsive and stops sending traffic to that instance.</span></span> <span data-ttu-id="df168-170">Si l’arrêt est trop long, msvsmon.exe est détaché du processus.</span><span class="sxs-lookup"><span data-stu-id="df168-170">If you stop for too long, msvsmon.exe detaches from the process.</span></span>
>
>

<span data-ttu-id="df168-171">Pour détacher le débogueur de tous les processus dans votre instance ou rôle, ouvrez le menu contextuel du rôle ou de l’instance que vous déboguez, puis sélectionnez **Détacher le débogueur**.</span><span class="sxs-lookup"><span data-stu-id="df168-171">To detach the debugger from all processes in your instance or role, open the shortcut menu for the role or instance that you're debugging, and then select **Detach Debugger**.</span></span>

## <a name="limitations-of-remote-debugging-in-azure"></a><span data-ttu-id="df168-172">Limitations du débogage distant dans Azure</span><span class="sxs-lookup"><span data-stu-id="df168-172">Limitations of remote debugging in Azure</span></span>
<span data-ttu-id="df168-173">À partir de la version 2.3 du Kit de développement logiciel (SDK), le débogage à distance présente les limitations ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="df168-173">From Azure SDK 2.3, remote debugging has the following limitations.</span></span>

* <span data-ttu-id="df168-174">Quand le débogage distant est activé, vous ne pouvez pas publier un service cloud dans lequel un rôle comporte plus de 25 instances.</span><span class="sxs-lookup"><span data-stu-id="df168-174">With remote debugging enabled, you can't publish a cloud service in which any role has more than 25 instances.</span></span>
* <span data-ttu-id="df168-175">Le débogueur utilise les ports 30400 à 30424, 31400 à 31424 et 32400 à 32424.</span><span class="sxs-lookup"><span data-stu-id="df168-175">The debugger uses ports 30400 to 30424, 31400 to 31424 and 32400 to 32424.</span></span> <span data-ttu-id="df168-176">Si vous essayez d’utiliser ces ports, vous ne pourrez pas publier votre service, et l’un des messages d’erreur suivants s’affichera dans le journal des activités Azure :</span><span class="sxs-lookup"><span data-stu-id="df168-176">If you try to use any of these ports, you won't be able to publish your service, and one of the following error messages will appear in the activity log for Azure:</span></span>

  * <span data-ttu-id="df168-177">Erreur lors de la validation du fichier .cscfg par rapport au fichier .csdef.</span><span class="sxs-lookup"><span data-stu-id="df168-177">Error validating the .cscfg file against the .csdef file.</span></span>
    <span data-ttu-id="df168-178">La plage de ports réservée ('range') pour le point de terminaison Microsoft.WindowsAzure.Plugins.RemoteDebugger.Connector du rôle ('role') chevauche une plage ou un port déjà défini.</span><span class="sxs-lookup"><span data-stu-id="df168-178">The reserved port range 'range' for endpoint Microsoft.WindowsAzure.Plugins.RemoteDebugger.Connector of role 'role' overlaps with an already defined port or range.</span></span>
  * <span data-ttu-id="df168-179">L’allocation a échoué.</span><span class="sxs-lookup"><span data-stu-id="df168-179">Allocation failed.</span></span> <span data-ttu-id="df168-180">Réessayez ultérieurement, essayez de réduire la taille de la machine virtuelle ou le nombre d’instances de rôle, ou essayez de déployer dans une autre région.</span><span class="sxs-lookup"><span data-stu-id="df168-180">Please retry later, try reducing the VM size or number of role instances, or try deploying to a different region.</span></span>

## <a name="debugging-azure-virtual-machines"></a><span data-ttu-id="df168-181">Déboguer des machines virtuelles Azure</span><span class="sxs-lookup"><span data-stu-id="df168-181">Debugging Azure virtual machines</span></span>
<span data-ttu-id="df168-182">Vous pouvez déboguer des programmes exécutés sur des machines virtuelles Azure à l’aide de l’Explorateur de serveurs dans Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="df168-182">You can debug programs that run on Azure virtual machines by using Server Explorer in Visual Studio.</span></span> <span data-ttu-id="df168-183">Quand vous activez le débogage distant sur une machine virtuelle Azure, Azure installe l’extension de débogage distant sur cette machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="df168-183">When you enable remote debugging on an Azure virtual machine, Azure installs the remote debugging extension on the virtual machine.</span></span> <span data-ttu-id="df168-184">Vous pouvez ensuite l’attacher aux processus sur la machine virtuelle et procéder au débogage normalement.</span><span class="sxs-lookup"><span data-stu-id="df168-184">Then, you can attach to processes on the virtual machine and debug as you normally would.</span></span>

> [!NOTE]
> <span data-ttu-id="df168-185">Les machines virtuelles créées via la pile Azure Resource Manager peuvent être déboguées à distance à l’aide de Cloud Explorer dans Visual Studio 2015.</span><span class="sxs-lookup"><span data-stu-id="df168-185">Virtual machines created through the Azure resource manager stack can be remotely debugged by using Cloud Explorer in Visual Studio 2015.</span></span> <span data-ttu-id="df168-186">Pour plus d’informations, consultez [Gestion des ressources Azure avec Cloud Explorer](http://go.microsoft.com/fwlink/?LinkId=623031).</span><span class="sxs-lookup"><span data-stu-id="df168-186">For more information, see [Managing Azure Resources with Cloud Explorer](http://go.microsoft.com/fwlink/?LinkId=623031).</span></span>
>
>

### <a name="to-debug-an-azure-virtual-machine"></a><span data-ttu-id="df168-187">Pour déboguer une machine virtuelle Azure</span><span class="sxs-lookup"><span data-stu-id="df168-187">To debug an Azure virtual machine</span></span>
1. <span data-ttu-id="df168-188">Dans l’Explorateur de serveurs, développez le nœud Machines virtuelles, puis sélectionnez le nœud de la machine virtuelle à déboguer.</span><span class="sxs-lookup"><span data-stu-id="df168-188">In Server Explorer, expand the Virtual Machines node and select the node of the virtual machine that you want to debug.</span></span>
2. <span data-ttu-id="df168-189">Ouvrez le menu contextuel, puis sélectionnez **Activer le débogage**.</span><span class="sxs-lookup"><span data-stu-id="df168-189">Open the context menu and select **Enable Debugging**.</span></span> <span data-ttu-id="df168-190">Quand vous êtes invité à confirmer l’activation du débogage sur la machine virtuelle, sélectionnez **Oui**.</span><span class="sxs-lookup"><span data-stu-id="df168-190">When asked if you're sure if you want to enable debugging on the virtual machine, select **Yes**.</span></span>

    <span data-ttu-id="df168-191">Azure installe l’extension de débogage distant sur la machine virtuelle pour activer le débogage.</span><span class="sxs-lookup"><span data-stu-id="df168-191">Azure installs the remote debugging extension on the virtual machine to enable debugging.</span></span>

    ![Commande d’activation du débogage de machine virtuelle](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC746720.png)

    ![Journal des activités Azure](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC746721.png)
3. <span data-ttu-id="df168-194">Une fois l’extension de débogage à distance installée, ouvrez le menu contextuel de la machine virtuelle et sélectionnez **Attacher le débogueur...**</span><span class="sxs-lookup"><span data-stu-id="df168-194">After the remote debugging extension finishes installing, open the virtual machine's context menu and select **Attach Debugger...**</span></span>

    <span data-ttu-id="df168-195">Azure récupère la liste des processus sur la machine virtuelle et l’affiche dans la boîte de dialogue Attacher au processus.</span><span class="sxs-lookup"><span data-stu-id="df168-195">Azure gets a list of the processes on the virtual machine and shows them in the Attach to Process dialog box.</span></span>

    ![Commande Attacher le débogueur](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC746722.png)
4. <span data-ttu-id="df168-197">Dans la boîte de dialogue **Attacher au processus**, sélectionnez **Sélectionner** pour limiter la liste des résultats et afficher uniquement les types de code que vous voulez déboguer.</span><span class="sxs-lookup"><span data-stu-id="df168-197">In the **Attach to Process** dialog box, select **Select** to limit the results list to show only the types of code you want to debug.</span></span> <span data-ttu-id="df168-198">Vous pouvez déboguer du code managé 32 ou 64 bits, du code natif ou les deux.</span><span class="sxs-lookup"><span data-stu-id="df168-198">You can debug 32- or 64-bit managed code, native code, or both.</span></span>

    ![Boîte de dialogue Sélectionner le type de code](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC718346.png)
5. <span data-ttu-id="df168-200">Sélectionnez les processus que vous voulez déboguer sur la machine virtuelle, puis **Attacher**.</span><span class="sxs-lookup"><span data-stu-id="df168-200">Select the processes you want to debug on the virtual machine and then select **Attach**.</span></span> <span data-ttu-id="df168-201">Par exemple, vous pouvez choisir le processus w3wp.exe pour déboguer une application web sur la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="df168-201">For example, you might choose the w3wp.exe process if you wanted to debug a web app on the virtual machine.</span></span> <span data-ttu-id="df168-202">Pour plus d’informations, consultez [Déboguer un ou plusieurs processus dans Visual Studio](https://msdn.microsoft.com/library/jj919165.aspx) et [Architecture de rôle Azure](http://blogs.msdn.com/b/kwill/archive/2011/05/05/windows-azure-role-architecture.aspx).</span><span class="sxs-lookup"><span data-stu-id="df168-202">See [Debug One or More Processes in Visual Studio](https://msdn.microsoft.com/library/jj919165.aspx) and [Azure Role Architecture](http://blogs.msdn.com/b/kwill/archive/2011/05/05/windows-azure-role-architecture.aspx) for more information.</span></span>

## <a name="create-a-web-project-and-a-virtual-machine-for-debugging"></a><span data-ttu-id="df168-203">Créer un projet web et une machine virtuelle pour le débogage</span><span class="sxs-lookup"><span data-stu-id="df168-203">Create a web project and a virtual machine for debugging</span></span>
<span data-ttu-id="df168-204">Avant de publier votre projet Azure, il peut être utile de le tester dans un environnement contrôlé qui prend en charge les scénarios de test et de débogage, et où vous pouvez installer les programmes de test et de surveillance.</span><span class="sxs-lookup"><span data-stu-id="df168-204">Before publishing your Azure project, you might find it useful to test it in a contained environment that supports debugging and testing scenarios, and where you can install testing and monitoring programs.</span></span> <span data-ttu-id="df168-205">Pour ce faire, vous pouvez déboguer votre application à distance sur une machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="df168-205">One way to do this is to remotely debug your app on a virtual machine.</span></span>

<span data-ttu-id="df168-206">Les projets Visual Studio ASP.NET permettent de créer une machine virtuelle que vous pouvez utiliser pour tester les applications.</span><span class="sxs-lookup"><span data-stu-id="df168-206">Visual Studio ASP.NET projects offer an option to create a handy virtual machine that you can use for app testing.</span></span> <span data-ttu-id="df168-207">La machine virtuelle inclut les points de terminaison généralement requis tels que PowerShell, le Bureau à distance et Web Deploy.</span><span class="sxs-lookup"><span data-stu-id="df168-207">The virtual machine includes commonly-needed endpoints such as PowerShell, remote desktop, and WebDeploy.</span></span>

### <a name="to-create-a-web-project-and-a-virtual-machine-for-debugging"></a><span data-ttu-id="df168-208">Pour créer un projet web et une machine virtuelle pour le débogage</span><span class="sxs-lookup"><span data-stu-id="df168-208">To create a web project and a virtual machine for debugging</span></span>
1. <span data-ttu-id="df168-209">Dans Visual Studio, créez une application web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="df168-209">In Visual Studio, create a new ASP.NET Web Application.</span></span>
2. <span data-ttu-id="df168-210">Dans la boîte de dialogue Nouveau projet ASP.NET, dans la section Azure, sélectionnez **Machine virtuelle** dans la liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="df168-210">In the New ASP.NET Project dialog, in the Azure section, choose **Virtual Machine** in the dropdown list box.</span></span> <span data-ttu-id="df168-211">Laissez la case **Créer des ressources distantes** cochée.</span><span class="sxs-lookup"><span data-stu-id="df168-211">Leave the **Create remote resources** check box selected.</span></span> <span data-ttu-id="df168-212">Sélectionnez **OK** pour poursuivre.</span><span class="sxs-lookup"><span data-stu-id="df168-212">Select **OK** to proceed.</span></span>

    <span data-ttu-id="df168-213">La boîte de dialogue **Créer une machine virtuelle dans Azure** s’affiche.</span><span class="sxs-lookup"><span data-stu-id="df168-213">The **Create virtual machine on Azure** dialog box appears.</span></span>

    ![Boîte de dialogue de création de projet web ASP.NET](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC746723.png)

    <span data-ttu-id="df168-215">**Remarque** : vous serez invité à vous connecter à votre compte Azure si vous ne l’êtes pas déjà.</span><span class="sxs-lookup"><span data-stu-id="df168-215">**Note:** You'll be asked to sign in to your Azure account if you're not already signed in.</span></span>

1. <span data-ttu-id="df168-216">Sélectionnez les différents paramètres de la machine virtuelle, puis sélectionnez **OK**.</span><span class="sxs-lookup"><span data-stu-id="df168-216">Select the various settings for the virtual machine and then select **OK**.</span></span> <span data-ttu-id="df168-217">Pour plus d’informations, consultez [Machines virtuelles](http://go.microsoft.com/fwlink/?LinkId=623033) .</span><span class="sxs-lookup"><span data-stu-id="df168-217">See [Virtual Machines](http://go.microsoft.com/fwlink/?LinkId=623033) for more information.</span></span>

    <span data-ttu-id="df168-218">Le nom que vous entrez dans le champ Nom DNS sera le nom de votre machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="df168-218">The name you enter for DNS name will be the name of the virtual machine.</span></span>

    ![Boîte de dialogue Créer une machine virtuelle sur Microsoft Azure](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC746724.png)

    <span data-ttu-id="df168-220">Azure crée la machine virtuelle, puis déploie et configure les points de terminaison, tels que le Bureau à distance et Web Deploy.</span><span class="sxs-lookup"><span data-stu-id="df168-220">Azure creates the virtual machine and then provisions and configures the endpoints, such as Remote Desktop and Web Deploy</span></span>
2. <span data-ttu-id="df168-221">Une fois la machine virtuelle entièrement configurée, sélectionnez son nœud dans l’Explorateur de serveurs.</span><span class="sxs-lookup"><span data-stu-id="df168-221">After the virtual machine is fully configured, select the virtual machine’s node in Server Explorer.</span></span>
3. <span data-ttu-id="df168-222">Ouvrez le menu contextuel, puis sélectionnez **Activer le débogage**.</span><span class="sxs-lookup"><span data-stu-id="df168-222">Open the context menu and select **Enable Debugging**.</span></span> <span data-ttu-id="df168-223">Quand vous êtes invité à confirmer l’activation du débogage sur la machine virtuelle, sélectionnez **Oui**.</span><span class="sxs-lookup"><span data-stu-id="df168-223">When asked if you're sure if you want to enable debugging on the virtual machine, select **Yes**.</span></span>

    <span data-ttu-id="df168-224">Azure installe l’extension de débogage distant sur la machine virtuelle pour activer le débogage.</span><span class="sxs-lookup"><span data-stu-id="df168-224">Azure installs the remote debugging extension to the virtual machine to enable debugging.</span></span>

    ![Commande d’activation du débogage de machine virtuelle](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC746720.png)

    ![Journal des activités Azure](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC746721.png)
4. <span data-ttu-id="df168-227">Publiez votre projet comme décrit dans la rubrique [Déploiement d’un projet web à l’aide de la publication en un clic dans Visual Studio](https://msdn.microsoft.com/library/dd465337.aspx).</span><span class="sxs-lookup"><span data-stu-id="df168-227">Publish your project as outlined in [How to: Deploy a Web Project Using One-Click Publish in Visual Studio](https://msdn.microsoft.com/library/dd465337.aspx).</span></span> <span data-ttu-id="df168-228">Comme vous voulez effectuer le débogage sur la machine virtuelle, sur la page **Paramètres** de l’Assistant **Publier le site web**, sélectionnez la configuration **Débogage**.</span><span class="sxs-lookup"><span data-stu-id="df168-228">Because you want to debug on the virtual machine, on the **Settings** page of the **Publish Web** wizard, select **Debug** as the configuration.</span></span> <span data-ttu-id="df168-229">Ceci permet de s’assurer que les symboles de code sont disponibles pendant le débogage.</span><span class="sxs-lookup"><span data-stu-id="df168-229">This makes sure that code symbols are available while debugging.</span></span>

    ![Paramètres de publication](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC718349.png)
5. <span data-ttu-id="df168-231">Dans **Options de publication des fichiers**, sélectionnez **Supprimer les fichiers supplémentaires à la destination** si le projet a déjà été déployé précédemment.</span><span class="sxs-lookup"><span data-stu-id="df168-231">In the **File Publish Options**, select **Remove additional files at destination** if the project was already deployed at an earlier time.</span></span>
6. <span data-ttu-id="df168-232">Une fois le projet publié, dans le menu contextuel de la machine virtuelle dans l’Explorateur de serveurs, sélectionnez **Attacher le débogueur...**</span><span class="sxs-lookup"><span data-stu-id="df168-232">After the project publishes, on the virtual machine's context menu in Server Explorer, select **Attach Debugger...**</span></span>

    <span data-ttu-id="df168-233">Azure récupère la liste des processus sur la machine virtuelle et l’affiche dans la boîte de dialogue Attacher au processus.</span><span class="sxs-lookup"><span data-stu-id="df168-233">Azure gets a list of the processes on the virtual machine and shows them in the Attach to Process dialog box.</span></span>

    ![Commande Attacher le débogueur](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC746722.png)
7. <span data-ttu-id="df168-235">Dans la boîte de dialogue **Attacher au processus**, sélectionnez **Sélectionner** pour limiter la liste des résultats et afficher uniquement les types de code que vous voulez déboguer.</span><span class="sxs-lookup"><span data-stu-id="df168-235">In the **Attach to Process** dialog box, select **Select** to limit the results list to show only the types of code you want to debug.</span></span> <span data-ttu-id="df168-236">Vous pouvez déboguer du code managé 32 ou 64 bits, du code natif ou les deux.</span><span class="sxs-lookup"><span data-stu-id="df168-236">You can debug 32- or 64-bit managed code, native code, or both.</span></span>

    ![Boîte de dialogue Sélectionner le type de code](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC718346.png)
8. <span data-ttu-id="df168-238">Sélectionnez les processus que vous voulez déboguer sur la machine virtuelle, puis **Attacher**.</span><span class="sxs-lookup"><span data-stu-id="df168-238">Select the processes you want to debug on the virtual machine and then select **Attach**.</span></span> <span data-ttu-id="df168-239">Par exemple, vous pouvez choisir le processus w3wp.exe pour déboguer une application web sur la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="df168-239">For example, you might choose the w3wp.exe process if you wanted to debug a web app on the virtual machine.</span></span> <span data-ttu-id="df168-240">Pour plus d’informations, consultez [Déboguer un ou plusieurs processus dans Visual Studio](https://msdn.microsoft.com/library/jj919165.aspx) .</span><span class="sxs-lookup"><span data-stu-id="df168-240">See [Debug One or More Processes in Visual Studio](https://msdn.microsoft.com/library/jj919165.aspx) for more information.</span></span>

## <a name="next-steps"></a><span data-ttu-id="df168-241">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="df168-241">Next steps</span></span>
* <span data-ttu-id="df168-242">Utilisez **IntelliTrace** pour collecter un journal des appels et des événements d’un serveur de publication.</span><span class="sxs-lookup"><span data-stu-id="df168-242">Use **Intellitrace** to collect a log of calls and events from a release server.</span></span> <span data-ttu-id="df168-243">Consultez [Débogage d’un service cloud publié avec IntelliTrace et Visual Studio](http://go.microsoft.com/fwlink/?LinkID=623016).</span><span class="sxs-lookup"><span data-stu-id="df168-243">See [Debugging a Published Cloud Service with IntelliTrace and Visual Studio](http://go.microsoft.com/fwlink/?LinkID=623016).</span></span>
* <span data-ttu-id="df168-244">Utilisez les **Diagnostics Azure** pour collecter des informations détaillées du code actuellement exécuté dans des rôles qui sont eux-mêmes exécutés dans l’environnement de développement ou dans Azure.</span><span class="sxs-lookup"><span data-stu-id="df168-244">Use **Azure Diagnostics** to log detailed information from code running within roles, whether the roles are running in the development environment or in Azure.</span></span> <span data-ttu-id="df168-245">Consultez [Collecter des données de journalisation avec les diagnostics Azure](http://go.microsoft.com/fwlink/p/?LinkId=400450).</span><span class="sxs-lookup"><span data-stu-id="df168-245">See [Collecting logging data by using Azure Diagnostics](http://go.microsoft.com/fwlink/p/?LinkId=400450).</span></span>
