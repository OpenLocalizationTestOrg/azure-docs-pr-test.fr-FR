---
title: "Sauvegarde Azure : récupérer des fichiers et des dossiers à partir d’une sauvegarde de machine virtuelle Azure | Microsoft Docs"
description: "Récupérer des fichiers à partir d’un point de récupération de machine virtuelle Azure"
services: backup
documentationcenter: dev-center-name
author: pvrk
manager: shivamg
keywords: "récupération au niveau élément ; récupération de fichiers à partir d’une sauvegarde de machine virtuelle Azure ; restaurer des fichiers à partir d’une machine virtuelle Azure"
ms.assetid: f1c067a2-4826-4da4-b97a-c5fd6c189a77
ms.service: backup
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: storage-backup-recovery
ms.date: 07/20/2017
ms.author: pullabhk;markgal
ms.openlocfilehash: ae7c345c11a7db25413d60ad822f16f84ca37362
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/03/2017
---
# <a name="recover-files-from-azure-virtual-machine-backup"></a><span data-ttu-id="9292d-104">Récupérer des fichiers à partir d’une sauvegarde de machine virtuelle Azure</span><span class="sxs-lookup"><span data-stu-id="9292d-104">Recover files from Azure virtual machine backup</span></span>

<span data-ttu-id="9292d-105">La sauvegarde Azure offre la possibilité de restaurer des [machines virtuelles et des disques Azure](./backup-azure-arm-restore-vms.md) à partir de sauvegardes de machines virtuelles Azure.</span><span class="sxs-lookup"><span data-stu-id="9292d-105">Azure backup provides the capability to restore [Azure VMs and disks](./backup-azure-arm-restore-vms.md) from Azure VM backups.</span></span> <span data-ttu-id="9292d-106">Cet article explique comment récupérer des éléments tels que des fichiers et des dossiers à partir d’une sauvegarde de machine virtuelle Azure.</span><span class="sxs-lookup"><span data-stu-id="9292d-106">Now this article explains how you can recover items such as files and folders from an Azure VM backup.</span></span>

> [!Note]
> <span data-ttu-id="9292d-107">Cette fonctionnalité est disponible pour les machines virtuelles Azure déployées à l’aide du modèle Resource Manager et protégées dans un coffre Recovery Services.</span><span class="sxs-lookup"><span data-stu-id="9292d-107">This feature is available for Azure VMs deployed using the Resource Manager model and protected to a Recovery services vault.</span></span>
> <span data-ttu-id="9292d-108">La récupération de fichiers à partir d’une sauvegarde de machine virtuelle chiffrée n’est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="9292d-108">File recovery from an encrypted VM backup is not supported.</span></span>
>

## <a name="mount-the-volume-and-copy-files"></a><span data-ttu-id="9292d-109">Monter le volume et copier les fichiers</span><span class="sxs-lookup"><span data-stu-id="9292d-109">Mount the volume and copy files</span></span>

1. <span data-ttu-id="9292d-110">Connectez-vous au [portail Azure](http://portal.Azure.com).</span><span class="sxs-lookup"><span data-stu-id="9292d-110">Sign into the [Azure portal](http://portal.Azure.com).</span></span> <span data-ttu-id="9292d-111">Recherchez le coffre Recovery Services approprié et l’élément de sauvegarde requis.</span><span class="sxs-lookup"><span data-stu-id="9292d-111">Find the relevant Recovery services vault and the required backup item.</span></span>

2. <span data-ttu-id="9292d-112">Dans le panneau Élément de sauvegarde, cliquez sur **Récupération de fichier**.</span><span class="sxs-lookup"><span data-stu-id="9292d-112">On the Backup Item blade, click **File Recovery**</span></span>

    ![Ouvrir l’élément de sauvegarde du coffre Recovery Services.](./media/backup-azure-restore-files-from-vm/open-vault-item.png)

    <span data-ttu-id="9292d-114">Le panneau **Récupération de fichier** s’affiche.</span><span class="sxs-lookup"><span data-stu-id="9292d-114">The **File Recovery** blade opens.</span></span>

    ![Panneau Récupération de fichier](./media/backup-azure-restore-files-from-vm/file-recovery-blade.png)

3. <span data-ttu-id="9292d-116">Dans le menu déroulant **Sélectionner le point de récupération**, sélectionnez le point de récupération qui contient les fichiers dont vous avez besoin.</span><span class="sxs-lookup"><span data-stu-id="9292d-116">From the **Select recovery point** drop-down menu, select the recovery point that contains the files you want.</span></span> <span data-ttu-id="9292d-117">Le dernier point de récupération est sélectionné par défaut.</span><span class="sxs-lookup"><span data-stu-id="9292d-117">By default, the latest recovery point is already selected.</span></span>

4. <span data-ttu-id="9292d-118">Cliquez sur **Download Executable** (Télécharger le fichier exécutable) pour une machine virtuelle Azure Windows ou **Download Script** (Télécharger le script) pour une machine virtuelle Azure Linux pour télécharger le logiciel que vous utiliserez pour copier des fichiers à partir du point de récupération.</span><span class="sxs-lookup"><span data-stu-id="9292d-118">Click **Download Executable** (for Windows Azure VM) or **Download Script** (for Linux Azure VM) to download the software that you'll use to copy files from the recovery point.</span></span>

  <span data-ttu-id="9292d-119">Le fichier exécutable/script crée une connexion entre l’ordinateur local et le point de récupération spécifié.</span><span class="sxs-lookup"><span data-stu-id="9292d-119">The executable/script creates a connection between the local computer and the specified recovery point.</span></span>

5. <span data-ttu-id="9292d-120">Pour exécuter le script/fichier exécutable téléchargé, vous avez besoin d’un mot de passe.</span><span class="sxs-lookup"><span data-stu-id="9292d-120">You need a password to run the downloaded script/executable.</span></span> <span data-ttu-id="9292d-121">Vous pouvez copier le mot de passe à partir du portail à l’aide du bouton Copier en regard du mot de passe généré.</span><span class="sxs-lookup"><span data-stu-id="9292d-121">You can copy the password from the portal using the copy button beside the generated password</span></span>

    ![Mot de passe généré](./media/backup-azure-restore-files-from-vm/generated-pswd.png)

6. <span data-ttu-id="9292d-123">Sur l’ordinateur sur lequel vous souhaitez récupérer les fichiers, exécutez le fichier exécutable/de script.</span><span class="sxs-lookup"><span data-stu-id="9292d-123">On the computer where you want to recover the files, run the executable/script.</span></span> <span data-ttu-id="9292d-124">Vous devez l’exécuter en tant qu’administrateur.</span><span class="sxs-lookup"><span data-stu-id="9292d-124">You must run it with Administrator credentials.</span></span> <span data-ttu-id="9292d-125">Si vous exécutez le script sur un ordinateur avec un accès restreint, vérifiez l’accès aux éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="9292d-125">If you run the script on a computer with restricted access, ensure there is access to:</span></span>

    - <span data-ttu-id="9292d-126">download.microsoft.com</span><span class="sxs-lookup"><span data-stu-id="9292d-126">download.microsoft.com</span></span>
    - <span data-ttu-id="9292d-127">points de terminaison Azure utilisés pour les sauvegardes de machines virtuelles Azure</span><span class="sxs-lookup"><span data-stu-id="9292d-127">Azure endpoints used for Azure VM backups</span></span>
    - <span data-ttu-id="9292d-128">port sortant 3260</span><span class="sxs-lookup"><span data-stu-id="9292d-128">outbound port 3260</span></span>

   <span data-ttu-id="9292d-129">Pour Linux, le script requiert les composants « open-iscsi » et « lshw » pour vous connecter au point de récupération.</span><span class="sxs-lookup"><span data-stu-id="9292d-129">For Linux, the script requires 'open-iscsi' and 'lshw' components to connect to the recovery point.</span></span> <span data-ttu-id="9292d-130">S’ils n’existent pas sur la machine utilisée pour l’exécution, il demande l’autorisation d’installer les composants concernés et les installe avec votre accord.</span><span class="sxs-lookup"><span data-stu-id="9292d-130">If those do not exist on the machine where it is run, it asks for permission to install the relevant components and installs them upon consent.</span></span>
   
   <span data-ttu-id="9292d-131">Lorsque vous y êtes invité, entrez le mot de passe copié à partir du portail.</span><span class="sxs-lookup"><span data-stu-id="9292d-131">Enter the password copied from the portal when prompted.</span></span> <span data-ttu-id="9292d-132">Une fois le mot de passe valide entré, le script se connecte au point de récupération.</span><span class="sxs-lookup"><span data-stu-id="9292d-132">Once the valid password is entered the scripts connects to the recovery point.</span></span>
      
    ![Panneau Récupération de fichier](./media/backup-azure-restore-files-from-vm/executable-output.png)
    
   
   <span data-ttu-id="9292d-134">Vous pouvez exécuter le script sur n’importe quelle machine dotée du même système d’exploitation (ou d’un système d’exploitation compatible) que la machine virtuelle sauvegardée.</span><span class="sxs-lookup"><span data-stu-id="9292d-134">You can run the script on any machine that has the same (or compatible) operating system as the backed-up VM.</span></span> <span data-ttu-id="9292d-135">Consultez le [tableau de compatibilité des systèmes d’exploitation](backup-azure-restore-files-from-vm.md#compatible-os) pour connaître les systèmes d’exploitation compatibles.</span><span class="sxs-lookup"><span data-stu-id="9292d-135">See the [Compatible OS table](backup-azure-restore-files-from-vm.md#compatible-os) for compatible operating systems.</span></span> <span data-ttu-id="9292d-136">Si la machine virtuelle Azure protégée utilise des espaces de stockage Windows (pour les machines virtuelles Azure Windows) ou le LVM/des baies RAID (pour les machines virtuelles Linux), vous ne pouvez pas exécuter le script exécutable sur cette machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="9292d-136">If the protected Azure virtual machine uses Windows Storage Spaces (for Windows Azure VMs) or LVM/RAID Arrays(for Linux VMs), then you can't run the executable/script on the same virtual machine.</span></span> <span data-ttu-id="9292d-137">Au lieu de cela, exécutez-la sur n’importe quelle autre machine avec un système d’exploitation compatible.</span><span class="sxs-lookup"><span data-stu-id="9292d-137">Instead, run it on any other machine with a compatible operating system.</span></span>

### <a name="compatible-os"></a><span data-ttu-id="9292d-138">Systèmes d’exploitation compatibles</span><span class="sxs-lookup"><span data-stu-id="9292d-138">Compatible OS</span></span>

#### <a name="for-windows"></a><span data-ttu-id="9292d-139">Pour Windows</span><span class="sxs-lookup"><span data-stu-id="9292d-139">For Windows</span></span>

<span data-ttu-id="9292d-140">Le tableau suivant indique la compatibilité entre les systèmes d’exploitation des serveurs et des ordinateurs.</span><span class="sxs-lookup"><span data-stu-id="9292d-140">The following table shows the compatibility between server and computer operating systems.</span></span> <span data-ttu-id="9292d-141">Lors de la récupération de fichiers, vous ne pouvez pas restaurer des fichiers entre des systèmes d’exploitation incompatibles.</span><span class="sxs-lookup"><span data-stu-id="9292d-141">When recovering files, you can't restore files between incompatible operating systems.</span></span>

|<span data-ttu-id="9292d-142">Système d’exploitation serveur</span><span class="sxs-lookup"><span data-stu-id="9292d-142">Server OS</span></span> | <span data-ttu-id="9292d-143">Système d’exploitation client compatible</span><span class="sxs-lookup"><span data-stu-id="9292d-143">Compatible client OS</span></span>  |
| --------------- | ---- |
| <span data-ttu-id="9292d-144">Windows Server 2012 R2</span><span class="sxs-lookup"><span data-stu-id="9292d-144">Windows Server 2012 R2</span></span> | <span data-ttu-id="9292d-145">Windows 8.1</span><span class="sxs-lookup"><span data-stu-id="9292d-145">Windows 8.1</span></span> |
| <span data-ttu-id="9292d-146">Windows Server 2012</span><span class="sxs-lookup"><span data-stu-id="9292d-146">Windows Server 2012</span></span>    | <span data-ttu-id="9292d-147">Windows 8</span><span class="sxs-lookup"><span data-stu-id="9292d-147">Windows 8</span></span>  |
| <span data-ttu-id="9292d-148">Windows Server 2008 R2</span><span class="sxs-lookup"><span data-stu-id="9292d-148">Windows Server 2008 R2</span></span> | <span data-ttu-id="9292d-149">Windows 7</span><span class="sxs-lookup"><span data-stu-id="9292d-149">Windows 7</span></span>   |

#### <a name="for-linux"></a><span data-ttu-id="9292d-150">Pour Linux</span><span class="sxs-lookup"><span data-stu-id="9292d-150">For Linux</span></span>

<span data-ttu-id="9292d-151">Sous Linux, l’exigence fondamentale est que le système d’exploitation de la machine sur laquelle le script est exécuté doit prendre en charge le système de fichiers des fichiers présents dans la machine virtuelle Linux sauvegardée.</span><span class="sxs-lookup"><span data-stu-id="9292d-151">In Linux, the fundamental requirement is that the OS of the machine where the script is run should support the filesystem of the files present in the backed-up Linux VM.</span></span> <span data-ttu-id="9292d-152">Lorsque vous sélectionnez une machine pour exécuter le script, assurez-vous qu’elle dispose d’un système d’exploitation compatible et des versions mentionnées dans le tableau ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="9292d-152">While selecting a machine to run the script, please ensure it has the compatible OS and the versions as mentioned in the table below.</span></span>

|<span data-ttu-id="9292d-153">Système d’exploitation Linux</span><span class="sxs-lookup"><span data-stu-id="9292d-153">Linux OS</span></span> | <span data-ttu-id="9292d-154">Versions</span><span class="sxs-lookup"><span data-stu-id="9292d-154">Versions</span></span>  |
| --------------- | ---- |
| <span data-ttu-id="9292d-155">Ubuntu</span><span class="sxs-lookup"><span data-stu-id="9292d-155">Ubuntu</span></span> | <span data-ttu-id="9292d-156">12.04 et versions ultérieures</span><span class="sxs-lookup"><span data-stu-id="9292d-156">12.04 and above</span></span> |
| <span data-ttu-id="9292d-157">CentOS</span><span class="sxs-lookup"><span data-stu-id="9292d-157">CentOS</span></span> | <span data-ttu-id="9292d-158">6.5 et versions ultérieures</span><span class="sxs-lookup"><span data-stu-id="9292d-158">6.5 and above</span></span>  |
| <span data-ttu-id="9292d-159">RHEL</span><span class="sxs-lookup"><span data-stu-id="9292d-159">RHEL</span></span> | <span data-ttu-id="9292d-160">6.7 et versions ultérieures</span><span class="sxs-lookup"><span data-stu-id="9292d-160">6.7 and above</span></span> |
| <span data-ttu-id="9292d-161">Debian</span><span class="sxs-lookup"><span data-stu-id="9292d-161">Debian</span></span> | <span data-ttu-id="9292d-162">7 et versions ultérieures</span><span class="sxs-lookup"><span data-stu-id="9292d-162">7 and above</span></span> |
| <span data-ttu-id="9292d-163">Oracle Linux</span><span class="sxs-lookup"><span data-stu-id="9292d-163">Oracle Linux</span></span> | <span data-ttu-id="9292d-164">6.4 et versions ultérieures</span><span class="sxs-lookup"><span data-stu-id="9292d-164">6.4 and above</span></span> |

<span data-ttu-id="9292d-165">Le script requiert également les composants python et bash pour exécuter et établir une connexion sécurisée avec le point de récupération.</span><span class="sxs-lookup"><span data-stu-id="9292d-165">The script also requires python and bash components to execute and connect securely to the recovery point.</span></span>

|<span data-ttu-id="9292d-166">Composant</span><span class="sxs-lookup"><span data-stu-id="9292d-166">Component</span></span> | <span data-ttu-id="9292d-167">Version</span><span class="sxs-lookup"><span data-stu-id="9292d-167">Version</span></span>  |
| --------------- | ---- |
| <span data-ttu-id="9292d-168">bash</span><span class="sxs-lookup"><span data-stu-id="9292d-168">bash</span></span> | <span data-ttu-id="9292d-169">4 et versions ultérieures</span><span class="sxs-lookup"><span data-stu-id="9292d-169">4 and above</span></span> |
| <span data-ttu-id="9292d-170">python</span><span class="sxs-lookup"><span data-stu-id="9292d-170">python</span></span> | <span data-ttu-id="9292d-171">2.6.6 et versions ultérieures</span><span class="sxs-lookup"><span data-stu-id="9292d-171">2.6.6 and above</span></span>  |


### <a name="identifying-volumes"></a><span data-ttu-id="9292d-172">Identification des volumes</span><span class="sxs-lookup"><span data-stu-id="9292d-172">Identifying Volumes</span></span>

#### <a name="for-windows"></a><span data-ttu-id="9292d-173">Pour Windows</span><span class="sxs-lookup"><span data-stu-id="9292d-173">For Windows</span></span>

<span data-ttu-id="9292d-174">Lorsque vous exécutez l’exécutable, le système d’exploitation monte les nouveaux volumes et attribue des lettres de lecteur.</span><span class="sxs-lookup"><span data-stu-id="9292d-174">When you run the exectuable, the operating system mounts the new volumes and assigns drive letters.</span></span> <span data-ttu-id="9292d-175">Vous pouvez utiliser l’Explorateur Windows ou l’Explorateur de fichiers pour parcourir ces lecteurs.</span><span class="sxs-lookup"><span data-stu-id="9292d-175">You can use Windows Explorer or File Explorer to browse those drives.</span></span> <span data-ttu-id="9292d-176">Les lettres de lecteur affectées aux volumes peuvent ne pas être les mêmes que celles de la machine virtuelle d’origine. Le nom de volume est cependant conservé.</span><span class="sxs-lookup"><span data-stu-id="9292d-176">The drive letters assigned to the volumes may not be the same letters as the original virtual machine, however, the volume name is preserved.</span></span> <span data-ttu-id="9292d-177">Par exemple, si le volume sur la machine virtuelle d’origine était « Disque de données (E:\) », ce volume peut être connecté en tant que « Disque de données (n’importe quelle lettre de lecteur disponible:\) » sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="9292d-177">For example, if the volume on the original virtual machine was “Data Disk (E:\)”, that volume can be attached as “Data Disk ('Any drive letter available':\) on the local computer.</span></span> <span data-ttu-id="9292d-178">Parcourez tous les volumes mentionnés dans la sortie du script jusqu’à trouver vos fichiers/votre dossier.</span><span class="sxs-lookup"><span data-stu-id="9292d-178">Browse through all volumes mentioned in the script output until you find your files/folder.</span></span>  
       
   ![Panneau Récupération de fichier](./media/backup-azure-restore-files-from-vm/volumes-attached.png)
           
#### <a name="for-linux"></a><span data-ttu-id="9292d-180">Pour Linux</span><span class="sxs-lookup"><span data-stu-id="9292d-180">For Linux</span></span>

<span data-ttu-id="9292d-181">Sous Linux, les volumes de point de récupération sont montés sur le dossier dans lequel le script est exécuté.</span><span class="sxs-lookup"><span data-stu-id="9292d-181">In Linux, the volumes of the recovery point are mounted to the folder where the script is run.</span></span> <span data-ttu-id="9292d-182">Les disques attachés, les volumes et les chemins d’accès de montage correspondants sont affichés en conséquence.</span><span class="sxs-lookup"><span data-stu-id="9292d-182">The attached disks, volumes and the corresponding mount paths are shown accordingly.</span></span> <span data-ttu-id="9292d-183">Ces chemins de montage sont visibles aux utilisateurs ayant un accès root.</span><span class="sxs-lookup"><span data-stu-id="9292d-183">These mount paths are visible to users having root level access.</span></span> <span data-ttu-id="9292d-184">Parcourez les volumes mentionnés dans la sortie du script.</span><span class="sxs-lookup"><span data-stu-id="9292d-184">Browse through the volumes mentioned in the script output.</span></span>

  ![Panneau Récupération de fichier Linux](./media/backup-azure-restore-files-from-vm/linux-mount-paths.png)
  

## <a name="closing-the-connection"></a><span data-ttu-id="9292d-186">Fermeture de la connexion</span><span class="sxs-lookup"><span data-stu-id="9292d-186">Closing the connection</span></span>

<span data-ttu-id="9292d-187">Après avoir identifié les fichiers et les avoir copiés dans un emplacement de stockage local, supprimez (ou démontez) les lecteurs supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="9292d-187">After identifying the files and copying them to a local storage location, remove (or unmount) the additional drives.</span></span> <span data-ttu-id="9292d-188">Pour démonter les lecteurs, dans le panneau **Récupération de fichier** du portail Azure, cliquez sur **Unmount Disks** (Démonter les disques).</span><span class="sxs-lookup"><span data-stu-id="9292d-188">To unmount the drives, on the **File Recovery** blade in the Azure portal, click **Unmount Disks**.</span></span>

![Démonter les disques](./media/backup-azure-restore-files-from-vm/unmount-disks3.png)

<span data-ttu-id="9292d-190">Une fois les disques démontés, vous recevez un message vous informant que l’opération a bien été effectuée.</span><span class="sxs-lookup"><span data-stu-id="9292d-190">Once the disks have been unmounted, you receive a message letting you know it was successful.</span></span> <span data-ttu-id="9292d-191">L’actualisation de la connexion de sorte que vous pouvez supprimer les disques peut prendre quelques minutes.</span><span class="sxs-lookup"><span data-stu-id="9292d-191">It may take a few minutes for the connection to refresh so that you can remove the disks.</span></span>

<span data-ttu-id="9292d-192">Sous Linux, une fois la connexion au point de récupération interrompue, le système d’exploitation ne supprime pas les chemins d’accès de montage correspondants automatiquement.</span><span class="sxs-lookup"><span data-stu-id="9292d-192">In Linux, after the connection to the recovery point is severed, the OS doesn't remove the corresponding mount paths automatically.</span></span> <span data-ttu-id="9292d-193">Ils existent en tant que volumes « orphelins » et ils sont visibles, mais génèrent une erreur lorsque vous accédez aux fichiers ou écrivez dessus.</span><span class="sxs-lookup"><span data-stu-id="9292d-193">These exist as "orphan" volumes and they are visible but throw an error when you access/write the files.</span></span> <span data-ttu-id="9292d-194">Ils peuvent être supprimés manuellement.</span><span class="sxs-lookup"><span data-stu-id="9292d-194">They can be manually removed.</span></span> <span data-ttu-id="9292d-195">Le script, lorsqu’il est exécuté, identifie de tels volumes existants à partir des points de récupération précédents et les nettoie après accord.</span><span class="sxs-lookup"><span data-stu-id="9292d-195">The script, when run, identifies any such volumes existing from any previous recovery points and cleans them up upon consent.</span></span>

## <a name="special-configurations"></a><span data-ttu-id="9292d-196">Configurations spéciales</span><span class="sxs-lookup"><span data-stu-id="9292d-196">Special configurations</span></span>

### <a name="dynamic-disks"></a><span data-ttu-id="9292d-197">Disques dynamiques</span><span class="sxs-lookup"><span data-stu-id="9292d-197">Dynamic Disks</span></span>

<span data-ttu-id="9292d-198">Si la machine virtuelle Azure qui a été sauvegardée comporte des volumes qui s’étendent sur plusieurs disques (volumes agrégés par bandes et étendus) et/ou des volumes à tolérance de panne (volumes miroirs ou RAID-5) sur des disques dynamiques, vous ne pouvez pas exécuter le script exécutable sur la même machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="9292d-198">If the Azure VM that was backed up has volumes that span multiple disks (spanned and striped volumes) and/or fault-tolerant volumes (mirrored and RAID-5 volumes) on dynamic disks, then you can't run the executable script on the same VM.</span></span> <span data-ttu-id="9292d-199">Au lieu de cela, exécutez le script exécutable sur n’importe quelle autre machine avec un système d’exploitation compatible.</span><span class="sxs-lookup"><span data-stu-id="9292d-199">Instead, run the executable script on any other machine with a compatible operating system.</span></span>

### <a name="windows-storage-spaces"></a><span data-ttu-id="9292d-200">Espaces de stockage Windows</span><span class="sxs-lookup"><span data-stu-id="9292d-200">Windows Storage Spaces</span></span>

<span data-ttu-id="9292d-201">Les espaces de stockage Windows sont une technologie de stockage de Windows qui vous permet de virtualiser le stockage.</span><span class="sxs-lookup"><span data-stu-id="9292d-201">Windows Storage Spaces is a technology in Windows storage that enables you to virtualize storage.</span></span> <span data-ttu-id="9292d-202">Grâce aux espaces de stockage Windows, vous pouvez regrouper les disques standard dans des pools de stockage, puis créer des disques virtuels, appelés espaces de stockage, à partir de l’espace disponible dans ces pools de stockage.</span><span class="sxs-lookup"><span data-stu-id="9292d-202">With Windows Storage Spaces you can group industry-standard disks into storage pools, and then create virtual disks, called storage spaces, from the available space in those storage pools.</span></span>

<span data-ttu-id="9292d-203">Si la machine virtuelle Azure sauvegardée utilise des espaces de stockage Windows, vous ne pouvez pas exécuter le script exécutable sur la même machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="9292d-203">If the Azure VM that was backed up uses Windows Storage Spaces, then you can't run the executable script on the same VM.</span></span> <span data-ttu-id="9292d-204">Au lieu de cela, exécutez le script exécutable sur n’importe quelle autre machine avec un système d’exploitation compatible.</span><span class="sxs-lookup"><span data-stu-id="9292d-204">Instead, run the executable script on any other machine with a compatible operating system.</span></span>

### <a name="lvmraid-arrays"></a><span data-ttu-id="9292d-205">Baies LVM/RAID</span><span class="sxs-lookup"><span data-stu-id="9292d-205">LVM/RAID Arrays</span></span>

<span data-ttu-id="9292d-206">Sous Linux, le gestionnaire de volumes logiques (LVM) et/ou les baies RAID logicielles permettent de gérer des volumes logiques sur plusieurs disques.</span><span class="sxs-lookup"><span data-stu-id="9292d-206">In Linux, Logical volume manager (LVM) and/or software RAID Arrays are used to manage logical volumes over multiple disks.</span></span> <span data-ttu-id="9292d-207">Si la machine virtuelle Linux sauvegardée utilise LVM et/ou des baies RAID, vous ne pouvez pas exécuter le script sur la même machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="9292d-207">If the backed up Linux VM uses LVM and/or RAID Arrays, you can't run the script on the same VM.</span></span> <span data-ttu-id="9292d-208">Exécutez plutôt le script sur une autre machine avec un système d’exploitation compatible et qui prend en charge le système de fichiers de la machine virtuelle sauvegardée.</span><span class="sxs-lookup"><span data-stu-id="9292d-208">Instead run the script on any other machine with compatible OS and which supports filesystem of the backed up VM.</span></span>

<span data-ttu-id="9292d-209">La sortie du script affiche les disques LVM et/ou des baies RAID et les volumes avec le type de partition, comme indiqué ci-dessous</span><span class="sxs-lookup"><span data-stu-id="9292d-209">The script output displays the LVM and/or RAID Arrays disks and the volumes with the partition type as shown below</span></span>

   ![Panneau de sortie de LVM Linux](./media/backup-azure-restore-files-from-vm/linux-LVMOutput.png)
   
<span data-ttu-id="9292d-211">Les commandes suivantes doivent être exécutées par l’utilisateur pour mettre en ligne ces partitions.</span><span class="sxs-lookup"><span data-stu-id="9292d-211">The following commands need to be run by the user to bring these partitions online.</span></span> 

<span data-ttu-id="9292d-212">**Pour les partitions LVM**</span><span class="sxs-lookup"><span data-stu-id="9292d-212">**For LVM Partitions**</span></span>

```
$ pvs <volume name as shown above in the script output> 
```
<span data-ttu-id="9292d-213">Répertorie les noms de groupes de volumes sous un volume physique.</span><span class="sxs-lookup"><span data-stu-id="9292d-213">This lists the volume group names under a physical volume.</span></span>

```
$ lvdisplay <volume-group-name from the pvs command’s results> 
```
<span data-ttu-id="9292d-214">Cela répertorie tous les volumes logiques, noms et chemins d’accès dans un groupe de volumes.</span><span class="sxs-lookup"><span data-stu-id="9292d-214">This lists all logical volumes, names and their paths in a volume group.</span></span>

```
$ mount <LV path> </mountpath>
```
<span data-ttu-id="9292d-215">Pour monter les volumes logiques sur le chemin d’accès de votre choix.</span><span class="sxs-lookup"><span data-stu-id="9292d-215">To mount the logical volumes to the path of your choice.</span></span>


<span data-ttu-id="9292d-216">**Pour les tableaux RAID**</span><span class="sxs-lookup"><span data-stu-id="9292d-216">**For RAID Arrays**</span></span>

```
$ mdadm –detail –scan
```
<span data-ttu-id="9292d-217">Cela affiche des détails sur tous les disques RAID.</span><span class="sxs-lookup"><span data-stu-id="9292d-217">This displays details about all raid disks.</span></span> <span data-ttu-id="9292d-218">Le disque RAID pertinent s’affichera en tant que `/dev/mdm/<RAID array name in the backed up VM>`</span><span class="sxs-lookup"><span data-stu-id="9292d-218">The relevant RAID disk will be displayed as `/dev/mdm/<RAID array name in the backed up VM>`</span></span>

<span data-ttu-id="9292d-219">Utilisez la commande mount si le disque RAID dispose de volumes physiques.</span><span class="sxs-lookup"><span data-stu-id="9292d-219">Use the mount command if the RAID disk has physical volumes.</span></span>
```
$ mount [RAID Disk Path] [/mounthpath]
```

<span data-ttu-id="9292d-220">Si ce disque RAID a un autre LVM configuré, suivez la même procédure que ci-dessus pour les partitions LVM dont le nom de volume est le nom de disque RAID</span><span class="sxs-lookup"><span data-stu-id="9292d-220">If this RAID disk has another LVM configured in it then follow the same procedure as outlined above for LVM partitions with the volume name being the RAID Disk name</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="9292d-221">Résolution des problèmes</span><span class="sxs-lookup"><span data-stu-id="9292d-221">Troubleshooting</span></span>

<span data-ttu-id="9292d-222">Si vous rencontrez des problèmes lors de la récupération de fichiers à partir de machines virtuelles, consultez le tableau suivant pour plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="9292d-222">If you have problems while recovering files from the virtual machines, check the following table for additional information.</span></span>

| <span data-ttu-id="9292d-223">Message d’erreur/Scénario</span><span class="sxs-lookup"><span data-stu-id="9292d-223">Error Message / Scenario</span></span> | <span data-ttu-id="9292d-224">Cause probable</span><span class="sxs-lookup"><span data-stu-id="9292d-224">Probable Cause</span></span> | <span data-ttu-id="9292d-225">Action recommandée</span><span class="sxs-lookup"><span data-stu-id="9292d-225">Recommended action</span></span> |
| ------------------------ | -------------- | ------------------ |
| <span data-ttu-id="9292d-226">Sortie du script exécutable : *Exception lors de la connexion à la cible*</span><span class="sxs-lookup"><span data-stu-id="9292d-226">Exe output: *Exception connecting to the target*</span></span> |<span data-ttu-id="9292d-227">Le script n’est pas en mesure d’accéder au point de récupération.</span><span class="sxs-lookup"><span data-stu-id="9292d-227">Script is not able to access the recovery point</span></span> | <span data-ttu-id="9292d-228">Vérifiez si l’ordinateur remplit les conditions d’accès mentionnées ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="9292d-228">Check whether the machine fulfills the access requirements mentioned above</span></span>|  
|   <span data-ttu-id="9292d-229">Sortie du script exécutable : *La cible a déjà été connectée via une session iSCSI.*</span><span class="sxs-lookup"><span data-stu-id="9292d-229">Exe output: *The target has already been logged in via an ISCSI session.*</span></span> | <span data-ttu-id="9292d-230">Le script a déjà été exécuté sur le même ordinateur et les lecteurs ont été connectés.</span><span class="sxs-lookup"><span data-stu-id="9292d-230">The script was already executed on the same machine and the drives have been attached</span></span> | <span data-ttu-id="9292d-231">Les volumes du point de récupération ont déjà été connectés.</span><span class="sxs-lookup"><span data-stu-id="9292d-231">The volumes of the recovery point have already been attached.</span></span> <span data-ttu-id="9292d-232">Ils NE peuvent PAS être montés avec les mêmes lettres de lecteur que celles de la machine virtuelle d’origine.</span><span class="sxs-lookup"><span data-stu-id="9292d-232">They may NOT be mounted with the same drive letters of the original VM.</span></span> <span data-ttu-id="9292d-233">Parcourez tous les volumes disponibles dans l’Explorateur de fichiers pour votre fichier.</span><span class="sxs-lookup"><span data-stu-id="9292d-233">Browse through all the available volumes in the file explorer for your file</span></span> |
| <span data-ttu-id="9292d-234">Sortie du script exécutable : *Ce script n’est pas valide, car les disques ont été démontés via le portail/ont dépassé la limite de 12 h. Téléchargez un nouveau script à partir du portail.*</span><span class="sxs-lookup"><span data-stu-id="9292d-234">Exe output: *This script is invalid because the disks have been dismounted via portal/exceeded the 12-hr limit. Please download a new script from the portal.*</span></span> |  <span data-ttu-id="9292d-235">Les disques ont été démontés à partir du portail ou la limite de 12 h a été dépassée</span><span class="sxs-lookup"><span data-stu-id="9292d-235">The disks have been dismounted from the portal or the 12-hr limit exceeded</span></span> |    <span data-ttu-id="9292d-236">Ce fichier exécutable en particulier n’est plus valide et ne peut pas être exécuté.</span><span class="sxs-lookup"><span data-stu-id="9292d-236">This particular exe is now invalid and can’t be run.</span></span> <span data-ttu-id="9292d-237">Si vous souhaitez accéder aux fichiers de ce point de récupération, visitez le portail pour un obtenir un nouveau fichier exécutable.</span><span class="sxs-lookup"><span data-stu-id="9292d-237">If you want to access the files of that recovery point-in-time, visit the portal for a new exe</span></span>|
| <span data-ttu-id="9292d-238">Sur l’ordinateur sur lequel est exécuté le fichier .exe : les nouveaux volumes ne sont pas démontés après avoir cliqué sur le bouton Démonter</span><span class="sxs-lookup"><span data-stu-id="9292d-238">On the machine where the exe is run: The new volumes are not dismounted after the dismount button is clicked</span></span> |    <span data-ttu-id="9292d-239">L’initiateur iSCSI de l’ordinateur ne répond pas/actualise sa connexion à la cible et met à jour le cache.</span><span class="sxs-lookup"><span data-stu-id="9292d-239">The ISCSI initiator on the machine is not responding/refreshing its connection to the target and maintaining the cache</span></span> |    <span data-ttu-id="9292d-240">Attendez quelques minutes après avoir cliqué sur le bouton Démonter.</span><span class="sxs-lookup"><span data-stu-id="9292d-240">Wait for some mins after the dismount button is pressed.</span></span> <span data-ttu-id="9292d-241">Si les nouveaux volumes ne sont toujours pas démontés, parcourez tous les volumes.</span><span class="sxs-lookup"><span data-stu-id="9292d-241">If the new volumes are still not dismounted, please browse through all the volumes.</span></span> <span data-ttu-id="9292d-242">Cela force l’initiateur à actualiser la connexion et le volume est démonté avec un message d’erreur indiquant que le disque n’est pas disponible.</span><span class="sxs-lookup"><span data-stu-id="9292d-242">This forces the initiator to refresh the connection and the volume is dismounted with an error message that the disk is not available</span></span>|
| <span data-ttu-id="9292d-243">Sortie du script exécutable : Le script est exécuté avec succès, mais le message « New volumes attached » (Nouveaux volumes connectés) ne s’affiche pas dans la sortie du script</span><span class="sxs-lookup"><span data-stu-id="9292d-243">Exe output: Script is run successfully but “New volumes attached” is not displayed on the script output</span></span> | <span data-ttu-id="9292d-244">Il s’agit d’une erreur temporaire.</span><span class="sxs-lookup"><span data-stu-id="9292d-244">This is a transient error</span></span>   | <span data-ttu-id="9292d-245">Les volumes seraient déjà connectés.</span><span class="sxs-lookup"><span data-stu-id="9292d-245">The volumes would have been already attached.</span></span> <span data-ttu-id="9292d-246">Ouvrez l’Explorateur pour parcourir les volumes.</span><span class="sxs-lookup"><span data-stu-id="9292d-246">Open Explorer to browse.</span></span> <span data-ttu-id="9292d-247">Si vous utilisez toujours le même ordinateur pour exécuter les scripts, essayez de le redémarrer et la liste devrait s’afficher lors des prochaines exécutions du fichier exécutable.</span><span class="sxs-lookup"><span data-stu-id="9292d-247">If you are using the same machine for running scripts every time, consider restarting the machine and the list should be displayed in the subsequent exe runs.</span></span> |
| <span data-ttu-id="9292d-248">Pour Linux : impossible d’afficher les volumes souhaités</span><span class="sxs-lookup"><span data-stu-id="9292d-248">Linux specific: Not able to view the desired volumes</span></span> | <span data-ttu-id="9292d-249">Le système d’exploitation de la machine sur laquelle est exécuté le script peut ne pas reconnaître le système de fichiers sous-jacent de la machine virtuelle sauvegardée</span><span class="sxs-lookup"><span data-stu-id="9292d-249">The OS of the machine where the script is run may not recognize the underlying filesystem of the backed up VM</span></span> | <span data-ttu-id="9292d-250">Vérifiez si le point de récupération est cohérent en cas d’incident ou cohérent avec les fichiers.</span><span class="sxs-lookup"><span data-stu-id="9292d-250">Check whether the recovery point is crash consistent or file-consistent.</span></span> <span data-ttu-id="9292d-251">S’il est cohérent avec les fichiers, exécutez le script sur une autre machine dont le système d’exploitation reconnaît le système de fichiers de la machine virtuelle sauvegardée</span><span class="sxs-lookup"><span data-stu-id="9292d-251">If file consistent, run the script on another machine whose OS recognizes the backed up VM's filesystem</span></span> |
| <span data-ttu-id="9292d-252">Pour Windows : impossible d’afficher les volumes souhaités</span><span class="sxs-lookup"><span data-stu-id="9292d-252">Windows specific: Not able to view the desired volumes</span></span> | <span data-ttu-id="9292d-253">Les disques ont peut-être été attachés, mais les volumes n’ont pas été configurés.</span><span class="sxs-lookup"><span data-stu-id="9292d-253">The disks may have been attached but the volumes were not configured</span></span> | <span data-ttu-id="9292d-254">À partir de l’écran de gestion de disque, identifiez les disques supplémentaires relatifs au point de récupération.</span><span class="sxs-lookup"><span data-stu-id="9292d-254">From the disk management screen, identify the additional disks related to the recovery point.</span></span> <span data-ttu-id="9292d-255">Si l’état de l’un de ces disques est hors connexion, essayez de le mettre en ligne en cliquant avec le bouton droit sur le disque, puis sur « En ligne ».</span><span class="sxs-lookup"><span data-stu-id="9292d-255">If any of these disks are in offline state try making them online by right-clicking on the disk and click 'Online'</span></span>|
