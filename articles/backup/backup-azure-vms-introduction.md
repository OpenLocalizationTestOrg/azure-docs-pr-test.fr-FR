---
title: aaaPlanning votre infrastructure de sauvegarde de machine virtuelle dans Azure | Documents Microsoft
description: "Considérations importantes lors de la planification tooback des machines virtuelles dans Azure"
services: backup
documentationcenter: 
author: markgalioto
manager: carmonm
editor: 
keywords: sauvegarde de machines virtuelles
ms.assetid: 19d2cf82-1f60-43e1-b089-9238042887a9
ms.service: backup
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 7/18/2017
ms.author: markgal;trinadhk
ms.openlocfilehash: d11982431610000293038ee6aa7df8e7bc2d8b70
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="plan-your-vm-backup-infrastructure-in-azure"></a><span data-ttu-id="722a7-104">Planification de votre infrastructure de sauvegarde de machines virtuelles dans Azure</span><span class="sxs-lookup"><span data-stu-id="722a7-104">Plan your VM backup infrastructure in Azure</span></span>
<span data-ttu-id="722a7-105">Cet article fournit des performances et la ressource toohelp de suggestions vous planifiez votre infrastructure de sauvegarde de machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="722a7-105">This article provides performance and resource suggestions toohelp you plan your VM backup infrastructure.</span></span> <span data-ttu-id="722a7-106">Il définit également les principaux aspects hello du service de sauvegarde ; Ces aspects peuvent être essentiels dans la définition de votre architecture, la planification des capacités et la planification.</span><span class="sxs-lookup"><span data-stu-id="722a7-106">It also defines key aspects of hello Backup service; these aspects can be critical in determining your architecture, capacity planning, and scheduling.</span></span> <span data-ttu-id="722a7-107">Si vous avez [préparé votre environnement](backup-azure-vms-prepare.md), la planification est l’étape suivante de hello avant de commencer [tooback des machines virtuelles](backup-azure-vms.md).</span><span class="sxs-lookup"><span data-stu-id="722a7-107">If you've [prepared your environment](backup-azure-vms-prepare.md), planning is hello next step before you begin [tooback up VMs](backup-azure-vms.md).</span></span> <span data-ttu-id="722a7-108">Si vous avez besoin de plus d’informations sur les machines virtuelles, consultez hello [documentation de Machines virtuelles](https://azure.microsoft.com/documentation/services/virtual-machines/).</span><span class="sxs-lookup"><span data-stu-id="722a7-108">If you need more information about Azure virtual machines, see hello [Virtual Machines documentation](https://azure.microsoft.com/documentation/services/virtual-machines/).</span></span>

## <a name="how-does-azure-back-up-virtual-machines"></a><span data-ttu-id="722a7-109">Comment Azure sauvegarde-t-il des machines virtuelles Azure ?</span><span class="sxs-lookup"><span data-stu-id="722a7-109">How does Azure back up virtual machines?</span></span>
<span data-ttu-id="722a7-110">Hello service Azure Backup lorsqu’un travail de sauvegarde au moment de hello planifiée, il déclenche hello extension de sauvegarde tootake un instantané de point-à-temps.</span><span class="sxs-lookup"><span data-stu-id="722a7-110">When hello Azure Backup service initiates a backup job at hello scheduled time, it triggers hello backup extension tootake a point-in-time snapshot.</span></span> <span data-ttu-id="722a7-111">Hello service Azure Backup utilise hello _VMSnapshot_ extension dans Windows et hello _VMSnapshotLinux_ extension dans Linux.</span><span class="sxs-lookup"><span data-stu-id="722a7-111">hello Azure Backup service uses hello _VMSnapshot_ extension in Windows, and hello _VMSnapshotLinux_ extension in Linux.</span></span> <span data-ttu-id="722a7-112">extension de Hello est installée au cours de la première sauvegarde de machine virtuelle hello.</span><span class="sxs-lookup"><span data-stu-id="722a7-112">hello extension is installed during hello first VM backup.</span></span> <span data-ttu-id="722a7-113">extension de hello tooinstall, hello machine virtuelle doit s’exécuter.</span><span class="sxs-lookup"><span data-stu-id="722a7-113">tooinstall hello extension, hello VM must be running.</span></span> <span data-ttu-id="722a7-114">Si hello machine virtuelle ne fonctionne pas, hello service de sauvegarde prend un instantané de hello stockage sous-jacent (dans la mesure où aucune écriture de l’application se produire lors de la machine virtuelle est arrêtée de hello).</span><span class="sxs-lookup"><span data-stu-id="722a7-114">If hello VM is not running, hello Backup service takes a snapshot of hello underlying storage (since no application writes occur while hello VM is stopped).</span></span>

<span data-ttu-id="722a7-115">Lorsque vous prenez un instantané de machines virtuelles Windows, service de sauvegarde hello coordonne hello Volume Shadow Copy Service (VSS) tooget un instantané cohérent des disques de l’ordinateur virtuel de hello.</span><span class="sxs-lookup"><span data-stu-id="722a7-115">When taking a snapshot of Windows VMs, hello Backup service coordinates with hello Volume Shadow Copy Service (VSS) tooget a consistent snapshot of hello virtual machine's disks.</span></span> <span data-ttu-id="722a7-116">Si vous sauvegardez les machines virtuelles Linux, vous pouvez écrire votre propre cohérence tooensure de scripts personnalisés lorsque vous prenez un instantané de la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="722a7-116">If you're backing up Linux VMs, you can write your own custom scripts tooensure consistency when taking a VM snapshot.</span></span> <span data-ttu-id="722a7-117">Des détails relatifs à l’appel de ces scripts sont fournis plus loin dans cet article.</span><span class="sxs-lookup"><span data-stu-id="722a7-117">Details on invoking these scripts are provided later in this article.</span></span>

<span data-ttu-id="722a7-118">Une fois que hello service Azure Backup prend un instantané de hello, données de hello sont transférées toohello coffre.</span><span class="sxs-lookup"><span data-stu-id="722a7-118">Once hello Azure Backup service takes hello snapshot, hello data is transferred toohello vault.</span></span> <span data-ttu-id="722a7-119">l’efficacité toomaximize, hello service identifie et transfère uniquement les blocs de hello de données qui ont été modifiés depuis la sauvegarde précédente de hello.</span><span class="sxs-lookup"><span data-stu-id="722a7-119">toomaximize efficiency, hello service identifies and transfers only hello blocks of data that have changed since hello previous backup.</span></span>

![Architecture de la sauvegarde des machines virtuelles Azure](./media/backup-azure-vms-introduction/vmbackup-architecture.png)

<span data-ttu-id="722a7-121">Lorsque le transfert de données hello est terminé, les instantanés hello sont supprimé et un point de récupération est créé.</span><span class="sxs-lookup"><span data-stu-id="722a7-121">When hello data transfer is complete, hello snapshot is removed and a recovery point is created.</span></span>

> [!NOTE]
> 1. <span data-ttu-id="722a7-122">Au cours du processus de sauvegarde hello, Azure Backup n’inclut pas hello disque temporaire attaché toohello virtual machine.</span><span class="sxs-lookup"><span data-stu-id="722a7-122">During hello backup process, Azure Backup doesn't include hello temporary disk attached toohello virtual machine.</span></span> <span data-ttu-id="722a7-123">Pour plus d’informations, voir le blog de hello sur [stockage temporaire](https://blogs.msdn.microsoft.com/mast/2013/12/06/understanding-the-temporary-drive-on-windows-azure-virtual-machines/).</span><span class="sxs-lookup"><span data-stu-id="722a7-123">For more information, see hello blog on [temporary storage](https://blogs.msdn.microsoft.com/mast/2013/12/06/understanding-the-temporary-drive-on-windows-azure-virtual-machines/).</span></span>
> 2. <span data-ttu-id="722a7-124">Étant donné que Azure Backup prend un instantané au niveau du stockage et les transferts toovault de capture instantanée, ne modifiez pas les clés de compte de stockage hello jusqu'à ce que la fin du travail de sauvegarde hello.</span><span class="sxs-lookup"><span data-stu-id="722a7-124">Since Azure Backup takes a storage-level snapshot and transfers that snapshot toovault, do not change hello storage account keys until hello backup job finishes.</span></span>
> 3. <span data-ttu-id="722a7-125">Pour les machines virtuelles premium, nous copions compte toostorage de capture instantanée hello.</span><span class="sxs-lookup"><span data-stu-id="722a7-125">For premium VMs, we copy hello snapshot toostorage account.</span></span> <span data-ttu-id="722a7-126">Il s’agit de toomake assurer que service Azure Backup IOPS suffisant pour le transfert de données toovault.</span><span class="sxs-lookup"><span data-stu-id="722a7-126">This is toomake sure that Azure Backup service gets sufficient IOPS for transferring data toovault.</span></span> <span data-ttu-id="722a7-127">Cette copie supplémentaire de stockage est facturée conformément à hello machine virtuelle de la taille allouée.</span><span class="sxs-lookup"><span data-stu-id="722a7-127">This additional copy of storage is charged as per hello VM allocated size.</span></span> 
>

### <a name="data-consistency"></a><span data-ttu-id="722a7-128">Cohérence des données</span><span class="sxs-lookup"><span data-stu-id="722a7-128">Data consistency</span></span>
<span data-ttu-id="722a7-129">Sauvegarde et restauration des données critiques sont compliqué par le fait de hello données critiques doivent être sauvegardées lors des applications hello qui produisent des données sont en cours d’exécution de hello.</span><span class="sxs-lookup"><span data-stu-id="722a7-129">Backing up and restoring business critical data is complicated by hello fact that business critical data must be backed up while hello applications that produce hello data are running.</span></span> <span data-ttu-id="722a7-130">tooaddress, Azure Backup prend en charge les sauvegardes cohérentes avec les applications pour Windows et les machines virtuelles Linux</span><span class="sxs-lookup"><span data-stu-id="722a7-130">tooaddress this, Azure Backup supports application-consistent backups for both Windows and Linux VMs</span></span>
#### <a name="windows-vm"></a><span data-ttu-id="722a7-131">Machine virtuelle Windows</span><span class="sxs-lookup"><span data-stu-id="722a7-131">Windows VM</span></span>
<span data-ttu-id="722a7-132">Azure Backup effectue la sauvegarde complète VSS sur les machines virtuelles Windows (en savoir plus sur la [sauvegarde complète VSS](http://blogs.technet.com/b/filecab/archive/2008/05/21/what-is-the-difference-between-vss-full-backup-and-vss-copy-backup-in-windows-server-2008.aspx)).</span><span class="sxs-lookup"><span data-stu-id="722a7-132">Azure Backup takes VSS full backups on Windows VMs (read more about [VSS full backup](http://blogs.technet.com/b/filecab/archive/2008/05/21/what-is-the-difference-between-vss-full-backup-and-vss-copy-backup-in-windows-server-2008.aspx)).</span></span> <span data-ttu-id="722a7-133">sauvegardes de copie VSS tooenable, hello suivant les besoins de la clé de Registre toobe définie sur hello machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="722a7-133">tooenable VSS copy backups, hello following registry key needs toobe set on hello VM.</span></span>

```
[HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\BCDRAGENT]
"USEVSSCOPYBACKUP"="TRUE"
```

#### <a name="linux-vms"></a><span data-ttu-id="722a7-134">Machines virtuelles Linux</span><span class="sxs-lookup"><span data-stu-id="722a7-134">Linux VMs</span></span>
<span data-ttu-id="722a7-135">Le service Sauvegarde Azure fournit une infrastructure de script.</span><span class="sxs-lookup"><span data-stu-id="722a7-135">Azure Backup provides a scripting framework.</span></span> <span data-ttu-id="722a7-136">tooensure la cohérence des applications lors de la sauvegarde d’ordinateurs virtuels Linux, créer des scripts personnalisés avant et post-scripts qui contrôlent le flux de travail sauvegarde hello et l’environnement.</span><span class="sxs-lookup"><span data-stu-id="722a7-136">tooensure application consistency when backing up Linux VMs, create custom pre-scripts and post-scripts that control hello backup workflow and environment.</span></span> <span data-ttu-id="722a7-137">Sauvegarde Azure appelle le script avant de hello avant d’effectuer l’instantané d’ordinateur virtuel hello et appelle postérieurs aux scripts hello une fois le travail de capture instantanée d’ordinateur virtuel hello se termine.</span><span class="sxs-lookup"><span data-stu-id="722a7-137">Azure Backup invokes hello pre-script before taking hello VM snapshot and invokes hello post-script once hello VM snapshot job completes.</span></span> <span data-ttu-id="722a7-138">Pour plus d’informations, voir [Sauvegarde cohérente des applications des machines virtuelles Linux à l’aide de pré-scripts et de post-scripts](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span><span class="sxs-lookup"><span data-stu-id="722a7-138">For more details, see [application consistent VM backups using pre-script and post-script](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span></span>
> [!NOTE]
> <span data-ttu-id="722a7-139">Sauvegarde Azure appelle uniquement hello écrits par le client avant et après des scripts.</span><span class="sxs-lookup"><span data-stu-id="722a7-139">Azure Backup only invokes hello customer-written pre- and post-scripts.</span></span> <span data-ttu-id="722a7-140">Si post-scripts et script avant de hello s’exécutent correctement, Azure Backup marque point de récupération hello en tant qu’application cohérente.</span><span class="sxs-lookup"><span data-stu-id="722a7-140">If hello pre-script and post-scripts execute successfully, Azure Backup marks hello recovery point as application consistent.</span></span> <span data-ttu-id="722a7-141">Toutefois, les clients hello sont responsable de la cohérence des applications hello lors de l’utilisation des scripts personnalisés.</span><span class="sxs-lookup"><span data-stu-id="722a7-141">However, hello customer is ultimately responsible for hello application consistency when using custom scripts.</span></span>
>


<span data-ttu-id="722a7-142">Ce tableau décrit les types de hello des conditions de la cohérence et hello qu’ils se produisent sous lors de la sauvegarde de la machine virtuelle Azure et procédures de restauration.</span><span class="sxs-lookup"><span data-stu-id="722a7-142">This table explains hello types of consistency and hello conditions that they occur under during Azure VM backup and restore procedures.</span></span>

| <span data-ttu-id="722a7-143">Cohérence</span><span class="sxs-lookup"><span data-stu-id="722a7-143">Consistency</span></span> | <span data-ttu-id="722a7-144">En fonction du service VSS</span><span class="sxs-lookup"><span data-stu-id="722a7-144">VSS-based</span></span> | <span data-ttu-id="722a7-145">Explication et détails</span><span class="sxs-lookup"><span data-stu-id="722a7-145">Explanation and details</span></span> |
| --- | --- | --- |
| <span data-ttu-id="722a7-146">Cohérence des applications</span><span class="sxs-lookup"><span data-stu-id="722a7-146">Application consistency</span></span> |<span data-ttu-id="722a7-147">Oui pour Windows</span><span class="sxs-lookup"><span data-stu-id="722a7-147">Yes for Windows</span></span>|<span data-ttu-id="722a7-148">La cohérence des applications est idéale pour les charges de travail, car elle apporte les garanties suivantes :</span><span class="sxs-lookup"><span data-stu-id="722a7-148">Application consistency is ideal for workloads as it ensures that:</span></span><ol><li> <span data-ttu-id="722a7-149">Hello VM *démarre*.</span><span class="sxs-lookup"><span data-stu-id="722a7-149">hello VM *boots up*.</span></span> <li><span data-ttu-id="722a7-150">Les données *ne sont pas endommagées*.</span><span class="sxs-lookup"><span data-stu-id="722a7-150">There is *no corruption*.</span></span> <li><span data-ttu-id="722a7-151">Il n’y a *aucune perte de données*.</span><span class="sxs-lookup"><span data-stu-id="722a7-151">There is *no data loss*.</span></span><li> <span data-ttu-id="722a7-152">les données de salutation sont toohello cohérente qui utilise des données hello en impliquant l’application hello au moment de hello de sauvegarde, à l’aide du script de pré/post ou de VSS.</span><span class="sxs-lookup"><span data-stu-id="722a7-152">hello data is consistent toohello application that uses hello data, by involving hello application at hello time of backup--using VSS or pre/post script.</span></span></ol> <li><span data-ttu-id="722a7-153">*Machines virtuelles Windows*-charges de travail plus Microsoft ont les enregistreurs VSS qui effectuent des actions spécifiques à la charge de travail connexes toodata cohérence.</span><span class="sxs-lookup"><span data-stu-id="722a7-153">*Windows VMs*- Most Microsoft workloads have VSS writers that do workload-specific actions related toodata consistency.</span></span> <span data-ttu-id="722a7-154">Par exemple, Microsoft SQL Server a un enregistreur VSS qui permet de s’assurer que le fichier journal des transactions hello écritures toohello et la base de données hello effectuées correctement.</span><span class="sxs-lookup"><span data-stu-id="722a7-154">For example, Microsoft SQL Server has a VSS writer that ensures that hello writes toohello transaction log file and hello database are done correctly.</span></span> <span data-ttu-id="722a7-155">Pour les sauvegardes de la machine virtuelle de Windows Azure, toocreate un point de récupération cohérents avec les applications, extension de sauvegarde hello doit appeler hello VSS workflow et la terminer avant de prendre l’instantané d’ordinateur virtuel hello.</span><span class="sxs-lookup"><span data-stu-id="722a7-155">For Azure Windows VM backups, toocreate an application-consistent recovery point, hello backup extension must invoke hello VSS workflow and complete it before taking hello VM snapshot.</span></span> <span data-ttu-id="722a7-156">Pour toobe de capture instantanée Azure VM hello précis, les enregistreurs VSS de hello de toutes les applications de machine virtuelle Azure doivent exécuter ainsi.</span><span class="sxs-lookup"><span data-stu-id="722a7-156">For hello Azure VM snapshot toobe accurate, hello VSS writers of all Azure VM applications must complete as well.</span></span> <span data-ttu-id="722a7-157">(En savoir hello [notions de base de VSS](http://blogs.technet.com/b/josebda/archive/2007/10/10/the-basics-of-the-volume-shadow-copy-service-vss.aspx) et examiner en détail les détails hello de [son fonctionnement](https://technet.microsoft.com/library/cc785914%28v=ws.10%29.aspx)).</span><span class="sxs-lookup"><span data-stu-id="722a7-157">(Learn hello [basics of VSS](http://blogs.technet.com/b/josebda/archive/2007/10/10/the-basics-of-the-volume-shadow-copy-service-vss.aspx) and dive deep into hello details of [how it works](https://technet.microsoft.com/library/cc785914%28v=ws.10%29.aspx)).</span></span> </li> <li> <span data-ttu-id="722a7-158">*Les machines virtuelles Linux*-les clients peuvent exécuter [tooensure personnalisé de script préalable et le script postérieur à la cohérence des applications](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span><span class="sxs-lookup"><span data-stu-id="722a7-158">*Linux VMs*- Customers can execute [custom pre-script and post-script tooensure application consistency](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span></span> </li> |
| <span data-ttu-id="722a7-159">Cohérence du système de fichiers</span><span class="sxs-lookup"><span data-stu-id="722a7-159">File-system consistency</span></span> |<span data-ttu-id="722a7-160">Oui : pour les ordinateurs Windows</span><span class="sxs-lookup"><span data-stu-id="722a7-160">Yes - for Windows-based computers</span></span> |<span data-ttu-id="722a7-161">Il existe deux scénarios où le point de récupération hello peut être *système de fichiers cohérent*:</span><span class="sxs-lookup"><span data-stu-id="722a7-161">There are two scenarios where hello recovery point can be *file-system consistent*:</span></span><ul><li><span data-ttu-id="722a7-162">Sauvegardes de machines virtuelles Linux dans Azure, sans pré/post-script ou si le pré/post-script a échoué.</span><span class="sxs-lookup"><span data-stu-id="722a7-162">Backups of Linux VMs in Azure, without pre-script/post-script or if pre-script/post-script failed.</span></span> <li><span data-ttu-id="722a7-163">Échec de VSS lors de la sauvegarde de machines virtuelles Windows dans Azure.</span><span class="sxs-lookup"><span data-stu-id="722a7-163">VSS failure during backup for Windows VMs in Azure.</span></span></li></ul> <span data-ttu-id="722a7-164">Dans ces deux cas, hello meilleures qui peut être effectué est tooensure qui :</span><span class="sxs-lookup"><span data-stu-id="722a7-164">In both these cases, hello best that can be done is tooensure that:</span></span> <ol><li> <span data-ttu-id="722a7-165">Hello VM *démarre*.</span><span class="sxs-lookup"><span data-stu-id="722a7-165">hello VM *boots up*.</span></span> <li><span data-ttu-id="722a7-166">Les données *ne sont pas endommagées*.</span><span class="sxs-lookup"><span data-stu-id="722a7-166">There is *no corruption*.</span></span><li><span data-ttu-id="722a7-167">Il n’y a *aucune perte de données*.</span><span class="sxs-lookup"><span data-stu-id="722a7-167">There is *no data loss*.</span></span></ol> <span data-ttu-id="722a7-168">Les applications doivent mécanisme tooimplement leur propre « fix-up » sur les données de salutation restaurée.</span><span class="sxs-lookup"><span data-stu-id="722a7-168">Applications need tooimplement their own "fix-up" mechanism on hello restored data.</span></span> |
| <span data-ttu-id="722a7-169">Cohérence en cas d’incident</span><span class="sxs-lookup"><span data-stu-id="722a7-169">Crash consistency</span></span> |<span data-ttu-id="722a7-170">Non</span><span class="sxs-lookup"><span data-stu-id="722a7-170">No</span></span> |<span data-ttu-id="722a7-171">Cette situation est la machine virtuelle de tooa équivalent rencontre un « incident » (via une réinitialisation matérielle ou logicielle).</span><span class="sxs-lookup"><span data-stu-id="722a7-171">This situation is equivalent tooa virtual machine experiencing a "crash" (through either a soft or hard reset).</span></span> <span data-ttu-id="722a7-172">Cohérence d’incident se produit généralement lorsque hello machine virtuelle Azure est arrêté au moment de hello de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="722a7-172">Crash consistency typically happens when hello Azure virtual machine is shut down at hello time of backup.</span></span> <span data-ttu-id="722a7-173">Un point de récupération cohérent après sinistre ne fournit aucune garantie autour de la cohérence de hello des données de hello sur support de stockage hello--à partir du point de vue hello hello système d’exploitation ou application hello.</span><span class="sxs-lookup"><span data-stu-id="722a7-173">A crash-consistent recovery point provides no guarantees around hello consistency of hello data on hello storage medium--either from hello perspective of hello operating system or hello application.</span></span> <span data-ttu-id="722a7-174">Seules les données hello qui existe déjà sur le disque de hello au moment de la sauvegarde de hello sont capturées et sauvegardées.</span><span class="sxs-lookup"><span data-stu-id="722a7-174">Only hello data that already exists on hello disk at hello time of backup is captured and backed up.</span></span> <br/> <br/> <span data-ttu-id="722a7-175">Lorsqu’il n’y a aucune garantie, généralement, hello démarrages du système d’exploitation, suivies de la vérification de disque procédure, comme chkdsk, toofix les erreurs d’endommagement.</span><span class="sxs-lookup"><span data-stu-id="722a7-175">While there are no guarantees, usually, hello operating system boots, followed by disk-checking procedure, like chkdsk, toofix any corruption errors.</span></span> <span data-ttu-id="722a7-176">Toutes les données en mémoire ou des écritures qui n’ont pas été transférés toohello disque sont perdues.</span><span class="sxs-lookup"><span data-stu-id="722a7-176">Any in-memory data or writes that have not been transferred toohello disk are lost.</span></span> <span data-ttu-id="722a7-177">application Hello suit généralement avec son propre mécanisme de vérification au cas où la restauration de données doit toobe terminé.</span><span class="sxs-lookup"><span data-stu-id="722a7-177">hello application typically follows with its own verification mechanism in case data rollback needs toobe done.</span></span> <br><br><span data-ttu-id="722a7-178">Par exemple, si le journal des transactions hello possède des entrées qui ne sont pas présentes dans la base de données hello, logiciel de base de données hello effectue ensuite une restauration jusqu'à ce que les données de salutation soient cohérentes.</span><span class="sxs-lookup"><span data-stu-id="722a7-178">As an example, if hello transaction log has entries that are not present in hello database, then hello database software does a rollback until hello data is consistent.</span></span> <span data-ttu-id="722a7-179">Lorsque les données sont réparties sur plusieurs disques virtuels (par exemple, les volumes fractionnés), un point de récupération cohérent après sinistre ne fournit aucune garantie d’exactitude hello de données de hello.</span><span class="sxs-lookup"><span data-stu-id="722a7-179">When data is spread across multiple virtual disks (like spanned volumes), a crash-consistent recovery point provides no guarantees for hello correctness of hello data.</span></span> |

## <a name="performance-and-resource-utilization"></a><span data-ttu-id="722a7-180">Performance et utilisation des ressources</span><span class="sxs-lookup"><span data-stu-id="722a7-180">Performance and resource utilization</span></span>
<span data-ttu-id="722a7-181">Au même titre qu’un logiciel de sauvegarde déployé sur site, il est recommandé de planifier les besoins en capacité et en consommation de ressources lors d’une sauvegarde de machines virtuelles dans Azure.</span><span class="sxs-lookup"><span data-stu-id="722a7-181">Like backup software that is deployed on-premises, you should plan for capacity and resource utilization needs when backing up VMs in Azure.</span></span> <span data-ttu-id="722a7-182">Hello [limite de stockage Azure](../azure-subscription-service-limits.md#storage-limits) définir l’impact de toostructure VM déploiements tooget optimiser les performances avec au minimum sur les charges de travail toorunning.</span><span class="sxs-lookup"><span data-stu-id="722a7-182">hello [Azure Storage limits](../azure-subscription-service-limits.md#storage-limits) define how toostructure VM deployments tooget maximum performance with minimum impact toorunning workloads.</span></span>

<span data-ttu-id="722a7-183">Payer toohello attention que suivants de stockage Azure limite lors de la planification des performances de sauvegarde :</span><span class="sxs-lookup"><span data-stu-id="722a7-183">Pay attention toohello following Azure Storage limits when planning backup performance:</span></span>

* <span data-ttu-id="722a7-184">Nombre maximal de sorties par compte de stockage</span><span class="sxs-lookup"><span data-stu-id="722a7-184">Max egress per storage account</span></span>
* <span data-ttu-id="722a7-185">Taux de requête total par compte de stockage</span><span class="sxs-lookup"><span data-stu-id="722a7-185">Total request rate per storage account</span></span>

### <a name="storage-account-limits"></a><span data-ttu-id="722a7-186">Limites de compte de stockage</span><span class="sxs-lookup"><span data-stu-id="722a7-186">Storage account limits</span></span>
<span data-ttu-id="722a7-187">Sauvegarder des données copiées à partir d’un compte de stockage, ajoute toohello d’opérations d’entrée/sortie par seconde (IOPS) et des métriques de sortie (ou un débit) hello du compte de stockage.</span><span class="sxs-lookup"><span data-stu-id="722a7-187">Backup data copied from a storage account, adds toohello input/output operations per second (IOPS) and egress (or throughput) metrics of hello storage account.</span></span> <span data-ttu-id="722a7-188">AT hello même consomment également des machines virtuelles, en temps IOPS et le débit.</span><span class="sxs-lookup"><span data-stu-id="722a7-188">At hello same time, virtual machines are also consuming IOPS and throughput.</span></span> <span data-ttu-id="722a7-189">Hello vise tooensure sauvegarde et le trafic d’ordinateur virtuel ne pas dépasser les limites de votre compte de stockage.</span><span class="sxs-lookup"><span data-stu-id="722a7-189">hello goal is tooensure Backup and virtual machine traffic don't exceed your storage account limits.</span></span>

### <a name="number-of-disks"></a><span data-ttu-id="722a7-190">Nombre de disques</span><span class="sxs-lookup"><span data-stu-id="722a7-190">Number of disks</span></span>
<span data-ttu-id="722a7-191">processus de sauvegarde Hello tente toocomplete un travail de sauvegarde aussi rapidement que possible.</span><span class="sxs-lookup"><span data-stu-id="722a7-191">hello backup process tries toocomplete a backup job as quickly as possible.</span></span> <span data-ttu-id="722a7-192">Autrement dit, il consomme un maximum de ressources.</span><span class="sxs-lookup"><span data-stu-id="722a7-192">In doing so, it consumes as many resources as it can.</span></span> <span data-ttu-id="722a7-193">Toutefois, toutes les opérations d’e/s sont limitées par hello *débit cible pour l’objet Blob unique*, qui a une limite de 60 Mo par seconde.</span><span class="sxs-lookup"><span data-stu-id="722a7-193">However, all I/O operations are limited by hello *Target Throughput for Single Blob*, which has a limit of 60 MB per second.</span></span> <span data-ttu-id="722a7-194">Dans un toomaximize tentative de sa vitesse, les processus de sauvegarde hello tente tooback chacun des disques de l’ordinateur virtuel hello *en parallèle*.</span><span class="sxs-lookup"><span data-stu-id="722a7-194">In an attempt toomaximize its speed, hello backup process tries tooback up each of hello VM's disks *in parallel*.</span></span> <span data-ttu-id="722a7-195">Si une machine virtuelle a quatre disques, hello tooback de tentatives de service de toutes les quatre disques en parallèle.</span><span class="sxs-lookup"><span data-stu-id="722a7-195">If a VM has four disks, hello service attempts tooback up all four disks in parallel.</span></span> <span data-ttu-id="722a7-196">Hello **nombre de disques** en cours de sauvegarde, est hello plus facteur déterminant le trafic sauvegarde de compte de stockage.</span><span class="sxs-lookup"><span data-stu-id="722a7-196">hello **number of disks** being backed up, is hello most important factor in determining storage account backup traffic.</span></span>

### <a name="backup-schedule"></a><span data-ttu-id="722a7-197">Planification de sauvegarde</span><span class="sxs-lookup"><span data-stu-id="722a7-197">Backup schedule</span></span>
<span data-ttu-id="722a7-198">Un facteur supplémentaire qui affecte les performances est hello **planification de sauvegarde**.</span><span class="sxs-lookup"><span data-stu-id="722a7-198">An additional factor that impacts performance is hello **backup schedule**.</span></span> <span data-ttu-id="722a7-199">Si vous configurez des stratégies de hello pour toutes les machines virtuelles sont sauvegardés à hello même temps, vous avez planifié un bourrage de trafic.</span><span class="sxs-lookup"><span data-stu-id="722a7-199">If you configure hello policies so all VMs are backed up at hello same time, you have scheduled a traffic jam.</span></span> <span data-ttu-id="722a7-200">processus de sauvegarde Hello tentatives tooback tous les disques en parallèle.</span><span class="sxs-lookup"><span data-stu-id="722a7-200">hello backup process attempts tooback up all disks in parallel.</span></span> <span data-ttu-id="722a7-201">tooreduce hello le trafic de sauvegarde à partir d’un compte de stockage, sauvegardez les différentes machines virtuelles à différents heure hello, sans chevauchement.</span><span class="sxs-lookup"><span data-stu-id="722a7-201">tooreduce hello backup traffic from a storage account, back up different VMs at different time of hello day, with no overlap.</span></span>

## <a name="capacity-planning"></a><span data-ttu-id="722a7-202">Planification de la capacité</span><span class="sxs-lookup"><span data-stu-id="722a7-202">Capacity planning</span></span>
<span data-ttu-id="722a7-203">Assembler les facteurs précédents hello, vous devez tooplan pour les besoins de l’utilisation de compte de stockage hello.</span><span class="sxs-lookup"><span data-stu-id="722a7-203">Putting hello previous factors together, you need tooplan for hello storage account usage needs.</span></span> <span data-ttu-id="722a7-204">Télécharger hello [capacité de sauvegarde de machine virtuelle planification de la feuille de calcul Excel](https://gallery.technet.microsoft.com/Azure-Backup-Storage-a46d7e33) impact de hello toosee de votre disque et de choix de la planification de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="722a7-204">Download hello [VM backup capacity planning Excel spreadsheet](https://gallery.technet.microsoft.com/Azure-Backup-Storage-a46d7e33) toosee hello impact of your disk and backup schedule choices.</span></span>

### <a name="backup-throughput"></a><span data-ttu-id="722a7-205">Débit de sauvegarde</span><span class="sxs-lookup"><span data-stu-id="722a7-205">Backup throughput</span></span>
<span data-ttu-id="722a7-206">Pour chaque disque en cours de sauvegarde, Azure Backup lit des blocs hello sur le disque de hello et magasins hello uniquement les données modifiées (sauvegarde incrémentielle).</span><span class="sxs-lookup"><span data-stu-id="722a7-206">For each disk being backed up, Azure Backup reads hello blocks on hello disk and stores only hello changed data (incremental backup).</span></span> <span data-ttu-id="722a7-207">Hello tableau suivant montre les valeurs hello moyenne sauvegarde service débit.</span><span class="sxs-lookup"><span data-stu-id="722a7-207">hello following table shows hello average Backup service throughput values.</span></span> <span data-ttu-id="722a7-208">À l’aide de données suivantes de hello, vous pouvez estimer la durée hello nécessaire tooback d’un disque d’une taille donnée.</span><span class="sxs-lookup"><span data-stu-id="722a7-208">Using hello following data, you can estimate hello amount of time needed tooback up a disk of a given size.</span></span>

| <span data-ttu-id="722a7-209">Opération de sauvegarde</span><span class="sxs-lookup"><span data-stu-id="722a7-209">Backup operation</span></span> | <span data-ttu-id="722a7-210">Meilleur débit</span><span class="sxs-lookup"><span data-stu-id="722a7-210">Best-case throughput</span></span> |
| --- | --- |
| <span data-ttu-id="722a7-211">Sauvegarde initiale</span><span class="sxs-lookup"><span data-stu-id="722a7-211">Initial backup</span></span> |<span data-ttu-id="722a7-212">160 Mbits/s</span><span class="sxs-lookup"><span data-stu-id="722a7-212">160 Mbps</span></span> |
| <span data-ttu-id="722a7-213">Sauvegarde incrémentielle (DR)</span><span class="sxs-lookup"><span data-stu-id="722a7-213">Incremental backup (DR)</span></span> |<span data-ttu-id="722a7-214">640 Mbits/s </span><span class="sxs-lookup"><span data-stu-id="722a7-214">640 Mbps</span></span> <br><br> <span data-ttu-id="722a7-215">Chute considérablement si hello modifié des données (qui doivent toobe sauvegardé) sont réparties sur les disques hello.</span><span class="sxs-lookup"><span data-stu-id="722a7-215">Throughput drops significantly if hello changed data (that needs toobe backed up) is dispersed across hello disk.</span></span>|

## <a name="total-vm-backup-time"></a><span data-ttu-id="722a7-216">Durée de sauvegarde de machine virtuelle totale</span><span class="sxs-lookup"><span data-stu-id="722a7-216">Total VM backup time</span></span>
<span data-ttu-id="722a7-217">Alors que la plupart du temps de sauvegarde hello est passé à la lecture et la copie des données, autres opérations contribuent tooback de temps total nécessaire toohello d’un ordinateur virtuel :</span><span class="sxs-lookup"><span data-stu-id="722a7-217">While most of hello backup time is spent reading and copying data, other operations contribute toohello total time needed tooback up a VM:</span></span>

* <span data-ttu-id="722a7-218">Temps nécessaire trop[installer ou mettre à jour d’extension de sauvegarde hello](backup-azure-vms.md).</span><span class="sxs-lookup"><span data-stu-id="722a7-218">Time needed too[install or update hello backup extension](backup-azure-vms.md).</span></span>
* <span data-ttu-id="722a7-219">Heure de l’instantané, qui est hello durée tootrigger un instantané.</span><span class="sxs-lookup"><span data-stu-id="722a7-219">Snapshot time, which is hello time taken tootrigger a snapshot.</span></span> <span data-ttu-id="722a7-220">Les instantanés sont déclenchées toohello fermer planifiée les temps de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="722a7-220">Snapshots are triggered close toohello scheduled backup time.</span></span>
* <span data-ttu-id="722a7-221">Délai d’attente de file d’attente.</span><span class="sxs-lookup"><span data-stu-id="722a7-221">Queue wait time.</span></span> <span data-ttu-id="722a7-222">Étant donné que le service de sauvegarde hello le traitement de sauvegardes à partir de plusieurs clients, copie des données de sauvegarde à partir de la sauvegarde d’instantanés toohello ou les Services de récupération coffre peut ne pas démarre immédiatement.</span><span class="sxs-lookup"><span data-stu-id="722a7-222">Since hello Backup service is processing backups from multiple customers, copying backup data from snapshot toohello backup or Recovery Services vault might not start immediately.</span></span> <span data-ttu-id="722a7-223">Dans les heures de pointe, hello attente permet d’étendre les heures tooeight en raison du nombre de toohello de sauvegardes en cours de traitement.</span><span class="sxs-lookup"><span data-stu-id="722a7-223">In times of peak load, hello wait can stretch up tooeight hours due toohello number of backups being processed.</span></span> <span data-ttu-id="722a7-224">Toutefois, hello total VM heure de la sauvegarde est inférieure à 24 heures pour les stratégies de sauvegarde quotidiennes.</span><span class="sxs-lookup"><span data-stu-id="722a7-224">However, hello total VM backup time is less than 24 hours for daily backup policies.</span></span>
* <span data-ttu-id="722a7-225">Temps de transfert de données, temps nécessaire pour la sauvegarde toocompute hello des modifications incrémentielles à partir d’une sauvegarde précédente du service et transférer ces stockage toovault de modifications.</span><span class="sxs-lookup"><span data-stu-id="722a7-225">Data transfer time, time needed for backup service toocompute hello incremental changes from previous backup and transfer those changes toovault storage.</span></span>

### <a name="why-am-i-observing-longer12-hours-backup-time"></a><span data-ttu-id="722a7-226">Pourquoi les temps de sauvegarde semblent-ils plus longs (>12 heures) ?</span><span class="sxs-lookup"><span data-stu-id="722a7-226">Why am I observing longer(>12 hours) backup time?</span></span>
<span data-ttu-id="722a7-227">Sauvegarde se compose de deux phases : prise d’instantanés et le transfert hello instantanés toohello coffre.</span><span class="sxs-lookup"><span data-stu-id="722a7-227">Backup consists of two phases: taking snapshots and transferring hello snapshots toohello vault.</span></span> <span data-ttu-id="722a7-228">Hello service sauvegarde optimise les demandes de stockage.</span><span class="sxs-lookup"><span data-stu-id="722a7-228">hello Backup service optimizes for storage.</span></span> <span data-ttu-id="722a7-229">Lors du transfert de hello instantané données tooa coffre, service de hello transfère uniquement les modifications incrémentielles à partir de l’instantané précédent de hello.</span><span class="sxs-lookup"><span data-stu-id="722a7-229">When transferring hello snapshot data tooa vault, hello service only transfers incremental changes from hello previous snapshot.</span></span>  <span data-ttu-id="722a7-230">toodetermine les modifications incrémentielles hello, service de hello calcule la somme de contrôle hello de blocs de hello.</span><span class="sxs-lookup"><span data-stu-id="722a7-230">toodetermine hello incremental changes, hello service computes hello checksum of hello blocks.</span></span> <span data-ttu-id="722a7-231">Si un bloc est modifié, les blocs hello sont identifié comme un toobe bloc envoyé toohello coffre.</span><span class="sxs-lookup"><span data-stu-id="722a7-231">If a block is changed, hello block is identified as a block toobe sent toohello vault.</span></span> <span data-ttu-id="722a7-232">Extrait vers le service hello supplémentaire dans chacun des hello identifiés blocs, recherchez des opportunités toominimize hello données tootransfer.</span><span class="sxs-lookup"><span data-stu-id="722a7-232">Then hello service drills further into each of hello identified blocks, looking for opportunities toominimize hello data tootransfer.</span></span> <span data-ttu-id="722a7-233">Après avoir évalué tous les blocs modifiés, service de hello fusionne les modifications hello et les envoie toohello coffre.</span><span class="sxs-lookup"><span data-stu-id="722a7-233">After evaluating all changed blocks, hello service coalesces hello changes and sends them toohello vault.</span></span> <span data-ttu-id="722a7-234">Dans certaines applications héritées, les écritures de petite taille et fragmentées ne sont pas optimales pour le stockage.</span><span class="sxs-lookup"><span data-stu-id="722a7-234">In some legacy applications, small, fragmented writes are not optimal for storage.</span></span> <span data-ttu-id="722a7-235">Si l’instantané d’hello contient de nombreuses écritures de petite taille, fragmentés, service de hello consacre plus de temps du traitement des données hello écrites par les applications hello.</span><span class="sxs-lookup"><span data-stu-id="722a7-235">If hello snapshot contains many small, fragmented writes, hello service spends additional time processing hello data written by hello applications.</span></span> <span data-ttu-id="722a7-236">Hello recommandé de bloc écriture d’applications à partir d’Azure, pour les applications en cours d’exécution à l’intérieur de hello machine virtuelle, est un minimum de 8 Ko.</span><span class="sxs-lookup"><span data-stu-id="722a7-236">hello recommended application write block from Azure, for applications running inside hello VM, is a minimum of 8 KB.</span></span> <span data-ttu-id="722a7-237">Si votre application utilise un bloc de moins de 8 Ko, les performances de sauvegarde sont affectées.</span><span class="sxs-lookup"><span data-stu-id="722a7-237">If your application uses a block of less than 8 KB, backup performance is effected.</span></span> <span data-ttu-id="722a7-238">Pour plus d’informations de réglage des performances de sauvegarde tooimprove application, consultez [paramétrage des applications pour des performances optimales avec le stockage Azure](../storage/common/storage-premium-storage-performance.md).</span><span class="sxs-lookup"><span data-stu-id="722a7-238">For help with tuning your application tooimprove backup performance, see [Tuning applications for optimal performance with Azure storage](../storage/common/storage-premium-storage-performance.md).</span></span> <span data-ttu-id="722a7-239">Bien que l’article hello sur les performances de sauvegarde utilise des exemples de stockage Premium, des conseils de hello sont applicable pour les disques de stockage Standard.</span><span class="sxs-lookup"><span data-stu-id="722a7-239">Though hello article on backup performance uses Premium storage examples, hello guidance is applicable for Standard storage disks.</span></span>

## <a name="total-restore-time"></a><span data-ttu-id="722a7-240">Temps de restauration total</span><span class="sxs-lookup"><span data-stu-id="722a7-240">Total restore time</span></span>
<span data-ttu-id="722a7-241">Une opération de restauration se compose de deux tâches principales sub : copie de données de compte de stockage client hello coffre toohello choisi et la création de machine virtuelle de hello.</span><span class="sxs-lookup"><span data-stu-id="722a7-241">A restore operation consists of two main sub tasks: Copying data back from hello vault toohello chosen customer storage account, and creating hello virtual machine.</span></span> <span data-ttu-id="722a7-242">Copie de données à partir de coffre de hello dépend où les sauvegardes hello sont stockées en interne dans Azure, et où se trouve le compte de stockage client hello.</span><span class="sxs-lookup"><span data-stu-id="722a7-242">Copying data back from hello vault depends on where hello backups are stored internally in Azure, and where hello customer storage account is stored.</span></span> <span data-ttu-id="722a7-243">Dépend de la durée des données de toocopy :</span><span class="sxs-lookup"><span data-stu-id="722a7-243">Time taken toocopy data depends upon:</span></span>
* <span data-ttu-id="722a7-244">File d’attente délai - étant donné que le processus de service hello les travaux de restauration à partir de plusieurs clients hello même temps, les demandes de restauration sont placés dans une file d’attente.</span><span class="sxs-lookup"><span data-stu-id="722a7-244">Queue wait time - Since hello service processes restore jobs from multiple customers at hello same time, restore requests are put in a queue.</span></span>
* <span data-ttu-id="722a7-245">Copie de données time - données sont copiées de hello coffre toohello compte de stockage.</span><span class="sxs-lookup"><span data-stu-id="722a7-245">Data copy time - Data is copied from hello vault toohello customer storage account.</span></span> <span data-ttu-id="722a7-246">Restaurer temps dépend des e/s et obtient de débit service Azure Backup sur le compte de stockage client hello sélectionné.</span><span class="sxs-lookup"><span data-stu-id="722a7-246">Restore time depends on IOPS and throughput Azure Backup service gets on hello selected customer storage account.</span></span> <span data-ttu-id="722a7-247">tooreduce hello copie moment pendant le processus de restauration hello, sélectionnez un compte de stockage ne pas chargé avec d’autres écritures de l’application et les lectures.</span><span class="sxs-lookup"><span data-stu-id="722a7-247">tooreduce hello copying time during hello restore process, select a storage account not loaded with other application writes and reads.</span></span>

## <a name="best-practices"></a><span data-ttu-id="722a7-248">Meilleures pratiques</span><span class="sxs-lookup"><span data-stu-id="722a7-248">Best practices</span></span>
<span data-ttu-id="722a7-249">Nous vous suggérons de suivre les meilleures pratiques ci-dessous lors de la configuration de sauvegardes de machines virtuelles :</span><span class="sxs-lookup"><span data-stu-id="722a7-249">We suggest following these practices while configuring backups for virtual machines:</span></span>

* <span data-ttu-id="722a7-250">Ne pas planifier plus de 10 ordinateurs virtuels classiques hello même de cloud service tooback à hello même temps.</span><span class="sxs-lookup"><span data-stu-id="722a7-250">Don't schedule more than 10 classic VMs from hello same cloud service tooback up at hello same time.</span></span> <span data-ttu-id="722a7-251">Si vous souhaitez tooback plusieurs ordinateurs virtuels à partir du même service cloud, échelonner les heures de début de la sauvegarde de hello, d’une heure.</span><span class="sxs-lookup"><span data-stu-id="722a7-251">If you want tooback up multiple VMs from same cloud service, stagger hello backup start times by an hour.</span></span>
* <span data-ttu-id="722a7-252">Ne planifiez pas plus de 40 tooback de machines virtuelles à hello même temps.</span><span class="sxs-lookup"><span data-stu-id="722a7-252">Do not schedule more than 40 VMs tooback up at hello same time.</span></span>
* <span data-ttu-id="722a7-253">Planifiez les sauvegardes de machines virtuelles pendant les heures creuses.</span><span class="sxs-lookup"><span data-stu-id="722a7-253">Schedule VM backups during non-peak hours.</span></span> <span data-ttu-id="722a7-254">Ce service de sauvegarde de hello moyen utilise IOPS pour transférer des données à partir du coffre de toohello hello client stockage compte.</span><span class="sxs-lookup"><span data-stu-id="722a7-254">This way hello Backup service uses IOPS for transferring data from hello customer storage account toohello vault.</span></span>
* <span data-ttu-id="722a7-255">Veillez à appliquer une stratégie aux machines virtuelles réparties entre les différents comptes de stockage.</span><span class="sxs-lookup"><span data-stu-id="722a7-255">Make sure that a policy is applied on VMs spread across different storage accounts.</span></span> <span data-ttu-id="722a7-256">Nous vous suggérons de pas plus de 20 disques à partir d’un seul compte de stockage protégé par hello même planning de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="722a7-256">We suggest no more than 20 total disks from a single storage account be protected by hello same backup schedule.</span></span> <span data-ttu-id="722a7-257">Si vous avez supérieure à 20 disques dans un compte de stockage se propager ces machines virtuelles entre plusieurs stratégies tooget hello IOPS requises pendant la phase de transfert hello hello du processus de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="722a7-257">If you have greater than 20 disks in a storage account, spread those VMs across multiple policies tooget hello required IOPS during hello transfer phase of hello backup process.</span></span>
* <span data-ttu-id="722a7-258">Ne restaurez pas une machine virtuelle en cours d’exécution sur le compte de stockage toosame stockage Premium.</span><span class="sxs-lookup"><span data-stu-id="722a7-258">Do not restore a VM running on Premium storage toosame storage account.</span></span> <span data-ttu-id="722a7-259">Si le processus de restauration hello coïncide avec l’opération de sauvegarde hello, il réduit hello IOPS disponibles pour la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="722a7-259">If hello restore operation process coincides with hello backup operation, it reduces hello available IOPS for backup.</span></span>
* <span data-ttu-id="722a7-260">Pour la sauvegarde de machine virtuelle Premium, assurez-vous que le compte de stockage qui héberge les disques Premium dispose d’au moins 50 % d’espace libre pour créer des captures instantanées intermédiaires pour une sauvegarde réussie.</span><span class="sxs-lookup"><span data-stu-id="722a7-260">For Premium VM backup, ensure that storage account that hosts premium disks has atleast 50% free space for staging snapshot for a successful backup.</span></span> 
* <span data-ttu-id="722a7-261">Assurez-vous que la version Python sur les machines virtuelles Linux activées pour la sauvegarde est 2.7</span><span class="sxs-lookup"><span data-stu-id="722a7-261">Make sure that python version on Linux VMs enabled for backup is 2.7</span></span>

## <a name="data-encryption"></a><span data-ttu-id="722a7-262">Chiffrement des données</span><span class="sxs-lookup"><span data-stu-id="722a7-262">Data encryption</span></span>
<span data-ttu-id="722a7-263">Azure Backup ne chiffre pas les données dans le cadre du processus de sauvegarde hello.</span><span class="sxs-lookup"><span data-stu-id="722a7-263">Azure Backup does not encrypt data as a part of hello backup process.</span></span> <span data-ttu-id="722a7-264">Toutefois, vous pouvez chiffrer les données au sein de hello VM et hello de sauvegarder les données protégées en toute transparence (en savoir plus sur [sauvegarde des données chiffrées](backup-azure-vms-encryption.md)).</span><span class="sxs-lookup"><span data-stu-id="722a7-264">However, you can encrypt data within hello VM and back up hello protected data seamlessly (read more about [backup of encrypted data](backup-azure-vms-encryption.md)).</span></span>

## <a name="calculating-hello-cost-of-protected-instances"></a><span data-ttu-id="722a7-265">Calcul du coût hello d’instances protégées</span><span class="sxs-lookup"><span data-stu-id="722a7-265">Calculating hello cost of protected instances</span></span>
<span data-ttu-id="722a7-266">Machines virtuelles qui sont sauvegardés via Azure Backup sont soumises trop[tarification d’Azure Backup](https://azure.microsoft.com/pricing/details/backup/).</span><span class="sxs-lookup"><span data-stu-id="722a7-266">Azure virtual machines that are backed up through Azure Backup are subject too[Azure Backup pricing](https://azure.microsoft.com/pricing/details/backup/).</span></span> <span data-ttu-id="722a7-267">Hello calcul des Instances de protégé est basée sur hello *réel* taille de machine virtuelle hello, qui est la somme de hello de toutes les données hello dans la machine virtuelle hello en excluant hello « disque de ressources ».</span><span class="sxs-lookup"><span data-stu-id="722a7-267">hello Protected Instances calculation is based on hello *actual* size of hello virtual machine, which is hello sum of all hello data in hello virtual machine--excluding hello “resource disk.”</span></span>

<span data-ttu-id="722a7-268">Prix de sauvegarde d’ordinateurs virtuels est *pas* en fonction de taille hello maximale prise en charge pour chaque ordinateur virtuel de données disque toohello attaché.</span><span class="sxs-lookup"><span data-stu-id="722a7-268">Pricing for backing up VMs is *not* based on hello maximum supported size for each data disk attached toohello virtual machine.</span></span> <span data-ttu-id="722a7-269">Tarification est basée sur des données réelles de hello stockées dans le disque de données hello.</span><span class="sxs-lookup"><span data-stu-id="722a7-269">Pricing is based on hello actual data stored in hello data disk.</span></span> <span data-ttu-id="722a7-270">De même, facture de stockage de sauvegarde hello est basée sur quantité hello de données qui sont stockées dans Azure Backup, qui est la somme de hello des données réelles de hello dans chaque point de récupération.</span><span class="sxs-lookup"><span data-stu-id="722a7-270">Similarly, hello backup storage bill is based on hello amount of data that is stored in Azure Backup, which is hello sum of hello actual data in each recovery point.</span></span>

<span data-ttu-id="722a7-271">Prenons l’exemple d’une machine virtuelle de taille standard A2 avec deux disques de données supplémentaires d’une taille maximale de 1 To.</span><span class="sxs-lookup"><span data-stu-id="722a7-271">For example, take an A2 Standard-sized virtual machine that has two additional data disks with a maximum size of 1 TB each.</span></span> <span data-ttu-id="722a7-272">Hello tableau suivant donne des données hello stockées sur chacun de ces disques :</span><span class="sxs-lookup"><span data-stu-id="722a7-272">hello following table gives hello actual data stored on each of these disks:</span></span>

| <span data-ttu-id="722a7-273">Type de disque</span><span class="sxs-lookup"><span data-stu-id="722a7-273">Disk type</span></span> | <span data-ttu-id="722a7-274">Taille maximale</span><span class="sxs-lookup"><span data-stu-id="722a7-274">Max size</span></span> | <span data-ttu-id="722a7-275">Données réelles présentes</span><span class="sxs-lookup"><span data-stu-id="722a7-275">Actual data present</span></span> |
| --- | --- | --- |
| <span data-ttu-id="722a7-276">Disque de système d’exploitation</span><span class="sxs-lookup"><span data-stu-id="722a7-276">Operating system disk</span></span> |<span data-ttu-id="722a7-277">1 023 Go</span><span class="sxs-lookup"><span data-stu-id="722a7-277">1023 GB</span></span> |<span data-ttu-id="722a7-278">17 Go</span><span class="sxs-lookup"><span data-stu-id="722a7-278">17 GB</span></span> |
| <span data-ttu-id="722a7-279">Disque local/Disque de ressources</span><span class="sxs-lookup"><span data-stu-id="722a7-279">Local disk / Resource disk</span></span> |<span data-ttu-id="722a7-280">135 Go</span><span class="sxs-lookup"><span data-stu-id="722a7-280">135 GB</span></span> |<span data-ttu-id="722a7-281">5 Go (non inclus pour la sauvegarde)</span><span class="sxs-lookup"><span data-stu-id="722a7-281">5 GB (not included for backup)</span></span> |
| <span data-ttu-id="722a7-282">Disque de données 1</span><span class="sxs-lookup"><span data-stu-id="722a7-282">Data disk 1</span></span> |<span data-ttu-id="722a7-283">1 023 Go</span><span class="sxs-lookup"><span data-stu-id="722a7-283">1023 GB</span></span> |<span data-ttu-id="722a7-284">30 Go</span><span class="sxs-lookup"><span data-stu-id="722a7-284">30 GB</span></span> |
| <span data-ttu-id="722a7-285">Disque de données 2</span><span class="sxs-lookup"><span data-stu-id="722a7-285">Data disk 2</span></span> |<span data-ttu-id="722a7-286">1 023 Go</span><span class="sxs-lookup"><span data-stu-id="722a7-286">1023 GB</span></span> |<span data-ttu-id="722a7-287">0 Go</span><span class="sxs-lookup"><span data-stu-id="722a7-287">0 GB</span></span> |

<span data-ttu-id="722a7-288">Hello *réel* taille de machine virtuelle de hello est dans ce cas 17 Go + 30 Go + 0 = 47 go.</span><span class="sxs-lookup"><span data-stu-id="722a7-288">hello *actual* size of hello virtual machine in this case is 17 GB + 30 GB + 0 GB = 47 GB.</span></span> <span data-ttu-id="722a7-289">Cette taille instances protégées (47 Go) devient la base hello mensuel hello.</span><span class="sxs-lookup"><span data-stu-id="722a7-289">This Protected Instance size (47 GB) becomes hello basis for hello monthly bill.</span></span> <span data-ttu-id="722a7-290">En tant que hello quantité de données dans la machine virtuelle de hello augmente, taille des instances de protégé hello utilisé pour les modifications de facturation en conséquence.</span><span class="sxs-lookup"><span data-stu-id="722a7-290">As hello amount of data in hello virtual machine grows, hello Protected Instance size used for billing changes accordingly.</span></span>

<span data-ttu-id="722a7-291">Facturation ne démarre pas tant que sauvegarde première hello se termine.</span><span class="sxs-lookup"><span data-stu-id="722a7-291">Billing does not start until hello first successful backup completes.</span></span> <span data-ttu-id="722a7-292">À ce stade, la facturation hello pour le stockage et protégé par les Instances commence.</span><span class="sxs-lookup"><span data-stu-id="722a7-292">At this point, hello billing for both Storage and Protected Instances begins.</span></span> <span data-ttu-id="722a7-293">Facturation continue tant qu’il est *les données stockées dans un coffre de sauvegarde* pour la machine virtuelle de hello.</span><span class="sxs-lookup"><span data-stu-id="722a7-293">Billing continues as long as there is *any backup data stored in a vault* for hello virtual machine.</span></span> <span data-ttu-id="722a7-294">Si vous arrêtez la protection sur l’ordinateur virtuel de hello, mais les données de sauvegarde d’ordinateur virtuel existent dans un coffre, la facturation continue.</span><span class="sxs-lookup"><span data-stu-id="722a7-294">If you stop protection on hello virtual machine, but virtual machine backup data exists in a vault, billing continues.</span></span>

<span data-ttu-id="722a7-295">Facturation pour un ordinateur virtuel spécifié s’arrête uniquement en cas d’arrêt de la protection de hello *et* toutes les données de sauvegarde est supprimé.</span><span class="sxs-lookup"><span data-stu-id="722a7-295">Billing for a specified virtual machine stops only if hello protection is stopped *and* all backup data is deleted.</span></span> <span data-ttu-id="722a7-296">Lorsque la protection s’arrête et n’a aucune tâche de sauvegarde active, taille hello de la dernière sauvegarde VM réussie hello devient la taille des instances de protégé hello utilisé pour la facture mensuelle de hello.</span><span class="sxs-lookup"><span data-stu-id="722a7-296">When protection stops and there are no active backup jobs, hello size of hello last successful VM backup becomes hello Protected Instance size used for hello monthly bill.</span></span>

## <a name="questions"></a><span data-ttu-id="722a7-297">Des questions ?</span><span class="sxs-lookup"><span data-stu-id="722a7-297">Questions?</span></span>
<span data-ttu-id="722a7-298">Si vous avez des questions, ou s’il en existe toute fonctionnalité qui vous aimeriez toosee inclus, [envoyez-nous vos commentaires](http://aka.ms/azurebackup_feedback).</span><span class="sxs-lookup"><span data-stu-id="722a7-298">If you have questions, or if there is any feature that you would like toosee included, [send us feedback](http://aka.ms/azurebackup_feedback).</span></span>

## <a name="next-steps"></a><span data-ttu-id="722a7-299">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="722a7-299">Next steps</span></span>
* [<span data-ttu-id="722a7-300">Sauvegarde de machines virtuelles</span><span class="sxs-lookup"><span data-stu-id="722a7-300">Back up virtual machines</span></span>](backup-azure-vms.md)
* [<span data-ttu-id="722a7-301">Gestion de la sauvegarde de machine virtuelle</span><span class="sxs-lookup"><span data-stu-id="722a7-301">Manage virtual machine backup</span></span>](backup-azure-manage-vms.md)
* [<span data-ttu-id="722a7-302">Restauration des machines virtuelles</span><span class="sxs-lookup"><span data-stu-id="722a7-302">Restore virtual machines</span></span>](backup-azure-restore-vms.md)
* [<span data-ttu-id="722a7-303">Résoudre les problèmes de sauvegarde de machines virtuelles</span><span class="sxs-lookup"><span data-stu-id="722a7-303">Troubleshoot VM backup issues</span></span>](backup-azure-vms-troubleshoot.md)
