---
title: "aaaBackup et récupération d’urgence pour les disques Azure IaaS | Documents Microsoft"
description: "Dans cet article, nous expliquerons comment tooplan pour la sauvegarde et récupération d’urgence (DR) de IaaS machines () et les disques dans Azure. Ce document couvre les disques managés et non managés."
services: storage
cloud: Azure
documentationcenter: na
author: luywang
manager: kavithag
ms.assetid: 
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/19/2017
ms.author: luywang
ms.openlocfilehash: 49b0e7732d6df9407e1e44d9af2500c99a85b37e
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="backup-and-disaster-recovery-for-azure-iaas-disks"></a><span data-ttu-id="f7f70-104">Sauvegarde et récupération d’urgence pour les disques IaaS Azure</span><span class="sxs-lookup"><span data-stu-id="f7f70-104">Backup and disaster recovery for Azure IaaS disks</span></span>

<span data-ttu-id="f7f70-105">Dans cet article, nous expliquerons comment tooplan pour la sauvegarde et récupération d’urgence (DR) de IaaS machines () et les disques dans Azure.</span><span class="sxs-lookup"><span data-stu-id="f7f70-105">In this article, we will explain how tooplan for Backup and Disaster Recovery (DR) of IaaS virtual machines (VMs) and Disks in Azure.</span></span> <span data-ttu-id="f7f70-106">Ce document couvre les disques managés et non managés.</span><span class="sxs-lookup"><span data-stu-id="f7f70-106">This document covers both Managed and Unmanaged Disks.</span></span>

<span data-ttu-id="f7f70-107">Nous parlerons tout d’abord hello intégrées des fonctionnalités de tolérance Bonjour plateforme Azure qui vous protéger contre les défaillances locales.</span><span class="sxs-lookup"><span data-stu-id="f7f70-107">We’ll first talk about hello built-in fault tolerance capabilities in hello Azure platform which help guard against local failures.</span></span> <span data-ttu-id="f7f70-108">Nous discuterons des scénarios de reprise après sinistre hello pas entièrement couverts par les fonctionnalités intégrées de hello, qui est le sujet principal de hello traité par ce document.</span><span class="sxs-lookup"><span data-stu-id="f7f70-108">We’ll then discuss hello disaster scenarios not fully covered by hello built-in capabilities, which is hello main topic addressed by this document.</span></span> <span data-ttu-id="f7f70-109">Nous montrons également plusieurs exemples de charges de travail où différentes considérations en matière de sauvegarde et de récupération d’urgence peuvent s’appliquer.</span><span class="sxs-lookup"><span data-stu-id="f7f70-109">We’ll also show several examples of workload scenarios where different Backup and DR considerations may apply.</span></span> <span data-ttu-id="f7f70-110">Nous voyons ensuite les solutions possibles pour la récupération d’urgence des disques IaaS.</span><span class="sxs-lookup"><span data-stu-id="f7f70-110">We’ll then review possible solutions for DR of IaaS Disks.</span></span> 

## <a name="introduction"></a><span data-ttu-id="f7f70-111">Introduction</span><span class="sxs-lookup"><span data-stu-id="f7f70-111">Introduction</span></span>

<span data-ttu-id="f7f70-112">Hello plateforme Azure utilise plusieurs méthodes pour assurer la redondance et protéger les clients contre les défaillances matérielles localisées qui peuvent se produire toohelp de tolérance de panne.</span><span class="sxs-lookup"><span data-stu-id="f7f70-112">hello Azure platform uses various methods for redundancy and fault tolerance toohelp protect customers from localized hardware failures that can occur.</span></span> <span data-ttu-id="f7f70-113">Échecs locaux peuvent inclure des problèmes avec un ordinateur de serveur de stockage Azure qui stocke une partie des données hello pour un disque virtuel ou échecs d’un disque SSD ou un disque dur sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="f7f70-113">Local failures may include problems with an Azure storage server machine that stores part of hello data for a virtual disk or failures of an SSD or HDD on that server.</span></span> <span data-ttu-id="f7f70-114">Ces défaillances de composant matériel isolé peuvent se produire pendant les opérations normales et plate-forme de hello est conçue toobe toothese résilient échecs.</span><span class="sxs-lookup"><span data-stu-id="f7f70-114">Such isolated hardware component failures can happen during normal operations and hello platform is designed toobe resilient toothese failures.</span></span> <span data-ttu-id="f7f70-115">Des sinistres majeurs peuvent entraîner des défaillances ou l’inaccessibilité d’un grand nombre de serveurs de stockage ou d’un centre de données entier.</span><span class="sxs-lookup"><span data-stu-id="f7f70-115">Major disasters can result in failures or inaccessibility of a large numbers of storage servers or a whole datacenter.</span></span> <span data-ttu-id="f7f70-116">Alors que vos machines virtuelles et les disques sont normalement protégés contre les défaillances localisés, des étapes supplémentaires sont nécessaire tooprotect votre charge de travail à partir de la région d’erreurs irrécupérables (par exemple, une catastrophe majeure) qui peuvent affecter votre machine virtuelle et les disques.</span><span class="sxs-lookup"><span data-stu-id="f7f70-116">While your VMs and disks are normally protected from localized failures, additional steps are necessary tooprotect your workload from region-wide catastrophic failures (such as a major disaster) that can affect your VM and disks.</span></span>

<span data-ttu-id="f7f70-117">En outre possibilité toohello d’échecs de la plateforme, des problèmes avec les données ou application de client hello peuvent se produire.</span><span class="sxs-lookup"><span data-stu-id="f7f70-117">In addition toohello possibility of platform failures, problems with hello customer application or data can occur.</span></span> <span data-ttu-id="f7f70-118">Par exemple, une nouvelle version de votre application peut par inadvertance modifiez importantes toohello données.</span><span class="sxs-lookup"><span data-stu-id="f7f70-118">For example, a new version of your application may inadvertently make a breaking change toohello data.</span></span> <span data-ttu-id="f7f70-119">Dans ce cas, vous souhaiterez peut-être application hello de toorevert et hello données tooa version antérieure contenant hello dernier état correct connu.</span><span class="sxs-lookup"><span data-stu-id="f7f70-119">In that case, you may want toorevert hello application and hello data tooa prior version containing hello last known good state.</span></span> <span data-ttu-id="f7f70-120">Cela nécessite la gestion de sauvegardes régulières.</span><span class="sxs-lookup"><span data-stu-id="f7f70-120">This requires maintaining regular backups.</span></span>

<span data-ttu-id="f7f70-121">Reprise après sinistre régional, vous devez sauvegarder votre IaaS VM disques tooa autre région.</span><span class="sxs-lookup"><span data-stu-id="f7f70-121">For regional disaster recovery, you must backup your IaaS VM disks tooa different region.</span></span> 

<span data-ttu-id="f7f70-122">Avant d’examiner les options de sauvegarde et de récupération d’urgence, récapitulons quelques méthodes disponibles pour gérer les défaillances localisées.</span><span class="sxs-lookup"><span data-stu-id="f7f70-122">Before we look at Backup and DR options, let’s recap a few methods available for handling localized failures.</span></span>

### <a name="azure-iaas-resiliency"></a><span data-ttu-id="f7f70-123">Résilience Azure IaaS</span><span class="sxs-lookup"><span data-stu-id="f7f70-123">Azure IaaS Resiliency</span></span>

<span data-ttu-id="f7f70-124">*Résilience* fait référence toohello tolérance des échecs normales qui se produisent dans les composants matériels.</span><span class="sxs-lookup"><span data-stu-id="f7f70-124">*Resiliency* refers toohello tolerance for normal failures that occur in hardware components.</span></span> <span data-ttu-id="f7f70-125">Résilience est toorecover de capacité hello contre les pannes et continuer toofunction.</span><span class="sxs-lookup"><span data-stu-id="f7f70-125">Resiliency is hello ability toorecover from failures and continue toofunction.</span></span> <span data-ttu-id="f7f70-126">Il n’est pas sur ce qui évite les échecs, mais répond toofailures d’une manière qui évite les temps d’arrêt ou perte de données.</span><span class="sxs-lookup"><span data-stu-id="f7f70-126">It's not about avoiding failures, but responding toofailures in a way that avoids downtime or data loss.</span></span> <span data-ttu-id="f7f70-127">Hello résilience vise tooreturn hello tooa pleinement fonctionnel état de l’application après un échec.</span><span class="sxs-lookup"><span data-stu-id="f7f70-127">hello goal of resiliency is tooreturn hello application tooa fully functioning state following a failure.</span></span> <span data-ttu-id="f7f70-128">Machines virtuelles et les disques sont les défaillances matérielles conçue toobe toocommon résilient.</span><span class="sxs-lookup"><span data-stu-id="f7f70-128">Azure Virtual Machines and Disks are designed toobe resilient toocommon hardware faults.</span></span> <span data-ttu-id="f7f70-129">Examinons la plateforme Azure IaaS de hello fournit cette résilience.</span><span class="sxs-lookup"><span data-stu-id="f7f70-129">Let us look at how hello Azure IaaS platform provides this resiliency.</span></span>

<span data-ttu-id="f7f70-130">Un ordinateur virtuel se compose principalement de deux parties : un (1) de calcul serveur et les disques persistants hello (2).</span><span class="sxs-lookup"><span data-stu-id="f7f70-130">A virtual machine consists mainly of two parts: (1) A compute server, and (2) hello persistent disks.</span></span> <span data-ttu-id="f7f70-131">Les deux affectent hello une tolérance de panne d’un ordinateur virtuel.</span><span class="sxs-lookup"><span data-stu-id="f7f70-131">Both affect hello fault tolerance of a virtual machine.</span></span>

<span data-ttu-id="f7f70-132">Si le serveur hôte de calcul Azure hello qui héberge votre machine virtuelle rencontre une défaillance matérielle (ce qui est rare), Azure est conçue tooautomatically restauration hello machine virtuelle sur un autre serveur.</span><span class="sxs-lookup"><span data-stu-id="f7f70-132">If hello Azure compute host server that houses your VM experiences a hardware failure (which is rare), Azure is designed tooautomatically restore hello VM on another server.</span></span> <span data-ttu-id="f7f70-133">Dans ce cas, vous rencontrerez un redémarrage et hello machine virtuelle sera après un certain temps.</span><span class="sxs-lookup"><span data-stu-id="f7f70-133">If this happens, you will experience a reboot, and hello VM will be back up after some time.</span></span> <span data-ttu-id="f7f70-134">Azure détecte ces défaillances matérielles automatiquement et exécute des récupérations toohelp vous assurer que le client de hello machine virtuelle seront disponible dès que possible.</span><span class="sxs-lookup"><span data-stu-id="f7f70-134">Azure automatically detects such hardware failures and executes recoveries toohelp ensure hello customer VM will be available as soon as possible.</span></span>

<span data-ttu-id="f7f70-135">Relatives aux disques de IaaS, la durabilité des données est essentielle pour la plateforme de stockage persistant hello.</span><span class="sxs-lookup"><span data-stu-id="f7f70-135">Regarding IaaS disks, durability of data is critical for hello persistent storage platform.</span></span> <span data-ttu-id="f7f70-136">Les clients Azure ont des applications métier importants sur IaaS, et ils dépendent de persistance hello de données de hello.</span><span class="sxs-lookup"><span data-stu-id="f7f70-136">Azure customers have important business applications running on IaaS and they depend on hello persistence of hello data.</span></span> <span data-ttu-id="f7f70-137">Azure conçoit la protection de ces disques IaaS avec trois copies redondantes des données stockées localement, fournissant ainsi une durabilité élevée contre les défaillances locales.</span><span class="sxs-lookup"><span data-stu-id="f7f70-137">Azure designs protection for these IaaS disks with three redundant copies of data stored locally, providing high durability against local failures.</span></span> <span data-ttu-id="f7f70-138">Si un des composants matériels hello qui contient le disque échoue, votre machine virtuelle n’est pas affecté, car il existe deux copies supplémentaires toosupport disque demandes.</span><span class="sxs-lookup"><span data-stu-id="f7f70-138">If one of hello hardware components that holds your disk fails, your VM is not impacted because there are two additional copies toosupport disk requests.</span></span> <span data-ttu-id="f7f70-139">Elle fonctionne même si les deux différents composants matériels prenant en charge d’un disque d’échouer au hello identiques (ce qui est très rare).</span><span class="sxs-lookup"><span data-stu-id="f7f70-139">It works fine even if two different hardware components supporting a disk fail at hello same time (which would be very rare).</span></span> <span data-ttu-id="f7f70-140">toohelp Assurez-vous que nous conservent toujours les trois réplicas, le service de stockage Azure hello génère automatiquement une nouvelle copie de données en arrière-plan de hello si un des trois copies de hello n’est plus disponible.</span><span class="sxs-lookup"><span data-stu-id="f7f70-140">toohelp ensure we always maintain three replicas, hello Azure Storage service automatically spawns a new copy of data in hello background if one of hello three copies becomes unavailable.</span></span> <span data-ttu-id="f7f70-141">Par conséquent, il ne doit pas être nécessaire toouse RAID avec des disques Azure pour la tolérance de panne.</span><span class="sxs-lookup"><span data-stu-id="f7f70-141">Therefore, it should not be necessary toouse RAID with Azure disks for fault tolerance.</span></span> <span data-ttu-id="f7f70-142">Un simple RAID de niveau 0 configuration doit être suffisante pour la répartition des disques hello si les volumes de grande capacité toocreate nécessaire.</span><span class="sxs-lookup"><span data-stu-id="f7f70-142">A simple RAID 0 configuration should be sufficient for striping hello disks if necessary toocreate larger volumes.</span></span>

<span data-ttu-id="f7f70-143">Cette architecture a permis à **Azure de fournir de façon cohérente une durabilité de classe Entreprise pour les disques IaaS, avec un [taux de défaillance annuel](https://en.wikipedia.org/wiki/Annualized_failure_rate) inégalé dans le secteur de zéro %.**</span><span class="sxs-lookup"><span data-stu-id="f7f70-143">Because of this architecture, **Azure has consistently delivered enterprise-grade durability for IaaS disks, with an industry-leading ZERO % [Annualized Failure Rate](https://en.wikipedia.org/wiki/Annualized_failure_rate).**</span></span>

<span data-ttu-id="f7f70-144">Les défaillances matérielles localisées sur hello calcul héberger ou dans le stockage hello plateforme peut quelquefois provoquer une indisponibilité temporaire pour hello machine virtuelle qui n’est couverte par hello [contrat SLA Azure](https://azure.microsoft.com/support/legal/sla/virtual-machines/) pour la disponibilité de la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="f7f70-144">Localized hardware faults on hello compute host or in hello storage platform can sometimes result in temporary unavailability for hello VM which is covered by hello [Azure SLA](https://azure.microsoft.com/support/legal/sla/virtual-machines/) for VM Availability.</span></span> <span data-ttu-id="f7f70-145">Azure fournit également un contrat SLA de pointe pour les instances de machine virtuelle uniques qui utilisent des disques Stockage Premium.</span><span class="sxs-lookup"><span data-stu-id="f7f70-145">Azure also provides an industry-leading SLA for single VM instances that use Premium Storage disks.</span></span>

<span data-ttu-id="f7f70-146">toosafeguard des charges de travail à partir du temps mort en raison d’une indisponibilité temporaire de toohello d’un disque ou d’une machine virtuelle, les clients peuvent exploiter [haute disponibilité](../../virtual-machines/windows/manage-availability.md).</span><span class="sxs-lookup"><span data-stu-id="f7f70-146">toosafeguard application workloads from downtime due toohello temporary unavailability of a disk or VM, customers can leverage [Availability Sets](../../virtual-machines/windows/manage-availability.md).</span></span> <span data-ttu-id="f7f70-147">Deux ou plusieurs machines virtuelles dans un ensemble de disponibilité apporte la redondance pour l’application hello.</span><span class="sxs-lookup"><span data-stu-id="f7f70-147">Two or more virtual machines in an availability set provides redundancy for hello application.</span></span> <span data-ttu-id="f7f70-148">Azure crée ensuite ces machines virtuelles et disques dans des domaines d’erreur distincts avec différents composants d’alimentation, réseau et serveur.</span><span class="sxs-lookup"><span data-stu-id="f7f70-148">Azure then creates these VMs and disks in separate fault domains with different power, network, and server components.</span></span> <span data-ttu-id="f7f70-149">Par conséquent, les défaillances matérielles localisées généralement n’affectent pas plusieurs machines virtuelles dans hello définie au hello même temps, en fournissant une haute disponibilité pour votre application.</span><span class="sxs-lookup"><span data-stu-id="f7f70-149">Thus, localized hardware failures typically do not affect multiple VMs in hello set at hello same time, providing high availability for your application.</span></span> <span data-ttu-id="f7f70-150">Il est considéré comme une disponibilité toouse de bonnes pratiques définit lors de la haute disponibilité n’est requise.</span><span class="sxs-lookup"><span data-stu-id="f7f70-150">It is considered a good practice toouse availability sets when high availability is required.</span></span> <span data-ttu-id="f7f70-151">Pour plus d’informations, consultez les aspects de la récupération d’urgence hello détaillées ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="f7f70-151">For more information, see hello Disaster Recovery aspects detailed below.</span></span>

### <a name="backup-and-disaster-recovery"></a><span data-ttu-id="f7f70-152">Sauvegarde et récupération d’urgence</span><span class="sxs-lookup"><span data-stu-id="f7f70-152">Backup and Disaster Recovery</span></span>

<span data-ttu-id="f7f70-153">La récupération d’urgence (DR) est toorecover de capacité hello d’incidents rares mais principales : les défaillances non transitoires et à grande échelle, tels que des interruptions de service qui affecte une région entière.</span><span class="sxs-lookup"><span data-stu-id="f7f70-153">Disaster recovery (DR) is hello ability toorecover from rare but major incidents: non-transient, wide-scale failures, such as service disruption that affects an entire region.</span></span> <span data-ttu-id="f7f70-154">La récupération d’urgence inclut la sauvegarde et l’archivage des données. Elle peut également inclure une intervention manuelle, comme la restauration d’une base de données à partir de la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="f7f70-154">Disaster recovery includes data backup and archiving, and may include manual intervention, such as restoring a database from backup.</span></span>

<span data-ttu-id="f7f70-155">Hello une protection intégrée contre les défaillances localisées de plateforme Azure ne peut pas protéger entièrement hello machines virtuelles/disques dans le cas de hello de sinistres majeurs qui peut provoquer des interruptions à grande échelle.</span><span class="sxs-lookup"><span data-stu-id="f7f70-155">hello Azure platform’s built-in protection against localized failures may not fully protect hello VMs/disks in hello case of major disasters which can cause large-scale outages.</span></span> <span data-ttu-id="f7f70-156">Cela inclut les événements catastrophiques, par exemple un centre de données atteint par un ouragan, un tremblement de terre, un incendie ou des pannes d’unités matérielles à grande échelle.</span><span class="sxs-lookup"><span data-stu-id="f7f70-156">This includes catastrophic events such as a data center being hit by a hurricane, earthquake, fire, or large scale hardware unit failures.</span></span> <span data-ttu-id="f7f70-157">En outre, vous pouvez rencontrer des échecs en raison de problèmes de tooapplication ou de données.</span><span class="sxs-lookup"><span data-stu-id="f7f70-157">In addition, you may encounter failures due tooapplication or data issues.</span></span>

<span data-ttu-id="f7f70-158">toohelp protection de vos charges de travail IaaS contre les pannes, vous devez planifier pour la récupération de tooenable de redondance et de sauvegardes.</span><span class="sxs-lookup"><span data-stu-id="f7f70-158">toohelp protect your IaaS workloads from outages, you should plan for redundancy and backups tooenable recovery.</span></span> <span data-ttu-id="f7f70-159">Récupération d’urgence, vous devez prévoir de redondance et de sauvegarde dans un emplacement géographique différent en dehors du site principal de hello.</span><span class="sxs-lookup"><span data-stu-id="f7f70-159">For disaster recovery, you should plan redundancy and backup in a different geographic location away from hello primary site.</span></span> <span data-ttu-id="f7f70-160">Cela permet de garantir la sauvegarde n’est pas affectée par hello même événement à l’origine des conséquences sur hello machine virtuelle ou les disques.</span><span class="sxs-lookup"><span data-stu-id="f7f70-160">This helps ensure your backup is not affected by hello same event that originally impacted hello VM or disks.</span></span> <span data-ttu-id="f7f70-161">Pour plus d’informations, consultez [Récupération d’urgence pour les applications développées sur Azure](https://docs.microsoft.com/azure/architecture/resiliency/disaster-recovery-azure-applications).</span><span class="sxs-lookup"><span data-stu-id="f7f70-161">For more information, see [Disaster Recovery for Applications built on Azure](https://docs.microsoft.com/azure/architecture/resiliency/disaster-recovery-azure-applications).</span></span>

<span data-ttu-id="f7f70-162">Votre considérations relatives à la récupération d’urgence peuvent inclure hello suivant aspects :</span><span class="sxs-lookup"><span data-stu-id="f7f70-162">Your DR considerations may include hello following aspects:</span></span>

1. <span data-ttu-id="f7f70-163">Haute disponibilité (HA) est la capacité hello hello application toocontinue est en cours d’exécution dans un état sain, sans temps mort significatif.</span><span class="sxs-lookup"><span data-stu-id="f7f70-163">High Availability (HA) is hello ability of hello application toocontinue running in a healthy state, without significant downtime.</span></span> <span data-ttu-id="f7f70-164">Par « sain », nous entendons application hello ne répond, les utilisateurs peuvent se connecter toohello application et interagir avec lui.</span><span class="sxs-lookup"><span data-stu-id="f7f70-164">By "healthy state," we mean hello application is responsive, and users can connect toohello application and interact with it.</span></span> <span data-ttu-id="f7f70-165">Certaines bases de données et les applications critiques peuvent être requis toobe disponible toujours, même lorsque sont en panne dans la plateforme de hello.</span><span class="sxs-lookup"><span data-stu-id="f7f70-165">Certain mission-critical applications and databases may be required toobe available always, even when there are failures in hello platform.</span></span> <span data-ttu-id="f7f70-166">Pour ces charges de travail, vous devrez peut-être redondance tooplan pour l’application hello, ainsi que les données de salutation.</span><span class="sxs-lookup"><span data-stu-id="f7f70-166">For these workloads, you may need tooplan redundancy for hello application as well as hello data.</span></span>

2. <span data-ttu-id="f7f70-167">Durabilité des données : Dans certains cas, les considération principale hello sont de vous assurer les données hello sont conservées dans le cas de hello d’un incident.</span><span class="sxs-lookup"><span data-stu-id="f7f70-167">Data Durability: In some cases, hello main consideration is ensuring hello data is preserved in hello case of a disaster.</span></span> <span data-ttu-id="f7f70-168">Par conséquent, vous aurez peut-être besoin d’une sauvegarde de vos données dans un autre site.</span><span class="sxs-lookup"><span data-stu-id="f7f70-168">Therefore, you may need a backup of your data in a different site.</span></span> <span data-ttu-id="f7f70-169">Pour ces charges de travail, vous ne devrez pas peut-être une redondance complète pour l’application hello, mais une sauvegarde régulière des disques de hello.</span><span class="sxs-lookup"><span data-stu-id="f7f70-169">For such workloads, you may not need full redundancy for hello application, but a regular backup of hello disks.</span></span>

## <a name="backup-and-dr-scenarios"></a><span data-ttu-id="f7f70-170">Scénarios de sauvegarde et de récupération d’urgence</span><span class="sxs-lookup"><span data-stu-id="f7f70-170">Backup and DR Scenarios</span></span>

<span data-ttu-id="f7f70-171">Examinons quelques exemples de scénarios de charge de travail d’application et les considérations de hello pour la planification de la récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="f7f70-171">Let’s look at a few typical examples of application workload scenarios and hello considerations for planning Disaster Recovery.</span></span>

### <a name="scenario-1-major-database-solutions"></a><span data-ttu-id="f7f70-172">Scénario 1 : solutions de base de données majeures</span><span class="sxs-lookup"><span data-stu-id="f7f70-172">Scenario 1: Major Database Solutions</span></span>

<span data-ttu-id="f7f70-173">Prenons l’exemple d’un serveur de base de données de production tel que SQL Server ou Oracle prenant en charge la haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="f7f70-173">Consider a production database server like SQL Server or Oracle that can support High Availability.</span></span> <span data-ttu-id="f7f70-174">Les utilisateurs et les applications de production critiques dépendent de cette base de données.</span><span class="sxs-lookup"><span data-stu-id="f7f70-174">Critical production applications and users depend on this database.</span></span> <span data-ttu-id="f7f70-175">plan de récupération d’urgence Hello pour ce système peut être nécessaire de hello toosupport suivant les exigences :</span><span class="sxs-lookup"><span data-stu-id="f7f70-175">hello Disaster Recovery plan for this system may need toosupport hello following requirements:</span></span>

1. <span data-ttu-id="f7f70-176">Les données doivent être protégées et récupérables.</span><span class="sxs-lookup"><span data-stu-id="f7f70-176">Data must be protected and recoverable.</span></span>
2.  <span data-ttu-id="f7f70-177">Le serveur doit être disponible pour utilisation.</span><span class="sxs-lookup"><span data-stu-id="f7f70-177">Server must be available for use.</span></span>

<span data-ttu-id="f7f70-178">Cette opération peut nécessiter la gestion d’un réplica de base de données hello dans une région différente de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="f7f70-178">This may require maintaining a replica of hello database in a different region as a backup.</span></span> <span data-ttu-id="f7f70-179">Selon les spécifications de hello pour la récupération des données et de la disponibilité du serveur, les solutions hello peut consister à partir d’un actif-actif ou actif-passif réplica site tooperiodic sauvegardes hors connexion de données de salutation.</span><span class="sxs-lookup"><span data-stu-id="f7f70-179">Depending on hello requirements for server availability and data recovery, hello solution could range from an Active-Active or Active-Passive replica site tooperiodic offline backups of hello data.</span></span> <span data-ttu-id="f7f70-180">Les bases de données relationnelles telles que SQL Server et Oracle fournissent diverses options pour la réplication.</span><span class="sxs-lookup"><span data-stu-id="f7f70-180">Relational databases such as SQL Server and Oracle provide various options for replication.</span></span> <span data-ttu-id="f7f70-181">Pour SQL Server, les [groupes de disponibilité SQL Server Always On](https://msdn.microsoft.com/library/hh510230.aspx) peuvent être utilisés pour la haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="f7f70-181">For SQL Server, [SQL Server Always On Availability Groups](https://msdn.microsoft.com/library/hh510230.aspx) can be used for high availability.</span></span>

<span data-ttu-id="f7f70-182">Les bases de données NoSQL comme MongoDB prennent également en charge les [réplicas](https://docs.mongodb.com/manual/replication/) pour assurer la redondance.</span><span class="sxs-lookup"><span data-stu-id="f7f70-182">NoSQL databases like MongoDB also support [replicas](https://docs.mongodb.com/manual/replication/) for redundancy.</span></span> <span data-ttu-id="f7f70-183">réplicas Hello pour la haute disponibilité peuvent être utilisés.</span><span class="sxs-lookup"><span data-stu-id="f7f70-183">hello replicas for high availability can be used.</span></span>

### <a name="scenario-2-a-cluster-of-redundant-vms"></a><span data-ttu-id="f7f70-184">Scénario 2 : un cluster de machines virtuelles redondantes</span><span class="sxs-lookup"><span data-stu-id="f7f70-184">Scenario 2: A cluster of redundant VMs</span></span>

<span data-ttu-id="f7f70-185">Prenons l’exemple d’une charge de travail gérée par un cluster de machines virtuelles qui fournit la redondance et l’équilibrage de charge.</span><span class="sxs-lookup"><span data-stu-id="f7f70-185">Consider a workload handled by a cluster of VMs that provide redundancy and load balancing.</span></span> <span data-ttu-id="f7f70-186">Il peut s’agir d’un cluster Cassandra déployé dans une région.</span><span class="sxs-lookup"><span data-stu-id="f7f70-186">One example would be a Cassandra cluster deployed in a region.</span></span> <span data-ttu-id="f7f70-187">Ce type d’architecture fournit déjà un niveau élevé de redondance dans cette région.</span><span class="sxs-lookup"><span data-stu-id="f7f70-187">This type of architecture already provides a high level of redundancy within that region.</span></span> <span data-ttu-id="f7f70-188">Toutefois, vous tooprotect hello la charge de travail à partir d’une défaillance au niveau régionale, vous devez envisager propagation du cluster de hello entre deux régions ou de création de la région tooanother des sauvegardes périodiques.</span><span class="sxs-lookup"><span data-stu-id="f7f70-188">However, tooprotect hello workload from a regional level failure, you should consider spreading hello cluster across two regions or making periodic backups tooanother region.</span></span>

### <a name="scenario-3-iaas-application-workload"></a><span data-ttu-id="f7f70-189">Scénario 3 : charge de travail d’application IaaS</span><span class="sxs-lookup"><span data-stu-id="f7f70-189">Scenario 3: IaaS Application Workload</span></span>

<span data-ttu-id="f7f70-190">Il peut s’agir d’une charge de travail de production standard exécutée sur une machine virtuelle Azure.</span><span class="sxs-lookup"><span data-stu-id="f7f70-190">This could be a typical production workload running on an Azure VM.</span></span> <span data-ttu-id="f7f70-191">Par exemple, il peut être un serveur web ou un serveur de fichiers contenant le contenu de hello et d’autres ressources d’un site.</span><span class="sxs-lookup"><span data-stu-id="f7f70-191">For example, it could be a web server or file server holding hello content and other resources of a site.</span></span> <span data-ttu-id="f7f70-192">Il peut également être une application métier personnalisée en cours d’exécution sur un ordinateur virtuel stocké de ses données, les ressources et état de l’application sur les disques de machine virtuelle hello.</span><span class="sxs-lookup"><span data-stu-id="f7f70-192">It could also be a custom-built business application running on a VM that stored its data, resources, and application state on hello VM disks.</span></span> <span data-ttu-id="f7f70-193">Dans ce cas, il est important toomake que vous effectuez des sauvegardes régulièrement.</span><span class="sxs-lookup"><span data-stu-id="f7f70-193">In this case, it is important toomake sure you take backups on a regular basis.</span></span> <span data-ttu-id="f7f70-194">Fréquence de sauvegarde doit reposer sur la nature hello de charge de travail de machine virtuelle hello.</span><span class="sxs-lookup"><span data-stu-id="f7f70-194">Backup frequency should be based on hello nature of hello VM workload.</span></span> <span data-ttu-id="f7f70-195">Par exemple, si l’application hello s’exécute chaque jour et modifie des données, puis hello sauvegarde doit être effectuée toutes les heures.</span><span class="sxs-lookup"><span data-stu-id="f7f70-195">For example, if hello application runs every day and modifies data, then hello backup should be taken every hour.</span></span>

<span data-ttu-id="f7f70-196">Voici un autre exemple : un serveur de rapports qui extrait des données provenant d’autres sources et génère des rapports agrégés.</span><span class="sxs-lookup"><span data-stu-id="f7f70-196">Another example is a reporting server that pull data from other sources and generates aggregated reports.</span></span> <span data-ttu-id="f7f70-197">Perte de cette machine virtuelle ou de disques entraîne une perte de toohello des rapports de hello.</span><span class="sxs-lookup"><span data-stu-id="f7f70-197">Loss of this VM or disks will lead toohello loss of hello reports.</span></span> <span data-ttu-id="f7f70-198">Toutefois, il peut être hello toorerun possible de processus et sortie de régénérer hello reporting.</span><span class="sxs-lookup"><span data-stu-id="f7f70-198">However, it may be possible toorerun hello reporting process and regenerate hello output.</span></span> <span data-ttu-id="f7f70-199">Dans ce cas, vous n’avez vraiment la perte de données même si le serveur de rapports hello est atteint avec un sinistre, donc vous pouvez avoir un niveau plus élevé de tolérance de perte de données hello sur le serveur de rapports de hello.</span><span class="sxs-lookup"><span data-stu-id="f7f70-199">In that case, you don’t really have a loss of data even if hello reporting server is hit with a disaster, so you could have a higher level of tolerance for losing part of hello data on hello reporting server.</span></span> <span data-ttu-id="f7f70-200">Dans ce cas, les sauvegardes moins fréquentes est un coût de hello tooreduce option.</span><span class="sxs-lookup"><span data-stu-id="f7f70-200">In that case, less frequent backups is an option tooreduce hello cost.</span></span>

### <a name="scenario-4-iaas-application-data-issues"></a><span data-ttu-id="f7f70-201">Scénario 4 : problèmes liés aux données d’une application IaaS</span><span class="sxs-lookup"><span data-stu-id="f7f70-201">Scenario 4: IaaS Application data issues</span></span>

<span data-ttu-id="f7f70-202">Vous avez une application qui calcule, tient à jour et gère des données commerciales critiques telles que des informations de tarification.</span><span class="sxs-lookup"><span data-stu-id="f7f70-202">You have an application that computes, maintains, and serves critical commercial data such as pricing information.</span></span> <span data-ttu-id="f7f70-203">Une nouvelle version de votre application avait un bogue logiciel incorrectement calculée hello tarification et endommagé des données commerce existantes hello pris en charge par la plateforme de hello.</span><span class="sxs-lookup"><span data-stu-id="f7f70-203">A new version of your application had a software bug which incorrectly computed hello pricing and corrupted hello existing commerce data served by hello platform.</span></span> <span data-ttu-id="f7f70-204">Ici, hello meilleure marche à suivre serait toorevert toohello une version antérieure de l’application hello et les données de salutation premier.</span><span class="sxs-lookup"><span data-stu-id="f7f70-204">Here, hello best course of action would be toorevert toohello earlier version of hello application and hello data first.</span></span> <span data-ttu-id="f7f70-205">tooenable cette option, prenez des sauvegardes périodiques de votre système.</span><span class="sxs-lookup"><span data-stu-id="f7f70-205">tooenable this, take periodic backups of your system.</span></span>

## <a name="disaster-recovery-solution-azure-backup-service"></a><span data-ttu-id="f7f70-206">Solution de récupération d’urgence : service Sauvegarde Azure</span><span class="sxs-lookup"><span data-stu-id="f7f70-206">Disaster Recovery Solution: Azure Backup Service</span></span>

<span data-ttu-id="f7f70-207">Le [service Sauvegarde Azure](https://azure.microsoft.com/services/backup/) peut être utilisé pour la sauvegarde et la récupération d’urgence et il fonctionne aussi bien avec les [disques managés](../../virtual-machines/windows/managed-disks-overview.md) que les [disques non managés](../../virtual-machines/windows/about-disks-and-vhds.md#unmanaged-disks).</span><span class="sxs-lookup"><span data-stu-id="f7f70-207">[Azure Backup Service](https://azure.microsoft.com/services/backup/) is can be used for Backup and DR, and it works with [Managed Disks](../../virtual-machines/windows/managed-disks-overview.md) as well as [Unmanaged Disks](../../virtual-machines/windows/about-disks-and-vhds.md#unmanaged-disks).</span></span> <span data-ttu-id="f7f70-208">Vous pouvez créer un travail de sauvegarde avec des sauvegardes périodiques, une restauration facile des machines virtuelles et des stratégies de rétention de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="f7f70-208">You can create a backup job with time-based backups, easy VM restoration and backup retention policies.</span></span> 

<span data-ttu-id="f7f70-209">Si vous utilisez [disques de stockage Premium](storage-premium-storage.md), [disques gérés](../../virtual-machines/windows/managed-disks-overview.md), ou d’autres types de disque avec hello [stockage localement redondant (LRS)](storage-redundancy.md#locally-redundant-storage) option, il est particulièrement important tooleverage des sauvegardes de récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="f7f70-209">If you use [Premium Storage disks](storage-premium-storage.md), [Managed Disks](../../virtual-machines/windows/managed-disks-overview.md), or other disk types with hello [locally redundant storage (LRS)](storage-redundancy.md#locally-redundant-storage) option, it is especially important tooleverage periodic DR backups.</span></span> <span data-ttu-id="f7f70-210">Sauvegarde Azure stocke les données de hello dans votre coffre Recovery Services pour une rétention à long terme.</span><span class="sxs-lookup"><span data-stu-id="f7f70-210">Azure Backup stores hello data in your Recovery Services vault for long term retention.</span></span> <span data-ttu-id="f7f70-211">Choisissez hello [stockage géo-redondant (GRS)](storage-redundancy.md#geo-redundant-storage) option pour les Services de récupération de sauvegarde hello coffre.</span><span class="sxs-lookup"><span data-stu-id="f7f70-211">Choose hello [Geo-redundant storage (GRS)](storage-redundancy.md#geo-redundant-storage) option for hello Backup Recovery Services vault.</span></span> <span data-ttu-id="f7f70-212">Cela permettra de garantir les sauvegardes sont répliquées tooa autre région Azure pour la protection contre les sinistres distants.</span><span class="sxs-lookup"><span data-stu-id="f7f70-212">That will ensure backups are replicated tooa different Azure region for safeguarding from regional disasters.</span></span>

<span data-ttu-id="f7f70-213">Pour [disques non managé](../../virtual-machines/windows/about-disks-and-vhds.md#unmanaged-disks), vous pouvez utiliser le type de stockage LRS hello pour les disques IaaS, mais assurez-vous que Azure Backup est activé par hello option GRS pour hello coffre Recovery Services.</span><span class="sxs-lookup"><span data-stu-id="f7f70-213">For [Unmanaged Disks](../../virtual-machines/windows/about-disks-and-vhds.md#unmanaged-disks), you can use hello LRS storage type for IaaS disks, but ensure that Azure Backup is enabled with hello GRS option for hello Recovery Services Vault.</span></span>

<span data-ttu-id="f7f70-214">**Si vous utilisez hello [GRS](storage-redundancy.md#geo-redundant-storage)/[RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage) option pour vos disques non managé, vous avez besoin de captures instantanées cohérentes avec pour la sauvegarde et récupération d’urgence.**</span><span class="sxs-lookup"><span data-stu-id="f7f70-214">**If you use hello [GRS](storage-redundancy.md#geo-redundant-storage)/[RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage) option for your Unmanaged Disks, you still need consistent snapshots for Backup and DR.**</span></span> <span data-ttu-id="f7f70-215">Vous devez utiliser le [service Sauvegarde Azure](https://azure.microsoft.com/services/backup/) ou des [captures instantanées cohérentes](#alternative-solution-consistent-snapshots).</span><span class="sxs-lookup"><span data-stu-id="f7f70-215">You must use either [Azure Backup Service](https://azure.microsoft.com/services/backup/) or [consistent snapshots](#alternative-solution-consistent-snapshots).</span></span>

<span data-ttu-id="f7f70-216">Hello Voici un résumé des solutions de récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="f7f70-216">hello following is a summary of solutions for DR.</span></span>

| <span data-ttu-id="f7f70-217">Scénario</span><span class="sxs-lookup"><span data-stu-id="f7f70-217">Scenario</span></span> | <span data-ttu-id="f7f70-218">Réplication automatique</span><span class="sxs-lookup"><span data-stu-id="f7f70-218">Automatic Replication</span></span> | <span data-ttu-id="f7f70-219">Solution de récupération d’urgence</span><span class="sxs-lookup"><span data-stu-id="f7f70-219">DR Solution</span></span> |
| --- | --- | --- |
| <span data-ttu-id="f7f70-220">*Disques stockage Premium*</span><span class="sxs-lookup"><span data-stu-id="f7f70-220">*Premium Storage Disks*</span></span> | <span data-ttu-id="f7f70-221">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="f7f70-221">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="f7f70-222">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="f7f70-222">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="f7f70-223">*Disques gérés*</span><span class="sxs-lookup"><span data-stu-id="f7f70-223">*Managed Disks*</span></span> | <span data-ttu-id="f7f70-224">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="f7f70-224">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="f7f70-225">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="f7f70-225">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="f7f70-226">*Disques LRS non managés*</span><span class="sxs-lookup"><span data-stu-id="f7f70-226">*Unmanaged LRS Disks*</span></span> | <span data-ttu-id="f7f70-227">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="f7f70-227">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="f7f70-228">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="f7f70-228">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="f7f70-229">*Disques GRS non managés*</span><span class="sxs-lookup"><span data-stu-id="f7f70-229">*Unmanaged GRS Disks*</span></span> | <span data-ttu-id="f7f70-230">Inter-région ([GRS](storage-redundancy.md#geo-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="f7f70-230">Cross region ([GRS](storage-redundancy.md#geo-redundant-storage))</span></span> | [<span data-ttu-id="f7f70-231">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="f7f70-231">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/)<br/>[<span data-ttu-id="f7f70-232">Captures instantanées cohérentes</span><span class="sxs-lookup"><span data-stu-id="f7f70-232">Consistent snapshots</span></span>](#alternative-solution-consistent-snapshots) |
| <span data-ttu-id="f7f70-233">*Disques RA-GRS non managés*</span><span class="sxs-lookup"><span data-stu-id="f7f70-233">*Unmanaged RA-GRS Disks*</span></span> | <span data-ttu-id="f7f70-234">Inter-région ([RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="f7f70-234">Cross region ([RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage))</span></span> | [<span data-ttu-id="f7f70-235">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="f7f70-235">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/)<br/>[<span data-ttu-id="f7f70-236">Captures instantanées cohérentes</span><span class="sxs-lookup"><span data-stu-id="f7f70-236">Consistent snapshots</span></span>](#alternative-solution-consistent-snapshots) |

<span data-ttu-id="f7f70-237">Haute disponibilité peut par répond le mieux à l’aide de hello de disques gérés dans un groupe à haute disponibilité avec Azure Backup.</span><span class="sxs-lookup"><span data-stu-id="f7f70-237">High availability can best by met through hello use of Managed Disks in an Availability Set along with Azure Backup.</span></span> <span data-ttu-id="f7f70-238">Si vous utilisez des disques non managés, vous pouvez toujours utiliser Sauvegarde Azure pour la récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="f7f70-238">If you are using Unmanaged Disks, you can still  use Azure Backup for DR.</span></span> <span data-ttu-id="f7f70-239">Si vous êtes toouse Impossible d’Azure Backup, puis en [instantanés cohérents avec](#alternative-solution-consistent-snapshots) comme décrit dans une section ultérieure est une autre solution de sauvegarde et de récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="f7f70-239">If you are unable toouse Azure Backup, then taking [consistent snapshots](#alternative-solution-consistent-snapshots) as described in a later section is an alternative solution for Backup and DR.</span></span>

<span data-ttu-id="f7f70-240">Vos choix pour la haute disponibilité, la sauvegarde et la récupération d’urgence aux niveaux Application et Infrastructure peuvent être représentés comme suit :</span><span class="sxs-lookup"><span data-stu-id="f7f70-240">Your choices for high availability, backup and DR at Application or Infrastructure levels can be represented as below:</span></span>

| <span data-ttu-id="f7f70-241">*Niveau*</span><span class="sxs-lookup"><span data-stu-id="f7f70-241">*Level*</span></span> | <span data-ttu-id="f7f70-242">Haute disponibilité</span><span class="sxs-lookup"><span data-stu-id="f7f70-242">High Availability</span></span>   | <span data-ttu-id="f7f70-243">Sauvegarde/récupération d’urgence</span><span class="sxs-lookup"><span data-stu-id="f7f70-243">Backup / DR</span></span> |
| --- | --- | --- |
| <span data-ttu-id="f7f70-244">*Application*</span><span class="sxs-lookup"><span data-stu-id="f7f70-244">*Application*</span></span> | <span data-ttu-id="f7f70-245">SQL Always On</span><span class="sxs-lookup"><span data-stu-id="f7f70-245">SQL Always On</span></span> | <span data-ttu-id="f7f70-246">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="f7f70-246">Azure Backup</span></span> |
| <span data-ttu-id="f7f70-247">*Infrastructure*</span><span class="sxs-lookup"><span data-stu-id="f7f70-247">*Infrastructure*</span></span>  | <span data-ttu-id="f7f70-248">Groupe à haute disponibilité</span><span class="sxs-lookup"><span data-stu-id="f7f70-248">Availability Set</span></span>  | <span data-ttu-id="f7f70-249">GRS avec captures instantanées cohérentes</span><span class="sxs-lookup"><span data-stu-id="f7f70-249">GRS with consistent snapshots</span></span> |

### <a name="using-hello-azure-backup-service"></a><span data-ttu-id="f7f70-250">À l’aide de hello Service de sauvegarde Azure</span><span class="sxs-lookup"><span data-stu-id="f7f70-250">Using hello Azure Backup Service</span></span>

<span data-ttu-id="f7f70-251">[Sauvegarde Azure](../../backup/backup-azure-vms-introduction.md) peut sauvegarder vos machines virtuelles Windows ou Linux toohello coffre Azure Recovery Services en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="f7f70-251">[Azure Backup](../../backup/backup-azure-vms-introduction.md) can backup your VMs running Windows or Linux toohello Azure Recovery Services Vault.</span></span> <span data-ttu-id="f7f70-252">Sauvegarde et restauration des données critiques est compliqué par le fait de hello données critiques doivent être sauvegardées lors des applications hello qui produisent des données sont en cours d’exécution de hello.</span><span class="sxs-lookup"><span data-stu-id="f7f70-252">Backing up and restoring business-critical data is complicated by hello fact that business-critical data must be backed up while hello applications that produce hello data are running.</span></span> <span data-ttu-id="f7f70-253">tooaddress, Azure Backup offre des sauvegardes cohérentes avec les applications pour les charges de travail Microsoft à l’aide de hello tooensure de Service de cliché instantané de Volume (VSS) que les données écrites correctement toostorage.</span><span class="sxs-lookup"><span data-stu-id="f7f70-253">tooaddress this, Azure Backup provides application-consistent backups for Microsoft workloads by using hello Volume Shadow Service (VSS) tooensure that data is written correctly toostorage.</span></span> <span data-ttu-id="f7f70-254">Pour les machines virtuelles Linux, seules les sauvegardes avec cohérence de fichiers sont possibles, Linux n’ayant pas tooVSS équivalent de fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="f7f70-254">For Linux VMs, only file-consistent backups are possible, since Linux does not have functionality equivalent tooVSS.</span></span>

![](./media/storage-backup-and-disaster-recovery-for-azure-iaas-disks/backup-and-disaster-recovery-for-azure-iaas-disks-1.png)   

<span data-ttu-id="f7f70-255">Lors de la sauvegarde Azure initie une opération de sauvegarde au moment de hello planifiée, il déclenche hello sauvegarde d’extension sont installées dans hello VM tootake un instantané de point-à-temps.</span><span class="sxs-lookup"><span data-stu-id="f7f70-255">When Azure Backup initiates a backup job at hello scheduled time, it triggers hello backup extension installed in hello VM tootake a point-in-time snapshot.</span></span> <span data-ttu-id="f7f70-256">Un instantané est réalisé en coordination avec VSS tooget un instantané cohérent des disques virtuels hello hello sans avoir tooshut il vers le bas.</span><span class="sxs-lookup"><span data-stu-id="f7f70-256">A snapshot is taken in coordination with VSS tooget a consistent snapshot of hello disks in hello virtual machine without having tooshut it down.</span></span> <span data-ttu-id="f7f70-257">extension de sauvegarde Hello Bonjour VM vide toutes les écritures avant d’effectuer des instantanés cohérent de hello de tous les disques hello.</span><span class="sxs-lookup"><span data-stu-id="f7f70-257">hello backup extension in hello VM flushes all writes before taking hello consistent snapshot of all hello disks.</span></span> <span data-ttu-id="f7f70-258">Après la réalisation de l’instantané d’hello, les données de salutation sont transférées par le coffre de sauvegarde Azure Backup toohello.</span><span class="sxs-lookup"><span data-stu-id="f7f70-258">After hello snapshot is taken, hello data is transferred by Azure Backup toohello backup vault.</span></span> <span data-ttu-id="f7f70-259">toomake hello processus de sauvegarde plus efficace, service de hello identifie et transfère uniquement les blocs de hello de données qui ont été modifiées depuis la dernière sauvegarde de hello.</span><span class="sxs-lookup"><span data-stu-id="f7f70-259">toomake hello backup process more efficient, hello service identifies and transfers only hello blocks of data that have changed since hello last backup.</span></span>


<span data-ttu-id="f7f70-260">toorestore, vous pouvez afficher les sauvegardes disponibles hello via Azure Backup et puis lancez une restauration.</span><span class="sxs-lookup"><span data-stu-id="f7f70-260">toorestore, you can view hello available backups through Azure Backup and then initiate a restore.</span></span> <span data-ttu-id="f7f70-261">Vous pouvez créer et restaurer des sauvegardes Azure via hello [portail Azure](https://portal.azure.com/), [à l’aide de PowerShell](../../backup/backup-azure-vms-automation.md ), ou à l’aide de hello [CLI d’Azure](https://docs.microsoft.com/azure/xplat-cli-install).</span><span class="sxs-lookup"><span data-stu-id="f7f70-261">You can create and restore Azure backups through hello [Azure portal](https://portal.azure.com/), [using PowerShell](../../backup/backup-azure-vms-automation.md ), or using hello [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install).</span></span> <span data-ttu-id="f7f70-262">Pour plus d’informations, consultez la page relative à Sauvegarde Azure.</span><span class="sxs-lookup"><span data-stu-id="f7f70-262">For more information, see Azure Backup.</span></span>

### <a name="steps-tooenable-backup"></a><span data-ttu-id="f7f70-263">Étapes tooEnable sauvegarde</span><span class="sxs-lookup"><span data-stu-id="f7f70-263">Steps tooEnable Backup</span></span>

<span data-ttu-id="f7f70-264">Hello étapes suivantes sont généralement utilisées tooenable des sauvegardes de vos machines virtuelles à l’aide de hello [Azure Portal](https://portal.azure.com/).</span><span class="sxs-lookup"><span data-stu-id="f7f70-264">hello following steps are typically used tooenable backups of your VMs using hello [Azure Portal](https://portal.azure.com/).</span></span> <span data-ttu-id="f7f70-265">Cela peut varier légèrement en fonction de votre scénario.</span><span class="sxs-lookup"><span data-stu-id="f7f70-265">There will be some variations depending on your exact scenario.</span></span> <span data-ttu-id="f7f70-266">Consultez toohello [Azure Backup](../../backup/backup-azure-vms-introduction.md) documentation pour plus de détails.</span><span class="sxs-lookup"><span data-stu-id="f7f70-266">Refer toohello [Azure Backup](../../backup/backup-azure-vms-introduction.md) documentation for full details.</span></span> <span data-ttu-id="f7f70-267">Sauvegarde Azure [prend également en charge les machines virtuelles avec des disques managés](https://azure.microsoft.com/blog/azure-managed-disk-backup/).</span><span class="sxs-lookup"><span data-stu-id="f7f70-267">Azure Backup also [supports VMs with Managed Disks](https://azure.microsoft.com/blog/azure-managed-disk-backup/).</span></span>

1.  <span data-ttu-id="f7f70-268">Créez un coffre recovery services pour une machine virtuelle à l’aide de hello comme suit :</span><span class="sxs-lookup"><span data-stu-id="f7f70-268">Create a recovery services vault for a VM using hello following steps:</span></span>

    <span data-ttu-id="f7f70-269">a.</span><span class="sxs-lookup"><span data-stu-id="f7f70-269">a.</span></span>  <span data-ttu-id="f7f70-270">À l’aide de hello [portail Azure](https://portal.azure.com/), parcourir toutes les ressources, puis recherchez « Coffres des Services de récupération ».</span><span class="sxs-lookup"><span data-stu-id="f7f70-270">Using hello [Azure portal](https://portal.azure.com/), browse all resources and find “Recovery Services vaults”.</span></span>

    <span data-ttu-id="f7f70-271">b.</span><span class="sxs-lookup"><span data-stu-id="f7f70-271">b.</span></span>  <span data-ttu-id="f7f70-272">Sur hello les Services de récupération des coffres de menu, cliquez sur Ajouter et suivez hello étapes toocreate un nouvel archivage Bonjour même région que hello machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="f7f70-272">On hello Recovery Services vaults menu, click Add and follow hello steps toocreate a new vault in hello same region as hello VM.</span></span> <span data-ttu-id="f7f70-273">Par exemple, si votre machine virtuelle est dans la région ouest des États-Unis, vous pouvez choisir ouest des États-Unis pour l’archivage de hello.</span><span class="sxs-lookup"><span data-stu-id="f7f70-273">For example, if your VM is in West US region, pick West US for hello vault.</span></span>

2.  <span data-ttu-id="f7f70-274">Vérifiez la réplication du stockage hello pour hello nouvellement créé le coffre.</span><span class="sxs-lookup"><span data-stu-id="f7f70-274">Verify hello Storage replication for hello newly created vault.</span></span> <span data-ttu-id="f7f70-275">toodo, accès hello coffre-fort à partir de hello Recovery Services coffres lame et passer toohello paramètres/sauvegarde Configuration.</span><span class="sxs-lookup"><span data-stu-id="f7f70-275">toodo this, access hello vault from hello Recovery Services vaults blade and go toohello settings/Backup Configuration.</span></span> <span data-ttu-id="f7f70-276">Vérifiez hello option de GRS est sélectionné par défaut.</span><span class="sxs-lookup"><span data-stu-id="f7f70-276">Ensure hello GRS option is selected by default.</span></span> <span data-ttu-id="f7f70-277">Cela garantit que votre coffre est le centre de données secondaire tooa automatiquement répliquées.</span><span class="sxs-lookup"><span data-stu-id="f7f70-277">This will ensure that your vault is automatically replicated tooa secondary data center.</span></span> <span data-ttu-id="f7f70-278">Par exemple, votre coffre de l’ouest des États-Unis seront automatiquement répliquée tooEast des États-Unis.</span><span class="sxs-lookup"><span data-stu-id="f7f70-278">For example, your vault in West US will be automatically replicated tooEast US.</span></span>

3.  <span data-ttu-id="f7f70-279">Configurer la stratégie de sauvegarde hello et sélectionnez hello machine virtuelle à partir de hello même interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f7f70-279">Configure hello backup policy and select hello VM from hello same UI.</span></span>

4.  <span data-ttu-id="f7f70-280">Vérifiez que hello que Backup Agent est installé sur hello machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="f7f70-280">Make sure hello Backup Agent is installed on hello VM.</span></span> <span data-ttu-id="f7f70-281">Si votre machine virtuelle est créée à l’aide d’une image de la galerie Azure, cela signifie que l’agent de sauvegarde hello est déjà installé.</span><span class="sxs-lookup"><span data-stu-id="f7f70-281">If your VM is created using an Azure gallery image, then hello Backup agent is already installed.</span></span> <span data-ttu-id="f7f70-282">Sinon (autrement dit, si vous utilisez une image personnalisée), utilisez les instructions trop[hello Install Agent de machine virtuelle sur l’ordinateur virtuel de hello](../../backup/backup-azure-arm-vms-prepare.md#install-the-vm-agent-on-the-virtual-machine).</span><span class="sxs-lookup"><span data-stu-id="f7f70-282">Otherwise (that is, if you are using a custom image), use instructions too[Install hello VM Agent on hello virtual machine](../../backup/backup-azure-arm-vms-prepare.md#install-the-vm-agent-on-the-virtual-machine).</span></span>

5.  <span data-ttu-id="f7f70-283">Assurez-vous que cette machine virtuelle hello permet la connectivité réseau pour toofunction du service de sauvegarde hello.</span><span class="sxs-lookup"><span data-stu-id="f7f70-283">Make sure that hello VM allows network connectivity for hello backup service toofunction.</span></span> <span data-ttu-id="f7f70-284">Suivez ces instructions relatives à la [connectivité réseau](../../backup/backup-azure-arm-vms-prepare.md#network-connectivity).</span><span class="sxs-lookup"><span data-stu-id="f7f70-284">Follow these instructions for [Network connectivity](../../backup/backup-azure-arm-vms-prepare.md#network-connectivity).</span></span>

6.  <span data-ttu-id="f7f70-285">Une fois terminés hello étapes ci-dessus, une sauvegarde hello sera exécutée à intervalles réguliers, comme spécifié dans la stratégie de sauvegarde hello.</span><span class="sxs-lookup"><span data-stu-id="f7f70-285">Once hello above steps are completed, hello backup will run at regular intervals as specified in hello backup policy.</span></span> <span data-ttu-id="f7f70-286">Si nécessaire, vous pouvez déclencher la première sauvegarde de hello manuellement à partir du tableau de bord coffre hello sur hello portail Azure.</span><span class="sxs-lookup"><span data-stu-id="f7f70-286">If necessary, you can trigger hello first backup manually from hello vault dashboard on hello Azure portal.</span></span>

<span data-ttu-id="f7f70-287">Pour automatiser la sauvegarde Azure à l’aide de scripts, consultez trop[applets de commande PowerShell pour la sauvegarde de la machine virtuelle](../../backup/backup-azure-vms-automation.md).</span><span class="sxs-lookup"><span data-stu-id="f7f70-287">For automating Azure Backup using scripts, please refer too[PowerShell cmdlets for VM backup](../../backup/backup-azure-vms-automation.md).</span></span>

### <a name="steps-for-recovery"></a><span data-ttu-id="f7f70-288">Étapes de récupération</span><span class="sxs-lookup"><span data-stu-id="f7f70-288">Steps for Recovery</span></span>

<span data-ttu-id="f7f70-289">Si vous avez besoin de toorepair ou reconstruisez une machine virtuelle, vous pouvez restaurer hello machine virtuelle à partir d’un des points de récupération d’une sauvegarde hello dans le coffre hello.</span><span class="sxs-lookup"><span data-stu-id="f7f70-289">If you need toorepair or rebuild a VM, you can restore hello VM from any of hello backup recovery points in hello vault.</span></span> <span data-ttu-id="f7f70-290">Il existe deux options différentes pour la récupération de hello :</span><span class="sxs-lookup"><span data-stu-id="f7f70-290">There are a couple of different options for performing hello recovery:</span></span>

1.  <span data-ttu-id="f7f70-291">Vous pouvez créer une machine virtuelle en tant que représentation jusqu’à une date et une heure de votre machine virtuelle sauvegardée.</span><span class="sxs-lookup"><span data-stu-id="f7f70-291">You can create a new VM as a point-in-time representation of your backed-up VM.</span></span>

2.  <span data-ttu-id="f7f70-292">Vous pouvez restaurer les disques hello et ensuite utiliser le modèle de hello pour toocustomize de machine virtuelle hello et reconstruction hello restauré la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="f7f70-292">You can restore hello disks and then use hello template for hello VM toocustomize and rebuild hello restored VM.</span></span> 

<span data-ttu-id="f7f70-293">Consultez les instructions[utilisez Azure portail toorestore virtuels](../../backup/backup-azure-arm-restore-vms.md#restoring-a-vm-during-azure-datacenter-disaster).</span><span class="sxs-lookup"><span data-stu-id="f7f70-293">See instructions too[Use Azure portal toorestore virtual machines](../../backup/backup-azure-arm-restore-vms.md#restoring-a-vm-during-azure-datacenter-disaster).</span></span> <span data-ttu-id="f7f70-294">document de Hello explique également les étapes spécifiques de hello pour la restauration du centre de données associés sauvegardé machines virtuelles toohello à l’aide de votre coffre de sauvegarde géo-redondant dans les cas de hello d’un incident au centre de données principal hello.</span><span class="sxs-lookup"><span data-stu-id="f7f70-294">hello document also explains hello specific steps for restoring backed-up VMs toohello paired data center using your geo-redundant backup vault in hello case of a disaster at hello primary data center.</span></span> <span data-ttu-id="f7f70-295">Dans ce cas, Azure Backup utilise le service de calcul hello de la machine virtuelle de hello région secondaire toocreate hello restaurée.</span><span class="sxs-lookup"><span data-stu-id="f7f70-295">In that case, Azure Backup uses hello Compute service from hello secondary region toocreate hello restored virtual machine.</span></span>

<span data-ttu-id="f7f70-296">Vous pouvez également utiliser PowerShell pour [restaurer une machine virtuelle](../../backup/backup-azure-vms-automation.md#restore-an-azure-vm) ou [créer une machine virtuelle à partir de disques restaurés](../../backup/backup-azure-vms-automation.md#create-a-vm-from-restored-disks).</span><span class="sxs-lookup"><span data-stu-id="f7f70-296">You can also use PowerShell for [restoring a VM](../../backup/backup-azure-vms-automation.md#restore-an-azure-vm) or for [creating a new VM from restored disks](../../backup/backup-azure-vms-automation.md#create-a-vm-from-restored-disks).</span></span>

## <a name="alternative-solution-consistent-snapshots"></a><span data-ttu-id="f7f70-297">Solution alternative : captures instantanées cohérentes</span><span class="sxs-lookup"><span data-stu-id="f7f70-297">Alternative Solution: Consistent Snapshots</span></span>

<span data-ttu-id="f7f70-298">Si vous êtes toouse Impossible hello Service Azure Backup, vous pouvez implémenter votre propre mécanisme de sauvegarde à l’aide de captures instantanées.</span><span class="sxs-lookup"><span data-stu-id="f7f70-298">If you are unable toouse hello Azure Backup Service, you can implement your own backup mechanism using snapshots.</span></span> <span data-ttu-id="f7f70-299">Il est compliqué toocreate captures instantanées cohérentes pour tous les disques utilisés par un ordinateur virtuel et puis de répliquer ces région tooanother de captures instantanées.</span><span class="sxs-lookup"><span data-stu-id="f7f70-299">It is complicated toocreate consistent snapshots for all disks used by a VM and then replicate those snapshots tooanother region.</span></span> <span data-ttu-id="f7f70-300">Pour cette raison, Azure considère que le Service de sauvegarde de hello en tirant parti une meilleure option que la création d’une solution personnalisée.</span><span class="sxs-lookup"><span data-stu-id="f7f70-300">For this reason, Azure considers leveraging hello Backup Service a better option than building a custom solution.</span></span> <span data-ttu-id="f7f70-301">Si vous utilisez le stockage de RA-GRS/GRS pour les disques, les instantanés sont automatiquement répliquées tooa les centre de données secondaire.</span><span class="sxs-lookup"><span data-stu-id="f7f70-301">If you use RA-GRS/GRS storage for disks, snapshots are automatically replicated tooa secondary data center.</span></span> <span data-ttu-id="f7f70-302">Si vous utilisez le stockage LRS pour les disques, vous devez les données de salutation tooreplicate vous-même.</span><span class="sxs-lookup"><span data-stu-id="f7f70-302">If you use LRS storage for disks, you will need tooreplicate hello data yourself.</span></span> <span data-ttu-id="f7f70-303">Pour plus d’informations, consultez [Sauvegarder les disques de machines virtuelles Azure non gérés avec des captures instantanées incrémentielles](../../virtual-machines/windows/incremental-snapshots.md).</span><span class="sxs-lookup"><span data-stu-id="f7f70-303">For more information, see [Back up Azure unmanaged VM disks with incremental snapshots](../../virtual-machines/windows/incremental-snapshots.md).</span></span>

<span data-ttu-id="f7f70-304">Une capture instantanée est une représentation sous la forme d’un objet à un point spécifique dans le temps.</span><span class="sxs-lookup"><span data-stu-id="f7f70-304">A snapshot is a representation of an object at a specific point in time.</span></span> <span data-ttu-id="f7f70-305">Un instantané entraîne la facturation pour la taille de hello incrémentielle des données de hello contient.</span><span class="sxs-lookup"><span data-stu-id="f7f70-305">A snapshot will incur billing for hello incremental size of hello data it holds.</span></span> <span data-ttu-id="f7f70-306">Pour plus d’informations, consultez [Création d’un instantané d’objet blob](../blobs/storage-blob-snapshots.md).</span><span class="sxs-lookup"><span data-stu-id="f7f70-306">For more information, see [Create a blob snapshot](../blobs/storage-blob-snapshots.md).</span></span>

### <a name="creating-snapshots-while-hello-vm-is-running"></a><span data-ttu-id="f7f70-307">Création d’instantanés hello lors de la machine virtuelle est en cours d’exécution</span><span class="sxs-lookup"><span data-stu-id="f7f70-307">Creating snapshots while hello VM is running</span></span>

<span data-ttu-id="f7f70-308">Pendant que vous pouvez prendre un instantané à tout moment, si hello machine virtuelle est en cours d’exécution, est toujours en cours de diffusion toohello disques de données, et les instantanés hello peuvent contenir des opérations partielles qui étaient en cours.</span><span class="sxs-lookup"><span data-stu-id="f7f70-308">While you can take a snapshot at any time, if hello VM is running, there is still data being streamed toohello disks, and hello snapshots may contain partial operations that were in flight.</span></span> <span data-ttu-id="f7f70-309">En outre, si plusieurs disques sont impliqués, instantanés hello des différents disques peuvent être survenu à des moments différents, ce qui signifie que ces instantanés ne peuvent pas être coordonnés.</span><span class="sxs-lookup"><span data-stu-id="f7f70-309">Also, if there are several disks involved, hello snapshots of different disks may have occurred at different times, which means these snapshots may not be coordinated.</span></span> <span data-ttu-id="f7f70-310">Cela est particulièrement problématique pour les volumes agrégés par bandes dont les fichiers peuvent être endommagés si des modifications sont apportées pendant la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="f7f70-310">This is especially problematic for striped volumes whose files can be corrupted if changes were being made during backup.</span></span>

<span data-ttu-id="f7f70-311">tooavoid cette situation, le processus de sauvegarde hello doit implémenter hello comme suit :</span><span class="sxs-lookup"><span data-stu-id="f7f70-311">tooavoid this situation, hello backup process must implement hello following steps:</span></span>

1.  <span data-ttu-id="f7f70-312">Figer tous les disques hello</span><span class="sxs-lookup"><span data-stu-id="f7f70-312">Freeze all hello disks</span></span>

2.  <span data-ttu-id="f7f70-313">Vider hello toutes les écritures en attente</span><span class="sxs-lookup"><span data-stu-id="f7f70-313">Flush all hello pending writes</span></span>

3.  <span data-ttu-id="f7f70-314">Ensuite, [créer un instantané d’objet blob](../blobs/storage-blob-snapshots.md) pour tous les hello disques</span><span class="sxs-lookup"><span data-stu-id="f7f70-314">Then, [create a blob snapshot](../blobs/storage-blob-snapshots.md) for all hello disks</span></span>

<span data-ttu-id="f7f70-315">Certaines applications de Windows telles que SQL Server fournissent un mécanisme de sauvegarde coordonné via des sauvegardes cohérentes avec les applications toocreate VSS.</span><span class="sxs-lookup"><span data-stu-id="f7f70-315">Some Windows applications like SQL Server provide a coordinated backup mechanism via VSS toocreate application-consistent backups.</span></span> <span data-ttu-id="f7f70-316">Sur Linux, vous pouvez utiliser un outil tel que fsfreeze pour la coordination des disques hello, qui fourniront des sauvegardes cohérentes de fichier, mais pas application instantanés cohérents au niveau.</span><span class="sxs-lookup"><span data-stu-id="f7f70-316">On Linux, you can use a tool like fsfreeze for coordinating hello disks, which will provide file-consistent backups, but not application-consistent snapshots.</span></span> <span data-ttu-id="f7f70-317">Ce processus étant compliqué, envisagez d’utiliser le service [Sauvegarde Azure](../../backup/backup-azure-vms-introduction.md) ou une solution de sauvegarde tierce qui implémente déjà cela.</span><span class="sxs-lookup"><span data-stu-id="f7f70-317">This process is complicated, so and you should consider using [Azure Backup](../../backup/backup-azure-vms-introduction.md) or a third-party backup solution which already implement this.</span></span>

<span data-ttu-id="f7f70-318">Hello ci-dessus processus entraîne une collection d’instantanés coordonnés pour tous les disques de machine virtuelle hello, représentant une vue spécifique de point-à-temps de hello machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="f7f70-318">hello above process will result in a collection of coordinated snapshots for all hello VM disks, representing a specific point-in-time view of hello VM.</span></span> <span data-ttu-id="f7f70-319">Il s’agit d’un point de restauration de sauvegarde pour hello machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="f7f70-319">This is a backup restore point for hello VM.</span></span> <span data-ttu-id="f7f70-320">Vous pouvez répéter le processus de hello lors des sauvegardes périodiques des intervalles planifiés toocreate.</span><span class="sxs-lookup"><span data-stu-id="f7f70-320">You can repeat hello process at scheduled intervals toocreate periodic backups.</span></span> <span data-ttu-id="f7f70-321">Voir ci-dessous pour connaître les étapes hello trop[région de copie hello sauvegardes tooanother](#copy-the-snapshots-to-another-region) pour la récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="f7f70-321">See below for hello steps too[copy hello backups tooanother region](#copy-the-snapshots-to-another-region) for DR.</span></span>

### <a name="creating-snapshots-while-hello-vm-is-offline"></a><span data-ttu-id="f7f70-322">Création d’instantanés hello lors de la machine virtuelle est en mode hors connexion</span><span class="sxs-lookup"><span data-stu-id="f7f70-322">Creating snapshots while hello VM is offline</span></span>

<span data-ttu-id="f7f70-323">Des sauvegardes cohérentes une autre option toocreate en cours d’arrêt hello machine virtuelle et d’objet blob de prendre des instantanés de chaque disque.</span><span class="sxs-lookup"><span data-stu-id="f7f70-323">Another option toocreate consistent backups is shutting down hello VM and taking blob snapshots of each disk.</span></span> <span data-ttu-id="f7f70-324">Cette opération est plus facile que de coordonner les captures instantanées d’une machine virtuelle en cours d’exécution, mais elle nécessite un temps d’arrêt de quelques minutes.</span><span class="sxs-lookup"><span data-stu-id="f7f70-324">This is easier than coordinating snapshots of a running VM, but it requires a few minutes of downtime.</span></span> <span data-ttu-id="f7f70-325">Pour ce processus, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="f7f70-325">For this process, follow these steps:</span></span>

1. <span data-ttu-id="f7f70-326">Arrêtez hello machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="f7f70-326">Shut down hello VM.</span></span>

2. <span data-ttu-id="f7f70-327">Créez une capture instantanée de chaque blob de disque dur virtuel. Cette opération ne prend que quelques secondes.</span><span class="sxs-lookup"><span data-stu-id="f7f70-327">Create a snapshot of each VHD blob, which only takes a few seconds.</span></span>

    <span data-ttu-id="f7f70-328">toocreate un instantané, vous pouvez utiliser [PowerShell](storage-powershell-guide-full.md#how-to-manage-azure-blob-snapshots), hello [API Rest de stockage Azure](https://msdn.microsoft.com/library/azure/ee691971.aspx), [CLI d’Azure](https://docs.microsoft.com/azure/xplat-cli-install), ou l’une des bibliothèques du Client du stockage Azure hello comme [ bibliothèque cliente de stockage Hello pour .NET](https://msdn.microsoft.com/library/azure/hh488361.aspx).</span><span class="sxs-lookup"><span data-stu-id="f7f70-328">toocreate a snapshot, you can use [PowerShell](storage-powershell-guide-full.md#how-to-manage-azure-blob-snapshots), hello [Azure Storage Rest API](https://msdn.microsoft.com/library/azure/ee691971.aspx), [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install), or one of hello Azure Storage Client Libraries such as [hello Storage client library for .NET](https://msdn.microsoft.com/library/azure/hh488361.aspx).</span></span>

3. <span data-ttu-id="f7f70-329">Démarrez hello machine virtuelle, ce qui se termine par des temps d’arrêt hello.</span><span class="sxs-lookup"><span data-stu-id="f7f70-329">Start hello VM, which ends hello downtime.</span></span> <span data-ttu-id="f7f70-330">En général, processus hello se termine dans quelques minutes.</span><span class="sxs-lookup"><span data-stu-id="f7f70-330">Typically hello entire process completes within a few minutes.</span></span>

<span data-ttu-id="f7f70-331">Ce processus génère une collection de captures instantanées cohérentes pour tous les disques de hello, qui fournit un point de restauration de sauvegarde pour hello machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="f7f70-331">This process yields a collection of consistent snapshots for all hello disks, providing a backup restore point for hello VM.</span></span> <span data-ttu-id="f7f70-332">Voir ci-dessous pour hello étapes toocopy hello instantanés tooanother la région pour la récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="f7f70-332">See below for hello steps toocopy hello snapshots tooanother region for DR.</span></span>

### <a name="copy-hello-snapshots-tooanother-region"></a><span data-ttu-id="f7f70-333">Copier la région de hello instantanés tooanother</span><span class="sxs-lookup"><span data-stu-id="f7f70-333">Copy hello snapshots tooanother region</span></span>

<span data-ttu-id="f7f70-334">Création d’instantanés hello seuls peut ne pas suffire pour la récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="f7f70-334">Creation of hello snapshots alone may not be sufficient for DR.</span></span> <span data-ttu-id="f7f70-335">Vous devez également répliquer la région de tooanother de sauvegardes de capture instantanée hello.</span><span class="sxs-lookup"><span data-stu-id="f7f70-335">You must also replicate hello snapshot backups tooanother region.</span></span>

<span data-ttu-id="f7f70-336">Si vous utilisez GRS ou RA-GRS pour vos disques, puis hello les instantanés sont répliqués toohello la région secondaire automatiquement.</span><span class="sxs-lookup"><span data-stu-id="f7f70-336">If you are using GRS or RA-GRS for your disks, then hello snapshots are replicated toohello secondary region automatically.</span></span> <span data-ttu-id="f7f70-337">Il peut y avoir quelques minutes de retard avant la réplication hello et si le centre de données principal hello tombe en panne avant de terminer la réplication des instantanés de hello, vous ne serez pas en mesure de tooaccess des instantanés de hello à partir du centre de données secondaire hello.</span><span class="sxs-lookup"><span data-stu-id="f7f70-337">There can be a few minutes of lag before hello replication, and if hello primary data center goes down before hello snapshots finish replicating, you will not be able tooaccess hello snapshots from hello secondary data center.</span></span> <span data-ttu-id="f7f70-338">probabilité Hello de ce est faible.</span><span class="sxs-lookup"><span data-stu-id="f7f70-338">hello likelihood of this is small.</span></span>

> [!Note] 
> <span data-ttu-id="f7f70-339">Ayant uniquement des disques de hello dans un compte GRS ou RA-GRS ne protège pas hello machine virtuelle à un incident.</span><span class="sxs-lookup"><span data-stu-id="f7f70-339">Only having hello disks in a GRS or RA-GRS account does not protect hello VM from disasters.</span></span> <span data-ttu-id="f7f70-340">Vous devez également créer des captures instantanées coordonnées ou utiliser Sauvegarde Azure.</span><span class="sxs-lookup"><span data-stu-id="f7f70-340">You must also create coordinated snapshots or use Azure Backup.</span></span> <span data-ttu-id="f7f70-341">Il s’agit de toorecover requis un état cohérent tooa de machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="f7f70-341">This is required toorecover a VM tooa consistent state.</span></span>

<span data-ttu-id="f7f70-342">Si vous utilisez LRS, vous devez copier hello instantanés tooa autre compte de stockage immédiatement après la création de capture instantanée de hello.</span><span class="sxs-lookup"><span data-stu-id="f7f70-342">If you are using LRS, you must copy hello snapshots tooa different storage account immediately after creating hello snapshot.</span></span> <span data-ttu-id="f7f70-343">la cible de copie Hello peut être un compte de stockage LRS dans une autre région, entraîne la copie de hello en cours d’une région à distance.</span><span class="sxs-lookup"><span data-stu-id="f7f70-343">hello copy target could be an LRS storage account in a different region, resulting in hello copy being in a remote region.</span></span> <span data-ttu-id="f7f70-344">Vous pouvez également copier le compte de stockage hello instantané tooan RA-GRS Bonjour même région.</span><span class="sxs-lookup"><span data-stu-id="f7f70-344">You can also copy hello snapshot tooan RA-GRS storage account in hello same region.</span></span> <span data-ttu-id="f7f70-345">Dans ce cas, les instantanés hello sera toohello tardivement répliquées de région secondaire distant.</span><span class="sxs-lookup"><span data-stu-id="f7f70-345">In this case, hello snapshot will be lazily replicated toohello remote secondary region.</span></span> <span data-ttu-id="f7f70-346">La sauvegarde est protégée contre les sinistres au site principal de hello une fois hello copie et la réplication terminée.</span><span class="sxs-lookup"><span data-stu-id="f7f70-346">Your backup is protected from disasters at hello primary site once hello copying and replication is complete.</span></span>

<span data-ttu-id="f7f70-347">toocopy vos instantanés incrémentiels pour la récupération d’urgence efficace, passez en revue les instructions hello dans [sauvegarde des disques de machine virtuelle non managées Azure avec des instantanés incrémentiels](../../virtual-machines/windows/incremental-snapshots.md).</span><span class="sxs-lookup"><span data-stu-id="f7f70-347">toocopy your incremental snapshots for DR efficiently, review hello instructions in [Back up Azure unmanaged VM disks with incremental snapshots](../../virtual-machines/windows/incremental-snapshots.md).</span></span>

![](./media/storage-backup-and-disaster-recovery-for-azure-iaas-disks/backup-and-disaster-recovery-for-azure-iaas-disks-2.png)   

### <a name="recovery-from-snapshots"></a><span data-ttu-id="f7f70-348">Récupération à partir de captures instantanées</span><span class="sxs-lookup"><span data-stu-id="f7f70-348">Recovery from Snapshots</span></span>

<span data-ttu-id="f7f70-349">tooretrieve un instantané, copiez-le toomake un nouvel objet blob.</span><span class="sxs-lookup"><span data-stu-id="f7f70-349">tooretrieve a snapshot, copy it toomake a new blob.</span></span> <span data-ttu-id="f7f70-350">Si vous copiez à partir du compte de principal hello instantané d’hello, vous pouvez copier hello instantané sur l’objet blob de base toohello d’instantané hello, donc rétablissement hello toohello snapshot de disque ; Il s’agit en tant que la promotion de capture instantanée de hello.</span><span class="sxs-lookup"><span data-stu-id="f7f70-350">If you are copying hello snapshot from hello primary account, you can copy hello snapshot over toohello base blob of hello snapshot, thus reverting hello disk toohello snapshot; this is known as promoting hello snapshot.</span></span> <span data-ttu-id="f7f70-351">Si vous copiez la sauvegarde d’instantanés hello à partir d’un compte secondaire (en cas de hello de RA-GRS), il doit être copié tooa le compte principal.</span><span class="sxs-lookup"><span data-stu-id="f7f70-351">If you are copying hello snapshot backup from a secondary account (in hello case of RA-GRS), it must be copied tooa primary account.</span></span> <span data-ttu-id="f7f70-352">Vous pouvez copier un instantané [à l’aide de PowerShell](storage-powershell-guide-full.md#how-to-copy-a-snapshot-of-a-blob) ou à l’aide d’utilitaire AzCopy de hello.</span><span class="sxs-lookup"><span data-stu-id="f7f70-352">You can copy a snapshot [using PowerShell](storage-powershell-guide-full.md#how-to-copy-a-snapshot-of-a-blob) or using hello AzCopy utility.</span></span> <span data-ttu-id="f7f70-353">Pour plus d’informations, consultez [transférer des données avec l’utilitaire de ligne de commande AzCopy de hello](storage-use-azcopy.md).</span><span class="sxs-lookup"><span data-stu-id="f7f70-353">For more information, see [Transfer data with hello AzCopy Command-Line Utility](storage-use-azcopy.md).</span></span>

<span data-ttu-id="f7f70-354">Dans le cas de hello de machines virtuelles avec plusieurs disques, vous devez copier tous les instantanés de hello qui font partie des mêmes coordonnées de hello point de restauration.</span><span class="sxs-lookup"><span data-stu-id="f7f70-354">In hello case of VMs with multiple disks, you must copy all hello snapshots that are part of hello same coordinated restore point.</span></span> <span data-ttu-id="f7f70-355">Une fois que vous copiez des objets BLOB de hello instantanés toowritable disque dur virtuel, vous pouvez utiliser toorecreate d’objets BLOB hello votre machine virtuelle à l’aide du modèle de hello pour hello machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="f7f70-355">Once you copy hello snapshots toowritable VHD blobs, you can use hello blobs toorecreate your VM using hello template for hello VM.</span></span>

## <a name="other-options"></a><span data-ttu-id="f7f70-356">Autres options</span><span class="sxs-lookup"><span data-stu-id="f7f70-356">Other options</span></span>

### <a name="sql-server"></a><span data-ttu-id="f7f70-357">SQL Server</span><span class="sxs-lookup"><span data-stu-id="f7f70-357">SQL Server</span></span>

<span data-ttu-id="f7f70-358">SQL Server s’exécutant dans une machine virtuelle a ses propres fonctionnalités intégrées de toobackup votre tooAzure de base de données SQL Server stockage d’objets Blob ou un partage de fichiers.</span><span class="sxs-lookup"><span data-stu-id="f7f70-358">SQL Server running in a VM has its own built-in capabilities toobackup your SQL Server database tooAzure Blob storage or a file share.</span></span> <span data-ttu-id="f7f70-359">Si le compte de stockage hello est GRS ou RA-GRS, vous pouvez accéder à ces sauvegardes dans le centre de données secondaire du compte de stockage hello dans l’événement hello de sinistre, avec hello soumis aux mêmes restrictions, comme indiqué précédemment.</span><span class="sxs-lookup"><span data-stu-id="f7f70-359">If hello storage account is GRS or RA-GRS, you can access those backups in hello storage account’s secondary data center in hello event of a disaster, with hello same restrictions as discussed previously.</span></span> <span data-ttu-id="f7f70-360">Pour plus d’informations, voir [Sauvegarde et restauration de SQL Server dans les machines virtuelles Azure](../../virtual-machines/windows/sql/virtual-machines-windows-sql-backup-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="f7f70-360">For more information, see [Backup and Restore for SQL Server in Azure Virtual Machines](../../virtual-machines/windows/sql/virtual-machines-windows-sql-backup-recovery.md).</span></span> <span data-ttu-id="f7f70-361">Dans toobackup d’addition et de restauration, [SQL Server groupes de disponibilité AlwaysOn](../../virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr.md) peut mettre à jour les réplicas secondaires de bases de données toogreatly réduisent les temps de récupération d’urgence hello.</span><span class="sxs-lookup"><span data-stu-id="f7f70-361">In addition toobackup and restore, [SQL Server Always On Availability Groups](../../virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr.md) can maintain secondary replicas of databases toogreatly reduce hello disaster recovery time.</span></span>

## <a name="other-considerations"></a><span data-ttu-id="f7f70-362">Autres points à considérer</span><span class="sxs-lookup"><span data-stu-id="f7f70-362">Other considerations</span></span>

<span data-ttu-id="f7f70-363">Cet article a examiné comment toobackup ou prendre des instantanés de vos machines virtuelles et de récupération d’urgence toosupport leurs disques et comment toouse ces toorecover.</span><span class="sxs-lookup"><span data-stu-id="f7f70-363">This article has discussed how toobackup or take snapshots of your VMs and their disks toosupport disaster recovery, and how toouse those toorecover.</span></span> <span data-ttu-id="f7f70-364">Avec le modèle de gestionnaire de ressources Azure hello, de nombreuses personnes utilisent les modèles toocreate leurs ordinateurs virtuels et autres infrastructures dans Azure.</span><span class="sxs-lookup"><span data-stu-id="f7f70-364">With hello Azure Resource Manager model, many people use templates toocreate their VMs and other infrastructure in Azure.</span></span> <span data-ttu-id="f7f70-365">Vous pouvez utiliser un modèle de toocreate un ordinateur virtuel qui a hello configuration même chaque fois.</span><span class="sxs-lookup"><span data-stu-id="f7f70-365">You can use a template toocreate a VM that has hello same configuration every time.</span></span> <span data-ttu-id="f7f70-366">Si vous utilisez des images personnalisées pour la création de vos machines virtuelles, vous devez également vous assurer que vos images sont protégés à l’aide d’un toostore de compte RA-GRS les.</span><span class="sxs-lookup"><span data-stu-id="f7f70-366">If you use custom images for creating your VMs, you must also make sure your images are protected by using an RA-GRS account toostore them.</span></span>

<span data-ttu-id="f7f70-367">Par conséquent, votre processus de sauvegarde peut être une combinaison de deux éléments :</span><span class="sxs-lookup"><span data-stu-id="f7f70-367">Consequently, your backup process may be a combination of two things:</span></span>

1. <span data-ttu-id="f7f70-368">Données de sauvegarde hello (disques)</span><span class="sxs-lookup"><span data-stu-id="f7f70-368">Backup hello data (disks)</span></span>
2. <span data-ttu-id="f7f70-369">Configuration de sauvegarde hello (modèles, des images personnalisées)</span><span class="sxs-lookup"><span data-stu-id="f7f70-369">Backup hello configuration (templates, custom images)</span></span>

<span data-ttu-id="f7f70-370">Selon l’option de sauvegarde hello que vous choisissez, vous n’avez peut-être toohandle hello sauvegarder à la fois hello données et configuration de hello ou service de sauvegarde hello peut gérer tout cela pour vous.</span><span class="sxs-lookup"><span data-stu-id="f7f70-370">Depending on hello backup option you choose, you may have toohandle hello backup of both hello data and hello configuration, or hello backup service may handle all of that for you.</span></span>

## <a name="appendix---understanding-hello-impact-of-lrs-grs-and-ra-grs"></a><span data-ttu-id="f7f70-371">Annexe - comprendre impact hello de LRS, GRS et RA-GRS</span><span class="sxs-lookup"><span data-stu-id="f7f70-371">Appendix - Understanding hello impact of LRS, GRS, and RA-GRS</span></span>

<span data-ttu-id="f7f70-372">Pour les comptes de stockage dans Azure, il existe trois types de redondance de données que vous devez prendre en compte lors d’une récupération d’urgence : le stockage localement redondant (LRS), le stockage géoredondant (GRS) ou le stockage géoredondant avec accès en lecture (RA-GRS).</span><span class="sxs-lookup"><span data-stu-id="f7f70-372">For storage accounts in Azure, there are three types of data redundancy that you should consider regarding disaster recovery – locally redundant (LRS), geo-redundant (GRS), or geo-redundant with read access (RA-GRS).</span></span> 

<span data-ttu-id="f7f70-373">Localement le stockage redondant (LRS) conserve trois copies de données hello Bonjour même centre de données.</span><span class="sxs-lookup"><span data-stu-id="f7f70-373">Locally Redundant Storage (LRS) retains three copies of hello data in hello same data center.</span></span> <span data-ttu-id="f7f70-374">Lors de l’écriture des données de hello, tous les trois copies sont mises à jour avant de réussite est renvoyée toohello appelant, afin de savoir qu’ils sont identiques.</span><span class="sxs-lookup"><span data-stu-id="f7f70-374">When writing hello data, all three copies are updated before success is returned toohello caller, so you know they are identical.</span></span> <span data-ttu-id="f7f70-375">Votre disque est protégé contre les pannes locales, car il est très peu probable que toutes les trois copies est affectés au hello même temps.</span><span class="sxs-lookup"><span data-stu-id="f7f70-375">Your disk is protected from local failures, since it is extremely unlikely that all three copies would be impacted at hello same time.</span></span> <span data-ttu-id="f7f70-376">Dans les cas de hello de LRS, il n’étant aucune géo-redondance, disque de hello n’est pas protégée contre les défaillances graves que peuvent avoir un impact sur une unité de stockage ou de centre de données.</span><span class="sxs-lookup"><span data-stu-id="f7f70-376">In hello case of LRS, there is no geo-redundancy, so hello disk is not protected from catastrophic failures that can impact an entire data center or storage unit.</span></span>

<span data-ttu-id="f7f70-377">GRS et RA-GRS, trois copies de vos données sont conservées dans la région principale de hello (que vous avez choisie), et plus de trois copies de vos données sont conservées dans une région secondaire correspondante (définie par Azure).</span><span class="sxs-lookup"><span data-stu-id="f7f70-377">With GRS and RA-GRS, three copies of your data are retained in hello primary region (selected by you), and three more copies of your data are retained in a corresponding secondary region (set by Azure).</span></span> <span data-ttu-id="f7f70-378">Par exemple, si vous stockez des données dans l’ouest des États-Unis, les données de salutation seront répliquée tooEast des États-Unis.</span><span class="sxs-lookup"><span data-stu-id="f7f70-378">For example, if you store data in West US, hello data will be replicated tooEast US.</span></span> <span data-ttu-id="f7f70-379">Cette opération est effectuée en mode asynchrone, et il existe un bref délai entre les mises à jour toohello principaux et secondaire.</span><span class="sxs-lookup"><span data-stu-id="f7f70-379">This is done asynchronously, and there is a small delay between updates toohello primary and secondary.</span></span> <span data-ttu-id="f7f70-380">Réplicas de disques hello sur le site secondaire de hello sont cohérentes sur une base par disque (avec un délai hello), mais les réplicas de plusieurs disques actives ne peuvent pas être synchronisés **entre eux**.</span><span class="sxs-lookup"><span data-stu-id="f7f70-380">Replicas of hello disks on hello secondary site are consistent on a per-disk basis (with hello delay), but replicas of multiple active disks may not be in sync **with each other**.</span></span> <span data-ttu-id="f7f70-381">toohave des réplicas cohérents sur plusieurs disques, les captures instantanées cohérentes sont nécessaires.</span><span class="sxs-lookup"><span data-stu-id="f7f70-381">toohave consistent replicas across multiple disks, consistent snapshots are needed.</span></span>

<span data-ttu-id="f7f70-382">Hello principale différence entre GRS et RA-GRS est qu’avec RA-GRS, vous pouvez lire la copie secondaire de hello à tout moment.</span><span class="sxs-lookup"><span data-stu-id="f7f70-382">hello main difference between GRS and RA-GRS is that with RA-GRS, you can read hello secondary copy at any time.</span></span> <span data-ttu-id="f7f70-383">S’il existe un problème qui rend les données hello dans la région principale de hello inaccessible, hello équipe Azure rend tous les accès toorestore effort.</span><span class="sxs-lookup"><span data-stu-id="f7f70-383">If there is a problem that renders hello data in hello primary region inaccessible, hello Azure team will make every effort toorestore access.</span></span> <span data-ttu-id="f7f70-384">Alors que hello principal est en panne, si vous avez RA-GRS est activé, vous pouvez accéder à des données hello dans le centre de données secondaire hello.</span><span class="sxs-lookup"><span data-stu-id="f7f70-384">While hello primary is down, if you have RA-GRS enabled, you can access hello data in hello secondary data center.</span></span> <span data-ttu-id="f7f70-385">Par conséquent, si vous envisagez tooread à partir du réplica de hello tandis que hello principal n’est pas accessible, puis RA-GRS doit être envisagé.</span><span class="sxs-lookup"><span data-stu-id="f7f70-385">Therefore, if you plan tooread from hello replica while hello primary is inaccessible, then RA-GRS should be considered.</span></span>

<span data-ttu-id="f7f70-386">S’il s’avère toobe une interruption importante, hello équipe Azure peut déclencher un basculement géographique et modifier toopoint toosecondary stockage hello principal DNS entrées.</span><span class="sxs-lookup"><span data-stu-id="f7f70-386">If it turns out toobe a significant outage, hello Azure team may trigger a geo-failover and change hello primary DNS entries toopoint toosecondary storage.</span></span> <span data-ttu-id="f7f70-387">À ce stade, si vous avez deux GRS ou RA-GRS est activé, vous pouvez accéder données hello dans une région hello utilisé hello toobe secondaire.</span><span class="sxs-lookup"><span data-stu-id="f7f70-387">At this point, if you have either GRS or RA-GRS enabled, you can access hello data in hello region that used toobe hello secondary.</span></span> <span data-ttu-id="f7f70-388">En d’autres termes, si votre compte de stockage est GRS, et il existe un problème, vous pouvez accéder au stockage de secondaire de hello uniquement s’il existe un basculement géographique.</span><span class="sxs-lookup"><span data-stu-id="f7f70-388">In other words, if your storage account is GRS and there is a problem, you can access hello secondary storage only if there is a geo-failover.</span></span>

<span data-ttu-id="f7f70-389">Pour plus d’informations, consultez [le toodo en cas de panne de stockage Azure](storage-disaster-recovery-guidance.md).</span><span class="sxs-lookup"><span data-stu-id="f7f70-389">For more information, see [What toodo if an Azure Storage outage occurs](storage-disaster-recovery-guidance.md).</span></span> 

<span data-ttu-id="f7f70-390">Notez que Microsoft contrôle si un basculement se produit.</span><span class="sxs-lookup"><span data-stu-id="f7f70-390">Note that Microsoft controls whether a failover occurs.</span></span> <span data-ttu-id="f7f70-391">Le basculement n’est pas contrôlé par le compte de stockage. Par conséquent, il n’est pas décidé par les clients individuels.</span><span class="sxs-lookup"><span data-stu-id="f7f70-391">Failover is not controlled per storage account, therefore it is not decided by individual customers.</span></span> <span data-ttu-id="f7f70-392">tooimplement la récupération d’urgence pour les comptes de stockage spécifique ou de disques de machine virtuelle, vous devez utiliser hello techniques décrites précédemment dans cet article.</span><span class="sxs-lookup"><span data-stu-id="f7f70-392">tooimplement Disaster Recovery for specific storage accounts or virtual machine disks, you must use hello techniques described previously in this article.</span></span>
