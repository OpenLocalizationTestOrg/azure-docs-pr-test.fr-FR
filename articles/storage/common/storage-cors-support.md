---
title: Prise en charge du service Partage des ressources cross-origine (CORS) | Microsoft Docs
description: "Découvrez comment activer la prise en charge du service CORS pour les services de stockage Microsoft Azure."
services: storage
documentationcenter: .net
author: cbrooksmsft
manager: carmonm
editor: tysonn
ms.assetid: a0229595-5b64-4898-b8d6-fa2625ea6887
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 2/22/2017
ms.author: cbrooks
ms.openlocfilehash: 8d189d3ec3e6081dd37b912824f287cd75f39b35
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/29/2017
---
# <a name="cross-origin-resource-sharing-cors-support-for-the-azure-storage-services"></a><span data-ttu-id="2c536-103">Prise en charge du service Partage des ressources cross-origine (CORS) pour les services Azure Storage</span><span class="sxs-lookup"><span data-stu-id="2c536-103">Cross-Origin Resource Sharing (CORS) Support for the Azure Storage Services</span></span>
<span data-ttu-id="2c536-104">Depuis la version 2013-08-15, les services Azure Storage prennent en charge le partage de ressources cross-origine (CORS) pour les services Blob Storage, Table Storage, Queue Storage et File Storage.</span><span class="sxs-lookup"><span data-stu-id="2c536-104">Beginning with version 2013-08-15, the Azure storage services support Cross-Origin Resource Sharing (CORS) for the Blob, Table, Queue, and File services.</span></span> <span data-ttu-id="2c536-105">CORS est une fonctionnalité HTTP qui permet à une application web exécutée dans un domaine d'accéder aux ressources d'un autre domaine.</span><span class="sxs-lookup"><span data-stu-id="2c536-105">CORS is an HTTP feature that enables a web application running under one domain to access resources in another domain.</span></span> <span data-ttu-id="2c536-106">Les navigateurs web implémentent une restriction de sécurité appelée [stratégie de même origine](http://www.w3.org/Security/wiki/Same_Origin_Policy) qui empêche une page web d’appeler des API d’un autre domaine ; CORS constitue un moyen sûr pour autoriser un domaine (le domaine d’origine) à appeler des API d’un autre domaine.</span><span class="sxs-lookup"><span data-stu-id="2c536-106">Web browsers implement a security restriction known as [same-origin policy](http://www.w3.org/Security/wiki/Same_Origin_Policy) that prevents a web page from calling APIs in a different domain; CORS provides a secure way to allow one domain (the origin domain) to call APIs in another domain.</span></span> <span data-ttu-id="2c536-107">Pour plus d’informations sur CORS, consultez la [Spécification CORS](http://www.w3.org/TR/cors/) .</span><span class="sxs-lookup"><span data-stu-id="2c536-107">See the [CORS specification](http://www.w3.org/TR/cors/) for details on CORS.</span></span>

<span data-ttu-id="2c536-108">Vous pouvez définir des règles CORS individuellement pour chaque service de stockage en appelant [Set Blob Service Properties](https://msdn.microsoft.com/library/hh452235.aspx), [Set Queue Service Properties](https://msdn.microsoft.com/library/hh452232.aspx) et [Set Table Service Properties](https://msdn.microsoft.com/library/hh452240.aspx).</span><span class="sxs-lookup"><span data-stu-id="2c536-108">You can set CORS rules individually for each of the storage services, by calling [Set Blob Service Properties](https://msdn.microsoft.com/library/hh452235.aspx), [Set Queue Service Properties](https://msdn.microsoft.com/library/hh452232.aspx), and [Set Table Service Properties](https://msdn.microsoft.com/library/hh452240.aspx).</span></span> <span data-ttu-id="2c536-109">Une fois que vous avez défini les règles CORS du service, une demande authentifiée exécutée auprès du service à partir d'un autre domaine est évaluée pour déterminer si elle est autorisée conformément aux règles que vous avez spécifiées.</span><span class="sxs-lookup"><span data-stu-id="2c536-109">Once you set the CORS rules for the service, then a properly authenticated request made against the service from a different domain will be evaluated to determine whether it is allowed according to the rules you have specified.</span></span>

> [!NOTE]
> <span data-ttu-id="2c536-110">Notez que CORS n'est pas un mécanisme d'authentification.</span><span class="sxs-lookup"><span data-stu-id="2c536-110">Note that CORS is not an authentication mechanism.</span></span> <span data-ttu-id="2c536-111">Toute demande adressée à une ressource de stockage lorsque CORS est activé doit avoir une signature d'authentification appropriée ou doit être exécutée sur une ressource publique.</span><span class="sxs-lookup"><span data-stu-id="2c536-111">Any request made against a storage resource when CORS is enabled must either have a proper authentication signature, or must be made against a public resource.</span></span>
> 
> 

## <a name="understanding-cors-requests"></a><span data-ttu-id="2c536-112">Présentation des demandes CORS</span><span class="sxs-lookup"><span data-stu-id="2c536-112">Understanding CORS requests</span></span>
<span data-ttu-id="2c536-113">Une demande CORS d'un domaine d'origine peut comprendre deux demandes distinctes :</span><span class="sxs-lookup"><span data-stu-id="2c536-113">A CORS request from an origin domain may consist of two separate requests:</span></span>

* <span data-ttu-id="2c536-114">Une demande préliminaire, qui interroge les restrictions CORS imposées par le service.</span><span class="sxs-lookup"><span data-stu-id="2c536-114">A preflight request, which queries the CORS restrictions imposed by the service.</span></span> <span data-ttu-id="2c536-115">La demande préliminaire est obligatoire, sauf si la méthode de demande est une [méthode simple](http://www.w3.org/TR/cors/), à savoir GET, HEAD ou POST.</span><span class="sxs-lookup"><span data-stu-id="2c536-115">The preflight request is required unless the request method is a [simple method](http://www.w3.org/TR/cors/), meaning GET, HEAD, or POST.</span></span>
* <span data-ttu-id="2c536-116">La demande réelle, adressée à la ressource souhaitée.</span><span class="sxs-lookup"><span data-stu-id="2c536-116">The actual request, made against the desired resource.</span></span>

### <a name="preflight-request"></a><span data-ttu-id="2c536-117">Demande préliminaire</span><span class="sxs-lookup"><span data-stu-id="2c536-117">Preflight request</span></span>
<span data-ttu-id="2c536-118">La demande préliminaire interroge les restrictions CORS qui ont été établies pour le service de stockage par le propriétaire du compte.</span><span class="sxs-lookup"><span data-stu-id="2c536-118">The preflight request queries the CORS restrictions that have been established for the storage service by the account owner.</span></span> <span data-ttu-id="2c536-119">Le navigateur web (ou tout autre agent utilisateur) envoie une demande OPTIONS qui comprend les en-têtes de demande, la méthode et le domaine d'origine.</span><span class="sxs-lookup"><span data-stu-id="2c536-119">The web browser (or other user agent) sends an OPTIONS request that includes the request headers, method and origin domain.</span></span> <span data-ttu-id="2c536-120">Le service de stockage évalue l'opération prévue selon un ensemble préconfiguré de règles CORS qui indiquent les domaines d'origine, les méthodes de demande et les en-têtes de demande qui peuvent être spécifiés dans une demande réelle à une ressource de stockage.</span><span class="sxs-lookup"><span data-stu-id="2c536-120">The storage service evaluates the intended operation based on a pre-configured set of CORS rules that specify which origin domains, request methods, and request headers may be specified on an actual request against a storage resource.</span></span>

<span data-ttu-id="2c536-121">Si CORS est activé pour le service et que l'une des règles CORS correspond à la demande préliminaire, le service répond avec le code d'état 200 (OK) et inclut les en-têtes Access-Control dans la réponse.</span><span class="sxs-lookup"><span data-stu-id="2c536-121">If CORS is enabled for the service and there is a CORS rule that matches the preflight request, the service responds with status code 200 (OK), and includes the required Access-Control headers in the response.</span></span>

<span data-ttu-id="2c536-122">Si CORS n'est pas activé pour le service ou si aucune règle CORS ne correspond à la demande préliminaire, le service répond avec le code d'état 403 (Interdit).</span><span class="sxs-lookup"><span data-stu-id="2c536-122">If CORS is not enabled for the service or no CORS rule matches the preflight request, the service will respond with status code 403 (Forbidden).</span></span>

<span data-ttu-id="2c536-123">Si la demande OPTIONS ne contient pas les en-têtes CORS nécessaires (en-têtes Origin et Access-Control-Request-Method), le service répond avec le code d’état 400 (Demande incorrecte).</span><span class="sxs-lookup"><span data-stu-id="2c536-123">If the OPTIONS request doesn't contain the required CORS headers (the Origin and Access-Control-Request-Method headers), the service will respond with status code 400 (Bad request).</span></span>

<span data-ttu-id="2c536-124">Notez qu'une demande préliminaire est évaluée par rapport au service (Blob, de File d'attente et de Table) et non par rapport à la ressource demandée.</span><span class="sxs-lookup"><span data-stu-id="2c536-124">Note that a preflight request is evaluated against the service (Blob, Queue, and Table) and not against the requested resource.</span></span> <span data-ttu-id="2c536-125">Le propriétaire du compte doit avoir activé CORS dans le cadre des propriétés du service de compte pour que la demande réussisse.</span><span class="sxs-lookup"><span data-stu-id="2c536-125">The account owner must have enabled CORS as part of the account service properties in order for the request to succeed.</span></span>

### <a name="actual-request"></a><span data-ttu-id="2c536-126">Demande réelle</span><span class="sxs-lookup"><span data-stu-id="2c536-126">Actual request</span></span>
<span data-ttu-id="2c536-127">Une fois la demande préliminaire acceptée et la réponse retournée, le navigateur envoie la demande réelle sur la ressource de stockage.</span><span class="sxs-lookup"><span data-stu-id="2c536-127">Once the preflight request is accepted and the response is returned, the browser will dispatch the actual request against the storage resource.</span></span> <span data-ttu-id="2c536-128">Le navigateur refuse immédiatement la demande réelle si la demande préliminaire est rejetée.</span><span class="sxs-lookup"><span data-stu-id="2c536-128">The browser will deny the actual request immediately if the preflight request is rejected.</span></span>

<span data-ttu-id="2c536-129">La demande réelle est traitée comme une demande normale au service de stockage.</span><span class="sxs-lookup"><span data-stu-id="2c536-129">The actual request is treated as normal request against the storage service.</span></span> <span data-ttu-id="2c536-130">La présence de l'en-tête Origin indique que la demande est une demande CORS et que le service vérifiera les règles CORS correspondantes.</span><span class="sxs-lookup"><span data-stu-id="2c536-130">The presence of the Origin header indicates that the request is a CORS request and the service will check the matching CORS rules.</span></span> <span data-ttu-id="2c536-131">Si une correspondance est trouvée, les en-têtes Access-Control sont ajoutés à la réponse et renvoyés au client.</span><span class="sxs-lookup"><span data-stu-id="2c536-131">If a match is found, the Access-Control headers are added to the response and sent back to the client.</span></span> <span data-ttu-id="2c536-132">Si aucune correspondance n'est trouvée, les en-têtes Access-Control CORS ne sont pas renvoyés.</span><span class="sxs-lookup"><span data-stu-id="2c536-132">If a match is not found, the CORS Access-Control headers are not returned.</span></span>

## <a name="enabling-cors-for-the-azure-storage-services"></a><span data-ttu-id="2c536-133">Activation de CORS pour les services de stockage Azure</span><span class="sxs-lookup"><span data-stu-id="2c536-133">Enabling CORS for the Azure Storage services</span></span>
<span data-ttu-id="2c536-134">Les règles CORS sont définies au niveau du service. Par conséquent, vous devez activer ou désactiver CORS pour chaque service (Blob, de File d'attente et de Table) séparément.</span><span class="sxs-lookup"><span data-stu-id="2c536-134">CORS rules are set at the service level, so you need to enable or disable CORS for each service (Blob, Queue and Table) separately.</span></span> <span data-ttu-id="2c536-135">Par défaut, CORS est désactivé pour tous les services.</span><span class="sxs-lookup"><span data-stu-id="2c536-135">By default, CORS is disabled for each service.</span></span> <span data-ttu-id="2c536-136">Pour activer CORS, vous devez définir les propriétés de service appropriées à l'aide de la version du 15/08/2013 ou version ultérieure, et ajouter des règles CORS aux propriétés de service.</span><span class="sxs-lookup"><span data-stu-id="2c536-136">To enable CORS, you need to set the appropriate service properties using version 2013-08-15 or later, and add CORS rules to the service properties.</span></span> <span data-ttu-id="2c536-137">Pour plus d’informations sur l’activation ou la désactivation de CORS pour un service et sur la définition de règles CORS, consultez [Définition des propriétés du service Blob](https://msdn.microsoft.com/library/hh452235.aspx), [Définition des propriétés du service de Table](https://msdn.microsoft.com/library/hh452232.aspx) et [Définition des propriétés du service de File d’attente](https://msdn.microsoft.com/library/hh452240.aspx).</span><span class="sxs-lookup"><span data-stu-id="2c536-137">For details about how to enable or disable CORS for a service and how to set CORS rules, please refer to [Set Blob Service Properties](https://msdn.microsoft.com/library/hh452235.aspx), [Set Queue Service Properties](https://msdn.microsoft.com/library/hh452232.aspx), and [Set Table Service Properties](https://msdn.microsoft.com/library/hh452240.aspx).</span></span>

<span data-ttu-id="2c536-138">Voici un exemple de règle CORS spécifiée via une opération Set Service Properties :</span><span class="sxs-lookup"><span data-stu-id="2c536-138">Here is a sample of a single CORS rule, specified via a Set Service Properties operation:</span></span>

```xml
<Cors>    
    <CorsRule>
        <AllowedOrigins>http://www.contoso.com, http://www.fabrikam.com</AllowedOrigins>
        <AllowedMethods>PUT,GET</AllowedMethods>
        <AllowedHeaders>x-ms-meta-data*,x-ms-meta-target*,x-ms-meta-abc</AllowedHeaders>
        <ExposedHeaders>x-ms-meta-*</ExposedHeaders>
        <MaxAgeInSeconds>200</MaxAgeInSeconds>
    </CorsRule>
<Cors>
```

<span data-ttu-id="2c536-139">Chaque élément inclus dans la règle CORS est décrit ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="2c536-139">Each element included in the CORS rule is described below:</span></span>

* <span data-ttu-id="2c536-140">**AllowedOrigins**: domaines d’origine qui sont autorisés à effectuer une demande auprès du service de stockage via CORS.</span><span class="sxs-lookup"><span data-stu-id="2c536-140">**AllowedOrigins**: The origin domains that are permitted to make a request against the storage service via CORS.</span></span> <span data-ttu-id="2c536-141">Le domaine d'origine est celui d'où provient la demande.</span><span class="sxs-lookup"><span data-stu-id="2c536-141">The origin domain is the domain from which the request originates.</span></span> <span data-ttu-id="2c536-142">Notez que l'origine doit correspondance exactement (avec respect de la casse) à l'origine que l'utilisateur envoie au service.</span><span class="sxs-lookup"><span data-stu-id="2c536-142">Note that the origin must be an exact case-sensitive match with the origin that the user age sends to the service.</span></span> <span data-ttu-id="2c536-143">Vous pouvez également utiliser le caractère générique « * » pour autoriser tous les domaines d'origine à effectuer des demandes via CORS.</span><span class="sxs-lookup"><span data-stu-id="2c536-143">You can also use the wildcard character '*' to allow all origin domains to make requests via CORS.</span></span> <span data-ttu-id="2c536-144">Dans l’exemple ci-dessus, les domaines [http://www.contoso.com](http://www.contoso.com) et [http://www.fabrikam.com](http://www.fabrikam.com) peuvent envoyer des demandes au service à l’aide de CORS.</span><span class="sxs-lookup"><span data-stu-id="2c536-144">In the example above, the domains [http://www.contoso.com](http://www.contoso.com) and [http://www.fabrikam.com](http://www.fabrikam.com) can make requests against the service using CORS.</span></span>
* <span data-ttu-id="2c536-145">**AllowedMethods**: méthodes (verbes de requête HTTP) que le domaine d’origine peut utiliser pour une demande CORS.</span><span class="sxs-lookup"><span data-stu-id="2c536-145">**AllowedMethods**: The methods (HTTP request verbs) that the origin domain may use for a CORS request.</span></span> <span data-ttu-id="2c536-146">Dans l'exemple ci-dessus, seules les demandes PUT et GET sont autorisées.</span><span class="sxs-lookup"><span data-stu-id="2c536-146">In the example above, only PUT and GET requests are permitted.</span></span>
* <span data-ttu-id="2c536-147">**AllowedHeaders**: en-têtes de demande que le domaine d’origine peut spécifier dans la demande CORS.</span><span class="sxs-lookup"><span data-stu-id="2c536-147">**AllowedHeaders**: The request headers that the origin domain may specify on the CORS request.</span></span> <span data-ttu-id="2c536-148">Dans l'exemple ci-dessus, tous les en-têtes de métadonnées commençant par x-ms-meta-data, x-ms-meta-target et x-ms-meta-abc sont autorisés.</span><span class="sxs-lookup"><span data-stu-id="2c536-148">In the example above, all metadata headers starting with x-ms-meta-data, x-ms-meta-target, and x-ms-meta-abc are permitted.</span></span> <span data-ttu-id="2c536-149">Notez que le caractère générique « * » indique que les en-têtes commençant par le préfixe spécifié sont autorisés.</span><span class="sxs-lookup"><span data-stu-id="2c536-149">Note that the wildcard character '*' indicates that any header beginning with the specified prefix is allowed.</span></span>
* <span data-ttu-id="2c536-150">**ExposedHeaders**: en-têtes de réponse qui peuvent être envoyés dans la réponse à la demande CORS et exposés par le navigateur à l’émetteur de la demande.</span><span class="sxs-lookup"><span data-stu-id="2c536-150">**ExposedHeaders**: The response headers that may be sent in the response to the CORS request and exposed by the browser to the request issuer.</span></span> <span data-ttu-id="2c536-151">Dans l'exemple ci-dessus, il est demandé au navigateur d'exposer les en-têtes commençant par x-ms-meta.</span><span class="sxs-lookup"><span data-stu-id="2c536-151">In the example above, the browser is instructed to expose any header beginning with x-ms-meta.</span></span>
* <span data-ttu-id="2c536-152">**MaxAgeInSeconds**: durée maximale pendant laquelle un navigateur doit mettre en cache la demande OPTIONS préliminaire.</span><span class="sxs-lookup"><span data-stu-id="2c536-152">**MaxAgeInSeconds**: The maximum amount time that a browser should cache the preflight OPTIONS request.</span></span>

<span data-ttu-id="2c536-153">Les services de stockage Azure prennent en charge la spécification d’en-têtes préfixés pour les éléments **AllowedHeaders** et **ExposedHeaders**.</span><span class="sxs-lookup"><span data-stu-id="2c536-153">The Azure storage services support specifying prefixed headers for both the **AllowedHeaders** and **ExposedHeaders** elements.</span></span> <span data-ttu-id="2c536-154">Pour autoriser une catégorie d'en-têtes, vous pouvez spécifier un préfixe commun à cette catégorie.</span><span class="sxs-lookup"><span data-stu-id="2c536-154">To allow a category of headers, you can specify a common prefix to that category.</span></span> <span data-ttu-id="2c536-155">Par exemple, le fait de spécifier *x-ms-meta** comme en-tête préfixé crée une règle qui établit une correspondance avec tous les en-têtes commençant par x-ms-meta.</span><span class="sxs-lookup"><span data-stu-id="2c536-155">For example, specifying *x-ms-meta** as a prefixed header establishes a rule that will match all headers that begin with x-ms-meta.</span></span>

<span data-ttu-id="2c536-156">Les limitations suivantes s'appliquent aux règles CORS :</span><span class="sxs-lookup"><span data-stu-id="2c536-156">The following limitations apply to CORS rules:</span></span>

* <span data-ttu-id="2c536-157">Vous pouvez spécifier jusqu'à cinq règles CORS par service de stockage (Blob, Table et File d'attente).</span><span class="sxs-lookup"><span data-stu-id="2c536-157">You can specify up to five CORS rules per storage service (Blob, Table, and Queue).</span></span>
* <span data-ttu-id="2c536-158">La taille maximale de tous les paramètres de règles CORS dans la demande, à l'exception des balises XML, ne doit pas dépasser 2 Ko.</span><span class="sxs-lookup"><span data-stu-id="2c536-158">The maximum size of all CORS rules settings on the request, excluding XML tags, should not exceed 2 KB.</span></span>
* <span data-ttu-id="2c536-159">La longueur d'un en-tête autorisé, d'un en-tête exposé ou d'une origine autorisée ne doit pas dépasser 256 caractères.</span><span class="sxs-lookup"><span data-stu-id="2c536-159">The length of an allowed header, exposed header, or allowed origin should not exceed 256 characters.</span></span>
* <span data-ttu-id="2c536-160">Les en-têtes autorisés et les en-têtes exposés peuvent être :</span><span class="sxs-lookup"><span data-stu-id="2c536-160">Allowed headers and exposed headers may be either:</span></span>
  * <span data-ttu-id="2c536-161">des en-têtes littéraux, où le nom exact de l’en-tête est spécifié, tel que **x-ms-meta-processed**.</span><span class="sxs-lookup"><span data-stu-id="2c536-161">Literal headers, where the exact header name is provided, such as **x-ms-meta-processed**.</span></span> <span data-ttu-id="2c536-162">Il ne peut pas y avoir plus de 64 en-têtes littéraux spécifiés sur la demande ;</span><span class="sxs-lookup"><span data-stu-id="2c536-162">A maximum of 64 literal headers may be specified on the request.</span></span>
  * <span data-ttu-id="2c536-163">des en-têtes préfixés, où un préfixe de l’en-tête est spécifié, tel que **x-ms-meta-data**.</span><span class="sxs-lookup"><span data-stu-id="2c536-163">Prefixed headers, where a prefix of the header is provided, such as **x-ms-meta-data***.</span></span> <span data-ttu-id="2c536-164">Le fait de spécifier un préfixe de cette façon autorise ou expose tout en-tête qui commence par le préfixe donné.</span><span class="sxs-lookup"><span data-stu-id="2c536-164">Specifying a prefix in this manner allows or exposes any header that begins with the given prefix.</span></span> <span data-ttu-id="2c536-165">Il ne peut pas y avoir plus de deux en-têtes préfixés spécifiés sur la demande.</span><span class="sxs-lookup"><span data-stu-id="2c536-165">A maximum of two prefixed headers may be specified on the request.</span></span>
* <span data-ttu-id="2c536-166">Les méthodes (ou verbes HTTP) spécifiées dans l’élément **AllowedMethods** doivent respecter les méthodes prises en charge par les API de service de stockage Azure.</span><span class="sxs-lookup"><span data-stu-id="2c536-166">The methods (or HTTP verbs) specified in the **AllowedMethods** element must conform to the methods supported by Azure storage service APIs.</span></span> <span data-ttu-id="2c536-167">Les méthodes prises en charge sont DELETE, GET, HEAD, MERGE, POST, OPTIONS et PUT.</span><span class="sxs-lookup"><span data-stu-id="2c536-167">Supported methods are DELETE, GET, HEAD, MERGE, POST, OPTIONS and PUT.</span></span>

## <a name="understanding-cors-rule-evaluation-logic"></a><span data-ttu-id="2c536-168">Présentation de la logique d'évaluation des règles CORS</span><span class="sxs-lookup"><span data-stu-id="2c536-168">Understanding CORS rule evaluation logic</span></span>
<span data-ttu-id="2c536-169">Quand un service de stockage reçoit une demande préliminaire ou réelle, il évalue cette demande en fonction des règles CORS que vous avez créées pour le service via l'opération Set Service Properties appropriée.</span><span class="sxs-lookup"><span data-stu-id="2c536-169">When a storage service receives a preflight or actual request, it evaluates that request based on the CORS rules you have established for the service via the appropriate Set Service Properties operation.</span></span> <span data-ttu-id="2c536-170">Les règles CORS sont évaluées dans l'ordre dans lequel elles ont été définies dans le corps de la demande de l'opération Set Service Properties.</span><span class="sxs-lookup"><span data-stu-id="2c536-170">CORS rules are evaluated in the order in which they were set in the request body of the Set Service Properties operation.</span></span>

<span data-ttu-id="2c536-171">Les règles CORS sont évaluées comme suit :</span><span class="sxs-lookup"><span data-stu-id="2c536-171">CORS rules are evaluated as follows:</span></span>

1. <span data-ttu-id="2c536-172">Tout d’abord, le domaine d’origine de la demande est vérifié par rapport aux domaines répertoriés pour l’élément **AllowedOrigins** .</span><span class="sxs-lookup"><span data-stu-id="2c536-172">First, the origin domain of the request is checked against the domains listed for the **AllowedOrigins** element.</span></span> <span data-ttu-id="2c536-173">Si le domaine d'origine figure dans la liste ou si tous les domaines sont autorisés avec le caractère générique « * », l'évaluation des règles continue.</span><span class="sxs-lookup"><span data-stu-id="2c536-173">If the origin domain is included in the list, or all domains are allowed with the wildcard character '*', then rules evaluation proceeds.</span></span> <span data-ttu-id="2c536-174">Si le domaine d'origine ne figure pas dans la liste, la demande échoue.</span><span class="sxs-lookup"><span data-stu-id="2c536-174">If the origin domain is not included, then the request fails.</span></span>
2. <span data-ttu-id="2c536-175">Ensuite, la méthode (ou le verbe HTTP) de la demande est comparée aux méthodes répertoriées dans l’élément **AllowedMethods** .</span><span class="sxs-lookup"><span data-stu-id="2c536-175">Next, the method (or HTTP verb) of the request is checked against the methods listed in the **AllowedMethods** element.</span></span> <span data-ttu-id="2c536-176">Si la méthode figure dans la liste, l'évaluation des règles continue ; sinon, la demande échoue.</span><span class="sxs-lookup"><span data-stu-id="2c536-176">If the method is included in the list, then rules evaluation proceeds; if not, then the request fails.</span></span>
3. <span data-ttu-id="2c536-177">Si la demande correspond à une règle dans son domaine d'origine et sa méthode, cette règle est sélectionnée pour traiter la demande et aucune autre règle n'est évaluée.</span><span class="sxs-lookup"><span data-stu-id="2c536-177">If the request matches a rule in its origin domain and its method, that rule is selected to process the request and no further rules are evaluated.</span></span> <span data-ttu-id="2c536-178">Cependant, avant que la demande réussisse, tous les en-têtes spécifiés dans la demande sont vérifiés par rapport aux en-têtes répertoriés dans l’élément **AllowedHeaders** .</span><span class="sxs-lookup"><span data-stu-id="2c536-178">Before the request can succeed, however, any headers specified on the request are checked against the headers listed in the **AllowedHeaders** element.</span></span> <span data-ttu-id="2c536-179">Si les en-têtes envoyés ne correspondent pas aux en-têtes autorisés, la demande échoue.</span><span class="sxs-lookup"><span data-stu-id="2c536-179">If the headers sent do not match the allowed headers, the request fails.</span></span>

<span data-ttu-id="2c536-180">Étant donné que les règles sont traitées dans l'ordre dans lequel elles sont indiquées dans le corps de la demande, il est recommandé de spécifier les règles les plus restrictives en ce qui concerne les origines en premier dans la liste, afin qu'elles soient évaluées en priorité.</span><span class="sxs-lookup"><span data-stu-id="2c536-180">Since the rules are processed in the order they are present in the request body, best practices recommend that you specify the most restrictive rules with respect to origins first in the list, so that these are evaluated first.</span></span> <span data-ttu-id="2c536-181">Spécifiez les règles les moins restrictives (par exemple, une règle pour autoriser toutes les origines) à la fin de la liste.</span><span class="sxs-lookup"><span data-stu-id="2c536-181">Specify rules that are less restrictive – for example, a rule to allow all origins – at the end of the list.</span></span>

### <a name="example--cors-rules-evaluation"></a><span data-ttu-id="2c536-182">Exemple : évaluation de règles CORS</span><span class="sxs-lookup"><span data-stu-id="2c536-182">Example – CORS rules evaluation</span></span>
<span data-ttu-id="2c536-183">L'exemple suivant illustre un corps de demande partiel pour une opération visant à définir des règles CORS pour les services de stockage.</span><span class="sxs-lookup"><span data-stu-id="2c536-183">The following example shows a partial request body for an operation to set CORS rules for the storage services.</span></span> <span data-ttu-id="2c536-184">Pour plus d’informations sur la construction de la requête, consultez [Définition des propriétés du service Blob](https://msdn.microsoft.com/library/hh452235.aspx), [Définition des propriétés du service de File d’attente](https://msdn.microsoft.com/library/hh452232.aspx) et [Définition des propriétés du service de Table](https://msdn.microsoft.com/library/hh452240.aspx).</span><span class="sxs-lookup"><span data-stu-id="2c536-184">See [Set Blob Service Properties](https://msdn.microsoft.com/library/hh452235.aspx), [Set Queue Service Properties](https://msdn.microsoft.com/library/hh452232.aspx), and [Set Table Service Properties](https://msdn.microsoft.com/library/hh452240.aspx) for details on constructing the request.</span></span>

```xml
<Cors>
    <CorsRule>
        <AllowedOrigins>http://www.contoso.com</AllowedOrigins>
        <AllowedMethods>PUT,HEAD</AllowedMethods>
        <MaxAgeInSeconds>5</MaxAgeInSeconds>
        <ExposedHeaders>x-ms-*</ExposedHeaders>
        <AllowedHeaders>x-ms-blob-content-type, x-ms-blob-content-disposition</AllowedHeaders>
    </CorsRule>
    <CorsRule>
        <AllowedOrigins>*</AllowedOrigins>
        <AllowedMethods>PUT,GET</AllowedMethods>
        <MaxAgeInSeconds>5</MaxAgeInSeconds>
        <ExposedHeaders>x-ms-*</ExposedHeaders>
        <AllowedHeaders>x-ms-blob-content-type, x-ms-blob-content-disposition</AllowedHeaders>
    </CorsRule>
    <CorsRule>
        <AllowedOrigins>http://www.contoso.com</AllowedOrigins>
        <AllowedMethods>GET</AllowedMethods>
        <MaxAgeInSeconds>5</MaxAgeInSeconds>
        <ExposedHeaders>x-ms-*</ExposedHeaders>
        <AllowedHeaders>x-ms-client-request-id</AllowedHeaders>
    </CorsRule>
</Cors>
```

<span data-ttu-id="2c536-185">Ensuite, tenez compte des demandes CORS suivantes :</span><span class="sxs-lookup"><span data-stu-id="2c536-185">Next, consider the following CORS requests:</span></span>

| <span data-ttu-id="2c536-186">Demande</span><span class="sxs-lookup"><span data-stu-id="2c536-186">Request</span></span> |  |  | <span data-ttu-id="2c536-187">Réponse</span><span class="sxs-lookup"><span data-stu-id="2c536-187">Response</span></span> |  |
| --- | --- | --- | --- | --- |
| <span data-ttu-id="2c536-188">**Méthode**</span><span class="sxs-lookup"><span data-stu-id="2c536-188">**Method**</span></span> |<span data-ttu-id="2c536-189">**Origine**</span><span class="sxs-lookup"><span data-stu-id="2c536-189">**Origin**</span></span> |<span data-ttu-id="2c536-190">**En-têtes de requête**</span><span class="sxs-lookup"><span data-stu-id="2c536-190">**Request Headers**</span></span> |<span data-ttu-id="2c536-191">**Correspondance de règle**</span><span class="sxs-lookup"><span data-stu-id="2c536-191">**Rule Match**</span></span> |<span data-ttu-id="2c536-192">**Résultat**</span><span class="sxs-lookup"><span data-stu-id="2c536-192">**Result**</span></span> |
| <span data-ttu-id="2c536-193">**PUT**</span><span class="sxs-lookup"><span data-stu-id="2c536-193">**PUT**</span></span> |<span data-ttu-id="2c536-194">http://www.contoso.com</span><span class="sxs-lookup"><span data-stu-id="2c536-194">http://www.contoso.com</span></span> |<span data-ttu-id="2c536-195">x-ms-blob-content-type</span><span class="sxs-lookup"><span data-stu-id="2c536-195">x-ms-blob-content-type</span></span> |<span data-ttu-id="2c536-196">Première règle</span><span class="sxs-lookup"><span data-stu-id="2c536-196">First rule</span></span> |<span data-ttu-id="2c536-197">Succès</span><span class="sxs-lookup"><span data-stu-id="2c536-197">Success</span></span> |
| <span data-ttu-id="2c536-198">**GET**</span><span class="sxs-lookup"><span data-stu-id="2c536-198">**GET**</span></span> |<span data-ttu-id="2c536-199">http://www.contoso.com</span><span class="sxs-lookup"><span data-stu-id="2c536-199">http://www.contoso.com</span></span> |<span data-ttu-id="2c536-200">x-ms-blob-content-type</span><span class="sxs-lookup"><span data-stu-id="2c536-200">x-ms-blob-content-type</span></span> |<span data-ttu-id="2c536-201">Deuxième règle</span><span class="sxs-lookup"><span data-stu-id="2c536-201">Second rule</span></span> |<span data-ttu-id="2c536-202">Succès</span><span class="sxs-lookup"><span data-stu-id="2c536-202">Success</span></span> |
| <span data-ttu-id="2c536-203">**GET**</span><span class="sxs-lookup"><span data-stu-id="2c536-203">**GET**</span></span> |<span data-ttu-id="2c536-204">http://www.contoso.com</span><span class="sxs-lookup"><span data-stu-id="2c536-204">http://www.contoso.com</span></span> |<span data-ttu-id="2c536-205">x-ms-client-request-id</span><span class="sxs-lookup"><span data-stu-id="2c536-205">x-ms-client-request-id</span></span> |<span data-ttu-id="2c536-206">Deuxième règle</span><span class="sxs-lookup"><span data-stu-id="2c536-206">Second rule</span></span> |<span data-ttu-id="2c536-207">Échec</span><span class="sxs-lookup"><span data-stu-id="2c536-207">Failure</span></span> |

<span data-ttu-id="2c536-208">La première demande correspond à la première règle (le domaine d'origine correspond aux origines autorisées, la méthode correspond aux méthodes autorisées et l'en-tête correspond aux en-têtes autorisés). Par conséquent, elle réussit.</span><span class="sxs-lookup"><span data-stu-id="2c536-208">The first request matches the first rule – the origin domain matches the allowed origins, the method matches the allowed methods, and the header matches the allowed headers – and so succeeds.</span></span>

<span data-ttu-id="2c536-209">La deuxième demande ne correspond pas à la première règle, car la méthode ne correspond pas aux méthodes autorisées.</span><span class="sxs-lookup"><span data-stu-id="2c536-209">The second request does not match the first rule because the method does not match the allowed methods.</span></span> <span data-ttu-id="2c536-210">Toutefois, elle correspond à la deuxième règle, donc elle réussit.</span><span class="sxs-lookup"><span data-stu-id="2c536-210">It does, however, match the second rule, so it succeeds.</span></span>

<span data-ttu-id="2c536-211">La troisième demande correspond à la deuxième règle en ce qui concerne le domaine d'origine et la méthode, donc aucune autre règle n'est évaluée.</span><span class="sxs-lookup"><span data-stu-id="2c536-211">The third request matches the second rule in its origin domain and method, so no further rules are evaluated.</span></span> <span data-ttu-id="2c536-212">Toutefois, l’ *en-tête x-ms-client-request-id* n’étant pas autorisé par la deuxième règle, la demande échoue en dépit du fait que la sémantique de la troisième règle lui aurait permis de réussir.</span><span class="sxs-lookup"><span data-stu-id="2c536-212">However, the *x-ms-client-request-id header* is not allowed by the second rule, so the request fails, despite the fact that the semantics of the third rule would have allowed it to succeed.</span></span>

> [!NOTE]
> <span data-ttu-id="2c536-213">Bien que cet exemple illustre une règle moins restrictive avant une règle plus restrictive, il est généralement recommandé de répertorier les règles les plus restrictives en premier.</span><span class="sxs-lookup"><span data-stu-id="2c536-213">Although this example shows a less restrictive rule before a more restrictive one, in general the best practice is to list the most restrictive rules first.</span></span>
> 
> 

## <a name="understanding-how-the-vary-header-is-set"></a><span data-ttu-id="2c536-214">Présentation de la définition de l'en-tête Vary</span><span class="sxs-lookup"><span data-stu-id="2c536-214">Understanding how the Vary header is set</span></span>
<span data-ttu-id="2c536-215">L’en-tête *Vary* est un en-tête HTTP/1.1 standard composé d’un ensemble de champs d’en-tête de demande qui indiquent au navigateur ou à l’agent utilisateur les critères sélectionnés par le serveur pour traiter la demande.</span><span class="sxs-lookup"><span data-stu-id="2c536-215">The *Vary* header is a standard HTTP/1.1 header consisting of a set of request header fields that advise the browser or user agent about the criteria that were selected by the server to process the request.</span></span> <span data-ttu-id="2c536-216">L’en-tête *Vary* est principalement utilisé pour la mise en cache par les proxys, les navigateurs et les réseaux de distribution de contenu, qui s’en servent pour déterminer comment la réponse doit être mise en cache.</span><span class="sxs-lookup"><span data-stu-id="2c536-216">The *Vary* header is mainly used for caching by proxies, browsers, and CDNs, which use it to determine how the response should be cached.</span></span> <span data-ttu-id="2c536-217">Pour plus d’informations, consultez la spécification de l’ [en-tête Vary](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html).</span><span class="sxs-lookup"><span data-stu-id="2c536-217">For details, see the specification for the [Vary header](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html).</span></span>

<span data-ttu-id="2c536-218">Lorsque le navigateur ou un autre agent utilisateur met en cache la réponse d'une demande CORS, le domaine d'origine est mis en cache comme origine autorisée.</span><span class="sxs-lookup"><span data-stu-id="2c536-218">When the browser or another user agent caches the response from a CORS request, the origin domain is cached as the allowed origin.</span></span> <span data-ttu-id="2c536-219">Quand un deuxième domaine émet la même demande pour une ressource de stockage pendant que le cache est actif, l'agent utilisateur récupère le domaine d'origine mis en cache.</span><span class="sxs-lookup"><span data-stu-id="2c536-219">When a second domain issues the same request for a storage resource while the cache is active, the user agent retrieves the cached origin domain.</span></span> <span data-ttu-id="2c536-220">Comme le deuxième domaine ne correspond pas au domaine mis en cache, la demande échoue (alors qu'elle devrait réussir en d'autres circonstances).</span><span class="sxs-lookup"><span data-stu-id="2c536-220">The second domain does not match the cached domain, so the request fails when it would otherwise succeed.</span></span> <span data-ttu-id="2c536-221">Dans certains cas, le stockage Azure affecte à l’en-tête Vary la valeur **Origin** pour indiquer à l’agent utilisateur qu’il doit envoyer la demande CORS suivante au service lorsque le domaine demandeur diffère de l’origine mise en cache.</span><span class="sxs-lookup"><span data-stu-id="2c536-221">In certain cases, Azure Storage sets the Vary header to **Origin** to instruct the user agent to send the subsequent CORS request to the service when the requesting domain differs from the cached origin.</span></span>

<span data-ttu-id="2c536-222">Le stockage Azure affecte à l’en-tête *Vary* la valeur **Origin** pour les demandes GET/HEAD réelles dans les cas suivants :</span><span class="sxs-lookup"><span data-stu-id="2c536-222">Azure Storage sets the *Vary* header to **Origin** for actual GET/HEAD requests in the following cases:</span></span>

* <span data-ttu-id="2c536-223">Lorsque l'origine de la demande correspond exactement à l'origine autorisée définie par une règle CORS.</span><span class="sxs-lookup"><span data-stu-id="2c536-223">When the request origin exactly matches the allowed origin defined by a CORS rule.</span></span> <span data-ttu-id="2c536-224">Pour qu’il s’agisse d’une correspondance exacte, la règle CORS ne doit pas inclure le caractère générique « * ».</span><span class="sxs-lookup"><span data-stu-id="2c536-224">To be an exact match, the CORS rule may not include a wildcard ' * ' character.</span></span>
* <span data-ttu-id="2c536-225">Il n'y a aucune règle correspondant à l'origine de la demande, mais CORS est activé pour le service de stockage.</span><span class="sxs-lookup"><span data-stu-id="2c536-225">There is no rule matching the request origin, but CORS is enabled for the storage service.</span></span>

<span data-ttu-id="2c536-226">Si une demande GET/HEAD correspond à une règle CORS qui autorise toutes les origines, la réponse indique que toutes les origines sont autorisées et le cache de l'agent utilisateur autorise les demandes suivantes à partir de n'importe quel domaine d'origine pendant que le cache est actif.</span><span class="sxs-lookup"><span data-stu-id="2c536-226">In the case where a GET/HEAD request matches a CORS rule that allows all origins, the response indicates that all origins are allowed, and the user agent cache will allow subsequent requests from any origin domain while the cache is active.</span></span>

<span data-ttu-id="2c536-227">Notez qu'en ce qui concerne les demandes à l'aide de méthodes autres que GET/HEAD, les services de stockage ne définissent pas l'en-tête Vary, car les réponses à ces méthodes ne sont pas mises en cache par les agents utilisateur.</span><span class="sxs-lookup"><span data-stu-id="2c536-227">Note that for requests using methods other than GET/HEAD, the storage services will not set the Vary header, since responses to these methods are not cached by user agents.</span></span>

<span data-ttu-id="2c536-228">Le tableau suivant indique comment le stockage Azure répond aux demandes GET/HEAD en fonction des cas mentionnés précédemment :</span><span class="sxs-lookup"><span data-stu-id="2c536-228">The following table indicates how Azure storage will respond to GET/HEAD requests based on the previously mentioned cases:</span></span>

| <span data-ttu-id="2c536-229">Demande</span><span class="sxs-lookup"><span data-stu-id="2c536-229">Request</span></span> | <span data-ttu-id="2c536-230">Paramètre de compte et résultat de l'évaluation de la règle</span><span class="sxs-lookup"><span data-stu-id="2c536-230">Account setting and result of rule evaluation</span></span> |  |  | <span data-ttu-id="2c536-231">Réponse</span><span class="sxs-lookup"><span data-stu-id="2c536-231">Response</span></span> |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="2c536-232">**En-tête d’origine présent dans la demande**</span><span class="sxs-lookup"><span data-stu-id="2c536-232">**Origin header present on request**</span></span> |<span data-ttu-id="2c536-233">**Règle(s) CORS spécifiée(s) pour ce service**</span><span class="sxs-lookup"><span data-stu-id="2c536-233">**CORS rule(s) specified for this service**</span></span> |<span data-ttu-id="2c536-234">**Règle de correspondance existante qui autorise toutes les origines(*)**</span><span class="sxs-lookup"><span data-stu-id="2c536-234">**Matching rule exists that allows all origins(*)**</span></span> |<span data-ttu-id="2c536-235">**Règle de correspondance existante pour la correspondance exacte d’origine**</span><span class="sxs-lookup"><span data-stu-id="2c536-235">**Matching rule exists for exact origin match**</span></span> |<span data-ttu-id="2c536-236">**La réponse inclut l’en-tête Vary avec la valeur Origin**</span><span class="sxs-lookup"><span data-stu-id="2c536-236">**Response includes Vary header set to Origin**</span></span> |<span data-ttu-id="2c536-237">**La réponse inclut l’en-tête Access-Control-Allowed-Origin : «*  »**</span><span class="sxs-lookup"><span data-stu-id="2c536-237">**Response includes Access-Control-Allowed-Origin: "*"**</span></span> |<span data-ttu-id="2c536-238">**La réponse inclut l’en-têteAccess-Control-Exposed-Headers**</span><span class="sxs-lookup"><span data-stu-id="2c536-238">**Response includes Access-Control-Exposed-Headers**</span></span> |
| <span data-ttu-id="2c536-239">Non</span><span class="sxs-lookup"><span data-stu-id="2c536-239">No</span></span> |<span data-ttu-id="2c536-240">Non</span><span class="sxs-lookup"><span data-stu-id="2c536-240">No</span></span> |<span data-ttu-id="2c536-241">Non</span><span class="sxs-lookup"><span data-stu-id="2c536-241">No</span></span> |<span data-ttu-id="2c536-242">Non</span><span class="sxs-lookup"><span data-stu-id="2c536-242">No</span></span> |<span data-ttu-id="2c536-243">Non</span><span class="sxs-lookup"><span data-stu-id="2c536-243">No</span></span> |<span data-ttu-id="2c536-244">Non</span><span class="sxs-lookup"><span data-stu-id="2c536-244">No</span></span> |<span data-ttu-id="2c536-245">Non</span><span class="sxs-lookup"><span data-stu-id="2c536-245">No</span></span> |
| <span data-ttu-id="2c536-246">Non</span><span class="sxs-lookup"><span data-stu-id="2c536-246">No</span></span> |<span data-ttu-id="2c536-247">Oui</span><span class="sxs-lookup"><span data-stu-id="2c536-247">Yes</span></span> |<span data-ttu-id="2c536-248">Non</span><span class="sxs-lookup"><span data-stu-id="2c536-248">No</span></span> |<span data-ttu-id="2c536-249">Non</span><span class="sxs-lookup"><span data-stu-id="2c536-249">No</span></span> |<span data-ttu-id="2c536-250">Oui</span><span class="sxs-lookup"><span data-stu-id="2c536-250">Yes</span></span> |<span data-ttu-id="2c536-251">Non</span><span class="sxs-lookup"><span data-stu-id="2c536-251">No</span></span> |<span data-ttu-id="2c536-252">Non</span><span class="sxs-lookup"><span data-stu-id="2c536-252">No</span></span> |
| <span data-ttu-id="2c536-253">Non</span><span class="sxs-lookup"><span data-stu-id="2c536-253">No</span></span> |<span data-ttu-id="2c536-254">Oui</span><span class="sxs-lookup"><span data-stu-id="2c536-254">Yes</span></span> |<span data-ttu-id="2c536-255">Oui</span><span class="sxs-lookup"><span data-stu-id="2c536-255">Yes</span></span> |<span data-ttu-id="2c536-256">Non</span><span class="sxs-lookup"><span data-stu-id="2c536-256">No</span></span> |<span data-ttu-id="2c536-257">Non</span><span class="sxs-lookup"><span data-stu-id="2c536-257">No</span></span> |<span data-ttu-id="2c536-258">Oui</span><span class="sxs-lookup"><span data-stu-id="2c536-258">Yes</span></span> |<span data-ttu-id="2c536-259">Oui</span><span class="sxs-lookup"><span data-stu-id="2c536-259">Yes</span></span> |
| <span data-ttu-id="2c536-260">Oui</span><span class="sxs-lookup"><span data-stu-id="2c536-260">Yes</span></span> |<span data-ttu-id="2c536-261">Non</span><span class="sxs-lookup"><span data-stu-id="2c536-261">No</span></span> |<span data-ttu-id="2c536-262">Non</span><span class="sxs-lookup"><span data-stu-id="2c536-262">No</span></span> |<span data-ttu-id="2c536-263">Non</span><span class="sxs-lookup"><span data-stu-id="2c536-263">No</span></span> |<span data-ttu-id="2c536-264">Non</span><span class="sxs-lookup"><span data-stu-id="2c536-264">No</span></span> |<span data-ttu-id="2c536-265">Non</span><span class="sxs-lookup"><span data-stu-id="2c536-265">No</span></span> |<span data-ttu-id="2c536-266">Non</span><span class="sxs-lookup"><span data-stu-id="2c536-266">No</span></span> |
| <span data-ttu-id="2c536-267">Oui</span><span class="sxs-lookup"><span data-stu-id="2c536-267">Yes</span></span> |<span data-ttu-id="2c536-268">Oui</span><span class="sxs-lookup"><span data-stu-id="2c536-268">Yes</span></span> |<span data-ttu-id="2c536-269">Non</span><span class="sxs-lookup"><span data-stu-id="2c536-269">No</span></span> |<span data-ttu-id="2c536-270">Oui</span><span class="sxs-lookup"><span data-stu-id="2c536-270">Yes</span></span> |<span data-ttu-id="2c536-271">Oui</span><span class="sxs-lookup"><span data-stu-id="2c536-271">Yes</span></span> |<span data-ttu-id="2c536-272">Non</span><span class="sxs-lookup"><span data-stu-id="2c536-272">No</span></span> |<span data-ttu-id="2c536-273">Oui</span><span class="sxs-lookup"><span data-stu-id="2c536-273">Yes</span></span> |
| <span data-ttu-id="2c536-274">Oui</span><span class="sxs-lookup"><span data-stu-id="2c536-274">Yes</span></span> |<span data-ttu-id="2c536-275">Oui</span><span class="sxs-lookup"><span data-stu-id="2c536-275">Yes</span></span> |<span data-ttu-id="2c536-276">Non</span><span class="sxs-lookup"><span data-stu-id="2c536-276">No</span></span> |<span data-ttu-id="2c536-277">Non</span><span class="sxs-lookup"><span data-stu-id="2c536-277">No</span></span> |<span data-ttu-id="2c536-278">Oui</span><span class="sxs-lookup"><span data-stu-id="2c536-278">Yes</span></span> |<span data-ttu-id="2c536-279">Non</span><span class="sxs-lookup"><span data-stu-id="2c536-279">No</span></span> |<span data-ttu-id="2c536-280">Non</span><span class="sxs-lookup"><span data-stu-id="2c536-280">No</span></span> |
| <span data-ttu-id="2c536-281">Oui</span><span class="sxs-lookup"><span data-stu-id="2c536-281">Yes</span></span> |<span data-ttu-id="2c536-282">Oui</span><span class="sxs-lookup"><span data-stu-id="2c536-282">Yes</span></span> |<span data-ttu-id="2c536-283">Oui</span><span class="sxs-lookup"><span data-stu-id="2c536-283">Yes</span></span> |<span data-ttu-id="2c536-284">Non</span><span class="sxs-lookup"><span data-stu-id="2c536-284">No</span></span> |<span data-ttu-id="2c536-285">Non</span><span class="sxs-lookup"><span data-stu-id="2c536-285">No</span></span> |<span data-ttu-id="2c536-286">Oui</span><span class="sxs-lookup"><span data-stu-id="2c536-286">Yes</span></span> |<span data-ttu-id="2c536-287">Oui</span><span class="sxs-lookup"><span data-stu-id="2c536-287">Yes</span></span> |

## <a name="billing-for-cors-requests"></a><span data-ttu-id="2c536-288">Facturation des demandes CORS</span><span class="sxs-lookup"><span data-stu-id="2c536-288">Billing for CORS requests</span></span>
<span data-ttu-id="2c536-289">Les demandes préliminaires ayant abouti sont facturées si vous avez activé CORS pour l’un des services de stockage de votre compte (en appelant [Set Blob Service Properties](https://msdn.microsoft.com/library/hh452235.aspx), [Set Queue Service Properties](https://msdn.microsoft.com/library/hh452232.aspx) ou [Set Table Service Properties](https://msdn.microsoft.com/library/hh452240.aspx)).</span><span class="sxs-lookup"><span data-stu-id="2c536-289">Successful preflight requests are billed if you have enabled CORS for any of the storage services for your account (by calling [Set Blob Service Properties](https://msdn.microsoft.com/library/hh452235.aspx), [Set Queue Service Properties](https://msdn.microsoft.com/library/hh452232.aspx), or [Set Table Service Properties](https://msdn.microsoft.com/library/hh452240.aspx)).</span></span> <span data-ttu-id="2c536-290">Pour réduire les coûts, attribuez une valeur plus élevée à l’élément **MaxAgeInSeconds** dans vos règles CORS, de façon que l’agent utilisateur mette en cache la demande.</span><span class="sxs-lookup"><span data-stu-id="2c536-290">To minimize charges, consider setting the **MaxAgeInSeconds** element in your CORS rules to a large value so that the user agent caches the request.</span></span>

<span data-ttu-id="2c536-291">Les demandes préliminaires infructueuses ne seront pas facturés.</span><span class="sxs-lookup"><span data-stu-id="2c536-291">Unsuccessful preflight requests will not be billed.</span></span>

## <a name="next-steps"></a><span data-ttu-id="2c536-292">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="2c536-292">Next steps</span></span>
[<span data-ttu-id="2c536-293">Définition des propriétés du service Blob</span><span class="sxs-lookup"><span data-stu-id="2c536-293">Set Blob Service Properties</span></span>](https://msdn.microsoft.com/library/hh452235.aspx)

[<span data-ttu-id="2c536-294">Définition des propriétés du service de File d’attente</span><span class="sxs-lookup"><span data-stu-id="2c536-294">Set Queue Service Properties</span></span>](https://msdn.microsoft.com/library/hh452232.aspx)

[<span data-ttu-id="2c536-295">Définition des propriétés du service de Table</span><span class="sxs-lookup"><span data-stu-id="2c536-295">Set Table Service Properties</span></span>](https://msdn.microsoft.com/library/hh452240.aspx)

[<span data-ttu-id="2c536-296">Spécification du Partage des ressources cross-origin (W3C)</span><span class="sxs-lookup"><span data-stu-id="2c536-296">W3C Cross-Origin Resource Sharing Specification</span></span>](http://www.w3.org/TR/cors/)

