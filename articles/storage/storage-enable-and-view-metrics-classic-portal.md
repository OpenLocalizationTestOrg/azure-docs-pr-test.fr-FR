---
title: "métriques de stockage aaaEnabling Bonjour portail Azure | Documents Microsoft"
description: "Comment tooenable les métriques de stockage pour hello services Blob, file d’attente, Table et fichier"
services: storage
documentationcenter: 
author: robinsh
manager: timlt
editor: tysonn
ms.assetid: 2fb5b229-f099-4334-92be-4e0e7dd257d7
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 03/03/2017
ms.author: robinsh
ms.openlocfilehash: 4c990371e08a6586d935b0535149eabd4960cfaa
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="enabling-storage-metrics-and-viewing-metrics-data"></a><span data-ttu-id="0c07c-103">Activation de Storage Metrics et affichage des données de métriques</span><span class="sxs-lookup"><span data-stu-id="0c07c-103">Enabling Storage metrics and viewing metrics data</span></span>
[!INCLUDE [storage-selector-portal-enable-and-view-metrics](../../includes/storage-selector-portal-enable-and-view-metrics.md)]

## <a name="overview"></a><span data-ttu-id="0c07c-104">Vue d'ensemble</span><span class="sxs-lookup"><span data-stu-id="0c07c-104">Overview</span></span>
<span data-ttu-id="0c07c-105">Storage Metrics est activé par défaut lorsque vous créez un compte de stockage.</span><span class="sxs-lookup"><span data-stu-id="0c07c-105">Storage Metrics is enabled by default when you create a new storage account.</span></span> <span data-ttu-id="0c07c-106">Vous pouvez configurer l’analyse à l’aide soit hello [portail classique Azure](https://manage.windowsazure.com), Windows PowerShell, ou par programmation via une API de stockage.</span><span class="sxs-lookup"><span data-stu-id="0c07c-106">You can configure monitoring using either hello [Azure Classic Portal](https://manage.windowsazure.com), Windows PowerShell, or programmatically through a storage API.</span></span>

<span data-ttu-id="0c07c-107">Lorsque vous activez Storage Metrics, vous devez choisir une période de rétention pour les données de salutation : cette période détermine pour le stockage de hello la durée pendant laquelle le service maintient les métriques hello et les frais de hello espace requis toostore les.</span><span class="sxs-lookup"><span data-stu-id="0c07c-107">When you enable Storage Metrics, you must choose a retention period for hello data: this period determines for how long hello storage service keeps hello metrics and charges you for hello space required toostore them.</span></span> <span data-ttu-id="0c07c-108">En règle générale, vous devez utiliser une période de rétention plus courte pour les métriques par minute que pour les métriques en raison de l’espace supplémentaire hello requis pour les métriques par minute.</span><span class="sxs-lookup"><span data-stu-id="0c07c-108">Typically, you should use a shorter retention period for minute metrics than hourly metrics because of hello significant extra space required for minute metrics.</span></span> <span data-ttu-id="0c07c-109">Vous devez choisir une période de rétention telles que des données suffisantes temps tooanalyze hello et de télécharger les métriques que vous souhaitez tookeep pour une analyse hors ligne ou à des fins de création de rapports.</span><span class="sxs-lookup"><span data-stu-id="0c07c-109">You should choose a retention period such that you have sufficient time tooanalyze hello data and download any metrics you wish tookeep for off-line analysis or reporting purposes.</span></span> <span data-ttu-id="0c07c-110">N’oubliez pas que le téléchargement des données de métriques depuis votre compte de stockage est aussi facturé.</span><span class="sxs-lookup"><span data-stu-id="0c07c-110">Remember that you will also be billed for downloading metrics data from your storage account.</span></span>

## <a name="how-tooenable-storage-metrics-using-hello-azure-classic-portal"></a><span data-ttu-id="0c07c-111">Comment tooenable Storage metrics à l’aide de hello portail classique Azure</span><span class="sxs-lookup"><span data-stu-id="0c07c-111">How tooenable Storage metrics using hello Azure Classic Portal</span></span>
<span data-ttu-id="0c07c-112">Bonjour [portail classique Azure](https://manage.windowsazure.com), vous utilisez la page Configurer hello pour un toocontrol de compte de stockage des métriques de stockage.</span><span class="sxs-lookup"><span data-stu-id="0c07c-112">In hello [Azure Classic Portal](https://manage.windowsazure.com), you use hello Configure page for a storage account toocontrol Storage Metrics.</span></span> <span data-ttu-id="0c07c-113">Pour la surveillance, vous pouvez définir un niveau et une période de rétention en jours pour chaque objet blob, table et file d’attente.</span><span class="sxs-lookup"><span data-stu-id="0c07c-113">For monitoring, you can set a level and a retention period in days for each of blobs, tables, and queues.</span></span> <span data-ttu-id="0c07c-114">Dans chaque cas, le niveau de hello est hello suivantes :</span><span class="sxs-lookup"><span data-stu-id="0c07c-114">In each case, hello level is one of hello following:</span></span>

* <span data-ttu-id="0c07c-115">Désactivée : aucune métrique n’est collectée.</span><span class="sxs-lookup"><span data-stu-id="0c07c-115">Off — No metrics are collected.</span></span>
* <span data-ttu-id="0c07c-116">Minimal — Storage Metrics collecte un ensemble de base de métriques, notamment des entrées/sorties, la disponibilité, la latence et les pourcentages de réussite, qui sont ensuite regroupés pour les services Blob, Table et de file d’attente hello.</span><span class="sxs-lookup"><span data-stu-id="0c07c-116">Minimal — Storage Metrics collects a basic set of metrics such as ingress/egress, availability, latency, and success percentages, which are aggregated for hello Blob, Table, and Queue services.</span></span>
* <span data-ttu-id="0c07c-117">Verbose : Collecte de métriques de stockage un jeu complet de métriques, notamment hello les mêmes métriques pour chaque opération de l’API de stockage, en outre toohello au niveau du service metrics.</span><span class="sxs-lookup"><span data-stu-id="0c07c-117">Verbose — Storage Metrics collects a full set of metrics that includes hello same metrics for each storage API operation, in addition toohello service-level metrics.</span></span> <span data-ttu-id="0c07c-118">Les métriques détaillées permettent d’analyser plus précisément les problèmes survenant durant le fonctionnement d’une application.</span><span class="sxs-lookup"><span data-stu-id="0c07c-118">Verbose metrics enable closer analysis of issues that occur during application operations.</span></span>

<span data-ttu-id="0c07c-119">Notez que hello portail classique Azure ne pas actuellement vous tooconfigure les métriques par minute dans votre compte de stockage ; Vous devez les activer à l’aide de PowerShell ou par programme.</span><span class="sxs-lookup"><span data-stu-id="0c07c-119">Note that hello Azure Classic Portal does not currently enable you tooconfigure minute metrics in your storage account; you must enable minute metrics using PowerShell or programmatically.</span></span>

## <a name="how-tooenable-storage-metrics-using-powershell"></a><span data-ttu-id="0c07c-120">Comment tooenable Storage metrics à l’aide de PowerShell</span><span class="sxs-lookup"><span data-stu-id="0c07c-120">How tooenable Storage metrics using PowerShell</span></span>
<span data-ttu-id="0c07c-121">Vous pouvez utiliser PowerShell sur votre ordinateur local de tooconfigure Storage Metrics dans votre compte de stockage en utilisant les paramètres en cours hello du tooretrieve applet de commande Get-AzureStorageServiceMetricsProperty hello Azure PowerShell et hello applet de commande Set-AzureStorageServiceMetricsProperty toochange hello les paramètres actuels.</span><span class="sxs-lookup"><span data-stu-id="0c07c-121">You can use PowerShell on your local machine tooconfigure Storage Metrics in your storage account by using hello Azure PowerShell cmdlet Get-AzureStorageServiceMetricsProperty tooretrieve hello current settings, and hello cmdlet Set-AzureStorageServiceMetricsProperty toochange hello current settings.</span></span>

<span data-ttu-id="0c07c-122">les applets de commande Hello qui contrôlent Storage Metrics utilisent hello paramètres suivants :</span><span class="sxs-lookup"><span data-stu-id="0c07c-122">hello cmdlets that control Storage Metrics use hello following parameters:</span></span>

* <span data-ttu-id="0c07c-123">MetricsType peut avoir pour valeur Hour ou Minute.</span><span class="sxs-lookup"><span data-stu-id="0c07c-123">MetricsType possible values are Hour and Minute.</span></span>
* <span data-ttu-id="0c07c-124">ServiceType peut avoir pour valeur Blob, Queue ou Table.</span><span class="sxs-lookup"><span data-stu-id="0c07c-124">ServiceType possible values are Blob, Queue, and Table.</span></span>
* <span data-ttu-id="0c07c-125">MetricsLevel les valeurs possibles sont None (tooOff équivalent Bonjour portail classique Azure), Service (équivalent tooMinimal Bonjour portail classique Azure) et ServiceAndApi (équivalent tooVerbose Bonjour portail classique Azure).</span><span class="sxs-lookup"><span data-stu-id="0c07c-125">MetricsLevel possible values are None (equivalent tooOff in hello Azure Classic Portal), Service (equivalent tooMinimal in hello Azure Classic Portal), and ServiceAndApi (equivalent tooVerbose in hello Azure Classic Portal).</span></span>

<span data-ttu-id="0c07c-126">Par exemple, hello commande suivante active minute métriques pour le service d’objets blob hello dans votre compte de stockage par défaut avec la période de rétention hello de définir les jours de toofive :</span><span class="sxs-lookup"><span data-stu-id="0c07c-126">For example, hello following command switches on minute metrics for hello blob service in your default storage account with hello retention period set toofive days:</span></span>

```powershell
Set-AzureStorageServiceMetricsProperty -MetricsType Minute -ServiceType Blob -MetricsLevel ServiceAndApi  -RetentionDays 5
```
<span data-ttu-id="0c07c-127">Hello commande suivante récupère hello actuel toutes les heures des métriques niveau et rétention en jours pour le service d’objets blob hello dans votre compte de stockage par défaut :</span><span class="sxs-lookup"><span data-stu-id="0c07c-127">hello following command retrieves hello current hourly metrics level and retention days for hello blob service in your default storage account:</span></span>

```powershell
Get-AzureStorageServiceMetricsProperty -MetricsType Hour -ServiceType Blob
```
<span data-ttu-id="0c07c-128">Pour plus d’informations sur comment tooconfigure hello le toowork d’applets de commande Azure PowerShell avec votre abonnement Azure et comment tooselect hello du stockage par défaut de compte toouse, consultez : [comment tooinstall et configurer Azure PowerShell](/powershell/azure/overview).</span><span class="sxs-lookup"><span data-stu-id="0c07c-128">For information about how tooconfigure hello Azure PowerShell cmdlets toowork with your Azure subscription and how tooselect hello default storage account toouse, see: [How tooinstall and configure Azure PowerShell](/powershell/azure/overview).</span></span>

## <a name="how-tooenable-storage-metrics-programmatically"></a><span data-ttu-id="0c07c-129">Comment tooenable Storage metrics par programmation</span><span class="sxs-lookup"><span data-stu-id="0c07c-129">How tooenable Storage metrics programmatically</span></span>
<span data-ttu-id="0c07c-130">Hello suivant extrait de code c# montre comment tooenable métriques et la journalisation pour le service de l’objet Blob hello à l’aide hello bibliothèque cliente de stockage pour .NET :</span><span class="sxs-lookup"><span data-stu-id="0c07c-130">hello following C# snippet shows how tooenable metrics and logging for hello Blob service using hello storage client library for .NET:</span></span>

```csharp
//Parse hello connection string for hello storage account.
const string ConnectionString = "DefaultEndpointsProtocol=https;AccountName=account-name;AccountKey=account-key";
CloudStorageAccount storageAccount = CloudStorageAccount.Parse(ConnectionString);

// Create service client for credentialed access toohello Blob service.
CloudBlobClient blobClient = storageAccount.CreateCloudBlobClient();

// Enable Storage Analytics logging and set retention policy too10 days. 
ServiceProperties properties = new ServiceProperties();
properties.Logging.LoggingOperations = LoggingOperations.All;
properties.Logging.RetentionDays = 10;
properties.Logging.Version = "1.0";

// Configure service properties for metrics. Both metrics and logging must be set at hello same time.
properties.HourMetrics.MetricsLevel = MetricsLevel.ServiceAndApi;
properties.HourMetrics.RetentionDays = 10;
properties.HourMetrics.Version = "1.0";

properties.MinuteMetrics.MetricsLevel = MetricsLevel.ServiceAndApi;
properties.MinuteMetrics.RetentionDays = 10;
properties.MinuteMetrics.Version = "1.0";

// Set hello default service version toobe used for anonymous requests.
properties.DefaultServiceVersion = "2015-04-05";

// Set hello service properties.
blobClient.SetServiceProperties(properties);
```

## <a name="viewing-storage-metrics"></a><span data-ttu-id="0c07c-131">Affichage des métriques de stockage</span><span class="sxs-lookup"><span data-stu-id="0c07c-131">Viewing Storage metrics</span></span>
<span data-ttu-id="0c07c-132">Lorsque vous avez configuré des métriques de stockage toomonitor votre compte de stockage, il enregistre les métriques hello dans un ensemble de tables connues dans votre compte de stockage.</span><span class="sxs-lookup"><span data-stu-id="0c07c-132">When you have configured Storage Metrics toomonitor your storage account, it records hello metrics in a set of well-known tables in your storage account.</span></span> <span data-ttu-id="0c07c-133">Vous pouvez utiliser la page de moniteur de hello pour votre compte de stockage dans le portail classique Azure tooview hello les métriques par heure de hello dès qu’elles sont disponibles sur un graphique.</span><span class="sxs-lookup"><span data-stu-id="0c07c-133">You can use hello Monitor page for your storage account in hello Azure Classic Portal tooview hello hourly metrics as they become available on a chart.</span></span> <span data-ttu-id="0c07c-134">Dans cette page hello portail classique Azure, vous pouvez :</span><span class="sxs-lookup"><span data-stu-id="0c07c-134">On this page in hello Azure Classic Portal, you can:</span></span>

* <span data-ttu-id="0c07c-135">Sélectionnez le tooplot métriques sur le graphique de hello (choix hello de métriques disponibles dépend de si vous avez choisi une surveillance détaillée ou minimale pour le service hello sur la page Configurer hello).</span><span class="sxs-lookup"><span data-stu-id="0c07c-135">Select which metrics tooplot on hello chart (hello choice of available metrics will depend on whether you chose verbose or minimal monitoring for hello service on hello Configure page).</span></span>
* <span data-ttu-id="0c07c-136">Sélectionnez la plage de temps hello pour les métriques de hello affichées sur le graphique de hello.</span><span class="sxs-lookup"><span data-stu-id="0c07c-136">Select hello time range for hello metrics displayed on hello chart.</span></span>
* <span data-ttu-id="0c07c-137">Choisissez toouse une métrique de hello tooplot l’échelle relative ou absolue.</span><span class="sxs-lookup"><span data-stu-id="0c07c-137">Choose toouse an absolute or relative scale tooplot hello metrics.</span></span>
* <span data-ttu-id="0c07c-138">Configurer toonotify des alertes par courrier électronique lorsqu’une métrique spécifique atteint une certaine valeur.</span><span class="sxs-lookup"><span data-stu-id="0c07c-138">Configure email alerts toonotify you when a specific metric reaches a certain value.</span></span>

<span data-ttu-id="0c07c-139">Si vous souhaitez que les métriques de hello toodownload pour le stockage à long terme ou tooanalyze les localement, vous devez toouse un outil ou écrire du code de tables de hello tooread.</span><span class="sxs-lookup"><span data-stu-id="0c07c-139">If you want toodownload hello metrics for long-term storage or tooanalyze them locally, you will need toouse a tool or write some code tooread hello tables.</span></span> <span data-ttu-id="0c07c-140">Vous devez télécharger les métriques par minute hello pour analyse.</span><span class="sxs-lookup"><span data-stu-id="0c07c-140">You must download hello minute metrics for analysis.</span></span> <span data-ttu-id="0c07c-141">les tables Hello n’apparaissent pas si vous répertoriez toutes les tables hello dans votre compte de stockage, mais vous pouvez y accéder directement par nom.</span><span class="sxs-lookup"><span data-stu-id="0c07c-141">hello tables do not appear if you list all hello tables in your storage account, but you can access them directly by name.</span></span> <span data-ttu-id="0c07c-142">Nombreux outils de consultation du stockage tiers ont connaissance de ces tables et vous permettre de tooview directement (consultez billet de blog hello [Microsoft Azure Storage Explorers](http://blogs.msdn.com/b/windowsazurestorage/archive/2014/03/11/windows-azure-storage-explorers-2014.aspx) pour obtenir la liste des outils disponibles).</span><span class="sxs-lookup"><span data-stu-id="0c07c-142">Many third-party storage-browsing tools are aware of these tables and enable you tooview them directly (see hello blog post [Microsoft Azure Storage Explorers](http://blogs.msdn.com/b/windowsazurestorage/archive/2014/03/11/windows-azure-storage-explorers-2014.aspx) for a list of available tools).</span></span>

### <a name="hourly-metrics"></a><span data-ttu-id="0c07c-143">Métriques toutes les heures</span><span class="sxs-lookup"><span data-stu-id="0c07c-143">Hourly metrics</span></span>
* <span data-ttu-id="0c07c-144">$MetricsHourPrimaryTransactionsBlob</span><span class="sxs-lookup"><span data-stu-id="0c07c-144">$MetricsHourPrimaryTransactionsBlob</span></span>
* <span data-ttu-id="0c07c-145">$MetricsHourPrimaryTransactionsTable</span><span class="sxs-lookup"><span data-stu-id="0c07c-145">$MetricsHourPrimaryTransactionsTable</span></span>
* <span data-ttu-id="0c07c-146">$MetricsHourPrimaryTransactionsQueue</span><span class="sxs-lookup"><span data-stu-id="0c07c-146">$MetricsHourPrimaryTransactionsQueue</span></span>

### <a name="minute-metrics"></a><span data-ttu-id="0c07c-147">Métriques par minute</span><span class="sxs-lookup"><span data-stu-id="0c07c-147">Minute metrics</span></span>
* <span data-ttu-id="0c07c-148">$MetricsMinutePrimaryTransactionsBlob</span><span class="sxs-lookup"><span data-stu-id="0c07c-148">$MetricsMinutePrimaryTransactionsBlob</span></span>
* <span data-ttu-id="0c07c-149">$MetricsMinutePrimaryTransactionsTable</span><span class="sxs-lookup"><span data-stu-id="0c07c-149">$MetricsMinutePrimaryTransactionsTable</span></span>
* <span data-ttu-id="0c07c-150">$MetricsMinutePrimaryTransactionsQueue</span><span class="sxs-lookup"><span data-stu-id="0c07c-150">$MetricsMinutePrimaryTransactionsQueue</span></span>

### <a name="capacity"></a><span data-ttu-id="0c07c-151">Capacité</span><span class="sxs-lookup"><span data-stu-id="0c07c-151">Capacity</span></span>
* <span data-ttu-id="0c07c-152">$MetricsCapacityBlob</span><span class="sxs-lookup"><span data-stu-id="0c07c-152">$MetricsCapacityBlob</span></span>

<span data-ttu-id="0c07c-153">Vous trouverez des informations complètes sur les schémas hello pour ces tables, consultez [schéma de Table de métriques Storage Analytique](https://msdn.microsoft.com/library/azure/hh343264.aspx).</span><span class="sxs-lookup"><span data-stu-id="0c07c-153">You can find full details of hello schemas for these tables at [Storage Analytics Metrics Table Schema](https://msdn.microsoft.com/library/azure/hh343264.aspx).</span></span> <span data-ttu-id="0c07c-154">lignes d’exemple Hello ci-dessous montrent uniquement un sous-ensemble de colonnes hello disponibles, mais illustrent certaines fonctionnalités importantes de façon hello que Storage Metrics enregistre ces métriques :</span><span class="sxs-lookup"><span data-stu-id="0c07c-154">hello sample rows below show only a subset of hello columns available, but illustrate some important features of hello way Storage Metrics saves these metrics:</span></span>

| <span data-ttu-id="0c07c-155">PartitionKey</span><span class="sxs-lookup"><span data-stu-id="0c07c-155">PartitionKey</span></span> | <span data-ttu-id="0c07c-156">RowKey</span><span class="sxs-lookup"><span data-stu-id="0c07c-156">RowKey</span></span> | <span data-ttu-id="0c07c-157">Timestamp</span><span class="sxs-lookup"><span data-stu-id="0c07c-157">Timestamp</span></span> | <span data-ttu-id="0c07c-158">TotalRequests</span><span class="sxs-lookup"><span data-stu-id="0c07c-158">TotalRequests</span></span> | <span data-ttu-id="0c07c-159">TotalBillableRequests</span><span class="sxs-lookup"><span data-stu-id="0c07c-159">TotalBillableRequests</span></span> | <span data-ttu-id="0c07c-160">TotalIngress</span><span class="sxs-lookup"><span data-stu-id="0c07c-160">TotalIngress</span></span> | <span data-ttu-id="0c07c-161">TotalEgress</span><span class="sxs-lookup"><span data-stu-id="0c07c-161">TotalEgress</span></span> | <span data-ttu-id="0c07c-162">Availability</span><span class="sxs-lookup"><span data-stu-id="0c07c-162">Availability</span></span> | <span data-ttu-id="0c07c-163">AverageE2ELatency</span><span class="sxs-lookup"><span data-stu-id="0c07c-163">AverageE2ELatency</span></span> | <span data-ttu-id="0c07c-164">AverageServerLatency</span><span class="sxs-lookup"><span data-stu-id="0c07c-164">AverageServerLatency</span></span> | <span data-ttu-id="0c07c-165">PercentSuccess</span><span class="sxs-lookup"><span data-stu-id="0c07c-165">PercentSuccess</span></span> |
| --- |:---:| ---:| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="0c07c-166">20140522T1100</span><span class="sxs-lookup"><span data-stu-id="0c07c-166">20140522T1100</span></span> |<span data-ttu-id="0c07c-167">user;All</span><span class="sxs-lookup"><span data-stu-id="0c07c-167">user;All</span></span> |<span data-ttu-id="0c07c-168">2014-05-22T11:01:16.7650250Z</span><span class="sxs-lookup"><span data-stu-id="0c07c-168">2014-05-22T11:01:16.7650250Z</span></span> |<span data-ttu-id="0c07c-169">7</span><span class="sxs-lookup"><span data-stu-id="0c07c-169">7</span></span> |<span data-ttu-id="0c07c-170">7</span><span class="sxs-lookup"><span data-stu-id="0c07c-170">7</span></span> |<span data-ttu-id="0c07c-171">4003</span><span class="sxs-lookup"><span data-stu-id="0c07c-171">4003</span></span> |<span data-ttu-id="0c07c-172">46801</span><span class="sxs-lookup"><span data-stu-id="0c07c-172">46801</span></span> |<span data-ttu-id="0c07c-173">100</span><span class="sxs-lookup"><span data-stu-id="0c07c-173">100</span></span> |<span data-ttu-id="0c07c-174">104.4286</span><span class="sxs-lookup"><span data-stu-id="0c07c-174">104.4286</span></span> |<span data-ttu-id="0c07c-175">6.857143</span><span class="sxs-lookup"><span data-stu-id="0c07c-175">6.857143</span></span> |<span data-ttu-id="0c07c-176">100</span><span class="sxs-lookup"><span data-stu-id="0c07c-176">100</span></span> |
| <span data-ttu-id="0c07c-177">20140522T1100</span><span class="sxs-lookup"><span data-stu-id="0c07c-177">20140522T1100</span></span> |<span data-ttu-id="0c07c-178">user;QueryEntities</span><span class="sxs-lookup"><span data-stu-id="0c07c-178">user;QueryEntities</span></span> |<span data-ttu-id="0c07c-179">2014-05-22T11:01:16.7640250Z</span><span class="sxs-lookup"><span data-stu-id="0c07c-179">2014-05-22T11:01:16.7640250Z</span></span> |<span data-ttu-id="0c07c-180">5</span><span class="sxs-lookup"><span data-stu-id="0c07c-180">5</span></span> |<span data-ttu-id="0c07c-181">5</span><span class="sxs-lookup"><span data-stu-id="0c07c-181">5</span></span> |<span data-ttu-id="0c07c-182">2694</span><span class="sxs-lookup"><span data-stu-id="0c07c-182">2694</span></span> |<span data-ttu-id="0c07c-183">45951</span><span class="sxs-lookup"><span data-stu-id="0c07c-183">45951</span></span> |<span data-ttu-id="0c07c-184">100</span><span class="sxs-lookup"><span data-stu-id="0c07c-184">100</span></span> |<span data-ttu-id="0c07c-185">143.8</span><span class="sxs-lookup"><span data-stu-id="0c07c-185">143.8</span></span> |<span data-ttu-id="0c07c-186">7.8</span><span class="sxs-lookup"><span data-stu-id="0c07c-186">7.8</span></span> |<span data-ttu-id="0c07c-187">100</span><span class="sxs-lookup"><span data-stu-id="0c07c-187">100</span></span> |
| <span data-ttu-id="0c07c-188">20140522T1100</span><span class="sxs-lookup"><span data-stu-id="0c07c-188">20140522T1100</span></span> |<span data-ttu-id="0c07c-189">user;QueryEntity</span><span class="sxs-lookup"><span data-stu-id="0c07c-189">user;QueryEntity</span></span> |<span data-ttu-id="0c07c-190">2014-05-22T11:01:16.7650250Z</span><span class="sxs-lookup"><span data-stu-id="0c07c-190">2014-05-22T11:01:16.7650250Z</span></span> |<span data-ttu-id="0c07c-191">1</span><span class="sxs-lookup"><span data-stu-id="0c07c-191">1</span></span> |<span data-ttu-id="0c07c-192">1</span><span class="sxs-lookup"><span data-stu-id="0c07c-192">1</span></span> |<span data-ttu-id="0c07c-193">538</span><span class="sxs-lookup"><span data-stu-id="0c07c-193">538</span></span> |<span data-ttu-id="0c07c-194">633</span><span class="sxs-lookup"><span data-stu-id="0c07c-194">633</span></span> |<span data-ttu-id="0c07c-195">100</span><span class="sxs-lookup"><span data-stu-id="0c07c-195">100</span></span> |<span data-ttu-id="0c07c-196">3</span><span class="sxs-lookup"><span data-stu-id="0c07c-196">3</span></span> |<span data-ttu-id="0c07c-197">3</span><span class="sxs-lookup"><span data-stu-id="0c07c-197">3</span></span> |<span data-ttu-id="0c07c-198">100</span><span class="sxs-lookup"><span data-stu-id="0c07c-198">100</span></span> |
| <span data-ttu-id="0c07c-199">20140522T1100</span><span class="sxs-lookup"><span data-stu-id="0c07c-199">20140522T1100</span></span> |<span data-ttu-id="0c07c-200">user;UpdateEntity</span><span class="sxs-lookup"><span data-stu-id="0c07c-200">user;UpdateEntity</span></span> |<span data-ttu-id="0c07c-201">2014-05-22T11:01:16.7650250Z</span><span class="sxs-lookup"><span data-stu-id="0c07c-201">2014-05-22T11:01:16.7650250Z</span></span> |<span data-ttu-id="0c07c-202">1</span><span class="sxs-lookup"><span data-stu-id="0c07c-202">1</span></span> |<span data-ttu-id="0c07c-203">1</span><span class="sxs-lookup"><span data-stu-id="0c07c-203">1</span></span> |<span data-ttu-id="0c07c-204">771</span><span class="sxs-lookup"><span data-stu-id="0c07c-204">771</span></span> |<span data-ttu-id="0c07c-205">217</span><span class="sxs-lookup"><span data-stu-id="0c07c-205">217</span></span> |<span data-ttu-id="0c07c-206">100</span><span class="sxs-lookup"><span data-stu-id="0c07c-206">100</span></span> |<span data-ttu-id="0c07c-207">9</span><span class="sxs-lookup"><span data-stu-id="0c07c-207">9</span></span> |<span data-ttu-id="0c07c-208">6</span><span class="sxs-lookup"><span data-stu-id="0c07c-208">6</span></span> |<span data-ttu-id="0c07c-209">100</span><span class="sxs-lookup"><span data-stu-id="0c07c-209">100</span></span> |

<span data-ttu-id="0c07c-210">Dans cet exemple de données de mesure des minutes, clé de partition hello sollicitent hello à la résolution d’une minute.</span><span class="sxs-lookup"><span data-stu-id="0c07c-210">In this example minute metrics data, hello partition key uses hello time at minute resolution.</span></span> <span data-ttu-id="0c07c-211">clé de ligne Hello identifie le type hello des informations qui sont stockées dans la ligne de hello et elle se compose de deux éléments d’information, type d’accès hello et type de demande de hello :</span><span class="sxs-lookup"><span data-stu-id="0c07c-211">hello row key identifies hello type of information that is stored in hello row and this is composed of two pieces of information, hello access type, and hello request type:</span></span>

* <span data-ttu-id="0c07c-212">type d’accès Hello est utilisateur ou système, où utilisateur désigne le service de stockage tooall utilisateur demandes toohello et système toorequests apportées par stockage Analytique.</span><span class="sxs-lookup"><span data-stu-id="0c07c-212">hello access type is either user or system, where user refers tooall user requests toohello storage service, and system refers toorequests made by Storage Analytics.</span></span>
* <span data-ttu-id="0c07c-213">type de demande de Hello est dans ce cas il s’agit d’une ligne de résumé, ou il identifie hello les API spécifiques telles que QueryEntity ou UpdateEntity.</span><span class="sxs-lookup"><span data-stu-id="0c07c-213">hello request type is either all in which case it is a summary line, or it identifies hello specific API such as QueryEntity or UpdateEntity.</span></span>

<span data-ttu-id="0c07c-214">données d’exemple Hello ci-dessus montre que tous les hello enregistre pour une seule minute (commence à 11 h 00), ce nombre de hello de demandes de QueryEntities plus hello nombre de demandes de QueryEntity plus nombre hello de demandes de UpdateEntity additionner tooseven, qui est hello total indiqué sur ligne d’user : All Hello.</span><span class="sxs-lookup"><span data-stu-id="0c07c-214">hello sample data above shows all hello records for a single minute (starting at 11:00AM), so hello number of QueryEntities requests plus hello number of QueryEntity requests plus hello number of UpdateEntity requests add up tooseven, which is hello total shown on hello user:All row.</span></span> <span data-ttu-id="0c07c-215">De même, vous pouvez dériver la latence de bout en bout moyenne hello (104,4286) sur la ligne d’user : All hello en calculant ((143.8 * 5) + 3 + 9) / 7.</span><span class="sxs-lookup"><span data-stu-id="0c07c-215">Similarly, you can derive hello average end-to-end latency 104.4286 on hello user:All row by calculating ((143.8 * 5) + 3 + 9)/7.</span></span>

<span data-ttu-id="0c07c-216">Vous devez envisager de définir des alertes Bonjour portail classique Azure sur la page d’analyse hello afin que Storage Metrics puisse vous avertir automatiquement de toutes les modifications importantes de comportement hello de vos services de stockage. Si vous utilisez un toodownload d’outil de l’Explorateur de stockage de ces données métriques dans un format délimité, vous pouvez utiliser les données de Microsoft Excel tooanalyze hello.</span><span class="sxs-lookup"><span data-stu-id="0c07c-216">You should consider setting up alerts in hello Azure Classic Portal on hello Monitor page so that Storage Metrics can automatically notify you of any important changes in hello behavior of your storage services.If you use a storage explorer tool toodownload this metrics data in a delimited format, you can use Microsoft Excel tooanalyze hello data.</span></span> <span data-ttu-id="0c07c-217">Consultez billet de blog hello [Microsoft Azure Storage Explorers](http://blogs.msdn.com/b/windowsazurestorage/archive/2014/03/11/windows-azure-storage-explorers-2014.aspx) pour obtenir la liste des outils de l’Explorateur de stockage disponible.</span><span class="sxs-lookup"><span data-stu-id="0c07c-217">See hello blog post [Microsoft Azure Storage Explorers](http://blogs.msdn.com/b/windowsazurestorage/archive/2014/03/11/windows-azure-storage-explorers-2014.aspx) for a list of available storage explorer tools.</span></span>

## <a name="accessing-metrics-data-programmatically"></a><span data-ttu-id="0c07c-218">Accès aux données de métriques par programmation</span><span class="sxs-lookup"><span data-stu-id="0c07c-218">Accessing metrics data programmatically</span></span>
<span data-ttu-id="0c07c-219">Hello ci-dessous montre exemple code c# qui accède aux métriques par minute hello pour une plage de minutes et affiche les résultats de hello dans une fenêtre de console.</span><span class="sxs-lookup"><span data-stu-id="0c07c-219">hello following listing shows sample C# code that accesses hello minute metrics for a range of minutes and displays hello results in a console Window.</span></span> <span data-ttu-id="0c07c-220">Il utilise hello version 4 incluant hello classe CloudAnalyticsClient qui simplifie l’accès aux tables de métriques hello dans le stockage de bibliothèque de stockage Azure.</span><span class="sxs-lookup"><span data-stu-id="0c07c-220">It uses hello Azure Storage Library version 4 that includes hello CloudAnalyticsClient class that simplifies accessing hello metrics tables in storage.</span></span>

```csharp
private static void PrintMinuteMetrics(CloudAnalyticsClient analyticsClient, DateTimeOffset startDateTime, DateTimeOffset endDateTime)
{
    // Convert hello dates toohello format used in hello PartitionKey
    var start = startDateTime.ToUniversalTime().ToString("yyyyMMdd'T'HHmm");
    var end = endDateTime.ToUniversalTime().ToString("yyyyMMdd'T'HHmm");

    var services = Enum.GetValues(typeof(StorageService));
    foreach (StorageService service in services)
    {
        Console.WriteLine("Minute Metrics for Service {0} from {1} too{2} UTC", service, start, end);
        var metricsQuery = analyticsClient.CreateMinuteMetricsQuery(service, StorageLocation.Primary);
        var t = analyticsClient.GetMinuteMetricsTable(service);
        var opContext = new OperationContext();
        var query =
          from entity in metricsQuery
          // Note, you can't filter using hello entity properties Time, AccessType, or TransactionType
          // because they are calculated fields in hello MetricsEntity class.
          // hello PartitionKey identifies hello DataTime of hello metrics.
          where entity.PartitionKey.CompareTo(start) >= 0 && entity.PartitionKey.CompareTo(end) <= 0 
        select entity;

        // Filter on "user" transactions after fetching hello metrics from Table Storage.
        // (StartsWith is not supported using LINQ with Azure table storage)
        var results = query.ToList().Where(m => m.RowKey.StartsWith("user"));
        var resultString = results.Aggregate(new StringBuilder(), (builder, metrics) => builder.AppendLine(MetricsString(metrics, opContext))).ToString();
        Console.WriteLine(resultString);
    }
}

private static string MetricsString(MetricsEntity entity, OperationContext opContext)
{
    var entityProperties = entity.WriteEntity(opContext);
    var entityString =
    string.Format("Time: {0}, ", entity.Time) +
    string.Format("AccessType: {0}, ", entity.AccessType) +
    string.Format("TransactionType: {0}, ", entity.TransactionType) +
    string.Join(",", entityProperties.Select(e => new KeyValuePair<string, string>(e.Key.ToString(), e.Value.PropertyAsObject.ToString())));
    return entityString;
}
```

## <a name="what-charges-do-you-incur-when-you-enable-storage-metrics"></a><span data-ttu-id="0c07c-221">Quels sont les frais encourus quand vous activez les métriques de stockage ?</span><span class="sxs-lookup"><span data-stu-id="0c07c-221">What charges do you incur when you enable storage metrics?</span></span>
<span data-ttu-id="0c07c-222">Écrire des entités de table toocreate de demandes pour les métriques sont facturées au hello des frais standard applicables tooall Azure des opérations de stockage.</span><span class="sxs-lookup"><span data-stu-id="0c07c-222">Write requests toocreate table entities for metrics are charged at hello standard rates applicable tooall Azure Storage operations.</span></span>

<span data-ttu-id="0c07c-223">Les demandes de lecture et de suppression par une toometrics les données client sont aussi facturées au tarif standard.</span><span class="sxs-lookup"><span data-stu-id="0c07c-223">Read and delete requests by a client toometrics data are also billable at standard rates.</span></span> <span data-ttu-id="0c07c-224">Si vous avez configuré une stratégie de rétention des données, vous n’êtes pas facturé quand Azure Storage supprime les anciennes données de métriques.</span><span class="sxs-lookup"><span data-stu-id="0c07c-224">If you have configured a data retention policy, you are not charged when Azure Storage deletes old metrics data.</span></span> <span data-ttu-id="0c07c-225">Toutefois, si vous supprimez les données analytique, votre compte est facturé pour les opérations de suppression hello.</span><span class="sxs-lookup"><span data-stu-id="0c07c-225">However, if you delete analytics data, your account is charged for hello delete operations.</span></span>

<span data-ttu-id="0c07c-226">capacité de Hello utilisée par les tables de métriques hello est également facturable : vous pouvez utiliser hello suivant le montant de hello tooestimate de capacité utilisée pour stocker les données de métriques :</span><span class="sxs-lookup"><span data-stu-id="0c07c-226">hello capacity used by hello metrics tables is also billable: you can use hello following tooestimate hello amount of capacity used for storing metrics data:</span></span>

* <span data-ttu-id="0c07c-227">Si chaque heure un service qui utilise des API de chaque service, environ 148 Ko de données sont stockée toutes les heures dans les tables de transaction de métriques hello si vous avez activé le service et le niveau de l’API résumé.</span><span class="sxs-lookup"><span data-stu-id="0c07c-227">If each hour a service utilizes every API in every service, then approximately 148KB of data is stored every hour in hello metrics transaction tables if you have enabled both service and API level summary.</span></span>
* <span data-ttu-id="0c07c-228">Si chaque heure un service qui utilise des API de chaque service, environ 12 Ko de données sont stockée toutes les heures dans les tables de transaction de métriques hello si vous avez activé uniquement service au niveau du résumé.</span><span class="sxs-lookup"><span data-stu-id="0c07c-228">If each hour a service utilizes every API in every service, then approximately 12KB of data is stored every hour in hello metrics transaction tables if you have enabled just service level summary.</span></span>
* <span data-ttu-id="0c07c-229">table de capacité pour les objets BLOB Hello a deux lignes sont ajoutées chaque jour (si l’utilisateur a activé les journaux) : cela signifie que chaque taille de hello jour de cette table augmente par des tooapproximately 300 octets.</span><span class="sxs-lookup"><span data-stu-id="0c07c-229">hello capacity table for blobs has two rows added each day (provided user has opted in for logs): this implies that every day hello size of this table increases by up tooapproximately 300 bytes.</span></span>

## <a name="next-steps"></a><span data-ttu-id="0c07c-230">Étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="0c07c-230">Next steps:</span></span>
[<span data-ttu-id="0c07c-231">Activation de la journalisation et accès aux données des journaux de stockage</span><span class="sxs-lookup"><span data-stu-id="0c07c-231">Enabling Storage Analytics Logging and Accessing Log Data</span></span>](https://msdn.microsoft.com/library/dn782840.aspx)
