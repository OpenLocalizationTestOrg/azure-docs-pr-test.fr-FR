---
title: 'Azure Premium Storage : conception sous le signe de la haute performance | Microsoft Docs'
description: "Concevoir des applications hautes performances avec Azure Premium Storage. Premium Storage offre une prise en charge très performante et à faible latence des disques pour les charges de travail utilisant beaucoup d'E/S exécutées sur les machines virtuelles Azure."
services: storage
documentationcenter: na
author: aungoo-msft
manager: tadb
editor: tysonn
ms.assetid: e6a409c3-d31a-4704-a93c-0a04fdc95960
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/27/2017
ms.author: aungoo
ms.openlocfilehash: 7bd38be9f8e1160ebf0d7c5ed51fd31d89481881
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/11/2017
---
# <a name="azure-premium-storage-design-for-high-performance"></a><span data-ttu-id="99f1c-104">Azure Premium Storage : conception sous le signe de la haute performance</span><span class="sxs-lookup"><span data-stu-id="99f1c-104">Azure Premium Storage: Design for High Performance</span></span>
## <a name="overview"></a><span data-ttu-id="99f1c-105">Vue d'ensemble</span><span class="sxs-lookup"><span data-stu-id="99f1c-105">Overview</span></span>
<span data-ttu-id="99f1c-106">Cet article fournit des instructions pour la création d’applications hautes performances avec Azure Premium Storage.</span><span class="sxs-lookup"><span data-stu-id="99f1c-106">This article provides guidelines for building high performance applications using Azure Premium Storage.</span></span> <span data-ttu-id="99f1c-107">Vous pouvez utiliser les instructions fournies dans ce document parallèlement aux bonnes pratiques de performances applicables aux technologies utilisées par votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-107">You can use the instructions provided in this document combined with performance best practices applicable to technologies used by your application.</span></span> <span data-ttu-id="99f1c-108">Pour illustrer les instructions, nous avons utilisé comme exemple un SQL Server exécuté sur Premium Storage.</span><span class="sxs-lookup"><span data-stu-id="99f1c-108">To illustrate the guidelines, we have used SQL Server running on Premium Storage as an example throughout this document.</span></span>

<span data-ttu-id="99f1c-109">Bien que cet article couvre plusieurs scénarios de performances au niveau de la couche de stockage, vous devrez optimiser la couche applicative.</span><span class="sxs-lookup"><span data-stu-id="99f1c-109">While we address performance scenarios for the Storage layer in this article, you will need to optimize the application layer.</span></span> <span data-ttu-id="99f1c-110">Par exemple, si vous hébergez une batterie de serveurs SharePoint sur Azure Premium Storage, vous pouvez utiliser les exemples SQL Server de cet article pour optimiser le serveur de base de données.</span><span class="sxs-lookup"><span data-stu-id="99f1c-110">For example, if you are hosting a SharePoint Farm on Azure Premium Storage, you can use the SQL Server examples from this article to optimize the database server.</span></span> <span data-ttu-id="99f1c-111">Vous devez également optimiser le serveur web et le serveur d’applications de la batterie de serveurs SharePoint pour obtenir de meilleures performances.</span><span class="sxs-lookup"><span data-stu-id="99f1c-111">Additionally, optimize the SharePoint Farm's Web server and Application server to get the most performance.</span></span>

<span data-ttu-id="99f1c-112">Cet article vous aidera à répondre à certaines questions courantes relatives à l’optimisation des performances applicatives sur Azure Premium Storage :</span><span class="sxs-lookup"><span data-stu-id="99f1c-112">This article will help answer following common questions about optimizing application performance on Azure Premium Storage,</span></span>

* <span data-ttu-id="99f1c-113">Comment mesurer les performances de votre application ?</span><span class="sxs-lookup"><span data-stu-id="99f1c-113">How to measure your application performance?</span></span>  
* <span data-ttu-id="99f1c-114">Pourquoi n’obtenez-vous pas les hautes performances attendues ?</span><span class="sxs-lookup"><span data-stu-id="99f1c-114">Why are you not seeing expected high performance?</span></span>  
* <span data-ttu-id="99f1c-115">Quels sont les facteurs qui influencent les performances de votre application sur Premium Storage ?</span><span class="sxs-lookup"><span data-stu-id="99f1c-115">Which factors influence your application performance on Premium Storage?</span></span>  
* <span data-ttu-id="99f1c-116">Comment ces facteurs influencent-ils les performances de votre application sur Premium Storage ?</span><span class="sxs-lookup"><span data-stu-id="99f1c-116">How do these factors influence performance of your application on Premium Storage?</span></span>  
* <span data-ttu-id="99f1c-117">Comment optimiser les performances d’E/S par seconde, de bande passante et de latence ?</span><span class="sxs-lookup"><span data-stu-id="99f1c-117">How can you optimize for IOPS, Bandwidth and Latency?</span></span>  

<span data-ttu-id="99f1c-118">Ces instructions vous sont spécifiquement fournies pour Premium Storage, car les charges de travail exécutées sur Premium Storage sont extrêmement sensibles aux performances.</span><span class="sxs-lookup"><span data-stu-id="99f1c-118">We have provided these guidelines specifically for Premium Storage because workloads running on Premium Storage are highly performance sensitive.</span></span> <span data-ttu-id="99f1c-119">Nous vous proposons des exemples lorsque cela s’y prête.</span><span class="sxs-lookup"><span data-stu-id="99f1c-119">We have provided examples where appropriate.</span></span> <span data-ttu-id="99f1c-120">Vous pouvez également appliquer certaines de ces instructions aux applications qui s’exécutent sur des machines virtuelles IaaS avec des disques de stockage Standard.</span><span class="sxs-lookup"><span data-stu-id="99f1c-120">You can also apply some of these guidelines to applications running on IaaS VMs with Standard Storage disks.</span></span>

<span data-ttu-id="99f1c-121">Avant de commencer, si vous ne connaissez pas le Stockage Premium, lisez tout d’abord les articles [Stockage Premium : stockage haute performance pour les charges de travail des machines virtuelles Azure](storage-premium-storage.md) et [Objectifs de performance et évolutivité du Stockage Azure](storage-scalability-targets.md).</span><span class="sxs-lookup"><span data-stu-id="99f1c-121">Before you begin, if you are new to Premium Storage, first read the [Premium Storage: High-Performance Storage for Azure Virtual Machine Workloads](storage-premium-storage.md) and [Azure Storage Scalability and Performance Targets](storage-scalability-targets.md) articles.</span></span>

## <a name="application-performance-indicators"></a><span data-ttu-id="99f1c-122">Indicateurs de performances d’une application</span><span class="sxs-lookup"><span data-stu-id="99f1c-122">Application Performance Indicators</span></span>
<span data-ttu-id="99f1c-123">Pour évaluer le degré de performances d’une application, nous nous appuyons sur divers indicateurs de performances, par exemple la vitesse à laquelle une application traite une demande utilisateur, la quantité de données qu’une application est capable de traiter pour chaque demande, le nombre de requêtes traitées par une application dans un intervalle donné, ou encore le temps d’attente que doit subir l’utilisateur avant d’obtenir une réponse à sa demande.</span><span class="sxs-lookup"><span data-stu-id="99f1c-123">We assess whether an application is performing well or not using performance indicators like, how fast an application is processing a user request, how much data an application is processing per request, how many requests is an application processing in a specific period of time, how long a user has to wait to get a response after submitting their request.</span></span> <span data-ttu-id="99f1c-124">Sur le plan technique, ces indicateurs de performances s’expriment en termes d’E/S par seconde, de débit (ou bande passante) et de latence.</span><span class="sxs-lookup"><span data-stu-id="99f1c-124">The technical terms for these performance indicators are, IOPS, Throughput or Bandwidth, and Latency.</span></span>

<span data-ttu-id="99f1c-125">Dans cette section, nous allons aborder les indicateurs de performances courants dans le contexte de Premium Storage.</span><span class="sxs-lookup"><span data-stu-id="99f1c-125">In this section, we will discuss the common performance indicators in the context of Premium Storage.</span></span> <span data-ttu-id="99f1c-126">Dans la section suivante, intitulée « Collecte des exigences de performances de l’application », vous apprendrez à mesurer ces indicateurs de performances pour votre propre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-126">In the following section, Gathering Application Requirements, you will learn how to measure these performance indicators for your application.</span></span> <span data-ttu-id="99f1c-127">Dans la section consacrée à l’optimisation des performances applicatives, vous découvrirez les facteurs qui affectent ces indicateurs de performances et obtiendrez des recommandations afin de les optimiser.</span><span class="sxs-lookup"><span data-stu-id="99f1c-127">Later in Optimizing Application Performance, you will learn about the factors affecting these performance indicators and recommendations to optimize them.</span></span>

## <a name="iops"></a><span data-ttu-id="99f1c-128">E/S par seconde</span><span class="sxs-lookup"><span data-stu-id="99f1c-128">IOPS</span></span>
<span data-ttu-id="99f1c-129">Le nombre d’E/S par seconde représente le nombre de demandes que votre application envoie aux disques de stockage en une seconde.</span><span class="sxs-lookup"><span data-stu-id="99f1c-129">IOPS is number of requests that your application is sending to the storage disks in one second.</span></span> <span data-ttu-id="99f1c-130">Une opération d’entrée/sortie peut être accessible en lecture ou écriture, et être séquentielle ou aléatoire.</span><span class="sxs-lookup"><span data-stu-id="99f1c-130">An input/output operation could be read or write, sequential or random.</span></span> <span data-ttu-id="99f1c-131">Les applications OLTP (un site web de vente en ligne, par exemple) doivent traiter immédiatement de nombreuses requêtes d’utilisateurs simultanées.</span><span class="sxs-lookup"><span data-stu-id="99f1c-131">OLTP applications like an online retail website need to process many concurrent user requests immediately.</span></span> <span data-ttu-id="99f1c-132">Les requêtes utilisateurs représentent des transactions d’insertion et de mise à jour qui pèsent lourdement sur la base de données, et que l’application doit traiter rapidement.</span><span class="sxs-lookup"><span data-stu-id="99f1c-132">The user requests are insert and update intensive database transactions, which the application must process quickly.</span></span> <span data-ttu-id="99f1c-133">Les applications OLTP requièrent dont un nombre d’E/S par seconde très élevé.</span><span class="sxs-lookup"><span data-stu-id="99f1c-133">Therefore, OLTP applications require very high IOPS.</span></span> <span data-ttu-id="99f1c-134">Ces applications gèrent des millions de demandes d’E/S petites et aléatoires.</span><span class="sxs-lookup"><span data-stu-id="99f1c-134">Such applications handle millions of small and random IO requests.</span></span> <span data-ttu-id="99f1c-135">Si vous possédez une telle application, vous devez concevoir votre infrastructure applicative de manière à optimiser les E/S.</span><span class="sxs-lookup"><span data-stu-id="99f1c-135">If you have such an application, you must design the application infrastructure to optimize for IOPS.</span></span> <span data-ttu-id="99f1c-136">Dans la section *Optimisation des performances applicatives*, nous aborderons en détail tous les facteurs que vous devez prendre en compte pour obtenir un nombre d’E/S par seconde élevé.</span><span class="sxs-lookup"><span data-stu-id="99f1c-136">In the later section, *Optimizing Application Performance*, we discuss in detail all the factors that you must consider to get high IOPS.</span></span>

<span data-ttu-id="99f1c-137">Lorsque vous attachez un disque de stockage Premium à votre machine virtuelle à grande échelle, Azure met à disposition un nombre garanti d’E/S par seconde, conformément à la spécification de disque.</span><span class="sxs-lookup"><span data-stu-id="99f1c-137">When you attach a premium storage disk to your high scale VM, Azure provisions for you a guaranteed number of IOPS as per the disk specification.</span></span> <span data-ttu-id="99f1c-138">Par exemple, un disque P50 configure 7500 E/S par seconde.</span><span class="sxs-lookup"><span data-stu-id="99f1c-138">For example, a P50 disk provisions 7500 IOPS.</span></span> <span data-ttu-id="99f1c-139">Chaque taille de machine virtuelle à grande échelle est également associée à une limite spécifique d’E/S par seconde qu’elle peut prendre en charge.</span><span class="sxs-lookup"><span data-stu-id="99f1c-139">Each high scale VM size also has a specific IOPS limit that it can sustain.</span></span> <span data-ttu-id="99f1c-140">Par exemple, une machine virtuelle GS5 Standard a une limite de 80 000 E/S par seconde.</span><span class="sxs-lookup"><span data-stu-id="99f1c-140">For example, a Standard GS5 VM has 80,000 IOPS limit.</span></span>

## <a name="throughput"></a><span data-ttu-id="99f1c-141">Débit</span><span class="sxs-lookup"><span data-stu-id="99f1c-141">Throughput</span></span>
<span data-ttu-id="99f1c-142">Le débit ou la bande passante est la quantité de données que votre application envoie aux disques de stockage dans un intervalle spécifié.</span><span class="sxs-lookup"><span data-stu-id="99f1c-142">Throughput or Bandwidth is the amount of data that your application is sending to the storage disks in a specified interval.</span></span> <span data-ttu-id="99f1c-143">Si votre application effectue des opérations d’entrée/sortie avec des tailles d’unité d’E/S importantes, elle aura besoin d’un débit élevé.</span><span class="sxs-lookup"><span data-stu-id="99f1c-143">If your application is performing input/output operations with large IO unit sizes, it requires high Throughput.</span></span> <span data-ttu-id="99f1c-144">Les applications d’entrepôt de données ont tendance à émettre des opérations d’analyse intensives qui accèdent simultanément à de grandes quantités de données et exécutent généralement des opérations en bloc.</span><span class="sxs-lookup"><span data-stu-id="99f1c-144">Data warehouse applications tend to issue scan intensive operations that access large portions of data at a time and commonly perform bulk operations.</span></span> <span data-ttu-id="99f1c-145">En d’autres termes, ces applications nécessitent un débit plus élevé.</span><span class="sxs-lookup"><span data-stu-id="99f1c-145">In other words, such applications require higher Throughput.</span></span> <span data-ttu-id="99f1c-146">Si vous possédez une telle application, vous devez concevoir votre infrastructure de manière à en optimiser le débit.</span><span class="sxs-lookup"><span data-stu-id="99f1c-146">If you have such an application, you must design its infrastructure to optimize for Throughput.</span></span> <span data-ttu-id="99f1c-147">Dans la section suivante, nous décrirons en détail les facteurs que vous devrez ajuster pour y parvenir.</span><span class="sxs-lookup"><span data-stu-id="99f1c-147">In the next section, we discuss in detail the factors you must tune to achieve this.</span></span>

<span data-ttu-id="99f1c-148">Lorsque vous attachez un disque de stockage premium à une machine virtuelle à grande échelle, Azure met à disposition un débit conforme à la spécification de ce disque.</span><span class="sxs-lookup"><span data-stu-id="99f1c-148">When you attach a premium storage disk to a high scale VM, Azure provisions Throughput as per that disk specification.</span></span> <span data-ttu-id="99f1c-149">Par exemple, un disque P50 configure un débit de disque de 250 Mo par seconde.</span><span class="sxs-lookup"><span data-stu-id="99f1c-149">For example, a P50 disk provisions 250 MB per second disk Throughput.</span></span> <span data-ttu-id="99f1c-150">Chaque taille de machine virtuelle à grande échelle est également associée à une limite spécifique de débit qu’elle peut prendre en charge.</span><span class="sxs-lookup"><span data-stu-id="99f1c-150">Each high scale VM size also has as specific Throughput limit that it can sustain.</span></span> <span data-ttu-id="99f1c-151">Par exemple, une machine virtuelle GS5 Standard a un débit maximal de 2 000 Mo par seconde.</span><span class="sxs-lookup"><span data-stu-id="99f1c-151">For example, Standard GS5 VM has a maximum throughput of 2,000 MB per second.</span></span> 

<span data-ttu-id="99f1c-152">La formule ci-dessous illustre la relation entre le débit et le nombre d’E/S par seconde.</span><span class="sxs-lookup"><span data-stu-id="99f1c-152">There is a relation between Throughput and IOPS as shown in the formula below.</span></span>

![](media/storage-premium-storage-performance/image1.png)

<span data-ttu-id="99f1c-153">Par conséquent, il est important de déterminer les valeurs optimales de débit et d’E/S par seconde dont a besoin votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-153">Therefore, it is important to determine the optimal Throughput and IOPS values that your application requires.</span></span> <span data-ttu-id="99f1c-154">Lorsque vous essayez d’optimiser une de ces valeurs, l’autre est également affectée.</span><span class="sxs-lookup"><span data-stu-id="99f1c-154">As you try to optimize one, the other also gets affected.</span></span> <span data-ttu-id="99f1c-155">Dans la section *Optimisation des performances applicatives*, nous aborderons plus en détail la question de l’optimisation des E/S par seconde et du débit.</span><span class="sxs-lookup"><span data-stu-id="99f1c-155">In a later section, *Optimizing Application Performance*, we will discuss in more details about optimizing IOPS and Throughput.</span></span>

## <a name="latency"></a><span data-ttu-id="99f1c-156">Latence</span><span class="sxs-lookup"><span data-stu-id="99f1c-156">Latency</span></span>
<span data-ttu-id="99f1c-157">La latence est le temps nécessaire à une application pour recevoir une demande unique, l’envoyer aux disques de stockage et transmettre la réponse au client.</span><span class="sxs-lookup"><span data-stu-id="99f1c-157">Latency is the time it takes an application to receive a single request, send it to the storage disks and send the response to the client.</span></span> <span data-ttu-id="99f1c-158">Il s’agit d’une mesure critique des performances d’une application, qui s’ajoute à celle des E/S par seconde et du débit.</span><span class="sxs-lookup"><span data-stu-id="99f1c-158">This is a critical measure of an application's performance in addition to IOPS and Throughput.</span></span> <span data-ttu-id="99f1c-159">La latence d’un disque de stockage premium correspond au temps nécessaire pour récupérer les informations d’une demande et les retourner à votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-159">The Latency of a premium storage disk is the time it takes to retrieve the information for a request and communicate it back to your application.</span></span> <span data-ttu-id="99f1c-160">Premium Storage offre de faibles latences.</span><span class="sxs-lookup"><span data-stu-id="99f1c-160">Premium Storage provides consistent low latencies.</span></span> <span data-ttu-id="99f1c-161">Si vous activez une mise en cache de l’hôte en lecture seule sur des disques de stockage premium, vous pourrez obtenir une latence de lecture bien plus faible.</span><span class="sxs-lookup"><span data-stu-id="99f1c-161">If you enable ReadOnly host caching on premium storage disks, you can get much lower read latency.</span></span> <span data-ttu-id="99f1c-162">Nous aborderons la mise en cache du disque plus en détail dans la section *Optimisation des performances applicatives*.</span><span class="sxs-lookup"><span data-stu-id="99f1c-162">We will discuss Disk Caching in more detail in later section on *Optimizing Application Performance*.</span></span>

<span data-ttu-id="99f1c-163">Lorsque vous optimisez votre application pour augmenter le nombre d’E/S par seconde et le débit, la latence de votre application s’en trouve affectée.</span><span class="sxs-lookup"><span data-stu-id="99f1c-163">When you are optimizing your application to get higher IOPS and Throughput, it will affect the Latency of your application.</span></span> <span data-ttu-id="99f1c-164">Après avoir ajusté les performances de votre application, pensez toujours à évaluer la latence de l’application afin d’éviter un comportement de latence élevée inattendu.</span><span class="sxs-lookup"><span data-stu-id="99f1c-164">After tuning the application performance, always evaluate the Latency of the application to avoid unexpected high latency behavior.</span></span>

## <a name="gather-application-performance-requirements"></a><span data-ttu-id="99f1c-165">Collecte des exigences de performances de l’application</span><span class="sxs-lookup"><span data-stu-id="99f1c-165">Gather Application Performance Requirements</span></span>
<span data-ttu-id="99f1c-166">La première étape de la conception d’applications hautes performances exécutées sur Azure Premium Storage consiste à comprendre les exigences de performances de votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-166">The first step in designing high performance applications running on Azure Premium Storage is, to understand the performance requirements of your application.</span></span> <span data-ttu-id="99f1c-167">Après avoir recueilli ces exigences de performances, vous pourrez optimiser votre application de manière à obtenir les meilleures performances possibles.</span><span class="sxs-lookup"><span data-stu-id="99f1c-167">After you gather performance requirements, you can optimize your application to achieve the most optimal performance.</span></span>

<span data-ttu-id="99f1c-168">Dans la section précédente, nous avons expliqué les indicateurs de performances courants, à savoir le nombre d’E/S par seconde, le débit et la latence.</span><span class="sxs-lookup"><span data-stu-id="99f1c-168">In the previous section, we explained the common performance indicators, IOPS, Throughput and Latency.</span></span> <span data-ttu-id="99f1c-169">Vous devez déterminer, parmi ces indicateurs de performances, lesquels sont essentiels à votre application pour fournir l’expérience utilisateur recherchée.</span><span class="sxs-lookup"><span data-stu-id="99f1c-169">You must identify which of these performance indicators are critical to your application to deliver the desired user experience.</span></span> <span data-ttu-id="99f1c-170">Par exemple, un nombre d’E/S par seconde élevé est plus important pour les applications OLTP qui traitent des millions de transactions en une seconde.</span><span class="sxs-lookup"><span data-stu-id="99f1c-170">For example, high IOPS matters most to OLTP applications processing millions of transactions in a second.</span></span> <span data-ttu-id="99f1c-171">En revanche, un débit élevé sera plus pertinent pour les applications d’entrepôt de données qui traitent de grandes quantités de données en une seconde.</span><span class="sxs-lookup"><span data-stu-id="99f1c-171">Whereas, high Throughput is critical for Data Warehouse applications processing large amounts of data in a second.</span></span> <span data-ttu-id="99f1c-172">De même, une très faible latence sera cruciale pour les applications en temps réel, telles que les sites web de diffusion en continu de vidéo en direct.</span><span class="sxs-lookup"><span data-stu-id="99f1c-172">Extremely low Latency is crucial for real-time applications like live video streaming websites.</span></span>

<span data-ttu-id="99f1c-173">Ensuite, vous devrez mesurer les exigences de performances maximales de votre application tout au long de sa durée de vie.</span><span class="sxs-lookup"><span data-stu-id="99f1c-173">Next, measure the maximum performance requirements of your application throughout its lifetime.</span></span> <span data-ttu-id="99f1c-174">Utilisez l’exemple de liste de contrôle ci-dessous comme point de départ.</span><span class="sxs-lookup"><span data-stu-id="99f1c-174">Use the sample checklist below as a start.</span></span> <span data-ttu-id="99f1c-175">Notez les exigences de performances maximales relevées au cours des périodes de charge de travail normales, des périodes de pointe et des heures creuses.</span><span class="sxs-lookup"><span data-stu-id="99f1c-175">Record the maximum performance requirements during normal, peak and off-hours workload periods.</span></span> <span data-ttu-id="99f1c-176">En identifiant les conditions requises pour tous les niveaux de charges de travail, vous serez en mesure de déterminer les exigences de performances globales de votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-176">By identifying requirements for all workloads levels, you will be able to determine the overall performance requirement of your application.</span></span> <span data-ttu-id="99f1c-177">Par exemple, la charge de travail normale d’un site web de commerce électronique correspond aux transactions habituellement traitées au quotidien au cours d’une année.</span><span class="sxs-lookup"><span data-stu-id="99f1c-177">For example, the normal workload of an e-commerce website will be the transactions it serves during most days in a year.</span></span> <span data-ttu-id="99f1c-178">Les pics de charge du site web correspondront aux transactions traitées pendant la période de Noël ou les périodes de soldes.</span><span class="sxs-lookup"><span data-stu-id="99f1c-178">The peak workload of the website will be the transactions it serves during holiday season or special sale events.</span></span> <span data-ttu-id="99f1c-179">Les pics de charge ne durent généralement que pendant un temps limité, mais ils peuvent vous obliger à mettre à l’échelle votre application en multipliant au moins par deux sa capacité par rapport à son fonctionnement normal.</span><span class="sxs-lookup"><span data-stu-id="99f1c-179">The peak workload is typically experienced for a limited period, but can require your application to scale two or more times its normal operation.</span></span> <span data-ttu-id="99f1c-180">Déterminez les besoins au 50e percentile, au 90e percentile et au 99e percentile.</span><span class="sxs-lookup"><span data-stu-id="99f1c-180">Find out the 50 percentile, 90 percentile and 99 percentile requirements.</span></span> <span data-ttu-id="99f1c-181">Cela vous permettra d’éliminer les observations aberrantes en termes d’exigences de performances et de concentrer vos efforts sur l’optimisation des valeurs adéquates.</span><span class="sxs-lookup"><span data-stu-id="99f1c-181">This helps filter out any outliers in the performance requirements and you can focus your efforts on optimizing for the right values.</span></span>

<span data-ttu-id="99f1c-182">**Liste de contrôle pour les exigences de performances de l’application**</span><span class="sxs-lookup"><span data-stu-id="99f1c-182">**Application Performance Requirements Checklist**</span></span>

| <span data-ttu-id="99f1c-183">**Exigences de performances**</span><span class="sxs-lookup"><span data-stu-id="99f1c-183">**Performance requirements**</span></span> | <span data-ttu-id="99f1c-184">**50e percentile**</span><span class="sxs-lookup"><span data-stu-id="99f1c-184">**50 Percentile**</span></span> | <span data-ttu-id="99f1c-185">**90e percentile**</span><span class="sxs-lookup"><span data-stu-id="99f1c-185">**90 Percentile**</span></span> | <span data-ttu-id="99f1c-186">**99e percentile**</span><span class="sxs-lookup"><span data-stu-id="99f1c-186">**99  Percentile**</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="99f1c-187">Bande passante</span><span class="sxs-lookup"><span data-stu-id="99f1c-187">Max.</span></span> <span data-ttu-id="99f1c-188">Transactions par seconde</span><span class="sxs-lookup"><span data-stu-id="99f1c-188">Transactions per second</span></span> | | | |
| <span data-ttu-id="99f1c-189">% d’opérations de lecture</span><span class="sxs-lookup"><span data-stu-id="99f1c-189">% Read operations</span></span> | | | |
| <span data-ttu-id="99f1c-190">% d’opérations d’écriture</span><span class="sxs-lookup"><span data-stu-id="99f1c-190">% Write operations</span></span> | | | |
| <span data-ttu-id="99f1c-191">% d’opérations aléatoires</span><span class="sxs-lookup"><span data-stu-id="99f1c-191">% Random operations</span></span> | | | |
| <span data-ttu-id="99f1c-192">% d’opérations séquentielles</span><span class="sxs-lookup"><span data-stu-id="99f1c-192">% Sequential operations</span></span> | | | |
| <span data-ttu-id="99f1c-193">Taille de la demande d’E/S</span><span class="sxs-lookup"><span data-stu-id="99f1c-193">IO request size</span></span> | | | |
| <span data-ttu-id="99f1c-194">Débit moyen</span><span class="sxs-lookup"><span data-stu-id="99f1c-194">Average Throughput</span></span> | | | |
| <span data-ttu-id="99f1c-195">Bande passante</span><span class="sxs-lookup"><span data-stu-id="99f1c-195">Max.</span></span> <span data-ttu-id="99f1c-196">Débit</span><span class="sxs-lookup"><span data-stu-id="99f1c-196">Throughput</span></span> | | | |
| <span data-ttu-id="99f1c-197">min.</span><span class="sxs-lookup"><span data-stu-id="99f1c-197">Min.</span></span> <span data-ttu-id="99f1c-198">Latence</span><span class="sxs-lookup"><span data-stu-id="99f1c-198">Latency</span></span> | | | |
| <span data-ttu-id="99f1c-199">Latence moyenne</span><span class="sxs-lookup"><span data-stu-id="99f1c-199">Average Latency</span></span> | | | |
| <span data-ttu-id="99f1c-200">Bande passante</span><span class="sxs-lookup"><span data-stu-id="99f1c-200">Max.</span></span> <span data-ttu-id="99f1c-201">UC</span><span class="sxs-lookup"><span data-stu-id="99f1c-201">CPU</span></span> | | | |
| <span data-ttu-id="99f1c-202">Utilisation moyenne de l’UC</span><span class="sxs-lookup"><span data-stu-id="99f1c-202">Average CPU</span></span> | | | |
| <span data-ttu-id="99f1c-203">Bande passante</span><span class="sxs-lookup"><span data-stu-id="99f1c-203">Max.</span></span> <span data-ttu-id="99f1c-204">Mémoire</span><span class="sxs-lookup"><span data-stu-id="99f1c-204">Memory</span></span> | | | |
| <span data-ttu-id="99f1c-205">Utilisation moyenne de la mémoire</span><span class="sxs-lookup"><span data-stu-id="99f1c-205">Average Memory</span></span> | | | |
| <span data-ttu-id="99f1c-206">Profondeur de file d’attente</span><span class="sxs-lookup"><span data-stu-id="99f1c-206">Queue Depth</span></span> | | | |

> [!NOTE]
> <span data-ttu-id="99f1c-207">vous devez anticiper la mise à l’échelle de ces nombres en fonction de la croissance prévue de votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-207">You should consider scaling these numbers based on expected future growth of your application.</span></span> <span data-ttu-id="99f1c-208">Il est judicieux de planifier la croissance, car il pourrait être plus difficile de modifier l’infrastructure ultérieurement afin d’en améliorer les performances.</span><span class="sxs-lookup"><span data-stu-id="99f1c-208">It is a good idea to plan for growth ahead of time, because it could be harder to change the infrastructure for improving performance later.</span></span>
>
>

<span data-ttu-id="99f1c-209">Si vous possédez une application existante et que vous souhaitez migrer vers Premium Storage, commencez par compléter la liste de contrôle ci-dessus pour l’application existante.</span><span class="sxs-lookup"><span data-stu-id="99f1c-209">If you have an existing application and want to move to Premium Storage, first build the checklist above for the existing application.</span></span> <span data-ttu-id="99f1c-210">Développez ensuite un prototype de votre application sur Premium Storage et concevez l’application selon les instructions décrites dans la section *Optimisation des performances applicatives* dans la suite de ce document.</span><span class="sxs-lookup"><span data-stu-id="99f1c-210">Then, build a prototype of your application on Premium Storage and design the application based on guidelines described in *Optimizing Application Performance* in a later section of this document.</span></span> <span data-ttu-id="99f1c-211">La section suivante décrit les outils que vous pouvez utiliser pour collecter les mesures de performances.</span><span class="sxs-lookup"><span data-stu-id="99f1c-211">The next section describes the tools you can use to gather the performance measurements.</span></span>

<span data-ttu-id="99f1c-212">Créez une liste de contrôle semblable à votre application prototype existante.</span><span class="sxs-lookup"><span data-stu-id="99f1c-212">Create a checklist similar to your existing application for the prototype.</span></span> <span data-ttu-id="99f1c-213">À l’aide des outils de benchmarking, vous pouvez simuler les charges de travail et mesurer les performances de l’application prototype.</span><span class="sxs-lookup"><span data-stu-id="99f1c-213">Using Benchmarking tools you can simulate the workloads and measure performance on the prototype application.</span></span> <span data-ttu-id="99f1c-214">Consultez la section [Benchmarking](#benchmarking) pour en savoir plus.</span><span class="sxs-lookup"><span data-stu-id="99f1c-214">See the section on [Benchmarking](#benchmarking) to learn more.</span></span> <span data-ttu-id="99f1c-215">En procédant ainsi, vous pouvez déterminer si Premium Storage peut satisfaire ou dépasser les exigences de performances de votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-215">By doing so you can determine whether Premium Storage can match or surpass your application performance requirements.</span></span> <span data-ttu-id="99f1c-216">Vous pouvez ensuite implémenter les mêmes règles pour votre application de production.</span><span class="sxs-lookup"><span data-stu-id="99f1c-216">Then you can implement the same guidelines for your production application.</span></span>

### <a name="counters-to-measure-application-performance-requirements"></a><span data-ttu-id="99f1c-217">Compteurs de mesure des exigences de performances de l’application</span><span class="sxs-lookup"><span data-stu-id="99f1c-217">Counters to measure application performance requirements</span></span>
<span data-ttu-id="99f1c-218">La meilleure façon de mesurer les exigences de performances de votre application consiste à utiliser les outils d’analyse des performances fournies par le système d’exploitation du serveur.</span><span class="sxs-lookup"><span data-stu-id="99f1c-218">The best way to measure performance requirements of your application, is to use performance-monitoring tools provided by the operating system of the server.</span></span> <span data-ttu-id="99f1c-219">Vous pouvez utiliser PerfMon pour Windows et iostat pour Linux.</span><span class="sxs-lookup"><span data-stu-id="99f1c-219">You can use PerfMon for Windows and iostat for Linux.</span></span> <span data-ttu-id="99f1c-220">Ces outils capturent des compteurs correspondant à chaque mesure expliquée dans la section ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="99f1c-220">These tools capture counters corresponding to each measure explained in the above section.</span></span> <span data-ttu-id="99f1c-221">Vous devez capturer les valeurs de ces compteurs lorsque votre application exécute ses charges de travail normales, de pointe et d’heures creuses.</span><span class="sxs-lookup"><span data-stu-id="99f1c-221">You must capture the values of these counters when your application is running its normal, peak and off-hours workloads.</span></span>

<span data-ttu-id="99f1c-222">Les compteurs PerfMon sont disponibles pour le processeur, pour la mémoire et pour chaque disque logique et chaque disque physique de votre serveur.</span><span class="sxs-lookup"><span data-stu-id="99f1c-222">The PerfMon counters are available for processor, memory and, each logical disk and physical disk of your server.</span></span> <span data-ttu-id="99f1c-223">Lorsque vous utilisez les disques de stockage premium avec une machine virtuelle, les compteurs de disque physique s’appliquent à chaque disque de stockage premium et les compteurs de disque logique à chaque volume créé sur les disques de stockage premium.</span><span class="sxs-lookup"><span data-stu-id="99f1c-223">When you use premium storage disks with a VM, the physical disk counters are for each premium storage disk, and logical disk counters are for each volume created on the premium storage disks.</span></span> <span data-ttu-id="99f1c-224">Vous devez capturer les valeurs des disques qui hébergent la charge de travail de votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-224">You must capture the values for the disks that host your application workload.</span></span> <span data-ttu-id="99f1c-225">S’il existe un mappage un-à-un entre les disques physiques et logiques, vous pouvez consulter les compteurs de disque physique ; sinon, référez-vous aux compteurs de disque logique.</span><span class="sxs-lookup"><span data-stu-id="99f1c-225">If there is a one to one mapping between logical and physical disks, you can refer to physical disk counters; otherwise refer to the logical disk counters.</span></span> <span data-ttu-id="99f1c-226">Sous Linux, la commande iostat génère un rapport d’utilisation du processeur et du disque.</span><span class="sxs-lookup"><span data-stu-id="99f1c-226">On Linux, the iostat command generates a CPU and disk utilization report.</span></span> <span data-ttu-id="99f1c-227">Le rapport d’utilisation du disque fournit des statistiques par unité physique ou par partition.</span><span class="sxs-lookup"><span data-stu-id="99f1c-227">The disk utilization report provides statistics per physical device or partition.</span></span> <span data-ttu-id="99f1c-228">Si vous avez un serveur de base de données dont les données et les journaux résident sur des disques distincts, récupérez ces données pour les deux disques.</span><span class="sxs-lookup"><span data-stu-id="99f1c-228">If you have a database server with its data and log on separate disks, collect this data for both disks.</span></span> <span data-ttu-id="99f1c-229">Le tableau ci-dessous décrit les compteurs de disques, de processeur et de mémoire :</span><span class="sxs-lookup"><span data-stu-id="99f1c-229">Below table describes counters for disks, processor and memory:</span></span>

| <span data-ttu-id="99f1c-230">Compteur</span><span class="sxs-lookup"><span data-stu-id="99f1c-230">Counter</span></span> | <span data-ttu-id="99f1c-231">Description</span><span class="sxs-lookup"><span data-stu-id="99f1c-231">Description</span></span> | <span data-ttu-id="99f1c-232">PerfMon</span><span class="sxs-lookup"><span data-stu-id="99f1c-232">PerfMon</span></span> | <span data-ttu-id="99f1c-233">Iostat</span><span class="sxs-lookup"><span data-stu-id="99f1c-233">Iostat</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="99f1c-234">**Nombre d’E/S par seconde ou de transactions par seconde**</span><span class="sxs-lookup"><span data-stu-id="99f1c-234">**IOPS or Transactions per second**</span></span> |<span data-ttu-id="99f1c-235">Nombre de demandes d’E/S émises sur le disque de stockage par seconde.</span><span class="sxs-lookup"><span data-stu-id="99f1c-235">Number of I/O requests issued to the storage disk per second.</span></span> |<span data-ttu-id="99f1c-236">Nb d’opérations de lectures de disque/s </span><span class="sxs-lookup"><span data-stu-id="99f1c-236">Disk Reads/sec</span></span> <br> <span data-ttu-id="99f1c-237">Nb d’opération d’écriture de disque/s</span><span class="sxs-lookup"><span data-stu-id="99f1c-237">Disk Writes/sec</span></span> |<span data-ttu-id="99f1c-238">tps </span><span class="sxs-lookup"><span data-stu-id="99f1c-238">tps</span></span> <br> <span data-ttu-id="99f1c-239">r/s </span><span class="sxs-lookup"><span data-stu-id="99f1c-239">r/s</span></span> <br> <span data-ttu-id="99f1c-240">w/s</span><span class="sxs-lookup"><span data-stu-id="99f1c-240">w/s</span></span> |
| <span data-ttu-id="99f1c-241">**Opérations de lecture et d’écriture de disque**</span><span class="sxs-lookup"><span data-stu-id="99f1c-241">**Disk Reads and Writes**</span></span> |<span data-ttu-id="99f1c-242">% d’opérations de lecture et d’écriture exécutées sur le disque.</span><span class="sxs-lookup"><span data-stu-id="99f1c-242">% of Reads and Write operations performed on the disk.</span></span> |<span data-ttu-id="99f1c-243">% temps de lecture du disque </span><span class="sxs-lookup"><span data-stu-id="99f1c-243">% Disk Read Time</span></span> <br> <span data-ttu-id="99f1c-244">% temps d’écriture du disque</span><span class="sxs-lookup"><span data-stu-id="99f1c-244">% Disk Write Time</span></span> |<span data-ttu-id="99f1c-245">r/s </span><span class="sxs-lookup"><span data-stu-id="99f1c-245">r/s</span></span> <br> <span data-ttu-id="99f1c-246">w/s</span><span class="sxs-lookup"><span data-stu-id="99f1c-246">w/s</span></span> |
| <span data-ttu-id="99f1c-247">**Débit**</span><span class="sxs-lookup"><span data-stu-id="99f1c-247">**Throughput**</span></span> |<span data-ttu-id="99f1c-248">Quantité de données lues ou écrites sur le disque par seconde.</span><span class="sxs-lookup"><span data-stu-id="99f1c-248">Amount of data read from or written to the disk per second.</span></span> |<span data-ttu-id="99f1c-249">Nb d’octets de lecture de disque/s </span><span class="sxs-lookup"><span data-stu-id="99f1c-249">Disk Read Bytes/sec</span></span> <br> <span data-ttu-id="99f1c-250">Nb d’octets d’écriture de disque/s</span><span class="sxs-lookup"><span data-stu-id="99f1c-250">Disk Write Bytes/sec</span></span> |<span data-ttu-id="99f1c-251">kB_read/s</span><span class="sxs-lookup"><span data-stu-id="99f1c-251">kB_read/s</span></span> <br> <span data-ttu-id="99f1c-252">kB_wrtn/s</span><span class="sxs-lookup"><span data-stu-id="99f1c-252">kB_wrtn/s</span></span> |
| <span data-ttu-id="99f1c-253">**Latence**</span><span class="sxs-lookup"><span data-stu-id="99f1c-253">**Latency**</span></span> |<span data-ttu-id="99f1c-254">Durée totale d’exécution d’une demande d’E/S sur le disque.</span><span class="sxs-lookup"><span data-stu-id="99f1c-254">Total time to complete a disk IO request.</span></span> |<span data-ttu-id="99f1c-255">Temps de lecture moyen du disque/s </span><span class="sxs-lookup"><span data-stu-id="99f1c-255">Average Disk sec/Read</span></span> <br> <span data-ttu-id="99f1c-256">Temps d’écriture moyen du disque/s</span><span class="sxs-lookup"><span data-stu-id="99f1c-256">Average disk sec/Write</span></span> |<span data-ttu-id="99f1c-257">await </span><span class="sxs-lookup"><span data-stu-id="99f1c-257">await</span></span> <br> <span data-ttu-id="99f1c-258">svctm</span><span class="sxs-lookup"><span data-stu-id="99f1c-258">svctm</span></span> |
| <span data-ttu-id="99f1c-259">**Taille d’E/S**</span><span class="sxs-lookup"><span data-stu-id="99f1c-259">**IO size**</span></span> |<span data-ttu-id="99f1c-260">La taille des demandes d’E/S émises sur les disques de stockage.</span><span class="sxs-lookup"><span data-stu-id="99f1c-260">The size of I/O requests issues to the storage disks.</span></span> |<span data-ttu-id="99f1c-261">Nb moyen d’octets en lecture du disque </span><span class="sxs-lookup"><span data-stu-id="99f1c-261">Average Disk Bytes/Read</span></span> <br> <span data-ttu-id="99f1c-262">Nb moyen d’octets en écriture du disque</span><span class="sxs-lookup"><span data-stu-id="99f1c-262">Average Disk Bytes/Write</span></span> |<span data-ttu-id="99f1c-263">avgrq-sz</span><span class="sxs-lookup"><span data-stu-id="99f1c-263">avgrq-sz</span></span> |
| <span data-ttu-id="99f1c-264">**Profondeur de file d’attente**</span><span class="sxs-lookup"><span data-stu-id="99f1c-264">**Queue Depth**</span></span> |<span data-ttu-id="99f1c-265">Nombre de demandes d’E/S en attente de lecture ou d’écriture sur le disque de stockage.</span><span class="sxs-lookup"><span data-stu-id="99f1c-265">Number of outstanding I/O requests waiting to be read form or written to the storage disk.</span></span> |<span data-ttu-id="99f1c-266">Longueur de file d’attente actuelle du disque</span><span class="sxs-lookup"><span data-stu-id="99f1c-266">Current Disk Queue Length</span></span> |<span data-ttu-id="99f1c-267">avgqu-sz</span><span class="sxs-lookup"><span data-stu-id="99f1c-267">avgqu-sz</span></span> |
| <span data-ttu-id="99f1c-268">**IOPS Mémoire**</span><span class="sxs-lookup"><span data-stu-id="99f1c-268">**Max. Memory**</span></span> |<span data-ttu-id="99f1c-269">Quantité de mémoire nécessaire pour une exécution fluide de l’application</span><span class="sxs-lookup"><span data-stu-id="99f1c-269">Amount of memory required to run application smoothly</span></span> |<span data-ttu-id="99f1c-270">% d’octets dédiés utilisés</span><span class="sxs-lookup"><span data-stu-id="99f1c-270">% Committed Bytes in Use</span></span> |<span data-ttu-id="99f1c-271">Use vmstat</span><span class="sxs-lookup"><span data-stu-id="99f1c-271">Use vmstat</span></span> |
| <span data-ttu-id="99f1c-272">**Bande passante UC**</span><span class="sxs-lookup"><span data-stu-id="99f1c-272">**Max. CPU**</span></span> |<span data-ttu-id="99f1c-273">Quantité d’UC nécessaire pour une application fluide de l’application</span><span class="sxs-lookup"><span data-stu-id="99f1c-273">Amount CPU required to run application smoothly</span></span> |<span data-ttu-id="99f1c-274">% temps processeur</span><span class="sxs-lookup"><span data-stu-id="99f1c-274">% Processor time</span></span> |<span data-ttu-id="99f1c-275">%util</span><span class="sxs-lookup"><span data-stu-id="99f1c-275">%util</span></span> |

<span data-ttu-id="99f1c-276">En savoir plus sur [iostat](http://linuxcommand.org/man_pages/iostat1.html) et [PerfMon](https://msdn.microsoft.com/library/aa645516.aspx).</span><span class="sxs-lookup"><span data-stu-id="99f1c-276">Learn more about [iostat](http://linuxcommand.org/man_pages/iostat1.html) and [PerfMon](https://msdn.microsoft.com/library/aa645516.aspx).</span></span>

## <a name="optimizing-application-performance"></a><span data-ttu-id="99f1c-277">Optimisation des performances applicatives</span><span class="sxs-lookup"><span data-stu-id="99f1c-277">Optimizing Application Performance</span></span>
<span data-ttu-id="99f1c-278">La nature des demandes d’E/S, la taille de machine virtuelle, la taille de disque, le nombre de disques, la mise en cache du disque, le traitement multithread et la profondeur de file d’attente représentent les principaux facteurs qui influencent les performances d’une application exécutée sur Premium Storage.</span><span class="sxs-lookup"><span data-stu-id="99f1c-278">The main factors that influence performance of an application running on Premium Storage are Nature of IO Requests, VM size, Disk size, Number of disks, Disk Caching, Multithreading and Queue Depth.</span></span> <span data-ttu-id="99f1c-279">Vous pouvez contrôler certains de ces facteurs avec les dispositifs fournis par le système.</span><span class="sxs-lookup"><span data-stu-id="99f1c-279">You can control some of these factors with knobs provided by the system.</span></span> <span data-ttu-id="99f1c-280">La plupart des applications ne vous permettront peut-être pas de modifier directement la taille d’E/S et la profondeur de file d’attente.</span><span class="sxs-lookup"><span data-stu-id="99f1c-280">Most applications may not give you an option to alter the IO size and Queue Depth directly.</span></span> <span data-ttu-id="99f1c-281">Par exemple, si vous utilisez SQL Server, vous ne pouvez choisir ni la taille d’E/S ni la profondeur de file d’attente.</span><span class="sxs-lookup"><span data-stu-id="99f1c-281">For example, if you are using SQL Server, you cannot choose the IO size and queue depth.</span></span> <span data-ttu-id="99f1c-282">SQL Server choisit les valeurs optimales de taille d’E/S et de profondeur de file d’attente profondeur de manière à obtenir les meilleures performances.</span><span class="sxs-lookup"><span data-stu-id="99f1c-282">SQL Server chooses the optimal IO size and queue depth values to get the most performance.</span></span> <span data-ttu-id="99f1c-283">Il est important de comprendre les effets de ces deux types de facteurs sur les performances de votre application, afin que vous puissiez configurer les ressources appropriées pour répondre à vos besoins de performances.</span><span class="sxs-lookup"><span data-stu-id="99f1c-283">It is important to understand the effects of both types of factors on your application performance, so that you can provision appropriate resources to meet performance needs.</span></span>

<span data-ttu-id="99f1c-284">Dans cette section, reportez-vous à la liste de contrôle des exigences de performances applicatives que vous avez créée pour identifier le degré nécessaire d’optimisation des performances de votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-284">Throughout this section, refer to the application requirements checklist that you created, to identify how much you need to optimize your application performance.</span></span> <span data-ttu-id="99f1c-285">Sur cette base, vous serez en mesure de déterminer les facteurs de cette section que vous devrez paramétrer.</span><span class="sxs-lookup"><span data-stu-id="99f1c-285">Based on that, you will be able to determine which factors from this section you will need to tune.</span></span> <span data-ttu-id="99f1c-286">Pour évaluer les effets de chaque facteur sur les performances de votre application, exécutez les outils de benchmarking sur l’installation de votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-286">To witness the effects of each factor on your application performance, run benchmarking tools on your application setup.</span></span> <span data-ttu-id="99f1c-287">Reportez-vous à la section [Benchmarking](#Benchmarking) à la fin de cet article pour connaître les étapes à suivre pour exécuter les outils d’évaluation courants sur les machines virtuelles Windows et Linux.</span><span class="sxs-lookup"><span data-stu-id="99f1c-287">Refer to the [Benchmarking](#Benchmarking) section at the end of this article for steps to run common benchmarking tools on Windows and Linux VMs.</span></span>

### <a name="optimizing-iops-throughput-and-latency-at-a-glance"></a><span data-ttu-id="99f1c-288">Aperçu de l’optimisation des E/S, du débit et de la latence</span><span class="sxs-lookup"><span data-stu-id="99f1c-288">Optimizing IOPS, Throughput and Latency at a glance</span></span>
<span data-ttu-id="99f1c-289">Le tableau ci-dessous résume les facteurs de performances et les étapes nécessaires à l’optimisation des E/S, du débit et de la latence.</span><span class="sxs-lookup"><span data-stu-id="99f1c-289">The table below summarizes all the performance factors and the steps to optimize IOPS, Throughput and Latency.</span></span> <span data-ttu-id="99f1c-290">Les sections qui suivent ce résumé décrivent en détail chaque facteur.</span><span class="sxs-lookup"><span data-stu-id="99f1c-290">The sections following this summary will describe each factor is much more depth.</span></span>

| &nbsp; | <span data-ttu-id="99f1c-291">**D’OPÉRATIONS D’E/S PAR SECONDE**</span><span class="sxs-lookup"><span data-stu-id="99f1c-291">**IOPS**</span></span> | <span data-ttu-id="99f1c-292">**Débit**</span><span class="sxs-lookup"><span data-stu-id="99f1c-292">**Throughput**</span></span> | <span data-ttu-id="99f1c-293">**Latence**</span><span class="sxs-lookup"><span data-stu-id="99f1c-293">**Latency**</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="99f1c-294">**Exemple de scénario**</span><span class="sxs-lookup"><span data-stu-id="99f1c-294">**Example Scenario**</span></span> |<span data-ttu-id="99f1c-295">Application OLTP d’entreprise nécessitant un taux très élevé de transactions par seconde.</span><span class="sxs-lookup"><span data-stu-id="99f1c-295">Enterprise OLTP application requiring very high transactions per second rate.</span></span> |<span data-ttu-id="99f1c-296">Application d’entreposage de données d’entreprise traitant de grandes quantités de données.</span><span class="sxs-lookup"><span data-stu-id="99f1c-296">Enterprise Data warehousing application processing large amounts of data.</span></span> |<span data-ttu-id="99f1c-297">Applications en temps quasi-réel nécessitant une réponse instantanée aux demandes utilisateur, telles que les jeux en ligne.</span><span class="sxs-lookup"><span data-stu-id="99f1c-297">Near real-time applications requiring instant responses to user requests, like online gaming.</span></span> |
| <span data-ttu-id="99f1c-298">Facteurs de performances</span><span class="sxs-lookup"><span data-stu-id="99f1c-298">Performance factors</span></span> | &nbsp; | &nbsp; | &nbsp; |
| <span data-ttu-id="99f1c-299">**Taille d’E/S**</span><span class="sxs-lookup"><span data-stu-id="99f1c-299">**IO size**</span></span> |<span data-ttu-id="99f1c-300">Une plus petite taille d’E/S génère un nombre d’E/S par seconde plus élevé.</span><span class="sxs-lookup"><span data-stu-id="99f1c-300">Smaller IO size yields higher IOPS.</span></span> |<span data-ttu-id="99f1c-301">Une plus grande taille d’E/S génère un débit plus élevé.</span><span class="sxs-lookup"><span data-stu-id="99f1c-301">Larger IO size to yields higher Throughput.</span></span> | &nbsp;|
| <span data-ttu-id="99f1c-302">**Taille de la machine virtuelle**</span><span class="sxs-lookup"><span data-stu-id="99f1c-302">**VM size**</span></span> |<span data-ttu-id="99f1c-303">Utilisez une taille de machine virtuelle qui offre un nombre d’E/S par seconde supérieur aux besoins de votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-303">Use a VM size that offers IOPS greater than your application requirement.</span></span> <span data-ttu-id="99f1c-304">Voir ici les tailles de machine virtuelle et les limites d’E/S par seconde qui leur sont associées.</span><span class="sxs-lookup"><span data-stu-id="99f1c-304">See VM sizes and their IOPS limits here.</span></span> |<span data-ttu-id="99f1c-305">Utilisez une taille de machine virtuelle qui offre une limite de débit supérieure aux besoins de votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-305">Use a VM size with Throughput limit greater than your application requirement.</span></span> <span data-ttu-id="99f1c-306">Voir ici les tailles de machine virtuelle et les limites de débit qui leur sont associées.</span><span class="sxs-lookup"><span data-stu-id="99f1c-306">See VM sizes and their Throughput limits here.</span></span> |<span data-ttu-id="99f1c-307">Utilisez une taille de machine virtuelle qui offre une limite de mise à l’échelle supérieure aux besoins de votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-307">Use a VM size that offers scale limits greater than your application requirement.</span></span> <span data-ttu-id="99f1c-308">Voir ici les tailles de machine virtuelle et les limites qui leur sont associées.</span><span class="sxs-lookup"><span data-stu-id="99f1c-308">See VM sizes and their limits here.</span></span> |
| <span data-ttu-id="99f1c-309">**Taille du disque**</span><span class="sxs-lookup"><span data-stu-id="99f1c-309">**Disk size**</span></span> |<span data-ttu-id="99f1c-310">Utilisez une taille de disque qui offre un nombre d’E/S par seconde supérieur aux besoins de votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-310">Use a disk size that offers IOPS greater than your application requirement.</span></span> <span data-ttu-id="99f1c-311">Voir ici les tailles de disque et les limites d’E/S par seconde qui leur sont associées.</span><span class="sxs-lookup"><span data-stu-id="99f1c-311">See disk sizes and their IOPS limits here.</span></span> |<span data-ttu-id="99f1c-312">Utilisez une taille de disque qui offre une limite de débit supérieure aux besoins de votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-312">Use a disk size with Throughput limit greater than your application requirement.</span></span> <span data-ttu-id="99f1c-313">Vous trouverez ici les tailles de disque et les limites de débit qui leur sont associées.</span><span class="sxs-lookup"><span data-stu-id="99f1c-313">See disk sizes and their Throughput limits here.</span></span> |<span data-ttu-id="99f1c-314">Utilisez une taille de disque qui offre une limite de mise à l’échelle supérieure aux besoins de votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-314">Use a disk size that offers scale limits greater than your application requirement.</span></span> <span data-ttu-id="99f1c-315">Vous trouverez ici les tailles de disque et les limites qui leur sont associées.</span><span class="sxs-lookup"><span data-stu-id="99f1c-315">See disk sizes and their limits here.</span></span> |
| <span data-ttu-id="99f1c-316">**Limites de mises à l’échelle des machines virtuelles et des disques**</span><span class="sxs-lookup"><span data-stu-id="99f1c-316">**VM and Disk Scale Limits**</span></span> |<span data-ttu-id="99f1c-317">La limite d’E/S par seconde de la taille de machine virtuelle choisie doit être supérieure au nombre total d’E/S par seconde générées par les disques de stockage premium qui lui sont associés.</span><span class="sxs-lookup"><span data-stu-id="99f1c-317">IOPS limit of the VM size chosen should be greater than total IOPS driven by premium storage disks attached to it.</span></span> |<span data-ttu-id="99f1c-318">La limite de débit par seconde de la taille de machine virtuelle choisie doit être supérieure au débit total généré par les disques de stockage premium qui lui sont associés.</span><span class="sxs-lookup"><span data-stu-id="99f1c-318">Throughput limit of the VM size chosen should be greater than total Throughput driven by premium storage disks attached to it.</span></span> |<span data-ttu-id="99f1c-319">Les limites de mise à l’échelle de la taille de machine virtuelle choisie doivent être supérieures aux limites totales de mise à l’échelle des disques de stockage premium qui lui sont associés.</span><span class="sxs-lookup"><span data-stu-id="99f1c-319">Scale limits of the VM size chosen must be greater than total scale limits of attached premium storage disks.</span></span> |
| <span data-ttu-id="99f1c-320">**Mise en cache du disque**</span><span class="sxs-lookup"><span data-stu-id="99f1c-320">**Disk Caching**</span></span> |<span data-ttu-id="99f1c-321">Activez le cache en lecture seule sur les disques de stockage premium avec des opérations de lecture intensives pour obtenir un taux d’E/S en lecture par seconde plus élevé.</span><span class="sxs-lookup"><span data-stu-id="99f1c-321">Enable ReadOnly Cache on premium storage disks with Read heavy operations to get higher Read IOPS.</span></span> | &nbsp; |<span data-ttu-id="99f1c-322">Activez le cache en lecture seule sur les disques de stockage premium avec des opérations de lecture intensives pour obtenir de très faibles latences en lecture.</span><span class="sxs-lookup"><span data-stu-id="99f1c-322">Enable ReadOnly Cache on premium storage disks with Ready heavy operations to get very low Read latencies.</span></span> |
| <span data-ttu-id="99f1c-323">**Entrelacement de disques**</span><span class="sxs-lookup"><span data-stu-id="99f1c-323">**Disk Striping**</span></span> |<span data-ttu-id="99f1c-324">Utilisez plusieurs disques et entrelacez-les pour augmenter la limite combinée de débit et d’E/S par seconde.</span><span class="sxs-lookup"><span data-stu-id="99f1c-324">Use multiple disks and stripe them together to get a combined higher IOPS and Throughput limit.</span></span> <span data-ttu-id="99f1c-325">Notez que la limite combinée par machine virtuelle doit être supérieure aux limites combinées des disques premium associés.</span><span class="sxs-lookup"><span data-stu-id="99f1c-325">Note that the combined limit per VM should be higher than the combined limits of attached premium disks.</span></span> | &nbsp; | &nbsp; |
| <span data-ttu-id="99f1c-326">**Taille de l’entrelacement**</span><span class="sxs-lookup"><span data-stu-id="99f1c-326">**Stripe Size**</span></span> |<span data-ttu-id="99f1c-327">Taille d’entrelacement plus petite pour les petits schémas d’E/S aléatoires associés aux applications OLTP.</span><span class="sxs-lookup"><span data-stu-id="99f1c-327">Smaller stripe size for random small IO pattern seen in OLTP applications.</span></span> <span data-ttu-id="99f1c-328">Utilisez par exemple une taille d’entrelacement de 64 Ko pour les applications OLTP sous SQL Server.</span><span class="sxs-lookup"><span data-stu-id="99f1c-328">E.g., use stripe size of 64KB for SQL Server OLTP application.</span></span> |<span data-ttu-id="99f1c-329">Plus grande taille d’entrelacement pour les grands schémas d’E/S séquentiels associés aux applications d’entrepôt de données.</span><span class="sxs-lookup"><span data-stu-id="99f1c-329">Larger stripe size for sequential large IO pattern seen in Data Warehouse applications.</span></span> <span data-ttu-id="99f1c-330">Utilisez par exemple une taille d’entrelacement de 256 Ko pour les applications d’entrepôt de données sous SQL Server.</span><span class="sxs-lookup"><span data-stu-id="99f1c-330">E.g., use 256KB stripe size for SQL Server Data warehouse application.</span></span> | &nbsp; |
| <span data-ttu-id="99f1c-331">**Traitement multithread**</span><span class="sxs-lookup"><span data-stu-id="99f1c-331">**Multithreading**</span></span> |<span data-ttu-id="99f1c-332">Utilisez le traitement multithread pour envoyer un plus grand nombre de demandes à Premium Storage et augmenter ainsi le débit et le nombre d’E/S par seconde.</span><span class="sxs-lookup"><span data-stu-id="99f1c-332">Use multithreading to push higher number of requests to Premium Storage that will lead to higher IOPS and Throughput.</span></span> <span data-ttu-id="99f1c-333">Sur SQL Server, par exemple, définissez une valeur MAXDOP élevée pour allouer plus de ressources processeur à SQL Server.</span><span class="sxs-lookup"><span data-stu-id="99f1c-333">For example, on SQL Server set a high MAXDOP value to allocate more CPUs to SQL Server.</span></span> | &nbsp; | &nbsp; |
| <span data-ttu-id="99f1c-334">**Profondeur de file d’attente**</span><span class="sxs-lookup"><span data-stu-id="99f1c-334">**Queue Depth**</span></span> |<span data-ttu-id="99f1c-335">Une plus grande profondeur de file d’attente génère un nombre plus élevé d’E/S par seconde.</span><span class="sxs-lookup"><span data-stu-id="99f1c-335">Larger Queue Depth yields higher IOPS.</span></span> |<span data-ttu-id="99f1c-336">Une plus grande profondeur de file d’attente génère un débit plus élevé.</span><span class="sxs-lookup"><span data-stu-id="99f1c-336">Larger Queue Depth yields higher Throughput.</span></span> |<span data-ttu-id="99f1c-337">Une plus petite profondeur de file d’attente réduit les latences.</span><span class="sxs-lookup"><span data-stu-id="99f1c-337">Smaller Queue Depth yields lower latencies.</span></span> |

## <a name="nature-of-io-requests"></a><span data-ttu-id="99f1c-338">Nature des demandes d’E/S</span><span class="sxs-lookup"><span data-stu-id="99f1c-338">Nature of IO Requests</span></span>
<span data-ttu-id="99f1c-339">Une demande d’E/S représente une unité d’opération d’entrée/sortie exécutée par votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-339">An IO request is a unit of input/output operation that your application will be performing.</span></span> <span data-ttu-id="99f1c-340">Identifier la nature des demandes d’E/S (aléatoires ou séquentielles, en lecture ou en écriture, petites ou grandes) vous permet de déterminer les exigences de performances de votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-340">Identifying the nature of IO requests, random or sequential, read or write, small or large, will help you determine the performance requirements of your application.</span></span> <span data-ttu-id="99f1c-341">Il est très important de comprendre la nature des demandes d’E/S afin de prendre les bonnes décisions lors de la conception de votre infrastructure d’applications.</span><span class="sxs-lookup"><span data-stu-id="99f1c-341">It is very important to understand the nature of IO requests, to make the right decisions when designing your application infrastructure.</span></span>

<span data-ttu-id="99f1c-342">La taille des E/S compte parmi les facteurs les plus importants.</span><span class="sxs-lookup"><span data-stu-id="99f1c-342">IO size is one of the more important factors.</span></span> <span data-ttu-id="99f1c-343">La taille des E/S correspond à la taille de la demande d’opération d’entrée/sortie générée par votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-343">The IO size is the size of the input/output operation request generated by your application.</span></span> <span data-ttu-id="99f1c-344">La taille des E/S a un impact significatif sur les performances, en particulier sur le nombre d’E/S par seconde et sur la bande passante, que l’application sera en mesure de délivrer.</span><span class="sxs-lookup"><span data-stu-id="99f1c-344">The IO size has a significant impact on performance especially on the IOPS and Bandwidth that the application is able to achieve.</span></span> <span data-ttu-id="99f1c-345">La formule suivante montre la relation entre le nombre d’E/S par seconde, la taille des E/S et la bande passante ou le débit.</span><span class="sxs-lookup"><span data-stu-id="99f1c-345">The following formula shows the relationship between IOPS, IO size and Bandwidth/Throughput.</span></span>  
    ![](media/storage-premium-storage-performance/image1.png)

<span data-ttu-id="99f1c-346">Certaines applications vous permettent de modifier leur taille d’E/S, contrairement à d’autres.</span><span class="sxs-lookup"><span data-stu-id="99f1c-346">Some applications allow you to alter their IO size, while some applications do not.</span></span> <span data-ttu-id="99f1c-347">Par exemple, SQL Server détermine lui-même la taille d’E/S optimale et ne fournit aux utilisateurs aucun dispositif permettant de la modifier.</span><span class="sxs-lookup"><span data-stu-id="99f1c-347">For example, SQL Server determines the optimal IO size itself, and does not provide users with any knobs to change it.</span></span> <span data-ttu-id="99f1c-348">De son côté, Oracle propose un paramètre appelé [DB\_BLOCK\_SIZE](https://docs.oracle.com/cd/B19306_01/server.102/b14211/iodesign.htm#i28815) que vous pouvez utiliser pour configurer la taille de la demande d’E/S de la base de données.</span><span class="sxs-lookup"><span data-stu-id="99f1c-348">On the other hand, Oracle provides a parameter called [DB\_BLOCK\_SIZE](https://docs.oracle.com/cd/B19306_01/server.102/b14211/iodesign.htm#i28815) using which you can configure the I/O request size of the database.</span></span>

<span data-ttu-id="99f1c-349">Si vous utilisez une application qui ne permet pas de modifier la taille d’E/S, suivez les indications de cet article pour optimiser les indicateurs de performances qui correspondent le mieux à votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-349">If you are using an application, which does not allow you to change the IO size, use the guidelines in this article to optimize the performance KPI that is most relevant to your application.</span></span> <span data-ttu-id="99f1c-350">Par exemple,</span><span class="sxs-lookup"><span data-stu-id="99f1c-350">For example,</span></span>

* <span data-ttu-id="99f1c-351">Une application OLTP génère des millions de demandes d’E/S petites et aléatoires.</span><span class="sxs-lookup"><span data-stu-id="99f1c-351">An OLTP application generates millions of small and random IO requests.</span></span> <span data-ttu-id="99f1c-352">Pour gérer ces types de demandes d’E/S, vous devez concevoir votre infrastructure d’applications de manière à augmenter le nombre d’E/S par seconde.</span><span class="sxs-lookup"><span data-stu-id="99f1c-352">To handle these type of IO requests, you must design your application infrastructure to get higher IOPS.</span></span>  
* <span data-ttu-id="99f1c-353">Une application d’entrepôt de données génère d’importantes demandes d’E/S séquentielles.</span><span class="sxs-lookup"><span data-stu-id="99f1c-353">A data warehousing application generates large and sequential IO requests.</span></span> <span data-ttu-id="99f1c-354">Pour gérer ces types de demandes d’E/S, vous devez concevoir votre infrastructure d’applications de manière à augmenter la bande passante ou le débit.</span><span class="sxs-lookup"><span data-stu-id="99f1c-354">To handle these type of IO requests, you must design your application infrastructure to get higher Bandwidth or Throughput.</span></span>

<span data-ttu-id="99f1c-355">Si vous utilisez une application qui vous permet de modifier la taille d’E/S, utilisez cette règle générale tout en respectant les autres instructions de performances.</span><span class="sxs-lookup"><span data-stu-id="99f1c-355">If you are using an application, which allows you to change the IO size, use this rule of thumb for the IO size in addition to other performance guidelines,</span></span>

* <span data-ttu-id="99f1c-356">Une plus petite taille d’E/S pour générer un nombre d’E/S par seconde plus élevé.</span><span class="sxs-lookup"><span data-stu-id="99f1c-356">Smaller IO size to get higher IOPS.</span></span> <span data-ttu-id="99f1c-357">Par exemple, 8 Ko pour une application OLTP.</span><span class="sxs-lookup"><span data-stu-id="99f1c-357">For example, 8 KB for an OLTP application.</span></span>  
* <span data-ttu-id="99f1c-358">Une plus grande taille d’E/S pour augmenter la bande passante ou le débit.</span><span class="sxs-lookup"><span data-stu-id="99f1c-358">Larger IO size to get higher Bandwidth/Throughput.</span></span> <span data-ttu-id="99f1c-359">Par exemple, 1 024 Ko pour une application d’entrepôt de données.</span><span class="sxs-lookup"><span data-stu-id="99f1c-359">For example, 1024 KB for a data warehouse application.</span></span>

<span data-ttu-id="99f1c-360">Voici un exemple de calcul du nombre d’E/S par seconde et du débit ou de la bande passante pour votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-360">Here is an example on how you can calculate the IOPS and Throughput/Bandwidth for your application.</span></span> <span data-ttu-id="99f1c-361">Supposons une application utilisant un disque P30.</span><span class="sxs-lookup"><span data-stu-id="99f1c-361">Consider an application using a P30 disk.</span></span> <span data-ttu-id="99f1c-362">Un disque P30 peut atteindre au maximum 5 000 E/S par seconde et 200 Mo de débit/bande passante par seconde.</span><span class="sxs-lookup"><span data-stu-id="99f1c-362">The maximum IOPS and Throughput/Bandwidth a P30 disk can achieve is 5000 IOPS and 200 MB per second respectively.</span></span> <span data-ttu-id="99f1c-363">À présent, si votre application a besoin d’utiliser le nombre maximal d’E/S par seconde du disque P30 alors que vous utilisez une taille d’E/S inférieure à 8 Ko, vous devriez obtenir 40 Mo de bande passante par seconde.</span><span class="sxs-lookup"><span data-stu-id="99f1c-363">Now, if your application requires the maximum IOPS from the P30 disk and you use a smaller IO size like 8 KB, the resulting Bandwidth you will be able to get is 40 MB per second.</span></span> <span data-ttu-id="99f1c-364">En revanche, si votre application requiert la valeur maximale de débit et de bande passante à partir du disque P30 et que vous utilisez une taille d’E/S supérieure à 1 024 Ko, vous obtiendrez seulement 200 E/S par seconde.</span><span class="sxs-lookup"><span data-stu-id="99f1c-364">However, if your application requires the maximum Throughput/Bandwidth from P30 disk, and you use a larger IO size like 1024 KB, the resulting IOPS will be less, 200 IOPS.</span></span> <span data-ttu-id="99f1c-365">Vous devez donc ajuster la taille d’E/S pour qu’elle réponde aux besoins de votre application tant en terme d’E/S que de débit et de bande passante.</span><span class="sxs-lookup"><span data-stu-id="99f1c-365">Therefore, tune the IO size such that it meets both your application's IOPS and Throughput/Bandwidth requirement.</span></span> <span data-ttu-id="99f1c-366">Le tableau ci-dessous récapitule les différentes tailles d’E/S en indiquant le nombre d’E/S par seconde et le débit correspondant dans le cas d’un disque P30.</span><span class="sxs-lookup"><span data-stu-id="99f1c-366">Table below summarizes the different IO sizes and their corresponding IOPS and Throughput for a P30 disk.</span></span>

| <span data-ttu-id="99f1c-367">Spécification de l’application</span><span class="sxs-lookup"><span data-stu-id="99f1c-367">Application Requirement</span></span> | <span data-ttu-id="99f1c-368">Taille des E/S</span><span class="sxs-lookup"><span data-stu-id="99f1c-368">I/O size</span></span> | <span data-ttu-id="99f1c-369">E/S par seconde</span><span class="sxs-lookup"><span data-stu-id="99f1c-369">IOPS</span></span> | <span data-ttu-id="99f1c-370">Débit/bande passante</span><span class="sxs-lookup"><span data-stu-id="99f1c-370">Throughput/Bandwidth</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="99f1c-371">Nb max. d’E/S par seconde</span><span class="sxs-lookup"><span data-stu-id="99f1c-371">Max IOPS</span></span> |<span data-ttu-id="99f1c-372">8 Ko</span><span class="sxs-lookup"><span data-stu-id="99f1c-372">8 KB</span></span> |<span data-ttu-id="99f1c-373">5 000</span><span class="sxs-lookup"><span data-stu-id="99f1c-373">5,000</span></span> |<span data-ttu-id="99f1c-374">40 Mo par seconde</span><span class="sxs-lookup"><span data-stu-id="99f1c-374">40 MB per second</span></span> |
| <span data-ttu-id="99f1c-375">Débit max.</span><span class="sxs-lookup"><span data-stu-id="99f1c-375">Max Throughput</span></span> |<span data-ttu-id="99f1c-376">1 024 Ko</span><span class="sxs-lookup"><span data-stu-id="99f1c-376">1024 KB</span></span> |<span data-ttu-id="99f1c-377">200</span><span class="sxs-lookup"><span data-stu-id="99f1c-377">200</span></span> |<span data-ttu-id="99f1c-378">200 Mo par seconde</span><span class="sxs-lookup"><span data-stu-id="99f1c-378">200 MB per second</span></span> |
| <span data-ttu-id="99f1c-379">Débit max + nb élevé d’E/S par seconde</span><span class="sxs-lookup"><span data-stu-id="99f1c-379">Max Throughput + high IOPS</span></span> |<span data-ttu-id="99f1c-380">64 Ko</span><span class="sxs-lookup"><span data-stu-id="99f1c-380">64 KB</span></span> |<span data-ttu-id="99f1c-381">3 200</span><span class="sxs-lookup"><span data-stu-id="99f1c-381">3,200</span></span> |<span data-ttu-id="99f1c-382">200 Mo par seconde</span><span class="sxs-lookup"><span data-stu-id="99f1c-382">200 MB per second</span></span> |
| <span data-ttu-id="99f1c-383">Nb max d’E/S par seconde + débit élevé</span><span class="sxs-lookup"><span data-stu-id="99f1c-383">Max IOPS + high Throughput</span></span> |<span data-ttu-id="99f1c-384">32 Ko</span><span class="sxs-lookup"><span data-stu-id="99f1c-384">32 KB</span></span> |<span data-ttu-id="99f1c-385">5 000</span><span class="sxs-lookup"><span data-stu-id="99f1c-385">5,000</span></span> |<span data-ttu-id="99f1c-386">160 Mo par seconde</span><span class="sxs-lookup"><span data-stu-id="99f1c-386">160 MB per second</span></span> |

<span data-ttu-id="99f1c-387">Pour obtenir une valeur d’E/S par seconde et de bande passante supérieure à la valeur maximale d’un seul disque de stockage premium, utilisez plusieurs disques premium entrelacés ensemble.</span><span class="sxs-lookup"><span data-stu-id="99f1c-387">To get IOPS and Bandwidth higher than the maximum value of a single premium storage disk, use multiple premium disks striped together.</span></span> <span data-ttu-id="99f1c-388">Par exemple, entrelacez deux disques P30 pour obtenir un total de 10 000 E/S par seconde ou un débit combiné de 400 Mo par seconde.</span><span class="sxs-lookup"><span data-stu-id="99f1c-388">For example, stripe two P30 disks to get a combined IOPS of 10,000 IOPS or a combined Throughput of 400 MB per second.</span></span> <span data-ttu-id="99f1c-389">Comme nous l’expliquons dans la section suivante, vous devez utiliser une taille de machine virtuelle qui prend en charge la valeur combinée d’E/S par seconde et de débit du disque.</span><span class="sxs-lookup"><span data-stu-id="99f1c-389">As explained in the next section, you must use a VM size that supports the combined disk IOPS and Throughput.</span></span>

> [!NOTE]
> <span data-ttu-id="99f1c-390">lorsque vous augmentez les E/S par seconde ou le débit, l’autre valeur augmente également ; assurez-vous de ne pas franchir les limites de débit ou d’E/S par seconde du disque ou de la machine virtuelle lorsque vous augmentez l’une de ces valeurs.</span><span class="sxs-lookup"><span data-stu-id="99f1c-390">As you increase either IOPS or Throughput the other also increases, make sure you do not hit throughput or IOPS limits of the disk or VM when increasing either one.</span></span>
>
>

<span data-ttu-id="99f1c-391">Pour évaluer les effets de la taille des E/S sur les performances de l’application, vous pouvez exécuter des outils d’évaluation sur votre machine virtuelle et sur vos disques.</span><span class="sxs-lookup"><span data-stu-id="99f1c-391">To witness the effects of IO size on application performance, you can run benchmarking tools on your VM and disks.</span></span> <span data-ttu-id="99f1c-392">Créez plusieurs séries de tests et utilisez une taille d’E/S différente pour chaque exécution afin d’en déterminer l’impact.</span><span class="sxs-lookup"><span data-stu-id="99f1c-392">Create multiple test runs and use different IO size for each run to see the impact.</span></span> <span data-ttu-id="99f1c-393">Reportez-vous à la section [Benchmarking](#Benchmarking) à la fin de cet article pour plus de détails.</span><span class="sxs-lookup"><span data-stu-id="99f1c-393">Refer to the [Benchmarking](#Benchmarking) section at the end of this article for more details.</span></span>

## <a name="high-scale-vm-sizes"></a><span data-ttu-id="99f1c-394">Tailles des machines virtuelles à grande échelle</span><span class="sxs-lookup"><span data-stu-id="99f1c-394">High Scale VM Sizes</span></span>
<span data-ttu-id="99f1c-395">Lorsque vous commencez la conception d’une application, l’une des premières choses à faire est de choisir une machine virtuelle qui hébergera votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-395">When you start designing an application, one of the first things to do is, choose a VM to host your application.</span></span> <span data-ttu-id="99f1c-396">Premium Storage est fourni avec des tailles de machine virtuelle à grande échelle capables d’exécuter des applications qui requièrent une plus grande puissance de calcul et de hautes performances d’E/S du disque local.</span><span class="sxs-lookup"><span data-stu-id="99f1c-396">Premium Storage comes with High Scale VM sizes that can run applications requiring higher compute power and a high local disk I/O performance.</span></span> <span data-ttu-id="99f1c-397">Ces machines virtuelles se caractérisent par des processeurs plus rapides, un rapport mémoire-cœur plus élevé et l’utilisation d’un disque SSD comme disque local.</span><span class="sxs-lookup"><span data-stu-id="99f1c-397">These VMs provide faster processors, a higher memory-to-core ratio, and a Solid-State Drive (SSD) for the local disk.</span></span> <span data-ttu-id="99f1c-398">Les séries DS, DSv2 et GS sont des exemples de machines virtuelles à grande échelle prenant en charge Premium Storage.</span><span class="sxs-lookup"><span data-stu-id="99f1c-398">Examples of High Scale VMs supporting Premium Storage are the DS, DSv2 and GS series VMs.</span></span>

<span data-ttu-id="99f1c-399">Ces machines virtuelles sont disponibles en différentes tailles, avec un nombre différent de cœurs de processeur, de mémoire, de système d’exploitation et de taille du disque temporaire.</span><span class="sxs-lookup"><span data-stu-id="99f1c-399">High Scale VMs are available in different sizes with a different number of CPU cores, memory, OS and temporary disk size.</span></span> <span data-ttu-id="99f1c-400">Chaque taille de chaque machine virtuelle possède également un nombre maximal de disques de données que vous pouvez attacher à la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="99f1c-400">Each VM size also has maximum number of data disks that you can attach to the VM.</span></span> <span data-ttu-id="99f1c-401">Par conséquent, la taille de machine virtuelle choisie affectera la quantité de traitement, de mémoire et de capacité de stockage disponible pour votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-401">Therefore, the chosen VM size will affect how much processing, memory, and storage capacity is available for your application.</span></span> <span data-ttu-id="99f1c-402">Elle affecte également le coût de traitement et de stockage.</span><span class="sxs-lookup"><span data-stu-id="99f1c-402">It also affects the Compute and Storage cost.</span></span> <span data-ttu-id="99f1c-403">Vous trouverez ci-dessous les spécifications de la plus grande taille de machine virtuelle d’une série DS, d’une série DSv2 et d’une série GS :</span><span class="sxs-lookup"><span data-stu-id="99f1c-403">For example, below are the specifications of the largest VM size in a DS series, DSv2 series and a GS series:</span></span>

| <span data-ttu-id="99f1c-404">Taille de la machine virtuelle</span><span class="sxs-lookup"><span data-stu-id="99f1c-404">VM size</span></span> | <span data-ttu-id="99f1c-405">Cœurs d’unité centrale</span><span class="sxs-lookup"><span data-stu-id="99f1c-405">CPU cores</span></span> | <span data-ttu-id="99f1c-406">Mémoire</span><span class="sxs-lookup"><span data-stu-id="99f1c-406">Memory</span></span> | <span data-ttu-id="99f1c-407">Tailles du disque de la machine virtuelle</span><span class="sxs-lookup"><span data-stu-id="99f1c-407">VM disk sizes</span></span> | <span data-ttu-id="99f1c-408">Bande passante</span><span class="sxs-lookup"><span data-stu-id="99f1c-408">Max.</span></span> <span data-ttu-id="99f1c-409">disques de données</span><span class="sxs-lookup"><span data-stu-id="99f1c-409">data disks</span></span> | <span data-ttu-id="99f1c-410">Taille du cache</span><span class="sxs-lookup"><span data-stu-id="99f1c-410">Cache size</span></span> | <span data-ttu-id="99f1c-411">E/S par seconde</span><span class="sxs-lookup"><span data-stu-id="99f1c-411">IOPS</span></span> | <span data-ttu-id="99f1c-412">Limites d’E/S du cache de bande passante</span><span class="sxs-lookup"><span data-stu-id="99f1c-412">Bandwidth Cache IO limits</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="99f1c-413">Standard_DS14</span><span class="sxs-lookup"><span data-stu-id="99f1c-413">Standard_DS14</span></span> |<span data-ttu-id="99f1c-414">16</span><span class="sxs-lookup"><span data-stu-id="99f1c-414">16</span></span> |<span data-ttu-id="99f1c-415">112 Go</span><span class="sxs-lookup"><span data-stu-id="99f1c-415">112 GB</span></span> |<span data-ttu-id="99f1c-416">OS = 1023 Go </span><span class="sxs-lookup"><span data-stu-id="99f1c-416">OS = 1023 GB</span></span> <br> <span data-ttu-id="99f1c-417">SSD local = 224 Go</span><span class="sxs-lookup"><span data-stu-id="99f1c-417">Local SSD = 224 GB</span></span> |<span data-ttu-id="99f1c-418">32</span><span class="sxs-lookup"><span data-stu-id="99f1c-418">32</span></span> |<span data-ttu-id="99f1c-419">576 Go</span><span class="sxs-lookup"><span data-stu-id="99f1c-419">576 GB</span></span> |<span data-ttu-id="99f1c-420">50 000 E/S par seconde </span><span class="sxs-lookup"><span data-stu-id="99f1c-420">50,000 IOPS</span></span> <br> <span data-ttu-id="99f1c-421">512 Mo par seconde</span><span class="sxs-lookup"><span data-stu-id="99f1c-421">512 MB per second</span></span> |<span data-ttu-id="99f1c-422">4 000 E/S par seconde et 33 Mo par seconde</span><span class="sxs-lookup"><span data-stu-id="99f1c-422">4,000 IOPS and 33 MB per second</span></span> |
| <span data-ttu-id="99f1c-423">Standard_GS5</span><span class="sxs-lookup"><span data-stu-id="99f1c-423">Standard_GS5</span></span> |<span data-ttu-id="99f1c-424">32</span><span class="sxs-lookup"><span data-stu-id="99f1c-424">32</span></span> |<span data-ttu-id="99f1c-425">448 Go</span><span class="sxs-lookup"><span data-stu-id="99f1c-425">448 GB</span></span> |<span data-ttu-id="99f1c-426">OS = 1023 Go </span><span class="sxs-lookup"><span data-stu-id="99f1c-426">OS = 1023 GB</span></span> <br> <span data-ttu-id="99f1c-427">SSD local = 896 Go</span><span class="sxs-lookup"><span data-stu-id="99f1c-427">Local SSD = 896 GB</span></span> |<span data-ttu-id="99f1c-428">64</span><span class="sxs-lookup"><span data-stu-id="99f1c-428">64</span></span> |<span data-ttu-id="99f1c-429">4 224 Go</span><span class="sxs-lookup"><span data-stu-id="99f1c-429">4224 GB</span></span> |<span data-ttu-id="99f1c-430">80 000 E/S par seconde </span><span class="sxs-lookup"><span data-stu-id="99f1c-430">80,000 IOPS</span></span> <br> <span data-ttu-id="99f1c-431">2 000 Mo par seconde</span><span class="sxs-lookup"><span data-stu-id="99f1c-431">2,000 MB per second</span></span> |<span data-ttu-id="99f1c-432">5 000 E/S par seconde et 50 Mo par seconde</span><span class="sxs-lookup"><span data-stu-id="99f1c-432">5,000 IOPS and 50 MB per second</span></span> |

<span data-ttu-id="99f1c-433">Pour afficher une liste complète de toutes les tailles de machine virtuelle Azure disponibles, consultez les articles [Tailles des machines virtuelles dans Azure (Windows)](../virtual-machines/windows/sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json) ou [Tailles des machines virtuelles dans Azure (Linux)](../virtual-machines/linux/sizes.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="99f1c-433">To view a complete list of all available Azure VM sizes, refer to [Windows VM sizes](../virtual-machines/windows/sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json) or [Linux VM sizes](../virtual-machines/linux/sizes.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span></span> <span data-ttu-id="99f1c-434">Choisissez une taille de machine virtuelle capable de s’adapter aux exigences de performances souhaitées de votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-434">Choose a VM size that can meet and scale to your desired application performance requirements.</span></span> <span data-ttu-id="99f1c-435">En outre, prenez en compte les considérations suivantes lors du choix de tailles de machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="99f1c-435">In addition to this, take into account following important considerations when choosing VM sizes.</span></span>

<span data-ttu-id="99f1c-436">*Limites de mise à l’échelle*</span><span class="sxs-lookup"><span data-stu-id="99f1c-436">*Scale Limits*</span></span>  
<span data-ttu-id="99f1c-437">Les limites d’E/S par seconde par machine virtuelle et par disque sont différentes et indépendantes les unes des autres.</span><span class="sxs-lookup"><span data-stu-id="99f1c-437">The maximum IOPS limits per VM and per disk are different and independent of each other.</span></span> <span data-ttu-id="99f1c-438">Assurez-vous que l’application génère un nombre d’E/S par seconde dans les limites de la machine virtuelle et des disques premium qui lui sont associés.</span><span class="sxs-lookup"><span data-stu-id="99f1c-438">Make sure that the application is driving IOPS within the limits of the VM as well as the premium disks attached to it.</span></span> <span data-ttu-id="99f1c-439">Dans le cas contraire, les performances de l’application seront limitées.</span><span class="sxs-lookup"><span data-stu-id="99f1c-439">Otherwise, application performance will experience throttling.</span></span>

<span data-ttu-id="99f1c-440">Par exemple, supposons une application exigeant un maximum de 4 000 E/S par seconde.</span><span class="sxs-lookup"><span data-stu-id="99f1c-440">As an example, suppose an application requirement is a maximum of 4,000 IOPS.</span></span> <span data-ttu-id="99f1c-441">Pour atteindre cette valeur, vous devez configurer un disque P30 sur une machine virtuelle DS1.</span><span class="sxs-lookup"><span data-stu-id="99f1c-441">To achieve this, you provision a P30 disk on a DS1 VM.</span></span> <span data-ttu-id="99f1c-442">Le disque P30 peut fournir jusqu’à 5 000 E/S par seconde.</span><span class="sxs-lookup"><span data-stu-id="99f1c-442">The P30 disk can deliver up to 5,000 IOPS.</span></span> <span data-ttu-id="99f1c-443">En revanche, la machine virtuelle DS1 est limitée à 3 200 E/S par seconde.</span><span class="sxs-lookup"><span data-stu-id="99f1c-443">However, the DS1 VM is limited to 3,200 IOPS.</span></span> <span data-ttu-id="99f1c-444">Par conséquent, les performances de l’application seront contraintes par la limite de la machine virtuelle à 3 200 E/S par seconde, ce qui affectera les performances.</span><span class="sxs-lookup"><span data-stu-id="99f1c-444">Consequently, the application performance will be constrained by the VM limit at 3,200 IOPS and there will be degraded performance.</span></span> <span data-ttu-id="99f1c-445">Pour éviter cette situation, choisissez une taille de machine virtuelle et de disque qui satisfont toutes deux aux exigences de l’application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-445">To prevent this situation, choose a VM and disk size that will both meet application requirements.</span></span>

<span data-ttu-id="99f1c-446">*Coût d’exploitation*</span><span class="sxs-lookup"><span data-stu-id="99f1c-446">*Cost of Operation*</span></span>  
<span data-ttu-id="99f1c-447">Dans de nombreux cas, il est possible que le coût global d’exploitation lié à l’utilisation de Premium Storage soit inférieur à celui associé à l’utilisation d’un stockage Standard.</span><span class="sxs-lookup"><span data-stu-id="99f1c-447">In many cases, it is possible that your overall cost of operation using Premium Storage is lower than using Standard Storage.</span></span>

<span data-ttu-id="99f1c-448">Imaginez par exemple une application nécessitant 16 000 E/S par seconde.</span><span class="sxs-lookup"><span data-stu-id="99f1c-448">For example, consider an application requiring 16,000 IOPS.</span></span> <span data-ttu-id="99f1c-449">Pour atteindre ces performances, vous aurez besoin d’une machine virtuelle IaaS Azure Standard\_StandardD14, qui peut délivrer 16 000 E/S par seconde maximum en utilisant 32 disques de stockage standard de 1 To.</span><span class="sxs-lookup"><span data-stu-id="99f1c-449">To achieve this performance, you will need a Standard\_D14 Azure IaaS VM, which can give a maximum IOPS of 16,000 using 32 standard storage 1TB disks.</span></span> <span data-ttu-id="99f1c-450">Chaque disque de stockage standard de 1 To peut atteindre un maximum de 500 E/S par seconde.</span><span class="sxs-lookup"><span data-stu-id="99f1c-450">Each 1TB standard storage disk can achieve a maximum of 500 IOPS.</span></span> <span data-ttu-id="99f1c-451">Le coût mensuel estimé de cette machine virtuelle sera de 1 570 $.</span><span class="sxs-lookup"><span data-stu-id="99f1c-451">The estimated cost of this VM per month will be $1,570.</span></span> <span data-ttu-id="99f1c-452">Le coût mensuel de 32 disques de stockage standard sera de 1 638 $.</span><span class="sxs-lookup"><span data-stu-id="99f1c-452">The monthly cost of 32 standard storage disks will be $1,638.</span></span> <span data-ttu-id="99f1c-453">Le coût total mensuel estimé sera donc de 3 208 $.</span><span class="sxs-lookup"><span data-stu-id="99f1c-453">The estimated total monthly cost will be $3,208.</span></span>

<span data-ttu-id="99f1c-454">Toutefois, si vous aviez hébergé la même application sur Premium Storage, vous auriez besoin d’une plus petite taille de machine virtuelle et de moins de disques de stockage premium, ce qui réduirait le coût global.</span><span class="sxs-lookup"><span data-stu-id="99f1c-454">However, if you hosted the same application on Premium Storage, you will need a smaller VM size and fewer premium storage disks, thus reducing the overall cost.</span></span> <span data-ttu-id="99f1c-455">Une machine virtuelle Standard\_StandardDS13 peut couvrir les 16 000 E/S par seconde requis à l’aide de quatre disques P30.</span><span class="sxs-lookup"><span data-stu-id="99f1c-455">A Standard\_DS13 VM can meet the 16,000 IOPS requirement using four P30 disks.</span></span> <span data-ttu-id="99f1c-456">La machine virtuelle DS13 délivre 25 600 E/S par seconde au maximum et chaque disque P30 délivre 5 000 E/S par seconde.</span><span class="sxs-lookup"><span data-stu-id="99f1c-456">The DS13 VM has a maximum IOPS of 25,600 and each P30 disk has a maximum IOPS of 5,000.</span></span> <span data-ttu-id="99f1c-457">Globalement, cette configuration peut atteindre 5 000 x 4 = 20 000 E/S par seconde.</span><span class="sxs-lookup"><span data-stu-id="99f1c-457">Overall, this configuration can achieve 5,000 x 4 = 20,000 IOPS.</span></span> <span data-ttu-id="99f1c-458">Le coût mensuel estimé de cette machine virtuelle sera de 1 003 $.</span><span class="sxs-lookup"><span data-stu-id="99f1c-458">The estimated cost of this VM per month will be $1,003.</span></span> <span data-ttu-id="99f1c-459">Le coût mensuel de quatre disques de stockage premium P30 sera de 544,34 $.</span><span class="sxs-lookup"><span data-stu-id="99f1c-459">The monthly cost of four P30 premium storage disks will be $544.34.</span></span> <span data-ttu-id="99f1c-460">Le coût total mensuel estimé sera donc de 1 544 $.</span><span class="sxs-lookup"><span data-stu-id="99f1c-460">The estimated total monthly cost will be $1,544.</span></span>

<span data-ttu-id="99f1c-461">Le tableau ci-dessous résume la répartition des coûts de ce scénario pour un stockage Standard et Premium.</span><span class="sxs-lookup"><span data-stu-id="99f1c-461">Table below summarizes the cost breakdown of this scenario for Standard and Premium Storage.</span></span>

| &nbsp; | <span data-ttu-id="99f1c-462">**Standard**</span><span class="sxs-lookup"><span data-stu-id="99f1c-462">**Standard**</span></span> | <span data-ttu-id="99f1c-463">**Premium**</span><span class="sxs-lookup"><span data-stu-id="99f1c-463">**Premium**</span></span> |
| --- | --- | --- |
| <span data-ttu-id="99f1c-464">**Coût de la machine virtuelle par mois**</span><span class="sxs-lookup"><span data-stu-id="99f1c-464">**Cost of VM per month**</span></span> |<span data-ttu-id="99f1c-465">1 570,58 $ (Standard\_StandardD14)</span><span class="sxs-lookup"><span data-stu-id="99f1c-465">$1,570.58 (Standard\_D14)</span></span> |<span data-ttu-id="99f1c-466">1 003,66 $ (Standard\_StandardDS13)</span><span class="sxs-lookup"><span data-stu-id="99f1c-466">$1,003.66 (Standard\_DS13)</span></span> |
| <span data-ttu-id="99f1c-467">**Coût des disques par mois**</span><span class="sxs-lookup"><span data-stu-id="99f1c-467">**Cost of Disks per month**</span></span> |<span data-ttu-id="99f1c-468">1 638,40 $ (32 disques de 1 To)</span><span class="sxs-lookup"><span data-stu-id="99f1c-468">$1,638.40 (32 x 1 TB disks)</span></span> |<span data-ttu-id="99f1c-469">544,34 $ (4 disques P30)</span><span class="sxs-lookup"><span data-stu-id="99f1c-469">$544.34 (4 x P30 disks)</span></span> |
| <span data-ttu-id="99f1c-470">**Coût global par mois**</span><span class="sxs-lookup"><span data-stu-id="99f1c-470">**Overall Cost per month**</span></span> |<span data-ttu-id="99f1c-471">3 208,98 $</span><span class="sxs-lookup"><span data-stu-id="99f1c-471">$3,208.98</span></span> |<span data-ttu-id="99f1c-472">1 544,34 $</span><span class="sxs-lookup"><span data-stu-id="99f1c-472">$1,544.34</span></span> |

<span data-ttu-id="99f1c-473">*Distributions Linux*</span><span class="sxs-lookup"><span data-stu-id="99f1c-473">*Linux Distros*</span></span>  

<span data-ttu-id="99f1c-474">Avec Azure Premium Storage, vous obtenez le même niveau de performances pour les machines virtuelles exécutant Windows et Linux.</span><span class="sxs-lookup"><span data-stu-id="99f1c-474">With Azure Premium Storage, you get the same level of Performance for VMs running Windows and Linux.</span></span> <span data-ttu-id="99f1c-475">Nous prenons en charge diverses distributions Linux, dont vous trouverez la liste complète [ici](../virtual-machines/linux/endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="99f1c-475">We support many flavors of Linux distros, and you can see the complete list [here](../virtual-machines/linux/endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span></span> <span data-ttu-id="99f1c-476">Il est important de noter que les différentes distributions sont mieux adaptées à différents types de charges de travail.</span><span class="sxs-lookup"><span data-stu-id="99f1c-476">It is important to note that different distros are better suited for different types of workloads.</span></span> <span data-ttu-id="99f1c-477">Vous verrez différents niveaux de performances selon la distribution sur laquelle votre charge de travail est exécutée.</span><span class="sxs-lookup"><span data-stu-id="99f1c-477">You will see different levels of performance depending on the distro your workload is running on.</span></span> <span data-ttu-id="99f1c-478">Testez les distributions Linux avec votre application et choisissez celle qui vous convient le mieux.</span><span class="sxs-lookup"><span data-stu-id="99f1c-478">Test the Linux distros with your application and choose the one that works best.</span></span>

<span data-ttu-id="99f1c-479">Lorsque vous exécutez Linux avec Premium Storage, vérifiez les dernières mises à jour sur les pilotes requis pour garantir de meilleures performances.</span><span class="sxs-lookup"><span data-stu-id="99f1c-479">When running Linux with Premium Storage, check the latest updates about required drivers to ensure high performance.</span></span>

## <a name="premium-storage-disk-sizes"></a><span data-ttu-id="99f1c-480">Tailles de disques Premium Storage</span><span class="sxs-lookup"><span data-stu-id="99f1c-480">Premium Storage Disk Sizes</span></span>
<span data-ttu-id="99f1c-481">Azure Premium Storage offre actuellement sept tailles de disque.</span><span class="sxs-lookup"><span data-stu-id="99f1c-481">Azure Premium Storage offers seven disk sizes currently.</span></span> <span data-ttu-id="99f1c-482">Chaque taille de disque a une limite de mise à l’échelle bien spécifique pour le nombre d’E/S par seconde, la bande passante et le stockage.</span><span class="sxs-lookup"><span data-stu-id="99f1c-482">Each disk size has a different scale limit for IOPS, Bandwidth and Storage.</span></span> <span data-ttu-id="99f1c-483">Choisissez la taille de disque Premium Storage adaptée aux exigences de l’application et à la taille de machine virtuelle à grande échelle.</span><span class="sxs-lookup"><span data-stu-id="99f1c-483">Choose the right Premium Storage Disk size depending on the application requirements and the high scale VM size.</span></span> <span data-ttu-id="99f1c-484">Le tableau ci-dessous répertorie les sept tailles de disque et leurs fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="99f1c-484">The table below shows the seven disks sizes and their capabilities.</span></span> <span data-ttu-id="99f1c-485">Les tailles de disque P4 et P6 ne sont actuellement prises en charge que par Managed Disks.</span><span class="sxs-lookup"><span data-stu-id="99f1c-485">P4 and P6 sizes are currently only supported for Managed Disks.</span></span>

| <span data-ttu-id="99f1c-486">Type de disque Premium</span><span class="sxs-lookup"><span data-stu-id="99f1c-486">Premium Disks Type</span></span>  | <span data-ttu-id="99f1c-487">P4</span><span class="sxs-lookup"><span data-stu-id="99f1c-487">P4</span></span>    | <span data-ttu-id="99f1c-488">P6</span><span class="sxs-lookup"><span data-stu-id="99f1c-488">P6</span></span>    | <span data-ttu-id="99f1c-489">P10</span><span class="sxs-lookup"><span data-stu-id="99f1c-489">P10</span></span>   | <span data-ttu-id="99f1c-490">P20</span><span class="sxs-lookup"><span data-stu-id="99f1c-490">P20</span></span>   | <span data-ttu-id="99f1c-491">P30</span><span class="sxs-lookup"><span data-stu-id="99f1c-491">P30</span></span>   | <span data-ttu-id="99f1c-492">P40</span><span class="sxs-lookup"><span data-stu-id="99f1c-492">P40</span></span>   | <span data-ttu-id="99f1c-493">P50</span><span class="sxs-lookup"><span data-stu-id="99f1c-493">P50</span></span>   | 
|---------------------|-------|-------|-------|-------|-------|-------|-------|
| <span data-ttu-id="99f1c-494">Taille du disque</span><span class="sxs-lookup"><span data-stu-id="99f1c-494">Disk size</span></span>           | <span data-ttu-id="99f1c-495">32 Go</span><span class="sxs-lookup"><span data-stu-id="99f1c-495">32 GB</span></span> | <span data-ttu-id="99f1c-496">64 Go</span><span class="sxs-lookup"><span data-stu-id="99f1c-496">64 GB</span></span> | <span data-ttu-id="99f1c-497">128 Go</span><span class="sxs-lookup"><span data-stu-id="99f1c-497">128 GB</span></span>| <span data-ttu-id="99f1c-498">512 Go</span><span class="sxs-lookup"><span data-stu-id="99f1c-498">512 GB</span></span>            | <span data-ttu-id="99f1c-499">1024 Go (1 To)</span><span class="sxs-lookup"><span data-stu-id="99f1c-499">1024 GB (1 TB)</span></span>    | <span data-ttu-id="99f1c-500">2 048 Go (2 To)</span><span class="sxs-lookup"><span data-stu-id="99f1c-500">2048 GB (2 TB)</span></span>    | <span data-ttu-id="99f1c-501">4 095 Go (4 To)</span><span class="sxs-lookup"><span data-stu-id="99f1c-501">4095 GB (4 TB)</span></span>    | 
| <span data-ttu-id="99f1c-502">IOPS par disque</span><span class="sxs-lookup"><span data-stu-id="99f1c-502">IOPS per disk</span></span>       | <span data-ttu-id="99f1c-503">120</span><span class="sxs-lookup"><span data-stu-id="99f1c-503">120</span></span>   | <span data-ttu-id="99f1c-504">240</span><span class="sxs-lookup"><span data-stu-id="99f1c-504">240</span></span>   | <span data-ttu-id="99f1c-505">500</span><span class="sxs-lookup"><span data-stu-id="99f1c-505">500</span></span>   | <span data-ttu-id="99f1c-506">2 300</span><span class="sxs-lookup"><span data-stu-id="99f1c-506">2300</span></span>              | <span data-ttu-id="99f1c-507">5 000</span><span class="sxs-lookup"><span data-stu-id="99f1c-507">5000</span></span>              | <span data-ttu-id="99f1c-508">7500</span><span class="sxs-lookup"><span data-stu-id="99f1c-508">7500</span></span>              | <span data-ttu-id="99f1c-509">7500</span><span class="sxs-lookup"><span data-stu-id="99f1c-509">7500</span></span>              | 
| <span data-ttu-id="99f1c-510">Débit par disque</span><span class="sxs-lookup"><span data-stu-id="99f1c-510">Throughput per disk</span></span> | <span data-ttu-id="99f1c-511">25 Mo par seconde</span><span class="sxs-lookup"><span data-stu-id="99f1c-511">25 MB per second</span></span>  | <span data-ttu-id="99f1c-512">50 Mo par seconde</span><span class="sxs-lookup"><span data-stu-id="99f1c-512">50 MB per second</span></span>  | <span data-ttu-id="99f1c-513">100 Mo par seconde</span><span class="sxs-lookup"><span data-stu-id="99f1c-513">100 MB per second</span></span> | <span data-ttu-id="99f1c-514">150 Mo par seconde</span><span class="sxs-lookup"><span data-stu-id="99f1c-514">150 MB per second</span></span> | <span data-ttu-id="99f1c-515">200 Mo par seconde</span><span class="sxs-lookup"><span data-stu-id="99f1c-515">200 MB per second</span></span> | <span data-ttu-id="99f1c-516">250 Mo par seconde</span><span class="sxs-lookup"><span data-stu-id="99f1c-516">250 MB per second</span></span> | <span data-ttu-id="99f1c-517">250 Mo par seconde</span><span class="sxs-lookup"><span data-stu-id="99f1c-517">250 MB per second</span></span> | 


<span data-ttu-id="99f1c-518">Le nombre de disques que vous choisissez dépend de la taille de disque choisie.</span><span class="sxs-lookup"><span data-stu-id="99f1c-518">How many disks you choose depends on the disk size chosen.</span></span> <span data-ttu-id="99f1c-519">Vous pouvez utiliser un seul disque P50 ou plusieurs disques P10 pour répondre aux besoins de votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-519">You could use a single P50 disk or multiple P10 disks to meet your application requirement.</span></span> <span data-ttu-id="99f1c-520">Tenez compte des remarques ci-dessous pour faire votre choix.</span><span class="sxs-lookup"><span data-stu-id="99f1c-520">Take into account considerations listed below when making the choice.</span></span>

<span data-ttu-id="99f1c-521">*Limites de mise à l’échelle (E/S par seconde et débit)*</span><span class="sxs-lookup"><span data-stu-id="99f1c-521">*Scale Limits (IOPS and Throughput)*</span></span>  
<span data-ttu-id="99f1c-522">Les limites d’E/S par seconde et de débit de chaque taille de disque Premium sont différentes et indépendantes des limites de mise à l’échelle de la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="99f1c-522">The IOPS and Throughput limits of each Premium disk size is different and independent from the VM scale limits.</span></span> <span data-ttu-id="99f1c-523">Assurez-vous que le nombre total d’E/S par seconde et le débit total des disques respectent bien les limites de mise à l’échelle de la taille de machine virtuelle choisie.</span><span class="sxs-lookup"><span data-stu-id="99f1c-523">Make sure that the total IOPS and Throughput from the disks are within scale limits of the chosen VM size.</span></span>

<span data-ttu-id="99f1c-524">Imaginez par exemple que votre application requiert un débit maximum de 250 Mo/s et que vous utilisez une machine virtuelle DS4 avec un seul disque P30.</span><span class="sxs-lookup"><span data-stu-id="99f1c-524">For example, if an application requirement is a maximum of 250 MB/sec Throughput and you are using a DS4 VM with a single P30 disk.</span></span> <span data-ttu-id="99f1c-525">La machine virtuelle DS4 peut délivrer un débit maximum de 256 Mo/s.</span><span class="sxs-lookup"><span data-stu-id="99f1c-525">The DS4 VM can give up to 256 MB/sec Throughput.</span></span> <span data-ttu-id="99f1c-526">Toutefois, un seul disque P30 a une limite de débit de 200 Mo/s.</span><span class="sxs-lookup"><span data-stu-id="99f1c-526">However, a single P30 disk has Throughput limit of 200 MB/sec.</span></span> <span data-ttu-id="99f1c-527">Par conséquent, l’application sera contrainte à 200 Mo/s en raison de la limite de disque.</span><span class="sxs-lookup"><span data-stu-id="99f1c-527">Consequently, the application will be constrained at 200 MB/sec due to the disk limit.</span></span> <span data-ttu-id="99f1c-528">Pour contourner cette limite, configurez plusieurs disques de données sur la machine virtuelle ou redimensionnez vos disques (de P40 à P50).</span><span class="sxs-lookup"><span data-stu-id="99f1c-528">To overcome this limit, provision more than one data disks to the VM or resize your disks to P40 or P50.</span></span>

> [!NOTE]
> <span data-ttu-id="99f1c-529">Les lectures traitées par le cache n’étant pas incluses dans les E/S et le débit de disque, elles ne sont pas soumises aux limites de disque.</span><span class="sxs-lookup"><span data-stu-id="99f1c-529">Reads served by the cache are not included in the disk IOPS and Throughput, hence not subject to disk limits.</span></span> <span data-ttu-id="99f1c-530">Le cache possède sa propre limite de débit et d’E/S pour chaque machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="99f1c-530">Cache has its separate IOPS and Throughput limit per VM.</span></span>
>
> <span data-ttu-id="99f1c-531">Par exemple, les lectures et écritures sont initialement de 60 Mo/s et 40 Mo/s respectivement.</span><span class="sxs-lookup"><span data-stu-id="99f1c-531">For example, initially your reads and writes are 60MB/sec and 40MB/sec respectively.</span></span> <span data-ttu-id="99f1c-532">Au fil du temps, le cache augmente et sert de plus en plus de lectures.</span><span class="sxs-lookup"><span data-stu-id="99f1c-532">Over time, the cache warms up and serves more and more of the reads from the cache.</span></span> <span data-ttu-id="99f1c-533">Vous pouvez alors obtenir un plus grand débit en écriture à partir du disque.</span><span class="sxs-lookup"><span data-stu-id="99f1c-533">Then, you can get higher write Throughput from the disk.</span></span>
>
>

<span data-ttu-id="99f1c-534">*Nombre de disques*</span><span class="sxs-lookup"><span data-stu-id="99f1c-534">*Number of Disks*</span></span>  
<span data-ttu-id="99f1c-535">Déterminez le nombre de disques dont vous aurez besoin en évaluant les besoins de l’application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-535">Determine the number of disks you will need by assessing application requirements.</span></span> <span data-ttu-id="99f1c-536">Chaque taille de chaque machine virtuelle est limitée quant au nombre de disques que vous pouvez lui associer.</span><span class="sxs-lookup"><span data-stu-id="99f1c-536">Each VM size also has a limit on the number of disks that you can attach to the VM.</span></span> <span data-ttu-id="99f1c-537">En règle générale, ce nombre est égal à deux fois le nombre de cœurs.</span><span class="sxs-lookup"><span data-stu-id="99f1c-537">Typically, this is twice the number of cores.</span></span> <span data-ttu-id="99f1c-538">Assurez-vous que la taille de machine virtuelle que vous choisissez est capable de prendre en charge le nombre de disques nécessaires.</span><span class="sxs-lookup"><span data-stu-id="99f1c-538">Ensure that the VM size you choose can support the number of disks needed.</span></span>

<span data-ttu-id="99f1c-539">N’oubliez pas les disques Premium Storage délivrent des performances supérieures à celles des disques de stockage Standard.</span><span class="sxs-lookup"><span data-stu-id="99f1c-539">Remember, the Premium Storage disks have higher performance capabilities compared to Standard Storage disks.</span></span> <span data-ttu-id="99f1c-540">Par conséquent, si vous migrez votre application d’un stockage Standard à un stockage Premium à partir d’une machine virtuelle IaaS Azure, vous aurez probablement besoin de moins de disques premium pour atteindre des performances identiques ou supérieures pour votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-540">Therefore, if you are migrating your application from Azure IaaS VM using Standard Storage to Premium Storage, you will likely need fewer premium disks to achieve the same or higher performance for your application.</span></span>

## <a name="disk-caching"></a><span data-ttu-id="99f1c-541">Mise en cache du disque</span><span class="sxs-lookup"><span data-stu-id="99f1c-541">Disk Caching</span></span>
<span data-ttu-id="99f1c-542">Les machines virtuelles à grande échelle qui exploitent Azure Premium Storage ont une technologie de mise en cache à plusieurs niveaux appelée BlobCache.</span><span class="sxs-lookup"><span data-stu-id="99f1c-542">High Scale VMs that leverage Azure Premium Storage have a multi-tier caching technology called BlobCache.</span></span> <span data-ttu-id="99f1c-543">BlobCache utilise à la fois la RAM de la machine virtuelle et le SSD local pour la mise en cache.</span><span class="sxs-lookup"><span data-stu-id="99f1c-543">BlobCache uses a combination of the Virtual Machine RAM and local SSD for caching.</span></span> <span data-ttu-id="99f1c-544">Ce cache est disponible pour les disques persistants Premium Storage et pour les disques locaux de la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="99f1c-544">This cache is available for the Premium Storage persistent disks and the VM local disks.</span></span> <span data-ttu-id="99f1c-545">Par défaut, ce paramètre de cache est défini en lecture/écriture pour les disques du système d’exploitation et en lecture seule pour les disques de données hébergés sur Premium Storage.</span><span class="sxs-lookup"><span data-stu-id="99f1c-545">By default, this cache setting is set to Read/Write for OS disks and ReadOnly for data disks hosted on Premium Storage.</span></span> <span data-ttu-id="99f1c-546">Lorsque la mise en cache du disque est activée sur les disques Premium Storage, les machines virtuelles à grande échelle peuvent atteindre des niveaux de performances extrêmement élevés qui dépassent les performances du disque sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="99f1c-546">With disk caching enabled on the Premium Storage disks, the high scale VMs can achieve extremely high levels of performance that exceed the underlying disk performance.</span></span>

> [!WARNING]
> <span data-ttu-id="99f1c-547">La modification du paramètre de cache d’un disque Azure détache et rattache le disque cible.</span><span class="sxs-lookup"><span data-stu-id="99f1c-547">Changing the cache setting of an Azure disk detaches and re-attaches the target disk.</span></span> <span data-ttu-id="99f1c-548">S’il s’agit du disque du système d’exploitation, la machine virtuelle redémarre.</span><span class="sxs-lookup"><span data-stu-id="99f1c-548">If it is the operating system disk, the VM is restarted.</span></span> <span data-ttu-id="99f1c-549">Arrêtez toutes les applications et services qui risquent d’être affectés par cette indisponibilité avant de modifier le paramètre de cache du disque.</span><span class="sxs-lookup"><span data-stu-id="99f1c-549">Stop all applications/services that might be affected by this disruption before changing the disk cache setting.</span></span>
>
>

<span data-ttu-id="99f1c-550">Pour en savoir plus sur le fonctionnement de BlobCache, reportez-vous à l’article du blog interne [Azure Premium Storage](https://azure.microsoft.com/blog/azure-premium-storage-now-generally-available-2/) .</span><span class="sxs-lookup"><span data-stu-id="99f1c-550">To learn more about how BlobCache works, refer to the Inside [Azure Premium Storage](https://azure.microsoft.com/blog/azure-premium-storage-now-generally-available-2/) blog post.</span></span>

<span data-ttu-id="99f1c-551">Il est important d’activer le cache sur le jeu de disques approprié.</span><span class="sxs-lookup"><span data-stu-id="99f1c-551">It is important to enable cache on the right set of disks.</span></span> <span data-ttu-id="99f1c-552">Le fait de devoir activer ou non la mise en cache du disque sur un disque premium dépendra du modèle de charge de travail que ce disque doit gérer.</span><span class="sxs-lookup"><span data-stu-id="99f1c-552">Whether you should enable disk caching on a premium disk or not will depend on the workload pattern that disk will be handling.</span></span> <span data-ttu-id="99f1c-553">Le tableau ci-dessous répertorie les paramètres de cache par défaut pour les disques du système d’exploitation et les disques de données.</span><span class="sxs-lookup"><span data-stu-id="99f1c-553">Table below shows the default cache settings for OS and Data disks.</span></span>

| <span data-ttu-id="99f1c-554">**Type de disque**</span><span class="sxs-lookup"><span data-stu-id="99f1c-554">**Disk Type**</span></span> | <span data-ttu-id="99f1c-555">**Paramètre de cache par défaut**</span><span class="sxs-lookup"><span data-stu-id="99f1c-555">**Default Cache Setting**</span></span> |
| --- | --- |
| <span data-ttu-id="99f1c-556">Disque de système d’exploitation</span><span class="sxs-lookup"><span data-stu-id="99f1c-556">OS disk</span></span> |<span data-ttu-id="99f1c-557">Lecture/écriture</span><span class="sxs-lookup"><span data-stu-id="99f1c-557">ReadWrite</span></span> |
| <span data-ttu-id="99f1c-558">Disque de données</span><span class="sxs-lookup"><span data-stu-id="99f1c-558">Data disk</span></span> |<span data-ttu-id="99f1c-559">Aucun</span><span class="sxs-lookup"><span data-stu-id="99f1c-559">None</span></span> |

<span data-ttu-id="99f1c-560">Voici les paramètres de cache de disque recommandés pour les disques de données :</span><span class="sxs-lookup"><span data-stu-id="99f1c-560">Following are the recommended disk cache settings for data disks,</span></span>

| <span data-ttu-id="99f1c-561">**Paramètre de mise en cache du disque**</span><span class="sxs-lookup"><span data-stu-id="99f1c-561">**Disk Caching Setting**</span></span> | <span data-ttu-id="99f1c-562">**Conditions recommandées d’utilisation de ce paramètre**</span><span class="sxs-lookup"><span data-stu-id="99f1c-562">**Recommendation on when to use this setting**</span></span> |
| --- | --- |
| <span data-ttu-id="99f1c-563">Aucun</span><span class="sxs-lookup"><span data-stu-id="99f1c-563">None</span></span> |<span data-ttu-id="99f1c-564">Configurer le cache hôte sur cette option pour les disques en lecture seule et les disques gourmands en écriture.</span><span class="sxs-lookup"><span data-stu-id="99f1c-564">Configure host-cache as None for write-only and write-heavy disks.</span></span> |
| <span data-ttu-id="99f1c-565">Lecture seule</span><span class="sxs-lookup"><span data-stu-id="99f1c-565">ReadOnly</span></span> |<span data-ttu-id="99f1c-566">Configurer le cache hôte en lecture seule pour les disques en lecture seule et les disques en lecture/écriture.</span><span class="sxs-lookup"><span data-stu-id="99f1c-566">Configure host-cache as ReadOnly for read-only and read-write disks.</span></span> |
| <span data-ttu-id="99f1c-567">Lecture/écriture</span><span class="sxs-lookup"><span data-stu-id="99f1c-567">ReadWrite</span></span> |<span data-ttu-id="99f1c-568">Configurer le cache hôte en lecture/écriture uniquement si votre application gère correctement l’écriture des données mises en cache sur les disques persistants lorsque cela est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="99f1c-568">Configure host-cache as ReadWrite only if your application properly  handles writing cached data to persistent disks when needed.</span></span> |

<span data-ttu-id="99f1c-569">*Lecture seule*</span><span class="sxs-lookup"><span data-stu-id="99f1c-569">*ReadOnly*</span></span>  
<span data-ttu-id="99f1c-570">En configurant une mise en cache en lecture seule sur des disques de données Premium Storage, vous pouvez obtenir une faible latence de lecture et obtenir de très hautes performances d’E/S et de débit en lecture pour votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-570">By configuring ReadOnly caching on Premium Storage data disks, you can achieve low Read latency and get very high Read IOPS and Throughput for your application.</span></span> <span data-ttu-id="99f1c-571">Cela est dû à deux raisons :</span><span class="sxs-lookup"><span data-stu-id="99f1c-571">This is due two reasons,</span></span>

1. <span data-ttu-id="99f1c-572">Les lectures effectuées à partir du cache, qui se trouvent sur la mémoire virtuelle et sur le SSD local, sont beaucoup plus rapides que les lectures effectuées à partir du disque de données, qui réside sur Azure Blob Storage.</span><span class="sxs-lookup"><span data-stu-id="99f1c-572">Reads performed from cache, which is on the VM memory and local SSD, are much faster than reads from the data disk, which is on the Azure blob storage.</span></span>  
2. <span data-ttu-id="99f1c-573">Premium Storage ne tient pas compte des lectures traitées à partir du cache pour le calcul du nombre d’E/S par seconde et du débit du disque.</span><span class="sxs-lookup"><span data-stu-id="99f1c-573">Premium Storage does not count the Reads served from cache, towards the disk IOPS and Throughput.</span></span> <span data-ttu-id="99f1c-574">Par conséquent, votre application est en mesure de délivrer de meilleures performances totales en termes d’E/S par seconde et de débit.</span><span class="sxs-lookup"><span data-stu-id="99f1c-574">Therefore, your application is able to achieve higher total IOPS and Throughput.</span></span>

<span data-ttu-id="99f1c-575">*Lecture/écriture*</span><span class="sxs-lookup"><span data-stu-id="99f1c-575">*ReadWrite*</span></span>  
<span data-ttu-id="99f1c-576">Par défaut, le cache en lecture/écriture est activé sur les disques du système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="99f1c-576">By default, the OS disks have ReadWrite caching enabled.</span></span> <span data-ttu-id="99f1c-577">Nous avons récemment ajouté la prise en charge de la mise en cache en lecture/écriture sur les données des disques.</span><span class="sxs-lookup"><span data-stu-id="99f1c-577">We have recently added support for ReadWrite caching on data disks as well.</span></span> <span data-ttu-id="99f1c-578">Si vous utilisez la mise en cache en lecture/écriture, vous devez disposer d’un moyen approprié d’écrire les données du cache sur des disques persistants.</span><span class="sxs-lookup"><span data-stu-id="99f1c-578">If you are using ReadWrite caching, you must have a proper way to write the data from cache to persistent disks.</span></span> <span data-ttu-id="99f1c-579">Par exemple, SQL Server gère lui-même l’écriture de données mises en cache sur les disques de stockage persistants.</span><span class="sxs-lookup"><span data-stu-id="99f1c-579">For example, SQL Server handles writing cached data to the persistent storage disks on its own.</span></span> <span data-ttu-id="99f1c-580">L’utilisation d’un cache en lecture/écriture avec une application qui ne gère pas la persistance des données requises peut entraîner des pertes de données en cas de panne de la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="99f1c-580">Using ReadWrite cache with an application that does not handle persisting the required data can lead to data loss, if the VM crashes.</span></span>

<span data-ttu-id="99f1c-581">Par exemple, vous pouvez appliquer ces instructions à une instance SQL Server exécutée sur Premium Storage de la manière suivante :</span><span class="sxs-lookup"><span data-stu-id="99f1c-581">As an example, you can apply these guidelines to SQL Server running on Premium Storage by doing the following,</span></span>

1. <span data-ttu-id="99f1c-582">Configurez le cache en lecture seule sur les disques de stockage Premium qui hébergent des fichiers de données.</span><span class="sxs-lookup"><span data-stu-id="99f1c-582">Configure "ReadOnly" cache on premium storage disks hosting data files.</span></span>  
   <span data-ttu-id="99f1c-583">a.</span><span class="sxs-lookup"><span data-stu-id="99f1c-583">a.</span></span>  <span data-ttu-id="99f1c-584">Les lectures rapides du cache réduisent le temps de requête de SQL Server puisque les pages de données sont récupérées à partir du cache bien plus rapidement que lorsque l’opération s’effectue directement à partir des disques de données.</span><span class="sxs-lookup"><span data-stu-id="99f1c-584">The fast reads from cache lower the SQL Server query time since data pages are retrieved much faster from the cache compared to directly from the data disks.</span></span>  
   <span data-ttu-id="99f1c-585">b.</span><span class="sxs-lookup"><span data-stu-id="99f1c-585">b.</span></span>  <span data-ttu-id="99f1c-586">Le traitement des lectures à partir du cache signifie que les disques de données premium délivrent un débit supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="99f1c-586">Serving reads from cache, means there is additional Throughput available from premium data disks.</span></span> <span data-ttu-id="99f1c-587">SQL Server peut utiliser ce débit supplémentaire pour la récupération d’un plus grand nombre de pages de données et d’autres opérations telles que la sauvegarde/restauration, les charges de traitement par lots et les reconstructions d’index.</span><span class="sxs-lookup"><span data-stu-id="99f1c-587">SQL Server can use this additional Throughput towards retrieving more data pages and other operations like backup/restore, batch loads, and index rebuilds.</span></span>  
2. <span data-ttu-id="99f1c-588">Choisissez l’option « Aucun » pour le cache sur les disques de stockage Premium qui hébergent des fichiers journaux.</span><span class="sxs-lookup"><span data-stu-id="99f1c-588">Configure "None" cache on premium storage disks hosting the log files.</span></span>  
   <span data-ttu-id="99f1c-589">a.</span><span class="sxs-lookup"><span data-stu-id="99f1c-589">a.</span></span>  <span data-ttu-id="99f1c-590">Les fichiers journaux ont principalement des opérations d’écriture intensives.</span><span class="sxs-lookup"><span data-stu-id="99f1c-590">Log files have primarily write-heavy operations.</span></span> <span data-ttu-id="99f1c-591">Ils ne bénéficient donc pas du cache en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="99f1c-591">Therefore, they do not benefit from the ReadOnly cache.</span></span>

## <a name="disk-striping"></a><span data-ttu-id="99f1c-592">Entrelacement de disques</span><span class="sxs-lookup"><span data-stu-id="99f1c-592">Disk Striping</span></span>
<span data-ttu-id="99f1c-593">Lorsqu’une machine virtuelle à grande échelle est connectée à plusieurs disques de stockage premium persistants, les disques peuvent être entrelacés ensemble pour agréger les E/S par seconde, la bande passante et la capacité de stockage.</span><span class="sxs-lookup"><span data-stu-id="99f1c-593">When a high scale VM is attached with several premium storage persistent disks, the disks can be striped together to aggregate their IOPs, bandwidth, and storage capacity.</span></span>

<span data-ttu-id="99f1c-594">Sous Windows, vous pouvez utiliser les espaces de stockage pour entrelacer les disques.</span><span class="sxs-lookup"><span data-stu-id="99f1c-594">On Windows, you can use Storage Spaces to stripe disks together.</span></span> <span data-ttu-id="99f1c-595">Vous devez configurer une seule colonne pour chaque disque dans un pool.</span><span class="sxs-lookup"><span data-stu-id="99f1c-595">You must configure one column for each disk in a pool.</span></span> <span data-ttu-id="99f1c-596">Dans le cas contraire, les performances globales du volume entrelacé peuvent être limitées, en raison d’une distribution inégale du trafic sur les disques.</span><span class="sxs-lookup"><span data-stu-id="99f1c-596">Otherwise, the overall performance of striped volume can be lower than expected, due to uneven distribution of traffic across the disks.</span></span>

<span data-ttu-id="99f1c-597">Important : avec l’interface utilisateur du Gestionnaire de serveurs, vous pouvez définir un nombre maximal de 8 colonnes au total pour un volume entrelacé.</span><span class="sxs-lookup"><span data-stu-id="99f1c-597">Important: Using Server Manager UI, you can set the total number of columns up to 8 for a striped volume.</span></span> <span data-ttu-id="99f1c-598">Au-delà de 8 disques, utilisez PowerShell pour créer le volume.</span><span class="sxs-lookup"><span data-stu-id="99f1c-598">When attaching more than 8 disks, use PowerShell to create the volume.</span></span> <span data-ttu-id="99f1c-599">PowerShell vous permet de définir un nombre de colonnes égal au nombre de disques.</span><span class="sxs-lookup"><span data-stu-id="99f1c-599">Using PowerShell, you can set the number of columns equal to the number of disks.</span></span> <span data-ttu-id="99f1c-600">Par exemple, s’il existe 16 disques dans un agrégat unique, spécifiez 16 colonnes dans le paramètre *NumberOfColumns* de l’applet de commande *New-VirtualDisk*.</span><span class="sxs-lookup"><span data-stu-id="99f1c-600">For example, if there are 16 disks in a single stripe set; specify 16 columns in the *NumberOfColumns* parameter of the *New-VirtualDisk* PowerShell cmdlet.</span></span>

<span data-ttu-id="99f1c-601">Sous Linux, utilisez l’utilitaire MDADM pour entrelacer les disques.</span><span class="sxs-lookup"><span data-stu-id="99f1c-601">On Linux, use the MDADM utility to stripe disks together.</span></span> <span data-ttu-id="99f1c-602">Pour obtenir des instructions détaillées sur l’entrelacement de disques sous Linux, reportez-vous à [Configuration d’un RAID logiciel sous Linux](../virtual-machines/linux/configure-raid.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="99f1c-602">For detailed steps on striping disks on Linux refer to [Configure Software RAID on Linux](../virtual-machines/linux/configure-raid.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span></span>

<span data-ttu-id="99f1c-603">*Taille de l’entrelacement*</span><span class="sxs-lookup"><span data-stu-id="99f1c-603">*Stripe Size*</span></span>  
<span data-ttu-id="99f1c-604">La taille d’entrelacement constitue un facteur important dans la configuration de l’entrelacement de disques.</span><span class="sxs-lookup"><span data-stu-id="99f1c-604">An important configuration in disk striping is the stripe size.</span></span> <span data-ttu-id="99f1c-605">La taille d’entrelacement ou la taille de bloc représente la plus petite partie des données que l’application peut traiter sur un volume entrelacé.</span><span class="sxs-lookup"><span data-stu-id="99f1c-605">The stripe size or block size is the smallest chunk of data that application can address on a striped volume.</span></span> <span data-ttu-id="99f1c-606">La taille d’entrelacement que vous configurez varie selon le type d’application et le modèle de demande associé.</span><span class="sxs-lookup"><span data-stu-id="99f1c-606">The stripe size you configure depends on the type of application and its request pattern.</span></span> <span data-ttu-id="99f1c-607">Si vous choisissez une taille d’entrelacement incorrecte, vous risquez de rencontrer un défaut d’alignement des E/S, ce qui conduirait à une dégradation des performances de votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-607">If you choose the wrong stripe size, it could lead to IO misalignment, which leads to degraded performance of your application.</span></span>

<span data-ttu-id="99f1c-608">Par exemple, si une demande d’E/S générée par votre application est supérieure à la taille d’entrelacement de disque, le système de stockage écrira au-delà des limites d’unité de bande sur plusieurs disques.</span><span class="sxs-lookup"><span data-stu-id="99f1c-608">For example, if an IO request generated by your application is bigger than the disk stripe size, the storage system writes it across stripe unit boundaries on more than one disk.</span></span> <span data-ttu-id="99f1c-609">Au moment d’accéder aux données, il devra effectuer une recherche sur plusieurs unités de bande pour exécuter la demande.</span><span class="sxs-lookup"><span data-stu-id="99f1c-609">When it is time to access that data, it will have to seek across more than one stripe units to complete the request.</span></span> <span data-ttu-id="99f1c-610">L’effet cumulatif de ce comportement peut entraîner une dégradation significative des performances.</span><span class="sxs-lookup"><span data-stu-id="99f1c-610">The cumulative effect of such behavior can lead to substantial performance degradation.</span></span> <span data-ttu-id="99f1c-611">En revanche, si la taille de la demande d’E/S est inférieure à la taille d’entrelacement, et si ces E/S sont aléatoires par nature, les demandes d’E/S peuvent s’ajouter sur le même disque et provoquer un goulot d’étranglement responsable d’une dégradation des performances d’E/S.</span><span class="sxs-lookup"><span data-stu-id="99f1c-611">On the other hand, if the IO request size is smaller than stripe size, and if it is random in nature, the IO requests may add up on the same disk causing a bottleneck and ultimately degrading the IO performance.</span></span>

<span data-ttu-id="99f1c-612">Selon le type de charge de travail que votre application exécute, choisissez une taille d’entrelacement appropriée.</span><span class="sxs-lookup"><span data-stu-id="99f1c-612">Depending on the type of workload your application is running, choose an appropriate stripe size.</span></span> <span data-ttu-id="99f1c-613">Pour les petites demandes d’E/S aléatoires, utilisez une plus petite taille d’entrelacement.</span><span class="sxs-lookup"><span data-stu-id="99f1c-613">For random small IO requests, use a smaller stripe size.</span></span> <span data-ttu-id="99f1c-614">Pour de grandes demandes d’E/S séquentielles, utilisez en revanche une plus grande taille d’entrelacement.</span><span class="sxs-lookup"><span data-stu-id="99f1c-614">Whereas, for large sequential IO requests use a larger stripe size.</span></span> <span data-ttu-id="99f1c-615">Découvrez les tailles d’entrelacement recommandées pour l’application exécutée sur Premium Storage.</span><span class="sxs-lookup"><span data-stu-id="99f1c-615">Find out the stripe size recommendations for the application you will be running on Premium Storage.</span></span> <span data-ttu-id="99f1c-616">Pour SQL Server, configurez une taille d’entrelacement de 64 Ko pour les charges de travail OLTP et de 256 Ko pour les charges de travail d’entrepôt de données.</span><span class="sxs-lookup"><span data-stu-id="99f1c-616">For SQL Server, configure stripe size of 64KB for OLTP workloads and 256KB for data warehousing workloads.</span></span> <span data-ttu-id="99f1c-617">Pour en savoir plus, consultez [Meilleures pratiques relatives aux performances de SQL Server dans Azure Virtual Machines](../virtual-machines/windows/sql/virtual-machines-windows-sql-performance.md#disks-guidance)</span><span class="sxs-lookup"><span data-stu-id="99f1c-617">See [Performance best practices for SQL Server on Azure VMs](../virtual-machines/windows/sql/virtual-machines-windows-sql-performance.md#disks-guidance) to learn more.</span></span>

> [!NOTE]
> <span data-ttu-id="99f1c-618">vous pouvez entrelacer au maximum 32 disques de stockage premium sur une machine virtuelle DS et 64 disques de stockage premium sur une machine virtuelle GS.</span><span class="sxs-lookup"><span data-stu-id="99f1c-618">You can stripe together a maximum of 32 premium storage disks on a DS series VM and 64 premium storage disks on a GS series VM.</span></span>
>
>

## <a name="multi-threading"></a><span data-ttu-id="99f1c-619">Multithreading</span><span class="sxs-lookup"><span data-stu-id="99f1c-619">Multi-threading</span></span>
<span data-ttu-id="99f1c-620">Azure a conçu une plate-forme Premium Storage hautement parallèle.</span><span class="sxs-lookup"><span data-stu-id="99f1c-620">Azure has designed Premium Storage platform to be massively parallel.</span></span> <span data-ttu-id="99f1c-621">Par conséquent, une application multithread délivre de bien meilleures performances qu’une application à thread unique.</span><span class="sxs-lookup"><span data-stu-id="99f1c-621">Therefore, a multi-threaded application achieves much higher performance than a single-threaded application.</span></span> <span data-ttu-id="99f1c-622">Une application multithread répartit ses tâches sur plusieurs threads et augmente l’efficacité de son exécution en utilisant au maximum les ressources de machine virtuelle et de disque.</span><span class="sxs-lookup"><span data-stu-id="99f1c-622">A multi-threaded application splits up its tasks across multiple threads and increases efficiency of its execution by utilizing the VM and disk resources to the maximum.</span></span>

<span data-ttu-id="99f1c-623">Par exemple, si votre application s’exécute sur une machine virtuelle monocœur utilisant deux threads, le processeur peut basculer entre les deux threads pour gagner en efficacité.</span><span class="sxs-lookup"><span data-stu-id="99f1c-623">For example, if your application is running on a single core VM using two threads, the CPU can switch between the two threads to achieve efficiency.</span></span> <span data-ttu-id="99f1c-624">En attendant l’exécution d’un thread sur une E/S de disque, le processeur peut basculer vers l’autre thread.</span><span class="sxs-lookup"><span data-stu-id="99f1c-624">While one thread is waiting on a disk IO to complete, the CPU can switch to the other thread.</span></span> <span data-ttu-id="99f1c-625">De cette façon, deux threads peuvent accomplir bien plus qu’un seul thread.</span><span class="sxs-lookup"><span data-stu-id="99f1c-625">In this way, two threads can accomplish more than a single thread would.</span></span> <span data-ttu-id="99f1c-626">Si la machine virtuelle possède plusieurs cœurs, elle réduit davantage le temps d’exécution dans la mesure où chaque cœur peut exécuter des tâches en parallèle.</span><span class="sxs-lookup"><span data-stu-id="99f1c-626">If the VM has more than one core, it further decreases running time since each core can execute tasks in parallel.</span></span>

<span data-ttu-id="99f1c-627">Vous n’êtes peut-être pas en mesure de modifier la façon dont une application du commerce implémente un seul thread ou plusieurs threads.</span><span class="sxs-lookup"><span data-stu-id="99f1c-627">You may not be able to change the way an off-the-shelf application implements single threading or multi-threading.</span></span> <span data-ttu-id="99f1c-628">Par exemple, SQL Server est capable de gérer plusieurs processeurs et plusieurs nœuds.</span><span class="sxs-lookup"><span data-stu-id="99f1c-628">For example, SQL Server is capable of handling multi-CPU and multi-core.</span></span> <span data-ttu-id="99f1c-629">SQL Server détermine cependant dans quelles conditions il utilisera un ou plusieurs threads pour traiter une requête.</span><span class="sxs-lookup"><span data-stu-id="99f1c-629">However, SQL Server decides under what conditions it will leverage one or more threads to process a query.</span></span> <span data-ttu-id="99f1c-630">Il peut exécuter des requêtes et créer des index à l’aide du traitement multithread.</span><span class="sxs-lookup"><span data-stu-id="99f1c-630">It can run queries and build indexes using multi-threading.</span></span> <span data-ttu-id="99f1c-631">Dans le cas d’une requête impliquant une fusion de tables volumineuses et un tri des données avant le renvoi des résultats à l’utilisateur, SQL Server utilisera probablement plusieurs threads.</span><span class="sxs-lookup"><span data-stu-id="99f1c-631">For a query that involves joining large tables and sorting data before returning to the user, SQL Server will likely use multiple threads.</span></span> <span data-ttu-id="99f1c-632">Toutefois, un utilisateur ne peut pas décider si SQL Server exécutera une requête à l’aide d’un ou plusieurs threads.</span><span class="sxs-lookup"><span data-stu-id="99f1c-632">However, a user cannot control whether SQL Server executes a query using a single thread or multiple threads.</span></span>

<span data-ttu-id="99f1c-633">Certains paramètres de configuration peuvent être modifiés pour influencer ce traitement multithread ou parallèle d’une application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-633">There are configuration settings that you can alter to influence this multi-threading or parallel processing of an application.</span></span> <span data-ttu-id="99f1c-634">Dans le cas de SQL Server, par exemple, il s’agit de la configuration maximale de degré de parallélisme.</span><span class="sxs-lookup"><span data-stu-id="99f1c-634">For example, in case of SQL Server it is the maximum Degree of Parallelism configuration.</span></span> <span data-ttu-id="99f1c-635">Ce paramètre appelé MAXDOP permet de configurer le nombre maximal de processeurs que SQL Server peut utiliser lors d’un de traitement parallèle.</span><span class="sxs-lookup"><span data-stu-id="99f1c-635">This setting called MAXDOP, allows you to configure the maximum number of processors SQL Server can use when parallel processing.</span></span> <span data-ttu-id="99f1c-636">Vous pouvez configurer MAXDOP pour des requêtes individuelles ou pour des opérations d’index.</span><span class="sxs-lookup"><span data-stu-id="99f1c-636">You can configure MAXDOP for individual queries or index operations.</span></span> <span data-ttu-id="99f1c-637">Cela vous sera utile si vous souhaitez équilibrer les ressources de votre système pour une application stratégique en termes de performances.</span><span class="sxs-lookup"><span data-stu-id="99f1c-637">This is beneficial when you want to balance resources of your system for a performance critical application.</span></span>

<span data-ttu-id="99f1c-638">Supposons par exemple que votre application basée sur SQL Server exécute simultanément une grande requête et une opération d’index.</span><span class="sxs-lookup"><span data-stu-id="99f1c-638">For example, say your application using SQL Server is executing a large query and an index operation at the same time.</span></span> <span data-ttu-id="99f1c-639">Imaginons que vous souhaitiez que l’opération d’index soit plus performante que la requête volumineuse.</span><span class="sxs-lookup"><span data-stu-id="99f1c-639">Let us assume that you wanted the index operation to be more performant compared to the large query.</span></span> <span data-ttu-id="99f1c-640">Dans ce cas, vous pouvez spécifier une valeur MAXDOP de l’opération d’index supérieure à la valeur MAXDOP de la requête.</span><span class="sxs-lookup"><span data-stu-id="99f1c-640">In such a case, you can set MAXDOP value of the index operation to be higher than the MAXDOP value for the query.</span></span> <span data-ttu-id="99f1c-641">SQL Server dispose ainsi d’un plus grand nombre de processeurs exploitables pour l’opération d’index par rapport au nombre de processeurs qu’il peut consacrer à la requête volumineuse.</span><span class="sxs-lookup"><span data-stu-id="99f1c-641">This way, SQL Server has more number of processors that it can leverage for the index operation compared to the number of processors it can dedicate to the large query.</span></span> <span data-ttu-id="99f1c-642">N’oubliez pas que vous n’avez aucun contrôle sur le nombre de threads que SQL Server utilisera pour chaque opération.</span><span class="sxs-lookup"><span data-stu-id="99f1c-642">Remember, you do not control the number of threads SQL Server will use for each operation.</span></span> <span data-ttu-id="99f1c-643">Vous pouvez contrôler le nombre maximal de processeurs dédiés au traitement multithread.</span><span class="sxs-lookup"><span data-stu-id="99f1c-643">You can control the maximum number of processors being dedicated for multi-threading.</span></span>

<span data-ttu-id="99f1c-644">En savoir plus sur [Degrés de parallélisme](https://technet.microsoft.com/library/ms188611.aspx) dans SQL Server.</span><span class="sxs-lookup"><span data-stu-id="99f1c-644">Learn more about [Degrees of Parallelism](https://technet.microsoft.com/library/ms188611.aspx) in SQL Server.</span></span> <span data-ttu-id="99f1c-645">Découvrez les paramètres qui influencent le traitement multithread dans votre application et leurs configurations pour optimiser les performances.</span><span class="sxs-lookup"><span data-stu-id="99f1c-645">Find out such settings that influence multi-threading in your application and their configurations to optimize performance.</span></span>

## <a name="queue-depth"></a><span data-ttu-id="99f1c-646">Profondeur de file d’attente</span><span class="sxs-lookup"><span data-stu-id="99f1c-646">Queue Depth</span></span>
<span data-ttu-id="99f1c-647">La profondeur, longueur ou taille de file d’attente correspond au nombre de demandes d’E/S en attente dans le système.</span><span class="sxs-lookup"><span data-stu-id="99f1c-647">The Queue Depth or Queue Length or Queue Size is the number of pending IO requests in the system.</span></span> <span data-ttu-id="99f1c-648">La valeur de profondeur de file d’attente détermine le nombre d’opérations d’E/S que votre application peut aligner et qui seront traitées par les disques de stockage.</span><span class="sxs-lookup"><span data-stu-id="99f1c-648">The value of Queue Depth determines how many IO operations your application can line up, which the storage disks will be processing.</span></span> <span data-ttu-id="99f1c-649">Elle affecte les trois indicateurs de performance que nous avons abordés dans cet article, à savoir le nombre d’E/S par seconde, le débit et la latence.</span><span class="sxs-lookup"><span data-stu-id="99f1c-649">It affects all the three application performance indicators that we discussed in this article viz., IOPS, Throughput and Latency.</span></span>

<span data-ttu-id="99f1c-650">La profondeur de file d’attente et le traitement multithread sont étroitement liés.</span><span class="sxs-lookup"><span data-stu-id="99f1c-650">Queue Depth and multi-threading are closely related.</span></span> <span data-ttu-id="99f1c-651">La valeur de profondeur de file d’attente indique dans quelle mesure l’application peut prendre en charge un traitement multithread.</span><span class="sxs-lookup"><span data-stu-id="99f1c-651">The Queue Depth value indicates how much multi-threading can be achieved by the application.</span></span> <span data-ttu-id="99f1c-652">Si la profondeur de file d’attente est importante, l’application peut exécuter davantage d’opérations simultanément, autrement dit un meilleur traitement multithread.</span><span class="sxs-lookup"><span data-stu-id="99f1c-652">If the Queue Depth is large, application can execute more operations concurrently, in other words, more multi-threading.</span></span> <span data-ttu-id="99f1c-653">Si la profondeur de file d’attente est petite, même si l’application est de type multithread, le nombre de demandes alignées sera insuffisant pour permettre une exécution simultanée.</span><span class="sxs-lookup"><span data-stu-id="99f1c-653">If the Queue Depth is small, even though application is multi-threaded, it will not have enough requests lined up for concurrent execution.</span></span>

<span data-ttu-id="99f1c-654">En règle générale, les applications du commerce ne vous permettent pas de modifier la profondeur de la file d’attente, car un paramétrage incorrect peut faire plus de mal que de bien.</span><span class="sxs-lookup"><span data-stu-id="99f1c-654">Typically, off the shelf applications do not allow you to change the queue depth, because if set incorrectly it will do more harm than good.</span></span> <span data-ttu-id="99f1c-655">Les applications définissent la valeur de la profondeur de file d’attente appropriée pour obtenir des performances optimales.</span><span class="sxs-lookup"><span data-stu-id="99f1c-655">Applications will set the right value of queue depth to get the optimal performance.</span></span> <span data-ttu-id="99f1c-656">Il est toutefois important de comprendre ce concept afin de pouvoir résoudre les problèmes de performances que vous pouvez rencontrer avec votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-656">However, it is important to understand this concept so that you can troubleshoot performance issues with your application.</span></span> <span data-ttu-id="99f1c-657">Vous pouvez également observer les effets de la profondeur de file d’attente en exécutant les outils de benchmarking sur votre système.</span><span class="sxs-lookup"><span data-stu-id="99f1c-657">You can also observe the effects of queue depth by running benchmarking tools on your system.</span></span>

<span data-ttu-id="99f1c-658">Certaines applications fournissent des paramètres qui influencent la profondeur de file d’attente.</span><span class="sxs-lookup"><span data-stu-id="99f1c-658">Some applications provide settings to influence the Queue Depth.</span></span> <span data-ttu-id="99f1c-659">Le paramètre MAXDOP (degré maximal de parallélisme) dans SQL Server, par exemple, est expliqué dans la section précédente.</span><span class="sxs-lookup"><span data-stu-id="99f1c-659">For example, the MAXDOP (maximum degree of parallelism) setting in SQL Server explained in previous section.</span></span> <span data-ttu-id="99f1c-660">MAXDOP offre un moyen d’influencer la profondeur de file d’attente et le traitement multithread, sans pour autant modifier directement la valeur de profondeur de file d’attente de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="99f1c-660">MAXDOP is a way to influence Queue Depth and multi-threading, although it does not directly change the Queue Depth value of SQL Server.</span></span>

<span data-ttu-id="99f1c-661">*Grande profondeur de file d’attente*</span><span class="sxs-lookup"><span data-stu-id="99f1c-661">*High Queue Depth*</span></span>  
<span data-ttu-id="99f1c-662">Une grande profondeur de file d’attente permet d’aligner davantage d’opérations sur le disque.</span><span class="sxs-lookup"><span data-stu-id="99f1c-662">A high queue depth lines up more operations on the disk.</span></span> <span data-ttu-id="99f1c-663">Le disque peut anticiper la prochaine demande placée dans sa file d’attente.</span><span class="sxs-lookup"><span data-stu-id="99f1c-663">The disk knows the next request in its queue ahead of time.</span></span> <span data-ttu-id="99f1c-664">Il peut ainsi planifier les opérations à l’avance et les traiter dans un ordre optimal.</span><span class="sxs-lookup"><span data-stu-id="99f1c-664">Consequently, the disk can schedule operations ahead of time and process them in an optimal sequence.</span></span> <span data-ttu-id="99f1c-665">Étant donné que l’application envoie davantage de requêtes sur le disque, ce dernier peut traiter un plus grand nombre d’E/S parallèles.</span><span class="sxs-lookup"><span data-stu-id="99f1c-665">Since the application is sending more requests to the disk, the disk can process more parallel IOs.</span></span> <span data-ttu-id="99f1c-666">Au final, l’application sera en mesure d’atteindre un taux supérieur d’E/S par seconde.</span><span class="sxs-lookup"><span data-stu-id="99f1c-666">Ultimately, the application will be able to achieve higher IOPS.</span></span> <span data-ttu-id="99f1c-667">Puisque l’application traite davantage de demandes, le débit total de l’application augmente également.</span><span class="sxs-lookup"><span data-stu-id="99f1c-667">Since application is processing more requests, the total Throughput of the application also increases.</span></span>

<span data-ttu-id="99f1c-668">En général, une application peut atteindre un débit maximal avec 8-16 E/S en attente par disque connecté.</span><span class="sxs-lookup"><span data-stu-id="99f1c-668">Typically, an application can achieve maximum Throughput with 8-16+ outstanding IOs per attached disk.</span></span> <span data-ttu-id="99f1c-669">Si la profondeur de file d’attente est de un, l’application ne force pas suffisamment d’E/S sur le système et traite moins de données pendant une période donnée.</span><span class="sxs-lookup"><span data-stu-id="99f1c-669">If a Queue Depth is one, application is not pushing enough IOs to the system, and it will process less amount of in a given period.</span></span> <span data-ttu-id="99f1c-670">En d’autres termes, elle atteindra un débit inférieur.</span><span class="sxs-lookup"><span data-stu-id="99f1c-670">In other words, less Throughput.</span></span>

<span data-ttu-id="99f1c-671">Par exemple, dans SQL Server, une valeur MAXDOP de 4 pour une requête indique à SQL Server qu’il peut utiliser jusqu’à quatre cœurs pour exécuter la requête.</span><span class="sxs-lookup"><span data-stu-id="99f1c-671">For example, in SQL Server, setting the MAXDOP value for a query to "4" informs SQL Server that it can use up to four cores to execute the query.</span></span> <span data-ttu-id="99f1c-672">SQL Server déterminera la meilleure valeur de profondeur de file d’attente ainsi que le nombre de cœurs à utiliser pour l’exécution de la requête.</span><span class="sxs-lookup"><span data-stu-id="99f1c-672">SQL Server will determine what is best queue depth value and the number of cores for the query execution.</span></span>

<span data-ttu-id="99f1c-673">*Profondeur de file d’attente optimale*</span><span class="sxs-lookup"><span data-stu-id="99f1c-673">*Optimal Queue Depth*</span></span>  
<span data-ttu-id="99f1c-674">Une valeur de profondeur de file d’attente très élevée présente aussi des inconvénients.</span><span class="sxs-lookup"><span data-stu-id="99f1c-674">Very high queue depth value also has its drawbacks.</span></span> <span data-ttu-id="99f1c-675">Si la valeur de profondeur de file d’attente est trop importante, l’application tentera de générer un taux d’E/S par seconde très élevé.</span><span class="sxs-lookup"><span data-stu-id="99f1c-675">If queue depth value is too high, the application will try to drive very high IOPS.</span></span> <span data-ttu-id="99f1c-676">À moins que l’application repose sur des disques persistants associés à un nombre suffisant d’E/S par seconde, cela peut affecter sérieusement les latences d’application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-676">Unless application has persistent disks with sufficient provisioned IOPS, this can negatively affect application latencies.</span></span> <span data-ttu-id="99f1c-677">La formule suivante montre la relation entre les E/S par seconde, la latence et la profondeur de file d’attente.</span><span class="sxs-lookup"><span data-stu-id="99f1c-677">Following formula shows the relationship between IOPS, Latency and Queue Depth.</span></span>  
    ![](media/storage-premium-storage-performance/image6.png)

<span data-ttu-id="99f1c-678">Vous ne devez pas configurer la profondeur de file d’attente à une valeur élevée, mais plutôt à une valeur optimale, qui peut générer suffisamment d’E/S par seconde pour l’application sans affecter les latences.</span><span class="sxs-lookup"><span data-stu-id="99f1c-678">You should not configure Queue Depth to any high value, but to an optimal value, which can deliver enough IOPS for the application without affecting latencies.</span></span> <span data-ttu-id="99f1c-679">Par exemple, si la latence de l’application doit être de 1 milliseconde, la profondeur de file d’attente requise pour atteindre 5 000 E/S par seconde sera : PF = 5 000 x 0,001 = 5.</span><span class="sxs-lookup"><span data-stu-id="99f1c-679">For example, if the application latency needs to be 1 millisecond, the Queue Depth required to achieve 5,000 IOPS is, QD = 5000 x 0.001 = 5.</span></span>

<span data-ttu-id="99f1c-680">*Profondeur de file d’attente pour le volume entrelacé*</span><span class="sxs-lookup"><span data-stu-id="99f1c-680">*Queue Depth for Striped Volume*</span></span>  
<span data-ttu-id="99f1c-681">Pour un volume entrelacé, conservez une profondeur de file d’attente suffisamment élevée de sorte que chaque disque dispose individuellement d’un pic de profondeur de file d’attente.</span><span class="sxs-lookup"><span data-stu-id="99f1c-681">For a striped volume, maintain a high enough queue depth such that, every disk has a peak queue depth individually.</span></span> <span data-ttu-id="99f1c-682">Par exemple, considérez une application qui définit une profondeur de file d’attente de 2 dans un scénario d’entrelacement à 4 disques.</span><span class="sxs-lookup"><span data-stu-id="99f1c-682">For example, consider an application that pushes a queue depth of 2 and there are 4 disks in the stripe.</span></span> <span data-ttu-id="99f1c-683">Les deux demandes d’E/S seront transmises à deux disques et les deux disques restants seront inactifs.</span><span class="sxs-lookup"><span data-stu-id="99f1c-683">The two IO requests will go to two disks and remaining two disks will be idle.</span></span> <span data-ttu-id="99f1c-684">Vous devez par conséquent configurer la profondeur de file d’attente afin que tous les disques puissent être occupés.</span><span class="sxs-lookup"><span data-stu-id="99f1c-684">Therefore, configure the queue depth such that all the disks can be busy.</span></span> <span data-ttu-id="99f1c-685">La formule ci-dessous montre comment déterminer la profondeur de file d’attente des volumes entrelacés.</span><span class="sxs-lookup"><span data-stu-id="99f1c-685">Formula below shows how to determine the queue depth of striped volumes.</span></span>  
    ![](media/storage-premium-storage-performance/image7.png)

## <a name="throttling"></a><span data-ttu-id="99f1c-686">Limitation</span><span class="sxs-lookup"><span data-stu-id="99f1c-686">Throttling</span></span>
<span data-ttu-id="99f1c-687">Azure Premium Storage configure la valeur spécifiée d’E/S par seconde et de débit en fonction des tailles de machine virtuelle et des tailles de disque que vous choisissez.</span><span class="sxs-lookup"><span data-stu-id="99f1c-687">Azure Premium Storage provisions specified number of IOPS and Throughput depending on the VM sizes and disk sizes you choose.</span></span> <span data-ttu-id="99f1c-688">Chaque fois que votre application tentera de dépasser les limites de ce que la machine virtuelle ou le disque peut gérer, Premium Storage lui imposera une limitation.</span><span class="sxs-lookup"><span data-stu-id="99f1c-688">Anytime your application tries to drive IOPS or Throughput above these limits of what the VM or disk can handle, Premium Storage will throttle it.</span></span> <span data-ttu-id="99f1c-689">Cette limitation se manifeste sous la forme d’une dégradation des performances de votre application,</span><span class="sxs-lookup"><span data-stu-id="99f1c-689">This manifests in the form of degraded performance in your application.</span></span> <span data-ttu-id="99f1c-690">à savoir une latence plus élevée, un débit réduit ou un nombre inférieur d’E/S par seconde.</span><span class="sxs-lookup"><span data-stu-id="99f1c-690">This can mean higher latency, lower Throughput or lower IOPS.</span></span> <span data-ttu-id="99f1c-691">Sans cette limitation, votre application risquerait de planter en demandant plus que ses ressources ne lui permettent d’effectuer.</span><span class="sxs-lookup"><span data-stu-id="99f1c-691">If Premium Storage does not throttle, your application could completely fail by exceeding what its resources are capable of achieving.</span></span> <span data-ttu-id="99f1c-692">Par conséquent, pour éviter les problèmes de performances associés à une limitation, veillez à toujours fournir suffisamment de ressources pour votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-692">So, to avoid performance issues due to throttling, always provision sufficient resources for your application.</span></span> <span data-ttu-id="99f1c-693">Tenez compte des explications données ci-dessus dans les sections relatives aux tailles de disque et aux tailles de machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="99f1c-693">Take into consideration what we discussed in the VM sizes and Disk sizes sections above.</span></span> <span data-ttu-id="99f1c-694">Le benchmarking offre le meilleur moyen de déterminer les ressources dont vous aurez besoin pour héberger votre application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-694">Benchmarking is the best way to figure out what resources you will need to host your application.</span></span>

## <a name="benchmarking"></a><span data-ttu-id="99f1c-695">Benchmarking</span><span class="sxs-lookup"><span data-stu-id="99f1c-695">Benchmarking</span></span>
<span data-ttu-id="99f1c-696">Le benchmarking consiste à simuler différentes charges de travail sur votre application et à mesurer les performances de l’application pour chaque charge de travail.</span><span class="sxs-lookup"><span data-stu-id="99f1c-696">Benchmarking is the process of simulating different workloads on your application and measuring the application performance for each workload.</span></span> <span data-ttu-id="99f1c-697">En suivant la procédure décrite dans la section précédente, vous avez pu recueillir les exigences de performances de l’application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-697">Using the steps described in an earlier section, you have gathered the application performance requirements.</span></span> <span data-ttu-id="99f1c-698">À présent, vous pouvez utiliser des outils de benchmarking sur les machines virtuelles qui hébergent l’application afin de déterminer les niveaux de performance que votre application peut atteindre avec Premium Storage.</span><span class="sxs-lookup"><span data-stu-id="99f1c-698">By running benchmarking tools on the VMs hosting the application, you can determine the performance levels that your application can achieve with Premium Storage.</span></span> <span data-ttu-id="99f1c-699">Dans cette section, nous allons vous fournir des exemples d’un benchmarking effectué sur une machine virtuelle DS14 Standard configurée avec des disques Azure Premium Storage.</span><span class="sxs-lookup"><span data-stu-id="99f1c-699">In this section, we provide you examples of benchmarking a Standard DS14 VM provisioned with Azure Premium Storage disks.</span></span>

<span data-ttu-id="99f1c-700">Nous avons utilisé les outils courants Iometer et FIO, pour Windows et Linux respectivement.</span><span class="sxs-lookup"><span data-stu-id="99f1c-700">We have used common benchmarking tools Iometer and FIO, for Windows and Linux respectively.</span></span> <span data-ttu-id="99f1c-701">Ces outils génèrent plusieurs threads qui simulent une charge de travail en production et mesurent les performances du système.</span><span class="sxs-lookup"><span data-stu-id="99f1c-701">These tools spawn multiple threads simulating a production like workload, and measure the system performance.</span></span> <span data-ttu-id="99f1c-702">L’utilisation de ces outils vous permet également de configurer des paramètres tels que la taille de bloc et la profondeur de file d’attente, que vous ne pouvez normalement pas modifier pour une application.</span><span class="sxs-lookup"><span data-stu-id="99f1c-702">Using the tools you can also configure parameters like block size and queue depth, which you normally cannot change for an application.</span></span> <span data-ttu-id="99f1c-703">Vous bénéficiez ainsi d’une plus grande souplesse pour optimiser les performances sur une machine virtuelle à grande échelle dotée de disques premium pour différents types de charges de travail applicatives.</span><span class="sxs-lookup"><span data-stu-id="99f1c-703">This gives you more flexibility to drive the maximum performance on a high scale VM provisioned with premium disks for different types of application workloads.</span></span> <span data-ttu-id="99f1c-704">Pour en savoir plus sur chaque outil de benchmarking, visitez [Iometer](http://www.iometer.org/) et [FIO](http://freecode.com/projects/fio).</span><span class="sxs-lookup"><span data-stu-id="99f1c-704">To learn more about each benchmarking tool visit [Iometer](http://www.iometer.org/) and [FIO](http://freecode.com/projects/fio).</span></span>

<span data-ttu-id="99f1c-705">Pour suivre les exemples ci-dessous, créez une machine virtuelle DS14 Standard et attachez-y 11 disques Premium Storage.</span><span class="sxs-lookup"><span data-stu-id="99f1c-705">To follow the examples below, create a Standard DS14 VM and attach 11 Premium Storage disks to the VM.</span></span> <span data-ttu-id="99f1c-706">Sur ces 11 disques, configurez 10 disques avec une mise en cache de l’hôte définie sur « Aucun » et entrelacez-les dans un volume appelé NoCacheWrites.</span><span class="sxs-lookup"><span data-stu-id="99f1c-706">Of the 11 disks, configure 10 disks with host caching as "None" and stripe them into a volume called NoCacheWrites.</span></span> <span data-ttu-id="99f1c-707">Configurez la mise en cache de l’hôte en « Lecture seule » sur le disque restant et créez un volume appelé CacheReads avec ce disque.</span><span class="sxs-lookup"><span data-stu-id="99f1c-707">Configure host caching as "ReadOnly" on the remaining disk and create a volume called CacheReads with this disk.</span></span> <span data-ttu-id="99f1c-708">Avec cette configuration, vous serez en mesure d’observer les performances de lecture et d’écriture maximale à partir d’une machine virtuelle DS14 Standard.</span><span class="sxs-lookup"><span data-stu-id="99f1c-708">Using this setup, you will be able to see the maximum Read and Write performance from a Standard DS14 VM.</span></span> <span data-ttu-id="99f1c-709">Pour connaître les étapes détaillées de la création d’une machine virtuelle DS14 avec des disques premium, accédez à [Créer et utiliser un compte de stockage Premium pour un disque de données de machine virtuelle](storage-premium-storage.md).</span><span class="sxs-lookup"><span data-stu-id="99f1c-709">For detailed steps about creating a DS14 VM with premium disks, go to [Create and use a Premium Storage account for a virtual machine data disk](storage-premium-storage.md).</span></span>

<span data-ttu-id="99f1c-710">*Préchauffage du cache*</span><span class="sxs-lookup"><span data-stu-id="99f1c-710">*Warming up the Cache*</span></span>  
<span data-ttu-id="99f1c-711">Le disque dont la mise en cache de l’hôte est définie en lecture seule sera en mesure de générer un taux d’E/S par seconde supérieur à la limite du disque.</span><span class="sxs-lookup"><span data-stu-id="99f1c-711">The disk with ReadOnly host caching will be able to give higher IOPS than the disk limit.</span></span> <span data-ttu-id="99f1c-712">Pour obtenir ces performances de lecture maximales à partir du cache de l’hôte, vous devez tout d’abord préchauffer le cache du disque.</span><span class="sxs-lookup"><span data-stu-id="99f1c-712">To get this maximum read performance from the host cache, first you must warm up the cache of this disk.</span></span> <span data-ttu-id="99f1c-713">De cette manière, les E/S de lecture que l’outil de benchmarking simulera sur le volume CacheReads pourront effectivement atteindre le cache et non pas le disque directement.</span><span class="sxs-lookup"><span data-stu-id="99f1c-713">This ensures that the Read IOs which benchmarking tool will drive on CacheReads volume actually hits the cache and not the disk directly.</span></span> <span data-ttu-id="99f1c-714">Le fait d’intervenir au niveau du cache permet de générer des E/S supplémentaires à partir du seul disque ayant une mise en cache.</span><span class="sxs-lookup"><span data-stu-id="99f1c-714">The cache hits result in additional IOPS from the single cache enabled disk.</span></span>

> <span data-ttu-id="99f1c-715">**Important :**</span><span class="sxs-lookup"><span data-stu-id="99f1c-715">**Important:**</span></span>  
> <span data-ttu-id="99f1c-716">Vous devez préchauffer le cache avant d’exécuter l’outil de benchmarking à chaque redémarrage de la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="99f1c-716">You must warm up the cache before running benchmarking, every time VM is rebooted.</span></span>
>
>

#### <a name="iometer"></a><span data-ttu-id="99f1c-717">Iometer</span><span class="sxs-lookup"><span data-stu-id="99f1c-717">Iometer</span></span>
<span data-ttu-id="99f1c-718">[Téléchargez l’outil Iometer](http://sourceforge.net/projects/iometer/files/iometer-stable/2006-07-27/iometer-2006.07.27.win32.i386-setup.exe/download) sur la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="99f1c-718">[Download the Iometer tool](http://sourceforge.net/projects/iometer/files/iometer-stable/2006-07-27/iometer-2006.07.27.win32.i386-setup.exe/download) on the VM.</span></span>

<span data-ttu-id="99f1c-719">*Fichier de test*</span><span class="sxs-lookup"><span data-stu-id="99f1c-719">*Test file*</span></span>  
<span data-ttu-id="99f1c-720">Iometer utilise un fichier de test stocké sur le volume sur lequel vous allez exécuter le test de benchmarking.</span><span class="sxs-lookup"><span data-stu-id="99f1c-720">Iometer uses a test file that is stored on the volume on which you will run the benchmarking test.</span></span> <span data-ttu-id="99f1c-721">Les lectures et écritures sont activées sur ce fichier de test afin de mesurer le taux d’E/S par seconde et le débit du disque.</span><span class="sxs-lookup"><span data-stu-id="99f1c-721">It drives Reads and Writes on this test file to measure the disk IOPS and Throughput.</span></span> <span data-ttu-id="99f1c-722">Iometer crée ce fichier de test si vous n’en avez pas fourni.</span><span class="sxs-lookup"><span data-stu-id="99f1c-722">Iometer creates this test file if you have not provided one.</span></span> <span data-ttu-id="99f1c-723">Créez un fichier de test de 200 Go appelé iobw.tst sur les volumes CacheReads et NoCacheWrites.</span><span class="sxs-lookup"><span data-stu-id="99f1c-723">Create a 200GB test file called iobw.tst on the CacheReads and NoCacheWrites volumes.</span></span>

<span data-ttu-id="99f1c-724">*Spécifications d’accès*</span><span class="sxs-lookup"><span data-stu-id="99f1c-724">*Access Specifications*</span></span>  
<span data-ttu-id="99f1c-725">Les spécifications (taille d’E/S de la demande, % de lecture-écriture, % aléatoire/séquentiel) sont configurées à l’aide de l’onglet « Access Specifications » d’Iometer.</span><span class="sxs-lookup"><span data-stu-id="99f1c-725">The specifications, request IO size, % read/write, % random/sequential are configured using the "Access Specifications" tab in Iometer.</span></span> <span data-ttu-id="99f1c-726">Créez une spécification d’accès pour chacun des scénarios ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="99f1c-726">Create an access specification for each of the scenarios described below.</span></span> <span data-ttu-id="99f1c-727">Créez les spécifications d’accès et enregistrez-les avec un nom approprié, comme RandomWrites\_8K, RandomReads\_8K.</span><span class="sxs-lookup"><span data-stu-id="99f1c-727">Create the access specifications and "Save" with an appropriate name like – RandomWrites\_8K, RandomReads\_8K.</span></span> <span data-ttu-id="99f1c-728">Sélectionnez la spécification correspondante lorsque vous exécutez le scénario de test.</span><span class="sxs-lookup"><span data-stu-id="99f1c-728">Select the corresponding specification when running the test scenario.</span></span>

<span data-ttu-id="99f1c-729">Vous trouverez ci-dessous un exemple de spécifications d’accès pour un scénario d’E/S en écriture maximales.</span><span class="sxs-lookup"><span data-stu-id="99f1c-729">An example of access specifications for maximum Write IOPS scenario is shown below,</span></span>  
    ![](media/storage-premium-storage-performance/image8.png)

<span data-ttu-id="99f1c-730">*Spécifications de test du taux maximal d’E/S par seconde*</span><span class="sxs-lookup"><span data-stu-id="99f1c-730">*Maximum IOPS Test Specifications*</span></span>  
<span data-ttu-id="99f1c-731">Pour démontrer le taux maximal d’E/S par seconde, utilisez une taille de demande plus petite.</span><span class="sxs-lookup"><span data-stu-id="99f1c-731">To demonstrate maximum IOPs, use smaller request size.</span></span> <span data-ttu-id="99f1c-732">Utilisez une taille de 8 Ko et créez des spécifications pour les lectures et écritures aléatoires.</span><span class="sxs-lookup"><span data-stu-id="99f1c-732">Use 8K request size and create specifications for Random Writes and Reads.</span></span>

| <span data-ttu-id="99f1c-733">Spécification d’accès</span><span class="sxs-lookup"><span data-stu-id="99f1c-733">Access Specification</span></span> | <span data-ttu-id="99f1c-734">Taille de la demande</span><span class="sxs-lookup"><span data-stu-id="99f1c-734">Request size</span></span> | <span data-ttu-id="99f1c-735">% aléatoire</span><span class="sxs-lookup"><span data-stu-id="99f1c-735">Random %</span></span> | <span data-ttu-id="99f1c-736">% écriture</span><span class="sxs-lookup"><span data-stu-id="99f1c-736">Read %</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="99f1c-737">RandomWrites\_8K</span><span class="sxs-lookup"><span data-stu-id="99f1c-737">RandomWrites\_8K</span></span> |<span data-ttu-id="99f1c-738">8 Ko</span><span class="sxs-lookup"><span data-stu-id="99f1c-738">8K</span></span> |<span data-ttu-id="99f1c-739">100</span><span class="sxs-lookup"><span data-stu-id="99f1c-739">100</span></span> |<span data-ttu-id="99f1c-740">0</span><span class="sxs-lookup"><span data-stu-id="99f1c-740">0</span></span> |
| <span data-ttu-id="99f1c-741">RandomReads\_8K</span><span class="sxs-lookup"><span data-stu-id="99f1c-741">RandomReads\_8K</span></span> |<span data-ttu-id="99f1c-742">8 Ko</span><span class="sxs-lookup"><span data-stu-id="99f1c-742">8K</span></span> |<span data-ttu-id="99f1c-743">100</span><span class="sxs-lookup"><span data-stu-id="99f1c-743">100</span></span> |<span data-ttu-id="99f1c-744">100</span><span class="sxs-lookup"><span data-stu-id="99f1c-744">100</span></span> |

<span data-ttu-id="99f1c-745">*Spécifications de test du débit maximal*</span><span class="sxs-lookup"><span data-stu-id="99f1c-745">*Maximum Throughput Test Specifications*</span></span>  
<span data-ttu-id="99f1c-746">Pour afficher le débit maximal, utilisez une plus grande taille de demande.</span><span class="sxs-lookup"><span data-stu-id="99f1c-746">To demonstrate maximum Throughput, use larger request size.</span></span> <span data-ttu-id="99f1c-747">Utilisez une taille de requête 64 K et créez des spécifications pour les lectures et écritures aléatoires.</span><span class="sxs-lookup"><span data-stu-id="99f1c-747">Use 64K request size and create specifications for Random Writes and Reads.</span></span>

| <span data-ttu-id="99f1c-748">Spécification d’accès</span><span class="sxs-lookup"><span data-stu-id="99f1c-748">Access Specification</span></span> | <span data-ttu-id="99f1c-749">Taille de la demande</span><span class="sxs-lookup"><span data-stu-id="99f1c-749">Request size</span></span> | <span data-ttu-id="99f1c-750">% aléatoire</span><span class="sxs-lookup"><span data-stu-id="99f1c-750">Random %</span></span> | <span data-ttu-id="99f1c-751">% écriture</span><span class="sxs-lookup"><span data-stu-id="99f1c-751">Read %</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="99f1c-752">RandomWrites\_64K</span><span class="sxs-lookup"><span data-stu-id="99f1c-752">RandomWrites\_64K</span></span> |<span data-ttu-id="99f1c-753">64 Ko</span><span class="sxs-lookup"><span data-stu-id="99f1c-753">64K</span></span> |<span data-ttu-id="99f1c-754">100</span><span class="sxs-lookup"><span data-stu-id="99f1c-754">100</span></span> |<span data-ttu-id="99f1c-755">0</span><span class="sxs-lookup"><span data-stu-id="99f1c-755">0</span></span> |
| <span data-ttu-id="99f1c-756">RandomReads\_64K</span><span class="sxs-lookup"><span data-stu-id="99f1c-756">RandomReads\_64K</span></span> |<span data-ttu-id="99f1c-757">64 Ko</span><span class="sxs-lookup"><span data-stu-id="99f1c-757">64K</span></span> |<span data-ttu-id="99f1c-758">100</span><span class="sxs-lookup"><span data-stu-id="99f1c-758">100</span></span> |<span data-ttu-id="99f1c-759">100</span><span class="sxs-lookup"><span data-stu-id="99f1c-759">100</span></span> |

<span data-ttu-id="99f1c-760">*Exécution du test Iometer*</span><span class="sxs-lookup"><span data-stu-id="99f1c-760">*Running the Iometer Test*</span></span>  
<span data-ttu-id="99f1c-761">Procédez comme suit pour préparer le cache</span><span class="sxs-lookup"><span data-stu-id="99f1c-761">Perform the steps below to warm up cache</span></span>

1. <span data-ttu-id="99f1c-762">Créez deux spécifications d’accès avec les valeurs indiquées ci-dessous</span><span class="sxs-lookup"><span data-stu-id="99f1c-762">Create two access specifications with values shown below,</span></span>

   | <span data-ttu-id="99f1c-763">Nom</span><span class="sxs-lookup"><span data-stu-id="99f1c-763">Name</span></span> | <span data-ttu-id="99f1c-764">Taille de la demande</span><span class="sxs-lookup"><span data-stu-id="99f1c-764">Request size</span></span> | <span data-ttu-id="99f1c-765">% aléatoire</span><span class="sxs-lookup"><span data-stu-id="99f1c-765">Random %</span></span> | <span data-ttu-id="99f1c-766">% écriture</span><span class="sxs-lookup"><span data-stu-id="99f1c-766">Read %</span></span> |
   | --- | --- | --- | --- |
   | <span data-ttu-id="99f1c-767">RandomWrites\_1MB</span><span class="sxs-lookup"><span data-stu-id="99f1c-767">RandomWrites\_1MB</span></span> |<span data-ttu-id="99f1c-768">1 Mo</span><span class="sxs-lookup"><span data-stu-id="99f1c-768">1MB</span></span> |<span data-ttu-id="99f1c-769">100</span><span class="sxs-lookup"><span data-stu-id="99f1c-769">100</span></span> |<span data-ttu-id="99f1c-770">0</span><span class="sxs-lookup"><span data-stu-id="99f1c-770">0</span></span> |
   | <span data-ttu-id="99f1c-771">RandomReads\_1MB</span><span class="sxs-lookup"><span data-stu-id="99f1c-771">RandomReads\_1MB</span></span> |<span data-ttu-id="99f1c-772">1 Mo</span><span class="sxs-lookup"><span data-stu-id="99f1c-772">1MB</span></span> |<span data-ttu-id="99f1c-773">100</span><span class="sxs-lookup"><span data-stu-id="99f1c-773">100</span></span> |<span data-ttu-id="99f1c-774">100</span><span class="sxs-lookup"><span data-stu-id="99f1c-774">100</span></span> |
2. <span data-ttu-id="99f1c-775">Exécutez le test Iometer pour initialiser le disque de cache avec les paramètres suivants.</span><span class="sxs-lookup"><span data-stu-id="99f1c-775">Run the Iometer test for initializing cache disk with following parameters.</span></span> <span data-ttu-id="99f1c-776">Utilisez trois threads de travail pour le volume cible et une profondeur de file d’attente de 128.</span><span class="sxs-lookup"><span data-stu-id="99f1c-776">Use three worker threads for the target volume and a queue depth of 128.</span></span> <span data-ttu-id="99f1c-777">Définissez la durée d’exécution du test sur 2 heures sous l’onglet « Test Setup ».</span><span class="sxs-lookup"><span data-stu-id="99f1c-777">Set the "Run time" duration of the test to 2hrs on the "Test Setup" tab.</span></span>

   | <span data-ttu-id="99f1c-778">Scénario</span><span class="sxs-lookup"><span data-stu-id="99f1c-778">Scenario</span></span> | <span data-ttu-id="99f1c-779">Volume cible</span><span class="sxs-lookup"><span data-stu-id="99f1c-779">Target Volume</span></span> | <span data-ttu-id="99f1c-780">Nom</span><span class="sxs-lookup"><span data-stu-id="99f1c-780">Name</span></span> | <span data-ttu-id="99f1c-781">Durée</span><span class="sxs-lookup"><span data-stu-id="99f1c-781">Duration</span></span> |
   | --- | --- | --- | --- |
   | <span data-ttu-id="99f1c-782">Initialisation du disque de cache</span><span class="sxs-lookup"><span data-stu-id="99f1c-782">Initialize Cache Disk</span></span> |<span data-ttu-id="99f1c-783">CacheReads</span><span class="sxs-lookup"><span data-stu-id="99f1c-783">CacheReads</span></span> |<span data-ttu-id="99f1c-784">RandomWrites\_1MB</span><span class="sxs-lookup"><span data-stu-id="99f1c-784">RandomWrites\_1MB</span></span> |<span data-ttu-id="99f1c-785">2 heures</span><span class="sxs-lookup"><span data-stu-id="99f1c-785">2hrs</span></span> |
3. <span data-ttu-id="99f1c-786">Exécutez le test Iometer pour préchauffer le disque de cache avec les paramètres suivants.</span><span class="sxs-lookup"><span data-stu-id="99f1c-786">Run the Iometer test for warming up cache disk with following parameters.</span></span> <span data-ttu-id="99f1c-787">Utilisez trois threads de travail pour le volume cible et une profondeur de file d’attente de 128.</span><span class="sxs-lookup"><span data-stu-id="99f1c-787">Use three worker threads for the target volume and a queue depth of 128.</span></span> <span data-ttu-id="99f1c-788">Définissez la durée d’exécution du test sur 2 heures sous l’onglet « Test Setup ».</span><span class="sxs-lookup"><span data-stu-id="99f1c-788">Set the "Run time" duration of the test to 2hrs on the "Test Setup" tab.</span></span>

   | <span data-ttu-id="99f1c-789">Scénario</span><span class="sxs-lookup"><span data-stu-id="99f1c-789">Scenario</span></span> | <span data-ttu-id="99f1c-790">Volume cible</span><span class="sxs-lookup"><span data-stu-id="99f1c-790">Target Volume</span></span> | <span data-ttu-id="99f1c-791">Nom</span><span class="sxs-lookup"><span data-stu-id="99f1c-791">Name</span></span> | <span data-ttu-id="99f1c-792">Durée</span><span class="sxs-lookup"><span data-stu-id="99f1c-792">Duration</span></span> |
   | --- | --- | --- | --- |
   | <span data-ttu-id="99f1c-793">Préchauffage du disque de cache</span><span class="sxs-lookup"><span data-stu-id="99f1c-793">Warm up Cache Disk</span></span> |<span data-ttu-id="99f1c-794">CacheReads</span><span class="sxs-lookup"><span data-stu-id="99f1c-794">CacheReads</span></span> |<span data-ttu-id="99f1c-795">RandomReads\_1MB</span><span class="sxs-lookup"><span data-stu-id="99f1c-795">RandomReads\_1MB</span></span> |<span data-ttu-id="99f1c-796">2 heures</span><span class="sxs-lookup"><span data-stu-id="99f1c-796">2hrs</span></span> |

<span data-ttu-id="99f1c-797">Une fois le disque de cache préchauffé, poursuivez avec les scénarios de test décrits ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="99f1c-797">After cache disk is warmed up, proceed with the test scenarios listed below.</span></span> <span data-ttu-id="99f1c-798">Pour exécuter le test Iometer, utilisez au moins trois threads de travail pour **chaque** volume cible.</span><span class="sxs-lookup"><span data-stu-id="99f1c-798">To run the Iometer test, use at least three worker threads for **each** target volume.</span></span> <span data-ttu-id="99f1c-799">Pour chaque thread de travail, sélectionnez le volume cible, définissez une profondeur de file d’attente et sélectionnez l’une des spécifications de test enregistrées, comme illustré dans le tableau ci-dessous, pour exécuter le scénario de test correspondant.</span><span class="sxs-lookup"><span data-stu-id="99f1c-799">For each worker thread, select the target volume, set queue depth and select one of the saved test specifications, as shown in the table below, to run the corresponding test scenario.</span></span> <span data-ttu-id="99f1c-800">Le tableau indique également les résultats attendus pour les E/S par seconde et le débit lors de l’exécution de ces tests.</span><span class="sxs-lookup"><span data-stu-id="99f1c-800">The table also shows expected results for IOPS and Throughput when running these tests.</span></span> <span data-ttu-id="99f1c-801">Pour tous les scénarios, une petite taille d’E/S de 8 Ko et une profondeur de file d’attente élevée de 128 sont utilisées.</span><span class="sxs-lookup"><span data-stu-id="99f1c-801">For all scenarios, a small IO size of 8KB and a high queue depth of 128 is used.</span></span>

| <span data-ttu-id="99f1c-802">Scénario de test</span><span class="sxs-lookup"><span data-stu-id="99f1c-802">Test Scenario</span></span> | <span data-ttu-id="99f1c-803">Volume cible</span><span class="sxs-lookup"><span data-stu-id="99f1c-803">Target Volume</span></span> | <span data-ttu-id="99f1c-804">Nom</span><span class="sxs-lookup"><span data-stu-id="99f1c-804">Name</span></span> | <span data-ttu-id="99f1c-805">Résultat</span><span class="sxs-lookup"><span data-stu-id="99f1c-805">Result</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="99f1c-806">Bande passante</span><span class="sxs-lookup"><span data-stu-id="99f1c-806">Max.</span></span> <span data-ttu-id="99f1c-807">E/S par seconde en lecture</span><span class="sxs-lookup"><span data-stu-id="99f1c-807">Read IOPS</span></span> |<span data-ttu-id="99f1c-808">CacheReads</span><span class="sxs-lookup"><span data-stu-id="99f1c-808">CacheReads</span></span> |<span data-ttu-id="99f1c-809">RandomWrites\_8K</span><span class="sxs-lookup"><span data-stu-id="99f1c-809">RandomWrites\_8K</span></span> |<span data-ttu-id="99f1c-810">50 000 E/S par seconde </span><span class="sxs-lookup"><span data-stu-id="99f1c-810">50,000 IOPS</span></span> |
| <span data-ttu-id="99f1c-811">Bande passante</span><span class="sxs-lookup"><span data-stu-id="99f1c-811">Max.</span></span> <span data-ttu-id="99f1c-812">E/S par seconde en écriture</span><span class="sxs-lookup"><span data-stu-id="99f1c-812">Write IOPS</span></span> |<span data-ttu-id="99f1c-813">NoCacheWrites</span><span class="sxs-lookup"><span data-stu-id="99f1c-813">NoCacheWrites</span></span> |<span data-ttu-id="99f1c-814">RandomReads\_8K</span><span class="sxs-lookup"><span data-stu-id="99f1c-814">RandomReads\_8K</span></span> |<span data-ttu-id="99f1c-815">64 000 E/S par seconde</span><span class="sxs-lookup"><span data-stu-id="99f1c-815">64,000 IOPS</span></span> |
| <span data-ttu-id="99f1c-816">Bande passante</span><span class="sxs-lookup"><span data-stu-id="99f1c-816">Max.</span></span> <span data-ttu-id="99f1c-817">Taux d’E/S par seconde combiné</span><span class="sxs-lookup"><span data-stu-id="99f1c-817">Combined IOPS</span></span> |<span data-ttu-id="99f1c-818">CacheReads</span><span class="sxs-lookup"><span data-stu-id="99f1c-818">CacheReads</span></span> |<span data-ttu-id="99f1c-819">RandomWrites\_8K</span><span class="sxs-lookup"><span data-stu-id="99f1c-819">RandomWrites\_8K</span></span> |<span data-ttu-id="99f1c-820">100 000 E/S par seconde</span><span class="sxs-lookup"><span data-stu-id="99f1c-820">100,000 IOPS</span></span> |
| <span data-ttu-id="99f1c-821">NoCacheWrites</span><span class="sxs-lookup"><span data-stu-id="99f1c-821">NoCacheWrites</span></span> |<span data-ttu-id="99f1c-822">RandomReads\_8K</span><span class="sxs-lookup"><span data-stu-id="99f1c-822">RandomReads\_8K</span></span> | &nbsp; | &nbsp; |
| <span data-ttu-id="99f1c-823">Bande passante</span><span class="sxs-lookup"><span data-stu-id="99f1c-823">Max.</span></span> <span data-ttu-id="99f1c-824">Mo/s en lecture</span><span class="sxs-lookup"><span data-stu-id="99f1c-824">Read MB/sec</span></span> |<span data-ttu-id="99f1c-825">CacheReads</span><span class="sxs-lookup"><span data-stu-id="99f1c-825">CacheReads</span></span> |<span data-ttu-id="99f1c-826">RandomWrites\_64K</span><span class="sxs-lookup"><span data-stu-id="99f1c-826">RandomWrites\_64K</span></span> |<span data-ttu-id="99f1c-827">524 Mo/s</span><span class="sxs-lookup"><span data-stu-id="99f1c-827">524 MB/sec</span></span> |
| <span data-ttu-id="99f1c-828">Bande passante</span><span class="sxs-lookup"><span data-stu-id="99f1c-828">Max.</span></span> <span data-ttu-id="99f1c-829">Mo/s en écriture</span><span class="sxs-lookup"><span data-stu-id="99f1c-829">Write MB/sec</span></span> |<span data-ttu-id="99f1c-830">NoCacheWrites</span><span class="sxs-lookup"><span data-stu-id="99f1c-830">NoCacheWrites</span></span> |<span data-ttu-id="99f1c-831">RandomReads\_64K</span><span class="sxs-lookup"><span data-stu-id="99f1c-831">RandomReads\_64K</span></span> |<span data-ttu-id="99f1c-832">524 Mo/s</span><span class="sxs-lookup"><span data-stu-id="99f1c-832">524 MB/sec</span></span> |
| <span data-ttu-id="99f1c-833">Mo/s combiné</span><span class="sxs-lookup"><span data-stu-id="99f1c-833">Combined MB/sec</span></span> |<span data-ttu-id="99f1c-834">CacheReads</span><span class="sxs-lookup"><span data-stu-id="99f1c-834">CacheReads</span></span> |<span data-ttu-id="99f1c-835">RandomWrites\_64K</span><span class="sxs-lookup"><span data-stu-id="99f1c-835">RandomWrites\_64K</span></span> |<span data-ttu-id="99f1c-836">1 000 Mo/s</span><span class="sxs-lookup"><span data-stu-id="99f1c-836">1000 MB/sec</span></span> |
| <span data-ttu-id="99f1c-837">NoCacheWrites</span><span class="sxs-lookup"><span data-stu-id="99f1c-837">NoCacheWrites</span></span> |<span data-ttu-id="99f1c-838">RandomReads\_64K</span><span class="sxs-lookup"><span data-stu-id="99f1c-838">RandomReads\_64K</span></span> | &nbsp; | &nbsp; |

<span data-ttu-id="99f1c-839">Voici les captures d’écran des résultats du test Iometer pour les scénarios de taux d’E/S par seconde et de débit combinés.</span><span class="sxs-lookup"><span data-stu-id="99f1c-839">Below are screenshots of the Iometer test results for combined IOPS and Throughput scenarios.</span></span>

<span data-ttu-id="99f1c-840">*Taux d’E/S maximal combiné en lecture et en écriture*</span><span class="sxs-lookup"><span data-stu-id="99f1c-840">*Combined Reads and Writes Maximum IOPS*</span></span>  
![](media/storage-premium-storage-performance/image9.png)

<span data-ttu-id="99f1c-841">*Débit maximal combiné en lecture et en écriture*</span><span class="sxs-lookup"><span data-stu-id="99f1c-841">*Combined Reads and Writes Maximum Throughput*</span></span>  
![](media/storage-premium-storage-performance/image10.png)

### <a name="fio"></a><span data-ttu-id="99f1c-842">FIO</span><span class="sxs-lookup"><span data-stu-id="99f1c-842">FIO</span></span>
<span data-ttu-id="99f1c-843">FIO est un outil communément utilisé pour tester le stockage sur des machines virtuelles Linux.</span><span class="sxs-lookup"><span data-stu-id="99f1c-843">FIO is a popular tool to benchmark storage on the Linux VMs.</span></span> <span data-ttu-id="99f1c-844">Cet outil offre la possibilité de sélectionner différentes tailles d’E/S, avec des lectures et des écritures séquentielles ou aléatoires.</span><span class="sxs-lookup"><span data-stu-id="99f1c-844">It has the flexibility to select different IO sizes, sequential or random reads and writes.</span></span> <span data-ttu-id="99f1c-845">Il génère des threads de travail ou des processus pour exécuter les opérations d’E/S spécifiées.</span><span class="sxs-lookup"><span data-stu-id="99f1c-845">It spawns worker threads or processes to perform the specified I/O operations.</span></span> <span data-ttu-id="99f1c-846">Vous pouvez spécifier le type d’opérations d’E/S que chaque thread de travail doit exécuter à l’aide de fichiers de travail.</span><span class="sxs-lookup"><span data-stu-id="99f1c-846">You can specify the type of I/O operations each worker thread must perform using job files.</span></span> <span data-ttu-id="99f1c-847">Nous avons créé un fichier de travail par scénario, comme illustré dans les exemples ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="99f1c-847">We created one job file per scenario illustrated in the examples below.</span></span> <span data-ttu-id="99f1c-848">Vous pouvez modifier les spécifications de ces fichiers de travail pour tester différentes charges de travail exécutées sur Premium Storage.</span><span class="sxs-lookup"><span data-stu-id="99f1c-848">You can change the specifications in these job files to benchmark different workloads running on Premium Storage.</span></span> <span data-ttu-id="99f1c-849">Dans ces exemples, nous utilisons une machine virtuelle DS 14 standard exécutée sous **Ubuntu**.</span><span class="sxs-lookup"><span data-stu-id="99f1c-849">In the examples, we are using a Standard DS 14 VM running **Ubuntu**.</span></span> <span data-ttu-id="99f1c-850">Utilisez la configuration décrite au début de la [section Benchmarking](#Benchmarking) et préchauffez le cache avant d’exécuter les tests de benchmarking.</span><span class="sxs-lookup"><span data-stu-id="99f1c-850">Use the same setup described in the beginning of the [Benchmarking section](#Benchmarking) and warm up the cache before running the benchmarking tests.</span></span>

<span data-ttu-id="99f1c-851">Avant de commencer, [téléchargez FIO](https://github.com/axboe/fio) et installez-le sur votre machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="99f1c-851">Before you begin, [download FIO](https://github.com/axboe/fio) and install it on your virtual machine.</span></span>

<span data-ttu-id="99f1c-852">Exécutez la commande ci-dessous pour Ubuntu.</span><span class="sxs-lookup"><span data-stu-id="99f1c-852">Run the following command for Ubuntu,</span></span>

```
apt-get install fio
```

<span data-ttu-id="99f1c-853">Nous allons utiliser quatre threads de travail pour générer les opérations d’écriture et quatre threads de travail pour générer les opérations de lecture sur les disques.</span><span class="sxs-lookup"><span data-stu-id="99f1c-853">We will use four worker threads for driving Write operations and four worker threads for driving Read operations on the disks.</span></span> <span data-ttu-id="99f1c-854">Les Workers d’écriture pilotent le trafic sur le volume « nocache », qui comporte 10 disques sans mise en cache (paramètre « Aucun »).</span><span class="sxs-lookup"><span data-stu-id="99f1c-854">The Write workers will be driving traffic on the "nocache" volume, which has 10 disks with cache set to "None".</span></span> <span data-ttu-id="99f1c-855">Les Workers de lecture pilotent le trafic sur le volume « readcache », qui comporte 1 disque avec une mise en cache définie sur « Lecture seule ».</span><span class="sxs-lookup"><span data-stu-id="99f1c-855">The Read workers will be driving traffic on the "readcache" volume, which has 1 disk with cache set to "ReadOnly".</span></span>

<span data-ttu-id="99f1c-856">*Taux d’E/S par seconde maximal en écriture*</span><span class="sxs-lookup"><span data-stu-id="99f1c-856">*Maximum Write IOPS*</span></span>  
<span data-ttu-id="99f1c-857">Créez le fichier de travail avec les spécifications suivantes pour obtenir le taux maximal d’E/S par seconde en écriture.</span><span class="sxs-lookup"><span data-stu-id="99f1c-857">Create the job file with following specifications to get maximum Write IOPS.</span></span> <span data-ttu-id="99f1c-858">Nommez ce fichier « fiowrite.ini ».</span><span class="sxs-lookup"><span data-stu-id="99f1c-858">Name it "fiowrite.ini".</span></span>

```
[global]
size=30g
direct=1
iodepth=256
ioengine=libaio
bs=8k

[writer1]
rw=randwrite
directory=/mnt/nocache
[writer2]
rw=randwrite
directory=/mnt/nocache
[writer3]
rw=randwrite
directory=/mnt/nocache
[writer4]
rw=randwrite
directory=/mnt/nocache
```

<span data-ttu-id="99f1c-859">Tenez compte des remarques suivantes qui sont en phase avec les instructions de conception présentées dans les sections précédentes.</span><span class="sxs-lookup"><span data-stu-id="99f1c-859">Note the follow key things that are in line with the design guidelines discussed in previous sections.</span></span> <span data-ttu-id="99f1c-860">Ces spécifications sont essentielles pour générer le taux d’E/S par seconde maximal.</span><span class="sxs-lookup"><span data-stu-id="99f1c-860">These specifications are essential to drive maximum IOPS,</span></span>  

* <span data-ttu-id="99f1c-861">Une profondeur de file d’attente élevée de 256.</span><span class="sxs-lookup"><span data-stu-id="99f1c-861">A high queue depth of 256.</span></span>  
* <span data-ttu-id="99f1c-862">Une petite taille de bloc de 8 Ko.</span><span class="sxs-lookup"><span data-stu-id="99f1c-862">A small block size of 8KB.</span></span>  
* <span data-ttu-id="99f1c-863">Plusieurs threads effectuant des écritures aléatoires.</span><span class="sxs-lookup"><span data-stu-id="99f1c-863">Multiple threads performing random writes.</span></span>

<span data-ttu-id="99f1c-864">Exécutez la commande suivante pour lancer le test FIO pendant 30 secondes.</span><span class="sxs-lookup"><span data-stu-id="99f1c-864">Run the following command to kick off the FIO test for 30 seconds,</span></span>  

```
sudo fio --runtime 30 fiowrite.ini
```

<span data-ttu-id="99f1c-865">Pendant l’exécution du test, vous serez en mesure de voir le nombre d’E/S par seconde en écriture générées par la machine virtuelle et les disques Premium.</span><span class="sxs-lookup"><span data-stu-id="99f1c-865">While the test runs, you will be able to see the number of write IOPS the VM and Premium disks are delivering.</span></span> <span data-ttu-id="99f1c-866">Comme indiqué dans l’exemple ci-dessous, la machine virtuelle DS14 produit un taux d’E/S par seconde maximal en écriture limité à 50 000 E/S par seconde.</span><span class="sxs-lookup"><span data-stu-id="99f1c-866">As shown in the sample below, the DS14 VM is delivering its maximum write IOPS limit of 50,000 IOPS.</span></span>  
    ![](media/storage-premium-storage-performance/image11.png)

<span data-ttu-id="99f1c-867">*Taux d’E/S par seconde maximal en lecture*</span><span class="sxs-lookup"><span data-stu-id="99f1c-867">*Maximum Read IOPS*</span></span>  
<span data-ttu-id="99f1c-868">Créez le fichier de travail avec les spécifications suivantes pour obtenir le taux maximal d’E/S par seconde en lecture.</span><span class="sxs-lookup"><span data-stu-id="99f1c-868">Create the job file with following specifications to get maximum Read IOPS.</span></span> <span data-ttu-id="99f1c-869">Nommez ce fichier « fioread.ini ».</span><span class="sxs-lookup"><span data-stu-id="99f1c-869">Name it "fioread.ini".</span></span>

```
[global]
size=30g
direct=1
iodepth=256
ioengine=libaio
bs=8k

[reader1]
rw=randread
directory=/mnt/readcache
[reader2]
rw=randread
directory=/mnt/readcache
[reader3]
rw=randread
directory=/mnt/readcache
[reader4]
rw=randread
directory=/mnt/readcache
```

<span data-ttu-id="99f1c-870">Tenez compte des remarques suivantes qui sont en phase avec les instructions de conception présentées dans les sections précédentes.</span><span class="sxs-lookup"><span data-stu-id="99f1c-870">Note the follow key things that are in line with the design guidelines discussed in previous sections.</span></span> <span data-ttu-id="99f1c-871">Ces spécifications sont essentielles pour générer le taux d’E/S par seconde maximal.</span><span class="sxs-lookup"><span data-stu-id="99f1c-871">These specifications are essential to drive maximum IOPS,</span></span>

* <span data-ttu-id="99f1c-872">Une profondeur de file d’attente élevée de 256.</span><span class="sxs-lookup"><span data-stu-id="99f1c-872">A high queue depth of 256.</span></span>  
* <span data-ttu-id="99f1c-873">Une petite taille de bloc de 8 Ko.</span><span class="sxs-lookup"><span data-stu-id="99f1c-873">A small block size of 8KB.</span></span>  
* <span data-ttu-id="99f1c-874">Plusieurs threads effectuant des écritures aléatoires.</span><span class="sxs-lookup"><span data-stu-id="99f1c-874">Multiple threads performing random writes.</span></span>

<span data-ttu-id="99f1c-875">Exécutez la commande suivante pour lancer le test FIO pendant 30 secondes.</span><span class="sxs-lookup"><span data-stu-id="99f1c-875">Run the following command to kick off the FIO test for 30 seconds,</span></span>

```
sudo fio --runtime 30 fioread.ini
```

<span data-ttu-id="99f1c-876">Pendant l’exécution du test, vous serez en mesure de voir le nombre d’E/S par seconde en lecture générées par la machine virtuelle et les disques Premium.</span><span class="sxs-lookup"><span data-stu-id="99f1c-876">While the test runs, you will be able to see the number of read IOPS the VM and Premium disks are delivering.</span></span> <span data-ttu-id="99f1c-877">Comme indiqué dans l’exemple ci-dessous, la machine virtuelle DS14 génère plus de 64 000 E/S par seconde en lecture.</span><span class="sxs-lookup"><span data-stu-id="99f1c-877">As shown in the sample below, the DS14 VM is delivering more than 64,000 Read IOPS.</span></span> <span data-ttu-id="99f1c-878">Cette valeur représente les performances combinées du disque et du cache.</span><span class="sxs-lookup"><span data-stu-id="99f1c-878">This is a combination of the disk and the cache performance.</span></span>  
    ![](media/storage-premium-storage-performance/image12.png)

<span data-ttu-id="99f1c-879">*Taux d’E/S par seconde maximal en lecture et en écriture*</span><span class="sxs-lookup"><span data-stu-id="99f1c-879">*Maximum Read and Write IOPS*</span></span>  
<span data-ttu-id="99f1c-880">Créez le fichier de travail avec les spécifications suivantes pour obtenir le taux maximal combiné d’E/S par seconde en lecture et en écriture.</span><span class="sxs-lookup"><span data-stu-id="99f1c-880">Create the job file with following specifications to get maximum combined Read and Write IOPS.</span></span> <span data-ttu-id="99f1c-881">Nommez ce fichier « fioreadwrite.ini ».</span><span class="sxs-lookup"><span data-stu-id="99f1c-881">Name it "fioreadwrite.ini".</span></span>

```
[global]
size=30g
direct=1
iodepth=128
ioengine=libaio
bs=4k

[reader1]
rw=randread
directory=/mnt/readcache
[reader2]
rw=randread
directory=/mnt/readcache
[reader3]
rw=randread
directory=/mnt/readcache
[reader4]
rw=randread
directory=/mnt/readcache

[writer1]
rw=randwrite
directory=/mnt/nocache
rate_iops=12500
[writer2]
rw=randwrite
directory=/mnt/nocache
rate_iops=12500
[writer3]
rw=randwrite
directory=/mnt/nocache
rate_iops=12500
[writer4]
rw=randwrite
directory=/mnt/nocache
rate_iops=12500
```

<span data-ttu-id="99f1c-882">Tenez compte des remarques suivantes qui sont en phase avec les instructions de conception présentées dans les sections précédentes.</span><span class="sxs-lookup"><span data-stu-id="99f1c-882">Note the follow key things that are in line with the design guidelines discussed in previous sections.</span></span> <span data-ttu-id="99f1c-883">Ces spécifications sont essentielles pour générer le taux d’E/S par seconde maximal.</span><span class="sxs-lookup"><span data-stu-id="99f1c-883">These specifications are essential to drive maximum IOPS,</span></span>

* <span data-ttu-id="99f1c-884">Une profondeur de file d’attente élevée de 128.</span><span class="sxs-lookup"><span data-stu-id="99f1c-884">A high queue depth of 128.</span></span>  
* <span data-ttu-id="99f1c-885">Une petite taille de bloc de 4 Ko.</span><span class="sxs-lookup"><span data-stu-id="99f1c-885">A small block size of 4KB.</span></span>  
* <span data-ttu-id="99f1c-886">Plusieurs threads effectuant des opérations d’écriture et de lecture aléatoires.</span><span class="sxs-lookup"><span data-stu-id="99f1c-886">Multiple threads performing random reads and writes.</span></span>

<span data-ttu-id="99f1c-887">Exécutez la commande suivante pour lancer le test FIO pendant 30 secondes.</span><span class="sxs-lookup"><span data-stu-id="99f1c-887">Run the following command to kick off the FIO test for 30 seconds,</span></span>

```
sudo fio --runtime 30 fioreadwrite.ini
```

<span data-ttu-id="99f1c-888">Pendant l’exécution du test, vous serez en mesure de voir le nombre combiné d’E/S par seconde en lecture et en écriture générées par la machine virtuelle et les disques Premium.</span><span class="sxs-lookup"><span data-stu-id="99f1c-888">While the test runs, you will be able to see the number of combined read and write IOPS the VM and Premium disks are delivering.</span></span> <span data-ttu-id="99f1c-889">Comme indiqué dans l’exemple ci-dessous, la machine virtuelle DS14 génère plus de 100 000 E/S par seconde en lecture et en écriture.</span><span class="sxs-lookup"><span data-stu-id="99f1c-889">As shown in the sample below, the DS14 VM is delivering more than 100,000 combined Read and Write IOPS.</span></span> <span data-ttu-id="99f1c-890">Cette valeur représente les performances combinées du disque et du cache.</span><span class="sxs-lookup"><span data-stu-id="99f1c-890">This is a combination of the disk and the cache performance.</span></span>  
    ![](media/storage-premium-storage-performance/image13.png)

<span data-ttu-id="99f1c-891">*Débit maximal combiné*</span><span class="sxs-lookup"><span data-stu-id="99f1c-891">*Maximum Combined Throughput*</span></span>  
<span data-ttu-id="99f1c-892">Pour obtenir le débit maximal combiné en lecture et en écriture, utilisez une plus grande taille de bloc et une grande profondeur de file d’attente avec plusieurs threads effectuant des opérations de lecture et d’écriture.</span><span class="sxs-lookup"><span data-stu-id="99f1c-892">To get the maximum combined Read and Write Throughput, use a larger block size and large queue depth with multiple threads performing reads and writes.</span></span> <span data-ttu-id="99f1c-893">Vous pouvez utiliser une taille de bloc de 64 Ko et une profondeur de file d’attente de 128.</span><span class="sxs-lookup"><span data-stu-id="99f1c-893">You can use a block size of 64KB and queue depth of 128.</span></span>

## <a name="next-steps"></a><span data-ttu-id="99f1c-894">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="99f1c-894">Next Steps</span></span>
<span data-ttu-id="99f1c-895">En savoir plus sur Azure Premium Storage :</span><span class="sxs-lookup"><span data-stu-id="99f1c-895">Learn more about Azure Premium Storage:</span></span>

* [<span data-ttu-id="99f1c-896">Stockage Premium : stockage hautes performances pour les charges de travail des machines virtuelles Azure</span><span class="sxs-lookup"><span data-stu-id="99f1c-896">Premium Storage: High-Performance Storage for Azure Virtual Machine Workloads</span></span>](storage-premium-storage.md)  

<span data-ttu-id="99f1c-897">Pour les utilisateurs de SQL Server, consultez les articles relatifs aux meilleures pratiques de performances de SQL Server :</span><span class="sxs-lookup"><span data-stu-id="99f1c-897">For SQL Server users, read articles on Performance Best Practices for SQL Server:</span></span>

* [<span data-ttu-id="99f1c-898">Bonnes pratiques relatives aux performances de SQL Server sur les machines virtuelles Azure</span><span class="sxs-lookup"><span data-stu-id="99f1c-898">Performance Best Practices for SQL Server in Azure Virtual Machines</span></span>](../virtual-machines/windows/sql/virtual-machines-windows-sql-performance.md)
* [<span data-ttu-id="99f1c-899">Azure Premium Storage provides highest performance for SQL Server in Azure VM (en anglais)</span><span class="sxs-lookup"><span data-stu-id="99f1c-899">Azure Premium Storage provides highest performance for SQL Server in Azure VM</span></span>](http://blogs.technet.com/b/dataplatforminsider/archive/2015/04/23/azure-premium-storage-provides-highest-performance-for-sql-server-in-azure-vm.aspx)
