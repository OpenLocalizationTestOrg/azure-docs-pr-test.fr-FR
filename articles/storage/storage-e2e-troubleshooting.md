---
title: "Résolution des problèmes de stockage Azure avec les diagnostics et Message Analyzer | Microsoft Docs"
description: "Didacticiel illustrant la résolution des problèmes de bout en bout avec Azure Storage Analytics, AzCopy et Microsoft Message Analyzer"
services: storage
documentationcenter: dotnet
author: robinsh
manager: timlt
ms.assetid: 643372a3-1c07-4e88-b4ef-042512a43086
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 03/15/2017
ms.author: robinsh
ms.openlocfilehash: e2b739772f98a9c23253c58bb2bbd3560814ccaa
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/11/2017
---
# <a name="end-to-end-troubleshooting-using-azure-storage-metrics-and-logging-azcopy-and-message-analyzer"></a><span data-ttu-id="2df8b-103">Résolution des problèmes de bout en bout avec la journalisation et les mesures du stockage Azure, AzCopy et Message Analyzer</span><span class="sxs-lookup"><span data-stu-id="2df8b-103">End-to-End Troubleshooting using Azure Storage metrics and logging, AzCopy, and Message Analyzer</span></span>
[!INCLUDE [storage-selector-portal-e2e-troubleshooting](../../includes/storage-selector-portal-e2e-troubleshooting.md)]

<span data-ttu-id="2df8b-104">Diagnostic et résolution des problèmes sont essentiels pour la création et la prise en charge d'applications clientes avec Microsoft Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="2df8b-104">Diagnosing and troubleshooting is a key skill for building and supporting client applications with Microsoft Azure Storage.</span></span> <span data-ttu-id="2df8b-105">En raison de la nature distribuée d'une application Azure, diagnostic et résolution des erreurs et des problèmes de performances peuvent être plus complexes que dans les environnements traditionnels.</span><span class="sxs-lookup"><span data-stu-id="2df8b-105">Due to the distributed nature of an Azure application, diagnosing and troubleshooting errors and performance issues may be more complex than in traditional environments.</span></span>

<span data-ttu-id="2df8b-106">Dans ce didacticiel, nous allons montrer comment identifier certaines erreurs qui peuvent affecter les performances et comment résoudre ces erreurs de bout en bout à l'aide des outils fournis par Microsoft et Azure Storage, afin d'optimiser l'application cliente.</span><span class="sxs-lookup"><span data-stu-id="2df8b-106">In this tutorial, we demonstrate how to identify certain errors that may affect performance, and troubleshoot those errors from end-to-end using tools provided by Microsoft and Azure Storage, in order to optimize the client application.</span></span>

<span data-ttu-id="2df8b-107">Ce didacticiel fournit une exploration pratique d'un scénario de dépannage de bout en bout.</span><span class="sxs-lookup"><span data-stu-id="2df8b-107">This tutorial provides a hands-on exploration of an end-to-end troubleshooting scenario.</span></span> <span data-ttu-id="2df8b-108">Pour un guide conceptuel détaillé du dépannage des applications de stockage Azure, consultez la page [Analyse, diagnostic et résolution des problèmes rencontrés sur Microsoft Azure Storage](storage-monitoring-diagnosing-troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="2df8b-108">For an in-depth conceptual guide to troubleshooting Azure storage applications, see [Monitor, diagnose, and troubleshoot Microsoft Azure Storage](storage-monitoring-diagnosing-troubleshooting.md).</span></span>

## <a name="tools-for-troubleshooting-azure-storage-applications"></a><span data-ttu-id="2df8b-109">Outils de résolution des problèmes dans les applications Azure Storage</span><span class="sxs-lookup"><span data-stu-id="2df8b-109">Tools for troubleshooting Azure Storage applications</span></span>
<span data-ttu-id="2df8b-110">Pour résoudre les problèmes des applications clientes utilisant Microsoft Azure Storage, vous pouvez faire appel à une combinaison d'outils afin de déterminer quand un problème s'est produit et quelle peut en être la cause.</span><span class="sxs-lookup"><span data-stu-id="2df8b-110">To troubleshoot client applications using Microsoft Azure Storage, you can use a combination of tools to determine when an issue has occurred and what the cause of the problem may be.</span></span> <span data-ttu-id="2df8b-111">Ces outils incluent :</span><span class="sxs-lookup"><span data-stu-id="2df8b-111">These tools include:</span></span>

* <span data-ttu-id="2df8b-112">**Azure Storage Analytics**.</span><span class="sxs-lookup"><span data-stu-id="2df8b-112">**Azure Storage Analytics**.</span></span> <span data-ttu-id="2df8b-113">[Azure Storage Analytics](/rest/api/storageservices/Storage-Analytics) fournit des métriques et une journalisation pour Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="2df8b-113">[Azure Storage Analytics](/rest/api/storageservices/Storage-Analytics) provides metrics and logging for Azure Storage.</span></span>
  
  * <span data-ttu-id="2df8b-114">**Storage Metrics** assure le suivi des métriques de transaction et des métriques de capacité pour votre compte de stockage.</span><span class="sxs-lookup"><span data-stu-id="2df8b-114">**Storage metrics** tracks transaction metrics and capacity metrics for your storage account.</span></span> <span data-ttu-id="2df8b-115">Les métriques vous permettent de déterminer comment votre application s'exécute en fonction de plusieurs mesures différentes.</span><span class="sxs-lookup"><span data-stu-id="2df8b-115">Using metrics, you can determine how your application is performing according to a variety of different measures.</span></span> <span data-ttu-id="2df8b-116">Pour plus d'informations sur les types de métrique suivis par Storage Analytics, consultez la page [Schéma de table de métriques Storage Analytics](/rest/api/storageservices/Storage-Analytics-Metrics-Table-Schema) .</span><span class="sxs-lookup"><span data-stu-id="2df8b-116">See [Storage Analytics Metrics Table Schema](/rest/api/storageservices/Storage-Analytics-Metrics-Table-Schema) for more information about the types of metrics tracked by Storage Analytics.</span></span>
  * <span data-ttu-id="2df8b-117">**Journalisation du stockage** enregistre chaque demande aux services de stockage Azure dans un journal côté serveur.</span><span class="sxs-lookup"><span data-stu-id="2df8b-117">**Storage logging** logs each request to the Azure Storage services to a server-side log.</span></span> <span data-ttu-id="2df8b-118">Le journal assure le suivi des données détaillées de chaque demande, y compris l'opération effectuée, son statut et les informations de latence.</span><span class="sxs-lookup"><span data-stu-id="2df8b-118">The log tracks detailed data for each request, including the operation performed, the status of the operation, and latency information.</span></span> <span data-ttu-id="2df8b-119">Pour plus d’informations sur les données de demande et de réponse qui sont écrites dans les journaux par Storage Analytics, voir la page [Format de journal de Storage Analytics](/rest/api/storageservices/Storage-Analytics-Log-Format) .</span><span class="sxs-lookup"><span data-stu-id="2df8b-119">See [Storage Analytics Log Format](/rest/api/storageservices/Storage-Analytics-Log-Format) for more information about the request and response data that is written to the logs by Storage Analytics.</span></span>

> [!NOTE]
> <span data-ttu-id="2df8b-120">Pour l’instant, les fonctionnalités de mesure et de journalisation ne sont pas activées pour les comptes de stockage avec un type de réplication Stockage redondant dans une zone (ZRS).</span><span class="sxs-lookup"><span data-stu-id="2df8b-120">Storage accounts with a replication type of Zone-Redundant Storage (ZRS) do not have the metrics or logging capability enabled at this time.</span></span> 
> 
> 

* <span data-ttu-id="2df8b-121">**Portail Azure**.</span><span class="sxs-lookup"><span data-stu-id="2df8b-121">**Azure portal**.</span></span> <span data-ttu-id="2df8b-122">Vous pouvez configurer les mesures et la journalisation pour votre compte de stockage dans le [portail Azure](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="2df8b-122">You can configure metrics and logging for your storage account in the [Azure portal](https://portal.azure.com).</span></span> <span data-ttu-id="2df8b-123">Vous pouvez également afficher des tableaux et des graphiques qui illustrent le fonctionnement de votre application au fil du temps et configurer des alertes pour vous avertir si votre application ne fonctionne pas comme prévu pour une métrique spécifique.</span><span class="sxs-lookup"><span data-stu-id="2df8b-123">You can also view charts and graphs that show how your application is performing over time, and configure alerts to notify you if your application performs differently than expected for a specified metric.</span></span>
  
    <span data-ttu-id="2df8b-124">Pour plus d’informations sur la configuration de la surveillance dans le portail Azure, consultez la page [Surveillance d’un compte de stockage dans le portail Azure](storage-monitor-storage-account.md).</span><span class="sxs-lookup"><span data-stu-id="2df8b-124">See [Monitor a storage account in the Azure portal](storage-monitor-storage-account.md) for information about configuring monitoring in the Azure portal.</span></span>
* <span data-ttu-id="2df8b-125">**AzCopy**.</span><span class="sxs-lookup"><span data-stu-id="2df8b-125">**AzCopy**.</span></span> <span data-ttu-id="2df8b-126">Les journaux de serveur pour Azure Storage sont stockés sous forme d'objets blob ; vous pouvez donc utiliser AzCopy pour copier les objets blob de journal dans un répertoire local pour l'analyse à l'aide de Microsoft Message Analyzer.</span><span class="sxs-lookup"><span data-stu-id="2df8b-126">Server logs for Azure Storage are stored as blobs, so you can use AzCopy to copy the log blobs to a local directory for analysis using Microsoft Message Analyzer.</span></span> <span data-ttu-id="2df8b-127">Pour plus d’informations sur AzCopy, consultez [Transfert de données avec l’utilitaire de ligne de commande AzCopy](storage-use-azcopy.md) .</span><span class="sxs-lookup"><span data-stu-id="2df8b-127">See [Transfer data with the AzCopy Command-Line Utility](storage-use-azcopy.md) for more information about AzCopy.</span></span>
* <span data-ttu-id="2df8b-128">**Microsoft Message Analyzer**.</span><span class="sxs-lookup"><span data-stu-id="2df8b-128">**Microsoft Message Analyzer**.</span></span> <span data-ttu-id="2df8b-129">Message Analyzer est un outil qui utilise des fichiers journaux et affiche les données des journaux dans un format visuel qui facilite le filtrage, la recherche et le regroupement des données de journaux dans des ensembles utiles dont vous pouvez vous servir pour analyser les erreurs et les problèmes de performances.</span><span class="sxs-lookup"><span data-stu-id="2df8b-129">Message Analyzer is a tool that consumes log files and displays log data in a visual format that makes it easy to filter, search, and group log data into useful sets that you can use to analyze errors and performance issues.</span></span> <span data-ttu-id="2df8b-130">Pour plus d'informations sur Message Analyzer, consultez la page [Guide d'exploitation de Microsoft Message Analyzer](http://technet.microsoft.com/library/jj649776.aspx) .</span><span class="sxs-lookup"><span data-stu-id="2df8b-130">See [Microsoft Message Analyzer Operating Guide](http://technet.microsoft.com/library/jj649776.aspx) for more information about Message Analyzer.</span></span>

## <a name="about-the-sample-scenario"></a><span data-ttu-id="2df8b-131">À propos de l'exemple de scénario</span><span class="sxs-lookup"><span data-stu-id="2df8b-131">About the sample scenario</span></span>
<span data-ttu-id="2df8b-132">Pour ce didacticiel, nous allons examiner un scénario où les métriques Azure Storage indiquent un faible taux de réussite pour une application qui appelle le stockage Azure.</span><span class="sxs-lookup"><span data-stu-id="2df8b-132">For this tutorial, we'll examine a scenario where Azure Storage metrics indicates a low percent success rate for an application that calls Azure storage.</span></span> <span data-ttu-id="2df8b-133">La métrique de taux faible de réussite (indiquée en tant que **PercentSuccess** dans le [portail Azure](https://portal.azure.com) et dans les tables de mesures) assure le suivi des opérations qui réussissent, mais qui retournent un code d’état HTTP supérieur à 299.</span><span class="sxs-lookup"><span data-stu-id="2df8b-133">The low percent success rate metric (shown as **PercentSuccess** in the [Azure portal](https://portal.azure.com) and in the metrics tables) tracks operations that succeed, but that return an HTTP status code that is greater than 299.</span></span> <span data-ttu-id="2df8b-134">Dans les fichiers journaux de stockage côté serveur, ces opérations sont enregistrées avec un statut de transaction **ClientOtherErrors**.</span><span class="sxs-lookup"><span data-stu-id="2df8b-134">In the server-side storage log files, these operations are recorded with a transaction status of **ClientOtherErrors**.</span></span> <span data-ttu-id="2df8b-135">Pour plus d'informations sur les métriques de faible taux de réussite, consultez la rubrique [Les métriques indiquent une valeur PercentSuccess faible ou les entrées du journal d'analyse incluent des opérations avec un statut de transaction ClientOtherErrors](storage-monitoring-diagnosing-troubleshooting.md#metrics-show-low-percent-success).</span><span class="sxs-lookup"><span data-stu-id="2df8b-135">For more details about the low percent success metric, see [Metrics show low PercentSuccess or analytics log entries have operations with transaction status of ClientOtherErrors](storage-monitoring-diagnosing-troubleshooting.md#metrics-show-low-percent-success).</span></span>

<span data-ttu-id="2df8b-136">Les opérations d’Azure Storage peuvent renvoyer les codes d’état HTTP supérieurs à 299 dans le cadre de leur fonctionnement normal.</span><span class="sxs-lookup"><span data-stu-id="2df8b-136">Azure Storage operations may return HTTP status codes greater than 299 as part of their normal functionality.</span></span> <span data-ttu-id="2df8b-137">Mais dans certains cas, ces erreurs indiquent que vous pouvez peut-être optimiser votre application cliente pour améliorer les performances.</span><span class="sxs-lookup"><span data-stu-id="2df8b-137">But these errors in some cases indicate that you may be able to optimize your client application for improved performance.</span></span>

<span data-ttu-id="2df8b-138">Dans ce scénario, nous allons considérer comme un faible taux de réussite tout ce qui est inférieur à 100 %.</span><span class="sxs-lookup"><span data-stu-id="2df8b-138">In this scenario, we'll consider a low percent success rate to be anything below 100%.</span></span> <span data-ttu-id="2df8b-139">Vous pouvez cependant choisir un autre niveau de métrique, en fonction de vos besoins.</span><span class="sxs-lookup"><span data-stu-id="2df8b-139">You can choose a different metric level, however, according to your needs.</span></span> <span data-ttu-id="2df8b-140">Nous vous recommandons, pendant le test de votre application, d'établir une tolérance de référence pour les métriques de performances clés.</span><span class="sxs-lookup"><span data-stu-id="2df8b-140">We recommend that during testing of your application, you establish a baseline tolerance for your key performance metrics.</span></span> <span data-ttu-id="2df8b-141">Par exemple, vous pouvez déterminer, sur la base de tests, que votre application doit avoir un taux de réussite de 90 % ou 85 %.</span><span class="sxs-lookup"><span data-stu-id="2df8b-141">For example, you might determine, based on testing, that your application should have a consistent percent success rate of 90%, or 85%.</span></span> <span data-ttu-id="2df8b-142">Si vos données métriques montrent que l'application s'écarte de cette valeur, vous pouvez rechercher ce qui est susceptible de provoquer l'augmentation.</span><span class="sxs-lookup"><span data-stu-id="2df8b-142">If your metrics data shows that the application is deviating from that number, then you can investigate what may be causing the increase.</span></span>

<span data-ttu-id="2df8b-143">Pour notre exemple de scénario, une fois que nous avons établi que la métrique du taux de réussite est inférieure à 100 %, nous allons examiner les journaux afin de rechercher les erreurs correspondant aux métriques et les utiliser pour déterminer ce qui provoque le taux de réussite plus faible.</span><span class="sxs-lookup"><span data-stu-id="2df8b-143">For our sample scenario, once we've established that the percent success rate metric is below 100%, we will examine the logs to find the errors that correlate to the metrics, and use them to figure out what is causing the lower percent success rate.</span></span> <span data-ttu-id="2df8b-144">Nous examinerons plus particulièrement les erreurs dans la plage 400.</span><span class="sxs-lookup"><span data-stu-id="2df8b-144">We'll look specifically at errors in the 400 range.</span></span> <span data-ttu-id="2df8b-145">Ensuite, nous étudierons plus en détail les erreurs 404 (Introuvable).</span><span class="sxs-lookup"><span data-stu-id="2df8b-145">Then we'll more closely investigate 404 (Not Found) errors.</span></span>

### <a name="some-causes-of-400-range-errors"></a><span data-ttu-id="2df8b-146">Certaines causes d'erreurs dans la plage 400</span><span class="sxs-lookup"><span data-stu-id="2df8b-146">Some causes of 400-range errors</span></span>
<span data-ttu-id="2df8b-147">Les exemples ci-dessous présentent un échantillon d'erreurs dans la plage 400 pour des demandes sur le stockage d'objets blob d'Azure, avec leurs causes possibles.</span><span class="sxs-lookup"><span data-stu-id="2df8b-147">The examples below shows a sampling of some 400-range errors for requests against Azure Blob Storage, and their possible causes.</span></span> <span data-ttu-id="2df8b-148">Toutes ces erreurs, ainsi que des erreurs dans la plage 300 et la plage 500, peuvent contribuer à un faible taux de réussite.</span><span class="sxs-lookup"><span data-stu-id="2df8b-148">Any of these errors, as well as errors in the 300 range and the 500 range, can contribute to a low percent success rate.</span></span>

<span data-ttu-id="2df8b-149">Notez que les listes ci-dessous sont loin d'être complètes.</span><span class="sxs-lookup"><span data-stu-id="2df8b-149">Note that the lists below are far from complete.</span></span> <span data-ttu-id="2df8b-150">Pour plus d'informations sur les erreurs générales dans Azure Storage et sur les erreurs propres à chacun des services de stockage, consultez la page [Codes d'état et d'erreur](http://msdn.microsoft.com/library/azure/dd179382.aspx) sur MSDN.</span><span class="sxs-lookup"><span data-stu-id="2df8b-150">See [Status and Error Codes](http://msdn.microsoft.com/library/azure/dd179382.aspx) on MSDN for details about general Azure Storage errors and about errors specific to each of the storage services.</span></span>

<span data-ttu-id="2df8b-151">**Exemples de code d’état 404 (Introuvable)**</span><span class="sxs-lookup"><span data-stu-id="2df8b-151">**Status Code 404 (Not Found) Examples**</span></span>

<span data-ttu-id="2df8b-152">Se produit lorsqu'une opération de lecture sur un conteneur ou un objet blob échoue parce que l'objet blob ou le conteneur est introuvable.</span><span class="sxs-lookup"><span data-stu-id="2df8b-152">Occurs when a read operation against a container or blob fails because the blob or container is not found.</span></span>

* <span data-ttu-id="2df8b-153">Se produit si un conteneur ou un objet blob a été supprimé par un autre client avant cette demande.</span><span class="sxs-lookup"><span data-stu-id="2df8b-153">Occurs if a container or blob has been deleted by another client before this request.</span></span>
* <span data-ttu-id="2df8b-154">Se produit si vous utilisez un appel d'API qui crée le conteneur ou l'objet blob après avoir vérifié s'il existe.</span><span class="sxs-lookup"><span data-stu-id="2df8b-154">Occurs if you are using an API call that creates the container or blob after checking whether it exists.</span></span> <span data-ttu-id="2df8b-155">Les API CreateIfNotExists effectuent un appel HEAD pour vérifier l'existence du conteneur ou de l'objet blob ; s'il n'existe pas, une erreur 404 est retournée, puis un second appel PUT est effectué pour écrire le conteneur ou l'objet blob.</span><span class="sxs-lookup"><span data-stu-id="2df8b-155">The CreateIfNotExists APIs make a HEAD call first to check for the existence of the container or blob; if it does not exist, a 404 error is returned, and then a second PUT call is made to write the container or blob.</span></span>

<span data-ttu-id="2df8b-156">**Exemples de code d'état 409 (Conflit)**</span><span class="sxs-lookup"><span data-stu-id="2df8b-156">**Status Code 409 (Conflict) Examples**</span></span>

* <span data-ttu-id="2df8b-157">Se produit si vous utilisez une API de création pour créer un conteneur ou un objet blob, sans vérification préalable de l'existence, et qu'un conteneur ou un objet blob avec ce nom existe déjà.</span><span class="sxs-lookup"><span data-stu-id="2df8b-157">Occurs if you use a Create API to create a new container or blob, without checking for existence first, and a container or blob with that name already exists.</span></span>
* <span data-ttu-id="2df8b-158">Se produit si un conteneur est supprimé et que vous tentez de créer un nouveau conteneur portant le même nom avant que l'opération de suppression ne soit terminée.</span><span class="sxs-lookup"><span data-stu-id="2df8b-158">Occurs if a container is being deleted, and you attempt to create a new container with the same name before the deletion operation is complete.</span></span>
* <span data-ttu-id="2df8b-159">Se produit si vous spécifiez un bail sur un conteneur ou un objet blob, alors qu'il existe déjà un bail.</span><span class="sxs-lookup"><span data-stu-id="2df8b-159">Occurs if you specify a lease on a container or blob, and there is already a lease present.</span></span>

<span data-ttu-id="2df8b-160">**Exemples de code d'état 412 (Échec de la précondition)**</span><span class="sxs-lookup"><span data-stu-id="2df8b-160">**Status Code 412 (Precondition Failed) Examples**</span></span>

* <span data-ttu-id="2df8b-161">Se produit lorsque la condition spécifiée par un en-tête conditionnel n'a pas été remplie.</span><span class="sxs-lookup"><span data-stu-id="2df8b-161">Occurs when the condition specified by a conditional header has not been met.</span></span>
* <span data-ttu-id="2df8b-162">Se produit lorsque l'ID de bail spécifié ne correspond pas à l'ID de bail sur le conteneur ou l'objet blob.</span><span class="sxs-lookup"><span data-stu-id="2df8b-162">Occurs when the lease ID specified does not match the lease ID on the container or blob.</span></span>

## <a name="generate-log-files-for-analysis"></a><span data-ttu-id="2df8b-163">Génération de fichiers journaux pour l'analyse</span><span class="sxs-lookup"><span data-stu-id="2df8b-163">Generate log files for analysis</span></span>
<span data-ttu-id="2df8b-164">Dans ce didacticiel, nous allons utiliser Message Analyzer pour travailler avec trois types de fichiers journaux différents, mais vous pouvez travailler avec celui de votre choix :</span><span class="sxs-lookup"><span data-stu-id="2df8b-164">In this tutorial, we'll use Message Analyzer to work with three different types of log files, although you could choose to work with any one of these:</span></span>

* <span data-ttu-id="2df8b-165">Le **journal du serveur**, qui est créé lorsque vous activez la journalisation Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="2df8b-165">The **server log**, which is created when you enable Azure Storage logging.</span></span> <span data-ttu-id="2df8b-166">Le journal du serveur contient des données sur chaque opération appelée sur un des services Azure Storage - objet blob, file d'attente, table et fichier.</span><span class="sxs-lookup"><span data-stu-id="2df8b-166">The server log contains data about each operation called against one of the Azure Storage services - blob, queue, table, and file.</span></span> <span data-ttu-id="2df8b-167">Le journal du serveur indique quelle opération a été appelée et quel code d'état a été retourné, ainsi que d'autres détails sur la demande et la réponse.</span><span class="sxs-lookup"><span data-stu-id="2df8b-167">The server log indicates which operation was called and what status code was returned, as well as other details about the request and response.</span></span>
* <span data-ttu-id="2df8b-168">Le **journal du client .NET**, qui est créé lorsque vous activez la journalisation côté client à partir de votre application .NET.</span><span class="sxs-lookup"><span data-stu-id="2df8b-168">The **.NET client log**, which is created when you enable client-side logging from within your .NET application.</span></span> <span data-ttu-id="2df8b-169">Le journal du client inclut des informations détaillées sur la façon dont le client prépare la demande, puis reçoit et traite la réponse.</span><span class="sxs-lookup"><span data-stu-id="2df8b-169">The client log includes detailed information about how the client prepares the request and receives and processes the response.</span></span>
* <span data-ttu-id="2df8b-170">Le **journal de suivi du réseau HTTP**, qui collecte les données sur les données des demandes et réponses HTTP/HTTPS, notamment pour les opérations sur Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="2df8b-170">The **HTTP network trace log**, which collects data on HTTP/HTTPS request and response data, including for operations against Azure Storage.</span></span> <span data-ttu-id="2df8b-171">Dans ce didacticiel, nous allons générer le suivi réseau via Message Analyzer.</span><span class="sxs-lookup"><span data-stu-id="2df8b-171">In this tutorial, we'll generate the network trace via Message Analyzer.</span></span>

### <a name="configure-server-side-logging-and-metrics"></a><span data-ttu-id="2df8b-172">Configuration de la journalisation et des métriques côté serveur</span><span class="sxs-lookup"><span data-stu-id="2df8b-172">Configure server-side logging and metrics</span></span>
<span data-ttu-id="2df8b-173">Tout d’abord, nous allons devoir configurer la journalisation et les métriques Azure Storage afin d’avoir des données de l’application cliente à analyser.</span><span class="sxs-lookup"><span data-stu-id="2df8b-173">First, we'll need to configure Azure Storage logging and metrics, so that we have data from the client application to analyze.</span></span> <span data-ttu-id="2df8b-174">Vous pouvez configurer la journalisation et les métriques de plusieurs manières : via le [portail Azure](https://portal.azure.com), à l’aide de PowerShell ou par programme.</span><span class="sxs-lookup"><span data-stu-id="2df8b-174">You can configure logging and metrics in a variety of ways - via the [Azure portal](https://portal.azure.com), by using PowerShell, or programmatically.</span></span> <span data-ttu-id="2df8b-175">Pour plus d’informations sur la configuration de la journalisation et des métriques, consultez les pages [Activation de Storage Metrics et affichage des données de métriques](http://msdn.microsoft.com/library/azure/dn782843.aspx) et [Activation de la journalisation du stockage et accès aux données de journal](http://msdn.microsoft.com/library/azure/dn782840.aspx) sur MSDN.</span><span class="sxs-lookup"><span data-stu-id="2df8b-175">See [Enabling Storage Metrics and Viewing Metrics Data](http://msdn.microsoft.com/library/azure/dn782843.aspx) and [Enabling Storage Logging and Accessing Log Data](http://msdn.microsoft.com/library/azure/dn782840.aspx) on MSDN for details about configuring logging and metrics.</span></span>

<span data-ttu-id="2df8b-176">**Via le portail Azure**</span><span class="sxs-lookup"><span data-stu-id="2df8b-176">**Via the Azure portal**</span></span>

<span data-ttu-id="2df8b-177">Pour configurer la journalisation et les métriques pour votre compte de stockage à l’aide du [portail Azure](https://portal.azure.com), suivez les instructions de la page [Surveillance d’un compte de stockage dans le portail Azure](storage-monitor-storage-account.md).</span><span class="sxs-lookup"><span data-stu-id="2df8b-177">To configure logging and metrics for your storage account using the [Azure portal](https://portal.azure.com), follow the instructions at [Monitor a storage account in the Azure portal](storage-monitor-storage-account.md).</span></span>

> [!NOTE]
> <span data-ttu-id="2df8b-178">Il n’est pas possible de définir des métriques par minute à l’aide du portail Azure.</span><span class="sxs-lookup"><span data-stu-id="2df8b-178">It's not possible to set minute metrics using the Azure portal.</span></span> <span data-ttu-id="2df8b-179">Toutefois, nous vous recommandons de les définir dans le cadre de ce didacticiel et pour examiner les problèmes de performances de votre application.</span><span class="sxs-lookup"><span data-stu-id="2df8b-179">However, we recommend that you do set them for the purposes of this tutorial, and for investigating performance issues with your application.</span></span> <span data-ttu-id="2df8b-180">Vous pouvez définir des métriques par minute à l’aide de PowerShell comme indiqué ci-dessous, par programme à l’aide de la bibliothèque cliente de stockage.</span><span class="sxs-lookup"><span data-stu-id="2df8b-180">You can set minute metrics using PowerShell as shown below, or programmatically using the storage client library.</span></span>
> 
> <span data-ttu-id="2df8b-181">Notez que le portail Azure ne peut pas afficher les métriques par minute, mais seulement les métriques par heure.</span><span class="sxs-lookup"><span data-stu-id="2df8b-181">Note that the Azure portal cannot display minute metrics, only hourly metrics.</span></span>
> 
> 

<span data-ttu-id="2df8b-182">**Via PowerShell**</span><span class="sxs-lookup"><span data-stu-id="2df8b-182">**Via PowerShell**</span></span>

<span data-ttu-id="2df8b-183">Pour commencer à utiliser PowerShell pour Azure, consultez la page [Installation et configuration d’Azure PowerShell](/powershell/azure/overview).</span><span class="sxs-lookup"><span data-stu-id="2df8b-183">To get started with PowerShell for Azure, see [How to install and configure Azure PowerShell](/powershell/azure/overview).</span></span>

1. <span data-ttu-id="2df8b-184">Utilisez l'applet de commande [Add-AzureAccount](/powershell/module/azure/add-azureaccount?view=azuresmps-3.7.0) pour ajouter votre compte d'utilisateur Azure dans la fenêtre PowerShell :</span><span class="sxs-lookup"><span data-stu-id="2df8b-184">Use the [Add-AzureAccount](/powershell/module/azure/add-azureaccount?view=azuresmps-3.7.0) cmdlet to add your Azure user account to the PowerShell window:</span></span>
   
    ```powershell
    Add-AzureAccount
    ```

2. <span data-ttu-id="2df8b-185">Dans la fenêtre **Connectez-vous à Microsoft Azure** , tapez l'adresse électronique et le mot de passe associés à votre compte.</span><span class="sxs-lookup"><span data-stu-id="2df8b-185">In the **Sign in to Microsoft Azure** window, type the email address and password associated with your account.</span></span> <span data-ttu-id="2df8b-186">Azure authentifie et enregistre les informations d’identification, puis ferme la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="2df8b-186">Azure authenticates and saves the credential information, and then closes the window.</span></span>
3. <span data-ttu-id="2df8b-187">Définissez le compte de stockage par défaut sur le compte de stockage que vous utilisez pour le didacticiel en exécutant ces commandes dans la fenêtre PowerShell :</span><span class="sxs-lookup"><span data-stu-id="2df8b-187">Set the default storage account to the storage account you are using for the tutorial by executing these commands in the PowerShell window:</span></span>
   
    ```powershell
    $SubscriptionName = 'Your subscription name'
    $StorageAccountName = 'yourstorageaccount'
    Set-AzureSubscription -CurrentStorageAccountName $StorageAccountName -SubscriptionName $SubscriptionName
    ```

4. <span data-ttu-id="2df8b-188">Activez la journalisation du stockage pour le service d'objets blob :</span><span class="sxs-lookup"><span data-stu-id="2df8b-188">Enable storage logging for the Blob service:</span></span>
   
    ```powershell
    Set-AzureStorageServiceLoggingProperty -ServiceType Blob -LoggingOperations Read,Write,Delete -PassThru -RetentionDays 7 -Version 1.0
    ```

5. <span data-ttu-id="2df8b-189">Activez les métriques du stockage pour le service d’objets blob, en veillant à définir **-MetricsType** sur `Minute` :</span><span class="sxs-lookup"><span data-stu-id="2df8b-189">Enable storage metrics for the Blob service, making sure to set **-MetricsType** to `Minute`:</span></span>
   
    ```powershell
    Set-AzureStorageServiceMetricsProperty -ServiceType Blob -MetricsType Minute -MetricsLevel ServiceAndApi -PassThru -RetentionDays 7 -Version 1.0
    ```

### <a name="configure-net-client-side-logging"></a><span data-ttu-id="2df8b-190">Configuration de la journalisation côté client .NET</span><span class="sxs-lookup"><span data-stu-id="2df8b-190">Configure .NET client-side logging</span></span>
<span data-ttu-id="2df8b-191">Pour configurer la journalisation côté client pour une application .NET, activez les diagnostics .NET dans le fichier de configuration de l'application (web.config ou app.config).</span><span class="sxs-lookup"><span data-stu-id="2df8b-191">To configure client-side logging for a .NET application, enable .NET diagnostics in the application's configuration file (web.config or app.config).</span></span> <span data-ttu-id="2df8b-192">Pour plus d’informations, consultez les pages [Journalisation côté client avec la bibliothèque cliente de stockage .NET](http://msdn.microsoft.com/library/azure/dn782839.aspx) et [Journalisation côté client avec le Kit de développement logiciel (SDK) Microsoft Azure Storage pour Java](http://msdn.microsoft.com/library/azure/dn782844.aspx) sur MSDN.</span><span class="sxs-lookup"><span data-stu-id="2df8b-192">See [Client-side Logging with the .NET Storage Client Library](http://msdn.microsoft.com/library/azure/dn782839.aspx) and [Client-side Logging with the Microsoft Azure Storage SDK for Java](http://msdn.microsoft.com/library/azure/dn782844.aspx) on MSDN for details.</span></span>

<span data-ttu-id="2df8b-193">Le journal côté client inclut des informations détaillées sur la manière dont le client prépare la demande, puis reçoit et traite la réponse.</span><span class="sxs-lookup"><span data-stu-id="2df8b-193">The client-side log includes detailed information about how the client prepares the request and receives and processes the response.</span></span>

<span data-ttu-id="2df8b-194">La bibliothèque cliente de stockage stocke les données du journal côté client à l'emplacement spécifié dans le fichier de configuration de l'application (web.config ou app.config).</span><span class="sxs-lookup"><span data-stu-id="2df8b-194">The Storage Client Library stores client-side log data in the location specified in the application's configuration file (web.config or app.config).</span></span>

### <a name="collect-a-network-trace"></a><span data-ttu-id="2df8b-195">Collecte d'un suivi réseau</span><span class="sxs-lookup"><span data-stu-id="2df8b-195">Collect a network trace</span></span>
<span data-ttu-id="2df8b-196">Vous pouvez utiliser Message Analyzer pour collecter un suivi réseau HTTP/HTTPS pendant l'exécution de votre application cliente.</span><span class="sxs-lookup"><span data-stu-id="2df8b-196">You can use Message Analyzer to collect an HTTP/HTTPS network trace while your client application is running.</span></span> <span data-ttu-id="2df8b-197">Message Analyzer utilise [Fiddler](http://www.telerik.com/fiddler) sur le serveur principal.</span><span class="sxs-lookup"><span data-stu-id="2df8b-197">Message Analyzer uses [Fiddler](http://www.telerik.com/fiddler) on the back end.</span></span> <span data-ttu-id="2df8b-198">Avant de collecter le suivi réseau, nous vous recommandons de configurer Fiddler pour enregistrer le trafic HTTPS non chiffré :</span><span class="sxs-lookup"><span data-stu-id="2df8b-198">Before you collect the network trace, we recommend that you configure Fiddler to record unencrypted HTTPS traffic:</span></span>

1. <span data-ttu-id="2df8b-199">Installez [Fiddler](http://www.telerik.com/download/fiddler).</span><span class="sxs-lookup"><span data-stu-id="2df8b-199">Install [Fiddler](http://www.telerik.com/download/fiddler).</span></span>
2. <span data-ttu-id="2df8b-200">Lancez Fiddler.</span><span class="sxs-lookup"><span data-stu-id="2df8b-200">Launch Fiddler.</span></span>
3. <span data-ttu-id="2df8b-201">Sélectionnez **Tools | Fiddler Options (Outils | Options de Fiddler)**.</span><span class="sxs-lookup"><span data-stu-id="2df8b-201">Select **Tools | Fiddler Options**.</span></span>
4. <span data-ttu-id="2df8b-202">Dans la boîte de dialogue Options (Options), vérifiez que **Capture HTTPS CONNECTs (Capturer les CONNECT HTTPS)** et **Decrypt HTTPS Traffic (Déchiffrer le trafic HTTPS)** sont tous deux activés, comme illustré ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="2df8b-202">In the Options dialog, ensure that **Capture HTTPS CONNECTs** and **Decrypt HTTPS Traffic** are both selected, as shown below.</span></span>

![Configuration des options de Fiddler](./media/storage-e2e-troubleshooting/fiddler-options-1.png)

<span data-ttu-id="2df8b-204">Dans le didacticiel, collectez et enregistrez d'abord un suivi réseau dans Message Analyzer, puis créez une session d'analyse pour analyser le suivi et les journaux.</span><span class="sxs-lookup"><span data-stu-id="2df8b-204">For the tutorial, collect and save a network trace first in Message Analyzer, then create an analysis session to analyze the trace and the logs.</span></span> <span data-ttu-id="2df8b-205">Pour collecter un suivi réseau dans Message Analyzer :</span><span class="sxs-lookup"><span data-stu-id="2df8b-205">To collect a network trace in Message Analyzer:</span></span>

1. <span data-ttu-id="2df8b-206">Dans Message Analyzer, sélectionnez **File | Quick Trace | Unencrypted HTTPS (Fichier | Suivi rapide | HTTPS non chiffré)**.</span><span class="sxs-lookup"><span data-stu-id="2df8b-206">In Message Analyzer, select **File | Quick Trace | Unencrypted HTTPS**.</span></span>
2. <span data-ttu-id="2df8b-207">Le suivi commence immédiatement.</span><span class="sxs-lookup"><span data-stu-id="2df8b-207">The trace will begin immediately.</span></span> <span data-ttu-id="2df8b-208">Cliquez sur **Arrêter** pour arrêter le suivi afin que nous puissions le configurer pour le suivi du trafic de stockage uniquement.</span><span class="sxs-lookup"><span data-stu-id="2df8b-208">Select **Stop** to stop the trace so that we can configure it to trace storage traffic only.</span></span>
3. <span data-ttu-id="2df8b-209">Cliquez sur **Modifier** pour modifier la session de suivi.</span><span class="sxs-lookup"><span data-stu-id="2df8b-209">Select **Edit** to edit the tracing session.</span></span>
4. <span data-ttu-id="2df8b-210">Cliquez sur le lien **Configure (Configurer)** à droite du fournisseur ETW **Microsoft-performance-WebProxy**.</span><span class="sxs-lookup"><span data-stu-id="2df8b-210">Select the **Configure** link to the right of the **Microsoft-Pef-WebProxy** ETW provider.</span></span>
5. <span data-ttu-id="2df8b-211">Dans la boîte de dialogue **Advanced Settings (Paramètres avancés)**, cliquez sur l’onglet **Provider (Fournisseur)**.</span><span class="sxs-lookup"><span data-stu-id="2df8b-211">In the **Advanced Settings** dialog, click the **Provider** tab.</span></span>
6. <span data-ttu-id="2df8b-212">Dans le champ **Filtre de nom d'hôte** , indiquez vos points de terminaison de stockage séparés par des espaces.</span><span class="sxs-lookup"><span data-stu-id="2df8b-212">In the **Hostname Filter** field, specify your storage endpoints, separated by spaces.</span></span> <span data-ttu-id="2df8b-213">Par exemple, vous pouvez spécifier vos points de terminaison comme suit (remplacez `storagesample` par le nom de votre compte de stockage) :</span><span class="sxs-lookup"><span data-stu-id="2df8b-213">For example, you can specify your endpoints as follows; change `storagesample` to the name of your storage account:</span></span>

    ```   
    storagesample.blob.core.windows.net storagesample.queue.core.windows.net storagesample.table.core.windows.net
    ```

7. <span data-ttu-id="2df8b-214">Fermez la boîte de dialogue, puis cliquez sur **Redémarrer** pour commencer à collecter le suivi avec le filtre de nom d'hôte en place, afin que seul le trafic réseau d'Azure Storage soit inclus dans le suivi.</span><span class="sxs-lookup"><span data-stu-id="2df8b-214">Exit the dialog, and click **Restart** to begin collecting the trace with the hostname filter in place, so that only Azure Storage network traffic is included in the trace.</span></span>

> [!NOTE]
> <span data-ttu-id="2df8b-215">Après avoir terminé la collecte de votre suivi réseau, nous vous recommandons fortement de rétablir les paramètres que vous avez éventuellement modifiés dans Fiddler pour déchiffrer le trafic HTTPS.</span><span class="sxs-lookup"><span data-stu-id="2df8b-215">After you have finished collecting your network trace, we strongly recommend that you revert the settings that you may have changed in Fiddler to decrypt HTTPS traffic.</span></span> <span data-ttu-id="2df8b-216">Dans la boîte de dialogue Fiddler Options (Options de Fiddler), désactivez les cases à cocher **Capture HTTPS CONNECTs (Capturer les CONNECT HTTPS)** et **Decrypt HTTPS Traffic (Déchiffrer le trafic HTTPS)**.</span><span class="sxs-lookup"><span data-stu-id="2df8b-216">In the Fiddler Options dialog, deselect the **Capture HTTPS CONNECTs** and **Decrypt HTTPS Traffic** checkboxes.</span></span>
> 
> 

<span data-ttu-id="2df8b-217">Pour plus de détails, voir la page [Utilisation des fonctionnalités de suivi réseau](http://technet.microsoft.com/library/jj674819.aspx) sur Technet.</span><span class="sxs-lookup"><span data-stu-id="2df8b-217">See [Using the Network Tracing Features](http://technet.microsoft.com/library/jj674819.aspx) on Technet for more details.</span></span>

## <a name="review-metrics-data-in-the-azure-portal"></a><span data-ttu-id="2df8b-218">Revue des données des métriques dans le portail Azure</span><span class="sxs-lookup"><span data-stu-id="2df8b-218">Review metrics data in the Azure portal</span></span>
<span data-ttu-id="2df8b-219">Une fois que votre application a fonctionné pendant une période donnée, vous pouvez consulter les graphiques des métriques qui apparaissent dans le [portail Azure](https://portal.azure.com) pour observer la façon dont votre service a fonctionné.</span><span class="sxs-lookup"><span data-stu-id="2df8b-219">Once your application has been running for a period of time, you can review the metrics charts that appear in the [Azure portal](https://portal.azure.com) to observe how your service has been performing.</span></span>

<span data-ttu-id="2df8b-220">D’abord, accédez à votre compte de stockage dans le Portail Azure.</span><span class="sxs-lookup"><span data-stu-id="2df8b-220">First, navigate to your storage account in the Azure portal.</span></span> <span data-ttu-id="2df8b-221">Par défaut, un graphique de surveillance avec la mesure **pourcentage de réussite** mesure s’affiche dans le panneau du compte.</span><span class="sxs-lookup"><span data-stu-id="2df8b-221">By default, a monitoring chart with the **Success percentage** metric is displayed on the account blade.</span></span> <span data-ttu-id="2df8b-222">Si vous avez modifié précédemment le graphique pour afficher des mesures différentes, ajoutez la mesure **pourcentage de réussite**.</span><span class="sxs-lookup"><span data-stu-id="2df8b-222">If you've previously modified the chart to display different metrics, add the **Success percentage** metric.</span></span>

<span data-ttu-id="2df8b-223">**Pourcentage de réussite** apparaît désormais dans le graphique de surveillance, ainsi que les autres métriques vous avez ajoutées.</span><span class="sxs-lookup"><span data-stu-id="2df8b-223">You'll now see **Success percentage** in the monitoring chart, along with any other metrics you may have added.</span></span> <span data-ttu-id="2df8b-224">Dans le scénario que nous étudierons ensuite en analysant les journaux dans Message Analyzer, le taux de pourcentage de réussite est légèrement inférieur à 100 %.</span><span class="sxs-lookup"><span data-stu-id="2df8b-224">In the scenario we'll investigate next by analyzing the logs in Message Analyzer, the percent success rate is somewhat below 100%.</span></span>

<span data-ttu-id="2df8b-225">Pour plus d’informations sur l’ajout et la personnalisation de graphiques de mesures, consultez [Personnalisation des graphiques de mesures](storage-monitor-storage-account.md#customize-metrics-charts).</span><span class="sxs-lookup"><span data-stu-id="2df8b-225">For more details on adding and customizing metrics charts, see [Customize metrics charts](storage-monitor-storage-account.md#customize-metrics-charts).</span></span>

> [!NOTE]
> <span data-ttu-id="2df8b-226">Les données de vos mesures peuvent mettre un certain temps pour apparaître dans le portail Azure une fois que vous avez activé les mesures de stockage.</span><span class="sxs-lookup"><span data-stu-id="2df8b-226">It may take some time for your metrics data to appear in the Azure portal after you enable storage metrics.</span></span> <span data-ttu-id="2df8b-227">C’est parce que les métriques horaires correspondant à l’heure précédente ne sont pas affichées dans le portail Azure tant que l’heure courante n’est pas écoulée.</span><span class="sxs-lookup"><span data-stu-id="2df8b-227">This is because hourly metrics for the previous hour are not displayed in the Azure portal until the current hour has elapsed.</span></span> <span data-ttu-id="2df8b-228">En outre, les mesures par minute ne sont pas actuellement affichées dans le portail Azure.</span><span class="sxs-lookup"><span data-stu-id="2df8b-228">Also, minute metrics are not currently displayed in the Azure portal.</span></span> <span data-ttu-id="2df8b-229">Donc, selon le moment où vous activez des métriques, l’affichage des données correspondantes peut prendre jusqu’à deux heures.</span><span class="sxs-lookup"><span data-stu-id="2df8b-229">So depending on when you enable metrics, it may take up to two hours to see metrics data.</span></span>
> 
> 

## <a name="use-azcopy-to-copy-server-logs-to-a-local-directory"></a><span data-ttu-id="2df8b-230">Utiliser AzCopy pour copier les journaux de serveur dans un répertoire local</span><span class="sxs-lookup"><span data-stu-id="2df8b-230">Use AzCopy to copy server logs to a local directory</span></span>
<span data-ttu-id="2df8b-231">Azure Storage écrit les données des journaux de serveur dans des objets blob, tandis que les métriques sont écrites dans des tables.</span><span class="sxs-lookup"><span data-stu-id="2df8b-231">Azure Storage writes server log data to blobs, while metrics are written to tables.</span></span> <span data-ttu-id="2df8b-232">Les objets blob de journal sont disponibles dans le fameux conteneur `$logs` de votre compte de stockage.</span><span class="sxs-lookup"><span data-stu-id="2df8b-232">Log blobs are available in the well-known `$logs` container for your storage account.</span></span> <span data-ttu-id="2df8b-233">Les objets blob de journal sont nommés hiérarchiquement par année, mois, jour et heure, afin que vous puissiez localiser facilement la plage de temps que vous souhaitez examiner.</span><span class="sxs-lookup"><span data-stu-id="2df8b-233">Log blobs are named hierarchically by year, month, day, and hour, so that you can easily locate the range of time you wish to investigate.</span></span> <span data-ttu-id="2df8b-234">Par exemple, dans le compte `storagesample`, le conteneur des objets blob de journal pour le 01/02/2015, de 8-9 h, est `https://storagesample.blob.core.windows.net/$logs/blob/2015/01/08/0800`.</span><span class="sxs-lookup"><span data-stu-id="2df8b-234">For example, in the `storagesample` account, the container for the log blobs for 01/02/2015, from 8-9 am, is `https://storagesample.blob.core.windows.net/$logs/blob/2015/01/08/0800`.</span></span> <span data-ttu-id="2df8b-235">Les objets blob individuels dans ce conteneur sont nommés de manière séquentielle, à partir de `000000.log`.</span><span class="sxs-lookup"><span data-stu-id="2df8b-235">The individual blobs in this container are named sequentially, beginning with `000000.log`.</span></span>

<span data-ttu-id="2df8b-236">Vous pouvez utiliser l'outil en ligne de commande AzCopy pour télécharger ces fichiers journaux côté serveur à l'emplacement de votre choix sur votre ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="2df8b-236">You can use the AzCopy command-line tool to download these server-side log files to a location of your choice on your local machine.</span></span> <span data-ttu-id="2df8b-237">Par exemple, vous pouvez utiliser la commande suivante pour télécharger les fichiers journaux pour les opérations sur des objets blob qui ont eu lieu le 2 janvier 2015 dans le dossier `C:\Temp\Logs\Server`. Remplacez `<storageaccountname>` par le nom de votre compte de stockage et `<storageaccountkey>` par la clé d'accès de votre compte :</span><span class="sxs-lookup"><span data-stu-id="2df8b-237">For example, you can use the following command to download the log files for blob operations that took place on January 2, 2015 to the folder `C:\Temp\Logs\Server`; replace `<storageaccountname>` with the name of your storage account, and `<storageaccountkey>` with your account access key:</span></span>

```azcopy
AzCopy.exe /Source:http://<storageaccountname>.blob.core.windows.net/$logs /Dest:C:\Temp\Logs\Server /Pattern:"blob/2015/01/02" /SourceKey:<storageaccountkey> /S /V
```
<span data-ttu-id="2df8b-238">AzCopy est disponible en téléchargement sur la page [Téléchargements Azure](https://azure.microsoft.com/downloads/) .</span><span class="sxs-lookup"><span data-stu-id="2df8b-238">AzCopy is available for download on the [Azure Downloads](https://azure.microsoft.com/downloads/) page.</span></span> <span data-ttu-id="2df8b-239">Pour plus d’informations sur l’utilisation d’AzCopy, consultez [Transfert de données avec l’utilitaire de ligne de commande AzCopy](storage-use-azcopy.md).</span><span class="sxs-lookup"><span data-stu-id="2df8b-239">For details about using AzCopy, see [Transfer data with the AzCopy Command-Line Utility](storage-use-azcopy.md).</span></span>

<span data-ttu-id="2df8b-240">Pour plus d’informations sur le téléchargement des journaux côté serveur, consultez [Télécharger les données de journal de la journalisation du stockage](http://msdn.microsoft.com/library/azure/dn782840.aspx#DownloadingStorageLogginglogdata).</span><span class="sxs-lookup"><span data-stu-id="2df8b-240">For additional information about downloading server-side logs, see [Download Storage Logging log data](http://msdn.microsoft.com/library/azure/dn782840.aspx#DownloadingStorageLogginglogdata).</span></span>

## <a name="use-microsoft-message-analyzer-to-analyze-log-data"></a><span data-ttu-id="2df8b-241">Utilisation de Microsoft Message Analyzer pour analyser les données de journal</span><span class="sxs-lookup"><span data-stu-id="2df8b-241">Use Microsoft Message Analyzer to analyze log data</span></span>
<span data-ttu-id="2df8b-242">Microsoft Message Analyzer est un outil de capture, d'affichage et d'analyse du trafic de messagerie de protocole, des événements et des autres messages du système ou des applications dans les scénarios de résolution des problèmes et de diagnostic.</span><span class="sxs-lookup"><span data-stu-id="2df8b-242">Microsoft Message Analyzer is a tool for capturing, displaying, and analyzing protocol messaging traffic, events, and other system or application messages in troubleshooting and diagnostic scenarios.</span></span> <span data-ttu-id="2df8b-243">Message Analyzer vous permet également de charger, d'agréger et d'analyser les données de journal et les fichiers de suivi enregistrés.</span><span class="sxs-lookup"><span data-stu-id="2df8b-243">Message Analyzer also enables you to load, aggregate, and analyze data from log and saved trace files.</span></span> <span data-ttu-id="2df8b-244">Pour plus d'informations sur Message Analyzer, consultez la page [Guide d'exploitation de Microsoft Message Analyzer](http://technet.microsoft.com/library/jj649776.aspx).</span><span class="sxs-lookup"><span data-stu-id="2df8b-244">For more information about Message Analyzer, see [Microsoft Message Analyzer Operating Guide](http://technet.microsoft.com/library/jj649776.aspx).</span></span>

<span data-ttu-id="2df8b-245">Message Analyzer inclut des ressources pour Azure Storage qui vous aident à analyser les journaux du serveur, du client et du réseau.</span><span class="sxs-lookup"><span data-stu-id="2df8b-245">Message Analyzer includes assets for Azure Storage that help you to analyze server, client, and network logs.</span></span> <span data-ttu-id="2df8b-246">Dans cette section, nous aborderons l'utilisation de ces outils pour résoudre le problème de faible pourcentage de réussite dans les journaux de stockage.</span><span class="sxs-lookup"><span data-stu-id="2df8b-246">In this section, we'll discuss how to use those tools to address the issue of low percent success in the storage logs.</span></span>

### <a name="download-and-install-message-analyzer-and-the-azure-storage-assets"></a><span data-ttu-id="2df8b-247">Téléchargement et installation de Message Analyzer et des ressources Azure Storage</span><span class="sxs-lookup"><span data-stu-id="2df8b-247">Download and install Message Analyzer and the Azure Storage Assets</span></span>
1. <span data-ttu-id="2df8b-248">Téléchargez [Message Analyzer](http://www.microsoft.com/download/details.aspx?id=44226) depuis le Centre de téléchargement de Microsoft et exécutez le programme d'installation.</span><span class="sxs-lookup"><span data-stu-id="2df8b-248">Download [Message Analyzer](http://www.microsoft.com/download/details.aspx?id=44226) from the Microsoft Download Center, and run the installer.</span></span>
2. <span data-ttu-id="2df8b-249">Lancez Message Analyzer.</span><span class="sxs-lookup"><span data-stu-id="2df8b-249">Launch Message Analyzer.</span></span>
3. <span data-ttu-id="2df8b-250">Dans le menu **Tools (Outils)**, sélectionnez **Asset Manager (Gestionnaire de biens)**.</span><span class="sxs-lookup"><span data-stu-id="2df8b-250">From the **Tools** menu, select **Asset Manager**.</span></span> <span data-ttu-id="2df8b-251">Dans la boîte de dialogue **Asset Manager (Gestionnaire de biens)**, sélectionnez **Downloads (Téléchargements)**, puis filtrez sur **Azure Storage**.</span><span class="sxs-lookup"><span data-stu-id="2df8b-251">In the **Asset Manager** dialog, select **Downloads**, then filter on **Azure Storage**.</span></span> <span data-ttu-id="2df8b-252">Vous verrez les ressources Azure Storage, comme illustré ci-après.</span><span class="sxs-lookup"><span data-stu-id="2df8b-252">You will see the Azure Storage Assets, as shown in the picture below.</span></span>
4. <span data-ttu-id="2df8b-253">Cliquez sur **Synchroniser tous les éléments affichés** pour installer les ressources Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="2df8b-253">Click **Sync All Displayed Items** to install the Azure Storage Assets.</span></span> <span data-ttu-id="2df8b-254">Les ressources disponibles sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="2df8b-254">The available assets include:</span></span>
   * <span data-ttu-id="2df8b-255">**Règles de couleur Azure Storage :** celles-ci permettent de définir des filtres spéciaux qui utilisent des styles de texte, de couleur et de police pour mettre en surbrillance les messages contenant des informations spécifiques dans une trace.</span><span class="sxs-lookup"><span data-stu-id="2df8b-255">**Azure Storage Color Rules:** Azure Storage color rules enable you to define special filters that use color, text, and font styles to highlight messages that contain specific information in a trace.</span></span>
   * <span data-ttu-id="2df8b-256">**Graphiques Azure Storage :** il s’agit de représentations graphiques prédéfinies des données du journal du serveur.</span><span class="sxs-lookup"><span data-stu-id="2df8b-256">**Azure Storage Charts:** Azure Storage charts are predefined charts that graph server log data.</span></span> <span data-ttu-id="2df8b-257">Notez que pour utiliser des graphiques Azure Storage à ce stade, vous pouvez uniquement charger le journal du serveur dans la grille d'analyse.</span><span class="sxs-lookup"><span data-stu-id="2df8b-257">Note that to use Azure Storage charts at this time, you may only load the server log into the Analysis Grid.</span></span>
   * <span data-ttu-id="2df8b-258">**Analyseurs Azure Storage :** ceux-ci analysent les journaux du client, du serveur et HTTP d'Azure Storage pour les afficher dans la grille d'analyse.</span><span class="sxs-lookup"><span data-stu-id="2df8b-258">**Azure Storage Parsers:** The Azure Storage parsers parse the Azure Storage client, server, and HTTP logs in order to display them in the Analysis Grid.</span></span>
   * <span data-ttu-id="2df8b-259">**Filtres d’Azure Storage :** il s’agit de critères prédéfinis que vous pouvez utiliser pour interroger vos données dans la grille d’analyse.</span><span class="sxs-lookup"><span data-stu-id="2df8b-259">**Azure Storage Filters:** Azure Storage filters are predefined criteria that you can use to query your data in the Analysis Grid.</span></span>
   * <span data-ttu-id="2df8b-260">**Dispositions de vue Azure Storage :** il s'agit des dispositions de colonnes et des regroupements prédéfinis dans la grille d'analyse.</span><span class="sxs-lookup"><span data-stu-id="2df8b-260">**Azure Storage View Layouts:** Azure Storage view layouts are predefined column layouts and groupings in the Analysis Grid.</span></span>
5. <span data-ttu-id="2df8b-261">Redémarrez Message Analyzer après avoir installé les éléments multimédias.</span><span class="sxs-lookup"><span data-stu-id="2df8b-261">Restart Message Analyzer after you've installed the assets.</span></span>

![Gestionnaire de biens de l’analyseur de message](./media/storage-e2e-troubleshooting/mma-start-page-1.png)

> [!NOTE]
> <span data-ttu-id="2df8b-263">Installez toutes les ressources Azure Storage indiquées dans le cadre de ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="2df8b-263">Install all of the Azure Storage assets shown for the purposes of this tutorial.</span></span>
> 
> 

### <a name="import-your-log-files-into-message-analyzer"></a><span data-ttu-id="2df8b-264">Importation de vos fichiers journaux dans Message Analyzer</span><span class="sxs-lookup"><span data-stu-id="2df8b-264">Import your log files into Message Analyzer</span></span>
<span data-ttu-id="2df8b-265">Vous pouvez importer tous vos fichiers journaux enregistrés (côté serveur, côté client et réseau) dans une session de Microsoft Message Analyzer pour l'analyse.</span><span class="sxs-lookup"><span data-stu-id="2df8b-265">You can import all of your saved log files (server-side, client-side, and network) into a single session in Microsoft Message Analyzer for analysis.</span></span>

1. <span data-ttu-id="2df8b-266">Dans le menu **File (Fichier)** de Microsoft Message Analyzer, cliquez sur **New Session (Nouvelle session)**, puis sur **Blank Session (Session vide)**.</span><span class="sxs-lookup"><span data-stu-id="2df8b-266">On the **File** menu in Microsoft Message Analyzer, click **New Session**, and then click **Blank Session**.</span></span> <span data-ttu-id="2df8b-267">Dans la boîte de dialogue **Nouvelle session** , entrez un nom pour votre session d'analyse.</span><span class="sxs-lookup"><span data-stu-id="2df8b-267">In the **New Session** dialog, enter a name for your analysis session.</span></span> <span data-ttu-id="2df8b-268">Dans le panneau **Session Details (Détails de la session)**, cliquez sur le bouton **Files (Fichiers)**.</span><span class="sxs-lookup"><span data-stu-id="2df8b-268">In the **Session Details** panel, click on the **Files** button.</span></span>
2. <span data-ttu-id="2df8b-269">Pour charger les données de suivi du réseau générées par Message Analyzer, cliquez sur **Add Files (Ajouter des fichiers)**, accédez à l’emplacement où vous avez enregistré votre fichier .matp à partir de votre session de suivi web, sélectionnez ce fichier, puis cliquez sur **Open (Ouvrir)**.</span><span class="sxs-lookup"><span data-stu-id="2df8b-269">To load the network trace data generated by Message Analyzer, click on **Add Files**, browse to the location where you saved your .matp file from your web tracing session, select the .matp file, and click **Open**.</span></span>
3. <span data-ttu-id="2df8b-270">Pour charger les données du journal côté serveur, cliquez sur **Add Files (Ajouter des fichiers)**, accédez à l’emplacement où vous avez téléchargé vos journaux côté serveur, sélectionnez ceux de la période que vous souhaitez analyser, puis cliquez sur **Open (Ouvrir)**.</span><span class="sxs-lookup"><span data-stu-id="2df8b-270">To load the server-side log data, click on **Add Files**, browse to the location where you downloaded your server-side logs, select the log files for the time range you want to analyze, and click **Open**.</span></span> <span data-ttu-id="2df8b-271">Ensuite, dans le panneau **Session Details (Détails de la session)**, réglez le menu déroulant **Text Log Configuration (Configuration du journal texte)** correspondant à chaque fichier journal côté serveur sur **AzureStorageLog** pour vous assurer que Microsoft Message Analyzer peut analyser le fichier journal correctement.</span><span class="sxs-lookup"><span data-stu-id="2df8b-271">Then, in the **Session Details** panel, set the **Text Log Configuration** drop-down for each server-side log file to **AzureStorageLog** to ensure that Microsoft Message Analyzer can parse the log file correctly.</span></span>
4. <span data-ttu-id="2df8b-272">Pour charger les données du journal côté client, cliquez sur **Add Files (Ajouter des fichiers)**, accédez à l’emplacement où vous avez enregistré vos journaux côté client, sélectionnez ceux que vous souhaitez analyser, puis cliquez sur **Ouvrir**.</span><span class="sxs-lookup"><span data-stu-id="2df8b-272">To load the client-side log data, click on **Add Files**, browse to the location where you saved your client-side logs, select the log files you want to analyze, and click **Open**.</span></span> <span data-ttu-id="2df8b-273">Ensuite, dans le panneau **Session Details (Détails de la session)**, réglez le menu déroulant **Text Log Configuration (Configuration du journal texte)** correspondant à chaque fichier journal côté client sur **AzureStorageClientDotNetV4** pour vous assurer que Microsoft Message Analyzer peut analyser le fichier journal correctement.</span><span class="sxs-lookup"><span data-stu-id="2df8b-273">Then, in the **Session Details** panel, set the **Text Log Configuration** drop-down for each client-side log file to **AzureStorageClientDotNetV4** to ensure that Microsoft Message Analyzer can parse the log file correctly.</span></span>
5. <span data-ttu-id="2df8b-274">Dans la boîte de dialogue **New Session (Nouvelle session)**, cliquez sur **Start (Démarrer)** pour charger et analyser les données du journal.</span><span class="sxs-lookup"><span data-stu-id="2df8b-274">Click **Start** in the **New Session** dialog to load and parse the log data.</span></span> <span data-ttu-id="2df8b-275">Les données du journal s'affichent dans la grille d'analyse de Message Analyzer.</span><span class="sxs-lookup"><span data-stu-id="2df8b-275">The log data displays in the Message Analyzer Analysis Grid.</span></span>

<span data-ttu-id="2df8b-276">L'illustration ci-dessous présente un exemple de session configurée avec les fichiers journaux du serveur, du client et de suivi du réseau.</span><span class="sxs-lookup"><span data-stu-id="2df8b-276">The picture below shows an example session configured with server, client, and network trace log files.</span></span>

![Configuration d’une session de Message Analyzer](./media/storage-e2e-troubleshooting/configure-mma-session-1.png)

<span data-ttu-id="2df8b-278">Notez que Message Analyzer charge les fichiers journaux en mémoire.</span><span class="sxs-lookup"><span data-stu-id="2df8b-278">Note that Message Analyzer loads log files into memory.</span></span> <span data-ttu-id="2df8b-279">Si l'ensemble des données des journaux est volumineux, vous devez le filtrer afin d'obtenir les meilleures performances de Message Analyzer.</span><span class="sxs-lookup"><span data-stu-id="2df8b-279">If you have a large set of log data, you will want to filter it in order to get the best performance from Message Analyzer.</span></span>

<span data-ttu-id="2df8b-280">Tout d'abord, déterminez l'intervalle de temps que vous souhaitez examiner en veillant à ce qu'il soit le plus petit possible.</span><span class="sxs-lookup"><span data-stu-id="2df8b-280">First, determine the time frame that you are interested in reviewing, and keep this time frame as small as possible.</span></span> <span data-ttu-id="2df8b-281">Dans de nombreux cas, vous devez examiner une période de quelques minutes ou quelques heures au maximum.</span><span class="sxs-lookup"><span data-stu-id="2df8b-281">In many cases you will want to review a period of minutes or hours at most.</span></span> <span data-ttu-id="2df8b-282">Importez le plus petit ensemble de journaux qui puisse répondre à vos besoins.</span><span class="sxs-lookup"><span data-stu-id="2df8b-282">Import the smallest set of logs that can meet your needs.</span></span>

<span data-ttu-id="2df8b-283">Si vous avez encore une grande quantité de données de journal, vous pouvez spécifier un filtre de session afin de les filtrer avant de les charger.</span><span class="sxs-lookup"><span data-stu-id="2df8b-283">If you still have a large amount of log data, then you may want to specify a session filter to filter your log data before you load it.</span></span> <span data-ttu-id="2df8b-284">Dans la zone **Session Filter (Filtre de session)**, cliquez sur le bouton **Library (Bibliothèque)** pour choisir un filtre prédéfini. Par exemple, choisissez **Global Time Filter I (Filtre de temps global I)** dans les filtres Azure Storage pour filtrer sur un intervalle de temps.</span><span class="sxs-lookup"><span data-stu-id="2df8b-284">In the **Session Filter** box, select the **Library** button to choose a predefined filter; for example, choose **Global Time Filter I** from the Azure Storage filters to filter on a time interval.</span></span> <span data-ttu-id="2df8b-285">Vous pouvez ensuite modifier les critères de filtre afin de spécifier l'horodatage de début et de fin pour l'intervalle que vous souhaitez afficher.</span><span class="sxs-lookup"><span data-stu-id="2df8b-285">You can then edit the filter criteria to specify the starting and ending timestamp for the interval you want to see.</span></span> <span data-ttu-id="2df8b-286">Vous pouvez également filtrer sur un code d'état spécifique ; par exemple, vous pouvez choisir de charger uniquement les entrées de journal où le code d'état est 404.</span><span class="sxs-lookup"><span data-stu-id="2df8b-286">You can also filter on a particular status code; for example, you can choose to load only log entries where the status code is 404.</span></span>

<span data-ttu-id="2df8b-287">Pour plus d'informations sur l'importation des données de journal dans Microsoft Message Analyzer, consultez la page [Récupération des données des messages](http://technet.microsoft.com/library/dn772437.aspx) sur TechNet.</span><span class="sxs-lookup"><span data-stu-id="2df8b-287">For more information about importing log data into Microsoft Message Analyzer, see [Retrieving Message Data](http://technet.microsoft.com/library/dn772437.aspx) on TechNet.</span></span>

### <a name="use-the-client-request-id-to-correlate-log-file-data"></a><span data-ttu-id="2df8b-288">Utilisation de l'ID de demande client pour mettre en corrélation des données de fichiers journaux</span><span class="sxs-lookup"><span data-stu-id="2df8b-288">Use the client request ID to correlate log file data</span></span>
<span data-ttu-id="2df8b-289">La bibliothèque cliente de stockage Azure génère automatiquement un ID de demande client unique pour chaque demande.</span><span class="sxs-lookup"><span data-stu-id="2df8b-289">The Azure Storage Client Library automatically generates a unique client request ID for every request.</span></span> <span data-ttu-id="2df8b-290">Cette valeur est écrite dans le journal du client, le journal du serveur et le suivi du réseau ; vous pouvez ainsi l'utiliser pour mettre en corrélation des données entre les trois journaux dans Message Analyzer.</span><span class="sxs-lookup"><span data-stu-id="2df8b-290">This value is written to the client log, the server log, and the network trace, so you can use it to correlate data across all three logs within Message Analyzer.</span></span> <span data-ttu-id="2df8b-291">Pour plus d'informations sur l'ID de demande client, consultez la rubrique [ID de la demande client](storage-monitoring-diagnosing-troubleshooting.md#client-request-id) .</span><span class="sxs-lookup"><span data-stu-id="2df8b-291">See [Client request ID](storage-monitoring-diagnosing-troubleshooting.md#client-request-id) for additional information about the client request ID.</span></span>

<span data-ttu-id="2df8b-292">Les sections ci-dessous expliquent comment utiliser des vues avec des dispositions préconfigurées et personnalisées pour mettre en corrélation et regrouper les données en fonction de l'ID de demande client.</span><span class="sxs-lookup"><span data-stu-id="2df8b-292">The sections below describe how to use pre-configured and custom layout views to correlate and group data based on the client request ID.</span></span>

### <a name="select-a-view-layout-to-display-in-the-analysis-grid"></a><span data-ttu-id="2df8b-293">Sélection d'une disposition de vue à afficher dans la grille d'analyse</span><span class="sxs-lookup"><span data-stu-id="2df8b-293">Select a view layout to display in the Analysis Grid</span></span>
<span data-ttu-id="2df8b-294">Les ressources de stockage de Message Analyzer incluent les dispositions de vue Azure Storage, qui sont des vues préconfigurées que vous pouvez utiliser pour afficher vos données avec des regroupements et des colonnes utiles dans différents scénarios.</span><span class="sxs-lookup"><span data-stu-id="2df8b-294">The Storage Assets for Message Analyzer include Azure Storage View Layouts, which are pre-configured views that you can use to display your data with useful groupings and columns for different scenarios.</span></span> <span data-ttu-id="2df8b-295">Vous pouvez également créer des dispositions de vue personnalisées et les enregistrer pour pouvoir les réutiliser.</span><span class="sxs-lookup"><span data-stu-id="2df8b-295">You can also create custom view layouts and save them for reuse.</span></span>

<span data-ttu-id="2df8b-296">L’illustration ci-dessous présente le menu **View Layout (Disposition de vue)**, auquel vous pouvez accéder en sélectionnant **View Layout (Disposition de vue)** dans le ruban de la barre d’outils.</span><span class="sxs-lookup"><span data-stu-id="2df8b-296">The picture below shows the **View Layout** menu, available by selecting **View Layout** from the toolbar ribbon.</span></span> <span data-ttu-id="2df8b-297">Les dispositions de vue Azure Storage sont regroupées sous le nœud **Azure Storage** dans le menu.</span><span class="sxs-lookup"><span data-stu-id="2df8b-297">The view layouts for Azure Storage are grouped under the **Azure Storage** node in the menu.</span></span> <span data-ttu-id="2df8b-298">Vous pouvez rechercher `Azure Storage` dans la zone de recherche pour filtrer les disposition de vue et afficher uniquement celles d’Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="2df8b-298">You can search for `Azure Storage` in the search box to filter on Azure Storage view layouts only.</span></span> <span data-ttu-id="2df8b-299">Vous pouvez également sélectionner l'étoile en regard d'une disposition de vue pour l'ajouter aux Favoris et l'afficher au début du menu.</span><span class="sxs-lookup"><span data-stu-id="2df8b-299">You can also select the star next to a view layout to make it a favorite and display it at the top of the menu.</span></span>

![Menu Disposition de vue](./media/storage-e2e-troubleshooting/view-layout-menu.png)

<span data-ttu-id="2df8b-301">Pour commencer, sélectionnez **Regroupé par ClientRequestID et Module**.</span><span class="sxs-lookup"><span data-stu-id="2df8b-301">To begin with, select **Grouped by ClientRequestID and Module**.</span></span> <span data-ttu-id="2df8b-302">Cette disposition de vue regroupe les données des trois journaux, d'abord par ID de demande client, puis par fichier journal source (ou **Module** dans Message Analyzer).</span><span class="sxs-lookup"><span data-stu-id="2df8b-302">This view layout groups log data from all three logs first by client request ID, then by source log file (or **Module** in Message Analyzer).</span></span> <span data-ttu-id="2df8b-303">Avec cette vue, vous pouvez explorer de manière détaillée un ID de demande client particulier et afficher les données des trois fichiers journaux pour cette ID de demande client.</span><span class="sxs-lookup"><span data-stu-id="2df8b-303">With this view, you can drill down into a particular client request ID, and see data from all three log files for that client request ID.</span></span>

<span data-ttu-id="2df8b-304">L'illustration ci-dessous présente cette disposition de vue appliquée à l'exemple de données de journal, avec l'affichage d'un sous-ensemble de colonnes.</span><span class="sxs-lookup"><span data-stu-id="2df8b-304">The picture below shows this layout view applied to the sample log data, with a subset of columns displayed.</span></span> <span data-ttu-id="2df8b-305">Vous pouvez voir que pour un ID de demande client particulier, la grille d'analyse affiche les données du journal du client, du journal du serveur et du suivi du réseau.</span><span class="sxs-lookup"><span data-stu-id="2df8b-305">You can see that for a particular client request ID, the Analysis Grid displays data from the client log, server log, and network trace.</span></span>

![Disposition de vue Azure Storage](./media/storage-e2e-troubleshooting/view-layout-client-request-id-module.png)

> [!NOTE]
> <span data-ttu-id="2df8b-307">Différents fichiers journaux ont des colonnes différentes ; par conséquent, lorsque les données de plusieurs fichiers journaux sont affichées dans la grille d'analyse, il se peut que certaines colonnes ne contiennent pas toutes les données d'une ligne particulière.</span><span class="sxs-lookup"><span data-stu-id="2df8b-307">Different log files have different columns, so when data from multiple log files is displayed in the Analysis Grid, some columns may not contain any data for a given row.</span></span> <span data-ttu-id="2df8b-308">Par exemple, dans l’illustration ci-dessus, les lignes du journal du client n’affichent pas toutes les données des colonnes **Timestamp**, **TimeElapsed**, **Source** et **Destination**, car ces dernières existent dans le suivi du réseau mais pas dans le journal du client.</span><span class="sxs-lookup"><span data-stu-id="2df8b-308">For example, in the picture above, the client log rows do not show any data for the **Timestamp**, **TimeElapsed**, **Source**, and **Destination** columns, because these columns do not exist in the client log, but do exist in the network trace.</span></span> <span data-ttu-id="2df8b-309">De même, la colonne **Timestamp** affiche les données d’horodatage du journal du serveur, mais aucune donnée n’est affichée pour les colonnes **TimeElapsed**, **Source** et **Destination**, qui ne font pas partie du journal du serveur.</span><span class="sxs-lookup"><span data-stu-id="2df8b-309">Similarly, the **Timestamp** column displays timestamp data from the server log, but no data is displayed for the **TimeElapsed**, **Source**, and **Destination** columns, which are not part of the server log.</span></span>
> 
> 

<span data-ttu-id="2df8b-310">Outre les dispositions de vue Azure Storage, vous pouvez également définir et enregistrer vos propres dispositions.</span><span class="sxs-lookup"><span data-stu-id="2df8b-310">In addition to using the Azure Storage view layouts, you can also define and save your own view layouts.</span></span> <span data-ttu-id="2df8b-311">Vous pouvez également sélectionner d'autres champs souhaités pour le regroupement des données et enregistrer le regroupement dans le cadre de votre disposition personnalisée.</span><span class="sxs-lookup"><span data-stu-id="2df8b-311">You can select other desired fields for grouping data and save the grouping as part of your custom layout as well.</span></span>

### <a name="apply-color-rules-to-the-analysis-grid"></a><span data-ttu-id="2df8b-312">Application de règles de couleur à la grille d'analyse</span><span class="sxs-lookup"><span data-stu-id="2df8b-312">Apply color rules to the Analysis Grid</span></span>
<span data-ttu-id="2df8b-313">Les ressources de stockage incluent également des règles de couleur, qui offrent un moyen visuel d'identifier les différents types d'erreur dans la grille d'analyse.</span><span class="sxs-lookup"><span data-stu-id="2df8b-313">The Storage Assets also include color rules, which offer a visual means to identify different types of errors in the Analysis Grid.</span></span> <span data-ttu-id="2df8b-314">Les règles de couleur prédéfinies s'appliquent aux erreurs HTTP et n'apparaissent par conséquent que pour le suivi du serveur et du réseau.</span><span class="sxs-lookup"><span data-stu-id="2df8b-314">The predefined color rules apply to HTTP errors, so they appear only for the server log and network trace.</span></span>

<span data-ttu-id="2df8b-315">Pour appliquer des règles de couleur, sélectionnez **Règles de couleur** à partir du ruban de la barre d'outils.</span><span class="sxs-lookup"><span data-stu-id="2df8b-315">To apply color rules, select **Color Rules** from the toolbar ribbon.</span></span> <span data-ttu-id="2df8b-316">Les règles de couleur Azure Storage apparaissent dans le menu.</span><span class="sxs-lookup"><span data-stu-id="2df8b-316">You'll see the Azure Storage color rules in the menu.</span></span> <span data-ttu-id="2df8b-317">Pour le didacticiel, sélectionnez **Erreurs du client (StatusCode entre 400 et 499)**, comme illustré dans l'image ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="2df8b-317">For the tutorial, select **Client Errors (StatusCode between 400 and 499)**, as shown in the picture below.</span></span>

![Disposition de vue Azure Storage](./media/storage-e2e-troubleshooting/color-rules-menu.png)

<span data-ttu-id="2df8b-319">Outre les règles de couleur Azure Storage, vous pouvez également définir et enregistrer vos propres règles de couleur.</span><span class="sxs-lookup"><span data-stu-id="2df8b-319">In addition to using the Azure Storage color rules, you can also define and save your own color rules.</span></span>

### <a name="group-and-filter-log-data-to-find-400-range-errors"></a><span data-ttu-id="2df8b-320">Regroupement et filtrage des données de journal pour rechercher les erreurs de la plage 400</span><span class="sxs-lookup"><span data-stu-id="2df8b-320">Group and filter log data to find 400-range errors</span></span>
<span data-ttu-id="2df8b-321">Nous allons ensuite regrouper et filtrer les données de journal pour rechercher toutes les erreurs dans la plage 400.</span><span class="sxs-lookup"><span data-stu-id="2df8b-321">Next, we'll group and filter the log data to find all errors in the 400 range.</span></span>

1. <span data-ttu-id="2df8b-322">Recherchez la colonne **StatusCode** dans la grille d’analyse, cliquez avec le bouton droit sur le titre de la colonne et sélectionnez **Group (Grouper)**.</span><span class="sxs-lookup"><span data-stu-id="2df8b-322">Locate the **StatusCode** column in the Analysis Grid, right-click the column heading, and select **Group**.</span></span>
2. <span data-ttu-id="2df8b-323">Effectuez ensuite un regroupement sur la colonne **ClientRequestId** .</span><span class="sxs-lookup"><span data-stu-id="2df8b-323">Next, group on the **ClientRequestId** column.</span></span> <span data-ttu-id="2df8b-324">Vous pouvez constater que les données dans la grille d'analyse sont désormais organisées par code d'état et par ID de demande client.</span><span class="sxs-lookup"><span data-stu-id="2df8b-324">You'll see that the data in the Analysis Grid is now organized by status code and by client request ID.</span></span>
3. <span data-ttu-id="2df8b-325">Affichez la fenêtre d'outil Filtre d'affichage si elle n'est pas déjà affichée.</span><span class="sxs-lookup"><span data-stu-id="2df8b-325">Display the View Filter tool window if it is not already displayed.</span></span> <span data-ttu-id="2df8b-326">Dans le ruban de la barre d’outils, sélectionnez **Tool Windows (Fenêtres d’outil)**, puis **View Filter (Filtre d’affichage)**.</span><span class="sxs-lookup"><span data-stu-id="2df8b-326">On the toolbar ribbon, select **Tool Windows**, then **View Filter**.</span></span>
4. <span data-ttu-id="2df8b-327">Pour filtrer les données de journal de manière à n’afficher que les erreurs de la plage 400, ajoutez les critères de filtre suivants dans la fenêtre **View Filter (Filtre d’affichage)**, puis cliquez sur **Apply (Appliquer)** :</span><span class="sxs-lookup"><span data-stu-id="2df8b-327">To filter the log data to display only 400-range errors, add the following filter criteria to the **View Filter** window, and click **Apply**:</span></span>

    ```   
    (AzureStorageLog.StatusCode >= 400 && AzureStorageLog.StatusCode <=499) || (HTTP.StatusCode >= 400 && HTTP.StatusCode <= 499)
    ```

<span data-ttu-id="2df8b-328">L'illustration ci-dessous montre les résultats du regroupement et du filtre.</span><span class="sxs-lookup"><span data-stu-id="2df8b-328">The picture below shows the results of this grouping and filter.</span></span> <span data-ttu-id="2df8b-329">Si vous développez le champ **ClientRequestID** sous le regroupement correspondant au code d'état 409, par exemple, une opération qui a provoqué ce code d'état s'affiche.</span><span class="sxs-lookup"><span data-stu-id="2df8b-329">Expanding the **ClientRequestID** field beneath the grouping for status code 409, for example, shows an operation that resulted in that status code.</span></span>

![Disposition de vue Azure Storage](./media/storage-e2e-troubleshooting/400-range-errors1.png)

<span data-ttu-id="2df8b-331">Après avoir appliqué ce filtre, vous verrez que les lignes du journal du client sont exclues, ce dernier n’incluant aucune colonne **StatusCode** .</span><span class="sxs-lookup"><span data-stu-id="2df8b-331">After applying this filter, you'll see that rows from the client log are excluded, as the client log does not include a **StatusCode** column.</span></span> <span data-ttu-id="2df8b-332">Pour commencer, nous allons revoir le serveur et les journaux de suivi du réseau pour rechercher les erreurs de la plage 404, puis revenir au journal du client pour examiner les opérations du client qui ont déclenché ces erreurs.</span><span class="sxs-lookup"><span data-stu-id="2df8b-332">To begin with, we'll review the server and network trace logs to locate 404 errors, and then we'll return to the client log to examine the client operations that led to them.</span></span>

> [!NOTE]
> <span data-ttu-id="2df8b-333">Vous pouvez filtrer sur la colonne **StatusCode** et continuer d'afficher les données des trois journaux, y compris du journal du client, si vous ajoutez au filtre une expression qui inclut des entrées de journal où le code d'état a la valeur null.</span><span class="sxs-lookup"><span data-stu-id="2df8b-333">You can filter on the **StatusCode** column and still display data from all three logs, including the client log, if you add an expression to the filter that includes log entries where the status code is null.</span></span> <span data-ttu-id="2df8b-334">Pour construire cette expression de filtre, utilisez :</span><span class="sxs-lookup"><span data-stu-id="2df8b-334">To construct this filter expression, use:</span></span>
> 
> <code>&#42;StatusCode >= 400 or !&#42;StatusCode</code>
> 
> <span data-ttu-id="2df8b-335">Ce filtre retourne toutes les lignes du journal du client et uniquement les lignes du journal du serveur et du journal HTTP où le code d'état est supérieur à 400.</span><span class="sxs-lookup"><span data-stu-id="2df8b-335">This filter returns all rows from the client log and only rows from the server log and HTTP log where the status code is greater than 400.</span></span> <span data-ttu-id="2df8b-336">Si vous l'appliquez à la disposition de la vue regroupée par ID de demande client et module, vous pouvez rechercher ou faire défiler les entrées de journal pour rechercher celles où les trois journaux sont représentés.</span><span class="sxs-lookup"><span data-stu-id="2df8b-336">If you apply it to the view layout grouped by client request ID and module, you can search or scroll through the log entries to find ones where all three logs are represented.</span></span>   
> 
> 

### <a name="filter-log-data-to-find-404-errors"></a><span data-ttu-id="2df8b-337">Filtrage des données du journal pour rechercher les erreurs 404</span><span class="sxs-lookup"><span data-stu-id="2df8b-337">Filter log data to find 404 errors</span></span>
<span data-ttu-id="2df8b-338">Les ressources de stockage incluent les filtres prédéfinis que vous pouvez utiliser pour limiter les données du journal afin de trouver les erreurs ou les tendances que vous recherchez.</span><span class="sxs-lookup"><span data-stu-id="2df8b-338">The Storage Assets include predefined filters that you can use to narrow log data to find the errors or trends you are looking for.</span></span> <span data-ttu-id="2df8b-339">Ensuite, nous allons appliquer deux filtres prédéfinis : un qui filtre les journaux de suivi du serveur et du réseau pour rechercher les erreurs 404 et l'autre qui filtre les données sur une période spécifiée.</span><span class="sxs-lookup"><span data-stu-id="2df8b-339">Next, we'll apply two predefined filters: one that filters the server and network trace logs for 404 errors, and one that filters the data on a specified time range.</span></span>

1. <span data-ttu-id="2df8b-340">Affichez la fenêtre d'outil Filtre d'affichage si elle n'est pas déjà affichée.</span><span class="sxs-lookup"><span data-stu-id="2df8b-340">Display the View Filter tool window if it is not already displayed.</span></span> <span data-ttu-id="2df8b-341">Dans le ruban de la barre d’outils, sélectionnez **Tool Windows (Fenêtres d’outil)**, puis **View Filter (Filtre d’affichage)**.</span><span class="sxs-lookup"><span data-stu-id="2df8b-341">On the toolbar ribbon, select **Tool Windows**, then **View Filter**.</span></span>
2. <span data-ttu-id="2df8b-342">Dans la fenêtre View Filter (Filtre d’affichage), sélectionnez **Library (Bibliothèque)** et effectuez une recherche sur `Azure Storage` pour trouver les filtres Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="2df8b-342">In the View Filter window, select **Library**, and search on `Azure Storage` to find the Azure Storage filters.</span></span> <span data-ttu-id="2df8b-343">Sélectionnez le filtre pour **Messages 404 (Introuvable) dans tous les journaux**.</span><span class="sxs-lookup"><span data-stu-id="2df8b-343">Select the filter for **404 (Not Found) messages in all logs**.</span></span>
3. <span data-ttu-id="2df8b-344">Affichez de nouveau le menu **Library (Bibliothèque)**, puis localisez et sélectionnez **Global Time Filter (Filtre de temps global)**.</span><span class="sxs-lookup"><span data-stu-id="2df8b-344">Display the **Library** menu again, and locate and select the **Global Time Filter**.</span></span>
4. <span data-ttu-id="2df8b-345">Modifiez l'horodatage indiqué dans le filtre en indiquant la plage que vous souhaitez afficher.</span><span class="sxs-lookup"><span data-stu-id="2df8b-345">Edit the timestamps shown in the filter to the range you wish to view.</span></span> <span data-ttu-id="2df8b-346">Cela vous aidera à limiter la plage de données à analyser.</span><span class="sxs-lookup"><span data-stu-id="2df8b-346">This will help to narrow the range of data to analyze.</span></span>
5. <span data-ttu-id="2df8b-347">Le filtre doit apparaître comme dans l'exemple ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="2df8b-347">Your filter should appear similar to the example below.</span></span> <span data-ttu-id="2df8b-348">Cliquez sur **Appliquer** pour appliquer le filtre à la grille d'analyse.</span><span class="sxs-lookup"><span data-stu-id="2df8b-348">Click **Apply** to apply the filter to the Analysis Grid.</span></span>

    ```   
    ((AzureStorageLog.StatusCode == 404 || HTTP.StatusCode == 404)) And
    (#Timestamp >= 2014-10-20T16:36:38 and #Timestamp <= 2014-10-20T16:36:39)
    ```

    ![Disposition de vue Azure Storage](./media/storage-e2e-troubleshooting/404-filtered-errors1.png)

### <a name="analyze-your-log-data"></a><span data-ttu-id="2df8b-350">Analyse des données du journal</span><span class="sxs-lookup"><span data-stu-id="2df8b-350">Analyze your log data</span></span>
<span data-ttu-id="2df8b-351">Maintenant que vous avez regroupé et filtré vos données, vous pouvez examiner les détails des demandes individuelles qui ont généré des erreurs 404.</span><span class="sxs-lookup"><span data-stu-id="2df8b-351">Now that you have grouped and filtered your data, you can examine the details of individual requests that generated 404 errors.</span></span> <span data-ttu-id="2df8b-352">Dans la disposition de la vue actuelle, les données sont regroupées par ID de demande client, puis par source du journal.</span><span class="sxs-lookup"><span data-stu-id="2df8b-352">In the current view layout, the data is grouped by client request ID, then by log source.</span></span> <span data-ttu-id="2df8b-353">Dans la mesure où le filtrage porte sur les demandes où le champ StatusCode contient 404, nous voyons seulement les données de suivi du serveur et du réseau, pas les données du journal du client.</span><span class="sxs-lookup"><span data-stu-id="2df8b-353">Since we are filtering on requests where the StatusCode field contains 404, we'll see only the server and network trace data, not the client log data.</span></span>

<span data-ttu-id="2df8b-354">L'illustration ci-dessous montre une demande spécifique où une opération Get Blob a généré une erreur 404 parce que l'objet blob n'existait pas.</span><span class="sxs-lookup"><span data-stu-id="2df8b-354">The picture below shows a specific request where a Get Blob operation yielded a 404 because the blob did not exist.</span></span> <span data-ttu-id="2df8b-355">Notez que certaines colonnes ont été supprimées de la vue standard pour afficher les données pertinentes.</span><span class="sxs-lookup"><span data-stu-id="2df8b-355">Note that some columns have been removed from the standard view in order to display the relevant data.</span></span>

![Journaux de suivi du serveur et du réseau filtrés](./media/storage-e2e-troubleshooting/server-filtered-404-error.png)

<span data-ttu-id="2df8b-357">Ensuite, nous allons mettre en corrélation cet ID de demande du client avec les données du journal du client pour voir quelles étaient les actions exécutées par le client lorsque l'erreur est survenue.</span><span class="sxs-lookup"><span data-stu-id="2df8b-357">Next, we'll correlate this client request ID with the client log data to see what actions the client was taking when the error happened.</span></span> <span data-ttu-id="2df8b-358">Vous pouvez afficher une nouvelle vue Grille d'analyse pour cette session afin de consulter les données du journal du client, qui s'ouvre sous un deuxième onglet :</span><span class="sxs-lookup"><span data-stu-id="2df8b-358">You can display a new Analysis Grid view for this session to view the client log data, which opens in a second tab:</span></span>

1. <span data-ttu-id="2df8b-359">Tout d'abord, copiez la valeur du champ **ClientRequestId** dans le Presse-papiers.</span><span class="sxs-lookup"><span data-stu-id="2df8b-359">First, copy the value of the **ClientRequestId** field to the clipboard.</span></span> <span data-ttu-id="2df8b-360">Pour ce faire, sélectionnez une ligne, recherchez le champ **ClientRequestId**, cliquez avec le bouton droit sur la valeur des données et choisissez **Copy 'ClientRequestId' (Copier 'ClientRequestId')**.</span><span class="sxs-lookup"><span data-stu-id="2df8b-360">You can do this by selecting either row, locating the **ClientRequestId** field, right-clicking on the data value, and choosing **Copy 'ClientRequestId'**.</span></span>
2. <span data-ttu-id="2df8b-361">Dans le ruban de la barre d’outils, sélectionnez **New Viewer (Nouvelle visionneuse)** puis **Analysis Grid (Grille d’analyse)** pour ouvrir un nouvel onglet.</span><span class="sxs-lookup"><span data-stu-id="2df8b-361">On the toolbar ribbon, select **New Viewer**, then select **Analysis Grid** to open a new tab.</span></span> <span data-ttu-id="2df8b-362">Sous le nouvel onglet s'affichent toutes les données de vos fichiers journaux, sans regroupement, filtrage ni règles de couleur.</span><span class="sxs-lookup"><span data-stu-id="2df8b-362">The new tab shows all data in your log files, without grouping, filtering, or color rules.</span></span>
3. <span data-ttu-id="2df8b-363">Dans le ruban de la barre d’outils, sélectionnez **View Layout (Disposition de vue)**, puis **All .NET Client Columns (Toutes les colonnes de client .NET)** sous la section **Azure Storage**.</span><span class="sxs-lookup"><span data-stu-id="2df8b-363">On the toolbar ribbon, select **View Layout**, then select **All .NET Client Columns** under the **Azure Storage** section.</span></span> <span data-ttu-id="2df8b-364">Cette disposition de la vue affiche les données à partir du journal du client ainsi que les journaux de suivi du serveur et du réseau.</span><span class="sxs-lookup"><span data-stu-id="2df8b-364">This view layout shows data from the client log as well as the server and network trace logs.</span></span> <span data-ttu-id="2df8b-365">Par défaut, elle est triée en fonction de la colonne **MessageNumber** .</span><span class="sxs-lookup"><span data-stu-id="2df8b-365">By default it is sorted on the **MessageNumber** column.</span></span>
4. <span data-ttu-id="2df8b-366">Ensuite, recherchez le journal du client pour l'ID de demande client.</span><span class="sxs-lookup"><span data-stu-id="2df8b-366">Next, search the client log for the client request ID.</span></span> <span data-ttu-id="2df8b-367">Dans le ruban de la barre d’outils, sélectionnez **Find Messages (Rechercher des messages)**, puis spécifiez un filtre personnalisé sur l’ID de demande client dans le champ **Find (Rechercher)**.</span><span class="sxs-lookup"><span data-stu-id="2df8b-367">On the toolbar ribbon, select **Find Messages**, then specify a custom filter on the client request ID in the **Find** field.</span></span> <span data-ttu-id="2df8b-368">Utilisez cette syntaxe pour le filtre en indiquant votre propre ID de demande client :</span><span class="sxs-lookup"><span data-stu-id="2df8b-368">Use this syntax for the filter, specifying your own client request ID:</span></span>

    ```
    *ClientRequestId == "398bac41-7725-484b-8a69-2a9e48fc669a"
    ```

<span data-ttu-id="2df8b-369">Message Analyzer localise et sélectionne la première entrée de journal dans laquelle les critères de recherche correspondent à l'ID de demande client.</span><span class="sxs-lookup"><span data-stu-id="2df8b-369">Message Analyzer locates and selects the first log entry where the search criteria matches the client request ID.</span></span> <span data-ttu-id="2df8b-370">Dans le journal du client, il existe plusieurs entrées pour chaque ID de demande client ; vous pouvez donc les regrouper sur le champ **ClientRequestId** pour pouvoir les afficher toutes ensemble.</span><span class="sxs-lookup"><span data-stu-id="2df8b-370">In the client log, there are several entries for each client request ID, so you may want to group them on the **ClientRequestId** field to make it easier to see them all together.</span></span> <span data-ttu-id="2df8b-371">L'illustration ci-dessous montre tous les messages du journal du client pour l'ID de demande client spécifié.</span><span class="sxs-lookup"><span data-stu-id="2df8b-371">The picture below shows all of the messages in the client log for the specified client request ID.</span></span>

![Journal client affichant des erreurs 404](./media/storage-e2e-troubleshooting/client-log-analysis-grid1.png)

<span data-ttu-id="2df8b-373">À l'aide des données affichées dans les dispositions de vue sous ces deux onglets, vous pouvez analyser les données de la demande pour déterminer ce qui peut avoir provoqué l'erreur.</span><span class="sxs-lookup"><span data-stu-id="2df8b-373">Using the data shown in the view layouts in these two tabs, you can analyze the request data to determine what may have caused the error.</span></span> <span data-ttu-id="2df8b-374">Vous pouvez également consulter les demandes qui ont précédé celle-ci pour voir si un événement antérieur a pu conduire à l'erreur 404.</span><span class="sxs-lookup"><span data-stu-id="2df8b-374">You can also look at requests that preceded this one to see if a previous event may have led to the 404 error.</span></span> <span data-ttu-id="2df8b-375">Par exemple, vous pouvez consulter les entrées du journal du client précédant cet ID de demande client pour déterminer si l'objet blob a été supprimé, ou si l'erreur est due à l'appel par l'application cliente d'une API CreateIfNotExists sur un conteneur ou un objet blob.</span><span class="sxs-lookup"><span data-stu-id="2df8b-375">For example, you can review the client log entries preceding this client request ID to determine whether the blob may have been deleted, or if the error was due to the client application calling a CreateIfNotExists API on a container or blob.</span></span> <span data-ttu-id="2df8b-376">Dans le journal du client, vous pouvez trouver l’adresse de l’objet blob dans le champ **Description (Description)**. Dans les journaux de suivi du serveur et du réseau, cette information s’affiche dans le champ **Summary (Résumé)**.</span><span class="sxs-lookup"><span data-stu-id="2df8b-376">In the client log, you can find the blob's address in the **Description** field; in the server and network trace logs, this information appears in the **Summary** field.</span></span>

<span data-ttu-id="2df8b-377">Une fois que vous connaissez l'adresse de l'objet blob qui a généré l'erreur 404, vous pouvez effectuer un examen plus approfondi.</span><span class="sxs-lookup"><span data-stu-id="2df8b-377">Once you know the address of the blob that yielded the 404 error, you can investigate further.</span></span> <span data-ttu-id="2df8b-378">Si vous recherchez les entrées du journal pour les autres messages associés à des opérations sur le même objet blob, vous pouvez vérifier si le client a précédemment supprimé l'entité.</span><span class="sxs-lookup"><span data-stu-id="2df8b-378">If you search the log entries for other messages associated with operations on the same blob, you can check whether the client previously deleted the entity.</span></span>

## <a name="analyze-other-types-of-storage-errors"></a><span data-ttu-id="2df8b-379">Analyse des autres types d'erreur de stockage</span><span class="sxs-lookup"><span data-stu-id="2df8b-379">Analyze other types of storage errors</span></span>
<span data-ttu-id="2df8b-380">Maintenant que vous êtes familiarisé avec Message Analyzer pour analyser vos données de journal, vous pouvez analyser d'autres types d'erreur avec les dispositions de vue, les règles de couleur , la recherche et le filtrage.</span><span class="sxs-lookup"><span data-stu-id="2df8b-380">Now that you are familiar with using Message Analyzer to analyze your log data, you can analyze other types of errors using view layouts, color rules, and searching/filtering.</span></span> <span data-ttu-id="2df8b-381">Les tableaux ci-dessous répertorient certains problèmes que vous pouvez rencontrer et les critères de filtre que vous pouvez utiliser pour les localiser.</span><span class="sxs-lookup"><span data-stu-id="2df8b-381">The tables below lists some issues you may encounter and the filter criteria you can use to locate them.</span></span> <span data-ttu-id="2df8b-382">Pour plus d'informations sur la construction des filtres et le langage de filtrage de Message Analyzer, consultez la page [Filtrage des données de message](http://technet.microsoft.com/library/jj819365.aspx).</span><span class="sxs-lookup"><span data-stu-id="2df8b-382">For more information on constructing filters and the Message Analyzer filtering language, see [Filtering Message Data](http://technet.microsoft.com/library/jj819365.aspx).</span></span>

| <span data-ttu-id="2df8b-383">Pour examiner...</span><span class="sxs-lookup"><span data-stu-id="2df8b-383">To Investigate…</span></span> | <span data-ttu-id="2df8b-384">Utiliser l'expression de filtre...</span><span class="sxs-lookup"><span data-stu-id="2df8b-384">Use Filter Expression…</span></span> | <span data-ttu-id="2df8b-385">L’expression s’applique au journal (client, serveur, réseau, tout)</span><span class="sxs-lookup"><span data-stu-id="2df8b-385">Expression Applies to Log (Client, Server,   Network, All)</span></span> |
| --- | --- | --- |
| <span data-ttu-id="2df8b-386">Retards inattendus de la remise des messages dans une file d'attente</span><span class="sxs-lookup"><span data-stu-id="2df8b-386">Unexpected delays in message delivery on a queue</span></span> |<span data-ttu-id="2df8b-387">AzureStorageClientDotNetV4.Description contient "Retrying failed operation."</span><span class="sxs-lookup"><span data-stu-id="2df8b-387">AzureStorageClientDotNetV4.Description   contains "Retrying failed operation."</span></span> |<span data-ttu-id="2df8b-388">Client</span><span class="sxs-lookup"><span data-stu-id="2df8b-388">Client</span></span> |
| <span data-ttu-id="2df8b-389">HTTP, augmentation de la valeur PercentThrottlingError</span><span class="sxs-lookup"><span data-stu-id="2df8b-389">HTTP Increase in PercentThrottlingError</span></span> |<span data-ttu-id="2df8b-390">HTTP.Response.StatusCode   == 500 &#124;&#124; HTTP.Response.StatusCode == 503</span><span class="sxs-lookup"><span data-stu-id="2df8b-390">HTTP.Response.StatusCode   == 500 &#124;&#124; HTTP.Response.StatusCode == 503</span></span> |<span data-ttu-id="2df8b-391">Réseau</span><span class="sxs-lookup"><span data-stu-id="2df8b-391">Network</span></span> |
| <span data-ttu-id="2df8b-392">Augmentation de la valeur PercentTimeoutError</span><span class="sxs-lookup"><span data-stu-id="2df8b-392">Increase in PercentTimeoutError</span></span> |<span data-ttu-id="2df8b-393">HTTP.Response.StatusCode   == 500</span><span class="sxs-lookup"><span data-stu-id="2df8b-393">HTTP.Response.StatusCode   == 500</span></span> |<span data-ttu-id="2df8b-394">Réseau</span><span class="sxs-lookup"><span data-stu-id="2df8b-394">Network</span></span> |
| <span data-ttu-id="2df8b-395">Augmentation de la valeur PercentTimeoutError (tous)</span><span class="sxs-lookup"><span data-stu-id="2df8b-395">Increase in PercentTimeoutError (all)</span></span> |<span data-ttu-id="2df8b-396">*StatusCode   == 500</span><span class="sxs-lookup"><span data-stu-id="2df8b-396">*StatusCode   == 500</span></span> |<span data-ttu-id="2df8b-397">Tout</span><span class="sxs-lookup"><span data-stu-id="2df8b-397">All</span></span> |
| <span data-ttu-id="2df8b-398">Augmentation de la valeur PercentNetworkError</span><span class="sxs-lookup"><span data-stu-id="2df8b-398">Increase in PercentNetworkError</span></span> |<span data-ttu-id="2df8b-399">AzureStorageClientDotNetV4.EventLogEntry.Level   < 2</span><span class="sxs-lookup"><span data-stu-id="2df8b-399">AzureStorageClientDotNetV4.EventLogEntry.Level   < 2</span></span> |<span data-ttu-id="2df8b-400">Client</span><span class="sxs-lookup"><span data-stu-id="2df8b-400">Client</span></span> |
| <span data-ttu-id="2df8b-401">Messages HTTP 403 (refusé)</span><span class="sxs-lookup"><span data-stu-id="2df8b-401">HTTP 403 (Forbidden) messages</span></span> |<span data-ttu-id="2df8b-402">HTTP.Response.StatusCode   == 403</span><span class="sxs-lookup"><span data-stu-id="2df8b-402">HTTP.Response.StatusCode   == 403</span></span> |<span data-ttu-id="2df8b-403">Réseau</span><span class="sxs-lookup"><span data-stu-id="2df8b-403">Network</span></span> |
| <span data-ttu-id="2df8b-404">Messages HTTP 404 (non trouvé)</span><span class="sxs-lookup"><span data-stu-id="2df8b-404">HTTP 404 (Not found) messages</span></span> |<span data-ttu-id="2df8b-405">HTTP.Response.StatusCode   == 404</span><span class="sxs-lookup"><span data-stu-id="2df8b-405">HTTP.Response.StatusCode   == 404</span></span> |<span data-ttu-id="2df8b-406">Réseau</span><span class="sxs-lookup"><span data-stu-id="2df8b-406">Network</span></span> |
| <span data-ttu-id="2df8b-407">404 (tous)</span><span class="sxs-lookup"><span data-stu-id="2df8b-407">404 (all)</span></span> |<span data-ttu-id="2df8b-408">*StatusCode   == 404</span><span class="sxs-lookup"><span data-stu-id="2df8b-408">*StatusCode   == 404</span></span> |<span data-ttu-id="2df8b-409">Tout</span><span class="sxs-lookup"><span data-stu-id="2df8b-409">All</span></span> |
| <span data-ttu-id="2df8b-410">Problème d'autorisation de la signature d'accès partagé (SAS)</span><span class="sxs-lookup"><span data-stu-id="2df8b-410">Shared Access Signature (SAS) authorization issue</span></span> |<span data-ttu-id="2df8b-411">AzureStorageLog.RequestStatus ==  "SASAuthorizationError"</span><span class="sxs-lookup"><span data-stu-id="2df8b-411">AzureStorageLog.RequestStatus ==  "SASAuthorizationError"</span></span> |<span data-ttu-id="2df8b-412">Réseau</span><span class="sxs-lookup"><span data-stu-id="2df8b-412">Network</span></span> |
| <span data-ttu-id="2df8b-413">Messages HTTP 409 (conflit)</span><span class="sxs-lookup"><span data-stu-id="2df8b-413">HTTP 409 (Conflict) messages</span></span> |<span data-ttu-id="2df8b-414">HTTP.Response.StatusCode   == 409</span><span class="sxs-lookup"><span data-stu-id="2df8b-414">HTTP.Response.StatusCode   == 409</span></span> |<span data-ttu-id="2df8b-415">Réseau</span><span class="sxs-lookup"><span data-stu-id="2df8b-415">Network</span></span> |
| <span data-ttu-id="2df8b-416">409 (tous)</span><span class="sxs-lookup"><span data-stu-id="2df8b-416">409 (all)</span></span> |<span data-ttu-id="2df8b-417">*StatusCode   == 409</span><span class="sxs-lookup"><span data-stu-id="2df8b-417">*StatusCode   == 409</span></span> |<span data-ttu-id="2df8b-418">Tout</span><span class="sxs-lookup"><span data-stu-id="2df8b-418">All</span></span> |
| <span data-ttu-id="2df8b-419">Les entrées à faible valeur PercentSuccess ou du journal   d’analyse incluent des opérations avec un statut de transaction ClientOtherErrors</span><span class="sxs-lookup"><span data-stu-id="2df8b-419">Low PercentSuccess or analytics log entries have   operations with transaction status of ClientOtherErrors</span></span> |<span data-ttu-id="2df8b-420">AzureStorageLog.RequestStatus ==   "ClientOtherError"</span><span class="sxs-lookup"><span data-stu-id="2df8b-420">AzureStorageLog.RequestStatus ==   "ClientOtherError"</span></span> |<span data-ttu-id="2df8b-421">Serveur</span><span class="sxs-lookup"><span data-stu-id="2df8b-421">Server</span></span> |
| <span data-ttu-id="2df8b-422">Avertissement   de Nagle</span><span class="sxs-lookup"><span data-stu-id="2df8b-422">Nagle   Warning</span></span> |<span data-ttu-id="2df8b-423">((AzureStorageLog.EndToEndLatencyMS   - AzureStorageLog.ServerLatencyMS) > (AzureStorageLog.ServerLatencyMS *   1.5)) et (AzureStorageLog.RequestPacketSize <1460) et (AzureStorageLog.EndToEndLatencyMS -   AzureStorageLog.ServerLatencyMS >= 200)</span><span class="sxs-lookup"><span data-stu-id="2df8b-423">((AzureStorageLog.EndToEndLatencyMS   - AzureStorageLog.ServerLatencyMS) > (AzureStorageLog.ServerLatencyMS *   1.5)) and (AzureStorageLog.RequestPacketSize <1460) and (AzureStorageLog.EndToEndLatencyMS -   AzureStorageLog.ServerLatencyMS >= 200)</span></span> |<span data-ttu-id="2df8b-424">Serveur</span><span class="sxs-lookup"><span data-stu-id="2df8b-424">Server</span></span> |
| <span data-ttu-id="2df8b-425">Plage horaire   dans les journaux serveur et réseau</span><span class="sxs-lookup"><span data-stu-id="2df8b-425">Range of   time in Server and Network logs</span></span> |<span data-ttu-id="2df8b-426">#Timestamp   >= 2014-10-20T16:36:38 and #Timestamp <= 2014-10-20T16:36:39</span><span class="sxs-lookup"><span data-stu-id="2df8b-426">#Timestamp   >= 2014-10-20T16:36:38 and #Timestamp <= 2014-10-20T16:36:39</span></span> |<span data-ttu-id="2df8b-427">Serveur, réseau</span><span class="sxs-lookup"><span data-stu-id="2df8b-427">Server, Network</span></span> |
| <span data-ttu-id="2df8b-428">Plage horaire   dans les journaux serveur</span><span class="sxs-lookup"><span data-stu-id="2df8b-428">Range of   time in Server logs</span></span> |<span data-ttu-id="2df8b-429">AzureStorageLog.Timestamp >= 2014-10-20T16:36:38 et AzureStorageLog.Timestamp <= 2014-10-20T16:36:39</span><span class="sxs-lookup"><span data-stu-id="2df8b-429">AzureStorageLog.Timestamp   >= 2014-10-20T16:36:38 and AzureStorageLog.Timestamp <=   2014-10-20T16:36:39</span></span> |<span data-ttu-id="2df8b-430">Serveur</span><span class="sxs-lookup"><span data-stu-id="2df8b-430">Server</span></span> |

## <a name="next-steps"></a><span data-ttu-id="2df8b-431">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="2df8b-431">Next steps</span></span>
<span data-ttu-id="2df8b-432">Pour plus d'informations sur les scénarios de résolution des problèmes de bout en bout dans Azure Storage, consultez les ressources suivantes :</span><span class="sxs-lookup"><span data-stu-id="2df8b-432">For more information about troubleshooting end-to-end scenarios in Azure Storage, see these resources:</span></span>

* [<span data-ttu-id="2df8b-433">Analyser, diagnostiquer et dépanner Microsoft Azure Storage</span><span class="sxs-lookup"><span data-stu-id="2df8b-433">Monitor, diagnose, and troubleshoot Microsoft Azure Storage</span></span>](storage-monitoring-diagnosing-troubleshooting.md)
* [<span data-ttu-id="2df8b-434">Analyse du stockage</span><span class="sxs-lookup"><span data-stu-id="2df8b-434">Storage Analytics</span></span>](http://msdn.microsoft.com/library/azure/hh343270.aspx)
* [<span data-ttu-id="2df8b-435">Surveiller un compte de stockage dans le portail Azure</span><span class="sxs-lookup"><span data-stu-id="2df8b-435">Monitor a storage account in the Azure portal</span></span>](storage-monitor-storage-account.md)
* [<span data-ttu-id="2df8b-436">Transfert de données avec l'utilitaire de ligne de commande AzCopy</span><span class="sxs-lookup"><span data-stu-id="2df8b-436">Transfer data with the AzCopy Command-Line Utility</span></span>](storage-use-azcopy.md)
* [<span data-ttu-id="2df8b-437">Guide d'exploitation de Microsoft Message Analyzer</span><span class="sxs-lookup"><span data-stu-id="2df8b-437">Microsoft Message Analyzer Operating Guide</span></span>](http://technet.microsoft.com/library/jj649776.aspx)
