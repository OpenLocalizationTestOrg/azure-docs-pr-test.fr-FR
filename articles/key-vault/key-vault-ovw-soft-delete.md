---
ms.assetid: 
title: "Suppression réversible d’Azure Key Vault | Microsoft Docs"
ms.service: key-vault
author: BrucePerlerMS
ms.author: bruceper
manager: mbaldwin
ms.date: 07/10/2017
ms.openlocfilehash: c873b153ef9c7d5f55672a5918c9dc4fb7256701
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/03/2017
---
# <a name="azure-key-vault-soft-delete-overview"></a><span data-ttu-id="55e5a-102">Vue d’ensemble de la suppression réversible d’Azure Key Vault</span><span class="sxs-lookup"><span data-stu-id="55e5a-102">Azure Key Vault soft-delete overview</span></span>

<span data-ttu-id="55e5a-103">La fonctionnalité de suppression réversible de Key Vault permet la récupération des coffres et des objets de coffres supprimés.</span><span class="sxs-lookup"><span data-stu-id="55e5a-103">Key Vault's soft delete feature allows recovery of the deleted vaults and vault objects, known as soft-delete.</span></span> <span data-ttu-id="55e5a-104">Nous aborderons en particulier les scénarios suivants :</span><span class="sxs-lookup"><span data-stu-id="55e5a-104">Specifically, we address the following scenarios:</span></span>

- <span data-ttu-id="55e5a-105">Prise en charge de la suppression récupérable d’un coffre de clés</span><span class="sxs-lookup"><span data-stu-id="55e5a-105">Support for recoverable deletion of a key vault</span></span>
- <span data-ttu-id="55e5a-106">Prise en charge de la suppression récupérable d’objets Key Vault (par exemple,</span><span class="sxs-lookup"><span data-stu-id="55e5a-106">Support for recoverable deletion of key vault objects (ex.</span></span> <span data-ttu-id="55e5a-107">clés, secrets et certificats)</span><span class="sxs-lookup"><span data-stu-id="55e5a-107">keys, secrets, certificates)</span></span>

## <a name="supporting-interfaces"></a><span data-ttu-id="55e5a-108">Prise en charge des interfaces</span><span class="sxs-lookup"><span data-stu-id="55e5a-108">Supporting interfaces</span></span>

<span data-ttu-id="55e5a-109">La fonctionnalité de suppression réversible est pour le moment disponible sur les interfaces .NET/C# et PowerShell.</span><span class="sxs-lookup"><span data-stu-id="55e5a-109">The soft-delete feature is initially available through the REST, .NET/C# and PowerShell interfaces.</span></span> <span data-ttu-id="55e5a-110">Pour plus d’informations, consultez les références correspondantes dans les [Informations de référence sur Key Vault](https://docs.microsoft.com/azure/key-vault/).</span><span class="sxs-lookup"><span data-stu-id="55e5a-110">Refer to the references for these for more details, [Key Vault Reference](https://docs.microsoft.com/azure/key-vault/).</span></span>

## <a name="scenarios"></a><span data-ttu-id="55e5a-111">Scénarios</span><span class="sxs-lookup"><span data-stu-id="55e5a-111">Scenarios</span></span>

<span data-ttu-id="55e5a-112">Les coffres Azure Key Vault désignent des ressources suivies, gérées par Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="55e5a-112">Azure Key Vaults are tracked resources, managed by Azure Resource Manager.</span></span> <span data-ttu-id="55e5a-113">Azure Resource Manager spécifie également un comportement bien défini pour la suppression, qui suppose qu’une opération DELETE correctement exécutée sur une ressource ne permet plus d’accéder à cette ressource.</span><span class="sxs-lookup"><span data-stu-id="55e5a-113">Azure Resource Manager also specifies a well-defined behavior for deletion, which requires that a successful DELETE operation must result in that resource not being accessible anymore.</span></span> <span data-ttu-id="55e5a-114">La fonctionnalité de suppression réversible permet la récupération de l’objet supprimé en cas de suppression accidentelle ou intentionnelle.</span><span class="sxs-lookup"><span data-stu-id="55e5a-114">The soft-delete feature addresses the recovery of the deleted object, whether the deletion was accidental or intentional.</span></span>

1. <span data-ttu-id="55e5a-115">Dans un scénario type, un utilisateur peut avoir supprimé par mégarde un coffre Key Vault ou un objet Key Vault ; si la restauration du coffre ou de l’objet en question a été programmée pendant une période prédéterminée, l’utilisateur peut annuler la suppression et récupérer ses données.</span><span class="sxs-lookup"><span data-stu-id="55e5a-115">In the typical scenario, a user may have inadvertently deleted a key vault or a key vault object; if that key vault or key vault object were to be recoverable for a predetermined period, the user may undo the deletion and recover their data.</span></span>

2. <span data-ttu-id="55e5a-116">Dans un autre scénario, un utilisateur non autorisé peut tenter de supprimer un coffre Key Vault ou un objet Key Vault, par exemple une clé se trouvant à l’intérieur d’un coffre, pour provoquer une interruption de service.</span><span class="sxs-lookup"><span data-stu-id="55e5a-116">In a different scenario, a rogue user may attempt to delete a key vault or a key vault object, such as a key inside a vault, to cause a business disruption.</span></span> <span data-ttu-id="55e5a-117">Le fait de séparer la suppression du coffre Key Vault ou de l’objet Key Vault de la suppression effective des données sous-jacentes peut renforcer la sécurité, par exemple en limitant les autorisations de suppression de données à un autre rôle approuvé.</span><span class="sxs-lookup"><span data-stu-id="55e5a-117">Separating the deletion of the key vault or key vault object from the actual deletion of the underlying data can be used as a safety measure by, for instance, restricting permissions on data deletion to a different, trusted role.</span></span> <span data-ttu-id="55e5a-118">Cette approche suppose d’appliquer un quorum à une opération donnée qui pourrait, dans d’autres circonstances, se traduire par une perte de données immédiate.</span><span class="sxs-lookup"><span data-stu-id="55e5a-118">This approach effectively requires quorum for an operation which might otherwise result in an immediate data loss.</span></span>

### <a name="soft-delete-behavior"></a><span data-ttu-id="55e5a-119">Comportement de la suppression réversible</span><span class="sxs-lookup"><span data-stu-id="55e5a-119">Soft-delete behavior</span></span>

<span data-ttu-id="55e5a-120">Avec cette fonctionnalité, l’opération SUPPRIMER effectuée sur un coffre de clés ou un objet de coffre de clés constitue une suppression réversible, qui conserve efficacement les ressources pendant une période de rétention donnée, tout en donnant l’impression que l’objet est supprimé.</span><span class="sxs-lookup"><span data-stu-id="55e5a-120">With this feature, the DELETE operation on a key vault or key vault object is a soft-delete, effectively holding the resources for a given retention period, while giving the appearance that the object is deleted.</span></span> <span data-ttu-id="55e5a-121">Le service fournit en outre un mécanisme de récupération de l’objet supprimé, qui a essentiellement pour effet d’annuler la suppression.</span><span class="sxs-lookup"><span data-stu-id="55e5a-121">The service further provides a mechanism for recovering the deleted object, essentially undoing the deletion.</span></span> 

<span data-ttu-id="55e5a-122">La suppression réversible est un comportement facultatif de Key Vault et **n’est pas activée par défaut** dans cette version.</span><span class="sxs-lookup"><span data-stu-id="55e5a-122">Soft-delete is an optional Key Vault behavior and is **not enabled by default** in this release.</span></span> <span data-ttu-id="55e5a-123">Pour plus d’informations sur l’activation de la suppression réversible pour votre Key Vault, consultez les instructions spécifiques à l’interface de votre choix dans la [Documentation Key Vault](https://docs.microsoft.com/azure/key-vault/).</span><span class="sxs-lookup"><span data-stu-id="55e5a-123">For details on enabling soft-delete for your key vault, see the specific guidance in the reference for the interface of your choice, [Key Vault Reference](https://docs.microsoft.com/azure/key-vault/).</span></span>

### <a name="key-vault-recovery"></a><span data-ttu-id="55e5a-124">Récupération d’un Key Vault</span><span class="sxs-lookup"><span data-stu-id="55e5a-124">Key vault recovery</span></span>

<span data-ttu-id="55e5a-125">En cas de suppression d’un coffre de clés, le service crée une ressource de proxy sous l’abonnement, en y ajoutant suffisamment de métadonnées pour permettre la récupération.</span><span class="sxs-lookup"><span data-stu-id="55e5a-125">Upon deleting a key vault, the service creates a proxy resource under the subscription, adding sufficient metadata for recovery.</span></span> <span data-ttu-id="55e5a-126">La ressource de proxy est un objet stocké, disponible au même emplacement que le Key Vault supprimé.</span><span class="sxs-lookup"><span data-stu-id="55e5a-126">The proxy resource is a stored object, available in the same location as the deleted key vault.</span></span> 

### <a name="key-vault-object-recovery"></a><span data-ttu-id="55e5a-127">Récupération d’objets Key Vault</span><span class="sxs-lookup"><span data-stu-id="55e5a-127">Key vault object recovery</span></span>

<span data-ttu-id="55e5a-128">Lors de la suppression d’un objet Key Vault (une clé, par exemple), le service place l’objet à l’état supprimé, ce qui le rend inaccessible à toutes les opérations de récupération.</span><span class="sxs-lookup"><span data-stu-id="55e5a-128">Upon deleting a key vault object, such as a key, the service will place the object in a deleted state, thus making it inaccessible to any retrieval operations.</span></span> <span data-ttu-id="55e5a-129">Dans cet état, l’objet de coffre de clés peut être seulement listé, restauré ou supprimé de façon forcée ou permanente.</span><span class="sxs-lookup"><span data-stu-id="55e5a-129">While in this state, the key vault object can only be listed, recovered, or forcefully/permanently deleted.</span></span> 

<span data-ttu-id="55e5a-130">Dans le même temps, Key Vault planifiera la suppression des données sous-jacentes correspondant au Key Vault ou à l’objet Key Vault supprimé afin qu’elle soit exécutée après un intervalle de rétention prédéterminé.</span><span class="sxs-lookup"><span data-stu-id="55e5a-130">At the same time, Key Vault will schedule the deletion of the underlying data corresponding to the deleted key vault or key vault object for execution after a predetermined retention interval.</span></span> <span data-ttu-id="55e5a-131">L’enregistrement DNS correspondant au coffre est également conservé pendant la durée de l’intervalle de rétention.</span><span class="sxs-lookup"><span data-stu-id="55e5a-131">The DNS record corresponding to the vault is also retained for the duration of the retention interval.</span></span>

### <a name="soft-delete-retention-period"></a><span data-ttu-id="55e5a-132">Période de rétention de la suppression réversible</span><span class="sxs-lookup"><span data-stu-id="55e5a-132">Soft-delete retention period</span></span>

<span data-ttu-id="55e5a-133">Les ressources ayant fait l’objet d’une suppression réversible sont conservées pendant une durée fixée à 90 jours.</span><span class="sxs-lookup"><span data-stu-id="55e5a-133">Soft deleted resources are retained for a set period of time, 90 days.</span></span> <span data-ttu-id="55e5a-134">Au cours de la période de rétention de la suppression réversible :</span><span class="sxs-lookup"><span data-stu-id="55e5a-134">During the soft-delete retention interval, the following apply:</span></span>

- <span data-ttu-id="55e5a-135">Vous pouvez répertorier tous les coffres Key Vault et les objets Key Vault à l’état de suppression réversible pour votre abonnement, et accéder à des informations concernant leur suppression et leur récupération.</span><span class="sxs-lookup"><span data-stu-id="55e5a-135">You may list all of the key vaults and key vault objects in the soft-delete state for your subscription as well as access deletion and recovery information about them.</span></span>
    - <span data-ttu-id="55e5a-136">Seuls les utilisateurs disposant d’autorisations spéciales peuvent répertorier des coffres supprimés.</span><span class="sxs-lookup"><span data-stu-id="55e5a-136">Only users with special permissions can list deleted vaults.</span></span> <span data-ttu-id="55e5a-137">Nous recommandons à nos utilisateurs de créer un rôle personnalisé avec ces autorisations spéciales pour le traitement des coffres supprimés.</span><span class="sxs-lookup"><span data-stu-id="55e5a-137">We recommend that our users create a custom role with these special permissions for handling deleted vaults.</span></span>
- <span data-ttu-id="55e5a-138">Il est impossible de créer un Key Vault du même nom au même emplacement. En conséquence, un objet Key Vault ne peut pas être créé dans un coffre donné si celui-ci contient un objet portant le même nom et se trouvant à l’état supprimé</span><span class="sxs-lookup"><span data-stu-id="55e5a-138">A key vault with the same name cannot be created in the same location; correspondingly, a key vault object cannot be created in a given vault if that key vault contains an object with the same name and which is in a deleted state</span></span> 
- <span data-ttu-id="55e5a-139">Seul un utilisateur disposant de privilèges spécifiques peut restaurer un coffre Key Vault ou un objet Key Vault en exécutant une commande de récupération sur la ressource de proxy correspondante.</span><span class="sxs-lookup"><span data-stu-id="55e5a-139">Only a specifically privileged user may restore a key vault or key vault object by issuing a recover command on the corresponding proxy resource.</span></span>
    - <span data-ttu-id="55e5a-140">L’utilisateur membre du rôle personnalisé qui est autorisé à créer un coffre sous le groupe de ressources peut restaurer le coffre.</span><span class="sxs-lookup"><span data-stu-id="55e5a-140">The user, member of the custom role, who has the privilege to create a key vault under the resource group can restore the vault.</span></span>
- <span data-ttu-id="55e5a-141">Seul un utilisateur disposant de privilèges spécifiques peut forcer la suppression d’un coffre Key Vault ou d’un objet Key Vault en exécutant une commande de suppression sur la ressource de proxy correspondante.</span><span class="sxs-lookup"><span data-stu-id="55e5a-141">Only a specifically privileged user may forcibly delete a key vault or key vault object by issuing a delete command on the corresponding proxy resource.</span></span>

<span data-ttu-id="55e5a-142">Sauf en cas de restauration d’un coffre de clés ou d’un objet de coffre de clés, à la fin de l’intervalle de rétention, le service vide le coffre de clés ou l’objet de coffre de clés qui a fait l’objet d’une suppression réversible, ainsi que son contenu.</span><span class="sxs-lookup"><span data-stu-id="55e5a-142">Unless a key vault or key vault object is recovered, at the end of the retention interval the service performs a purge of the soft-deleted key vault or key vault object and its content.</span></span> <span data-ttu-id="55e5a-143">La suppression de la ressource ne peut pas être replanifiée.</span><span class="sxs-lookup"><span data-stu-id="55e5a-143">Resource deletion may not be rescheduled.</span></span>

### <a name="permitted-purge"></a><span data-ttu-id="55e5a-144">Vidage autorisé</span><span class="sxs-lookup"><span data-stu-id="55e5a-144">Permitted purge</span></span>

<span data-ttu-id="55e5a-145">Il est possible de supprimer ou vider définitivement un coffre Key Vault en exécutant une commande POST sur la ressource de proxy. Cette opération nécessite des privilèges spéciaux.</span><span class="sxs-lookup"><span data-stu-id="55e5a-145">Permanently deleting, purging, a key vault is possible via a POST operation on the proxy resource and requires special privileges.</span></span> <span data-ttu-id="55e5a-146">En général, seul le propriétaire de l’abonnement peut vider un coffre.</span><span class="sxs-lookup"><span data-stu-id="55e5a-146">Generally, only the subscription owner will be able to purge a key vault.</span></span> <span data-ttu-id="55e5a-147">L’opération POST déclenche la suppression immédiate et irrécupérable de ce coffre,</span><span class="sxs-lookup"><span data-stu-id="55e5a-147">The POST operation triggers the immediate and irrecoverable deletion of that vault.</span></span> 

<span data-ttu-id="55e5a-148">sauf si l’abonnement Azure a été marqué comme *impossible à supprimer*.</span><span class="sxs-lookup"><span data-stu-id="55e5a-148">An exception to this is the case when the Azure subscription has been marked as *undeletable*.</span></span> <span data-ttu-id="55e5a-149">Dans ce cas, seul le service peut alors effectuer la suppression, dans le cadre d’un processus planifié.</span><span class="sxs-lookup"><span data-stu-id="55e5a-149">In this case, only the service may then perform the actual deletion, and does so as a scheduled process.</span></span> 



