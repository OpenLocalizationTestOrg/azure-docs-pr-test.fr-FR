---
title: "Azure AD Connect : lorsque vous avez déjà Azure AD | Microsoft Docs"
description: "Cette rubrique décrit comment utiliser Connect lorsque vous avez un client Azure AD existant."
services: active-directory
documentationcenter: 
author: andkjell
manager: femila
editor: 
ms.assetid: 
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/13/2017
ms.author: billmath
ms.openlocfilehash: 908c576b0427a23934c844362a4fd69443800d0f
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/03/2017
---
# <a name="azure-ad-connect-when-you-have-an-existent-tenant"></a><span data-ttu-id="44475-103">Azure AD Connect : lorsque vous avez un client existant</span><span class="sxs-lookup"><span data-stu-id="44475-103">Azure AD Connect: When you have an existent tenant</span></span>
<span data-ttu-id="44475-104">La plupart des rubriques sur l’utilisation d’Azure AD Connect suppose que vous démarrez avec un nouveau client Azure AD qui ne contient aucun utilisateur ni autres objets.</span><span class="sxs-lookup"><span data-stu-id="44475-104">Most of the topics for how to use Azure AD Connect assumes you start with a new Azure AD tenant and that there are no users or other objects there.</span></span> <span data-ttu-id="44475-105">Mais si vous avez démarré avec un client Azure AD, auquel vous avez ajouté des utilisateurs et d’autres objets, et que vous souhaitez désormais utiliser Connect, alors cette rubrique est faite pour vous.</span><span class="sxs-lookup"><span data-stu-id="44475-105">But if you have started with an Azure AD tenant, populated it with users and other objects, and now want to use Connect, then this topic is for you.</span></span>

## <a name="the-basics"></a><span data-ttu-id="44475-106">Concepts de base</span><span class="sxs-lookup"><span data-stu-id="44475-106">The basics</span></span>
<span data-ttu-id="44475-107">Un objet dans Azure AD est soit contrôlé dans le cloud (Azure AD), soit local.</span><span class="sxs-lookup"><span data-stu-id="44475-107">An object in Azure AD is either mastered in the cloud (Azure AD) or on-premises.</span></span> <span data-ttu-id="44475-108">Pour un objet unique, vous ne pouvez pas gérer certains attributs en local et d’autres attributs dans Azure AD.</span><span class="sxs-lookup"><span data-stu-id="44475-108">For one single object, you cannot manage some attributes on-premises and some other attributes in Azure AD.</span></span> <span data-ttu-id="44475-109">Chaque objet dispose d’un indicateur qui indique où l’objet est géré.</span><span class="sxs-lookup"><span data-stu-id="44475-109">Each object has a flag indicating where the object is managed.</span></span>

<span data-ttu-id="44475-110">Vous pouvez gérer certains utilisateurs en local et d’autres dans le cloud.</span><span class="sxs-lookup"><span data-stu-id="44475-110">You can manage some users on-premises and other in the cloud.</span></span> <span data-ttu-id="44475-111">Un scénario courant pour cette configuration est une organisation qui regroupe des comptables et des commerciaux.</span><span class="sxs-lookup"><span data-stu-id="44475-111">A common scenario for this configuration is an organization with a mix of accounting workers and sales workers.</span></span> <span data-ttu-id="44475-112">Les comptables ont un compte AD local, mais les commerciaux n’en ont pas. Ils disposent d’un compte dans Azure AD.</span><span class="sxs-lookup"><span data-stu-id="44475-112">The accounting workers have an on-premises AD account, but the sales workers do not, they have an account in Azure AD.</span></span> <span data-ttu-id="44475-113">Vous devez alors gérer certains utilisateurs en local et d’autres dans Azure AD.</span><span class="sxs-lookup"><span data-stu-id="44475-113">You would manage some users on-premises and some in Azure AD.</span></span>

<span data-ttu-id="44475-114">Si vous avez commencé à gérer des utilisateurs dans Azure AD qui se trouvent également dans un répertoire AD local et que vous souhaitez ultérieurement utiliser Connect, il existe des considérations supplémentaires que vous devez prendre en compte.</span><span class="sxs-lookup"><span data-stu-id="44475-114">If you started to manage users in Azure AD that are also in on-premises AD and later want to use Connect, then there are some additional concerns you need to consider.</span></span>

## <a name="sync-with-existing-users-in-azure-ad"></a><span data-ttu-id="44475-115">Synchroniser avec les utilisateurs existants dans Azure AD</span><span class="sxs-lookup"><span data-stu-id="44475-115">Sync with existing users in Azure AD</span></span>
<span data-ttu-id="44475-116">Lorsque vous installez Azure AD Connect et démarrez la synchronisation, le service de synchronisation Azure AD (dans Azure AD) effectue une vérification de chaque nouvel objet et essaie de trouver un objet existant correspondant.</span><span class="sxs-lookup"><span data-stu-id="44475-116">When you install Azure AD Connect and you start synchronizing, the Azure AD sync service (in Azure AD) does a check on every new object and try to find an existing object to match.</span></span> <span data-ttu-id="44475-117">Il existe trois attributs utilisés pour ce processus : **userPrincipalName**, **proxyAddresses** et **sourceAnchor**/**immutableID**.</span><span class="sxs-lookup"><span data-stu-id="44475-117">There are three attributes used for this process: **userPrincipalName**, **proxyAddresses**, and **sourceAnchor**/**immutableID**.</span></span> <span data-ttu-id="44475-118">Une correspondance avec **userPrincipalName** et avec **proxyAddresses** est appelée une **correspondance souple**.</span><span class="sxs-lookup"><span data-stu-id="44475-118">A match on **userPrincipalName** and **proxyAddresses** is known as a **soft match**.</span></span> <span data-ttu-id="44475-119">Une correspondance avec **sourceAnchor** est appelée une **correspondance exacte**.</span><span class="sxs-lookup"><span data-stu-id="44475-119">A match on **sourceAnchor** is known as **hard match**.</span></span> <span data-ttu-id="44475-120">Pour l’attribut **proxyAddresses**, seule la valeur avec **SMTP :**, c’est-à-dire l’adresse e-mail principale, est utilisée pour l’évaluation.</span><span class="sxs-lookup"><span data-stu-id="44475-120">For the **proxyAddresses** attribute only the value with **SMTP:**, that is the primary email address, is used for the evaluation.</span></span>

<span data-ttu-id="44475-121">La correspondance est évaluée uniquement pour les nouveaux objets provenant de Connect.</span><span class="sxs-lookup"><span data-stu-id="44475-121">The match is only evaluated for new objects coming from Connect.</span></span> <span data-ttu-id="44475-122">Si vous modifiez un objet existant afin qu’il corresponde à l’un de ces attributs, une erreur s’affiche à la place.</span><span class="sxs-lookup"><span data-stu-id="44475-122">If you change an exiting object so it is matching any of these attributes, then you see an error instead.</span></span>

<span data-ttu-id="44475-123">Si AD Azure détecte un objet dans lequel les valeurs d’attribut sont les mêmes pour un objet provenant de Connect et qui est déjà présent dans Azure AD, alors l’objet dans Azure AD est pris en charge par Connect.</span><span class="sxs-lookup"><span data-stu-id="44475-123">If Azure AD finds an object where the attribute values are the same for an object coming from Connect and that it is already present in Azure AD, then the object in Azure AD is taken over by Connect.</span></span> <span data-ttu-id="44475-124">L’objet précédemment géré dans le cloud est indiqué comme étant géré en local.</span><span class="sxs-lookup"><span data-stu-id="44475-124">The previously cloud-managed object is flagged as on-premises managed.</span></span> <span data-ttu-id="44475-125">Tous les attributs dans Azure AD avec une valeur dans le répertoire AD local sont remplacés par la valeur locale.</span><span class="sxs-lookup"><span data-stu-id="44475-125">All attributes in Azure AD with a value in on-premises AD are overwritten with the on-premises value.</span></span> <span data-ttu-id="44475-126">L’exception est lorsqu’un attribut a une valeur **NULL** locale.</span><span class="sxs-lookup"><span data-stu-id="44475-126">The exception is when an attribute has a **NULL** value on-premises.</span></span> <span data-ttu-id="44475-127">Dans ce cas, la valeur dans Azure AD est conservée, mais vous pouvez toujours la modifier uniquement en local.</span><span class="sxs-lookup"><span data-stu-id="44475-127">In this case, the value in Azure AD remains, but you can still only change it on-premises to something else.</span></span>

> [!WARNING]
> <span data-ttu-id="44475-128">Étant donné que tous les attributs dans Azure AD vont être remplacés par la valeur locale, assurez-vous que vous disposez de bonnes données locales.</span><span class="sxs-lookup"><span data-stu-id="44475-128">Since all attributes in Azure AD are going to be overwritten by the on-premises value, make sure you have good data on-premises.</span></span> <span data-ttu-id="44475-129">Par exemple, si vous avez uniquement une adresse e-mail gérée dans Office 365 et que vous ne l’avez pas conservée à jour dans AD DS en local, alors vous perdrez toutes les valeurs dans Azure AD/Office 365 qui ne figurent pas dans AD DS.</span><span class="sxs-lookup"><span data-stu-id="44475-129">For example, if you only have managed email address in Office 365 and not kept it updated in on-premises AD DS, then you lose any values in Azure AD/Office 365 not present in AD DS.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="44475-130">Si vous utilisez la synchronisation de mot de passe, qui est toujours utilisée par la configuration rapide, alors le mot de passe dans Azure AD est remplacé par le mot de passe dans le répertoire AD local.</span><span class="sxs-lookup"><span data-stu-id="44475-130">If you use password sync, which is always used by express settings, then the password in Azure AD is overwritten with the password in on-premises AD.</span></span> <span data-ttu-id="44475-131">Si vos utilisateurs sont habitués à gérer des mots de passe différents, vous devez alors les informer qu’ils doivent utiliser le mot de passe local une fois Connect installé.</span><span class="sxs-lookup"><span data-stu-id="44475-131">If your users are used to manage different passwords, then you need to inform them that they should use the on-premises password when you have installed Connect.</span></span>

<span data-ttu-id="44475-132">La section précédente et l’avertissement qu’elle contient doivent être pris en compte lors de la planification.</span><span class="sxs-lookup"><span data-stu-id="44475-132">The previous section and warning must be considered in your planning.</span></span> <span data-ttu-id="44475-133">Si vous avez effectué de nombreuses modifications dans Azure AD qui ne sont pas reflétées dans AD DS en local, vous devez alors planifier comment renseigner AD DS avec les valeurs mises à jour avant de synchroniser vos objets avec Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="44475-133">If you have made many changes in Azure AD not reflected in on-premises AD DS, then you need to plan for how to populate AD DS with the updated values before you sync your objects with Azure AD Connect.</span></span>

<span data-ttu-id="44475-134">Si vous avez exécuté la correspondance de vos objets avec une correspondance souple, l’attribut **sourceAnchor** est ajouté à l’objet dans Azure AD afin qu’une correspondance exacte soit utilisée ultérieurement.</span><span class="sxs-lookup"><span data-stu-id="44475-134">If you matched your objects with a soft-match, then the **sourceAnchor** is added to the object in Azure AD so a hard match can be used later.</span></span>

### <a name="hard-match-vs-soft-match"></a><span data-ttu-id="44475-135">Correspondance exacte et correspondance souple</span><span class="sxs-lookup"><span data-stu-id="44475-135">Hard-match vs Soft-match</span></span>
<span data-ttu-id="44475-136">Pour une nouvelle installation de Connect, il n’existe aucune différence pratique entre une correspondance souple et une correspondance exacte.</span><span class="sxs-lookup"><span data-stu-id="44475-136">For a new installation of Connect, there is no practical difference between a soft- and a hard-match.</span></span> <span data-ttu-id="44475-137">La différence réside dans une situation de récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="44475-137">The difference is in a disaster recovery situation.</span></span> <span data-ttu-id="44475-138">Si votre serveur avec Azure AD Connect a connu une défaillance, vous pouvez réinstaller une nouvelle instance sans perdre de données.</span><span class="sxs-lookup"><span data-stu-id="44475-138">If you have lost your server with Azure AD Connect, you can reinstall a new instance without losing any data.</span></span> <span data-ttu-id="44475-139">Un objet avec un attribut sourceAnchor est envoyé à Connect lors de l’installation initiale.</span><span class="sxs-lookup"><span data-stu-id="44475-139">An object with a sourceAnchor is sent to Connect during initial install.</span></span> <span data-ttu-id="44475-140">La correspondance peut ensuite être évaluée par le client (Azure AD Connect), ce qui est beaucoup plus rapide que de faire la même chose dans Azure AD.</span><span class="sxs-lookup"><span data-stu-id="44475-140">The match can then be evaluated by the client (Azure AD Connect), which is a lot faster than doing the same in Azure AD.</span></span> <span data-ttu-id="44475-141">Une correspondance exacte est évaluée à la fois par Connect et par Azure AD.</span><span class="sxs-lookup"><span data-stu-id="44475-141">A hard match is evaluated both by Connect and by Azure AD.</span></span> <span data-ttu-id="44475-142">Une correspondance souple n’est évaluée que par Azure AD.</span><span class="sxs-lookup"><span data-stu-id="44475-142">A soft match is only evaluated by Azure AD.</span></span>

### <a name="other-objects-than-users"></a><span data-ttu-id="44475-143">Objets autres que des utilisateurs</span><span class="sxs-lookup"><span data-stu-id="44475-143">Other objects than users</span></span>
<span data-ttu-id="44475-144">Les utilisateurs disposent généralement des attributs userPrincipalName et proxyAddresses, facilitant ainsi la correspondance.</span><span class="sxs-lookup"><span data-stu-id="44475-144">Users usually have both userPrincipalName and proxyAddresses, making the match easy.</span></span> <span data-ttu-id="44475-145">Mais les autres objets, tels que les groupes de sécurité, n’ont pas ces attributs.</span><span class="sxs-lookup"><span data-stu-id="44475-145">But other objects, such as security groups, do not have those.</span></span> <span data-ttu-id="44475-146">Dans ce cas, vous pouvez uniquement établir une correspondance exacte à l’aide de l’attribut sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="44475-146">In this case, you can only match on a hard match using the sourceAnchor.</span></span> <span data-ttu-id="44475-147">L’attribut sourceAnchor correspond toujours à l’attribut **objectGUID** en local converti en Base64. Vous devez donc mettre à jour la valeur dans Azure AD lorsque vous avez besoin que deux objets correspondent.</span><span class="sxs-lookup"><span data-stu-id="44475-147">The sourceAnchor is always the Base64 converted **objectGUID** on-premises, so you must update the value in Azure AD when you need two objects to match.</span></span> <span data-ttu-id="44475-148">L’attribut sourceAnchor/immutableID peut uniquement être mis à jour avec PowerShell et non via les portails.</span><span class="sxs-lookup"><span data-stu-id="44475-148">The sourceAnchor/immutableID can only be updated with PowerShell and not through the portals.</span></span>

## <a name="create-a-new-on-premises-active-directory-from-data-in-azure-ad"></a><span data-ttu-id="44475-149">Créer un nouveau répertoire Active Directory local à partir des données dans Azure AD</span><span class="sxs-lookup"><span data-stu-id="44475-149">Create a new on-premises Active Directory from data in Azure AD</span></span>
<span data-ttu-id="44475-150">Certains clients démarrent avec une solution cloud uniquement avec Azure AD et ils ne disposent pas d’un répertoire AD local.</span><span class="sxs-lookup"><span data-stu-id="44475-150">Some customers start with a cloud-only solution with Azure AD and they do not have an on-premises AD.</span></span> <span data-ttu-id="44475-151">Ensuite, ils souhaitent consommer des ressources locales et créer un répertoire AD local basé sur les données d’Azure AD.</span><span class="sxs-lookup"><span data-stu-id="44475-151">Later they want to consume on-premises resources and want to build an on-premises AD based on Azure AD data.</span></span> <span data-ttu-id="44475-152">Azure AD Connect ne peut pas vous aider dans ce scénario.</span><span class="sxs-lookup"><span data-stu-id="44475-152">Azure AD Connect cannot help you for this scenario.</span></span> <span data-ttu-id="44475-153">Il ne crée pas d’utilisateurs locaux et il ne peut pas définir le mot de passe local pour qu’il soit le même que dans Azure AD.</span><span class="sxs-lookup"><span data-stu-id="44475-153">It does not create users on-premises and it does not have any ability to set the password on-premises to the same as in Azure AD.</span></span>

<span data-ttu-id="44475-154">Si la seule raison pour laquelle vous souhaitez ajouter un répertoire AD local est pour la prise en charge d’applications métier, vous devrez peut-être envisager d’utiliser les [services de domaine Azure AD](../../active-directory-domain-services/index.md) à la place.</span><span class="sxs-lookup"><span data-stu-id="44475-154">If the only reason why you plan to add on-premises AD is to support LOBs (Line-of-Business apps), then maybe you should consider to use [Azure AD domain services](../../active-directory-domain-services/index.md) instead.</span></span>

## <a name="next-steps"></a><span data-ttu-id="44475-155">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="44475-155">Next steps</span></span>
<span data-ttu-id="44475-156">En savoir plus sur l’ [intégration de vos identités locales avec Azure Active Directory](active-directory-aadconnect.md).</span><span class="sxs-lookup"><span data-stu-id="44475-156">Learn more about [Integrating your on-premises identities with Azure Active Directory](active-directory-aadconnect.md).</span></span>
