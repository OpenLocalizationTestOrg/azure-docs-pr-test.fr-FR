---
title: "aaaAzure Active Directory v2.0 étendues, les autorisations et consentement | Documents Microsoft"
description: "Description de l’autorisation dans le point de terminaison hello Azure AD v2.0, y compris les étendues, les autorisations et consentement."
services: active-directory
documentationcenter: 
author: dstrockis
manager: mbaldwin
editor: 
ms.assetid: 8f98cbf0-a71d-4e34-babf-e644ad9ff423
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/07/2017
ms.author: dastrock
ms.custom: aaddev
ms.openlocfilehash: 5721d368c435868bfb4ae91cff7fbb9bc4a79b66
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="scopes-permissions-and-consent-in-hello-azure-active-directory-v20-endpoint"></a><span data-ttu-id="226e3-103">Consentement dans le point de terminaison v2.0 hello Azure Active Directory, les autorisations et les étendues</span><span class="sxs-lookup"><span data-stu-id="226e3-103">Scopes, permissions, and consent in hello Azure Active Directory v2.0 endpoint</span></span>
<span data-ttu-id="226e3-104">Les applications intégrées à Azure Active Directory (Azure AD) suivent un modèle d’autorisation, qui permet aux utilisateurs de contrôler le mode d’accès d’une application à leurs données.</span><span class="sxs-lookup"><span data-stu-id="226e3-104">Apps that integrate with Azure Active Directory (Azure AD) follow an authorization model that gives users control over how an app can access their data.</span></span> <span data-ttu-id="226e3-105">implémentation de v2.0 Hello du modèle d’autorisation de hello a été mis à jour, et il modifie la façon dont une application doit interagir avec Azure AD.</span><span class="sxs-lookup"><span data-stu-id="226e3-105">hello v2.0 implementation of hello authorization model has been updated, and it changes how an app must interact with Azure AD.</span></span> <span data-ttu-id="226e3-106">Cet article traite des concepts de base hello de ce modèle d’autorisation, y compris les étendues, les autorisations et consentement.</span><span class="sxs-lookup"><span data-stu-id="226e3-106">This article covers hello basic concepts of this authorization model, including scopes, permissions, and consent.</span></span>

> [!NOTE]
> <span data-ttu-id="226e3-107">point de terminaison Hello v2.0 ne prend pas en charge toutes les fonctionnalités et scénarios d’Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="226e3-107">hello v2.0 endpoint does not support all Azure Active Directory scenarios and features.</span></span> <span data-ttu-id="226e3-108">toodetermine si vous devez utiliser le point de terminaison hello v2.0, en savoir plus sur [v2.0 limitations](active-directory-v2-limitations.md).</span><span class="sxs-lookup"><span data-stu-id="226e3-108">toodetermine whether you should use hello v2.0 endpoint, read about [v2.0 limitations](active-directory-v2-limitations.md).</span></span>
>
>

## <a name="scopes-and-permissions"></a><span data-ttu-id="226e3-109">Étendues et autorisations</span><span class="sxs-lookup"><span data-stu-id="226e3-109">Scopes and permissions</span></span>
<span data-ttu-id="226e3-110">Azure AD implémente hello [OAuth 2.0](active-directory-v2-protocols.md) protocole d’autorisation.</span><span class="sxs-lookup"><span data-stu-id="226e3-110">Azure AD implements hello [OAuth 2.0](active-directory-v2-protocols.md) authorization protocol.</span></span> <span data-ttu-id="226e3-111">OAuth 2.0 est une méthode par le biais de laquelle une application tierce peut accéder aux ressources hébergées sur le web au nom d’un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="226e3-111">OAuth 2.0 is a method through which a third-party app can access web-hosted resources on behalf of a user.</span></span> <span data-ttu-id="226e3-112">Les ressources hébergées sur le web qui s’intègrent à Azure AD présentent un identificateur de ressource, également appelé *URI d’ID d’application*.</span><span class="sxs-lookup"><span data-stu-id="226e3-112">Any web-hosted resource that integrates with Azure AD has a resource identifier, or *Application ID URI*.</span></span> <span data-ttu-id="226e3-113">Voici, par exemple, quelques-unes des ressources hébergées sur le Web de Microsoft :</span><span class="sxs-lookup"><span data-stu-id="226e3-113">For example, some of Microsoft's web-hosted resources include:</span></span>

* <span data-ttu-id="226e3-114">Hello API de messagerie unifiée d’Office 365 :`https://outlook.office.com`</span><span class="sxs-lookup"><span data-stu-id="226e3-114">hello Office 365 Unified Mail API: `https://outlook.office.com`</span></span>
* <span data-ttu-id="226e3-115">Hello API Azure AD Graph :`https://graph.windows.net`</span><span class="sxs-lookup"><span data-stu-id="226e3-115">hello Azure AD Graph API: `https://graph.windows.net`</span></span>
* <span data-ttu-id="226e3-116">Microsoft Graph : `https://graph.microsoft.com`</span><span class="sxs-lookup"><span data-stu-id="226e3-116">Microsoft Graph: `https://graph.microsoft.com`</span></span>

<span data-ttu-id="226e3-117">Hello qu'est de même pour toutes les ressources de tiers intégrés à Azure AD.</span><span class="sxs-lookup"><span data-stu-id="226e3-117">hello same is true for any third-party resources that have integrated with Azure AD.</span></span> <span data-ttu-id="226e3-118">Ces ressources peuvent également définir un jeu d’autorisations qui peuvent être des fonctionnalités de hello toodivide utilisé d’une ressource en plus petits.</span><span class="sxs-lookup"><span data-stu-id="226e3-118">Any of these resources also can define a set of permissions that can be used toodivide hello functionality of that resource into smaller chunks.</span></span> <span data-ttu-id="226e3-119">Par exemple, [Microsoft Graph](https://graph.microsoft.io) a défini hello de toodo autorisations suivant de tâches, entre autres :</span><span class="sxs-lookup"><span data-stu-id="226e3-119">As an example, [Microsoft Graph](https://graph.microsoft.io) has defined permissions toodo hello following tasks, among others:</span></span>

* <span data-ttu-id="226e3-120">Lire le calendrier d’un utilisateur</span><span class="sxs-lookup"><span data-stu-id="226e3-120">Read a user's calendar</span></span>
* <span data-ttu-id="226e3-121">Calendrier de l’utilisateur écriture tooa</span><span class="sxs-lookup"><span data-stu-id="226e3-121">Write tooa user's calendar</span></span>
* <span data-ttu-id="226e3-122">Envoi de messages en tant qu’utilisateur</span><span class="sxs-lookup"><span data-stu-id="226e3-122">Send mail as a user</span></span>

<span data-ttu-id="226e3-123">En définissant ces types d’autorisations, les ressources hello possède un contrôle affiné sur ses données et la façon dont les données de salutation sont exposées.</span><span class="sxs-lookup"><span data-stu-id="226e3-123">By defining these types of permissions, hello resource has fine-grained control over its data and how hello data is exposed.</span></span> <span data-ttu-id="226e3-124">Une application tierce peut demander ces autorisations à un utilisateur d’application.</span><span class="sxs-lookup"><span data-stu-id="226e3-124">A third-party app can request these permissions from an app user.</span></span> <span data-ttu-id="226e3-125">utilisateur d’application Hello doit approuver les autorisations hello avant de l’application hello peut agir au nom d’utilisateur hello.</span><span class="sxs-lookup"><span data-stu-id="226e3-125">hello app user must approve hello permissions before hello app can act on hello user's behalf.</span></span> <span data-ttu-id="226e3-126">Par les fonctionnalités de la ressource hello dans les jeux d’autorisations plus petits de segmentation, les applications tierces peuvent être toorequest intégrée uniquement hello des autorisations spécifiques dont ils ont besoin tooperform leur fonction.</span><span class="sxs-lookup"><span data-stu-id="226e3-126">By chunking hello resource's functionality into smaller permission sets, third-party apps can be built toorequest only hello specific permissions that they need tooperform their function.</span></span> <span data-ttu-id="226e3-127">Utilisateurs de l’application peuvent savoir exactement comment une application utilise leurs données, et ils peuvent être plus sûr pour que cette application hello ne semble pas fonctionne dans un but malveillant.</span><span class="sxs-lookup"><span data-stu-id="226e3-127">App users can know exactly how an app will use their data, and they can be more confident that hello app is not behaving with malicious intent.</span></span>

<span data-ttu-id="226e3-128">Dans Azure AD et OAuth, ces types d’autorisation sont appelés des *étendues*.</span><span class="sxs-lookup"><span data-stu-id="226e3-128">In Azure AD and OAuth, these types of permissions are called *scopes*.</span></span> <span data-ttu-id="226e3-129">Ils sont parfois également désignée tooas *oAuth2Permissions*.</span><span class="sxs-lookup"><span data-stu-id="226e3-129">They also sometimes are referred tooas *oAuth2Permissions*.</span></span> <span data-ttu-id="226e3-130">Une étendue est représentée dans Azure AD en tant que valeur de chaîne.</span><span class="sxs-lookup"><span data-stu-id="226e3-130">A scope is represented in Azure AD as a string value.</span></span> <span data-ttu-id="226e3-131">Valeur de la portée hello pour chaque autorisation de poursuivre avec l’exemple de Microsoft Graph hello, est :</span><span class="sxs-lookup"><span data-stu-id="226e3-131">Continuing with hello Microsoft Graph example, hello scope value for each permission is:</span></span>

* <span data-ttu-id="226e3-132">Lire le calendrier d’un utilisateur en utilisant `Calendar.Read`</span><span class="sxs-lookup"><span data-stu-id="226e3-132">Read a user's calendar by using `Calendar.Read`</span></span>
* <span data-ttu-id="226e3-133">Écrire le calendrier de l’utilisateur tooa à l’aide de`Mail.ReadWrite`</span><span class="sxs-lookup"><span data-stu-id="226e3-133">Write tooa user's calendar by using `Mail.ReadWrite`</span></span>
* <span data-ttu-id="226e3-134">Envoi de messages en tant qu’utilisateur en utilisant `Mail.Send`</span><span class="sxs-lookup"><span data-stu-id="226e3-134">Send mail as a user using by `Mail.Send`</span></span>

<span data-ttu-id="226e3-135">Une application peut demander ces autorisations en spécifiant des étendues de hello dans le point de terminaison de demandes toohello v2.0.</span><span class="sxs-lookup"><span data-stu-id="226e3-135">An app can request these permissions by specifying hello scopes in requests toohello v2.0 endpoint.</span></span>

## <a name="openid-connect-scopes"></a><span data-ttu-id="226e3-136">Étendues OpenId Connect</span><span class="sxs-lookup"><span data-stu-id="226e3-136">OpenID Connect scopes</span></span>
<span data-ttu-id="226e3-137">implémentation de v2.0 Hello de OpenID Connect a quelques étendues bien définis qui ne s’appliquent pas les ressources spécifiques tooa : `openid`, `email`, `profile`, et `offline_access`.</span><span class="sxs-lookup"><span data-stu-id="226e3-137">hello v2.0 implementation of OpenID Connect has a few well-defined scopes that do not apply tooa specific resource: `openid`, `email`, `profile`, and `offline_access`.</span></span>

### <a name="openid"></a><span data-ttu-id="226e3-138">openid</span><span class="sxs-lookup"><span data-stu-id="226e3-138">openid</span></span>
<span data-ttu-id="226e3-139">Si une application qui effectue la connexion à l’aide de [OpenID Connect](active-directory-v2-protocols.md), elle doit demander l’autorisation hello `openid` étendue.</span><span class="sxs-lookup"><span data-stu-id="226e3-139">If an app performs sign-in by using [OpenID Connect](active-directory-v2-protocols.md), it must request hello `openid` scope.</span></span> <span data-ttu-id="226e3-140">Hello `openid` montre étendue sur le compte de travail hello page de consentement hello « Connexion vous » l’autorisation et sur le compte Microsoft personnel de hello donner son accord page comme hello l’autorisation « Afficher votre profil et se connecter tooapps et services à l’aide de votre compte Microsoft ».</span><span class="sxs-lookup"><span data-stu-id="226e3-140">hello `openid` scope shows on hello work account consent page as hello "Sign you in" permission, and on hello personal Microsoft account consent page as hello "View your profile and connect tooapps and services using your Microsoft account" permission.</span></span> <span data-ttu-id="226e3-141">Avec cette autorisation, une application peut recevoir un identificateur unique pour l’utilisateur de hello sous forme de hello Hello `sub` de revendication.</span><span class="sxs-lookup"><span data-stu-id="226e3-141">With this permission, an app can receive a unique identifier for hello user in hello form of hello `sub` claim.</span></span> <span data-ttu-id="226e3-142">Elle donne également le point de terminaison hello application accès toohello UserInfo.</span><span class="sxs-lookup"><span data-stu-id="226e3-142">It also gives hello app access toohello UserInfo endpoint.</span></span> <span data-ttu-id="226e3-143">Hello `openid` étendue peut être utilisée à hello v2.0 point de terminaison token tooacquire ID jetons, qui peuvent être utilisé toosecure HTTP des appels entre les différents composants d’une application.</span><span class="sxs-lookup"><span data-stu-id="226e3-143">hello `openid` scope can be used at hello v2.0 token endpoint tooacquire ID tokens, which can be used toosecure HTTP calls between different components of an app.</span></span>

### <a name="email"></a><span data-ttu-id="226e3-144">email</span><span class="sxs-lookup"><span data-stu-id="226e3-144">email</span></span>
<span data-ttu-id="226e3-145">Hello `email` étendue peut être utilisée avec hello `openid` étendue et autres.</span><span class="sxs-lookup"><span data-stu-id="226e3-145">hello `email` scope can be used with hello `openid` scope and any others.</span></span> <span data-ttu-id="226e3-146">Il donne l’adresse de messagerie principale de l’utilisateur toohello hello application accès sous forme de hello Hello `email` de revendication.</span><span class="sxs-lookup"><span data-stu-id="226e3-146">It gives hello app access toohello user's primary email address in hello form of hello `email` claim.</span></span> <span data-ttu-id="226e3-147">Hello `email` revendication est incluse dans un jeton uniquement si une adresse de messagerie est associée au compte d’utilisateur hello, qui n’est pas toujours le cas de hello.</span><span class="sxs-lookup"><span data-stu-id="226e3-147">hello `email` claim is included in a token only if an email address is associated with hello user account, which is not always hello case.</span></span> <span data-ttu-id="226e3-148">Si elle utilise hello `email` étendue, votre application doit être préparée toohandle un cas dans le hello `email` revendication n’existe pas dans le jeton de hello.</span><span class="sxs-lookup"><span data-stu-id="226e3-148">If it uses hello `email` scope, your app should be prepared toohandle a case in which hello `email` claim does not exist in hello token.</span></span>

### <a name="profile"></a><span data-ttu-id="226e3-149">Profil</span><span class="sxs-lookup"><span data-stu-id="226e3-149">profile</span></span>
<span data-ttu-id="226e3-150">Hello `profile` étendue peut être utilisée avec hello `openid` étendue et autres.</span><span class="sxs-lookup"><span data-stu-id="226e3-150">hello `profile` scope can be used with hello `openid` scope and any others.</span></span> <span data-ttu-id="226e3-151">Elle donne hello application accès tooa beaucoup d’informations sur l’utilisateur de hello.</span><span class="sxs-lookup"><span data-stu-id="226e3-151">It gives hello app access tooa substantial amount of information about hello user.</span></span> <span data-ttu-id="226e3-152">Il peut accéder à des informations Hello inclut, mais ne sont pas limitées pour hello du nom de l’utilisateur, nom de famille, nom d’utilisateur par défaut et l’ID d’objet</span><span class="sxs-lookup"><span data-stu-id="226e3-152">hello information it can access includes, but is not limited to, hello user's given name, surname, preferred username, and object ID.</span></span> <span data-ttu-id="226e3-153">Pour obtenir une liste complète des revendications de profil hello disponibles dans le paramètre d’id_tokens hello pour un utilisateur spécifique, consultez hello [v2.0 jetons référence](active-directory-v2-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="226e3-153">For a complete list of hello profile claims available in hello id_tokens parameter for a specific user, see hello [v2.0 tokens reference](active-directory-v2-tokens.md).</span></span>

### <a name="offlineaccess"></a><span data-ttu-id="226e3-154">offline_access</span><span class="sxs-lookup"><span data-stu-id="226e3-154">offline_access</span></span>
<span data-ttu-id="226e3-155">Hello [ `offline_access` étendue](http://openid.net/specs/openid-connect-core-1_0.html#OfflineAccess) donne votre tooresources de l’accès d’application pour le compte d’utilisateur de hello pendant une durée prolongée.</span><span class="sxs-lookup"><span data-stu-id="226e3-155">hello [`offline_access` scope](http://openid.net/specs/openid-connect-core-1_0.html#OfflineAccess) gives your app access tooresources on behalf of hello user for an extended time.</span></span> <span data-ttu-id="226e3-156">Sur la page de consentement hello travail compte, cette étendue s’affiche comme hello « Accéder à vos données à tout moment » l’autorisation.</span><span class="sxs-lookup"><span data-stu-id="226e3-156">On hello work account consent page, this scope appears as hello "Access your data anytime" permission.</span></span> <span data-ttu-id="226e3-157">Sur hello personnel consentement page de compte Microsoft, il apparaît comme hello « Accéder à vos informations à tout moment » l’autorisation.</span><span class="sxs-lookup"><span data-stu-id="226e3-157">On hello personal Microsoft account consent page, it appears as hello "Access your info anytime" permission.</span></span> <span data-ttu-id="226e3-158">Quand un utilisateur approuve hello `offline_access` étendue, votre application peut recevoir des jetons d’actualisation à partir du point de terminaison token hello v2.0.</span><span class="sxs-lookup"><span data-stu-id="226e3-158">When a user approves hello `offline_access` scope, your app can receive refresh tokens from hello v2.0 token endpoint.</span></span> <span data-ttu-id="226e3-159">Les jetons d’actualisation sont de longue durée.</span><span class="sxs-lookup"><span data-stu-id="226e3-159">Refresh tokens are long-lived.</span></span> <span data-ttu-id="226e3-160">Votre application peut obtenir de nouveaux jetons d’accès lorsque les plus anciens arrivent à expiration.</span><span class="sxs-lookup"><span data-stu-id="226e3-160">Your app can get new access tokens as older ones expire.</span></span>

<span data-ttu-id="226e3-161">Si votre application ne demande pas hello `offline_access` étendue, il ne sera pas recevoir des jetons d’actualisation.</span><span class="sxs-lookup"><span data-stu-id="226e3-161">If your app does not request hello `offline_access` scope, it won't receive refresh tokens.</span></span> <span data-ttu-id="226e3-162">Cela signifie que lorsque vous utilisez un code d’autorisation Bonjour [flux de code d’autorisation OAuth 2.0](active-directory-v2-protocols.md), vous recevrez un jeton d’accès de hello `/token` point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="226e3-162">This means that when you redeem an authorization code in hello [OAuth 2.0 authorization code flow](active-directory-v2-protocols.md), you'll receive only an access token from hello `/token` endpoint.</span></span> <span data-ttu-id="226e3-163">jeton d’accès Hello est valide pendant une courte période.</span><span class="sxs-lookup"><span data-stu-id="226e3-163">hello access token is valid for a short time.</span></span> <span data-ttu-id="226e3-164">jeton d’accès Hello expire généralement en une heure.</span><span class="sxs-lookup"><span data-stu-id="226e3-164">hello access token usually expires in one hour.</span></span> <span data-ttu-id="226e3-165">À ce stade, votre application doit tooredirect hello utilisateur précédent toohello `/authorize` tooget de point de terminaison un nouveau code d’autorisation.</span><span class="sxs-lookup"><span data-stu-id="226e3-165">At that point, your app needs tooredirect hello user back toohello `/authorize` endpoint tooget a new authorization code.</span></span> <span data-ttu-id="226e3-166">Au cours de cette redirection, en fonction de type hello d’application, utilisateur de hello tooenter leurs informations d’identification de nouveau besoin ou donner son consentement à nouveau toopermissions.</span><span class="sxs-lookup"><span data-stu-id="226e3-166">During this redirect, depending on hello type of app, hello user might need tooenter their credentials again or consent again toopermissions.</span></span>

<span data-ttu-id="226e3-167">Pour plus d’informations sur la façon dont tooget et utilisez jetons d’actualisation, consultez hello [référence au protocole v2.0](active-directory-v2-protocols.md).</span><span class="sxs-lookup"><span data-stu-id="226e3-167">For more information about how tooget and use refresh tokens, see hello [v2.0 protocol reference](active-directory-v2-protocols.md).</span></span>

## <a name="requesting-individual-user-consent"></a><span data-ttu-id="226e3-168">Demande de consentement d’utilisateur individuel</span><span class="sxs-lookup"><span data-stu-id="226e3-168">Requesting individual user consent</span></span>
<span data-ttu-id="226e3-169">Dans un [OpenID Connect ou OAuth 2.0](active-directory-v2-protocols.md) demande d’autorisation, une application peut demander des autorisations de hello dont il a besoin à l’aide de hello `scope` paramètre de requête.</span><span class="sxs-lookup"><span data-stu-id="226e3-169">In an [OpenID Connect or OAuth 2.0](active-directory-v2-protocols.md) authorization request, an app can request hello permissions it needs by using hello `scope` query parameter.</span></span> <span data-ttu-id="226e3-170">Par exemple, lorsqu’un utilisateur se connecte dans l’application de tooan, application hello envoie une requête comme hello exemple suivant (avec les sauts de ligne ajoutés pour une meilleure lisibilité) :</span><span class="sxs-lookup"><span data-stu-id="226e3-170">For example, when a user signs in tooan app, hello app sends a request like hello following example (with line breaks added for legibility):</span></span>

```
GET https://login.microsoftonline.com/common/oauth2/v2.0/authorize?
client_id=6731de76-14a6-49ae-97bc-6eba6914391e
&response_type=code
&redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F
&response_mode=query
&scope=
https%3A%2F%2Fgraph.microsoft.com%2Fcalendar.read%20
https%3A%2F%2Fgraph.microsoft.com%2Fmail.send
&state=12345
```

<span data-ttu-id="226e3-171">Hello `scope` paramètre est une liste séparée par des espaces d’étendues que hello application demande.</span><span class="sxs-lookup"><span data-stu-id="226e3-171">hello `scope` parameter is a space-separated list of scopes that hello app is requesting.</span></span> <span data-ttu-id="226e3-172">Chaque étendue est indiqué par l’ajout de l’identificateur de la ressource toohello hello étendue valeur (hello URI ID d’Application).</span><span class="sxs-lookup"><span data-stu-id="226e3-172">Each scope is indicated by appending hello scope value toohello resource's identifier (hello Application ID URI).</span></span> <span data-ttu-id="226e3-173">Dans l’exemple de demande hello, hello application besoins autorisation tooread hello calendrier de l’utilisateur et envoyer du courrier en tant qu’utilisateur de hello.</span><span class="sxs-lookup"><span data-stu-id="226e3-173">In hello request example, hello app needs permission tooread hello user's calendar and send mail as hello user.</span></span>

<span data-ttu-id="226e3-174">Une fois que l’utilisateur de la hello entre leurs informations d’identification, point de terminaison hello v2.0 vérifie un enregistrement correspondant de *consentement de l’utilisateur*.</span><span class="sxs-lookup"><span data-stu-id="226e3-174">After hello user enters their credentials, hello v2.0 endpoint checks for a matching record of *user consent*.</span></span> <span data-ttu-id="226e3-175">Si l’utilisateur de hello n’a pas accepté tooany Hello demandé Bonjour passé, les autorisations de point de terminaison hello v2.0 demande hello utilisateur toogrant hello les autorisations demandées.</span><span class="sxs-lookup"><span data-stu-id="226e3-175">If hello user has not consented tooany of hello requested permissions in hello past, hello v2.0 endpoint asks hello user toogrant hello requested permissions.</span></span>

![Consentement dans le compte professionnel](../../media/active-directory-v2-flows/work_account_consent.png)

<span data-ttu-id="226e3-177">Lorsque l’utilisateur de hello approuve l’autorisation de hello, consentement de hello est enregistré pour hello utilisateur ne dispose pas tooconsent à nouveau sur les connexions de compte suivantes.</span><span class="sxs-lookup"><span data-stu-id="226e3-177">When hello user approves hello permission, hello consent is recorded so that hello user doesn't have tooconsent again on subsequent account sign-ins.</span></span>

## <a name="requesting-consent-for-an-entire-tenant"></a><span data-ttu-id="226e3-178">Demande de consentement d’un client entier</span><span class="sxs-lookup"><span data-stu-id="226e3-178">Requesting consent for an entire tenant</span></span>
<span data-ttu-id="226e3-179">Souvent, lorsqu’une organisation achète une licence ou un abonnement pour une application, organisation de hello souhaite que toofully disposition hello application pour ses employés.</span><span class="sxs-lookup"><span data-stu-id="226e3-179">Often, when an organization purchases a license or subscription for an application, hello organization wants toofully provision hello application for its employees.</span></span> <span data-ttu-id="226e3-180">Dans le cadre de ce processus, un administrateur peut accorder son consentement à tooact d’application hello pour le compte de tous les employés.</span><span class="sxs-lookup"><span data-stu-id="226e3-180">As part of this process, an administrator can grant consent for hello application tooact on behalf of any employee.</span></span> <span data-ttu-id="226e3-181">Si hello admin consentement pour le client entière de hello, hello ses employés ne voyez pas une page de consentement pour l’application hello.</span><span class="sxs-lookup"><span data-stu-id="226e3-181">If hello admin grants consent for hello entire tenant, hello organization's employees won't see a consent page for hello application.</span></span>

<span data-ttu-id="226e3-182">consentement toorequest pour tous les utilisateurs dans un locataire, votre application peut utiliser consentement point de terminaison admin hello.</span><span class="sxs-lookup"><span data-stu-id="226e3-182">toorequest consent for all users in a tenant, your app can use hello admin consent endpoint.</span></span>

## <a name="admin-restricted-scopes"></a><span data-ttu-id="226e3-183">Étendues limitées aux administrateurs</span><span class="sxs-lookup"><span data-stu-id="226e3-183">Admin-restricted scopes</span></span>
<span data-ttu-id="226e3-184">Certaines autorisations à privilèges élevés dans l’écosystème de Microsoft hello peuvent être définies trop*restreint aux administrateurs*.</span><span class="sxs-lookup"><span data-stu-id="226e3-184">Some high-privilege permissions in hello Microsoft ecosystem can be set too*admin-restricted*.</span></span> <span data-ttu-id="226e3-185">Exemples de ces types de portées hello les autorisations suivantes :</span><span class="sxs-lookup"><span data-stu-id="226e3-185">Examples of these kinds of scopes include hello following permissions:</span></span>

* <span data-ttu-id="226e3-186">Lire le répertoire d’une organisation à l’aide de `Directory.Read`</span><span class="sxs-lookup"><span data-stu-id="226e3-186">Read an organization's directory data by using `Directory.Read`</span></span>
* <span data-ttu-id="226e3-187">Écrire des données tooan l’annuaire organisation à l’aide de`Directory.ReadWrite`</span><span class="sxs-lookup"><span data-stu-id="226e3-187">Write data tooan organization's directory by using `Directory.ReadWrite`</span></span>
* <span data-ttu-id="226e3-188">Lire des groupes de sécurité dans le répertoire d’une organisation à l’aide de `Groups.Read.All`</span><span class="sxs-lookup"><span data-stu-id="226e3-188">Read security groups in an organization's directory by using `Groups.Read.All`</span></span>

<span data-ttu-id="226e3-189">Même si un utilisateur de consommateur peut être un toothis d’accès application type de données, les utilisateurs professionnels sont restreints l’octroi de toohello accès même jeu de données d’entreprise sensibles.</span><span class="sxs-lookup"><span data-stu-id="226e3-189">Although a consumer user might grant an application access toothis kind of data, organizational users are restricted from granting access toohello same set of sensitive company data.</span></span> <span data-ttu-id="226e3-190">Si votre application demande tooone d’accès de ces autorisations à partir d’un utilisateur d’organisation, utilisateur de hello reçoit un message d’erreur indiquant qu’ils ne sont pas des autorisations de l’application de tooyour tooconsent autorisés.</span><span class="sxs-lookup"><span data-stu-id="226e3-190">If your application requests access tooone of these permissions from an organizational user, hello user receives an error message that says they are not authorized tooconsent tooyour app's permissions.</span></span>

<span data-ttu-id="226e3-191">Si votre application nécessite un accès restreint tooadmin étendues pour les organisations, vous devez les demander également directement à partir d’un administrateur d’entreprise, à l’aide de hello admin consentement point de terminaison, décrite ci-après.</span><span class="sxs-lookup"><span data-stu-id="226e3-191">If your app requires access tooadmin-restricted scopes for organizations, you should request them directly from a company administrator, also by using hello admin consent endpoint, described next.</span></span>

<span data-ttu-id="226e3-192">Lorsqu’un administrateur accorde que ces autorisations via hello admin consentement de point de terminaison, le consentement est accordé pour tous les utilisateurs dans le locataire de hello.</span><span class="sxs-lookup"><span data-stu-id="226e3-192">When an administrator grants these permissions via hello admin consent endpoint, consent is granted for all users in hello tenant.</span></span>

## <a name="using-hello-admin-consent-endpoint"></a><span data-ttu-id="226e3-193">À l’aide du point de terminaison consentement hello admin</span><span class="sxs-lookup"><span data-stu-id="226e3-193">Using hello admin consent endpoint</span></span>
<span data-ttu-id="226e3-194">Si vous suivez ces étapes, votre application peut rassembler les autorisations pour tous les utilisateurs dans un client, notamment les étendues restreintes aux administrateurs.</span><span class="sxs-lookup"><span data-stu-id="226e3-194">If you follow these steps, your app can gather permissions for all users in a tenant, including admin-restricted scopes.</span></span> <span data-ttu-id="226e3-195">toosee un exemple de code qui implémente la procédure hello, consultez hello [exemple d’étendues de restreint aux administrateurs](https://github.com/Azure-Samples/active-directory-dotnet-admin-restricted-scopes-v2).</span><span class="sxs-lookup"><span data-stu-id="226e3-195">toosee a code sample that implements hello steps, see hello [admin-restricted scopes sample](https://github.com/Azure-Samples/active-directory-dotnet-admin-restricted-scopes-v2).</span></span>

### <a name="request-hello-permissions-in-hello-app-registration-portal"></a><span data-ttu-id="226e3-196">Demander des autorisations dans le portail de l’enregistrement d’application hello hello</span><span class="sxs-lookup"><span data-stu-id="226e3-196">Request hello permissions in hello app registration portal</span></span>
1. <span data-ttu-id="226e3-197">Accédez application tooyour Bonjour [portail de l’enregistrement d’Application](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList), ou [créer une application](active-directory-v2-app-registration.md) si vous n’avez pas déjà.</span><span class="sxs-lookup"><span data-stu-id="226e3-197">Go tooyour application in hello [Application Registration Portal](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList), or [create an app](active-directory-v2-app-registration.md) if you haven't already.</span></span>
2. <span data-ttu-id="226e3-198">Recherchez hello **Microsoft Graph autorisations** section, puis ajoutez les autorisations de hello que votre application requiert.</span><span class="sxs-lookup"><span data-stu-id="226e3-198">Locate hello **Microsoft Graph Permissions** section, and then add hello permissions that your app requires.</span></span>
3. <span data-ttu-id="226e3-199">Vérifiez que vous **enregistrer** hello d’inscription d’une application.</span><span class="sxs-lookup"><span data-stu-id="226e3-199">Make sure you **Save** hello app registration.</span></span>

### <a name="recommended-sign-hello-user-in-tooyour-app"></a><span data-ttu-id="226e3-200">Recommandé : Se connecter hello utilisateur dans l’application de tooyour</span><span class="sxs-lookup"><span data-stu-id="226e3-200">Recommended: Sign hello user in tooyour app</span></span>
<span data-ttu-id="226e3-201">En règle générale, lorsque vous générez une application qui utilise le point de terminaison consentement hello admin, application hello a besoin d’une page ou un affichage dans le hello administrateur peut approuver les autorisations de l’application hello.</span><span class="sxs-lookup"><span data-stu-id="226e3-201">Typically, when you build an application that uses hello admin consent endpoint, hello app needs a page or view in which hello admin can approve hello app's permissions.</span></span> <span data-ttu-id="226e3-202">Cette page peut faire partie du flux d’inscription de l’application hello, partie des paramètres de l’application hello, ou il peut être « se connecter » flux dédié.</span><span class="sxs-lookup"><span data-stu-id="226e3-202">This page can be part of hello app's sign-up flow, part of hello app's settings, or it can be a dedicated "connect" flow.</span></span> <span data-ttu-id="226e3-203">Dans de nombreux cas, il est logique pour hello application tooshow cela « se connecter » afficher uniquement une fois un utilisateur connecté avec un professionnel ou scolaire compte Microsoft.</span><span class="sxs-lookup"><span data-stu-id="226e3-203">In many cases, it makes sense for hello app tooshow this "connect" view only after a user has signed in with a work or school Microsoft account.</span></span>

<span data-ttu-id="226e3-204">Lorsque vous vous connectez utilisateur hello dans tooyour application, vous pouvez identifier les organisation hello toowhich hello admin appartient avant de demander les autorisations nécessaires de tooapprove hello.</span><span class="sxs-lookup"><span data-stu-id="226e3-204">When you sign hello user in tooyour app, you can identify hello organization toowhich hello admin belongs before asking them tooapprove hello necessary permissions.</span></span> <span data-ttu-id="226e3-205">Même si cela n’est pas strictement nécessaire, cela peut vous aider à créer une expérience plus intuitive pour les utilisateurs de l’organisation.</span><span class="sxs-lookup"><span data-stu-id="226e3-205">Although not strictly necessary, it can help you create a more intuitive experience for your organizational users.</span></span> <span data-ttu-id="226e3-206">toosign hello utilisateur, suivez notre [didacticiels de protocole v2.0](active-directory-v2-protocols.md).</span><span class="sxs-lookup"><span data-stu-id="226e3-206">toosign hello user in, follow our [v2.0 protocol tutorials](active-directory-v2-protocols.md).</span></span>

### <a name="request-hello-permissions-from-a-directory-admin"></a><span data-ttu-id="226e3-207">Demander des autorisations hello à partir d’un administrateur d’annuaire</span><span class="sxs-lookup"><span data-stu-id="226e3-207">Request hello permissions from a directory admin</span></span>
<span data-ttu-id="226e3-208">Lorsque vous êtes prêt toorequest les autorisations de l’administrateur de votre organisation, vous pouvez rediriger hello utilisateur toohello v2.0 *point de terminaison admin consentement*.</span><span class="sxs-lookup"><span data-stu-id="226e3-208">When you're ready toorequest permissions from your organization's admin, you can redirect hello user toohello v2.0 *admin consent endpoint*.</span></span>

```
// Line breaks are for legibility only.

GET https://login.microsoftonline.com/{tenant}/adminconsent?
client_id=6731de76-14a6-49ae-97bc-6eba6914391e
&state=12345
&redirect_uri=http://localhost/myapp/permissions
```

```
// Pro tip: Try pasting hello below request in a browser!
```

```
https://login.microsoftonline.com/common/adminconsent?client_id=6731de76-14a6-49ae-97bc-6eba6914391e&state=12345&redirect_uri=http://localhost/myapp/permissions
```

| <span data-ttu-id="226e3-209">Paramètre</span><span class="sxs-lookup"><span data-stu-id="226e3-209">Parameter</span></span> | <span data-ttu-id="226e3-210">Condition</span><span class="sxs-lookup"><span data-stu-id="226e3-210">Condition</span></span> | <span data-ttu-id="226e3-211">Description</span><span class="sxs-lookup"><span data-stu-id="226e3-211">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="226e3-212">locataire</span><span class="sxs-lookup"><span data-stu-id="226e3-212">tenant</span></span> |<span data-ttu-id="226e3-213">Requis</span><span class="sxs-lookup"><span data-stu-id="226e3-213">Required</span></span> |<span data-ttu-id="226e3-214">locataire d’annuaire Hello toorequest autorisation souhaité.</span><span class="sxs-lookup"><span data-stu-id="226e3-214">hello directory tenant that you want toorequest permission from.</span></span> <span data-ttu-id="226e3-215">Peut être fourni au format GUID ou sous forme de nom convivial.</span><span class="sxs-lookup"><span data-stu-id="226e3-215">Can be provided in GUID or friendly name format.</span></span> |
| <span data-ttu-id="226e3-216">client_id</span><span class="sxs-lookup"><span data-stu-id="226e3-216">client_id</span></span> |<span data-ttu-id="226e3-217">Requis</span><span class="sxs-lookup"><span data-stu-id="226e3-217">Required</span></span> |<span data-ttu-id="226e3-218">Hello Application ID que hello [portail de l’enregistrement d’Application](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList) affecté tooyour application.</span><span class="sxs-lookup"><span data-stu-id="226e3-218">hello Application ID that hello [Application Registration Portal](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList) assigned tooyour app.</span></span> |
| <span data-ttu-id="226e3-219">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="226e3-219">redirect_uri</span></span> |<span data-ttu-id="226e3-220">Requis</span><span class="sxs-lookup"><span data-stu-id="226e3-220">Required</span></span> |<span data-ttu-id="226e3-221">Hello rediriger URI où vous souhaitez hello toobe de réponse envoyé pour toohandle de votre application.</span><span class="sxs-lookup"><span data-stu-id="226e3-221">hello redirect URI where you want hello response toobe sent for your app toohandle.</span></span> <span data-ttu-id="226e3-222">Il doit correspondre exactement à celle de la redirection de hello URI que vous avez enregistré dans le portail de l’enregistrement d’application hello.</span><span class="sxs-lookup"><span data-stu-id="226e3-222">It must exactly match one of hello redirect URIs that you registered in hello app registration portal.</span></span> |
| <span data-ttu-id="226e3-223">state</span><span class="sxs-lookup"><span data-stu-id="226e3-223">state</span></span> |<span data-ttu-id="226e3-224">Recommandé</span><span class="sxs-lookup"><span data-stu-id="226e3-224">Recommended</span></span> |<span data-ttu-id="226e3-225">Une valeur incluse dans la demande hello qui s’affichera dans la réponse du jeton hello.</span><span class="sxs-lookup"><span data-stu-id="226e3-225">A value included in hello request that will also be returned in hello token response.</span></span> <span data-ttu-id="226e3-226">Il peut s’agir d’une chaîne du contenu de votre choix.</span><span class="sxs-lookup"><span data-stu-id="226e3-226">It can be a string of any content you want.</span></span> <span data-ttu-id="226e3-227">Utilisez hello état tooencode d’informations sur l’état de l’utilisateur hello dans application hello avant de la demande d’authentification hello s’est produite, hello page ou un affichage qu’ils étaient sur.</span><span class="sxs-lookup"><span data-stu-id="226e3-227">Use hello state tooencode information about hello user's state in hello app before hello authentication request occurred, such as hello page or view they were on.</span></span> |

<span data-ttu-id="226e3-228">À ce stade, Azure AD nécessite une toosign d’administrateur client dans la demande toocomplete hello.</span><span class="sxs-lookup"><span data-stu-id="226e3-228">At this point, Azure AD requires a tenant administrator toosign in toocomplete hello request.</span></span> <span data-ttu-id="226e3-229">administrateur de Hello est demandé tooapprove que tous hello les autorisations que vous avez demandé pour votre application dans le portail de l’enregistrement d’application hello.</span><span class="sxs-lookup"><span data-stu-id="226e3-229">hello administrator is asked tooapprove all hello permissions that you have requested for your app in hello app registration portal.</span></span>

#### <a name="successful-response"></a><span data-ttu-id="226e3-230">Réponse correcte</span><span class="sxs-lookup"><span data-stu-id="226e3-230">Successful response</span></span>
<span data-ttu-id="226e3-231">Si hello administrateur approuve les autorisations hello pour votre application, la réponse correcte de hello ressemble à ceci :</span><span class="sxs-lookup"><span data-stu-id="226e3-231">If hello admin approves hello permissions for your app, hello successful response looks like this:</span></span>

```
GET http://localhost/myapp/permissions?tenant=a8990e1f-ff32-408a-9f8e-78d3b9139b95&state=state=12345&admin_consent=True
```

| <span data-ttu-id="226e3-232">Paramètre</span><span class="sxs-lookup"><span data-stu-id="226e3-232">Parameter</span></span> | <span data-ttu-id="226e3-233">Description</span><span class="sxs-lookup"><span data-stu-id="226e3-233">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="226e3-234">locataire</span><span class="sxs-lookup"><span data-stu-id="226e3-234">tenant</span></span> |<span data-ttu-id="226e3-235">locataire d’annuaire Hello qui a accordé les autorisations de hello de votre application il a demandées, au format GUID.</span><span class="sxs-lookup"><span data-stu-id="226e3-235">hello directory tenant that granted your application hello permissions it requested, in GUID format.</span></span> |
| <span data-ttu-id="226e3-236">state</span><span class="sxs-lookup"><span data-stu-id="226e3-236">state</span></span> |<span data-ttu-id="226e3-237">Une valeur incluse dans la demande hello qui sera également renvoyé dans la réponse du jeton hello.</span><span class="sxs-lookup"><span data-stu-id="226e3-237">A value included in hello request that also will be returned in hello token response.</span></span> <span data-ttu-id="226e3-238">Il peut s’agir d’une chaîne du contenu de votre choix.</span><span class="sxs-lookup"><span data-stu-id="226e3-238">It can be a string of any content you want.</span></span> <span data-ttu-id="226e3-239">l’état Hello est tooencode utilisé plus d’informations sur l’état de l’utilisateur hello dans application hello avant de la demande d’authentification hello s’est produite, page de hello ou un affichage qu’ils étaient sur.</span><span class="sxs-lookup"><span data-stu-id="226e3-239">hello state is used tooencode information about hello user's state in hello app before hello authentication request occurred, such as hello page or view they were on.</span></span> |
| <span data-ttu-id="226e3-240">admin_consent</span><span class="sxs-lookup"><span data-stu-id="226e3-240">admin_consent</span></span> |<span data-ttu-id="226e3-241">Est défini trop**true**.</span><span class="sxs-lookup"><span data-stu-id="226e3-241">Will be set too**true**.</span></span> |

#### <a name="error-response"></a><span data-ttu-id="226e3-242">Réponse d’erreur</span><span class="sxs-lookup"><span data-stu-id="226e3-242">Error response</span></span>
<span data-ttu-id="226e3-243">Si l’administrateur de hello n’approuve pas les autorisations hello pour votre application, hello a échoué présente de réponse comme suit :</span><span class="sxs-lookup"><span data-stu-id="226e3-243">If hello admin does not approve hello permissions for your app, hello failed response looks like this:</span></span>

```
GET http://localhost/myapp/permissions?error=permission_denied&error_description=The+admin+canceled+the+request
```

| <span data-ttu-id="226e3-244">Paramètre</span><span class="sxs-lookup"><span data-stu-id="226e3-244">Parameter</span></span> | <span data-ttu-id="226e3-245">Description</span><span class="sxs-lookup"><span data-stu-id="226e3-245">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="226e3-246">error</span><span class="sxs-lookup"><span data-stu-id="226e3-246">error</span></span> |<span data-ttu-id="226e3-247">Une chaîne de code d’erreur qui peut être utilisés tooclassify des types d’erreurs qui se produisent et peut être utilisé tooreact tooerrors.</span><span class="sxs-lookup"><span data-stu-id="226e3-247">An error code string that can be used tooclassify types of errors that occur, and can be used tooreact tooerrors.</span></span> |
| <span data-ttu-id="226e3-248">error_description</span><span class="sxs-lookup"><span data-stu-id="226e3-248">error_description</span></span> |<span data-ttu-id="226e3-249">Un message d’erreur spécifique qui permettre aider un développeur à identifier la cause de hello d’une erreur.</span><span class="sxs-lookup"><span data-stu-id="226e3-249">A specific error message that can help a developer identify hello root cause of an error.</span></span> |

<span data-ttu-id="226e3-250">Une fois que vous avez reçu une réponse correcte à partir de la terminaison de consentement admin hello, votre application a obtenu les autorisations hello qu'il demandé.</span><span class="sxs-lookup"><span data-stu-id="226e3-250">After you've received a successful response from hello admin consent endpoint, your app has gained hello permissions it requested.</span></span> <span data-ttu-id="226e3-251">Ensuite, vous pouvez demander un jeton de ressource hello souhaitée.</span><span class="sxs-lookup"><span data-stu-id="226e3-251">Next, you can request a token for hello resource you want.</span></span>

## <a name="using-permissions"></a><span data-ttu-id="226e3-252">Utilisation des autorisations</span><span class="sxs-lookup"><span data-stu-id="226e3-252">Using permissions</span></span>
<span data-ttu-id="226e3-253">Une fois que l’utilisateur de hello donne son consentement toopermissions pour votre application, votre application peut acquérir des jetons d’accès qui représentent les tooaccess d’autorisation de votre application une ressource dans une capacité.</span><span class="sxs-lookup"><span data-stu-id="226e3-253">After hello user consents toopermissions for your app, your app can acquire access tokens that represent your app's permission tooaccess a resource in some capacity.</span></span> <span data-ttu-id="226e3-254">Un jeton d’accès peut être utilisé uniquement pour une seule ressource, mais encodé dans le jeton d’accès hello est chaque autorisation que votre application a été accordée pour cette ressource.</span><span class="sxs-lookup"><span data-stu-id="226e3-254">An access token can be used only for a single resource, but encoded inside hello access token is every permission that your app has been granted for that resource.</span></span> <span data-ttu-id="226e3-255">tooacquire un jeton d’accès, votre application peut effectuer une demande toohello v2.0 jeton point de terminaison, comme suit :</span><span class="sxs-lookup"><span data-stu-id="226e3-255">tooacquire an access token, your app can make a request toohello v2.0 token endpoint, like this:</span></span>

```
POST common/oauth2/v2.0/token HTTP/1.1
Host: https://login.microsoftonline.com
Content-Type: application/json

{
    "grant_type": "authorization_code",
    "client_id": "6731de76-14a6-49ae-97bc-6eba6914391e",
    "scope": "https://outlook.office.com/mail.read https://outlook.office.com/mail.send",
    "code": "AwABAAAAvPM1KaPlrEqdFSBzjqfTGBCmLdgfSTLEMPGYuNHSUYBrq..."
    "redirect_uri": "https://localhost/myapp",
    "client_secret": "zc53fwe80980293klaj9823"  // NOTE: Only required for web apps
}
```

<span data-ttu-id="226e3-256">Vous pouvez utiliser le jeton d’accès obtenu hello dans la ressource de toohello de demandes HTTP.</span><span class="sxs-lookup"><span data-stu-id="226e3-256">You can use hello resulting access token in HTTP requests toohello resource.</span></span> <span data-ttu-id="226e3-257">Il indique fiable ressource toohello que votre application rencontre hello autorisation appropriée tooperform une tâche spécifique.</span><span class="sxs-lookup"><span data-stu-id="226e3-257">It reliably indicates toohello resource that your app has hello proper permission tooperform a specific task.</span></span>  

<span data-ttu-id="226e3-258">Pour plus d’informations sur hello OAuth 2.0, protocole et de jetons d’accès tooget, voir hello [référence de protocole de point de terminaison v2.0](active-directory-v2-protocols.md).</span><span class="sxs-lookup"><span data-stu-id="226e3-258">For more information about hello OAuth 2.0 protocol and how tooget access tokens, see hello [v2.0 endpoint protocol reference](active-directory-v2-protocols.md).</span></span>
