---
title: "aaaSingle l’authentification avec le Proxy d’Application | Documents Microsoft"
description: "Décrit comment tooprovide l’authentification unique à l’aide du Proxy d’Application Azure AD."
services: active-directory
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: ded0d9c9-45f6-47d7-bd0f-3f7fd99ab621
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/25/2017
ms.author: kgremban
ms.reviewer: harshja
ms.custom: H1Hack27Feb2017, it-pro
ms.openlocfilehash: 0047e834cd42e057a75ebc0c5dcf860734464a05
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="kerberos-constrained-delegation-for-single-sign-on-tooyour-apps-with-application-proxy"></a><span data-ttu-id="0508e-103">La délégation contrainte Kerberos pour les applications tooyour de l’authentification unique avec le Proxy d’Application</span><span class="sxs-lookup"><span data-stu-id="0508e-103">Kerberos Constrained Delegation for single sign-on tooyour apps with Application Proxy</span></span>

<span data-ttu-id="0508e-104">Vous pouvez fournir l’authentification unique pour les applications locales publiées via le proxy d’application et sécurisées avec l’authentification Windows intégrée.</span><span class="sxs-lookup"><span data-stu-id="0508e-104">You can provide single sign-on for on-premises applications published through Application Proxy that are secured with Integrated Windows Authentication.</span></span> <span data-ttu-id="0508e-105">L’accès à ces applications nécessitent un ticket Kerberos.</span><span class="sxs-lookup"><span data-stu-id="0508e-105">These applications require a Kerberos ticket for access.</span></span> <span data-ttu-id="0508e-106">Le Proxy d’application utilise la délégation Kerberos (KCD) toosupport ces applications.</span><span class="sxs-lookup"><span data-stu-id="0508e-106">Application Proxy uses Kerberos Constrained Delegation (KCD) toosupport these applications.</span></span> 

<span data-ttu-id="0508e-107">Vous pouvez activer les applications tooyour de l’authentification unique à l’aide de l’authentification Windows (intégrée) en attribuant l’autorisation de connecteurs de Proxy d’Application dans Active Directory tooimpersonate users.</span><span class="sxs-lookup"><span data-stu-id="0508e-107">You can enable single sign-on tooyour applications using Integrated Windows Authentication (IWA) by giving Application Proxy connectors permission in Active Directory tooimpersonate users.</span></span> <span data-ttu-id="0508e-108">les connecteurs Hello utilisent toosend de cette autorisation et recevoir des jetons en leur nom.</span><span class="sxs-lookup"><span data-stu-id="0508e-108">hello connectors use this permission toosend and receive tokens on their behalf.</span></span>

## <a name="how-single-sign-on-with-kcd-works"></a><span data-ttu-id="0508e-109">Fonctionnement de l’authentification unique avec KCD</span><span class="sxs-lookup"><span data-stu-id="0508e-109">How single sign-on with KCD works</span></span>
<span data-ttu-id="0508e-110">Ce diagramme explique le flux de hello lorsqu’un utilisateur tente de tooaccess une application locale qui utilise IWA.</span><span class="sxs-lookup"><span data-stu-id="0508e-110">This diagram explains hello flow when a user attempts tooaccess an on-prem application that uses IWA.</span></span>

![Diagramme de flux de l’authentification Microsoft AAD](./media/active-directory-application-proxy-sso-using-kcd/AuthDiagram.png)

1. <span data-ttu-id="0508e-112">utilisateur de Hello passe à l’application hello URL tooaccess hello local via le Proxy d’Application.</span><span class="sxs-lookup"><span data-stu-id="0508e-112">hello user enters hello URL tooaccess hello on-prem application through Application Proxy.</span></span>
2. <span data-ttu-id="0508e-113">Le Proxy d’application redirige hello demande tooAzure AD authentication services toopreauthenticate.</span><span class="sxs-lookup"><span data-stu-id="0508e-113">Application Proxy redirects hello request tooAzure AD authentication services toopreauthenticate.</span></span> <span data-ttu-id="0508e-114">À ce stade, Azure AD applique les stratégies d’authentification et d’autorisation applicables, comme l’authentification multifacteur.</span><span class="sxs-lookup"><span data-stu-id="0508e-114">At this point, Azure AD applies any applicable authentication and authorization policies, such as multifactor authentication.</span></span> <span data-ttu-id="0508e-115">Si l’utilisateur de hello est validé, Azure AD crée un jeton et l’envoie toohello utilisateur.</span><span class="sxs-lookup"><span data-stu-id="0508e-115">If hello user is validated, Azure AD creates a token and sends it toohello user.</span></span>
3. <span data-ttu-id="0508e-116">Hello passe tooApplication de jeton hello Proxy.</span><span class="sxs-lookup"><span data-stu-id="0508e-116">hello user passes hello token tooApplication Proxy.</span></span>
4. <span data-ttu-id="0508e-117">Le Proxy d’application valide le jeton de hello et récupère hello nom d’utilisateur Principal (UPN) à partir de celui-ci, et puis envoie hello demande hello UPN et hello toohello de nom de Principal du Service (SPN) connecteur via un canal sécurisé doublement authentifié.</span><span class="sxs-lookup"><span data-stu-id="0508e-117">Application Proxy validates hello token and retrieves hello User Principal Name (UPN) from it, and then sends hello request, hello UPN, and hello Service Principal Name (SPN) toohello Connector through a dually authenticated secure channel.</span></span>
5. <span data-ttu-id="0508e-118">Hello connecteur effectue une négociation de la délégation Kerberos (KCD) avec hello local AD, l’emprunt d’identité hello utilisateur tooget une application de toohello jeton Kerberos.</span><span class="sxs-lookup"><span data-stu-id="0508e-118">hello Connector performs Kerberos Constrained Delegation (KCD) negotiation with hello on-prem AD, impersonating hello user tooget a Kerberos token toohello application.</span></span>
6. <span data-ttu-id="0508e-119">Active Directory envoie le jeton Kerberos de hello pour hello application toohello connecteur.</span><span class="sxs-lookup"><span data-stu-id="0508e-119">Active Directory sends hello Kerberos token for hello application toohello Connector.</span></span>
7. <span data-ttu-id="0508e-120">Hello connecteur envoie hello d’origine demande toohello serveur d’applications, à l’aide du jeton Kerberos de hello que provenant d’AD.</span><span class="sxs-lookup"><span data-stu-id="0508e-120">hello Connector sends hello original request toohello application server, using hello Kerberos token it received from AD.</span></span>
8. <span data-ttu-id="0508e-121">application Hello envoie hello réponse toohello connecteur, qui est renvoyée au service de Proxy d’Application toohello et enfin toohello utilisateur.</span><span class="sxs-lookup"><span data-stu-id="0508e-121">hello application sends hello response toohello Connector, which is then returned toohello Application Proxy service and finally toohello user.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="0508e-122">Composants requis</span><span class="sxs-lookup"><span data-stu-id="0508e-122">Prerequisites</span></span>
<span data-ttu-id="0508e-123">Avant de commencer avec l’authentification unique pour les applications IWA, assurez-vous que votre environnement est prêt à hello suivant les paramètres et les configurations :</span><span class="sxs-lookup"><span data-stu-id="0508e-123">Before you get started with single sign-on for IWA applications, make sure your environment is ready with hello following settings and configurations:</span></span>

* <span data-ttu-id="0508e-124">Vos applications, telles que les applications SharePoint Web, sont définies toouse l’authentification Windows intégrée.</span><span class="sxs-lookup"><span data-stu-id="0508e-124">Your apps, like SharePoint Web apps, are set toouse Integrated Windows Authentication.</span></span> <span data-ttu-id="0508e-125">Pour plus d’informations, consultez [Activer la prise en charge de l’authentification Kerberos](https://technet.microsoft.com/library/dd759186.aspx) ou, pour SharePoint, consultez [Planifier l’authentification Kerberos dans SharePoint 2013](https://technet.microsoft.com/library/ee806870.aspx).</span><span class="sxs-lookup"><span data-stu-id="0508e-125">For more information, see [Enable Support for Kerberos Authentication](https://technet.microsoft.com/library/dd759186.aspx), or for SharePoint see [Plan for Kerberos authentication in SharePoint 2013](https://technet.microsoft.com/library/ee806870.aspx).</span></span>
* <span data-ttu-id="0508e-126">Toutes vos applications disposent de [Noms de principal du service](https://social.technet.microsoft.com/wiki/contents/articles/717.service-principal-names-spns-setspn-syntax-setspn-exe.aspx).</span><span class="sxs-lookup"><span data-stu-id="0508e-126">All your apps have [Service Principal Names](https://social.technet.microsoft.com/wiki/contents/articles/717.service-principal-names-spns-setspn-syntax-setspn-exe.aspx).</span></span>
* <span data-ttu-id="0508e-127">hello en cours d’exécution du serveur Hello connecteur et serveur hello application hello en cours d’exécution sont joints à un domaine et une partie de hello même domaine ou domaines autorisés à approuver.</span><span class="sxs-lookup"><span data-stu-id="0508e-127">hello server running hello Connector and hello server running hello app are domain joined and part of hello same domain or trusting domains.</span></span> <span data-ttu-id="0508e-128">Pour plus d’informations sur la jonction de domaine, consultez [joindre un domaine de tooa ordinateur](https://technet.microsoft.com/library/dd807102.aspx).</span><span class="sxs-lookup"><span data-stu-id="0508e-128">For more information on domain join, see [Join a Computer tooa Domain](https://technet.microsoft.com/library/dd807102.aspx).</span></span>
* <span data-ttu-id="0508e-129">serveur Hello hello connecteur possède un attribut TokenGroupsGlobalAndUniversal hello de tooread d’accès pour les utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="0508e-129">hello server running hello Connector has access tooread hello TokenGroupsGlobalAndUniversal attribute for users.</span></span> <span data-ttu-id="0508e-130">Ce paramètre par défaut peut avoir affecté par l’environnement de hello de renforcement de la sécurité.</span><span class="sxs-lookup"><span data-stu-id="0508e-130">This default setting might have been impacted by security hardening hello environment.</span></span>

### <a name="configure-active-directory"></a><span data-ttu-id="0508e-131">Configurer Active Directory</span><span class="sxs-lookup"><span data-stu-id="0508e-131">Configure Active Directory</span></span>
<span data-ttu-id="0508e-132">configuration d’Active Directory Hello varie, selon si votre connecteur de Proxy d’Application et le serveur d’applications hello sont dans hello même domaine ou non.</span><span class="sxs-lookup"><span data-stu-id="0508e-132">hello Active Directory configuration varies, depending on whether your Application Proxy connector and hello application server are in hello same domain or not.</span></span>

#### <a name="connector-and-application-server-in-hello-same-domain"></a><span data-ttu-id="0508e-133">Connecteur et serveur d’applications Bonjour même domaine</span><span class="sxs-lookup"><span data-stu-id="0508e-133">Connector and application server in hello same domain</span></span>
1. <span data-ttu-id="0508e-134">Dans Active Directory, accédez trop**outils** > **utilisateurs et ordinateurs**.</span><span class="sxs-lookup"><span data-stu-id="0508e-134">In Active Directory, go too**Tools** > **Users and Computers**.</span></span>
2. <span data-ttu-id="0508e-135">Sélectionnez serveur hello connecteur de hello en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="0508e-135">Select hello server running hello connector.</span></span>
3. <span data-ttu-id="0508e-136">Cliquez avec le bouton droit, puis sélectionnez **Properties** > **Délégation**.</span><span class="sxs-lookup"><span data-stu-id="0508e-136">Right-click and select **Properties** > **Delegation**.</span></span>
4. <span data-ttu-id="0508e-137">Sélectionnez **n’approuver cet ordinateur pour les services uniquement de délégation toospecified**.</span><span class="sxs-lookup"><span data-stu-id="0508e-137">Select **Trust this computer for delegation toospecified services only**.</span></span> 
5. <span data-ttu-id="0508e-138">Sous **Services toowhich ce compte peut présenter des informations d’identification déléguées** Ajouter valeur hello pour hello identité SPN hello du serveur d’applications.</span><span class="sxs-lookup"><span data-stu-id="0508e-138">Under **Services toowhich this account can present delegated credentials** add hello value for hello SPN identity of hello application server.</span></span> <span data-ttu-id="0508e-139">Ainsi, hello connecteur Proxy d’Application tooimpersonate les utilisateurs dans Active Directory par rapport aux applications hello définies dans la liste de hello.</span><span class="sxs-lookup"><span data-stu-id="0508e-139">This enables hello Application Proxy Connector tooimpersonate users in AD against hello applications defined in hello list.</span></span>

   ![Capture d’écran de la fenêtre Propriétés du connecteur-SVR](./media/active-directory-application-proxy-sso-using-kcd/Properties.jpg)

#### <a name="connector-and-application-server-in-different-domains"></a><span data-ttu-id="0508e-141">Le connecteur et le serveur d’application sont dans des domaines différents</span><span class="sxs-lookup"><span data-stu-id="0508e-141">Connector and application server in different domains</span></span>
1. <span data-ttu-id="0508e-142">Pour obtenir la liste des conditions préalables à l’utilisation de la délégation Kerberos contrainte entre domaines, consultez [Délégation Kerberos contrainte entre domaines](https://technet.microsoft.com/library/hh831477.aspx).</span><span class="sxs-lookup"><span data-stu-id="0508e-142">For a list of prerequisites for working with KCD across domains, see [Kerberos Constrained Delegation across domains](https://technet.microsoft.com/library/hh831477.aspx).</span></span>
2. <span data-ttu-id="0508e-143">Hello d’utilisation `principalsallowedtodelegateto` propriété sur le Proxy d’Application hello connecteur serveur tooenable hello toodelegate pour le serveur de connecteur hello.</span><span class="sxs-lookup"><span data-stu-id="0508e-143">Use hello `principalsallowedtodelegateto` property on hello Connector server tooenable hello Application Proxy toodelegate for hello Connector server.</span></span> <span data-ttu-id="0508e-144">serveur d’applications Hello `sharepointserviceaccount` et hello délégation du serveur est `connectormachineaccount`.</span><span class="sxs-lookup"><span data-stu-id="0508e-144">hello application server is `sharepointserviceaccount` and hello delegating server is `connectormachineaccount`.</span></span> <span data-ttu-id="0508e-145">Pour Windows 2012 R2, utilisez ce code comme exemple :</span><span class="sxs-lookup"><span data-stu-id="0508e-145">For Windows 2012 R2, use this code as an example:</span></span>

        $connector= Get-ADComputer -Identity connectormachineaccount -server dc.connectordomain.com

        Set-ADComputer -Identity sharepointserviceaccount -PrincipalsAllowedToDelegateToAccount $connector

        Get-ADComputer sharepointserviceaccount -Properties PrincipalsAllowedToDelegateToAccount

<span data-ttu-id="0508e-146">Sharepointserviceaccount peut être un compte de service sous le hello SPS pool d’applications est en cours d’exécution ou de compte d’ordinateur hello SPS.</span><span class="sxs-lookup"><span data-stu-id="0508e-146">Sharepointserviceaccount can be hello SPS machine account or a service account under which hello SPS app pool is running.</span></span>

## <a name="configure-single-sign-on"></a><span data-ttu-id="0508e-147">Configurer l’authentification unique</span><span class="sxs-lookup"><span data-stu-id="0508e-147">Configure single sign-on</span></span> 
1. <span data-ttu-id="0508e-148">Publier votre application en fonction des instructions toohello décrites dans [publier des applications avec Proxy d’Application](application-proxy-publish-azure-portal.md).</span><span class="sxs-lookup"><span data-stu-id="0508e-148">Publish your application according toohello instructions described in [Publish applications with Application Proxy](application-proxy-publish-azure-portal.md).</span></span> <span data-ttu-id="0508e-149">Assurez-vous que tooselect **Azure Active Directory** comme hello **méthode de pré-authentification**.</span><span class="sxs-lookup"><span data-stu-id="0508e-149">Make sure tooselect **Azure Active Directory** as hello **Preauthentication Method**.</span></span>
2. <span data-ttu-id="0508e-150">Une fois que votre application s’affiche dans la liste hello d’applications d’entreprise, sélectionnez-la et cliquez sur **l’authentification unique**.</span><span class="sxs-lookup"><span data-stu-id="0508e-150">After your application appears in hello list of enterprise applications, select it and click **Single sign-on**.</span></span>
3. <span data-ttu-id="0508e-151">Définir hello seul mode d’authentification trop**l’authentification Windows intégrée**.</span><span class="sxs-lookup"><span data-stu-id="0508e-151">Set hello single sign-on mode too**Integrated Windows Authentication**.</span></span>  
4. <span data-ttu-id="0508e-152">Entrez hello **SPN d’Application interne** hello serveur d’applications.</span><span class="sxs-lookup"><span data-stu-id="0508e-152">Enter hello **Internal Application SPN** of hello application server.</span></span> <span data-ttu-id="0508e-153">Dans cet exemple, hello SPN pour notre application publiée est http/www.contoso.com. Cette toobe de besoins SPN dans liste hello du connecteur de hello toowhich services peut présenter des informations d’identification déléguées.</span><span class="sxs-lookup"><span data-stu-id="0508e-153">In this example, hello SPN for our published application is http/www.contoso.com. This SPN needs toobe in hello list of services toowhich hello connector can present delegated credentials.</span></span> 
5. <span data-ttu-id="0508e-154">Choisissez hello **identité déléguée** pour toouse de connecteur hello pour le compte de vos utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="0508e-154">Choose hello **Delegated Login Identity** for hello connector toouse on behalf of your users.</span></span> <span data-ttu-id="0508e-155">Pour plus d’informations, consultez [Utilisation d’identités cloud et locales différentes](#Working-with-different-on-premises-and-cloud-identities)</span><span class="sxs-lookup"><span data-stu-id="0508e-155">For more information, see [Working with different on-premises and cloud identities](#Working-with-different-on-premises-and-cloud-identities)</span></span>

   ![Configuration avancée des applications](./media/active-directory-application-proxy-sso-using-kcd/cwap_auth2.png)  


## <a name="sso-for-non-windows-apps"></a><span data-ttu-id="0508e-157">Authentification unique pour les applications non Windows</span><span class="sxs-lookup"><span data-stu-id="0508e-157">SSO for non-Windows apps</span></span>
<span data-ttu-id="0508e-158">Hello flux de délégation contrainte Kerberos dans le Proxy d’Application Azure AD démarre lorsque Azure AD authentifie l’utilisateur hello dans le cloud de hello.</span><span class="sxs-lookup"><span data-stu-id="0508e-158">hello Kerberos delegation flow in Azure AD Application Proxy starts when Azure AD authenticates hello user in hello cloud.</span></span> <span data-ttu-id="0508e-159">Une fois la demande de hello arrive sur site, hello Proxy d’Application Azure Active Directory connector émet un ticket Kerberos pour le compte d’utilisateur de hello en interagissant avec hello Active Directory local.</span><span class="sxs-lookup"><span data-stu-id="0508e-159">Once hello request arrives on-premises, hello Azure AD Application Proxy connector issues a Kerberos ticket on behalf of hello user by interacting with hello local Active Directory.</span></span> <span data-ttu-id="0508e-160">Ce processus est tooas auxquels la délégation Kerberos (KCD).</span><span class="sxs-lookup"><span data-stu-id="0508e-160">This process is referred tooas Kerberos Constrained Delegation (KCD).</span></span> <span data-ttu-id="0508e-161">Bonjour la phase suivante, une demande est envoyée toohello l’application principale avec ce ticket Kerberos.</span><span class="sxs-lookup"><span data-stu-id="0508e-161">In hello next phase, a request is sent toohello backend application with this Kerberos ticket.</span></span> <span data-ttu-id="0508e-162">Il existe plusieurs protocoles qui définissent comment toosend ces demandes.</span><span class="sxs-lookup"><span data-stu-id="0508e-162">There are several protocols that define how toosend such requests.</span></span> <span data-ttu-id="0508e-163">La plupart des serveurs non Windows supposent qu’il s’agit de Negotiate/SPNego, qui est maintenant pris en charge sur le proxy d’application Azure AD.</span><span class="sxs-lookup"><span data-stu-id="0508e-163">Most non-Windows servers expect Negotiate/SPNego that is now supported on Azure AD Application Proxy.</span></span>

<span data-ttu-id="0508e-164">Pour plus d’informations sur Kerberos, consultez [vous souhaitez tooknow sur la délégation Kerberos (KCD)](https://blogs.technet.microsoft.com/applicationproxyblog/2015/09/21/all-you-want-to-know-about-kerberos-constrained-delegation-kcd).</span><span class="sxs-lookup"><span data-stu-id="0508e-164">For more information about Kerberos, see [All you want tooknow about Kerberos Constrained Delegation (KCD)](https://blogs.technet.microsoft.com/applicationproxyblog/2015/09/21/all-you-want-to-know-about-kerberos-constrained-delegation-kcd).</span></span>

<span data-ttu-id="0508e-165">Les applications non Windows utilisent en général les noms d’utilisateur ou les noms de compte SAM au lieu des adresses e-mail de domaine.</span><span class="sxs-lookup"><span data-stu-id="0508e-165">Non-Windows apps typically user usernames or SAM account names instead of domain email addresses.</span></span> <span data-ttu-id="0508e-166">Si cette situation s’applique tooyour applications, vous devez tooconfigure hello déléguée connexion identité champ tooconnect vos identités d’application cloud identités tooyour.</span><span class="sxs-lookup"><span data-stu-id="0508e-166">If that situation applies tooyour applications, you need tooconfigure hello delegated login identity field tooconnect your cloud identities tooyour application identities.</span></span> 

## <a name="working-with-different-on-premises-and-cloud-identities"></a><span data-ttu-id="0508e-167">Utilisation d’identités cloud et locales différentes</span><span class="sxs-lookup"><span data-stu-id="0508e-167">Working with different on-premises and cloud identities</span></span>
<span data-ttu-id="0508e-168">Le Proxy d’application part du principe que les utilisateurs ont exactement hello même identité dans le cloud de hello et sur site.</span><span class="sxs-lookup"><span data-stu-id="0508e-168">Application Proxy assumes that users have exactly hello same identity in hello cloud and on-premises.</span></span> <span data-ttu-id="0508e-169">Si tel n’est pas le cas de hello, vous pouvez peuvent toujours utiliser KCD pour l’authentification unique.</span><span class="sxs-lookup"><span data-stu-id="0508e-169">If that's not hello case, you can can still use KCD for single sign-on.</span></span> <span data-ttu-id="0508e-170">Configurer un **déléguée identité** pour chaque toospecify application quelle identité doit être utilisée lors de l’exécution de l’authentification unique.</span><span class="sxs-lookup"><span data-stu-id="0508e-170">Configure a **Delegated login identity** for each application toospecify which identity should be used when performing single sign-on.</span></span>  

<span data-ttu-id="0508e-171">Cette fonctionnalité permet à de nombreuses organisations qui ont des différents locaux et cloud identités toohave l’authentification unique à partir d’applications de site tooon hello cloud sans nécessiter de hello utilisateurs tooenter différents noms d’utilisateur et mots de passe.</span><span class="sxs-lookup"><span data-stu-id="0508e-171">This capability allows many organizations that have different on-premises and cloud identities toohave SSO from hello cloud tooon-premises apps without requiring hello users tooenter different usernames and passwords.</span></span> <span data-ttu-id="0508e-172">Cela inclut les organisations qui :</span><span class="sxs-lookup"><span data-stu-id="0508e-172">This includes organizations that:</span></span>

* <span data-ttu-id="0508e-173">Disposent de plusieurs domaines en interne (joe@us.contoso.com, joe@eu.contoso.com) et un domaine unique dans le cloud de hello (joe@contoso.com).</span><span class="sxs-lookup"><span data-stu-id="0508e-173">Have multiple domains internally (joe@us.contoso.com, joe@eu.contoso.com) and a single domain in hello cloud (joe@contoso.com).</span></span>
* <span data-ttu-id="0508e-174">Avoir le nom de domaine non routable en interne (joe@contoso.usa) et un juridique dans le cloud de hello.</span><span class="sxs-lookup"><span data-stu-id="0508e-174">Have non-routable domain name internally (joe@contoso.usa) and a legal one in hello cloud.</span></span>
* <span data-ttu-id="0508e-175">n’utilisent pas de noms de domaine en interne (joe) ;</span><span class="sxs-lookup"><span data-stu-id="0508e-175">Do not use domain names internally (joe)</span></span>
* <span data-ttu-id="0508e-176">Utilisez des alias différents localement et dans le cloud de hello.</span><span class="sxs-lookup"><span data-stu-id="0508e-176">Use different aliases on-prem and in hello cloud.</span></span> <span data-ttu-id="0508e-177">Par exemple, joe-johns@contoso.com et joej@contoso.com</span><span class="sxs-lookup"><span data-stu-id="0508e-177">For example, joe-johns@contoso.com vs. joej@contoso.com</span></span>  

<span data-ttu-id="0508e-178">Proxy d’Application, vous pouvez sélectionner le hello de tooobtain toouse identité ticket Kerberos.</span><span class="sxs-lookup"><span data-stu-id="0508e-178">With Application Proxy, you can select which identity toouse tooobtain hello Kerberos ticket.</span></span> <span data-ttu-id="0508e-179">Ce paramètre est à configurer application par application.</span><span class="sxs-lookup"><span data-stu-id="0508e-179">This setting is per application.</span></span> <span data-ttu-id="0508e-180">Certaines de ces options sont adaptées pour les systèmes qui n’acceptent pas le format d’adresse de messagerie, tandis que d’autres sont conçues pour les connexions alternatives.</span><span class="sxs-lookup"><span data-stu-id="0508e-180">Some of these options are suitable for systems that do not accept email address format, others are designed for alternative login.</span></span>

![Capture d’écran du paramètre Identité de connexion déléguée](./media/active-directory-application-proxy-sso-using-kcd/app_proxy_sso_diff_id_upn.png)

<span data-ttu-id="0508e-182">Si l’identité déléguée est utilisée, hello valeur ne peut pas être unique entre tous les domaines de hello ou les forêts de votre organisation.</span><span class="sxs-lookup"><span data-stu-id="0508e-182">If delegated login identity is used, hello value might not be unique across all hello domains or forests in your organization.</span></span> <span data-ttu-id="0508e-183">Vous pouvez éviter ce problème en publiant ces applications deux fois à l’aide de deux groupes de connecteurs différents.</span><span class="sxs-lookup"><span data-stu-id="0508e-183">You can avoid this issue by publishing these applications twice using two different Connector groups.</span></span> <span data-ttu-id="0508e-184">Étant donné que chaque application possède une audience utilisateur différent, vous pouvez joindre son domaine différent de tooa de connecteurs.</span><span class="sxs-lookup"><span data-stu-id="0508e-184">Since each application has a different user audience, you can join its Connectors tooa different domain.</span></span>

### <a name="configure-sso-for-different-identities"></a><span data-ttu-id="0508e-185">Configuration de l’authentification unique pour différentes identités</span><span class="sxs-lookup"><span data-stu-id="0508e-185">Configure SSO for different identities</span></span>
1. <span data-ttu-id="0508e-186">Configurer les paramètres d’Azure AD Connect identité principale de hello est l’adresse de messagerie hello (messagerie).</span><span class="sxs-lookup"><span data-stu-id="0508e-186">Configure Azure AD Connect settings so hello main identity is hello email address (mail).</span></span> <span data-ttu-id="0508e-187">Cette opération s’effectue comme partie de hello personnaliser le processus, en modifiant hello **nom d’utilisateur Principal** champ dans les paramètres de synchronisation hello.</span><span class="sxs-lookup"><span data-stu-id="0508e-187">This is done as part of hello customize process, by changing hello **User Principal Name** field in hello sync settings.</span></span> <span data-ttu-id="0508e-188">Ces paramètres déterminent également comment les utilisateurs du journal dans tooOffice365, les appareils Windows 10 Professionnel et d’autres applications qui utilisent Azure AD en tant que leur magasin d’identités.</span><span class="sxs-lookup"><span data-stu-id="0508e-188">These settings also determine how users log in tooOffice365, Windows10 devices, and other applications that use Azure AD as their identity store.</span></span>  
   <span data-ttu-id="0508e-189">![Capture d’écran de l’identification des utilisateurs : liste déroulante Nom d’utilisateur principal](./media/active-directory-application-proxy-sso-using-kcd/app_proxy_sso_diff_id_connect_settings.png)</span><span class="sxs-lookup"><span data-stu-id="0508e-189">![Identifying users screenshot - User Principal Name dropdown](./media/active-directory-application-proxy-sso-using-kcd/app_proxy_sso_diff_id_connect_settings.png)</span></span>  
2. <span data-ttu-id="0508e-190">Dans les paramètres de Configuration de l’Application hello pour une application hello vous aimeriez toomodify, sélectionnez hello **identité déléguée** toobe utilisé :</span><span class="sxs-lookup"><span data-stu-id="0508e-190">In hello Application Configuration settings for hello application you would like toomodify, select hello **Delegated Login Identity** toobe used:</span></span>

   * <span data-ttu-id="0508e-191">Nom d’utilisateur principal (par exemple, joe@contoso.com)</span><span class="sxs-lookup"><span data-stu-id="0508e-191">User Principal Name (for example, joe@contoso.com)</span></span>
   * <span data-ttu-id="0508e-192">Nom d’utilisateur principal alternatif (par exemple, joed@contoso.local)</span><span class="sxs-lookup"><span data-stu-id="0508e-192">Alternate User Principal Name (for example, joed@contoso.local)</span></span>
   * <span data-ttu-id="0508e-193">Partie correspondant au nom d’utilisateur dans le nom d’utilisateur principal (par exemple, joe)</span><span class="sxs-lookup"><span data-stu-id="0508e-193">Username part of User Principal Name (for example, joe)</span></span>
   * <span data-ttu-id="0508e-194">Partie correspondant au nom d’utilisateur dans le nom d’utilisateur principal alternatif (par exemple, joed)</span><span class="sxs-lookup"><span data-stu-id="0508e-194">Username part of Alternate User Principal Name (for example, joed)</span></span>
   * <span data-ttu-id="0508e-195">Nom de compte SAM local (dépend de la configuration du contrôleur de domaine hello)</span><span class="sxs-lookup"><span data-stu-id="0508e-195">On-premises SAM account name (depends on hello domain controller configuration)</span></span>

### <a name="troubleshooting-sso-for-different-identities"></a><span data-ttu-id="0508e-196">Résolution des problèmes liés à l’authentification unique pour différentes identités</span><span class="sxs-lookup"><span data-stu-id="0508e-196">Troubleshooting SSO for different identities</span></span>
<span data-ttu-id="0508e-197">S’il existe une erreur dans hello processus d’authentification unique, il apparaît dans le journal des événements hello connecteur ordinateur comme expliqué dans [dépannage](application-proxy-back-end-kerberos-constrained-delegation-how-to.md).</span><span class="sxs-lookup"><span data-stu-id="0508e-197">If there is an error in hello SSO process, it appears in hello connector machine event log as explained in [Troubleshooting](application-proxy-back-end-kerberos-constrained-delegation-how-to.md).</span></span>
<span data-ttu-id="0508e-198">Toutefois, dans certains cas, demande de hello est envoyée avec succès l’application principale toohello alors que cette application répond dans divers autres réponses HTTP.</span><span class="sxs-lookup"><span data-stu-id="0508e-198">But, in some cases, hello request is successfully sent toohello backend application while this application replies in various other HTTP responses.</span></span> <span data-ttu-id="0508e-199">Résolution des problèmes de ces cas doivent commencer en examinant le numéro d’événement 24029 sur l’ordinateur de connecteur hello dans le journal des événements session hello Proxy d’Application.</span><span class="sxs-lookup"><span data-stu-id="0508e-199">Troubleshooting these cases should start by examining event number 24029 on hello connector machine in hello Application Proxy session event log.</span></span> <span data-ttu-id="0508e-200">identité de l’utilisateur Hello qui a été utilisée pour la délégation s’affiche dans le champ « utilisateur » de hello dans les détails de l’événement hello.</span><span class="sxs-lookup"><span data-stu-id="0508e-200">hello user identity that was used for delegation appears in hello “user” field within hello event details.</span></span> <span data-ttu-id="0508e-201">tooturn sur le journal de session, sélectionnez **afficher d’analyse et les journaux de débogage** dans le menu Affichage de hello événements Observateur.</span><span class="sxs-lookup"><span data-stu-id="0508e-201">tooturn on session log, select **Show analytic and debug logs** in hello event viewer view menu.</span></span>

## <a name="next-steps"></a><span data-ttu-id="0508e-202">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="0508e-202">Next steps</span></span>

* [<span data-ttu-id="0508e-203">Comment tooconfigure un toouse d’application de Proxy d’Application la délégation contrainte Kerberos</span><span class="sxs-lookup"><span data-stu-id="0508e-203">How tooconfigure an Application Proxy application toouse Kerberos Constrained Delegation</span></span>](application-proxy-back-end-kerberos-constrained-delegation-how-to.md)
* [<span data-ttu-id="0508e-204">Résoudre les problèmes rencontrés avec le proxy d’application</span><span class="sxs-lookup"><span data-stu-id="0508e-204">Troubleshoot issues you're having with Application Proxy</span></span>](active-directory-application-proxy-troubleshoot.md)


<span data-ttu-id="0508e-205">Pour les informations les plus récentes hello et mises à jour, consultez hello [blog de Proxy d’Application](http://blogs.technet.com/b/applicationproxyblog/)</span><span class="sxs-lookup"><span data-stu-id="0508e-205">For hello latest news and updates, check out hello [Application Proxy blog](http://blogs.technet.com/b/applicationproxyblog/)</span></span>

