---
title: Archivage des journaux de diagnostic Azure | Microsoft Docs
description: "Découvrez comment archiver vos journaux de diagnostic Azure pour une conservation à long terme dans un compte de stockage."
author: johnkemnetz
manager: orenr
editor: 
services: monitoring-and-diagnostics
documentationcenter: monitoring-and-diagnostics
ms.assetid: 3a55c73f-2ef3-45f3-8956-bcf9c0cb7e05
ms.service: monitoring-and-diagnostics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/21/2017
ms.author: johnkem
ms.openlocfilehash: dbc5f89001dcb6cd1ab061cb0a9632e4e5d2c1c7
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/29/2017
---
# <a name="archive-azure-diagnostic-logs"></a><span data-ttu-id="5bd4e-103">Archivage des journaux de diagnostic Azure</span><span class="sxs-lookup"><span data-stu-id="5bd4e-103">Archive Azure Diagnostic Logs</span></span>
<span data-ttu-id="5bd4e-104">Dans cet article, nous vous expliquons comment utiliser le portail Azure, les applets de commande PowerShell, l’interface de ligne de commande ou l’API REST pour archiver vos [journaux de diagnostic Azure](monitoring-overview-of-diagnostic-logs.md) dans un compte de stockage.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-104">In this article, we show how you can use the Azure portal, PowerShell Cmdlets, CLI, or REST API to archive your [Azure diagnostic logs](monitoring-overview-of-diagnostic-logs.md) in a storage account.</span></span> <span data-ttu-id="5bd4e-105">Cette option est utile si vous voulez conserver vos journaux de diagnostic avec une stratégie de rétention facultative à des fins d’audit, d’analyse statique ou de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-105">This option is useful if you would like to retain your diagnostic logs with an optional retention policy for audit, static analysis, or backup.</span></span> <span data-ttu-id="5bd4e-106">Il n’est pas nécessaire que le compte de stockage se trouve dans le même abonnement que la ressource générant des journaux, à condition que l’utilisateur qui configure le paramètre ait un accès RBAC approprié aux deux abonnements.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-106">The storage account does not have to be in the same subscription as the resource emitting logs as long as the user who configures the setting has appropriate RBAC access to both subscriptions.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="5bd4e-107">Composants requis</span><span class="sxs-lookup"><span data-stu-id="5bd4e-107">Prerequisites</span></span>
<span data-ttu-id="5bd4e-108">Avant de commencer, vous devez [créer un compte de stockage](../storage/storage-create-storage-account.md) sur lequel vous pouvez archiver vos journaux de diagnostic.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-108">Before you begin, you need to [create a storage account](../storage/storage-create-storage-account.md) to which you can archive your diagnostic logs.</span></span> <span data-ttu-id="5bd4e-109">Nous vous recommandons vivement de ne pas utiliser un compte de stockage existant sur lequel sont stockées d’autres données de non-analyse, afin de pouvoir mieux contrôler l’accès aux données d’analyse.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-109">We highly recommend that you do not use an existing storage account that has other, non-monitoring data stored in it so that you can better control access to monitoring data.</span></span> <span data-ttu-id="5bd4e-110">En revanche, si vous archivez également votre journal d’activité et des métriques de diagnostic sur un compte de stockage, il peut être judicieux d’utiliser également ce compte pour vos journaux de diagnostic, afin de centraliser toutes vos données d’analyse.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-110">However, if you are also archiving your Activity Log and diagnostic metrics to a storage account, it may make sense to use that storage account for your diagnostic logs as well to keep all monitoring data in a central location.</span></span> <span data-ttu-id="5bd4e-111">Le compte de stockage que vous utilisez doit être un compte de stockage à usage général, et non un compte de stockage Blob.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-111">The storage account you use must be a general purpose storage account, not a blob storage account.</span></span>

## <a name="diagnostic-settings"></a><span data-ttu-id="5bd4e-112">Paramètres de diagnostic</span><span class="sxs-lookup"><span data-stu-id="5bd4e-112">Diagnostic settings</span></span>
<span data-ttu-id="5bd4e-113">Pour archiver vos journaux de diagnostic à l’aide de l’une des méthodes ci-dessous, vous devez définir un **paramètre de diagnostic** pour chaque ressource.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-113">To archive your diagnostic logs using any of the methods below, you set a **diagnostic setting** for a particular resource.</span></span> <span data-ttu-id="5bd4e-114">Un paramètre de diagnostic pour une ressource définit les catégories de journaux et les données métriques envoyées vers une destination (compte de stockage, espace de noms Event Hubs ou Log Analytics).</span><span class="sxs-lookup"><span data-stu-id="5bd4e-114">A diagnostic setting for a resource defines the categories of logs and metric data sent to a destination (storage account, Event Hubs namespace, or Log Analytics).</span></span> <span data-ttu-id="5bd4e-115">Il définit également la stratégie de rétention (nombre de jours de conservation) pour les événements de chaque catégorie de journal et de données métriques stockés dans un compte de stockage.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-115">It also defines the retention policy (number of days to retain) for events of each log category and metric data stored in a storage account.</span></span> <span data-ttu-id="5bd4e-116">Si la stratégie de rétention est définie sur zéro, les événements de cette catégorie de journal sont stockés indéfiniment (c’est-à-dire pour toujours).</span><span class="sxs-lookup"><span data-stu-id="5bd4e-116">If a retention policy is set to zero, events for that log category are stored indefinitely (that is to say, forever).</span></span> <span data-ttu-id="5bd4e-117">Une stratégie de rétention peut également être définie sur n’importe quel nombre de jours entre 1 et 2147483647.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-117">A retention policy can otherwise be any number of days between 1 and 2147483647.</span></span> <span data-ttu-id="5bd4e-118">[Vous trouverez plus d’informations sur les paramètres de diagnostic ici](monitoring-overview-of-diagnostic-logs.md#resource-diagnostic-settings).</span><span class="sxs-lookup"><span data-stu-id="5bd4e-118">[You can read more about diagnostic settings here](monitoring-overview-of-diagnostic-logs.md#resource-diagnostic-settings).</span></span> <span data-ttu-id="5bd4e-119">Les stratégies de rétention sont appliquées sur une base quotidienne. Donc, à la fin d’une journée (UTC), les journaux de la journée qui est désormais au-delà de la stratégie de rétention sont supprimés.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-119">Retention policies are applied per-day, so at the end of a day (UTC), logs from the day that is now beyond the retention policy will be deleted.</span></span> <span data-ttu-id="5bd4e-120">Par exemple, si vous aviez une stratégie de rétention d’une journée, au début de la journée d’aujourd’hui les journaux d’avant-hier seraient supprimés.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-120">For example, if you had a retention policy of one day, at the beginning of the day today the logs from the day before yesterday would be deleted</span></span>

## <a name="archive-diagnostic-logs-using-the-portal"></a><span data-ttu-id="5bd4e-121">Archivage des journaux de diagnostic à l’aide du portail</span><span class="sxs-lookup"><span data-stu-id="5bd4e-121">Archive diagnostic logs using the portal</span></span>
1. <span data-ttu-id="5bd4e-122">Dans le portail, accédez à Azure Monitor, puis cliquez sur **Paramètres de diagnostic**</span><span class="sxs-lookup"><span data-stu-id="5bd4e-122">In the portal, navigate to Azure Monitor and click on **Diagnostic Settings**</span></span>

    ![Section Surveillance d’Azure Monitor](media/monitoring-archive-diagnostic-logs/diagnostic-settings-blade.png)

2. <span data-ttu-id="5bd4e-124">Vous pouvez également filtrer la liste par type ou groupe de ressources, puis cliquez sur la ressource pour laquelle vous souhaitez définir un paramètre de diagnostic.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-124">Optionally filter the list by resource group or resource type, then click on the resource for which you would like to set a diagnostic setting.</span></span>

3. <span data-ttu-id="5bd4e-125">S’il n’existe aucun paramètre sur la ressource que vous avez sélectionnée, vous êtes invité à créer un paramètre.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-125">If no settings exist on the resource you have selected, you are prompted to create a setting.</span></span> <span data-ttu-id="5bd4e-126">Cliquez sur « Activer les diagnostics ».</span><span class="sxs-lookup"><span data-stu-id="5bd4e-126">Click "Turn on diagnostics."</span></span>

   ![Ajouter le paramètre de diagnostic - aucun paramètre existant](media/monitoring-archive-diagnostic-logs/diagnostic-settings-none.png)

   <span data-ttu-id="5bd4e-128">S’il existe des paramètres existants sur la ressource, vous verrez une liste de paramètres déjà configurés sur cette ressource.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-128">If there are existing settings on the resource, you will see a list of settings already configured on this resource.</span></span> <span data-ttu-id="5bd4e-129">Cliquez sur « Ajouter le paramètre de diagnostic ».</span><span class="sxs-lookup"><span data-stu-id="5bd4e-129">Click "Add diagnostic setting."</span></span>

   ![Ajouter le paramètre de diagnostic - paramètres existants](media/monitoring-archive-diagnostic-logs/diagnostic-settings-multiple.png)

3. <span data-ttu-id="5bd4e-131">Donnez un nom à votre paramètre et cochez la case **Exporter vers un compte de stockage**, puis sélectionnez un compte de stockage.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-131">Give your setting a name and check the box for **Export to Storage Account**, then select a storage account.</span></span> <span data-ttu-id="5bd4e-132">Si vous le souhaitez, vous pouvez également définir un nombre de jours de conservation de ces journaux à l’aide des curseurs **Rétention (jours)** .</span><span class="sxs-lookup"><span data-stu-id="5bd4e-132">Optionally, set a number of days to retain these logs by using the **Retention (days)** sliders.</span></span> <span data-ttu-id="5bd4e-133">Si la valeur zéro est appliquée à la rétention, les journaux sont stockés pour une durée indéfinie.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-133">A retention of zero days stores the logs indefinitely.</span></span>
   
   ![Ajouter le paramètre de diagnostic - paramètres existants](media/monitoring-archive-diagnostic-logs/diagnostic-settings-configure.png)
    
4. <span data-ttu-id="5bd4e-135">Cliquez sur **Enregistrer**.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-135">Click **Save**.</span></span>

<span data-ttu-id="5bd4e-136">Après quelques instants, le nouveau paramètre apparaît dans la liste des paramètres de cette ressource, et les journaux de diagnostic sont archivés dans ce compte de stockage dès que de nouvelles données d’événement sont générées.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-136">After a few moments, the new setting appears in your list of settings for this resource, and diagnostic logs are archived to that storage account as soon as new event data is generated.</span></span>

## <a name="archive-diagnostic-logs-via-azure-powershell"></a><span data-ttu-id="5bd4e-137">Archivage des journaux de diagnostic à l’aide d’Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="5bd4e-137">Archive diagnostic logs via Azure PowerShell</span></span>
```
Set-AzureRmDiagnosticSetting -ResourceId /subscriptions/s1id1234-5679-0123-4567-890123456789/resourceGroups/testresourcegroup/providers/Microsoft.Network/networkSecurityGroups/testnsg -StorageAccountId /subscriptions/s1id1234-5679-0123-4567-890123456789/resourceGroups/myrg1/providers/Microsoft.Storage/storageAccounts/my_storage -Categories networksecuritygroupevent,networksecuritygrouprulecounter -Enabled $true -RetentionEnabled $true -RetentionInDays 90
```

| <span data-ttu-id="5bd4e-138">Propriété</span><span class="sxs-lookup"><span data-stu-id="5bd4e-138">Property</span></span> | <span data-ttu-id="5bd4e-139">Requis</span><span class="sxs-lookup"><span data-stu-id="5bd4e-139">Required</span></span> | <span data-ttu-id="5bd4e-140">Description</span><span class="sxs-lookup"><span data-stu-id="5bd4e-140">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="5bd4e-141">ResourceId</span><span class="sxs-lookup"><span data-stu-id="5bd4e-141">ResourceId</span></span> |<span data-ttu-id="5bd4e-142">OUI</span><span class="sxs-lookup"><span data-stu-id="5bd4e-142">Yes</span></span> |<span data-ttu-id="5bd4e-143">ID de la ressource pour laquelle vous voulez définir un paramètre de diagnostic.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-143">Resource ID of the resource on which you want to set a diagnostic setting.</span></span> |
| <span data-ttu-id="5bd4e-144">StorageAccountId</span><span class="sxs-lookup"><span data-stu-id="5bd4e-144">StorageAccountId</span></span> |<span data-ttu-id="5bd4e-145">Non</span><span class="sxs-lookup"><span data-stu-id="5bd4e-145">No</span></span> |<span data-ttu-id="5bd4e-146">ID de ressource du compte de stockage dans lequel les journaux de diagnostic doivent être enregistrés.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-146">Resource ID of the Storage Account to which Diagnostic Logs should be saved.</span></span> |
| <span data-ttu-id="5bd4e-147">Catégories</span><span class="sxs-lookup"><span data-stu-id="5bd4e-147">Categories</span></span> |<span data-ttu-id="5bd4e-148">Non</span><span class="sxs-lookup"><span data-stu-id="5bd4e-148">No</span></span> |<span data-ttu-id="5bd4e-149">Liste séparée par des virgules des catégories de journaux à activer.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-149">Comma-separated list of log categories to enable.</span></span> |
| <span data-ttu-id="5bd4e-150">Activé</span><span class="sxs-lookup"><span data-stu-id="5bd4e-150">Enabled</span></span> |<span data-ttu-id="5bd4e-151">OUI</span><span class="sxs-lookup"><span data-stu-id="5bd4e-151">Yes</span></span> |<span data-ttu-id="5bd4e-152">Valeur booléenne indiquant si les diagnostics sont activés ou désactivés pour cette ressource.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-152">Boolean indicating whether diagnostics are enabled or disabled on this resource.</span></span> |
| <span data-ttu-id="5bd4e-153">RetentionEnabled</span><span class="sxs-lookup"><span data-stu-id="5bd4e-153">RetentionEnabled</span></span> |<span data-ttu-id="5bd4e-154">Non</span><span class="sxs-lookup"><span data-stu-id="5bd4e-154">No</span></span> |<span data-ttu-id="5bd4e-155">Valeur booléenne indiquant si une stratégie de rétention est activée pour cette ressource.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-155">Boolean indicating if a retention policy are enabled on this resource.</span></span> |
| <span data-ttu-id="5bd4e-156">RetentionInDays</span><span class="sxs-lookup"><span data-stu-id="5bd4e-156">RetentionInDays</span></span> |<span data-ttu-id="5bd4e-157">Non</span><span class="sxs-lookup"><span data-stu-id="5bd4e-157">No</span></span> |<span data-ttu-id="5bd4e-158">Nombre de jours pendant lesquels les événements doivent être conservés, compris entre 1 et 2147483647.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-158">Number of days for which events should be retained between 1 and 2147483647.</span></span> <span data-ttu-id="5bd4e-159">Une valeur de zéro signifie que les journaux seront stockés pour une durée indéfinie.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-159">A value of zero stores the logs indefinitely.</span></span> |

## <a name="archive-diagnostic-logs-via-the-cross-platform-cli"></a><span data-ttu-id="5bd4e-160">Archivage des journaux de diagnostic à l’aide de l’interface de ligne de commande multiplateforme</span><span class="sxs-lookup"><span data-stu-id="5bd4e-160">Archive diagnostic logs via the Cross-Platform CLI</span></span>
```
azure insights diagnostic set --resourceId /subscriptions/s1id1234-5679-0123-4567-890123456789/resourceGroups/testresourcegroup/providers/Microsoft.Network/networkSecurityGroups/testnsg --storageId /subscriptions/s1id1234-5679-0123-4567-890123456789/resourceGroups/myrg1/providers/Microsoft.Storage/storageAccounts/my_storage –categories networksecuritygroupevent,networksecuritygrouprulecounter --enabled true
```

| <span data-ttu-id="5bd4e-161">Propriété</span><span class="sxs-lookup"><span data-stu-id="5bd4e-161">Property</span></span> | <span data-ttu-id="5bd4e-162">Requis</span><span class="sxs-lookup"><span data-stu-id="5bd4e-162">Required</span></span> | <span data-ttu-id="5bd4e-163">Description</span><span class="sxs-lookup"><span data-stu-id="5bd4e-163">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="5bd4e-164">ResourceId</span><span class="sxs-lookup"><span data-stu-id="5bd4e-164">resourceId</span></span> |<span data-ttu-id="5bd4e-165">OUI</span><span class="sxs-lookup"><span data-stu-id="5bd4e-165">Yes</span></span> |<span data-ttu-id="5bd4e-166">ID de la ressource pour laquelle vous voulez définir un paramètre de diagnostic.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-166">Resource ID of the resource on which you want to set a diagnostic setting.</span></span> |
| <span data-ttu-id="5bd4e-167">storageId</span><span class="sxs-lookup"><span data-stu-id="5bd4e-167">storageId</span></span> |<span data-ttu-id="5bd4e-168">Non</span><span class="sxs-lookup"><span data-stu-id="5bd4e-168">No</span></span> |<span data-ttu-id="5bd4e-169">ID de ressource du compte de stockage dans lequel les journaux de diagnostic doivent être enregistrés.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-169">Resource ID of the Storage Account to which diagnostic logs should be saved.</span></span> |
| <span data-ttu-id="5bd4e-170">Catégories</span><span class="sxs-lookup"><span data-stu-id="5bd4e-170">categories</span></span> |<span data-ttu-id="5bd4e-171">Non</span><span class="sxs-lookup"><span data-stu-id="5bd4e-171">No</span></span> |<span data-ttu-id="5bd4e-172">Liste séparée par des virgules des catégories de journaux à activer.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-172">Comma-separated list of log categories to enable.</span></span> |
| <span data-ttu-id="5bd4e-173">Activé</span><span class="sxs-lookup"><span data-stu-id="5bd4e-173">enabled</span></span> |<span data-ttu-id="5bd4e-174">OUI</span><span class="sxs-lookup"><span data-stu-id="5bd4e-174">Yes</span></span> |<span data-ttu-id="5bd4e-175">Valeur booléenne indiquant si les diagnostics sont activés ou désactivés pour cette ressource.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-175">Boolean indicating whether diagnostics are enabled or disabled on this resource.</span></span> |

## <a name="archive-diagnostic-logs-via-the-rest-api"></a><span data-ttu-id="5bd4e-176">Archivage des journaux de diagnostic à l’aide de l’API REST</span><span class="sxs-lookup"><span data-stu-id="5bd4e-176">Archive diagnostic logs via the REST API</span></span>
<span data-ttu-id="5bd4e-177">[Consultez ce document](https://docs.microsoft.com/rest/api/monitor/servicediagnosticsettings) pour obtenir plus d’informations sur la configuration d’un paramètre de diagnostic à l’aide de l’API REST Azure Monitor.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-177">[See this document](https://docs.microsoft.com/rest/api/monitor/servicediagnosticsettings) for information on how you can set up a diagnostic setting using the Azure Monitor REST API.</span></span>

## <a name="schema-of-diagnostic-logs-in-the-storage-account"></a><span data-ttu-id="5bd4e-178">Schéma des journaux de diagnostic dans le compte de stockage</span><span class="sxs-lookup"><span data-stu-id="5bd4e-178">Schema of diagnostic logs in the storage account</span></span>
<span data-ttu-id="5bd4e-179">Une fois que vous avez configuré l’archivage, un conteneur de stockage est créé dans le compte de stockage dès qu’un événement se produit dans les catégories de journaux que vous avez activées.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-179">Once you have set up archival, a storage container is created in the storage account as soon as an event occurs in one of the log categories you have enabled.</span></span> <span data-ttu-id="5bd4e-180">Les objets blob au sein du conteneur suivent le même format dans les journaux de diagnostic et le journal d’activité.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-180">The blobs within the container follow the same format across Diagnostic Logs and the Activity Log.</span></span> <span data-ttu-id="5bd4e-181">La structure de ces objets blob est la suivante :</span><span class="sxs-lookup"><span data-stu-id="5bd4e-181">The structure of these blobs is:</span></span>

> <span data-ttu-id="5bd4e-182">insights-logs-{nom de la catégorie de journal}/resourceId=/SUBSCRIPTIONS/{ID d’abonnement}/RESOURCEGROUPS/{nom du groupe de ressources}/PROVIDERS/{nom du fournisseur de ressources}/{type de ressource}/{nom de la ressource}/y={année, quatre chiffres}/m={mois, deux chiffres}/d={jour, deux chiffres}/h={heure, deux chiffres, format 24 h}/m=00/PT1H.json</span><span class="sxs-lookup"><span data-stu-id="5bd4e-182">insights-logs-{log category name}/resourceId=/SUBSCRIPTIONS/{subscription ID}/RESOURCEGROUPS/{resource group name}/PROVIDERS/{resource provider name}/{resource type}/{resource name}/y={four-digit numeric year}/m={two-digit numeric month}/d={two-digit numeric day}/h={two-digit 24-hour clock hour}/m=00/PT1H.json</span></span>
> 
> 

<span data-ttu-id="5bd4e-183">Ou, plus simplement,</span><span class="sxs-lookup"><span data-stu-id="5bd4e-183">Or, more simply,</span></span>

> <span data-ttu-id="5bd4e-184">insights-logs-{nom de la catégorie de journal}/resourceId=/{ID de la ressource}/y={année, quatre chiffres}/m={mois, deux chiffres}/d={jour, deux chiffres}/h={heure, deux chiffres, format 24 h}/m=00/PT1H.json</span><span class="sxs-lookup"><span data-stu-id="5bd4e-184">insights-logs-{log category name}/resourceId=/{resource Id}/y={four-digit numeric year}/m={two-digit numeric month}/d={two-digit numeric day}/h={two-digit 24-hour clock hour}/m=00/PT1H.json</span></span>
> 
> 

<span data-ttu-id="5bd4e-185">Voici un exemple de nom d’objet blob :</span><span class="sxs-lookup"><span data-stu-id="5bd4e-185">For example, a blob name might be:</span></span>

> <span data-ttu-id="5bd4e-186">insights-logs-networksecuritygrouprulecounter/resourceId=/SUBSCRIPTIONS/s1id1234-5679-0123-4567-890123456789/RESOURCEGROUPS/TESTRESOURCEGROUP/PROVIDERS/MICROSOFT.NETWORK/NETWORKSECURITYGROUP/TESTNSG/y=2016/m=08/d=22/h=18/m=00/PT1H.json</span><span class="sxs-lookup"><span data-stu-id="5bd4e-186">insights-logs-networksecuritygrouprulecounter/resourceId=/SUBSCRIPTIONS/s1id1234-5679-0123-4567-890123456789/RESOURCEGROUPS/TESTRESOURCEGROUP/PROVIDERS/MICROSOFT.NETWORK/NETWORKSECURITYGROUP/TESTNSG/y=2016/m=08/d=22/h=18/m=00/PT1H.json</span></span>
> 
> 

<span data-ttu-id="5bd4e-187">Chaque objet blob PT1H.json contient un objet blob d’événements JSON qui se sont produits pendant l’heure spécifiée dans l’URL de l’objet blob (par exemple, h=12).</span><span class="sxs-lookup"><span data-stu-id="5bd4e-187">Each PT1H.json blob contains a JSON blob of events that occurred within the hour specified in the blob URL (for example, h=12).</span></span> <span data-ttu-id="5bd4e-188">Pendant l’heure en cours, les événements sont ajoutés au fichier PT1H.json à mesure qu’ils se produisent.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-188">During the present hour, events are appended to the PT1H.json file as they occur.</span></span> <span data-ttu-id="5bd4e-189">La valeur de minute (m = 00) est toujours 00, étant donné que les événements du journal de diagnostic sont répartis en différents objets blob par heure.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-189">The minute value (m=00) is always 00, since diagnostic log events are broken into individual blobs per hour.</span></span>

<span data-ttu-id="5bd4e-190">Dans le fichier PT1H.json, chaque événement est stocké dans le tableau « enregistrements », au format suivant :</span><span class="sxs-lookup"><span data-stu-id="5bd4e-190">Within the PT1H.json file, each event is stored in the “records” array, following this format:</span></span>

```
{
    "records": [
        {
            "time": "2016-07-01T00:00:37.2040000Z",
            "systemId": "46cdbb41-cb9c-4f3d-a5b4-1d458d827ff1",
            "category": "NetworkSecurityGroupRuleCounter",
            "resourceId": "/SUBSCRIPTIONS/s1id1234-5679-0123-4567-890123456789/RESOURCEGROUPS/TESTRESOURCEGROUP/PROVIDERS/MICROSOFT.NETWORK/NETWORKSECURITYGROUPS/TESTNSG",
            "operationName": "NetworkSecurityGroupCounters",
            "properties": {
                "vnetResourceGuid": "{12345678-9012-3456-7890-123456789012}",
                "subnetPrefix": "10.3.0.0/24",
                "macAddress": "000123456789",
                "ruleName": "/subscriptions/ s1id1234-5679-0123-4567-890123456789/resourceGroups/testresourcegroup/providers/Microsoft.Network/networkSecurityGroups/testnsg/securityRules/default-allow-rdp",
                "direction": "In",
                "type": "allow",
                "matchedConnections": 1988
            }
        }
    ]
}
```

| <span data-ttu-id="5bd4e-191">Nom de l'élément</span><span class="sxs-lookup"><span data-stu-id="5bd4e-191">Element name</span></span> | <span data-ttu-id="5bd4e-192">Description</span><span class="sxs-lookup"><span data-stu-id="5bd4e-192">Description</span></span> |
| --- | --- |
| <span data-ttu-id="5bd4e-193">time</span><span class="sxs-lookup"><span data-stu-id="5bd4e-193">time</span></span> |<span data-ttu-id="5bd4e-194">Horodatage lorsque l’événement a été généré par le service Azure traitant la demande correspondant à l’événement.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-194">Timestamp when the event was generated by the Azure service processing the request corresponding the event.</span></span> |
| <span data-ttu-id="5bd4e-195">resourceId</span><span class="sxs-lookup"><span data-stu-id="5bd4e-195">resourceId</span></span> |<span data-ttu-id="5bd4e-196">ID de ressource de la ressource affectée.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-196">Resource ID of the impacted resource.</span></span> |
| <span data-ttu-id="5bd4e-197">operationName</span><span class="sxs-lookup"><span data-stu-id="5bd4e-197">operationName</span></span> |<span data-ttu-id="5bd4e-198">Nom de l’opération.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-198">Name of the operation.</span></span> |
| <span data-ttu-id="5bd4e-199">category</span><span class="sxs-lookup"><span data-stu-id="5bd4e-199">category</span></span> |<span data-ttu-id="5bd4e-200">Catégorie de journal de l’événement.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-200">Log category of the event.</span></span> |
| <span data-ttu-id="5bd4e-201">properties</span><span class="sxs-lookup"><span data-stu-id="5bd4e-201">properties</span></span> |<span data-ttu-id="5bd4e-202">Jeu de paires `<Key, Value>` (p. ex. Dictionary) décrivant les détails de l’événement.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-202">Set of `<Key, Value>` pairs (i.e. Dictionary) describing the details of the event.</span></span> |

> [!NOTE]
> <span data-ttu-id="5bd4e-203">Les propriétés et l’utilisation de ces propriétés peuvent varier en fonction de la ressource.</span><span class="sxs-lookup"><span data-stu-id="5bd4e-203">The properties and usage of those properties can vary depending on the resource.</span></span>
> 
> 

## <a name="next-steps"></a><span data-ttu-id="5bd4e-204">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="5bd4e-204">Next steps</span></span>
* [<span data-ttu-id="5bd4e-205">Télécharger des objets blob pour analyse</span><span class="sxs-lookup"><span data-stu-id="5bd4e-205">Download blobs for analysis</span></span>](../storage/storage-dotnet-how-to-use-blobs.md)
* [<span data-ttu-id="5bd4e-206">Diffuser en continu les journaux de diagnostic sur un espace de noms Event Hubs</span><span class="sxs-lookup"><span data-stu-id="5bd4e-206">Stream diagnostic logs to an Event Hubs namespace</span></span>](monitoring-stream-diagnostic-logs-to-event-hubs.md)
* [<span data-ttu-id="5bd4e-207">En savoir plus sur les journaux de diagnostic</span><span class="sxs-lookup"><span data-stu-id="5bd4e-207">Read more about diagnostic logs</span></span>](monitoring-overview-of-diagnostic-logs.md)
