---
title: "Meilleures pratiques et guide de dépannage pour les applications node sur Azure Web Apps"
description: "Découvrez les meilleures pratiques et les procédures de dépannage pour les applications node sur Azure Web Apps."
services: app-service\web
documentationcenter: nodejs
author: ranjithr
manager: wadeh
editor: 
ms.assetid: 387ea217-7910-4468-8987-9a1022a99bef
ms.service: app-service-web
ms.workload: web
ms.tgt_pltfrm: na
ms.devlang: nodejs
ms.topic: article
ms.date: 06/06/2016
ms.author: ranjithr
ms.openlocfilehash: d820ef3438e13332657641b06b57fa277e79f811
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/29/2017
---
# <a name="best-practices-and-troubleshooting-guide-for-node-applications-on-azure-web-apps"></a><span data-ttu-id="7e501-103">Meilleures pratiques et guide de dépannage pour les applications node sur Azure Web Apps</span><span class="sxs-lookup"><span data-stu-id="7e501-103">Best practices and troubleshooting guide for node applications on Azure Web Apps</span></span>
[!INCLUDE [tabs](../../includes/app-service-web-get-started-nav-tabs.md)]

<span data-ttu-id="7e501-104">Cet article présente les meilleures pratiques et les procédures de dépannage pour les [applications node](app-service-web-get-started-nodejs.md) exécutées dans Azure Web Apps (avec [iisnode](https://github.com/azure/iisnode)).</span><span class="sxs-lookup"><span data-stu-id="7e501-104">In this article, you will learn the best practices and troubleshooting steps for [node applications](app-service-web-get-started-nodejs.md) running on Azure Webapps (with [iisnode](https://github.com/azure/iisnode)).</span></span>

> [!WARNING]
> <span data-ttu-id="7e501-105">Soyez vigilant lorsque vous appliquez ces étapes de dépannage sur votre site de production.</span><span class="sxs-lookup"><span data-stu-id="7e501-105">Use caution when using troubleshooting steps on your production site.</span></span> <span data-ttu-id="7e501-106">Il est recommandé de résoudre les problèmes de votre application sur une installation hors production (par exemple, votre emplacement intermédiaire) et, une fois le problème résolu, de remplacer votre emplacement intermédiaire par votre emplacement de production.</span><span class="sxs-lookup"><span data-stu-id="7e501-106">Recommendation is to troubleshoot your app on a non-production setup for example your staging slot and when the issue is fixed, swap your staging slot with your production slot.</span></span>
> 
> 

## <a name="iisnode-configuration"></a><span data-ttu-id="7e501-107">Configuration de IISNODE</span><span class="sxs-lookup"><span data-stu-id="7e501-107">IISNODE configuration</span></span>
<span data-ttu-id="7e501-108">Ce [fichier de schéma](https://github.com/Azure/iisnode/blob/master/src/config/iisnode_schema_x64.xml) affiche tous les paramètres qui peuvent être configurés pour iisnode.</span><span class="sxs-lookup"><span data-stu-id="7e501-108">This [schema file](https://github.com/Azure/iisnode/blob/master/src/config/iisnode_schema_x64.xml) shows all the settings that can be configured for iisnode.</span></span> <span data-ttu-id="7e501-109">Voici quelques paramètres qui peuvent être utiles pour votre application :</span><span class="sxs-lookup"><span data-stu-id="7e501-109">Some of the settings that will be useful for your application are:</span></span>

* <span data-ttu-id="7e501-110">nodeProcessCountPerApplication</span><span class="sxs-lookup"><span data-stu-id="7e501-110">nodeProcessCountPerApplication</span></span>
  
    <span data-ttu-id="7e501-111">Ce paramètre contrôle le nombre de processus de nœud qui seront lancés pour chaque application IIS.</span><span class="sxs-lookup"><span data-stu-id="7e501-111">This setting controls the number of node processes that are launched per IIS application.</span></span> <span data-ttu-id="7e501-112">La valeur par défaut est 1.</span><span class="sxs-lookup"><span data-stu-id="7e501-112">Default value is 1.</span></span> <span data-ttu-id="7e501-113">Vous pouvez lancer autant de fichiers node.exe que votre nombre de cœurs de machine virtuelle en définissant ce paramètre sur 0.</span><span class="sxs-lookup"><span data-stu-id="7e501-113">You can launch as many node.exe’s as your VM core count by setting this to 0.</span></span> <span data-ttu-id="7e501-114">La valeur recommandée est 0 pour la plupart des applications, ce qui signifie que vous pouvez utiliser tous les cœurs de votre machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="7e501-114">Recommended value is 0 for most application so you can utilize all of the cores on your machine.</span></span> <span data-ttu-id="7e501-115">Node.exe étant de type monothread, un seul node.exe consommera 1 cœur maximum. Pour optimiser les performances de votre application node, l’idéal est d’utiliser tous les cœurs.</span><span class="sxs-lookup"><span data-stu-id="7e501-115">Node.exe is single threaded so one node.exe will consume a maximum of 1 core and to get maximum performance out of your node application you would want to utilize all cores.</span></span>
* <span data-ttu-id="7e501-116">nodeProcessCommandLine</span><span class="sxs-lookup"><span data-stu-id="7e501-116">nodeProcessCommandLine</span></span>
  
    <span data-ttu-id="7e501-117">Ce paramètre contrôle le chemin d’accès à node.exe.</span><span class="sxs-lookup"><span data-stu-id="7e501-117">This setting controls the path to the node.exe.</span></span> <span data-ttu-id="7e501-118">Vous pouvez définir cette valeur pour pointer vers votre version node.exe.</span><span class="sxs-lookup"><span data-stu-id="7e501-118">You can set this value to point to your node.exe version.</span></span>
* <span data-ttu-id="7e501-119">maxConcurrentRequestsPerProcess</span><span class="sxs-lookup"><span data-stu-id="7e501-119">maxConcurrentRequestsPerProcess</span></span>
  
    <span data-ttu-id="7e501-120">Ce paramètre contrôle le nombre maximal de demandes simultanées envoyées par iisnode pour chaque node.exe.</span><span class="sxs-lookup"><span data-stu-id="7e501-120">This setting controls the maximum number of concurrent requests sent by iisnode to each node.exe.</span></span> <span data-ttu-id="7e501-121">Dans Azure Webapps, la valeur par défaut est « Infinite ».</span><span class="sxs-lookup"><span data-stu-id="7e501-121">On azure webapps, the default value for this is Infinite.</span></span> <span data-ttu-id="7e501-122">Vous n’avez pas à vous soucier de ce paramètre.</span><span class="sxs-lookup"><span data-stu-id="7e501-122">You will not have to worry about this setting.</span></span> <span data-ttu-id="7e501-123">En dehors d’Azure Webapps, la valeur par défaut est 1024.</span><span class="sxs-lookup"><span data-stu-id="7e501-123">Outside azure webapps, the default value is 1024.</span></span> <span data-ttu-id="7e501-124">Vous pouvez souhaiter configurer ce paramètre en fonction du nombre de requêtes dirigées vers votre application et de la vitesse à laquelle votre application traite chaque requête.</span><span class="sxs-lookup"><span data-stu-id="7e501-124">You might want to configure this depending on how many requests your application gets and how fast your application processes each request.</span></span>
* <span data-ttu-id="7e501-125">maxNamedPipeConnectionRetry</span><span class="sxs-lookup"><span data-stu-id="7e501-125">maxNamedPipeConnectionRetry</span></span>
  
    <span data-ttu-id="7e501-126">Ce paramètre contrôle le nombre maximal de tentatives de connexion effectuées par iisnode sur le canal nommé pour envoyer la requête à node.exe.</span><span class="sxs-lookup"><span data-stu-id="7e501-126">This setting controls the maximum number of times iisnode will retry making connection on the named pipe to send the request over to node.exe.</span></span> <span data-ttu-id="7e501-127">Ce paramètre, utilisé parallèlement au paramètre namedPipeConnectionRetryDelay, permet de déterminer le délai d’attente total de chaque requête dans iisnode.</span><span class="sxs-lookup"><span data-stu-id="7e501-127">This setting in combination with namedPipeConnectionRetryDelay determines the total timeout of each request within iisnode.</span></span> <span data-ttu-id="7e501-128">La valeur par défaut est 200 sur Azure Webapps.</span><span class="sxs-lookup"><span data-stu-id="7e501-128">Default value is 200 on Azure Webapps.</span></span> <span data-ttu-id="7e501-129">Délai total d’expiration en secondes = (maxNamedPipeConnectionRetry \* namedPipeConnectionRetryDelay) / 1 000</span><span class="sxs-lookup"><span data-stu-id="7e501-129">Total Timeout in seconds = (maxNamedPipeConnectionRetry \* namedPipeConnectionRetryDelay) / 1000</span></span>
* <span data-ttu-id="7e501-130">namedPipeConnectionRetryDelay</span><span class="sxs-lookup"><span data-stu-id="7e501-130">namedPipeConnectionRetryDelay</span></span>
  
    <span data-ttu-id="7e501-131">Ce paramètre contrôle la durée (en ms) d’attente que respectera iisnode entre chaque tentative d’envoi de la requête à node.exe via le canal nommé.</span><span class="sxs-lookup"><span data-stu-id="7e501-131">This setting controls the amount of time (in ms) iisnode will wait for between each retry to send request to node.exe over the named pipe.</span></span> <span data-ttu-id="7e501-132">La valeur par défaut est 250 ms.</span><span class="sxs-lookup"><span data-stu-id="7e501-132">Default value is 250ms.</span></span>
    <span data-ttu-id="7e501-133">Délai total d’expiration en secondes = (maxNamedPipeConnectionRetry \* namedPipeConnectionRetryDelay) / 1 000</span><span class="sxs-lookup"><span data-stu-id="7e501-133">Total Timeout in seconds = (maxNamedPipeConnectionRetry \* namedPipeConnectionRetryDelay) / 1000</span></span>
  
    <span data-ttu-id="7e501-134">Sur Azure Webapps, le délai total d’expiration dans iisnode est de 200 \* 250 ms = 50 secondes par défaut.</span><span class="sxs-lookup"><span data-stu-id="7e501-134">By default the total timeout in iisnode on azure webapps is 200 \* 250ms = 50 seconds.</span></span>
* <span data-ttu-id="7e501-135">logDirectory</span><span class="sxs-lookup"><span data-stu-id="7e501-135">logDirectory</span></span>
  
    <span data-ttu-id="7e501-136">Ce paramètre contrôle le répertoire dans lequel iisnode enregistrera stdout/stderr.</span><span class="sxs-lookup"><span data-stu-id="7e501-136">This setting controls the directory where iisnode will log stdout/stderr.</span></span> <span data-ttu-id="7e501-137">La valeur par défaut est iisnode ; cela se rapporte au répertoire de script principal, c’est-à-dire au répertoire qui contient le fichier server.js principal</span><span class="sxs-lookup"><span data-stu-id="7e501-137">Default value is iisnode which is relative to the main script directory (directory where main server.js is present)</span></span>
* <span data-ttu-id="7e501-138">debuggerExtensionDll</span><span class="sxs-lookup"><span data-stu-id="7e501-138">debuggerExtensionDll</span></span>
  
    <span data-ttu-id="7e501-139">Ce paramètre contrôle la version de node inspector qu’utilisera iisnode lors du débogage de votre application node.</span><span class="sxs-lookup"><span data-stu-id="7e501-139">This setting controls what version of node-inspector iisnode will use when debugging your node application.</span></span> <span data-ttu-id="7e501-140">Les versions iisnode-inspector-0.7.3.dll et iisnode-inspector.dll sont actuellement les deux seules valeurs valides pour ce paramètre.</span><span class="sxs-lookup"><span data-stu-id="7e501-140">Currently iisnode-inspector-0.7.3.dll and iisnode-inspector.dll are the only 2 valid values for this setting.</span></span> <span data-ttu-id="7e501-141">La valeur par défaut est iisnode-inspector 0.7.3.dll.</span><span class="sxs-lookup"><span data-stu-id="7e501-141">Default value is iisnode-inspector-0.7.3.dll.</span></span> <span data-ttu-id="7e501-142">La version iisnode-inspector 0.7.3.dll utilise node-inspecteur-0.7.3 et des WebSockets, ce qui signifie que vous devez activer les WebSockets sur votre instance Azure Webapps pour utiliser cette version.</span><span class="sxs-lookup"><span data-stu-id="7e501-142">iisnode-inspector-0.7.3.dll version uses node-inspector-0.7.3 and uses websockets, so you will need to enable websockets on your azure webapp to use this version.</span></span> <span data-ttu-id="7e501-143">Consultez <http://www.ranjithr.com/?p=98> pour plus d’informations sur la manière de configurer iisnode pour utiliser le nouveau node-inspector.</span><span class="sxs-lookup"><span data-stu-id="7e501-143">See <http://www.ranjithr.com/?p=98> for more details on how to configure iisnode to use the new node-inspector.</span></span>
* <span data-ttu-id="7e501-144">flushResponse</span><span class="sxs-lookup"><span data-stu-id="7e501-144">flushResponse</span></span>
  
    <span data-ttu-id="7e501-145">Par défaut, IIS met en mémoire tampon les données de réponse jusqu’à une limite de 4 Mo avant le vidage de la mémoire ou jusqu’à la fin de la réponse, selon la première occurrence.</span><span class="sxs-lookup"><span data-stu-id="7e501-145">The default behavior of IIS is that it buffers response data up to 4MB before flushing, or until the end of the response, whichever comes first.</span></span> <span data-ttu-id="7e501-146">iisnode offre un paramètre de configuration permettant de remplacer ce comportement : pour vider un fragment du corps d’entité réponse dès qu’iisnode le reçoit de node.exe, vous devez définir l’attribut iisnode/@flushResponse dans le fichier web.config sur « true » :</span><span class="sxs-lookup"><span data-stu-id="7e501-146">iisnode offers a configuration setting to override this behavior: to flush a fragment of the response entity body as soon as iisnode receives it from node.exe, you need to set the iisnode/@flushResponse attribute in web.config to 'true':</span></span>
  
    ```
    <configuration>    
        <system.webServer>    
            <!-- ... -->    
            <iisnode flushResponse="true" />    
        </system.webServer>    
    </configuration>
    ```
  
    <span data-ttu-id="7e501-147">L’activation du vidage de chaque fragment du corps de l’entité de réponse entraîne une dégradation des performances qui réduit le débit du système de l’ordre de ~ 5 % (à partir de la v0.1.13). Il est donc préférable de limiter ce paramètre uniquement aux points de terminaison qui requièrent une diffusion en continu des réponses (par exemple, à l’aide de l’élément <location> dans le fichier web.config)</span><span class="sxs-lookup"><span data-stu-id="7e501-147">Enabling flushing of every fragment of the response entity body adds performance overhead that reduces the throughput of the system by ~5% (as of v0.1.13), so it is best to scope this setting only to endpoints that require response streaming (e.g. using the <location> element in the web.config)</span></span>
  
    <span data-ttu-id="7e501-148">En outre, pour les applications de diffusion en continu, vous devez également définir le paramètre responseBufferLimit de votre gestionnaire iisnode sur 0.</span><span class="sxs-lookup"><span data-stu-id="7e501-148">In addition to this, for streaming applications, you will need to also set responseBufferLimit of your iisnode handler to 0.</span></span>
  
    ```
    <handlers>    
        <add name="iisnode" path="app.js" verb="\*" modules="iisnode" responseBufferLimit="0"/>    
    </handlers>
    ```
* <span data-ttu-id="7e501-149">watchedFiles</span><span class="sxs-lookup"><span data-stu-id="7e501-149">watchedFiles</span></span>
  
    <span data-ttu-id="7e501-150">Liste de fichiers séparés par des points-virgules dont les modifications feront l’objet d’une surveillance.</span><span class="sxs-lookup"><span data-stu-id="7e501-150">This is a semi-colon separated list of files that will be watched for changes.</span></span> <span data-ttu-id="7e501-151">Une modification apportée à un fichier entraînera un recyclage de l’application.</span><span class="sxs-lookup"><span data-stu-id="7e501-151">A change to a file causes the application to recycle.</span></span> <span data-ttu-id="7e501-152">Chaque entrée se compose d’un nom de répertoire facultatif, auquel s’ajoute le nom de fichier obligatoire. Ces noms dépendent du répertoire où se trouve le point d’entrée principal de l’application.</span><span class="sxs-lookup"><span data-stu-id="7e501-152">Each entry consists of an optional directory name plus required file name which are relative to the directory where the main application entry point is located.</span></span> <span data-ttu-id="7e501-153">Les caractères génériques sont autorisés uniquement dans la partie de nom de fichier.</span><span class="sxs-lookup"><span data-stu-id="7e501-153">Wild cards are allowed in the file name portion only.</span></span> <span data-ttu-id="7e501-154">La valeur par défaut est « \*. js;web.config ».</span><span class="sxs-lookup"><span data-stu-id="7e501-154">Default value is “\*.js;web.config”</span></span>
* <span data-ttu-id="7e501-155">recycleSignalEnabled</span><span class="sxs-lookup"><span data-stu-id="7e501-155">recycleSignalEnabled</span></span>
  
    <span data-ttu-id="7e501-156">La valeur par défaut est false.</span><span class="sxs-lookup"><span data-stu-id="7e501-156">Default value is false.</span></span> <span data-ttu-id="7e501-157">Si ce paramètre est activé, votre application node peut se connecter à un canal nommé (variable d’environnement IISNODE\_CONTROL\_PIPE) et envoyer un message de « recyclage ».</span><span class="sxs-lookup"><span data-stu-id="7e501-157">If enabled, your node application can connect to a named pipe (environment variable IISNODE\_CONTROL\_PIPE) and send a “recycle” message.</span></span> <span data-ttu-id="7e501-158">Le w3wp sera alors recyclé normalement.</span><span class="sxs-lookup"><span data-stu-id="7e501-158">This will cause the w3wp to recycle gracefully.</span></span>
* <span data-ttu-id="7e501-159">idlePageOutTimePeriod</span><span class="sxs-lookup"><span data-stu-id="7e501-159">idlePageOutTimePeriod</span></span>
  
    <span data-ttu-id="7e501-160">La valeur par défaut est 0, ce qui signifie que cette fonctionnalité est désactivée.</span><span class="sxs-lookup"><span data-stu-id="7e501-160">Default value is 0 which means this feature is disabled.</span></span> <span data-ttu-id="7e501-161">Si ce paramètre est défini sur une valeur supérieure à 0, iisnode effectuera un page-out sur tous ses processus enfants toutes les millisecondes « idlePageOutTimePeriod ».</span><span class="sxs-lookup"><span data-stu-id="7e501-161">When set to some value greater than 0, iisnode will page out all its child processes every ‘idlePageOutTimePeriod’ milliseconds.</span></span> <span data-ttu-id="7e501-162">Pour mieux comprendre le concept de page-out, reportez-vous à cette [documentation](https://msdn.microsoft.com/library/windows/desktop/ms682606.aspx).</span><span class="sxs-lookup"><span data-stu-id="7e501-162">To understand what page out means, please refer to this [documentation](https://msdn.microsoft.com/library/windows/desktop/ms682606.aspx).</span></span> <span data-ttu-id="7e501-163">Ce paramètre sera utile pour les applications qui consomment une grande quantité de mémoire et qui chercheront à déplacer occasionnellement des données de la mémoire vers le disque (page-out) pour libérer de la mémoire RAM.</span><span class="sxs-lookup"><span data-stu-id="7e501-163">This setting will be useful for applications that consume a lot of memory and want to pageout memory to disk occasionally to free up some RAM.</span></span>

> [!WARNING]
> <span data-ttu-id="7e501-164">Soyez vigilant lorsque vous activez les paramètres de configuration suivants sur les applications de production.</span><span class="sxs-lookup"><span data-stu-id="7e501-164">Use caution when enabling the following configuration settings on production applications.</span></span> <span data-ttu-id="7e501-165">Il est recommandé de ne pas les activer sur les applications de production en direct.</span><span class="sxs-lookup"><span data-stu-id="7e501-165">Recommendation is to not enable them on live production applications.</span></span>
> 
> 

* <span data-ttu-id="7e501-166">debugHeaderEnabled</span><span class="sxs-lookup"><span data-stu-id="7e501-166">debugHeaderEnabled</span></span>
  
    <span data-ttu-id="7e501-167">La valeur par défaut est false.</span><span class="sxs-lookup"><span data-stu-id="7e501-167">The default value is false.</span></span> <span data-ttu-id="7e501-168">Si la valeur true est définie, iisnode ajoute un en-tête de réponse HTTP iisnode-debug pour chaque réponse HTTP envoyée. La valeur d’en-tête iisnode-debug est une URL.</span><span class="sxs-lookup"><span data-stu-id="7e501-168">If set to true, iisnode will add an HTTP response header iisnode-debug to every HTTP response it sends the iisnode-debug header value is a URL.</span></span> <span data-ttu-id="7e501-169">Vous pouvez examiner le fragment d’URL pour obtenir des éléments d’informations de diagnostic, mais le mieux est d’ouvrir l’URL dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="7e501-169">Individual pieces of diagnostic information can be gleaned by looking at the URL fragment, but a much better visualization is achieved by opening the URL in the browser.</span></span>
* <span data-ttu-id="7e501-170">loggingEnabled</span><span class="sxs-lookup"><span data-stu-id="7e501-170">loggingEnabled</span></span>
  
    <span data-ttu-id="7e501-171">Ce paramètre contrôle la journalisation de stdout et stderr par iisnode.</span><span class="sxs-lookup"><span data-stu-id="7e501-171">This setting controls the logging of stdout and stderr by iisnode.</span></span> <span data-ttu-id="7e501-172">Iisnode récupère stdout/stderr à partir des processus node qu’il exécute et écrit dans le répertoire spécifié dans le paramètre « logDirectory ».</span><span class="sxs-lookup"><span data-stu-id="7e501-172">Iisnode will capture stdout/stderr from node processes it launches and write to the directory specified in the ‘logDirectory’ setting.</span></span> <span data-ttu-id="7e501-173">Une fois ce paramètre activé, votre application doit écrire les fichiers journaux dans le système de fichiers. Le niveau de journalisation exécuté par l’application peut avoir des conséquences sur les performances.</span><span class="sxs-lookup"><span data-stu-id="7e501-173">Once this is enable, your application will be writing logs to the file system and depending on the amount of logging done by the application, there could be performance implications.</span></span>
* <span data-ttu-id="7e501-174">devErrorsEnabled</span><span class="sxs-lookup"><span data-stu-id="7e501-174">devErrorsEnabled</span></span>
  
    <span data-ttu-id="7e501-175">La valeur par défaut est false.</span><span class="sxs-lookup"><span data-stu-id="7e501-175">Default value is false.</span></span> <span data-ttu-id="7e501-176">Lorsque la valeur est définie sur true, iisnode affiche le code d’état HTTP et le code d’erreur Win32 sur votre navigateur.</span><span class="sxs-lookup"><span data-stu-id="7e501-176">When set to true, iisnode will display the HTTP status code and Win32 error code on your browser.</span></span> <span data-ttu-id="7e501-177">Le code win32 sera utile lors du débogage de certains types de problèmes.</span><span class="sxs-lookup"><span data-stu-id="7e501-177">The win32 code will be helpful in debugging certain types of issues.</span></span>
* <span data-ttu-id="7e501-178">debuggingEnabled (ne pas activer ce paramètre sur un site de production en direct)</span><span class="sxs-lookup"><span data-stu-id="7e501-178">debuggingEnabled (do not enable on live production site)</span></span>
  
    <span data-ttu-id="7e501-179">Ce paramètre contrôle la fonctionnalité de débogage.</span><span class="sxs-lookup"><span data-stu-id="7e501-179">This setting controls debugging feature.</span></span> <span data-ttu-id="7e501-180">iisnode est intégré à node-inspector.</span><span class="sxs-lookup"><span data-stu-id="7e501-180">Iisnode is integrated with node-inspector.</span></span> <span data-ttu-id="7e501-181">En activant ce paramètre, vous activez le débogage de votre application node.</span><span class="sxs-lookup"><span data-stu-id="7e501-181">By enabling this setting, you enable debugging of your node application.</span></span> <span data-ttu-id="7e501-182">Une fois ce paramètre activé, iisnode place les fichiers node-inspector nécessaires dans le répertoire « debuggerVirtualDir » à la première demande de débogage transmise à votre application node.</span><span class="sxs-lookup"><span data-stu-id="7e501-182">Once this setting is enabled, iisnode will layout the necessary node-inspector files in ‘debuggerVirtualDir’ directory on the first debug request to your node application.</span></span> <span data-ttu-id="7e501-183">Vous pouvez charger le fichier node-inspector en envoyant une demande à l’adresse http://yoursite/server.js/debug.</span><span class="sxs-lookup"><span data-stu-id="7e501-183">You can load the node-inspector by sending a request to http://yoursite/server.js/debug.</span></span> <span data-ttu-id="7e501-184">Vous pouvez contrôler le segment d’URL de débogage à l’aide du paramètre « debuggerPathSegment ».</span><span class="sxs-lookup"><span data-stu-id="7e501-184">You can control the debug URL segment with ‘debuggerPathSegment’ setting.</span></span> <span data-ttu-id="7e501-185">Par défaut, debuggerPathSegment=’debug’.</span><span class="sxs-lookup"><span data-stu-id="7e501-185">By default debuggerPathSegment=’debug’.</span></span> <span data-ttu-id="7e501-186">Vous pouvez définir ce paramètre sur un GUID par exemple, afin qu’il soit plus difficilement découvrable par les autres utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="7e501-186">You can set this to a GUID for example so that it is more difficult to be discovered by others.</span></span>
  
    <span data-ttu-id="7e501-187">Consultez ce [lien](https://tomasz.janczuk.org/2011/11/debug-nodejs-applications-on-windows.html) pour plus d’informations sur le débogage.</span><span class="sxs-lookup"><span data-stu-id="7e501-187">Check this [link](https://tomasz.janczuk.org/2011/11/debug-nodejs-applications-on-windows.html) for more details on debugging.</span></span>

## <a name="scenarios-and-recommendationstroubleshooting"></a><span data-ttu-id="7e501-188">Scénarios et recommandations/résolution des pannes</span><span class="sxs-lookup"><span data-stu-id="7e501-188">Scenarios and recommendations/troubleshooting</span></span>
### <a name="my-node-application-is-making-too-many-outbound-calls"></a><span data-ttu-id="7e501-189">Mon application node émet trop d’appels sortants.</span><span class="sxs-lookup"><span data-stu-id="7e501-189">My node application is making too many outbound calls.</span></span>
<span data-ttu-id="7e501-190">La plupart des applications cherchent à établir des connexions sortantes dans le cadre de leur fonctionnement normal.</span><span class="sxs-lookup"><span data-stu-id="7e501-190">Many applications would want to make outbound connections as part of their regular operation.</span></span> <span data-ttu-id="7e501-191">Par exemple, à l’arrivée d’une requête, votre application node va chercher à contacter une API REST à un autre emplacement et à obtenir des informations afin de traiter cette requête.</span><span class="sxs-lookup"><span data-stu-id="7e501-191">For example, when a request comes in, your node app would want to contact a REST API elsewhere and get some information to process the request.</span></span> <span data-ttu-id="7e501-192">Vous pouvez utiliser un agent keep alive lors des appels http ou https.</span><span class="sxs-lookup"><span data-stu-id="7e501-192">You would want to use a keep alive agent when making http or https calls.</span></span> <span data-ttu-id="7e501-193">Par exemple, vous pouvez utiliser le module agentkeepalive en tant qu’agent keep alive lors de l’exécution de ces appels sortants.</span><span class="sxs-lookup"><span data-stu-id="7e501-193">For example, you could use the agentkeepalive module as your keep alive agent when making these outbound calls.</span></span> <span data-ttu-id="7e501-194">Cela permet de s’assurer que les sockets seront réutilisés sur votre machine virtuelle Azure Webapps, tout en réduisant la charge liée à la création de nouveaux sockets pour chaque requête sortante.</span><span class="sxs-lookup"><span data-stu-id="7e501-194">This makes sure that the sockets are reused on your azure webapp VM and reducing the overhead of creating new sockets for every outbound request.</span></span> <span data-ttu-id="7e501-195">En outre, cela vous permet d’utiliser moins de sockets pour exécuter de nombreuses requêtes sortantes, et donc ne pas dépasser la valeur maxSockets allouée par machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="7e501-195">Also, this makes sure that you are using less number of sockets to make many outbound requests and therefore you don’t exceed the maxSockets that are allocated per VM.</span></span> <span data-ttu-id="7e501-196">Sur Azure Webapps, il est recommandé de définir la valeur maxSockets du module agentKeepAlive sur un total de 160 sockets par machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="7e501-196">Recommendation on Azure Webapps would be to set the agentKeepAlive maxSockets value to a total of 160 sockets per VM.</span></span> <span data-ttu-id="7e501-197">Autrement dit, si vous avez 4 node.exe en cours d’exécution sur votre machine virtuelle, vous pourriez définir le paramètre maxSockets du module agentKeepAlive sur 40 par node.exe, soit un total de 160 par machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="7e501-197">This means that if you have 4 node.exe running on the VM, you would want to set the agentKeepAlive maxSockets to 40 per node.exe which is 160 total per VM.</span></span>

<span data-ttu-id="7e501-198">Exemple de configuration [d’agentKeepALive](https://www.npmjs.com/package/agentkeepalive) :</span><span class="sxs-lookup"><span data-stu-id="7e501-198">Example [agentKeepALive](https://www.npmjs.com/package/agentkeepalive) configuration:</span></span>

```
var keepaliveAgent = new Agent({    
    maxSockets: 40,    
    maxFreeSockets: 10,    
    timeout: 60000,    
    keepAliveTimeout: 300000    
});
```

<span data-ttu-id="7e501-199">Cet exemple suppose que 4 node.exe sont en cours d’exécution sur votre machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="7e501-199">This example assumes you have 4 node.exe running on your VM.</span></span> <span data-ttu-id="7e501-200">Si vous avez un nombre différent de node.exe en cours d’exécution sur la machine virtuelle, vous devez modifier le paramètre maxSockets en conséquence.</span><span class="sxs-lookup"><span data-stu-id="7e501-200">If you have a different number of node.exe running on the VM, you will have to modify the maxSockets setting accordingly.</span></span>

### <a name="my-node-application-is-consuming-too-much-cpu"></a><span data-ttu-id="7e501-201">Mon application node consomme trop de ressources processeur.</span><span class="sxs-lookup"><span data-stu-id="7e501-201">My node application is consuming too much CPU.</span></span>
<span data-ttu-id="7e501-202">Azure Webapps vous enverra probablement une recommandation sur votre portail concernant le niveau de consommation processeur considéré comme élevé.</span><span class="sxs-lookup"><span data-stu-id="7e501-202">You will probably get a recommendation from Azure Webapps on your portal about high cpu consumption.</span></span> <span data-ttu-id="7e501-203">Vous pouvez également configurer des analyses pour surveiller certaines [mesures](web-sites-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="7e501-203">You can also setup monitors to watch for certain [metrics](web-sites-monitor.md).</span></span> <span data-ttu-id="7e501-204">Lors de la vérification de l’utilisation du processeur sur le [tableau de bord du Portail Azure](../application-insights/app-insights-web-monitor-performance.md), veuillez vérifier les valeurs MAX de processeur afin d’éviter de passer à côté des pics de valeur.</span><span class="sxs-lookup"><span data-stu-id="7e501-204">When checking the CPU usage on the [Azure Portal Dashboard](../application-insights/app-insights-web-monitor-performance.md), please check the MAX values for CPU so you don’t miss out the peak values.</span></span>
<span data-ttu-id="7e501-205">Si vous pensez que votre application consomme trop de ressources processeur et que vous ne trouvez pas d’explication, vous devez profiler votre application node.</span><span class="sxs-lookup"><span data-stu-id="7e501-205">In cases where you think your application is consuming too much CPU and you cannot explain why, you will need to profile your node application.</span></span>

### 
#### <a name="profiling-your-node-application-on-azure-webapps-with-v8-profiler"></a><span data-ttu-id="7e501-206">Profilage de votre application node sur Azure Webapps à l’aide de V8-Profiler</span><span class="sxs-lookup"><span data-stu-id="7e501-206">Profiling your node application on azure webapps with V8-Profiler</span></span>
<span data-ttu-id="7e501-207">Par exemple, supposons que vous disposez d’une application hello world que vous souhaitez profiler comme indiqué ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="7e501-207">For example, lets say you have a hello world app that you want to profile as shown below:</span></span>

```
var http = require('http');    
function WriteConsoleLog() {    
    for(var i=0;i<99999;++i) {    
        console.log('hello world');    
    }    
}

function HandleRequest() {    
    WriteConsoleLog();    
}

http.createServer(function (req, res) {    
    res.writeHead(200, {'Content-Type': 'text/html'});    
    HandleRequest();    
    res.end('Hello world!');    
}).listen(process.env.PORT);
```

<span data-ttu-id="7e501-208">Accédez à votre site SCM : https://yoursite.scm.azurewebsites.net/DebugConsole</span><span class="sxs-lookup"><span data-stu-id="7e501-208">Go to your scm site https://yoursite.scm.azurewebsites.net/DebugConsole</span></span>

<span data-ttu-id="7e501-209">Vous accéder à une invite de commandes, comme indiqué ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="7e501-209">You will see a command prompt as shown below.</span></span> <span data-ttu-id="7e501-210">Allez dans votre répertoire site/wwwroot.</span><span class="sxs-lookup"><span data-stu-id="7e501-210">Go into your site/wwwroot directory</span></span>

![](./media/app-service-web-nodejs-best-practices-and-troubleshoot-guide/scm_install_v8.png)

<span data-ttu-id="7e501-211">Exécutez la commande « npm install v8-profiler »</span><span class="sxs-lookup"><span data-stu-id="7e501-211">Run the command “npm install v8-profiler”</span></span>

<span data-ttu-id="7e501-212">Le programme v8-profiler et toutes ses dépendances devraient s’installer sous le répertoire node\_modules.</span><span class="sxs-lookup"><span data-stu-id="7e501-212">This should install v8-profiler under node\_modules directory and all of its dependencies.</span></span>
<span data-ttu-id="7e501-213">À présent, modifiez votre fichier server.js pour profiler votre application.</span><span class="sxs-lookup"><span data-stu-id="7e501-213">Now, edit your server.js to profile your application.</span></span>

```
var http = require('http');    
var profiler = require('v8-profiler');    
var fs = require('fs');

function WriteConsoleLog() {    
    for(var i=0;i<99999;++i) {    
        console.log('hello world');    
    }    
}

function HandleRequest() {    
    profiler.startProfiling('HandleRequest');    
    WriteConsoleLog();    
    fs.writeFileSync('profile.cpuprofile', JSON.stringify(profiler.stopProfiling('HandleRequest')));    
}

http.createServer(function (req, res) {    
    res.writeHead(200, {'Content-Type': 'text/html'});    
    HandleRequest();    
    res.end('Hello world!');    
}).listen(process.env.PORT);
```

<span data-ttu-id="7e501-214">Les modifications ci-dessus permettront de profiler la fonction WriteConsoleLog, puis d’écrire la sortie du profil dans le fichier « profile.cpuprofile » sous le répertoire wwwroot de votre site.</span><span class="sxs-lookup"><span data-stu-id="7e501-214">The above changes will profile the WriteConsoleLog function and then write the profile output to ‘profile.cpuprofile’ file under your site wwwroot.</span></span> <span data-ttu-id="7e501-215">Envoyez une requête à votre application.</span><span class="sxs-lookup"><span data-stu-id="7e501-215">Send a request to your application.</span></span> <span data-ttu-id="7e501-216">Vous verrez qu’un fichier « profile.cpuprofile » a été créé sous le répertoire wwwroot de votre site.</span><span class="sxs-lookup"><span data-stu-id="7e501-216">You will see a ‘profile.cpuprofile’ file created under your site wwwroot.</span></span>

![](./media/app-service-web-nodejs-best-practices-and-troubleshoot-guide/scm_profile.cpuprofile.png)

<span data-ttu-id="7e501-217">Téléchargez ce fichier, que vous devrez ouvrir à l’aide des outils Chrome F12.</span><span class="sxs-lookup"><span data-stu-id="7e501-217">Download this file and you will need to open this file with Chrome F12 Tools.</span></span> <span data-ttu-id="7e501-218">Appuyez sur F12 dans Chrome, puis cliquez sur l’onglet « Profiles ».</span><span class="sxs-lookup"><span data-stu-id="7e501-218">Hit F12 on chrome, then click on the “Profiles Tab”.</span></span> <span data-ttu-id="7e501-219">Cliquez sur le bouton « Load ».</span><span class="sxs-lookup"><span data-stu-id="7e501-219">Click on “Load” Button.</span></span> <span data-ttu-id="7e501-220">Sélectionnez le fichier profile.cpuprofile que vous venez de télécharger.</span><span class="sxs-lookup"><span data-stu-id="7e501-220">Select your profile.cpuprofile file that you just downloaded.</span></span> <span data-ttu-id="7e501-221">Cliquez sur le profil que vous venez de télécharger.</span><span class="sxs-lookup"><span data-stu-id="7e501-221">Click on the profile you just loaded.</span></span>

![](./media/app-service-web-nodejs-best-practices-and-troubleshoot-guide/chrome_tools_view.png)

<span data-ttu-id="7e501-222">Vous verrez que 95 % du temps a été consommé par la fonction WriteConsoleLog, comme indiqué ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="7e501-222">You will see that 95% of the time was consumed by WriteConsoleLog function as shown below.</span></span> <span data-ttu-id="7e501-223">Cela vous montre également les numéros de ligne et les fichiers source qui sont à l’origine du problème.</span><span class="sxs-lookup"><span data-stu-id="7e501-223">This also shows you the exact line numbers and source files that cause the issue.</span></span>

### <a name="my-node-application-is-consuming-too-much-memory"></a><span data-ttu-id="7e501-224">Mon application node consomme trop de mémoire.</span><span class="sxs-lookup"><span data-stu-id="7e501-224">My node application is consuming too much memory.</span></span>
<span data-ttu-id="7e501-225">Azure Webapps vous enverra probablement une recommandation sur votre portail concernant le niveau de consommation de mémoire considéré comme élevé.</span><span class="sxs-lookup"><span data-stu-id="7e501-225">You will probably get a recommendation from Azure Webapps on your portal about high memory consumption.</span></span> <span data-ttu-id="7e501-226">Vous pouvez également configurer des analyses pour surveiller certaines [mesures](web-sites-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="7e501-226">You can also setup monitors to watch for certain [metrics](web-sites-monitor.md).</span></span> <span data-ttu-id="7e501-227">Lors de la vérification de l’utilisation de mémoire sur le [tableau de bord du Portail Azure](../application-insights/app-insights-web-monitor-performance.md), veuillez vérifier les valeurs MAX de la mémoire afin d’éviter de passer à côté des pics de valeur.</span><span class="sxs-lookup"><span data-stu-id="7e501-227">When checking the memory usage on the [Azure Portal Dashboard](../application-insights/app-insights-web-monitor-performance.md), please check the MAX values for memory so you don’t miss out the peak values.</span></span>

#### <a name="leak-detection-and-heap-diffing-for-nodejs"></a><span data-ttu-id="7e501-228">Détection des fuites et procédure de heap diffing pour node.js</span><span class="sxs-lookup"><span data-stu-id="7e501-228">Leak detection and Heap Diffing for node.js</span></span>
<span data-ttu-id="7e501-229">Vous pouvez utiliser [node-memwatch](https://github.com/lloyd/node-memwatch) pour vous aider à identifier les fuites de mémoire.</span><span class="sxs-lookup"><span data-stu-id="7e501-229">You could use [node-memwatch](https://github.com/lloyd/node-memwatch) to help you identify memory leaks.</span></span>
<span data-ttu-id="7e501-230">Vous pouvez installer memwatch en suivant la même procédure que pour v8-profiler et modifier votre code pour capturer et comparer les tas afin d’identifier les fuites de mémoire dans votre application.</span><span class="sxs-lookup"><span data-stu-id="7e501-230">You can install memwatch just like v8-profiler and edit your code to capture and diff heaps to identify the memory leaks in your application.</span></span>

### <a name="my-nodeexes-are-getting-killed-randomly"></a><span data-ttu-id="7e501-231">Mes fichiers node.exe sont arrêtés de façon aléatoire</span><span class="sxs-lookup"><span data-stu-id="7e501-231">My node.exe’s are getting killed randomly</span></span>
<span data-ttu-id="7e501-232">Cette situation peut avoir diverses raisons :</span><span class="sxs-lookup"><span data-stu-id="7e501-232">There are a few reasons why this could be happening:</span></span>

1. <span data-ttu-id="7e501-233">Votre application lève des exceptions non interceptées ; consultez le fichier d:\\home\\LogFiles\\Application\\logging-errors.txt pour obtenir plus d’informations sur l’exception levée.</span><span class="sxs-lookup"><span data-stu-id="7e501-233">Your application is throwing uncaught exceptions – Please check d:\\home\\LogFiles\\Application\\logging-errors.txt file for the details on the exception thrown.</span></span> <span data-ttu-id="7e501-234">Ce fichier contient l’arborescence des appels de procédure qui vous permet de corriger votre application.</span><span class="sxs-lookup"><span data-stu-id="7e501-234">This file has the stack trace so you can fix your application based on this.</span></span>
2. <span data-ttu-id="7e501-235">Votre application consomme trop de mémoire, ce qui affecte le démarrage des autres processus.</span><span class="sxs-lookup"><span data-stu-id="7e501-235">Your application is consuming too much memory which is affecting other processes from getting started.</span></span> <span data-ttu-id="7e501-236">Si la mémoire totale de la machine virtuelle est proche de 100 %, votre node.exe risque d’être arrêté par le Gestionnaire de processus afin de laisser aux autres processus l’occasion d’exécuter une tâche.</span><span class="sxs-lookup"><span data-stu-id="7e501-236">If the total VM memory is close to 100%, your node.exe’s could be killed by the process manager to let other processes get a chance to do some work.</span></span> <span data-ttu-id="7e501-237">Pour résoudre ce problème, vérifiez l’absence de fuite de mémoire au niveau de votre application OU, si votre application a réellement besoin d’une grande quantité de mémoire, basculez vers une plus grande machine virtuelle comportant une capacité de RAM supérieure.</span><span class="sxs-lookup"><span data-stu-id="7e501-237">To fix this, either make sure your application is not leaking memory OR if you application really needs to use a lot of memory, please scale up to a larger VM with a lot more RAM.</span></span>

### <a name="my-node-application-does-not-start"></a><span data-ttu-id="7e501-238">Mon application node ne démarre pas</span><span class="sxs-lookup"><span data-stu-id="7e501-238">My node application does not start</span></span>
<span data-ttu-id="7e501-239">Si votre application renvoie des erreurs 500 au démarrage, plusieurs raisons peuvent expliquer ce phénomène :</span><span class="sxs-lookup"><span data-stu-id="7e501-239">If your application is returning 500 Errors at startup, there could be a few reasons:</span></span>

1. <span data-ttu-id="7e501-240">Le fichier node.exe ne se trouve pas à l’emplacement correct.</span><span class="sxs-lookup"><span data-stu-id="7e501-240">Node.exe is not present at the correct location.</span></span> <span data-ttu-id="7e501-241">Vérifiez le paramètre nodeProcessCommandLine.</span><span class="sxs-lookup"><span data-stu-id="7e501-241">Check nodeProcessCommandLine setting.</span></span>
2. <span data-ttu-id="7e501-242">Le fichier de script principal ne se trouve pas à l’emplacement correct.</span><span class="sxs-lookup"><span data-stu-id="7e501-242">Main script file is not present at the correct location.</span></span> <span data-ttu-id="7e501-243">Vérifiez le fichier web.config et assurez-vous que le nom du fichier de script principal dans la section des gestionnaires correspond au fichier de script principal.</span><span class="sxs-lookup"><span data-stu-id="7e501-243">Check web.config and make sure the name of the main script file in the handlers section matches the main script file.</span></span>
3. <span data-ttu-id="7e501-244">La configuration du fichier web.config est incorrecte : vérifiez les noms et les valeurs des paramètres.</span><span class="sxs-lookup"><span data-stu-id="7e501-244">Web.config configuration is not correct – check the settings names/values.</span></span>
4. <span data-ttu-id="7e501-245">Démarrage à froid : votre application prend trop de temps à démarrer.</span><span class="sxs-lookup"><span data-stu-id="7e501-245">Cold Start – Your application is taking too long to startup.</span></span> <span data-ttu-id="7e501-246">Si votre application met plus de (maxNamedPipeConnectionRetry \* namedPipeConnectionRetryDelay) / 1 000 secondes à démarrer, iisnode renvoie une erreur 500.</span><span class="sxs-lookup"><span data-stu-id="7e501-246">If your application takes longer than (maxNamedPipeConnectionRetry \* namedPipeConnectionRetryDelay) / 1000 seconds, iisnode will return 500 error.</span></span> <span data-ttu-id="7e501-247">Augmentez les valeurs de ces paramètres pour correspondre à l’heure de début de votre application afin d’éviter qu’iisnode dépasse le délai d’expiration et retourne une erreur 500.</span><span class="sxs-lookup"><span data-stu-id="7e501-247">Increase the values of these settings to match your application start time to prevent iisnode from timing out and returning the 500 error.</span></span>

### <a name="my-node-application-crashed"></a><span data-ttu-id="7e501-248">Mon application node a planté</span><span class="sxs-lookup"><span data-stu-id="7e501-248">My node application crashed</span></span>
<span data-ttu-id="7e501-249">Votre application lève des exceptions non interceptées ; consultez le fichier d:\\home\\LogFiles\\Application\\logging-errors.txt pour obtenir plus d’informations sur l’exception levée.</span><span class="sxs-lookup"><span data-stu-id="7e501-249">Your application is throwing uncaught exceptions – Please check d:\\home\\LogFiles\\Application\\logging-errors.txt file for the details on the exception thrown.</span></span> <span data-ttu-id="7e501-250">Ce fichier contient l’arborescence des appels de procédure qui vous permet de corriger votre application.</span><span class="sxs-lookup"><span data-stu-id="7e501-250">This file has the stack trace so you can fix your application based on this.</span></span>

### <a name="my-node-application-takes-too-much-time-to-startup-cold-start"></a><span data-ttu-id="7e501-251">Mon application node prend trop de temps au démarrage (démarrage à froid)</span><span class="sxs-lookup"><span data-stu-id="7e501-251">My node application takes too much time to startup (Cold Start)</span></span>
<span data-ttu-id="7e501-252">Ce problème est le plus souvent lié au fait que l’application possède un grand nombre de fichiers dans node\_modules et essaie de charger la plupart de ces fichiers au démarrage.</span><span class="sxs-lookup"><span data-stu-id="7e501-252">Most common reason for this is that the application has a lot of files in the node\_modules and the application tries to load most of these files during startup.</span></span> <span data-ttu-id="7e501-253">Par défaut, puisque vos fichiers résident sur le partage réseau dans Azure Webapps, le chargement d’un si grand nombre de fichiers peut prendre un certain temps.</span><span class="sxs-lookup"><span data-stu-id="7e501-253">By default, since your files reside on the network share on Azure Webapps, loading so many files can take some time.</span></span>
<span data-ttu-id="7e501-254">Voici quelques solutions qui pourront vous aider à accélérer le processus :</span><span class="sxs-lookup"><span data-stu-id="7e501-254">Some solutions to make this faster are:</span></span>

1. <span data-ttu-id="7e501-255">Utilisez npm3 pour installer vos modules de manière à avoir une structure de dépendances plate et à éviter toute dépendance en double.</span><span class="sxs-lookup"><span data-stu-id="7e501-255">Make sure you have a flat dependency structure and no duplicate dependencies by using npm3 to install your modules.</span></span>
2. <span data-ttu-id="7e501-256">Essayez de charger progressivement votre node\_modules plutôt que de charger tous les modules au démarrage.</span><span class="sxs-lookup"><span data-stu-id="7e501-256">Try to lazy load your node\_modules and not load all of the modules at startup.</span></span> <span data-ttu-id="7e501-257">Cela signifie que vous devez appeler require('module') lorsque vous en avez réellement besoin dans la fonction que vous testez pour utiliser le module.</span><span class="sxs-lookup"><span data-stu-id="7e501-257">This means that the call to require(‘module’) should be done when you actually need it within the function you try to use the module.</span></span>
3. <span data-ttu-id="7e501-258">Azure Webapps offre une fonctionnalité dite de « cache local ».</span><span class="sxs-lookup"><span data-stu-id="7e501-258">Azure Webapps offers a feature called local cache.</span></span> <span data-ttu-id="7e501-259">Cette fonctionnalité copie le contenu du partage réseau sur le disque local de la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="7e501-259">This feature copies your content from the network share to the local disk on the VM.</span></span> <span data-ttu-id="7e501-260">Étant donné que les fichiers sont en local, le temps de chargement du node\_modules est beaucoup plus rapide.</span><span class="sxs-lookup"><span data-stu-id="7e501-260">Since the files are local, the load time of node\_modules is much faster.</span></span> <span data-ttu-id="7e501-261">-Cette [documentation](../app-service/app-service-local-cache.md) explique de façon plus détaillée comment utiliser la fonctionnalité de cache local.</span><span class="sxs-lookup"><span data-stu-id="7e501-261">- This [documentation](../app-service/app-service-local-cache.md) explains how to use Local Cache in more detail.</span></span>

## <a name="iisnode-http-status-and-substatus"></a><span data-ttu-id="7e501-262">État et sous-état http IISNODE</span><span class="sxs-lookup"><span data-stu-id="7e501-262">IISNODE http status and substatus</span></span>
<span data-ttu-id="7e501-263">Ce [fichier source](https://github.com/Azure/iisnode/blob/master/src/iisnode/cnodeconstants.h) répertorie toutes les combinaisons d’état/sous-état qu’iisnode peut renvoyer en cas d’erreur.</span><span class="sxs-lookup"><span data-stu-id="7e501-263">This [source file](https://github.com/Azure/iisnode/blob/master/src/iisnode/cnodeconstants.h) lists all the possible status/substatus combination iisnode can return in case of error.</span></span>

<span data-ttu-id="7e501-264">Activez FREB pour votre application afin de voir le code d’erreur win32 (pour des raisons de performances, veillez à activer FREB uniquement sur les sites de test).</span><span class="sxs-lookup"><span data-stu-id="7e501-264">Enable FREB for your application to see the win32 error code (please make sure you enable FREB only on non-production sites for performance reasons).</span></span>

| <span data-ttu-id="7e501-265">État HTTP</span><span class="sxs-lookup"><span data-stu-id="7e501-265">Http Status</span></span> | <span data-ttu-id="7e501-266">Sous-état HTTP</span><span class="sxs-lookup"><span data-stu-id="7e501-266">Http SubStatus</span></span> | <span data-ttu-id="7e501-267">Raison possible ?</span><span class="sxs-lookup"><span data-stu-id="7e501-267">Possible Reason?</span></span> |
| --- | --- | --- |
| <span data-ttu-id="7e501-268">500</span><span class="sxs-lookup"><span data-stu-id="7e501-268">500</span></span> |<span data-ttu-id="7e501-269">1 000</span><span class="sxs-lookup"><span data-stu-id="7e501-269">1000</span></span> |<span data-ttu-id="7e501-270">Un problème est survenu au moment de l’envoi de la requête à IISNODE : vérifiez si node.exe a bien été démarré.</span><span class="sxs-lookup"><span data-stu-id="7e501-270">There was some issue dispatching the request to IISNODE – check if node.exe was started up.</span></span> <span data-ttu-id="7e501-271">node.exe peut avoir été bloqué au démarrage.</span><span class="sxs-lookup"><span data-stu-id="7e501-271">Node.exe could have crashed on startup.</span></span> <span data-ttu-id="7e501-272">Vérifiez la configuration de votre fichier web.config afin d’identifier d’éventuelles erreurs.</span><span class="sxs-lookup"><span data-stu-id="7e501-272">Check your web.config configuration for errors.</span></span> |
| <span data-ttu-id="7e501-273">500</span><span class="sxs-lookup"><span data-stu-id="7e501-273">500</span></span> |<span data-ttu-id="7e501-274">1001</span><span class="sxs-lookup"><span data-stu-id="7e501-274">1001</span></span> |<span data-ttu-id="7e501-275">-Win32Error 0 x 2 - L’application ne répond pas à l’URL.</span><span class="sxs-lookup"><span data-stu-id="7e501-275">- Win32Error 0x2 - App is not responding to the URL.</span></span> <span data-ttu-id="7e501-276">Vérifiez les règles de réécriture d’URL ou assurez-vous que les routes définies pour votre application sont correctes.</span><span class="sxs-lookup"><span data-stu-id="7e501-276">Check URL rewrite rules or if your express app has the correct routes defined.</span></span> <span data-ttu-id="7e501-277">-Win32Error 0x6d – le canal nommé est occupé : node.exe n’accepte pas les requêtes car le canal est occupé.</span><span class="sxs-lookup"><span data-stu-id="7e501-277">- Win32Error 0x6d – named pipe is busy – Node.exe is not accepting requests because the pipe is busy.</span></span> <span data-ttu-id="7e501-278">Vérifiez l’utilisation élevée du processeur.</span><span class="sxs-lookup"><span data-stu-id="7e501-278">Check high cpu usage.</span></span> <span data-ttu-id="7e501-279">-Autres erreurs : vérifiez si node.exe a planté.</span><span class="sxs-lookup"><span data-stu-id="7e501-279">- Other errors – check if node.exe crashed.</span></span> |
| <span data-ttu-id="7e501-280">500</span><span class="sxs-lookup"><span data-stu-id="7e501-280">500</span></span> |<span data-ttu-id="7e501-281">1002</span><span class="sxs-lookup"><span data-stu-id="7e501-281">1002</span></span> |<span data-ttu-id="7e501-282">node.exe a planté : consultez l’arborescence des appels de procédure sous d:\\home\\LogFiles\\logging-errors.txt.</span><span class="sxs-lookup"><span data-stu-id="7e501-282">Node.exe crashed – check d:\\home\\LogFiles\\logging-errors.txt for stack trace.</span></span> |
| <span data-ttu-id="7e501-283">500</span><span class="sxs-lookup"><span data-stu-id="7e501-283">500</span></span> |<span data-ttu-id="7e501-284">1003</span><span class="sxs-lookup"><span data-stu-id="7e501-284">1003</span></span> |<span data-ttu-id="7e501-285">Problème de configuration du canal : cet état ne devrait jamais apparaître, mais dans le cas contraire, cela signifie que la configuration du canal nommé est incorrecte.</span><span class="sxs-lookup"><span data-stu-id="7e501-285">Pipe configuration Issue – You should never see this but if you do, the named pipe configuration is incorrect.</span></span> |
| <span data-ttu-id="7e501-286">500</span><span class="sxs-lookup"><span data-stu-id="7e501-286">500</span></span> |<span data-ttu-id="7e501-287">1004-1018</span><span class="sxs-lookup"><span data-stu-id="7e501-287">1004-1018</span></span> |<span data-ttu-id="7e501-288">Une erreur s’est produite lors de l’envoi de la requête ou du traitement de la réponse depuis/vers node.exe.</span><span class="sxs-lookup"><span data-stu-id="7e501-288">There was some error while sending the request or processing the response to/from node.exe.</span></span> <span data-ttu-id="7e501-289">Vérifiez si node.exe a planté.</span><span class="sxs-lookup"><span data-stu-id="7e501-289">Check if node.exe crashed.</span></span> <span data-ttu-id="7e501-290">Consultez l’arborescence des appels de procédure sous d:\\home\\LogFiles\\logging-errors.txt.</span><span class="sxs-lookup"><span data-stu-id="7e501-290">check d:\\home\\LogFiles\\logging-errors.txt for stack trace.</span></span> |
| <span data-ttu-id="7e501-291">503</span><span class="sxs-lookup"><span data-stu-id="7e501-291">503</span></span> |<span data-ttu-id="7e501-292">1 000</span><span class="sxs-lookup"><span data-stu-id="7e501-292">1000</span></span> |<span data-ttu-id="7e501-293">Mémoire insuffisante pour allouer davantage de connexions de canal nommé.</span><span class="sxs-lookup"><span data-stu-id="7e501-293">Not enough memory to allocate more named pipe connections.</span></span> <span data-ttu-id="7e501-294">Vérifiez pourquoi votre application consomme une grande quantité de mémoire.</span><span class="sxs-lookup"><span data-stu-id="7e501-294">Check why your app is consuming so much memory.</span></span> <span data-ttu-id="7e501-295">Vérifiez la valeur du paramètre maxConcurrentRequestsPerProcess.</span><span class="sxs-lookup"><span data-stu-id="7e501-295">Check maxConcurrentRequestsPerProcess setting value.</span></span> <span data-ttu-id="7e501-296">Si ce paramètre n’est pas défini sur « infinite » et que vous avez un grand nombre de requêtes, augmentez cette valeur pour éviter cette erreur.</span><span class="sxs-lookup"><span data-stu-id="7e501-296">If its not infinite and you have a lot of requests, increase this value to prevent this error.</span></span> |
| <span data-ttu-id="7e501-297">503</span><span class="sxs-lookup"><span data-stu-id="7e501-297">503</span></span> |<span data-ttu-id="7e501-298">1001</span><span class="sxs-lookup"><span data-stu-id="7e501-298">1001</span></span> |<span data-ttu-id="7e501-299">Impossible de distribuer la requête à node.exe en raison du recyclage de l’application.</span><span class="sxs-lookup"><span data-stu-id="7e501-299">Request could not be dispatched to node.exe because the application is recycling.</span></span> <span data-ttu-id="7e501-300">Une fois que l’application est recyclée, les requêtes devraient être traitées normalement.</span><span class="sxs-lookup"><span data-stu-id="7e501-300">After the application has recycled, requests should be served normally.</span></span> |
| <span data-ttu-id="7e501-301">503</span><span class="sxs-lookup"><span data-stu-id="7e501-301">503</span></span> |<span data-ttu-id="7e501-302">1002</span><span class="sxs-lookup"><span data-stu-id="7e501-302">1002</span></span> |<span data-ttu-id="7e501-303">Vérifiez le code d’erreur win32 pour connaître la raison : impossible de distribuer la requête à un node.exe.</span><span class="sxs-lookup"><span data-stu-id="7e501-303">Check win32 error code for actual reason – Request could not be dispatched to a node.exe.</span></span> |
| <span data-ttu-id="7e501-304">503</span><span class="sxs-lookup"><span data-stu-id="7e501-304">503</span></span> |<span data-ttu-id="7e501-305">1003</span><span class="sxs-lookup"><span data-stu-id="7e501-305">1003</span></span> |<span data-ttu-id="7e501-306">Le canal nommé est trop occupé : vérifiez si nœud consomme beaucoup de ressources processeur</span><span class="sxs-lookup"><span data-stu-id="7e501-306">Named pipe is too Busy – Check if node is consuming a lot of CPU</span></span> |

<span data-ttu-id="7e501-307">NODE.exe contient un paramètre appelé NODE\_PENDING\_PIPE\_INSTANCES.</span><span class="sxs-lookup"><span data-stu-id="7e501-307">There is a setting within NODE.exe called NODE\_PENDING\_PIPE\_INSTANCES.</span></span> <span data-ttu-id="7e501-308">Par défaut, cette valeur est définie sur 4 en dehors d’Azure Webapps.</span><span class="sxs-lookup"><span data-stu-id="7e501-308">By default outside of azure webapps this value is 4.</span></span> <span data-ttu-id="7e501-309">Cela signifie que node.exe ne peut accepter que 4 requêtes à la fois sur le canal nommé.</span><span class="sxs-lookup"><span data-stu-id="7e501-309">This means that node.exe can only accept 4 requests at a time on the named pipe.</span></span> <span data-ttu-id="7e501-310">Dans Azure Webapps, cette valeur est définie sur 5 000, ce qui doit être suffisant pour la plupart des applications node exécutées sur Azure Webapps.</span><span class="sxs-lookup"><span data-stu-id="7e501-310">On Azure Webapps, this value is set to 5000 and this value should be good enough for most node applications running on azure webapps.</span></span> <span data-ttu-id="7e501-311">Vous ne devriez pas rencontrer l’état 503.1003 sur Azure Webapps, car le paramètre NODE\_PENDING\_PIPE\_INSTANCES est défini sur une valeur élevée.</span><span class="sxs-lookup"><span data-stu-id="7e501-311">You should not see 503.1003 on azure webapps because we have a high value for the NODE\_PENDING\_PIPE\_INSTANCES.</span></span>  |

## <a name="more-resources"></a><span data-ttu-id="7e501-312">Autres ressources</span><span class="sxs-lookup"><span data-stu-id="7e501-312">More resources</span></span>
<span data-ttu-id="7e501-313">Cliquez sur ces liens pour en savoir plus sur les applications node.js dans Azure App Service.</span><span class="sxs-lookup"><span data-stu-id="7e501-313">Follow these links to learn more about node.js applications on Azure App Service.</span></span>

* [<span data-ttu-id="7e501-314">Prise en main des applications web Node.js dans Azure App Service</span><span class="sxs-lookup"><span data-stu-id="7e501-314">Get started with Node.js web apps in Azure App Service</span></span>](app-service-web-get-started-nodejs.md)
* [<span data-ttu-id="7e501-315">Débogage d’une application web Node.js dans Azure Web Service</span><span class="sxs-lookup"><span data-stu-id="7e501-315">How to debug a Node.js web app in Azure App Service</span></span>](web-sites-nodejs-debug.md)
* [<span data-ttu-id="7e501-316">Utilisation de modules Node.js avec des applications Azure</span><span class="sxs-lookup"><span data-stu-id="7e501-316">Using Node.js Modules with Azure applications</span></span>](../nodejs-use-node-modules-azure-apps.md)
* [<span data-ttu-id="7e501-317">Azure App Service Web Apps : Node.js</span><span class="sxs-lookup"><span data-stu-id="7e501-317">Azure App Service Web Apps: Node.js</span></span>](https://blogs.msdn.microsoft.com/silverlining/2012/06/14/windows-azure-websites-node-js/)
* [<span data-ttu-id="7e501-318">Centre de développement Node.js</span><span class="sxs-lookup"><span data-stu-id="7e501-318">Node.js Developer Center</span></span>](../nodejs-use-node-modules-azure-apps.md)
* [<span data-ttu-id="7e501-319">Exploring the Super Secret Kudu Debug Console (Exploration de la console de débogage Kudu Super Secret)</span><span class="sxs-lookup"><span data-stu-id="7e501-319">Exploring the Super Secret Kudu Debug Console</span></span>](https://azure.microsoft.com/documentation/videos/super-secret-kudu-debug-console-for-azure-web-sites/)

