---
title: Prise en main de la fonction de test en production pour les applications web
description: En savoir plus sur la fonction de test en production dans Azure App Service Web Apps.
services: app-service\web
documentationcenter: 
author: cephalin
manager: erikre
editor: 
ms.assetid: 4623468d-886e-4203-8012-8f86deb2790b
ms.service: app-service-web
ms.workload: web
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/13/2016
ms.author: cephalin
ms.openlocfilehash: 9f38b635140cacf0513c75385bce3c110a930969
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/11/2017
---
# <a name="get-started-with-test-in-production-for-web-apps"></a><span data-ttu-id="bf4bc-103">Prise en main de la fonction de test en production pour les applications web</span><span class="sxs-lookup"><span data-stu-id="bf4bc-103">Get started with test in production for Web Apps</span></span>
<span data-ttu-id="bf4bc-104">Le test en production, ou test en direct de votre application web à l’aide du trafic client en direct, est une stratégie de test que les développeurs d’applications intègrent de plus en plus à leur méthodologie de [développement agile](https://en.wikipedia.org/wiki/Agile_software_development) .</span><span class="sxs-lookup"><span data-stu-id="bf4bc-104">Testing in production, or live-testing your web app using live customer traffic, is a test strategy that app developers increasingly integrate into their [agile development](https://en.wikipedia.org/wiki/Agile_software_development) methodology.</span></span> <span data-ttu-id="bf4bc-105">Cette fonction vous permet de tester la qualité de vos applications avec le trafic des utilisateurs en direct dans votre environnement de production, par opposition aux données synthétisées dans un environnement de test.</span><span class="sxs-lookup"><span data-stu-id="bf4bc-105">It enables you to test the quality of your apps with live user traffic in your production environment, as opposed to synthesized data in a test environment.</span></span> <span data-ttu-id="bf4bc-106">En exposant votre nouvelle application auprès d’utilisateurs réels, vous pouvez recevoir des informations sur les problèmes réels qu’elle sera susceptible de rencontrer après son déploiement.</span><span class="sxs-lookup"><span data-stu-id="bf4bc-106">By exposing your new app to real users, you can be informed on the real problems your app may face once it is deployed.</span></span> <span data-ttu-id="bf4bc-107">Vous pouvez vérifier les fonctionnalités, les performances et la valeur de vos mises à jour de l’application par rapport au volume, à la vitesse et à la diversité du trafic utilisateur réel, ce qui est impossible dans un environnement de test.</span><span class="sxs-lookup"><span data-stu-id="bf4bc-107">You can verify the functionality, performance, and value of your app updates against the volume, velocity, and variety of real user traffic, which you can never approximate in a test environment.</span></span>

## <a name="traffic-routing-in-app-service-web-apps"></a><span data-ttu-id="bf4bc-108">Routage du trafic dans App Service Web Apps</span><span class="sxs-lookup"><span data-stu-id="bf4bc-108">Traffic Routing in App Service Web Apps</span></span>
<span data-ttu-id="bf4bc-109">Grâce à la fonctionnalité de routage du trafic dans [Azure App Service](http://go.microsoft.com/fwlink/?LinkId=529714), vous pouvez diriger une partie du trafic utilisateur direct vers un ou plusieurs [emplacements de déploiement](web-sites-staged-publishing.md), puis analyser votre application avec [Azure Application Insights](/services/application-insights/), [Azure HDInsight](/services/hdinsight/) ou un outil tiers comme [New Relic](/marketplace/partners/newrelic/newrelic/) pour valider vos modifications.</span><span class="sxs-lookup"><span data-stu-id="bf4bc-109">With the Traffic Routing feature in [Azure App Service](http://go.microsoft.com/fwlink/?LinkId=529714), you can direct a portion of live user traffic to one or more [deployment slots](web-sites-staged-publishing.md), and then analyze your app with [Azure Application Insights](/services/application-insights/) or [Azure HDInsight](/services/hdinsight/), or a third-party tool like [New Relic](/marketplace/partners/newrelic/newrelic/) to validate your change.</span></span> <span data-ttu-id="bf4bc-110">Par exemple, vous pouvez implémenter les scénarios suivants avec App Service :</span><span class="sxs-lookup"><span data-stu-id="bf4bc-110">For example, you can implement the following scenarios with App Service:</span></span>

* <span data-ttu-id="bf4bc-111">Découvrir des bogues fonctionnels ou identifier les goulots d’étranglement de performances dans vos mises à jour avant le déploiement à l’échelle du site</span><span class="sxs-lookup"><span data-stu-id="bf4bc-111">Discover functional bugs or pinpoint performance bottlenecks in your updates prior to site-wide deployment</span></span>
* <span data-ttu-id="bf4bc-112">Exécuter des « versions de test contrôlées » de vos modifications en mesurant la facilité d’utilisation sur l’application bêta</span><span class="sxs-lookup"><span data-stu-id="bf4bc-112">Perform "controlled test flights" of your changes by measuring usability metrics on the beta app</span></span>
* <span data-ttu-id="bf4bc-113">Développer progressivement une nouvelle mise à jour et revenir normalement à la version actuelle si une erreur se produit</span><span class="sxs-lookup"><span data-stu-id="bf4bc-113">Gradually ramp up to a new update, and gracefully back down to the current version if an error occurs</span></span> 
* <span data-ttu-id="bf4bc-114">Optimiser les résultats commerciaux de votre application en exécutant des [tests A/B](https://en.wikipedia.org/wiki/A/B_testing) ou des [tests multivariables](https://en.wikipedia.org/wiki/Multivariate_testing_in_marketing) dans plusieurs emplacements de déploiement</span><span class="sxs-lookup"><span data-stu-id="bf4bc-114">Optimize your app's business results by running [A/B tests](https://en.wikipedia.org/wiki/A/B_testing) or [multivariate tests](https://en.wikipedia.org/wiki/Multivariate_testing_in_marketing) in multiple deployment slots</span></span>

### <a name="requirements-for-using-traffic-routing-in-web-apps"></a><span data-ttu-id="bf4bc-115">Configuration requise pour utiliser le routage du trafic dans Web Apps</span><span class="sxs-lookup"><span data-stu-id="bf4bc-115">Requirements for using Traffic Routing in Web Apps</span></span>
* <span data-ttu-id="bf4bc-116">Votre application web doit s’exécuter au niveau **Standard** ou **Premium**, requis pour les emplacements de déploiement multiples.</span><span class="sxs-lookup"><span data-stu-id="bf4bc-116">Your web app must run in **Standard** or **Premium** tier, as it is required for multiple deployment slots.</span></span>
* <span data-ttu-id="bf4bc-117">Pour fonctionner correctement, le routage du trafic requiert l’activation des cookies dans le navigateur des utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="bf4bc-117">In order to work properly, Traffic Routing requires cookies to be enabled in the users' browser.</span></span> <span data-ttu-id="bf4bc-118">Le routage du trafic utilise des cookies pour épingler un navigateur client à un emplacement de déploiement pendant la durée de la session de client.</span><span class="sxs-lookup"><span data-stu-id="bf4bc-118">Traffic Routing uses cookies to pin a client browser to a deployment slot for the life the client session.</span></span>
* <span data-ttu-id="bf4bc-119">Le routage du trafic prend en charge des scénarios avancés de test en production via les applets de commande Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="bf4bc-119">Traffic Routing supports advanced TiP scenarios through Azure PowerShell cmdlets.</span></span>

## <a name="route-traffic-segment-to-a-deployment-slot"></a><span data-ttu-id="bf4bc-120">Routage d’un segment de trafic vers un emplacement de déploiement</span><span class="sxs-lookup"><span data-stu-id="bf4bc-120">Route traffic segment to a deployment slot</span></span>
<span data-ttu-id="bf4bc-121">Au niveau de base, dans chaque scénario de test en production, vous acheminez un pourcentage prédéfini de votre trafic en direct vers un emplacement de déploiement hors production.</span><span class="sxs-lookup"><span data-stu-id="bf4bc-121">At the basic level in every TiP scenario, you route a predefined percentage of your live traffic to a non-production deployment slot.</span></span> <span data-ttu-id="bf4bc-122">Pour ce faire, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="bf4bc-122">To do this, follow the steps below:</span></span>

> [!NOTE]
> <span data-ttu-id="bf4bc-123">Cette procédure suppose que vous disposez déjà d’un [emplacement de déploiement hors production](web-sites-staged-publishing.md) et que le contenu d’application web souhaité est déjà [déployé](web-sites-deploy.md) sur celui-ci.</span><span class="sxs-lookup"><span data-stu-id="bf4bc-123">The steps here assumes that you already have a [non-production deployment slot](web-sites-staged-publishing.md) and that the desired web app content is already [deployed](web-sites-deploy.md) to it.</span></span>
> 
> 

1. <span data-ttu-id="bf4bc-124">Connectez-vous au [portail Azure](https://portal.azure.com/).</span><span class="sxs-lookup"><span data-stu-id="bf4bc-124">Log into the [Azure Portal](https://portal.azure.com/).</span></span>
2. <span data-ttu-id="bf4bc-125">Dans le panneau de votre application web, cliquez sur **Paramètres** > **Routage du trafic**.</span><span class="sxs-lookup"><span data-stu-id="bf4bc-125">In your web app's blade, click **Settings** > **Traffic Routing**.</span></span>
   ![](./media/app-service-web-test-in-production/01-traffic-routing.png)
3. <span data-ttu-id="bf4bc-126">Sélectionnez l’emplacement vers lequel vous souhaitez acheminer le trafic, ainsi que le pourcentage de trafic total souhaité, puis cliquez sur **Enregistrer**.</span><span class="sxs-lookup"><span data-stu-id="bf4bc-126">Select the slot that you want to route traffic to and the percentage of the total traffic you desire, then click **Save**.</span></span>
   
    ![](./media/app-service-web-test-in-production/02-select-slot.png)
4. <span data-ttu-id="bf4bc-127">Accédez au panneau de l’emplacement de déploiement.</span><span class="sxs-lookup"><span data-stu-id="bf4bc-127">Go to the deployment slot's blade.</span></span> <span data-ttu-id="bf4bc-128">Vous devriez maintenant voir le trafic en direct en cours de routage vers celui-ci.</span><span class="sxs-lookup"><span data-stu-id="bf4bc-128">You should now see live traffic being routed to it.</span></span>
   
    ![](./media/app-service-web-test-in-production/03-traffic-routed.png)

<span data-ttu-id="bf4bc-129">Une fois le routage du trafic configuré, le pourcentage de clients spécifié sera routé de manière aléatoire vers votre emplacement hors production.</span><span class="sxs-lookup"><span data-stu-id="bf4bc-129">Once Traffic Routing is configured, the specified percentage of clients will be randomly routed to your non-production slot.</span></span> <span data-ttu-id="bf4bc-130">Toutefois, il est important de noter qu’une fois qu’un client est automatiquement acheminé vers un emplacement spécifique, il est « épinglé » à cet emplacement pendant la durée de cette session de client.</span><span class="sxs-lookup"><span data-stu-id="bf4bc-130">However, it is important to note that once a client is automatically routed to a specific slot, it will be "pinned" to that slot for the life of that client session.</span></span> <span data-ttu-id="bf4bc-131">Cette opération est effectuée à l’aide d’un cookie pour épingler la session utilisateur.</span><span class="sxs-lookup"><span data-stu-id="bf4bc-131">This done using a cookie to pin the user session.</span></span> <span data-ttu-id="bf4bc-132">Si vous inspectez les demandes HTTP, vous trouverez un cookie `TipMix` dans chaque demande ultérieure.</span><span class="sxs-lookup"><span data-stu-id="bf4bc-132">If you inspect the HTTP requests, you will find a `TipMix` cookie in every subsequent request.</span></span>

![](./media/app-service-web-test-in-production/04-tip-cookie.png)

## <a name="force-client-requests-to-a-specific-slot"></a><span data-ttu-id="bf4bc-133">Forcer les demandes des clients vers un emplacement spécifique</span><span class="sxs-lookup"><span data-stu-id="bf4bc-133">Force client requests to a specific slot</span></span>
<span data-ttu-id="bf4bc-134">Outre le routage automatique du trafic, App Service peut acheminer les demandes vers un emplacement spécifique.</span><span class="sxs-lookup"><span data-stu-id="bf4bc-134">In addition to automatic traffic routing, App Service is able to route requests to a specific slot.</span></span> <span data-ttu-id="bf4bc-135">Cela est utile lorsque vous souhaitez que vos utilisateurs puissent choisir d’accepter ou de refuser votre application bêta.</span><span class="sxs-lookup"><span data-stu-id="bf4bc-135">This is useful when you want your users to be able to opt-into or opt-out of your beta app.</span></span> <span data-ttu-id="bf4bc-136">Pour ce faire, vous utilisez le paramètre de requête `x-ms-routing-name` .</span><span class="sxs-lookup"><span data-stu-id="bf4bc-136">To do this, you use the `x-ms-routing-name` query parameter.</span></span>

<span data-ttu-id="bf4bc-137">Pour rediriger les utilisateurs vers un emplacement spécifique à l’aide de `x-ms-routing-name`, vous devez vous assurer que l’emplacement est déjà ajouté à la liste de routage du trafic.</span><span class="sxs-lookup"><span data-stu-id="bf4bc-137">To reroute users to a specific slot using `x-ms-routing-name`, you must make sure that the slot is already added to the Traffic Routing list.</span></span> <span data-ttu-id="bf4bc-138">Étant donné que vous souhaitez router vers un emplacement explicitement, le pourcentage de routage réel que vous définissez n’a pas d’importance.</span><span class="sxs-lookup"><span data-stu-id="bf4bc-138">Since you want to route to a slot explicitly, the actual routing percentage you set doesn't matter.</span></span> <span data-ttu-id="bf4bc-139">Si vous le souhaitez, vous pouvez créer un « lien bêta » sur lequel les utilisateurs peuvent cliquer pour accéder à l’application bêta.</span><span class="sxs-lookup"><span data-stu-id="bf4bc-139">If you want, you can craft a "beta link" that users can click to access the beta app.</span></span>

![](./media/app-service-web-test-in-production/06-enable-x-ms-routing-name.png)

### <a name="opt-users-out-of-beta-app"></a><span data-ttu-id="bf4bc-140">Utilisateurs refusant l’application bêta</span><span class="sxs-lookup"><span data-stu-id="bf4bc-140">Opt users out of beta app</span></span>
<span data-ttu-id="bf4bc-141">Par exemple, pour permettre aux utilisateurs de refuser votre application bêta, vous pouvez placer ce lien sur votre page web :</span><span class="sxs-lookup"><span data-stu-id="bf4bc-141">To let users opt out of your beta app, for example, you can put this link in your web page:</span></span>

    <a href="<webappname>.azurewebsites.net/?x-ms-routing-name=self">Go back to production app</a>

<span data-ttu-id="bf4bc-142">La chaîne `x-ms-routing-name=self` spécifie l’emplacement de production.</span><span class="sxs-lookup"><span data-stu-id="bf4bc-142">The string `x-ms-routing-name=self` specifies the production slot.</span></span> <span data-ttu-id="bf4bc-143">Une fois que le navigateur client accède au lien, non seulement il est redirigé vers l’emplacement de production, mais chaque demande ultérieure contiendra le cookie `x-ms-routing-name=self` qui épingle la session à l’emplacement de production.</span><span class="sxs-lookup"><span data-stu-id="bf4bc-143">Once the client browser access the link, not only is it redirected to the production slot, but every subsequent request will contain the `x-ms-routing-name=self` cookie that pins the session to the production slot.</span></span>

![](./media/app-service-web-test-in-production/05-access-production-slot.png)

### <a name="opt-users-in-to-beta-app"></a><span data-ttu-id="bf4bc-144">Utilisateurs acceptant l’application bêta</span><span class="sxs-lookup"><span data-stu-id="bf4bc-144">Opt users in to beta app</span></span>
<span data-ttu-id="bf4bc-145">Pour permettre aux utilisateurs d’accepter votre application bêta, définissez le même paramètre de requête pour le nom de l’emplacement hors production, par exemple :</span><span class="sxs-lookup"><span data-stu-id="bf4bc-145">To let users opt in to your beta app, set the same query parameter to the name of the non-production slot, for example:</span></span>

        <webappname>.azurewebsites.net/?x-ms-routing-name=staging

## <a name="more-resources"></a><span data-ttu-id="bf4bc-146">Autres ressources</span><span class="sxs-lookup"><span data-stu-id="bf4bc-146">More resources</span></span>
* [<span data-ttu-id="bf4bc-147">Configurer des environnements intermédiaires pour les applications web dans Azure App Service</span><span class="sxs-lookup"><span data-stu-id="bf4bc-147">Set up staging environments for web apps in Azure App Service</span></span>](web-sites-staged-publishing.md)
* [<span data-ttu-id="bf4bc-148">Déployer une application complexe de manière prévisible dans Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="bf4bc-148">Deploy a complex application predictably in Azure</span></span>](app-service-deploy-complex-application-predictably.md)
* [<span data-ttu-id="bf4bc-149">Développement logiciel agile avec Azure App Service</span><span class="sxs-lookup"><span data-stu-id="bf4bc-149">Agile software development with Azure App Service</span></span>](app-service-agile-software-development.md)
* [<span data-ttu-id="bf4bc-150">Utiliser efficacement les environnements DevOps pour vos applications web</span><span class="sxs-lookup"><span data-stu-id="bf4bc-150">Use DevOps environments effectively for your web apps</span></span>](app-service-web-staged-publishing-realworld-scenarios.md)

