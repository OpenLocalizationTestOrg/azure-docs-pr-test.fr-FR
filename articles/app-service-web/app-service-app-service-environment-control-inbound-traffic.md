---
title: "Contrôle du trafic entrant vers un environnement App Service"
description: "Découvrez comment configurer des règles de sécurité réseau pour contrôler le trafic entrant vers un environnement App Service."
services: app-service
documentationcenter: 
author: ccompy
manager: erikre
editor: 
ms.assetid: 4cc82439-8791-48a4-9485-de6d8e1d1a08
ms.service: app-service
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/11/2017
ms.author: stefsch
ms.openlocfilehash: ee0a2248a1cd5d76f87b280de05410b94f96c8af
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/11/2017
---
# <a name="how-to-control-inbound-traffic-to-an-app-service-environment"></a><span data-ttu-id="785cb-103">Contrôle du trafic entrant vers un environnement App Service</span><span class="sxs-lookup"><span data-stu-id="785cb-103">How To Control Inbound Traffic to an App Service Environment</span></span>
## <a name="overview"></a><span data-ttu-id="785cb-104">Vue d’ensemble</span><span class="sxs-lookup"><span data-stu-id="785cb-104">Overview</span></span>
<span data-ttu-id="785cb-105">Un environnement App Service peut être créé **soit** dans un réseau virtuel Azure Resource Manager, **soit** dans un [réseau virtuel][virtualnetwork] de modèle de déploiement classique.</span><span class="sxs-lookup"><span data-stu-id="785cb-105">An App Service Environment can be created in **either** an Azure Resource Manager virtual network, **or** a classic deployment model [virtual network][virtualnetwork].</span></span>  <span data-ttu-id="785cb-106">Il est possible de définir un nouveau réseau virtuel et un nouveau sous-réseau au moment de la création d'un environnement App Service.</span><span class="sxs-lookup"><span data-stu-id="785cb-106">A new virtual network and new subnet can be defined at the time an App Service Environment is created.</span></span>  <span data-ttu-id="785cb-107">Vous pouvez également créer un environnement App Service dans un réseau virtuel préexistant et un sous-réseau préexistant.</span><span class="sxs-lookup"><span data-stu-id="785cb-107">Alternatively, an App Service Environment can be created in a pre-existing virtual network and pre-existing subnet.</span></span>  <span data-ttu-id="785cb-108">Grâce à une modification effectuée en juin 2016, les environnements ASE peuvent également être déployés dans les réseaux virtuels qui utilisent soit des plages d’adresses publiques soit des espaces d’adressage RFC1918 (par exemple,</span><span class="sxs-lookup"><span data-stu-id="785cb-108">With a change made in June 2016, ASEs can also be deployed into virtual networks that use either public address ranges, or RFC1918 address spaces (i.e.</span></span> <span data-ttu-id="785cb-109">des adresses privées).</span><span class="sxs-lookup"><span data-stu-id="785cb-109">private addresses).</span></span>  <span data-ttu-id="785cb-110">Pour plus de détails sur la création d’un environnement App Service, consultez [Création d’un environnement App Service][HowToCreateAnAppServiceEnvironment].</span><span class="sxs-lookup"><span data-stu-id="785cb-110">For more details on creating an App Service Environment see [How To Create an App Service Environment][HowToCreateAnAppServiceEnvironment].</span></span>

<span data-ttu-id="785cb-111">Un environnement App Service doit toujours être créé dans un sous-réseau, car un sous-réseau fournit une limite réseau qui peut être utilisée pour verrouiller le trafic entrant derrière des appareils et des services en amont, de sorte que le trafic HTTP et HTTPS soit accepté uniquement à partir d'adresses IP en amont.</span><span class="sxs-lookup"><span data-stu-id="785cb-111">An App Service Environment must always be created within a subnet because a subnet provides a network boundary which can be used to lock down inbound traffic behind upstream devices and services such that HTTP and HTTPS traffic is only accepted from specific upstream IP addresses.</span></span>

<span data-ttu-id="785cb-112">Le trafic réseau entrant et sortant sur un sous-réseau est contrôlé à l'aide d’un [groupe de sécurité réseau][NetworkSecurityGroups].</span><span class="sxs-lookup"><span data-stu-id="785cb-112">Inbound and outbound network traffic on a subnet is controlled using a [network security group][NetworkSecurityGroups].</span></span> <span data-ttu-id="785cb-113">Le contrôle du trafic entrant requiert la création de règles de sécurité réseau dans un groupe de sécurité réseau, ainsi que l'affectation du sous-réseau contenant l'environnement App Service à ce groupe de sécurité réseau.</span><span class="sxs-lookup"><span data-stu-id="785cb-113">Controlling inbound traffic requires creating network security rules in a network security group, and then assigning the network security group the subnet containing the App Service Environment.</span></span>

<span data-ttu-id="785cb-114">Lorsqu'un groupe de sécurité réseau est affecté à un sous-réseau, le trafic entrant vers des applications de l'environnement App Service est autorisé/bloqués en fonction des règles d'autorisation et de refus définies dans le groupe de sécurité réseau.</span><span class="sxs-lookup"><span data-stu-id="785cb-114">Once a network security group is assigned to a subnet, inbound traffic to apps in the App Service Environment is allowed/blocked based on the allow and deny rules defined in the network security group.</span></span>

[!INCLUDE [app-service-web-to-api-and-mobile](../../includes/app-service-web-to-api-and-mobile.md)]

## <a name="inbound-network-ports-used-in-an-app-service-environment"></a><span data-ttu-id="785cb-115">Ports réseau entrants dans un environnement App Service</span><span class="sxs-lookup"><span data-stu-id="785cb-115">Inbound Network Ports Used in an App Service Environment</span></span>
<span data-ttu-id="785cb-116">Avant de verrouiller le trafic réseau entrant à l'aide d'un groupe de sécurité réseau, il est important de connaître l'ensemble de ports réseau obligatoires et facultatifs utilisés par un environnement App Service.</span><span class="sxs-lookup"><span data-stu-id="785cb-116">Before locking down inbound network traffic with a network security group, it is important to know the set of required and optional network ports used by an App Service Environment.</span></span>  <span data-ttu-id="785cb-117">La fermeture accidentelle du trafic vers certains ports peut entraîner une perte de fonctionnalités dans un environnement App Service.</span><span class="sxs-lookup"><span data-stu-id="785cb-117">Accidentally closing off traffic to some ports can result in loss of functionality in an App Service Environment.</span></span>

<span data-ttu-id="785cb-118">La liste suivante présente les ports utilisés par un environnement App Service.</span><span class="sxs-lookup"><span data-stu-id="785cb-118">The following is a list of ports used by an App Service Environment.</span></span> <span data-ttu-id="785cb-119">Tous les ports sont **TCP**, sauf indication contraire clairement spécifiée :</span><span class="sxs-lookup"><span data-stu-id="785cb-119">All ports are **TCP**, unless otherwise clearly noted:</span></span>

* <span data-ttu-id="785cb-120">454 : **Port obligatoire** utilisé par l'infrastructure Azure pour la gestion et la maintenance des environnements App Service par le biais de SSL.</span><span class="sxs-lookup"><span data-stu-id="785cb-120">454:  **Required port** used by Azure infrastructure for managing and maintaining App Service Environments via SSL.</span></span>  <span data-ttu-id="785cb-121">Ne bloquez pas le trafic vers ce port.</span><span class="sxs-lookup"><span data-stu-id="785cb-121">Do not block traffic to this port.</span></span>  <span data-ttu-id="785cb-122">Ce port est toujours lié à l’adresse IP virtuelle publique d’un ASE.</span><span class="sxs-lookup"><span data-stu-id="785cb-122">This port is always bound to the public VIP of an ASE.</span></span>
* <span data-ttu-id="785cb-123">455 : **Port obligatoire** utilisé par l'infrastructure Azure pour la gestion et la maintenance des environnements App Service par le biais de SSL.</span><span class="sxs-lookup"><span data-stu-id="785cb-123">455:  **Required port** used by Azure infrastructure for managing and maintaining App Service Environments via SSL.</span></span>  <span data-ttu-id="785cb-124">Ne bloquez pas le trafic vers ce port.</span><span class="sxs-lookup"><span data-stu-id="785cb-124">Do not block traffic to this port.</span></span>  <span data-ttu-id="785cb-125">Ce port est toujours lié à l’adresse IP virtuelle publique d’un ASE.</span><span class="sxs-lookup"><span data-stu-id="785cb-125">This port is always bound to the public VIP of an ASE.</span></span>
* <span data-ttu-id="785cb-126">80 : Port par défaut pour le trafic HTTP entrant vers des applications s'exécutant dans plans App Service d'un environnement App Service.</span><span class="sxs-lookup"><span data-stu-id="785cb-126">80:  Default port for inbound HTTP traffic to apps running in App Service Plans in an App Service Environment.</span></span>  <span data-ttu-id="785cb-127">Sur un ASE avec équilibrage de charge interne, ce port est lié à l’adresse d’équilibrage de charge interne de l’ASE.</span><span class="sxs-lookup"><span data-stu-id="785cb-127">On an ILB-enabled ASE, this port is bound to the ILB address of the ASE.</span></span>
* <span data-ttu-id="785cb-128">443 : port par défaut pour le trafic SSL entrant vers des applications s'exécutant dans plans App Service d'un environnement App Service.</span><span class="sxs-lookup"><span data-stu-id="785cb-128">443: Default port for inbound SSL traffic to apps running in App Service Plans in an App Service Environment.</span></span>  <span data-ttu-id="785cb-129">Sur un ASE avec équilibrage de charge interne, ce port est lié à l’adresse d’équilibrage de charge interne de l’ASE.</span><span class="sxs-lookup"><span data-stu-id="785cb-129">On an ILB-enabled ASE, this port is bound to the ILB address of the ASE.</span></span>
* <span data-ttu-id="785cb-130">21 : Canal de contrôle pour FTP.</span><span class="sxs-lookup"><span data-stu-id="785cb-130">21:  Control channel for FTP.</span></span>  <span data-ttu-id="785cb-131">Ce port peut être bloqué en toute sécurité si FTP n'est pas utilisé.</span><span class="sxs-lookup"><span data-stu-id="785cb-131">This port can be safely blocked if FTP is not being used.</span></span>  <span data-ttu-id="785cb-132">Sur un ASE avec équilibrage de charge interne, ce port peut être lié à l’adresse d’équilibrage de charge interne d’un ASE.</span><span class="sxs-lookup"><span data-stu-id="785cb-132">On an ILB-enabled ASE, this port can be bound to the ILB address for an ASE.</span></span>
* <span data-ttu-id="785cb-133">990 : Canal de contrôle pour FTPS.</span><span class="sxs-lookup"><span data-stu-id="785cb-133">990:  Control channel for FTPS.</span></span>  <span data-ttu-id="785cb-134">Ce port peut être bloqué en toute sécurité si FTPS n’est pas utilisé.</span><span class="sxs-lookup"><span data-stu-id="785cb-134">This port can be safely blocked if FTPS is not being used.</span></span>  <span data-ttu-id="785cb-135">Sur un ASE avec équilibrage de charge interne, ce port peut être lié à l’adresse d’équilibrage de charge interne d’un ASE.</span><span class="sxs-lookup"><span data-stu-id="785cb-135">On an ILB-enabled ASE, this port can be bound to the ILB address for an ASE.</span></span>
* <span data-ttu-id="785cb-136">10001-10020 : Canaux de données pour FTP.</span><span class="sxs-lookup"><span data-stu-id="785cb-136">10001-10020: Data channels for FTP.</span></span>  <span data-ttu-id="785cb-137">Comme avec le canal de contrôle, ces ports peuvent être bloqués en toute sécurité si FTP n’est pas utilisé.</span><span class="sxs-lookup"><span data-stu-id="785cb-137">As with the control channel, these ports can be safely blocked if FTP is not being used.</span></span>  <span data-ttu-id="785cb-138">Sur un ASE avec équilibrage de charge interne, ce port peut être lié à l’adresse d’équilibrage de charge interne de l’ASE.</span><span class="sxs-lookup"><span data-stu-id="785cb-138">On an ILB-enabled ASE, this port can be bound to the ASE's ILB address.</span></span>
* <span data-ttu-id="785cb-139">4016 : Utilisé pour le débogage à distance avec Visual Studio 2012.</span><span class="sxs-lookup"><span data-stu-id="785cb-139">4016: Used for remote debugging with Visual Studio 2012.</span></span>  <span data-ttu-id="785cb-140">Ce port peut être bloqué en toute sécurité si la fonctionnalité n'est pas utilisée.</span><span class="sxs-lookup"><span data-stu-id="785cb-140">This port can be safely blocked if the feature is not being used.</span></span>  <span data-ttu-id="785cb-141">Sur un ASE avec équilibrage de charge interne, ce port est lié à l’adresse d’équilibrage de charge interne de l’ASE.</span><span class="sxs-lookup"><span data-stu-id="785cb-141">On an ILB-enabled ASE, this port is bound to the ILB address of the ASE.</span></span>
* <span data-ttu-id="785cb-142">4018 : Utilisé pour le débogage à distance avec Visual Studio 2013.</span><span class="sxs-lookup"><span data-stu-id="785cb-142">4018: Used for remote debugging with Visual Studio 2013.</span></span>  <span data-ttu-id="785cb-143">Ce port peut être bloqué en toute sécurité si la fonctionnalité n'est pas utilisée.</span><span class="sxs-lookup"><span data-stu-id="785cb-143">This port can be safely blocked if the feature is not being used.</span></span>  <span data-ttu-id="785cb-144">Sur un ASE avec équilibrage de charge interne, ce port est lié à l’adresse d’équilibrage de charge interne de l’ASE.</span><span class="sxs-lookup"><span data-stu-id="785cb-144">On an ILB-enabled ASE, this port is bound to the ILB address of the ASE.</span></span>
* <span data-ttu-id="785cb-145">4020 : Utilisé pour le débogage à distance avec Visual Studio 2015.</span><span class="sxs-lookup"><span data-stu-id="785cb-145">4020: Used for remote debugging with Visual Studio 2015.</span></span>  <span data-ttu-id="785cb-146">Ce port peut être bloqué en toute sécurité si la fonctionnalité n'est pas utilisée.</span><span class="sxs-lookup"><span data-stu-id="785cb-146">This port can be safely blocked if the feature is not being used.</span></span>  <span data-ttu-id="785cb-147">Sur un ASE avec équilibrage de charge interne, ce port est lié à l’adresse d’équilibrage de charge interne de l’ASE.</span><span class="sxs-lookup"><span data-stu-id="785cb-147">On an ILB-enabled ASE, this port is bound to the ILB address of the ASE.</span></span>

## <a name="outbound-connectivity-and-dns-requirements"></a><span data-ttu-id="785cb-148">Connectivité sortante et configuration DNS requise</span><span class="sxs-lookup"><span data-stu-id="785cb-148">Outbound Connectivity and DNS Requirements</span></span>
<span data-ttu-id="785cb-149">Pour qu’un environnement App Service fonctionne correctement, il requiert également un accès sortant à différents points de terminaison.</span><span class="sxs-lookup"><span data-stu-id="785cb-149">For an App Service Environment to function properly, it also requires outbound access to various endpoints.</span></span> <span data-ttu-id="785cb-150">Une liste complète des points de terminaison externes utilisés par un ASE est disponible dans la section « Connectivité réseau requise » de l’article [Configuration réseau pour ExpressRoute](app-service-app-service-environment-network-configuration-expressroute.md#required-network-connectivity) .</span><span class="sxs-lookup"><span data-stu-id="785cb-150">A full list of the external endpoints used by an ASE is in the "Required Network Connectivity" section of the [Network Configuration for ExpressRoute](app-service-app-service-environment-network-configuration-expressroute.md#required-network-connectivity) article.</span></span>

<span data-ttu-id="785cb-151">Les environnements App Service nécessitent une infrastructure DNS valide configurée pour le réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="785cb-151">App Service Environments require a valid DNS infrastructure configured for the virtual network.</span></span>  <span data-ttu-id="785cb-152">Si, pour une raison quelconque, la configuration DNS est modifiée après la création d'un environnement App Service, les développeurs peuvent forcer un environnement App Service à récupérer la nouvelle configuration DNS.</span><span class="sxs-lookup"><span data-stu-id="785cb-152">If for any reason the DNS configuration is changed after an App Service Environment has been created, developers can force an App Service Environment to pick up the new DNS configuration.</span></span>  <span data-ttu-id="785cb-153">Le déclenchement du redémarrage d’un environnement propagé à l’aide de l’icône « Redémarrer » située en haut du panneau de gestion de l’environnement App Service du [portail Azure][NewPortal] force l’environnement à récupérer la nouvelle configuration DNS.</span><span class="sxs-lookup"><span data-stu-id="785cb-153">Triggering a rolling environment reboot using the "Restart" icon located at the top of the App Service Environment management blade in the [Azure portal][NewPortal] will cause the environment to pick up the new DNS configuration.</span></span>

<span data-ttu-id="785cb-154">Il est également recommandé de configurer les serveurs DNS personnalisés sur le réseau virtuel à l'avance, avant de créer un environnement App Service.</span><span class="sxs-lookup"><span data-stu-id="785cb-154">It is also recommended that any custom DNS servers on the vnet be setup ahead of time prior to creating an App Service Environment.</span></span>  <span data-ttu-id="785cb-155">Si la configuration DNS d'un réseau virtuel est modifiée pendant la création d'un environnement App Service, alors le processus de création de l'environnement App Service échouera.</span><span class="sxs-lookup"><span data-stu-id="785cb-155">If a virtual network's DNS configuration is changed while an App Service Environment is being created, that will result in the App Service Environment creation process failing.</span></span>  <span data-ttu-id="785cb-156">De même, s’il existe un serveur DNS personnalisé à l’autre extrémité d’une passerelle VPN et que le serveur DNS n’est pas accessible ou disponible, le processus de création d’un environnement App Service échoue également.</span><span class="sxs-lookup"><span data-stu-id="785cb-156">In a similar vein, if a custom DNS server exists on the other end of a VPN gateway, and the DNS server is unreachable or unavailable, the App Service Environment creation process will also fail.</span></span>

## <a name="creating-a-network-security-group"></a><span data-ttu-id="785cb-157">Création d'un groupe de sécurité réseau</span><span class="sxs-lookup"><span data-stu-id="785cb-157">Creating a Network Security Group</span></span>
<span data-ttu-id="785cb-158">Pour plus d'informations sur le fonctionnement des groupes de sécurité réseau, consultez les [informations][NetworkSecurityGroups] suivantes.</span><span class="sxs-lookup"><span data-stu-id="785cb-158">For full details on how network security groups work see the following [information][NetworkSecurityGroups].</span></span>  <span data-ttu-id="785cb-159">L’exemple Gestion des services Azure ci-dessous aborde les points principaux relatifs aux groupes de sécurité réseau, en se concentrant sur la configuration et l’application d’un groupe de sécurité réseau à un sous-réseau contenant un environnement App Service.</span><span class="sxs-lookup"><span data-stu-id="785cb-159">The Azure Service Management example below touches on highlights of network security groups, with a focus on configuring and applying a network security group to a subnet that contains an App Service Environment.</span></span>

<span data-ttu-id="785cb-160">**Remarque :** les groupes de sécurité réseau peuvent être configurés sous forme graphique à l’aide du [portail Azure](https://portal.azure.com) ou via Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="785cb-160">**Note:** Network security groups can be configured graphically using the [Azure Portal](https://portal.azure.com) or through Azure PowerShell.</span></span>

<span data-ttu-id="785cb-161">Les groupes de sécurité réseau sont tout d’abord créés en tant qu’entités autonomes associées à un abonnement.</span><span class="sxs-lookup"><span data-stu-id="785cb-161">Network security groups are first created as a standalone entity associated with a subscription.</span></span> <span data-ttu-id="785cb-162">Dans la mesure où les groupes de sécurité réseau sont créés dans une région Azure, assurez-vous que le groupe de sécurité réseau est créé dans la même région que l'environnement App Service.</span><span class="sxs-lookup"><span data-stu-id="785cb-162">Since network security groups are created in an Azure region, ensure that the network security group is created in the same region as the App Service Environment.</span></span>

<span data-ttu-id="785cb-163">Voici un exemple de création d'un groupe de sécurité réseau :</span><span class="sxs-lookup"><span data-stu-id="785cb-163">The following demonstrates creating a network security group:</span></span>

    New-AzureNetworkSecurityGroup -Name "testNSGexample" -Location "South Central US" -Label "Example network security group for an app service environment"

<span data-ttu-id="785cb-164">Une fois un groupe de sécurité réseau créé, une ou plusieurs règles de sécurité réseau lui sont ajoutées.</span><span class="sxs-lookup"><span data-stu-id="785cb-164">Once a network security group is created, one or more network security rules are added to it.</span></span>  <span data-ttu-id="785cb-165">Étant donné que l'ensemble de règles peut changer au fil du temps, il est recommandé d'espacer le modèle de numérotation utilisé pour les priorités des règles pour faciliter l'insertion de règles supplémentaires dans le temps.</span><span class="sxs-lookup"><span data-stu-id="785cb-165">Since the set of rules may change over time, it is recommended to space out the numbering scheme used for rule priorities to make it easy to insert additional rules over time.</span></span>

<span data-ttu-id="785cb-166">L'exemple ci-dessous montre une règle qui accorde explicitement l'accès aux ports de gestion requis par l'infrastructure Azure pour gérer et maintenir un environnement App Service.</span><span class="sxs-lookup"><span data-stu-id="785cb-166">The example below shows a rule that explicitly grants access to the management ports needed by the Azure infrastructure to manage and maintain an App Service Environment.</span></span>  <span data-ttu-id="785cb-167">Notez que tout le trafic de gestion transite sur SSL et est sécurisé par des certificats clients. Par conséquent, même si les ports sont ouverts, ils sont inaccessibles à toute entité autre que l'infrastructure de gestion Azure.</span><span class="sxs-lookup"><span data-stu-id="785cb-167">Note that all management traffic flows over SSL and is secured by client certificates, so even though the ports are opened they are inaccessible by any entity other than Azure management infrastructure.</span></span>

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "ALLOW AzureMngmt" -Type Inbound -Priority 100 -Action Allow -SourceAddressPrefix 'INTERNET'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '454-455' -Protocol TCP


<span data-ttu-id="785cb-168">Lors du verrouillage de l'accès aux ports 80 et 443 pour « masquer » un environnement App Service derrière des appareils ou services en amont, vous devez connaître l'adresse IP en amont.</span><span class="sxs-lookup"><span data-stu-id="785cb-168">When locking down access to port 80 and 443 to "hide" an App Service Environment behind upstream devices or services, you will need to know the upstream IP address.</span></span>  <span data-ttu-id="785cb-169">Par exemple, si vous utilisez un pare-feu d'applications web (WAF), ce pare-feu aura sa propre adresse IP (ou ses propres adresses IP) qu'il utilise lors de l'acheminement du trafic proxy vers un environnement App Service d'application en aval.</span><span class="sxs-lookup"><span data-stu-id="785cb-169">For example, if you are using a web application firewall (WAF), the WAF will have its own IP address (or addresses) which it uses when proxying traffic to a downstream App Service Environment.</span></span>  <span data-ttu-id="785cb-170">Vous devez utiliser cette adresse IP dans le paramètre *SourceAddressPrefix* d'une règle de sécurité réseau.</span><span class="sxs-lookup"><span data-stu-id="785cb-170">You will need to use this IP address in the *SourceAddressPrefix* parameter of a network security rule.</span></span>

<span data-ttu-id="785cb-171">Dans l'exemple ci-dessous, le trafic entrant à partir d'une adresse IP en amont spécifique est explicitement autorisé.</span><span class="sxs-lookup"><span data-stu-id="785cb-171">In the example below, inbound traffic from a specific upstream IP address is explicitly allowed.</span></span>  <span data-ttu-id="785cb-172">L'adresse *1.2.3.4* est utilisée comme un espace réservé pour l'adresse IP d'un pare-feu d'applications web (WAF) en amont.</span><span class="sxs-lookup"><span data-stu-id="785cb-172">The address *1.2.3.4* is used as a placeholder for the IP address of an upstream WAF.</span></span>  <span data-ttu-id="785cb-173">Modifiez la valeur pour la faire correspondre à l'adresse utilisée par votre service ou appareil en amont.</span><span class="sxs-lookup"><span data-stu-id="785cb-173">Change the value to match the address used by your upstream device or service.</span></span>

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT HTTP" -Type Inbound -Priority 200 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '80' -Protocol TCP
    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT HTTPS" -Type Inbound -Priority 300 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '443' -Protocol TCP

<span data-ttu-id="785cb-174">Si la prise en charge FTP est souhaitée, les règles suivantes peuvent être utilisées comme modèle pour accorder l'accès au port de contrôle FTP et aux ports du canal de contrôle.</span><span class="sxs-lookup"><span data-stu-id="785cb-174">If FTP support is desired, the following rules can be used as a template to grant access to the FTP control port and data channel ports.</span></span>  <span data-ttu-id="785cb-175">Étant donné que FTP est un protocole avec état, il se peut que vous ne puissiez pas acheminer le trafic FTP via un pare-feu HTTP/HTTPS ou un appareil proxy traditionnel.</span><span class="sxs-lookup"><span data-stu-id="785cb-175">Since FTP is a stateful protocol, you may not be able to route FTP traffic through a traditional HTTP/HTTPS firewall or proxy device.</span></span>  <span data-ttu-id="785cb-176">Dans ce cas, vous devez définir le paramètre *SourceAddressPrefix* sur une autre valeur (par exemple, la plage d'adresses IP de machines de développement ou de déploiement sur lesquelles s'exécutent les clients FTP.</span><span class="sxs-lookup"><span data-stu-id="785cb-176">In this case you will need to set the *SourceAddressPrefix* to a different value - for example the IP address range of developer or deployment machines on which FTP clients are running.</span></span> 

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT FTPCtrl" -Type Inbound -Priority 400 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '21' -Protocol TCP
    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT FTPDataRange" -Type Inbound -Priority 500 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '10001-10020' -Protocol TCP

<span data-ttu-id="785cb-177">(**Remarque :** la plage de ports du canal de données peut changer pendant la durée de la version préliminaire.)</span><span class="sxs-lookup"><span data-stu-id="785cb-177">(**Note:**  the data channel port range may change during the preview period.)</span></span>

<span data-ttu-id="785cb-178">Si le débogage à distance avec Visual Studio est utilisé, les règles suivantes montrent comment accorder l'accès.</span><span class="sxs-lookup"><span data-stu-id="785cb-178">If remote debugging with Visual Studio is used, the following rules demonstrate how to grant access.</span></span>  <span data-ttu-id="785cb-179">Il existe une règle distincte pour chaque version prise en charge de Visual Studio, car chaque version utilise un port différent pour le débogage à distance.</span><span class="sxs-lookup"><span data-stu-id="785cb-179">There is a separate rule for each supported version of Visual Studio since each version uses a different port for remote debugging.</span></span>  <span data-ttu-id="785cb-180">Comme avec l'accès FTP, il est possible que le trafic du débogage à distance ne transite pas correctement via un pare-feu d'applications web (WAF) ou un appareil proxy traditionnel.</span><span class="sxs-lookup"><span data-stu-id="785cb-180">As with FTP access, remote debugging traffic may not flow properly through a traditional WAF or proxy device.</span></span>  <span data-ttu-id="785cb-181">À la place, le paramètre *SourceAddressPrefix* peut être défini sur la plage d'adresses IP des machines de développement exécutant Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="785cb-181">The *SourceAddressPrefix* can instead be set to the IP address range of developer machines running Visual Studio.</span></span>

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT RemoteDebuggingVS2012" -Type Inbound -Priority 600 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '4016' -Protocol TCP
    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT RemoteDebuggingVS2013" -Type Inbound -Priority 700 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '4018' -Protocol TCP
    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT RemoteDebuggingVS2015" -Type Inbound -Priority 800 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '4020' -Protocol TCP

## <a name="assigning-a-network-security-group-to-a-subnet"></a><span data-ttu-id="785cb-182">Affectation d'un groupe de sécurité réseau à un sous-réseau</span><span class="sxs-lookup"><span data-stu-id="785cb-182">Assigning a Network Security Group to a Subnet</span></span>
<span data-ttu-id="785cb-183">Un groupe de sécurité réseau comporte une règle de sécurité par défaut qui refuse l'accès à tout le trafic externe.</span><span class="sxs-lookup"><span data-stu-id="785cb-183">A network security group has a default security rule which denies access to all external traffic.</span></span>  <span data-ttu-id="785cb-184">En résultat de la combinaison des règles de sécurité réseau décrites ci-dessus et de la règle de sécurité par défaut bloquant le trafic entrant, seul le trafic provenant de plages d'adresses sources associées à une action *Autoriser* pourra être envoyé vers des applications qui s'exécutent dans un environnement App Service.</span><span class="sxs-lookup"><span data-stu-id="785cb-184">The result from combining the network security rules described above, and the default security rule blocking inbound traffic, is that only traffic from source address ranges associated with an *Allow* action will be able to send traffic to apps running in an App Service Environment.</span></span>

<span data-ttu-id="785cb-185">Une fois un groupe de sécurité réseau rempli avec des règles de sécurité, il doit être affecté au sous-réseau contenant l'environnement App Service.</span><span class="sxs-lookup"><span data-stu-id="785cb-185">After a network security group is populated with security rules, it needs to be assigned to the subnet containing the App Service Environment.</span></span>  <span data-ttu-id="785cb-186">La commande d'affectation fait référence à la fois au nom du réseau virtuel dans lequel réside l'environnement App Service et au nom du sous-réseau dans lequel l'environnement App Service a été créé.</span><span class="sxs-lookup"><span data-stu-id="785cb-186">The assignment command references both the name of the virtual network where the App Service Environment resides, as well as the name of the subnet where the App Service Environment was created.</span></span>  

<span data-ttu-id="785cb-187">L'exemple ci-dessous présente un groupe de sécurité réseau attribué à un sous-réseau et un réseau virtuel :</span><span class="sxs-lookup"><span data-stu-id="785cb-187">The example below shows a network security group being assigned to a subnet and virtual network:</span></span>

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityGroupToSubnet -VirtualNetworkName 'testVNet' -SubnetName 'Subnet-test'

<span data-ttu-id="785cb-188">Une fois l'affectation du groupe de sécurité réseau réussie (l'affectation est une opération longue qui peut prendre quelques minutes), seul le trafic entrant respectant les règles *Autoriser* peut atteindre des applications de l'environnement App Service.</span><span class="sxs-lookup"><span data-stu-id="785cb-188">Once the network security group assignment succeeds (the assignment is a long-running operations and can take a few minutes to complete), only inbound traffic matching *Allow* rules will successfully reach apps in the App Service Environment.</span></span>

<span data-ttu-id="785cb-189">Par souci d'exhaustivité, l'exemple suivant montre comment supprimer, et donc dissocier, le groupe de sécurité réseau du sous-réseau :</span><span class="sxs-lookup"><span data-stu-id="785cb-189">For completeness the following example shows how to remove and thus dis-associate the network security group from the subnet:</span></span>

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Remove-AzureNetworkSecurityGroupFromSubnet -VirtualNetworkName 'testVNet' -SubnetName 'Subnet-test'

## <a name="special-considerations-for-explicit-ip-ssl"></a><span data-ttu-id="785cb-190">Considérations spécifiques concernant les adresses IP SSL explicites</span><span class="sxs-lookup"><span data-stu-id="785cb-190">Special Considerations for Explicit IP-SSL</span></span>
<span data-ttu-id="785cb-191">Si une application est configurée avec une adresse IP explicite (applicable *uniquement* aux environnements ASE qui ont une adresse IP virtuelle publique), au lieu de l’adresse IP par défaut de l’environnement App Service, le trafic HTTP et HTTPS transite dans le sous-réseau via un ensemble de ports autres que les ports 80 et 443.</span><span class="sxs-lookup"><span data-stu-id="785cb-191">If an app is configured with an explicit IP-SSL address (applicable *only* to ASEs that have a public VIP), instead of using the default IP address of the App Service Environment, both HTTP and HTTPS traffic flows into the subnet over a different set of ports other than ports 80 and 443.</span></span>

<span data-ttu-id="785cb-192">Vous trouverez la paire de ports utilisés par chaque adresse IP SSL individuelle dans l’interface utilisateur du portail, dans le panneau UX des détails de l’environnement App Service.</span><span class="sxs-lookup"><span data-stu-id="785cb-192">The individual pair of ports used by each IP-SSL address can be found in the portal user interface from the App Service Environment's details UX blade.</span></span>  <span data-ttu-id="785cb-193">Sélectionnez « Tous les paramètres » --> « Adresses IP ».</span><span class="sxs-lookup"><span data-stu-id="785cb-193">Select "All settings" --> "IP addresses".</span></span>  <span data-ttu-id="785cb-194">Le panneau « Adresses IP » affiche un tableau de toutes les adresses IP SSL configurées explicitement pour l’environnement App Service, ainsi que la paire de ports spéciale utilisée pour acheminer le trafic HTTP et HTTPS associé à chaque adresse IP SSL.</span><span class="sxs-lookup"><span data-stu-id="785cb-194">The "IP addresses" blade shows a table of all explicitly configured IP-SSL addresses for the App Service Environment, along with the special port pair that is used to route HTTP and HTTPS traffic associated with each IP-SSL address.</span></span>  <span data-ttu-id="785cb-195">Il s’agit de la paire de ports à utiliser pour les paramètres DestinationPortRange lors de la configuration de règles dans un groupe de sécurité réseau.</span><span class="sxs-lookup"><span data-stu-id="785cb-195">It is this port pair that needs to be used for the DestinationPortRange parameters when configuring rules in a network security group.</span></span>

<span data-ttu-id="785cb-196">Lorsqu’une application sur un environnement App Service est configurée pour utiliser IP-SSL, les clients externes ne voient pas et n’ont pas à se préoccuper du mappage spécial de la paire de ports.</span><span class="sxs-lookup"><span data-stu-id="785cb-196">When an app on an ASE is configured to use IP-SSL, external customers will not see and do not need to worry about the special port pair mapping.</span></span>  <span data-ttu-id="785cb-197">Le trafic vers les applications se dirigera normalement vers l’adresse IP-SSL configurée.</span><span class="sxs-lookup"><span data-stu-id="785cb-197">Traffic to the apps will flow normally to the configured IP-SSL address.</span></span>  <span data-ttu-id="785cb-198">La traduction automatique de la paire de port spéciale se produit en interne pendant la dernière phase du routage du trafic dans un sous-réseau contenant l’ASE.</span><span class="sxs-lookup"><span data-stu-id="785cb-198">The translation to the special port pair automatically happens internally during the final leg of routing traffic into the subnet containing the ASE.</span></span> 

## <a name="getting-started"></a><span data-ttu-id="785cb-199">Prise en main</span><span class="sxs-lookup"><span data-stu-id="785cb-199">Getting started</span></span>
<span data-ttu-id="785cb-200">Pour bien démarrer avec les environnements App Service, consultez [Présentation de l’environnement App Service][IntroToAppServiceEnvironment]</span><span class="sxs-lookup"><span data-stu-id="785cb-200">To get started with App Service Environments, see [Introduction to App Service Environment][IntroToAppServiceEnvironment]</span></span>

<span data-ttu-id="785cb-201">Tous les articles et procédures concernant les environnements App Service sont disponibles dans le [fichier Lisez-moi des environnements App Service](../app-service/app-service-app-service-environments-readme.md).</span><span class="sxs-lookup"><span data-stu-id="785cb-201">All articles and How-To's for App Service Environments are available in the [README for Application Service Environments](../app-service/app-service-app-service-environments-readme.md).</span></span>

<span data-ttu-id="785cb-202">Pour plus d’informations sur les applications se connectant de manière sécurisée à des ressources de backend à partir d’un environnement App Service, consultez [Connexion sécurisée à des ressources de backend à partir d’un environnement App Service][SecurelyConnecttoBackend].</span><span class="sxs-lookup"><span data-stu-id="785cb-202">For details around apps securely connecting to backend resource from an App Service Environment, see [Securely connecting to Backend resources from an App Service Environment][SecurelyConnecttoBackend]</span></span>

<span data-ttu-id="785cb-203">Pour plus d’informations sur la plateforme Azure App Service, consultez la rubrique [Azure App Service][AzureAppService].</span><span class="sxs-lookup"><span data-stu-id="785cb-203">For more information about the Azure App Service platform, see [Azure App Service][AzureAppService].</span></span>

[!INCLUDE [app-service-web-whats-changed](../../includes/app-service-web-whats-changed.md)]

[!INCLUDE [app-service-web-try-app-service](../../includes/app-service-web-try-app-service.md)]

<!-- LINKS -->
[virtualnetwork]: https://azure.microsoft.com/documentation/articles/virtual-networks-faq/
[HowToCreateAnAppServiceEnvironment]: http://azure.microsoft.com/documentation/articles/app-service-web-how-to-create-an-app-service-environment/
[NetworkSecurityGroups]: https://azure.microsoft.com/documentation/articles/virtual-networks-nsg/
[AzureAppService]: http://azure.microsoft.com/documentation/articles/app-service-value-prop-what-is/
[IntroToAppServiceEnvironment]:  http://azure.microsoft.com/documentation/articles/app-service-app-service-environment-intro/
[SecurelyConnecttoBackend]:  http://azure.microsoft.com/documentation/articles/app-service-app-service-environment-securely-connecting-to-backend-resources/
[NewPortal]:  https://portal.azure.com  

<!-- IMAGES -->

