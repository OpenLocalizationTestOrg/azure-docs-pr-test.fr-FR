---
title: aaaUse de calcul intensif machines virtuelles de Azure avec le traitement par lots | Documents Microsoft
description: "Comment parti tootake de machine virtuelle prenant en charge RDMA ou GPU compatible tailles dans des pools d’Azure Batch"
services: batch
documentationcenter: 
author: dlepow
manager: timlt
editor: 
ms.assetid: 
ms.service: batch
ms.workload: big-compute
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/27/2017
ms.author: danlep
ms.openlocfilehash: 6a462a5f2a44ddcec8bf4e5c200d444cac8fafe6
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="use-rdma-capable-or-gpu-enabled-instances-in-batch-pools"></a><span data-ttu-id="da135-103">Utiliser des instances compatibles RDMA ou GPU dans les pools Batch</span><span class="sxs-lookup"><span data-stu-id="da135-103">Use RDMA-capable or GPU-enabled instances in Batch pools</span></span>

<span data-ttu-id="da135-104">toorun certains traitements par lots, vous souhaiterez peut-être parti tootake des tailles de machine virtuelle Azure conçu pour le calcul à grande échelle.</span><span class="sxs-lookup"><span data-stu-id="da135-104">toorun certain Batch jobs, you might want tootake advantage of Azure VM sizes designed for large-scale computation.</span></span> <span data-ttu-id="da135-105">Par exemple, les instances multiples toorun [les charges de travail MPI](batch-mpi.md), vous pouvez choisir A8, A9, ou tailles H-série qui ont un réseau de l’interface d’accès à distance directe mémoire (RDMA).</span><span class="sxs-lookup"><span data-stu-id="da135-105">For example, toorun multi-instance [MPI workloads](batch-mpi.md), you can choose A8, A9, or H-series sizes that have a network interface for Remote Direct Memory Access (RDMA).</span></span> <span data-ttu-id="da135-106">Ces tailles de connecter le réseau InfiniBand de tooan pour la communication entre les nœuds, ce qui peut accélérer les applications MPI.</span><span class="sxs-lookup"><span data-stu-id="da135-106">These sizes connect tooan InfiniBand network for inter-node communication, which can accelerate MPI applications.</span></span> <span data-ttu-id="da135-107">Pour les applications CUDA, vous pouvez choisir des tailles de série N qui incluent des cartes d’unité de traitement graphique (GPU) NVIDIA Tesla.</span><span class="sxs-lookup"><span data-stu-id="da135-107">Or for CUDA applications, you can choose N-series sizes that include NVIDIA Tesla graphics processing unit (GPU) cards.</span></span>

<span data-ttu-id="da135-108">Cet article fournit des instructions et des exemples toouse quelques-uns des formats de spécialisées d’Azure dans les pools de lot.</span><span class="sxs-lookup"><span data-stu-id="da135-108">This article provides guidance and examples toouse some of Azure's specialized sizes in Batch pools.</span></span> <span data-ttu-id="da135-109">Pour obtenir des informations générales et en savoir plus sur les caractéristiques techniques, consultez :</span><span class="sxs-lookup"><span data-stu-id="da135-109">For specs and background, see:</span></span>

* <span data-ttu-id="da135-110">Tailles de machines virtuelles de calcul haute performance ([Linux](../virtual-machines/linux/sizes-hpc.md), [Windows](../virtual-machines/windows/sizes-hpc.md))</span><span class="sxs-lookup"><span data-stu-id="da135-110">High performance compute VM sizes ([Linux](../virtual-machines/linux/sizes-hpc.md), [Windows](../virtual-machines/windows/sizes-hpc.md))</span></span> 

* <span data-ttu-id="da135-111">Tailles de machines virtuelles Linux compatibles GPU ([Linux](../virtual-machines/linux/sizes-gpu.md), [Windows](../virtual-machines/windows/sizes-gpu.md))</span><span class="sxs-lookup"><span data-stu-id="da135-111">GPU-enabled VM sizes ([Linux](../virtual-machines/linux/sizes-gpu.md), [Windows](../virtual-machines/windows/sizes-gpu.md))</span></span> 


## <a name="subscription-and-account-limits"></a><span data-ttu-id="da135-112">Limites de compte et d’abonnement</span><span class="sxs-lookup"><span data-stu-id="da135-112">Subscription and account limits</span></span>

* <span data-ttu-id="da135-113">**Quotas** -un ou plusieurs quotas Azure peuvent limiter hello nombre ou le type de nœuds, vous pouvez ajouter pool de traitement par lots tooa.</span><span class="sxs-lookup"><span data-stu-id="da135-113">**Quotas** - One or more Azure quotas may limit hello number or type of nodes you can add tooa Batch pool.</span></span> <span data-ttu-id="da135-114">Vous êtes toobe probablement limité lorsque vous choisissez prenant en charge RDMA, GPU compatible, ou autres tailles de machine virtuelle multicœurs.</span><span class="sxs-lookup"><span data-stu-id="da135-114">You are more likely toobe limited when you choose RDMA-capable, GPU-enabled, or other multicore VM sizes.</span></span> <span data-ttu-id="da135-115">En fonction de type hello du compte de traitement par lots créé, les quotas de hello pourraient s’appliquent compte toohello lui-même ou tooyour abonnement.</span><span class="sxs-lookup"><span data-stu-id="da135-115">Depending on hello type of Batch account you created, hello quotas could apply toohello account itself or tooyour subscription.</span></span>

    * <span data-ttu-id="da135-116">Si vous avez créé votre compte Batch Bonjour **lot service** configuration, vous êtes limité par hello [quota de cœurs dédiés par compte Batch](batch-quota-limit.md#resource-quotas).</span><span class="sxs-lookup"><span data-stu-id="da135-116">If you created your Batch account in hello **Batch service** configuration, you are limited by hello [dedicated cores quota per Batch account](batch-quota-limit.md#resource-quotas).</span></span> <span data-ttu-id="da135-117">Par défaut, ce quota est de 20 cœurs.</span><span class="sxs-lookup"><span data-stu-id="da135-117">By default, this quota is 20 cores.</span></span> <span data-ttu-id="da135-118">Un quota distinct s’applique également[machines virtuelles de faible priorité](batch-low-pri-vms.md), si vous les utilisez.</span><span class="sxs-lookup"><span data-stu-id="da135-118">A separate quota applies too[low-priority VMs](batch-low-pri-vms.md), if you use them.</span></span> 

    * <span data-ttu-id="da135-119">Si vous avez créé le compte de hello Bonjour **abonnement utilisateur** configuration, votre abonnement limite le nombre hello de cœurs de machine virtuelle par région.</span><span class="sxs-lookup"><span data-stu-id="da135-119">If you created hello account in hello **User subscription** configuration, your subscription limits hello number of VM cores per region.</span></span> <span data-ttu-id="da135-120">Consultez [Abonnement Azure et limites, quotas et contraintes de service](../azure-subscription-service-limits.md).</span><span class="sxs-lookup"><span data-stu-id="da135-120">See [Azure subscription and service limits, quotas, and constraints](../azure-subscription-service-limits.md).</span></span> <span data-ttu-id="da135-121">Votre abonnement s’applique également à un quota régionaux toocertain tailles de machine virtuelle, notamment des instances HPC et du GPU.</span><span class="sxs-lookup"><span data-stu-id="da135-121">Your subscription also applies a regional quota toocertain VM sizes, including HPC and GPU instances.</span></span> <span data-ttu-id="da135-122">Dans la configuration d’un abonnement utilisateur hello, aucune des quotas supplémentaires s’appliquent toohello du compte Batch.</span><span class="sxs-lookup"><span data-stu-id="da135-122">In hello user subscription configuration, no additional quotas apply toohello Batch account.</span></span> 

  <span data-ttu-id="da135-123">Vous devrez peut-être tooincrease un ou plusieurs quotas lors de l’utilisation d’une taille de machine virtuelle spécialisée dans le lot.</span><span class="sxs-lookup"><span data-stu-id="da135-123">You might need tooincrease one or more quotas when using a specialized VM size in Batch.</span></span> <span data-ttu-id="da135-124">toorequest une augmentation du quota, ouvrir une [demande de support technique en ligne](../azure-supportability/how-to-create-azure-support-request.md) sans frais.</span><span class="sxs-lookup"><span data-stu-id="da135-124">toorequest a quota increase, open an [online customer support request](../azure-supportability/how-to-create-azure-support-request.md) at no charge.</span></span>

* <span data-ttu-id="da135-125">**Disponibilité de la région** - calcul intensif machines virtuelles ne soient pas disponibles dans les régions hello où vous créez des comptes de traitement par lots.</span><span class="sxs-lookup"><span data-stu-id="da135-125">**Region availability** - Compute-intensive VMs might not be available in hello regions where you create your Batch accounts.</span></span> <span data-ttu-id="da135-126">toocheck qu’une taille n’est disponible, consultez [produits disponibles par région](https://azure.microsoft.com/regions/services/).</span><span class="sxs-lookup"><span data-stu-id="da135-126">toocheck that a size is available, see [Products available by region](https://azure.microsoft.com/regions/services/).</span></span>


## <a name="dependencies"></a><span data-ttu-id="da135-127">Dépendances</span><span class="sxs-lookup"><span data-stu-id="da135-127">Dependencies</span></span>

<span data-ttu-id="da135-128">Hello RDMA et les fonctionnalités GPU des tailles de calcul intensif sont pris en charge uniquement dans certains systèmes d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="da135-128">hello RDMA and GPU capabilities of compute-intensive sizes are supported only in certain operating systems.</span></span> <span data-ttu-id="da135-129">Selon votre système d’exploitation, vous deviez tooinstall ou configurer des pilotes supplémentaires ou autres logiciels.</span><span class="sxs-lookup"><span data-stu-id="da135-129">Depending on your operating system, you might need tooinstall or configure additional driver or other software.</span></span> <span data-ttu-id="da135-130">Hello les tableaux suivants résument ces dépendances.</span><span class="sxs-lookup"><span data-stu-id="da135-130">hello following tables summarize these dependencies.</span></span> <span data-ttu-id="da135-131">Pour plus de détails, consultez les articles associés.</span><span class="sxs-lookup"><span data-stu-id="da135-131">See linked articles for details.</span></span> <span data-ttu-id="da135-132">Pour les pools de lot tooconfigure options, consultez plus loin dans cet article.</span><span class="sxs-lookup"><span data-stu-id="da135-132">For options tooconfigure Batch pools, see later in this article.</span></span>


### <a name="linux-pools---virtual-machine-configuration"></a><span data-ttu-id="da135-133">Pools Linux - Configuration de machine virtuelle</span><span class="sxs-lookup"><span data-stu-id="da135-133">Linux pools - Virtual machine configuration</span></span>

| <span data-ttu-id="da135-134">Taille</span><span class="sxs-lookup"><span data-stu-id="da135-134">Size</span></span> | <span data-ttu-id="da135-135">Fonctionnalité</span><span class="sxs-lookup"><span data-stu-id="da135-135">Capability</span></span> | <span data-ttu-id="da135-136">Systèmes d’exploitation</span><span class="sxs-lookup"><span data-stu-id="da135-136">Operating systems</span></span> | <span data-ttu-id="da135-137">Logiciels requis</span><span class="sxs-lookup"><span data-stu-id="da135-137">Required software</span></span> | <span data-ttu-id="da135-138">Paramètres de pool</span><span class="sxs-lookup"><span data-stu-id="da135-138">Pool settings</span></span> |
| -------- | -------- | ----- |  -------- | ----- |
| [<span data-ttu-id="da135-139">H16r, H16mr, A8, A9</span><span class="sxs-lookup"><span data-stu-id="da135-139">H16r, H16mr, A8, A9</span></span>](../virtual-machines/linux/sizes-hpc.md#rdma-capable-instances) | <span data-ttu-id="da135-140">RDMA</span><span class="sxs-lookup"><span data-stu-id="da135-140">RDMA</span></span> | <span data-ttu-id="da135-141">HPC SUSE Linux Enterprise Server 12 ou</span><span class="sxs-lookup"><span data-stu-id="da135-141">SUSE Linux Enterprise Server 12 HPC or</span></span><br/><span data-ttu-id="da135-142">HPC basé sur CentOS</span><span class="sxs-lookup"><span data-stu-id="da135-142">CentOS-based HPC</span></span><br/><span data-ttu-id="da135-143">(Place de marché Azure)</span><span class="sxs-lookup"><span data-stu-id="da135-143">(Azure Marketplace)</span></span> | <span data-ttu-id="da135-144">Intel MPI 5</span><span class="sxs-lookup"><span data-stu-id="da135-144">Intel MPI 5</span></span> | <span data-ttu-id="da135-145">Activer la communication entre les nœuds, désactiver l’exécution simultanée des tâches</span><span class="sxs-lookup"><span data-stu-id="da135-145">Enable inter-node communication, disable concurrent task execution</span></span> |
| [<span data-ttu-id="da135-146">Série NC*</span><span class="sxs-lookup"><span data-stu-id="da135-146">NC series*</span></span>](../virtual-machines/linux/n-series-driver-setup.md#install-cuda-drivers-for-nc-vms) | <span data-ttu-id="da135-147">GPU NVIDIA Tesla K80</span><span class="sxs-lookup"><span data-stu-id="da135-147">NVIDIA Tesla K80 GPU</span></span> | <span data-ttu-id="da135-148">Ubuntu 16.04 LTS.</span><span class="sxs-lookup"><span data-stu-id="da135-148">Ubuntu 16.04 LTS.</span></span><br/><span data-ttu-id="da135-149">Red Hat Enterprise Linux 7.3 ou</span><span class="sxs-lookup"><span data-stu-id="da135-149">Red Hat Enterprise Linux 7.3, or</span></span><br/><span data-ttu-id="da135-150">Basé sur CentOS 7.3</span><span class="sxs-lookup"><span data-stu-id="da135-150">CentOS-based 7.3</span></span><br/><span data-ttu-id="da135-151">(Place de marché Azure)</span><span class="sxs-lookup"><span data-stu-id="da135-151">(Azure Marketplace)</span></span> | <span data-ttu-id="da135-152">Pilotes NVIDIA CUDA Toolkit 8.0</span><span class="sxs-lookup"><span data-stu-id="da135-152">NVIDIA CUDA Toolkit 8.0 drivers</span></span> | <span data-ttu-id="da135-153">N/A</span><span class="sxs-lookup"><span data-stu-id="da135-153">N/A</span></span> | 
| [<span data-ttu-id="da135-154">Série NV</span><span class="sxs-lookup"><span data-stu-id="da135-154">NV series</span></span>](../virtual-machines/linux/n-series-driver-setup.md#install-grid-drivers-for-nv-vms) | <span data-ttu-id="da135-155">GPU NVIDIA Tesla M60</span><span class="sxs-lookup"><span data-stu-id="da135-155">NVIDIA Tesla M60 GPU</span></span> | <span data-ttu-id="da135-156">Ubuntu 16.04 LTS</span><span class="sxs-lookup"><span data-stu-id="da135-156">Ubuntu 16.04 LTS</span></span><br/><span data-ttu-id="da135-157">Red Hat Enterprise Linux 7.3</span><span class="sxs-lookup"><span data-stu-id="da135-157">Red Hat Enterprise Linux 7.3</span></span><br/><span data-ttu-id="da135-158">Basé sur CentOS 7.3</span><span class="sxs-lookup"><span data-stu-id="da135-158">CentOS-based 7.3</span></span><br/><span data-ttu-id="da135-159">(Place de marché Azure)</span><span class="sxs-lookup"><span data-stu-id="da135-159">(Azure Marketplace)</span></span> | <span data-ttu-id="da135-160">Pilotes NVIDIA GRID 4.3</span><span class="sxs-lookup"><span data-stu-id="da135-160">NVIDIA GRID 4.3 drivers</span></span> | <span data-ttu-id="da135-161">N/A</span><span class="sxs-lookup"><span data-stu-id="da135-161">N/A</span></span> |

<span data-ttu-id="da135-162">*La connectivité RDMA sur les machines virtuelles NC24r est prise en charge sur HPC basé sur CentOS 7.3 avec Intel MPI.</span><span class="sxs-lookup"><span data-stu-id="da135-162">*RDMA connectivity on NC24r VMs is supported on CentOS-based 7.3 HPC with Intel MPI.</span></span>



### <a name="windows-pools---virtual-machine-configuration"></a><span data-ttu-id="da135-163">Pools Windows - Configuration de machine virtuelle</span><span class="sxs-lookup"><span data-stu-id="da135-163">Windows pools - Virtual machine configuration</span></span>

| <span data-ttu-id="da135-164">Taille</span><span class="sxs-lookup"><span data-stu-id="da135-164">Size</span></span> | <span data-ttu-id="da135-165">Fonctionnalité</span><span class="sxs-lookup"><span data-stu-id="da135-165">Capability</span></span> | <span data-ttu-id="da135-166">Systèmes d’exploitation</span><span class="sxs-lookup"><span data-stu-id="da135-166">Operating systems</span></span> | <span data-ttu-id="da135-167">Logiciels requis</span><span class="sxs-lookup"><span data-stu-id="da135-167">Required software</span></span> | <span data-ttu-id="da135-168">Paramètres de pool</span><span class="sxs-lookup"><span data-stu-id="da135-168">Pool settings</span></span> |
| -------- | ------ | -------- | -------- | ----- |
| [<span data-ttu-id="da135-169">H16r, H16mr, A8, A9</span><span class="sxs-lookup"><span data-stu-id="da135-169">H16r, H16mr, A8, A9</span></span>](../virtual-machines/windows/sizes-hpc.md#rdma-capable-instances) | <span data-ttu-id="da135-170">RDMA</span><span class="sxs-lookup"><span data-stu-id="da135-170">RDMA</span></span> | <span data-ttu-id="da135-171">Windows Server 2012 R2 ou</span><span class="sxs-lookup"><span data-stu-id="da135-171">Windows Server 2012 R2 or</span></span><br/><span data-ttu-id="da135-172">Windows Server 2012 (Place de marché Azure)</span><span class="sxs-lookup"><span data-stu-id="da135-172">Windows Server 2012 (Azure Marketplace)</span></span> | <span data-ttu-id="da135-173">Microsoft MPI 2012 R2 ou ultérieur, ou</span><span class="sxs-lookup"><span data-stu-id="da135-173">Microsoft MPI 2012 R2 or later, or</span></span><br/> <span data-ttu-id="da135-174">Intel MPI 5</span><span class="sxs-lookup"><span data-stu-id="da135-174">Intel MPI 5</span></span><br/><br/><span data-ttu-id="da135-175">Extension de machine virtuelle Azure HpcVMDrivers</span><span class="sxs-lookup"><span data-stu-id="da135-175">HpcVMDrivers Azure VM extension</span></span> | <span data-ttu-id="da135-176">Activer la communication entre les nœuds, désactiver l’exécution simultanée des tâches</span><span class="sxs-lookup"><span data-stu-id="da135-176">Enable inter-node communication, disable concurrent task execution</span></span> |
| [<span data-ttu-id="da135-177">Série NC*</span><span class="sxs-lookup"><span data-stu-id="da135-177">NC series*</span></span>](../virtual-machines/windows/n-series-driver-setup.md) | <span data-ttu-id="da135-178">GPU NVIDIA Tesla K80</span><span class="sxs-lookup"><span data-stu-id="da135-178">NVIDIA Tesla K80 GPU</span></span> | <span data-ttu-id="da135-179">Windows Server 2016 ou</span><span class="sxs-lookup"><span data-stu-id="da135-179">Windows Server 2016 or</span></span> <br/><span data-ttu-id="da135-180">Windows Server 2012 R2 (Place de marché Azure)</span><span class="sxs-lookup"><span data-stu-id="da135-180">Windows Server 2012 R2 (Azure Marketplace)</span></span> | <span data-ttu-id="da135-181">Pilotes NVIDIA Tesla ou pilotes CUDA Toolkit 8.0</span><span class="sxs-lookup"><span data-stu-id="da135-181">NVIDIA Tesla drivers or CUDA Toolkit 8.0 drivers</span></span>| <span data-ttu-id="da135-182">N/A</span><span class="sxs-lookup"><span data-stu-id="da135-182">N/A</span></span> | 
| [<span data-ttu-id="da135-183">Série NV</span><span class="sxs-lookup"><span data-stu-id="da135-183">NV series</span></span>](../virtual-machines/windows/n-series-driver-setup.md) | <span data-ttu-id="da135-184">GPU NVIDIA Tesla M60</span><span class="sxs-lookup"><span data-stu-id="da135-184">NVIDIA Tesla M60 GPU</span></span> | <span data-ttu-id="da135-185">Windows Server 2016 ou</span><span class="sxs-lookup"><span data-stu-id="da135-185">Windows Server 2016 or</span></span><br/><span data-ttu-id="da135-186">Windows Server 2012 R2 (Place de marché Azure)</span><span class="sxs-lookup"><span data-stu-id="da135-186">Windows Server 2012 R2 (Azure Marketplace)</span></span> | <span data-ttu-id="da135-187">Pilotes NVIDIA GRID 4.3</span><span class="sxs-lookup"><span data-stu-id="da135-187">NVIDIA GRID 4.3 drivers</span></span> | <span data-ttu-id="da135-188">N/A</span><span class="sxs-lookup"><span data-stu-id="da135-188">N/A</span></span> |

<span data-ttu-id="da135-189">*La connectivité RDMA sur les machines virtuelles NC24r est prise en charge sur Windows Server 2012 R2 avec l’extension HpcVMDrivers et Microsoft MPI ou Intel MPI.</span><span class="sxs-lookup"><span data-stu-id="da135-189">*RDMA connectivity on NC24r VMs is supported on Windows Server 2012 R2 with HpcVMDrivers extension and Microsoft MPI or Intel MPI.</span></span>

### <a name="windows-pools---cloud-services-configuration"></a><span data-ttu-id="da135-190">Pools Windows - Configuration des services cloud</span><span class="sxs-lookup"><span data-stu-id="da135-190">Windows pools - Cloud services configuration</span></span>

> [!NOTE]
> <span data-ttu-id="da135-191">Pools de lot avec la configuration des services cloud hello ne prend pas en charge les tailles de N-series.</span><span class="sxs-lookup"><span data-stu-id="da135-191">N-series sizes are not supported in Batch pools with hello cloud services configuration.</span></span>
>

| <span data-ttu-id="da135-192">Taille</span><span class="sxs-lookup"><span data-stu-id="da135-192">Size</span></span> | <span data-ttu-id="da135-193">Fonctionnalité</span><span class="sxs-lookup"><span data-stu-id="da135-193">Capability</span></span> | <span data-ttu-id="da135-194">Systèmes d’exploitation</span><span class="sxs-lookup"><span data-stu-id="da135-194">Operating systems</span></span> | <span data-ttu-id="da135-195">Logiciels requis</span><span class="sxs-lookup"><span data-stu-id="da135-195">Required software</span></span> | <span data-ttu-id="da135-196">Paramètres de pool</span><span class="sxs-lookup"><span data-stu-id="da135-196">Pool settings</span></span> |
| -------- | ------- | -------- | -------- | ----- |
| [<span data-ttu-id="da135-197">H16r, H16mr, A8, A9</span><span class="sxs-lookup"><span data-stu-id="da135-197">H16r, H16mr, A8, A9</span></span>](../virtual-machines/windows/sizes-hpc.md#rdma-capable-instances) | <span data-ttu-id="da135-198">RDMA</span><span class="sxs-lookup"><span data-stu-id="da135-198">RDMA</span></span> | <span data-ttu-id="da135-199">Windows Server 2012 R2,</span><span class="sxs-lookup"><span data-stu-id="da135-199">Windows Server 2012 R2,</span></span><br/><span data-ttu-id="da135-200">Windows Server 2012 ou</span><span class="sxs-lookup"><span data-stu-id="da135-200">Windows Server 2012, or</span></span><br/><span data-ttu-id="da135-201">Windows Server 2008 R2 (Famille de système d’exploitation invité)</span><span class="sxs-lookup"><span data-stu-id="da135-201">Windows Server 2008 R2 (Guest OS family)</span></span> | <span data-ttu-id="da135-202">Microsoft MPI 2012 R2 ou ultérieur, ou</span><span class="sxs-lookup"><span data-stu-id="da135-202">Microsoft MPI 2012 R2 or later, or</span></span><br/><span data-ttu-id="da135-203">Intel MPI 5</span><span class="sxs-lookup"><span data-stu-id="da135-203">Intel MPI 5</span></span><br/><br/><span data-ttu-id="da135-204">Extension de machine virtuelle Azure HpcVMDrivers</span><span class="sxs-lookup"><span data-stu-id="da135-204">HpcVMDrivers Azure VM extension</span></span> | <span data-ttu-id="da135-205">Activer la communication entre les nœuds,</span><span class="sxs-lookup"><span data-stu-id="da135-205">Enable inter-node communication,</span></span><br/> <span data-ttu-id="da135-206">désactiver l’exécution simultanée des tâches</span><span class="sxs-lookup"><span data-stu-id="da135-206">disable concurrent task execution</span></span> |





## <a name="pool-configuration-options"></a><span data-ttu-id="da135-207">Options de configuration de pool</span><span class="sxs-lookup"><span data-stu-id="da135-207">Pool configuration options</span></span>

<span data-ttu-id="da135-208">tooconfigure une taille de machine virtuelle spécialisée pour votre pool de lot, hello API de lot et les outils fournissent plusieurs logiciels de tooinstall requis d’options ou les pilotes, y compris :</span><span class="sxs-lookup"><span data-stu-id="da135-208">tooconfigure a specialized VM size for your Batch pool, hello Batch APIs and tools provide several options tooinstall required software or drivers, including:</span></span>

* <span data-ttu-id="da135-209">[Démarrer la tâche](batch-api-basics.md#start-task) -télécharger un package d’installation comme un tooan de fichier de ressources compte de stockage Azure Bonjour même région que hello compte Batch.</span><span class="sxs-lookup"><span data-stu-id="da135-209">[Start task](batch-api-basics.md#start-task) - Upload an installation package as a resource file tooan Azure storage account in hello same region as hello Batch account.</span></span> <span data-ttu-id="da135-210">Créer un fichier de ressources hello tooinstall début tâche ligne de commande en mode silencieux au démarrage du pool de hello.</span><span class="sxs-lookup"><span data-stu-id="da135-210">Create a start task command line tooinstall hello resource file silently when hello pool starts.</span></span> <span data-ttu-id="da135-211">Pour plus d’informations, consultez hello [documentation de l’API REST](/rest/api/batchservice/add-a-pool-to-an-account#bk_starttask).</span><span class="sxs-lookup"><span data-stu-id="da135-211">For more information, see hello [REST API documentation](/rest/api/batchservice/add-a-pool-to-an-account#bk_starttask).</span></span>

  > [!NOTE] 
  > <span data-ttu-id="da135-212">tâche de démarrage Hello doit s’exécuter avec des autorisations avec élévation de privilèges (administrateur), et il doit attendre pour la réussite.</span><span class="sxs-lookup"><span data-stu-id="da135-212">hello start task must run with elevated (admin) permissions, and it must wait for success.</span></span>
  >

* <span data-ttu-id="da135-213">[Package d’application](batch-application-packages.md) - ajouter un tooyour de package d’installation compressé compte Batch et configurer une référence de package dans le pool de hello.</span><span class="sxs-lookup"><span data-stu-id="da135-213">[Application package](batch-application-packages.md) - Add a zipped installation package tooyour Batch account, and configure a package reference in hello pool.</span></span> <span data-ttu-id="da135-214">Ce paramètre télécharge et décompresse le package hello sur tous les nœuds dans le pool de hello.</span><span class="sxs-lookup"><span data-stu-id="da135-214">This setting uploads and unzips hello package on all nodes in hello pool.</span></span> <span data-ttu-id="da135-215">Si le package de hello est un programme d’installation, créer une application hello de démarrage tâche ligne de commande toosilently installation sur tous les nœuds de pool.</span><span class="sxs-lookup"><span data-stu-id="da135-215">If hello package is an installer, create a start task command line toosilently install hello app on all pool nodes.</span></span> <span data-ttu-id="da135-216">Vous pouvez également installer hello lorsqu’une tâche est planifiée toorun sur un nœud.</span><span class="sxs-lookup"><span data-stu-id="da135-216">Optionally, install hello package when a task is scheduled toorun on a node.</span></span>

* <span data-ttu-id="da135-217">[Image de pool personnalisé](batch-api-basics.md#pool) - création d’un Windows personnalisé ou l’image Linux VM qui contient les pilotes, logiciels ou autres paramètres nécessaires pour hello taille de machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="da135-217">[Custom pool image](batch-api-basics.md#pool) - Create a custom Windows or Linux VM image that contains drivers, software, or other settings required for hello VM size.</span></span> <span data-ttu-id="da135-218">Si vous avez créé votre compte Batch dans la configuration d’un abonnement utilisateur hello, spécifiez l’image personnalisée de hello pour votre pool de traitement par lots.</span><span class="sxs-lookup"><span data-stu-id="da135-218">If you created your Batch account in hello user subscription configuration, specify hello custom image for your Batch pool.</span></span> <span data-ttu-id="da135-219">(Les images personnalisées ne sont pas pris en charge dans les comptes dans la configuration du service de traitement par lots hello.) Images personnalisées utilisable uniquement avec les pools dans la configuration d’ordinateur virtuel hello.</span><span class="sxs-lookup"><span data-stu-id="da135-219">(Custom images are not supported in accounts in hello Batch service configuration.) Custom images can only be used with pools in hello virtual machine configuration.</span></span>

  > [!IMPORTANT]
  > <span data-ttu-id="da135-220">Dans les pools Batch, vous ne pouvez pas utiliser une image personnalisée créée avec des disques gérés ou avec le stockage Premium pour l’instant.</span><span class="sxs-lookup"><span data-stu-id="da135-220">In Batch pools, you can't currently use a custom image created with managed disks or with Premium storage.</span></span>
  >



* <span data-ttu-id="da135-221">[Traitement par lots chantier](https://github.com/Azure/batch-shipyard) configure automatiquement la toowork GPU et RDMA hello en toute transparence avec des charges de travail sur Azure Batch.</span><span class="sxs-lookup"><span data-stu-id="da135-221">[Batch Shipyard](https://github.com/Azure/batch-shipyard) automatically configures hello GPU and RDMA toowork transparently with containerized workloads on Azure Batch.</span></span> <span data-ttu-id="da135-222">Batch Shipyard est entièrement piloté par les fichiers de configuration.</span><span class="sxs-lookup"><span data-stu-id="da135-222">Batch Shipyard is entirely driven with configuration files.</span></span> <span data-ttu-id="da135-223">Il existe plusieurs exemples recette de configurations disponibles qui permettent les charges de travail GPU et RDMA telles que hello [CNTK GPU recette](https://github.com/Azure/batch-shipyard/tree/master/recipes/CNTK-GPU-OpenMPI) qui préconfigure les pilotes GPU sur des machines virtuelles de série N et charge les logiciels Microsoft cognitifs Toolkit comme une image Docker.</span><span class="sxs-lookup"><span data-stu-id="da135-223">There are many sample recipe configurations available that enable GPU and RDMA workloads such as hello [CNTK GPU Recipe](https://github.com/Azure/batch-shipyard/tree/master/recipes/CNTK-GPU-OpenMPI)  which preconfigures GPU drivers on N-series VMs and loads Microsoft Cognitive Toolkit software as a Docker image.</span></span>


## <a name="example-microsoft-mpi-on-an-a8-vm-pool"></a><span data-ttu-id="da135-224">Exemple : Microsoft MPI sur un pool de machines virtuelles A8</span><span class="sxs-lookup"><span data-stu-id="da135-224">Example: Microsoft MPI on an A8 VM pool</span></span>

<span data-ttu-id="da135-225">toorun les applications MPI de Windows sur un pool de nœuds d’Azure A8, vous devez tooinstall une implémentation MPI prise en charge.</span><span class="sxs-lookup"><span data-stu-id="da135-225">toorun Windows MPI applications on a pool of Azure A8 nodes, you need tooinstall a supported MPI implementation.</span></span> <span data-ttu-id="da135-226">Voici des exemples étapes tooinstall [Microsoft MPI](https://msdn.microsoft.com/library/bb524831(v=vs.85).aspx) sur un Windows du pool à l’aide d’un package d’application de traitement par lots.</span><span class="sxs-lookup"><span data-stu-id="da135-226">Here are sample steps tooinstall [Microsoft MPI](https://msdn.microsoft.com/library/bb524831(v=vs.85).aspx) on a Windows pool using a Batch application package.</span></span>

1. <span data-ttu-id="da135-227">Télécharger hello [le package d’installation](http://go.microsoft.com/FWLink/p/?LinkID=389556) (MSMpiSetup.exe) pour la version la plus récente de Microsoft MPI hello.</span><span class="sxs-lookup"><span data-stu-id="da135-227">Download hello [setup package](http://go.microsoft.com/FWLink/p/?LinkID=389556) (MSMpiSetup.exe) for hello latest version of Microsoft MPI.</span></span>
2. <span data-ttu-id="da135-228">Créer un fichier zip de package de hello.</span><span class="sxs-lookup"><span data-stu-id="da135-228">Create a zip file of hello package.</span></span>
3. <span data-ttu-id="da135-229">Téléchargez le compte de traitement par lots tooyour hello package.</span><span class="sxs-lookup"><span data-stu-id="da135-229">Upload hello package tooyour Batch account.</span></span> <span data-ttu-id="da135-230">Pour obtenir des instructions, consultez hello [les packages d’applications](batch-application-packages.md) des conseils.</span><span class="sxs-lookup"><span data-stu-id="da135-230">For steps, see hello [application packages](batch-application-packages.md) guidance.</span></span> <span data-ttu-id="da135-231">Spécifiez un ID d’application (par exemple *MSMPI*) et une version (par exemple *8.1*).</span><span class="sxs-lookup"><span data-stu-id="da135-231">Specify an application id such as *MSMPI*, and a version such as *8.1*.</span></span> 
4. <span data-ttu-id="da135-232">Hello API de lot ou le portail Azure, créez un pool dans configuration des services cloud hello avec numéro hello souhaité de nœuds et d’échelle.</span><span class="sxs-lookup"><span data-stu-id="da135-232">Using hello Batch APIs or Azure portal, create a pool in hello cloud services configuration with hello desired number of nodes and scale.</span></span> <span data-ttu-id="da135-233">Hello tableau suivant montre tooset de paramètres d’échantillon des MPI en mode sans assistance à l’aide d’une tâche de démarrage :</span><span class="sxs-lookup"><span data-stu-id="da135-233">hello following table shows sample settings tooset up MPI in unattended mode using a start task:</span></span>

| <span data-ttu-id="da135-234">Paramètre</span><span class="sxs-lookup"><span data-stu-id="da135-234">Setting</span></span> | <span data-ttu-id="da135-235">Valeur</span><span class="sxs-lookup"><span data-stu-id="da135-235">Value</span></span> |
| ---- | ----- | 
| <span data-ttu-id="da135-236">**Type d’image**</span><span class="sxs-lookup"><span data-stu-id="da135-236">**Image Type**</span></span> | <span data-ttu-id="da135-237">Services cloud</span><span class="sxs-lookup"><span data-stu-id="da135-237">Cloud Services</span></span> |
| <span data-ttu-id="da135-238">**Famille de système d’exploitation**</span><span class="sxs-lookup"><span data-stu-id="da135-238">**OS family**</span></span> | <span data-ttu-id="da135-239">Windows Server 2012 R2 (famille de système d’exploitation 4)</span><span class="sxs-lookup"><span data-stu-id="da135-239">Windows Server 2012 R2 (OS family 4)</span></span> |
| <span data-ttu-id="da135-240">**Taille du nœud**</span><span class="sxs-lookup"><span data-stu-id="da135-240">**Node size**</span></span> | <span data-ttu-id="da135-241">A8 Standard</span><span class="sxs-lookup"><span data-stu-id="da135-241">A8 Standard</span></span> |
| <span data-ttu-id="da135-242">**Communication entre les nœuds activée**</span><span class="sxs-lookup"><span data-stu-id="da135-242">**Internode communication enabled**</span></span> | <span data-ttu-id="da135-243">true</span><span class="sxs-lookup"><span data-stu-id="da135-243">True</span></span> |
| <span data-ttu-id="da135-244">**Nombre maximal de tâches par nœud**</span><span class="sxs-lookup"><span data-stu-id="da135-244">**Max tasks per node**</span></span> | <span data-ttu-id="da135-245">1</span><span class="sxs-lookup"><span data-stu-id="da135-245">1</span></span> |
| <span data-ttu-id="da135-246">**Références du package d’application**</span><span class="sxs-lookup"><span data-stu-id="da135-246">**Application package references**</span></span> | <span data-ttu-id="da135-247">MSMPI</span><span class="sxs-lookup"><span data-stu-id="da135-247">MSMPI</span></span> |
| <span data-ttu-id="da135-248">**Tâche de démarrage activée**</span><span class="sxs-lookup"><span data-stu-id="da135-248">**Start task enabled**</span></span> | <span data-ttu-id="da135-249">true</span><span class="sxs-lookup"><span data-stu-id="da135-249">True</span></span><br><span data-ttu-id="da135-250">**Ligne de commande** - `"cmd /c %AZ_BATCH_APP_PACKAGE_MSMPI#8.1%\\MSMpiSetup.exe -unattend -force"`</span><span class="sxs-lookup"><span data-stu-id="da135-250">**Command line** - `"cmd /c %AZ_BATCH_APP_PACKAGE_MSMPI#8.1%\\MSMpiSetup.exe -unattend -force"`</span></span><br/><span data-ttu-id="da135-251">**Identité de l’utilisateur** - Pool autouser, admin</span><span class="sxs-lookup"><span data-stu-id="da135-251">**User identity** - Pool autouser, admin</span></span><br/><span data-ttu-id="da135-252">**Attente de la réussite** - True</span><span class="sxs-lookup"><span data-stu-id="da135-252">**Wait for success** - True</span></span>

## <a name="example-nvidia-tesla-drivers-on-nc-vm-pool"></a><span data-ttu-id="da135-253">Exemple : Pilotes NVIDIA Tesla sur un pool de machines virtuelles NC</span><span class="sxs-lookup"><span data-stu-id="da135-253">Example: NVIDIA Tesla drivers on NC VM pool</span></span>

<span data-ttu-id="da135-254">applications de CUDA toorun sur un pool de nœuds de contexte de nommage de Linux, vous devez tooinstall CUDA Toolkit 8.0 sur les nœuds hello.</span><span class="sxs-lookup"><span data-stu-id="da135-254">toorun CUDA applications on a pool of Linux NC nodes, you need tooinstall CUDA Toolkit 8.0 on hello nodes.</span></span> <span data-ttu-id="da135-255">Hello Toolkit installe des pilotes de NVIDIA Tesla GPU nécessaires hello.</span><span class="sxs-lookup"><span data-stu-id="da135-255">hello Toolkit installs hello necessary NVIDIA Tesla GPU drivers.</span></span> <span data-ttu-id="da135-256">Voici un exemple suit toodeploy une image Ubuntu 16.04 LTS personnalisée avec les pilotes GPU hello :</span><span class="sxs-lookup"><span data-stu-id="da135-256">Here are sample steps toodeploy a custom Ubuntu 16.04 LTS image with hello GPU drivers:</span></span>

1. <span data-ttu-id="da135-257">Déployez une machine virtuelle Azure NC6 exécutant Ubuntu 16.04 LTS.</span><span class="sxs-lookup"><span data-stu-id="da135-257">Deploy an Azure NC6 VM running Ubuntu 16.04 LTS.</span></span> <span data-ttu-id="da135-258">Par exemple, créer hello machine virtuelle dans la région US Sud hello.</span><span class="sxs-lookup"><span data-stu-id="da135-258">For example, create hello VM in hello US South Central region.</span></span> <span data-ttu-id="da135-259">Vérifiez que vous créez hello machine virtuelle avec un stockage standard, et *sans* des disques gérés.</span><span class="sxs-lookup"><span data-stu-id="da135-259">Make sure that you create hello VM with standard storage, and *without* managed disks.</span></span>
2. <span data-ttu-id="da135-260">Suivez hello étapes tooconnect toohello VM et [installer des pilotes CUDA](../virtual-machines/linux/n-series-driver-setup.md#install-cuda-drivers-for-nc-vms).</span><span class="sxs-lookup"><span data-stu-id="da135-260">Follow hello steps tooconnect toohello VM and [install CUDA drivers](../virtual-machines/linux/n-series-driver-setup.md#install-cuda-drivers-for-nc-vms).</span></span>
3. <span data-ttu-id="da135-261">Annuler le déploiement de l’agent de hello Linux, puis vous capturez image Linux VM à l’aide des commandes hello Azure CLI 1.0.</span><span class="sxs-lookup"><span data-stu-id="da135-261">Deprovision hello Linux agent, and then capture Linux VM image using hello Azure CLI 1.0 commands.</span></span> <span data-ttu-id="da135-262">Pour connaître les étapes nécessaires, consultez [Capturer une machine virtuelle Linux exécutée sur Azure](../virtual-machines/linux/capture-image-nodejs.md).</span><span class="sxs-lookup"><span data-stu-id="da135-262">For steps, see [Capture a Linux virtual machine running on Azure](../virtual-machines/linux/capture-image-nodejs.md).</span></span> <span data-ttu-id="da135-263">Prenez note de l’URI d’image hello.</span><span class="sxs-lookup"><span data-stu-id="da135-263">Make a note of hello image URI.</span></span>
  > [!IMPORTANT]
  > <span data-ttu-id="da135-264">N’utilisez pas d’image de Azure CLI 2.0 commandes toocapture hello pour Azure Batch.</span><span class="sxs-lookup"><span data-stu-id="da135-264">Do not use Azure CLI 2.0 commands toocapture hello image for Azure Batch.</span></span> <span data-ttu-id="da135-265">Actuellement commandes hello CLI 2.0 ne capturer que les machines virtuelles créées à l’aide de disques gérés.</span><span class="sxs-lookup"><span data-stu-id="da135-265">Currently hello CLI 2.0 commands only capture VMs created using managed disks.</span></span>
  >
4. <span data-ttu-id="da135-266">Créez un compte Batch, avec configuration abonnement utilisateur hello, dans une région qui prend en charge des machines virtuelles de contexte de nommage.</span><span class="sxs-lookup"><span data-stu-id="da135-266">Create a Batch account, with hello user subscription configuration, in a region that supports NC VMs.</span></span>
5. <span data-ttu-id="da135-267">Hello API de lot ou le portail Azure, créez un pool à l’aide d’image personnalisée de hello et par hello souhaité nombre de nœuds et l’échelle.</span><span class="sxs-lookup"><span data-stu-id="da135-267">Using hello Batch APIs or Azure portal, create a pool using hello custom image and with hello desired number of nodes and scale.</span></span> <span data-ttu-id="da135-268">Hello tableau suivant présente les paramètres de pool exemple pour l’image de hello :</span><span class="sxs-lookup"><span data-stu-id="da135-268">hello following table shows sample pool settings for hello image:</span></span>

| <span data-ttu-id="da135-269">Paramètre</span><span class="sxs-lookup"><span data-stu-id="da135-269">Setting</span></span> | <span data-ttu-id="da135-270">Valeur</span><span class="sxs-lookup"><span data-stu-id="da135-270">Value</span></span> |
| ---- | ---- |
| <span data-ttu-id="da135-271">**Type d’image**</span><span class="sxs-lookup"><span data-stu-id="da135-271">**Image Type**</span></span> | <span data-ttu-id="da135-272">Image personnalisée</span><span class="sxs-lookup"><span data-stu-id="da135-272">Custom Image</span></span> |
| <span data-ttu-id="da135-273">**Image personnalisée**</span><span class="sxs-lookup"><span data-stu-id="da135-273">**Custom Image**</span></span> | <span data-ttu-id="da135-274">URI du formulaire de hello d’image`https://yourstorageaccountdisks.blob.core.windows.net/system/Microsoft.Compute/Images/vhds/MyVHDNamePrefix-osDisk.xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx.vhd`</span><span class="sxs-lookup"><span data-stu-id="da135-274">Image URI of hello form `https://yourstorageaccountdisks.blob.core.windows.net/system/Microsoft.Compute/Images/vhds/MyVHDNamePrefix-osDisk.xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx.vhd`</span></span> |
| <span data-ttu-id="da135-275">**Référence de l’agent de nœud**</span><span class="sxs-lookup"><span data-stu-id="da135-275">**Node agent SKU**</span></span> | <span data-ttu-id="da135-276">batch.node.ubuntu 16.04</span><span class="sxs-lookup"><span data-stu-id="da135-276">batch.node.ubuntu 16.04</span></span> |
| <span data-ttu-id="da135-277">**Taille du nœud**</span><span class="sxs-lookup"><span data-stu-id="da135-277">**Node size**</span></span> | <span data-ttu-id="da135-278">NC6 Standard</span><span class="sxs-lookup"><span data-stu-id="da135-278">NC6 Standard</span></span> |



## <a name="next-steps"></a><span data-ttu-id="da135-279">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="da135-279">Next steps</span></span>

* <span data-ttu-id="da135-280">toorun des travaux MPI sur un pool de traitement par lots Azure, consultez hello [Windows](batch-mpi.md) ou [Linux](https://blogs.technet.microsoft.com/windowshpc/2016/07/20/introducing-mpi-support-for-linux-on-azure-batch/) exemples.</span><span class="sxs-lookup"><span data-stu-id="da135-280">toorun MPI jobs on an Azure Batch pool, see hello [Windows](batch-mpi.md) or [Linux](https://blogs.technet.microsoft.com/windowshpc/2016/07/20/introducing-mpi-support-for-linux-on-azure-batch/) examples.</span></span>

* <span data-ttu-id="da135-281">Pour obtenir des exemples de charges de travail GPU sur le traitement par lots, consultez hello [lot chantier](https://github.com/Azure/batch-shipyard/) recettes.</span><span class="sxs-lookup"><span data-stu-id="da135-281">For examples of GPU workloads on Batch, see hello [Batch Shipyard](https://github.com/Azure/batch-shipyard/) recipes.</span></span>
