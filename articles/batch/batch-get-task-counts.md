---
title: "aaaMonitor de progression d’une tâche en comptant les tâches par état - Azure Batch | Documents Microsoft"
description: "Surveiller la progression de hello d’un travail en appelant l’opération d’obtenir le nombre de tâches hello toocount tâches pour un travail. Vous pouvez obtenir un nombre de tâches actives, en cours d’exécution et terminées et selon que les tâches ont réussi ou échoué."
services: batch
author: tamram
manager: timlt
ms.service: batch
ms.topic: article
ms.date: 08/02/2017
ms.author: tamram
ms.openlocfilehash: 03957d8a3d678bf44587f3bc7f988a76885c2af0
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="count-tasks-by-state-toomonitor-a-jobs-progress-preview"></a><span data-ttu-id="27892-104">Nombre de tâches par état toomonitor l’avancement d’une tâche (version préliminaire)</span><span class="sxs-lookup"><span data-stu-id="27892-104">Count tasks by state toomonitor a job's progress (Preview)</span></span>

<span data-ttu-id="27892-105">Traitement par lots Azure fournit une manière efficace toomonitor hello de progression d’une tâche lorsqu’elle s’exécute ses tâches.</span><span class="sxs-lookup"><span data-stu-id="27892-105">Azure Batch provides an efficient way toomonitor hello progress of a job as it runs its tasks.</span></span> <span data-ttu-id="27892-106">Vous pouvez appeler hello [obtenir le nombre de tâches] [ rest_get_task_counts] toofind opération le nombre de tâches est dans un état actif, en cours d’exécution ou terminé, et combien ont réussi ou échoué.</span><span class="sxs-lookup"><span data-stu-id="27892-106">You can call hello [Get Task Counts][rest_get_task_counts] operation toofind out how many tasks are in an active, running, or completed state, and how many have succeeded or failed.</span></span> <span data-ttu-id="27892-107">En comptant le nombre de hello de tâches dans chaque état, vous pouvez plus facilement afficher l’utilisateur de tooa de progression du travail hello ou détecter des retards inattendus ou des échecs qui peuvent affecter les travaux hello.</span><span class="sxs-lookup"><span data-stu-id="27892-107">By counting hello number of tasks in each state, you can more easily display hello job's progress tooa user, or detect unexpected delays or failures that may affect hello job.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="27892-108">Bonjour opération d’obtenir le nombre de tâches est actuellement en version préliminaire et n’est pas encore disponible dans Azure Government Azure Chine et Azure situés en Allemagne.</span><span class="sxs-lookup"><span data-stu-id="27892-108">hello Get Task Counts operation is currently in preview, and is not yet available in Azure Government, Azure China, and Azure Germany.</span></span> 
>
>

## <a name="how-tasks-are-counted"></a><span data-ttu-id="27892-109">Comptage des tâches</span><span class="sxs-lookup"><span data-stu-id="27892-109">How tasks are counted</span></span>

<span data-ttu-id="27892-110">Hello opération d’obtenir le nombre de tâches compte les tâches par état, comme suit :</span><span class="sxs-lookup"><span data-stu-id="27892-110">hello Get Task Counts operation counts tasks by state, as follows:</span></span>

- <span data-ttu-id="27892-111">Une tâche est comptée comme **active** quand il est toorun en file d’attente et en mesure, mais n’est pas actuellement affecté tooa de nœud de calcul.</span><span class="sxs-lookup"><span data-stu-id="27892-111">A task is counted as **active** when it is queued and able toorun, but is not currently assigned tooa compute node.</span></span> <span data-ttu-id="27892-112">Une tâche est également comptée comme **active** si elle dépend d’une tâche parente qui n’est pas encore terminée.</span><span class="sxs-lookup"><span data-stu-id="27892-112">A task is also counted as **active** if it is dependent on a parent task that has not yet completed.</span></span> <span data-ttu-id="27892-113">Pour plus d’informations sur les dépendances de tâche, consultez [toorun les tâches qui dépendent d’autres tâches de créer des interdépendances](batch-task-dependencies.md).</span><span class="sxs-lookup"><span data-stu-id="27892-113">For more information on task dependencies, see [Create task dependencies toorun tasks that depend on other tasks](batch-task-dependencies.md).</span></span> 
- <span data-ttu-id="27892-114">Une tâche est comptée comme **en cours d’exécution** quand il a été affecté tooa de nœud de calcul, mais n’est pas encore terminée.</span><span class="sxs-lookup"><span data-stu-id="27892-114">A task is counted as **running** when it has been assigned tooa compute node, but has not yet completed.</span></span> <span data-ttu-id="27892-115">Une tâche est comptée comme **en cours d’exécution** lorsque son état est `preparing` ou `running`, comme indiqué par hello [obtenir des informations sur une tâche] [ rest_get_task] opération.</span><span class="sxs-lookup"><span data-stu-id="27892-115">A task is counted as **running** when its state is either `preparing` or `running`, as indicated by hello [Get information about a task][rest_get_task] operation.</span></span>
- <span data-ttu-id="27892-116">Une tâche est comptée comme **terminé** quand il n’est plus toorun éligible.</span><span class="sxs-lookup"><span data-stu-id="27892-116">A task is counted as **completed** when it is no longer eligible toorun.</span></span> <span data-ttu-id="27892-117">Une tâche comptée comme **terminée** est une tâche qui s’est généralement déroulée correctement ou qui a échoué et a épuisé par ailleurs son nombre maximal de tentatives.</span><span class="sxs-lookup"><span data-stu-id="27892-117">A task counted as **completed** has typically either finished successfully, or has finished unsuccessfully and has also exhausted its retry limit.</span></span> 

<span data-ttu-id="27892-118">Hello opération d’obtenir le nombre de tâches signale également le nombre de tâches ayant a réussi ou échoué.</span><span class="sxs-lookup"><span data-stu-id="27892-118">hello Get Task Counts operation also reports how many tasks have succeeded or failed.</span></span> <span data-ttu-id="27892-119">Traitement par lots détermine si une tâche a réussi ou échoué en vérifiant hello **résultat** propriété Hello [executionInfo] [https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-task#executionInfo] propriété :</span><span class="sxs-lookup"><span data-stu-id="27892-119">Batch determines whether a task has succeeded or failed by checking hello **result** property of hello [executionInfo][https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-task#executionInfo] property:</span></span>

    - <span data-ttu-id="27892-120">Une tâche est comptée comme **a réussi** si le résultat de hello d’exécution de la tâche est `success`.</span><span class="sxs-lookup"><span data-stu-id="27892-120">A task is counted as **succeeded** if hello result of task execution is `success`.</span></span>
    - <span data-ttu-id="27892-121">Une tâche est comptée comme **échec** si le résultat de hello d’exécution de la tâche est `failure`.</span><span class="sxs-lookup"><span data-stu-id="27892-121">A task is counted as **failed** if hello result of task execution is `failure`.</span></span>

<span data-ttu-id="27892-122">Pour plus d’informations sur les états des tâches, consultez [Obtenir des informations sur une tâche][rest_get_task].</span><span class="sxs-lookup"><span data-stu-id="27892-122">For more information about task states, see [Get information about a task][rest_get_task].</span></span>

<span data-ttu-id="27892-123">Hello .NET code exemple suivant montre comment les tâches tooretrieve nombres par état :</span><span class="sxs-lookup"><span data-stu-id="27892-123">hello following .NET code sample shows how tooretrieve task counts by state:</span></span> 

```csharp
var taskCounts = await batchClient.JobOperations.GetTaskCountsAsync("job-1");

Console.WriteLine("Task count in active state: {0}", taskCounts.Active);
Console.WriteLine("Task count in preparing or running state: {0}", taskCounts.Running);
Console.WriteLine("Task count in completed state: {0}", taskCounts.Completed);
Console.WriteLine("Succeeded task count: {0}", taskCounts.Succeeded);
Console.WriteLine("Failed task count: {0}", taskCounts.Failed);
Console.WriteLine("ValidationStatus: {0}", taskCounts.ValidationStatus);
```

> [!NOTE]
> <span data-ttu-id="27892-124">Vous pouvez utiliser un modèle semblable pour REST et autres langages pris en charge tooget tâche compte pour un travail.</span><span class="sxs-lookup"><span data-stu-id="27892-124">You can use a similar pattern for REST and other supported languages tooget task counts for a job.</span></span> 
> 
> 

## <a name="consistency-checking-for-task-counts"></a><span data-ttu-id="27892-125">Vérification de la cohérence des nombres de tâches</span><span class="sxs-lookup"><span data-stu-id="27892-125">Consistency checking for task counts</span></span>

<span data-ttu-id="27892-126">service de traitement par lots Hello agrège les nombres de la tâche en collectant des données à partir de plusieurs parties d’un système distribué asynchrone.</span><span class="sxs-lookup"><span data-stu-id="27892-126">hello Batch service aggregates task counts by gathering data from multiple parts of an asynchronous distributed system.</span></span> <span data-ttu-id="27892-127">tooensure que les nombres de la tâche sont corrects, lot fournit une validation supplémentaire pour les États comptes en effectuant des vérifications de cohérence par rapport à plusieurs composants du système de hello.</span><span class="sxs-lookup"><span data-stu-id="27892-127">tooensure that task counts are correct, Batch provides additional validation for state counts by performing consistency checks against multiple components of hello system.</span></span> <span data-ttu-id="27892-128">Lot effectue ces vérifications de cohérence tant qu’il existe moins de 200 000 tâches dans la tâche de hello.</span><span class="sxs-lookup"><span data-stu-id="27892-128">Batch performs these consistency checks as long as there are fewer than 200,000 tasks in hello job.</span></span> <span data-ttu-id="27892-129">Hello improbable que la vérification de cohérence hello trouve des erreurs, lot corrige le résultat de hello d’opération d’obtenir le nombre de tâches hello basée sur les résultats de hello hello de vérification de cohérence.</span><span class="sxs-lookup"><span data-stu-id="27892-129">In hello unlikely event that hello consistency check finds errors, Batch corrects hello result of hello Get Tasks Counts operation based on hello results of hello consistency check.</span></span> <span data-ttu-id="27892-130">Bonjour la vérification de cohérence est une tooensure mesure supplémentaire que les clients qui s’appuient sur hello obtenir le nombre de tâches l’opération obtiennent des informations de droit hello que dont ils ont besoin pour leur solution.</span><span class="sxs-lookup"><span data-stu-id="27892-130">hello consistency check is an extra measure tooensure that customers who rely on hello Get Task Counts operation get hello right information they need for their solution.</span></span>

<span data-ttu-id="27892-131">Hello **validationStatus** propriété dans la réponse de hello indique si lot a effectué la vérification de cohérence hello.</span><span class="sxs-lookup"><span data-stu-id="27892-131">hello **validationStatus** property in hello response indicates whether Batch has performed hello consistency check.</span></span> <span data-ttu-id="27892-132">Si le lot n’a pas été en mesure de toocheck des nombres d’état contre les États réel hello contenues dans le système de hello, puis hello **validationStatus** propriété a la valeur trop`unvalidated`.</span><span class="sxs-lookup"><span data-stu-id="27892-132">If Batch has not been able toocheck state counts against hello actual states held in hello system, then hello **validationStatus** property is set too`unvalidated`.</span></span> <span data-ttu-id="27892-133">Pour des raisons de performances, traitement par lots n’effectuera pas si le travail hello inclut la vérification de cohérence hello plus de 200 000 tâches, c’est le cas hello **validationStatus** propriété peut être définie trop`unvalidated` dans ce cas.</span><span class="sxs-lookup"><span data-stu-id="27892-133">For performance reasons, Batch will not perform hello consistency check if hello job includes more than 200,000 tasks, so hello **validationStatus** property may be set too`unvalidated` in this case.</span></span> <span data-ttu-id="27892-134">Toutefois, nombre de tâches hello n’est pas nécessairement incorrect dans ce cas, même une perte de données très limité est très improbable.</span><span class="sxs-lookup"><span data-stu-id="27892-134">However, hello task count is not necessarily wrong in this case, as even a very limited data loss is highly unlikely.</span></span> 

<span data-ttu-id="27892-135">Lorsqu’une tâche change d’état, pipeline de d’agrégation hello traite les modifications de hello dans quelques secondes.</span><span class="sxs-lookup"><span data-stu-id="27892-135">When a task changes state, hello aggregation pipeline processes hello change within few seconds.</span></span> <span data-ttu-id="27892-136">Hello opération d’obtenir le nombre de tâches reflète le nombre de tâches hello mis à jour dans ce délai.</span><span class="sxs-lookup"><span data-stu-id="27892-136">hello Get Task Counts operation reflects hello updated task counts within that period.</span></span> <span data-ttu-id="27892-137">Toutefois, si une modification dans un état de la tâche des absences dans le pipeline d’agrégation hello, puis modification n’est pas inscrit jusqu'à ce que le test de validation suivant hello.</span><span class="sxs-lookup"><span data-stu-id="27892-137">However, if hello aggregation pipeline misses a change in a task state, then that change is not registered until hello next validation pass.</span></span> <span data-ttu-id="27892-138">Pendant ce temps, le nombre de tâches peut-être être légèrement erroné en raison de l’événement de manquées toohello, mais elles sont corrigées dans le test de validation suivant hello.</span><span class="sxs-lookup"><span data-stu-id="27892-138">During this time, task counts may be slightly inaccurate due toohello missed event, but they are corrected on hello next validation pass.</span></span>

## <a name="best-practices-for-counting-a-jobs-tasks"></a><span data-ttu-id="27892-139">Bonnes pratiques pour le comptage des tâches d’un travail</span><span class="sxs-lookup"><span data-stu-id="27892-139">Best practices for counting a job's tasks</span></span>

<span data-ttu-id="27892-140">L’appel d’opération d’obtenir le nombre de tâches hello est tooreturn de façon plus efficace hello un décompte de base des tâches d’un travail par état.</span><span class="sxs-lookup"><span data-stu-id="27892-140">Calling hello Get Task Counts operation is hello most efficient way tooreturn a basic count of a job's tasks by state.</span></span> <span data-ttu-id="27892-141">Si vous utilisez la version du service de traitement par lots 2017-06-01.5.1, nous vous recommandons d’écrire ou de mise à jour de votre toouse code obtenir le nombre de tâches.</span><span class="sxs-lookup"><span data-stu-id="27892-141">If you are using Batch service version 2017-06-01.5.1, we recommend writing or updating your code toouse Get Task Counts.</span></span>

<span data-ttu-id="27892-142">Hello opération d’obtenir le nombre de tâches n’est pas disponible dans les versions de service de traitement par lots 2017-06-01.5.1 au plus tôt.</span><span class="sxs-lookup"><span data-stu-id="27892-142">hello Get Task Counts operation is not available in Batch service versions earlier than 2017-06-01.5.1.</span></span> <span data-ttu-id="27892-143">Si vous utilisez une version antérieure du service de hello, puis utilisez une liste des tâches toocount requête dans un travail à la place.</span><span class="sxs-lookup"><span data-stu-id="27892-143">If you are using an older version of hello service, then use a list query toocount tasks in a job instead.</span></span> <span data-ttu-id="27892-144">Pour plus d’informations, consultez [créer efficacement les ressources de traitement par lots toolist requêtes](batch-efficient-list-queries.md).</span><span class="sxs-lookup"><span data-stu-id="27892-144">For more information, see [Create queries toolist Batch resources efficiently](batch-efficient-list-queries.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="27892-145">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="27892-145">Next steps</span></span>

* <span data-ttu-id="27892-146">Consultez hello [vue d’ensemble de lot](batch-api-basics.md) toolearn plus d’informations sur les fonctionnalités et les concepts du service de traitement par lots.</span><span class="sxs-lookup"><span data-stu-id="27892-146">See hello [Batch feature overview](batch-api-basics.md) toolearn more about Batch service concepts and features.</span></span> <span data-ttu-id="27892-147">Hello article traite des ressources de traitement principales hello tels que les pools, les nœuds de calcul, les opérations et les tâches et fournit une vue d’ensemble des fonctionnalités du service hello.</span><span class="sxs-lookup"><span data-stu-id="27892-147">hello article discusses hello primary Batch resources such as pools, compute nodes, jobs, and tasks, and provides an overview of hello service's features.</span></span>
* <span data-ttu-id="27892-148">Principes fondamentaux du développement d’une application activée de lot à l’aide de hello hello [bibliothèque cliente .NET de lot](batch-dotnet-get-started.md) ou [Python](batch-python-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="27892-148">Learn hello basics of developing a Batch-enabled application using hello [Batch .NET client library](batch-dotnet-get-started.md) or [Python](batch-python-tutorial.md).</span></span> <span data-ttu-id="27892-149">Ces articles d’introduction vous guident dans une application opérationnelle qui utilise hello lot service tooexecute une charge de travail sur plusieurs nœuds de calcul.</span><span class="sxs-lookup"><span data-stu-id="27892-149">These introductory articles guide you through a working application that uses hello Batch service tooexecute a workload on multiple compute nodes.</span></span>


[rest_get_task_counts]: https://docs.microsoft.com/rest/api/batchservice/get-the-task-counts-for-a-job
[rest_get_task]: https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-task
[rest_list_tasks]: https://docs.microsoft.com/rest/api/batchservice/list-the-tasks-associated-with-a-job
