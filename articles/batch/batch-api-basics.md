---
title: "Vue d’ensemble d’Azure Batch pour développeurs | Microsoft Docs"
description: "Découvrez les fonctionnalités du service Batch et de ses API du point de vue du développeur."
services: batch
documentationcenter: .net
author: tamram
manager: timlt
editor: 
ms.assetid: 416b95f8-2d7b-4111-8012-679b0f60d204
ms.service: batch
ms.devlang: multiple
ms.topic: get-started-article
ms.tgt_pltfrm: na
ms.workload: big-compute
ms.date: 06/28/2017
ms.author: tamram
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: c2f2a878414e4efd626d674ef9a182ae52eeb1ff
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/29/2017
---
# <a name="develop-large-scale-parallel-compute-solutions-with-batch"></a><span data-ttu-id="c376c-103">Développer des solutions de calcul parallèles à grande échelle avec Batch</span><span class="sxs-lookup"><span data-stu-id="c376c-103">Develop large-scale parallel compute solutions with Batch</span></span>

<span data-ttu-id="c376c-104">Dans cette vue d’ensemble des principaux composants du service Azure Batch, nous aborderons les fonctionnalités et ressources du service Batch qui permettent aux développeurs de créer des solutions de calcul parallèles à grande échelle.</span><span class="sxs-lookup"><span data-stu-id="c376c-104">In this overview of the core components of the Azure Batch service, we discuss the primary service features and resources that Batch developers can use to build large-scale parallel compute solutions.</span></span>

<span data-ttu-id="c376c-105">Que vous développiez une application ou un service de calcul distribué émettant des appels [d’API REST][batch_rest_api] directs, ou que vous utilisiez l’un des [Kits de développement logiciel (SDK) Batch](batch-apis-tools.md#azure-accounts-for-batch-development), vous utiliserez la plupart des ressources et des fonctionnalités présentées dans cet article.</span><span class="sxs-lookup"><span data-stu-id="c376c-105">Whether you're developing a distributed computational application or service that issues direct [REST API][batch_rest_api] calls or you're using one of the [Batch SDKs](batch-apis-tools.md#azure-accounts-for-batch-development), you'll use many of the resources and features discussed in this article.</span></span>

> [!TIP]
> <span data-ttu-id="c376c-106">Pour une présentation plus poussée du service Batch, consultez l’article [Notions de base d’Azure Batch](batch-technical-overview.md).</span><span class="sxs-lookup"><span data-stu-id="c376c-106">For a higher-level introduction to the Batch service, see [Basics of Azure Batch](batch-technical-overview.md).</span></span>
>
>

## <a name="batch-service-workflow"></a><span data-ttu-id="c376c-107">Flux de travail du service Batch</span><span class="sxs-lookup"><span data-stu-id="c376c-107">Batch service workflow</span></span>
<span data-ttu-id="c376c-108">Le flux de travail de haut niveau suivant est caractéristique de la plupart des applications et services utilisant le service Batch pour le traitement des charges de travail parallèles :</span><span class="sxs-lookup"><span data-stu-id="c376c-108">The following high-level workflow is typical of nearly all applications and services that use the Batch service for processing parallel workloads:</span></span>

1. <span data-ttu-id="c376c-109">Chargez les **fichiers de données** que vous souhaitez traiter vers un compte [Stockage Azure][azure_storage].</span><span class="sxs-lookup"><span data-stu-id="c376c-109">Upload the **data files** that you want to process to an [Azure Storage][azure_storage] account.</span></span> <span data-ttu-id="c376c-110">Le service Batch inclut la prise en charge intégrée de l’accès au stockage d’objets Blob Azure ; lorsque les tâches sont exécutées, celles-ci peuvent télécharger les fichiers en question vers les [nœuds de calcul](#compute-node) .</span><span class="sxs-lookup"><span data-stu-id="c376c-110">Batch includes built-in support for accessing Azure Blob storage, and your tasks can download these files to [compute nodes](#compute-node) when the tasks are run.</span></span>
2. <span data-ttu-id="c376c-111">Chargez le **fichiers d’application** que les tâches exécuteront.</span><span class="sxs-lookup"><span data-stu-id="c376c-111">Upload the **application files** that your tasks will run.</span></span> <span data-ttu-id="c376c-112">Ces fichiers peuvent être des fichiers binaires ou des scripts, accompagnés de leurs dépendances, et sont exécutés par les tâches dans vos travaux.</span><span class="sxs-lookup"><span data-stu-id="c376c-112">These files can be binaries or scripts and their dependencies, and are executed by the tasks in your jobs.</span></span> <span data-ttu-id="c376c-113">Vos tâches peuvent télécharger ces fichiers à partir de votre compte Azure Storage ; vous pouvez également utiliser la fonctionnalité [packages d’application](#application-packages) de Batch pour le déploiement et la gestion des applications.</span><span class="sxs-lookup"><span data-stu-id="c376c-113">Your tasks can download these files from your Storage account, or you can use the [application packages](#application-packages) feature of Batch for application management and deployment.</span></span>
3. <span data-ttu-id="c376c-114">Créez un [pool](#pool) de nœuds de calcul.</span><span class="sxs-lookup"><span data-stu-id="c376c-114">Create a [pool](#pool) of compute nodes.</span></span> <span data-ttu-id="c376c-115">Lors de la création d’un pool, vous devez spécifier le nombre de nœuds de calcul du pool, leur taille ainsi que le système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="c376c-115">When you create a pool, you specify the number of compute nodes for the pool, their size, and the operating system.</span></span> <span data-ttu-id="c376c-116">Pour chaque exécution de tâche dans votre travail, cette dernière est exécutée sur l’un des nœuds du pool.</span><span class="sxs-lookup"><span data-stu-id="c376c-116">When each task in your job runs, it's assigned to execute on one of the nodes in your pool.</span></span>
4. <span data-ttu-id="c376c-117">Créez un [travail](#job).</span><span class="sxs-lookup"><span data-stu-id="c376c-117">Create a [job](#job).</span></span> <span data-ttu-id="c376c-118">Un travail gère une collection de tâches.</span><span class="sxs-lookup"><span data-stu-id="c376c-118">A job manages a collection of tasks.</span></span> <span data-ttu-id="c376c-119">Vous associez chaque travail à un pool spécifique, dans lequel s’exécuteront les tâches du travail concerné.</span><span class="sxs-lookup"><span data-stu-id="c376c-119">You associate each job to a specific pool where that job's tasks will run.</span></span>
5. <span data-ttu-id="c376c-120">Ajoutez des [tâches](#task) au travail.</span><span class="sxs-lookup"><span data-stu-id="c376c-120">Add [tasks](#task) to the job.</span></span> <span data-ttu-id="c376c-121">Chaque tâche exécute l’application ou le script téléchargés afin de traiter les fichiers de données téléchargés à partir de votre compte de stockage.</span><span class="sxs-lookup"><span data-stu-id="c376c-121">Each task runs the application or script that you uploaded to process the data files it downloads from your Storage account.</span></span> <span data-ttu-id="c376c-122">Lorsque chaque tâche est terminée, celle-ci peut télécharger sa sortie vers Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="c376c-122">As each task completes, it can upload its output to Azure Storage.</span></span>
6. <span data-ttu-id="c376c-123">Surveillez la progression du travail et récupérez la sortie de la tâche à partir d’Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="c376c-123">Monitor job progress and retrieve the task output from Azure Storage.</span></span>

<span data-ttu-id="c376c-124">Les sections suivantes portent sur ces points ainsi que sur les autres ressources de Batch qui permettent l’exécution de votre scénario de calcul distribué.</span><span class="sxs-lookup"><span data-stu-id="c376c-124">The following sections discuss these and the other resources of Batch that enable your distributed computational scenario.</span></span>

> [!NOTE]
> <span data-ttu-id="c376c-125">Un [compte Batch](#account) est nécessaire pour utiliser le service Batch.</span><span class="sxs-lookup"><span data-stu-id="c376c-125">You need a [Batch account](#account) to use the Batch service.</span></span> <span data-ttu-id="c376c-126">La plupart des solutions Batch utilisent aussi un compte [Stockage Azure][azure_storage], afin de stocker et récupérer un fichier.</span><span class="sxs-lookup"><span data-stu-id="c376c-126">Most Batch solutions also use an [Azure Storage][azure_storage] account for file storage and retrieval.</span></span> <span data-ttu-id="c376c-127">Actuellement, le service Batch prend uniquement en charge le type de compte de stockage à **usage général**, comme décrit à l’étape 5 de la section [Créer un compte de stockage](../storage/common/storage-create-storage-account.md#create-a-storage-account) de l’article [À propos des comptes de stockage Azure](../storage/common/storage-create-storage-account.md).</span><span class="sxs-lookup"><span data-stu-id="c376c-127">Batch currently supports only the **general-purpose** storage account type, as described in step 5 of [Create a storage account](../storage/common/storage-create-storage-account.md#create-a-storage-account) in [About Azure storage accounts](../storage/common/storage-create-storage-account.md).</span></span>
>
>

## <a name="batch-service-resources"></a><span data-ttu-id="c376c-128">Ressources du service Batch</span><span class="sxs-lookup"><span data-stu-id="c376c-128">Batch service resources</span></span>
<span data-ttu-id="c376c-129">Certaines des ressources suivantes (comptes, nœuds de calcul, pools, travaux et tâches) sont requises par toutes les solutions qui utilisent le service Batch.</span><span class="sxs-lookup"><span data-stu-id="c376c-129">Some of the following resources--accounts, compute nodes, pools, jobs, and tasks--are required by all solutions that use the Batch service.</span></span> <span data-ttu-id="c376c-130">D’autres, telles que les planifications de travaux et les packages d’applications, sont utiles, mais facultatives.</span><span class="sxs-lookup"><span data-stu-id="c376c-130">Others, like job schedules and application packages, are helpful, but optional, features.</span></span>

* [<span data-ttu-id="c376c-131">Compte</span><span class="sxs-lookup"><span data-stu-id="c376c-131">Account</span></span>](#account)
* [<span data-ttu-id="c376c-132">Nœud de calcul</span><span class="sxs-lookup"><span data-stu-id="c376c-132">Compute node</span></span>](#compute-node)
* [<span data-ttu-id="c376c-133">Pool</span><span class="sxs-lookup"><span data-stu-id="c376c-133">Pool</span></span>](#pool)
* [<span data-ttu-id="c376c-134">Travail</span><span class="sxs-lookup"><span data-stu-id="c376c-134">Job</span></span>](#job)

  * [<span data-ttu-id="c376c-135">Planifications de travaux</span><span class="sxs-lookup"><span data-stu-id="c376c-135">Job schedules</span></span>](#scheduled-jobs)
* [<span data-ttu-id="c376c-136">Tâche</span><span class="sxs-lookup"><span data-stu-id="c376c-136">Task</span></span>](#task)

  * [<span data-ttu-id="c376c-137">Tâche de démarrage</span><span class="sxs-lookup"><span data-stu-id="c376c-137">Start task</span></span>](#start-task)
  * [<span data-ttu-id="c376c-138">Tâche du gestionnaire de travaux</span><span class="sxs-lookup"><span data-stu-id="c376c-138">Job manager task</span></span>](#job-manager-task)
  * [<span data-ttu-id="c376c-139">Tâches de préparation et lancement</span><span class="sxs-lookup"><span data-stu-id="c376c-139">Job preparation and release tasks</span></span>](#job-preparation-and-release-tasks)
  * [<span data-ttu-id="c376c-140">Tâche multi-instance (MPI)</span><span class="sxs-lookup"><span data-stu-id="c376c-140">Multi-instance task (MPI)</span></span>](#multi-instance-tasks)
  * [<span data-ttu-id="c376c-141">Dépendances de la tâche</span><span class="sxs-lookup"><span data-stu-id="c376c-141">Task dependencies</span></span>](#task-dependencies)
* [<span data-ttu-id="c376c-142">Packages d’applications</span><span class="sxs-lookup"><span data-stu-id="c376c-142">Application packages</span></span>](#application-packages)

## <a name="account"></a><span data-ttu-id="c376c-143">Compte</span><span class="sxs-lookup"><span data-stu-id="c376c-143">Account</span></span>
<span data-ttu-id="c376c-144">Un compte Batch est une entité identifiée de façon unique au sein du service Batch.</span><span class="sxs-lookup"><span data-stu-id="c376c-144">A Batch account is a uniquely identified entity within the Batch service.</span></span> <span data-ttu-id="c376c-145">Tout le traitement s’effectue via un compte Batch.</span><span class="sxs-lookup"><span data-stu-id="c376c-145">All processing is associated with a Batch account.</span></span>

<span data-ttu-id="c376c-146">Vous pouvez créer un compte Azure Batch à l’aide du [Portail Azure](batch-account-create-portal.md) ou par programme, par exemple avec la [bibliothèque .NET de gestion Batch](batch-management-dotnet.md).</span><span class="sxs-lookup"><span data-stu-id="c376c-146">You can create an Azure Batch account using the [Azure portal](batch-account-create-portal.md) or programmatically, such as with the [Batch Management .NET library](batch-management-dotnet.md).</span></span> <span data-ttu-id="c376c-147">Au moment de la création du compte, vous pouvez associer un compte de Stockage Azure.</span><span class="sxs-lookup"><span data-stu-id="c376c-147">When creating the account, you can associate an Azure storage account.</span></span>

### <a name="pool-allocation-mode"></a><span data-ttu-id="c376c-148">Mode d’allocation de pool</span><span class="sxs-lookup"><span data-stu-id="c376c-148">Pool allocation mode</span></span>

<span data-ttu-id="c376c-149">Lorsque vous créez un compte Batch, vous pouvez spécifier la manière dont les [pools](#pool) de nœuds de calcul sont alloués.</span><span class="sxs-lookup"><span data-stu-id="c376c-149">When you create a Batch account, you can specify how [pools](#pool) of compute nodes are allocated.</span></span> <span data-ttu-id="c376c-150">Vous pouvez choisir d’allouer les pools de nœuds de calcul dans un abonnement géré par Azure Batch. Vous pouvez aussi les allouer dans votre propre abonnement.</span><span class="sxs-lookup"><span data-stu-id="c376c-150">You can choose to allocate pools of compute nodes in a subscription managed by Azure Batch, or you can allocate them in your own subscription.</span></span> <span data-ttu-id="c376c-151">La propriété *mode d’allocation de pool* du compte détermine l’endroit où les pools sont alloués.</span><span class="sxs-lookup"><span data-stu-id="c376c-151">The *pool allocation mode* property for the account determines where pools are allocated.</span></span> 

<span data-ttu-id="c376c-152">Pour déterminer le mode d’allocation de pool à utiliser, il convient de réfléchir au mode qui est le plus adapté à votre scénario :</span><span class="sxs-lookup"><span data-stu-id="c376c-152">To decide which pool allocation mode to use, consider which best fits your scenario:</span></span>

* <span data-ttu-id="c376c-153">**Service Batch** est le mode d’allocation de pool par défaut. Les pools sont alloués en arrière-plan dans des abonnements gérés par Azure.</span><span class="sxs-lookup"><span data-stu-id="c376c-153">**Batch Service**: Batch Service is the default pool allocation mode, in which pools are allocated behind the scenes in Azure-managed subscriptions.</span></span> <span data-ttu-id="c376c-154">Gardez à l’esprit ces points clés concernant le mode d’allocation de pool Service Batch :</span><span class="sxs-lookup"><span data-stu-id="c376c-154">Keep in mind these key points about the Batch Service pool allocation mode:</span></span>

    - <span data-ttu-id="c376c-155">Le mode d’allocation de pool Service Batch prend en charge les pools de service cloud et de machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="c376c-155">The Batch Service pool allocation mode supports both Cloud Service and Virtual Machine pools.</span></span>
    - <span data-ttu-id="c376c-156">Le mode d’allocation de pool Service Batch prend en charge l’authentification par clé partagée ou [l’authentification Azure Active Directory](batch-aad-auth.md) (Azure AD).</span><span class="sxs-lookup"><span data-stu-id="c376c-156">The Batch Service pool allocation mode supports both shared key authentication or [Azure Active Directory authentication](batch-aad-auth.md) (Azure AD).</span></span> 
    - <span data-ttu-id="c376c-157">Grâce au mode d’allocation de pool Service Batch, vous pouvez utiliser des nœuds de calcul dédiés ou à faible priorité dans des pools alloués.</span><span class="sxs-lookup"><span data-stu-id="c376c-157">You can use either dedicated or low-priority compute nodes in pools allocated with the Batch Service pool allocation mode.</span></span>
    - <span data-ttu-id="c376c-158">N’utilisez pas ce mode d’allocation de pool si vous souhaitez créer des pools de machines virtuelles Azure à partir d’images de VM, ou si vous prévoyez d’utiliser un réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="c376c-158">Do not use the Batch Service pool allocation mode if you plan to create Azure virtual machine pools from custom VM images, or if you plan to use a virtual network.</span></span> <span data-ttu-id="c376c-159">À la place, créez votre compte avec le mode d’allocation de pool Abonnement utilisateur.</span><span class="sxs-lookup"><span data-stu-id="c376c-159">Create your account with the User Subscription pool allocation mode instead.</span></span>
    - <span data-ttu-id="c376c-160">Les pools de machines virtuelles configurés dans un compte créé grâce au mode d’allocation de pool Service Batch doivent être créés à partir d’images de la [Place de marché de machines virtuelles Microsoft Azure][vm_marketplace].</span><span class="sxs-lookup"><span data-stu-id="c376c-160">Virtual Machine pools provisioned in an account created with the Batch Service pool allocation mode must be created from [Azure Virtual Machines Marketplace][vm_marketplace] images.</span></span>

* <span data-ttu-id="c376c-161">Avec le mode d’allocation de pool **Abonnement utilisateur**, les pools Batch sont alloués dans l’abonnement Azure où le compte est créé.</span><span class="sxs-lookup"><span data-stu-id="c376c-161">**User subscription**: With the User Subscription pool allocation mode, Batch pools are allocated in the Azure subscription where the account is created.</span></span> <span data-ttu-id="c376c-162">Gardez à l’esprit ces points clés concernant le mode d’allocation de pool Abonnement utilisateur :</span><span class="sxs-lookup"><span data-stu-id="c376c-162">Keep in mind these key points about the User Subscription pool allocation mode:</span></span>
     
    - <span data-ttu-id="c376c-163">Ce mode d’allocation de pool prend uniquement en charge les pools de machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="c376c-163">The User Subscription pool allocation mode supports only Virtual Machine pools.</span></span> <span data-ttu-id="c376c-164">elle ne gère pas les pools de services cloud.</span><span class="sxs-lookup"><span data-stu-id="c376c-164">It does not support Cloud Services pools.</span></span>
    - <span data-ttu-id="c376c-165">Pour créer des pools de machines virtuelles à partir d’images VM, ou pour utiliser un réseau virtuel avec des pools de machines virtuelles, vous devez utiliser le mode d’allocation de pool Abonnement utilisateur.</span><span class="sxs-lookup"><span data-stu-id="c376c-165">To create Virtual Machine pools from custom VM images or to use a virtual network with Virtual Machine pools, you must use the User Subscription pool allocation mode.</span></span>  
    - <span data-ttu-id="c376c-166">Vous devez utiliser [l’authentification Azure Active Directory](batch-aad-auth.md) avec les pools qui sont alloués dans l’abonnement de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="c376c-166">You must use [Azure Active Directory authentication](batch-aad-auth.md) with pools that are allocated in the user subscription.</span></span> 
    - <span data-ttu-id="c376c-167">Si le mode d’allocation de pool est défini sur Abonnement utilisateur, vous devez configurer un Azure Key Vault pour votre compte Batch.</span><span class="sxs-lookup"><span data-stu-id="c376c-167">You must set up an Azure key vault for your Batch account if the pool allocation mode is set to User Subscription.</span></span> 
    - <span data-ttu-id="c376c-168">Vous pouvez uniquement utiliser des nœuds de calcul dans des pools dont le compte est créé avec le mode d’allocation de pool Abonnement utilisateur.</span><span class="sxs-lookup"><span data-stu-id="c376c-168">You can use only dedicated compute nodes in pools in an account created with the User Subscription pool allocation mode.</span></span> <span data-ttu-id="c376c-169">Les nœuds à faible priorité ne sont pas pris en charge.</span><span class="sxs-lookup"><span data-stu-id="c376c-169">Low-priority nodes are not supported.</span></span>
    - <span data-ttu-id="c376c-170">Les pools de machines virtuelles configurés dans un compte associé au mode d’allocation de pool Abonnement utilisateur peuvent être créés à partir d’images de la [Place de marché Microsoft Azure][vm_marketplace] ou d’images personnalisées fournies par vos soins.</span><span class="sxs-lookup"><span data-stu-id="c376c-170">Virtual Machine pools provisioned in an account with the User Subscription pool allocation mode can be created either from [Azure Virtual Machines Marketplace][vm_marketplace] images, or from custom images that you provide.</span></span>

<span data-ttu-id="c376c-171">Le tableau suivant compare les modes d’allocation de pool Service Batch et d’Abonnement utilisateur.</span><span class="sxs-lookup"><span data-stu-id="c376c-171">The following table compares the Batch Service and User Subscription pool allocation modes.</span></span>

| <span data-ttu-id="c376c-172">**Mode d’allocation de pool**</span><span class="sxs-lookup"><span data-stu-id="c376c-172">**Pool allocation mode**</span></span>                 | <span data-ttu-id="c376c-173">**Service Batch**</span><span class="sxs-lookup"><span data-stu-id="c376c-173">**Batch Service**</span></span>                                                                                       | <span data-ttu-id="c376c-174">**Abonnement utilisateur**</span><span class="sxs-lookup"><span data-stu-id="c376c-174">**User Subscription**</span></span>                                                              |
|-------------------------------------------|---------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------|
| <span data-ttu-id="c376c-175">**Les pools sont alloués dans**</span><span class="sxs-lookup"><span data-stu-id="c376c-175">**Pools are allocated in**</span></span>               | <span data-ttu-id="c376c-176">Un abonnement Azure géré</span><span class="sxs-lookup"><span data-stu-id="c376c-176">An Azure-managed subscription</span></span>                                                                           | <span data-ttu-id="c376c-177">L’abonnement de l’utilisateur dans lequel le compte Batch est créé</span><span class="sxs-lookup"><span data-stu-id="c376c-177">The user subscription in which the Batch account is created</span></span>                        |
| <span data-ttu-id="c376c-178">**Configurations prises en charge**</span><span class="sxs-lookup"><span data-stu-id="c376c-178">**Supported configurations**</span></span>             | <ul><li><span data-ttu-id="c376c-179">Configuration service cloud</span><span class="sxs-lookup"><span data-stu-id="c376c-179">Cloud Service Configuration</span></span></li><li><span data-ttu-id="c376c-180">Configuration de machines virtuelles (Linux et Windows)</span><span class="sxs-lookup"><span data-stu-id="c376c-180">Virtual Machine Configuration (Linux and Windows)</span></span></li></ul> | <ul><li><span data-ttu-id="c376c-181">Configuration de machines virtuelles (Linux et Windows)</span><span class="sxs-lookup"><span data-stu-id="c376c-181">Virtual Machine Configuration (Linux and Windows)</span></span></li></ul>                |
| <span data-ttu-id="c376c-182">**Images de machine virtuelle prises en charge**</span><span class="sxs-lookup"><span data-stu-id="c376c-182">**Supported VM images**</span></span>                  | <ul><li><span data-ttu-id="c376c-183">Images de la Place de marché Azure</span><span class="sxs-lookup"><span data-stu-id="c376c-183">Azure Marketplace images</span></span></li></ul>                                                              | <ul><li><span data-ttu-id="c376c-184">Images de la Place de marché Azure</span><span class="sxs-lookup"><span data-stu-id="c376c-184">Azure Marketplace images</span></span></li><li><span data-ttu-id="c376c-185">Images personnalisées</span><span class="sxs-lookup"><span data-stu-id="c376c-185">Custom images</span></span></li></ul>                   |
| <span data-ttu-id="c376c-186">**Types de nœuds de calcul pris en charge**</span><span class="sxs-lookup"><span data-stu-id="c376c-186">**Supported compute node types**</span></span>         | <ul><li><span data-ttu-id="c376c-187">Nœuds dédiés</span><span class="sxs-lookup"><span data-stu-id="c376c-187">Dedicated nodes</span></span></li><li><span data-ttu-id="c376c-188">Nœuds de faible priorité</span><span class="sxs-lookup"><span data-stu-id="c376c-188">Low-priority nodes</span></span></li></ul>                                            | <ul><li><span data-ttu-id="c376c-189">Nœuds dédiés</span><span class="sxs-lookup"><span data-stu-id="c376c-189">Dedicated nodes</span></span></li></ul>                                                  |
| <span data-ttu-id="c376c-190">**Authentification prise en charge**</span><span class="sxs-lookup"><span data-stu-id="c376c-190">**Supported authentication**</span></span>             | <ul><li><span data-ttu-id="c376c-191">Clé partagée</span><span class="sxs-lookup"><span data-stu-id="c376c-191">Shared Key</span></span></li><li><span data-ttu-id="c376c-192">Azure AD</span><span class="sxs-lookup"><span data-stu-id="c376c-192">Azure AD</span></span></li></ul>                                                           | <ul><li><span data-ttu-id="c376c-193">Azure AD</span><span class="sxs-lookup"><span data-stu-id="c376c-193">Azure AD</span></span></li></ul>                                                         |
| <span data-ttu-id="c376c-194">**Azure Key Vault requis**</span><span class="sxs-lookup"><span data-stu-id="c376c-194">**Azure Key Vault required**</span></span>             | <span data-ttu-id="c376c-195">Non</span><span class="sxs-lookup"><span data-stu-id="c376c-195">No</span></span>                                                                                                      | <span data-ttu-id="c376c-196">Oui</span><span class="sxs-lookup"><span data-stu-id="c376c-196">Yes</span></span>                                                                                |
| <span data-ttu-id="c376c-197">**Quota de cœurs**</span><span class="sxs-lookup"><span data-stu-id="c376c-197">**Core quota**</span></span>                           | <span data-ttu-id="c376c-198">Déterminé par le quota de cœurs Batch</span><span class="sxs-lookup"><span data-stu-id="c376c-198">Determined by Batch core quota</span></span>                                                                          | <span data-ttu-id="c376c-199">Déterminé par le quota de cœurs Batch</span><span class="sxs-lookup"><span data-stu-id="c376c-199">Determined by subscription core quota</span></span>                                              |
| <span data-ttu-id="c376c-200">**Support réseau virtuel Azure (Vnet)**</span><span class="sxs-lookup"><span data-stu-id="c376c-200">**Azure Virtual Network (Vnet) support**</span></span> | <span data-ttu-id="c376c-201">Pools créés avec une configuration du service cloud</span><span class="sxs-lookup"><span data-stu-id="c376c-201">Pools created with the Cloud Service Configuration</span></span>                                                      | <span data-ttu-id="c376c-202">Pools créés avec une configuration de machines virtuelles</span><span class="sxs-lookup"><span data-stu-id="c376c-202">Pools created with the Virtual Machine Configuration</span></span>                               |
| <span data-ttu-id="c376c-203">**Modèle de déploiement de réseau virtuel pris en charge**</span><span class="sxs-lookup"><span data-stu-id="c376c-203">**Vnet deployment model supported**</span></span>      | <span data-ttu-id="c376c-204">Vnets créés avec un modèle de déploiement classique</span><span class="sxs-lookup"><span data-stu-id="c376c-204">Vnets created with classic deployment model</span></span>                                                             | <span data-ttu-id="c376c-205">Réseaux virtuels créés avec le modèle de déploiement classique ou Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="c376c-205">Vnets created with either the classic deployment model or Azure   Resource Manager</span></span> |

## <a name="azure-storage-account"></a><span data-ttu-id="c376c-206">un compte Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="c376c-206">Azure Storage account</span></span>

<span data-ttu-id="c376c-207">La plupart des solutions Batch utilisent Stockage Azure pour stocker les fichiers de ressources et les fichiers de sortie.</span><span class="sxs-lookup"><span data-stu-id="c376c-207">Most Batch solutions use Azure Storage for storing resource files and output files.</span></span>  

<span data-ttu-id="c376c-208">Actuellement, le service Batch prend uniquement en charge le type de compte de stockage à usage général, comme décrit à l’étape 5 de la section [Créer un compte de stockage](../storage/common/storage-create-storage-account.md#create-a-storage-account) de l’article [À propos des comptes de stockage Azure](../storage/common/storage-create-storage-account.md).</span><span class="sxs-lookup"><span data-stu-id="c376c-208">Batch currently supports only the general-purpose storage account type, as described in step 5 of [Create a storage account](../storage/common/storage-create-storage-account.md#create-a-storage-account) in [About Azure storage accounts](../storage/common/storage-create-storage-account.md).</span></span> <span data-ttu-id="c376c-209">Vos tâches Batch (y compris les tâches standard, de démarrage, de préparation des travaux et de validation des travaux) doivent spécifier des fichiers de ressources se trouvant dans les comptes de stockage à usage général.</span><span class="sxs-lookup"><span data-stu-id="c376c-209">Your Batch tasks (including standard tasks, start tasks, job preparation tasks, and job release tasks) must specify resource files that reside in general-purpose storage accounts.</span></span>


## <a name="compute-node"></a><span data-ttu-id="c376c-210">Nœud de calcul</span><span class="sxs-lookup"><span data-stu-id="c376c-210">Compute node</span></span>
<span data-ttu-id="c376c-211">Un nœud de calcul est une machine virtuelle Azure ou une machine virtuelle de service cloud dédiée au traitement d’une partie de la charge de travail de votre application.</span><span class="sxs-lookup"><span data-stu-id="c376c-211">A compute node is an Azure virtual machine (VM) or cloud service VM that is dedicated to processing a portion of your application's workload.</span></span> <span data-ttu-id="c376c-212">La taille d’un nœud détermine le nombre de cœurs du processeur, la capacité de mémoire et la taille du système de fichiers local qui lui est allouée.</span><span class="sxs-lookup"><span data-stu-id="c376c-212">The size of a node determines the number of CPU cores, memory capacity, and local file system size that is allocated to the node.</span></span> <span data-ttu-id="c376c-213">Vous pouvez créer des pools de nœuds Windows ou Linux à l’aide des services Azure Cloud Services, des images provenant de la [Place de marché de machines virtuelles Azure][vm_marketplace] ou des images personnalisées par vos soins.</span><span class="sxs-lookup"><span data-stu-id="c376c-213">You can create pools of Windows or Linux nodes by using Azure Cloud Services, images from the [Azure Virtual Machines Marketplace][vm_marketplace], or custom images that you prepare.</span></span> <span data-ttu-id="c376c-214">Pour plus d’informations sur ces options, voir la section suivante [Pool](#pool) .</span><span class="sxs-lookup"><span data-stu-id="c376c-214">See the following [Pool](#pool) section for more information on these options.</span></span>

<span data-ttu-id="c376c-215">Les nœuds peuvent exécuter tout fichier exécutable ou script pris en charge par l’environnement de système d’exploitation du nœud.</span><span class="sxs-lookup"><span data-stu-id="c376c-215">Nodes can run any executable or script that is supported by the operating system environment of the node.</span></span> <span data-ttu-id="c376c-216">Cela inclut les scripts \*.exe, \*.cmd, \*.bat et PowerShell pour Windows, les fichiers binaires, ainsi que les scripts shell et Python pour Linux.</span><span class="sxs-lookup"><span data-stu-id="c376c-216">This includes \*.exe, \*.cmd, \*.bat and PowerShell scripts for Windows--and binaries, shell, and Python scripts for Linux.</span></span>

<span data-ttu-id="c376c-217">Tous les nœuds de calcul Batch incluent également les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="c376c-217">All compute nodes in Batch also include:</span></span>

* <span data-ttu-id="c376c-218">Une [structure de dossiers](#files-and-directories) standard et des [variables d’environnement](#environment-settings-for-tasks) associées pouvant être référencées par les tâches.</span><span class="sxs-lookup"><span data-stu-id="c376c-218">A standard [folder structure](#files-and-directories) and associated [environment variables](#environment-settings-for-tasks) that are available for reference by tasks.</span></span>
* <span data-ttu-id="c376c-219">**pare-feu** configurés pour le contrôle de l’accès.</span><span class="sxs-lookup"><span data-stu-id="c376c-219">**Firewall** settings that are configured to control access.</span></span>
* <span data-ttu-id="c376c-220">[accès distant](#connecting-to-compute-nodes) aux nœuds Windows (protocole RDP [Remote Desktop Protocol]) et Linux (Secure Shell [SSH]).</span><span class="sxs-lookup"><span data-stu-id="c376c-220">[Remote access](#connecting-to-compute-nodes) to both Windows (Remote Desktop Protocol (RDP)) and Linux (Secure Shell (SSH)) nodes.</span></span>

## <a name="pool"></a><span data-ttu-id="c376c-221">pool</span><span class="sxs-lookup"><span data-stu-id="c376c-221">Pool</span></span>
<span data-ttu-id="c376c-222">Un pool est une collection de nœuds sur lesquels votre application s’exécute.</span><span class="sxs-lookup"><span data-stu-id="c376c-222">A pool is a collection of nodes that your application runs on.</span></span> <span data-ttu-id="c376c-223">Vous pouvez créer le pool manuellement. Il peut également être créé automatiquement par le service Batch lorsque vous spécifiez le travail à accomplir.</span><span class="sxs-lookup"><span data-stu-id="c376c-223">The pool can be created manually by you, or automatically by the Batch service when you specify the work to be done.</span></span> <span data-ttu-id="c376c-224">Vous pouvez créer et gérer un pool qui répond aux besoins en ressources de votre application.</span><span class="sxs-lookup"><span data-stu-id="c376c-224">You can create and manage a pool that meets the resource requirements of your application.</span></span> <span data-ttu-id="c376c-225">Un pool ne peut être utilisé que par le compte Batch dans lequel il a été créé.</span><span class="sxs-lookup"><span data-stu-id="c376c-225">A pool can be used only by the Batch account in which it was created.</span></span> <span data-ttu-id="c376c-226">Un compte Batch peut avoir plusieurs pools.</span><span class="sxs-lookup"><span data-stu-id="c376c-226">A Batch account can have more than one pool.</span></span>

<span data-ttu-id="c376c-227">Les pools Azure Batch sont créés en parallèle à la plate-forme de calcul Azure principale.</span><span class="sxs-lookup"><span data-stu-id="c376c-227">Azure Batch pools build on top of the core Azure compute platform.</span></span> <span data-ttu-id="c376c-228">Ils permettent d’effectuer des allocations à grande échelle, l’installation d’applications, la distribution de données, des analyses de fonctionnement et des ajustements flexibles du nombre de nœuds de calcul au sein d’un pool ([mise à l’échelle](#scaling-compute-resources)).</span><span class="sxs-lookup"><span data-stu-id="c376c-228">They provide large-scale allocation, application installation, data distribution, health monitoring, and flexible adjustment of the number of compute nodes within a pool ([scaling](#scaling-compute-resources)).</span></span>

<span data-ttu-id="c376c-229">Chaque nœud ajouté à un pool se voit attribuer un nom unique et l’adresse IP.</span><span class="sxs-lookup"><span data-stu-id="c376c-229">Every node that is added to a pool is assigned a unique name and IP address.</span></span> <span data-ttu-id="c376c-230">Lorsqu’un nœud est supprimé d’un pool, toutes les modifications apportées au système d’exploitation ou aux fichiers sont perdues, et son nom et son adresse IP sont libérés pour une utilisation ultérieure.</span><span class="sxs-lookup"><span data-stu-id="c376c-230">When a node is removed from a pool, any changes that are made to the operating system or files are lost, and its name and IP address are released for future use.</span></span> <span data-ttu-id="c376c-231">Lorsqu’un nœud quitte un pool, sa durée de vie est terminée.</span><span class="sxs-lookup"><span data-stu-id="c376c-231">When a node leaves a pool, its lifetime is over.</span></span>

<span data-ttu-id="c376c-232">Lorsque vous créez un pool, vous pouvez spécifier les attributs suivants.</span><span class="sxs-lookup"><span data-stu-id="c376c-232">When you create a pool, you can specify the following attributes.</span></span> <span data-ttu-id="c376c-233">Certains paramètres varient en fonction du mode d’allocation de pool associé au [compte](#account) Batch :</span><span class="sxs-lookup"><span data-stu-id="c376c-233">Some settings differ, depending on the pool allocation mode of the Batch [account](#account):</span></span>

- <span data-ttu-id="c376c-234">Système d’exploitation et version de nœud de calcul</span><span class="sxs-lookup"><span data-stu-id="c376c-234">Compute node operating system and version</span></span>
- <span data-ttu-id="c376c-235">Type de nœud de calcul et nombre cible de nœuds</span><span class="sxs-lookup"><span data-stu-id="c376c-235">Compute node type and target number of nodes</span></span>
- <span data-ttu-id="c376c-236">Taille des nœuds de calcul</span><span class="sxs-lookup"><span data-stu-id="c376c-236">Size of the compute nodes</span></span>
- <span data-ttu-id="c376c-237">Stratégie de mise à l’échelle</span><span class="sxs-lookup"><span data-stu-id="c376c-237">Scaling policy</span></span>
- <span data-ttu-id="c376c-238">Stratégie de planification des tâches</span><span class="sxs-lookup"><span data-stu-id="c376c-238">Task scheduling policy</span></span>
- <span data-ttu-id="c376c-239">État de communication des nœuds de calcul</span><span class="sxs-lookup"><span data-stu-id="c376c-239">Communication status for compute nodes</span></span>
- <span data-ttu-id="c376c-240">Tâches de démarrage des nœuds de calcul</span><span class="sxs-lookup"><span data-stu-id="c376c-240">Start tasks for compute nodes</span></span>
- <span data-ttu-id="c376c-241">packages d’application</span><span class="sxs-lookup"><span data-stu-id="c376c-241">Application packages</span></span>
- <span data-ttu-id="c376c-242">Configuration réseau</span><span class="sxs-lookup"><span data-stu-id="c376c-242">Network configuration</span></span>

<span data-ttu-id="c376c-243">Chacun de ces paramètres est décrit plus en détail dans les sections suivantes.</span><span class="sxs-lookup"><span data-stu-id="c376c-243">Each of these settings is described in more detail in the following sections.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="c376c-244">Les comptes Batch créés avec le mode d’allocation de pool Service Batch possèdent un quota par défaut. Ce quota limite le nombre de cœurs dans un compte Batch.</span><span class="sxs-lookup"><span data-stu-id="c376c-244">Batch accounts created with the Batch Service pool allocation mode have a default quota that limits the number of cores in a Batch account.</span></span> <span data-ttu-id="c376c-245">Le nombre de cœurs correspond au nombre de nœuds de calcul.</span><span class="sxs-lookup"><span data-stu-id="c376c-245">The number of cores corresponds to the number of compute nodes.</span></span> <span data-ttu-id="c376c-246">Pour en savoir plus sur les quotas par défaut et obtenir des instructions sur [l’augmentation d’un quota](batch-quota-limit.md#increase-a-quota), consultez l’article [Quotas et limites pour le service Azure Batch](batch-quota-limit.md).</span><span class="sxs-lookup"><span data-stu-id="c376c-246">You can find the default quotas and instructions on how to [increase a quota](batch-quota-limit.md#increase-a-quota) in [Quotas and limits for the Azure Batch service](batch-quota-limit.md).</span></span> <span data-ttu-id="c376c-247">Si votre pool n’a pas obtenu son nombre cible de nœuds, cela peut être dû au quota principal.</span><span class="sxs-lookup"><span data-stu-id="c376c-247">If your pool is not achieving its target number of nodes, the core quota might be the reason.</span></span>
>
><span data-ttu-id="c376c-248">Les comptes Batch créés avec le mode d’allocation de pool Abonnement utilisateur ne tiennent pas compte des quotas relatifs aux services Batch.</span><span class="sxs-lookup"><span data-stu-id="c376c-248">Batch accounts created with the User Subscription pool allocation mode do not observe the Batch service quotas.</span></span> <span data-ttu-id="c376c-249">Au lieu de cela, ils partagent le quota principal de l’abonnement spécifié.</span><span class="sxs-lookup"><span data-stu-id="c376c-249">Instead, they share in the core quota for the specified subscription.</span></span> <span data-ttu-id="c376c-250">Pour en savoir plus, consultez le paragraphe [Limites de machines virtuelles](../azure-subscription-service-limits.md#virtual-machines-limits) de la section [Abonnement Azure et limites, quotas et contraintes de service](../azure-subscription-service-limits.md).</span><span class="sxs-lookup"><span data-stu-id="c376c-250">For more information, see [Virtual Machines limits](../azure-subscription-service-limits.md#virtual-machines-limits) in [Azure subscription and service limits, quotas, and constraints](../azure-subscription-service-limits.md).</span></span>
>
>

### <a name="compute-node-operating-system-and-version"></a><span data-ttu-id="c376c-251">Système d’exploitation et version de nœud de calcul</span><span class="sxs-lookup"><span data-stu-id="c376c-251">Compute node operating system and version</span></span>

<span data-ttu-id="c376c-252">Lorsque vous créez un pool Batch, vous pouvez spécifier la configuration de machines virtuelles Azure et le type de système d’exploitation que vous souhaitez exécuter sur chaque nœud de calcul dans le pool.</span><span class="sxs-lookup"><span data-stu-id="c376c-252">When you create a Batch pool, you can specify the Azure virtual machine configuration and the type of operating system you want to run on each compute node in the pool.</span></span> <span data-ttu-id="c376c-253">Les deux types de configurations Batch disponibles sont les suivants :</span><span class="sxs-lookup"><span data-stu-id="c376c-253">The two types of configurations available in Batch are:</span></span>

- <span data-ttu-id="c376c-254">La **configuration de machines virtuelles** indique que le pool est composé de machines virtuelles Azure.</span><span class="sxs-lookup"><span data-stu-id="c376c-254">The **Virtual Machine Configuration**, which specifies that the pool is comprised of Azure virtual machines.</span></span> <span data-ttu-id="c376c-255">Ces machines virtuelles peuvent être créées à partir d’images Linux ou Windows.</span><span class="sxs-lookup"><span data-stu-id="c376c-255">These VMs may be created from either Linux or Windows images.</span></span> 

    <span data-ttu-id="c376c-256">Lorsque vous créez un pool basé sur la configuration de machine virtuelle, vous devez spécifier la taille des nœuds, mais aussi la source et les images utilisées pour les créer, la **référence d’image de machine virtuelle** et la **référence SKU de l’agent du nœud** à installer sur les nœuds.</span><span class="sxs-lookup"><span data-stu-id="c376c-256">When you create a pool based on the Virtual Machine Configuration, you must specify not only the size of the nodes and the source of the images used to create them, but also the **virtual machine image reference** and the Batch **node agent SKU** to be installed on the nodes.</span></span> <span data-ttu-id="c376c-257">Pour plus d’informations sur la spécification des propriétés de pool, voir [Configurer des nœuds de calcul Linux dans des pools Azure Batch](batch-linux-nodes.md).</span><span class="sxs-lookup"><span data-stu-id="c376c-257">For more information about specifying these pool properties, see [Provision Linux compute nodes in Azure Batch pools](batch-linux-nodes.md).</span></span>

- <span data-ttu-id="c376c-258">La **configuration de Cloud Services** indique que le pool est composé de nœuds Microsoft Azure Cloud Services.</span><span class="sxs-lookup"><span data-stu-id="c376c-258">The **Cloud Services Configuration**, which specifies that the pool is comprised of Azure Cloud Services nodes.</span></span> <span data-ttu-id="c376c-259">Ce dernier fournit *uniquement* des nœuds de calcul Windows.</span><span class="sxs-lookup"><span data-stu-id="c376c-259">Cloud Services provide Windows compute nodes *only*.</span></span>

    <span data-ttu-id="c376c-260">Les systèmes d’exploitation disponibles pour les pools de configuration des services coud sont répertoriés dans [Versions du SE invité et matrice de compatibilité du Kit de développement logiciel (SDK) Azure](../cloud-services/cloud-services-guestos-update-matrix.md).</span><span class="sxs-lookup"><span data-stu-id="c376c-260">Available operating systems for Cloud Services Configuration pools are listed in the [Azure Guest OS releases and SDK compatibility matrix](../cloud-services/cloud-services-guestos-update-matrix.md).</span></span> <span data-ttu-id="c376c-261">Lorsque vous créez un pool qui contient des nœuds Cloud Services, vous devez spécifier la taille du nœud et sa *famille de systèmes d’exploitation*.</span><span class="sxs-lookup"><span data-stu-id="c376c-261">When you create a pool that contains Cloud Services nodes, you need to specify the node size and its *OS Family*.</span></span> <span data-ttu-id="c376c-262">Les services cloud sont déployés plus rapidement sur Azure que les machines virtuelles exécutant Windows.</span><span class="sxs-lookup"><span data-stu-id="c376c-262">Cloud Services are deployed to Azure more quickly than virtual machines running Windows.</span></span> <span data-ttu-id="c376c-263">Si vous souhaitez créer des nœuds de calcul Windows, vous pouvez constater que Cloud Services propose un délai de déploiement moins important.</span><span class="sxs-lookup"><span data-stu-id="c376c-263">If you want pools of Windows compute nodes, you may find that Cloud Services provide a performance benefit in terms of deployment time.</span></span>

    * <span data-ttu-id="c376c-264">La *famille de système d’exploitation* détermine également les versions de .NET qui sont installées avec le système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="c376c-264">The *OS Family* also determines which versions of .NET are installed with the OS.</span></span>
    * <span data-ttu-id="c376c-265">Comme avec les rôles de travail dans Services cloud, vous pouvez spécifier une *Version du système d’exploitation* (pour plus d’informations sur les rôles de travail, consultez la section [En savoir plus sur Services cloud](../cloud-services/cloud-services-choose-me.md#tell-me-about-cloud-services) de l’article [Vue d’ensemble de Services cloud](../cloud-services/cloud-services-choose-me.md)).</span><span class="sxs-lookup"><span data-stu-id="c376c-265">As with worker roles within Cloud Services, you can specify an *OS Version* (for more information on worker roles, see the [Tell me about cloud services](../cloud-services/cloud-services-choose-me.md#tell-me-about-cloud-services) section in the [Cloud Services overview](../cloud-services/cloud-services-choose-me.md)).</span></span>
    * <span data-ttu-id="c376c-266">Comme avec les rôles de travail, nous vous recommandons de spécifier `*` comme *version du système d’exploitation* afin que les nœuds soient automatiquement mis à niveau et qu’aucun travail supplémentaire ne soit requis pour gérer ces nouvelles versions.</span><span class="sxs-lookup"><span data-stu-id="c376c-266">As with worker roles, we recommend that you specify `*` for the *OS Version* so that the nodes are automatically upgraded, and there is no work required to cater to newly released versions.</span></span> <span data-ttu-id="c376c-267">La principale raison de sélectionner une version de système d’exploitation spécifique est d’assurer la compatibilité des applications, ce qui permet aux tests de compatibilité descendante d’être réalisés avant d’autoriser la mise à jour de la version.</span><span class="sxs-lookup"><span data-stu-id="c376c-267">The primary use case for selecting a specific OS version is to ensure application compatibility, which allows backward compatibility testing to be performed before allowing the version to be updated.</span></span> <span data-ttu-id="c376c-268">Une fois validée, la *version du système d’exploitation* du pool peut être mise à jour et la nouvelle image du système d’exploitation peut être installée. Toutes les tâches en cours d’exécution sont interrompues et remises en file d’attente.</span><span class="sxs-lookup"><span data-stu-id="c376c-268">After validation, the *OS Version* for the pool can be updated and the new OS image can be installed--any running tasks are interrupted and requeued.</span></span>

<span data-ttu-id="c376c-269">Lorsque vous créez un pool, vous devez sélectionner la valeur **nodeAgentSkuId** appropriée, selon le système d’exploitation de l’image de base de votre VHD.</span><span class="sxs-lookup"><span data-stu-id="c376c-269">When you create a pool, you need to select the appropriate **nodeAgentSkuId**, depending on the OS of the base image of your VHD.</span></span> <span data-ttu-id="c376c-270">Pour obtenir un mappage des ID de référence SKU d’agent de nœud disponible sur les références des images de système d’exploitation, appelez l’opération permettant de [répertorier les références SKU d’agent de nœud prises en charge](https://docs.microsoft.com/rest/api/batchservice/list-supported-node-agent-skus).</span><span class="sxs-lookup"><span data-stu-id="c376c-270">You can get a mapping of available node agent SKU ID's to their OS Image references by calling the [List Supported Node Agent SKUs](https://docs.microsoft.com/rest/api/batchservice/list-supported-node-agent-skus) operation.</span></span>

<span data-ttu-id="c376c-271">Consultez la section relative au [compte](#account) pour en savoir plus sur la définition du mode d’allocation de pool lorsque vous créez un compte Batch.</span><span class="sxs-lookup"><span data-stu-id="c376c-271">See the [Account](#account) section for information on setting the pool allocation mode when you create a Batch account.</span></span>

#### <a name="custom-images-for-virtual-machine-pools"></a><span data-ttu-id="c376c-272">Images personnalisées pour les pools de machines virtuelles</span><span class="sxs-lookup"><span data-stu-id="c376c-272">Custom images for Virtual Machine pools</span></span>

<span data-ttu-id="c376c-273">Pour pouvoir utiliser des images personnalisées pour vos pools de machines virtuelles, créez votre compte Batch avec le mode d’allocation de pool Abonnement utilisateur.</span><span class="sxs-lookup"><span data-stu-id="c376c-273">To use a custom image to provision Virtual Machine pools, create your Batch account with the User Subscription pool allocation mode.</span></span> <span data-ttu-id="c376c-274">Grâce à ce mode, les pools Batch sont alloués au sein de l’abonnement où se trouve le compte.</span><span class="sxs-lookup"><span data-stu-id="c376c-274">With this mode, Batch pools are allocated into the subscription where the account resides.</span></span> <span data-ttu-id="c376c-275">Consultez la section relative au [compte](#account) pour en savoir plus sur la définition du mode d’allocation de pool lorsque vous créez un compte Batch.</span><span class="sxs-lookup"><span data-stu-id="c376c-275">See the [Account](#account) section for information on setting the pool allocation mode when you create a Batch account.</span></span>

<span data-ttu-id="c376c-276">Pour utiliser une image personnalisée, vous devez préparer l’image en la généralisant.</span><span class="sxs-lookup"><span data-stu-id="c376c-276">To use a custom image, you'll need to prepare the image by generalizing it.</span></span> <span data-ttu-id="c376c-277">Pour en savoir plus sur la préparation d’images Linux personnalisées à partir de machines virtuelles Azure, consultez la section [Capturer une machine virtuelle Linux exécutée sur Azure](../virtual-machines/linux/capture-image-nodejs.md).</span><span class="sxs-lookup"><span data-stu-id="c376c-277">For information about preparing custom Linux images from Azure VMs, see [Capture an Azure Linux VM to use as a template](../virtual-machines/linux/capture-image-nodejs.md).</span></span> <span data-ttu-id="c376c-278">Pour plus d’informations sur la préparation d’images Windows personnalisées à partir de machines virtuelles Azure, consultez la section [Créer une image personnalisée d’une machine virtuelle Azure à l’aide de PowerShell](../virtual-machines/windows/tutorial-custom-images.md).</span><span class="sxs-lookup"><span data-stu-id="c376c-278">For information about preparing custom Windows images from Azure VMs, see [Create custom VM images with Azure PowerShell](../virtual-machines/windows/tutorial-custom-images.md).</span></span> 

> [!IMPORTANT]
> <span data-ttu-id="c376c-279">Lors de la préparation de votre image personnalisée, gardez à l’esprit les points suivants :</span><span class="sxs-lookup"><span data-stu-id="c376c-279">When preparing your custom image, keep in mind the following:</span></span>
> - <span data-ttu-id="c376c-280">Vérifiez que l’image de base du système d’exploitation utilisée pour approvisionner les pools Batch ne comporte pas d’extensions Azure préinstallées, telle que l’extension Script personnalisé.</span><span class="sxs-lookup"><span data-stu-id="c376c-280">Ensure that the base OS image you use to provision your Batch pools does not have any pre-installed Azure extensions, such as the Custom Script extension.</span></span> <span data-ttu-id="c376c-281">Si l’image contient une extension préinstallée, Azure peut rencontrer des problèmes de déploiement de la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="c376c-281">If the image contains a pre-installed extension, Azure may encounter problems deploying the VM.</span></span>
> - <span data-ttu-id="c376c-282">Assurez-vous que l’image de base du système d’exploitation utilise le lecteur temporaire par défaut, puisque l’agent de nœud Batch attend actuellement ce lecteur.</span><span class="sxs-lookup"><span data-stu-id="c376c-282">Ensure that the base OS image you provide uses the default temp drive, as the Batch node agent currently expects the default temp drive.</span></span>
>
>

<span data-ttu-id="c376c-283">Pour créer un pool de configuration de machines virtuelles à l’aide d’une image personnalisée, vous devez disposer au minimum d’un compte de stockage Microsoft Azure standard, dans lequel stocker vos images VHD personnalisées.</span><span class="sxs-lookup"><span data-stu-id="c376c-283">To create a Virtual Machine Configuration pool using a custom image, you'll need one or more standard Azure Storage accounts to store your custom VHD images.</span></span> <span data-ttu-id="c376c-284">Les images personnalisées sont stockées en tant que blobs.</span><span class="sxs-lookup"><span data-stu-id="c376c-284">Custom images are stored as blobs.</span></span> <span data-ttu-id="c376c-285">Pour faire référence à vos images personnalisées lorsque vous créez un pool, spécifiez les URI des blobs VHD d’images personnalisées pour la propriété [osDisk](https://docs.microsoft.com/rest/api/batchservice/add-a-pool-to-an-account#bk_osdisk) de la propriété [virtualMachineConfiguration](https://docs.microsoft.com/rest/api/batchservice/add-a-pool-to-an-account#bk_vmconf).</span><span class="sxs-lookup"><span data-stu-id="c376c-285">To reference your custom images when you create a pool, specify the URIs of the custom image VHD blobs for the [osDisk](https://docs.microsoft.com/rest/api/batchservice/add-a-pool-to-an-account#bk_osdisk) property of the [virtualMachineConfiguration](https://docs.microsoft.com/rest/api/batchservice/add-a-pool-to-an-account#bk_vmconf) property.</span></span>

<span data-ttu-id="c376c-286">Assurez-vous que vos comptes de stockage répondent aux critères suivants :</span><span class="sxs-lookup"><span data-stu-id="c376c-286">Make sure that your storage accounts meet the following criteria:</span></span>   

- <span data-ttu-id="c376c-287">Les comptes de stockage contenant des blobs VHD d’images personnalisées doivent se trouver dans le même abonnement que le compte Batch (abonnement utilisateur).</span><span class="sxs-lookup"><span data-stu-id="c376c-287">The storage accounts containing the custom image VHD blobs need to be in the same subscription as the Batch account (the user subscription).</span></span>
- <span data-ttu-id="c376c-288">Les comptes de stockage spécifiés doivent se trouver dans la même région que le compte Batch.</span><span class="sxs-lookup"><span data-stu-id="c376c-288">The specified storage accounts need to be in the same region as the Batch account.</span></span>
- <span data-ttu-id="c376c-289">Actuellement, seuls les comptes de stockage standards sont pris en charge.</span><span class="sxs-lookup"><span data-stu-id="c376c-289">Only standard general-purpose storage accounts are currently supported.</span></span> <span data-ttu-id="c376c-290">Nous prendrons prochainement en charge le stockage Azure Premium.</span><span class="sxs-lookup"><span data-stu-id="c376c-290">Azure Premium storage will be supported in the future.</span></span>
- <span data-ttu-id="c376c-291">Vous pouvez spécifier un compte de stockage avec plusieurs blobs VHD personnalisés, ou plusieurs comptes de stockage incluant un seul blob.</span><span class="sxs-lookup"><span data-stu-id="c376c-291">You can specify one storage account with multiple custom VHD blobs or multiple storage accounts each having a single blob.</span></span> <span data-ttu-id="c376c-292">Nous vous recommandons d’utiliser plusieurs comptes de stockage, afin d’optimiser les performances.</span><span class="sxs-lookup"><span data-stu-id="c376c-292">We recommend you to use multiple storage accounts to get a better performance.</span></span>
- <span data-ttu-id="c376c-293">Un seul blob VHD d’images personnalisées peut gérer jusqu’à 40 instances de machines virtuelles Linux, ou 20 instances de machines virtuelles Windows.</span><span class="sxs-lookup"><span data-stu-id="c376c-293">One unique custom image VHD blob can support up to 40 Linux VM instances or 20 Windows VM instances.</span></span> <span data-ttu-id="c376c-294">Vous devez créer des copies des blobs VHD pour pouvoir générer des pools incluant plusieurs machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="c376c-294">You will need to create copies of the VHD blob to create pools with more VMs.</span></span> <span data-ttu-id="c376c-295">Par exemple, un pool incluant 200 machines virtuelles Windows requiert la spécification de 10 blobs VHD uniques pour la propriété **osDisk**.</span><span class="sxs-lookup"><span data-stu-id="c376c-295">For example, a pool with 200 Windows VMs needs 10 unique VHD blobs specified for the **osDisk** property.</span></span>

<span data-ttu-id="c376c-296">Pour créer un pool à partir d’une image personnalisée, à l’aide du portail Azure, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="c376c-296">To create a pool from a custom image using the Azure portal:</span></span>

1. <span data-ttu-id="c376c-297">Accédez à votre compte  Batch dans le portail Azure.</span><span class="sxs-lookup"><span data-stu-id="c376c-297">Navigate to your Batch account in the Azure portal.</span></span>
2. <span data-ttu-id="c376c-298">Dans le panneau **Paramètres**, sélectionnez l’élément de menu **Pools**.</span><span class="sxs-lookup"><span data-stu-id="c376c-298">On the **Settings** blade, select the **Pools** menu item.</span></span>
3. <span data-ttu-id="c376c-299">Sur le panneau **Pools**, sélectionnez la commande **Ajouter**. Le panneau **Ajouter un pool** s’affiche.</span><span class="sxs-lookup"><span data-stu-id="c376c-299">On the **Pools** blade, select the **Add** command; the **Add pool** blade will be displayed.</span></span>
4. <span data-ttu-id="c376c-300">Sélectionnez l’option **Image personnalisée (Linux/Windows)** dans la liste déroulante **Type d’image**.</span><span class="sxs-lookup"><span data-stu-id="c376c-300">Select **Custom Image (Linux/Windows)** from the **Image Type** dropdown.</span></span> <span data-ttu-id="c376c-301">Le portail affiche le sélecteur **Image personnalisée**.</span><span class="sxs-lookup"><span data-stu-id="c376c-301">The portal displays the **Custom Image** picker.</span></span> <span data-ttu-id="c376c-302">Choisissez un ou plusieurs VHD dans le même conteneur et cliquez sur le bouton **Sélectionner**.</span><span class="sxs-lookup"><span data-stu-id="c376c-302">Choose one or more VHDs from the same container and click the **Select** button.</span></span> 
    <span data-ttu-id="c376c-303">La prise en charge de plusieurs VHD à partir de plusieurs comptes de stockage et conteneurs différents sera assurée prochainement.</span><span class="sxs-lookup"><span data-stu-id="c376c-303">Support for multiple VHDs from different storage accounts and different containers will be added in the future.</span></span>
5. <span data-ttu-id="c376c-304">Sélectionnez les valeurs **d’éditeur/d’offre/de référence SKU** adéquates de vos VHD personnalisés, choisissez le mode de **mise en cache**, puis indiquez l’ensemble des autres paramètres du pool.</span><span class="sxs-lookup"><span data-stu-id="c376c-304">Select the correct **Publisher/Offer/Sku** for your custom VHDs, select the desired **Caching** mode, then fill in all the other parameters for the pool.</span></span>
6. <span data-ttu-id="c376c-305">Pour vérifier si un pool est basé sur une image personnalisée, consultez la propriété relative au **système d’exploitation** dans la section Récapitulatif des ressources du panneau **Pool**.</span><span class="sxs-lookup"><span data-stu-id="c376c-305">To check if a pool is based on a custom image, see the **Operating System** property in the resource summary section of the **Pool** blade.</span></span> <span data-ttu-id="c376c-306">La valeur de cette propriété doit être **Image de machine virtuelle personnalisée**.</span><span class="sxs-lookup"><span data-stu-id="c376c-306">The value of this property should be **Custom VM image**.</span></span>
7. <span data-ttu-id="c376c-307">Tous les VHD associés à un pool sont affichés sur le panneau **Propriétés** de ce dernier.</span><span class="sxs-lookup"><span data-stu-id="c376c-307">All custom VHDs associated with a pool are displayed on the pool's **Properties** blade.</span></span>

### <a name="compute-node-type-and-target-number-of-nodes"></a><span data-ttu-id="c376c-308">Type de nœud de calcul et nombre cible de nœuds</span><span class="sxs-lookup"><span data-stu-id="c376c-308">Compute node type and target number of nodes</span></span>

<span data-ttu-id="c376c-309">Lorsque vous créez un pool, vous pouvez spécifier les types de nœuds de calcul souhaités et le nombre cible pour chacun.</span><span class="sxs-lookup"><span data-stu-id="c376c-309">When you create a pool, you can specify which types of compute nodes you want and the target number for each.</span></span> <span data-ttu-id="c376c-310">Les deux types de nœuds de calcul sont les suivants :</span><span class="sxs-lookup"><span data-stu-id="c376c-310">The two types of compute nodes are:</span></span>

- <span data-ttu-id="c376c-311">**Nœuds de calcul dédiés.**</span><span class="sxs-lookup"><span data-stu-id="c376c-311">**Dedicated compute nodes.**</span></span> <span data-ttu-id="c376c-312">Les nœuds de calcul dédiés sont réservés à vos charges de travail.</span><span class="sxs-lookup"><span data-stu-id="c376c-312">Dedicated compute nodes are reserved for your workloads.</span></span> <span data-ttu-id="c376c-313">Ils sont plus chers que les nœuds à faible priorité, mais sont assurés de ne jamais être reportés.</span><span class="sxs-lookup"><span data-stu-id="c376c-313">They are more expensive than low-priority nodes, but they are guaranteed to never be preempted.</span></span>

- <span data-ttu-id="c376c-314">**Nœuds de calcul à faible priorité.**</span><span class="sxs-lookup"><span data-stu-id="c376c-314">**Low-priority compute nodes.**</span></span> <span data-ttu-id="c376c-315">Les nœuds à faible priorité tirent profit de la capacité excédentaire dans Azure pour exécuter vos charges de travail par lots.</span><span class="sxs-lookup"><span data-stu-id="c376c-315">Low-priority nodes take advantage of surplus capacity in Azure to run your Batch workloads.</span></span> <span data-ttu-id="c376c-316">Le coût horaire des nœuds à faible priorité est moins élevé que celui des nœuds dédiés. Par ailleurs, ces nœuds activent des charges de travail nécessitant une importante puissance de calcul.</span><span class="sxs-lookup"><span data-stu-id="c376c-316">Low-priority nodes are less expensive per hour than dedicated nodes, and enable workloads requiring a lot of compute power.</span></span> <span data-ttu-id="c376c-317">Pour plus d’informations, consultez [Utiliser des machines virtuelles à faible priorité avec Batch](batch-low-pri-vms.md).</span><span class="sxs-lookup"><span data-stu-id="c376c-317">For more information, see [Use low-priority VMs with Batch](batch-low-pri-vms.md).</span></span>

    <span data-ttu-id="c376c-318">Les nœuds de calcul à faible priorité peuvent être reportés lorsque Azure n’a pas suffisamment de capacité excédentaire.</span><span class="sxs-lookup"><span data-stu-id="c376c-318">Low-priority compute nodes may be preempted when Azure has insufficient surplus capacity.</span></span> <span data-ttu-id="c376c-319">Si un nœud est reporté lors de l’exécution de tâches, celles-ci sont remises dans la file d’attente et exécutées à nouveau dès qu’un nœud de calcul redevient disponible.</span><span class="sxs-lookup"><span data-stu-id="c376c-319">If a node is preempted while running tasks, the tasks are requeued and run again once a compute node becomes available again.</span></span> <span data-ttu-id="c376c-320">Les nœuds à faible priorité sont intéressants pour les charges de travail pour lesquelles l’heure d’achèvement est flexible et le travail est réparti entre plusieurs nœuds.</span><span class="sxs-lookup"><span data-stu-id="c376c-320">Low-priority nodes are a good option for workloads where the job completion time is flexible and the work is distributed across many nodes.</span></span> <span data-ttu-id="c376c-321">Avant de décider d’utiliser des nœuds à faible priorité pour votre scénario, assurez-vous que le nombre de tâches risquant d’être perdues sera peu élevé, et que ces tâches seront faciles à recréer, le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="c376c-321">Before you decide to use low-priority nodes for your scenario, make sure that any work lost due to preemption will be minimal and easy to recreate.</span></span>

    <span data-ttu-id="c376c-322">Les nœuds de calcul à faible priorité sont disponibles uniquement pour les comptes Batch créés avec le mode d’allocation de pool défini sur **Service Batch**.</span><span class="sxs-lookup"><span data-stu-id="c376c-322">Low-priority compute nodes are available only for Batch accounts created with the pool allocation mode set to **Batch Service**.</span></span>

<span data-ttu-id="c376c-323">Un même pool peut contenir des nœuds de calcul dédiés et à faible priorité.</span><span class="sxs-lookup"><span data-stu-id="c376c-323">You can have both low-priority and dedicated compute nodes in the same pool.</span></span> <span data-ttu-id="c376c-324">Chaque type de nœud &mdash; dédié et à faible priorité &mdash; a son propre paramètre de cible pour lequel vous pouvez spécifier le nombre de nœuds souhaité.</span><span class="sxs-lookup"><span data-stu-id="c376c-324">Each type of node &mdash; low-priority and dedicated &mdash; has its own target setting, for which you can specify the desired number of nodes.</span></span> 
    
<span data-ttu-id="c376c-325">Le nombre de nœuds de calcul est appelé *cible* car, dans certaines situations, votre pool ne pourra peut-être pas atteindre le nombre de nœuds souhaité.</span><span class="sxs-lookup"><span data-stu-id="c376c-325">The number of compute nodes is referred to as a *target* because, in some situations, your pool might not reach the desired number of nodes.</span></span> <span data-ttu-id="c376c-326">Par exemple, un pool ne pourra peut-être pas atteindre la cible s’il atteint d’abord le [quota de base](batch-quota-limit.md) de votre compte Batch</span><span class="sxs-lookup"><span data-stu-id="c376c-326">For example, a pool might not achieve the target if it reaches the [core quota](batch-quota-limit.md) for your Batch account first.</span></span> <span data-ttu-id="c376c-327">ou si vous avez appliqué au pool une formule de mise à l’échelle automatique qui limite le nombre maximal de nœuds.</span><span class="sxs-lookup"><span data-stu-id="c376c-327">Or, the pool might not achieve the target if you have applied an auto-scaling formula to the pool that limits the maximum number of nodes.</span></span>

<span data-ttu-id="c376c-328">Pour obtenir les informations de tarification des nœuds de calcul dédiés et à faible priorité, consultez [Tarification du service Batch](https://azure.microsoft.com/pricing/details/batch/).</span><span class="sxs-lookup"><span data-stu-id="c376c-328">For pricing information for both low-priority and dedicated compute nodes, see [Batch Pricing](https://azure.microsoft.com/pricing/details/batch/).</span></span>

### <a name="size-of-the-compute-nodes"></a><span data-ttu-id="c376c-329">Taille des nœuds de calcul</span><span class="sxs-lookup"><span data-stu-id="c376c-329">Size of the compute nodes</span></span>

<span data-ttu-id="c376c-330">**Configuration de Cloud Services** sont répertoriées dans [Tailles de services cloud](../cloud-services/cloud-services-sizes-specs.md).</span><span class="sxs-lookup"><span data-stu-id="c376c-330">**Cloud Services Configuration** compute node sizes are listed in [Sizes for Cloud Services](../cloud-services/cloud-services-sizes-specs.md).</span></span> <span data-ttu-id="c376c-331">Le service Batch prend en charge l’ensemble des tailles de services cloud, à l’exception de `ExtraSmall`, `STANDARD_A1_V2` et `STANDARD_A2_V2`.</span><span class="sxs-lookup"><span data-stu-id="c376c-331">Batch supports all Cloud Services sizes except `ExtraSmall`, `STANDARD_A1_V2`, and `STANDARD_A2_V2`.</span></span>

<span data-ttu-id="c376c-332">Les tailles de nœud de calcul de la **configuration de machines virtuelles** sont répertoriées dans [Tailles des machines virtuelles dans Azure](../virtual-machines/linux/sizes.md) (Linux) et [Tailles des machines virtuelles dans Azure](../virtual-machines/windows/sizes.md) (Windows).</span><span class="sxs-lookup"><span data-stu-id="c376c-332">**Virtual Machine Configuration** compute node sizes are listed in [Sizes for virtual machines in Azure](../virtual-machines/linux/sizes.md) (Linux) and [Sizes for virtual machines in Azure](../virtual-machines/windows/sizes.md) (Windows).</span></span> <span data-ttu-id="c376c-333">Le service Batch prend en charge l’ensemble des tailles de machine virtuelle Azure, à l’exception de `STANDARD_A0` et de celles comprises dans Premium Storage (série `STANDARD_GS`, `STANDARD_DS`, et `STANDARD_DSV2`).</span><span class="sxs-lookup"><span data-stu-id="c376c-333">Batch supports all Azure VM sizes except `STANDARD_A0` and those with premium storage (`STANDARD_GS`, `STANDARD_DS`, and `STANDARD_DSV2` series).</span></span>

<span data-ttu-id="c376c-334">Lorsque vous sélectionnez une taille de nœud de calcul, tenez compte des caractéristiques et des exigences des applications que vous allez exécuter sur les nœuds.</span><span class="sxs-lookup"><span data-stu-id="c376c-334">When selecting a compute node size, consider the characteristics and requirements of the applications you'll run on the nodes.</span></span> <span data-ttu-id="c376c-335">Des aspects tels que la nature multithread de l’application et le volume de mémoire utilisé vous aideront à déterminer la taille de nœud la mieux adaptée et la plus rentable.</span><span class="sxs-lookup"><span data-stu-id="c376c-335">Aspects like whether the application is multithreaded and how much memory it consumes can help determine the most suitable and cost-effective node size.</span></span> <span data-ttu-id="c376c-336">La taille du nœud est souvent sélectionnée en supposant qu’une tâche s’exécutera sur un nœud à la fois.</span><span class="sxs-lookup"><span data-stu-id="c376c-336">It's typical to select a node size assuming one task will run on a node at a time.</span></span> <span data-ttu-id="c376c-337">Cependant, plusieurs tâches (et par conséquent, plusieurs instances d’application) peuvent [s’exécuter en parallèle](batch-parallel-node-tasks.md) sur les nœuds de calcul lors de l’exécution du travail.</span><span class="sxs-lookup"><span data-stu-id="c376c-337">However, it is possible to have multiple tasks (and therefore multiple application instances) [run in parallel](batch-parallel-node-tasks.md) on compute nodes during job execution.</span></span> <span data-ttu-id="c376c-338">Dans ce cas, il est courant de choisir une plus grande taille de nœud pour prendre en charge la demande accrue de l’exécution parallèle des tâches.</span><span class="sxs-lookup"><span data-stu-id="c376c-338">In this case, it is common to choose a larger node size to accommodate the increased demand of parallel task execution.</span></span> <span data-ttu-id="c376c-339">Pour plus d’informations, consultez la section [Stratégie de planification de tâches](#task-scheduling-policy).</span><span class="sxs-lookup"><span data-stu-id="c376c-339">See [Task scheduling policy](#task-scheduling-policy) for more information.</span></span>

<span data-ttu-id="c376c-340">Tous les nœuds du pool ont la même taille.</span><span class="sxs-lookup"><span data-stu-id="c376c-340">All of the nodes in a pool are the same size.</span></span> <span data-ttu-id="c376c-341">Si vous prévoyez d’exécuter des applications dont la configuration système requise et/ou les niveaux de charge diffèrent, nous vous recommandons d’utiliser des pools distincts.</span><span class="sxs-lookup"><span data-stu-id="c376c-341">If you intend to run applications with differing system requirements and/or load levels, we recommend that you use separate pools.</span></span>

### <a name="scaling-policy"></a><span data-ttu-id="c376c-342">Stratégie de mise à l’échelle</span><span class="sxs-lookup"><span data-stu-id="c376c-342">Scaling policy</span></span>

<span data-ttu-id="c376c-343">Pour les charges de travail dynamiques, vous pouvez écrire et appliquer une [formule de mise à l’échelle automatique](#scaling-compute-resources) à un pool.</span><span class="sxs-lookup"><span data-stu-id="c376c-343">For dynamic workloads, you can write and apply an [auto-scaling formula](#scaling-compute-resources) to a pool.</span></span> <span data-ttu-id="c376c-344">Le service Batch évalue régulièrement la formule et ajuste le nombre de nœuds dans le pool en fonction de différents paramètres de pool, de travail et de tâche que vous pouvez spécifier.</span><span class="sxs-lookup"><span data-stu-id="c376c-344">The Batch service periodically evaluates your formula and adjusts the number of nodes within the pool based on various pool, job, and task parameters that you can specify.</span></span>

### <a name="task-scheduling-policy"></a><span data-ttu-id="c376c-345">Stratégie de planification des tâches</span><span class="sxs-lookup"><span data-stu-id="c376c-345">Task scheduling policy</span></span>

<span data-ttu-id="c376c-346">L’option de configuration [Nombre maximal de tâches par nœud](batch-parallel-node-tasks.md) détermine le nombre maximal de tâches qui peuvent être exécutées en parallèle sur chaque nœud de calcul au sein du pool.</span><span class="sxs-lookup"><span data-stu-id="c376c-346">The [max tasks per node](batch-parallel-node-tasks.md) configuration option determines the maximum number of tasks that can be run in parallel on each compute node within the pool.</span></span>

<span data-ttu-id="c376c-347">La configuration par défaut prévoit de n’exécuter qu’une seule tâche à la fois sur un nœud. Toutefois, dans certains scénarios, il est préférable d’exécuter plusieurs tâches simultanément sur un nœud.</span><span class="sxs-lookup"><span data-stu-id="c376c-347">The default configuration specifies that one task at a time runs on a node, but there are scenarios where it is beneficial to have two or more tasks executed on a node simultaneously.</span></span> <span data-ttu-id="c376c-348">Consultez [l’exemple de scénario](batch-parallel-node-tasks.md#example-scenario) de l’article sur les [tâches de nœud simultanées](batch-parallel-node-tasks.md) pour découvrir comment tirer parti de plusieurs tâches par nœud.</span><span class="sxs-lookup"><span data-stu-id="c376c-348">See the [example scenario](batch-parallel-node-tasks.md#example-scenario) in the [concurrent node tasks](batch-parallel-node-tasks.md) article to see how you can benefit from multiple tasks per node.</span></span>

<span data-ttu-id="c376c-349">Vous pouvez également spécifier un *type de remplissage* qui détermine si l’option Batch répartit les tâches uniformément sur tous les nœuds dans un pool, ou remplit chaque nœud avec le nombre maximal de tâches avant d’affecter des tâches à un autre nœud.</span><span class="sxs-lookup"><span data-stu-id="c376c-349">You can also specify a *fill type* which determines whether Batch spreads the tasks evenly across all nodes in a pool, or packs each node with the maximum number of tasks before assigning tasks to another node.</span></span>

### <a name="communication-status-for-compute-nodes"></a><span data-ttu-id="c376c-350">État de communication des nœuds de calcul</span><span class="sxs-lookup"><span data-stu-id="c376c-350">Communication status for compute nodes</span></span>

<span data-ttu-id="c376c-351">Dans la plupart des scénarios, les tâches fonctionnent indépendamment et n’ont pas besoin de communiquer les unes avec les autres.</span><span class="sxs-lookup"><span data-stu-id="c376c-351">In most scenarios, tasks operate independently and do not need to communicate with one another.</span></span> <span data-ttu-id="c376c-352">Cependant, il existe des applications dans lesquelles les tâches doivent communiquer, par exemple les [scénarios impliquant des applications MPI](batch-mpi.md).</span><span class="sxs-lookup"><span data-stu-id="c376c-352">However, there are some applications in which tasks must communicate, like [MPI scenarios](batch-mpi.md).</span></span>

<span data-ttu-id="c376c-353">Vous pouvez configurer un pool en activant la **communication entre nœuds** afin de permettre aux nœuds du pool de communiquer au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="c376c-353">You can configure a pool to allow **internode communication**, so that nodes within a pool can communicate at runtime.</span></span> <span data-ttu-id="c376c-354">Lorsque la communication entre les nœuds est activée, les nœuds des pools Configuration de Cloud Services peuvent communiquer entre eux sur les ports supérieurs à 1100, et les pools Configuration de la machine virtuelle ne limitent pas le trafic sur les ports.</span><span class="sxs-lookup"><span data-stu-id="c376c-354">When internode communication is enabled, nodes in Cloud Services Configuration pools can communicate with each other on ports greater than 1100, and Virtual Machine Configuration pools do not restrict traffic on any port.</span></span>

<span data-ttu-id="c376c-355">Notez que l’activation de la communication entre les nœuds affecte également le placement des nœuds au sein des clusters et peut limiter le nombre maximal de nœuds dans un pool en raison des restrictions de déploiement.</span><span class="sxs-lookup"><span data-stu-id="c376c-355">Note that enabling internode communication also impacts the placement of the nodes within clusters and might limit the maximum number of nodes in a pool because of deployment restrictions.</span></span> <span data-ttu-id="c376c-356">Si votre application ne nécessite pas de communication entre les nœuds, le service Batch peut éventuellement allouer au pool un grand nombre de nœuds issus de différents centres de données et clusters pour accroître la puissance de traitement parallèle.</span><span class="sxs-lookup"><span data-stu-id="c376c-356">If your application does not require communication between nodes, the Batch service can allocate a potentially large number of nodes to the pool from many different clusters and datacenters to enable increased parallel processing power.</span></span>

### <a name="start-tasks-for-compute-nodes"></a><span data-ttu-id="c376c-357">Tâches de démarrage des nœuds de calcul</span><span class="sxs-lookup"><span data-stu-id="c376c-357">Start tasks for compute nodes</span></span>

<span data-ttu-id="c376c-358">La *tâche de démarrage* facultative s’exécute sur chacun des nœuds rejoignant le pool, ainsi qu’à chaque redémarrage ou réinitialisation d’un nœud.</span><span class="sxs-lookup"><span data-stu-id="c376c-358">The optional *start task* executes on each node as that node joins the pool, and each time a node is restarted or reimaged.</span></span> <span data-ttu-id="c376c-359">La tâche de démarrage est particulièrement utile pour la préparation des nœuds de calcul à l’exécution de tâches, comme l’installation des applications que vos tâches exécutent sur les nœuds de calcul.</span><span class="sxs-lookup"><span data-stu-id="c376c-359">The start task is especially useful for preparing compute nodes for the execution of tasks, like installing the applications that your tasks run on the compute nodes.</span></span>

### <a name="application-packages"></a><span data-ttu-id="c376c-360">packages d’application</span><span class="sxs-lookup"><span data-stu-id="c376c-360">Application packages</span></span>

<span data-ttu-id="c376c-361">Vous pouvez spécifier des [packages d’applications](#application-packages) à déployer sur les nœuds de calcul dans le pool.</span><span class="sxs-lookup"><span data-stu-id="c376c-361">You can specify [application packages](#application-packages) to deploy to the compute nodes in the pool.</span></span> <span data-ttu-id="c376c-362">Les packages d’applications permettent un déploiement simplifié et le contrôle de version des applications exécutées par vos tâches.</span><span class="sxs-lookup"><span data-stu-id="c376c-362">Application packages provide simplified deployment and versioning of the applications that your tasks run.</span></span> <span data-ttu-id="c376c-363">Les packages d’applications que vous spécifiez pour un pool sont installés sur chaque nœud qui rejoint le pool, et à chaque fois qu’un nœud est redémarré ou réinitialisé.</span><span class="sxs-lookup"><span data-stu-id="c376c-363">Application packages that you specify for a pool are installed on every node that joins that pool, and every time a node is rebooted or reimaged.</span></span>

> [!NOTE]
> <span data-ttu-id="c376c-364">Les packages d’applications sont pris en charge sur tous les pools Batch créés après le 5 juillet 2017.</span><span class="sxs-lookup"><span data-stu-id="c376c-364">Application packages are supported on all Batch pools created after 5 July 2017.</span></span> <span data-ttu-id="c376c-365">Ils sont pris en charge sur les pools Batch créés entre le 10 mars 2016 et le 5 juillet 2017 uniquement si le pool a été créé à l’aide d’une configuration de service cloud.</span><span class="sxs-lookup"><span data-stu-id="c376c-365">They are supported on Batch pools created between 10 March 2016 and 5 July 2017 only if the pool was created using a Cloud Service configuration.</span></span> <span data-ttu-id="c376c-366">Les pools Batch créés avant le 10 mars 2016 ne prennent pas en charge les packages d’applications.</span><span class="sxs-lookup"><span data-stu-id="c376c-366">Batch pools created prior to 10 March 2016 do not support application packages.</span></span> <span data-ttu-id="c376c-367">Pour plus d’informations sur l’utilisation de packages d’applications pour déployer vos applications sur vos nœuds Batch, consultez [Déployer des applications sur les nœuds avec des packages d’applications Batch](batch-application-packages.md).</span><span class="sxs-lookup"><span data-stu-id="c376c-367">For more information about using application packages to deploy your applications to your Batch nodes, see [Deploy applications to compute nodes with Batch application packages](batch-application-packages.md).</span></span>
>
>

### <a name="network-configuration"></a><span data-ttu-id="c376c-368">Configuration réseau</span><span class="sxs-lookup"><span data-stu-id="c376c-368">Network configuration</span></span>

<span data-ttu-id="c376c-369">Vous pouvez spécifier le sous-réseau d’un [réseau virtuel (VNet)](../virtual-network/virtual-networks-overview.md) Azure dans lequel les nœuds de calcul du pool doivent être créés.</span><span class="sxs-lookup"><span data-stu-id="c376c-369">You can specify the subnet of an Azure [virtual network (VNet)](../virtual-network/virtual-networks-overview.md) in which the pool's compute nodes should be created.</span></span> <span data-ttu-id="c376c-370">Pour plus d'informations, consultez [Configuration du réseau de pools](#pool-network-configuration).</span><span class="sxs-lookup"><span data-stu-id="c376c-370">See the [Pool network configuration](#pool-network-configuration) section for more information.</span></span>


## <a name="job"></a><span data-ttu-id="c376c-371">Travail</span><span class="sxs-lookup"><span data-stu-id="c376c-371">Job</span></span>
<span data-ttu-id="c376c-372">Un travail est une collection de tâches.</span><span class="sxs-lookup"><span data-stu-id="c376c-372">A job is a collection of tasks.</span></span> <span data-ttu-id="c376c-373">Il gère la façon dont le calcul est effectué par ses tâches sur les nœuds de calcul d’un pool.</span><span class="sxs-lookup"><span data-stu-id="c376c-373">It manages how computation is performed by its tasks on the compute nodes in a pool.</span></span>

* <span data-ttu-id="c376c-374">Le travail spécifie le **pool** sur lequel le travail doit être exécuté.</span><span class="sxs-lookup"><span data-stu-id="c376c-374">The job specifies the **pool** in which the work is to be run.</span></span> <span data-ttu-id="c376c-375">Vous pouvez créer un nouveau pool pour chaque tâche, ou utiliser un pool pour plusieurs travaux.</span><span class="sxs-lookup"><span data-stu-id="c376c-375">You can create a new pool for each job, or use one pool for many jobs.</span></span> <span data-ttu-id="c376c-376">Vous pouvez créer un pool pour chaque travail associé à une planification de travail, ou pour tous les travaux associés à une planification de travail.</span><span class="sxs-lookup"><span data-stu-id="c376c-376">You can create a pool for each job that is associated with a job schedule, or for all jobs that are associated with a job schedule.</span></span>
* <span data-ttu-id="c376c-377">Une **priorité de travail**facultative peut être spécifiée.</span><span class="sxs-lookup"><span data-stu-id="c376c-377">You can specify an optional **job priority**.</span></span> <span data-ttu-id="c376c-378">Quand un travail dont la priorité est supérieure à celle des autres travaux en cours est envoyé, les tâches du travail dont la priorité est la plus élevée sont insérées dans la file d’attente devant les tâches des travaux de priorité inférieure.</span><span class="sxs-lookup"><span data-stu-id="c376c-378">When a job is submitted with a higher priority than jobs that are currently in progress, the tasks for the higher-priority job are inserted into the queue ahead of tasks for the lower-priority jobs.</span></span> <span data-ttu-id="c376c-379">Les tâches des travaux de priorité inférieure qui sont déjà en cours d’exécution ne sont pas reportées.</span><span class="sxs-lookup"><span data-stu-id="c376c-379">Tasks in lower-priority jobs that are already running are not preempted.</span></span>
* <span data-ttu-id="c376c-380">Vous pouvez utiliser des **contraintes** de travail pour spécifier certaines limites pour vos travaux :</span><span class="sxs-lookup"><span data-stu-id="c376c-380">You can use job **constraints** to specify certain limits for your jobs:</span></span>

    <span data-ttu-id="c376c-381">Vous pouvez définir une **durée maximale**pour les travaux ; si la durée d’exécution du travail est supérieure à la durée maximale spécifiée, le travail et toutes les tâches qui lui sont associées seront terminés.</span><span class="sxs-lookup"><span data-stu-id="c376c-381">You can set a **maximum wallclock time**, so that if a job runs for longer than the maximum wallclock time that is specified, the job and all of its tasks are terminated.</span></span>

    <span data-ttu-id="c376c-382">Le service Batch peut détecter, puis relancer des tâches ayant échoué.</span><span class="sxs-lookup"><span data-stu-id="c376c-382">Batch can detect and then retry failed tasks.</span></span> <span data-ttu-id="c376c-383">Vous pouvez spécifier le **nombre maximal de nouvelles tentatives de tâche** en tant que contrainte, et indiquer notamment si une tâche doit *toujours* être systématiquement relancée ou ne *jamais* l’être.</span><span class="sxs-lookup"><span data-stu-id="c376c-383">You can specify the **maximum number of task retries** as a constraint, including whether a task is *always* or *never* retried.</span></span> <span data-ttu-id="c376c-384">Lorsqu’une tâche est relancée, cela signifie qu’elle est remise en file d’attente afin d’être réexécutée.</span><span class="sxs-lookup"><span data-stu-id="c376c-384">Retrying a task means that the task is requeued to be run again.</span></span>
* <span data-ttu-id="c376c-385">Votre application cliente peut ajouter des tâches à un travail. Vous pouvez également spécifier une [tâche du gestionnaire de travaux](#job-manager-task).</span><span class="sxs-lookup"><span data-stu-id="c376c-385">Your client application can add tasks to a job, or you can specify a [job manager task](#job-manager-task).</span></span> <span data-ttu-id="c376c-386">Une tâche de ce type contient les informations nécessaires à la création des tâches requises pour un travail et elle s’exécute sur l’un des nœuds de calcul du pool.</span><span class="sxs-lookup"><span data-stu-id="c376c-386">A job manager task contains the information that is necessary to create the required tasks for a job, with the job manager task being run on one of the compute nodes in the pool.</span></span> <span data-ttu-id="c376c-387">La tâche du gestionnaire de travaux est gérée spécifiquement par Batch : elle est mise en file d’attente dès que le travail est créé et elle est redémarrée en cas d’échec.</span><span class="sxs-lookup"><span data-stu-id="c376c-387">The job manager task is handled specifically by Batch--it is queued as soon as the job is created, and is restarted if it fails.</span></span> <span data-ttu-id="c376c-388">Une tâche du gestionnaire de travaux est *requise* pour les travaux créés dans le cadre d’une [planification de travail](#scheduled-jobs), car il s’agit du seul moyen de définir les tâches avant que le travail ne soit instancié.</span><span class="sxs-lookup"><span data-stu-id="c376c-388">A job manager task is *required* for jobs that are created by a [job schedule](#scheduled-jobs) because it is the only way to define the tasks before the job is instantiated.</span></span>
* <span data-ttu-id="c376c-389">Par défaut, l’état des tâches est maintenu comme actif lorsque toutes les tâches du travail sont terminées.</span><span class="sxs-lookup"><span data-stu-id="c376c-389">By default, jobs remain in the active state when all tasks within the job are complete.</span></span> <span data-ttu-id="c376c-390">Vous pouvez modifier cette configuration pour terminer automatiquement le travail lorsque toutes les tâches afférentes ont été accomplies.</span><span class="sxs-lookup"><span data-stu-id="c376c-390">You can change this behavior so that the job is automatically terminated when all tasks in the job are complete.</span></span> <span data-ttu-id="c376c-391">Définissez la propriété **onAllTasksComplete** du travail ([OnAllTasksComplete][net_onalltaskscomplete] dans .NET Batch) sur *terminatejob* pour terminer automatiquement le travail lorsque l’état de toutes les tâches afférentes est défini comme terminé.</span><span class="sxs-lookup"><span data-stu-id="c376c-391">Set the job's **onAllTasksComplete** property ([OnAllTasksComplete][net_onalltaskscomplete] in Batch .NET) to *terminatejob* to automatically terminate the job when all of its tasks are in the completed state.</span></span>

    <span data-ttu-id="c376c-392">Notez que le service Batch considère les travaux ne présentant *aucune* tâche comme des travaux dont toutes les tâches sont terminées.</span><span class="sxs-lookup"><span data-stu-id="c376c-392">Note that the Batch service considers a job with *no* tasks to have all of its tasks completed.</span></span> <span data-ttu-id="c376c-393">C’est la raison pour laquelle cette option est généralement utilisée avec une [tâche de gestionnaire de travaux](#job-manager-task).</span><span class="sxs-lookup"><span data-stu-id="c376c-393">Therefore, this option is most commonly used with a [job manager task](#job-manager-task).</span></span> <span data-ttu-id="c376c-394">Si vous souhaitez définir l’arrêt automatique d’un travail sans utiliser de gestionnaire de travaux, définissez initialement la propriété **onAllTasksComplete** d’un nouveau travail sur *noaction*, puis sur *terminatejob* seulement une fois que vous avez terminé d’ajouter des tâches au travail.</span><span class="sxs-lookup"><span data-stu-id="c376c-394">If you want to use automatic job termination without a job manager, you should initially set a new job's **onAllTasksComplete** property to *noaction*, then set it to *terminatejob* only after you've finished adding tasks to the job.</span></span>

### <a name="job-priority"></a><span data-ttu-id="c376c-395">priorité de travail</span><span class="sxs-lookup"><span data-stu-id="c376c-395">Job priority</span></span>
<span data-ttu-id="c376c-396">Vous pouvez établir une priorité pour les travaux que vous créez dans Batch.</span><span class="sxs-lookup"><span data-stu-id="c376c-396">You can assign a priority to jobs that you create in Batch.</span></span> <span data-ttu-id="c376c-397">Le service Batch utilise les valeurs de priorité du travail pour déterminer l’ordre de planification du travail dans un compte (à ne pas confondre avec le [travail planifié](#scheduled-jobs)).</span><span class="sxs-lookup"><span data-stu-id="c376c-397">The Batch service uses the priority value of the job to determine the order of job scheduling within an account (this is not to be confused with a [scheduled job](#scheduled-jobs)).</span></span> <span data-ttu-id="c376c-398">Les valeurs de priorité sont comprises entre -1000 et 1000, -1000 étant la priorité la plus basse et 1000 la plus élevée.</span><span class="sxs-lookup"><span data-stu-id="c376c-398">The priority values range from -1000 to 1000, with -1000 being the lowest priority and 1000 being the highest.</span></span> <span data-ttu-id="c376c-399">Pour mettre à jour la priorité d’un travail, appelez l’opération [Mettre à jour les propriétés d’un travail][rest_update_job] (REST Batch) ou modifiez la propriété [CloudJob.Priority][net_cloudjob_priority] (.NET Batch).</span><span class="sxs-lookup"><span data-stu-id="c376c-399">To update the priority of a job, call the [Update the properties of a job][rest_update_job] operation (Batch REST), or modify the [CloudJob.Priority][net_cloudjob_priority] property (Batch .NET).</span></span>

<span data-ttu-id="c376c-400">Dans un même compte, les travaux de priorité supérieure sont prioritaires en termes de planification sur les travaux de priorité inférieure.</span><span class="sxs-lookup"><span data-stu-id="c376c-400">Within the same account, higher-priority jobs have scheduling precedence over lower-priority jobs.</span></span> <span data-ttu-id="c376c-401">Un travail à priorité supérieure dans un compte n’est pas prioritaire en termes de planification sur un autre travail à priorité inférieure dans un autre compte.</span><span class="sxs-lookup"><span data-stu-id="c376c-401">A job with a higher-priority value in one account does not have scheduling precedence over another job with a lower-priority value in a different account.</span></span>

<span data-ttu-id="c376c-402">La planification de travail entre pools est indépendante.</span><span class="sxs-lookup"><span data-stu-id="c376c-402">Job scheduling across pools is independent.</span></span> <span data-ttu-id="c376c-403">Entre des pools différents, un travail à priorité supérieure n’est pas systématiquement planifié en premier si le pool auquel il est associé n’a pas suffisamment de nœuds inactifs.</span><span class="sxs-lookup"><span data-stu-id="c376c-403">Between different pools, it is not guaranteed that a higher-priority job is scheduled first if its associated pool is short of idle nodes.</span></span> <span data-ttu-id="c376c-404">Dans le même pool, les travaux avec le même niveau de priorité ont autant de chance d’être planifiés.</span><span class="sxs-lookup"><span data-stu-id="c376c-404">In the same pool, jobs with the same priority level have an equal chance of being scheduled.</span></span>

### <a name="scheduled-jobs"></a><span data-ttu-id="c376c-405">Scheduled jobs</span><span class="sxs-lookup"><span data-stu-id="c376c-405">Scheduled jobs</span></span>
<span data-ttu-id="c376c-406">Les [planifications de travaux][rest_job_schedules] vous permettent de créer des travaux périodiques au sein du service Batch.</span><span class="sxs-lookup"><span data-stu-id="c376c-406">[Job schedules][rest_job_schedules] enable you to create recurring jobs within the Batch service.</span></span> <span data-ttu-id="c376c-407">Une planification de travail indique le moment où exécuter des tâches et les spécifications des travaux à exécuter.</span><span class="sxs-lookup"><span data-stu-id="c376c-407">A job schedule specifies when to run jobs and includes the specifications for the jobs to be run.</span></span> <span data-ttu-id="c376c-408">Vous pouvez spécifier la durée de la planification (durée proprement dite et date d’entrée en vigueur de la planification), ainsi que la fréquence de création des travaux au cours de la période de planification.</span><span class="sxs-lookup"><span data-stu-id="c376c-408">You can specify the duration of the schedule--how long and when the schedule is in effect--and how frequently jobs are created during the scheduled period.</span></span>

## <a name="task"></a><span data-ttu-id="c376c-409">Task</span><span class="sxs-lookup"><span data-stu-id="c376c-409">Task</span></span>
<span data-ttu-id="c376c-410">Une tâche est une unité de calcul associée à un travail.</span><span class="sxs-lookup"><span data-stu-id="c376c-410">A task is a unit of computation that is associated with a job.</span></span> <span data-ttu-id="c376c-411">Elle s’exécute sur un nœud.</span><span class="sxs-lookup"><span data-stu-id="c376c-411">It runs on a node.</span></span> <span data-ttu-id="c376c-412">Les tâches sont affectées à un nœud afin d’être exécutées ou sont mises en file d’attente jusqu’à ce qu’un nœud soit disponible.</span><span class="sxs-lookup"><span data-stu-id="c376c-412">Tasks are assigned to a node for execution, or are queued until a node becomes free.</span></span> <span data-ttu-id="c376c-413">Une tâche exécute un ou plusieurs programmes ou scripts sur un nœud de calcul afin d’effectuer le travail nécessaire.</span><span class="sxs-lookup"><span data-stu-id="c376c-413">Put simply, a task runs one or more programs or scripts on a compute node to perform the work you need done.</span></span>

<span data-ttu-id="c376c-414">Lorsque vous créez une tâche, vous pouvez spécifier les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="c376c-414">When you create a task, you can specify:</span></span>

* <span data-ttu-id="c376c-415">**Ligne de commande** de la tâche.</span><span class="sxs-lookup"><span data-stu-id="c376c-415">The **command line** for the task.</span></span> <span data-ttu-id="c376c-416">Il s’agit de la ligne de commande qui exécute votre application ou script sur le nœud de calcul.</span><span class="sxs-lookup"><span data-stu-id="c376c-416">This is the command line that runs your application or script on the compute node.</span></span>

    <span data-ttu-id="c376c-417">Il est important de noter que la ligne de commande ne s’exécute pas réellement sous un interpréteur de commandes.</span><span class="sxs-lookup"><span data-stu-id="c376c-417">It is important to note that the command line does not actually run under a shell.</span></span> <span data-ttu-id="c376c-418">Elle ne peut donc pas tirer parti en mode natif des fonctionnalités de l’interpréteur de commandes, comme l’expansion de [variables d’environnement](#environment-settings-for-tasks) (qui inclut le `PATH`).</span><span class="sxs-lookup"><span data-stu-id="c376c-418">Therefore, it cannot natively take advantage of shell features like [environment variable](#environment-settings-for-tasks) expansion (this includes the `PATH`).</span></span> <span data-ttu-id="c376c-419">Pour tirer parti de ces fonctionnalités, vous devez appeler l’interpréteur de commandes dans la ligne de commande, par exemple, en lançant `cmd.exe` sur les nœuds Windows ou `/bin/sh` sur Linux :</span><span class="sxs-lookup"><span data-stu-id="c376c-419">To take advantage of such features, you must invoke the shell in the command line--for example, by launching `cmd.exe` on Windows nodes or `/bin/sh` on Linux:</span></span>

    `cmd /c MyTaskApplication.exe %MY_ENV_VAR%`

    `/bin/sh -c MyTaskApplication $MY_ENV_VAR`

    <span data-ttu-id="c376c-420">Si vos tâches doivent exécuter une application ou un script hors du `PATH` du nœud ou référencer des variables d’environnement, appelez l’interpréteur de commandes explicitement dans la ligne de commande de la tâche.</span><span class="sxs-lookup"><span data-stu-id="c376c-420">If your tasks need to run an application or script that is not in the node's `PATH` or reference environment variables, invoke the shell explicitly in the task command line.</span></span>
* <span data-ttu-id="c376c-421">**Fichiers de ressources** contenant les données à traiter.</span><span class="sxs-lookup"><span data-stu-id="c376c-421">**Resource files** that contain the data to be processed.</span></span> <span data-ttu-id="c376c-422">Ces fichiers sont automatiquement copiés sur le nœud à partir de Stockage Blob dans un compte Stockage Azure à usage général avant l’exécution de la ligne de commande de la tâche.</span><span class="sxs-lookup"><span data-stu-id="c376c-422">These files are automatically copied to the node from Blob storage in a general-purpose Azure Storage account before the task's command line is executed.</span></span> <span data-ttu-id="c376c-423">Pour plus d’informations, consultez les sections [Tâche de démarrage](#start-task) et [Fichiers et répertoires](#files-and-directories).</span><span class="sxs-lookup"><span data-stu-id="c376c-423">For more information, see the sections [Start task](#start-task) and [Files and directories](#files-and-directories).</span></span>
* <span data-ttu-id="c376c-424">Les **variables d’environnement** requises par l’application.</span><span class="sxs-lookup"><span data-stu-id="c376c-424">The **environment variables** that are required by your application.</span></span> <span data-ttu-id="c376c-425">Pour plus d’informations, consultez la section [Paramètres d’environnement des tâches](#environment-settings-for-tasks) .</span><span class="sxs-lookup"><span data-stu-id="c376c-425">For more information, see the [Environment settings for tasks](#environment-settings-for-tasks) section.</span></span>
* <span data-ttu-id="c376c-426">Les **contraintes** sous lesquelles la tâche doit s’exécuter.</span><span class="sxs-lookup"><span data-stu-id="c376c-426">The **constraints** under which the task should execute.</span></span> <span data-ttu-id="c376c-427">Les contraintes comprennent notamment la durée maximale pendant laquelle la tâche est autorisée à s’exécuter, le nombre maximal de nouvelles tentatives en cas d’échec de la tâche, ainsi que la durée maximale de conservation des fichiers dans le répertoire de travail de la tâche.</span><span class="sxs-lookup"><span data-stu-id="c376c-427">For example, constraints include the maximum time that the task is allowed to run, the maximum number of times a failed task should be retried, and the maximum time that files in the task's working directory are retained.</span></span>
* <span data-ttu-id="c376c-428">**Packages d’applications** à déployer sur le nœud de calcul sur lequel l’exécution de la tâche est planifiée.</span><span class="sxs-lookup"><span data-stu-id="c376c-428">**Application packages** to deploy to the compute node on which the task is scheduled to run.</span></span> <span data-ttu-id="c376c-429">[Application packages](#application-packages) permettent le déploiement simplifié et le contrôle de version des applications exécutées par vos tâches.</span><span class="sxs-lookup"><span data-stu-id="c376c-429">[Application packages](#application-packages) provide simplified deployment and versioning of the applications that your tasks run.</span></span> <span data-ttu-id="c376c-430">Les packages d’applications au niveau des tâches sont particulièrement utiles dans les environnements de pool partagé, où différentes tâches sont exécutées sur un même pool et le pool n’est pas supprimé lorsqu’un travail est terminé.</span><span class="sxs-lookup"><span data-stu-id="c376c-430">Task-level application packages are especially useful in shared-pool environments, where different jobs are run on one pool, and the pool is not deleted when a job is completed.</span></span> <span data-ttu-id="c376c-431">Si votre travail présente moins de tâches que le pool ne contient de nœuds, les packages d’applications au niveau des tâches peuvent réduire le transfert de données, votre application n’étant déployée que sur les nœuds exécutant les tâches.</span><span class="sxs-lookup"><span data-stu-id="c376c-431">If your job has fewer tasks than nodes in the pool, task application packages can minimize data transfer since your application is deployed only to the nodes that run tasks.</span></span>

<span data-ttu-id="c376c-432">Outre les tâches que vous pouvez définir pour effectuer des calculs sur un nœud, les tâches spéciales suivantes sont également fournies par le service Batch :</span><span class="sxs-lookup"><span data-stu-id="c376c-432">In addition to tasks you define to perform computation on a node, the following special tasks are also provided by the Batch service:</span></span>

* [<span data-ttu-id="c376c-433">Tâche de démarrage</span><span class="sxs-lookup"><span data-stu-id="c376c-433">Start task</span></span>](#start-task)
* [<span data-ttu-id="c376c-434">Tâche du gestionnaire de travaux</span><span class="sxs-lookup"><span data-stu-id="c376c-434">Job manager task</span></span>](#job-manager-task)
* [<span data-ttu-id="c376c-435">Tâches de préparation et lancement</span><span class="sxs-lookup"><span data-stu-id="c376c-435">Job preparation and release tasks</span></span>](#job-preparation-and-release-tasks)
* [<span data-ttu-id="c376c-436">Tâches multi-instances (MPI)</span><span class="sxs-lookup"><span data-stu-id="c376c-436">Multi-instance tasks (MPI)</span></span>](#multi-instance-tasks)
* [<span data-ttu-id="c376c-437">Dépendances de la tâche</span><span class="sxs-lookup"><span data-stu-id="c376c-437">Task dependencies</span></span>](#task-dependencies)

### <a name="start-task"></a><span data-ttu-id="c376c-438">Tâche de démarrage</span><span class="sxs-lookup"><span data-stu-id="c376c-438">Start task</span></span>
<span data-ttu-id="c376c-439">En associant une **tâche de démarrage** à un pool, vous pouvez préparer l’environnement d’exploitation de ses nœuds.</span><span class="sxs-lookup"><span data-stu-id="c376c-439">By associating a **start task** with a pool, you can prepare the operating environment of its nodes.</span></span> <span data-ttu-id="c376c-440">Par exemple, vous pouvez effectuer des opérations telles que l’installation des applications que vos tâches exécuteront ou le démarrage des processus d’arrière-plan.</span><span class="sxs-lookup"><span data-stu-id="c376c-440">For example, you can perform actions like installing the applications that your tasks run or starting background processes.</span></span> <span data-ttu-id="c376c-441">La tâche de démarrage s’exécute à chaque démarrage d’un nœud tant qu’il reste dans le pool, notamment lorsque le nœud est ajouté au pool en premier lieu, redémarré ou réinitialisé.</span><span class="sxs-lookup"><span data-stu-id="c376c-441">The start task runs every time a node starts, for as long as it remains in the pool--including when the node is first added to the pool and when it is restarted or reimaged.</span></span>

<span data-ttu-id="c376c-442">Le principal avantage de la tâche de démarrage est qu’elle peut contenir toutes les informations nécessaires pour configurer un nœud de calcul et installer les applications requises pour l’exécution de la tâche.</span><span class="sxs-lookup"><span data-stu-id="c376c-442">A primary benefit of the start task is that it can contain all of the information that is necessary to configure a compute node and install the applications that are required for task execution.</span></span> <span data-ttu-id="c376c-443">L’augmentation du nombre de nœuds dans un pool revient donc tout simplement à spécifier le nouveau nombre de nœuds cible.</span><span class="sxs-lookup"><span data-stu-id="c376c-443">Therefore, increasing the number of nodes in a pool is as simple as specifying the new target node count.</span></span> <span data-ttu-id="c376c-444">La tâche de démarrage fournit au service Batch les informations nécessaires pour la configuration des nouveaux nœuds et pour leur préparation à l’acceptation des tâches.</span><span class="sxs-lookup"><span data-stu-id="c376c-444">The start task provides the Batch service the information that is needed to configure the new nodes and get them ready for accepting tasks.</span></span>

<span data-ttu-id="c376c-445">Comme dans le cas de n’importe quelle tâche Azure Batch, vous pouvez spécifier une liste de **fichiers de ressources** dans [Stockage Azure][azure_storage], en plus d’une **ligne de commande** à exécuter.</span><span class="sxs-lookup"><span data-stu-id="c376c-445">As with any Azure Batch task, you can specify a list of **resource files** in [Azure Storage][azure_storage], in addition to a **command line** to be executed.</span></span> <span data-ttu-id="c376c-446">Le service Batch commence par copier les fichiers de ressources sur le nœud à partir de Stockage Azure, puis exécute la ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="c376c-446">The Batch service first copies the resource files to the node from Azure Storage, and then runs the command line.</span></span> <span data-ttu-id="c376c-447">Pour une tâche de démarrage de pool, la liste des fichiers contient généralement l’application de la tâche et ses dépendances.</span><span class="sxs-lookup"><span data-stu-id="c376c-447">For a pool start task, the file list typically contains the task application and its dependencies.</span></span>

<span data-ttu-id="c376c-448">Toutefois, la tâche de démarrage peut également inclure des données de référence qui doivent être utilisées par toutes les tâches exécutées sur le nœud de calcul.</span><span class="sxs-lookup"><span data-stu-id="c376c-448">However, the start task could also include reference data to be used by all tasks that are running on the compute node.</span></span> <span data-ttu-id="c376c-449">Par exemple, la ligne de commande d’une tâche de démarrage peut effectuer une opération `robocopy` afin de copier les fichiers d’application (qui ont été spécifiés comme fichiers de ressources et téléchargés vers le nœud) à partir du [répertoire de travail](#files-and-directories) de la tâche de démarrage vers le [dossier partagé](#files-and-directories), puis exécuter un MSI ou `setup.exe`.</span><span class="sxs-lookup"><span data-stu-id="c376c-449">For example, a start task's command line could perform a `robocopy` operation to copy application files (which were specified as resource files and downloaded to the node) from the start task's [working directory](#files-and-directories) to the [shared folder](#files-and-directories), and then run an MSI or `setup.exe`.</span></span>

<span data-ttu-id="c376c-450">Il est généralement préférable pour le service Batch d’attendre que la tâche de démarrage soit terminée avant de considérer que le nœud est prêt à recevoir des tâches, mais vous pouvez configurer ce paramètre.</span><span class="sxs-lookup"><span data-stu-id="c376c-450">It is typically desirable for the Batch service to wait for the start task to complete before considering the node ready to be assigned tasks, but you can configure this.</span></span>

<span data-ttu-id="c376c-451">Si une tâche de démarrage échoue sur un nœud du pool, l’état du nœud est mis à jour pour refléter l’échec et aucune tâche n’est affectée au nœud.</span><span class="sxs-lookup"><span data-stu-id="c376c-451">If a start task fails on a compute node, then the state of the node is updated to reflect the failure, and the node is not assigned any tasks.</span></span> <span data-ttu-id="c376c-452">Une tâche de démarrage peut échouer en cas de problème de copie des fichiers de ressources depuis le stockage, ou si le processus exécuté par sa ligne de commande retourne un code de sortie différent de zéro.</span><span class="sxs-lookup"><span data-stu-id="c376c-452">A start task can fail if there is an issue copying its resource files from storage, or if the process executed by its command line returns a nonzero exit code.</span></span>

<span data-ttu-id="c376c-453">Si vous ajoutez ou mettez à jour la tâche de démarrage pour un pool existant, vous devez redémarrer ses nœuds de calcul pour que cette tâche soit appliquée aux nœuds.</span><span class="sxs-lookup"><span data-stu-id="c376c-453">If you add or update the start task for an existing pool, you must reboot its compute nodes for the start task to be applied to the nodes.</span></span>

>[!NOTE]
> <span data-ttu-id="c376c-454">La taille totale d’une tâche de démarrage doit être inférieure ou égale à 32 768 caractères, y compris les fichiers de ressources et les variables d’environnement.</span><span class="sxs-lookup"><span data-stu-id="c376c-454">The total size of a start task must be less than or equal to 32768 characters, including resource files and environment variables.</span></span> <span data-ttu-id="c376c-455">Pour vous assurer que votre tâche de démarrage répond à cette exigence, vous pouvez utiliser l’une des deux approches suivantes :</span><span class="sxs-lookup"><span data-stu-id="c376c-455">To ensure that your start task meets this requirement, you can use one of two approaches:</span></span>
>
> 1. <span data-ttu-id="c376c-456">Utilisez des packages d’application pour distribuer des applications ou des données sur chaque nœud de votre pool  Batch.</span><span class="sxs-lookup"><span data-stu-id="c376c-456">You can use application packages to distribute applications or data across each node in your Batch pool.</span></span> <span data-ttu-id="c376c-457">Pour en savoir plus sur les packages d’applications, consultez [Déployer des applications sur les nœuds avec des packages d’applications Batch](batch-application-packages.md).</span><span class="sxs-lookup"><span data-stu-id="c376c-457">For more information about application packages, see [Deploy applications to compute nodes with Batch application packages](batch-application-packages.md).</span></span>
> 2. <span data-ttu-id="c376c-458">Vous pouvez créer manuellement une archive au format ZIP contenant vos fichiers d’applications.</span><span class="sxs-lookup"><span data-stu-id="c376c-458">You can manually create a zipped archive containing your applications files.</span></span> <span data-ttu-id="c376c-459">Chargez l’archive ZIP dans le stockage Azure, en tant que blob.</span><span class="sxs-lookup"><span data-stu-id="c376c-459">Upload your zipped archive to Azure Storage as a blob.</span></span> <span data-ttu-id="c376c-460">Spécifiez cette archive sous la forme d’un fichier de ressources pour votre tâche de démarrage.</span><span class="sxs-lookup"><span data-stu-id="c376c-460">Specify the zipped archive as a resource file for your start task.</span></span> <span data-ttu-id="c376c-461">Avant d’exécuter la ligne de commande pour votre tâche de démarrage, décompressez l’archive à partir de la ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="c376c-461">Before you run the command line for your start task, unzip the archive from the command line.</span></span> 
>
>    <span data-ttu-id="c376c-462">Pour ce faire, vous pouvez utiliser l’outil d’archivage de votre choix.</span><span class="sxs-lookup"><span data-stu-id="c376c-462">To unzip the archive, you can use the archiving tool of your choice.</span></span> <span data-ttu-id="c376c-463">Vous devez inclure l’outil qui vous permet de décompresser l’archive en tant que fichier de ressources pour la tâche de démarrage.</span><span class="sxs-lookup"><span data-stu-id="c376c-463">You will need to include the tool that you use to unzip the archive as a resource file for the start task.</span></span>
>
>

### <a name="job-manager-task"></a><span data-ttu-id="c376c-464">Tâche du gestionnaire de travaux</span><span class="sxs-lookup"><span data-stu-id="c376c-464">Job manager task</span></span>
<span data-ttu-id="c376c-465">Vous utilisez généralement une **tâche du gestionnaire de travaux** pour contrôler et/ou surveiller l’exécution des travaux, par exemple, pour créer et soumettre les tâches d’un travail, identifier les autres tâches à exécuter et déterminer lorsque le travail est terminé.</span><span class="sxs-lookup"><span data-stu-id="c376c-465">You typically use a **job manager task** to control and/or monitor job execution--for example, to create and submit the tasks for a job, determine additional tasks to run, and determine when work is complete.</span></span> <span data-ttu-id="c376c-466">Toutefois, une tâche du gestionnaire de travaux n’est pas limitée à ces activités.</span><span class="sxs-lookup"><span data-stu-id="c376c-466">However, a job manager task is not restricted to these activities.</span></span> <span data-ttu-id="c376c-467">C’est une tâche à part entière qui peut effectuer toutes les actions requises pour le travail.</span><span class="sxs-lookup"><span data-stu-id="c376c-467">It is a fully fledged task that can perform any actions that are required for the job.</span></span> <span data-ttu-id="c376c-468">Par exemple, une tâche du gestionnaire de travaux peut télécharger un fichier spécifié en tant que paramètre, en analyser le contenu et soumettre des tâches supplémentaires en fonction de ce contenu.</span><span class="sxs-lookup"><span data-stu-id="c376c-468">For example, a job manager task might download a file that is specified as a parameter, analyze the contents of that file, and submit additional tasks based on those contents.</span></span>

<span data-ttu-id="c376c-469">Une tâche du gestionnaire de travaux est lancée avant toutes les autres tâches.</span><span class="sxs-lookup"><span data-stu-id="c376c-469">A job manager task is started before all other tasks.</span></span> <span data-ttu-id="c376c-470">Elle fournit les fonctionnalités suivantes :</span><span class="sxs-lookup"><span data-stu-id="c376c-470">It provides the following features:</span></span>

* <span data-ttu-id="c376c-471">Elle est automatiquement soumise en tant que tâche par le service Batch lorsque le travail est créé.</span><span class="sxs-lookup"><span data-stu-id="c376c-471">It is automatically submitted as a task by the Batch service when the job is created.</span></span>
* <span data-ttu-id="c376c-472">Elle est planifiée pour s’exécuter avant les autres tâches d’un projet.</span><span class="sxs-lookup"><span data-stu-id="c376c-472">It is scheduled to execute before the other tasks in a job.</span></span>
* <span data-ttu-id="c376c-473">Le nœud associé est le dernier à être supprimé d’un pool lorsque la taille de ce dernier diminue.</span><span class="sxs-lookup"><span data-stu-id="c376c-473">Its associated node is the last to be removed from a pool when the pool is being downsized.</span></span>
* <span data-ttu-id="c376c-474">Son arrêt peut être lié à l'arrêt de toutes les tâches du travail.</span><span class="sxs-lookup"><span data-stu-id="c376c-474">Its termination can be tied to the termination of all tasks in the job.</span></span>
* <span data-ttu-id="c376c-475">Une tâche de gestionnaire de travaux reçoit la priorité la plus élevée lorsqu’elle doit être redémarrée.</span><span class="sxs-lookup"><span data-stu-id="c376c-475">A job manager task is given the highest priority when it needs to be restarted.</span></span> <span data-ttu-id="c376c-476">Si aucun nœud inactif n’est disponible, le service Batch peut mettre fin à une tâche en cours d’exécution dans le pool pour libérer de l’espace pour l’exécution de la tâche du gestionnaire de travaux.</span><span class="sxs-lookup"><span data-stu-id="c376c-476">If an idle node is not available, the Batch service might terminate one of the other running tasks in the pool to make room for the job manager task to run.</span></span>
* <span data-ttu-id="c376c-477">Une tâche du gestionnaire de travaux associée à un travail n’a pas la priorité sur les tâches d’autres travaux.</span><span class="sxs-lookup"><span data-stu-id="c376c-477">A job manager task in one job does not have priority over the tasks of other jobs.</span></span> <span data-ttu-id="c376c-478">Parmi les travaux, seules les priorités au niveau du travail sont observées.</span><span class="sxs-lookup"><span data-stu-id="c376c-478">Across jobs, only job-level priorities are observed.</span></span>

### <a name="job-preparation-and-release-tasks"></a><span data-ttu-id="c376c-479">Tâches de préparation et lancement</span><span class="sxs-lookup"><span data-stu-id="c376c-479">Job preparation and release tasks</span></span>
<span data-ttu-id="c376c-480">Batch fournit des tâches de préparation des travaux pour la configuration de l’exécution des travaux préliminaire.</span><span class="sxs-lookup"><span data-stu-id="c376c-480">Batch provides job preparation tasks for pre-job execution setup.</span></span> <span data-ttu-id="c376c-481">Les tâches de validation des travaux sont destinées à la maintenance ou au nettoyage postérieurs aux travaux.</span><span class="sxs-lookup"><span data-stu-id="c376c-481">Job release tasks are for post-job maintenance or cleanup.</span></span>

* <span data-ttu-id="c376c-482">**Tâche de préparation de travail**: une tâche de préparation de travail s’exécute sur tous les nœuds de calcul qui sont planifiés pour exécuter les tâches avant l’exécution des autres tâches du travail.</span><span class="sxs-lookup"><span data-stu-id="c376c-482">**Job preparation task**: A job preparation task runs on all compute nodes that are scheduled to run tasks, before any of the other job tasks are executed.</span></span> <span data-ttu-id="c376c-483">Vous pouvez utiliser une tâche de préparation du travail pour copier les données partagées par toutes les tâches, mais propres au travail, par exemple.</span><span class="sxs-lookup"><span data-stu-id="c376c-483">You can use a job preparation task to copy data that is shared by all tasks, but is unique to the job, for example.</span></span>
* <span data-ttu-id="c376c-484">**Tâche de validation de travail**: lorsqu’un travail est terminé, une tâche de validation de travail s’exécute sur chaque nœud du pool ayant exécuté au moins une tâche.</span><span class="sxs-lookup"><span data-stu-id="c376c-484">**Job release task**: When a job has completed, a job release task runs on each node in the pool that executed at least one task.</span></span> <span data-ttu-id="c376c-485">Vous pouvez utiliser une tâche de validation de travail pour supprimer les données copiées par la tâche de préparation de travail, ou pour compresser et charger des données de journaux de diagnostic, par exemple.</span><span class="sxs-lookup"><span data-stu-id="c376c-485">You can use a job release task to delete data that is copied by the job preparation task, or to compress and upload diagnostic log data, for example.</span></span>

<span data-ttu-id="c376c-486">Les tâches de préparation et de validation de travail vous permettent de spécifier une ligne de commande à exécuter lorsque la tâche est appelée.</span><span class="sxs-lookup"><span data-stu-id="c376c-486">Both job preparation and release tasks allow you to specify a command line to run when the task is invoked.</span></span> <span data-ttu-id="c376c-487">Elles offrent des fonctionnalités telles que le téléchargement de fichiers, une exécution élevée, des variables d’environnement personnalisées, une durée d’exécution maximale, le nombre de tentatives et la durée de rétention des fichiers.</span><span class="sxs-lookup"><span data-stu-id="c376c-487">They offer features like file download, elevated execution, custom environment variables, maximum execution duration, retry count, and file retention time.</span></span>

<span data-ttu-id="c376c-488">Pour plus d’informations sur les tâches de préparation de travail et de validation, consultez [Exécuter les tâches de préparation de travail et de validation sur les nœuds de calcul Azure Batch](batch-job-prep-release.md).</span><span class="sxs-lookup"><span data-stu-id="c376c-488">For more information on job preparation and release tasks, see [Run job preparation and completion tasks on Azure Batch compute nodes](batch-job-prep-release.md).</span></span>

### <a name="multi-instance-task"></a><span data-ttu-id="c376c-489">Tâche multi-instance</span><span class="sxs-lookup"><span data-stu-id="c376c-489">Multi-instance task</span></span>
<span data-ttu-id="c376c-490">Une [tâche multi-instance](batch-mpi.md) est une tâche configurée pour s’exécuter simultanément sur plusieurs nœuds de calcul.</span><span class="sxs-lookup"><span data-stu-id="c376c-490">A [multi-instance task](batch-mpi.md) is a task that is configured to run on more than one compute node simultaneously.</span></span> <span data-ttu-id="c376c-491">Avec des tâches multi-instances, vous pouvez permettre des scénarios de calcul haute performance qui requièrent un groupe de nœuds de calcul alloués ensemble pour traiter une seule et même charge de travail (comme MPI).</span><span class="sxs-lookup"><span data-stu-id="c376c-491">With multi-instance tasks, you can enable high-performance computing scenarios that require a group of compute nodes that are allocated together to process a single workload (like Message Passing Interface (MPI)).</span></span>

<span data-ttu-id="c376c-492">Pour une présentation détaillée de l’exécution des travaux MPI dans Batch à l’aide de la bibliothèque .NET Batch, consultez l’article [Utiliser les tâches multi-instances pour exécuter des applications MPI (Message Passing Interface) dans Azure Batch](batch-mpi.md).</span><span class="sxs-lookup"><span data-stu-id="c376c-492">For a detailed discussion on running MPI jobs in Batch by using the Batch .NET library, check out [Use multi-instance tasks to run Message Passing Interface (MPI) applications in Azure Batch](batch-mpi.md).</span></span>

### <a name="task-dependencies"></a><span data-ttu-id="c376c-493">Dépendances de la tâche</span><span class="sxs-lookup"><span data-stu-id="c376c-493">Task dependencies</span></span>
<span data-ttu-id="c376c-494">La [dépendance entre tâches](batch-task-dependencies.md), comme son nom l’indique, vous permet de préciser que l’exécution d’une tâche dépend de l’achèvement préalable d’autres tâches.</span><span class="sxs-lookup"><span data-stu-id="c376c-494">[Task dependencies](batch-task-dependencies.md), as the name implies, allow you to specify that a task depends on the completion of other tasks before its execution.</span></span> <span data-ttu-id="c376c-495">Cette fonctionnalité prend en charge des situations dans lesquelles une tâche « en aval » consomme la sortie d’une tâche « en amont », ou lorsqu’une tâche en amont effectue une initialisation requise par une tâche en aval.</span><span class="sxs-lookup"><span data-stu-id="c376c-495">This feature provides support for situations in which a "downstream" task consumes the output of an "upstream" task--or when an upstream task performs some initialization that is required by a downstream task.</span></span> <span data-ttu-id="c376c-496">Pour utiliser cette fonctionnalité, vous devez d’abord activer les dépendances de tâche sur la tâche Batch.</span><span class="sxs-lookup"><span data-stu-id="c376c-496">To use this feature, you must first enable task dependencies on your Batch job.</span></span> <span data-ttu-id="c376c-497">Ensuite, pour chaque tâche qui dépend d’une autre (ou de plusieurs autres), vous devez spécifier les tâches dont elle dépend.</span><span class="sxs-lookup"><span data-stu-id="c376c-497">Then, for each task that depends on another (or many others), you specify the tasks which that task depends on.</span></span>

<span data-ttu-id="c376c-498">Avec l’interdépendance des tâches, vous pouvez configurer des scénarios tels que :</span><span class="sxs-lookup"><span data-stu-id="c376c-498">With task dependencies, you can configure scenarios like the following:</span></span>

* <span data-ttu-id="c376c-499">*taskB* dépend de *taskA* (l’exécution de *taskB* ne commence pas tant que celle de *taskA* n’est pas terminée).</span><span class="sxs-lookup"><span data-stu-id="c376c-499">*taskB* depends on *taskA* (*taskB* will not begin execution until *taskA* has completed).</span></span>
* <span data-ttu-id="c376c-500">*taskC* dépend de *taskA* et de *taskB*.</span><span class="sxs-lookup"><span data-stu-id="c376c-500">*taskC* depends on both *taskA* and *taskB*.</span></span>
* <span data-ttu-id="c376c-501">*taskD* dépend d’une plage de tâches, notamment des tâches *1* à *10* avant de pouvoir s’exécuter.</span><span class="sxs-lookup"><span data-stu-id="c376c-501">*taskD* depends on a range of tasks, such as tasks *1* through *10*, before it executes.</span></span>

<span data-ttu-id="c376c-502">Pour plus d’informations détaillées sur cette fonctionnalité, consultez l’article [Dépendances de tâches dans Azure Batch](batch-task-dependencies.md) et l’exemple de code [TaskDependencies][github_sample_taskdeps] dans le référentiel GitHub [azure-batch-samples][github_samples].</span><span class="sxs-lookup"><span data-stu-id="c376c-502">Check out [Task dependencies in Azure Batch](batch-task-dependencies.md) and the [TaskDependencies][github_sample_taskdeps] code sample in the [azure-batch-samples][github_samples] GitHub repository for more in-depth details on this feature.</span></span>

## <a name="environment-settings-for-tasks"></a><span data-ttu-id="c376c-503">Paramètres d’environnement des tâches</span><span class="sxs-lookup"><span data-stu-id="c376c-503">Environment settings for tasks</span></span>
<span data-ttu-id="c376c-504">Chaque tâche exécutée par le service Batch a accès aux variables d’environnement définies sur les nœuds de calcul.</span><span class="sxs-lookup"><span data-stu-id="c376c-504">Each task executed by the Batch service has access to environment variables that it sets on compute nodes.</span></span> <span data-ttu-id="c376c-505">Cela inclut les variables d’environnement définies par le service Batch (voir [cet article][msdn_env_vars]) et les variables d’environnement personnalisées que vous pouvez définir pour vos tâches.</span><span class="sxs-lookup"><span data-stu-id="c376c-505">This includes environment variables defined by the Batch service ([service-defined][msdn_env_vars]) and custom environment variables that you can define for your tasks.</span></span> <span data-ttu-id="c376c-506">Les applications et les scripts que vos tâches exécutent sur les nœuds ont accès à ces variables d’environnement pendant l’exécution.</span><span class="sxs-lookup"><span data-stu-id="c376c-506">The applications and scripts your tasks execute have access to these environment variables during execution.</span></span>

<span data-ttu-id="c376c-507">Vous pouvez définir des variables d’environnement personnalisées au niveau de la tâche ou du travail en remplissant la propriété de *paramètres d’environnement* pour ces entités.</span><span class="sxs-lookup"><span data-stu-id="c376c-507">You can set custom environment variables at the task or job level by populating the *environment settings* property for these entities.</span></span> <span data-ttu-id="c376c-508">Par exemple, consultez l’opération [Ajouter une tâche à un travail][rest_add_task] (API REST Batch) ou les propriétés [CloudTask.EnvironmentSettings][net_cloudtask_env] et [CloudJob.CommonEnvironmentSettings][net_job_env] dans .NET Batch.</span><span class="sxs-lookup"><span data-stu-id="c376c-508">For example, see the [Add a task to a job][rest_add_task] operation (Batch REST API), or the [CloudTask.EnvironmentSettings][net_cloudtask_env] and [CloudJob.CommonEnvironmentSettings][net_job_env] properties in Batch .NET.</span></span>

<span data-ttu-id="c376c-509">L’application cliente ou le service peuvent obtenir des variables d’environnement d’une tâche, à la fois définies par le service et personnalisées, à l’aide de l’opération [Obtenir des informations sur une tâche][rest_get_task_info] (REST Batch) ou en accédant à la propriété [CloudTask.EnvironmentSettings][net_cloudtask_env] (.NET Batch).</span><span class="sxs-lookup"><span data-stu-id="c376c-509">Your client application or service can obtain a task's environment variables, both service-defined and custom, by using the [Get information about a task][rest_get_task_info] operation (Batch REST) or by accessing the [CloudTask.EnvironmentSettings][net_cloudtask_env] property (Batch .NET).</span></span> <span data-ttu-id="c376c-510">Les processus qui s’exécutent sur un nœud de calcul peuvent accéder à ces dernières ainsi qu’à d’autres variables d’environnement sur le nœud, par exemple à l’aide de la syntaxe classique `%VARIABLE_NAME%` (Windows) ou la syntaxe `$VARIABLE_NAME` (Linux).</span><span class="sxs-lookup"><span data-stu-id="c376c-510">Processes executing on a compute node can access these and other environment variables on the node, for example, by using the familiar `%VARIABLE_NAME%` (Windows) or `$VARIABLE_NAME` (Linux) syntax.</span></span>

<span data-ttu-id="c376c-511">Vous trouverez la liste complète des variables d’environnement définies par le service dans l’article [Compute node environment variables][msdn_env_vars] (Variables d’environnement de nœud de calcul).</span><span class="sxs-lookup"><span data-stu-id="c376c-511">You can find a full list of all service-defined environment variables in [Compute node environment variables][msdn_env_vars].</span></span>

## <a name="files-and-directories"></a><span data-ttu-id="c376c-512">Fichiers et répertoires</span><span class="sxs-lookup"><span data-stu-id="c376c-512">Files and directories</span></span>
<span data-ttu-id="c376c-513">Chaque tâche possède un *répertoire de travail* sous lequel elle crée zéro ou plusieurs fichiers et répertoires.</span><span class="sxs-lookup"><span data-stu-id="c376c-513">Each task has a *working directory* under which it creates zero or more files and directories.</span></span> <span data-ttu-id="c376c-514">Ce répertoire de travail peut être utilisé pour stocker le programme exécuté par la tâche, les données qu’il traite et la sortie du traitement qu’il effectue.</span><span class="sxs-lookup"><span data-stu-id="c376c-514">This working directory can be used for storing the program that is run by the task, the data that it processes, and the output of the processing it performs.</span></span> <span data-ttu-id="c376c-515">Tous les fichiers et répertoires d’une tâche sont détenus par l’utilisateur de la tâche.</span><span class="sxs-lookup"><span data-stu-id="c376c-515">All files and directories of a task are owned by the task user.</span></span>

<span data-ttu-id="c376c-516">Le service Batch expose une partie du système de fichiers sur un nœud en tant que *répertoire racine*.</span><span class="sxs-lookup"><span data-stu-id="c376c-516">The Batch service exposes a portion of the file system on a node as the *root directory*.</span></span> <span data-ttu-id="c376c-517">Les tâches peuvent accéder au répertoire racine en référençant la variable d’environnement `AZ_BATCH_NODE_ROOT_DIR` .</span><span class="sxs-lookup"><span data-stu-id="c376c-517">Tasks can access the root directory by referencing the `AZ_BATCH_NODE_ROOT_DIR` environment variable.</span></span> <span data-ttu-id="c376c-518">Pour plus d’informations sur l’utilisation de variables d’environnement, consultez la section [Paramètres d’environnement des tâches](#environment-settings-for-tasks).</span><span class="sxs-lookup"><span data-stu-id="c376c-518">For more information about using environment variables, see [Environment settings for tasks](#environment-settings-for-tasks).</span></span>

<span data-ttu-id="c376c-519">Le répertoire racine contient la structure de répertoires suivante :</span><span class="sxs-lookup"><span data-stu-id="c376c-519">The root directory contains the following directory structure:</span></span>

![Structure de répertoire du nœud de calcul][1]

* <span data-ttu-id="c376c-521">**Partagé**: ce répertoire fournit un accès en lecture/écriture à *toutes* les tâches qui s’exécutent sur un nœud.</span><span class="sxs-lookup"><span data-stu-id="c376c-521">**shared**: This directory provides read/write access to *all* tasks that run on a node.</span></span> <span data-ttu-id="c376c-522">Les tâches qui s’exécutent sur le nœud peuvent créer, lire, mettre à jour et supprimer des fichiers dans ce répertoire.</span><span class="sxs-lookup"><span data-stu-id="c376c-522">Any task that runs on the node can create, read, update, and delete files in this directory.</span></span> <span data-ttu-id="c376c-523">Les tâches peuvent accéder à ce répertoire en référençant la variable d’environnement `AZ_BATCH_NODE_SHARED_DIR` .</span><span class="sxs-lookup"><span data-stu-id="c376c-523">Tasks can access this directory by referencing the `AZ_BATCH_NODE_SHARED_DIR` environment variable.</span></span>
* <span data-ttu-id="c376c-524">**Démarrage**: ce répertoire est utilisé par une tâche de démarrage en tant que répertoire de travail.</span><span class="sxs-lookup"><span data-stu-id="c376c-524">**startup**: This directory is used by a start task as its working directory.</span></span> <span data-ttu-id="c376c-525">Tous les fichiers téléchargés vers le nœud par la tâche de démarrage sont stockés ici.</span><span class="sxs-lookup"><span data-stu-id="c376c-525">All of the files that are downloaded to the node by the start task are stored here.</span></span> <span data-ttu-id="c376c-526">La tâche de démarrage peut créer, lire, mettre à jour et supprimer des fichiers dans ce répertoire.</span><span class="sxs-lookup"><span data-stu-id="c376c-526">The start task can create, read, update, and delete files under this directory.</span></span> <span data-ttu-id="c376c-527">Les tâches peuvent accéder à ce répertoire en référençant la variable d’environnement `AZ_BATCH_NODE_STARTUP_DIR` .</span><span class="sxs-lookup"><span data-stu-id="c376c-527">Tasks can access this directory by referencing the `AZ_BATCH_NODE_STARTUP_DIR` environment variable.</span></span>
* <span data-ttu-id="c376c-528">**Tâches**: un répertoire est créé pour chaque tâche qui s’exécute sur le nœud.</span><span class="sxs-lookup"><span data-stu-id="c376c-528">**Tasks**: A directory is created for each task that runs on the node.</span></span> <span data-ttu-id="c376c-529">Il est accessible en référençant la variable d’environnement `AZ_BATCH_TASK_DIR` .</span><span class="sxs-lookup"><span data-stu-id="c376c-529">It is accessed by referencing the `AZ_BATCH_TASK_DIR` environment variable.</span></span>

    <span data-ttu-id="c376c-530">Dans chaque répertoire de la tâche, le service Batch crée un répertoire de travail (`wd`) dont le chemin unique est spécifié par la variable d’environnement `AZ_BATCH_TASK_WORKING_DIR`.</span><span class="sxs-lookup"><span data-stu-id="c376c-530">Within each task directory, the Batch service creates a working directory (`wd`) whose unique path is specified by the `AZ_BATCH_TASK_WORKING_DIR` environment variable.</span></span> <span data-ttu-id="c376c-531">Ce répertoire fournit un accès en lecture/écriture à la tâche.</span><span class="sxs-lookup"><span data-stu-id="c376c-531">This directory provides read/write access to the task.</span></span> <span data-ttu-id="c376c-532">La tâche peut créer, lire, mettre à jour et supprimer des fichiers dans ce répertoire.</span><span class="sxs-lookup"><span data-stu-id="c376c-532">The task can create, read, update, and delete files under this directory.</span></span> <span data-ttu-id="c376c-533">Ce répertoire est conservé en fonction de la contrainte *RetentionTime* spécifiée pour la tâche.</span><span class="sxs-lookup"><span data-stu-id="c376c-533">This directory is retained based on the *RetentionTime* constraint that is specified for the task.</span></span>

    <span data-ttu-id="c376c-534">`stdout.txt` et `stderr.txt` : ces fichiers sont écrits dans le dossier des tâches lors de l’exécution de la tâche.</span><span class="sxs-lookup"><span data-stu-id="c376c-534">`stdout.txt` and `stderr.txt`: These files are written to the task folder during the execution of the task.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="c376c-535">Lorsqu’un nœud est supprimé du pool, *tous* les fichiers stockés sur ce nœud sont supprimés.</span><span class="sxs-lookup"><span data-stu-id="c376c-535">When a node is removed from the pool, *all* of the files that are stored on the node are removed.</span></span>
>
>

## <a name="application-packages"></a><span data-ttu-id="c376c-536">packages d’application</span><span class="sxs-lookup"><span data-stu-id="c376c-536">Application packages</span></span>
<span data-ttu-id="c376c-537">La fonctionnalité [packages d’application](batch-application-packages.md) facilite la gestion et le déploiement d’applications sur les nœuds de calcul dans vos pools.</span><span class="sxs-lookup"><span data-stu-id="c376c-537">The [application packages](batch-application-packages.md) feature provides easy management and deployment of applications to the compute nodes in your pools.</span></span> <span data-ttu-id="c376c-538">Vous pouvez facilement charger et gérer plusieurs versions des applications exécutées par vos tâches, notamment leurs fichiers binaires et leurs fichiers de prise en charge.</span><span class="sxs-lookup"><span data-stu-id="c376c-538">You can upload and manage multiple versions of the applications run by your tasks, including their binaries and support files.</span></span> <span data-ttu-id="c376c-539">Vous pouvez ensuite déployer automatiquement une ou plusieurs de ces applications sur les nœuds de calcul dans le pool.</span><span class="sxs-lookup"><span data-stu-id="c376c-539">Then you can automatically deploy one or more of these applications to the compute nodes in your pool.</span></span>

<span data-ttu-id="c376c-540">Vous pouvez spécifier les packages d’applications au niveau du pool et des tâches.</span><span class="sxs-lookup"><span data-stu-id="c376c-540">You can specify application packages at the pool and task level.</span></span> <span data-ttu-id="c376c-541">Lorsque vous spécifiez des packages d’applications au niveau du pool, l’application est déployée sur tous les nœuds du pool.</span><span class="sxs-lookup"><span data-stu-id="c376c-541">When you specify pool application packages, the application is deployed to every node in the pool.</span></span> <span data-ttu-id="c376c-542">Lorsque vous spécifiez des packages d’applications au niveau des tâches, l’application est déployée uniquement sur les nœuds programmés pour exécuter au moins une des tâches du travail, juste avant l’exécution de la ligne de commande de la tâche.</span><span class="sxs-lookup"><span data-stu-id="c376c-542">When you specify task application packages, the application is deployed only to nodes that are scheduled to run at least one of the job's tasks, just before the task's command line is run.</span></span>

<span data-ttu-id="c376c-543">Batch gère les détails de l’utilisation d’Azure Storage en arrière-plan pour stocker vos packages d’applications et les déployer sur les nœuds de calcul, de manière à permettre de simplifier votre code et vos frais de gestion.</span><span class="sxs-lookup"><span data-stu-id="c376c-543">Batch handles the details of working with Azure Storage to store your application packages and deploy them to compute nodes, so both your code and management overhead can be simplified.</span></span>

<span data-ttu-id="c376c-544">Pour en savoir plus sur la fonctionnalité packages d’applications, consultez [Déployer des applications sur les nœuds avec des packages d’applications Batch](batch-application-packages.md).</span><span class="sxs-lookup"><span data-stu-id="c376c-544">To find out more about the application package feature, check out [Deploy applications to compute nodes with Batch application packages](batch-application-packages.md).</span></span>

> [!NOTE]
> <span data-ttu-id="c376c-545">Si vous ajoutez des packages de d’applications au niveau du pool à un pool *existant* , vous devez redémarrer ses nœuds de calcul afin que les packages d’applications soient déployés sur les nœuds.</span><span class="sxs-lookup"><span data-stu-id="c376c-545">If you add pool application packages to an *existing* pool, you must reboot its compute nodes for the application packages to be deployed to the nodes.</span></span>
>
>

## <a name="pool-and-compute-node-lifetime"></a><span data-ttu-id="c376c-546">Durée de vie de nœud de pool et de calcul</span><span class="sxs-lookup"><span data-stu-id="c376c-546">Pool and compute node lifetime</span></span>
<span data-ttu-id="c376c-547">Lorsque vous créez votre solution Azure Batch, vous devez prendre une décision de conception relative à la procédure et au moment de la création des pools, et à la durée pendant laquelle les nœuds de calcul de ces pools restent disponibles.</span><span class="sxs-lookup"><span data-stu-id="c376c-547">When you design your Azure Batch solution, you have to make a design decision about how and when pools are created, and how long compute nodes within those pools are kept available.</span></span>

<span data-ttu-id="c376c-548">D’un côté, vous pouvez créer un pool pour chaque travail que vous soumettez et supprimer le pool dès la fin de l’exécution des tâches associées.</span><span class="sxs-lookup"><span data-stu-id="c376c-548">On one end of the spectrum, you can create a pool for each job that you submit, and delete the pool as soon as its tasks finish execution.</span></span> <span data-ttu-id="c376c-549">Cela permet d’optimiser l’utilisation, car les nœuds sont seulement alloués lorsqu’ils sont requis et sont arrêtés dès qu’ils sont inactifs.</span><span class="sxs-lookup"><span data-stu-id="c376c-549">This maximizes utilization because the nodes are only allocated when needed, and shut down as soon as they're idle.</span></span> <span data-ttu-id="c376c-550">Cela signifie que le travail doit attendre que les nœuds soient alloués, mais il est important de noter que l’exécution des tâches est planifiée dès que les nœuds sont individuellement disponibles, alloués, et que la tâche de démarrage est terminée.</span><span class="sxs-lookup"><span data-stu-id="c376c-550">While this means that the job must wait for the nodes to be allocated, it's important to note that tasks are scheduled for execution as soon as nodes are individually available, allocated, and the start task has completed.</span></span> <span data-ttu-id="c376c-551">Batch n’attend *pas* que tous les nœuds d’un pool soient disponibles avant d’affecter des tâches aux nœuds.</span><span class="sxs-lookup"><span data-stu-id="c376c-551">Batch does *not* wait until all nodes within a pool are available before assigning tasks to the nodes.</span></span> <span data-ttu-id="c376c-552">Cela garantit l’utilisation maximale de tous les nœuds disponibles.</span><span class="sxs-lookup"><span data-stu-id="c376c-552">This ensures maximum utilization of all available nodes.</span></span>

<span data-ttu-id="c376c-553">À l’opposé, si la priorité absolue consiste à démarrer immédiatement des travaux, vous pouvez créer un pool avant l’heure et mettre ses nœuds à disposition avant la soumission des travaux.</span><span class="sxs-lookup"><span data-stu-id="c376c-553">At the other end of the spectrum, if having jobs start immediately is the highest priority, you can create a pool ahead of time and make its nodes available before jobs are submitted.</span></span> <span data-ttu-id="c376c-554">Dans ce scénario, les tâches peuvent démarrer immédiatement, mais il se peut que les nœuds restent inactifs en attendant que les tâches soient affectées.</span><span class="sxs-lookup"><span data-stu-id="c376c-554">In this scenario, tasks can start immediately, but nodes might sit idle while waiting for them to be assigned.</span></span>

<span data-ttu-id="c376c-555">Une approche combinée est généralement utilisée pour la gestion d’une charge variable, mais continue.</span><span class="sxs-lookup"><span data-stu-id="c376c-555">A combined approach is typically used for handling a variable, but ongoing, load.</span></span> <span data-ttu-id="c376c-556">Vous pouvez disposer d’un pool auquel plusieurs travaux sont soumis, mais vous pouvez augmenter ou réduire le nombre de nœuds en fonction de la charge de travail (consultez [Mise à l’échelle des ressources de calcul](#scaling-compute-resources) dans la section suivante).</span><span class="sxs-lookup"><span data-stu-id="c376c-556">You can have a pool that multiple jobs are submitted to, but can scale the number of nodes up or down according to the job load (see [Scaling compute resources](#scaling-compute-resources) in the following section).</span></span> <span data-ttu-id="c376c-557">Vous pouvez procéder en réaction, en fonction de la charge actuelle, ou en amont, si la charge peut être prédite.</span><span class="sxs-lookup"><span data-stu-id="c376c-557">You can do this reactively, based on current load, or proactively, if load can be predicted.</span></span>

## <a name="virtual-network-vnet-and-firewall-configuration"></a><span data-ttu-id="c376c-558">Configuration du pare-feu et du réseau virtuel (VNet)</span><span class="sxs-lookup"><span data-stu-id="c376c-558">Virtual network (VNet) and firewall configuration</span></span> 

<span data-ttu-id="c376c-559">Lorsque vous configurez un pool de nœuds de calcul dans Azure Batch, vous pouvez associer le pool au sous-réseau d’un [réseau virtuel (VNet)](../virtual-network/virtual-networks-overview.md) Azure.</span><span class="sxs-lookup"><span data-stu-id="c376c-559">When you provision a pool of compute nodes in Azure Batch, you can associate the pool with a subnet of an Azure [virtual network (VNet)](../virtual-network/virtual-networks-overview.md).</span></span> <span data-ttu-id="c376c-560">Pour en savoir plus sur la création d’un réseau virtuel avec des sous-réseaux, consultez la section [Créer un réseau virtuel Azure comprenant plusieurs sous-réseaux](../virtual-network/virtual-networks-create-vnet-arm-pportal.md).</span><span class="sxs-lookup"><span data-stu-id="c376c-560">To learn more about creating a VNet with subnets, see [Create an Azure virtual network with subnets](../virtual-network/virtual-networks-create-vnet-arm-pportal.md).</span></span> 

 * <span data-ttu-id="c376c-561">Le réseau virtuel associé à un pool doit être :</span><span class="sxs-lookup"><span data-stu-id="c376c-561">The VNet associated with a pool must be:</span></span>

   * <span data-ttu-id="c376c-562">Dans la même **région** Azure que le compte Azure Batch.</span><span class="sxs-lookup"><span data-stu-id="c376c-562">In the same Azure **region** as the Azure Batch account.</span></span>
   * <span data-ttu-id="c376c-563">Dans le même **abonnement** que le compte Azure Batch.</span><span class="sxs-lookup"><span data-stu-id="c376c-563">In the same **subscription** as the Azure Batch account.</span></span>

* <span data-ttu-id="c376c-564">Le type de réseau virtuel pris en charge dépend de la façon dont les pools sont alloués pour le compte Batch :</span><span class="sxs-lookup"><span data-stu-id="c376c-564">The type of VNet supported depends on how pools are being allocated for the Batch account:</span></span>

    - <span data-ttu-id="c376c-565">Si le mode d’allocation de pool de votre compte Batch est défini sur le mode Service Batch, vous pouvez alors assigner un réseau virtuel uniquement aux pools créés avec la **Configuration Cloud Services**.</span><span class="sxs-lookup"><span data-stu-id="c376c-565">If the pool allocation mode for your Batch account is set to Batch Service, then you can assign a VNet only to pools created with the **Cloud Services Configuration**.</span></span> <span data-ttu-id="c376c-566">En outre, le réseau virtuel spécifié doit être créé suivant le modèle de déploiement classique.</span><span class="sxs-lookup"><span data-stu-id="c376c-566">Additionally, the specified VNet must be created with the classic deployment model.</span></span> <span data-ttu-id="c376c-567">Les réseaux virtuels créés avec le modèle de déploiement Azure Resource Manager ne sont pas pris en charge.</span><span class="sxs-lookup"><span data-stu-id="c376c-567">VNets created with the Azure Resource Manager deployment model are not supported.</span></span>
 
    - <span data-ttu-id="c376c-568">Si le mode d’allocation de pool de votre compte Batch est défini sur le mode Abonnement utilisateur, vous pouvez alors assigner un réseau virtuel uniquement aux pools créés avec la **Configuration de machines virtuelles**.</span><span class="sxs-lookup"><span data-stu-id="c376c-568">If the pool allocation mode for your Batch account is set to User Subscription, then you can assign a VNet only to pools created with the **Virtual Machine Configuration**.</span></span> <span data-ttu-id="c376c-569">Les pools créés avec la **Configuration du service cloud** ne sont pas pris en charge.</span><span class="sxs-lookup"><span data-stu-id="c376c-569">Pools created with the **Cloud Service Configuration** are not supported.</span></span> <span data-ttu-id="c376c-570">Un réseau virtuel associé peut être créé suivant le modèle de déploiement Azure Resource Manager ou le modèle de déploiement classique.</span><span class="sxs-lookup"><span data-stu-id="c376c-570">The associated VNet may be created with either the Azure Resource Manager deployment model or the classic deployment model.</span></span>

    <span data-ttu-id="c376c-571">Pour obtenir un tableau résumant la prise en charge d’un réseau virtuel suivant le mode d’allocation de pool, consultez la section [Mode d’allocation de pool](#pool-allocation-mode).</span><span class="sxs-lookup"><span data-stu-id="c376c-571">For a table summarizing VNet support according to pool allocation mode, see the [Pool allocation mode](#pool-allocation-mode) section.</span></span>

* <span data-ttu-id="c376c-572">Si le mode d’allocation de pool de votre compte Batch est défini sur le mode Service Batch, vous devez alors fournir les autorisations permettant au principal du service Batch d’accéder au réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="c376c-572">If the pool allocation mode for your Batch account is set to Batch Service, then you must provide permissions for the Batch service principal to access the VNet.</span></span> <span data-ttu-id="c376c-573">Le réseau virtuel doit assigner au principal du service Batch le rôle de [contrôle d’accès en fonction du rôle (RBAC) Collaborateur de machine virtuelle classique](https://azure.microsoft.com/documentation/articles/role-based-access-built-in-roles/#classic-virtual-machine-contributor).</span><span class="sxs-lookup"><span data-stu-id="c376c-573">The VNet must assign the [Classic Virtual Machine Contributor Role-Based Access Control (RBAC)](https://azure.microsoft.com/documentation/articles/role-based-access-built-in-roles/#classic-virtual-machine-contributor) role to the Batch service principal.</span></span> <span data-ttu-id="c376c-574">Si le rôle RBAC spécifié n’est pas fourni, le service Batch renvoie une erreur 400 (Demande incorrecte).</span><span class="sxs-lookup"><span data-stu-id="c376c-574">If the specified RBAC role is not provided, the Batch service returns 400 (Bad Request).</span></span> <span data-ttu-id="c376c-575">Pour ajouter le rôle à partir du portail Azure :</span><span class="sxs-lookup"><span data-stu-id="c376c-575">To add the role in the Azure portal:</span></span>

    1. <span data-ttu-id="c376c-576">Sélectionnez le **réseau virtuel**, puis **Contrôle d’accès (IAM)** > **Rôles** > **Collaborateur de machine virtuelle classique** > **Ajouter**.</span><span class="sxs-lookup"><span data-stu-id="c376c-576">Select the **VNet**, then **Access control (IAM)** > **Roles** > **Virtual Machine Contributor** > **Add**.</span></span>
    2. <span data-ttu-id="c376c-577">Sur le panneau **Ajouter des autorisations**, sélectionnez le rôle **Collaborateur de machine virtuelle**.</span><span class="sxs-lookup"><span data-stu-id="c376c-577">On the **Add permissions** blade, select the **Virtual Machine Contributor** role.</span></span>
    3. <span data-ttu-id="c376c-578">Dans le panneau **Ajouter des autorisations**, recherchez l’API Batch.</span><span class="sxs-lookup"><span data-stu-id="c376c-578">On the **Add permissions** blade, search for the Batch API.</span></span> <span data-ttu-id="c376c-579">Recherchez chacune de ces chaînes, jusqu’à ce que vous trouviez l’API :</span><span class="sxs-lookup"><span data-stu-id="c376c-579">Search for each of these strings in turn until you find the API:</span></span>
        1. <span data-ttu-id="c376c-580">**MicrosoftAzureBatch**.</span><span class="sxs-lookup"><span data-stu-id="c376c-580">**MicrosoftAzureBatch**.</span></span>
        2. <span data-ttu-id="c376c-581">**Microsoft Azure Batch**.</span><span class="sxs-lookup"><span data-stu-id="c376c-581">**Microsoft Azure Batch**.</span></span> <span data-ttu-id="c376c-582">Les locataires Azure AD les plus récents peuvent utiliser ce nom.</span><span class="sxs-lookup"><span data-stu-id="c376c-582">Newer Azure AD tenants may use this name.</span></span>
        3. <span data-ttu-id="c376c-583">La chaîne **ddbf3205-c6bd-46ae-8127-60eb93363864** correspond à l’ID de l’API Batch.</span><span class="sxs-lookup"><span data-stu-id="c376c-583">**ddbf3205-c6bd-46ae-8127-60eb93363864** is the ID for the Batch API.</span></span> 
    3. <span data-ttu-id="c376c-584">Sélectionnez le principal du service d’API Batch.</span><span class="sxs-lookup"><span data-stu-id="c376c-584">Select the Batch API service principal.</span></span> 
    4. <span data-ttu-id="c376c-585">Cliquez sur **Enregistrer**.</span><span class="sxs-lookup"><span data-stu-id="c376c-585">Click **Save**.</span></span>

        ![Assignez le rôle de collaborateur de machine virtuelle au principal du service Batch](./media/batch-api-basics/iam-add-role.png)


* <span data-ttu-id="c376c-587">Le sous-réseau spécifié doit avoir suffisamment **d’adresses IP** disponibles pour prendre en compte le nombre total de nœuds cibles ; autrement dit, la somme des propriétés `targetDedicatedNodes` et `targetLowPriorityNodes` du pool.</span><span class="sxs-lookup"><span data-stu-id="c376c-587">The specified subnet should have enough free **IP addresses** to accommodate the total number of target nodes; that is, the sum of the `targetDedicatedNodes` and `targetLowPriorityNodes` properties of the pool.</span></span> <span data-ttu-id="c376c-588">Si le sous-réseau n’a pas suffisamment d’adresses IP disponibles, le service Batch alloue partiellement les nœuds de calcul dans le pool et renvoie une erreur de redimensionnement.</span><span class="sxs-lookup"><span data-stu-id="c376c-588">If the subnet doesn't have enough free IP addresses, the Batch service partially allocates the compute nodes in the pool and returns a resize error.</span></span>

* <span data-ttu-id="c376c-589">Le sous-réseau spécifié doit autoriser les communications à partir du service Batch pour pouvoir planifier des tâches sur les nœuds de calcul.</span><span class="sxs-lookup"><span data-stu-id="c376c-589">The specified subnet must allow communication from the Batch service to be able to schedule tasks on the compute nodes.</span></span> <span data-ttu-id="c376c-590">Si la communication vers les nœuds de calcul est refusée par un **groupe de sécurité réseau (NSG)** associé au réseau virtuel, le service Batch définit l’état des nœuds de calcul comme **inutilisable**.</span><span class="sxs-lookup"><span data-stu-id="c376c-590">If communication to the compute nodes is denied by a **Network Security Group (NSG)** associated with the VNet, then the Batch service sets the state of the compute nodes to **unusable**.</span></span>

* <span data-ttu-id="c376c-591">Si le réseau virtuel spécifié possède des **groupes de sécurité réseau** associés et/ou un **pare-feu**, quelques ports système réservés doivent être activés pour les communications entrantes :</span><span class="sxs-lookup"><span data-stu-id="c376c-591">If the specified VNet has associated **Network Security Groups (NSGs)** and/or a **firewall**, then a few reserved system ports must be enabled for inbound communication:</span></span>

- <span data-ttu-id="c376c-592">Pour les pools créés avec une configuration de machine virtuelle, activez les ports 29876 et 29877, ainsi que le port 22 pour Linux et le port 3389 pour Windows.</span><span class="sxs-lookup"><span data-stu-id="c376c-592">For pools created with a virtual machine configuration, enable ports 29876 and 29877, as well as port 22 for Linux and port 3389 for Windows.</span></span> 
- <span data-ttu-id="c376c-593">Pour les pools créés avec une configuration de service cloud, activez les ports 10100, 20100 et 30100.</span><span class="sxs-lookup"><span data-stu-id="c376c-593">For pools created with a cloud service configuration, enable ports 10100, 20100, and 30100.</span></span> 
- <span data-ttu-id="c376c-594">Activez les connexions sortantes vers Stockage Azure sur le port 443.</span><span class="sxs-lookup"><span data-stu-id="c376c-594">Enable outbound connections to Azure Storage on port 443.</span></span> <span data-ttu-id="c376c-595">Aussi, assurez-vous que votre point de terminaison de Stockage Azure peut être résolu par tous les serveurs DNS personnalisés qui traitent votre réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="c376c-595">Also, ensure that your Azure Storage endpoint can be resolved by any custom DNS servers that serve your VNET.</span></span> <span data-ttu-id="c376c-596">Plus précisément, une URL sous la forme `<account>.table.core.windows.net` doit pouvoir être résolue.</span><span class="sxs-lookup"><span data-stu-id="c376c-596">Specifically, a URL of the form `<account>.table.core.windows.net` should be resolvable.</span></span>

    <span data-ttu-id="c376c-597">La table suivante décrit les ports entrants que vous devez activer pour les pools créés avec la configuration de machines virtuelles :</span><span class="sxs-lookup"><span data-stu-id="c376c-597">The following table describes the inbound ports that you need to enable for pools that you created with the virtual machine configuration:</span></span>

    |    <span data-ttu-id="c376c-598">Port(s) de destination</span><span class="sxs-lookup"><span data-stu-id="c376c-598">Destination Port(s)</span></span>    |    <span data-ttu-id="c376c-599">Adresse IP source</span><span class="sxs-lookup"><span data-stu-id="c376c-599">Source IP address</span></span>      |    <span data-ttu-id="c376c-600">Azure Batch ajoute-t-il des NSG ?</span><span class="sxs-lookup"><span data-stu-id="c376c-600">Does Batch add NSGs?</span></span>    |    <span data-ttu-id="c376c-601">Élément requis pour permettre l’utilisation des machines virtuelles ?</span><span class="sxs-lookup"><span data-stu-id="c376c-601">Required for VM to be usable?</span></span>    |    <span data-ttu-id="c376c-602">Action que l’utilisateur doit effectuer</span><span class="sxs-lookup"><span data-stu-id="c376c-602">Action from user</span></span>   |
    |---------------------------|---------------------------|----------------------------|-------------------------------------|-----------------------|
    |    <ul><li><span data-ttu-id="c376c-603">Pour les pools créés avec la configuration de machines virtuelles : 29876, 29877</span><span class="sxs-lookup"><span data-stu-id="c376c-603">For pools created with the virtual machine configuration: 29876, 29877</span></span></li><li><span data-ttu-id="c376c-604">Pour les pools créés avec une configuration de service cloud : 10100, 20100, 30100</span><span class="sxs-lookup"><span data-stu-id="c376c-604">For pools created with the cloud service configuration: 10100, 20100, 30100</span></span></li></ul>         |    <span data-ttu-id="c376c-605">Adresses IP du rôle de service Batch uniquement</span><span class="sxs-lookup"><span data-stu-id="c376c-605">Only Batch service role IP addresses</span></span> |    <span data-ttu-id="c376c-606">Oui.</span><span class="sxs-lookup"><span data-stu-id="c376c-606">Yes.</span></span> <span data-ttu-id="c376c-607">Azure Batch ajoute des NSG au niveau des cartes réseau jointes aux machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="c376c-607">Batch adds NSGs at the level of network interfaces (NIC) attached to VMs.</span></span> <span data-ttu-id="c376c-608">Ces NSG autorisent le trafic uniquement à partir d’adresses IP du rôle de service Batch.</span><span class="sxs-lookup"><span data-stu-id="c376c-608">These NSGs allow traffic only from Batch service role IP addresses.</span></span> <span data-ttu-id="c376c-609">Même si vous ouvrez ces ports au web tout entier, le trafic sera bloqué au niveau de la carte réseau.</span><span class="sxs-lookup"><span data-stu-id="c376c-609">Even if you open these ports for the  entire web, the traffic will get blocked at the NIC.</span></span> |    <span data-ttu-id="c376c-610">Oui</span><span class="sxs-lookup"><span data-stu-id="c376c-610">Yes</span></span>  |  <span data-ttu-id="c376c-611">Vous n’avez pas besoin de spécifier un NSG, car Azure Batch autorise uniquement les adresses IP Batch.</span><span class="sxs-lookup"><span data-stu-id="c376c-611">You do not need to specify an NSG, because Batch allows only Batch IP addresses.</span></span> <br /><br /> <span data-ttu-id="c376c-612">Toutefois, si vous ne spécifiez pas de NSG, assurez-vous que ces ports sont ouverts pour le trafic entrant.</span><span class="sxs-lookup"><span data-stu-id="c376c-612">However, if you do specify an NSG, please ensure that these ports are open for inbound traffic.</span></span> <br /><br /> <span data-ttu-id="c376c-613">Si vous spécifiez le caractère * en tant qu’adresse IP source de votre NSG, Batch ajoute des NSG au niveau des cartes réseau attachées aux machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="c376c-613">If you specify * as the source IP in your NSG, Batch still adds NSGs at the level of NIC attached to VMs.</span></span> |
    |    <span data-ttu-id="c376c-614">3389, 22</span><span class="sxs-lookup"><span data-stu-id="c376c-614">3389, 22</span></span>               |    <span data-ttu-id="c376c-615">Ordinateurs de l’utilisateur, utilisés à des fins de débogage, afin que vous puissiez accéder à distance aux machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="c376c-615">User machines, used for debugging purposes, so that you can remotely access the VM.</span></span>    |    <span data-ttu-id="c376c-616">Non</span><span class="sxs-lookup"><span data-stu-id="c376c-616">No</span></span>                                    |    <span data-ttu-id="c376c-617">Non</span><span class="sxs-lookup"><span data-stu-id="c376c-617">No</span></span>                     |    <span data-ttu-id="c376c-618">Ajoutez des NSG si vous souhaitez autoriser les utilisateurs à accéder à distance aux machines virtuelles (via RDP/SSH).</span><span class="sxs-lookup"><span data-stu-id="c376c-618">Add NSGs if you want to permit remote access (RDP/SSH) to the VM.</span></span>   |                 

    <span data-ttu-id="c376c-619">Le tableau suivant décrit le port de sortie que vous devez activer pour autoriser l’accès au stockage Azure :</span><span class="sxs-lookup"><span data-stu-id="c376c-619">The following table describes the outbound port that you need to enable to permit access to Azure Storage:</span></span>

    |    <span data-ttu-id="c376c-620">Port(s) sortant(s)</span><span class="sxs-lookup"><span data-stu-id="c376c-620">Outbound Port(s)</span></span>    |    <span data-ttu-id="c376c-621">Destination</span><span class="sxs-lookup"><span data-stu-id="c376c-621">Destination</span></span>    |    <span data-ttu-id="c376c-622">Azure Batch ajoute-t-il des NSG ?</span><span class="sxs-lookup"><span data-stu-id="c376c-622">Does Batch add NSGs?</span></span>    |    <span data-ttu-id="c376c-623">Élément requis pour permettre l’utilisation des machines virtuelles ?</span><span class="sxs-lookup"><span data-stu-id="c376c-623">Required for VM to be usable?</span></span>    |    <span data-ttu-id="c376c-624">Action que l’utilisateur doit effectuer</span><span class="sxs-lookup"><span data-stu-id="c376c-624">Action from user</span></span>    |
    |------------------------|-------------------|----------------------------|-------------------------------------|------------------------|
    |    <span data-ttu-id="c376c-625">443</span><span class="sxs-lookup"><span data-stu-id="c376c-625">443</span></span>    |    <span data-ttu-id="c376c-626">Azure Storage</span><span class="sxs-lookup"><span data-stu-id="c376c-626">Azure Storage</span></span>    |    <span data-ttu-id="c376c-627">Non</span><span class="sxs-lookup"><span data-stu-id="c376c-627">No</span></span>    |    <span data-ttu-id="c376c-628">Oui</span><span class="sxs-lookup"><span data-stu-id="c376c-628">Yes</span></span>    |    <span data-ttu-id="c376c-629">Si vous ajoutez des NSG, vérifiez que ce port est ouvert pour le trafic sortant.</span><span class="sxs-lookup"><span data-stu-id="c376c-629">If you add any NSGs, then ensure that this port is open to outbound   traffic.</span></span>    |


## <a name="scaling-compute-resources"></a><span data-ttu-id="c376c-630">Mise à l’échelle des ressources de calcul</span><span class="sxs-lookup"><span data-stu-id="c376c-630">Scaling compute resources</span></span>
<span data-ttu-id="c376c-631">Avec la [mise à l’échelle automatique](batch-automatic-scaling.md), le service Batch peut ajuster de manière dynamique le nombre de nœuds de calcul d’un pool en fonction de la charge de travail actuelle et de l’utilisation des ressources de votre scénario de calcul.</span><span class="sxs-lookup"><span data-stu-id="c376c-631">With [automatic scaling](batch-automatic-scaling.md), you can have the Batch service dynamically adjust the number of compute nodes in a pool according to the current workload and resource usage of your compute scenario.</span></span> <span data-ttu-id="c376c-632">Cela vous permet de réduire le coût global d’exécution de votre application en utilisant uniquement les ressources dont vous avez besoin et en libérant les autres.</span><span class="sxs-lookup"><span data-stu-id="c376c-632">This allows you to lower the overall cost of running your application by using only the resources you need, and releasing those you don't need.</span></span>

<span data-ttu-id="c376c-633">Pour activer la mise à l’échelle automatique, écrivez une [formule de mise à l’échelle automatique](batch-automatic-scaling.md#automatic-scaling-formulas) et associez-la à un pool.</span><span class="sxs-lookup"><span data-stu-id="c376c-633">You enable automatic scaling by writing an [automatic scaling formula](batch-automatic-scaling.md#automatic-scaling-formulas) and associating that formula with a pool.</span></span> <span data-ttu-id="c376c-634">Le service Batch utilise la formule pour déterminer le nombre cible de nœuds dans le pool pour le prochain intervalle de mise à l’échelle (intervalle que vous pouvez configurer).</span><span class="sxs-lookup"><span data-stu-id="c376c-634">The Batch service uses the formula to determine the target number of nodes in the pool for the next scaling interval (an interval that you can configure).</span></span> <span data-ttu-id="c376c-635">Vous pouvez spécifier les paramètres de mise à l’échelle automatique pour un pool lorsque vous le créez ou activez la mise à l’échelle sur un pool ultérieurement.</span><span class="sxs-lookup"><span data-stu-id="c376c-635">You can specify the automatic scaling settings for a pool when you create it, or enable scaling on a pool later.</span></span> <span data-ttu-id="c376c-636">Vous pouvez également mettre à jour les paramètres de mise à l’échelle sur un pool compatible avec la mise à l’échelle.</span><span class="sxs-lookup"><span data-stu-id="c376c-636">You can also update the scaling settings on a scaling-enabled pool.</span></span>

<span data-ttu-id="c376c-637">Par exemple, il se peut qu’un travail exige que vous envoyiez un grand nombre de tâches devant être exécutées.</span><span class="sxs-lookup"><span data-stu-id="c376c-637">As an example, perhaps a job requires that you submit a very large number of tasks to be executed.</span></span> <span data-ttu-id="c376c-638">Vous pouvez attribuer au pool une formule de mise à l’échelle qui règle le nombre de nœuds du pool en fonction du nombre actuel de tâches en file d’attente et du degré d’achèvement des tâches dans le travail.</span><span class="sxs-lookup"><span data-stu-id="c376c-638">You can assign a scaling formula to the pool that adjusts the number of nodes in the pool based on the current number of queued tasks and the completion rate of the tasks in the job.</span></span> <span data-ttu-id="c376c-639">Le service Batch évalue régulièrement la formule et redimensionne le pool en fonction de la charge de travail et des autres paramètres de votre formule.</span><span class="sxs-lookup"><span data-stu-id="c376c-639">The Batch service periodically evaluates the formula and resizes the pool, based on workload and your other formula settings.</span></span> <span data-ttu-id="c376c-640">Le service ajoute des nœuds selon les besoins lorsqu’il existe un grand nombre de tâches en file d’attente, et supprime des nœuds lorsqu’aucune tâche n’est en file d’attente ni en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="c376c-640">The service adds nodes as needed when there are a large number of queued tasks, and removes nodes when there are no queued or running tasks.</span></span>

<span data-ttu-id="c376c-641">Une formule de mise à l’échelle peut être basée sur les mesures suivantes :</span><span class="sxs-lookup"><span data-stu-id="c376c-641">A scaling formula can be based on the following metrics:</span></span>

* <span data-ttu-id="c376c-642">**mesures temporelles** sont basées sur les statistiques collectées toutes les cinq minutes dans le nombre d’heures spécifié.</span><span class="sxs-lookup"><span data-stu-id="c376c-642">**Time metrics** are based on statistics collected every five minutes in the specified number of hours.</span></span>
* <span data-ttu-id="c376c-643">**mesures de ressources** sont basées sur l’utilisation du processeur, de la bande passante et de la mémoire, et sur le nombre de nœuds.</span><span class="sxs-lookup"><span data-stu-id="c376c-643">**Resource metrics** are based on CPU usage, bandwidth usage, memory usage, and number of nodes.</span></span>
* <span data-ttu-id="c376c-644">Les **mesures de tâches** sont basées sur l’état de la tâche, tel que *Active* (en file d’attente), *En cours d’exécution* ou *Terminée*.</span><span class="sxs-lookup"><span data-stu-id="c376c-644">**Task metrics** are based on task state, such as *Active* (queued), *Running*, or *Completed*.</span></span>

<span data-ttu-id="c376c-645">Lorsque la mise à l’échelle automatique diminue le nombre de nœuds de calcul dans un pool, vous devez réfléchir aux méthodes pour gérer les tâches s’exécutant au moment de cette opération de réduction.</span><span class="sxs-lookup"><span data-stu-id="c376c-645">When automatic scaling decreases the number of compute nodes in a pool, you must consider how to handle tasks that are running at the time of the decrease operation.</span></span> <span data-ttu-id="c376c-646">Pour ce faire, Batch fournit une *option de désallocation de nœud* que vous pouvez inclure dans vos formules.</span><span class="sxs-lookup"><span data-stu-id="c376c-646">To accommodate this, Batch provides a *node deallocation option* that you can include in your formulas.</span></span> <span data-ttu-id="c376c-647">Par exemple, vous pouvez spécifier d’arrêter immédiatement les tâches en cours, de les arrêter immédiatement, puis les remettre en file d’attente pour une exécution sur un autre nœud, ou les autoriser à terminer avant la suppression du nœud du pool.</span><span class="sxs-lookup"><span data-stu-id="c376c-647">For example, you can specify that running tasks are stopped immediately, stopped immediately and then requeued for execution on another node, or allowed to finish before the node is removed from the pool.</span></span>

<span data-ttu-id="c376c-648">Pour plus d’informations sur la mise à l’échelle automatique d’une application, consultez la section [Mettre automatiquement à l’échelle les nœuds de calcul dans un pool Azure Batch](batch-automatic-scaling.md).</span><span class="sxs-lookup"><span data-stu-id="c376c-648">For more information about automatically scaling an application, see [Automatically scale compute nodes in an Azure Batch pool](batch-automatic-scaling.md).</span></span>

> [!TIP]
> <span data-ttu-id="c376c-649">Pour optimiser l’utilisation des ressources de calcul, définissez à zéro le nombre cible de nœuds à la fin d’un travail tout en autorisant les tâches en cours à s’achever.</span><span class="sxs-lookup"><span data-stu-id="c376c-649">To maximize compute resource utilization, set the target number of nodes to zero at the end of a job, but allow running tasks to finish.</span></span>
>
>

## <a name="security-with-certificates"></a><span data-ttu-id="c376c-650">Sécurité avec certificats</span><span class="sxs-lookup"><span data-stu-id="c376c-650">Security with certificates</span></span>
<span data-ttu-id="c376c-651">En principe, vous devez utiliser des certificats lorsque vous chiffrez ou déchiffrez des informations sensibles pour les tâches, comme la clé d’un [compte Stockage Azure][azure_storage].</span><span class="sxs-lookup"><span data-stu-id="c376c-651">You typically need to use certificates when you encrypt or decrypt sensitive information for tasks, like the key for an [Azure Storage account][azure_storage].</span></span> <span data-ttu-id="c376c-652">Pour ce faire, vous pouvez installer des certificats sur les nœuds.</span><span class="sxs-lookup"><span data-stu-id="c376c-652">To support this, you can install certificates on nodes.</span></span> <span data-ttu-id="c376c-653">Les secrets chiffrés sont transmis aux tâches dans les paramètres de ligne de commande ou incorporés dans l’une des ressources et les certificats installés peuvent être utilisés pour les déchiffrer.</span><span class="sxs-lookup"><span data-stu-id="c376c-653">Encrypted secrets are passed to tasks via command-line parameters or embedded in one of the task resources, and the installed certificates can be used to decrypt them.</span></span>

<span data-ttu-id="c376c-654">Pour ajouter un certificat à un compte Batch, vous utilisez l’opération [Ajouter le certificat][rest_add_cert] (REST Batch) ou la méthode [CertificateOperations.CreateCertificate][net_create_cert] (.NET Batch).</span><span class="sxs-lookup"><span data-stu-id="c376c-654">You use the [Add certificate][rest_add_cert] operation (Batch REST) or [CertificateOperations.CreateCertificate][net_create_cert] method (Batch .NET) to add a certificate to a Batch account.</span></span> <span data-ttu-id="c376c-655">Vous pouvez ensuite associer le certificat à un pool existant ou nouveau.</span><span class="sxs-lookup"><span data-stu-id="c376c-655">You can then associate the certificate with a new or existing pool.</span></span> <span data-ttu-id="c376c-656">Lorsqu’un certificat est associé à un pool, le service Batch installe le certificat sur chaque nœud du pool.</span><span class="sxs-lookup"><span data-stu-id="c376c-656">When a certificate is associated with a pool, the Batch service installs the certificate on each node in the pool.</span></span> <span data-ttu-id="c376c-657">Le service Batch installe les certificats appropriés au démarrage du nœud, avant de lancer une tâche quelconque (notamment les tâches de démarrage et celles du gestionnaire de travaux).</span><span class="sxs-lookup"><span data-stu-id="c376c-657">The Batch service installs the appropriate certificates when the node starts up, before launching any tasks (including the start task and job manager task).</span></span>

<span data-ttu-id="c376c-658">Si vous ajoutez des certificats à un pool *existant* , vous devez redémarrer ses nœuds de calcul afin que les certificats soient appliqués aux nœuds.</span><span class="sxs-lookup"><span data-stu-id="c376c-658">If you add certificates to an *existing* pool, you must reboot its compute nodes for the certificates to be applied to the nodes.</span></span>

## <a name="error-handling"></a><span data-ttu-id="c376c-659">Gestion des erreurs</span><span class="sxs-lookup"><span data-stu-id="c376c-659">Error handling</span></span>
<span data-ttu-id="c376c-660">Il peut s’avérer utile de gérer les échecs de tâche et d’application au sein de votre solution Batch.</span><span class="sxs-lookup"><span data-stu-id="c376c-660">You might find it necessary to handle both task and application failures within your Batch solution.</span></span>

### <a name="task-failure-handling"></a><span data-ttu-id="c376c-661">Gestion des échecs de tâche</span><span class="sxs-lookup"><span data-stu-id="c376c-661">Task failure handling</span></span>
<span data-ttu-id="c376c-662">Les échecs de tâche peuvent être classés suivant les catégories suivantes :</span><span class="sxs-lookup"><span data-stu-id="c376c-662">Task failures fall into these categories:</span></span>

* <span data-ttu-id="c376c-663">**Échecs de prétraitement**</span><span class="sxs-lookup"><span data-stu-id="c376c-663">**Pre-processing failures**</span></span>

    <span data-ttu-id="c376c-664">Si une tâche ne parvient pas à démarrer, une erreur de prétraitement est définie pour la tâche.</span><span class="sxs-lookup"><span data-stu-id="c376c-664">If a task fails to start, a pre-processing error is set for the task.</span></span>  

    <span data-ttu-id="c376c-665">Des erreurs de prétraitement peuvent se produire si des fichiers de ressources de la tâche ont été déplacés, si le compte Stockage n’est plus disponible ou si un autre problème ayant empêché la copie des fichiers sur le nœud est survenu.</span><span class="sxs-lookup"><span data-stu-id="c376c-665">Pre-processing errors can occur if the task's resource files have moved, the Storage account is no longer available, or another issue was encountered that prevented the successful copying of files to the node.</span></span>

* <span data-ttu-id="c376c-666">**Échecs de chargement de fichier**</span><span class="sxs-lookup"><span data-stu-id="c376c-666">**File upload failures**</span></span>

    <span data-ttu-id="c376c-667">Si le chargement des fichiers qui sont spécifiés pour une tâche échoue pour une raison quelconque, une erreur de chargement est définie pour la tâche.</span><span class="sxs-lookup"><span data-stu-id="c376c-667">If uploading files that are specified for a task fails for any reason, a file upload error is set for the task.</span></span>

    <span data-ttu-id="c376c-668">Des erreurs de chargement de fichier peuvent se produire si la SAP permettant d’accéder au Stockage Azure n’est pas valide ou n’accorde pas d’autorisations d’écriture, si le compte de stockage n’est plus disponible ou si un autre problème ayant empêché la copie des fichiers sur le nœud est survenu.</span><span class="sxs-lookup"><span data-stu-id="c376c-668">File upload errors can occur if the SAS supplied for accessing Azure Storage is invalid or does not provide write permissions, if the storage account is no longer available, or if another issue was encountered that prevented the successful copying of files from the node.</span></span>    

* <span data-ttu-id="c376c-669">**Échecs d’application**</span><span class="sxs-lookup"><span data-stu-id="c376c-669">**Application failures**</span></span>

    <span data-ttu-id="c376c-670">Le processus spécifié par la ligne de commande de la tâche peut également échouer.</span><span class="sxs-lookup"><span data-stu-id="c376c-670">The process that is specified by the task's command line can also fail.</span></span> <span data-ttu-id="c376c-671">Il est considéré comme ayant échoué lorsqu’un code de sortie différent de zéro est renvoyé par le processus exécuté par la tâche (voir *Codes de sortie de tâche* dans la section ci-après).</span><span class="sxs-lookup"><span data-stu-id="c376c-671">The process is deemed to have failed when a nonzero exit code is returned by the process that is executed by the task (see *Task exit codes* in the next section).</span></span>

    <span data-ttu-id="c376c-672">Pour les échecs d’application, vous pouvez configurer Batch pour relancer automatiquement la tâche autant de fois que vous l’aurez spécifié.</span><span class="sxs-lookup"><span data-stu-id="c376c-672">For application failures, you can configure Batch to automatically retry the task up to a specified number of times.</span></span>

* <span data-ttu-id="c376c-673">**Échecs de contrainte**</span><span class="sxs-lookup"><span data-stu-id="c376c-673">**Constraint failures**</span></span>

    <span data-ttu-id="c376c-674">Vous pouvez définir une contrainte qui spécifie la durée maximale d’exécution d’un travail ou d’une tâche, le *maxWallClockTime*.</span><span class="sxs-lookup"><span data-stu-id="c376c-674">You can set a constraint that specifies the maximum execution duration for a job or task, the *maxWallClockTime*.</span></span> <span data-ttu-id="c376c-675">Cette opération peut se révéler utile pour terminer les tâches dont la progression échoue.</span><span class="sxs-lookup"><span data-stu-id="c376c-675">This can be useful for terminating tasks that fail to progress.</span></span>

    <span data-ttu-id="c376c-676">Lorsque la durée maximale est dépassée, la tâche est marquée comme *terminée*, mais le code de sortie est défini sur `0xC000013A` et le champ *schedulingError* est marqué comme `{ category:"ServerError", code="TaskEnded"}`.</span><span class="sxs-lookup"><span data-stu-id="c376c-676">When the maximum amount of time has been exceeded, the task is marked as *completed*, but the exit code is set to `0xC000013A` and the *schedulingError* field is marked as `{ category:"ServerError", code="TaskEnded"}`.</span></span>

### <a name="debugging-application-failures"></a><span data-ttu-id="c376c-677">Débogage des échecs d’application</span><span class="sxs-lookup"><span data-stu-id="c376c-677">Debugging application failures</span></span>
* <span data-ttu-id="c376c-678">`stderr` et `stdout`</span><span class="sxs-lookup"><span data-stu-id="c376c-678">`stderr` and `stdout`</span></span>

    <span data-ttu-id="c376c-679">Pendant l’exécution, une application peut produire des diagnostics qui vous permettent de résoudre les problèmes.</span><span class="sxs-lookup"><span data-stu-id="c376c-679">During execution, an application might produce diagnostic output that you can use to troubleshoot issues.</span></span> <span data-ttu-id="c376c-680">Comme mentionné dans la section plus haut [Fichiers et répertoires](#files-and-directories), le service Batch écrit des sorties et des sorties d’erreur standard dans des fichiers `stdout.txt` et `stderr.txt` du répertoire de tâche sur le nœud de calcul.</span><span class="sxs-lookup"><span data-stu-id="c376c-680">As mentioned in the earlier section [Files and directories](#files-and-directories), the Batch service writes standard output and standard error output to `stdout.txt` and `stderr.txt` files in the task directory on the compute node.</span></span> <span data-ttu-id="c376c-681">Vous pouvez utiliser le portail Azure ou l’un des Kits de développement logiciel (SDK) Batch pour télécharger ces fichiers.</span><span class="sxs-lookup"><span data-stu-id="c376c-681">You can use the Azure portal or one of the Batch SDKs to download these files.</span></span> <span data-ttu-id="c376c-682">Par exemple, vous pouvez récupérer ces fichiers et d’autres à des fins de résolution des problèmes en utilisant [ComputeNode.GetNodeFile][net_getfile_node] et [CloudTask.GetNodeFile][net_getfile_task] dans la bibliothèque .NET Batch.</span><span class="sxs-lookup"><span data-stu-id="c376c-682">For example, you can retrieve these and other files for troubleshooting purposes by using [ComputeNode.GetNodeFile][net_getfile_node] and [CloudTask.GetNodeFile][net_getfile_task] in the Batch .NET library.</span></span>

* <span data-ttu-id="c376c-683">**Codes de sortie de tâche**</span><span class="sxs-lookup"><span data-stu-id="c376c-683">**Task exit codes**</span></span>

    <span data-ttu-id="c376c-684">Comme mentionné précédemment, une tâche est marquée comme ayant échoué par le service Batch si le processus exécuté par la tâche retourne un code de sortie différent de zéro.</span><span class="sxs-lookup"><span data-stu-id="c376c-684">As mentioned earlier, a task is marked as failed by the Batch service if the process that is executed by the task returns a nonzero exit code.</span></span> <span data-ttu-id="c376c-685">Lorsqu’une tâche exécute un processus, Batch remplit la propriété de code de sortie de la tâche avec le *code de retour du processus*.</span><span class="sxs-lookup"><span data-stu-id="c376c-685">When a task executes a process, Batch populates the task's exit code property with the *return code of the process*.</span></span> <span data-ttu-id="c376c-686">Il est important de noter que le code de sortie d’une tâche **n’est pas** déterminé par le service Batch,</span><span class="sxs-lookup"><span data-stu-id="c376c-686">It is important to note that a task's exit code is **not** determined by the Batch service.</span></span> <span data-ttu-id="c376c-687">mais par le processus proprement dit ou par le système d’exploitation sur lequel le processus est exécuté.</span><span class="sxs-lookup"><span data-stu-id="c376c-687">A task's exit code is determined by the process itself or the operating system on which the process executed.</span></span>

### <a name="accounting-for-task-failures-or-interruptions"></a><span data-ttu-id="c376c-688">Prise en compte des échecs ou des interruptions de tâche</span><span class="sxs-lookup"><span data-stu-id="c376c-688">Accounting for task failures or interruptions</span></span>
<span data-ttu-id="c376c-689">Les tâches peuvent parfois échouer ou être interrompues.</span><span class="sxs-lookup"><span data-stu-id="c376c-689">Tasks might occasionally fail or be interrupted.</span></span> <span data-ttu-id="c376c-690">L’application de la tâche elle-même peut échouer, le nœud sur lequel elle s’exécute peut être redémarré, voire supprimé du pool pendant le redimensionnement de ce dernier si la stratégie de désallocation du pool définie prévoit la suppression immédiate des nœuds, sans attendre la fin des tâches.</span><span class="sxs-lookup"><span data-stu-id="c376c-690">The task application itself might fail, the node on which the task is running might be rebooted, or the node might be removed from the pool during a resize operation if the pool's deallocation policy is set to remove nodes immediately without waiting for tasks to finish.</span></span> <span data-ttu-id="c376c-691">Dans tous les cas, la tâche peut être automatiquement remise en file d’attente par Batch pour être exécutée sur un autre nœud.</span><span class="sxs-lookup"><span data-stu-id="c376c-691">In all cases, the task can be automatically requeued by Batch for execution on another node.</span></span>

<span data-ttu-id="c376c-692">Un problème intermittent peut également provoquer la suspension d’une tâche ou ralentir son exécution.</span><span class="sxs-lookup"><span data-stu-id="c376c-692">It is also possible for an intermittent issue to cause a task to hang or take too long to execute.</span></span> <span data-ttu-id="c376c-693">Vous pouvez définir l’intervalle d’exécution maximal d’une tâche.</span><span class="sxs-lookup"><span data-stu-id="c376c-693">You can set the maximum execution interval for a task.</span></span> <span data-ttu-id="c376c-694">Si l’intervalle d’exécution maximal est dépassé, le service Batch interrompt l’application de la tâche.</span><span class="sxs-lookup"><span data-stu-id="c376c-694">If the maximum execution interval is exceeded, the Batch service interrupts the task application.</span></span>

### <a name="connecting-to-compute-nodes"></a><span data-ttu-id="c376c-695">Se connecter aux nœuds de calcul</span><span class="sxs-lookup"><span data-stu-id="c376c-695">Connecting to compute nodes</span></span>
<span data-ttu-id="c376c-696">Vous pouvez effectuer des actions supplémentaires de débogage et de résolution des problèmes en vous connectant à un nœud de calcul à distance.</span><span class="sxs-lookup"><span data-stu-id="c376c-696">You can perform additional debugging and troubleshooting by signing in to a compute node remotely.</span></span> <span data-ttu-id="c376c-697">Vous pouvez utiliser le portail Azure pour télécharger un fichier RDP pour les nœuds Windows et obtenir des informations de connexion SSH pour les nœuds Linux.</span><span class="sxs-lookup"><span data-stu-id="c376c-697">You can use the Azure portal to download a Remote Desktop Protocol (RDP) file for Windows nodes and obtain Secure Shell (SSH) connection information for Linux nodes.</span></span> <span data-ttu-id="c376c-698">Vous pouvez également effectuer cette opération à l’aide des API Batch, par exemple [.NET Batch][net_rdpfile] ou [Python Batch](batch-linux-nodes.md#connect-to-linux-nodes-using-ssh).</span><span class="sxs-lookup"><span data-stu-id="c376c-698">You can also do this by using the Batch APIs--for example, with [Batch .NET][net_rdpfile] or [Batch Python](batch-linux-nodes.md#connect-to-linux-nodes-using-ssh).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="c376c-699">Pour vous connecter à un nœud via RDP ou SSH, vous devez d’abord créer un utilisateur sur le nœud.</span><span class="sxs-lookup"><span data-stu-id="c376c-699">To connect to a node via RDP or SSH, you must first create a user on the node.</span></span> <span data-ttu-id="c376c-700">Pour ce faire, vous pouvez utiliser le Portail Azure, [ajouter un compte d’utilisateur à un nœud][rest_create_user] en utilisant l’API REST Batch, appeler la méthode [ComputeNode.CreateComputeNodeUser][net_create_user] dans .NET Batch ou appeler la méthode [add_user][py_add_user] dans le module Python de Batch.</span><span class="sxs-lookup"><span data-stu-id="c376c-700">To do this, you can use the Azure portal, [add a user account to a node][rest_create_user] by using the Batch REST API, call the [ComputeNode.CreateComputeNodeUser][net_create_user] method in Batch .NET, or call the [add_user][py_add_user] method in the Batch Python module.</span></span>
>
>

### <a name="troubleshooting-problematic-compute-nodes"></a><span data-ttu-id="c376c-701">Résolution des problèmes liés aux nœuds de calcul</span><span class="sxs-lookup"><span data-stu-id="c376c-701">Troubleshooting problematic compute nodes</span></span>
<span data-ttu-id="c376c-702">Quand certaines de vos tâches échouent, votre application cliente Batch ou un service peut examiner les métadonnées des tâches en échec pour identifier un nœud présentant un dysfonctionnement.</span><span class="sxs-lookup"><span data-stu-id="c376c-702">In situations where some of your tasks are failing, your Batch client application or service can examine the metadata of the failed tasks to identify a misbehaving node.</span></span> <span data-ttu-id="c376c-703">Chaque nœud d’un pool se voit attribuer un ID unique et le nœud sur lequel s’exécute une tâche est inclus dans les métadonnées de la tâche.</span><span class="sxs-lookup"><span data-stu-id="c376c-703">Each node in a pool is given a unique ID, and the node on which a task runs is included in the task metadata.</span></span> <span data-ttu-id="c376c-704">Une fois que vous avez identifié le nœud présentant un problème, vous pouvez effectuer les actions suivantes :</span><span class="sxs-lookup"><span data-stu-id="c376c-704">After you've identified a problem node, you can take several actions with it:</span></span>

* <span data-ttu-id="c376c-705">**Redémarrer le nœud** ([REST][rest_reboot] | [.NET][net_reboot])</span><span class="sxs-lookup"><span data-stu-id="c376c-705">**Reboot the node** ([REST][rest_reboot] | [.NET][net_reboot])</span></span>

    <span data-ttu-id="c376c-706">Le fait de redémarrer le nœud peut parfois résoudre des problèmes latents comme des processus bloqués ou défaillants.</span><span class="sxs-lookup"><span data-stu-id="c376c-706">Restarting the node can sometimes clear up latent issues like stuck or crashed processes.</span></span> <span data-ttu-id="c376c-707">Notez que si votre pool utilise une tâche de démarrage ou si votre travail utilise une tâche de préparation, ces deux éléments s’exécutent au redémarrage du nœud.</span><span class="sxs-lookup"><span data-stu-id="c376c-707">Note that if your pool uses a start task or your job uses a job preparation task, they are executed when the node restarts.</span></span>
* <span data-ttu-id="c376c-708">**Réinitialiser le nœud** ([REST][rest_reimage] | [.NET][net_reimage])</span><span class="sxs-lookup"><span data-stu-id="c376c-708">**Reimage the node** ([REST][rest_reimage] | [.NET][net_reimage])</span></span>

    <span data-ttu-id="c376c-709">Cette opération réinstalle le système d’exploitation sur le nœud.</span><span class="sxs-lookup"><span data-stu-id="c376c-709">This reinstalls the operating system on the node.</span></span> <span data-ttu-id="c376c-710">Comme avec le redémarrage d’un nœud, les tâches de démarrage et celles de préparation d’un travail sont relancées une fois le nœud réinitialisé.</span><span class="sxs-lookup"><span data-stu-id="c376c-710">As with rebooting a node, start tasks and job preparation tasks are rerun after the node has been reimaged.</span></span>
* <span data-ttu-id="c376c-711">**Supprimer le nœud du pool** ([REST][rest_remove] | [.NET][net_remove])</span><span class="sxs-lookup"><span data-stu-id="c376c-711">**Remove the node from the pool** ([REST][rest_remove] | [.NET][net_remove])</span></span>

    <span data-ttu-id="c376c-712">Il est parfois nécessaire de supprimer entièrement le nœud à partir du pool.</span><span class="sxs-lookup"><span data-stu-id="c376c-712">Sometimes it is necessary to completely remove the node from the pool.</span></span>
* <span data-ttu-id="c376c-713">**Désactiver la planification des tâches sur le nœud** ([REST][rest_offline] | [.NET][net_offline])</span><span class="sxs-lookup"><span data-stu-id="c376c-713">**Disable task scheduling on the node** ([REST][rest_offline] | [.NET][net_offline])</span></span>

    <span data-ttu-id="c376c-714">Cette opération met le nœud hors connexion, de sorte qu’aucune tâche supplémentaire ne peut lui être affectée. Toutefois, le nœud est autorisé à poursuivre son exécution et à rester dans le pool.</span><span class="sxs-lookup"><span data-stu-id="c376c-714">This effectively takes the node offline so that no further tasks are assigned to it, but allows the node to remain running and in the pool.</span></span> <span data-ttu-id="c376c-715">Cela vous permet de faire une recherche approfondie sur la cause des échecs sans perdre les données de la tâche en échec et sans que le nœud n’occasionne d’autres échecs de tâche supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="c376c-715">This enables you to perform further investigation into the cause of the failures without losing the failed task's data, and without the node causing additional task failures.</span></span> <span data-ttu-id="c376c-716">Par exemple, vous pouvez désactiver la planification des tâches sur le nœud, puis vous [connecter à distance](#connecting-to-compute-nodes) pour examiner les journaux des événements de ce nœud ou encore résoudre d’autres problèmes.</span><span class="sxs-lookup"><span data-stu-id="c376c-716">For example, you can disable task scheduling on the node, then [sign in remotely](#connecting-to-compute-nodes) to examine the node's event logs or perform other troubleshooting.</span></span> <span data-ttu-id="c376c-717">Après avoir terminé votre recherche, vous pouvez remettre le nœud en ligne en activant la planification des tâches ([REST][rest_online] | [.NET][net_online]), ou exécuter l’une des autres actions indiquées précédemment.</span><span class="sxs-lookup"><span data-stu-id="c376c-717">After you've finished your investigation, you can then bring the node back online by enabling task scheduling ([REST][rest_online] | [.NET][net_online]), or perform one of the other actions discussed earlier.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="c376c-718">Pour chaque action décrite dans cette section (redémarrer, réinitialiser, supprimer, et désactiver la planification des tâches), vous pouvez indiquer la manière dont les tâches en cours d’exécution sur le nœud sont gérées lorsque vous effectuez l’action.</span><span class="sxs-lookup"><span data-stu-id="c376c-718">With each action that is described in this section--reboot, reimage, remove, and disable task scheduling--you are able to specify how tasks currently running on the node are handled when you perform the action.</span></span> <span data-ttu-id="c376c-719">Par exemple, lorsque vous désactivez la planification des tâches sur un nœud à l’aide de la bibliothèque client .NET Batch, vous pouvez spécifier une valeur d’énumération [DisableComputeNodeSchedulingOption][net_offline_option] pour préciser s’il faut **terminer** les tâches en cours d’exécution, les **remettre en file d’attente** pour les planifier sur d’autres nœuds ou finaliser les tâches en cours avant d’exécuter l’action (**TaskCompletion**).</span><span class="sxs-lookup"><span data-stu-id="c376c-719">For example, when you disable task scheduling on a node by using the Batch .NET client library, you can specify a [DisableComputeNodeSchedulingOption][net_offline_option] enum value to specify whether to **Terminate** running tasks, **Requeue** them for scheduling on other nodes, or allow running tasks to complete before performing the action (**TaskCompletion**).</span></span>
>
>

## <a name="next-steps"></a><span data-ttu-id="c376c-720">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="c376c-720">Next steps</span></span>
* <span data-ttu-id="c376c-721">Découvrez les [outils et API Batch](batch-apis-tools.md) disponibles pour créer des solutions Batch.</span><span class="sxs-lookup"><span data-stu-id="c376c-721">Learn about the [Batch APIs and tools](batch-apis-tools.md) available for building Batch solutions.</span></span>
* <span data-ttu-id="c376c-722">Passez en revue un exemple d’application Batch détaillée dans [Prise en main de la bibliothèque Azure Batch pour .NET](batch-dotnet-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="c376c-722">Walk through a sample Batch application step-by-step in [Get started with the Azure Batch Library for .NET](batch-dotnet-get-started.md).</span></span> <span data-ttu-id="c376c-723">Il existe également une [version Python](batch-python-tutorial.md) du didacticiel qui exécute une charge de travail sur des nœuds de calcul Linux.</span><span class="sxs-lookup"><span data-stu-id="c376c-723">There is also a [Python version](batch-python-tutorial.md) of the tutorial that runs a workload on Linux compute nodes.</span></span>
* <span data-ttu-id="c376c-724">Téléchargez et créez l’exemple de projet [Batch Explorer][github_batchexplorer] à utiliser lors du développement de vos solutions Batch.</span><span class="sxs-lookup"><span data-stu-id="c376c-724">Download and build the [Batch Explorer][github_batchexplorer] sample project for use while you develop your Batch solutions.</span></span> <span data-ttu-id="c376c-725">En utilisant l’explorateur Batch, vous pouvez effectuer ce qui suit, et bien plus encore :</span><span class="sxs-lookup"><span data-stu-id="c376c-725">Using the Batch Explorer, you can perform the following and more:</span></span>

  * <span data-ttu-id="c376c-726">Analysez et manipulez les pools, les travaux et les tâches au sein de votre compte Batch</span><span class="sxs-lookup"><span data-stu-id="c376c-726">Monitor and manipulate pools, jobs, and tasks within your Batch account</span></span>
  * <span data-ttu-id="c376c-727">Téléchargez `stdout.txt`, `stderr.txt` et d’autres fichiers à partir des nœuds</span><span class="sxs-lookup"><span data-stu-id="c376c-727">Download `stdout.txt`, `stderr.txt`, and other files from nodes</span></span>
  * <span data-ttu-id="c376c-728">Créez des utilisateurs sur les nœuds et téléchargez les fichiers RDP pour la connexion à distance</span><span class="sxs-lookup"><span data-stu-id="c376c-728">Create users on nodes and download RDP files for remote login</span></span>
* <span data-ttu-id="c376c-729">Découvrez comment [créer des pools de nœuds de calcul Linux](batch-linux-nodes.md).</span><span class="sxs-lookup"><span data-stu-id="c376c-729">Learn how to [create pools of Linux compute nodes](batch-linux-nodes.md).</span></span>
* <span data-ttu-id="c376c-730">Consultez le [forum Azure Batch][batch_forum] sur MSDN.</span><span class="sxs-lookup"><span data-stu-id="c376c-730">Visit the [Azure Batch forum][batch_forum] on MSDN.</span></span> <span data-ttu-id="c376c-731">Le forum est parfait pour poser des questions, que vous soyez débutant ou expert dans l’utilisation du service Batch.</span><span class="sxs-lookup"><span data-stu-id="c376c-731">The forum is a good place to ask questions, whether you are just learning or are an expert in using Batch.</span></span>

[1]: ./media/batch-api-basics/node-folder-structure.png

[azure_storage]: https://azure.microsoft.com/services/storage/
[batch_forum]: https://social.msdn.microsoft.com/Forums/en-US/home?forum=azurebatch
[cloud_service_sizes]: ../cloud-services/cloud-services-sizes-specs.md
[msmpi]: https://msdn.microsoft.com/library/bb524831.aspx
[github_samples]: https://github.com/Azure/azure-batch-samples
[github_sample_taskdeps]:  https://github.com/Azure/azure-batch-samples/tree/master/CSharp/ArticleProjects/TaskDependencies
[github_batchexplorer]: https://github.com/Azure/azure-batch-samples/tree/master/CSharp/BatchExplorer
[batch_net_api]: https://msdn.microsoft.com/library/azure/mt348682.aspx
[msdn_env_vars]: https://msdn.microsoft.com/library/azure/mt743623.aspx
[net_cloudjob_jobmanagertask]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.cloudjob.jobmanagertask.aspx
[net_cloudjob_priority]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.cloudjob.priority.aspx
[net_cloudpool_starttask]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.cloudpool.starttask.aspx
[net_cloudtask_env]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.cloudtask.environmentsettings.aspx
[net_create_cert]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.certificateoperations.createcertificate.aspx
[net_create_user]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.computenode.createcomputenodeuser.aspx
[net_getfile_node]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.computenode.getnodefile.aspx
[net_getfile_task]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.cloudtask.getnodefile.aspx
[net_job_env]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.cloudjob.commonenvironmentsettings.aspx
[net_multiinstancesettings]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.multiinstancesettings.aspx
[net_onalltaskscomplete]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.cloudjob.onalltaskscomplete.aspx
[net_rdp]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.computenode.getrdpfile.aspx
[net_reboot]: https://msdn.microsoft.com/library/azure/mt631495.aspx
[net_reimage]: https://msdn.microsoft.com/library/azure/mt631496.aspx
[net_remove]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.pooloperations.removefrompoolasync.aspx
[net_offline]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.computenode.disableschedulingasync.aspx
[net_online]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.computenode.enableschedulingasync.aspx
[net_offline_option]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.common.disablecomputenodeschedulingoption.aspx
[net_rdpfile]: https://msdn.microsoft.com/library/azure/Mt272127.aspx
[vnet]: https://msdn.microsoft.com/library/azure/dn820174.aspx#bk_netconf

[py_add_user]: http://azure-sdk-for-python.readthedocs.io/en/latest/ref/azure.batch.operations.html#azure.batch.operations.ComputeNodeOperations.add_user

[batch_rest_api]: https://msdn.microsoft.com/library/azure/Dn820158.aspx
[rest_add_job]: https://msdn.microsoft.com/library/azure/mt282178.aspx
[rest_add_pool]: https://msdn.microsoft.com/library/azure/dn820174.aspx
[rest_add_cert]: https://msdn.microsoft.com/library/azure/dn820169.aspx
[rest_add_task]: https://msdn.microsoft.com/library/azure/dn820105.aspx
[rest_create_user]: https://msdn.microsoft.com/library/azure/dn820137.aspx
[rest_get_task_info]: https://msdn.microsoft.com/library/azure/dn820133.aspx
[rest_job_schedules]: https://msdn.microsoft.com/library/azure/mt282179.aspx
[rest_multiinstance]: https://msdn.microsoft.com/library/azure/mt637905.aspx
[rest_multiinstancesettings]: https://msdn.microsoft.com/library/azure/dn820105.aspx#multiInstanceSettings
[rest_update_job]: https://msdn.microsoft.com/library/azure/dn820162.aspx
[rest_rdp]: https://msdn.microsoft.com/library/azure/dn820120.aspx
[rest_reboot]: https://msdn.microsoft.com/library/azure/dn820171.aspx
[rest_reimage]: https://msdn.microsoft.com/library/azure/dn820157.aspx
[rest_remove]: https://msdn.microsoft.com/library/azure/dn820194.aspx
[rest_offline]: https://msdn.microsoft.com/library/azure/mt637904.aspx
[rest_online]: https://msdn.microsoft.com/library/azure/mt637907.aspx

[vm_marketplace]: https://azure.microsoft.com/marketplace/virtual-machines/
