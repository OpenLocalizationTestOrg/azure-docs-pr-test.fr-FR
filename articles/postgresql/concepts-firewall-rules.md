---
title: "Règles de pare-feu d’un serveur de base de données Azure pour PostgreSQL | Microsoft Docs"
description: "Décrit les règles de pare-feu d’un serveur de base de données Azure pour PostgreSQL."
services: postgresql
author: jasonwhowell
ms.author: jasonh
manager: jhubbard
editor: jasonwhowell
ms.service: postgresql
ms.topic: article
ms.date: 05/10/2017
ms.openlocfilehash: 150c4f53c5ab6a6425b6af7d286d4c1518b006f8
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/29/2017
---
# <a name="azure-database-for-postgresql-server-firewall-rules"></a><span data-ttu-id="62434-103">Règles de pare-feu d’un serveur de base de données Azure pour PostgreSQL</span><span class="sxs-lookup"><span data-stu-id="62434-103">Azure Database for PostgreSQL Server firewall rules</span></span>
<span data-ttu-id="62434-104">Le pare-feu empêche tout accès à votre serveur de base de données jusqu’à ce que vous spécifiiez les ordinateurs qui disposent d’autorisations.</span><span class="sxs-lookup"><span data-stu-id="62434-104">Firewalls prevent all access to your database server until you specify which computers have permission.</span></span> <span data-ttu-id="62434-105">Le pare-feu octroie l’accès au serveur en fonction de l’adresse IP d’origine de chaque demande.</span><span class="sxs-lookup"><span data-stu-id="62434-105">The firewall grants access to the server based on the originating IP address of each request.</span></span>
<span data-ttu-id="62434-106">Pour configurer votre pare-feu, vous créez des règles de pare-feu qui spécifient les plages d’adresses IP acceptables.</span><span class="sxs-lookup"><span data-stu-id="62434-106">To configure your firewall, you create firewall rules that specify ranges of acceptable IP addresses.</span></span> <span data-ttu-id="62434-107">Vous pouvez créer des règles de pare-feu au niveau du serveur.</span><span class="sxs-lookup"><span data-stu-id="62434-107">You can create firewall rules at the server level.</span></span>

<span data-ttu-id="62434-108">**Règles de pare-feu :** ces règles permettent aux clients d’accéder à l’ensemble de votre serveur de base de données Azure pour PostgreSQL, c’est-à-dire à toutes les bases de données qui se trouvent sur le même serveur logique.</span><span class="sxs-lookup"><span data-stu-id="62434-108">**Firewall rules:** These rules enable clients to access your entire Azure Database for PostgreSQL Server, that is, all the databases within the same logical server.</span></span> <span data-ttu-id="62434-109">Les règles de pare-feu au niveau du serveur peuvent être configurées en utilisant le Portail Azure ou des commandes d’Azure CLI.</span><span class="sxs-lookup"><span data-stu-id="62434-109">Server-level firewall rules can be configured by using the Azure portal or using Azure CLI commands.</span></span> <span data-ttu-id="62434-110">Pour créer des règles de pare-feu au niveau du serveur, vous devez être le propriétaire de l’abonnement ou collaborateur.</span><span class="sxs-lookup"><span data-stu-id="62434-110">To create server-level firewall rules, you must be the subscription owner or a subscription contributor.</span></span>

## <a name="firewall-overview"></a><span data-ttu-id="62434-111">Présentation du pare-feu</span><span class="sxs-lookup"><span data-stu-id="62434-111">Firewall overview</span></span>
<span data-ttu-id="62434-112">Par défaut, tous les accès au serveur de base de données Azure pour PostgreSQL sont bloqués par le pare-feu.</span><span class="sxs-lookup"><span data-stu-id="62434-112">All database access to your Azure Database for PostgreSQL server is blocked by the firewall by default.</span></span> <span data-ttu-id="62434-113">Pour pouvoir utiliser votre serveur à partir d’un autre ordinateur, vous devez spécifier une ou plusieurs règles de pare-feu au niveau du serveur afin de permettre l’accès à votre serveur.</span><span class="sxs-lookup"><span data-stu-id="62434-113">To begin using your server from another computer, you need to specify one or more server-level firewall rules to enable access to your server.</span></span> <span data-ttu-id="62434-114">Utilisez les règles de pare-feu pour spécifier les plages d’adresses IP d’Internet à autoriser.</span><span class="sxs-lookup"><span data-stu-id="62434-114">Use the firewall rules to specify which IP address ranges from the Internet to allow.</span></span> <span data-ttu-id="62434-115">L’accès au site web du Portail Azure proprement dit n’est pas affecté par les règles de pare-feu.</span><span class="sxs-lookup"><span data-stu-id="62434-115">Access to the Azure portal website itself is not impacted by the firewall rules.</span></span>
<span data-ttu-id="62434-116">Les tentatives de connexion à partir d’Internet et d’Azure doivent franchir le pare-feu pour pouvoir atteindre votre base de données PostgreSQL, comme l’illustre le diagramme suivant :</span><span class="sxs-lookup"><span data-stu-id="62434-116">Connection attempts from the Internet and Azure must first pass through the firewall before they can reach your PostgreSQL Database, as shown in the following diagram:</span></span>

![Exemple de flux de fonctionnement du pare-feu](media/concepts-firewall-rules/1-firewall-concept.png)

## <a name="connecting-from-the-internet"></a><span data-ttu-id="62434-118">Connexion à partir d’Internet</span><span class="sxs-lookup"><span data-stu-id="62434-118">Connecting from the Internet</span></span>
<span data-ttu-id="62434-119">Les règles de pare-feu au niveau du serveur s’appliquent à toutes les bases de données qui se trouvent sur le serveur de base de données Azure pour PostgreSQL.</span><span class="sxs-lookup"><span data-stu-id="62434-119">Server-level firewall rules apply to all databases on the Azure Database for PostgreSQL server.</span></span> <span data-ttu-id="62434-120">Si l’adresse IP de la demande appartient à une des plages spécifiées dans les règles de pare-feu au niveau du serveur, la connexion est accordée.</span><span class="sxs-lookup"><span data-stu-id="62434-120">If the IP address of the request is within one of the ranges specified in the server-level firewall rules, the connection is granted.</span></span>
<span data-ttu-id="62434-121">Si l’adresse IP de la demande n’appartient pas aux plages spécifiées dans des règles de pare-feu au niveau du serveur ou de la base de données, la demande de connexion échoue.</span><span class="sxs-lookup"><span data-stu-id="62434-121">If the IP address of the request is not within the ranges specified in any of the database-level or server-level firewall rules, the connection request fails.</span></span>
<span data-ttu-id="62434-122">Par exemple, si votre application se connecte au pilote JDBC pour PostgreSQL, il se peut que vous rencontriez cette erreur au cours de la tentative de connexion, si le pare-feu la bloque.</span><span class="sxs-lookup"><span data-stu-id="62434-122">For example, if your application connects with JDBC driver for PostgreSQL, you may encounter this error attempting to connect when the firewall is blocking the connection.</span></span>
> <span data-ttu-id="62434-123">java.util.concurrent.ExecutionException: java.lang.RuntimeException: org.postgresql.util.PSQLException: FATAL: no pg\_hba.conf entry for host "123.45.67.890", user "adminuser", database "postgresql", SSL</span><span class="sxs-lookup"><span data-stu-id="62434-123">java.util.concurrent.ExecutionException: java.lang.RuntimeException: org.postgresql.util.PSQLException: FATAL: no pg\_hba.conf entry for host "123.45.67.890", user "adminuser", database "postgresql", SSL</span></span>

## <a name="programmatically-managing-firewall-rules"></a><span data-ttu-id="62434-124">Gestion par programmation des règles de pare-feu</span><span class="sxs-lookup"><span data-stu-id="62434-124">Programmatically managing firewall rules</span></span>
<span data-ttu-id="62434-125">En dehors du Portail Azure, les règles de pare-feu peuvent être gérées par programmation à l’aide d’Azure CLI.</span><span class="sxs-lookup"><span data-stu-id="62434-125">In addition to the Azure portal, firewall rules can be managed programmatically using Azure CLI.</span></span>
<span data-ttu-id="62434-126">Consultez également la page [Créer et gérer les règles de pare-feu de la base de données Azure pour PostgreSQL à l’aide d’Azure CLI](howto-manage-firewall-using-cli.md).</span><span class="sxs-lookup"><span data-stu-id="62434-126">See also [Create and manage Azure Database for PostgreSQL firewall rules using Azure CLI](howto-manage-firewall-using-cli.md)</span></span>

## <a name="troubleshooting-the-database-firewall"></a><span data-ttu-id="62434-127">Dépannage du pare-feu de base de données</span><span class="sxs-lookup"><span data-stu-id="62434-127">Troubleshooting the database firewall</span></span>
<span data-ttu-id="62434-128">Considérez les points suivants quand l’accès au service de serveur de base de données Microsoft Azure pour PostgreSQL présente un comportement anormal :</span><span class="sxs-lookup"><span data-stu-id="62434-128">Consider the following points when access to the Microsoft Azure Database for PostgreSQL Server service does not behave as you expect:</span></span>

* <span data-ttu-id="62434-129">**Les modifications apportées à la liste d’approbation n’ont pas encore pris effet :** jusqu’à cinq minutes peuvent s’écouler avant que les modifications apportées à la configuration du pare-feu du serveur de base de données Azure pour PostgreSQL ne soient effectives.</span><span class="sxs-lookup"><span data-stu-id="62434-129">**Changes to the allow list have not taken effect yet:** There may be as much as a five-minute delay for changes to the Azure Database for PostgreSQL Server firewall configuration to take effect.</span></span>

* <span data-ttu-id="62434-130">**La connexion n’est pas autorisée ou un mot de passe incorrect a été utilisé :** si une connexion n’a pas d’autorisations sur le serveur de base de données Azure pour PostgreSQL ou que le mot de passe est incorrect, la connexion au serveur de base de données Azure pour PostgreSQL est refusée.</span><span class="sxs-lookup"><span data-stu-id="62434-130">**The login is not authorized or an incorrect password was used:** If a login does not have permissions on the Azure Database for PostgreSQL server or the password used is incorrect, the connection to the Azure Database for PostgreSQL server is denied.</span></span> <span data-ttu-id="62434-131">Créer un paramètre de pare-feu permet uniquement aux clients de tenter de se connecter à votre serveur ; chaque client doit fournir les informations d’identification de sécurité nécessaires.</span><span class="sxs-lookup"><span data-stu-id="62434-131">Creating a firewall setting only provides clients with an opportunity to attempt connecting to your server; each client must provide the necessary security credentials.</span></span>

<span data-ttu-id="62434-132">Par exemple, avec un client JDBC, l’erreur suivante est susceptible d’apparaître.</span><span class="sxs-lookup"><span data-stu-id="62434-132">For example, using a JDBC client, the following error may appear.</span></span>
> <span data-ttu-id="62434-133">java.util.concurrent.ExecutionException: java.lang.RuntimeException: org.postgresql.util.PSQLException: FATAL: password authentication failed for user "yourusername"</span><span class="sxs-lookup"><span data-stu-id="62434-133">java.util.concurrent.ExecutionException: java.lang.RuntimeException: org.postgresql.util.PSQLException: FATAL: password authentication failed for user "yourusername"</span></span>

* <span data-ttu-id="62434-134">**Adresse IP dynamique :** si vous avez une connexion Internet avec adressage IP dynamique et que le pare-feu demeure infranchissable, vous pouvez essayer une des solutions suivantes :</span><span class="sxs-lookup"><span data-stu-id="62434-134">**Dynamic IP address:** If you have an Internet connection with dynamic IP addressing and you are having trouble getting through the firewall, you could try one of the following solutions:</span></span>

* <span data-ttu-id="62434-135">Demandez à votre fournisseur de services Internet (ISP) la plage d’adresses IP affectée à vos ordinateurs clients qui accèdent au serveur de base de données Azure pour PostgreSQL, puis ajoutez cette plage dans une règle de pare-feu.</span><span class="sxs-lookup"><span data-stu-id="62434-135">Ask your Internet Service Provider (ISP) for the IP address range assigned to your client computers that access the Azure Database for PostgreSQL Server, and then add the IP address range as a firewall rule.</span></span>

* <span data-ttu-id="62434-136">Obtenez un adressage IP statique à la place pour vos ordinateurs clients, puis ajoutez les adresses IP en tant que règles de pare-feu.</span><span class="sxs-lookup"><span data-stu-id="62434-136">Get static IP addressing instead for your client computers, and then add the IP addresses as firewall rules.</span></span>

## <a name="next-steps"></a><span data-ttu-id="62434-137">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="62434-137">Next steps</span></span>
<span data-ttu-id="62434-138">Pour obtenir des informations sur la création de règles de pare-feu au niveau du serveur et au niveau de la base de données, consultez les articles suivants :</span><span class="sxs-lookup"><span data-stu-id="62434-138">For articles on creating server-level and database-level firewall rules, see:</span></span>
* [<span data-ttu-id="62434-139">Créer et gérer des règles de pare-feu de la base de données Azure pour PostgreSQL à l’aide du Portail Azure</span><span class="sxs-lookup"><span data-stu-id="62434-139">Create and manage Azure Database for PostgreSQL firewall rules using the Azure portal</span></span>](howto-manage-firewall-using-portal.md)
* [<span data-ttu-id="62434-140">Créer et gérer des règles de pare-feu de la base de données Azure pour PostgreSQL à l’aide d’Azure CLI</span><span class="sxs-lookup"><span data-stu-id="62434-140">Create and manage Azure Database for PostgreSQL firewall rules using Azure CLI</span></span>](howto-manage-firewall-using-cli.md)