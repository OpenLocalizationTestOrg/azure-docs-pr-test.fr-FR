---
title: "Mon premier Runbook graphique dans Azure Automation | Microsoft Docs"
description: "Ce didacticiel vous familiarise avec la création, le test et la publication d'un Runbook graphique simple."
services: automation
documentationcenter: 
author: mgoedtel
manager: jwhit
editor: 
keywords: "runbook, modèle de runbook, automatisation des runbooks, runbook azure"
ms.assetid: dcb88f19-ed2b-4372-9724-6625cd287c8a
ms.service: automation
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 05/17/2017
ms.author: magoedte;bwren
ms.openlocfilehash: 9d4b28416376482247127698bec7c99b83308885
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/11/2017
---
# <a name="my-first-graphical-runbook"></a><span data-ttu-id="efcb9-104">Mon premier Runbook graphique</span><span class="sxs-lookup"><span data-stu-id="efcb9-104">My first graphical runbook</span></span>

> [!div class="op_single_selector"]
> * [<span data-ttu-id="efcb9-105">Graphique</span><span class="sxs-lookup"><span data-stu-id="efcb9-105">Graphical</span></span>](automation-first-runbook-graphical.md)
> * [<span data-ttu-id="efcb9-106">PowerShell</span><span class="sxs-lookup"><span data-stu-id="efcb9-106">PowerShell</span></span>](automation-first-runbook-textual-powershell.md)
> * [<span data-ttu-id="efcb9-107">Workflow PowerShell</span><span class="sxs-lookup"><span data-stu-id="efcb9-107">PowerShell Workflow</span></span>](automation-first-runbook-textual.md)
> 
> 

<span data-ttu-id="efcb9-108">Ce didacticiel vous familiarise avec la création d’un [Runbook graphique](automation-runbook-types.md#graphical-runbooks) dans Azure Automation.</span><span class="sxs-lookup"><span data-stu-id="efcb9-108">This tutorial walks you through the creation of a [graphical runbook](automation-runbook-types.md#graphical-runbooks) in Azure Automation.</span></span>  <span data-ttu-id="efcb9-109">Nous commençons par un simple runbook que nous testons et publions tout en expliquant comment suivre l’état du travail du runbook.</span><span class="sxs-lookup"><span data-stu-id="efcb9-109">We start with a simple runbook that tests and publishes while we explain how to track the status of the runbook job.</span></span>  <span data-ttu-id="efcb9-110">Nous modifions ensuite le runbook pour gérer les ressources Azure, en démarrant dans ce cas une machine virtuelle Azure.</span><span class="sxs-lookup"><span data-stu-id="efcb9-110">Then we modify the runbook to actually manage Azure resources, in this case starting an Azure virtual machine.</span></span>  <span data-ttu-id="efcb9-111">Enfin, nous terminons ce didacticiel en renforçant le Runbook grâce à l’ajout des paramètres de Runbook et des liens conditionnels.</span><span class="sxs-lookup"><span data-stu-id="efcb9-111">Then we complete the tutorial by making the runbook more robust by adding runbook parameters and conditional links.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="efcb9-112">Composants requis</span><span class="sxs-lookup"><span data-stu-id="efcb9-112">Prerequisites</span></span>
<span data-ttu-id="efcb9-113">Pour réaliser ce didacticiel, vous avez besoin des éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="efcb9-113">To complete this tutorial, you will need the following.</span></span>

* <span data-ttu-id="efcb9-114">Abonnement Azure.</span><span class="sxs-lookup"><span data-stu-id="efcb9-114">Azure subscription.</span></span>  <span data-ttu-id="efcb9-115">Si vous n’avez pas encore d’abonnement, vous pouvez [activer vos avantages abonnés MSDN](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) ou <a href="/pricing/free-account/" target="_blank">[créer un compte gratuit](https://azure.microsoft.com/free/).</span><span class="sxs-lookup"><span data-stu-id="efcb9-115">If you don't have one yet, you can [activate your MSDN subscriber benefits](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) or <a href="/pricing/free-account/" target="_blank">[sign up for a free account](https://azure.microsoft.com/free/).</span></span>
* <span data-ttu-id="efcb9-116">[Compte Azure Automation](automation-sec-configure-azure-runas-account.md) pour le stockage du Runbook et l’authentification auprès des ressources Azure.</span><span class="sxs-lookup"><span data-stu-id="efcb9-116">[Azure Automation account](automation-sec-configure-azure-runas-account.md) to hold the runbook and authenticate to Azure resources.</span></span>  <span data-ttu-id="efcb9-117">Ce compte doit avoir l’autorisation de démarrer et d’arrêter la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="efcb9-117">This account must have permission to start and stop the virtual machine.</span></span>
* <span data-ttu-id="efcb9-118">Une machine virtuelle Azure.</span><span class="sxs-lookup"><span data-stu-id="efcb9-118">An Azure virtual machine.</span></span>  <span data-ttu-id="efcb9-119">Nous arrêterons et démarrerons cet ordinateur afin qu'il ne soit pas en production.</span><span class="sxs-lookup"><span data-stu-id="efcb9-119">We will stop and start this machine so it should not be production.</span></span>

## <a name="step-1---create-runbook"></a><span data-ttu-id="efcb9-120">Étape 1 - Création d’un Runbook</span><span class="sxs-lookup"><span data-stu-id="efcb9-120">Step 1 - Create runbook</span></span>
<span data-ttu-id="efcb9-121">Nous commençons par créer un Runbook simple qui renvoie le texte *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="efcb9-121">We start by creating a simple runbook that outputs the text *Hello World*.</span></span>

1. <span data-ttu-id="efcb9-122">Dans le portail Azure, ouvrez votre compte Automation.</span><span class="sxs-lookup"><span data-stu-id="efcb9-122">In the Azure portal, open your Automation account.</span></span>  
   <span data-ttu-id="efcb9-123">La page du compte Automation vous offre un aperçu rapide des ressources de ce compte.</span><span class="sxs-lookup"><span data-stu-id="efcb9-123">The Automation account page gives you a quick view of the resources in this account.</span></span>  <span data-ttu-id="efcb9-124">Vous devriez déjà posséder certains éléments multimédias.</span><span class="sxs-lookup"><span data-stu-id="efcb9-124">You should already have some Assets.</span></span>  <span data-ttu-id="efcb9-125">La plupart de ces éléments représentent les modules automatiquement inclus dans un nouveau compte Automation.</span><span class="sxs-lookup"><span data-stu-id="efcb9-125">Most of those are the modules that are automatically included in a new Automation account.</span></span>  <span data-ttu-id="efcb9-126">Vous devriez également disposer de la ressource d’informations d’identification mentionnée dans les [composants requis](#prerequisites).</span><span class="sxs-lookup"><span data-stu-id="efcb9-126">You should also have the Credential asset that's mentioned in the [prerequisites](#prerequisites).</span></span>
2. <span data-ttu-id="efcb9-127">Cliquez sur la vignette **Runbooks** pour ouvrir la liste des runbooks.</span><span class="sxs-lookup"><span data-stu-id="efcb9-127">Click the **Runbooks** tile to open the list of runbooks.</span></span><br> <span data-ttu-id="efcb9-128">![Contrôle des Runbooks](media/automation-first-runbook-graphical/runbooks-resources-tile.png)</span><span class="sxs-lookup"><span data-stu-id="efcb9-128">![Runbooks control](media/automation-first-runbook-graphical/runbooks-resources-tile.png)</span></span>
3. <span data-ttu-id="efcb9-129">Créez un Runbook en cliquant sur le bouton **Ajouter un Runbook** puis**Créer un Runbook**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-129">Create a new runbook by clicking on the **Add a runbook** button and then **Create a new runbook**.</span></span>
4. <span data-ttu-id="efcb9-130">Nommez le Runbook *MyFirstRunbook-Graphical*.</span><span class="sxs-lookup"><span data-stu-id="efcb9-130">Give the runbook the name *MyFirstRunbook-Graphical*.</span></span>
5. <span data-ttu-id="efcb9-131">Dans ce cas précis, nous allons créer un [Runbook graphique](automation-graphical-authoring-intro.md) ; vous devez donc sélectionner **Graphique** dans le champ **Type de Runbook**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-131">In this case, we're going to create a [graphical runbook](automation-graphical-authoring-intro.md) so select **Graphical** for **Runbook type**.</span></span><br> <span data-ttu-id="efcb9-132">![Nouveau Runbook](media/automation-first-runbook-graphical/create-new-runbook.png)</span><span class="sxs-lookup"><span data-stu-id="efcb9-132">![New runbook](media/automation-first-runbook-graphical/create-new-runbook.png)</span></span><br>
6. <span data-ttu-id="efcb9-133">Cliquez sur **Créer** pour créer le Runbook et ouvrez l’éditeur graphique.</span><span class="sxs-lookup"><span data-stu-id="efcb9-133">Click **Create** to create the runbook and open the graphical editor.</span></span>

## <a name="step-2---add-activities-to-the-runbook"></a><span data-ttu-id="efcb9-134">Étape 2 : Ajout d’activités au Runbook</span><span class="sxs-lookup"><span data-stu-id="efcb9-134">Step 2 - Add activities to the runbook</span></span>
<span data-ttu-id="efcb9-135">Le contrôle Bibliothèque à gauche de l’éditeur vous permet de sélectionner des activités à ajouter à votre Runbook.</span><span class="sxs-lookup"><span data-stu-id="efcb9-135">The Library control on the left side of the editor allows you to select activities to add to your runbook.</span></span>  <span data-ttu-id="efcb9-136">Nous allons ajouter une applet de commande **Write-Output** pour extraire du texte du Runbook.</span><span class="sxs-lookup"><span data-stu-id="efcb9-136">We're going to add a **Write-Output** cmdlet to output text from the runbook.</span></span>

1. <span data-ttu-id="efcb9-137">Dans le contrôle Bibliothèque, cliquez dans la zone de recherche et tapez **Write-Output**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-137">In the Library control, click in the search textbox and type **Write-Output**.</span></span>  <span data-ttu-id="efcb9-138">Les résultats de recherche seront affichés ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="efcb9-138">The search results will be displayed below.</span></span> <br> <span data-ttu-id="efcb9-139">![Microsoft.PowerShell.Utility](media/automation-first-runbook-graphical/search-powershell-cmdlet-writeoutput.png)</span><span class="sxs-lookup"><span data-stu-id="efcb9-139">![Microsoft.PowerShell.Utility](media/automation-first-runbook-graphical/search-powershell-cmdlet-writeoutput.png)</span></span>
2. <span data-ttu-id="efcb9-140">Faites défiler jusqu'au bas de la liste.</span><span class="sxs-lookup"><span data-stu-id="efcb9-140">Scroll down to the bottom of the list.</span></span>  <span data-ttu-id="efcb9-141">Vous pouvez cliquer avec le bouton droit sur **Write-Output** et sélectionner **Ajouter au canevas** ou cliquer sur les points de suspension en regard de l’applet de commande, puis sélectionner **Ajouter au canevas**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-141">You can either right-click **Write-Output** and select **Add to canvas** or click the ellipse next to the cmdlet and then select **Add to canvas**.</span></span>
3. <span data-ttu-id="efcb9-142">Cliquez sur l’activité **Write-Output** sur le canevas.</span><span class="sxs-lookup"><span data-stu-id="efcb9-142">Click the **Write-Output** activity on the canvas.</span></span>  <span data-ttu-id="efcb9-143">Le panneau du contrôle Configuration qui vous permet de configurer l’activité s’ouvre.</span><span class="sxs-lookup"><span data-stu-id="efcb9-143">This opens the Configuration control blade, which allows you to configure the activity.</span></span>
4. <span data-ttu-id="efcb9-144">Par défaut, le champ **Étiquette** affiche le nom de l’applet de commande, mais nous pouvons le modifier pour le rendre plus convivial.</span><span class="sxs-lookup"><span data-stu-id="efcb9-144">The **Label** defaults to the name of the cmdlet, but we can change it to something more friendly.</span></span> <span data-ttu-id="efcb9-145">Remplacez-le par *Write Hello World to output*.</span><span class="sxs-lookup"><span data-stu-id="efcb9-145">Change it to *Write Hello World to output*.</span></span>
5. <span data-ttu-id="efcb9-146">Cliquez sur **Paramètres** pour renseigner les paramètres de l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="efcb9-146">Click **Parameters** to provide values for the cmdlet's parameters.</span></span>  
   <span data-ttu-id="efcb9-147">Certaines applets de commande comportent plusieurs jeux de paramètres, et vous devez choisir lequel utiliser.</span><span class="sxs-lookup"><span data-stu-id="efcb9-147">Some cmdlets have multiple parameter sets, and you need to select which you one to use.</span></span> <span data-ttu-id="efcb9-148">Dans ce cas précis, **Write-Output** ne comporte qu’un seul paramètre défini ; vous n’avez donc pas besoin d’en sélectionner un.</span><span class="sxs-lookup"><span data-stu-id="efcb9-148">In this case, **Write-Output** has only one parameter set, so you don't need to select one.</span></span> <br> <span data-ttu-id="efcb9-149">![Propriétés Write-Output](media/automation-first-runbook-graphical/write-output-properties-b.png)</span><span class="sxs-lookup"><span data-stu-id="efcb9-149">![Write-Output properties](media/automation-first-runbook-graphical/write-output-properties-b.png)</span></span>
6. <span data-ttu-id="efcb9-150">Sélectionnez le paramètre **InputObject** .</span><span class="sxs-lookup"><span data-stu-id="efcb9-150">Select the **InputObject** parameter.</span></span>  <span data-ttu-id="efcb9-151">Il s’agit du paramètre où nous spécifions le texte à envoyer au flux de sortie.</span><span class="sxs-lookup"><span data-stu-id="efcb9-151">This is the parameter where we specify the text to send to the output stream.</span></span>
7. <span data-ttu-id="efcb9-152">Dans le menu déroulant **Source de données**, sélectionnez **Expression PowerShell**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-152">In the **Data source** dropdown, select **PowerShell expression**.</span></span>  <span data-ttu-id="efcb9-153">Le menu déroulant **Source de données** fournit différentes sources que vous utilisez pour renseigner un paramètre.</span><span class="sxs-lookup"><span data-stu-id="efcb9-153">The **Data source** dropdown provides different sources that you use to populate a parameter value.</span></span>  
   <span data-ttu-id="efcb9-154">Vous pouvez utiliser la sortie de ces sources, par exemple une autre activité, un élément multimédia Automation ou une expression PowerShell.</span><span class="sxs-lookup"><span data-stu-id="efcb9-154">You can use output from such sources such as another activity, an Automation asset, or a PowerShell expression.</span></span>  <span data-ttu-id="efcb9-155">Dans notre cas, nous voulons simplement extraire le texte *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="efcb9-155">In this case, we just want to output the text *Hello World*.</span></span> <span data-ttu-id="efcb9-156">Nous pouvons utiliser une expression PowerShell et spécifiez une chaîne.</span><span class="sxs-lookup"><span data-stu-id="efcb9-156">We can use a PowerShell expression and specify a string.</span></span>
8. <span data-ttu-id="efcb9-157">Dans le champ **Expression**, tapez *« Hello World »*, puis cliquez deux fois sur **OK** pour revenir au canevas.</span><span class="sxs-lookup"><span data-stu-id="efcb9-157">In the **Expression** box, type *"Hello World"* and then click **OK** twice to return to the canvas.</span></span><br> <span data-ttu-id="efcb9-158">![PowerShell Expression](media/automation-first-runbook-graphical/expression-hello-world.png)</span><span class="sxs-lookup"><span data-stu-id="efcb9-158">![PowerShell Expression](media/automation-first-runbook-graphical/expression-hello-world.png)</span></span>
9. <span data-ttu-id="efcb9-159">Enregistrez le Runbook en cliquant sur **Enregistrer**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-159">Save the runbook by clicking **Save**.</span></span><br> <span data-ttu-id="efcb9-160">![Enregistrer un Runbook](media/automation-first-runbook-graphical/runbook-toolbar-save-revised20165.png)</span><span class="sxs-lookup"><span data-stu-id="efcb9-160">![Save runbook](media/automation-first-runbook-graphical/runbook-toolbar-save-revised20165.png)</span></span>

## <a name="step-3---test-the-runbook"></a><span data-ttu-id="efcb9-161">Étape 3 : Test du Runbook</span><span class="sxs-lookup"><span data-stu-id="efcb9-161">Step 3 - Test the runbook</span></span>
<span data-ttu-id="efcb9-162">Avant publier le Runbook pour le rendre disponible en production, nous voulons le tester pour s’assurer qu'il fonctionne correctement.</span><span class="sxs-lookup"><span data-stu-id="efcb9-162">Before we publish the runbook to make it available in production, we want to test it to make sure that it works properly.</span></span>  <span data-ttu-id="efcb9-163">Lorsque vous testez un Runbook, vous exécutez sa version **Brouillon** et affichez sa sortie de manière interactive.</span><span class="sxs-lookup"><span data-stu-id="efcb9-163">When you test a runbook, you run its **Draft** version and view its output interactively.</span></span>

1. <span data-ttu-id="efcb9-164">Cliquez sur **Panneau de test** pour ouvrir le panneau Test.</span><span class="sxs-lookup"><span data-stu-id="efcb9-164">Click **Test pane** to open the Test blade.</span></span><br> <span data-ttu-id="efcb9-165">![Volet de test](media/automation-first-runbook-graphical/runbook-toolbar-test-revised20165.png)</span><span class="sxs-lookup"><span data-stu-id="efcb9-165">![Test pane](media/automation-first-runbook-graphical/runbook-toolbar-test-revised20165.png)</span></span>
2. <span data-ttu-id="efcb9-166">Cliquez sur **Démarrer** pour démarrer le test.</span><span class="sxs-lookup"><span data-stu-id="efcb9-166">Click **Start** to start the test.</span></span>  <span data-ttu-id="efcb9-167">Ce doit être la seule option activée.</span><span class="sxs-lookup"><span data-stu-id="efcb9-167">This should be the only enabled option.</span></span>
3. <span data-ttu-id="efcb9-168">Une [tâche de Runbook](automation-runbook-execution.md) est créée et son état apparaît dans le volet.</span><span class="sxs-lookup"><span data-stu-id="efcb9-168">A [runbook job](automation-runbook-execution.md) is created and its status displayed in the pane.</span></span>  
   <span data-ttu-id="efcb9-169">L’état initial du travail est *Mis en file d’attente* pour indiquer que la tâche attend qu’un Runbook Worker du cloud devienne disponible.</span><span class="sxs-lookup"><span data-stu-id="efcb9-169">The job status starts as *Queued* indicating that it is waiting for a runbook worker in the cloud to become available.</span></span>  <span data-ttu-id="efcb9-170">La tâche prend ensuite l’état *Démarrage en cours* lorsqu’un Worker sélectionne la tâche, puis l’état *En cours d’exécution* lorsque le Runbook commence à s’exécuter.</span><span class="sxs-lookup"><span data-stu-id="efcb9-170">It then moves to *Starting* when a worker claims the job, and then *Running* when the runbook actually starts running.</span></span>  
4. <span data-ttu-id="efcb9-171">Lorsque la tâche du Runbook est terminée, sa sortie s'affiche.</span><span class="sxs-lookup"><span data-stu-id="efcb9-171">When the runbook job completes, its output is displayed.</span></span> <span data-ttu-id="efcb9-172">Dans notre cas, nous devrions voir *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="efcb9-172">In our case, we should see *Hello World*.</span></span><br> <span data-ttu-id="efcb9-173">![Hello World](media/automation-first-runbook-graphical/runbook-test-results.png)</span><span class="sxs-lookup"><span data-stu-id="efcb9-173">![Hello World](media/automation-first-runbook-graphical/runbook-test-results.png)</span></span>
5. <span data-ttu-id="efcb9-174">Fermez le panneau Test pour revenir au canevas.</span><span class="sxs-lookup"><span data-stu-id="efcb9-174">Close the Test blade to return to the canvas.</span></span>

## <a name="step-4---publish-and-start-the-runbook"></a><span data-ttu-id="efcb9-175">Étape 4 : Publication et démarrage du Runbook</span><span class="sxs-lookup"><span data-stu-id="efcb9-175">Step 4 - Publish and start the runbook</span></span>
<span data-ttu-id="efcb9-176">Le runbook que nous avons créé est toujours en mode brouillon.</span><span class="sxs-lookup"><span data-stu-id="efcb9-176">The runbook that we created is still in Draft mode.</span></span> <span data-ttu-id="efcb9-177">Nous devons le publier pour pouvoir l'exécuter en production.</span><span class="sxs-lookup"><span data-stu-id="efcb9-177">We need to publish it before we can run it in production.</span></span>  <span data-ttu-id="efcb9-178">Lorsque vous publiez un Runbook, vous écrasez la version publiée existante par la version brouillon.</span><span class="sxs-lookup"><span data-stu-id="efcb9-178">When you publish a runbook, you overwrite the existing Published version with the Draft version.</span></span>  <span data-ttu-id="efcb9-179">Dans notre cas, nous n'avons pas encore de version publiée car nous venons de créer le Runbook.</span><span class="sxs-lookup"><span data-stu-id="efcb9-179">In our case, we don't have a Published version yet because we just created the runbook.</span></span>

1. <span data-ttu-id="efcb9-180">Cliquez sur **Publier** pour publier le Runbook, puis sur **Oui** quand vous y êtes invité.</span><span class="sxs-lookup"><span data-stu-id="efcb9-180">Click **Publish** to publish the runbook and then **Yes** when prompted.</span></span><br> <span data-ttu-id="efcb9-181">![Publier](media/automation-first-runbook-graphical/runbook-toolbar-publish-revised20166.png)</span><span class="sxs-lookup"><span data-stu-id="efcb9-181">![Publish](media/automation-first-runbook-graphical/runbook-toolbar-publish-revised20166.png)</span></span>
2. <span data-ttu-id="efcb9-182">Si vous faites défiler la page vers la gauche pour visualiser le panneau **Runbooks**, celui-ci affiche **l’État de création** **Publié**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-182">If you scroll left to view the runbook in the **Runbooks** blade, it shows an **Authoring Status** of **Published**.</span></span>
3. <span data-ttu-id="efcb9-183">Faites défiler la page vers la droite pour visualiser le panneau **MyFirstRunbook**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-183">Scroll back to the right to view the blade for **MyFirstRunbook**.</span></span>  
   <span data-ttu-id="efcb9-184">Les options de la partie supérieure nous permettent de démarrer le Runbook, de planifier son démarrage à un moment ultérieur ou de créer un [Webhook](automation-webhooks.md) afin de le démarrer par le biais d’un appel HTTP.</span><span class="sxs-lookup"><span data-stu-id="efcb9-184">The options across the top allow us to start the runbook, schedule it to start at some time in the future, or create a [webhook](automation-webhooks.md) so it can be started through an HTTP call.</span></span>
4. <span data-ttu-id="efcb9-185">Comme nous voulons simplement démarrer le Runbook, cliquez sur **Démarrer**, puis sur **Oui** quand vous y êtes invité.</span><span class="sxs-lookup"><span data-stu-id="efcb9-185">We just want to start the runbook so click **Start** and then **Yes** when prompted.</span></span><br> <span data-ttu-id="efcb9-186">![Démarrer un Runbook](media/automation-first-runbook-graphical/runbook-controls-start-revised20165.png)</span><span class="sxs-lookup"><span data-stu-id="efcb9-186">![Start runbook](media/automation-first-runbook-graphical/runbook-controls-start-revised20165.png)</span></span>
5. <span data-ttu-id="efcb9-187">Un panneau de tâche est ouvert pour la tâche du Runbook que nous avons créée.</span><span class="sxs-lookup"><span data-stu-id="efcb9-187">A job blade is opened for the runbook job that we created.</span></span>  <span data-ttu-id="efcb9-188">Nous pouvons fermer ce panneau mais, dans ce cas, nous le laissons ouvert afin de suivre la progression de la tâche.</span><span class="sxs-lookup"><span data-stu-id="efcb9-188">We can close this blade, but in this case we leave it open so we can watch the job's progress.</span></span>
6. <span data-ttu-id="efcb9-189">L’état de la tâche est indiqué dans le champ **Résumé de la tâche** et correspond aux états que nous avons constatés lors du test du Runbook.</span><span class="sxs-lookup"><span data-stu-id="efcb9-189">The job status is shown in **Job Summary** and matches the statuses that we saw when we tested the runbook.</span></span><br> <span data-ttu-id="efcb9-190">![Résumé des tâches](media/automation-first-runbook-graphical/runbook-job-summary.png)</span><span class="sxs-lookup"><span data-stu-id="efcb9-190">![Job Summary](media/automation-first-runbook-graphical/runbook-job-summary.png)</span></span>
7. <span data-ttu-id="efcb9-191">Lorsque le Runbook prend l’état *Terminé*, cliquez sur **Sortie**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-191">Once the runbook status shows *Completed*, click **Output**.</span></span> <span data-ttu-id="efcb9-192">Le panneau **Sortie** s’ouvre, affichant *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="efcb9-192">The **Output** blade is opened, and we can see our *Hello World* in the pane.</span></span><br> <span data-ttu-id="efcb9-193">![Résumé des tâches](media/automation-first-runbook-graphical/runbook-job-output.png)</span><span class="sxs-lookup"><span data-stu-id="efcb9-193">![Job Summary](media/automation-first-runbook-graphical/runbook-job-output.png)</span></span>  
8. <span data-ttu-id="efcb9-194">Fermez le panneau Sortie.</span><span class="sxs-lookup"><span data-stu-id="efcb9-194">Close the Output blade.</span></span>
9. <span data-ttu-id="efcb9-195">Cliquez sur **Tous les journaux** pour ouvrir le panneau Flux de la tâche du Runbook.</span><span class="sxs-lookup"><span data-stu-id="efcb9-195">Click **All Logs** to open the Streams blade for the runbook job.</span></span>  <span data-ttu-id="efcb9-196">Seul le message *Hello World* devrait apparaître dans le flux de sortie, mais d’autres flux peuvent s’afficher pour une tâche de Runbook, notamment Mode détaillé et Erreur si le Runbook consigne ces informations.</span><span class="sxs-lookup"><span data-stu-id="efcb9-196">We should only see *Hello World* in the output stream, but this can show other streams for a runbook job such as Verbose and Error if the runbook writes to them.</span></span><br> <span data-ttu-id="efcb9-197">![Résumé des tâches](media/automation-first-runbook-graphical/runbook-job-AllLogs.png)</span><span class="sxs-lookup"><span data-stu-id="efcb9-197">![Job Summary](media/automation-first-runbook-graphical/runbook-job-AllLogs.png)</span></span>
10. <span data-ttu-id="efcb9-198">Fermez le panneau Tous les journaux et le panneau Tâche pour revenir au panneau MyFirstRunbook.</span><span class="sxs-lookup"><span data-stu-id="efcb9-198">Close the All Logs blade and the Job blade to return to the MyFirstRunbook blade.</span></span>
11. <span data-ttu-id="efcb9-199">Cliquez sur **Tâches** pour ouvrir le panneau Tâches de ce Runbook.</span><span class="sxs-lookup"><span data-stu-id="efcb9-199">Click **Jobs** to open the Jobs blade for this runbook.</span></span>  <span data-ttu-id="efcb9-200">Il répertorie toutes les tâches créées par ce Runbook.</span><span class="sxs-lookup"><span data-stu-id="efcb9-200">This lists all the jobs created by this runbook.</span></span> <span data-ttu-id="efcb9-201">Une seule tâche doit apparaître, car nous n’avons exécuté la tâche qu’une seule fois.</span><span class="sxs-lookup"><span data-stu-id="efcb9-201">We should only see one job listed since we only ran the job once.</span></span><br> <span data-ttu-id="efcb9-202">![Travaux](media/automation-first-runbook-graphical/runbook-control-jobs.png)</span><span class="sxs-lookup"><span data-stu-id="efcb9-202">![Jobs](media/automation-first-runbook-graphical/runbook-control-jobs.png)</span></span>
12. <span data-ttu-id="efcb9-203">Vous pouvez cliquer sur ce travail pour ouvrir le même volet du travail que nous avons consulté au démarrage du runbook.</span><span class="sxs-lookup"><span data-stu-id="efcb9-203">You can click this job to open the same Job pane that we viewed when we started the runbook.</span></span>  <span data-ttu-id="efcb9-204">Cela vous permet de revenir en arrière et d’afficher les détails de toute tâche créée pour un Runbook donné.</span><span class="sxs-lookup"><span data-stu-id="efcb9-204">This allows you to go back in time and view the details of any job that was created for a particular runbook.</span></span>

## <a name="step-5---create-variable-assets"></a><span data-ttu-id="efcb9-205">Étape 5 - Créer des ressources de variables</span><span class="sxs-lookup"><span data-stu-id="efcb9-205">Step 5 - Create variable assets</span></span>
<span data-ttu-id="efcb9-206">Nous avons testé et publié notre Runbook, mais jusqu'à présent, il ne fait rien d'utile.</span><span class="sxs-lookup"><span data-stu-id="efcb9-206">We've tested and published our runbook, but so far it doesn't do anything useful.</span></span> <span data-ttu-id="efcb9-207">Nous voulons qu’il gère les ressources Azure.</span><span class="sxs-lookup"><span data-stu-id="efcb9-207">We want to have it manage Azure resources.</span></span>  <span data-ttu-id="efcb9-208">Avant de configurer le Runbook pour l’authentification, nous créons une variable qui contiendra l’ID d’abonnement. Nous la référencerons après avoir configuré l’authentification à l’étape 6 ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="efcb9-208">Before we configure the runbook to authenticate, we  create a variable to hold the subscription ID and reference it after we set up the activity to authenticate in step 6 below.</span></span>  <span data-ttu-id="efcb9-209">L’ajout d’une référence au contexte de l’abonnement vous permet de gérer facilement plusieurs abonnements.</span><span class="sxs-lookup"><span data-stu-id="efcb9-209">Including a reference to the subscription context allows you to easily work between multiple subscriptions.</span></span>  <span data-ttu-id="efcb9-210">Avant de poursuivre, copiez votre ID d’abonnement depuis l’option Abonnements du panneau de navigation.</span><span class="sxs-lookup"><span data-stu-id="efcb9-210">Before proceeding, copy your subscription ID from the Subscriptions option off the Navigation pane.</span></span>  

1. <span data-ttu-id="efcb9-211">Dans le panneau Comptes Automation, cliquez sur la vignette **Ressources**. Le panneau **Ressources** s’ouvre.</span><span class="sxs-lookup"><span data-stu-id="efcb9-211">In the Automation Accounts blade, click the **Assets** tile and the **Assets** blade is opened.</span></span>
2. <span data-ttu-id="efcb9-212">Dans le panneau Ressources, cliquez sur la vignette **Variables** .</span><span class="sxs-lookup"><span data-stu-id="efcb9-212">In the Assets blade, click the **Variables** tile.</span></span>
3. <span data-ttu-id="efcb9-213">Dans le panneau Variables, cliquez sur **Ajouter une variable**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-213">On the Variables blade, click **Add a variable**.</span></span><br><span data-ttu-id="efcb9-214">![Variable Automation](media/automation-first-runbook-graphical/create-new-subscriptionid-variable.png)</span><span class="sxs-lookup"><span data-stu-id="efcb9-214">![Automation Variable](media/automation-first-runbook-graphical/create-new-subscriptionid-variable.png)</span></span>
4. <span data-ttu-id="efcb9-215">Dans la zone **Nom** du panneau Nouvelle variable, entrez **AzureSubscriptionId**, puis dans la zone **Valeur**, entrez votre ID d’abonnement.</span><span class="sxs-lookup"><span data-stu-id="efcb9-215">In the New variable blade, in the **Name** box, enter **AzureSubscriptionId** and in the **Value** box enter your Subscription ID.</span></span>  <span data-ttu-id="efcb9-216">Conservez la sélection *chaîne* pour **Type** et la valeur par défaut pour le **chiffrement**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-216">Keep *string* for the **Type** and the default value for **Encryption**.</span></span>  
5. <span data-ttu-id="efcb9-217">Cliquez sur **Créer** pour créer la variable.</span><span class="sxs-lookup"><span data-stu-id="efcb9-217">Click **Create** to create the variable.</span></span>  

## <a name="step-6---add-authentication-to-manage-azure-resources"></a><span data-ttu-id="efcb9-218">Étape 6 - Ajouter une authentification pour gérer les ressources Azure</span><span class="sxs-lookup"><span data-stu-id="efcb9-218">Step 6 - Add authentication to manage Azure resources</span></span>
<span data-ttu-id="efcb9-219">Maintenant que nous disposons d’une variable pour contenir l’ID d’abonnement, nous pouvons configurer le Runbook pour l’authentification à l’aide des informations d’identification mentionnées dans les [conditions préalables](#prerequisites).</span><span class="sxs-lookup"><span data-stu-id="efcb9-219">Now that we have a variable to hold our subscription ID, we can configure our runbook to authenticate with the Run As credentials that are referred to in the [prerequisites](#prerequisites).</span></span>  <span data-ttu-id="efcb9-220">Il suffit pour cela d’ajouter au canevas la **Ressource** de connexion Azure et l’applet de commande **Add-AzureRMAccount**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-220">We do that by adding the Azure Run As connection **Asset** and **Add-AzureRMAccount** cmdlet to the canvas.</span></span>  

1. <span data-ttu-id="efcb9-221">Ouvrez l’éditeur graphique en cliquant sur **Modifier** dans le panneau MyFirstRunbook.</span><span class="sxs-lookup"><span data-stu-id="efcb9-221">Open the graphical editor by clicking **Edit** on the MyFirstRunbook blade.</span></span><br> <span data-ttu-id="efcb9-222">![Modifier un Runbook](media/automation-first-runbook-graphical/runbook-controls-edit-revised20165.png)</span><span class="sxs-lookup"><span data-stu-id="efcb9-222">![Edit runbook](media/automation-first-runbook-graphical/runbook-controls-edit-revised20165.png)</span></span>
2. <span data-ttu-id="efcb9-223">Étant donné que **Write Hello World to output** ne nous est plus utile, cliquez dessus avec le bouton droit et sélectionnez **Supprimer**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-223">We don't need the **Write Hello World to output** anymore, so right-click it and select **Delete**.</span></span>
3. <span data-ttu-id="efcb9-224">Dans la bibliothèque, développez **Connexions** et ajoutez **AzureRunAsConnection** au canevas en sélectionnant **Ajouter au canevas**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-224">In the Library control, expand **Connections** and add **AzureRunAsConnection** to the canvas by selecting **Add to canvas**.</span></span>
4. <span data-ttu-id="efcb9-225">Dans le canevas, sélectionnez **AzureRunAsConnection**, puis dans le panneau de contrôle Configuration, tapez **Get Run As Connection** (Obtenir une connexion d’identification) dans la zone de texte **Étiquette**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-225">On the canvas, select **AzureRunAsConnection** and in the Configuration control pane, type **Get Run As Connection** in the **Label** textbox.</span></span>  <span data-ttu-id="efcb9-226">Il s’agit de la connexion.</span><span class="sxs-lookup"><span data-stu-id="efcb9-226">This is the connection</span></span>
5. <span data-ttu-id="efcb9-227">Dans la commande Bibliothèque, tapez **Add-AzureRmAccount** dans la zone de recherche.</span><span class="sxs-lookup"><span data-stu-id="efcb9-227">In the Library control, type **Add-AzureRmAccount** in the search textbox.</span></span>
6. <span data-ttu-id="efcb9-228">Ajoutez **Ajoutez-AzureRmAccount** au canevas.</span><span class="sxs-lookup"><span data-stu-id="efcb9-228">Add **Add-AzureRmAccount** to the canvas.</span></span><br> <span data-ttu-id="efcb9-229">![Add-AzureRMAccount](media/automation-first-runbook-graphical/search-powershell-cmdlet-addazurermaccount.png)</span><span class="sxs-lookup"><span data-stu-id="efcb9-229">![Add-AzureRMAccount](media/automation-first-runbook-graphical/search-powershell-cmdlet-addazurermaccount.png)</span></span>
7. <span data-ttu-id="efcb9-230">Pointez sur **Get Run As Connection** (Obtenir une connexion d’identification) jusqu’à ce qu’un cercle apparaisse au bas de la forme.</span><span class="sxs-lookup"><span data-stu-id="efcb9-230">Hover over **Get Run As Connection** until a circle appears on the bottom of the shape.</span></span> <span data-ttu-id="efcb9-231">Cliquez sur le cercle et faites glisser la flèche vers **Add-AzureRmAccount**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-231">Click the circle and drag the arrow to **Add-AzureRmAccount**.</span></span>  <span data-ttu-id="efcb9-232">La flèche que vous avez créée est un *lien*.</span><span class="sxs-lookup"><span data-stu-id="efcb9-232">The arrow that you created is a *link*.</span></span>  <span data-ttu-id="efcb9-233">Le runbook démarre avec **Get Run As Connection**. Exécutez **Add-AzureRmAccount**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-233">The runbook starts with **Get Run As Connection** and then run **Add-AzureRmAccount**.</span></span><br> <span data-ttu-id="efcb9-234">![Créer un lien entre des activités](media/automation-first-runbook-graphical/runbook-link-auth-activities.png)</span><span class="sxs-lookup"><span data-stu-id="efcb9-234">![Create link between activities](media/automation-first-runbook-graphical/runbook-link-auth-activities.png)</span></span>
8. <span data-ttu-id="efcb9-235">Dans le canevas, sélectionnez **Add-AzureRmAccount** et le type de panneau de contrôle Configuration **Login to Azure** (Connexion à Azure) dans la zone de texte **Étiquette**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-235">On the canvas, select **Add-AzureRmAccount** and in the Configuration control pane type **Login to Azure** in the **Label** textbox.</span></span>
9. <span data-ttu-id="efcb9-236">Cliquez sur **Paramètres** pour afficher le panneau Configuration des paramètres d’activité.</span><span class="sxs-lookup"><span data-stu-id="efcb9-236">Click **Parameters** and the Activity Parameter Configuration blade appears.</span></span>
10. <span data-ttu-id="efcb9-237">**Add-AzureRmAccount** comporte plusieurs jeux de paramètres et vous devez donc en sélectionner un pour fournir les valeurs de paramètre.</span><span class="sxs-lookup"><span data-stu-id="efcb9-237">**Add-AzureRmAccount** has multiple parameter sets, so we need to select one before we can provide parameter values.</span></span>  <span data-ttu-id="efcb9-238">Cliquez sur **Jeu de paramètres**, puis sélectionnez le jeu de paramètres **ServicePrincipalCertificatewithSubscriptionId**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-238">Click **Parameter Set** and then select the **ServicePrincipalCertificatewithSubscriptionId** parameter set.</span></span>
11. <span data-ttu-id="efcb9-239">Une fois que vous sélectionnez le jeu de paramètres, les paramètres apparaissent dans le panneau Configuration des paramètres d’activité.</span><span class="sxs-lookup"><span data-stu-id="efcb9-239">Once you select the parameter set, the parameters are displayed in the Activity Parameter Configuration blade.</span></span>  <span data-ttu-id="efcb9-240">Cliquez sur **APPLICATIONID**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-240">Click **APPLICATIONID**.</span></span><br> <span data-ttu-id="efcb9-241">![Ajouter des paramètres de compte Azure RM](media/automation-first-runbook-graphical/add-azurermaccount-params.png)</span><span class="sxs-lookup"><span data-stu-id="efcb9-241">![Add Azure RM account parameters](media/automation-first-runbook-graphical/add-azurermaccount-params.png)</span></span>
12. <span data-ttu-id="efcb9-242">Dans le panneau Valeur du paramètre, sélectionnez **Sortie d’activité** pour **Source de données** et sélectionnez **Get Run As Connection** (Obtenir une connexion d’identification) dans la liste. Puis, dans la zone de texte **Chemin du champ**, saisissez **ApplicationId** et cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-242">In the Parameter Value blade, select **Activity output** for the **Data source** and select **Get Run As Connection** from the list, in the **Field path** textbox type **ApplicationId**, and then click **OK**.</span></span>  <span data-ttu-id="efcb9-243">Nous allons spécifier le nom de la propriété du chemin du champ car l’activité génère un objet contenant plusieurs propriétés.</span><span class="sxs-lookup"><span data-stu-id="efcb9-243">We are specifying the name of the property for the Field path because the activity outputs an object with multiple properties.</span></span>
13. <span data-ttu-id="efcb9-244">Cliquez sur **CERTIFICATETHUMBPRINT** puis, dans le panneau Valeur du paramètre, sélectionnez **Sortie de l’activité** comme **Source de données**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-244">Click **CERTIFICATETHUMBPRINT**, and in the Parameter Value blade, select **Activity output** for the **Data source**.</span></span>  <span data-ttu-id="efcb9-245">Sélectionnez **Get Run As Connection** (Obtenir une connexion d’identification) dans la liste, puis, dans la zone de texte **Chemin du champ**, entrez **CertificateThumbprint** et cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-245">Select **Get Run As Connection** from the list, in the **Field path** textbox type **CertificateThumbprint**, and then click **OK**.</span></span>
14. <span data-ttu-id="efcb9-246">Cliquez sur **SERVICEPRINCIPALNAME** puis, dans le panneau Valeur du paramètre, sélectionnez **ConstantValue** comme **source de données**, cliquez sur l’option **True**, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-246">Click **SERVICEPRINCIPAL**, and in the Parameter Value blade, select **ConstantValue** for the **Data source**, click the option **True**, and then click **OK**.</span></span>
15. <span data-ttu-id="efcb9-247">Cliquez sur **TENANTID** puis, dans le panneau Valeur du paramètre, sélectionnez **Sortie de l’activité** comme **Source de données**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-247">Click **TENANTID**, and in the Parameter Value blade, select **Activity output** for the **Data source**.</span></span>  <span data-ttu-id="efcb9-248">Sélectionnez **Get Run As Connection** (Obtenir une connexion d’identification) dans la liste, puis, dans la zone de texte **Chemin du champ**, entrez **TenantId** et cliquez deux fois sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-248">Select **Get Run As Connection** from the list, in the **Field path** textbox type **TenantId**, and then click **OK** twice.</span></span>  
16. <span data-ttu-id="efcb9-249">Dans la commande Bibliothèque, tapez **Set-AzureRmContext** dans la zone de recherche.</span><span class="sxs-lookup"><span data-stu-id="efcb9-249">In the Library control, type **Set-AzureRmContext** in the search textbox.</span></span>
17. <span data-ttu-id="efcb9-250">Ajoutez **Set-AzureRmContext** au canevas.</span><span class="sxs-lookup"><span data-stu-id="efcb9-250">Add **Set-AzureRmContext** to the canvas.</span></span>
18. <span data-ttu-id="efcb9-251">Dans le canevas, sélectionnez **Set-AzureRmContext**, puis dans le panneau de contrôle Configuration, tapez **Specify Subscription Id** (Spécifier un ID d’abonnement) dans la zone de texte **Étiquette**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-251">On the canvas, select **Set-AzureRmContext** and in the Configuration control pane type **Specify Subscription Id** in the **Label** textbox.</span></span>
19. <span data-ttu-id="efcb9-252">Cliquez sur **Paramètres** pour afficher le panneau Configuration des paramètres d’activité.</span><span class="sxs-lookup"><span data-stu-id="efcb9-252">Click **Parameters** and the Activity Parameter Configuration blade appears.</span></span>
20. <span data-ttu-id="efcb9-253">**Set-AzureRmContext** comporte plusieurs jeux de paramètres et vous devez donc en sélectionner un pour fournir les valeurs de paramètre.</span><span class="sxs-lookup"><span data-stu-id="efcb9-253">**Set-AzureRmContext** has multiple parameter sets, so we need to select one before we can provide parameter values.</span></span>  <span data-ttu-id="efcb9-254">Cliquez sur **Jeu de paramètres**, puis sélectionnez le jeu de paramètres **SubscriptionId**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-254">Click **Parameter Set** and then select the **SubscriptionId** parameter set.</span></span>  
21. <span data-ttu-id="efcb9-255">Une fois que vous sélectionnez le jeu de paramètres, les paramètres apparaissent dans le panneau Configuration des paramètres d’activité.</span><span class="sxs-lookup"><span data-stu-id="efcb9-255">Once you select the parameter set, the parameters are displayed in the Activity Parameter Configuration blade.</span></span>  <span data-ttu-id="efcb9-256">Cliquez sur **SubscriptionID**</span><span class="sxs-lookup"><span data-stu-id="efcb9-256">Click **SubscriptionID**</span></span>
22. <span data-ttu-id="efcb9-257">Dans le panneau Valeur du paramètre, sélectionnez **Ressource de variable** comme **Source de données** et sélectionnez **AzureSubscriptionId** dans la liste, puis cliquez à deux reprises sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-257">In the Parameter Value blade, select **Variable Asset** for the **Data source** and select **AzureSubscriptionId** from the list and then click **OK** twice.</span></span>   
23. <span data-ttu-id="efcb9-258">Pointez sur **Login to Azure** (Connexion à Azure) jusqu’à ce qu’un cercle apparaisse au bas de la forme.</span><span class="sxs-lookup"><span data-stu-id="efcb9-258">Hover over **Login to Azure** until a circle appears on the bottom of the shape.</span></span> <span data-ttu-id="efcb9-259">Cliquez sur le cercle et faites glisser la flèche vers **Specify Subscription Id**(Spécifier un ID d’abonnement).</span><span class="sxs-lookup"><span data-stu-id="efcb9-259">Click the circle and drag the arrow to **Specify Subscription Id**.</span></span>

<span data-ttu-id="efcb9-260">À ce stade, votre Runbook doit ressembler à ce qui suit : </span><span class="sxs-lookup"><span data-stu-id="efcb9-260">Your runbook should look like the following at this point:</span></span> <br>![Configuration de l’authentification de runbook](media/automation-first-runbook-graphical/runbook-auth-config.png)

## <a name="step-7---add-activity-to-start-a-virtual-machine"></a><span data-ttu-id="efcb9-262">Étape 7 - Ajouter une activité pour démarrer une machine virtuelle</span><span class="sxs-lookup"><span data-stu-id="efcb9-262">Step 7 - Add activity to start a virtual machine</span></span>
<span data-ttu-id="efcb9-263">Nous ajoutons maintenant une activité **Start-AzureRmVM** pour démarrer une machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="efcb9-263">Here we add a **Start-AzureRmVM** activity to start a virtual machine.</span></span>  <span data-ttu-id="efcb9-264">Vous pouvez choisir n’importe quelle machine virtuelle dans votre abonnement Azure, et pour l’instant, coder ce nom dans l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="efcb9-264">You can pick any virtual machine in your Azure subscription, and for now you hardcode that name into the cmdlet.</span></span>

1. <span data-ttu-id="efcb9-265">Dans la commande Bibliothèque, tapez **Start-AzureRm** dans la zone de recherche.</span><span class="sxs-lookup"><span data-stu-id="efcb9-265">In the Library control, type **Start-AzureRm** in the search textbox.</span></span>
2. <span data-ttu-id="efcb9-266">Ajoutez **Start-AzureRmVM** au canevas, puis faites-le glisser sous **Specify Subscription Id** (Spécifier un ID d’abonnement).</span><span class="sxs-lookup"><span data-stu-id="efcb9-266">Add **Start-AzureRmVM** to the canvas and then click and drag it underneath **Specify Subscription Id**.</span></span>
3. <span data-ttu-id="efcb9-267">Pointez sur **Specify Subscription Id** (Spécifier un ID d’abonnement) jusqu’à ce qu’un cercle apparaisse au bas de la forme.</span><span class="sxs-lookup"><span data-stu-id="efcb9-267">Hover over **Specify Subscription Id** until a circle appears on the bottom of the shape.</span></span>  <span data-ttu-id="efcb9-268">Cliquez sur le cercle et faites glisser la flèche vers **Start-AzureRmVM**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-268">Click the circle and drag the arrow to **Start-AzureRmVM**.</span></span>
4. <span data-ttu-id="efcb9-269">Sélectionnez **Start-AzureRmVM**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-269">Select **Start-AzureRmVM**.</span></span>  <span data-ttu-id="efcb9-270">Cliquez sur **Paramètres**, puis sur **Jeu de paramètres** afin d’afficher les jeux pour **Start-AzureRmVM**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-270">Click **Parameters** and then **Parameter Set** to view the sets for **Start-AzureRmVM**.</span></span>  <span data-ttu-id="efcb9-271">Sélectionnez le jeu de paramètres **ResourceGroupNameParameterSetName** .</span><span class="sxs-lookup"><span data-stu-id="efcb9-271">Select the **ResourceGroupNameParameterSetName** parameter set.</span></span> <span data-ttu-id="efcb9-272">Notez que des points d’exclamation apparaissent en regard des paramètres **ResourceGroupName** et **Name**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-272">Note that **ResourceGroupName** and **Name** have exclamation points next them.</span></span>  <span data-ttu-id="efcb9-273">Ils indiquent que ces paramètres sont obligatoires.</span><span class="sxs-lookup"><span data-stu-id="efcb9-273">This indicates that they are required parameters.</span></span>  <span data-ttu-id="efcb9-274">Notez également que les deux attendent des valeurs de chaîne.</span><span class="sxs-lookup"><span data-stu-id="efcb9-274">Also note both expect string values.</span></span>
5. <span data-ttu-id="efcb9-275">Sélectionnez **Name**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-275">Select **Name**.</span></span>  <span data-ttu-id="efcb9-276">Sélectionnez **Expression PowerShell** pour **Source de données** et tapez entre guillemets doubles le nom de la machine virtuelle que nous démarrons avec ce Runbook.</span><span class="sxs-lookup"><span data-stu-id="efcb9-276">Select **PowerShell expression** for the **Data source** and type in the name of the virtual machine surrounded with double quotes that we start with this runbook.</span></span>  <span data-ttu-id="efcb9-277">Cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-277">Click **OK**.</span></span><br><span data-ttu-id="efcb9-278">![Valeur du paramètre Name Start-AzureRmVM](media/automation-first-runbook-graphical/runbook-startvm-nameparameter.png)</span><span class="sxs-lookup"><span data-stu-id="efcb9-278">![Start-AzureRmVM Name Parameter Value](media/automation-first-runbook-graphical/runbook-startvm-nameparameter.png)</span></span>
6. <span data-ttu-id="efcb9-279">Sélectionnez **ResourceGroupName**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-279">Select **ResourceGroupName**.</span></span> <span data-ttu-id="efcb9-280">Utilisez **Expression PowerShell** pour **Source de données** et tapez le nom du groupe de ressources entre guillemets doubles.</span><span class="sxs-lookup"><span data-stu-id="efcb9-280">Use **PowerShell expression** for the **Data source** and type in the name of the resource group surrounded with double quotes.</span></span>  <span data-ttu-id="efcb9-281">Cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-281">Click **OK**.</span></span><br> <span data-ttu-id="efcb9-282">![Paramètres Start-AzureRmVM](media/automation-first-runbook-graphical/startazurermvm-params.png)</span><span class="sxs-lookup"><span data-stu-id="efcb9-282">![Start-AzureRmVM Parameters](media/automation-first-runbook-graphical/startazurermvm-params.png)</span></span>
7. <span data-ttu-id="efcb9-283">Cliquez sur le volet de test afin de tester le Runbook.</span><span class="sxs-lookup"><span data-stu-id="efcb9-283">Click Test pane so that we can test the runbook.</span></span>
8. <span data-ttu-id="efcb9-284">Cliquez sur **Démarrer** pour démarrer le test.</span><span class="sxs-lookup"><span data-stu-id="efcb9-284">Click **Start** to start the test.</span></span>  <span data-ttu-id="efcb9-285">Une fois le test terminé, vérifiez que la machine virtuelle a démarré.</span><span class="sxs-lookup"><span data-stu-id="efcb9-285">Once it completes, check that the virtual machine was started.</span></span>

<span data-ttu-id="efcb9-286">À ce stade, votre Runbook doit ressembler à ce qui suit : </span><span class="sxs-lookup"><span data-stu-id="efcb9-286">Your runbook should look like the following at this point:</span></span> <br>![Configuration de l’authentification de runbook](media/automation-first-runbook-graphical/runbook-startvm.png)

## <a name="step-8---add-additional-input-parameters-to-the-runbook"></a><span data-ttu-id="efcb9-288">Étape 8 - Ajouter des paramètres d’entrée supplémentaires au Runbook</span><span class="sxs-lookup"><span data-stu-id="efcb9-288">Step 8 - Add additional input parameters to the runbook</span></span>
<span data-ttu-id="efcb9-289">Notre runbook démarre actuellement la machine virtuelle dans le groupe de ressources que nous avons spécifié dans l’applet de commande **AzureRmVM-Start**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-289">Our runbook currently starts the virtual machine in the resource group that we specified in the **Start-AzureRmVM** cmdlet.</span></span>  <span data-ttu-id="efcb9-290">Il serait plus utile si nous pouvions spécifier ces deux éléments au démarrage du runbook.</span><span class="sxs-lookup"><span data-stu-id="efcb9-290">Our runbook would be more useful if we could specify both when the runbook is started.</span></span>  <span data-ttu-id="efcb9-291">Nous allons à présent ajouter des paramètres d’entrée au Runbook pour fournir cette fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="efcb9-291">We now add input parameters to the runbook to provide that functionality.</span></span>

1. <span data-ttu-id="efcb9-292">Ouvrez l’éditeur graphique en cliquant sur **Modifier** dans le volet **MyFirstRunbook**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-292">Open the graphical editor by clicking **Edit** on the **MyFirstRunbook** pane.</span></span>
2. <span data-ttu-id="efcb9-293">Cliquez sur **Entrée et sortie**, puis sur **Ajouter une entrée** pour ouvrir le volet Paramètre d’entrée de Runbook.</span><span class="sxs-lookup"><span data-stu-id="efcb9-293">Click **Input and output** and then **Add input** to open the Runbook Input Parameter pane.</span></span><br> <span data-ttu-id="efcb9-294">![Entrée et sortie de Runbook](media/automation-first-runbook-graphical/runbook-toolbar-InputandOutput-revised20165.png)</span><span class="sxs-lookup"><span data-stu-id="efcb9-294">![Runbook Input and Output](media/automation-first-runbook-graphical/runbook-toolbar-InputandOutput-revised20165.png)</span></span>
3. <span data-ttu-id="efcb9-295">Spécifiez *VMName* dans le champ **Nom**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-295">Specify *VMName* for the **Name**.</span></span>  <span data-ttu-id="efcb9-296">Conservez la sélection *chaîne* pour le champ **Type**, mais définissez la valeur **Obligatoire** sur *Oui*.</span><span class="sxs-lookup"><span data-stu-id="efcb9-296">Keep *string* for the **Type**, but change **Mandatory** to *Yes*.</span></span>  <span data-ttu-id="efcb9-297">Cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-297">Click **OK**.</span></span>
4. <span data-ttu-id="efcb9-298">Créez un second paramètre d’entrée obligatoire appelé *ResourceGroupName*, puis cliquez sur **OK** pour fermer le panneau **Entrée et sortie**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-298">Create a second mandatory input parameter called *ResourceGroupName* and then click **OK** to close the **Input and Output** pane.</span></span><br> <span data-ttu-id="efcb9-299">![Paramètres d'entrée de Runbook](media/automation-first-runbook-graphical/start-azurermvm-params-outputs.png)</span><span class="sxs-lookup"><span data-stu-id="efcb9-299">![Runbook Input Parameters](media/automation-first-runbook-graphical/start-azurermvm-params-outputs.png)</span></span>
5. <span data-ttu-id="efcb9-300">Sélectionnez l’activité **Start-AzureRmVM**, puis cliquez sur **Paramètres**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-300">Select the **Start-AzureRmVM** activity and then click **Parameters**.</span></span>
6. <span data-ttu-id="efcb9-301">Changez la **Source de données** de **Name** en **Entrée de Runbook**, puis sélectionnez **VMName**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-301">Change the **Data source** for **Name** to **Runbook input** and then select **VMName**.</span></span><br>
7. <span data-ttu-id="efcb9-302">Changez la **Source de données** de **ResourceGroupName** en **Entrée de Runbook**, puis sélectionnez **ResourceGroupName**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-302">Change the **Data source** for **ResourceGroupName** to **Runbook input** and then select **ResourceGroupName**.</span></span><br> <span data-ttu-id="efcb9-303">![Paramètres Start-AzureVM](media/automation-first-runbook-graphical/start-azurermvm-params-runbookinput.png)</span><span class="sxs-lookup"><span data-stu-id="efcb9-303">![Start-AzureVM Parameters](media/automation-first-runbook-graphical/start-azurermvm-params-runbookinput.png)</span></span>
8. <span data-ttu-id="efcb9-304">Enregistrez le Runbook et ouvrez le volet de test.</span><span class="sxs-lookup"><span data-stu-id="efcb9-304">Save the runbook and open the Test pane.</span></span>  <span data-ttu-id="efcb9-305">Notez que vous pouvez désormais fournir des valeurs pour les deux variables d’entrée que vous utilisez dans le test.</span><span class="sxs-lookup"><span data-stu-id="efcb9-305">Note that you can now provide values for the two input variables that you use in the test.</span></span>
9. <span data-ttu-id="efcb9-306">Fermez le volet de test.</span><span class="sxs-lookup"><span data-stu-id="efcb9-306">Close the Test pane.</span></span>
10. <span data-ttu-id="efcb9-307">Cliquez sur **Publier** pour publier la nouvelle version du Runbook.</span><span class="sxs-lookup"><span data-stu-id="efcb9-307">Click **Publish** to publish the new version of the runbook.</span></span>
11. <span data-ttu-id="efcb9-308">Arrêtez la machine virtuelle que vous avez démarrée à l'étape précédente.</span><span class="sxs-lookup"><span data-stu-id="efcb9-308">Stop the virtual machine that you started in the previous step.</span></span>
12. <span data-ttu-id="efcb9-309">Cliquez sur **Démarrer** pour démarrer le Runbook.</span><span class="sxs-lookup"><span data-stu-id="efcb9-309">Click **Start** to start the runbook.</span></span>  <span data-ttu-id="efcb9-310">Tapez les valeurs **VMName** et **ResourceGroupName** pour la machine virtuelle que vous allez démarrer.</span><span class="sxs-lookup"><span data-stu-id="efcb9-310">Type in the **VMName** and **ResourceGroupName** for the virtual machine that you're going to start.</span></span><br> <span data-ttu-id="efcb9-311">![Start Runbook](media/automation-first-runbook-graphical/runbook-start-inputparams.png)</span><span class="sxs-lookup"><span data-stu-id="efcb9-311">![Start Runbook](media/automation-first-runbook-graphical/runbook-start-inputparams.png)</span></span>
13. <span data-ttu-id="efcb9-312">Une fois le Runbook terminé, vérifiez que la machine virtuelle a démarré.</span><span class="sxs-lookup"><span data-stu-id="efcb9-312">When the runbook completes, check that the virtual machine was started.</span></span>

## <a name="step-9---create-a-conditional-link"></a><span data-ttu-id="efcb9-313">Étape 9 - Création d’un lien conditionnel</span><span class="sxs-lookup"><span data-stu-id="efcb9-313">Step 9 - Create a conditional link</span></span>
<span data-ttu-id="efcb9-314">Nous modifions maintenant le Runbook afin qu’il tente de démarrer la machine virtuelle uniquement si elle n’est pas déjà démarrée.</span><span class="sxs-lookup"><span data-stu-id="efcb9-314">We now modify the runbook so that it only attempts to start the virtual machine if it is not already started.</span></span>  <span data-ttu-id="efcb9-315">Pour cela, vous ajoutez au Runbook une applet de commande **Get-AzureRmVM** qui obtient l’état du niveau d’instance de la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="efcb9-315">You do this by adding a **Get-AzureRmVM** cmdlet to the runbook that gets the instance level status of the virtual machine.</span></span> <span data-ttu-id="efcb9-316">Ensuite, vous ajoutez un module de code Workflow PowerShell appelé **Obtenir l’état** à un extrait de code PowerShell pour déterminer si l’état de la machine virtuelle est en cours d’exécution ou arrêté.</span><span class="sxs-lookup"><span data-stu-id="efcb9-316">Then you add a PowerShell Workflow code module called **Get Status** with a snippet of PowerShell code to determine if the virtual machine state is running or stopped.</span></span>  <span data-ttu-id="efcb9-317">Un lien conditionnel à partir du module **Obtenir l’état** exécute **Start-AzureRmVM** seulement si l’état d’exécution en cours est arrêté.</span><span class="sxs-lookup"><span data-stu-id="efcb9-317">A conditional link from the **Get Status** module only runs **Start-AzureRmVM** if the current running state is stopped.</span></span>  <span data-ttu-id="efcb9-318">Enfin, nous générons un message vous informant si la machine virtuelle a été démarrée avec succès ou non à l’aide de l’applet de commande PowerShell Write-Output.</span><span class="sxs-lookup"><span data-stu-id="efcb9-318">Finally, we output a message to inform you if the VM was successfully started or not using the PowerShell Write-Output cmdlet.</span></span>

1. <span data-ttu-id="efcb9-319">Ouvrez **MyFirstRunbook** dans l’éditeur graphique.</span><span class="sxs-lookup"><span data-stu-id="efcb9-319">Open **MyFirstRunbook** in the graphical editor.</span></span>
2. <span data-ttu-id="efcb9-320">Supprimez le lien entre **Specify Subscription Id** (Spécifier un ID d’abonnement) et **Start-AzureRmVM** en cliquant dessus, puis en appuyant sur la touche *Supprimer*.</span><span class="sxs-lookup"><span data-stu-id="efcb9-320">Remove the link between **Specify Subscription Id** and **Start-AzureRmVM** by clicking on it and then pressing the *Delete* key.</span></span>
3. <span data-ttu-id="efcb9-321">Dans la commande Bibliothèque, tapez **Get-AzureRm** dans la zone de recherche.</span><span class="sxs-lookup"><span data-stu-id="efcb9-321">In the Library control, type **Get-AzureRm** in the search textbox.</span></span>
4. <span data-ttu-id="efcb9-322">Ajoutez **Get-AzureRmVM** au canevas.</span><span class="sxs-lookup"><span data-stu-id="efcb9-322">Add **Get-AzureRmVM** to the canvas.</span></span>
5. <span data-ttu-id="efcb9-323">Sélectionnez **Get-AzureRmVM** puis **Jeu de paramètres** afin d’afficher les jeux pour **Get-AzureRmVM**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-323">Select **Get-AzureRmVM** and then **Parameter Set** to view the sets for **Get-AzureRmVM**.</span></span>  <span data-ttu-id="efcb9-324">Sélectionnez le jeu de paramètres **GetVirtualMachineInResourceGroupNameParamSet** .</span><span class="sxs-lookup"><span data-stu-id="efcb9-324">Select the **GetVirtualMachineInResourceGroupNameParamSet** parameter set.</span></span>  <span data-ttu-id="efcb9-325">Notez que des points d’exclamation apparaissent en regard des paramètres **ResourceGroupName** et **Name**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-325">Note that **ResourceGroupName** and **Name** have exclamation points next them.</span></span>  <span data-ttu-id="efcb9-326">Ils indiquent que ces paramètres sont obligatoires.</span><span class="sxs-lookup"><span data-stu-id="efcb9-326">This indicates that they are required parameters.</span></span>  <span data-ttu-id="efcb9-327">Notez également que les deux attendent des valeurs de chaîne.</span><span class="sxs-lookup"><span data-stu-id="efcb9-327">Also note both expect string values.</span></span>
6. <span data-ttu-id="efcb9-328">Pour le paramètre **Name** sous **Source de données**, sélectionnez **Entrée du Runbook** puis **VMName**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-328">Under **Data source** for **Name**, select **Runbook input** and then select **VMName**.</span></span>  <span data-ttu-id="efcb9-329">Cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-329">Click **OK**.</span></span>
7. <span data-ttu-id="efcb9-330">Pour le paramètre **ResourceGroupName** sous **Source de données**, sélectionnez **Entrée de Runbook**, puis **ResourceGroupName**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-330">Under **Data source** for **ResourceGroupName**, select **Runbook input** and then select **ResourceGroupName**.</span></span>  <span data-ttu-id="efcb9-331">Cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-331">Click **OK**.</span></span>
8. <span data-ttu-id="efcb9-332">Pour le paramètre **Status** sous **Source de données**, sélectionnez **Valeur constante**, puis cliquez sur **True**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-332">Under **Data source** for **Status**, select **Constant value** and then click  **True**.</span></span>  <span data-ttu-id="efcb9-333">Cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-333">Click **OK**.</span></span>  
9. <span data-ttu-id="efcb9-334">Créez un lien entre **Specify Subscription Id** (Spécifier un ID d’abonnement) et **Get-AzureRmVM**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-334">Create a link from **Specify Subscription Id** to **Get-AzureRmVM**.</span></span>
10. <span data-ttu-id="efcb9-335">Dans la commande Bibliothèque, développez **Contrôle de Runbook** et ajoutez **Code** au canevas.</span><span class="sxs-lookup"><span data-stu-id="efcb9-335">In the library control, expand **Runbook Control** and add **Code** to the canvas.</span></span>  
11. <span data-ttu-id="efcb9-336">Créez un lien entre **Get-AzureRmVM** et **Code**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-336">Create a link from **Get-AzureRmVM** to **Code**.</span></span>  
12. <span data-ttu-id="efcb9-337">Cliquez sur **Code** et dans le panneau Configuration, changez l’étiquette en **Obtenir l’état**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-337">Click **Code** and in the Configuration pane, change label to **Get Status**.</span></span>
13. <span data-ttu-id="efcb9-338">Sélectionnez le paramètre **Code** pour afficher le panneau **Éditeur de code**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-338">Select **Code** parameter, and the **Code Editor** blade appears.</span></span>  
14. <span data-ttu-id="efcb9-339">Dans l’éditeur de code, collez l’extrait de code suivant :</span><span class="sxs-lookup"><span data-stu-id="efcb9-339">In the code editor, paste the following snippet of code:</span></span>
    
     ```
     $StatusesJson = $ActivityOutput['Get-AzureRmVM'].StatusesText
     $Statuses = ConvertFrom-Json $StatusesJson
     $StatusOut =""
     foreach ($Status in $Statuses){
     if($Status.Code -eq "Powerstate/running"){$StatusOut = "running"}
     elseif ($Status.Code -eq "Powerstate/deallocated") {$StatusOut = "stopped"}
     }
     $StatusOut
     ```
15. <span data-ttu-id="efcb9-340">Créez un lien entre **Obtenir l’état** et **Start-AzureRmVM**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-340">Create a link from **Get Status** to **Start-AzureRmVM**.</span></span><br> <span data-ttu-id="efcb9-341">![Runbook avec module de code](media/automation-first-runbook-graphical/runbook-startvm-get-status.png)</span><span class="sxs-lookup"><span data-stu-id="efcb9-341">![Runbook with Code Module](media/automation-first-runbook-graphical/runbook-startvm-get-status.png)</span></span>  
16. <span data-ttu-id="efcb9-342">Sélectionnez le lien puis dans le panneau Configuration, changez **Appliquer la condition** en **Oui**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-342">Select the link and in the Configuration pane, change **Apply condition** to **Yes**.</span></span>   <span data-ttu-id="efcb9-343">Notez que le lien se transforme en une ligne pointillée indiquant que l’activité cible s’exécute uniquement si la condition produit la valeur true.</span><span class="sxs-lookup"><span data-stu-id="efcb9-343">Note the link turns to a dashed line indicating that the target activity only runs if the condition resolves to true.</span></span>  
17. <span data-ttu-id="efcb9-344">Dans la zone **Expression de condition**, tapez *$ActivityOutput[’Get Status’] -eq "Stopped"*.</span><span class="sxs-lookup"><span data-stu-id="efcb9-344">For the **Condition expression**, type *$ActivityOutput['Get Status'] -eq "Stopped"*.</span></span>  <span data-ttu-id="efcb9-345">**Start-AzureRmVM** s’exécute uniquement si la machine virtuelle est arrêtée.</span><span class="sxs-lookup"><span data-stu-id="efcb9-345">**Start-AzureRmVM** now only runs if the virtual machine is stopped.</span></span>
18. <span data-ttu-id="efcb9-346">Dans le contrôle Bibliothèque, développez **Applets de commande**, puis **Microsoft.PowerShell.Utility**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-346">In the Library control, expand **Cmdlets** and then **Microsoft.PowerShell.Utility**.</span></span>
19. <span data-ttu-id="efcb9-347">Ajoutez **Write-Output** au canevas à deux reprises.</span><span class="sxs-lookup"><span data-stu-id="efcb9-347">Add **Write-Output** to the canvas twice.</span></span><br> <span data-ttu-id="efcb9-348">![Runbook avec Write-Output](media/automation-first-runbook-graphical/runbook-startazurermvm-complete.png)</span><span class="sxs-lookup"><span data-stu-id="efcb9-348">![Runbook with Write-Output](media/automation-first-runbook-graphical/runbook-startazurermvm-complete.png)</span></span>
20. <span data-ttu-id="efcb9-349">Sur le premier contrôle **Write-Output**, cliquez sur **Paramètres** et changez la valeur de **Étiquette** en *Notify VM Started*.</span><span class="sxs-lookup"><span data-stu-id="efcb9-349">On the first **Write-Output** control, click **Parameters** and change the **Label** value to *Notify VM Started*.</span></span>
21. <span data-ttu-id="efcb9-350">Pour **InputObject**, définissez le champ **Source de données** sur **Expression PowerShell**, puis tapez l’expression *"$VMName démarrée."*.</span><span class="sxs-lookup"><span data-stu-id="efcb9-350">For **InputObject**, change **Data source** to **PowerShell expression** and type in the expression *"$VMName successfully started."*.</span></span>
22. <span data-ttu-id="efcb9-351">Sur le second contrôle **Write-Output**, cliquez sur **Paramètres** et changez la valeur de **Étiquette** en *Notify VM Start Failed*</span><span class="sxs-lookup"><span data-stu-id="efcb9-351">On the second **Write-Output** control, click **Parameters** and change the **Label** value to *Notify VM Start Failed*</span></span>
23. <span data-ttu-id="efcb9-352">Pour **InputObject**, changez **Source de données** en **Expression PowerShell** puis tapez l’expression *"$VMName n’a pas pu démarrer."*.</span><span class="sxs-lookup"><span data-stu-id="efcb9-352">For **InputObject**, change **Data source** to **PowerShell expression** and type in the expression *"$VMName could not start."*.</span></span>
24. <span data-ttu-id="efcb9-353">Créez un lien entre **Start-AzureRmVM** et **Notify VM Started** ainsi que **Notify VM Start Failed**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-353">Create a link from **Start-AzureRmVM** to **Notify VM Started** and **Notify VM Start Failed**.</span></span>
25. <span data-ttu-id="efcb9-354">Sélectionnez le lien vers **Notify VM Started** et changez **Appliquer la condition** en **True**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-354">Select the link to **Notify VM Started** and change **Apply condition** to **True**.</span></span>
26. <span data-ttu-id="efcb9-355">Dans la zone **Expression de condition**, tapez *$ActivityOutput[’Start-AzureRmVM’].IsSuccessStatusCode -eq $true*.</span><span class="sxs-lookup"><span data-stu-id="efcb9-355">For the **Condition expression**, type *$ActivityOutput['Start-AzureRmVM'].IsSuccessStatusCode -eq $true*.</span></span>  <span data-ttu-id="efcb9-356">Ce contrôle Write-Output s’exécute désormais uniquement si la machine virtuelle a démarré correctement.</span><span class="sxs-lookup"><span data-stu-id="efcb9-356">This Write-Output control now only runs if the virtual machine is successfully started.</span></span>
27. <span data-ttu-id="efcb9-357">Sélectionnez le lien vers **Notify VM Start Failed** et changez **Appliquer la condition** en **True**.</span><span class="sxs-lookup"><span data-stu-id="efcb9-357">Select the link to **Notify VM Start Failed** and change **Apply condition** to **True**.</span></span>
28. <span data-ttu-id="efcb9-358">Dans la zone **Expression de condition**, tapez *$ActivityOutput[’Start-AzureRmVM’].IsSuccessStatusCode -ne $true*.</span><span class="sxs-lookup"><span data-stu-id="efcb9-358">For the **Condition expression**, type *$ActivityOutput['Start-AzureRmVM'].IsSuccessStatusCode -ne $true*.</span></span>  <span data-ttu-id="efcb9-359">Ce contrôle Write-Output s’exécute désormais uniquement si la machine virtuelle n’a pas démarré correctement.</span><span class="sxs-lookup"><span data-stu-id="efcb9-359">This Write-Output control now only runs if the virtual machine is not successfully started.</span></span>
29. <span data-ttu-id="efcb9-360">Enregistrez le Runbook et ouvrez le volet de test.</span><span class="sxs-lookup"><span data-stu-id="efcb9-360">Save the runbook and open the Test pane.</span></span>
30. <span data-ttu-id="efcb9-361">Démarrez le Runbook avec la machine virtuelle arrêtée, et il devrait démarrer.</span><span class="sxs-lookup"><span data-stu-id="efcb9-361">Start the runbook with the virtual machine stopped, and it should start.</span></span>

## <a name="next-steps"></a><span data-ttu-id="efcb9-362">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="efcb9-362">Next steps</span></span>
* <span data-ttu-id="efcb9-363">Pour en savoir plus sur la création graphique, consultez [Création de graphiques dans Azure Automation](automation-graphical-authoring-intro.md)</span><span class="sxs-lookup"><span data-stu-id="efcb9-363">To learn more about Graphical Authoring, see [Graphical authoring in Azure Automation](automation-graphical-authoring-intro.md)</span></span>
* <span data-ttu-id="efcb9-364">Pour une prise en main des Runbooks PowerShell, consultez [Mon premier Runbook PowerShell](automation-first-runbook-textual-powershell.md)</span><span class="sxs-lookup"><span data-stu-id="efcb9-364">To get started with PowerShell runbooks, see [My first PowerShell runbook](automation-first-runbook-textual-powershell.md)</span></span>
* <span data-ttu-id="efcb9-365">Pour une prise en main des Runbooks de workflow PowerShell, consultez [Mon premier Runbook PowerShell Workflow](automation-first-runbook-textual.md)</span><span class="sxs-lookup"><span data-stu-id="efcb9-365">To get started with PowerShell workflow runbooks, see [My first PowerShell workflow runbook](automation-first-runbook-textual.md)</span></span>

