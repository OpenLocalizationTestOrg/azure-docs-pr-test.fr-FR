---
title: les runbook PowerShell Workflow premier aaaMy dans Azure Automation | Documents Microsoft
description: "Didacticiel qui vous guide tout au long de la création de hello, test et la publication d’un runbook de texte simple à l’aide de flux de travail PowerShell."
services: automation
documentationcenter: 
author: mgoedtel
manager: jwhit
editor: 
keywords: powershell workflow, exemples de workflows powershell, workflows powershell
ms.assetid: 0002d7f7-e2b5-46e3-b5eb-4596b84fd526
ms.service: automation
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 03/26/2017
ms.author: magoedte;bwren
ms.openlocfilehash: b5a34d363ef4865878f3f68119833367b5280f83
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="my-first-powershell-workflow-runbook"></a><span data-ttu-id="1f540-104">Mon premier runbook PowerShell Workflow</span><span class="sxs-lookup"><span data-stu-id="1f540-104">My first PowerShell Workflow runbook</span></span>

> [!div class="op_single_selector"]
> * [<span data-ttu-id="1f540-105">Graphique</span><span class="sxs-lookup"><span data-stu-id="1f540-105">Graphical</span></span>](automation-first-runbook-graphical.md)
> * [<span data-ttu-id="1f540-106">PowerShell</span><span class="sxs-lookup"><span data-stu-id="1f540-106">PowerShell</span></span>](automation-first-runbook-textual-powershell.md)
> * [<span data-ttu-id="1f540-107">Workflow PowerShell</span><span class="sxs-lookup"><span data-stu-id="1f540-107">PowerShell Workflow</span></span>](automation-first-runbook-textual.md)
> 
> 

<span data-ttu-id="1f540-108">Ce didacticiel vous guide dans la création de hello d’un [runbook PowerShell Workflow](automation-runbook-types.md#powershell-workflow-runbooks) dans Azure Automation.</span><span class="sxs-lookup"><span data-stu-id="1f540-108">This tutorial walks you through hello creation of a [PowerShell Workflow runbook](automation-runbook-types.md#powershell-workflow-runbooks) in Azure Automation.</span></span> <span data-ttu-id="1f540-109">Nous allons commencer avec un runbook simple que nous testons et publier tout en expliquant comment tootrack hello état du travail de runbook hello.</span><span class="sxs-lookup"><span data-stu-id="1f540-109">We start with a simple runbook that we test and publish while explaining how tootrack hello status of hello runbook job.</span></span> <span data-ttu-id="1f540-110">Puis nous modifions hello runbook tooactually gérer des ressources Azure, dans ce cas de démarrer une machine virtuelle Azure.</span><span class="sxs-lookup"><span data-stu-id="1f540-110">Then we modify hello runbook tooactually manage Azure resources, in this case starting an Azure virtual machine.</span></span> <span data-ttu-id="1f540-111">Enfin, nous faisons hello runbook plus fiable en ajoutant des paramètres de runbook.</span><span class="sxs-lookup"><span data-stu-id="1f540-111">Lastly we make hello runbook more robust by adding runbook parameters.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="1f540-112">Composants requis</span><span class="sxs-lookup"><span data-stu-id="1f540-112">Prerequisites</span></span>
<span data-ttu-id="1f540-113">toocomplete ce didacticiel, vous devez hello suivant :</span><span class="sxs-lookup"><span data-stu-id="1f540-113">toocomplete this tutorial, you will need hello following:</span></span>

* <span data-ttu-id="1f540-114">Abonnement Azure.</span><span class="sxs-lookup"><span data-stu-id="1f540-114">Azure subscription.</span></span> <span data-ttu-id="1f540-115">Si vous n’avez pas encore d’abonnement, vous pouvez [activer vos avantages abonnés MSDN](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) ou <a href="/pricing/free-account/" target="_blank">[créer un compte gratuit](https://azure.microsoft.com/free/).</span><span class="sxs-lookup"><span data-stu-id="1f540-115">If you don't have one yet, you can [activate your MSDN subscriber benefits](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) or <a href="/pricing/free-account/" target="_blank">[sign up for a free account](https://azure.microsoft.com/free/).</span></span>
* <span data-ttu-id="1f540-116">[Compte Automation](automation-sec-configure-azure-runas-account.md) toohold hello runbook et authentifier les ressources tooAzure.</span><span class="sxs-lookup"><span data-stu-id="1f540-116">[Automation account](automation-sec-configure-azure-runas-account.md) toohold hello runbook and authenticate tooAzure resources.</span></span>  <span data-ttu-id="1f540-117">Ce compte doit avoir l’autorisation toostart et arrêter l’ordinateur virtuel de hello.</span><span class="sxs-lookup"><span data-stu-id="1f540-117">This account must have permission toostart and stop hello virtual machine.</span></span>
* <span data-ttu-id="1f540-118">Une machine virtuelle Azure.</span><span class="sxs-lookup"><span data-stu-id="1f540-118">An Azure virtual machine.</span></span> <span data-ttu-id="1f540-119">Nous arrêtons et démarrons cette machine afin qu’elle ne soit pas une machine virtuelle de production.</span><span class="sxs-lookup"><span data-stu-id="1f540-119">We stop and start this machine so it should not be a production VM.</span></span>

## <a name="step-1---create-new-runbook"></a><span data-ttu-id="1f540-120">Étape 1 - Création d’un Runbook</span><span class="sxs-lookup"><span data-stu-id="1f540-120">Step 1 - Create new runbook</span></span>
<span data-ttu-id="1f540-121">Nous allons commencer par la création d’un runbook simple qui génère du texte hello *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="1f540-121">We'll start by creating a simple runbook that outputs hello text *Hello World*.</span></span>

1. <span data-ttu-id="1f540-122">Bonjour portail Azure, ouvrez votre compte Automation.</span><span class="sxs-lookup"><span data-stu-id="1f540-122">In hello Azure portal, open your Automation account.</span></span>  
   <span data-ttu-id="1f540-123">page compte d’automatisation Hello vous donne un aperçu rapide des ressources de hello dans ce compte.</span><span class="sxs-lookup"><span data-stu-id="1f540-123">hello Automation account page gives you a quick view of hello resources in this account.</span></span> <span data-ttu-id="1f540-124">Vous devriez déjà posséder certains éléments.</span><span class="sxs-lookup"><span data-stu-id="1f540-124">You should already have some assets.</span></span> <span data-ttu-id="1f540-125">La plupart d'entre eux est des modules hello sont inclus automatiquement dans un compte Automation.</span><span class="sxs-lookup"><span data-stu-id="1f540-125">Most of those are hello modules that are automatically included in a new Automation account.</span></span> <span data-ttu-id="1f540-126">Vous devez également avoir la ressource d’informations d’identification hello qui est mentionné dans hello [conditions préalables](#prerequisites).</span><span class="sxs-lookup"><span data-stu-id="1f540-126">You should also have hello Credential asset that's mentioned in hello [prerequisites](#prerequisites).</span></span>
2. <span data-ttu-id="1f540-127">Cliquez sur hello **Runbooks** vignette tooopen hello liste des runbooks.</span><span class="sxs-lookup"><span data-stu-id="1f540-127">Click on hello **Runbooks** tile tooopen hello list of runbooks.</span></span><br><br> <span data-ttu-id="1f540-128">![Contrôle des Runbooks](media/automation-first-runbook-textual/runbooks-control-tiles.png)</span><span class="sxs-lookup"><span data-stu-id="1f540-128">![Runbooks control](media/automation-first-runbook-textual/runbooks-control-tiles.png)</span></span>
3. <span data-ttu-id="1f540-129">Créer un runbook en cliquant sur hello **ajouter un runbook** bouton, puis **créer un runbook**.</span><span class="sxs-lookup"><span data-stu-id="1f540-129">Create a new runbook by clicking on hello **Add a runbook** button and then **Create a new runbook**.</span></span>
4. <span data-ttu-id="1f540-130">Nommez hello hello runbook *MyFirstRunbook-flux de travail*.</span><span class="sxs-lookup"><span data-stu-id="1f540-130">Give hello runbook hello name *MyFirstRunbook-Workflow*.</span></span>
5. <span data-ttu-id="1f540-131">Dans ce cas, nous allons toocreate un [runbook PowerShell Workflow](automation-runbook-types.md#powershell-workflow-runbooks) ainsi sélectionnez **Powershell Workflow** pour **le type de Runbook**.</span><span class="sxs-lookup"><span data-stu-id="1f540-131">In this case, we're going toocreate a [PowerShell Workflow runbook](automation-runbook-types.md#powershell-workflow-runbooks) so select **Powershell Workflow** for **Runbook type**.</span></span><br><br> <span data-ttu-id="1f540-132">![Nouveau Runbook](media/automation-first-runbook-textual/new-runbook-properties.png)</span><span class="sxs-lookup"><span data-stu-id="1f540-132">![New runbook](media/automation-first-runbook-textual/new-runbook-properties.png)</span></span>
6. <span data-ttu-id="1f540-133">Cliquez sur **créer** toocreate hello runbook et l’éditeur de texte hello ouvert.</span><span class="sxs-lookup"><span data-stu-id="1f540-133">Click **Create** toocreate hello runbook and open hello textual editor.</span></span>

## <a name="step-2---add-code-toohello-runbook"></a><span data-ttu-id="1f540-134">Étape 2 : ajouter du code toohello runbook</span><span class="sxs-lookup"><span data-stu-id="1f540-134">Step 2 - Add code toohello runbook</span></span>
<span data-ttu-id="1f540-135">Vous pouvez soit code type directement dans les runbook hello, ou vous pouvez sélectionner des applets de commande, les runbooks et les ressources de hello contrôle de la bibliothèque et ont les ajoutés runbook toohello avec tous les paramètres associés.</span><span class="sxs-lookup"><span data-stu-id="1f540-135">You can either type code directly into hello runbook, or you can select cmdlets, runbooks, and assets from hello Library control and have them added toohello runbook with any related parameters.</span></span> <span data-ttu-id="1f540-136">Pour cette procédure pas à pas, nous allons taper directement dans les runbook de hello.</span><span class="sxs-lookup"><span data-stu-id="1f540-136">For this walkthrough, we'll type directly into hello runbook.</span></span>

1. <span data-ttu-id="1f540-137">Notre runbook est actuellement vide avec uniquement les hello requis *workflow* (mot clé), le nom hello de nos runbook et les accolades hello appliquer à l’ensemble du workflow hello.</span><span class="sxs-lookup"><span data-stu-id="1f540-137">Our runbook is currently empty with only hello required *workflow* keyword, hello name of our runbook, and hello braces that will encase hello entire workflow.</span></span>

   ```
   Workflow MyFirstRunbook-Workflow
   {
   }
   ```
2. <span data-ttu-id="1f540-138">Tapez *Write-Output « Hello World. »*</span><span class="sxs-lookup"><span data-stu-id="1f540-138">Type *Write-Output "Hello World."*</span></span> <span data-ttu-id="1f540-139">entre accolades de hello.</span><span class="sxs-lookup"><span data-stu-id="1f540-139">between hello braces.</span></span>

   ```
   Workflow MyFirstRunbook-Workflow
   {
   Write-Output "Hello World"
   }
   ```
3. <span data-ttu-id="1f540-140">Enregistrer les runbook hello en cliquant sur **enregistrer**.</span><span class="sxs-lookup"><span data-stu-id="1f540-140">Save hello runbook by clicking **Save**.</span></span><br><br> <span data-ttu-id="1f540-141">![Enregistrer un Runbook](media/automation-first-runbook-textual/automation-runbook-edit-controls-save.png)</span><span class="sxs-lookup"><span data-stu-id="1f540-141">![Save runbook](media/automation-first-runbook-textual/automation-runbook-edit-controls-save.png)</span></span>

## <a name="step-3---test-hello-runbook"></a><span data-ttu-id="1f540-142">Étape 3 : Test hello runbook</span><span class="sxs-lookup"><span data-stu-id="1f540-142">Step 3 - Test hello runbook</span></span>
<span data-ttu-id="1f540-143">Avant que nous publions hello runbook toomake il disponible en production, nous souhaitons tootest il toomake assurer qu’il fonctionne correctement.</span><span class="sxs-lookup"><span data-stu-id="1f540-143">Before we publish hello runbook toomake it available in production, we want tootest it toomake sure that it works properly.</span></span> <span data-ttu-id="1f540-144">Lorsque vous testez un Runbook, vous exécutez sa version **Brouillon** et affichez sa sortie de manière interactive.</span><span class="sxs-lookup"><span data-stu-id="1f540-144">When you test a runbook, you run its **Draft** version and view its output interactively.</span></span>

1. <span data-ttu-id="1f540-145">Cliquez sur **volet Test** volet de Test tooopen hello.</span><span class="sxs-lookup"><span data-stu-id="1f540-145">Click **Test pane** tooopen hello Test pane.</span></span><br><br> <span data-ttu-id="1f540-146">![Volet de test](media/automation-first-runbook-textual/automation-runbook-edit-controls-test.png)</span><span class="sxs-lookup"><span data-stu-id="1f540-146">![Test pane](media/automation-first-runbook-textual/automation-runbook-edit-controls-test.png)</span></span>
2. <span data-ttu-id="1f540-147">Cliquez sur **Démarrer** test de hello toostart.</span><span class="sxs-lookup"><span data-stu-id="1f540-147">Click **Start** toostart hello test.</span></span> <span data-ttu-id="1f540-148">Ce doit être l’option de hello uniquement activé.</span><span class="sxs-lookup"><span data-stu-id="1f540-148">This should be hello only enabled option.</span></span>
3. <span data-ttu-id="1f540-149">Une [tâche de Runbook](automation-runbook-execution.md) est créée et son état apparaît.</span><span class="sxs-lookup"><span data-stu-id="1f540-149">A [runbook job](automation-runbook-execution.md) is created and its status displayed.</span></span>  
   <span data-ttu-id="1f540-150">état de la tâche Hello démarrera en tant que *en file d’attente* indiquant qu’il est en attente d’un runbook worker dans hello toocome de cloud disponible.</span><span class="sxs-lookup"><span data-stu-id="1f540-150">hello job status will start as *Queued* indicating that it is waiting for a runbook worker in hello cloud toocome available.</span></span> <span data-ttu-id="1f540-151">Il passe alors trop*départ* lorsqu’un processus de travail tâche de hello, les revendications, puis *en cours d’exécution* démarrage hello runbook réellement en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="1f540-151">It will then move too*Starting* when a worker claims hello job, and then *Running* when hello runbook actually starts running.</span></span>  
4. <span data-ttu-id="1f540-152">Fin de la tâche du runbook hello, sa sortie s’affiche.</span><span class="sxs-lookup"><span data-stu-id="1f540-152">When hello runbook job completes, its output is displayed.</span></span> <span data-ttu-id="1f540-153">Dans notre cas, nous devrions voir *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="1f540-153">In our case, we should see *Hello World*.</span></span><br><br> <span data-ttu-id="1f540-154">![Hello World](media/automation-first-runbook-textual/test-output-hello-world.png)</span><span class="sxs-lookup"><span data-stu-id="1f540-154">![Hello World](media/automation-first-runbook-textual/test-output-hello-world.png)</span></span>
5. <span data-ttu-id="1f540-155">Fermez la zone de dessin hello Test volet tooreturn toohello.</span><span class="sxs-lookup"><span data-stu-id="1f540-155">Close hello Test pane tooreturn toohello canvas.</span></span>

## <a name="step-4---publish-and-start-hello-runbook"></a><span data-ttu-id="1f540-156">Étape 4 : publier et démarrer hello runbook</span><span class="sxs-lookup"><span data-stu-id="1f540-156">Step 4 - Publish and start hello runbook</span></span>
<span data-ttu-id="1f540-157">runbook Hello que nous venons de créer est toujours en mode brouillon.</span><span class="sxs-lookup"><span data-stu-id="1f540-157">hello runbook that we just created is still in Draft mode.</span></span> <span data-ttu-id="1f540-158">Nous devons toopublish avant de l’exécuter en production.</span><span class="sxs-lookup"><span data-stu-id="1f540-158">We need toopublish it before we can run it in production.</span></span> <span data-ttu-id="1f540-159">Lorsque vous publiez un runbook, vous remplacez la version publiée existante de hello avec brouillon hello.</span><span class="sxs-lookup"><span data-stu-id="1f540-159">When you publish a runbook, you overwrite hello existing Published version with hello Draft version.</span></span> <span data-ttu-id="1f540-160">Dans notre cas, nous n’avez pas une version publiée encore, car nous avons créé hello runbook.</span><span class="sxs-lookup"><span data-stu-id="1f540-160">In our case, we don't have a Published version yet because we just created hello runbook.</span></span>

1. <span data-ttu-id="1f540-161">Cliquez sur **publier** toopublish hello runbook, puis **Oui** lorsque vous y êtes invité.</span><span class="sxs-lookup"><span data-stu-id="1f540-161">Click **Publish** toopublish hello runbook and then **Yes** when prompted.</span></span><br><br> <span data-ttu-id="1f540-162">![Publier](media/automation-first-runbook-textual/automation-runbook-edit-controls-publish.png)</span><span class="sxs-lookup"><span data-stu-id="1f540-162">![Publish](media/automation-first-runbook-textual/automation-runbook-edit-controls-publish.png)</span></span>
2. <span data-ttu-id="1f540-163">Si vous faites défiler les runbook de hello tooview gauche Bonjour **Runbooks** volet maintenant, il affiche un **état de création** de **publié**.</span><span class="sxs-lookup"><span data-stu-id="1f540-163">If you scroll left tooview hello runbook in hello **Runbooks** pane now, it will show an **Authoring Status** of **Published**.</span></span>
3. <span data-ttu-id="1f540-164">Défilement arrière toohello tooview droite hello volet **MyFirstRunbook-flux de travail**.</span><span class="sxs-lookup"><span data-stu-id="1f540-164">Scroll back toohello right tooview hello pane for **MyFirstRunbook-Workflow**.</span></span>  
   <span data-ttu-id="1f540-165">Hello options haut hello nous permettent de toostart hello runbook, planifier son toostart à un moment donné dans hello futures ou créer un [webhook](automation-webhooks.md) afin de pouvoir être démarrée par un appel HTTP.</span><span class="sxs-lookup"><span data-stu-id="1f540-165">hello options across hello top allow us toostart hello runbook, schedule it toostart at some time in hello future, or create a [webhook](automation-webhooks.md) so it can be started through an HTTP call.</span></span>
4. <span data-ttu-id="1f540-166">Nous voulons simplement nous toostart hello runbook cliquez alors sur **Démarrer** , puis **Oui** lorsque vous y êtes invité.</span><span class="sxs-lookup"><span data-stu-id="1f540-166">We just want toostart hello runbook so click **Start** and then **Yes** when prompted.</span></span><br><br> <span data-ttu-id="1f540-167">![Démarrer un Runbook](media/automation-first-runbook-textual/automation-runbook-controls-start.png)</span><span class="sxs-lookup"><span data-stu-id="1f540-167">![Start runbook](media/automation-first-runbook-textual/automation-runbook-controls-start.png)</span></span>
5. <span data-ttu-id="1f540-168">Un volet de travail est ouvert pour la tâche du runbook hello que nous venons de créer.</span><span class="sxs-lookup"><span data-stu-id="1f540-168">A job pane is opened for hello runbook job that we just created.</span></span> <span data-ttu-id="1f540-169">Nous pouvons fermer ce volet, mais dans ce cas nous allons laisser ouverte afin de nous pouvons observer la progression du travail hello.</span><span class="sxs-lookup"><span data-stu-id="1f540-169">We can close this pane, but in this case we'll leave it open so we can watch hello job's progress.</span></span>
6. <span data-ttu-id="1f540-170">état de la tâche Hello est indiqué dans **récapitulatif** et correspondances hello états que nous avons vu lorsque nous avons testé hello runbook.</span><span class="sxs-lookup"><span data-stu-id="1f540-170">hello job status is shown in **Job Summary** and matches hello statuses that we saw when we tested hello runbook.</span></span><br><br> <span data-ttu-id="1f540-171">![Résumé des tâches](media/automation-first-runbook-textual/job-pane-status-blade-jobsummary.png)</span><span class="sxs-lookup"><span data-stu-id="1f540-171">![Job Summary](media/automation-first-runbook-textual/job-pane-status-blade-jobsummary.png)</span></span>
7. <span data-ttu-id="1f540-172">Une fois hello runbook état indique *terminé*, cliquez sur **sortie**.</span><span class="sxs-lookup"><span data-stu-id="1f540-172">Once hello runbook status shows *Completed*, click **Output**.</span></span> <span data-ttu-id="1f540-173">volet de sortie Hello est ouvert, et nous pouvons voir notre *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="1f540-173">hello Output pane is opened, and we can see our *Hello World*.</span></span><br><br> <span data-ttu-id="1f540-174">![Résumé des tâches](media/automation-first-runbook-textual/job-pane-status-blade-outputtile.png)</span><span class="sxs-lookup"><span data-stu-id="1f540-174">![Job Summary](media/automation-first-runbook-textual/job-pane-status-blade-outputtile.png)</span></span>  
8. <span data-ttu-id="1f540-175">Volet de sortie de fermeture hello.</span><span class="sxs-lookup"><span data-stu-id="1f540-175">Close hello Output pane.</span></span>
9. <span data-ttu-id="1f540-176">Cliquez sur **tous les journaux** volet de flux tooopen hello pour la tâche du runbook hello.</span><span class="sxs-lookup"><span data-stu-id="1f540-176">Click **All Logs** tooopen hello Streams pane for hello runbook job.</span></span> <span data-ttu-id="1f540-177">Nous devons uniquement voir *Hello World* dans la sortie de hello flux, mais cela peut afficher les autres flux pour un travail de runbook telles que des commentaires et d’erreur si hello runbook écrit toothem.</span><span class="sxs-lookup"><span data-stu-id="1f540-177">We should only see *Hello World* in hello output stream, but this can show other streams for a runbook job such as Verbose and Error if hello runbook writes toothem.</span></span><br><br> <span data-ttu-id="1f540-178">![Résumé des tâches](media/automation-first-runbook-textual/job-pane-status-blade-alllogstile.png)</span><span class="sxs-lookup"><span data-stu-id="1f540-178">![Job Summary](media/automation-first-runbook-textual/job-pane-status-blade-alllogstile.png)</span></span>
10. <span data-ttu-id="1f540-179">Fermez hello flux volets et hello travail volet tooreturn toohello MyFirstRunbook.</span><span class="sxs-lookup"><span data-stu-id="1f540-179">Close hello Streams pane and hello Job pane tooreturn toohello MyFirstRunbook pane.</span></span>
11. <span data-ttu-id="1f540-180">Cliquez sur **travaux** volet de tâches tooopen hello pour ce runbook.</span><span class="sxs-lookup"><span data-stu-id="1f540-180">Click **Jobs** tooopen hello Jobs pane for this runbook.</span></span> <span data-ttu-id="1f540-181">Répertorie tous les travaux de hello créés par ce runbook.</span><span class="sxs-lookup"><span data-stu-id="1f540-181">This lists all of hello jobs created by this runbook.</span></span> <span data-ttu-id="1f540-182">Nous devons uniquement voir une tâche répertoriée dans la mesure où nous avons uniquement les travaux hello qu’une seule fois.</span><span class="sxs-lookup"><span data-stu-id="1f540-182">We should only see one job listed since we only ran hello job once.</span></span><br><br> <span data-ttu-id="1f540-183">![Tâches](media/automation-first-runbook-textual/runbook-control-job-tile.png)</span><span class="sxs-lookup"><span data-stu-id="1f540-183">![Jobs](media/automation-first-runbook-textual/runbook-control-job-tile.png)</span></span>
12. <span data-ttu-id="1f540-184">Vous pouvez cliquer sur cette hello tooopen de travail même volet de travail que nous avons vu lorsque nous avons commencé hello runbook.</span><span class="sxs-lookup"><span data-stu-id="1f540-184">You can click on this job tooopen hello same Job pane that we viewed when we started hello runbook.</span></span> <span data-ttu-id="1f540-185">Ainsi, vous toogo à temps et consulter les détails de hello d’un travail qui a été créé pour un runbook donné.</span><span class="sxs-lookup"><span data-stu-id="1f540-185">This allows you toogo back in time and view hello details of any job that was created for a particular runbook.</span></span>

## <a name="step-5---add-authentication-toomanage-azure-resources"></a><span data-ttu-id="1f540-186">Étape 5 : ajouter l’authentification toomanage ressources Azure</span><span class="sxs-lookup"><span data-stu-id="1f540-186">Step 5 - Add authentication toomanage Azure resources</span></span>
<span data-ttu-id="1f540-187">Nous avons testé et publié notre Runbook, mais jusqu'à présent, il ne fait rien d'utile.</span><span class="sxs-lookup"><span data-stu-id="1f540-187">We've tested and published our runbook, but so far it doesn't do anything useful.</span></span> <span data-ttu-id="1f540-188">Nous souhaitons toohave gérer les ressources Azure.</span><span class="sxs-lookup"><span data-stu-id="1f540-188">We want toohave it manage Azure resources.</span></span> <span data-ttu-id="1f540-189">Il ne sera pas en mesure de toodo que s’il s’authentifier à moins que nous avons à l’aide des informations d’identification hello qui sont référencés par tooin hello [conditions préalables](#prerequisites).</span><span class="sxs-lookup"><span data-stu-id="1f540-189">It won't be able toodo that though unless we have it authenticate using hello credentials that are referred tooin hello [prerequisites](#prerequisites).</span></span> <span data-ttu-id="1f540-190">Cela se fait par hello **Add-AzureRMAccount** applet de commande.</span><span class="sxs-lookup"><span data-stu-id="1f540-190">We do that with hello **Add-AzureRMAccount** cmdlet.</span></span>

1. <span data-ttu-id="1f540-191">Éditeur de texte hello ouvrir en cliquant sur **modifier** dans le volet de hello MyFirstRunbook-flux de travail.</span><span class="sxs-lookup"><span data-stu-id="1f540-191">Open hello textual editor by clicking **Edit** on hello MyFirstRunbook-Workflow pane.</span></span><br><br> <span data-ttu-id="1f540-192">![Modifier un Runbook](media/automation-first-runbook-textual/automation-runbook-controls-edit.png)</span><span class="sxs-lookup"><span data-stu-id="1f540-192">![Edit runbook](media/automation-first-runbook-textual/automation-runbook-controls-edit.png)</span></span>
2. <span data-ttu-id="1f540-193">Nous ne devons hello **Write-Output** plus de ligne, par conséquent, continuez et le supprimer.</span><span class="sxs-lookup"><span data-stu-id="1f540-193">We don't need hello **Write-Output** line anymore, so go ahead and delete it.</span></span>
3. <span data-ttu-id="1f540-194">Placer le curseur hello sur une ligne vide entre les accolades hello.</span><span class="sxs-lookup"><span data-stu-id="1f540-194">Position hello cursor on a blank line between hello braces.</span></span>
4. <span data-ttu-id="1f540-195">Tapez ou copiez-collez hello suivant le code qui gère l’authentification avec votre compte d’identification Automation hello :</span><span class="sxs-lookup"><span data-stu-id="1f540-195">Type or copy and paste hello following code that will handle hello authentication with your Automation Run As account:</span></span>

   ```
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID `
   -ApplicationId $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   ```
5. <span data-ttu-id="1f540-196">Cliquez sur **Test volet** afin que nous puissions tester hello runbook.</span><span class="sxs-lookup"><span data-stu-id="1f540-196">Click **Test pane** so that we can test hello runbook.</span></span>
6. <span data-ttu-id="1f540-197">Cliquez sur **Démarrer** test de hello toostart.</span><span class="sxs-lookup"><span data-stu-id="1f540-197">Click **Start** toostart hello test.</span></span> <span data-ttu-id="1f540-198">Une fois terminée, vous devez recevoir toohello similaire de sortie suivant, l’affichage des informations de base à partir de votre compte.</span><span class="sxs-lookup"><span data-stu-id="1f540-198">Once it completes, you should receive output similar toohello following, displaying basic information from your account.</span></span> <span data-ttu-id="1f540-199">Cela confirme que ces informations d’identification hello sont valide.</span><span class="sxs-lookup"><span data-stu-id="1f540-199">This confirms that hello credential is valid.</span></span><br><br> <span data-ttu-id="1f540-200">![Authentifier](media/automation-first-runbook-textual/runbook-auth-output.png)</span><span class="sxs-lookup"><span data-stu-id="1f540-200">![Authenticate](media/automation-first-runbook-textual/runbook-auth-output.png)</span></span>

## <a name="step-6---add-code-toostart-a-virtual-machine"></a><span data-ttu-id="1f540-201">Étape 6 : ajouter du code toostart une machine virtuelle</span><span class="sxs-lookup"><span data-stu-id="1f540-201">Step 6 - Add code toostart a virtual machine</span></span>
<span data-ttu-id="1f540-202">Maintenant que notre runbook authentifie tooour abonnement Azure, nous pouvons gérer les ressources.</span><span class="sxs-lookup"><span data-stu-id="1f540-202">Now that our runbook is authenticating tooour Azure subscription, we can manage resources.</span></span> <span data-ttu-id="1f540-203">Nous ajoutons un toostart commande une machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="1f540-203">We add a command toostart a virtual machine.</span></span> <span data-ttu-id="1f540-204">Vous pouvez choisir n’importe quel ordinateur virtuel dans votre abonnement Azure, et pour l’instant, nous sera coder en dur ce nom dans les runbook hello.</span><span class="sxs-lookup"><span data-stu-id="1f540-204">You can pick any virtual machine in your Azure subscription, and for now we will be hardcoding that name in hello runbook.</span></span>

1. <span data-ttu-id="1f540-205">Après avoir *Add-AzureRmAccount*, type *AzureRmVM de démarrage-nom 'VMName' - ResourceGroupName 'NameofResourceGroup'* fournissant les noms de hello et groupe de ressources de toostart de machine virtuelle hello.</span><span class="sxs-lookup"><span data-stu-id="1f540-205">After *Add-AzureRmAccount*, type *Start-AzureRmVM -Name 'VMName' -ResourceGroupName 'NameofResourceGroup'* providing hello name and Resource Group name of hello virtual machine toostart.</span></span>  

   ```
   workflow MyFirstRunbook-Workflow
   {
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID -ApplicationId $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   Start-AzureRmVM -Name 'VMName' -ResourceGroupName 'ResourceGroupName'
   }
   ```
2. <span data-ttu-id="1f540-206">Enregistrer hello runbook, puis cliquez sur **Test volet** afin que nous puissions le tester.</span><span class="sxs-lookup"><span data-stu-id="1f540-206">Save hello runbook and then click **Test pane** so that we can test it.</span></span>
3. <span data-ttu-id="1f540-207">Cliquez sur **Démarrer** test de hello toostart.</span><span class="sxs-lookup"><span data-stu-id="1f540-207">Click **Start** toostart hello test.</span></span> <span data-ttu-id="1f540-208">Une fois terminée, vérifiez que l’ordinateur virtuel hello a été démarré.</span><span class="sxs-lookup"><span data-stu-id="1f540-208">Once it completes, check that hello virtual machine was started.</span></span>

## <a name="step-7---add-an-input-parameter-toohello-runbook"></a><span data-ttu-id="1f540-209">Étape 7 : ajouter un runbook toohello de paramètre d’entrée</span><span class="sxs-lookup"><span data-stu-id="1f540-209">Step 7 - Add an input parameter toohello runbook</span></span>
<span data-ttu-id="1f540-210">Notre runbook démarre actuellement hello virtuel de l’ordinateur que nous codé en dur dans les runbook hello, mais il est plus utile si nous pouvons spécifier virtuels hello lorsque hello runbook est démarré.</span><span class="sxs-lookup"><span data-stu-id="1f540-210">Our runbook currently starts hello virtual machine that we hardcoded in hello runbook, but it would be more useful if we could specify hello virtual machine when hello runbook is started.</span></span> <span data-ttu-id="1f540-211">Nous allons maintenant ajouter des paramètres d’entrée toohello runbook tooprovide cette fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="1f540-211">We will now add input parameters toohello runbook tooprovide that functionality.</span></span>

1. <span data-ttu-id="1f540-212">Ajouter des paramètres pour *VMName* et *ResourceGroupName* toohello runbook et utilisation de ces variables hello **AzureRmVM de début** applet de commande comme exemple hello ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="1f540-212">Add parameters for *VMName* and *ResourceGroupName* toohello runbook and use these variables with hello **Start-AzureRmVM** cmdlet as in hello example below.</span></span>

   ```
   workflow MyFirstRunbook-Workflow
   {
    Param(
     [string]$VMName,
     [string]$ResourceGroupName
    )  
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID -ApplicationId $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   Start-AzureRmVM -Name $VMName -ResourceGroupName $ResourceGroupName
   }
   ```
2. <span data-ttu-id="1f540-213">Enregistrer les runbook hello et ouvrir le volet de Test hello.</span><span class="sxs-lookup"><span data-stu-id="1f540-213">Save hello runbook and open hello Test pane.</span></span> <span data-ttu-id="1f540-214">Notez que vous pouvez maintenant fournir des valeurs pour hello deux variables d’entrée qui seront utilisées dans le test de hello.</span><span class="sxs-lookup"><span data-stu-id="1f540-214">Note that you can now provide values for hello two input variables that will be used in hello test.</span></span>
3. <span data-ttu-id="1f540-215">Volet de Test hello fermer.</span><span class="sxs-lookup"><span data-stu-id="1f540-215">Close hello Test pane.</span></span>
4. <span data-ttu-id="1f540-216">Cliquez sur **publier** toopublish hello nouvelle version du runbook de hello.</span><span class="sxs-lookup"><span data-stu-id="1f540-216">Click **Publish** toopublish hello new version of hello runbook.</span></span>
5. <span data-ttu-id="1f540-217">Arrêter la machine virtuelle hello que vous avez démarrées à l’étape précédente de hello.</span><span class="sxs-lookup"><span data-stu-id="1f540-217">Stop hello virtual machine that you started in hello previous step.</span></span>
6. <span data-ttu-id="1f540-218">Cliquez sur **Démarrer** toostart hello runbook.</span><span class="sxs-lookup"><span data-stu-id="1f540-218">Click **Start** toostart hello runbook.</span></span> <span data-ttu-id="1f540-219">Type Bonjour **VMName** et **ResourceGroupName** pour la machine virtuelle de hello que vous allez toostart.</span><span class="sxs-lookup"><span data-stu-id="1f540-219">Type in hello **VMName** and **ResourceGroupName** for hello virtual machine that you're going toostart.</span></span><br><br> <span data-ttu-id="1f540-220">![Start Runbook](media/automation-first-runbook-textual/automation-pass-params.png)</span><span class="sxs-lookup"><span data-stu-id="1f540-220">![Start Runbook](media/automation-first-runbook-textual/automation-pass-params.png)</span></span><br>  
7. <span data-ttu-id="1f540-221">Lorsque hello runbook est terminée, vérifiez que l’ordinateur virtuel hello a été démarré.</span><span class="sxs-lookup"><span data-stu-id="1f540-221">When hello runbook completes, check that hello virtual machine was started.</span></span>  

## <a name="next-steps"></a><span data-ttu-id="1f540-222">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="1f540-222">Next steps</span></span>
* <span data-ttu-id="1f540-223">tooget main runbooks graphiques, consultez [mon premier runbook graphique](automation-first-runbook-graphical.md)</span><span class="sxs-lookup"><span data-stu-id="1f540-223">tooget started with Graphical runbooks, see [My first graphical runbook](automation-first-runbook-graphical.md)</span></span>
* <span data-ttu-id="1f540-224">tooget main runbook PowerShell, consultez [mon premier runbook de PowerShell](automation-first-runbook-textual-powershell.md)</span><span class="sxs-lookup"><span data-stu-id="1f540-224">tooget started with PowerShell runbooks, see [My first PowerShell runbook](automation-first-runbook-textual-powershell.md)</span></span>
* <span data-ttu-id="1f540-225">toolearn en savoir plus sur les types de runbook, leurs avantages et les limitations, consultez [types de runbook Azure Automation](automation-runbook-types.md)</span><span class="sxs-lookup"><span data-stu-id="1f540-225">toolearn more about runbook types, their advantages and limitations, see [Azure Automation runbook types](automation-runbook-types.md)</span></span>
* <span data-ttu-id="1f540-226">Pour plus d’informations sur la fonctionnalité de prise en charge de script PowerShell, consultez [Prise en charge de script PowerShell natif dans Azure Automation](https://azure.microsoft.com/blog/announcing-powershell-script-support-azure-automation-2/)</span><span class="sxs-lookup"><span data-stu-id="1f540-226">For more information on PowerShell script support feature, see [Native PowerShell script support in Azure Automation](https://azure.microsoft.com/blog/announcing-powershell-script-support-azure-automation-2/)</span></span>
