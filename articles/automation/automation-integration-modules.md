---
title: "aaaCreate un Module d’intégration Azure Automation | Documents Microsoft"
description: "Didacticiel qui vous guide à l’aide de la création, le test et exemple hello des modules d’intégration dans Azure Automation."
services: automation
documentationcenter: 
author: mgoedtel
manager: jwhit
editor: 
ms.assetid: 27798efb-08b9-45d9-9b41-5ad91a3df41e
ms.service: automation
ms.workload: infrastructure-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 01/13/2017
ms.author: magoedte
ms.openlocfilehash: d4064d8b106496f4dab442024131886c4affccab
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="azure-automation-integration-modules"></a><span data-ttu-id="38a9b-103">Modules d’intégration Azure Automation</span><span class="sxs-lookup"><span data-stu-id="38a9b-103">Azure Automation Integration Modules</span></span>
<span data-ttu-id="38a9b-104">PowerShell est la technologie fondamentaux hello Azure Automation.</span><span class="sxs-lookup"><span data-stu-id="38a9b-104">PowerShell is hello fundamental technology behind Azure Automation.</span></span> <span data-ttu-id="38a9b-105">Étant donné que Azure Automation est basée sur PowerShell, modules PowerShell sont extensibilité toohello clé d’Azure Automation.</span><span class="sxs-lookup"><span data-stu-id="38a9b-105">Since Azure Automation is built on PowerShell, PowerShell modules are key toohello extensibility of Azure Automation.</span></span> <span data-ttu-id="38a9b-106">Dans cet article, nous vous guidera tout au long des spécificités de hello d’utilisation d’Azure Automation de modules PowerShell visé tooas « Modules d’intégration » et meilleures pratiques pour la création de votre propre toomake de modules PowerShell assurer qu'elles fonctionnent comme des Modules d’intégration dans Azure Automation.</span><span class="sxs-lookup"><span data-stu-id="38a9b-106">In this article, we will guide you through hello specifics of Azure Automation’s use of PowerShell modules, referred tooas “Integration Modules”, and best practices for creating your own PowerShell modules toomake sure they work as Integration Modules within Azure Automation.</span></span> 

## <a name="what-is-a-powershell-module"></a><span data-ttu-id="38a9b-107">Qu’est-ce qu’un module PowerShell ?</span><span class="sxs-lookup"><span data-stu-id="38a9b-107">What is a PowerShell Module?</span></span>
<span data-ttu-id="38a9b-108">Un module PowerShell est un groupe d’applets de commande PowerShell comme **Get-Date** ou **Copy-Item**, qui peut être utilisé à partir de la console PowerShell de hello, les scripts, les flux de travail, les runbooks et les ressources DSC PowerShell telles que WindowsFeature ou fichier, qui peut être utilisé dans les configurations DSC PowerShell.</span><span class="sxs-lookup"><span data-stu-id="38a9b-108">A PowerShell module is a group of PowerShell cmdlets like **Get-Date** or **Copy-Item**, that can be used from hello PowerShell console, scripts, workflows, runbooks, and PowerShell DSC resources like WindowsFeature or File, that can be used from PowerShell DSC configurations.</span></span> <span data-ttu-id="38a9b-109">Toutes les fonctionnalités de hello de PowerShell est exposée via les applets de commande et des ressources DSC, et toutes les ressources DSC / l’applet de commande sont soutenu par un module PowerShell, un grand nombre des qui sont fournis avec PowerShell.</span><span class="sxs-lookup"><span data-stu-id="38a9b-109">All of hello functionality of PowerShell is exposed through cmdlets and DSC resources, and every cmdlet/DSC resource is backed by a PowerShell module, many of which ship with PowerShell itself.</span></span> <span data-ttu-id="38a9b-110">Par exemple, hello **Get-Date** applet de commande fait partie du module Microsoft.PowerShell.Utility PowerShell, de hello et **Copy-Item** applet de commande fait partie du module Microsoft.PowerShell.Management PowerShell de hello et Hello ressource DSC de Package fait partie de hello module PSDesiredStateConfiguration PowerShell.</span><span class="sxs-lookup"><span data-stu-id="38a9b-110">For example, hello **Get-Date** cmdlet is part of hello Microsoft.PowerShell.Utility PowerShell module, and **Copy-Item** cmdlet is part of hello Microsoft.PowerShell.Management PowerShell module and hello Package DSC resource is part of hello PSDesiredStateConfiguration PowerShell module.</span></span> <span data-ttu-id="38a9b-111">Ces deux modules sont fournis avec PowerShell.</span><span class="sxs-lookup"><span data-stu-id="38a9b-111">Both of these modules ship with PowerShell.</span></span> <span data-ttu-id="38a9b-112">Mais un nombre de modules PowerShell ne sont pas fournis dans le cadre de PowerShell et est distribuée à la place avec les produits tiers ou première tels que System Center 2012 Configuration Manager ou de hello grande PowerShell Communauté sur emplacements tels que PowerShell Gallery.</span><span class="sxs-lookup"><span data-stu-id="38a9b-112">But many PowerShell modules do not ship as part of PowerShell, and are instead distributed with first or third-party products like System Center 2012 Configuration Manager or by hello vast PowerShell community on places like PowerShell Gallery.</span></span>  <span data-ttu-id="38a9b-113">modules de Hello sont utiles car ils simplifient les tâches complexes via la fonctionnalité encapsulée.</span><span class="sxs-lookup"><span data-stu-id="38a9b-113">hello modules are useful because they make complex tasks simpler through encapsulated functionality.</span></span>  <span data-ttu-id="38a9b-114">Vous pouvez en savoir plus sur les [modules PowerShell sur MSDN](https://msdn.microsoft.com/library/dd878324%28v=vs.85%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="38a9b-114">You can learn more about [PowerShell modules on MSDN](https://msdn.microsoft.com/library/dd878324%28v=vs.85%29.aspx).</span></span> 

## <a name="what-is-an-azure-automation-integration-module"></a><span data-ttu-id="38a9b-115">Qu’est-ce qu’un module d’intégration Azure Automation ?</span><span class="sxs-lookup"><span data-stu-id="38a9b-115">What is an Azure Automation Integration Module?</span></span>
<span data-ttu-id="38a9b-116">Un module d’intégration n’est pas très différent d’un module PowerShell.</span><span class="sxs-lookup"><span data-stu-id="38a9b-116">An Integration Module isn't very different from a PowerShell module.</span></span> <span data-ttu-id="38a9b-117">Son simplement un module PowerShell qui contient éventuellement un fichier supplémentaire - un fichier de métadonnées en spécifiant un toobe de type de connexion Azure Automation utilisé avec les applets de commande du module hello dans les runbooks.</span><span class="sxs-lookup"><span data-stu-id="38a9b-117">Its simply a PowerShell module that optionally contains one additional file - a metadata file specifying an Azure Automation connection type toobe used with hello module's cmdlets in runbooks.</span></span> <span data-ttu-id="38a9b-118">Facultatif du fichier ou non, ces modules peuvent être importés dans toomake Azure Automation des applets de commande disponibles pour les utilisent dans des procédures opérationnelles et de leurs ressources DSC disponibles pour une utilisation dans les configurations DSC de PowerShell.</span><span class="sxs-lookup"><span data-stu-id="38a9b-118">Optional file or not, these PowerShell modules can be imported into Azure Automation toomake their cmdlets available for use within runbooks and their DSC resources available for use within DSC configurations.</span></span> <span data-ttu-id="38a9b-119">Coulisses de hello, Azure Automation stocke ces modules et au moment de l’exécution de travaux de compilation DSC et à la tâche du runbook, il les charge dans sandbox d’Azure Automation hello où les runbooks sont exécutés et les configurations DSC sont compilées.</span><span class="sxs-lookup"><span data-stu-id="38a9b-119">Behind hello scenes, Azure Automation stores these modules, and at runbook job and DSC compilation job execution time, loads them into hello Azure Automation sandboxes where runbooks are executed and DSC configurations are compiled.</span></span>  <span data-ttu-id="38a9b-120">Toutes les ressources DSC dans les modules sont placés automatiquement sur le serveur de collecteur hello Automation DSC, afin qu’ils peuvent être extraites par les ordinateurs de tooapply les configurations DSC.</span><span class="sxs-lookup"><span data-stu-id="38a9b-120">Any DSC resources in modules are also automatically placed on hello Automation DSC pull server, so that they can be pulled by machines attempting tooapply DSC configurations.</span></span>  

<span data-ttu-id="38a9b-121">Nous livrer un nombre de modules Azure PowerShell en dehors de la zone hello dans Azure Automation pour vous toouse afin de commencer à automatiser la gestion de Azure immédiatement, mais vous pouvez importer des modules PowerShell pour le système, un service ou un outil que vous souhaitez utiliser toointegrate avec.</span><span class="sxs-lookup"><span data-stu-id="38a9b-121">We ship a number of Azure  PowerShell modules out of hello box in Azure Automation for you toouse so you can get started automating Azure management right away, but you can import PowerShell modules for whatever system, service, or tool you want toointegrate with.</span></span> 

> [!NOTE]
> <span data-ttu-id="38a9b-122">Certains modules sont fournis en tant que « modules globales » dans le service d’automatisation hello.</span><span class="sxs-lookup"><span data-stu-id="38a9b-122">Certain modules are shipped as “global modules” in hello Automation service.</span></span> <span data-ttu-id="38a9b-123">Ces modules globaux sont tooyou disponible lorsque vous créez un compte automation, et nous les mettre à jour parfois qui les envoie automatiquement les comptes d’automation tooyour.</span><span class="sxs-lookup"><span data-stu-id="38a9b-123">These global modules are available tooyou when you create an automation account, and we update them sometimes which automatically pushes them out tooyour automation account.</span></span> <span data-ttu-id="38a9b-124">Si vous ne souhaitez pas les toobe à jour automatiquement, vous pouvez toujours importer hello même module vous-même, et qui ont priorité sur la version du module global hello de ce module nous fournis dans le service hello.</span><span class="sxs-lookup"><span data-stu-id="38a9b-124">If you don’t want them toobe auto-updated, you can always import hello same module yourself, and that will take precedence over hello global module version of that module that we ship in hello service.</span></span> 

<span data-ttu-id="38a9b-125">format Hello dans laquelle importer un package de Module d’intégration est un fichier compressé portant le même nom de module de hello et l’extension .zip de hello.</span><span class="sxs-lookup"><span data-stu-id="38a9b-125">hello format in which you import an Integration Module package is a compressed file with hello same name as hello module and a .zip extension.</span></span> <span data-ttu-id="38a9b-126">Il contient le module Windows PowerShell de hello et tous les fichiers de prise en charge, y compris un fichier manifeste (.psd1) si le module de hello a un.</span><span class="sxs-lookup"><span data-stu-id="38a9b-126">It contains hello Windows PowerShell module and any supporting files, including a manifest file (.psd1) if hello module has one.</span></span>

<span data-ttu-id="38a9b-127">Si le module de hello doit contenir un type de connexion Azure Automation, il doit également contenir un fichier portant le nom de hello `<ModuleName>-Automation.json` qui spécifie les propriétés de type de connexion hello.</span><span class="sxs-lookup"><span data-stu-id="38a9b-127">If hello module should contain an Azure Automation connection type, it must also contain a file with hello name `<ModuleName>-Automation.json` that specifies hello connection type properties.</span></span> <span data-ttu-id="38a9b-128">Ceci est un fichier json placé dans le dossier du module hello de votre fichier .zip compressé et contient des champs de hello d’une « connexion », qui est requis tooconnect toohello système ou service hello module représente.</span><span class="sxs-lookup"><span data-stu-id="38a9b-128">This is a json file placed within hello module folder of your compressed .zip file, and contains hello fields of a “connection” that is required tooconnect toohello system or service hello module represents.</span></span> <span data-ttu-id="38a9b-129">Ceci créera un type de connexion dans Azure Automation.</span><span class="sxs-lookup"><span data-stu-id="38a9b-129">This will end up creating a connection type in Azure Automation.</span></span> <span data-ttu-id="38a9b-130">À l’aide de ce fichier, vous pouvez définir des noms de champ de hello, types, et indique si les champs de hello doivent être chiffrées et/ou facultatifs pour le type de connexion hello du module de hello.</span><span class="sxs-lookup"><span data-stu-id="38a9b-130">Using this file you can set hello field names, types, and whether hello fields should be encrypted and / or optional, for hello connection type of hello module.</span></span> <span data-ttu-id="38a9b-131">Hello Voici un modèle au format json hello :</span><span class="sxs-lookup"><span data-stu-id="38a9b-131">hello following is a template in hello json file format:</span></span>

```
{ 
   "ConnectionFields": [
   {
      "IsEncrypted":  false,
      "IsOptional":  false,
      "Name":  "ComputerName",
      "TypeName":  "System.String"
   },
   {
      "IsEncrypted":  false,
      "IsOptional":  true,
      "Name":  "Username",
      "TypeName":  "System.String"
   },
   {
      "IsEncrypted":  true,
      "IsOptional":  false,
      "Name":  "Password",
   "TypeName":  "System.String"
   }],
   "ConnectionTypeName":  "DataProtectionManager",
   "IntegrationModuleName":  "DataProtectionManager"
}
```

<span data-ttu-id="38a9b-132">Si vous avez déployé le Service Management Automation et créé les packages de Modules d’intégration de vos runbooks automation, cela doit ressembler tooyou très familier.</span><span class="sxs-lookup"><span data-stu-id="38a9b-132">If you have deployed Service Management Automation and created Integration Modules packages for your automation runbooks, this should look very familiar tooyou.</span></span> 

## <a name="authoring-best-practices"></a><span data-ttu-id="38a9b-133">Établissement de meilleures pratiques</span><span class="sxs-lookup"><span data-stu-id="38a9b-133">Authoring Best Practices</span></span>
<span data-ttu-id="38a9b-134">Bien que les Modules d’intégration sont essentiellement des modules PowerShell, il est toujours un nombre de choses que nous vous recommandons d’envisager lors de la création d’un module PowerShell, toomake il est plus utilisable dans Azure Automation.</span><span class="sxs-lookup"><span data-stu-id="38a9b-134">Even though Integration Modules are essentially PowerShell modules, there’s still a number of things we recommend you consider while authoring a PowerShell module, toomake it most usable in Azure Automation.</span></span> <span data-ttu-id="38a9b-135">Certaines sont spécifiques à Azure Automation, et certaines d'entre elles sont utile toomake simplement vos modules fonctionnent correctement dans les flux de travail PowerShell, indépendamment de si vous utilisez l’Automation.</span><span class="sxs-lookup"><span data-stu-id="38a9b-135">Some of these are Azure Automation specific, and some of them are useful just toomake your modules work well in PowerShell Workflow, regardless of whether or not you’re using Automation.</span></span> 

1. <span data-ttu-id="38a9b-136">Inclure un résumé des différentes, description et aider à des URI pour chaque applet de commande dans le module de hello.</span><span class="sxs-lookup"><span data-stu-id="38a9b-136">Include a synopsis, description, and help URI for every cmdlet in hello module.</span></span> <span data-ttu-id="38a9b-137">Dans PowerShell, vous pouvez définir certaines informations d’aide pour l’aide d’applets de commande tooallow hello utilisateur tooreceive sur leur utilisation avec hello **Get-Help** applet de commande.</span><span class="sxs-lookup"><span data-stu-id="38a9b-137">In PowerShell, you can define certain help information for cmdlets tooallow hello user tooreceive help on using them with hello **Get-Help** cmdlet.</span></span> <span data-ttu-id="38a9b-138">Par exemple, voici comment définir un synopsis et l’URI d’aide pour un module PowerShell écrit dans un fichier .psm1.</span><span class="sxs-lookup"><span data-stu-id="38a9b-138">For example, here’s how you can define a synopsis and help URI for a PowerShell module written in a .psm1 file.</span></span><br>  
   
    ```
    <#
        .SYNOPSIS
         Gets all outgoing phone numbers for this Twilio account 
    #>
    function Get-TwilioPhoneNumbers {
    [CmdletBinding(DefaultParameterSetName='SpecifyConnectionFields', `
    HelpUri='http://www.twilio.com/docs/api/rest/outgoing-caller-ids')]
    param(
       [Parameter(ParameterSetName='SpecifyConnectionFields', Mandatory=$true)]
       [ValidateNotNullOrEmpty()]
       [string]
       $AccountSid,
   
       [Parameter(ParameterSetName='SpecifyConnectionFields', Mandatory=$true)]
       [ValidateNotNullOrEmpty()]
       [string]
       $AuthToken,
   
       [Parameter(ParameterSetName='UseConnectionObject', Mandatory=$true)]
       [ValidateNotNullOrEmpty()]
       [Hashtable]
       $Connection
    )
   
    $cred = CreateTwilioCredential -Connection $Connection -AccountSid $AccountSid -AuthToken $AuthToken
   
    $uri = "$TWILIO_BASE_URL/Accounts/" + $cred.UserName + "/IncomingPhoneNumbers"
   
    $response = Invoke-RestMethod -Method Get -Uri $uri -Credential $cred
   
    $response.TwilioResponse.IncomingPhoneNumbers.IncomingPhoneNumber
    }
    ```
   <br> <span data-ttu-id="38a9b-139">Fournir ces informations uniquement n’affichera pas cette aide à l’aide de hello **Get-Help** applet de commande hello console PowerShell, il expose également cette fonctionnalité d’aide dans Azure Automation.</span><span class="sxs-lookup"><span data-stu-id="38a9b-139">Providing this info will not only show this help using hello **Get-Help** cmdlet in hello PowerShell console, it will also expose this help functionality within Azure Automation.</span></span>  <span data-ttu-id="38a9b-140">Par exemple, lors de l’insertion d’activités lors de la création de runbook.</span><span class="sxs-lookup"><span data-stu-id="38a9b-140">For example, when inserting activities during runbook authoring.</span></span> <span data-ttu-id="38a9b-141">Cliquez sur « Afficher une aide détaillée » sera aide hello ouvrir URI dans un autre onglet de hello navigateur web à l’aide de tooaccess Azure Automation.</span><span class="sxs-lookup"><span data-stu-id="38a9b-141">Clicking “View detailed help” will open hello help URI in another tab of hello web browser you’re using tooaccess Azure Automation.</span></span><br><span data-ttu-id="38a9b-142">![Aide du module d’intégration](media/automation-integration-modules/automation-integration-module-activitydesc.png)</span><span class="sxs-lookup"><span data-stu-id="38a9b-142">![Integration Module Help](media/automation-integration-modules/automation-integration-module-activitydesc.png)</span></span>
2. <span data-ttu-id="38a9b-143">Si le module de hello s’exécute sur un système distant,</span><span class="sxs-lookup"><span data-stu-id="38a9b-143">If hello module runs against a remote system,</span></span>

    <span data-ttu-id="38a9b-144">a.</span><span class="sxs-lookup"><span data-stu-id="38a9b-144">a.</span></span> <span data-ttu-id="38a9b-145">Elle doit contenir un fichier de métadonnées du Module d’intégration qui définit hello informations nécessaires tooconnect toothat système distant, ce qui signifie le type de connexion hello.</span><span class="sxs-lookup"><span data-stu-id="38a9b-145">It should contain an Integration Module metadata file that defines hello information needed tooconnect toothat remote system, meaning hello connection type.</span></span>  
    <span data-ttu-id="38a9b-146">b.</span><span class="sxs-lookup"><span data-stu-id="38a9b-146">b.</span></span> <span data-ttu-id="38a9b-147">Chaque applet de commande dans le module de hello doit être en mesure de tootake dans un objet de connexion (il s’agit d’une instance de ce type de connexion) en tant que paramètre.</span><span class="sxs-lookup"><span data-stu-id="38a9b-147">Each cmdlet in hello module should be able tootake in a connection object (an instance of that connection type) as a parameter.</span></span>  

    <span data-ttu-id="38a9b-148">Applets de commande hello module deviennent toouse plus facile dans Azure Automation si vous autorisez le passage d’un objet avec des champs hello hello du type de connexion en tant qu’une applet de commande de toohello de paramètre.</span><span class="sxs-lookup"><span data-stu-id="38a9b-148">Cmdlets in hello module become easier toouse in Azure Automation if you allow passing an object with hello fields of hello connection type as a parameter toohello cmdlet.</span></span> <span data-ttu-id="38a9b-149">Ainsi, les utilisateurs n’ont pas les paramètres de toomap de paramètres correspondants de hello connexion asset toohello l’applet de commande chaque fois qu’ils appellent une applet de commande.</span><span class="sxs-lookup"><span data-stu-id="38a9b-149">This way users don’t have toomap parameters of hello connection asset toohello cmdlet's corresponding parameters each time they call a cmdlet.</span></span> <span data-ttu-id="38a9b-150">En fonction de l’exemple de runbook hello ci-dessus, il utilise une ressource de connexion Twilio appelée CorpTwilio tooaccess Twilio et retourner tous les numéros de téléphone hello dans le compte de hello.</span><span class="sxs-lookup"><span data-stu-id="38a9b-150">Based on hello runbook example above, it uses a Twilio connection asset called CorpTwilio tooaccess Twilio and return all hello phone numbers in hello account.</span></span>  <span data-ttu-id="38a9b-151">Notez comment il consiste à mapper les champs hello hello toohello des paramètres de connexion de l’applet de commande hello ?</span><span class="sxs-lookup"><span data-stu-id="38a9b-151">Notice how it is mapping hello fields of hello connection toohello parameters of hello cmdlet?</span></span><br>
   
    ```
    workflow Get-CorpTwilioPhones
    {
      $CorpTwilio = Get-AutomationConnection -Name 'CorpTwilio'
   
      Get-TwilioPhoneNumbers 
        -AccountSid $CorpTwilio.AccountSid  
        -AuthToken $CorptTwilio.AuthToken
    }
    ```
  
    <span data-ttu-id="38a9b-152">Un tooapproach de manière plus simple et une meilleure cela est directement le passage d’applet de commande de toohello de hello connexion object-</span><span class="sxs-lookup"><span data-stu-id="38a9b-152">An easier and better way tooapproach this is directly passing hello connection object toohello cmdlet -</span></span>
   
    ```
    workflow Get-CorpTwilioPhones
    {
      $CorpTwilio = Get-AutomationConnection -Name 'CorpTwilio'
   
      Get-TwilioPhoneNumbers -Connection $CorpTwilio
    }
    ```
   
    <span data-ttu-id="38a9b-153">Vous pouvez activer le comportement comme suit pour vos applets de commande en les autorisant tooaccept un objet de connexion directement en tant que paramètre, au lieu de simplement les champs de connexion pour les paramètres.</span><span class="sxs-lookup"><span data-stu-id="38a9b-153">You can enable behavior like this for your cmdlets by allowing them tooaccept a connection object directly as a parameter, instead of just connection fields for parameters.</span></span> <span data-ttu-id="38a9b-154">Vous souhaiterez généralement un jeu de paramètres pour chacun, afin que l’utilisateur ne pas à l’aide d’Azure Automation peut appeler vos applets de commande sans faire appel à une tooact de la table de hachage en tant qu’objet de connexion hello.</span><span class="sxs-lookup"><span data-stu-id="38a9b-154">Usually you’ll want a parameter set for each, so that a user not using Azure Automation can call your cmdlets without constructing a hashtable tooact as hello connection object.</span></span> <span data-ttu-id="38a9b-155">Jeu de paramètres **SpecifyConnectionFields** Voici toopass utilisé les propriétés de champ de connexion hello un par un.</span><span class="sxs-lookup"><span data-stu-id="38a9b-155">Parameter set **SpecifyConnectionFields** below is used toopass hello connection field properties one by one.</span></span> <span data-ttu-id="38a9b-156">**UseConnectionObject** vous permet de transmettre hello directement par le biais de la connexion.</span><span class="sxs-lookup"><span data-stu-id="38a9b-156">**UseConnectionObject** lets you pass hello connection straight through.</span></span> <span data-ttu-id="38a9b-157">Comme vous pouvez le voir, hello applet de commande Send-TwilioSMS Bonjour [module PowerShell de Twilio](https://gallery.technet.microsoft.com/scriptcenter/Twilio-PowerShell-Module-8a8bfef8) permet le passage dans les deux cas :</span><span class="sxs-lookup"><span data-stu-id="38a9b-157">As you can see, hello Send-TwilioSMS cmdlet in hello [Twilio PowerShell module](https://gallery.technet.microsoft.com/scriptcenter/Twilio-PowerShell-Module-8a8bfef8) allows passing either way:</span></span> 
   
    ```
    function Send-TwilioSMS {
      [CmdletBinding(DefaultParameterSetName='SpecifyConnectionFields', `
      HelpUri='http://www.twilio.com/docs/api/rest/sending-sms')]
      param(
         [Parameter(ParameterSetName='SpecifyConnectionFields', Mandatory=$true)]
         [ValidateNotNullOrEmpty()]
         [string]
         $AccountSid,
   
         [Parameter(ParameterSetName='SpecifyConnectionFields', Mandatory=$true)]
         [ValidateNotNullOrEmpty()]
         [string]
         $AuthToken,
   
         [Parameter(ParameterSetName='UseConnectionObject', Mandatory=$true)]
         [ValidateNotNullOrEmpty()]
         [Hashtable]
         $Connection
   
       )
    }
    ```
   <br>
3. <span data-ttu-id="38a9b-158">Définir le type de sortie pour toutes les applets de commande dans le module de hello.</span><span class="sxs-lookup"><span data-stu-id="38a9b-158">Define output type for all cmdlets in hello module.</span></span> <span data-ttu-id="38a9b-159">Définition d’un type de sortie pour une applet de commande permet à IntelliSense au moment du design toohelp vous hello Déterminez les propriétés de l’applet de commande hello, pour une utilisation lors de la création de sortie.</span><span class="sxs-lookup"><span data-stu-id="38a9b-159">Defining an output type for a cmdlet allows design-time IntelliSense toohelp you determine hello output properties of hello cmdlet, for use during authoring.</span></span> <span data-ttu-id="38a9b-160">Cela est particulièrement utile lors de l’Automation runbook graphique de création, où les connaissances des temps de conception est tooan clé facile confort d’utilisation avec le module.</span><span class="sxs-lookup"><span data-stu-id="38a9b-160">It is especially helpful during Automation runbook graphical authoring, where design time knowledge is key tooan easy user experience with your module.</span></span><br><br> <span data-ttu-id="38a9b-161">![Type de sortie de Runbook graphique](media/automation-integration-modules/runbook-graphical-module-output-type.png)</span><span class="sxs-lookup"><span data-stu-id="38a9b-161">![Graphical Runbook Output Type](media/automation-integration-modules/runbook-graphical-module-output-type.png)</span></span><br> <span data-ttu-id="38a9b-162">Cela s’apparente toohello « de type avance » de fonctionnalité d’applet de commande de sortie dans PowerShell ISE sans avoir toorun il.</span><span class="sxs-lookup"><span data-stu-id="38a9b-162">This is similar toohello "type ahead" functionality of a cmdlet's output in PowerShell ISE without having toorun it.</span></span><br><br> <span data-ttu-id="38a9b-163">![POSH IntelliSense](media/automation-integration-modules/automation-posh-ise-intellisense.png)</span><span class="sxs-lookup"><span data-stu-id="38a9b-163">![POSH IntelliSense](media/automation-integration-modules/automation-posh-ise-intellisense.png)</span></span><br>
4. <span data-ttu-id="38a9b-164">Applets de commande hello module ne nécessite pas de types d’objet complexe pour les paramètres.</span><span class="sxs-lookup"><span data-stu-id="38a9b-164">Cmdlets in hello module should not take complex object types for parameters.</span></span> <span data-ttu-id="38a9b-165">La différence entre PowerShell et le Workflow PowerShell réside dans le fait que ce dernier stocke des types complexes sous forme désérialisée.</span><span class="sxs-lookup"><span data-stu-id="38a9b-165">PowerShell Workflow is different from PowerShell in that it stores complex types in deserialized form.</span></span> <span data-ttu-id="38a9b-166">Les types primitifs resteront en tant que primitives, mais les types complexes sont les versions tootheir converti désérialisé, qui sont essentiellement des conteneurs de propriétés.</span><span class="sxs-lookup"><span data-stu-id="38a9b-166">Primitive types will stay as primitives, but complex types are converted tootheir deserialized versions, which are essentially property bags.</span></span> <span data-ttu-id="38a9b-167">Par exemple, si vous avez utilisé hello **Get-Process** applet de commande dans un runbook (ou un flux de travail PowerShell quel), il serait retournent un objet de type [Deserialized.System.Diagnostic.Process], pas hello [attendu Type de System.diagnostic.Process retournés].</span><span class="sxs-lookup"><span data-stu-id="38a9b-167">For example, if you used hello **Get-Process** cmdlet in a runbook (or a PowerShell Workflow for that matter), it would return an object of type [Deserialized.System.Diagnostic.Process], not hello expected [System.Diagnostic.Process] type.</span></span> <span data-ttu-id="38a9b-168">Ce type possède toutes les hello les mêmes propriétés que hello non désérialiser le type, mais aucune des méthodes de hello.</span><span class="sxs-lookup"><span data-stu-id="38a9b-168">This type has all hello same properties as hello non-deserialized type, but none of hello methods.</span></span> <span data-ttu-id="38a9b-169">Et si vous essayez de toopass cette valeur comme paramètre tooa applet de commande, où hello applet de commande attend une valeur de [System.diagnostic.Process retournés] pour ce paramètre, vous recevez hello l’erreur suivante : *ne peut pas traiter de transformation d’argument sur le paramètre « processus » . Erreur : « Impossible de convertir hello les valeur de « System.Diagnostics.Process (CcmExec) » de type « Deserialized.System.Diagnostics.Process » tootype « System.Diagnostics.Process ».*</span><span class="sxs-lookup"><span data-stu-id="38a9b-169">And if you try toopass this value as a parameter tooa cmdlet, where hello cmdlet expects a [System.Diagnostic.Process] value for this parameter, you’ll receive hello following error: *Cannot process argument transformation on parameter 'process'. Error: "Cannot convert hello "System.Diagnostics.Process (CcmExec)" value of type  "Deserialized.System.Diagnostics.Process" tootype "System.Diagnostics.Process".*</span></span>   <span data-ttu-id="38a9b-170">Il s’agit, car il existe qu'une incompatibilité de type entre hello attendu [System.diagnostic.Process retournés] type et hello [Deserialized.System.Diagnostic.Process] type donné.</span><span class="sxs-lookup"><span data-stu-id="38a9b-170">This is because there is a type mismatch between hello expected [System.Diagnostic.Process] type and hello given [Deserialized.System.Diagnostic.Process] type.</span></span> <span data-ttu-id="38a9b-171">Hello corriger ce problème consiste tooensure hello applets de commande de votre module ne prennent pas de types complexes pour les paramètres.</span><span class="sxs-lookup"><span data-stu-id="38a9b-171">hello way around this issue is tooensure hello cmdlets of your module do not take complex types for parameters.</span></span> <span data-ttu-id="38a9b-172">Voici hello mauvaise méthode toodo il.</span><span class="sxs-lookup"><span data-stu-id="38a9b-172">Here is hello wrong way toodo it.</span></span>
   
    ```
    function Get-ProcessDescription {
      param (
            [System.Diagnostic.Process] $process
      )
      $process.Description
    }
    ``` 
    <br>
    <span data-ttu-id="38a9b-173">Et Voici hello droite, dans une primitive qui peut être utilisée en interne par l’applet de commande hello toograb hello objet complexe et l’utiliser.</span><span class="sxs-lookup"><span data-stu-id="38a9b-173">And here is hello right way, taking in a primitive that can be used internally by hello cmdlet toograb hello complex object and use it.</span></span> <span data-ttu-id="38a9b-174">Étant donné que les applets de commande s’exécutent dans le contexte de hello de PowerShell, pas PowerShell Workflow, à l’intérieur d’applet de commande hello $process est de type hello correcte [System.diagnostic.Process retournés].</span><span class="sxs-lookup"><span data-stu-id="38a9b-174">Since cmdlets execute in hello context of PowerShell, not PowerShell Workflow, inside hello cmdlet $process becomes hello correct [System.Diagnostic.Process] type.</span></span>  
   
    ```
    function Get-ProcessDescription {
      param (
            [String] $processName
      )
      $process = Get-Process -Name $processName
   
      $process.Description
    }
    ```
   <br>
   <span data-ttu-id="38a9b-175">Ressources de connexion dans les runbooks sont des tables de hachage, qui sont un type complexe, et encore ces tables de hachage semblent toobe en mesure de toobe passé dans les applets de commande pour leurs : paramètre de connexion parfaitement, avec aucune exception de cast.</span><span class="sxs-lookup"><span data-stu-id="38a9b-175">Connection assets in runbooks are hashtables, which are a complex type, and yet these hashtables seem toobe able toobe passed into cmdlets for their –Connection parameter perfectly, with no cast exception.</span></span> <span data-ttu-id="38a9b-176">Techniquement, certains types de PowerShell sont en mesure de toocast correctement à partir de leur forme tootheir désérialisé de formulaire sérialisé et peuvent donc être passés dans les applets de commande pour les paramètres d’accepter le type de non désérialisé hello.</span><span class="sxs-lookup"><span data-stu-id="38a9b-176">Technically, some PowerShell types are able toocast properly from their serialized form tootheir deserialized form, and hence can be passed into cmdlets for parameters accepting hello non-deserialized type.</span></span> <span data-ttu-id="38a9b-177">La table de hachage fait partie de ces types.</span><span class="sxs-lookup"><span data-stu-id="38a9b-177">Hashtable is one of these.</span></span> <span data-ttu-id="38a9b-178">Il est possible pour toobe de types définis de l’auteur d’un module implémentée de manière à ce qu’ils capable de désérialiser correctement également, mais il existe certaines tooconsider compromis.</span><span class="sxs-lookup"><span data-stu-id="38a9b-178">It’s possible for a module author’s defined types toobe implemented in a way that they can correctly deserialize as well, but there are some trade-offs tooconsider.</span></span> <span data-ttu-id="38a9b-179">Hello type besoins toohave un constructeur par défaut, ont toutes ses propriétés de public et avoir un PSTypeConverter.</span><span class="sxs-lookup"><span data-stu-id="38a9b-179">hello type needs toohave a default constructor, have all of its properties public, and have a PSTypeConverter.</span></span> <span data-ttu-id="38a9b-180">Toutefois, pour les types déjà définis par cet auteur de module hello non propriétaire, il existe trop ne « corriger » les, donc hello recommandation tooavoid des types complexes pour l’ensemble de paramètres.</span><span class="sxs-lookup"><span data-stu-id="38a9b-180">However, for already-defined types that hello module author does not own, there is no way too“fix” them, hence hello recommendation tooavoid complex types for parameters all together.</span></span> <span data-ttu-id="38a9b-181">Création de runbooks de Conseil : si pour une raison quelconque vos applets de commande avez besoin de paramètre de type tootake un type complexe, ou à l’aide de module d’une autre personne qui requiert un paramètre de type complexe, la solution de contournement hello dans les runbooks PowerShell Workflow et les flux de travail PowerShell local PowerShell, est l’applet de commande toowrap hello qui génère le type complexe de hello et l’applet de commande hello qui utilise le type complexe de hello Bonjour même activité InlineScript.</span><span class="sxs-lookup"><span data-stu-id="38a9b-181">Runbook Authoring tip: If for some reason your cmdlets need tootake a complex type parameter, or you are using someone else’s module that requires a complex type parameter, hello workaround in PowerShell Workflow runbooks and PowerShell Workflows in local PowerShell, is toowrap hello cmdlet that generates hello complex type and hello cmdlet that consumes hello complex type in hello same InlineScript activity.</span></span> <span data-ttu-id="38a9b-182">Étant donné que InlineScript s’exécute à son contenu en tant que PowerShell plutôt que le flux de travail PowerShell, applet de commande hello génération de type complexe de hello génère ce type correct, pas hello désérialisé type complexe.</span><span class="sxs-lookup"><span data-stu-id="38a9b-182">Since InlineScript executes its contents as PowerShell rather than PowerShell Workflow, hello cmdlet generating hello complex type would produce that correct type, not hello deserialized complex type.</span></span>
5. <span data-ttu-id="38a9b-183">Vérifiez toutes les applets de commande dans le module de hello sans état.</span><span class="sxs-lookup"><span data-stu-id="38a9b-183">Make all cmdlets in hello module stateless.</span></span> <span data-ttu-id="38a9b-184">Flux de travail PowerShell s’exécute chaque applet de commande appelé dans le flux de travail hello dans une autre session.</span><span class="sxs-lookup"><span data-stu-id="38a9b-184">PowerShell Workflow runs every cmdlet called in hello workflow in a different session.</span></span> <span data-ttu-id="38a9b-185">Cela signifie que toutes les applets de commande qui dépendent de l’état de session créé / modifié par d’autres applets de commande Bonjour même module ne fonctionnera pas dans les runbooks PowerShell Workflow.</span><span class="sxs-lookup"><span data-stu-id="38a9b-185">This means any cmdlets that depend on session state created / modified by other cmdlets in hello same module will not work in PowerShell Workflow runbooks.</span></span>  <span data-ttu-id="38a9b-186">Voici un exemple de ce que toodo pas.</span><span class="sxs-lookup"><span data-stu-id="38a9b-186">Here is an example of what not toodo.</span></span>
   
    ```
    $globalNum = 0
    function Set-GlobalNum {
       param(
           [int] $num
       )
   
       $globalNum = $num
    }
    function Get-GlobalNumTimesTwo {
       $output = $globalNum * 2
   
       $output
    }
    ```
   <br>
6. <span data-ttu-id="38a9b-187">module de Hello doit être entièrement contenue dans un package en mesure de Xcopy.</span><span class="sxs-lookup"><span data-stu-id="38a9b-187">hello module should be fully contained in an Xcopy-able package.</span></span> <span data-ttu-id="38a9b-188">Modules d’automatisation d’Azure sont distribuées toohello Automation sandbox lorsque runbooks devez tooexecute, il est nécessaire toowork indépendamment hôte hello sur que s’exécutent.</span><span class="sxs-lookup"><span data-stu-id="38a9b-188">Because Azure Automation modules are distributed toohello Automation sandboxes when runbooks need tooexecute, they need toowork independently of hello host they are running on.</span></span> <span data-ttu-id="38a9b-189">Cela signifie que vous devez être en mesure de tooZip package de module hello, déplacez-le tooany autre hôte avec hello identique ou plus récente version de PowerShell, et qu’il fonctionne normalement lors de l’importation dans l’environnement PowerShell de l’ordinateur hôte.</span><span class="sxs-lookup"><span data-stu-id="38a9b-189">What this means is that you should be able tooZip up hello module package, move it tooany other host with hello same or newer PowerShell version, and have it function as normal when imported into that host’s PowerShell environment.</span></span> <span data-ttu-id="38a9b-190">Afin que toohappen, hello module ne doit pas dépendre des fichiers en dehors du dossier de module hello (dossier hello qui obtient compressé lors de l’importation dans Azure Automation) ou sur tous les paramètres de Registre unique sur un ordinateur hôte, telles que celles définies par hello installation d’un produit.</span><span class="sxs-lookup"><span data-stu-id="38a9b-190">In order for that toohappen, hello module should not depend on any files outside hello module folder (hello folder that gets zipped up when importing into Azure Automation), or on any unique registry settings on a host, such as those set by hello install of a product.</span></span> <span data-ttu-id="38a9b-191">Si cela n’est pas suivie, il se peut que hello module ne sera pas utilisable dans Azure Automation.</span><span class="sxs-lookup"><span data-stu-id="38a9b-191">If this best practice is not followed, hello module will not be usable in Azure Automation.</span></span>  

## <a name="next-steps"></a><span data-ttu-id="38a9b-192">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="38a9b-192">Next steps</span></span>

* <span data-ttu-id="38a9b-193">tooget a démarré avec des runbooks de flux de travail PowerShell, consultez [mon premier runbook de flux de travail PowerShell](automation-first-runbook-textual.md)</span><span class="sxs-lookup"><span data-stu-id="38a9b-193">tooget started with PowerShell workflow runbooks, see [My first PowerShell workflow runbook](automation-first-runbook-textual.md)</span></span>
* <span data-ttu-id="38a9b-194">toolearn plus sur la création de Modules PowerShell, consultez [l’écriture d’un Module Windows PowerShell](https://msdn.microsoft.com/library/dd878310%28v=vs.85%29.aspx)</span><span class="sxs-lookup"><span data-stu-id="38a9b-194">toolearn more about creating PowerShell Modules, see [Writing a Windows PowerShell Module](https://msdn.microsoft.com/library/dd878310%28v=vs.85%29.aspx)</span></span>

