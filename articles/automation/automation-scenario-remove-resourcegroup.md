---
title: Automatiser la suppression des groupes de ressources | Microsoft Docs
description: "Version du workflow PowerShell d’un scénario d’Azure Automation incluant des runbooks pour supprimer tous les groupes de ressources de votre abonnement."
services: automation
documentationcenter: 
author: MGoedtel
manager: jwhit
editor: 
ms.assetid: b848e345-fd5d-4b9d-bc57-3fe41d2ddb5c
ms.service: automation
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 09/26/2016
ms.author: magoedte
ms.openlocfilehash: 6aa3897d44b146483204d43e026d3d158c3e13b6
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/11/2017
---
# <a name="azure-automation-scenario---automate-removal-of-resource-groups"></a><span data-ttu-id="687e4-103">Scénario Azure Automation - Automatiser la suppression de groupes de ressources</span><span class="sxs-lookup"><span data-stu-id="687e4-103">Azure Automation scenario - automate removal of resource groups</span></span>
<span data-ttu-id="687e4-104">De nombreux clients créent plusieurs groupes de ressources.</span><span class="sxs-lookup"><span data-stu-id="687e4-104">Many customers create more than one resource group.</span></span> <span data-ttu-id="687e4-105">Certains peuvent être utilisés pour la gestion des applications de production, et d’autres comme environnement de développement, de test et intermédiaires.</span><span class="sxs-lookup"><span data-stu-id="687e4-105">Some might be used for managing production applications, and others might be used as development, testing, and staging environments.</span></span> <span data-ttu-id="687e4-106">Automatiser le déploiement de ces ressources est une chose, mais être capable de désactiver un groupe de ressources d’un simple clic en est une autre.</span><span class="sxs-lookup"><span data-stu-id="687e4-106">Automating the deployment of these resources is one thing, but being able to decommission a resource group with a click of the button is another.</span></span> <span data-ttu-id="687e4-107">Vous pouvez simplifier cette tâche de gestion courante à l’aide d’Azure Automation.</span><span class="sxs-lookup"><span data-stu-id="687e4-107">You can streamline this common management task by using Azure Automation.</span></span> <span data-ttu-id="687e4-108">Cela est également utile si vous travaillez avec un abonnement Azure présentant une limite de dépense obtenue via une offre spéciale réservée aux membres de MSDN ou du programme Microsoft Partner Network Cloud Essentials.</span><span class="sxs-lookup"><span data-stu-id="687e4-108">This is helpful if you are working with an Azure subscription that has a spending limit through a member offer like MSDN or the Microsoft Partner Network Cloud Essentials program.</span></span>

<span data-ttu-id="687e4-109">Ce scénario repose sur un runbook PowerShell et est conçu pour supprimer un ou plusieurs groupes de ressources que vous spécifiez de votre abonnement.</span><span class="sxs-lookup"><span data-stu-id="687e4-109">This scenario is based on a PowerShell runbook and is designed to remove one or more resource groups that you specify from your subscription.</span></span> <span data-ttu-id="687e4-110">Le paramètre par défaut du runbook consiste à effectuer un test avant de continuer.</span><span class="sxs-lookup"><span data-stu-id="687e4-110">The default setting of the runbook is to test before proceeding.</span></span> <span data-ttu-id="687e4-111">Cela garantit de ne pas supprimer accidentellement le groupe de ressources avant d’être prêt à effectuer cette procédure.</span><span class="sxs-lookup"><span data-stu-id="687e4-111">This ensures that you don't accidentally delete the resource group before you're ready to complete this procedure.</span></span>   

## <a name="getting-the-scenario"></a><span data-ttu-id="687e4-112">Obtention du scénario</span><span class="sxs-lookup"><span data-stu-id="687e4-112">Getting the scenario</span></span>
<span data-ttu-id="687e4-113">Ce scénario se compose d’un runbook PowerShell que vous pouvez télécharger depuis [PowerShell Gallery](https://www.powershellgallery.com/packages/Remove-ResourceGroup/1.0/DisplayScript).</span><span class="sxs-lookup"><span data-stu-id="687e4-113">This scenario consists of a PowerShell runbook that you can download from the [PowerShell Gallery](https://www.powershellgallery.com/packages/Remove-ResourceGroup/1.0/DisplayScript).</span></span> <span data-ttu-id="687e4-114">Vous pouvez également l’importer directement depuis [Runbook Gallery](automation-runbook-gallery.md) dans le portail Azure.</span><span class="sxs-lookup"><span data-stu-id="687e4-114">You can also import it directly from the [Runbook Gallery](automation-runbook-gallery.md) in the Azure portal.</span></span><br><br>

| <span data-ttu-id="687e4-115">Runbook</span><span class="sxs-lookup"><span data-stu-id="687e4-115">Runbook</span></span> | <span data-ttu-id="687e4-116">Description</span><span class="sxs-lookup"><span data-stu-id="687e4-116">Description</span></span> |
| --- | --- |
| <span data-ttu-id="687e4-117">Remove-ResourceGroup</span><span class="sxs-lookup"><span data-stu-id="687e4-117">Remove-ResourceGroup</span></span> |<span data-ttu-id="687e4-118">Supprime un ou plusieurs groupes de ressources Azure et les ressources associées de l’abonnement.</span><span class="sxs-lookup"><span data-stu-id="687e4-118">Removes one or more Azure resource groups and associated resources from the subscription.</span></span> |

<br>
<span data-ttu-id="687e4-119">Les paramètres d’entrée suivants sont définis pour ce runbook :</span><span class="sxs-lookup"><span data-stu-id="687e4-119">The following input parameters are defined for this runbook:</span></span>

| <span data-ttu-id="687e4-120">Paramètre</span><span class="sxs-lookup"><span data-stu-id="687e4-120">Parameter</span></span> | <span data-ttu-id="687e4-121">Description</span><span class="sxs-lookup"><span data-stu-id="687e4-121">Description</span></span> |
| --- | --- |
| <span data-ttu-id="687e4-122">NameFilter (obligatoire)</span><span class="sxs-lookup"><span data-stu-id="687e4-122">NameFilter (Required)</span></span> |<span data-ttu-id="687e4-123">Spécifie un filtre de nom pour limiter les groupes de ressources que vous avez l’intention de supprimer.</span><span class="sxs-lookup"><span data-stu-id="687e4-123">Specifies a name filter to limit the resource groups that you intend on deleting.</span></span> <span data-ttu-id="687e4-124">Vous pouvez transmettre plusieurs valeurs à l’aide d’une liste séparée par des virgules.</span><span class="sxs-lookup"><span data-stu-id="687e4-124">You can pass multiple values using a comma-separated list.</span></span><br><span data-ttu-id="687e4-125">Le filtre ne respecte pas la casse et établit une correspondance avec tous les groupes de ressources qui contiennent cette chaîne.</span><span class="sxs-lookup"><span data-stu-id="687e4-125">The filter is not case-sensitive and will match any resource group that contains the string.</span></span> |
| <span data-ttu-id="687e4-126">PreviewMode (facultatif)</span><span class="sxs-lookup"><span data-stu-id="687e4-126">PreviewMode (Optional)</span></span> |<span data-ttu-id="687e4-127">Exécutez le runbook pour voir quels groupes de ressources seraient supprimés, sans procéder à leur suppression.</span><span class="sxs-lookup"><span data-stu-id="687e4-127">Executes the runbook to see which resource groups would be deleted, but takes no action.</span></span><br><span data-ttu-id="687e4-128">**true** afin d’éviter la suppression accidentelle de groupes de ressources transmis au runbook.</span><span class="sxs-lookup"><span data-stu-id="687e4-128">The default is **true** to help avoid accidental deletion of one or more resource groups passed to the runbook.</span></span> |

## <a name="install-and-configure-this-scenario"></a><span data-ttu-id="687e4-129">Installer et configurer ce scénario</span><span class="sxs-lookup"><span data-stu-id="687e4-129">Install and configure this scenario</span></span>
### <a name="prerequisites"></a><span data-ttu-id="687e4-130">Composants requis</span><span class="sxs-lookup"><span data-stu-id="687e4-130">Prerequisites</span></span>
<span data-ttu-id="687e4-131">Ce runbook s’authentifie à l’aide du [compte d’identification Azure](automation-sec-configure-azure-runas-account.md).</span><span class="sxs-lookup"><span data-stu-id="687e4-131">This runbook authenticates using the [Azure Run As account](automation-sec-configure-azure-runas-account.md).</span></span>    

### <a name="install-and-publish-the-runbooks"></a><span data-ttu-id="687e4-132">Installer et publier des Runbook</span><span class="sxs-lookup"><span data-stu-id="687e4-132">Install and publish the runbooks</span></span>
<span data-ttu-id="687e4-133">Après avoir téléchargé le runbook, vous pouvez l’importer à l’aide de la procédure décrite dans les [procédures d’importation de runbooks](automation-creating-importing-runbook.md#importing-a-runbook-from-a-file-into-azure-automation).</span><span class="sxs-lookup"><span data-stu-id="687e4-133">After you download the runbook, you can import it by using the procedure in [Importing runbook procedures](automation-creating-importing-runbook.md#importing-a-runbook-from-a-file-into-azure-automation).</span></span> <span data-ttu-id="687e4-134">Publiez le runbook une fois qu’il a été correctement importé dans votre compte Automation.</span><span class="sxs-lookup"><span data-stu-id="687e4-134">Publish the runbook after it has been successfully imported into your Automation account.</span></span>

## <a name="using-the-runbook"></a><span data-ttu-id="687e4-135">Utilisation du runbook</span><span class="sxs-lookup"><span data-stu-id="687e4-135">Using the runbook</span></span>
<span data-ttu-id="687e4-136">La procédure suivante vous guide à travers l’exécution de ce runbook et vous aide à vous familiariser avec son fonctionnement.</span><span class="sxs-lookup"><span data-stu-id="687e4-136">The following steps will walk you through the execution of this runbook and help you become familiar with how it works.</span></span> <span data-ttu-id="687e4-137">Dans cet exemple, vous allez uniquement tester le runbook ; nous ne procéderons pas à la suppression effective du groupe de ressources.</span><span class="sxs-lookup"><span data-stu-id="687e4-137">You will only be testing the runbook in this example, not actually deleting the resource group.</span></span>  

1. <span data-ttu-id="687e4-138">À partir du portail Azure, ouvrez votre compte Automation, puis cliquez sur la vignette **Runbooks**.</span><span class="sxs-lookup"><span data-stu-id="687e4-138">From the Azure portal, open your Automation account and click **Runbooks**.</span></span>
2. <span data-ttu-id="687e4-139">Sélectionnez le runbook **Remove-ResourceGroup** et cliquez sur **Démarrer**.</span><span class="sxs-lookup"><span data-stu-id="687e4-139">Select the **Remove-ResourceGroup** runbook and click **Start**.</span></span>
3. <span data-ttu-id="687e4-140">Lorsque vous démarrez le runbook, le panneau **Démarrer le Runbook** s’ouvre. Vous pouvez configurer les paramètres.</span><span class="sxs-lookup"><span data-stu-id="687e4-140">When you start the runbook, the **Start Runbook** blade opens and you can configure the parameters.</span></span> <span data-ttu-id="687e4-141">Entrez le nom des groupes de ressources de votre abonnement que vous pouvez utiliser pour le test et dont la suppression accidentelle n’aura aucune incidence.</span><span class="sxs-lookup"><span data-stu-id="687e4-141">Enter the names of resource groups in your subscription that you can use for testing and will cause no harm if accidentally deleted.</span></span><br> <span data-ttu-id="687e4-142">![Paramètres de Remove-ResouceGroup](media/automation-scenario-remove-resourcegroup/remove-resourcegroup-input-parameters.png)</span><span class="sxs-lookup"><span data-stu-id="687e4-142">![Remove-ResouceGroup parameters](media/automation-scenario-remove-resourcegroup/remove-resourcegroup-input-parameters.png)</span></span>

   > [!NOTE]
   > <span data-ttu-id="687e4-143">Assurez-vous que l’option **PreviewMode** est définie sur **true** afin d’éviter de supprimer les groupes de ressources sélectionnés.</span><span class="sxs-lookup"><span data-stu-id="687e4-143">Make sure **Previewmode** is set to **true** to avoid deleting the selected resource groups.</span></span>  <span data-ttu-id="687e4-144">**Notez** que ce runbook ne supprimera pas le groupe de ressources contenant le compte Automation qui exécute ce runbook.</span><span class="sxs-lookup"><span data-stu-id="687e4-144">**Note** that this runbook will not remove the resource group that contains the Automation account that is running this runbook.</span></span>  
   >
   >
4. <span data-ttu-id="687e4-145">Une fois toutes les valeurs des paramètres configurées, cliquez sur **OK**. Le runbook est placé en file d’attente en vue de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="687e4-145">After you have configured all the parameter values, click **OK**, and the runbook will be queued for execution.</span></span>  

<span data-ttu-id="687e4-146">Pour visualiser les détails de la tâche du runbook **Remove-ResourceGroup** dans le portail Azure, sélectionnez **Tâches** dans le runbook.</span><span class="sxs-lookup"><span data-stu-id="687e4-146">To view the details of the **Remove-ResourceGroup** runbook job in the Azure portal, select **Jobs** in the runbook.</span></span> <span data-ttu-id="687e4-147">Le résumé de la tâche affiche les paramètres d’entrée et le flux de sortie, en plus des informations générales sur le travail et des exceptions.</span><span class="sxs-lookup"><span data-stu-id="687e4-147">The job summary displays the input parameters and the output stream in addition to general information about the job and any exceptions that occurred.</span></span><br> <span data-ttu-id="687e4-148">![État de la tâche du runbook Remove-ResourceGroup](media/automation-scenario-remove-resourcegroup/remove-resourcegroup-runbook-job-status.png).</span><span class="sxs-lookup"><span data-stu-id="687e4-148">![Remove-ResourceGroup runbook job status](media/automation-scenario-remove-resourcegroup/remove-resourcegroup-runbook-job-status.png).</span></span>

<span data-ttu-id="687e4-149">Le **Résumé du travail** inclut les messages des flux de sortie, des flux d’avertissements et des flux d’erreurs.</span><span class="sxs-lookup"><span data-stu-id="687e4-149">The **Job Summary** includes messages from the output, warning, and error streams.</span></span> <span data-ttu-id="687e4-150">Pour visualiser les résultats détaillés de l’exécution du Runbook, sélectionnez **Sortie**.</span><span class="sxs-lookup"><span data-stu-id="687e4-150">Select **Output** to view detailed results from the runbook execution.</span></span><br> <span data-ttu-id="687e4-151">![Résultats de la sortie du runbook Remove-ResourceGroup](media/automation-scenario-remove-resourcegroup/remove-resourcegroup-runbook-job-output.png)</span><span class="sxs-lookup"><span data-stu-id="687e4-151">![Remove-ResourceGroup runbook output results](media/automation-scenario-remove-resourcegroup/remove-resourcegroup-runbook-job-output.png)</span></span>

## <a name="next-steps"></a><span data-ttu-id="687e4-152">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="687e4-152">Next steps</span></span>
* <span data-ttu-id="687e4-153">Pour vous familiariser avec la création de votre propre runbook, consultez [Création ou importation d’un runbook dans Azure Automation](automation-creating-importing-runbook.md).</span><span class="sxs-lookup"><span data-stu-id="687e4-153">To get started creating your own runbook, see [Creating or importing a runbook in Azure Automation](automation-creating-importing-runbook.md).</span></span>
* <span data-ttu-id="687e4-154">Pour prendre en main des Runbooks de workflow PowerShell, consultez [Mon premier Runbook PowerShell Workflow](automation-first-runbook-textual.md).</span><span class="sxs-lookup"><span data-stu-id="687e4-154">To get started with PowerShell Workflow runbooks, see [My first PowerShell Workflow runbook](automation-first-runbook-textual.md).</span></span>
