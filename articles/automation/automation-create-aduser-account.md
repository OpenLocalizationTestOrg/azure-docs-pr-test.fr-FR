---
title: "Créer un compte d’utilisateur Azure AD | Microsoft Docs"
description: "Cet article décrit comment créer les informations d’identification d’un compte d’utilisateur Azure AD pour les Runbooks dans Azure Automation pour l’authentification dans Azure et Azure Classic."
services: automation
documentationcenter: 
author: MGoedtel
manager: jwhit
editor: tysonn
keywords: "utilisateur azure active directory, azure service management, compte d’utilisateur azure ad"
ms.assetid: fcfe266d-b22e-4dfb-8272-adcab09fc0cf
ms.service: automation
ms.devlang: na
ms.topic: get-started-article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 04/13/2017
ms.author: magoedte
ms.openlocfilehash: 4eaa3e36ededddeb5268ec4f49b9daee2f824cee
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/18/2017
---
# <a name="authenticate-runbooks-with-azure-classic-deployment-and-resource-manager"></a><span data-ttu-id="e4866-104">Authentification des Runbooks avec le déploiement Azure Classic et Resource Manager</span><span class="sxs-lookup"><span data-stu-id="e4866-104">Authenticate Runbooks with Azure classic deployment and Resource Manager</span></span>
<span data-ttu-id="e4866-105">Cet article décrit les étapes à effectuer pour configurer un compte d’utilisateur Azure AD pour les runbooks Azure Automation en cours d’exécution sur des ressources du modèle de déploiement Azure Classic ou Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="e4866-105">This article describes the steps you must perform to configure an Azure AD User account for Azure Automation runbooks running against Azure classic deployment model or Azure Resource Manager resources.</span></span>  <span data-ttu-id="e4866-106">Même si cette procédure est toujours prise en charge comme identité d’authentification pour vos Runbooks Azure Resource Manager, il est recommandé d’utiliser un compte d’identification Azure.</span><span class="sxs-lookup"><span data-stu-id="e4866-106">While this continues to be a supported authentication identity for your Azure Resource Manager based runbooks, the recommended method is using an Azure Run As account.</span></span>       

## <a name="create-a-new-azure-active-directory-user"></a><span data-ttu-id="e4866-107">Création d’un nouvel utilisateur Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="e4866-107">Create a new Azure Active Directory user</span></span>
1. <span data-ttu-id="e4866-108">Connectez-vous au portail Azure Classic en tant qu’administrateur de service pour l’abonnement Azure que vous souhaitez gérer.</span><span class="sxs-lookup"><span data-stu-id="e4866-108">Log in to the Azure Classic portal as a service administrator for the Azure subscription you want to manage.</span></span>
2. <span data-ttu-id="e4866-109">Sélectionnez **Active Directory**, puis sélectionnez le nom du répertoire de votre organisation.</span><span class="sxs-lookup"><span data-stu-id="e4866-109">Select **Active Directory**, and then select the name of your organization directory.</span></span>
3. <span data-ttu-id="e4866-110">Sélectionnez l’onglet **Utilisateurs**, puis, dans la zone de commande, sélectionnez **Ajouter un utilisateur**.</span><span class="sxs-lookup"><span data-stu-id="e4866-110">Select the **Users** tab, and then, in the command area, select **Add User**.</span></span>
4. <span data-ttu-id="e4866-111">Sur la page **Dites-nous en plus sur cet utilisateur**, sous **Type d’utilisateur**, sélectionnez **Nouvel utilisateur dans votre organisation**.</span><span class="sxs-lookup"><span data-stu-id="e4866-111">On the **Tell us about this user** page, under **Type of user**, select **New user in your organization**.</span></span>
5. <span data-ttu-id="e4866-112">Entrez un nom d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e4866-112">Enter a user name.</span></span>  
6. <span data-ttu-id="e4866-113">Sélectionnez le nom du répertoire associé à votre abonnement Azure sur la page Active Directory.</span><span class="sxs-lookup"><span data-stu-id="e4866-113">Select the directory name that is associated with your Azure subscription on the Active Directory page.</span></span>
7. <span data-ttu-id="e4866-114">Sur la page **Profil de l’utilisateur**, entrez les nom et prénom de l’utilisateur, un nom convivial et sélectionnez Utilisateur dans la liste **Rôles**.</span><span class="sxs-lookup"><span data-stu-id="e4866-114">On the **user profile** page, provide a first and last name, a user-friendly name, and User from the **Roles** list.</span></span>  <span data-ttu-id="e4866-115">Ne sélectionnez pas la case à cocher **Activer l’authentification multifacteur**.</span><span class="sxs-lookup"><span data-stu-id="e4866-115">Do not **Enable Multi-Factor Authentication**.</span></span>
8. <span data-ttu-id="e4866-116">Notez le nom complet de l’utilisateur et le mot de passe temporaire.</span><span class="sxs-lookup"><span data-stu-id="e4866-116">Note the user’s full name and temporary password.</span></span>
9. <span data-ttu-id="e4866-117">Sélectionnez **Paramètres > Administrateurs > Ajouter**.</span><span class="sxs-lookup"><span data-stu-id="e4866-117">Select **Settings > Administrators > Add**.</span></span>
10. <span data-ttu-id="e4866-118">Tapez le nom d’utilisateur complet de l’utilisateur que vous avez créé.</span><span class="sxs-lookup"><span data-stu-id="e4866-118">Type the full user name of the user that you created.</span></span>
11. <span data-ttu-id="e4866-119">Sélectionnez l’abonnement que vous souhaitez gérer.</span><span class="sxs-lookup"><span data-stu-id="e4866-119">Select the subscription that you want the user to manage.</span></span>
12. <span data-ttu-id="e4866-120">Déconnectez-vous d’Azure et puis reconnectez-vous avec le compte que vous venez de créer.</span><span class="sxs-lookup"><span data-stu-id="e4866-120">Log out of Azure and then log back in with the account you just created.</span></span> <span data-ttu-id="e4866-121">Vous serez invité à modifier le mot de passe de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e4866-121">You will be prompted to change the user’s password.</span></span>

## <a name="create-an-automation-account-in-azure-classic-portal"></a><span data-ttu-id="e4866-122">Création d’un compte Automation dans le portail Azure Classic</span><span class="sxs-lookup"><span data-stu-id="e4866-122">Create an Automation account in Azure Classic portal</span></span>
<span data-ttu-id="e4866-123">Dans cette section, vous effectuez les étapes suivantes pour créer un compte Azure Automation dans le portail Azure qui sera utilisé avec vos ressources de gestion des Runbooks dans le mode de déploiement Azure Classic.</span><span class="sxs-lookup"><span data-stu-id="e4866-123">In this section, you perform the following steps to create an Azure Automation account in the Azure portal for use with your runbooks managing resources in Azure classic deployment.</span></span>  

> [!NOTE]
> <span data-ttu-id="e4866-124">Les comptes Automation créés avec le portail Azure Classic peuvent être gérés par le portail Azure Classic et le portail Azure, et par le jeu d’applets de commande correspondant.</span><span class="sxs-lookup"><span data-stu-id="e4866-124">Automation accounts created with the Azure Classic portal can be managed by both the Azure Classic and Azure portal and either set of cmdlets.</span></span> <span data-ttu-id="e4866-125">Une fois que le compte est créé, la façon de créer et de gérer des ressources au sein du compte n'importe pas.</span><span class="sxs-lookup"><span data-stu-id="e4866-125">Once the account is created, it makes no difference how you create and manage resources within the account.</span></span> <span data-ttu-id="e4866-126">Si vous envisagez de continuer à utiliser le portail Azure Classic, vous devez alors l’utiliser au lieu d’utiliser le portail Azure pour créer des comptes Automation.</span><span class="sxs-lookup"><span data-stu-id="e4866-126">If you are planning to continue to use the Azure Classic portal, then you should use it instead of the Azure portal to create any Automation accounts.</span></span>
> 
> 

1. <span data-ttu-id="e4866-127">Connectez-vous au portail Azure Classic en tant qu’administrateur de service pour l’abonnement Azure que vous souhaitez gérer.</span><span class="sxs-lookup"><span data-stu-id="e4866-127">Log in to the Azure Classic portal as a service administrator for the Azure subscription you want to manage.</span></span>
2. <span data-ttu-id="e4866-128">Sélectionnez **Automation**.</span><span class="sxs-lookup"><span data-stu-id="e4866-128">Select **Automation**.</span></span>
3. <span data-ttu-id="e4866-129">Sur la page **Automation**, sélectionnez **Créer un compte Automation**.</span><span class="sxs-lookup"><span data-stu-id="e4866-129">On the **Automation** page, select **Create an Automation Account**.</span></span>
4. <span data-ttu-id="e4866-130">Dans la boîte de dialogue **Créer un compte Automation**, entrez un nom pour votre nouveau compte Automation et sélectionnez une **région** dans la liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="e4866-130">In the **Create an Automation Account** box, type in a name for your new Automation account and select a **Region** from the drop-down list.</span></span>  
5. <span data-ttu-id="e4866-131">Cliquez sur **OK** pour accepter les paramètres et créer le compte.</span><span class="sxs-lookup"><span data-stu-id="e4866-131">Click **OK** to accept your settings and create the account.</span></span>
6. <span data-ttu-id="e4866-132">Une fois le compte créé, il est répertorié sur la page **Automation** .</span><span class="sxs-lookup"><span data-stu-id="e4866-132">After it is created it will be listed on the **Automation** page.</span></span>
7. <span data-ttu-id="e4866-133">Cliquez sur le compte pour accéder à la page Tableau de bord.</span><span class="sxs-lookup"><span data-stu-id="e4866-133">Click on the account and it will bring you to the Dashboard page.</span></span>  
8. <span data-ttu-id="e4866-134">Sur la page Tableau de bord Automation, sélectionnez **Actifs**.</span><span class="sxs-lookup"><span data-stu-id="e4866-134">On the Automation Dashboard page, select **Assets**.</span></span>
9. <span data-ttu-id="e4866-135">Sur la page **Actifs**, sélectionnez l’option **Ajouter des paramètres** située en bas de la page.</span><span class="sxs-lookup"><span data-stu-id="e4866-135">On the **Assets** page, select **Add Settings** located at the bottom of the page.</span></span>
10. <span data-ttu-id="e4866-136">Sur la page **Ajouter des paramètres**, sélectionnez **Ajouter des informations d’identification**.</span><span class="sxs-lookup"><span data-stu-id="e4866-136">On the **Add Settings** page, select **Add Credential**.</span></span>
11. <span data-ttu-id="e4866-137">Sur la page **Définir les informations d’identification**, sélectionnez **Informations d’identification de Windows PowerShell** dans la liste déroulante **Type d’informations d’identification** et entrez un nom pour les informations d’identification.</span><span class="sxs-lookup"><span data-stu-id="e4866-137">On the **Define Credential** page, select **Windows PowerShell Credential** from the **Credential Type** drop-down list and provide a name for the credential.</span></span>
12. <span data-ttu-id="e4866-138">Sur la page **Définir les informations d’identification** suivante, entrez le nom d’utilisateur du compte utilisateur Active Directory créé précédemment dans le champ **Nom d’utilisateur** et le mot de passe dans les champs **Mot de passe** et **Confirmer le mot de passe**.</span><span class="sxs-lookup"><span data-stu-id="e4866-138">On the following **Define Credential** page type in the username of the AD user account created earlier in the **User Name** field and the password in the **Password** and **Confirm Password** fields.</span></span> <span data-ttu-id="e4866-139">Cliquez sur **OK** pour enregistrer vos modifications.</span><span class="sxs-lookup"><span data-stu-id="e4866-139">Click **OK** to save your changes.</span></span>

## <a name="create-an-automation-account-in-the-azure-portal"></a><span data-ttu-id="e4866-140">Création d’un compte Automation dans le portail Azure</span><span class="sxs-lookup"><span data-stu-id="e4866-140">Create an Automation account in the Azure portal</span></span>
<span data-ttu-id="e4866-141">Dans cette section, vous effectuez les étapes suivantes pour créer un compte Azure Automation dans le portail Azure qui sera utilisé avec vos ressources de gestion des Runbooks en mode Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="e4866-141">In this section, perform the following steps to create an Azure Automation account in the Azure portal for use with your runbooks managing resources in Azure Resource Manager mode.</span></span>  

1. <span data-ttu-id="e4866-142">Connectez-vous au portail Azure en tant qu’administrateur de service pour l’abonnement Azure que vous souhaitez gérer.</span><span class="sxs-lookup"><span data-stu-id="e4866-142">Log in to the Azure portal as a service administrator for the Azure subscription you want to manage.</span></span>
2. <span data-ttu-id="e4866-143">Sélectionnez **Comptes Automation**.</span><span class="sxs-lookup"><span data-stu-id="e4866-143">Select **Automation Accounts**.</span></span>
3. <span data-ttu-id="e4866-144">Dans le panneau Comptes Automation, cliquez sur **Ajouter**.</span><span class="sxs-lookup"><span data-stu-id="e4866-144">In the Automation Accounts blade, click **Add**.</span></span><br><br><span data-ttu-id="e4866-145">![Ajouter un compte Automation](media/automation-create-aduser-account/add-automation-acct-properties.png)</span><span class="sxs-lookup"><span data-stu-id="e4866-145">![Add Automation Account](media/automation-create-aduser-account/add-automation-acct-properties.png)</span></span>
4. <span data-ttu-id="e4866-146">Dans le panneau **Ajouter un compte Automation**, entrez le nom de votre nouveau compte Automation dans la zone **Nom**.</span><span class="sxs-lookup"><span data-stu-id="e4866-146">In the **Add Automation Account** blade, in the **Name** box type in a name for your new Automation account.</span></span>
5. <span data-ttu-id="e4866-147">Si vous disposez de plusieurs abonnements, spécifiez celui du nouveau compte, ainsi qu’un **groupe de ressources** nouveau ou existant et un **emplacement** de centre de données Azure.</span><span class="sxs-lookup"><span data-stu-id="e4866-147">If you have more than one subscription, specify the one for the new account, as well as a new or existing **Resource group** and an Azure datacenter **Location**.</span></span>
6. <span data-ttu-id="e4866-148">Sélectionnez la valeur **Yes** dans l’option **Créer un compte d’authentification Azure**, puis cliquez sur le bouton **Créer**.</span><span class="sxs-lookup"><span data-stu-id="e4866-148">Select the value **Yes** for the **Create Azure Run As account** option, and click the **Create** button.</span></span>  
   
    > [!NOTE]
    > <span data-ttu-id="e4866-149">Si vous choisissez de ne pas créer de compte d’identification en sélectionnant l’option **Non**, un message d’avertissement s’affiche dans le panneau **Ajouter un compte Automation**.</span><span class="sxs-lookup"><span data-stu-id="e4866-149">If you choose to not create the Run As account by selecting the option **No**, you will be presented with a warning message in the **Add Automation Account** blade.</span></span>  <span data-ttu-id="e4866-150">Bien que le compte soit créé avec le rôle de **contributeur** dans l’abonnement, il n’aura pas d’identité d’authentification correspondante au sein de votre service de répertoire d’abonnements et, par conséquent, il n’aura pas accès aux ressources de votre abonnement.</span><span class="sxs-lookup"><span data-stu-id="e4866-150">While the account is created and assigned to the **Contributor** role in the subscription, it will not have a corresponding authentication identity within your subscriptions directory service and therefore, no access resources in your subscription.</span></span>  <span data-ttu-id="e4866-151">Cela empêchera tous les Runbooks faisant référence à ce compte de pouvoir authentifier et effectuer des tâches sur les ressources Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="e4866-151">This will prevent any runbooks referencing this account from being able to authenticate and perform tasks against Azure Resource Manager resources.</span></span>
    > 
    >

    <br>![Avertissement Ajouter un compte Automation](media/automation-create-aduser-account/add-automation-acct-properties-error.png)<br>  
7. <span data-ttu-id="e4866-153">Pour suivre la progression de la création du compte Automation, accédez à l’onglet **Notifications** du menu.</span><span class="sxs-lookup"><span data-stu-id="e4866-153">While Azure creates the Automation account, you can track the progress under **Notifications** from the menu.</span></span>

<span data-ttu-id="e4866-154">Lorsque la création des informations d’identification est terminée, vous devez créer un actif d’informations d’identification pour associer le compte Automation au compte d’utilisateur Active Directory créé précédemment.</span><span class="sxs-lookup"><span data-stu-id="e4866-154">When the creation of the credential is completed, you need to create a Credential Asset to associate the Automation Account with the AD User account created earlier.</span></span>  <span data-ttu-id="e4866-155">N’oubliez pas que nous avons uniquement créé le compte Automation et qu’il n’est pas associé à une identité d’authentification.</span><span class="sxs-lookup"><span data-stu-id="e4866-155">Remember, we only created the Automation account and it is not associated with an authentication identity.</span></span>  <span data-ttu-id="e4866-156">Suivez les étapes présentées dans l’article [Ressources d’informations d’identification dans Azure Automation](automation-credentials.md#creating-a-new-credential-asset) et entrez la valeur du **nom d’utilisateur** au format **domaine\utilisateur**.</span><span class="sxs-lookup"><span data-stu-id="e4866-156">Perform the steps outlined in the [Credential assets in Azure Automation article](automation-credentials.md#creating-a-new-credential-asset) and enter the value for **username** in the format **domain\user**.</span></span>

## <a name="use-the-credential-in-a-runbook"></a><span data-ttu-id="e4866-157">Utilisation des informations d’identification dans un Runbook</span><span class="sxs-lookup"><span data-stu-id="e4866-157">Use the credential in a runbook</span></span>
<span data-ttu-id="e4866-158">Vous pouvez récupérer les informations d’identification dans un Runbook à l’aide de l’activité [Get-AutomationPSCredential](http://msdn.microsoft.com/library/dn940015.aspx) et les utiliser avec [Add-AzureAccount](http://msdn.microsoft.com/library/azure/dn722528.aspx) pour vous connecter à votre abonnement Azure.</span><span class="sxs-lookup"><span data-stu-id="e4866-158">You can retrieve the credential in a runbook using the [Get-AutomationPSCredential](http://msdn.microsoft.com/library/dn940015.aspx) activity and then use it with [Add-AzureAccount](http://msdn.microsoft.com/library/azure/dn722528.aspx) to connect to your Azure subscription.</span></span> <span data-ttu-id="e4866-159">Si les informations d’identification correspondent à un administrateur de plusieurs abonnements Azure, vous devez également utiliser [Select-AzureSubscription](http://msdn.microsoft.com/library/dn495203.aspx) pour spécifier celle qui convient.</span><span class="sxs-lookup"><span data-stu-id="e4866-159">If the credential is an administrator of multiple Azure subscriptions, then you should also use [Select-AzureSubscription](http://msdn.microsoft.com/library/dn495203.aspx) to specify the correct one.</span></span> <span data-ttu-id="e4866-160">Cela est illustré dans l’exemple Windows PowerShell ci-dessous qui apparaît en haut de la plupart des Runbooks Azure Automation.</span><span class="sxs-lookup"><span data-stu-id="e4866-160">This is shown in the sample Windows PowerShell below that will typically appear at the top of most Azure Automation runbooks.</span></span>

    $cred = Get-AutomationPSCredential –Name "myuseraccount.onmicrosoft.com"
    Add-AzureAccount –Credential $cred
    Select-AzureSubscription –SubscriptionName "My Subscription"

<span data-ttu-id="e4866-161">Vous devez répéter ces lignes après tout [point de contrôle](http://technet.microsoft.com/library/dn469257.aspx#bk_Checkpoints) dans votre Runbook.</span><span class="sxs-lookup"><span data-stu-id="e4866-161">You should repeat these lines after any [checkpoints](http://technet.microsoft.com/library/dn469257.aspx#bk_Checkpoints) in your runbook.</span></span> <span data-ttu-id="e4866-162">Si le Runbook est interrompu, puis reprend avec un autre collaborateur, ce dernier doit s’authentifier à nouveau.</span><span class="sxs-lookup"><span data-stu-id="e4866-162">If the runbook is suspended and then resumes on another worker, then it will need to perform the authentication again.</span></span>

## <a name="next-steps"></a><span data-ttu-id="e4866-163">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="e4866-163">Next Steps</span></span>
* <span data-ttu-id="e4866-164">Passez en revue les différents types de Runbooks et les étapes pour créer vos propres Runbooks dans l’article [Types de Runbooks Azure Automation](automation-runbook-types.md)</span><span class="sxs-lookup"><span data-stu-id="e4866-164">Review the different runbook types and steps for creating your own runbooks from the following article [Azure Automation runbook types](automation-runbook-types.md)</span></span>

