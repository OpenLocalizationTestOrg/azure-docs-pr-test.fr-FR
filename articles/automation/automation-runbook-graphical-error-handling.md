---
title: aaaError gestion dans Azure Automation des runbooks graphiques | Documents Microsoft
description: "Cet article décrit comment tooimplement gestion d’erreur logique dans Azure Automation des runbooks graphiques."
services: automation
documentationcenter: 
author: mgoedtel
manager: jwhit
editor: tysonn
ms.assetid: 
ms.service: automation
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 12/26/2016
ms.author: magoedte
ms.openlocfilehash: b9ff01361d2ebd9c0174b074a7a290b1cc2fd1c8
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="error-handling-in-azure-automation-graphical-runbooks"></a><span data-ttu-id="4df62-103">Gestion des erreurs dans les runbooks graphiques Azure Automation</span><span class="sxs-lookup"><span data-stu-id="4df62-103">Error handling in Azure Automation graphical runbooks</span></span>

<span data-ttu-id="4df62-104">Un tooconsider principal de création de runbook clé consiste à identifier différents problèmes liés à un runbook peut rencontrer.</span><span class="sxs-lookup"><span data-stu-id="4df62-104">A key runbook design principal tooconsider is identifying different issues that a runbook might experience.</span></span> <span data-ttu-id="4df62-105">Ces problèmes peuvent être liés à la réussite, aux états d’erreur attendus et aux conditions d’erreur inattendue.</span><span class="sxs-lookup"><span data-stu-id="4df62-105">These issues can include success, expected error states, and unexpected error conditions.</span></span>

<span data-ttu-id="4df62-106">Les runbooks doivent inclure une gestion des erreurs.</span><span class="sxs-lookup"><span data-stu-id="4df62-106">Runbooks should include error handling.</span></span> <span data-ttu-id="4df62-107">toovalidate hello la sortie d’une activité ou gérer une erreur avec des runbooks graphiques, vous pourriez utiliser une activité de code Windows PowerShell, définir la logique conditionnelle sur le lien de sortie hello d’activité hello ou appliquer une autre méthode.</span><span class="sxs-lookup"><span data-stu-id="4df62-107">toovalidate hello output of an activity or handle an error with graphical runbooks, you could use a Windows PowerShell code activity, define conditional logic on hello output link of hello activity, or apply another method.</span></span>          

<span data-ttu-id="4df62-108">Souvent, s’il existe une erreur sans fin d’exécution qui se produit avec une activité de runbook, toute activité qui suit est traitée, quelle que soit l’erreur de hello.</span><span class="sxs-lookup"><span data-stu-id="4df62-108">Often, if there is a non-terminating error that occurs with a runbook activity, any activity that follows is processed regardless of hello error.</span></span> <span data-ttu-id="4df62-109">Erreur de Hello est toogenerate probablement une exception, mais l’activité suivante de hello est toujours autorisée toorun.</span><span class="sxs-lookup"><span data-stu-id="4df62-109">hello error is likely toogenerate an exception, but hello next activity is still allowed toorun.</span></span> <span data-ttu-id="4df62-110">Il s’agit de façon hello que PowerShell est conçue toohandle erreurs.</span><span class="sxs-lookup"><span data-stu-id="4df62-110">This is hello way that PowerShell is designed toohandle errors.</span></span>    

<span data-ttu-id="4df62-111">types Hello des erreurs PowerShell qui peuvent se produire lors de l’exécution sont arrête ou sans fin d’exécution.</span><span class="sxs-lookup"><span data-stu-id="4df62-111">hello types of PowerShell errors that can occur during execution are terminating or non-terminating.</span></span> <span data-ttu-id="4df62-112">différences de Hello entre les erreurs sans fin d’exécution et de fin sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="4df62-112">hello differences between terminating and non-terminating errors are as follows:</span></span>

* <span data-ttu-id="4df62-113">**Erreur de fin**: une erreur grave lors de l’exécution qui arrête complètement la commande hello (ou l’exécution du script).</span><span class="sxs-lookup"><span data-stu-id="4df62-113">**Terminating error**: A serious error during execution that halts hello command (or script execution) completely.</span></span> <span data-ttu-id="4df62-114">Il peut s’agir de cmdlets inexistantes, d’erreurs de syntaxe qui empêchent une cmdlet de s’exécuter ou d’autres erreurs irrécupérables.</span><span class="sxs-lookup"><span data-stu-id="4df62-114">Examples include non-existent cmdlets, syntax errors that prevent a cmdlet from running, or other fatal errors.</span></span>

* <span data-ttu-id="4df62-115">**Erreur de fin d’exécution non**: une erreur non grave qui permet de toocontinue de l’exécution en dépit de l’échec de hello.</span><span class="sxs-lookup"><span data-stu-id="4df62-115">**Non-terminating error**: A non-serious error that allows execution toocontinue despite hello failure.</span></span> <span data-ttu-id="4df62-116">Il peut s’agit d’erreurs opérationnelles comme un fichier introuvable et de problèmes d’autorisation.</span><span class="sxs-lookup"><span data-stu-id="4df62-116">Examples include operational errors such as file not found errors and permissions problems.</span></span>

<span data-ttu-id="4df62-117">Azure Automation runbooks graphiques ont été améliorés hello capacité tooinclude gestion d’erreurs.</span><span class="sxs-lookup"><span data-stu-id="4df62-117">Azure Automation graphical runbooks have been improved with hello capability tooinclude error handling.</span></span> <span data-ttu-id="4df62-118">Vous pouvez maintenant convertir les exceptions en erreurs sans fin d’exécution et créer des liens d’erreur entre les activités.</span><span class="sxs-lookup"><span data-stu-id="4df62-118">You can now turn exceptions into non-terminating errors and create error links between activities.</span></span> <span data-ttu-id="4df62-119">Ce processus permet à un auteur de runbook toocatch erreurs et gérez les conditions réalisées ou inattendues.</span><span class="sxs-lookup"><span data-stu-id="4df62-119">This process allows a runbook author toocatch errors and manage realized or unexpected conditions.</span></span>  

## <a name="when-toouse-error-handling"></a><span data-ttu-id="4df62-120">Lors de la gestion des erreurs toouse</span><span class="sxs-lookup"><span data-stu-id="4df62-120">When toouse error handling</span></span>

<span data-ttu-id="4df62-121">Chaque fois qu’il existe une activité critique qui lève une erreur ou une exception, il est important tooprevent hello prochaine activité dans votre runbook à partir de l’erreur traitement toohandle hello en conséquence.</span><span class="sxs-lookup"><span data-stu-id="4df62-121">Whenever there is a critical activity that throws an error or exception, it's important tooprevent hello next activity in your runbook from processing and toohandle hello error appropriately.</span></span> <span data-ttu-id="4df62-122">Cela est tout particulièrement vital lorsque vos runbooks prennent en charge un processus d’entreprise ou de service.</span><span class="sxs-lookup"><span data-stu-id="4df62-122">This is especially critical when your runbooks are supporting a business or service operations process.</span></span>

<span data-ttu-id="4df62-123">Pour chaque activité qui peut générer une erreur, auteur de runbook hello peut ajouter un lien d’erreur pointant tooany autre activité.</span><span class="sxs-lookup"><span data-stu-id="4df62-123">For each activity that can produce an error, hello runbook author can add an error link pointing tooany other activity.</span></span>  <span data-ttu-id="4df62-124">activité de destination Hello peut être de tout type, y compris les activités de code, appelez une applet de commande, appel d’un autre runbook et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="4df62-124">hello destination activity can be of any type, including code activities, invoking a cmdlet, invoking another runbook, and so on.</span></span>

<span data-ttu-id="4df62-125">En outre, activité de destination hello peut également avoir des liens sortants.</span><span class="sxs-lookup"><span data-stu-id="4df62-125">In addition, hello destination activity can also have outgoing links.</span></span> <span data-ttu-id="4df62-126">Ces liens peuvent être des liens réguliers ou des liens d’erreur.</span><span class="sxs-lookup"><span data-stu-id="4df62-126">These links can be regular links or error links.</span></span> <span data-ttu-id="4df62-127">Cela signifie que l’auteur de runbook hello peut implémenter la logique de gestion des erreurs complexe sans avoir recours les tooa activité de code.</span><span class="sxs-lookup"><span data-stu-id="4df62-127">This means hello runbook author can implement complex error-handling logic without resorting tooa code activity.</span></span> <span data-ttu-id="4df62-128">Hello recommandé consiste toocreate un runbook de gestion des erreurs dédié avec des fonctionnalités communes, mais il n’est pas obligatoire.</span><span class="sxs-lookup"><span data-stu-id="4df62-128">hello recommended practice is toocreate a dedicated error-handling runbook with common functionality, but it's not mandatory.</span></span> <span data-ttu-id="4df62-129">Logique de gestion des erreurs dans une activité de code PowerShell qu’il n’est pas hello seule option.</span><span class="sxs-lookup"><span data-stu-id="4df62-129">Error-handling logic in a PowerShell code activity it isn't hello only option.</span></span>  

<span data-ttu-id="4df62-130">Par exemple, prenons un runbook qui tente de toostart une machine virtuelle et installer une application sur ce dernier.</span><span class="sxs-lookup"><span data-stu-id="4df62-130">For example, consider a runbook that tries toostart a VM and install an application on it.</span></span> <span data-ttu-id="4df62-131">Si hello machine virtuelle ne démarre pas correctement, il effectue deux actions :</span><span class="sxs-lookup"><span data-stu-id="4df62-131">If hello VM doesn't start correctly, it performs two actions:</span></span>

1. <span data-ttu-id="4df62-132">Il envoie une notification concernant le problème.</span><span class="sxs-lookup"><span data-stu-id="4df62-132">It sends a notification about this problem.</span></span>
2. <span data-ttu-id="4df62-133">Il démarre un autre runbook qui configure automatiquement une nouvelle machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="4df62-133">It starts another runbook that automatically provisions a new VM instead.</span></span>

<span data-ttu-id="4df62-134">Une solution est toohave un lien d’erreur pointant activité tooan que gère la première étape.</span><span class="sxs-lookup"><span data-stu-id="4df62-134">One solution is toohave an error link pointing tooan activity that handles step one.</span></span> <span data-ttu-id="4df62-135">Par exemple, vous pouvez connecter hello **Write-Warning** activité de tooan d’applet de commande pour l’étape 2, par exemple hello **AzureRmAutomationRunbook de début** applet de commande.</span><span class="sxs-lookup"><span data-stu-id="4df62-135">For example, you could connect hello **Write-Warning** cmdlet tooan activity for step two, such as hello **Start-AzureRmAutomationRunbook** cmdlet.</span></span>

<span data-ttu-id="4df62-136">Vous pourriez également généraliser ce comportement pour une utilisation dans nombreuses procédures opérationnelles en plaçant ces deux activités dans un runbook de la gestion des erreurs distinct et les conseils qui suivent hello suggéré précédemment.</span><span class="sxs-lookup"><span data-stu-id="4df62-136">You could also generalize this behavior for use in many runbooks by putting these two activities in a separate error handling runbook and following hello guidance suggested earlier.</span></span> <span data-ttu-id="4df62-137">Avant d’appeler ce runbook de gestion des erreurs, vous pourriez construire un message personnalisé à partir des données hello dans les runbook d’origine hello et puis passez-le en tant qu’un runbook de gestion des erreurs de paramètre toohello.</span><span class="sxs-lookup"><span data-stu-id="4df62-137">Before calling this error-handling runbook, you could construct a custom message from hello data in hello original runbook, and then pass it as a parameter toohello error-handling runbook.</span></span>

## <a name="how-toouse-error-handling"></a><span data-ttu-id="4df62-138">Comment la gestion des erreurs toouse</span><span class="sxs-lookup"><span data-stu-id="4df62-138">How toouse error handling</span></span>

<span data-ttu-id="4df62-139">Chaque activité possède un paramètre de configuration permettant de transformer les exceptions en erreurs sans fin d’exécution.</span><span class="sxs-lookup"><span data-stu-id="4df62-139">Each activity has a configuration setting that turns exceptions into non-terminating errors.</span></span> <span data-ttu-id="4df62-140">Par défaut, ce paramètre est désactivé.</span><span class="sxs-lookup"><span data-stu-id="4df62-140">By default, this setting is disabled.</span></span> <span data-ttu-id="4df62-141">Nous vous recommandons d’activer ce paramètre sur toute activité dans laquelle vous souhaitez que les erreurs de toohandle.</span><span class="sxs-lookup"><span data-stu-id="4df62-141">We recommend that you enable this setting on any activity where you want toohandle errors.</span></span>  

<span data-ttu-id="4df62-142">En activant cette configuration, vous sont garantissant que les erreurs avec ou sans fin d’exécution dans l’activité hello sont gérées comme des erreurs de sans fin d’exécution et peuvent être gérées avec un lien d’erreur.</span><span class="sxs-lookup"><span data-stu-id="4df62-142">By enabling this configuration, you are assuring that both terminating and non-terminating errors in hello activity are handled as non-terminating errors, and can be handled with an error link.</span></span>  

<span data-ttu-id="4df62-143">Après avoir configuré ce paramètre, vous créez une activité qui gère l’erreur de hello.</span><span class="sxs-lookup"><span data-stu-id="4df62-143">After configuring this setting, you create an activity that handles hello error.</span></span> <span data-ttu-id="4df62-144">Si une activité génère une erreur, puis hello erreur sortant des liens sont suivies et hello de liens réguliers ne sont pas, même si l’activité hello génère une sortie normale ainsi.</span><span class="sxs-lookup"><span data-stu-id="4df62-144">If an activity produces any error, then hello outgoing error links are followed, and hello regular links are not, even if hello activity produces regular output as well.</span></span><br><br> ![Exemple de lien d’erreur d’un runbook Automation](media/automation-runbook-graphical-error-handling/error-link-example.png)

<span data-ttu-id="4df62-146">Bonjour l’exemple suivant, un runbook récupère une variable qui contient le nom de l’ordinateur hello d’un ordinateur virtuel.</span><span class="sxs-lookup"><span data-stu-id="4df62-146">In hello following example, a runbook retrieves a variable that contains hello computer name of a virtual machine.</span></span> <span data-ttu-id="4df62-147">Il tente alors de machine virtuelle de hello toostart avec l’activité suivante de hello.</span><span class="sxs-lookup"><span data-stu-id="4df62-147">It then attempts toostart hello virtual machine with hello next activity.</span></span><br><br> ![Exemple de gestion des erreurs d’un runbook Automation](media/automation-runbook-graphical-error-handling/runbook-example-error-handling.png)<br><br>      

<span data-ttu-id="4df62-149">Hello **Get-AutomationVariable** activité et **Start-AzureRmVm** sont tooerrors d’exceptions tooconvert configuré.</span><span class="sxs-lookup"><span data-stu-id="4df62-149">hello **Get-AutomationVariable** activity and **Start-AzureRmVm** are configured tooconvert exceptions tooerrors.</span></span>  <span data-ttu-id="4df62-150">S’il n’y hello difficultés variable ou départ hello machine virtuelle, puis les erreurs sont générées.</span><span class="sxs-lookup"><span data-stu-id="4df62-150">If there are problems getting hello variable or starting hello VM, then errors are generated.</span></span><br><br> <span data-ttu-id="4df62-151">![Paramètres d’activité de gestion des erreurs d’un runbook Automation](media/automation-runbook-graphical-error-handling/activity-blade-convertexception-option.png)</span><span class="sxs-lookup"><span data-stu-id="4df62-151">![Automation runbook error-handling activity settings](media/automation-runbook-graphical-error-handling/activity-blade-convertexception-option.png)</span></span>

<span data-ttu-id="4df62-152">Liens d’erreur de flux à partir de ces activités tooa unique **la gestion des erreurs** activité (code).</span><span class="sxs-lookup"><span data-stu-id="4df62-152">Error links flow from these activities tooa single **error management** activity (a code activity).</span></span> <span data-ttu-id="4df62-153">Cette activité est configurée avec une expression PowerShell simple qui utilise hello *lever* toostop mot clé du traitement, ainsi que par *$Error.Exception.Message* tooget message de type hello qui décrit hello exception actuelle.</span><span class="sxs-lookup"><span data-stu-id="4df62-153">This activity is configured with a simple PowerShell expression that uses hello *Throw* keyword toostop processing, along with *$Error.Exception.Message* tooget hello message that describes hello current exception.</span></span><br><br> <span data-ttu-id="4df62-154">![Exemple de code de gestion des erreurs d’un runbook Automation](media/automation-runbook-graphical-error-handling/runbook-example-error-handling-code.png)</span><span class="sxs-lookup"><span data-stu-id="4df62-154">![Automation runbook error-handling code example](media/automation-runbook-graphical-error-handling/runbook-example-error-handling-code.png)</span></span>


## <a name="next-steps"></a><span data-ttu-id="4df62-155">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="4df62-155">Next steps</span></span>

* <span data-ttu-id="4df62-156">toolearn en savoir plus sur les liens et les types de liens dans les runbooks graphiques, consultez [de création graphique dans Azure Automation](automation-graphical-authoring-intro.md#links-and-workflow).</span><span class="sxs-lookup"><span data-stu-id="4df62-156">toolearn more about links and link types in graphical runbooks, see [Graphical authoring in Azure Automation](automation-graphical-authoring-intro.md#links-and-workflow).</span></span>

* <span data-ttu-id="4df62-157">toolearn plus d’informations sur l’exécution du runbook, comment les tâches de runbook toomonitor et d’autres détails techniques, consultez [suivre un travail de runbook](automation-runbook-execution.md).</span><span class="sxs-lookup"><span data-stu-id="4df62-157">toolearn more about runbook execution, how toomonitor runbook jobs, and other technical details, see [Track a runbook job](automation-runbook-execution.md).</span></span>
