---
title: aaaChild des runbooks dans Azure Automation | Documents Microsoft
description: "Décrit différentes méthodes de hello pour le démarrage d’un runbook dans Azure Automation à partir d’un autre runbook et partager des informations entre eux."
services: automation
documentationcenter: 
author: mgoedtel
manager: jwhit
editor: tysonn
ms.assetid: 919887b9-43e2-4c16-883c-f81807fe37db
ms.service: automation
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 02/02/2017
ms.author: magoedte;bwren
ms.openlocfilehash: d3d06818d344b565d53cc4f4705b41dcfcf9a376
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="child-runbooks-in-azure-automation"></a><span data-ttu-id="1965d-103">Runbooks enfants dans Azure Automation</span><span class="sxs-lookup"><span data-stu-id="1965d-103">Child runbooks in Azure Automation</span></span>
<span data-ttu-id="1965d-104">Il est recommandé dans toowrite réutilisables et modulaires runbooks d’automatisation Azure avec une fonction discrète qui peut être utilisée par d’autres runbooks.</span><span class="sxs-lookup"><span data-stu-id="1965d-104">It is a best practice in Azure Automation toowrite reusable, modular runbooks with a discrete function that can be used by other runbooks.</span></span> <span data-ttu-id="1965d-105">Un runbook parent appelle souvent un ou plusieurs runbooks enfants des fonctionnalités tooperform requis.</span><span class="sxs-lookup"><span data-stu-id="1965d-105">A parent runbook will often call one or more child runbooks tooperform required functionality.</span></span> <span data-ttu-id="1965d-106">Il existe deux façons toocall un runbook enfant et chacune présente des différences que vous devez comprendre afin que vous pouvez déterminer celle qui convient le mieux à vos scénarios.</span><span class="sxs-lookup"><span data-stu-id="1965d-106">There are two ways toocall a child runbook, and each has distinct differences that you should understand so that you can determine which will be best for your different scenarios.</span></span>

## <a name="invoking-a-child-runbook-using-inline-execution"></a><span data-ttu-id="1965d-107">Appeler un Runbook enfant à l’aide de l’exécution en ligne</span><span class="sxs-lookup"><span data-stu-id="1965d-107">Invoking a child runbook using inline execution</span></span>
<span data-ttu-id="1965d-108">tooinvoke un runbook inline à partir d’un autre runbook, vous utilisez nom hello de hello runbook et fournir des valeurs pour ses paramètres exactement comme vous utiliseriez une activité ou une applet de commande.</span><span class="sxs-lookup"><span data-stu-id="1965d-108">tooinvoke a runbook inline from another runbook, you use hello name of hello runbook and provide values for its parameters exactly like you would use an activity or cmdlet.</span></span>  <span data-ttu-id="1965d-109">Tous les runbooks hello même compte Automation est tooall disponible à d’autres toobe utilisés de cette manière.</span><span class="sxs-lookup"><span data-stu-id="1965d-109">All runbooks in hello same Automation account are available tooall others toobe used in this manner.</span></span> <span data-ttu-id="1965d-110">Hello le runbook parent attend que hello enfant runbook toocomplete avant de déplacer la ligne suivante de toohello, et les sorties sont retournées directement toohello parent.</span><span class="sxs-lookup"><span data-stu-id="1965d-110">hello parent runbook will wait for hello child runbook toocomplete before moving toohello next line, and any output is returned directly toohello parent.</span></span>

<span data-ttu-id="1965d-111">Lorsque vous appelez un runbook inline, il s’exécute dans hello même de la tâche en tant que le runbook parent hello.</span><span class="sxs-lookup"><span data-stu-id="1965d-111">When you invoke a runbook inline, it runs in hello same job as hello parent runbook.</span></span> <span data-ttu-id="1965d-112">Il y a aucune indication dans l’historique des travaux hello du runbook enfant hello qu’il a exécuté.</span><span class="sxs-lookup"><span data-stu-id="1965d-112">There will be no indication in hello job history of hello child runbook that it ran.</span></span> <span data-ttu-id="1965d-113">Toutes les exceptions et les flux de sortie du runbook de hello enfant sera associés au parent de hello.</span><span class="sxs-lookup"><span data-stu-id="1965d-113">Any exceptions and any stream output from hello child runbook will be associated with hello parent.</span></span> <span data-ttu-id="1965d-114">Cela entraîne moins de travaux et facilite tootrack, tootroubleshoot depuis toutes les exceptions levées par le runbook enfant hello et sa sortie de flux de données sont associés avec la tâche parent de hello.</span><span class="sxs-lookup"><span data-stu-id="1965d-114">This results in fewer jobs and makes them easier tootrack and tootroubleshoot since any exceptions thrown by hello child runbook and any of its stream output are associated with hello parent job.</span></span>

<span data-ttu-id="1965d-115">Lorsqu’un Runbook est publié, les Runbooks enfants qu’il appelle doivent déjà être publiés.</span><span class="sxs-lookup"><span data-stu-id="1965d-115">When a runbook is published, any child runbooks that it calls must already be published.</span></span> <span data-ttu-id="1965d-116">En effet, Azure Automation crée une association avec tous les Runbooks enfants lorsqu’un Runbook est compilé.</span><span class="sxs-lookup"><span data-stu-id="1965d-116">This is because Azure Automation builds an association with any child runbooks when a runbook is compiled.</span></span> <span data-ttu-id="1965d-117">Si elles ne sont pas, le runbook parent hello apparaîtra toopublish correctement, mais génère une exception lorsqu’il est démarré.</span><span class="sxs-lookup"><span data-stu-id="1965d-117">If they aren’t, hello parent runbook will appear toopublish properly, but will generate an exception when it’s started.</span></span> <span data-ttu-id="1965d-118">Dans ce cas, vous pouvez republier le runbook parent hello dans les runbooks enfants hello ordre tooproperly référence.</span><span class="sxs-lookup"><span data-stu-id="1965d-118">If this happens, you can republish hello parent runbook in order tooproperly reference hello child runbooks.</span></span> <span data-ttu-id="1965d-119">Il est inutile toorepublish hello parent runbook si les runbooks enfants de hello sont modifiés, car l’association de hello est déjà créée.</span><span class="sxs-lookup"><span data-stu-id="1965d-119">You do not need toorepublish hello parent runbook if any of hello child runbooks are changed because hello association will have already been created.</span></span>

<span data-ttu-id="1965d-120">paramètres Hello d’un runbook enfant appelé inline peuvent être n’importe quel type de données, y compris les objets complexes et il n’est pas [sérialisation JSON](automation-starting-a-runbook.md#runbook-parameters) qu’il est quand vous démarrez runbook hello à l’aide de hello portail de gestion Azure, ou par hello Applet de commande Start-AzureRmAutomationRunbook.</span><span class="sxs-lookup"><span data-stu-id="1965d-120">hello parameters of a child runbook called inline can be any data type including complex objects, and there is no [JSON serialization](automation-starting-a-runbook.md#runbook-parameters) as there is when you start hello runbook using hello Azure Management Portal or with hello Start-AzureRmAutomationRunbook cmdlet.</span></span>

### <a name="runbook-types"></a><span data-ttu-id="1965d-121">Types de runbook</span><span class="sxs-lookup"><span data-stu-id="1965d-121">Runbook types</span></span>
<span data-ttu-id="1965d-122">Types pouvant s’appeler mutuellement :</span><span class="sxs-lookup"><span data-stu-id="1965d-122">Which types can call each other:</span></span>

* <span data-ttu-id="1965d-123">Un [runbook PowerShell](automation-runbook-types.md#powershell-runbooks) et des [runbooks graphiques](automation-runbook-types.md#graphical-runbooks) peuvent s’appeler mutuellement en ligne (les deux sont basés sur PowerShell).</span><span class="sxs-lookup"><span data-stu-id="1965d-123">A [PowerShell runbook](automation-runbook-types.md#powershell-runbooks) and [Graphical runbooks](automation-runbook-types.md#graphical-runbooks) can call each other inline (both are PowerShell based).</span></span>
* <span data-ttu-id="1965d-124">Un [runbook PowerShell Workflow](automation-runbook-types.md#powershell-workflow-runbooks) et des runbooks PowerShell Workflow graphiques peuvent s’appeler mutuellement en ligne (les deux sont basé sur PowerShell)</span><span class="sxs-lookup"><span data-stu-id="1965d-124">A [PowerShell Workflow runbook](automation-runbook-types.md#powershell-workflow-runbooks) and Graphical PowerShell Workflow runbooks can call each other inline (both are PowerShell Workflow based)</span></span>
* <span data-ttu-id="1965d-125">Hello PowerShell types et hello que types de flux de travail PowerShell ne peut pas appeler les uns des autres inline et doit utiliser AzureRmAutomationRunbook de début.</span><span class="sxs-lookup"><span data-stu-id="1965d-125">hello PowerShell types and hello PowerShell Workflow types can’t call each other inline, and must use Start-AzureRmAutomationRunbook.</span></span>

<span data-ttu-id="1965d-126">Pertinence de l’ordre de publication :</span><span class="sxs-lookup"><span data-stu-id="1965d-126">When does publish order matter:</span></span>

* <span data-ttu-id="1965d-127">Hello publier l’ordre des procédures opérationnelles a une incidence uniquement pour les runbooks PowerShell Workflow et les flux de travail PowerShell graphique.</span><span class="sxs-lookup"><span data-stu-id="1965d-127">hello publish order of runbooks only matters for PowerShell Workflow and Graphical PowerShell Workflow runbooks.</span></span>

<span data-ttu-id="1965d-128">Lorsque vous appelez un runbook enfant graphique ou de flux de travail PowerShell à l’aide de l’exécution inline, vous utilisez simplement nom hello de hello runbook.</span><span class="sxs-lookup"><span data-stu-id="1965d-128">When you call a Graphical or PowerShell Workflow child runbook using inline execution, you just use hello name of hello runbook.</span></span>  <span data-ttu-id="1965d-129">Lorsque vous appelez un runbook enfant de PowerShell, vous devez précédé son nom avec *.\\*  toospecify qui hello script se trouve dans le répertoire local de hello.</span><span class="sxs-lookup"><span data-stu-id="1965d-129">When you call a PowerShell child runbook, you must preceded its name with *.\\* toospecify that hello script is located in hello local directory.</span></span> 

### <a name="example"></a><span data-ttu-id="1965d-130">Exemple</span><span class="sxs-lookup"><span data-stu-id="1965d-130">Example</span></span>
<span data-ttu-id="1965d-131">Bonjour à l’exemple suivant appelle un runbook enfant qui accepte trois paramètres, un objet complexe, un entier et une valeur booléenne.</span><span class="sxs-lookup"><span data-stu-id="1965d-131">hello following example invokes a test child runbook that accepts three parameters, a complex object, an integer, and a boolean.</span></span> <span data-ttu-id="1965d-132">sortie de Hello du runbook enfant de hello est affectée tooa variable.</span><span class="sxs-lookup"><span data-stu-id="1965d-132">hello output of hello child runbook is assigned tooa variable.</span></span>  <span data-ttu-id="1965d-133">Dans ce cas, le runbook enfant hello est un runbook PowerShell Workflow</span><span class="sxs-lookup"><span data-stu-id="1965d-133">In this case, hello child runbook is a PowerShell Workflow runbook</span></span>

    $vm = Get-AzureRmVM –ResourceGroupName "LabRG" –Name "MyVM"
    $output = PSWF-ChildRunbook –VM $vm –RepeatCount 2 –Restart $true

<span data-ttu-id="1965d-134">Voici hello même exemple à l’aide d’un runbook PowerShell en tant qu’enfant de hello.</span><span class="sxs-lookup"><span data-stu-id="1965d-134">Following is hello same example using a PowerShell runbook as hello child.</span></span>

    $vm = Get-AzureRmVM –ResourceGroupName "LabRG" –Name "MyVM"
    $output = .\PS-ChildRunbook.ps1 –VM $vm –RepeatCount 2 –Restart $true


## <a name="starting-a-child-runbook-using-cmdlet"></a><span data-ttu-id="1965d-135">Démarrage d’un Runbook enfant à l’aide d’une applet de commande</span><span class="sxs-lookup"><span data-stu-id="1965d-135">Starting a child runbook using cmdlet</span></span>
<span data-ttu-id="1965d-136">Vous pouvez utiliser hello [Start-AzureRmAutomationRunbook](https://msdn.microsoft.com/library/mt603661.aspx) toostart de l’applet de commande un runbook, comme décrit dans [toostart un runbook avec Windows PowerShell](automation-starting-a-runbook.md#starting-a-runbook-with-windows-powershell).</span><span class="sxs-lookup"><span data-stu-id="1965d-136">You can use hello [Start-AzureRmAutomationRunbook](https://msdn.microsoft.com/library/mt603661.aspx) cmdlet toostart a runbook as described in [toostart a runbook with Windows PowerShell](automation-starting-a-runbook.md#starting-a-runbook-with-windows-powershell).</span></span> <span data-ttu-id="1965d-137">Il existe deux modes d’utilisation pour cette applet de commande.</span><span class="sxs-lookup"><span data-stu-id="1965d-137">There are two modes of use for this cmdlet.</span></span>  <span data-ttu-id="1965d-138">Dans un mode, hello applet de commande renvoie les id de tâche hello dès que la tâche enfant de hello est créé pour le runbook enfant hello.</span><span class="sxs-lookup"><span data-stu-id="1965d-138">In one mode, hello cmdlet returns hello job id as soon as hello child job is created for hello child runbook.</span></span>  <span data-ttu-id="1965d-139">Dans hello autre mode, vous activez en spécifiant hello **-attente** paramètre, attend que les enfants hello hello applet de commande de la tâche se termine et retourne la sortie de hello du runbook enfant de hello.</span><span class="sxs-lookup"><span data-stu-id="1965d-139">In hello other mode, which you enable by specifying hello **-wait** parameter, hello cmdlet will wait until hello child job finishes and will return hello output from hello child runbook.</span></span>

<span data-ttu-id="1965d-140">tâche Hello à partir d’un runbook enfant démarré avec une applet de commande s’exécute dans un travail distinct hello parent runbook.</span><span class="sxs-lookup"><span data-stu-id="1965d-140">hello job from a child runbook started with a cmdlet will run in a separate job from hello parent runbook.</span></span> <span data-ttu-id="1965d-141">Cela entraîne plus de travaux que l’appel hello runbook inline et les rend plus difficile tootrack.</span><span class="sxs-lookup"><span data-stu-id="1965d-141">This results in more jobs than invoking hello runbook inline and makes them more difficult tootrack.</span></span> <span data-ttu-id="1965d-142">parent de Hello peut démarrer plusieurs runbooks enfants de façon asynchrone sans attendre que chaque toocomplete.</span><span class="sxs-lookup"><span data-stu-id="1965d-142">hello parent can start multiple child runbooks asynchronously without waiting for each toocomplete.</span></span> <span data-ttu-id="1965d-143">Pour que ce même type d’exécution parallèle appelle les runbooks enfants de hello, le runbook parent hello devez toouse hello [mot clé parallel](automation-powershell-workflow.md#parallel-processing).</span><span class="sxs-lookup"><span data-stu-id="1965d-143">For that same kind of parallel execution calling hello child runbooks inline, hello parent runbook would need toouse hello [parallel keyword](automation-powershell-workflow.md#parallel-processing).</span></span>

<span data-ttu-id="1965d-144">Les paramètres d’un runbook enfant démarré avec une applet de commande sont fournis sous forme de table de hachage, comme décrit dans [Paramètres du runbook](automation-starting-a-runbook.md#runbook-parameters).</span><span class="sxs-lookup"><span data-stu-id="1965d-144">Parameters for a child runbook started with a cmdlet are provided as a hashtable as described in [Runbook Parameters](automation-starting-a-runbook.md#runbook-parameters).</span></span> <span data-ttu-id="1965d-145">Seuls les types de données simples peuvent être utilisés.</span><span class="sxs-lookup"><span data-stu-id="1965d-145">Only simple data types can be used.</span></span> <span data-ttu-id="1965d-146">Si hello runbook possède un paramètre avec un type de données complexe, puis il doit être appelé inline.</span><span class="sxs-lookup"><span data-stu-id="1965d-146">If hello runbook has a parameter with a complex data type, then it must be called inline.</span></span>

### <a name="example"></a><span data-ttu-id="1965d-147">Exemple</span><span class="sxs-lookup"><span data-stu-id="1965d-147">Example</span></span>
<span data-ttu-id="1965d-148">Hello exemple suivant démarre un runbook enfant avec des paramètres et puis attend toocomplete à l’aide de hello AzureRmAutomationRunbook-Start-attendre le paramètre.</span><span class="sxs-lookup"><span data-stu-id="1965d-148">hello following example starts a child runbook with parameters and then waits for it toocomplete using hello Start-AzureRmAutomationRunbook -wait parameter.</span></span> <span data-ttu-id="1965d-149">Une fois terminé, sa sortie est collectée à partir de runbook d’enfant hello.</span><span class="sxs-lookup"><span data-stu-id="1965d-149">Once completed, its output is collected from hello child runbook.</span></span>

    $params = @{"VMName"="MyVM";"RepeatCount"=2;"Restart"=$true} 
    $joboutput = Start-AzureRmAutomationRunbook –AutomationAccountName "MyAutomationAccount" –Name "Test-ChildRunbook" -ResourceGroupName "LabRG" –Parameters $params –wait


## <a name="comparison-of-methods-for-calling-a-child-runbook"></a><span data-ttu-id="1965d-150">Comparaison des méthodes pour l’appel d’un Runbook enfant</span><span class="sxs-lookup"><span data-stu-id="1965d-150">Comparison of methods for calling a child runbook</span></span>
<span data-ttu-id="1965d-151">Hello tableau suivant résume les différences de hello entre hello deux méthodes d’appel d’un runbook à partir d’un autre runbook.</span><span class="sxs-lookup"><span data-stu-id="1965d-151">hello following table summarizes hello differences between hello two methods for calling a runbook from another runbook.</span></span>

|  | <span data-ttu-id="1965d-152">En ligne</span><span class="sxs-lookup"><span data-stu-id="1965d-152">Inline</span></span> | <span data-ttu-id="1965d-153">Applet de commande</span><span class="sxs-lookup"><span data-stu-id="1965d-153">Cmdlet</span></span> |
|:--- |:--- |:--- |
| <span data-ttu-id="1965d-154">Travail</span><span class="sxs-lookup"><span data-stu-id="1965d-154">Job</span></span> |<span data-ttu-id="1965d-155">Runbooks enfants s’exécutent dans hello même de la tâche en tant que parent de hello.</span><span class="sxs-lookup"><span data-stu-id="1965d-155">Child runbooks run in hello same job as hello parent.</span></span> |<span data-ttu-id="1965d-156">Un travail distinct est créé pour le runbook enfant hello.</span><span class="sxs-lookup"><span data-stu-id="1965d-156">A separate job is created for hello child runbook.</span></span> |
| <span data-ttu-id="1965d-157">Exécution</span><span class="sxs-lookup"><span data-stu-id="1965d-157">Execution</span></span> |<span data-ttu-id="1965d-158">Le runbook parent attend hello enfant runbook toocomplete avant de continuer.</span><span class="sxs-lookup"><span data-stu-id="1965d-158">Parent runbook waits for hello child runbook toocomplete before continuing.</span></span> |<span data-ttu-id="1965d-159">Le runbook parent se poursuit immédiatement après le démarrage du runbook enfant *ou* runbook parent attend toofinish de travail enfant hello.</span><span class="sxs-lookup"><span data-stu-id="1965d-159">Parent runbook continues immediately after child runbook is started *or* parent runbook waits for hello child job toofinish.</span></span> |
| <span data-ttu-id="1965d-160">Sortie</span><span class="sxs-lookup"><span data-stu-id="1965d-160">Output</span></span> |<span data-ttu-id="1965d-161">Le Runbook parent peut obtenir directement la sortie du Runbook enfant.</span><span class="sxs-lookup"><span data-stu-id="1965d-161">Parent runbook can directly get output from child runbook.</span></span> |<span data-ttu-id="1965d-162">Le runbook parent doit récupérer la sortie à partir de la tâche du runbook enfant *ou* le runbook parent peut obtenir directement la sortie du runbook enfant.</span><span class="sxs-lookup"><span data-stu-id="1965d-162">Parent runbook must retrieve output from child runbook job *or* parent runbook can directly get output from child runbook.</span></span> |
| <span data-ttu-id="1965d-163">Paramètres</span><span class="sxs-lookup"><span data-stu-id="1965d-163">Parameters</span></span> |<span data-ttu-id="1965d-164">Les valeurs des paramètres de runbook hello enfant sont spécifiées séparément et peuvent utiliser n’importe quel type de données.</span><span class="sxs-lookup"><span data-stu-id="1965d-164">Values for hello child runbook parameters are specified separately and can use any data type.</span></span> |<span data-ttu-id="1965d-165">Les valeurs de hello du runbook enfant doivent être combinées en une seule table de hachage de paramètres et ne peuvent contenir que simple, de tableau et types de données exploitant la sérialisation JSON de l’objet.</span><span class="sxs-lookup"><span data-stu-id="1965d-165">Values for hello child runbook parameters must be combined into a single hashtable and can only include simple, array, and object data types that leverage JSON serialization.</span></span> |
| <span data-ttu-id="1965d-166">Compte Automation</span><span class="sxs-lookup"><span data-stu-id="1965d-166">Automation Account</span></span> |<span data-ttu-id="1965d-167">Le runbook parent peut uniquement utiliser le runbook enfant Bonjour même compte automation.</span><span class="sxs-lookup"><span data-stu-id="1965d-167">Parent runbook can only use child runbook in hello same automation account.</span></span> |<span data-ttu-id="1965d-168">Le runbook parent peut utiliser runbook enfant à partir de n’importe quel compte automation à partir de hello même abonnement Azure et même un autre abonnement si vous avez un tooit de connexion.</span><span class="sxs-lookup"><span data-stu-id="1965d-168">Parent runbook can use child runbook from any automation account from hello same Azure subscription and even a different subscription if you have a connection tooit.</span></span> |
| <span data-ttu-id="1965d-169">Publication</span><span class="sxs-lookup"><span data-stu-id="1965d-169">Publishing</span></span> |<span data-ttu-id="1965d-170">Le Runbook enfant doit être publié avant la publication du Runbook parent.</span><span class="sxs-lookup"><span data-stu-id="1965d-170">Child runbook must be published before parent runbook is published.</span></span> |<span data-ttu-id="1965d-171">Le Runbook enfant doit être publié avant le démarrage du Runbook parent.</span><span class="sxs-lookup"><span data-stu-id="1965d-171">Child runbook must be published any time before parent runbook is started.</span></span> |

## <a name="next-steps"></a><span data-ttu-id="1965d-172">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="1965d-172">Next steps</span></span>
* [<span data-ttu-id="1965d-173">Démarrage d'un Runbook dans Azure Automation</span><span class="sxs-lookup"><span data-stu-id="1965d-173">Starting a runbook in Azure Automation</span></span>](automation-starting-a-runbook.md)
* [<span data-ttu-id="1965d-174">Sortie et messages de Runbook dans Azure Automation</span><span class="sxs-lookup"><span data-stu-id="1965d-174">Runbook output and messages in Azure Automation</span></span>](automation-runbook-output-and-messages.md)

