---
title: "aaaIntegrate Azure Automation avec contrôle de code source Visual Studio Team Services | Documents Microsoft"
description: "Ce scénario vous guide pour la configuration de l’intégration dans un compte Azure Automation et pour le contrôle de code source Visual Studio Team Services."
services: automation
documentationcenter: 
author: eamono
manager: 
editor: 
keywords: "Azure powershell, VSTS, contrôle de code source, automation"
ms.assetid: a43b395a-e740-41a3-ae62-40eac9d0ec00
ms.service: automation
ms.workload: infrastructure-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/24/2017
ms.openlocfilehash: 8f6faa596a5ad1f8b72e820ca320b3e103d83579
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="azure-automation-scenario---automation-source-control-integration-with-visual-studio-team-services"></a><span data-ttu-id="15fdb-104">Scénario Azure Automation - Intégration du contrôle de code source Automation dans Visual Studio Team Services</span><span class="sxs-lookup"><span data-stu-id="15fdb-104">Azure Automation scenario - Automation source control integration with Visual Studio Team Services</span></span>

<span data-ttu-id="15fdb-105">Dans ce scénario, vous avez un projet Visual Studio Team Services que vous utilisez des runbooks d’automatisation Azure toomanage ou les configurations DSC sous contrôle de code source.</span><span class="sxs-lookup"><span data-stu-id="15fdb-105">In this scenario, you have a Visual Studio Team Services project that you are using toomanage Azure Automation runbooks or DSC configurations under source control.</span></span>
<span data-ttu-id="15fdb-106">Cet article décrit comment toointegrate VSTS à votre environnement Azure Automation afin que l’intégration continue se produit pour chaque archivage.</span><span class="sxs-lookup"><span data-stu-id="15fdb-106">This article describes how toointegrate VSTS with your Azure Automation environment so that continuous integration happens for each check-in.</span></span>

## <a name="getting-hello-scenario"></a><span data-ttu-id="15fdb-107">Scénario de hello mise en route</span><span class="sxs-lookup"><span data-stu-id="15fdb-107">Getting hello scenario</span></span>

<span data-ttu-id="15fdb-108">Ce scénario se compose de deux procédures opérationnelles PowerShell que vous pouvez importer directement à partir de hello [galerie de runbooks](automation-runbook-gallery.md) dans hello portail Azure ou les télécharger à partir de hello [PowerShell Gallery](https://www.powershellgallery.com).</span><span class="sxs-lookup"><span data-stu-id="15fdb-108">This scenario consists of two PowerShell runbooks that you can import directly from hello [Runbook Gallery](automation-runbook-gallery.md) in hello Azure portal or download from hello [PowerShell Gallery](https://www.powershellgallery.com).</span></span>

### <a name="runbooks"></a><span data-ttu-id="15fdb-109">Runbooks</span><span class="sxs-lookup"><span data-stu-id="15fdb-109">Runbooks</span></span>

<span data-ttu-id="15fdb-110">Runbook</span><span class="sxs-lookup"><span data-stu-id="15fdb-110">Runbook</span></span> | <span data-ttu-id="15fdb-111">Description</span><span class="sxs-lookup"><span data-stu-id="15fdb-111">Description</span></span>| 
--------|------------|
<span data-ttu-id="15fdb-112">Sync-VSTS</span><span class="sxs-lookup"><span data-stu-id="15fdb-112">Sync-VSTS</span></span> | <span data-ttu-id="15fdb-113">Importer des runbooks ou des configurations à partir du contrôle de code source VSTS lorsqu’un archivage est effectué.</span><span class="sxs-lookup"><span data-stu-id="15fdb-113">Import runbooks or configurations from VSTS source control when a check-in is done.</span></span> <span data-ttu-id="15fdb-114">Si vous exécutez manuellement, il importer et publier toutes les procédures opérationnelles ou les configurations dans hello compte Automation.</span><span class="sxs-lookup"><span data-stu-id="15fdb-114">If run manually, it will import and publish all runbooks or configurations into hello Automation account.</span></span>| 
<span data-ttu-id="15fdb-115">Sync-VSTSGit</span><span class="sxs-lookup"><span data-stu-id="15fdb-115">Sync-VSTSGit</span></span> | <span data-ttu-id="15fdb-116">Importer des runbooks ou des configurations à partir du contrôle de code source VSTS sous Git lorsqu’un archivage est effectué.</span><span class="sxs-lookup"><span data-stu-id="15fdb-116">Import runbooks or configurations from VSTS under Git source control when a check-in is done.</span></span> <span data-ttu-id="15fdb-117">Si vous exécutez manuellement, il importer et publier toutes les procédures opérationnelles ou les configurations dans hello compte Automation.</span><span class="sxs-lookup"><span data-stu-id="15fdb-117">If run manually, it will import and publish all runbooks or configurations into hello Automation account.</span></span>|

### <a name="variables"></a><span data-ttu-id="15fdb-118">variables</span><span class="sxs-lookup"><span data-stu-id="15fdb-118">Variables</span></span>

<span data-ttu-id="15fdb-119">Variable</span><span class="sxs-lookup"><span data-stu-id="15fdb-119">Variable</span></span> | <span data-ttu-id="15fdb-120">Description</span><span class="sxs-lookup"><span data-stu-id="15fdb-120">Description</span></span>|
-----------|------------|
<span data-ttu-id="15fdb-121">VSToken</span><span class="sxs-lookup"><span data-stu-id="15fdb-121">VSToken</span></span> | <span data-ttu-id="15fdb-122">Ressource de variable sécurisé, vous allez créer qui contient le jeton d’accès personnel hello VSTS.</span><span class="sxs-lookup"><span data-stu-id="15fdb-122">Secure variable asset you will create that contains hello VSTS personal access token.</span></span> <span data-ttu-id="15fdb-123">Vous pouvez apprendre comment toocreate personnelle VSTS aux jetons sur hello [page d’authentification VSTS](https://www.visualstudio.com/en-us/docs/integrate/get-started/auth/overview).</span><span class="sxs-lookup"><span data-stu-id="15fdb-123">You can learn how toocreate a VSTS personal access token on hello [VSTS authentication page](https://www.visualstudio.com/en-us/docs/integrate/get-started/auth/overview).</span></span> 
## <a name="installing-and-configuring-this-scenario"></a><span data-ttu-id="15fdb-124">Installation et configuration de ce scénario</span><span class="sxs-lookup"><span data-stu-id="15fdb-124">Installing and configuring this scenario</span></span>

<span data-ttu-id="15fdb-125">Créer un [jeton d’accès personnel](https://www.visualstudio.com/en-us/docs/integrate/get-started/auth/overview) dans VSTS que vous utiliserez toosync hello runbooks ou les configurations dans votre compte automation.</span><span class="sxs-lookup"><span data-stu-id="15fdb-125">Create a [personal access token](https://www.visualstudio.com/en-us/docs/integrate/get-started/auth/overview) in VSTS that you will use toosync hello runbooks or configurations into your automation account.</span></span>

![](media/automation-scenario-source-control-integration-with-VSTS/VSTSPersonalToken.png) 

<span data-ttu-id="15fdb-126">Créer un [variable secure](automation-variables.md) dans votre hello toohold du compte automation accès personnel jeton afin que hello runbook peut authentifier les runbooks hello tooVSTS et la synchronisation ou les configurations dans hello compte Automation.</span><span class="sxs-lookup"><span data-stu-id="15fdb-126">Create a [secure variable](automation-variables.md) in your automation account toohold hello personal access token so that hello runbook can authenticate tooVSTS and sync hello runbooks or configurations into hello Automation account.</span></span> <span data-ttu-id="15fdb-127">Vous pouvez la nommer VSToken.</span><span class="sxs-lookup"><span data-stu-id="15fdb-127">You can name this VSToken.</span></span> 

![](media/automation-scenario-source-control-integration-with-VSTS/VSTSTokenVariable.png)

<span data-ttu-id="15fdb-128">Importer le runbook hello synchroniser votre runbook ou les configurations dans le compte d’automatisation hello.</span><span class="sxs-lookup"><span data-stu-id="15fdb-128">Import hello runbook that will sync your runbooks or configurations into hello automation account.</span></span> <span data-ttu-id="15fdb-129">Vous pouvez utiliser hello [VSTS exemple runbook](https://www.powershellgallery.com/packages/Sync-VSTS/1.0/DisplayScript) ou hello [VSTS avec l’exemple de runbook Git] (https://www.powershellgallery.com/packages/Sync-VSTSGit/1.0/DisplayScript) à partir de hello PowerShellGallery.com selon que vous utilisez VSTS VSTS avec Git ou contrôle de source et déployer le compte d’automatisation tooyour.</span><span class="sxs-lookup"><span data-stu-id="15fdb-129">You can use hello [VSTS sample runbook](https://www.powershellgallery.com/packages/Sync-VSTS/1.0/DisplayScript) or hello [VSTS with Git sample runbook] (https://www.powershellgallery.com/packages/Sync-VSTSGit/1.0/DisplayScript) from hello PowerShellGallery.com depending on if you use VSTS source control or VSTS with Git and deploy tooyour automation account.</span></span>

![](media/automation-scenario-source-control-integration-with-VSTS/VSTSPowerShellGallery.png)

<span data-ttu-id="15fdb-130">Vous pouvez à présent [publier](automation-creating-importing-runbook.md#publishing-a-runbook) ce runbook pour créer un webhook.</span><span class="sxs-lookup"><span data-stu-id="15fdb-130">You can now [publish](automation-creating-importing-runbook.md#publishing-a-runbook) this runbook so you can create a webhook.</span></span> 
![](media/automation-scenario-source-control-integration-with-VSTS/VSTSPublishRunbook.png)

<span data-ttu-id="15fdb-131">Créer un [webhook](automation-webhooks.md) pour ce runbook de VSTS de synchronisation et de remplissage dans paramètres hello comme indiqué ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="15fdb-131">Create a [webhook](automation-webhooks.md) for this Sync-VSTS runbook and fill in hello parameters as shown below.</span></span> <span data-ttu-id="15fdb-132">Veillez à que copier l’url du webhook hello car vous en aurez besoin pour un crochet de service dans VSTS.</span><span class="sxs-lookup"><span data-stu-id="15fdb-132">Make sure you copy hello webhook url as you will need it for a service hook in VSTS.</span></span> <span data-ttu-id="15fdb-133">Hello VSAccessTokenVariableName est le nom de hello (VSToken) de la variable sécurisé de hello que vous avez créé le jeton d’accès personnel hello antérieur toohold.</span><span class="sxs-lookup"><span data-stu-id="15fdb-133">hello VSAccessTokenVariableName is hello name (VSToken) of hello secure variable that you created earlier toohold hello personal access token.</span></span> 

<span data-ttu-id="15fdb-134">Intégration avec VSTS (synchronisation-VSTS.ps1) prendra hello paramètres suivants.</span><span class="sxs-lookup"><span data-stu-id="15fdb-134">Integrating with VSTS (Sync-VSTS.ps1) will take hello following parameters.</span></span>
### <a name="sync-vsts-parameters"></a><span data-ttu-id="15fdb-135">Paramètres Sync-VSTS</span><span class="sxs-lookup"><span data-stu-id="15fdb-135">Sync-VSTS Parameters</span></span>

<span data-ttu-id="15fdb-136">Paramètre</span><span class="sxs-lookup"><span data-stu-id="15fdb-136">Parameter</span></span> | <span data-ttu-id="15fdb-137">Description</span><span class="sxs-lookup"><span data-stu-id="15fdb-137">Description</span></span>| 
--------|------------|
<span data-ttu-id="15fdb-138">WebhookData</span><span class="sxs-lookup"><span data-stu-id="15fdb-138">WebhookData</span></span> | <span data-ttu-id="15fdb-139">Cela contient les informations de consignation hello envoyées à partir de raccordement de service hello VSTS.</span><span class="sxs-lookup"><span data-stu-id="15fdb-139">This will contain hello checkin information sent from hello VSTS service hook.</span></span> <span data-ttu-id="15fdb-140">Laissez ce paramètre vide.</span><span class="sxs-lookup"><span data-stu-id="15fdb-140">You should leave this parameter blank.</span></span>| 
<span data-ttu-id="15fdb-141">ResourceGroup</span><span class="sxs-lookup"><span data-stu-id="15fdb-141">ResourceGroup</span></span> | <span data-ttu-id="15fdb-142">Il s’agit de nom hello hello du groupe de ressources qui hello automation compte se trouve dans.</span><span class="sxs-lookup"><span data-stu-id="15fdb-142">This is hello name of hello resource group that hello automation account is in.</span></span>|
<span data-ttu-id="15fdb-143">AutomationAccountName</span><span class="sxs-lookup"><span data-stu-id="15fdb-143">AutomationAccountName</span></span> | <span data-ttu-id="15fdb-144">nom de Hello du compte automation hello qui est synchronisés avec VSTS.</span><span class="sxs-lookup"><span data-stu-id="15fdb-144">hello name of hello automation account that will sync with VSTS.</span></span>|
<span data-ttu-id="15fdb-145">VSFolder</span><span class="sxs-lookup"><span data-stu-id="15fdb-145">VSFolder</span></span> | <span data-ttu-id="15fdb-146">Le nom du dossier de hello dans VSTS où hello runbooks et les configurations existent.</span><span class="sxs-lookup"><span data-stu-id="15fdb-146">The name of hello folder in VSTS where hello runbooks and configurations exist.</span></span>|
<span data-ttu-id="15fdb-147">VSAccount</span><span class="sxs-lookup"><span data-stu-id="15fdb-147">VSAccount</span></span> | <span data-ttu-id="15fdb-148">nom Hello Hello compte Visual Studio Team Services.</span><span class="sxs-lookup"><span data-stu-id="15fdb-148">hello name of hello Visual Studio Team Services account.</span></span>| 
<span data-ttu-id="15fdb-149">VSAccessTokenVariableName</span><span class="sxs-lookup"><span data-stu-id="15fdb-149">VSAccessTokenVariableName</span></span> | <span data-ttu-id="15fdb-150">nom Hello de variable sécurisé hello (VSToken) qui contient le jeton d’accès personnel hello VSTS.</span><span class="sxs-lookup"><span data-stu-id="15fdb-150">hello name of hello secure variable (VSToken) that holds hello VSTS personal access token.</span></span>| 


![](media/automation-scenario-source-control-integration-with-VSTS/VSTSWebhook.png)

<span data-ttu-id="15fdb-151">Si vous utilisez VSTS avec GIT (synchronisation-VSTSGit.ps1), il prendra hello paramètres suivants.</span><span class="sxs-lookup"><span data-stu-id="15fdb-151">If you are using VSTS with GIT (Sync-VSTSGit.ps1) it will take hello following parameters.</span></span>

<span data-ttu-id="15fdb-152">Paramètre</span><span class="sxs-lookup"><span data-stu-id="15fdb-152">Parameter</span></span> | <span data-ttu-id="15fdb-153">Description</span><span class="sxs-lookup"><span data-stu-id="15fdb-153">Description</span></span>|
--------|------------|
<span data-ttu-id="15fdb-154">WebhookData</span><span class="sxs-lookup"><span data-stu-id="15fdb-154">WebhookData</span></span> | <span data-ttu-id="15fdb-155">Cela contient les informations de consignation hello envoyées à partir de raccordement de service hello VSTS.</span><span class="sxs-lookup"><span data-stu-id="15fdb-155">This will contain hello checkin information sent from hello VSTS service hook.</span></span> <span data-ttu-id="15fdb-156">Laissez ce paramètre vide.</span><span class="sxs-lookup"><span data-stu-id="15fdb-156">You should leave this parameter blank.</span></span>| <span data-ttu-id="15fdb-157">ResourceGroup</span><span class="sxs-lookup"><span data-stu-id="15fdb-157">ResourceGroup</span></span> | <span data-ttu-id="15fdb-158">Ce nom hello hello du groupe de ressources qui hello compte automation est.</span><span class="sxs-lookup"><span data-stu-id="15fdb-158">This hello name of hello resource group that hello automation account is in.</span></span>|
<span data-ttu-id="15fdb-159">AutomationAccountName</span><span class="sxs-lookup"><span data-stu-id="15fdb-159">AutomationAccountName</span></span> | <span data-ttu-id="15fdb-160">nom de Hello du compte automation hello qui est synchronisés avec VSTS.</span><span class="sxs-lookup"><span data-stu-id="15fdb-160">hello name of hello automation account that will sync with VSTS.</span></span>|
<span data-ttu-id="15fdb-161">VSAccount</span><span class="sxs-lookup"><span data-stu-id="15fdb-161">VSAccount</span></span> | <span data-ttu-id="15fdb-162">nom Hello Hello compte Visual Studio Team Services.</span><span class="sxs-lookup"><span data-stu-id="15fdb-162">hello name of hello Visual Studio Team Services account.</span></span>|
<span data-ttu-id="15fdb-163">VSProject</span><span class="sxs-lookup"><span data-stu-id="15fdb-163">VSProject</span></span> | <span data-ttu-id="15fdb-164">nom Hello du projet hello dans VSTS où hello runbooks et les configurations existent.</span><span class="sxs-lookup"><span data-stu-id="15fdb-164">hello name of hello project in VSTS where hello runbooks and configurations exist.</span></span>|
<span data-ttu-id="15fdb-165">GitRepo</span><span class="sxs-lookup"><span data-stu-id="15fdb-165">GitRepo</span></span> | <span data-ttu-id="15fdb-166">nom de Hello du référentiel Git de hello.</span><span class="sxs-lookup"><span data-stu-id="15fdb-166">hello name of hello Git repository.</span></span>|
<span data-ttu-id="15fdb-167">GitBranch</span><span class="sxs-lookup"><span data-stu-id="15fdb-167">GitBranch</span></span> | <span data-ttu-id="15fdb-168">nom de Hello de branche hello dans le référentiel Git de VSTS.</span><span class="sxs-lookup"><span data-stu-id="15fdb-168">hello name of hello branch in VSTS Git repository.</span></span>|
<span data-ttu-id="15fdb-169">Dossier</span><span class="sxs-lookup"><span data-stu-id="15fdb-169">Folder</span></span> | <span data-ttu-id="15fdb-170">nom Hello du dossier hello dans la branche Git de VSTS.</span><span class="sxs-lookup"><span data-stu-id="15fdb-170">hello name of hello folder in VSTS Git branch.</span></span>|
<span data-ttu-id="15fdb-171">VSAccessTokenVariableName</span><span class="sxs-lookup"><span data-stu-id="15fdb-171">VSAccessTokenVariableName</span></span> | <span data-ttu-id="15fdb-172">nom Hello de variable sécurisé hello (VSToken) qui contient le jeton d’accès personnel hello VSTS.</span><span class="sxs-lookup"><span data-stu-id="15fdb-172">hello name of hello secure variable (VSToken) that holds hello VSTS personal access token.</span></span>|

![](media/automation-scenario-source-control-integration-with-VSTS/VSTSGitWebhook.png)

<span data-ttu-id="15fdb-173">Créer un raccordement de service dans VSTS dossier toohello des archivages qui déclenche cet webhook sur l’archivage du code.</span><span class="sxs-lookup"><span data-stu-id="15fdb-173">Create a service hook in VSTS for check-ins toohello folder that triggers this webhook on code check-in.</span></span> <span data-ttu-id="15fdb-174">Sélectionnez Web Hooks comme toointegrate de service hello avec lorsque vous créez un nouvel abonnement.</span><span class="sxs-lookup"><span data-stu-id="15fdb-174">Select Web Hooks as hello service toointegrate with when you create a new subscription.</span></span> <span data-ttu-id="15fdb-175">Pour en savoir plus sur les webhooks de service, consultez la [documentation sur les webhooks de service VSTS](https://www.visualstudio.com/en-us/docs/marketplace/integrate/service-hooks/get-started).</span><span class="sxs-lookup"><span data-stu-id="15fdb-175">You can learn more about service hooks on [VSTS Service Hooks documentation](https://www.visualstudio.com/en-us/docs/marketplace/integrate/service-hooks/get-started).</span></span>
![](media/automation-scenario-source-control-integration-with-VSTS/VSTSServiceHook.png)

<span data-ttu-id="15fdb-176">Doit maintenant être en mesure de toodo tous les archivages de vos procédures opérationnelles et de configurations dans VSTS et que ces automatiquement synchronisation avait dans votre compte automation.</span><span class="sxs-lookup"><span data-stu-id="15fdb-176">You should now be able toodo all check-ins of your runbooks and configurations into VSTS and have these automatically sync’d into your automation account.</span></span>

![](media/automation-scenario-source-control-integration-with-VSTS/VSTSSyncRunbookOutput.png)

<span data-ttu-id="15fdb-177">Si vous exécutez ce runbook manuellement sans déclenchées par VSTS, vous pouvez laisser un paramètre de webhookdata hello vide et il effectuera une synchronisation complète à partir du dossier VSTS hello spécifié.</span><span class="sxs-lookup"><span data-stu-id="15fdb-177">If you run this runbook manually without being triggered by VSTS, you can leave hello webhookdata parameter empty and it will do a full sync from hello VSTS folder specified.</span></span>

<span data-ttu-id="15fdb-178">Si vous souhaitez le scénario de hello toouninstall, supprimez hello service raccordement VSTS, supprimer hello runbook et hello VSToken variable.</span><span class="sxs-lookup"><span data-stu-id="15fdb-178">If you wish toouninstall hello scenario, remove hello service hook from VSTS, delete hello runbook, and hello VSToken variable.</span></span>
