---
title: "aaaMy première PowerShell runbook dans Azure Automation | Documents Microsoft"
description: "Didacticiel qui vous guide tout au long de la création de hello, test et la publication d’un runbook PowerShell simple."
services: automation
documentationcenter: 
author: mgoedtel
manager: jwhit
editor: 
keywords: azure powershell, didacticiel sur le script powershell, automatisation powershell
ms.assetid: a43b395a-e740-41a3-ae62-40eac9d0ec00
ms.service: automation
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 03/26/2017
ms.author: magoedte;sngun
ms.openlocfilehash: abff94abe666cd8423c35b970b4162ba9247bcf8
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="my-first-powershell-runbook"></a><span data-ttu-id="783ed-104">Mon premier Runbook PowerShell</span><span class="sxs-lookup"><span data-stu-id="783ed-104">My first PowerShell runbook</span></span>

> [!div class="op_single_selector"]
> * [<span data-ttu-id="783ed-105">Graphique</span><span class="sxs-lookup"><span data-stu-id="783ed-105">Graphical</span></span>](automation-first-runbook-graphical.md)
> * [<span data-ttu-id="783ed-106">PowerShell</span><span class="sxs-lookup"><span data-stu-id="783ed-106">PowerShell</span></span>](automation-first-runbook-textual-powershell.md)
> * [<span data-ttu-id="783ed-107">Workflow PowerShell</span><span class="sxs-lookup"><span data-stu-id="783ed-107">PowerShell Workflow</span></span>](automation-first-runbook-textual.md)
> 
> 

<span data-ttu-id="783ed-108">Ce didacticiel vous guide dans la création de hello d’un [runbook PowerShell](automation-runbook-types.md#powershell-runbooks) dans Azure Automation.</span><span class="sxs-lookup"><span data-stu-id="783ed-108">This tutorial walks you through hello creation of a [PowerShell runbook](automation-runbook-types.md#powershell-runbooks) in Azure Automation.</span></span> <span data-ttu-id="783ed-109">Nous allons commencer avec un runbook simple que nous testons et publier pendant que nous expliquons comment tootrack hello état du travail de runbook hello.</span><span class="sxs-lookup"><span data-stu-id="783ed-109">We start with a simple runbook that we test and publish while we explain how tootrack hello status of hello runbook job.</span></span> <span data-ttu-id="783ed-110">Puis nous modifions hello runbook tooactually gérer des ressources Azure, dans ce cas de démarrer une machine virtuelle Azure.</span><span class="sxs-lookup"><span data-stu-id="783ed-110">Then we modify hello runbook tooactually manage Azure resources, in this case starting an Azure virtual machine.</span></span> <span data-ttu-id="783ed-111">Enfin, nous faisons hello runbook plus fiable en ajoutant des paramètres de runbook.</span><span class="sxs-lookup"><span data-stu-id="783ed-111">Lastly, we make hello runbook more robust by adding runbook parameters.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="783ed-112">Composants requis</span><span class="sxs-lookup"><span data-stu-id="783ed-112">Prerequisites</span></span>
<span data-ttu-id="783ed-113">toocomplete ce didacticiel, vous devez hello suivant :</span><span class="sxs-lookup"><span data-stu-id="783ed-113">toocomplete this tutorial, you need hello following:</span></span>

* <span data-ttu-id="783ed-114">Abonnement Azure.</span><span class="sxs-lookup"><span data-stu-id="783ed-114">Azure subscription.</span></span> <span data-ttu-id="783ed-115">Si vous n’avez pas encore d’abonnement, vous pouvez [activer vos avantages abonnés MSDN](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) ou <a href="/pricing/free-account/" target="_blank">[créer un compte gratuit](https://azure.microsoft.com/free/).</span><span class="sxs-lookup"><span data-stu-id="783ed-115">If you don't have one yet, you can [activate your MSDN subscriber benefits](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) or <a href="/pricing/free-account/" target="_blank">[sign up for a free account](https://azure.microsoft.com/free/).</span></span>
* <span data-ttu-id="783ed-116">[Compte Automation](automation-sec-configure-azure-runas-account.md) toohold hello runbook et authentifier les ressources tooAzure.</span><span class="sxs-lookup"><span data-stu-id="783ed-116">[Automation account](automation-sec-configure-azure-runas-account.md) toohold hello runbook and authenticate tooAzure resources.</span></span>  <span data-ttu-id="783ed-117">Ce compte doit avoir l’autorisation toostart et arrêter l’ordinateur virtuel de hello.</span><span class="sxs-lookup"><span data-stu-id="783ed-117">This account must have permission toostart and stop hello virtual machine.</span></span>
* <span data-ttu-id="783ed-118">Une machine virtuelle Azure.</span><span class="sxs-lookup"><span data-stu-id="783ed-118">An Azure virtual machine.</span></span> <span data-ttu-id="783ed-119">Nous arrêtons et démarrons cette machine afin qu’elle ne soit pas une machine virtuelle de production.</span><span class="sxs-lookup"><span data-stu-id="783ed-119">We stop and start this machine so it should not be a production VM.</span></span>

## <a name="step-1---create-new-runbook"></a><span data-ttu-id="783ed-120">Étape 1 - Création d’un Runbook</span><span class="sxs-lookup"><span data-stu-id="783ed-120">Step 1 - Create new runbook</span></span>
<span data-ttu-id="783ed-121">Nous allons commencer par la création d’un runbook simple qui génère du texte hello *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="783ed-121">We'll start by creating a simple runbook that outputs hello text *Hello World*.</span></span>

1. <span data-ttu-id="783ed-122">Bonjour portail Azure, ouvrez votre compte Automation.</span><span class="sxs-lookup"><span data-stu-id="783ed-122">In hello Azure portal, open your Automation account.</span></span>  
   <span data-ttu-id="783ed-123">page compte d’automatisation Hello vous donne un aperçu rapide des ressources de hello dans ce compte.</span><span class="sxs-lookup"><span data-stu-id="783ed-123">hello Automation account page gives you a quick view of hello resources in this account.</span></span> <span data-ttu-id="783ed-124">Vous devriez déjà posséder certains éléments.</span><span class="sxs-lookup"><span data-stu-id="783ed-124">You should already have some assets.</span></span> <span data-ttu-id="783ed-125">La plupart d'entre eux est des modules hello sont inclus automatiquement dans un compte Automation.</span><span class="sxs-lookup"><span data-stu-id="783ed-125">Most of those are hello modules that are automatically included in a new Automation account.</span></span> <span data-ttu-id="783ed-126">Vous devez également avoir la ressource d’informations d’identification hello qui est mentionné dans hello [conditions préalables](#prerequisites).</span><span class="sxs-lookup"><span data-stu-id="783ed-126">You should also have hello Credential asset that's mentioned in hello [prerequisites](#prerequisites).</span></span>
2. <span data-ttu-id="783ed-127">Cliquez sur hello **Runbooks** vignette tooopen hello liste des runbooks.</span><span class="sxs-lookup"><span data-stu-id="783ed-127">Click hello **Runbooks** tile tooopen hello list of runbooks.</span></span><br><br> <span data-ttu-id="783ed-128">![RunbooksControl](media/automation-first-runbook-textual-powershell/runbooks-control-tiles.png)</span><span class="sxs-lookup"><span data-stu-id="783ed-128">![RunbooksControl](media/automation-first-runbook-textual-powershell/runbooks-control-tiles.png)</span></span>  
3. <span data-ttu-id="783ed-129">Créer un runbook en cliquant sur hello **ajouter un runbook** bouton, puis **créer un runbook**.</span><span class="sxs-lookup"><span data-stu-id="783ed-129">Create a new runbook by clicking hello **Add a runbook** button and then **Create a new runbook**.</span></span>
4. <span data-ttu-id="783ed-130">Nommez hello hello runbook *MyFirstRunbook-PowerShell*.</span><span class="sxs-lookup"><span data-stu-id="783ed-130">Give hello runbook hello name *MyFirstRunbook-PowerShell*.</span></span>
5. <span data-ttu-id="783ed-131">Dans ce cas, nous allons toocreate un [runbook PowerShell](automation-runbook-types.md#powershell-runbooks) ainsi sélectionnez **Powershell** pour **le type de Runbook**.</span><span class="sxs-lookup"><span data-stu-id="783ed-131">In this case, we're going toocreate a [PowerShell runbook](automation-runbook-types.md#powershell-runbooks) so select **Powershell** for **Runbook type**.</span></span><br><br> <span data-ttu-id="783ed-132">![Types de Runbook](media/automation-first-runbook-textual-powershell/automation-runbook-type.png)</span><span class="sxs-lookup"><span data-stu-id="783ed-132">![Runbook Type](media/automation-first-runbook-textual-powershell/automation-runbook-type.png)</span></span>  
6. <span data-ttu-id="783ed-133">Cliquez sur **créer** toocreate hello runbook et l’éditeur de texte hello ouvert.</span><span class="sxs-lookup"><span data-stu-id="783ed-133">Click **Create** toocreate hello runbook and open hello textual editor.</span></span>

## <a name="step-2---add-code-toohello-runbook"></a><span data-ttu-id="783ed-134">Étape 2 : ajouter du code toohello runbook</span><span class="sxs-lookup"><span data-stu-id="783ed-134">Step 2 - Add code toohello runbook</span></span>
<span data-ttu-id="783ed-135">Vous pouvez soit code type directement dans les runbook hello, ou vous pouvez sélectionner des applets de commande, les runbooks et les ressources de hello contrôle de la bibliothèque et ont les ajoutés runbook toohello avec tous les paramètres associés.</span><span class="sxs-lookup"><span data-stu-id="783ed-135">You can either type code directly into hello runbook, or you can select cmdlets, runbooks, and assets from hello Library control and have them added toohello runbook with any related parameters.</span></span> <span data-ttu-id="783ed-136">Pour cette procédure pas à pas, vous tapez directement dans les runbook hello.</span><span class="sxs-lookup"><span data-stu-id="783ed-136">For this walkthrough, we type directly in hello runbook.</span></span>

1. <span data-ttu-id="783ed-137">Notre Runbook est actuellement vide, saisissez *Write-Output « Hello World »*.</span><span class="sxs-lookup"><span data-stu-id="783ed-137">Our runbook is currently empty, type *Write-Output "Hello World."*.</span></span><br><br> <span data-ttu-id="783ed-138">![Hello World](media/automation-first-runbook-textual-powershell/automation-helloworld.png)</span><span class="sxs-lookup"><span data-stu-id="783ed-138">![Hello World](media/automation-first-runbook-textual-powershell/automation-helloworld.png)</span></span>  
2. <span data-ttu-id="783ed-139">Enregistrer les runbook hello en cliquant sur **enregistrer**.</span><span class="sxs-lookup"><span data-stu-id="783ed-139">Save hello runbook by clicking **Save**.</span></span><br><br> <span data-ttu-id="783ed-140">![Bouton Enregistrer](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-save.png)</span><span class="sxs-lookup"><span data-stu-id="783ed-140">![Save Button](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-save.png)</span></span>  

## <a name="step-3---test-hello-runbook"></a><span data-ttu-id="783ed-141">Étape 3 : Test hello runbook</span><span class="sxs-lookup"><span data-stu-id="783ed-141">Step 3 - Test hello runbook</span></span>
<span data-ttu-id="783ed-142">Avant que nous publions hello runbook toomake il disponible en production, nous souhaitons tootest il toomake assurer qu’il fonctionne correctement.</span><span class="sxs-lookup"><span data-stu-id="783ed-142">Before we publish hello runbook toomake it available in production, we want tootest it toomake sure that it works properly.</span></span> <span data-ttu-id="783ed-143">Lorsque vous testez un Runbook, vous exécutez sa version **Brouillon** et affichez sa sortie de manière interactive.</span><span class="sxs-lookup"><span data-stu-id="783ed-143">When you test a runbook, you run its **Draft** version and view its output interactively.</span></span>

1. <span data-ttu-id="783ed-144">Cliquez sur **volet Test** volet de Test tooopen hello.</span><span class="sxs-lookup"><span data-stu-id="783ed-144">Click **Test pane** tooopen hello Test pane.</span></span><br><br> <span data-ttu-id="783ed-145">![Test Pane](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-test.png)</span><span class="sxs-lookup"><span data-stu-id="783ed-145">![Test Pane](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-test.png)</span></span>  
2. <span data-ttu-id="783ed-146">Cliquez sur **Démarrer** test de hello toostart.</span><span class="sxs-lookup"><span data-stu-id="783ed-146">Click **Start** toostart hello test.</span></span> <span data-ttu-id="783ed-147">Ce doit être l’option de hello uniquement activé.</span><span class="sxs-lookup"><span data-stu-id="783ed-147">This should be hello only enabled option.</span></span>
3. <span data-ttu-id="783ed-148">Une [tâche de Runbook](automation-runbook-execution.md) est créée et son état apparaît.</span><span class="sxs-lookup"><span data-stu-id="783ed-148">A [runbook job](automation-runbook-execution.md) is created and its status displayed.</span></span>  
   <span data-ttu-id="783ed-149">état de la tâche Hello démarre en tant que *en file d’attente* indiquant qu’il est en attente d’un runbook worker dans hello toocome de cloud disponible.</span><span class="sxs-lookup"><span data-stu-id="783ed-149">hello job status starts as *Queued* indicating that it is waiting for a runbook worker in hello cloud toocome available.</span></span> <span data-ttu-id="783ed-150">Il passe alors trop*départ* lorsqu’un processus de travail tâche de hello, les revendications, puis *en cours d’exécution* démarrage hello runbook réellement en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="783ed-150">It will then move too*Starting* when a worker claims hello job, and then *Running* when hello runbook actually starts running.</span></span>  
4. <span data-ttu-id="783ed-151">Fin de la tâche du runbook hello, sa sortie s’affiche.</span><span class="sxs-lookup"><span data-stu-id="783ed-151">When hello runbook job completes, its output is displayed.</span></span> <span data-ttu-id="783ed-152">Dans notre cas, nous devrions voir *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="783ed-152">In our case, we should see *Hello World*.</span></span><br><br> <span data-ttu-id="783ed-153">![Résultat du volet de test](media/automation-first-runbook-textual-powershell/automation-testpane-output.png)</span><span class="sxs-lookup"><span data-stu-id="783ed-153">![Test Pane Output](media/automation-first-runbook-textual-powershell/automation-testpane-output.png)</span></span>  
5. <span data-ttu-id="783ed-154">Fermez la zone de dessin hello Test volet tooreturn toohello.</span><span class="sxs-lookup"><span data-stu-id="783ed-154">Close hello Test pane tooreturn toohello canvas.</span></span>

## <a name="step-4---publish-and-start-hello-runbook"></a><span data-ttu-id="783ed-155">Étape 4 : publier et démarrer hello runbook</span><span class="sxs-lookup"><span data-stu-id="783ed-155">Step 4 - Publish and start hello runbook</span></span>
<span data-ttu-id="783ed-156">Hello runbook que vous avez créée est toujours en mode brouillon.</span><span class="sxs-lookup"><span data-stu-id="783ed-156">hello runbook that we created is still in Draft mode.</span></span> <span data-ttu-id="783ed-157">Nous devons toopublish avant de l’exécuter en production.</span><span class="sxs-lookup"><span data-stu-id="783ed-157">We need toopublish it before we can run it in production.</span></span>  <span data-ttu-id="783ed-158">Lorsque vous publiez un runbook, vous remplacez la version publiée existante de hello avec brouillon hello.</span><span class="sxs-lookup"><span data-stu-id="783ed-158">When you publish a runbook, you overwrite hello existing Published version with hello Draft version.</span></span>  <span data-ttu-id="783ed-159">Dans notre cas, nous n’avez pas une version publiée encore, car nous avons créé hello runbook.</span><span class="sxs-lookup"><span data-stu-id="783ed-159">In our case, we don't have a Published version yet because we just created hello runbook.</span></span>

1. <span data-ttu-id="783ed-160">Cliquez sur **publier** toopublish hello runbook, puis **Oui** lorsque vous y êtes invité.</span><span class="sxs-lookup"><span data-stu-id="783ed-160">Click **Publish** toopublish hello runbook and then **Yes** when prompted.</span></span><br><br> <span data-ttu-id="783ed-161">![Bouton Publier](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-publish.png)</span><span class="sxs-lookup"><span data-stu-id="783ed-161">![Publish button](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-publish.png)</span></span>  
2. <span data-ttu-id="783ed-162">Si vous faites défiler les runbook de hello tooview gauche Bonjour **Runbooks** volet maintenant, il affiche un **état de création** de **publié**.</span><span class="sxs-lookup"><span data-stu-id="783ed-162">If you scroll left tooview hello runbook in hello **Runbooks** pane now, it will show an **Authoring Status** of **Published**.</span></span>
3. <span data-ttu-id="783ed-163">Défilement arrière toohello tooview droite hello volet **MyFirstRunbook-PowerShell**.</span><span class="sxs-lookup"><span data-stu-id="783ed-163">Scroll back toohello right tooview hello pane for **MyFirstRunbook-PowerShell**.</span></span>  
   <span data-ttu-id="783ed-164">Hello options haut hello nous permettent de toostart hello runbook, afficher hello runbook, planifier son toostart à un moment donné dans hello future ou créer un [webhook](automation-webhooks.md) afin de pouvoir être démarrée par un appel HTTP.</span><span class="sxs-lookup"><span data-stu-id="783ed-164">hello options across hello top allow us toostart hello runbook, view hello runbook, schedule it toostart at some time in hello future, or create a [webhook](automation-webhooks.md) so it can be started through an HTTP call.</span></span>
4. <span data-ttu-id="783ed-165">Nous souhaitez toostart hello runbook, cliquez sur **Démarrer** puis cliquez sur **Ok** lorsque le panneau de démarrer le Runbook hello s’ouvre.</span><span class="sxs-lookup"><span data-stu-id="783ed-165">We want toostart hello runbook, so click **Start** and then click **Ok** when hello Start Runbook blade opens.</span></span><br><br> <span data-ttu-id="783ed-166">![Bouton Démarrer](media/automation-first-runbook-textual-powershell/automation-runbook-controls-start.png)</span><span class="sxs-lookup"><span data-stu-id="783ed-166">![Start button](media/automation-first-runbook-textual-powershell/automation-runbook-controls-start.png)</span></span><br>    
5. <span data-ttu-id="783ed-167">Un volet de travail est ouvert pour la tâche du runbook hello que nous avons créés.</span><span class="sxs-lookup"><span data-stu-id="783ed-167">A job pane is opened for hello runbook job that we created.</span></span> <span data-ttu-id="783ed-168">Nous pouvons fermer ce volet, mais dans ce cas nous laisser ouverte afin de nous pouvons observer la progression du travail hello.</span><span class="sxs-lookup"><span data-stu-id="783ed-168">We can close this pane, but in this case we leave it open so we can watch hello job's progress.</span></span>
6. <span data-ttu-id="783ed-169">état de la tâche Hello est indiqué dans **récapitulatif** et correspondances hello états que nous avons vu lorsque nous avons testé hello runbook.</span><span class="sxs-lookup"><span data-stu-id="783ed-169">hello job status is shown in **Job Summary** and matches hello statuses that we saw when we tested hello runbook.</span></span><br><br> <span data-ttu-id="783ed-170">![Résumé des tâches](media/automation-first-runbook-textual-powershell/job-pane-status-blade-jobsummary.png)</span><span class="sxs-lookup"><span data-stu-id="783ed-170">![Job Summary](media/automation-first-runbook-textual-powershell/job-pane-status-blade-jobsummary.png)</span></span><br>  
7. <span data-ttu-id="783ed-171">Une fois hello runbook état indique *terminé*, cliquez sur **sortie**.</span><span class="sxs-lookup"><span data-stu-id="783ed-171">Once hello runbook status shows *Completed*, click **Output**.</span></span> <span data-ttu-id="783ed-172">volet de sortie Hello est ouvert, et nous pouvons voir notre *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="783ed-172">hello Output pane is opened, and we can see our *Hello World*.</span></span><br><br> <span data-ttu-id="783ed-173">![Sortie de travail](media/automation-first-runbook-textual-powershell/job-pane-status-blade-outputtile.png)</span><span class="sxs-lookup"><span data-stu-id="783ed-173">![Job Output](media/automation-first-runbook-textual-powershell/job-pane-status-blade-outputtile.png)</span></span><br> 
8. <span data-ttu-id="783ed-174">Volet de sortie de fermeture hello.</span><span class="sxs-lookup"><span data-stu-id="783ed-174">Close hello Output pane.</span></span>
9. <span data-ttu-id="783ed-175">Cliquez sur **tous les journaux** volet de flux tooopen hello pour la tâche du runbook hello.</span><span class="sxs-lookup"><span data-stu-id="783ed-175">Click **All Logs** tooopen hello Streams pane for hello runbook job.</span></span> <span data-ttu-id="783ed-176">Nous devons uniquement voir *Hello World* dans la sortie de hello flux, mais cela peut afficher les autres flux pour un travail de runbook telles que des commentaires et d’erreur si hello runbook écrit toothem.</span><span class="sxs-lookup"><span data-stu-id="783ed-176">We should only see *Hello World* in hello output stream, but this can show other streams for a runbook job such as Verbose and Error if hello runbook writes toothem.</span></span><br><br> <span data-ttu-id="783ed-177">![Tous les journaux](media/automation-first-runbook-textual-powershell/job-pane-status-blade-alllogstile.png)</span><span class="sxs-lookup"><span data-stu-id="783ed-177">![All Logs](media/automation-first-runbook-textual-powershell/job-pane-status-blade-alllogstile.png)</span></span><br>   
10. <span data-ttu-id="783ed-178">Fermez hello flux volets et hello travail volet tooreturn toohello MyFirstRunbook-PowerShell.</span><span class="sxs-lookup"><span data-stu-id="783ed-178">Close hello Streams pane and hello Job pane tooreturn toohello MyFirstRunbook-PowerShell pane.</span></span>
11. <span data-ttu-id="783ed-179">Cliquez sur **travaux** volet de tâches tooopen hello pour ce runbook.</span><span class="sxs-lookup"><span data-stu-id="783ed-179">Click **Jobs** tooopen hello Jobs pane for this runbook.</span></span> <span data-ttu-id="783ed-180">Répertorie tous les travaux de hello créés par ce runbook.</span><span class="sxs-lookup"><span data-stu-id="783ed-180">This lists all of hello jobs created by this runbook.</span></span> <span data-ttu-id="783ed-181">Nous devons uniquement voir une tâche répertoriée dans la mesure où nous avons uniquement les travaux hello qu’une seule fois.</span><span class="sxs-lookup"><span data-stu-id="783ed-181">We should only see one job listed since we only ran hello job once.</span></span><br><br> <span data-ttu-id="783ed-182">![Liste des postes](media/automation-first-runbook-textual-powershell/runbook-control-job-tile.png)</span><span class="sxs-lookup"><span data-stu-id="783ed-182">![Job List](media/automation-first-runbook-textual-powershell/runbook-control-job-tile.png)</span></span>  
12. <span data-ttu-id="783ed-183">Vous pouvez cliquer sur ce travail tooopen hello même volet de travail que nous avons vu lorsque nous avons commencé hello runbook.</span><span class="sxs-lookup"><span data-stu-id="783ed-183">You can click this job tooopen hello same Job pane that we viewed when we started hello runbook.</span></span> <span data-ttu-id="783ed-184">Ainsi, vous toogo à temps et consulter les détails de hello d’un travail qui a été créé pour un runbook donné.</span><span class="sxs-lookup"><span data-stu-id="783ed-184">This allows you toogo back in time and view hello details of any job that was created for a particular runbook.</span></span>

## <a name="step-5---add-authentication-toomanage-azure-resources"></a><span data-ttu-id="783ed-185">Étape 5 : ajouter l’authentification toomanage ressources Azure</span><span class="sxs-lookup"><span data-stu-id="783ed-185">Step 5 - Add authentication toomanage Azure resources</span></span>
<span data-ttu-id="783ed-186">Nous avons testé et publié notre Runbook, mais jusqu'à présent, il ne fait rien d'utile.</span><span class="sxs-lookup"><span data-stu-id="783ed-186">We've tested and published our runbook, but so far it doesn't do anything useful.</span></span> <span data-ttu-id="783ed-187">Nous souhaitons toohave gérer les ressources Azure.</span><span class="sxs-lookup"><span data-stu-id="783ed-187">We want toohave it manage Azure resources.</span></span> <span data-ttu-id="783ed-188">Il ne sera pas en mesure de toodo que s’il s’authentifier à moins que nous avons à l’aide des informations d’identification hello qui sont référencés par tooin hello [conditions préalables](#prerequisites).</span><span class="sxs-lookup"><span data-stu-id="783ed-188">It won't be able toodo that though unless we have it authenticate using hello credentials that are referred tooin hello [prerequisites](#prerequisites).</span></span> <span data-ttu-id="783ed-189">Cela se fait par hello **Add-AzureRmAccount** applet de commande.</span><span class="sxs-lookup"><span data-stu-id="783ed-189">We do that with hello **Add-AzureRmAccount** cmdlet.</span></span>

1. <span data-ttu-id="783ed-190">Éditeur de texte hello ouvrir en cliquant sur **modifier** dans le volet de hello MyFirstRunbook-PowerShell.</span><span class="sxs-lookup"><span data-stu-id="783ed-190">Open hello textual editor by clicking **Edit** on hello MyFirstRunbook-PowerShell pane.</span></span><br><br> <span data-ttu-id="783ed-191">![Modifier un Runbook](media/automation-first-runbook-textual-powershell/automation-runbook-controls-edit.png)</span><span class="sxs-lookup"><span data-stu-id="783ed-191">![Edit Runbook](media/automation-first-runbook-textual-powershell/automation-runbook-controls-edit.png)</span></span><br>   
2. <span data-ttu-id="783ed-192">Nous ne devons hello **Write-Output** plus de ligne, par conséquent, continuez et le supprimer.</span><span class="sxs-lookup"><span data-stu-id="783ed-192">We don't need hello **Write-Output** line anymore, so go ahead and delete it.</span></span>
3. <span data-ttu-id="783ed-193">Tapez ou copiez-collez hello suivant le code qui gère l’authentification de hello avec votre compte Automation exécuter en tant que :</span><span class="sxs-lookup"><span data-stu-id="783ed-193">Type or copy and paste hello following code that handles hello authentication with your Automation Run As account:</span></span>
   
   ```
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID `
   -ApplicationId $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   ```
   <br>
4. <span data-ttu-id="783ed-194">Cliquez sur **Test volet** afin que nous puissions tester hello runbook.</span><span class="sxs-lookup"><span data-stu-id="783ed-194">Click **Test pane** so that we can test hello runbook.</span></span>
5. <span data-ttu-id="783ed-195">Cliquez sur **Démarrer** test de hello toostart.</span><span class="sxs-lookup"><span data-stu-id="783ed-195">Click **Start** toostart hello test.</span></span> <span data-ttu-id="783ed-196">Une fois terminée, vous devez recevoir toohello similaire de sortie suivant, l’affichage des informations de base à partir de votre compte.</span><span class="sxs-lookup"><span data-stu-id="783ed-196">Once it completes, you should receive output similar toohello following, displaying basic information from your account.</span></span> <span data-ttu-id="783ed-197">Cela confirme que ces informations d’identification hello sont valide.</span><span class="sxs-lookup"><span data-stu-id="783ed-197">This confirms that hello credential is valid.</span></span><br><br> <span data-ttu-id="783ed-198">![Authentifier](media/automation-first-runbook-textual-powershell/runbook-auth-output.png)</span><span class="sxs-lookup"><span data-stu-id="783ed-198">![Authenticate](media/automation-first-runbook-textual-powershell/runbook-auth-output.png)</span></span>

## <a name="step-6---add-code-toostart-a-virtual-machine"></a><span data-ttu-id="783ed-199">Étape 6 : ajouter du code toostart une machine virtuelle</span><span class="sxs-lookup"><span data-stu-id="783ed-199">Step 6 - Add code toostart a virtual machine</span></span>
<span data-ttu-id="783ed-200">Maintenant que notre runbook authentifie tooour abonnement Azure, nous pouvons gérer les ressources.</span><span class="sxs-lookup"><span data-stu-id="783ed-200">Now that our runbook is authenticating tooour Azure subscription, we can manage resources.</span></span> <span data-ttu-id="783ed-201">Nous ajoutons un toostart commande une machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="783ed-201">We add a command toostart a virtual machine.</span></span> <span data-ttu-id="783ed-202">Vous pouvez choisir n’importe quel ordinateur virtuel dans votre abonnement Azure, et pour l’instant, nous allons coder ce nom dans les runbook hello.</span><span class="sxs-lookup"><span data-stu-id="783ed-202">You can pick any virtual machine in your Azure subscription, and for now we will hardcode that name in hello runbook.</span></span>

1. <span data-ttu-id="783ed-203">Après avoir *Add-AzureRmAccount*, type *AzureRmVM de démarrage-nom 'VMName' - ResourceGroupName 'NameofResourceGroup'* fournissant les noms de hello et groupe de ressources de toostart de machine virtuelle hello.</span><span class="sxs-lookup"><span data-stu-id="783ed-203">After *Add-AzureRmAccount*, type *Start-AzureRmVM -Name 'VMName' -ResourceGroupName 'NameofResourceGroup'* providing hello name and Resource Group name of hello virtual machine toostart.</span></span>  
   
   ```
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID `
   -ApplicationID $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   Start-AzureRmVM -Name 'VMName' -ResourceGroupName 'ResourceGroupName'
   ```
   <br>
2. <span data-ttu-id="783ed-204">Enregistrer hello runbook, puis cliquez sur **Test volet** afin que nous puissions le tester.</span><span class="sxs-lookup"><span data-stu-id="783ed-204">Save hello runbook and then click **Test pane** so that we can test it.</span></span>
3. <span data-ttu-id="783ed-205">Cliquez sur **Démarrer** test de hello toostart.</span><span class="sxs-lookup"><span data-stu-id="783ed-205">Click **Start** toostart hello test.</span></span> <span data-ttu-id="783ed-206">Une fois terminée, vérifiez que l’ordinateur virtuel hello a été démarré.</span><span class="sxs-lookup"><span data-stu-id="783ed-206">Once it completes, check that hello virtual machine was started.</span></span>

## <a name="step-7---add-an-input-parameter-toohello-runbook"></a><span data-ttu-id="783ed-207">Étape 7 : ajouter un runbook toohello de paramètre d’entrée</span><span class="sxs-lookup"><span data-stu-id="783ed-207">Step 7 - Add an input parameter toohello runbook</span></span>
<span data-ttu-id="783ed-208">Notre runbook démarre actuellement hello virtuel de l’ordinateur que nous codé en dur dans les runbook hello, mais il est plus utile si nous spécifions la machine virtuelle de hello lorsque hello runbook est démarré.</span><span class="sxs-lookup"><span data-stu-id="783ed-208">Our runbook currently starts hello virtual machine that we hardcoded in hello runbook, but it would be more useful if we specify hello virtual machine when hello runbook is started.</span></span> <span data-ttu-id="783ed-209">Nous allons maintenant ajouter des paramètres d’entrée toohello runbook tooprovide cette fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="783ed-209">We will now add input parameters toohello runbook tooprovide that functionality.</span></span>

1. <span data-ttu-id="783ed-210">Ajouter des paramètres pour *VMName* et *ResourceGroupName* toohello runbook et utilisation de ces variables hello **AzureRmVM de début** applet de commande comme exemple hello ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="783ed-210">Add parameters for *VMName* and *ResourceGroupName* toohello runbook and use these variables with hello **Start-AzureRmVM** cmdlet as in hello example below.</span></span>  
   
   ```
   Param(
    [string]$VMName,
    [string]$ResourceGroupName
   )
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID `
   -ApplicationID $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   Start-AzureRmVM -Name $VMName -ResourceGroupName $ResourceGroupName
   ```
   <br>
2. <span data-ttu-id="783ed-211">Enregistrer les runbook hello et ouvrir le volet de Test hello.</span><span class="sxs-lookup"><span data-stu-id="783ed-211">Save hello runbook and open hello Test pane.</span></span> <span data-ttu-id="783ed-212">Vous pouvez maintenant fournir des valeurs pour hello deux variables d’entrée qui sont utilisés dans les tests de hello.</span><span class="sxs-lookup"><span data-stu-id="783ed-212">You can now provide values for hello two input variables that are used in hello test.</span></span>
3. <span data-ttu-id="783ed-213">Volet de Test hello fermer.</span><span class="sxs-lookup"><span data-stu-id="783ed-213">Close hello Test pane.</span></span>
4. <span data-ttu-id="783ed-214">Cliquez sur **publier** toopublish hello nouvelle version du runbook de hello.</span><span class="sxs-lookup"><span data-stu-id="783ed-214">Click **Publish** toopublish hello new version of hello runbook.</span></span>
5. <span data-ttu-id="783ed-215">Arrêter la machine virtuelle hello que vous avez démarrées à l’étape précédente de hello.</span><span class="sxs-lookup"><span data-stu-id="783ed-215">Stop hello virtual machine that you started in hello previous step.</span></span>
6. <span data-ttu-id="783ed-216">Cliquez sur **Démarrer** toostart hello runbook.</span><span class="sxs-lookup"><span data-stu-id="783ed-216">Click **Start** toostart hello runbook.</span></span> <span data-ttu-id="783ed-217">Type Bonjour **VMName** et **ResourceGroupName** pour la machine virtuelle de hello que vous allez toostart.</span><span class="sxs-lookup"><span data-stu-id="783ed-217">Type in hello **VMName** and **ResourceGroupName** for hello virtual machine that you're going toostart.</span></span><br><br> <span data-ttu-id="783ed-218">![Paramètre de réussite](media/automation-first-runbook-textual-powershell/automation-pass-params.png)</span><span class="sxs-lookup"><span data-stu-id="783ed-218">![Pass Parameter](media/automation-first-runbook-textual-powershell/automation-pass-params.png)</span></span><br>  
7. <span data-ttu-id="783ed-219">Lorsque hello runbook est terminée, vérifiez que l’ordinateur virtuel hello a été démarré.</span><span class="sxs-lookup"><span data-stu-id="783ed-219">When hello runbook completes, check that hello virtual machine was started.</span></span>

## <a name="differences-from-powershell-workflow"></a><span data-ttu-id="783ed-220">Différences par rapport à PowerShell Workflow</span><span class="sxs-lookup"><span data-stu-id="783ed-220">Differences from PowerShell Workflow</span></span>
<span data-ttu-id="783ed-221">Runbook PowerShell ont hello même cycle de vie, les fonctionnalités et gestion en tant que les runbooks PowerShell Workflow, mais il existe certaines différences et les limitations :</span><span class="sxs-lookup"><span data-stu-id="783ed-221">PowerShell runbooks have hello same lifecycle, capabilities, and management as PowerShell Workflow runbooks but there are some differences and limitations:</span></span>

1. <span data-ttu-id="783ed-222">Runbooks PowerShell exécuter tooPowerShell comparé rapide runbooks de flux de travail car ils n’ont pas étape de compilation.</span><span class="sxs-lookup"><span data-stu-id="783ed-222">PowerShell runbooks run fast compared tooPowerShell Workflow runbooks as they don’t have compilation step.</span></span>
2. <span data-ttu-id="783ed-223">Les runbooks PowerShell Workflow prend en charge les points de contrôle, à l’aide de points de contrôle, les runbooks PowerShell Workflow peut reprendre à partir de n’importe quel point dans le runbook de hello, tandis que les runbooks PowerShell peut reprendre uniquement à partir du début de hello.</span><span class="sxs-lookup"><span data-stu-id="783ed-223">PowerShell Workflow runbooks support checkpoints, using checkpoints, PowerShell Workflow runbooks can resume from any point in hello runbook whereas PowerShell runbooks can only resume from hello beginning.</span></span>
3. <span data-ttu-id="783ed-224">Les Runbooks PowerShell Workflow prennent en charge l’exécution parallèle et série, alors que les Runbooks PowerShell peuvent exécuter des commandes en série uniquement.</span><span class="sxs-lookup"><span data-stu-id="783ed-224">PowerShell Workflow runbooks support parallel and serial execution whereas PowerShell runbooks can only execute commands serially.</span></span>
4. <span data-ttu-id="783ed-225">Dans un runbook PowerShell Workflow, une activité, une commande ou un bloc de script peut avoir sa propre instance d’exécution, alors que dans un Runbook PowerShell, tous les éléments du script s’exécutent dans une instance d’exécution unique.</span><span class="sxs-lookup"><span data-stu-id="783ed-225">In a PowerShell Workflow runbook, an activity, a command, or a script block can have its own runspace whereas in a PowerShell runbook, everything in a script runs in a single runspace.</span></span> <span data-ttu-id="783ed-226">Il existe également certaines [différences syntaxiques](https://technet.microsoft.com/magazine/dn151046.aspx) entre un Runbook PowerShell natif et un Runbook PowerShell Workflow.</span><span class="sxs-lookup"><span data-stu-id="783ed-226">There are also some [syntactic differences](https://technet.microsoft.com/magazine/dn151046.aspx) between a native PowerShell runbook and a PowerShell Workflow runbook.</span></span>

## <a name="next-steps"></a><span data-ttu-id="783ed-227">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="783ed-227">Next steps</span></span>
* <span data-ttu-id="783ed-228">tooget main runbooks graphiques, consultez [mon premier runbook graphique](automation-first-runbook-graphical.md)</span><span class="sxs-lookup"><span data-stu-id="783ed-228">tooget started with Graphical runbooks, see [My first graphical runbook](automation-first-runbook-graphical.md)</span></span>
* <span data-ttu-id="783ed-229">tooget a démarré avec des runbooks de flux de travail PowerShell, consultez [mon premier runbook de flux de travail PowerShell](automation-first-runbook-textual.md)</span><span class="sxs-lookup"><span data-stu-id="783ed-229">tooget started with PowerShell workflow runbooks, see [My first PowerShell workflow runbook](automation-first-runbook-textual.md)</span></span>
* <span data-ttu-id="783ed-230">tooknow en savoir plus sur les types de runbook, leurs avantages et les limitations, consultez [types de runbook Azure Automation](automation-runbook-types.md)</span><span class="sxs-lookup"><span data-stu-id="783ed-230">tooknow more about runbook types, their advantages and limitations, see [Azure Automation runbook types](automation-runbook-types.md)</span></span>
* <span data-ttu-id="783ed-231">Pour plus d’informations sur la fonctionnalité de prise en charge de script PowerShell, consultez [Prise en charge de script PowerShell natif dans Azure Automation](https://azure.microsoft.com/blog/announcing-powershell-script-support-azure-automation-2/)</span><span class="sxs-lookup"><span data-stu-id="783ed-231">For more information on PowerShell script support feature, see [Native PowerShell script support in Azure Automation](https://azure.microsoft.com/blog/announcing-powershell-script-support-azure-automation-2/)</span></span>

