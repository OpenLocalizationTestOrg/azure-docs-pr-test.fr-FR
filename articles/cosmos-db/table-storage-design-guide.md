---
title: "Guide de conception de Table de stockage d’aaaAzure | Documents Microsoft"
description: "Concevoir des tables évolutives et performantes dans le stockage de tables Azure"
services: cosmos-db
documentationcenter: na
author: mimig1
manager: tadb
editor: tysonn
ms.assetid: 8e228b0c-2998-4462-8101-9f16517393ca
ms.service: cosmos-db
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: storage
ms.date: 02/28/2017
ms.author: mimig
ms.openlocfilehash: 059f05a1d20e4d9537034b7ca133c5334bbefa04
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="azure-storage-table-design-guide-designing-scalable-and-performant-tables"></a><span data-ttu-id="20a16-103">Guide de conception de table Azure Storage : conception de tables évolutives et performantes</span><span class="sxs-lookup"><span data-stu-id="20a16-103">Azure Storage Table Design Guide: Designing Scalable and Performant Tables</span></span>
[!INCLUDE [storage-table-cosmos-db-tip-include](../../includes/storage-table-cosmos-db-tip-include.md)]

<span data-ttu-id="20a16-104">toodesign évolutive et performantes tables, vous devez considérer plusieurs facteurs tels que les performances, d’évolutivité et de coût.</span><span class="sxs-lookup"><span data-stu-id="20a16-104">toodesign scalable and performant tables you must consider a number of factors such as performance, scalability, and cost.</span></span> <span data-ttu-id="20a16-105">Si vous avez précédemment conçu des schémas pour les bases de données relationnelles, ces considérations sera tooyou familier, mais s’il existe des similarités entre le modèle de stockage de service de Table Azure hello et des modèles relationnels, sont également nombreux important différences.</span><span class="sxs-lookup"><span data-stu-id="20a16-105">If you have previously designed schemas for relational databases, these considerations will be familiar tooyou, but while there are some similarities between hello Azure Table service storage model and relational models, there are also many important differences.</span></span> <span data-ttu-id="20a16-106">Ces différences conduisent généralement toovery différentes conceptions qui semblent toosomeone contre-intuitif ou de mauvaise familiariser avec les bases de données relationnelles, mais qui faites idée si vous concevez pour un magasin de clé/valeur NoSQL comme hello service Table Azure.</span><span class="sxs-lookup"><span data-stu-id="20a16-106">These differences typically lead toovery different designs that may look counter-intuitive or wrong toosomeone familiar with relational databases, but which do make good sense if you are designing for a NoSQL key/value store such as hello Azure Table service.</span></span> <span data-ttu-id="20a16-107">La plupart des différences de votre conception reflète hello fait que service de Table hello applications à l’échelle de cloud conçue toosupport qui peuvent contenir des milliards d’entités (lignes dans la terminologie de base de données relationnelle) de données ou pour les jeux de données qui doit prendre en charge très élevée volumes de transactions : par conséquent, vous devez toothink différemment sur la manière dont vous stockez vos données et comprendre le fonctionne de hello service de Table.</span><span class="sxs-lookup"><span data-stu-id="20a16-107">Many of your design differences will reflect hello fact that hello Table service is designed toosupport cloud-scale applications that can contain billions of entities (rows in relational database terminology) of data or for datasets that must support very high transaction volumes: therefore, you need toothink differently about how you store your data and understand how hello Table service works.</span></span> <span data-ttu-id="20a16-108">Un magasin de données NoSQL conçu peut activer tooscale de votre solution plus loin (et à moindre coût) à une solution qui utilise une base de données relationnelle.</span><span class="sxs-lookup"><span data-stu-id="20a16-108">A well designed NoSQL data store can enable your solution tooscale much further (and at a lower cost) than a solution that uses a relational database.</span></span> <span data-ttu-id="20a16-109">Ce guide fournit une aide relative à ces sujets.</span><span class="sxs-lookup"><span data-stu-id="20a16-109">This guide helps you with these topics.</span></span>  

## <a name="about-hello-azure-table-service"></a><span data-ttu-id="20a16-110">À propos de hello service Table Azure</span><span class="sxs-lookup"><span data-stu-id="20a16-110">About hello Azure Table service</span></span>
<span data-ttu-id="20a16-111">Cette section présente certaines des fonctionnalités clés hello du service de Table hello qui sont particulièrement pertinentes toodesigning des performances et évolutivité.</span><span class="sxs-lookup"><span data-stu-id="20a16-111">This section highlights some of hello key features of hello Table service that are especially relevant toodesigning for performance and scalability.</span></span> <span data-ttu-id="20a16-112">Si vous êtes tooAzure nouveau stockage et hello service de Table, lisez d’abord [Introduction tooMicrosoft Azure Storage](../storage/common/storage-introduction.md) et [prise en main Azure Table Storage à l’aide de .NET](table-storage-how-to-use-dotnet.md) avant de lire le reste de hello de article.</span><span class="sxs-lookup"><span data-stu-id="20a16-112">If you are new tooAzure Storage and hello Table service, first read [Introduction tooMicrosoft Azure Storage](../storage/common/storage-introduction.md) and [Get started with Azure Table Storage using .NET](table-storage-how-to-use-dotnet.md) before reading hello remainder of this article.</span></span> <span data-ttu-id="20a16-113">Bien que hello de ce guide porte sur hello service de Table, elle inclut une discussion de hello file d’attente Azure et les services Blob, et comment vous pouvez les utiliser en même temps que le service de Table dans une solution de hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-113">Although hello focus of this guide is on hello Table service, it will include some discussion of hello Azure Queue and Blob services, and how you might use them along with hello Table service in a solution.</span></span>  

<span data-ttu-id="20a16-114">Qu’est le service de Table hello ?</span><span class="sxs-lookup"><span data-stu-id="20a16-114">What is hello Table service?</span></span> <span data-ttu-id="20a16-115">Comme vous pouvez vous attendre à partir du nom de hello, hello service de Table utilise un toostore de données sous forme de tableau.</span><span class="sxs-lookup"><span data-stu-id="20a16-115">As you might expect from hello name, hello Table service uses a tabular format toostore data.</span></span> <span data-ttu-id="20a16-116">Dans la terminologie hello, chaque ligne de table de hello représente une entité et magasin de colonnes hello hello diverses propriétés de cette entité.</span><span class="sxs-lookup"><span data-stu-id="20a16-116">In hello standard terminology, each row of hello table represents an entity, and hello columns store hello various properties of that entity.</span></span> <span data-ttu-id="20a16-117">Chaque entité a une paire de clés toouniquely identifier, et une colonne timestamp que hello service de Table utilise tootrack lors de la mise à jour d’entité de hello (cela se produit automatiquement et vous ne peut pas remplacer manuellement de hello timestamp avec une valeur arbitraire).</span><span class="sxs-lookup"><span data-stu-id="20a16-117">Every entity has a pair of keys toouniquely identify it, and a timestamp column that hello Table service uses tootrack when hello entity was last updated (this happens automatically and you cannot manually overwrite hello timestamp with an arbitrary value).</span></span> <span data-ttu-id="20a16-118">Hello service de Table utilise cet horodatage de dernière modification (LMT) toomanage l’accès concurrentiel optimiste.</span><span class="sxs-lookup"><span data-stu-id="20a16-118">hello Table service uses this last-modified timestamp (LMT) toomanage optimistic concurrency.</span></span>  

> [!NOTE]
> <span data-ttu-id="20a16-119">opérations d’API REST service Hello Table retournent également un **ETag** valeur dérive d’horodatage de dernière modification de hello (LMT).</span><span class="sxs-lookup"><span data-stu-id="20a16-119">hello Table service REST API operations also return an **ETag** value that it derives from hello last-modified timestamp (LMT).</span></span> <span data-ttu-id="20a16-120">Dans ce document, nous allons utiliser hello conditions ETag et LMT indifféremment car ils font référence toohello même les données sous-jacentes.</span><span class="sxs-lookup"><span data-stu-id="20a16-120">In this document we will use hello terms ETag and LMT interchangeably because they refer toohello same underlying data.</span></span>  
> 
> 

<span data-ttu-id="20a16-121">Hello suivant montre un toostore de conception de table simple entités employee et department.</span><span class="sxs-lookup"><span data-stu-id="20a16-121">hello following example shows a simple table design toostore employee and department entities.</span></span> <span data-ttu-id="20a16-122">La plupart des exemples hello figurant plus loin dans ce guide sont basées sur cette conception simple.</span><span class="sxs-lookup"><span data-stu-id="20a16-122">Many of hello examples shown later in this guide are based on this simple design.</span></span>  

<table>
<tr>
<th><span data-ttu-id="20a16-123">PartitionKey</span><span class="sxs-lookup"><span data-stu-id="20a16-123">PartitionKey</span></span></th>
<th><span data-ttu-id="20a16-124">RowKey</span><span class="sxs-lookup"><span data-stu-id="20a16-124">RowKey</span></span></th>
<th><span data-ttu-id="20a16-125">Timestamp</span><span class="sxs-lookup"><span data-stu-id="20a16-125">Timestamp</span></span></th>
<th></th>
</tr>
<tr>
<td><span data-ttu-id="20a16-126">Marketing</span><span class="sxs-lookup"><span data-stu-id="20a16-126">Marketing</span></span></td>
<td><span data-ttu-id="20a16-127">00001</span><span class="sxs-lookup"><span data-stu-id="20a16-127">00001</span></span></td>
<td><span data-ttu-id="20a16-128">2014-08-22T00:50:32Z</span><span class="sxs-lookup"><span data-stu-id="20a16-128">2014-08-22T00:50:32Z</span></span></td>
<td>
<table>
<tr>
<th><span data-ttu-id="20a16-129">FirstName</span><span class="sxs-lookup"><span data-stu-id="20a16-129">FirstName</span></span></th>
<th><span data-ttu-id="20a16-130">LastName</span><span class="sxs-lookup"><span data-stu-id="20a16-130">LastName</span></span></th>
<th><span data-ttu-id="20a16-131">Age</span><span class="sxs-lookup"><span data-stu-id="20a16-131">Age</span></span></th>
<th><span data-ttu-id="20a16-132">Email</span><span class="sxs-lookup"><span data-stu-id="20a16-132">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="20a16-133">Don</span><span class="sxs-lookup"><span data-stu-id="20a16-133">Don</span></span></td>
<td><span data-ttu-id="20a16-134">Hall</span><span class="sxs-lookup"><span data-stu-id="20a16-134">Hall</span></span></td>
<td><span data-ttu-id="20a16-135">34</span><span class="sxs-lookup"><span data-stu-id="20a16-135">34</span></span></td>
<td>donh@contoso.com</td>
</tr>
</table>
</tr>
<tr>
<td><span data-ttu-id="20a16-136">Marketing</span><span class="sxs-lookup"><span data-stu-id="20a16-136">Marketing</span></span></td>
<td><span data-ttu-id="20a16-137">00002</span><span class="sxs-lookup"><span data-stu-id="20a16-137">00002</span></span></td>
<td><span data-ttu-id="20a16-138">2014-08-22T00:50:34Z</span><span class="sxs-lookup"><span data-stu-id="20a16-138">2014-08-22T00:50:34Z</span></span></td>
<td>
<table>
<tr>
<th><span data-ttu-id="20a16-139">FirstName</span><span class="sxs-lookup"><span data-stu-id="20a16-139">FirstName</span></span></th>
<th><span data-ttu-id="20a16-140">LastName</span><span class="sxs-lookup"><span data-stu-id="20a16-140">LastName</span></span></th>
<th><span data-ttu-id="20a16-141">Age</span><span class="sxs-lookup"><span data-stu-id="20a16-141">Age</span></span></th>
<th><span data-ttu-id="20a16-142">Email</span><span class="sxs-lookup"><span data-stu-id="20a16-142">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="20a16-143">Jun</span><span class="sxs-lookup"><span data-stu-id="20a16-143">Jun</span></span></td>
<td><span data-ttu-id="20a16-144">Cao</span><span class="sxs-lookup"><span data-stu-id="20a16-144">Cao</span></span></td>
<td><span data-ttu-id="20a16-145">47</span><span class="sxs-lookup"><span data-stu-id="20a16-145">47</span></span></td>
<td>junc@contoso.com</td>
</tr>
</table>
</tr>
<tr>
<td><span data-ttu-id="20a16-146">Marketing</span><span class="sxs-lookup"><span data-stu-id="20a16-146">Marketing</span></span></td>
<td><span data-ttu-id="20a16-147">Département</span><span class="sxs-lookup"><span data-stu-id="20a16-147">Department</span></span></td>
<td><span data-ttu-id="20a16-148">2014-08-22T00:50:30Z</span><span class="sxs-lookup"><span data-stu-id="20a16-148">2014-08-22T00:50:30Z</span></span></td>
<td>
<table>
<tr>
<th><span data-ttu-id="20a16-149">DepartmentName</span><span class="sxs-lookup"><span data-stu-id="20a16-149">DepartmentName</span></span></th>
<th><span data-ttu-id="20a16-150">EmployeeCount</span><span class="sxs-lookup"><span data-stu-id="20a16-150">EmployeeCount</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="20a16-151">Marketing</span><span class="sxs-lookup"><span data-stu-id="20a16-151">Marketing</span></span></td>
<td><span data-ttu-id="20a16-152">153</span><span class="sxs-lookup"><span data-stu-id="20a16-152">153</span></span></td>
</tr>
</table>
</td>
</tr>
<tr>
<td><span data-ttu-id="20a16-153">Sales</span><span class="sxs-lookup"><span data-stu-id="20a16-153">Sales</span></span></td>
<td><span data-ttu-id="20a16-154">00010</span><span class="sxs-lookup"><span data-stu-id="20a16-154">00010</span></span></td>
<td><span data-ttu-id="20a16-155">2014-08-22T00:50:44Z</span><span class="sxs-lookup"><span data-stu-id="20a16-155">2014-08-22T00:50:44Z</span></span></td>
<td>
<table>
<tr>
<th><span data-ttu-id="20a16-156">FirstName</span><span class="sxs-lookup"><span data-stu-id="20a16-156">FirstName</span></span></th>
<th><span data-ttu-id="20a16-157">LastName</span><span class="sxs-lookup"><span data-stu-id="20a16-157">LastName</span></span></th>
<th><span data-ttu-id="20a16-158">Age</span><span class="sxs-lookup"><span data-stu-id="20a16-158">Age</span></span></th>
<th><span data-ttu-id="20a16-159">Email</span><span class="sxs-lookup"><span data-stu-id="20a16-159">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="20a16-160">Ken</span><span class="sxs-lookup"><span data-stu-id="20a16-160">Ken</span></span></td>
<td><span data-ttu-id="20a16-161">Kwok</span><span class="sxs-lookup"><span data-stu-id="20a16-161">Kwok</span></span></td>
<td><span data-ttu-id="20a16-162">23</span><span class="sxs-lookup"><span data-stu-id="20a16-162">23</span></span></td>
<td>kenk@contoso.com</td>
</tr>
</table>
</td>
</tr>
</table>


<span data-ttu-id="20a16-163">Jusqu'à présent, cela ressemble très similaire tooa table dans une base de données relationnelle avec les différences clés hello en cours hello colonnes obligatoires, et hello capacité toostore plusieurs types d’entités Bonjour même table.</span><span class="sxs-lookup"><span data-stu-id="20a16-163">So far, this looks very similar tooa table in a relational database with hello key differences being hello mandatory columns, and hello ability toostore multiple entity types in hello same table.</span></span> <span data-ttu-id="20a16-164">En outre, chacun des hello propriétés définies par l’utilisateur comme **FirstName** ou **âge** a un type de données, comme integer ou string, simplement comme une colonne dans une base de données relationnelle.</span><span class="sxs-lookup"><span data-stu-id="20a16-164">In addition, each of hello user-defined properties such as **FirstName** or **Age** has a data type, such as integer or string, just like a column in a relational database.</span></span> <span data-ttu-id="20a16-165">Bien que, contrairement à une base de données relationnelle, nature de sans schéma hello Hello moyens de service de Table qui a une propriété n’a pas besoin hello même type de données sur chaque entité.</span><span class="sxs-lookup"><span data-stu-id="20a16-165">Although unlike in a relational database, hello schema-less nature of hello Table service means that a property need not have hello same data type on each entity.</span></span> <span data-ttu-id="20a16-166">toostore des types de données complexes dans une seule propriété, vous devez utiliser un format sérialisé comme JSON ou XML.</span><span class="sxs-lookup"><span data-stu-id="20a16-166">toostore complex data types in a single property, you must use a serialized format such as JSON or XML.</span></span> <span data-ttu-id="20a16-167">Pour plus d’informations sur les types de données de service telles que la prise en charge de table hello, les plages de dates prise en charge, les règles d’affectation de noms et contraintes de taille, consultez [hello de présentation des modèle de données de Service de Table](http://msdn.microsoft.com/library/azure/dd179338.aspx).</span><span class="sxs-lookup"><span data-stu-id="20a16-167">For more information about hello table service such as supported data types, supported date ranges, naming rules, and size constraints, see [Understanding hello Table Service Data Model](http://msdn.microsoft.com/library/azure/dd179338.aspx).</span></span>

<span data-ttu-id="20a16-168">Comme vous le verrez, votre choix de **PartitionKey** et **RowKey** est la conception de la table toogood fondamentaux.</span><span class="sxs-lookup"><span data-stu-id="20a16-168">As you will see, your choice of **PartitionKey** and **RowKey** is fundamental toogood table design.</span></span> <span data-ttu-id="20a16-169">Toutes les entités stockées dans une table doivent avoir une combinaison unique de **PartitionKey** et **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="20a16-169">Every entity stored in a table must have a unique combination of **PartitionKey** and **RowKey**.</span></span> <span data-ttu-id="20a16-170">Comme avec les clés dans une table de base de données relationnelle, hello **PartitionKey** et **RowKey** les valeurs sont indexée toocreate un index cluster qui permet la recherche rapide ; Toutefois, hello service de Table ne crée aucun les index secondaires afin qu’ils soient hello que deux des propriétés indexées (certains schémas hello décrites plus loin montrent comment vous pouvez contourner cette limitation apparente).</span><span class="sxs-lookup"><span data-stu-id="20a16-170">As with keys in a relational database table, hello **PartitionKey** and **RowKey** values are indexed toocreate a clustered index that enables fast look-ups; however, hello Table service does not create any secondary indexes so these are hello only two indexed properties (some of hello patterns described later show how you can work around this apparent limitation).</span></span>  

<span data-ttu-id="20a16-171">Un tableau est constitué d’une ou plusieurs partitions, et comme vous le verrez, nombreux hello vous apportez va être autour adaptée des décisions de conception **PartitionKey** et **RowKey** toooptimize votre solution.</span><span class="sxs-lookup"><span data-stu-id="20a16-171">A table is made up of one or more partitions, and as you will see, many of hello design decisions you make will be around choosing a suitable **PartitionKey** and **RowKey** toooptimize your solution.</span></span> <span data-ttu-id="20a16-172">En guise de solution, vous pouvez utiliser une seule table contenant toutes vos entités organisées en partitions, mais généralement, une solution possède plusieurs tables.</span><span class="sxs-lookup"><span data-stu-id="20a16-172">A solution could consist of just a single table that contains all your entities organized into partitions, but typically a solution will have multiple tables.</span></span> <span data-ttu-id="20a16-173">Tables vous aident à toologically organiser vos entités, vous aident à gérer l’accès à des données toohello à l’aide des listes de contrôle d’accès, et vous pouvez supprimer une table entière à l’aide d’une opération de stockage unique.</span><span class="sxs-lookup"><span data-stu-id="20a16-173">Tables help you toologically organize your entities, help you manage access toohello data using access control lists, and you can drop an entire table using a single storage operation.</span></span>  

### <a name="table-partitions"></a><span data-ttu-id="20a16-174">Partitions de table</span><span class="sxs-lookup"><span data-stu-id="20a16-174">Table partitions</span></span>
<span data-ttu-id="20a16-175">nom du compte Hello, nom de la table et **PartitionKey** ensemble identifier partition hello au sein du service de stockage hello où le service de table hello stocke les entités hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-175">hello account name, table name and **PartitionKey** together identify hello partition within hello storage service where hello table service stores hello entity.</span></span> <span data-ttu-id="20a16-176">Ainsi que faisant partie du modèle pour les entités d’adressage de hello, partitions de définissent une étendue pour les transactions (consultez [Transactions de groupe d’entités](#entity-group-transactions) ci-dessous) et écran hello de comment le service de table hello évolue.</span><span class="sxs-lookup"><span data-stu-id="20a16-176">As well as being part of hello addressing scheme for entities, partitions define a scope for transactions (see [Entity Group Transactions](#entity-group-transactions) below), and form hello basis of how hello table service scales.</span></span> <span data-ttu-id="20a16-177">Pour plus d’informations sur les partitions, consultez [Objectifs d’évolutivité et de performances d’Azure Storage](../storage/common/storage-scalability-targets.md).</span><span class="sxs-lookup"><span data-stu-id="20a16-177">For more information on partitions see [Azure Storage Scalability and Performance Targets](../storage/common/storage-scalability-targets.md).</span></span>  

<span data-ttu-id="20a16-178">Bonjour service de Table, un nœud individuel services ou plus effectuer des partitions et hello service échelles dynamiquement à l’équilibrage de charge des partitions sur les nœuds.</span><span class="sxs-lookup"><span data-stu-id="20a16-178">In hello Table service, an individual node services one or more complete partitions and hello service scales by dynamically load-balancing partitions across nodes.</span></span> <span data-ttu-id="20a16-179">Si un nœud est sous charge, le service de table hello peut *fractionner* plage hello de partitions traitées par ce nœud sur différents nœuds ; lors de la réduction du trafic, le service de hello peut *fusion* allant de la partition de hello nœuds silencieux sur un seul nœud.</span><span class="sxs-lookup"><span data-stu-id="20a16-179">If a node is under load, hello table service can *split* hello range of partitions serviced by that node onto different nodes; when traffic subsides, hello service can *merge* hello partition ranges from quiet nodes back onto a single node.</span></span>  

<span data-ttu-id="20a16-180">Pour plus d’informations sur hello détails internes de hello service de Table et notamment comment le service de hello gère les partitions, consultez les livre hello [Microsoft Azure Storage : A hautement disponible Service de stockage Cloud à forte cohérence](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/11/20/windows-azure-storage-a-highly-available-cloud-storage-service-with-strong-consistency.aspx).</span><span class="sxs-lookup"><span data-stu-id="20a16-180">For more information about hello internal details of hello Table service, and in particular how hello service manages partitions, see hello paper [Microsoft Azure Storage: A Highly Available Cloud Storage Service with Strong Consistency](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/11/20/windows-azure-storage-a-highly-available-cloud-storage-service-with-strong-consistency.aspx).</span></span>  

### <a name="entity-group-transactions"></a><span data-ttu-id="20a16-181">Transactions de groupe d’entités</span><span class="sxs-lookup"><span data-stu-id="20a16-181">Entity Group Transactions</span></span>
<span data-ttu-id="20a16-182">Bonjour service de Table, Transactions de groupe d’entités (EGTs) sont mécanisme intégré uniquement de hello pour effectuer des mises à jour atomiques entre plusieurs entités.</span><span class="sxs-lookup"><span data-stu-id="20a16-182">In hello Table service, Entity Group Transactions (EGTs) are hello only built-in mechanism for performing atomic updates across multiple entities.</span></span> <span data-ttu-id="20a16-183">EGTs sont également référencé tooas *par lots de transactions* dans certains documents.</span><span class="sxs-lookup"><span data-stu-id="20a16-183">EGTs are also referred tooas *batch transactions* in some documentation.</span></span> <span data-ttu-id="20a16-184">EGTs peut uniquement fonctionner sur des entités stockées dans hello même partition (partage hello même clé de partition dans une table donnée), de sorte que chaque fois que vous devez le comportement transactionnel atomique entre plusieurs entités vous devez tooensure ces entités sont Bonjour même partition.</span><span class="sxs-lookup"><span data-stu-id="20a16-184">EGTs can only operate on entities stored in hello same partition (share hello same partition key in a given table), so anytime you need atomic transactional behavior across multiple entities you need tooensure that those entities are in hello same partition.</span></span> <span data-ttu-id="20a16-185">Il s’agit souvent une raison de conserver plusieurs types d’entités Bonjour même table (et de partition) et non à l’aide de plusieurs tables pour les différents types d’entité.</span><span class="sxs-lookup"><span data-stu-id="20a16-185">This is often a reason for keeping multiple entity types in hello same table (and partition) and not using multiple tables for different entity types.</span></span> <span data-ttu-id="20a16-186">Une seule EGT peut traiter jusqu'à 100 entités.</span><span class="sxs-lookup"><span data-stu-id="20a16-186">A single EGT can operate on at most 100 entities.</span></span>  <span data-ttu-id="20a16-187">Si vous envoyez plusieurs EGTs simultanées pour son traitement est important tooensure ces EGTs ne fonctionnent pas sur les entités qui sont communes à EGTs comme dans le cas contraire le traitement peut être différé.</span><span class="sxs-lookup"><span data-stu-id="20a16-187">If you submit multiple concurrent EGTs for processing it is important tooensure  those EGTs do not operate on entities that are common across EGTs as otherwise processing can be delayed.</span></span>

<span data-ttu-id="20a16-188">EGTs présentent également un compromis potentiel pour vous tooevaluate dans votre conception : l’utilisation de plusieurs partitions augmente l’évolutivité de hello de votre application, car Azure dispose de davantage d’occasions de requêtes sur les nœuds d’équilibrage de charge, mais cela peut limiter hello capacité de votre application tooperform atomique des transactions et maintenir la cohérence forte pour vos données.</span><span class="sxs-lookup"><span data-stu-id="20a16-188">EGTs also introduce a potential trade-off for you tooevaluate in your design: using more partitions will increase hello scalability of your application because Azure has more opportunities for load balancing requests across nodes, but this might limit hello ability of your application tooperform atomic transactions and maintain strong consistency for your data.</span></span> <span data-ttu-id="20a16-189">En outre, il existe des objectifs d’évolutivité spécifique au niveau de hello d’une partition qui peut limiter le débit des transactions, vous pouvez vous attendre pour un seul nœud hello : pour plus d’informations sur les objectifs d’évolutivité hello pour les comptes de stockage Azure et de la table de hello service, consultez [évolutivité du stockage Azure et les objectifs de performances](../storage/common/storage-scalability-targets.md).</span><span class="sxs-lookup"><span data-stu-id="20a16-189">Furthermore, there are specific scalability targets at hello level of a partition that might limit hello throughput of transactions you can expect for a single node: for more information about hello scalability targets for Azure storage accounts and hello table service, see [Azure Storage Scalability and Performance Targets](../storage/common/storage-scalability-targets.md).</span></span> <span data-ttu-id="20a16-190">Discutez des différentes sections ultérieures de ce guide de conception des stratégies qui vous aident à gérer les compromis de telles que celle-ci et discutez de la meilleure façon toochoose votre clé de partition basés sur les conditions spécifiques de hello de votre application cliente.</span><span class="sxs-lookup"><span data-stu-id="20a16-190">Later sections of this guide discuss various design strategies that help you manage trade-offs such as this one, and discuss how best toochoose your partition key based on hello specific requirements of your client application.</span></span>  

### <a name="capacity-considerations"></a><span data-ttu-id="20a16-191">Considérations relatives à la capacité</span><span class="sxs-lookup"><span data-stu-id="20a16-191">Capacity considerations</span></span>
<span data-ttu-id="20a16-192">Hello tableau suivant récapitule certaines des toobe de valeurs de clé hello connaître lorsque vous concevez une solution de service de Table :</span><span class="sxs-lookup"><span data-stu-id="20a16-192">hello following table includes some of hello key values toobe aware of when you are designing a Table service solution:</span></span>  

| <span data-ttu-id="20a16-193">Capacité totale d'un compte de stockage Azure</span><span class="sxs-lookup"><span data-stu-id="20a16-193">Total capacity of an Azure storage account</span></span> | <span data-ttu-id="20a16-194">500 To</span><span class="sxs-lookup"><span data-stu-id="20a16-194">500 TB</span></span> |
| --- | --- |
| <span data-ttu-id="20a16-195">Nombre de tables dans un compte de stockage Azure</span><span class="sxs-lookup"><span data-stu-id="20a16-195">Number of tables in an Azure storage account</span></span> |<span data-ttu-id="20a16-196">Limité uniquement par la capacité de hello hello du compte de stockage</span><span class="sxs-lookup"><span data-stu-id="20a16-196">Limited only by hello capacity of hello storage account</span></span> |
| <span data-ttu-id="20a16-197">Nombre de partitions dans une table</span><span class="sxs-lookup"><span data-stu-id="20a16-197">Number of partitions in a table</span></span> |<span data-ttu-id="20a16-198">Limité uniquement par la capacité de hello hello du compte de stockage</span><span class="sxs-lookup"><span data-stu-id="20a16-198">Limited only by hello capacity of hello storage account</span></span> |
| <span data-ttu-id="20a16-199">Nombre d'entités dans une partition</span><span class="sxs-lookup"><span data-stu-id="20a16-199">Number of entities in a partition</span></span> |<span data-ttu-id="20a16-200">Limité uniquement par la capacité de hello hello du compte de stockage</span><span class="sxs-lookup"><span data-stu-id="20a16-200">Limited only by hello capacity of hello storage account</span></span> |
| <span data-ttu-id="20a16-201">Taille d'une entité individuelle</span><span class="sxs-lookup"><span data-stu-id="20a16-201">Size of an individual entity</span></span> |<span data-ttu-id="20a16-202">Configurer Mo too1 avec un maximum de 255 propriétés (y compris hello **PartitionKey**, **RowKey**, et **Timestamp**)</span><span class="sxs-lookup"><span data-stu-id="20a16-202">Up too1 MB with a maximum of 255 properties (including hello **PartitionKey**, **RowKey**, and **Timestamp**)</span></span> |
| <span data-ttu-id="20a16-203">Taille de hello **PartitionKey**</span><span class="sxs-lookup"><span data-stu-id="20a16-203">Size of hello **PartitionKey**</span></span> |<span data-ttu-id="20a16-204">Une chaîne de taille too1 Ko</span><span class="sxs-lookup"><span data-stu-id="20a16-204">A string up too1 KB in size</span></span> |
| <span data-ttu-id="20a16-205">Taille de hello **RowKey**</span><span class="sxs-lookup"><span data-stu-id="20a16-205">Size of hello **RowKey**</span></span> |<span data-ttu-id="20a16-206">Une chaîne de taille too1 Ko</span><span class="sxs-lookup"><span data-stu-id="20a16-206">A string up too1 KB in size</span></span> |
| <span data-ttu-id="20a16-207">Taille d'une transaction ETG</span><span class="sxs-lookup"><span data-stu-id="20a16-207">Size of an Entity Group Transaction</span></span> |<span data-ttu-id="20a16-208">Une transaction peut inclure au plus 100 entités et la charge utile de hello doit être inférieure à 4 Mo.</span><span class="sxs-lookup"><span data-stu-id="20a16-208">A transaction can include at most 100 entities and hello payload must be less than 4 MB in size.</span></span> <span data-ttu-id="20a16-209">Une transaction EGT ne peut mettre à jour une entité qu'une seule fois.</span><span class="sxs-lookup"><span data-stu-id="20a16-209">An EGT can only update an entity once.</span></span> |

<span data-ttu-id="20a16-210">Pour plus d’informations, consultez [hello de présentation des modèle de données de Service de Table](http://msdn.microsoft.com/library/azure/dd179338.aspx).</span><span class="sxs-lookup"><span data-stu-id="20a16-210">For more information, see [Understanding hello Table Service Data Model](http://msdn.microsoft.com/library/azure/dd179338.aspx).</span></span>  

### <a name="cost-considerations"></a><span data-ttu-id="20a16-211">Considérations relatives au coût</span><span class="sxs-lookup"><span data-stu-id="20a16-211">Cost considerations</span></span>
<span data-ttu-id="20a16-212">Stockage de table est relativement peu coûteux, mais vous devez inclure les estimations de coût pour les deux quantité capacité hello et l’utilisation de transactions dans le cadre de votre version d’évaluation d’une solution qui utilise le service de Table hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-212">Table storage is relatively inexpensive, but you should include cost estimates for both capacity usage and hello quantity of transactions as part of your evaluation of any solution that uses hello Table service.</span></span> <span data-ttu-id="20a16-213">Toutefois, dans de nombreux scénarios, le stockage des données dénormalisées ou en double dans hello tooimprove de commande performance ou l’évolutivité de votre solution est un tootake approche valide.</span><span class="sxs-lookup"><span data-stu-id="20a16-213">However, in many scenarios storing denormalized or duplicate data in order tooimprove hello performance or scalability of your solution is a valid approach tootake.</span></span> <span data-ttu-id="20a16-214">Pour plus d’informations sur la tarification, consultez la page [Tarification Azure Storage](https://azure.microsoft.com/pricing/details/storage/).</span><span class="sxs-lookup"><span data-stu-id="20a16-214">For more information about pricing, see [Azure Storage Pricing](https://azure.microsoft.com/pricing/details/storage/).</span></span>  

## <a name="guidelines-for-table-design"></a><span data-ttu-id="20a16-215">Conseils pour la conception de table</span><span class="sxs-lookup"><span data-stu-id="20a16-215">Guidelines for table design</span></span>
<span data-ttu-id="20a16-216">Ces listes résument certaines des recommandations principales de hello que vous gardez à l’esprit lorsque vous concevez vos tables, de ce guide puisse les traiter dans plus en détail plus loin dans.</span><span class="sxs-lookup"><span data-stu-id="20a16-216">These lists summarize some of hello key guidelines you should keep in mind when you are designing your tables, and this guide will address them all in more detail later in.</span></span> <span data-ttu-id="20a16-217">Ces instructions sont très différentes de recommandations hello que vous devrez généralement effectuer pour la conception de base de données relationnelle.</span><span class="sxs-lookup"><span data-stu-id="20a16-217">These guidelines are very different from hello guidelines you would typically follow for relational database design.</span></span>  

<span data-ttu-id="20a16-218">Conception de votre toobe de solution de service de Table *lire* efficace :</span><span class="sxs-lookup"><span data-stu-id="20a16-218">Designing your Table service solution toobe *read* efficient:</span></span>

* <span data-ttu-id="20a16-219">***Pensez votre conception pour l’interrogation dans des applications à lecture intensive.***</span><span class="sxs-lookup"><span data-stu-id="20a16-219">***Design for querying in read-heavy applications.***</span></span> <span data-ttu-id="20a16-220">Lorsque vous concevez vos tables, pensez aux requêtes hello (surtout latence de hello ceux qui sont sensibles) que vous allez exécuter avant de définir comment mettre à jour vos entités.</span><span class="sxs-lookup"><span data-stu-id="20a16-220">When you are designing your tables, think about hello queries (especially hello latency sensitive ones) that you will execute before you think about how you will update your entities.</span></span> <span data-ttu-id="20a16-221">Cela permet généralement d’élaborer une solution efficace et performante.</span><span class="sxs-lookup"><span data-stu-id="20a16-221">This typically results in an efficient and performant solution.</span></span>  
* <span data-ttu-id="20a16-222">***Spécifiez les valeurs de PartitionKey et de RowKey dans vos requêtes.***</span><span class="sxs-lookup"><span data-stu-id="20a16-222">***Specify both PartitionKey and RowKey in your queries.***</span></span> <span data-ttu-id="20a16-223">*Point de requêtes* tel qu’il s’agit des requêtes de service de table hello plus efficaces.</span><span class="sxs-lookup"><span data-stu-id="20a16-223">*Point queries* such as these are hello most efficient table service queries.</span></span>  
* <span data-ttu-id="20a16-224">***Envisagez de stocker des copies dupliquées des entités.***</span><span class="sxs-lookup"><span data-stu-id="20a16-224">***Consider storing duplicate copies of entities.***</span></span> <span data-ttu-id="20a16-225">Stockage de table est bon marché vous devez donc le stockage hello même entité plusieurs fois (avec des clés différentes) tooenable des requêtes plus efficaces.</span><span class="sxs-lookup"><span data-stu-id="20a16-225">Table storage is cheap so consider storing hello same entity multiple times (with different keys) tooenable more efficient queries.</span></span>  
* <span data-ttu-id="20a16-226">***Envisagez de dénormaliser vos données.***</span><span class="sxs-lookup"><span data-stu-id="20a16-226">***Consider denormalizing your data.***</span></span> <span data-ttu-id="20a16-227">Le stockage de tables est bon marché. Nous vous recommandons donc d’envisager la dénormalisation de vos données.</span><span class="sxs-lookup"><span data-stu-id="20a16-227">Table storage is cheap so consider denormalizing your data.</span></span> <span data-ttu-id="20a16-228">Par exemple, stocker les entités résumées afin que les requêtes pour les données d’agrégation doivent uniquement tooaccess une seule entité.</span><span class="sxs-lookup"><span data-stu-id="20a16-228">For example, store summary entities so that queries for aggregate data only need tooaccess a single entity.</span></span>  
* <span data-ttu-id="20a16-229">***Utilisez des valeurs de clé composées.***</span><span class="sxs-lookup"><span data-stu-id="20a16-229">***Use compound key values.***</span></span> <span data-ttu-id="20a16-230">Hello uniquement les clés que vous avez sont **PartitionKey** et **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="20a16-230">hello only keys you have are **PartitionKey** and **RowKey**.</span></span> <span data-ttu-id="20a16-231">Par exemple, utilisez tooentities de chemins d’accès composés de valeurs de clé tooenable autre accès à clé.</span><span class="sxs-lookup"><span data-stu-id="20a16-231">For example, use compound key values tooenable alternate keyed access paths tooentities.</span></span>  
* <span data-ttu-id="20a16-232">***Utilisez la projection de requête.***</span><span class="sxs-lookup"><span data-stu-id="20a16-232">***Use query projection.***</span></span> <span data-ttu-id="20a16-233">Vous pouvez réduire la quantité hello de données que vous transférez réseau hello à l’aide de requêtes qui sélectionnent uniquement les champs hello que nécessaires.</span><span class="sxs-lookup"><span data-stu-id="20a16-233">You can reduce hello amount of data that you transfer over hello network by using queries that select just hello fields you need.</span></span>  

<span data-ttu-id="20a16-234">Conception de votre toobe de solution de service de Table *écrire* efficace :</span><span class="sxs-lookup"><span data-stu-id="20a16-234">Designing your Table service solution toobe *write* efficient:</span></span>  

* <span data-ttu-id="20a16-235">***Ne créez pas de partitions à chaud.***</span><span class="sxs-lookup"><span data-stu-id="20a16-235">***Do not create hot partitions.***</span></span> <span data-ttu-id="20a16-236">Choisissez les touches qui vous permettent de toospread vos demandes sur plusieurs partitions à tout moment.</span><span class="sxs-lookup"><span data-stu-id="20a16-236">Choose keys that enable you toospread your requests across multiple partitions at any point of time.</span></span>  
* <span data-ttu-id="20a16-237">***Évitez les pics de trafic.***</span><span class="sxs-lookup"><span data-stu-id="20a16-237">***Avoid spikes in traffic.***</span></span> <span data-ttu-id="20a16-238">Le trafic de hello lever un délai raisonnable et éviter des pics de trafic.</span><span class="sxs-lookup"><span data-stu-id="20a16-238">Smooth hello traffic over a reasonable period of time and avoid spikes in traffic.</span></span>
* <span data-ttu-id="20a16-239">***Ne créez pas nécessairement une table distincte pour chaque type d’entité.***</span><span class="sxs-lookup"><span data-stu-id="20a16-239">***Don't necessarily create a separate table for each type of entity.***</span></span> <span data-ttu-id="20a16-240">Lorsque vous avez besoin des transactions atomiques sur les types d’entité, vous pouvez stocker ces plusieurs types d’entités dans hello même partition Bonjour même table.</span><span class="sxs-lookup"><span data-stu-id="20a16-240">When you require atomic transactions across entity types, you can store these multiple entity types in hello same partition in hello same table.</span></span>
* <span data-ttu-id="20a16-241">***Considérez que vous devez obtenir un débit maximal hello.***</span><span class="sxs-lookup"><span data-stu-id="20a16-241">***Consider hello maximum throughput you must achieve.***</span></span> <span data-ttu-id="20a16-242">Vous devez être conscient des objectifs d’évolutivité hello pour hello service de Table et vous assurer que votre conception n’entraîne pas vous tooexceed les.</span><span class="sxs-lookup"><span data-stu-id="20a16-242">You must be aware of hello scalability targets for hello Table service and ensure that your design will not cause you tooexceed them.</span></span>  

<span data-ttu-id="20a16-243">En lisant ce guide, vous rencontrerez des exemples mettant ces principes en pratique.</span><span class="sxs-lookup"><span data-stu-id="20a16-243">As you read this guide, you will see examples that put all of these principles into practice.</span></span>  

## <a name="design-for-querying"></a><span data-ttu-id="20a16-244">Conception pour l'interrogation</span><span class="sxs-lookup"><span data-stu-id="20a16-244">Design for querying</span></span>
<span data-ttu-id="20a16-245">Les solutions de service de table peuvent être lus beaucoup, beaucoup d’écriture ou une combinaison de hello deux.</span><span class="sxs-lookup"><span data-stu-id="20a16-245">Table service solutions may be read intensive, write intensive, or a mix of hello two.</span></span> <span data-ttu-id="20a16-246">Cette section se concentre sur toobear de choses hello à l’esprit lorsque vous concevez votre toosupport du service de Table efficacement des opérations de lecture.</span><span class="sxs-lookup"><span data-stu-id="20a16-246">This section focuses on hello things toobear in mind when you are designing your Table service toosupport read operations efficiently.</span></span> <span data-ttu-id="20a16-247">En règle générale, une conception qui prend en charge les opérations de lecture de manière efficace le sera également pour des opérations d'écriture.</span><span class="sxs-lookup"><span data-stu-id="20a16-247">Typically, a design that supports read operations efficiently is also efficient for write operations.</span></span> <span data-ttu-id="20a16-248">Toutefois, il existe des considérations supplémentaires toobear à l’esprit lors de la conception toosupport opérations d’écriture, décrites dans la section suivante de hello, [conception pour la modification de données](#design-for-data-modification).</span><span class="sxs-lookup"><span data-stu-id="20a16-248">However, there are additional considerations toobear in mind when designing toosupport write operations, discussed in hello next section, [Design for data modification](#design-for-data-modification).</span></span>

<span data-ttu-id="20a16-249">Un bon point de départ pour concevoir votre tooenable de solution de service de Table vous tooread des données efficacement sont tooask « les requêtes seront mes données hello application besoin tooexecute tooretrieve dont il a besoin de hello service de Table ? »</span><span class="sxs-lookup"><span data-stu-id="20a16-249">A good starting point for designing your Table service solution tooenable you tooread data efficiently is tooask "What queries will my application need tooexecute tooretrieve hello data it needs from hello Table service?"</span></span>  

> [!NOTE]
> <span data-ttu-id="20a16-250">Hello service de Table, il est important de tooget hello design correct au préalable, car il est difficile et coûteuse toochange plus tard.</span><span class="sxs-lookup"><span data-stu-id="20a16-250">With hello Table service, it's important tooget hello design correct up front because it's difficult and expensive toochange it later.</span></span> <span data-ttu-id="20a16-251">Par exemple, dans une base de données relationnelle, il est souvent tooaddress possibles des problèmes de performances en ajoutant simplement indexe tooan de base de données existante : il n’est pas une option avec hello service de Table.</span><span class="sxs-lookup"><span data-stu-id="20a16-251">For example, in a relational database it's often possible tooaddress performance issues simply by adding indexes tooan existing database: this is not an option with hello Table service.</span></span>  
> 
> 

<span data-ttu-id="20a16-252">Cette section se concentre sur les problèmes clés hello que lorsque vous concevez vos tables pour les requêtes à traiter.</span><span class="sxs-lookup"><span data-stu-id="20a16-252">This section focuses on hello key issues you must address when you design your tables for querying.</span></span> <span data-ttu-id="20a16-253">Hello rubriques de cette section sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="20a16-253">hello topics covered in this section include:</span></span>

* [<span data-ttu-id="20a16-254">Impact de votre choix de PartitionKey et RowKey sur les performances des requêtes</span><span class="sxs-lookup"><span data-stu-id="20a16-254">How your choice of PartitionKey and RowKey impacts query performance</span></span>](#how-your-choice-of-partitionkey-and-rowkey-impacts-query-performance)
* [<span data-ttu-id="20a16-255">Choix d’une PartitionKey appropriée</span><span class="sxs-lookup"><span data-stu-id="20a16-255">Choosing an appropriate PartitionKey</span></span>](#choosing-an-appropriate-partitionkey)
* [<span data-ttu-id="20a16-256">Optimisation des requêtes pour hello service de Table</span><span class="sxs-lookup"><span data-stu-id="20a16-256">Optimizing queries for hello Table service</span></span>](#optimizing-queries-for-the-table-service)
* [<span data-ttu-id="20a16-257">Tri des données dans hello service de Table</span><span class="sxs-lookup"><span data-stu-id="20a16-257">Sorting data in hello Table service</span></span>](#sorting-data-in-the-table-service)

### <a name="how-your-choice-of-partitionkey-and-rowkey-impacts-query-performance"></a><span data-ttu-id="20a16-258">Impact de votre choix de PartitionKey et RowKey sur les performances des requêtes</span><span class="sxs-lookup"><span data-stu-id="20a16-258">How your choice of PartitionKey and RowKey impacts query performance</span></span>
<span data-ttu-id="20a16-259">Hello exemples suivants supposent service de table hello stocke les entités employé par hello suivant structure (la plupart des exemples de hello omettre hello **Timestamp** propriété par souci de clarté) :</span><span class="sxs-lookup"><span data-stu-id="20a16-259">hello following examples assume hello table service is storing employee entities with hello following structure (most of hello examples omit hello **Timestamp** property for clarity):</span></span>  

| <span data-ttu-id="20a16-260">*Nom de la colonne*</span><span class="sxs-lookup"><span data-stu-id="20a16-260">*Column name*</span></span> | <span data-ttu-id="20a16-261">*Type de données*</span><span class="sxs-lookup"><span data-stu-id="20a16-261">*Data type*</span></span> |
| --- | --- |
| <span data-ttu-id="20a16-262">**PartitionKey** (nom du service)</span><span class="sxs-lookup"><span data-stu-id="20a16-262">**PartitionKey** (Department Name)</span></span> |<span data-ttu-id="20a16-263">String</span><span class="sxs-lookup"><span data-stu-id="20a16-263">String</span></span> |
| <span data-ttu-id="20a16-264">**RowKey** (ID d’employé)</span><span class="sxs-lookup"><span data-stu-id="20a16-264">**RowKey** (Employee Id)</span></span> |<span data-ttu-id="20a16-265">String</span><span class="sxs-lookup"><span data-stu-id="20a16-265">String</span></span> |
| <span data-ttu-id="20a16-266">**FirstName**</span><span class="sxs-lookup"><span data-stu-id="20a16-266">**FirstName**</span></span> |<span data-ttu-id="20a16-267">String</span><span class="sxs-lookup"><span data-stu-id="20a16-267">String</span></span> |
| <span data-ttu-id="20a16-268">**LastName**</span><span class="sxs-lookup"><span data-stu-id="20a16-268">**LastName**</span></span> |<span data-ttu-id="20a16-269">String</span><span class="sxs-lookup"><span data-stu-id="20a16-269">String</span></span> |
| <span data-ttu-id="20a16-270">**Age**</span><span class="sxs-lookup"><span data-stu-id="20a16-270">**Age**</span></span> |<span data-ttu-id="20a16-271">Integer</span><span class="sxs-lookup"><span data-stu-id="20a16-271">Integer</span></span> |
| <span data-ttu-id="20a16-272">**EmailAddress**</span><span class="sxs-lookup"><span data-stu-id="20a16-272">**EmailAddress**</span></span> |<span data-ttu-id="20a16-273">String</span><span class="sxs-lookup"><span data-stu-id="20a16-273">String</span></span> |

<span data-ttu-id="20a16-274">Hello section antérieure [vue d’ensemble du service Table Azure](#overview) décrit quelques-unes des fonctionnalités clés hello Hello service Table Azure qui ont un impact direct sur la conception de la requête.</span><span class="sxs-lookup"><span data-stu-id="20a16-274">hello earlier section [Azure Table service overview](#overview) describes some of hello key features of hello Azure Table service that have a direct influence on designing for query.</span></span> <span data-ttu-id="20a16-275">Sont ainsi hello suivant les recommandations générales pour concevoir des requêtes de service de Table.</span><span class="sxs-lookup"><span data-stu-id="20a16-275">These result in hello following general guidelines for designing Table service queries.</span></span> <span data-ttu-id="20a16-276">Notez que la syntaxe du filtre hello utilisé dans les exemples hello ci-dessous est à partir du service de Table hello API REST, pour plus d’informations, consultez [interroger des entités](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span><span class="sxs-lookup"><span data-stu-id="20a16-276">Note that hello filter syntax used in hello examples below is from hello Table service REST API, for more information see [Query Entities](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span></span>  

* <span data-ttu-id="20a16-277">A ***requête de Point de*** toouse recherche plus efficace de hello, est recommandée toobe utilisé pour les recherches de haut volume ou de recherches nécessitant une latence la plus faible.</span><span class="sxs-lookup"><span data-stu-id="20a16-277">A ***Point Query*** is hello most efficient lookup toouse and is recommended toobe used for high-volume lookups or lookups requiring lowest latency.</span></span> <span data-ttu-id="20a16-278">Une telle requête peut utiliser hello index toolocate une entité individuelle très efficacement en spécifiant les deux hello **PartitionKey** et **RowKey** valeurs.</span><span class="sxs-lookup"><span data-stu-id="20a16-278">Such a query can use hello indexes toolocate an individual entity very efficiently by specifying both hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="20a16-279">Par exemple : $filter=(PartitionKey eq ’Sales’) and (RowKey eq ’2’)</span><span class="sxs-lookup"><span data-stu-id="20a16-279">For example: $filter=(PartitionKey eq 'Sales') and (RowKey eq '2')</span></span>  
* <span data-ttu-id="20a16-280">Deuxième est un ***requête de plage*** qui utilise hello **PartitionKey** et les filtres d’une plage de **RowKey** valeurs tooreturn plusieurs entités.</span><span class="sxs-lookup"><span data-stu-id="20a16-280">Second best is a ***Range Query*** that uses hello **PartitionKey** and filters on a range of **RowKey** values tooreturn more than one entity.</span></span> <span data-ttu-id="20a16-281">Hello **PartitionKey** valeur identifie une partition spécifique et hello **RowKey** valeurs identifient un sous-ensemble d’entités hello dans cette partition.</span><span class="sxs-lookup"><span data-stu-id="20a16-281">hello **PartitionKey** value identifies a specific partition, and hello **RowKey** values identify a subset of hello entities in that partition.</span></span> <span data-ttu-id="20a16-282">Par exemple : $filter=PartitionKey eq ’Sales’ and RowKey ge ’S’ and RowKey lt ’T’</span><span class="sxs-lookup"><span data-stu-id="20a16-282">For example: $filter=PartitionKey eq 'Sales' and RowKey ge 'S' and RowKey lt 'T'</span></span>  
* <span data-ttu-id="20a16-283">Troisième optimale est un ***Partition analyse*** qui utilise hello **PartitionKey** et filtres sur une autre propriété non-clé et qui peuvent retourner plusieurs entités.</span><span class="sxs-lookup"><span data-stu-id="20a16-283">Third best is a ***Partition Scan*** that uses hello **PartitionKey** and filters on another non-key property and that may return more than one entity.</span></span> <span data-ttu-id="20a16-284">Hello **PartitionKey** valeur identifie une partition spécifique, et sélectionnez pour un sous-ensemble d’entités hello dans cette partition de valeurs de propriété de hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-284">hello **PartitionKey** value identifies a specific partition, and hello property values select for a subset of hello entities in that partition.</span></span> <span data-ttu-id="20a16-285">Par exemple : $filter=PartitionKey eq ’Sales’ and LastName eq ’Smith’</span><span class="sxs-lookup"><span data-stu-id="20a16-285">For example: $filter=PartitionKey eq 'Sales' and LastName eq 'Smith'</span></span>  
* <span data-ttu-id="20a16-286">A ***Table Scan*** n’inclut pas de hello **PartitionKey** et s’avère particulièrement inefficace parce qu’il recherche toutes les partitions hello qui composent la table à son tour pour toutes les entités correspondantes.</span><span class="sxs-lookup"><span data-stu-id="20a16-286">A ***Table Scan*** does not include hello **PartitionKey** and is very inefficient because it searches all of hello partitions that make up your table in turn for any matching entities.</span></span> <span data-ttu-id="20a16-287">Il effectue une analyse de table, quelle que soit ou non votre filtre utilise hello **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="20a16-287">It will perform a table scan regardless of whether or not your filter uses hello **RowKey**.</span></span> <span data-ttu-id="20a16-288">Par exemple : $filter=LastName eq ’Jones’</span><span class="sxs-lookup"><span data-stu-id="20a16-288">For example: $filter=LastName eq 'Jones'</span></span>  
* <span data-ttu-id="20a16-289">Les requêtes qui retournent plusieurs entités les retournent triées dans l’ordre de la **PartitionKey** et de la **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="20a16-289">Queries that return multiple entities return them sorted in **PartitionKey** and **RowKey** order.</span></span> <span data-ttu-id="20a16-290">tooavoid avoir recours les entités hello dans le client de hello, choisissez un **RowKey** qui définit l’ordre de tri hello plus courantes.</span><span class="sxs-lookup"><span data-stu-id="20a16-290">tooavoid resorting hello entities in hello client, choose a **RowKey** that defines hello most common sort order.</span></span>  

<span data-ttu-id="20a16-291">Notez que l’utilisation une «**ou**» toospecify un filtre basé sur **RowKey** les valeurs des résultats dans une analyse de la partition et n’est pas traité comme une requête de plage.</span><span class="sxs-lookup"><span data-stu-id="20a16-291">Note that using an "**or**" toospecify a filter based on **RowKey** values results in a partition scan and is not treated as a range query.</span></span> <span data-ttu-id="20a16-292">Par conséquent, vous devez éviter les requêtes qui utilisent des filtres comme : $filter=PartitionKey eq ’Sales’ and (RowKey eq ’121’ or RowKey eq ’322’)</span><span class="sxs-lookup"><span data-stu-id="20a16-292">Therefore, you should avoid queries that use filters such as: $filter=PartitionKey eq 'Sales' and (RowKey eq '121' or RowKey eq '322')</span></span>  

<span data-ttu-id="20a16-293">Pour obtenir des exemples de code côté client qui utilisent des requêtes efficaces hello bibliothèque cliente de stockage tooexecute, consultez :</span><span class="sxs-lookup"><span data-stu-id="20a16-293">For examples of client-side code that use hello Storage Client Library tooexecute efficient queries, see:</span></span>  

* [<span data-ttu-id="20a16-294">Exécution d’une requête de point à l’aide de la bibliothèque cliente de stockage de hello</span><span class="sxs-lookup"><span data-stu-id="20a16-294">Executing a point query using hello Storage Client Library</span></span>](#executing-a-point-query-using-the-storage-client-library)
* [<span data-ttu-id="20a16-295">Récupération de plusieurs entités à l’aide de LINQ</span><span class="sxs-lookup"><span data-stu-id="20a16-295">Retrieving multiple entities using LINQ</span></span>](#retrieving-multiple-entities-using-linq)
* [<span data-ttu-id="20a16-296">Projection côté serveur</span><span class="sxs-lookup"><span data-stu-id="20a16-296">Server-side projection</span></span>](#server-side-projection)  

<span data-ttu-id="20a16-297">Pour obtenir des exemples de code côté client qui peut gérer l’entité plusieurs types stockés dans hello même table, consultez :</span><span class="sxs-lookup"><span data-stu-id="20a16-297">For examples of client-side code that can handle multiple entity types stored in hello same table, see:</span></span>  

* [<span data-ttu-id="20a16-298">Utilisation des types d’entités hétérogènes</span><span class="sxs-lookup"><span data-stu-id="20a16-298">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)  

### <a name="choosing-an-appropriate-partitionkey"></a><span data-ttu-id="20a16-299">Choix d’une PartitionKey appropriée</span><span class="sxs-lookup"><span data-stu-id="20a16-299">Choosing an appropriate PartitionKey</span></span>
<span data-ttu-id="20a16-300">Votre choix de **PartitionKey** doit équilibrer utiliser hello besoin tooenables hello EGTs (cohérence tooensure) hello exigence toodistribute vos entités sur plusieurs partitions (tooensure une solution évolutive).</span><span class="sxs-lookup"><span data-stu-id="20a16-300">Your choice of **PartitionKey** should balance hello need tooenables hello use of EGTs (tooensure consistency) against hello requirement toodistribute your entities across multiple partitions (tooensure a scalable solution).</span></span>  

<span data-ttu-id="20a16-301">Une des extrémités, vous pouvez stocker toutes vos entités dans une seule partition, mais cela peut limiter l’évolutivité hello de votre solution et empêche le service de table hello ne soient pas en mesure de tooload-équilibrer les demandes.</span><span class="sxs-lookup"><span data-stu-id="20a16-301">At one extreme, you could store all your entities in a single partition, but this may limit hello scalability of your solution and would prevent hello table service from being able tooload-balance requests.</span></span> <span data-ttu-id="20a16-302">À hello inverse, vous pouvez stocker une entité par partition, qui est hautement évolutif et qui permet de tooload-équilibrer les demandes de hello table service, mais qui vous empêchent d’à l’aide de transactions de groupe d’entités.</span><span class="sxs-lookup"><span data-stu-id="20a16-302">At hello other extreme, you could store one entity per partition, which would be highly scalable and which enables hello table service tooload-balance requests, but which would prevent you from using entity group transactions.</span></span>  

<span data-ttu-id="20a16-303">Idéale **PartitionKey** est celui qui vous permet de toouse des requêtes efficaces et qui est suffisamment partitions tooensure votre solution est évolutif.</span><span class="sxs-lookup"><span data-stu-id="20a16-303">An ideal **PartitionKey** is one that enables you toouse efficient queries and that has sufficient partitions tooensure your solution is scalable.</span></span> <span data-ttu-id="20a16-304">En règle générale, vous trouverez que vos entités auront une propriété appropriée qui les distribue sur des partitions suffisantes.</span><span class="sxs-lookup"><span data-stu-id="20a16-304">Typically, you will find that your entities will have a suitable property that distributes your entities across sufficient partitions.</span></span>

> [!NOTE]
> <span data-ttu-id="20a16-305">Par exemple, dans un système qui stocke des informations sur des utilisateurs ou des employés, l’ID utilisateur peut être une bonne PartitionKey.</span><span class="sxs-lookup"><span data-stu-id="20a16-305">For example, in a system that stores information about users or employees, UserID may be a good PartitionKey.</span></span> <span data-ttu-id="20a16-306">Vous pouvez avoir plusieurs entités qui utilisent un nom d’utilisateur donné en tant que clé de partition hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-306">You may have several entities that use a given UserID as hello partition key.</span></span> <span data-ttu-id="20a16-307">Les différentes entités qui stockent des données relatives à un utilisateur sont regroupées en une seule partition et sont ainsi accessibles via des transactions de groupe d’entités, tout en étant hautement évolutives.</span><span class="sxs-lookup"><span data-stu-id="20a16-307">Each entity that stores data about a user is grouped into a single partition, and so these entities are accessible via entity group transactions, while still being highly scalable.</span></span>
> 
> 

<span data-ttu-id="20a16-308">Il existe des considérations supplémentaires de votre choix de **PartitionKey** liés toohow vous insérer, mettre à jour et supprimer des entités : consultez la section de hello [conception pour la modification de données](#design-for-data-modification) ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="20a16-308">There are additional considerations in your choice of **PartitionKey** that relate toohow you will insert, update, and delete entities: see hello section [Design for data modification](#design-for-data-modification) below.</span></span>  

### <a name="optimizing-queries-for-hello-table-service"></a><span data-ttu-id="20a16-309">Optimisation des requêtes pour hello service de Table</span><span class="sxs-lookup"><span data-stu-id="20a16-309">Optimizing queries for hello Table service</span></span>
<span data-ttu-id="20a16-310">service de Table de Hello indexe automatiquement vos entités à l’aide de hello **PartitionKey** et **RowKey** valeurs dans un index cluster unique, hello donc raison que les requêtes univoques sont hello toouse plus efficace .</span><span class="sxs-lookup"><span data-stu-id="20a16-310">hello Table service automatically indexes your entities using hello **PartitionKey** and **RowKey** values in a single clustered index, hence hello reason that point queries are hello most efficient toouse.</span></span> <span data-ttu-id="20a16-311">Toutefois, il n’existe pas d’index autre que celui sur l’index ordonné en clusters hello hello **PartitionKey** et **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="20a16-311">However, there are no indexes other than that on hello clustered index on hello **PartitionKey** and **RowKey**.</span></span>

<span data-ttu-id="20a16-312">De nombreuses conceptions doivent répondre aux recherche tooenable de spécifications d’entités en fonction de plusieurs critères.</span><span class="sxs-lookup"><span data-stu-id="20a16-312">Many designs must meet requirements tooenable lookup of entities based on multiple criteria.</span></span> <span data-ttu-id="20a16-313">Par exemple, la localisation des entités relatives aux employés (employee) en fonction de leurs adresses de messagerie électronique, de leur ID employé ou de leur nom.</span><span class="sxs-lookup"><span data-stu-id="20a16-313">For example, locating employee entities based on email, employee id, or last name.</span></span> <span data-ttu-id="20a16-314">Hello suivants de modèles dans la section de hello [les modèles de conception de Table](#table-design-patterns) résoudre ces types de spécifications et décrivent les façons de contourner les faits hello que service de Table hello ne fournit pas d’index secondaires :</span><span class="sxs-lookup"><span data-stu-id="20a16-314">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address these types of requirement and describe ways of working around hello fact that hello Table service does not provide secondary indexes:</span></span>  

* <span data-ttu-id="20a16-315">[Modèle d’index secondaire intra-partition](#intra-partition-secondary-index-pattern) -stocker plusieurs copies de chaque entité à l’aide de différents **RowKey** valeurs (Bonjour même partition) tooenable des recherches rapides et efficaces et tri de substitution à l’aide des commandes autre **RowKey** valeurs.</span><span class="sxs-lookup"><span data-stu-id="20a16-315">[Intra-partition secondary index pattern](#intra-partition-secondary-index-pattern) - Store multiple copies of each entity using different **RowKey** values (in hello same partition) tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  
* <span data-ttu-id="20a16-316">[Modèle de partition entre les index secondaires](#inter-partition-secondary-index-pattern) - stocker plusieurs copies de chaque entité à l’aide de différentes valeurs de RowKey dans des partitions distinctes ou dans des tables distinctes tooenable rapide et des recherches efficaces et tri de substitution des commandes à l’aide de différents **RowKey** valeurs.</span><span class="sxs-lookup"><span data-stu-id="20a16-316">[Inter-partition secondary index pattern](#inter-partition-secondary-index-pattern) - Store multiple copies of each entity using different RowKey values in separate partitions or in separate tables tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  
* <span data-ttu-id="20a16-317">[Modèle d’entités index](#index-entities-pattern) -conserver les index entités tooenable recherches efficaces qui retournent les listes des entités.</span><span class="sxs-lookup"><span data-stu-id="20a16-317">[Index Entities Pattern](#index-entities-pattern) - Maintain index entities tooenable efficient searches that return lists of entities.</span></span>  

### <a name="sorting-data-in-hello-table-service"></a><span data-ttu-id="20a16-318">Tri des données dans hello service de Table</span><span class="sxs-lookup"><span data-stu-id="20a16-318">Sorting data in hello Table service</span></span>
<span data-ttu-id="20a16-319">Hello service de Table retourne des entités triées dans l’ordre croissant selon **PartitionKey** puis **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="20a16-319">hello Table service returns entities sorted in ascending order based on **PartitionKey** and then by **RowKey**.</span></span> <span data-ttu-id="20a16-320">Ces clés sont des valeurs de chaîne et tooensure trier les valeurs numériques correctement, vous devez les convertir tooa fixée longueur et les remplir avec des zéros.</span><span class="sxs-lookup"><span data-stu-id="20a16-320">These keys are string values and tooensure that numeric values sort correctly, you should convert them tooa fixed length and pad them with zeroes.</span></span> <span data-ttu-id="20a16-321">Par exemple, si hello valeur d’id employé vous servir hello **RowKey** est une valeur entière, vous devez convertir les id d’employé **123** trop**00000123**.</span><span class="sxs-lookup"><span data-stu-id="20a16-321">For example, if hello employee id value you use as hello **RowKey** is an integer value, you should convert employee id **123** too**00000123**.</span></span>  

<span data-ttu-id="20a16-322">De nombreuses applications ont des exigences toouse données triées dans des ordres différents : par exemple, le tri employés par nom ou par date de jointure.</span><span class="sxs-lookup"><span data-stu-id="20a16-322">Many applications have requirements toouse data sorted in different orders: for example, sorting employees by name, or by joining date.</span></span> <span data-ttu-id="20a16-323">Hello suivants de modèles dans la section de hello [les modèles de conception de Table](#table-design-patterns) adresse la façon dont les ordres de tri de tooalternate pour vos entités :</span><span class="sxs-lookup"><span data-stu-id="20a16-323">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address how tooalternate sort orders for your entities:</span></span>  

* <span data-ttu-id="20a16-324">[Modèle d’index secondaire intra-partition](#intra-partition-secondary-index-pattern) -stocker plusieurs copies de chaque entité à l’aide de différentes valeurs de RowKey (Bonjour même partition) tooenable des recherches rapides et efficaces et tri de substitution des commandes à l’aide de différentes valeurs de RowKey.</span><span class="sxs-lookup"><span data-stu-id="20a16-324">[Intra-partition secondary index pattern](#intra-partition-secondary-index-pattern) - Store multiple copies of each entity using different RowKey values (in hello same partition) tooenable fast and efficient lookups and alternate sort orders by using different RowKey values.</span></span>  
* <span data-ttu-id="20a16-325">[Modèle de partition entre les index secondaires](#inter-partition-secondary-index-pattern) - stocker plusieurs copies de chaque entité à l’aide de différentes valeurs de RowKey dans des partitions distinctes dans des tables distinctes tooenable rapide et des recherches efficaces et tri de substitution des commandes à l’aide de différents RowKey valeurs.</span><span class="sxs-lookup"><span data-stu-id="20a16-325">[Inter-partition secondary index pattern](#inter-partition-secondary-index-pattern) - Store multiple copies of each entity using different RowKey values in separate partitions in separate tables tooenable fast and efficient lookups and alternate sort orders by using different RowKey values.</span></span>
* <span data-ttu-id="20a16-326">[Le modèle de la fin du journal](#log-tail-pattern) -récupérer hello  *n*  entités la plus récemment ajoutée tooa partition à l’aide un **RowKey** valeur trie inverse de date et l’ordre chronologique.</span><span class="sxs-lookup"><span data-stu-id="20a16-326">[Log tail pattern](#log-tail-pattern) - Retrieve hello *n* entities most recently added tooa partition by using a **RowKey** value that sorts in reverse date and time order.</span></span>  

## <a name="design-for-data-modification"></a><span data-ttu-id="20a16-327">Conception pour la modification de données</span><span class="sxs-lookup"><span data-stu-id="20a16-327">Design for data modification</span></span>
<span data-ttu-id="20a16-328">Cette section se concentre sur les considérations de conception hello pour l’optimisation des insertions, mises à jour et les supprime.</span><span class="sxs-lookup"><span data-stu-id="20a16-328">This section focuses on hello design considerations for optimizing inserts, updates, and deletes.</span></span> <span data-ttu-id="20a16-329">Dans certains cas, vous devez tooevaluate les compromis de hello entre conceptions optimiser pour l’interrogation de conceptions optimiser pour la modification des données comme vous le feriez dans les conceptions de bases de données relationnelles (bien que les techniques de hello de gestion hello conception compromis sont différents dans une base de données relationnelle).</span><span class="sxs-lookup"><span data-stu-id="20a16-329">In some cases, you will need tooevaluate hello trade-off between designs that optimize for querying against designs that optimize for data modification just as you do in designs for relational databases (although hello techniques for managing hello design trade-offs are different in a relational database).</span></span> <span data-ttu-id="20a16-330">Hello section [les modèles de conception de Table](#table-design-patterns) décrit certains modèles de conception détaillées pour hello service de Table et met en évidence certaines ces compromis.</span><span class="sxs-lookup"><span data-stu-id="20a16-330">hello section [Table Design Patterns](#table-design-patterns) describes some detailed design patterns for hello Table service and highlights some these trade-offs.</span></span> <span data-ttu-id="20a16-331">En pratique, vous constaterez que les nombreuses conceptions optimisées pour l'interrogation des entités fonctionnent aussi bien pour la modification des entités.</span><span class="sxs-lookup"><span data-stu-id="20a16-331">In practice, you will find that many designs optimized for querying entities also work well for modifying entities.</span></span>  

### <a name="optimizing-hello-performance-of-insert-update-and-delete-operations"></a><span data-ttu-id="20a16-332">Optimisation des performances de hello de l’instruction insert, update et delete opérations</span><span class="sxs-lookup"><span data-stu-id="20a16-332">Optimizing hello performance of insert, update, and delete operations</span></span>
<span data-ttu-id="20a16-333">tooupdate ou supprimer une entité, vous devez être en mesure de tooidentify à l’aide de hello **PartitionKey** et **RowKey** valeurs.</span><span class="sxs-lookup"><span data-stu-id="20a16-333">tooupdate or delete an entity, you must be able tooidentify it by using hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="20a16-334">À cet égard, votre choix de **PartitionKey** et **RowKey** pour la modification des entités doit suivre similaire critères tooyour choix toosupport point de requêtes, car vous souhaitez que les entités tooidentify en tant que plus efficacement possible.</span><span class="sxs-lookup"><span data-stu-id="20a16-334">In this respect, your choice of **PartitionKey** and **RowKey** for modifying entities should follow similar criteria tooyour choice toosupport point queries because you want tooidentify entities as efficiently as possible.</span></span> <span data-ttu-id="20a16-335">Vous ne souhaitez pas toouse un inefficace partition ou une table analyse toolocate une entité Bonjour de toodiscover commande **PartitionKey** et **RowKey** valeurs, vous devez tooupdate ou la supprimer.</span><span class="sxs-lookup"><span data-stu-id="20a16-335">You do not want toouse an inefficient partition or table scan toolocate an entity in order toodiscover hello **PartitionKey** and **RowKey** values you need tooupdate or delete it.</span></span>  

<span data-ttu-id="20a16-336">Hello suivants de modèles dans la section de hello [les modèles de conception de Table](#table-design-patterns) adresse optimisation des performances hello ou votre insertion, la mise à jour et supprimer des opérations :</span><span class="sxs-lookup"><span data-stu-id="20a16-336">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address optimizing hello performance or your insert, update, and delete operations:</span></span>  

* <span data-ttu-id="20a16-337">[Un volume élevé supprimer modèle](#high-volume-delete-pattern) -suppression de hello activation d’un volume élevé d’entités en stockant toutes les entités hello pour suppression simultanée dans leur propre table distincte ; vous supprimer des entités de hello en supprimant la table de hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-337">[High volume delete pattern](#high-volume-delete-pattern) - Enable hello deletion of a high volume of entities by storing all hello entities for simultaneous deletion in their own separate table; you delete hello entities by deleting hello table.</span></span>  
* <span data-ttu-id="20a16-338">[Modèle de série de données](#data-series-pattern) -série de données complète de magasin seule entité toominimize hello de plusieurs demandes.</span><span class="sxs-lookup"><span data-stu-id="20a16-338">[Data series pattern](#data-series-pattern) - Store complete data series in a single entity toominimize hello number of requests you make.</span></span>  
* <span data-ttu-id="20a16-339">[Modèle d’entités large](#wide-entities-pattern) -utiliser des entités logiques plusieurs entités physiques toostore avec plus de 252 propriétés.</span><span class="sxs-lookup"><span data-stu-id="20a16-339">[Wide entities pattern](#wide-entities-pattern) - Use multiple physical entities toostore logical entities with more than 252 properties.</span></span>  
* <span data-ttu-id="20a16-340">[Modèle d’entités volumineux](#large-entities-pattern) -utiliser blob stockage toostore grande des valeurs.</span><span class="sxs-lookup"><span data-stu-id="20a16-340">[Large entities pattern](#large-entities-pattern) - Use blob storage toostore large property values.</span></span>  

### <a name="ensuring-consistency-in-your-stored-entities"></a><span data-ttu-id="20a16-341">Vérification de la cohérence de vos entités stockées</span><span class="sxs-lookup"><span data-stu-id="20a16-341">Ensuring consistency in your stored entities</span></span>
<span data-ttu-id="20a16-342">Hello autre facteur clé qui influencent votre choix de clés pour l’optimisation des modifications de données est la cohérence tooensure à l’aide de transactions atomiques.</span><span class="sxs-lookup"><span data-stu-id="20a16-342">hello other key factor that influences your choice of keys for optimizing data modifications is how tooensure consistency by using atomic transactions.</span></span> <span data-ttu-id="20a16-343">Vous ne pouvez utiliser un toooperate EGT sur les entités stockées dans hello même partition.</span><span class="sxs-lookup"><span data-stu-id="20a16-343">You can only use an EGT toooperate on entities stored in hello same partition.</span></span>  

<span data-ttu-id="20a16-344">Hello suivants de modèles dans la section de hello [les modèles de conception de Table](#table-design-patterns) la gestion de la cohérence des adresses :</span><span class="sxs-lookup"><span data-stu-id="20a16-344">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address managing consistency:</span></span>  

* <span data-ttu-id="20a16-345">[Modèle d’index secondaire intra-partition](#intra-partition-secondary-index-pattern) -stocker plusieurs copies de chaque entité à l’aide de différents **RowKey** valeurs (Bonjour même partition) tooenable des recherches rapides et efficaces et tri de substitution à l’aide des commandes autre **RowKey** valeurs.</span><span class="sxs-lookup"><span data-stu-id="20a16-345">[Intra-partition secondary index pattern](#intra-partition-secondary-index-pattern) - Store multiple copies of each entity using different **RowKey** values (in hello same partition) tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  
* <span data-ttu-id="20a16-346">[Modèle de partition entre les index secondaires](#inter-partition-secondary-index-pattern) - stocker plusieurs copies de chaque entité à l’aide de différentes valeurs de RowKey dans des partitions distinctes ou dans des tables distinctes tooenable rapide et des recherches efficaces et tri de substitution des commandes à l’aide de différents **RowKey** valeurs.</span><span class="sxs-lookup"><span data-stu-id="20a16-346">[Inter-partition secondary index pattern](#inter-partition-secondary-index-pattern) - Store multiple copies of each entity using different RowKey values in separate partitions or in separate tables tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  
* <span data-ttu-id="20a16-347">[Modèle de transactions cohérentes](#eventually-consistent-transactions-pattern) : permet de conserver un comportement cohérent entre les limites de partition ou les limites du système de stockage à l’aide des files d’attente Azure.</span><span class="sxs-lookup"><span data-stu-id="20a16-347">[Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) - Enable eventually consistent behavior across partition boundaries or storage system boundaries by using Azure queues.</span></span>
* <span data-ttu-id="20a16-348">[Modèle d’entités index](#index-entities-pattern) -conserver les index entités tooenable recherches efficaces qui retournent les listes des entités.</span><span class="sxs-lookup"><span data-stu-id="20a16-348">[Index Entities Pattern](#index-entities-pattern) - Maintain index entities tooenable efficient searches that return lists of entities.</span></span>  
* <span data-ttu-id="20a16-349">[Modèle de dénormalisation](#denormalization-pattern) -combiner reliés de données dans une seule entité tooenable tooretrieve tous hello des données que vous avez besoin d’une requête de point unique.</span><span class="sxs-lookup"><span data-stu-id="20a16-349">[Denormalization pattern](#denormalization-pattern) - Combine related data together in a single entity tooenable you tooretrieve all hello data you need with a single point query.</span></span>  
* <span data-ttu-id="20a16-350">[Modèle de série de données](#data-series-pattern) -série de données complète de magasin seule entité toominimize hello de plusieurs demandes.</span><span class="sxs-lookup"><span data-stu-id="20a16-350">[Data series pattern](#data-series-pattern) - Store complete data series in a single entity toominimize hello number of requests you make.</span></span>  

<span data-ttu-id="20a16-351">Pour plus d’informations sur les transactions de groupe d’entités, consultez la section de hello [Transactions de groupe d’entités](#entity-group-transactions).</span><span class="sxs-lookup"><span data-stu-id="20a16-351">For information about entity group transactions, see hello section [Entity Group Transactions](#entity-group-transactions).</span></span>  

### <a name="ensuring-your-design-for-efficient-modifications-facilitates-efficient-queries"></a><span data-ttu-id="20a16-352">Garantie que votre conception visant à effectuer des modifications efficaces facilite les requêtes efficaces</span><span class="sxs-lookup"><span data-stu-id="20a16-352">Ensuring your design for efficient modifications facilitates efficient queries</span></span>
<span data-ttu-id="20a16-353">Dans de nombreux cas, une conception pour les résultats de requêtes efficace dans modifications efficace, mais vous devez évaluez toujours s’il s’agit de cas hello pour votre scénario spécifique.</span><span class="sxs-lookup"><span data-stu-id="20a16-353">In many cases, a design for efficient querying results in efficient modifications, but you should always evaluate whether this is hello case for your specific scenario.</span></span> <span data-ttu-id="20a16-354">Certains schémas hello dans la section de hello [les modèles de conception de Table](#table-design-patterns) explicitement évaluer les compromis entre l’interrogation et la modification des entités, et vous devez toujours prendre en compte hello quantité, pour chaque type d’opération.</span><span class="sxs-lookup"><span data-stu-id="20a16-354">Some of hello patterns in hello section [Table Design Patterns](#table-design-patterns) explicitly evaluate trade-offs between querying and modifying entities, and you should always take into account hello number of each type of operation.</span></span>  

<span data-ttu-id="20a16-355">Hello suivants de modèles dans la section de hello [les modèles de conception de Table](#table-design-patterns) compromis entre la conception de requêtes efficaces et de conception pour la modification de données efficace d’adresses :</span><span class="sxs-lookup"><span data-stu-id="20a16-355">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address trade-offs between designing for efficient queries and designing for efficient data modification:</span></span>  

* <span data-ttu-id="20a16-356">[Modèle clé composé](#compound-key-pattern) -utilisez composé **RowKey** valeurs tooenable un toolookup client liés de données avec une requête de point unique.</span><span class="sxs-lookup"><span data-stu-id="20a16-356">[Compound key pattern](#compound-key-pattern) - Use compound **RowKey** values tooenable a client toolookup related data with a single point query.</span></span>  
* <span data-ttu-id="20a16-357">[Le modèle de la fin du journal](#log-tail-pattern) -récupérer hello  *n*  entités la plus récemment ajoutée tooa partition à l’aide un **RowKey** valeur trie inverse de date et l’ordre chronologique.</span><span class="sxs-lookup"><span data-stu-id="20a16-357">[Log tail pattern](#log-tail-pattern) - Retrieve hello *n* entities most recently added tooa partition by using a **RowKey** value that sorts in reverse date and time order.</span></span>  

## <a name="encrypting-table-data"></a><span data-ttu-id="20a16-358">Chiffrement de données de table</span><span class="sxs-lookup"><span data-stu-id="20a16-358">Encrypting Table Data</span></span>
<span data-ttu-id="20a16-359">Hello bibliothèque cliente de stockage de Azure .NET prend en charge le chiffrement des propriétés d’entité de chaîne pour l’insertion d’opérations et de remplacement.</span><span class="sxs-lookup"><span data-stu-id="20a16-359">hello .NET Azure Storage Client Library supports encryption of string entity properties for insert and replace operations.</span></span> <span data-ttu-id="20a16-360">chaînes de Hello chiffrée sont stockées sur le service de hello en tant que propriétés binaires, et elles sont converties en arrière toostrings après le déchiffrement.</span><span class="sxs-lookup"><span data-stu-id="20a16-360">hello encrypted strings are stored on hello service as binary properties, and they are converted back toostrings after decryption.</span></span>    

<span data-ttu-id="20a16-361">Pour les tables, en outre toohello de stratégie de chiffrement, les utilisateurs doivent spécifier hello propriétés toobe est chiffré.</span><span class="sxs-lookup"><span data-stu-id="20a16-361">For tables, in addition toohello encryption policy, users must specify hello properties toobe encrypted.</span></span> <span data-ttu-id="20a16-362">Pour ce faire, il faut spécifier un attribut EncryptProperty \(pour les entités POCO qui dérivent de TableEntity) ou un programme de résolution de chiffrement dans les options de requête.</span><span class="sxs-lookup"><span data-stu-id="20a16-362">This can be done by either specifying an [EncryptProperty] attribute (for POCO entities that derive from TableEntity) or an encryption resolver in request options.</span></span> <span data-ttu-id="20a16-363">Un programme de résolution de chiffrement est un délégué qui prend une clé de partition, une clé de ligne et un nom de propriété, puis renvoie une valeur booléenne indiquant si cette propriété doit être chiffrée.</span><span class="sxs-lookup"><span data-stu-id="20a16-363">An encryption resolver is a delegate that takes a partition key, row key, and property name and returns a Boolean that indicates whether that property should be encrypted.</span></span> <span data-ttu-id="20a16-364">Au cours du chiffrement, bibliothèque cliente de hello utilisera cette toodecide informations si une propriété doit être chiffrée lors de l’écriture toohello câble.</span><span class="sxs-lookup"><span data-stu-id="20a16-364">During encryption, hello client library will use this information toodecide whether a property should be encrypted while writing toohello wire.</span></span> <span data-ttu-id="20a16-365">délégué de Hello prévoit également de la possibilité de hello de logique autour de la façon dont les propriétés sont cryptées.</span><span class="sxs-lookup"><span data-stu-id="20a16-365">hello delegate also provides for hello possibility of logic around how properties are encrypted.</span></span> <span data-ttu-id="20a16-366">(Par exemple, si X, alors chiffrer la propriété A ; sinon chiffrer les propriétés A et B.) Notez qu’il est tooprovide n’est pas nécessaire de ces informations lors de la lecture ou l’interrogation des entités.</span><span class="sxs-lookup"><span data-stu-id="20a16-366">(For example, if X, then encrypt property A; otherwise encrypt properties A and B.) Note that it is not necessary tooprovide this information while reading or querying entities.</span></span>

<span data-ttu-id="20a16-367">Notez que la fusion n’est pas prise en charge pour le moment.</span><span class="sxs-lookup"><span data-stu-id="20a16-367">Note that merge is not currently supported.</span></span> <span data-ttu-id="20a16-368">Dans la mesure où un sous-ensemble de propriétés aient été crypté précédemment à l’aide d’une autre clé, simplement la fusion de nouvelles propriétés de hello et mise à jour des métadonnées de hello entraîne une perte de données.</span><span class="sxs-lookup"><span data-stu-id="20a16-368">Since a subset of properties may have been encrypted previously using a different key, simply merging hello new properties and updating hello metadata will result in data loss.</span></span> <span data-ttu-id="20a16-369">La fusion soit nécessite un service supplémentaire appels entité de tooread hello existant à partir du service de hello, ou à l’aide d’une nouvelle clé par propriété, qui ne conviennent pas pour des raisons de performances.</span><span class="sxs-lookup"><span data-stu-id="20a16-369">Merging either requires making extra service calls tooread hello pre-existing entity from hello service, or using a new key per property, both of which are not suitable for performance reasons.</span></span>     

<span data-ttu-id="20a16-370">Pour plus d’informations sur le chiffrement des données de table, consultez [Chiffrement côté client et coffre de clés Azure pour Microsoft Azure Storage](../storage/common/storage-client-side-encryption.md).</span><span class="sxs-lookup"><span data-stu-id="20a16-370">For information about encrypting table data, see [Client-Side Encryption and Azure Key Vault for Microsoft Azure Storage](../storage/common/storage-client-side-encryption.md).</span></span>  

## <a name="modelling-relationships"></a><span data-ttu-id="20a16-371">Modélisation des relations</span><span class="sxs-lookup"><span data-stu-id="20a16-371">Modelling relationships</span></span>
<span data-ttu-id="20a16-372">Création de modèles de domaine est une étape clée dans la conception de hello des systèmes complexes.</span><span class="sxs-lookup"><span data-stu-id="20a16-372">Building domain models is a key step in hello design of complex systems.</span></span> <span data-ttu-id="20a16-373">En règle générale, vous hello modélisation des processus tooidentify entités et relations hello entre eux, comme un moyen toounderstand hello du domaine d’entreprise informent conception hello de votre système.</span><span class="sxs-lookup"><span data-stu-id="20a16-373">Typically, you use hello modelling process tooidentify entities and hello relationships between them as a way toounderstand hello business domain and inform hello design of your system.</span></span> <span data-ttu-id="20a16-374">Cette section se concentre sur la façon dont vous pouvez traduire certains des types hello communs relation trouvés dans toodesigns de modèles de domaine pour hello service de Table.</span><span class="sxs-lookup"><span data-stu-id="20a16-374">This section focuses on how you can translate some of hello common relationship types found in domain models toodesigns for hello Table service.</span></span> <span data-ttu-id="20a16-375">processus de Hello de mappage à partir d’un logique tooa de modèle de données physique en fonction-modèle de données NoSQL est très différente de celle utilisée lors de la conception d’une base de données relationnelle.</span><span class="sxs-lookup"><span data-stu-id="20a16-375">hello process of mapping from a logical data-model tooa physical NoSQL based data-model is very different from that used when designing a relational database.</span></span> <span data-ttu-id="20a16-376">Conception de bases de données relationnelles suppose généralement un processus de normalisation de données optimisé pour minimiser la redondance – et une fonctionnalité de requête déclarative qui résumés hello la mise en œuvre du fonctionne de la base de données hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-376">Relational databases design typically assumes a data normalization process optimized for minimizing redundancy – and a declarative querying capability that abstracts how hello implementation of how hello database works.</span></span>  

### <a name="one-to-many-relationships"></a><span data-ttu-id="20a16-377">Relations un-à-plusieurs</span><span class="sxs-lookup"><span data-stu-id="20a16-377">One-to-many relationships</span></span>
<span data-ttu-id="20a16-378">Les relations un-à-plusieurs entre des objets de domaine d'entreprise se produisent très fréquemment : par exemple, un service a de nombreux employés.</span><span class="sxs-lookup"><span data-stu-id="20a16-378">One-to-many relationships between business domain objects occur very frequently: for example, one department has many employees.</span></span> <span data-ttu-id="20a16-379">Il existe plusieurs relations de type un-à-plusieurs façons tooimplement Bonjour service de Table chaque avec leurs avantages et inconvénients qui peuvent être pertinentes toohello scénario en particulier.</span><span class="sxs-lookup"><span data-stu-id="20a16-379">There are several ways tooimplement one-to-many relationships in hello Table service each with pros and cons that may be relevant toohello particular scenario.</span></span>  

<span data-ttu-id="20a16-380">Considérez l’exemple hello d’une grande entreprise multinationale avec des dizaines de milliers de services et les entités employé où chaque service a de nombreux employés et chaque employé comme associée à un service spécifique.</span><span class="sxs-lookup"><span data-stu-id="20a16-380">Consider hello example of a large multi-national corporation with tens of thousands of departments and employee entities where every department has many employees and each employee as associated with one specific department.</span></span> <span data-ttu-id="20a16-381">Une approche consiste à service distincts de toostore et entités employé telles que celles-ci :</span><span class="sxs-lookup"><span data-stu-id="20a16-381">One approach is toostore separate department and employee entities such as these:</span></span>  

![][1]

<span data-ttu-id="20a16-382">Cet exemple montre une relation un-à-plusieurs implicite entre types hello selon hello **PartitionKey** valeur.</span><span class="sxs-lookup"><span data-stu-id="20a16-382">This example shows an implicit one-to-many relationship between hello types based on hello **PartitionKey** value.</span></span> <span data-ttu-id="20a16-383">Chaque service peut avoir de nombreux employés.</span><span class="sxs-lookup"><span data-stu-id="20a16-383">Each department can have many employees.</span></span>  

<span data-ttu-id="20a16-384">Cet exemple montre également une entité de service et ses entités employé dans hello même partition.</span><span class="sxs-lookup"><span data-stu-id="20a16-384">This example also shows a department entity and its related employee entities in hello same partition.</span></span> <span data-ttu-id="20a16-385">Vous pouvez choisir toouse différentes partitions, les tables ou même des comptes de stockage pour hello différents types d’entité.</span><span class="sxs-lookup"><span data-stu-id="20a16-385">You could choose toouse different partitions, tables, or even storage accounts for hello different entity types.</span></span>  

<span data-ttu-id="20a16-386">Une autre approche est toodenormalize vos entités employé uniquement données et le magasin avec des données dénormalisées département, comme indiqué dans hello l’exemple suivant.</span><span class="sxs-lookup"><span data-stu-id="20a16-386">An alternative approach is toodenormalize your data and store only employee entities with denormalized department data as shown in hello following example.</span></span> <span data-ttu-id="20a16-387">Dans ce scénario particulier, cette approche dénormalisée peut-être pas hello meilleures si vous avez un besoin toobe toochange en mesure de hello les détails d’un gestionnaire de service car toodo cela vous devez tooupdate chaque employé dans le service de hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-387">In this particular scenario, this denormalized approach may not be hello best if you have a requirement toobe able toochange hello details of a department manager because toodo this you need tooupdate every employee in hello department.</span></span>  

![][2]

<span data-ttu-id="20a16-388">Pour plus d’informations, consultez hello [modèle de dénormalisation](#denormalization-pattern) plus loin dans ce guide.</span><span class="sxs-lookup"><span data-stu-id="20a16-388">For more information, see hello [Denormalization pattern](#denormalization-pattern) later in this guide.</span></span>  

<span data-ttu-id="20a16-389">Hello tableau suivant résume les avantages et inconvénients de chacune des approches hello présentées ci-dessus pour le stockage des employés et des entités de service qui ont une relation un-à-plusieurs hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-389">hello following table summarizes hello pros and cons of each of hello approaches outlined above for storing employee and department entities that have a one-to-many relationship.</span></span> <span data-ttu-id="20a16-390">Vous devez également envisager la fréquence à laquelle tooperform diverses opérations : il peut être acceptable toohave une conception qui inclut une opération coûteuse, si cette opération ne se produit que rarement.</span><span class="sxs-lookup"><span data-stu-id="20a16-390">You should also consider how often you expect tooperform various operations: it may be acceptable toohave a design that includes an expensive operation if that operation only happens infrequently.</span></span>  

<table>
<tr>
<th><span data-ttu-id="20a16-391">Approche</span><span class="sxs-lookup"><span data-stu-id="20a16-391">Approach</span></span></th>
<th><span data-ttu-id="20a16-392">Avantages</span><span class="sxs-lookup"><span data-stu-id="20a16-392">Pros</span></span></th>
<th><span data-ttu-id="20a16-393">Inconvénients</span><span class="sxs-lookup"><span data-stu-id="20a16-393">Cons</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="20a16-394">Séparation des types d'entités, même partition, même table</span><span class="sxs-lookup"><span data-stu-id="20a16-394">Separate entity types, same partition, same table</span></span></td>
<td>
<ul>
<li><span data-ttu-id="20a16-395">Vous pouvez mettre à jour une entité de service en une seule opération.</span><span class="sxs-lookup"><span data-stu-id="20a16-395">You can update a department entity with a single operation.</span></span></li>
<li><span data-ttu-id="20a16-396">Vous pouvez utiliser une cohérence de toomaintain EGT si vous disposez d’une exigence toomodify une entité de service chaque fois que vous mise à jour/insertion/suppression une entité employee.</span><span class="sxs-lookup"><span data-stu-id="20a16-396">You can use an EGT toomaintain consistency if you have a requirement toomodify a department entity whenever you update/insert/delete an employee entity.</span></span> <span data-ttu-id="20a16-397">Par exemple, si vous conservez un nombre d'employés de service pour chaque service.</span><span class="sxs-lookup"><span data-stu-id="20a16-397">For example if you maintain a departmental employee count for each department.</span></span></li>
</ul>
</td>
<td>
<ul>
<li><span data-ttu-id="20a16-398">Vous devrez peut-être tooretrieve un employé et une entité de service pour certaines activités de client.</span><span class="sxs-lookup"><span data-stu-id="20a16-398">You may need tooretrieve both an employee and a department entity for some client activities.</span></span></li>
<li><span data-ttu-id="20a16-399">Opérations de stockage produisent dans hello même partition.</span><span class="sxs-lookup"><span data-stu-id="20a16-399">Storage operations happen in hello same partition.</span></span> <span data-ttu-id="20a16-400">Si les volumes de transactions sont élevés, cela peut entraîner une zone sensible.</span><span class="sxs-lookup"><span data-stu-id="20a16-400">At high transaction volumes, this may result in a hotspot.</span></span></li>
<li><span data-ttu-id="20a16-401">Vous ne pouvez pas déplacer un employé tooa nouveau service à l’aide d’un EGT.</span><span class="sxs-lookup"><span data-stu-id="20a16-401">You cannot move an employee tooa new department using an EGT.</span></span></li>
</ul>
</td>
</tr>
<tr>
<td><span data-ttu-id="20a16-402">Types d'entités distincts, différentes partitions ou différentes tables ou différents comptes de stockage</span><span class="sxs-lookup"><span data-stu-id="20a16-402">Separate entity types, different partitions or tables or storage accounts</span></span></td>
<td>
<ul>
<li><span data-ttu-id="20a16-403">Vous pouvez mettre à jour une entité de service ou une entité d'employé avec une seule opération.</span><span class="sxs-lookup"><span data-stu-id="20a16-403">You can update a department entity or employee entity with a single operation.</span></span></li>
<li><span data-ttu-id="20a16-404">Au niveau des volumes élevés de transactions, cela peut aider à charge de hello réparti sur plusieurs partitions.</span><span class="sxs-lookup"><span data-stu-id="20a16-404">At high transaction volumes, this may help spread hello load across more partitions.</span></span></li>
</ul>
</td>
<td>
<ul>
<li><span data-ttu-id="20a16-405">Vous devrez peut-être tooretrieve un employé et une entité de service pour certaines activités de client.</span><span class="sxs-lookup"><span data-stu-id="20a16-405">You may need tooretrieve both an employee and a department entity for some client activities.</span></span></li>
<li><span data-ttu-id="20a16-406">Vous ne pouvez pas utiliser EGTs toomaintain cohérence lorsque vous mise à jour/insertion/suppression un employé et mise à jour un service.</span><span class="sxs-lookup"><span data-stu-id="20a16-406">You cannot use EGTs toomaintain consistency when you update/insert/delete an employee and update a department.</span></span> <span data-ttu-id="20a16-407">Par exemple, la mise à jour d'un nombre d'employés dans une entité de service.</span><span class="sxs-lookup"><span data-stu-id="20a16-407">For example, updating an employee count in a department entity.</span></span></li>
<li><span data-ttu-id="20a16-408">Vous ne pouvez pas déplacer un employé tooa nouveau service à l’aide d’un EGT.</span><span class="sxs-lookup"><span data-stu-id="20a16-408">You cannot move an employee tooa new department using an EGT.</span></span></li>
</ul>
</td>
</tr>
<tr>
<td><span data-ttu-id="20a16-409">Dénormaliser en type d'entité unique</span><span class="sxs-lookup"><span data-stu-id="20a16-409">Denormalize into single entity type</span></span></td>
<td>
<ul>
<li><span data-ttu-id="20a16-410">Vous pouvez récupérer toutes les informations de hello que vous avez besoin d’une demande unique.</span><span class="sxs-lookup"><span data-stu-id="20a16-410">You can retrieve all hello information you need with a single request.</span></span></li>
</ul>
</td>
<td>
<ul>
<li><span data-ttu-id="20a16-411">Il peut être coûteuse toomaintain cohérence si vous avez besoin des informations de service tooupdate (cela nécessiterait vous tooupdate tous les employés hello dans un service).</span><span class="sxs-lookup"><span data-stu-id="20a16-411">It may be expensive toomaintain consistency if you need tooupdate department information (this would require you tooupdate all hello employees in a department).</span></span></li>
</ul>
</td>
</tr>
</table>

<span data-ttu-id="20a16-412">Comment vous choisir entre ces options et les professionnels de l’hello et les inconvénients sont plus importantes, dépend de vos scénarios d’application spécifique.</span><span class="sxs-lookup"><span data-stu-id="20a16-412">How you choose between these options, and which of hello pros and cons are most significant, depends on your specific application scenarios.</span></span> <span data-ttu-id="20a16-413">Par exemple, la fréquence à laquelle vous modifiez des entités de service ; toutes vos requêtes employé doivent-elles hello départemental des informations supplémentaires ; Comment fermer vous sont les limites d’extensibilité toohello sur vos partitions ou votre compte de stockage ?</span><span class="sxs-lookup"><span data-stu-id="20a16-413">For example, how often do you modify department entities; do all your employee queries need hello additional departmental information; how close are you toohello scalability limits on your partitions or your storage account?</span></span>  

### <a name="one-to-one-relationships"></a><span data-ttu-id="20a16-414">Relations un à un</span><span class="sxs-lookup"><span data-stu-id="20a16-414">One-to-one relationships</span></span>
<span data-ttu-id="20a16-415">Les modèles de domaines peuvent inclure des relations un à un entre les entités.</span><span class="sxs-lookup"><span data-stu-id="20a16-415">Domain models may include one-to-one relationships between entities.</span></span> <span data-ttu-id="20a16-416">Si vous devez tooimplement une relation un à un Bonjour service de Table, vous devez également choisir comment toolink hello deux entités associées lorsque vous avez besoin de tooretrieve tous les deux.</span><span class="sxs-lookup"><span data-stu-id="20a16-416">If you need tooimplement a one-to-one relationship in hello Table service, you must also choose how toolink hello two related entities when you need tooretrieve them both.</span></span> <span data-ttu-id="20a16-417">Ce lien peut être implicite, selon une convention de valeurs de clés hello ou explicite en stockant un lien sous forme de hello de **PartitionKey** et **RowKey** entité de valeurs dans chaque tooits entité liée.</span><span class="sxs-lookup"><span data-stu-id="20a16-417">This link can be either implicit, based on a convention in hello key values, or explicit by storing a link in hello form of **PartitionKey** and **RowKey** values in each entity tooits related entity.</span></span> <span data-ttu-id="20a16-418">Pour en savoir plus sur si vous devez stocker hello des entités connexes dans hello même partition, consultez la section de hello [un-à-plusieurs relations](#one-to-many-relationships).</span><span class="sxs-lookup"><span data-stu-id="20a16-418">For a discussion of whether you should store hello related entities in hello same partition, see hello section [One-to-many relationships](#one-to-many-relationships).</span></span>  

<span data-ttu-id="20a16-419">Notez qu’il existe également des considérations sur l’implémentation qui peuvent représenter des relations tooimplement hello service de Table :</span><span class="sxs-lookup"><span data-stu-id="20a16-419">Note that there are also implementation considerations that might lead you tooimplement one-to-one relationships in hello Table service:</span></span>  

* <span data-ttu-id="20a16-420">Gestion des entités volumineuses (pour plus d’informations, consultez [Modèle d’entités volumineuses](#large-entities-pattern))</span><span class="sxs-lookup"><span data-stu-id="20a16-420">Handling large entities (for more information, see [Large Entities Pattern](#large-entities-pattern)).</span></span>  
* <span data-ttu-id="20a16-421">L’implémentation de contrôles d’accès (pour plus d’informations, consultez [Contrôle d’accès avec des signatures d’accès partagé](#controlling-access-with-shared-access-signatures))</span><span class="sxs-lookup"><span data-stu-id="20a16-421">Implementing access controls (for more information, see [Controlling access with Shared Access Signatures](#controlling-access-with-shared-access-signatures)).</span></span>  

### <a name="join-in-hello-client"></a><span data-ttu-id="20a16-422">Jointure dans le client de hello</span><span class="sxs-lookup"><span data-stu-id="20a16-422">Join in hello client</span></span>
<span data-ttu-id="20a16-423">Bien qu’il existe des relations de façons toomodel Bonjour service de Table, vous que deux raisons principales hello pour l’utilisation du service de Table hello sont l’évolutivité et les performances ne devez pas oublier.</span><span class="sxs-lookup"><span data-stu-id="20a16-423">Although there are ways toomodel relationships in hello Table service, you should not forget that hello two prime reasons for using hello Table service are scalability and performance.</span></span> <span data-ttu-id="20a16-424">Si vous trouvez que sont de modélisation plusieurs relations de compromettre les performances hello et l’évolutivité de votre solution, se poser que si elle est nécessaire toobuild tous hello dans votre conception de la table des relations de données.</span><span class="sxs-lookup"><span data-stu-id="20a16-424">If you find you are modelling many relationships that compromise hello performance and scalability of your solution, you should ask yourself if it is necessary toobuild all hello data relationships into your table design.</span></span> <span data-ttu-id="20a16-425">Vous pouvez en mesure de toosimplify hello Design et améliorer les performances de votre solution et l’extensibilité de hello si vous laissez votre application cliente pour effectuer toutes les jointures nécessaires.</span><span class="sxs-lookup"><span data-stu-id="20a16-425">You may be able toosimplify hello design and improve hello scalability and performance of your solution if you let your client application perform any necessary joins.</span></span>  

<span data-ttu-id="20a16-426">Par exemple, si vous avez des tables de petite taille qui contiennent des données qui ne changent pas souvent, vous pouvez extraire ces données qu’une seule fois et mettre en cache sur le client de hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-426">For example, if you have small tables that contain data that does not change very often, then you can retrieve this data once and cache it on hello client.</span></span> <span data-ttu-id="20a16-427">Cela permet d’éviter les allers et retours répétées tooretrieve hello des mêmes données.</span><span class="sxs-lookup"><span data-stu-id="20a16-427">This can avoid repeated roundtrips tooretrieve hello same data.</span></span> <span data-ttu-id="20a16-428">Dans les exemples hello que nous avons abordé dans ce guide, hello ensemble de services dans une petite entreprise est probablement toobe petit et modification rarement rend un bon candidat pour l’application cliente peut télécharger une fois les données et le cache en tant que données de recherche.</span><span class="sxs-lookup"><span data-stu-id="20a16-428">In hello examples we have looked at in this guide, hello set of departments in a small organization is likely toobe small and change infrequently making it a good candidate for data that client application can download once and cache as look up data.</span></span>  

### <a name="inheritance-relationships"></a><span data-ttu-id="20a16-429">Relations d'héritage</span><span class="sxs-lookup"><span data-stu-id="20a16-429">Inheritance relationships</span></span>
<span data-ttu-id="20a16-430">Si votre application cliente utilise un ensemble de classes faisant partie d’un entités toorepresent relation d’héritage, vous pouvez facilement conserver ces entités Bonjour service de Table.</span><span class="sxs-lookup"><span data-stu-id="20a16-430">If your client application uses a set of classes that form part of an inheritance relationship toorepresent business entities, you can easily persist those entities in hello Table service.</span></span> <span data-ttu-id="20a16-431">Par exemple, vous disposez hello suivant l’ensemble de classes définies dans votre application cliente où **personne** est une classe abstraite.</span><span class="sxs-lookup"><span data-stu-id="20a16-431">For example, you might have hello following set of classes defined in your client application where **Person** is an abstract class.</span></span>

![][3]

<span data-ttu-id="20a16-432">Vous pouvez conserver les instances de deux classes concrètes hello Bonjour service de Table à l’aide d’une seule table de personne à l’aide des entités dans ressemblant à ceci :</span><span class="sxs-lookup"><span data-stu-id="20a16-432">You can persist instances of hello two concrete classes in hello Table service using a single Person table using entities in that look like this:</span></span>  

![][4]

<span data-ttu-id="20a16-433">Pour plus d’informations sur l’utilisation de plusieurs types d’entités dans la même table dans le code client de hello, consultez la section de hello [utilisation des types d’entités hétérogènes](#working-with-heterogeneous-entity-types) plus loin dans ce guide.</span><span class="sxs-lookup"><span data-stu-id="20a16-433">For more information about working with multiple entity types in hello same table in client code, see hello section [Working with heterogeneous entity types](#working-with-heterogeneous-entity-types) later in this guide.</span></span> <span data-ttu-id="20a16-434">Cela fournit des exemples de la façon dont toorecognize hello type d’entité dans le code client.</span><span class="sxs-lookup"><span data-stu-id="20a16-434">This provides examples of how toorecognize hello entity type in client code.</span></span>  

## <a name="table-design-patterns"></a><span data-ttu-id="20a16-435">Modèles de conception de table</span><span class="sxs-lookup"><span data-stu-id="20a16-435">Table Design Patterns</span></span>
<span data-ttu-id="20a16-436">Dans les sections précédentes, vous avez vu certaines des descriptions détaillées sur comment toooptimize votre table de conception pour les deux la récupération des données d’entité à l’aide de requêtes et d’insertion, de mise à jour et de suppression des données d’entité.</span><span class="sxs-lookup"><span data-stu-id="20a16-436">In previous sections, you have seen some detailed discussions about how toooptimize your table design for both retrieving entity data using queries and for inserting, updating, and deleting entity data.</span></span> <span data-ttu-id="20a16-437">Cette section décrit certains modèles appropriés pour une utilisation avec des solutions de service de Table.</span><span class="sxs-lookup"><span data-stu-id="20a16-437">This section describes some patterns appropriate for use with Table service solutions.</span></span> <span data-ttu-id="20a16-438">En outre, vous verrez comment vous pouvez pratiquement résoudre certains problèmes de hello et compromis générées précédemment dans ce guide.</span><span class="sxs-lookup"><span data-stu-id="20a16-438">In addition, you will see how you can practically address some of hello issues and trade-offs raised previously in this guide.</span></span> <span data-ttu-id="20a16-439">Hello diagramme suivant résume les relations entre différents modèles d’hello hello :</span><span class="sxs-lookup"><span data-stu-id="20a16-439">hello following diagram summarizes hello relationships between hello different patterns:</span></span>  

![][5]

<span data-ttu-id="20a16-440">mappage de modèle Hello ci-dessus met en évidence des relations entre des modèles (bleus) et anti-modèles (orange) qui sont décrits dans ce guide.</span><span class="sxs-lookup"><span data-stu-id="20a16-440">hello pattern map above highlights some relationships between patterns (blue) and anti-patterns (orange) that are documented in this guide.</span></span> <span data-ttu-id="20a16-441">Il existe bien sûr bien d'autres modèles qui méritent votre attention.</span><span class="sxs-lookup"><span data-stu-id="20a16-441">There are of course many other patterns that are worth considering.</span></span> <span data-ttu-id="20a16-442">Par exemple, un des principaux scénarios de hello pour Service de Table est toouse hello [modèle de vue matérialisée](https://msdn.microsoft.com/library/azure/dn589782.aspx) de hello [répartition de responsabilité requête commande (CQRS)](https://msdn.microsoft.com/library/azure/jj554200.aspx) modèle.</span><span class="sxs-lookup"><span data-stu-id="20a16-442">For example, one of hello key scenarios for Table Service is toouse hello [Materialized View Pattern](https://msdn.microsoft.com/library/azure/dn589782.aspx) from hello [Command Query Responsibility Segregation (CQRS)](https://msdn.microsoft.com/library/azure/jj554200.aspx) pattern.</span></span>  

### <a name="intra-partition-secondary-index-pattern"></a><span data-ttu-id="20a16-443">Modèle d’index secondaire intra-partition</span><span class="sxs-lookup"><span data-stu-id="20a16-443">Intra-partition secondary index pattern</span></span>
<span data-ttu-id="20a16-444">Stocker plusieurs copies de chaque entité à l’aide de différents **RowKey** valeurs (Bonjour même partition) tooenable des recherches rapides et efficaces et tri de substitution des commandes à l’aide de différents **RowKey** valeurs.</span><span class="sxs-lookup"><span data-stu-id="20a16-444">Store multiple copies of each entity using different **RowKey** values (in hello same partition) tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span> <span data-ttu-id="20a16-445">La cohérence des mises à jour entre les copies peut être assurée à l’aide d’une EGT.</span><span class="sxs-lookup"><span data-stu-id="20a16-445">Updates between copies can be kept consistent using EGT's.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="20a16-446">Contexte et problème</span><span class="sxs-lookup"><span data-stu-id="20a16-446">Context and problem</span></span>
<span data-ttu-id="20a16-447">Hello service de Table indexe automatiquement des entités à l’aide de hello **PartitionKey** et **RowKey** valeurs.</span><span class="sxs-lookup"><span data-stu-id="20a16-447">hello Table service automatically indexes entities using hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="20a16-448">Cela permet une tooretrieve d’application client à une entité efficacement à l’aide de ces valeurs.</span><span class="sxs-lookup"><span data-stu-id="20a16-448">This enables a client application tooretrieve an entity efficiently using these values.</span></span> <span data-ttu-id="20a16-449">Par exemple, à l’aide de la structure de la table hello illustré ci-dessous, une application cliente peut utiliser un tooretrieve requête de point d’une entité de l’employé individuel en utilisant le nom du service informatique hello et id d’employé hello (hello **PartitionKey** et  **RowKey** valeurs).</span><span class="sxs-lookup"><span data-stu-id="20a16-449">For example, using hello table structure shown below, a client application can use a point query tooretrieve an individual employee entity by using hello department name and hello employee id (hello **PartitionKey** and **RowKey** values).</span></span> <span data-ttu-id="20a16-450">Un client peut également récupérer des entités, triées par ID d'employé au sein de chaque service.</span><span class="sxs-lookup"><span data-stu-id="20a16-450">A client can also retrieve entities sorted by employee id within each department.</span></span>

![][6]

<span data-ttu-id="20a16-451">Si vous voulez également toofind en mesure de toobe une entité employee en fonction de valeur hello d’une autre propriété, telles que l’adresse de messagerie, vous devez utiliser un toofind d’analyse partition moins efficace une correspondance.</span><span class="sxs-lookup"><span data-stu-id="20a16-451">If you also want toobe able toofind an employee entity based on hello value of another property, such as email address, you must use a less efficient partition scan toofind a match.</span></span> <span data-ttu-id="20a16-452">Il s’agit, car le service de table hello ne fournit pas d’index secondaires.</span><span class="sxs-lookup"><span data-stu-id="20a16-452">This is because hello table service does not provide secondary indexes.</span></span> <span data-ttu-id="20a16-453">En outre, il n’existe aucune option toorequest une liste d’employés triés dans un ordre différent de celui **RowKey** ordre.</span><span class="sxs-lookup"><span data-stu-id="20a16-453">In addition, there is no option toorequest a list of employees sorted in a different order than **RowKey** order.</span></span>  

#### <a name="solution"></a><span data-ttu-id="20a16-454">Solution</span><span class="sxs-lookup"><span data-stu-id="20a16-454">Solution</span></span>
<span data-ttu-id="20a16-455">toowork autour d’un manque de hello d’index secondaires, vous pouvez stocker plusieurs copies de chaque entité avec chaque copie à l’aide d’une autre **RowKey** valeur.</span><span class="sxs-lookup"><span data-stu-id="20a16-455">toowork around hello lack of secondary indexes, you can store multiple copies of each entity with each copy using a different **RowKey** value.</span></span> <span data-ttu-id="20a16-456">Si vous stockez une entité avec les structures hello illustrés ci-dessous, vous pouvez récupérer efficacement des entités employee en fonction de l’id de courrier électronique adresse ou de l’employé. Hello des valeurs de préfixe de hello **RowKey**, « empid_ » et « email_ » permettent tooquery pour un seul employé ou une plage d’employés à l’aide d’une plage d’adresses de messagerie ou l’ID d’employé.</span><span class="sxs-lookup"><span data-stu-id="20a16-456">If you store an entity with hello structures shown below, you can efficiently retrieve employee entities based on email address or employee id. hello prefix values for hello **RowKey**, "empid_" and "email_" enable you tooquery for a single employee or a range of employees by using a range of email addresses or employee ids.</span></span>  

![][7]

<span data-ttu-id="20a16-457">Hello suivant deux critères de filtre (une recherche par id d’employé et une recherche par adresse de messagerie), tous deux spécifient des requêtes de point de :</span><span class="sxs-lookup"><span data-stu-id="20a16-457">hello following two filter criteria (one looking up by employee id and one looking up by email address) both specify point queries:</span></span>  

* <span data-ttu-id="20a16-458">$filter=(PartitionKey eq ’Sales’) and (RowKey eq ’empid_000223’)</span><span class="sxs-lookup"><span data-stu-id="20a16-458">$filter=(PartitionKey eq 'Sales') and (RowKey eq 'empid_000223')</span></span>  
* <span data-ttu-id="20a16-459">$filter=(PartitionKey eq 'Sales') and (RowKey eq email_jonesj@contoso.com</span><span class="sxs-lookup"><span data-stu-id="20a16-459">$filter=(PartitionKey eq 'Sales') and (RowKey eq 'email_jonesj@contoso.com')</span></span>  

<span data-ttu-id="20a16-460">Si vous interrogez pour une plage d’entités de l’employé, vous pouvez spécifier une plage triée dans l’ordre des id employé, ou une plage triée dans l’ordre d’adresse de messagerie en interrogeant des entités avec le préfixe approprié de hello Bonjour **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="20a16-460">If you query for a range of employee entities, you can specify a range sorted in employee id order, or a range sorted in email address order by querying for entities with hello appropriate prefix in hello **RowKey**.</span></span>  

* <span data-ttu-id="20a16-461">l’utilisation de tous les employés hello dans le service des ventes hello avec un id d’employé dans hello plage 000100 too000199 toofind : $filter = (PartitionKey eq 'Sales') et (RowKey ge 'empid_000100') et (le RowKey 'empid_000199')</span><span class="sxs-lookup"><span data-stu-id="20a16-461">toofind all hello employees in hello Sales department with an employee id in hello range 000100 too000199 use: $filter=(PartitionKey eq 'Sales') and (RowKey ge 'empid_000100') and (RowKey le 'empid_000199')</span></span>  
* <span data-ttu-id="20a16-462">toofind tous hello employés du département des ventes hello avec une adresse de messagerie commençant par hello lettre « a » utilisation : $filter = (PartitionKey eq 'Sales') et (RowKey ge 'email_a') et (RowKey lt 'email_b')</span><span class="sxs-lookup"><span data-stu-id="20a16-462">toofind all hello employees in hello Sales department with an email address starting with hello letter 'a' use: $filter=(PartitionKey eq 'Sales') and (RowKey ge 'email_a') and (RowKey lt 'email_b')</span></span>  
  
  <span data-ttu-id="20a16-463">Notez que la syntaxe du filtre hello utilisé dans les exemples hello ci-dessus est hello service de Table API REST, pour plus d’informations, consultez [interroger des entités](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span><span class="sxs-lookup"><span data-stu-id="20a16-463">Note that hello filter syntax used in hello examples above is from hello Table service REST API, for more information see [Query Entities](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="20a16-464">Problèmes et considérations</span><span class="sxs-lookup"><span data-stu-id="20a16-464">Issues and considerations</span></span>
<span data-ttu-id="20a16-465">Prendre en compte les points suivants lorsque vous décidez de hello comment tooimplement ce modèle :</span><span class="sxs-lookup"><span data-stu-id="20a16-465">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="20a16-466">Stockage de table étant relativement peu coûteux toouse hello coût des frais de stockage des données en double ne doit pas être une préoccupation majeure.</span><span class="sxs-lookup"><span data-stu-id="20a16-466">Table storage is relatively cheap toouse so hello cost overhead of storing duplicate data should not be a major concern.</span></span> <span data-ttu-id="20a16-467">Toutefois, vous devez toujours évaluée coût hello de votre conception en fonction de vos besoins de stockage et ajouter uniquement des entités en double toosupport hello requêtes que votre application cliente s’exécute.</span><span class="sxs-lookup"><span data-stu-id="20a16-467">However, you should always evaluate hello cost of your design based on your anticipated storage requirements and only add duplicate entities toosupport hello queries your client application will execute.</span></span>  
* <span data-ttu-id="20a16-468">Entités d’index secondaire hello sont stockées dans hello même partition en tant qu’entités d’origine de hello, vous devez vous assurer que vous ne dépassez pas les objectifs d’évolutivité hello pour une partition individuelle.</span><span class="sxs-lookup"><span data-stu-id="20a16-468">Because hello secondary index entities are stored in hello same partition as hello original entities, you should ensure that you do not exceed hello scalability targets for an individual partition.</span></span>  
* <span data-ttu-id="20a16-469">Vous pouvez conserver vos entités en double cohérents entre eux à l’aide de EGTs tooupdate hello deux des copies de l’entité de hello atomiquement.</span><span class="sxs-lookup"><span data-stu-id="20a16-469">You can keep your duplicate entities consistent with each other by using EGTs tooupdate hello two copies of hello entity atomically.</span></span> <span data-ttu-id="20a16-470">Cela implique que vous devez stocker toutes les copies d’une entité dans hello même partition.</span><span class="sxs-lookup"><span data-stu-id="20a16-470">This implies that you should store all copies of an entity in hello same partition.</span></span> <span data-ttu-id="20a16-471">Pour plus d’informations, consultez la section de hello [à l’aide de Transactions de groupe d’entités](#entity-group-transactions).</span><span class="sxs-lookup"><span data-stu-id="20a16-471">For more information, see hello section [Using Entity Group Transactions](#entity-group-transactions).</span></span>  
* <span data-ttu-id="20a16-472">valeur utilisée pour hello de Hello **RowKey** doit être unique pour chaque entité.</span><span class="sxs-lookup"><span data-stu-id="20a16-472">hello value used for hello **RowKey** must be unique for each entity.</span></span> <span data-ttu-id="20a16-473">Nous vous conseillons d'utiliser des valeurs de clé composée.</span><span class="sxs-lookup"><span data-stu-id="20a16-473">Consider using compound key values.</span></span>  
* <span data-ttu-id="20a16-474">Remplissage des valeurs numériques dans hello **RowKey** (par exemple, id d’employé hello 000223), permet de corriger le tri et de filtrage en fonction des limites supérieures et inférieures.</span><span class="sxs-lookup"><span data-stu-id="20a16-474">Padding numeric values in hello **RowKey** (for example, hello employee id 000223), enables correct sorting and filtering based on upper and lower bounds.</span></span>  
* <span data-ttu-id="20a16-475">Vous ne devez pas nécessairement tooduplicate toutes les propriétés de hello de votre entité.</span><span class="sxs-lookup"><span data-stu-id="20a16-475">You do not necessarily need tooduplicate all hello properties of your entity.</span></span> <span data-ttu-id="20a16-476">Par exemple, si hello requêtes envoyer par courrier électronique des entités hello de recherche à l’aide de hello adressent Bonjour **RowKey** ont jamais besoin d’âge de l’employé hello, ces entités peut avoir hello suivant structure :</span><span class="sxs-lookup"><span data-stu-id="20a16-476">For example, if hello queries that lookup hello entities using hello email address in hello **RowKey** never need hello employee's age, these entities could have hello following structure:</span></span>

![][8]

* <span data-ttu-id="20a16-477">Il est généralement préférable de doublons toostore et vous assurer que vous pouvez récupérer toutes les données hello vous avez besoin d’une seule requête, à toouse une requête toolocate une entité et un autre toolookup hello données requises.</span><span class="sxs-lookup"><span data-stu-id="20a16-477">It is typically better toostore duplicate data and ensure that you can retrieve all hello data you need with a single query, than toouse one query toolocate an entity and another toolookup hello required data.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="20a16-478">Lorsque toouse ce modèle</span><span class="sxs-lookup"><span data-stu-id="20a16-478">When toouse this pattern</span></span>
<span data-ttu-id="20a16-479">Utilisez ce modèle lorsque votre application cliente doit tooretrieve les entités à l’aide d’une variété de clés différentes, lorsque votre client nécessite des entités tooretrieve dans différents ordres de tri, et où vous pouvez identifier chaque entité à une série de valeurs uniques.</span><span class="sxs-lookup"><span data-stu-id="20a16-479">Use this pattern when your client application needs tooretrieve entities using a variety of different keys, when your client needs tooretrieve entities in different sort orders, and where you can identify each entity using a variety of unique values.</span></span> <span data-ttu-id="20a16-480">Toutefois, vous devez être sûr de ne pas dépasser les limites d’extensibilité hello partition lorsque vous effectuez des recherches d’entité à l’aide de la hello différents **RowKey** valeurs.</span><span class="sxs-lookup"><span data-stu-id="20a16-480">However, you should be sure that you do not exceed hello partition scalability limits when you are performing entity lookups using hello different **RowKey** values.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="20a16-481">Conseils et modèles connexes</span><span class="sxs-lookup"><span data-stu-id="20a16-481">Related patterns and guidance</span></span>
<span data-ttu-id="20a16-482">Hello suivantes des modèles et des instructions peuvent également être intéressant lorsque vous implémentez ce modèle :</span><span class="sxs-lookup"><span data-stu-id="20a16-482">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="20a16-483">Modèle d’index secondaire entre les partitions</span><span class="sxs-lookup"><span data-stu-id="20a16-483">Inter-partition secondary index pattern</span></span>](#inter-partition-secondary-index-pattern)
* [<span data-ttu-id="20a16-484">Modèle de clé composée</span><span class="sxs-lookup"><span data-stu-id="20a16-484">Compound key pattern</span></span>](#compound-key-pattern)
* [<span data-ttu-id="20a16-485">Transactions de groupe d’entités</span><span class="sxs-lookup"><span data-stu-id="20a16-485">Entity Group Transactions</span></span>](#entity-group-transactions)
* [<span data-ttu-id="20a16-486">Utilisation des types d’entités hétérogènes</span><span class="sxs-lookup"><span data-stu-id="20a16-486">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)

### <a name="inter-partition-secondary-index-pattern"></a><span data-ttu-id="20a16-487">Modèle d’index secondaire entre les partitions</span><span class="sxs-lookup"><span data-stu-id="20a16-487">Inter-partition secondary index pattern</span></span>
<span data-ttu-id="20a16-488">Stocker plusieurs copies de chaque entité à l’aide de différents **RowKey** valeurs dans des partitions distinctes ou dans les recherches des tables distinctes tooenable rapides et efficaces et ordres de tri secondaires à l’aide de différents **RowKey**valeurs.</span><span class="sxs-lookup"><span data-stu-id="20a16-488">Store multiple copies of each entity using different **RowKey** values in separate partitions or in separate tables tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="20a16-489">Contexte et problème</span><span class="sxs-lookup"><span data-stu-id="20a16-489">Context and problem</span></span>
<span data-ttu-id="20a16-490">Hello service de Table indexe automatiquement des entités à l’aide de hello **PartitionKey** et **RowKey** valeurs.</span><span class="sxs-lookup"><span data-stu-id="20a16-490">hello Table service automatically indexes entities using hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="20a16-491">Cela permet une tooretrieve d’application client à une entité efficacement à l’aide de ces valeurs.</span><span class="sxs-lookup"><span data-stu-id="20a16-491">This enables a client application tooretrieve an entity efficiently using these values.</span></span> <span data-ttu-id="20a16-492">Par exemple, à l’aide de la structure de la table hello illustré ci-dessous, une application cliente peut utiliser un tooretrieve requête de point d’une entité de l’employé individuel en utilisant le nom du service informatique hello et id d’employé hello (hello **PartitionKey** et  **RowKey** valeurs).</span><span class="sxs-lookup"><span data-stu-id="20a16-492">For example, using hello table structure shown below, a client application can use a point query tooretrieve an individual employee entity by using hello department name and hello employee id (hello **PartitionKey** and **RowKey** values).</span></span> <span data-ttu-id="20a16-493">Un client peut également récupérer des entités, triées par ID d'employé au sein de chaque service.</span><span class="sxs-lookup"><span data-stu-id="20a16-493">A client can also retrieve entities sorted by employee id within each department.</span></span>  

![][9]

<span data-ttu-id="20a16-494">Si vous voulez également toofind en mesure de toobe une entité employee en fonction de valeur hello d’une autre propriété, telles que l’adresse de messagerie, vous devez utiliser un toofind d’analyse partition moins efficace une correspondance.</span><span class="sxs-lookup"><span data-stu-id="20a16-494">If you also want toobe able toofind an employee entity based on hello value of another property, such as email address, you must use a less efficient partition scan toofind a match.</span></span> <span data-ttu-id="20a16-495">Il s’agit, car le service de table hello ne fournit pas d’index secondaires.</span><span class="sxs-lookup"><span data-stu-id="20a16-495">This is because hello table service does not provide secondary indexes.</span></span> <span data-ttu-id="20a16-496">En outre, il n’existe aucune option toorequest une liste d’employés triés dans un ordre différent de celui **RowKey** ordre.</span><span class="sxs-lookup"><span data-stu-id="20a16-496">In addition, there is no option toorequest a list of employees sorted in a different order than **RowKey** order.</span></span>  

<span data-ttu-id="20a16-497">Vous comptez un volume très élevé de transactions par rapport à ces entités et que vous souhaitez risque de hello toominimize Hello limitation votre client de service de Table.</span><span class="sxs-lookup"><span data-stu-id="20a16-497">You are anticipating a very high volume of transactions against these entities and want toominimize hello risk of hello Table service throttling your client.</span></span>  

#### <a name="solution"></a><span data-ttu-id="20a16-498">Solution</span><span class="sxs-lookup"><span data-stu-id="20a16-498">Solution</span></span>
<span data-ttu-id="20a16-499">toowork autour d’un manque de hello d’index secondaires, vous pouvez stocker plusieurs copies de chaque entité avec chaque copie à l’aide de différents **PartitionKey** et **RowKey** valeurs.</span><span class="sxs-lookup"><span data-stu-id="20a16-499">toowork around hello lack of secondary indexes, you can store multiple copies of each entity with each copy using different **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="20a16-500">Si vous stockez une entité avec les structures hello illustrés ci-dessous, vous pouvez récupérer efficacement des entités employee en fonction de l’id de courrier électronique adresse ou de l’employé. Hello des valeurs de préfixe de hello **PartitionKey**, « empid_ » et « email_ » permettent de tooidentify qui index que vous souhaitez toouse pour une requête.</span><span class="sxs-lookup"><span data-stu-id="20a16-500">If you store an entity with hello structures shown below, you can efficiently retrieve employee entities based on email address or employee id. hello prefix values for hello **PartitionKey**, "empid_" and "email_" enable you tooidentify which index you want toouse for a query.</span></span>  

![][10]

<span data-ttu-id="20a16-501">Hello suivant deux critères de filtre (une recherche par id d’employé et une recherche par adresse de messagerie), tous deux spécifient des requêtes de point de :</span><span class="sxs-lookup"><span data-stu-id="20a16-501">hello following two filter criteria (one looking up by employee id and one looking up by email address) both specify point queries:</span></span>  

* <span data-ttu-id="20a16-502">$filter=(PartitionKey eq ’empid_Sales’) and (RowKey eq ’000223’)</span><span class="sxs-lookup"><span data-stu-id="20a16-502">$filter=(PartitionKey eq 'empid_Sales') and (RowKey eq '000223')</span></span>
* <span data-ttu-id="20a16-503">$filter=(PartitionKey eq ’email_Sales’) and (RowKey eq jonesj@contoso.com</span><span class="sxs-lookup"><span data-stu-id="20a16-503">$filter=(PartitionKey eq 'email_Sales') and (RowKey eq 'jonesj@contoso.com')</span></span>  

<span data-ttu-id="20a16-504">Si vous interrogez pour une plage d’entités de l’employé, vous pouvez spécifier une plage triée dans l’ordre des id employé, ou une plage triée dans l’ordre d’adresse de messagerie en interrogeant des entités avec le préfixe approprié de hello Bonjour **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="20a16-504">If you query for a range of employee entities, you can specify a range sorted in employee id order, or a range sorted in email address order by querying for entities with hello appropriate prefix in hello **RowKey**.</span></span>  

* <span data-ttu-id="20a16-505">toofind tous hello employés dans hello service des ventes avec un id d’employé dans la plage de hello **000100** trop**000199** triées en cours d’utilisation d’order id employé : $filter = (PartitionKey eq ' empid_Sales') et (RowKey ge ' 000100') et (le RowKey '000199')</span><span class="sxs-lookup"><span data-stu-id="20a16-505">toofind all hello employees in hello Sales department with an employee id in hello range **000100** too**000199** sorted in employee id order use: $filter=(PartitionKey eq 'empid_Sales') and (RowKey ge '000100') and (RowKey le '000199')</span></span>  
* <span data-ttu-id="20a16-506">toofind tous les employés hello dans le service des ventes hello avec une adresse de messagerie qui commence par « a » dans Utilisation de commande d’adresse de messagerie : $filter = (PartitionKey eq ' email_Sales') et (RowKey ge 'a') et (RowKey lt 'b')</span><span class="sxs-lookup"><span data-stu-id="20a16-506">toofind all hello employees in hello Sales department with an email address that starts with 'a' sorted in email address order use: $filter=(PartitionKey eq 'email_Sales') and (RowKey ge 'a') and (RowKey lt 'b')</span></span>  

<span data-ttu-id="20a16-507">Notez que la syntaxe du filtre hello utilisé dans les exemples hello ci-dessus est hello service de Table API REST, pour plus d’informations, consultez [interroger des entités](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span><span class="sxs-lookup"><span data-stu-id="20a16-507">Note that hello filter syntax used in hello examples above is from hello Table service REST API, for more information see [Query Entities](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="20a16-508">Problèmes et considérations</span><span class="sxs-lookup"><span data-stu-id="20a16-508">Issues and considerations</span></span>
<span data-ttu-id="20a16-509">Prendre en compte les points suivants lorsque vous décidez de hello comment tooimplement ce modèle :</span><span class="sxs-lookup"><span data-stu-id="20a16-509">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="20a16-510">Vous pouvez conserver vos entités en double cohérente entre eux à l’aide de hello [modèle de transactions cohérente](#eventually-consistent-transactions-pattern) entités de toomaintain hello index primaires et secondaires.</span><span class="sxs-lookup"><span data-stu-id="20a16-510">You can keep your duplicate entities eventually consistent with each other by using hello [Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) toomaintain hello primary and secondary index entities.</span></span>  
* <span data-ttu-id="20a16-511">Stockage de table étant relativement peu coûteux toouse hello coût des frais de stockage des données en double ne doit pas être une préoccupation majeure.</span><span class="sxs-lookup"><span data-stu-id="20a16-511">Table storage is relatively cheap toouse so hello cost overhead of storing duplicate data should not be a major concern.</span></span> <span data-ttu-id="20a16-512">Toutefois, vous devez toujours évaluée coût hello de votre conception en fonction de vos besoins de stockage et ajouter uniquement des entités en double toosupport hello requêtes que votre application cliente s’exécute.</span><span class="sxs-lookup"><span data-stu-id="20a16-512">However, you should always evaluate hello cost of your design based on your anticipated storage requirements and only add duplicate entities toosupport hello queries your client application will execute.</span></span>  
* <span data-ttu-id="20a16-513">valeur utilisée pour hello de Hello **RowKey** doit être unique pour chaque entité.</span><span class="sxs-lookup"><span data-stu-id="20a16-513">hello value used for hello **RowKey** must be unique for each entity.</span></span> <span data-ttu-id="20a16-514">Nous vous conseillons d'utiliser des valeurs de clé composée.</span><span class="sxs-lookup"><span data-stu-id="20a16-514">Consider using compound key values.</span></span>  
* <span data-ttu-id="20a16-515">Remplissage des valeurs numériques dans hello **RowKey** (par exemple, id d’employé hello 000223), permet de corriger le tri et de filtrage en fonction des limites supérieures et inférieures.</span><span class="sxs-lookup"><span data-stu-id="20a16-515">Padding numeric values in hello **RowKey** (for example, hello employee id 000223), enables correct sorting and filtering based on upper and lower bounds.</span></span>  
* <span data-ttu-id="20a16-516">Vous ne devez pas nécessairement tooduplicate toutes les propriétés de hello de votre entité.</span><span class="sxs-lookup"><span data-stu-id="20a16-516">You do not necessarily need tooduplicate all hello properties of your entity.</span></span> <span data-ttu-id="20a16-517">Par exemple, si hello requêtes envoyer par courrier électronique des entités hello de recherche à l’aide de hello adressent Bonjour **RowKey** ont jamais besoin d’âge de l’employé hello, ces entités peut avoir hello suivant structure :</span><span class="sxs-lookup"><span data-stu-id="20a16-517">For example, if hello queries that lookup hello entities using hello email address in hello **RowKey** never need hello employee's age, these entities could have hello following structure:</span></span>
  
  ![][11]
* <span data-ttu-id="20a16-518">Il est généralement une meilleure toostore des données en double et vous assurer que vous pouvez récupérer toutes les données hello que vous avez besoin d’une requête unique que toolocate d’une requête toouse une entité à l’aide de hello index secondaire et un autre toolookup hello les données requises dans les index primaire hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-518">It is typically better toostore duplicate data and ensure that you can retrieve all hello data you need with a single query than toouse one query toolocate an entity using hello secondary index and another toolookup hello required data in hello primary index.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="20a16-519">Lorsque toouse ce modèle</span><span class="sxs-lookup"><span data-stu-id="20a16-519">When toouse this pattern</span></span>
<span data-ttu-id="20a16-520">Utilisez ce modèle lorsque votre application cliente doit tooretrieve les entités à l’aide d’une variété de clés différentes, lorsque votre client nécessite des entités tooretrieve dans différents ordres de tri, et où vous pouvez identifier chaque entité à une série de valeurs uniques.</span><span class="sxs-lookup"><span data-stu-id="20a16-520">Use this pattern when your client application needs tooretrieve entities using a variety of different keys, when your client needs tooretrieve entities in different sort orders, and where you can identify each entity using a variety of unique values.</span></span> <span data-ttu-id="20a16-521">Utilisez ce modèle lorsque vous souhaitez tooavoid dépassement des limites de l’évolutivité de partition hello lorsque vous effectuez des recherches d’entité à l’aide de la hello différents **RowKey** valeurs.</span><span class="sxs-lookup"><span data-stu-id="20a16-521">Use this pattern when you want tooavoid exceeding hello partition scalability limits when you are performing entity lookups using hello different **RowKey** values.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="20a16-522">Conseils et modèles connexes</span><span class="sxs-lookup"><span data-stu-id="20a16-522">Related patterns and guidance</span></span>
<span data-ttu-id="20a16-523">Hello suivantes des modèles et des instructions peuvent également être intéressant lorsque vous implémentez ce modèle :</span><span class="sxs-lookup"><span data-stu-id="20a16-523">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="20a16-524">Modèle de transactions cohérentes</span><span class="sxs-lookup"><span data-stu-id="20a16-524">Eventually consistent transactions pattern</span></span>](#eventually-consistent-transactions-pattern)  
* [<span data-ttu-id="20a16-525">Modèle d’index secondaire intra-partition</span><span class="sxs-lookup"><span data-stu-id="20a16-525">Intra-partition secondary index pattern</span></span>](#intra-partition-secondary-index-pattern)  
* [<span data-ttu-id="20a16-526">Modèle de clé composée</span><span class="sxs-lookup"><span data-stu-id="20a16-526">Compound key pattern</span></span>](#compound-key-pattern)  
* [<span data-ttu-id="20a16-527">Transactions de groupe d’entités</span><span class="sxs-lookup"><span data-stu-id="20a16-527">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="20a16-528">Utilisation des types d’entités hétérogènes</span><span class="sxs-lookup"><span data-stu-id="20a16-528">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)  

### <a name="eventually-consistent-transactions-pattern"></a><span data-ttu-id="20a16-529">Modèle de transactions cohérentes</span><span class="sxs-lookup"><span data-stu-id="20a16-529">Eventually consistent transactions pattern</span></span>
<span data-ttu-id="20a16-530">Permet de conserver un comportement cohérent entre les limites de partition ou les limites du système de stockage à l'aide des files d'attente Azure.</span><span class="sxs-lookup"><span data-stu-id="20a16-530">Enable eventually consistent behavior across partition boundaries or storage system boundaries by using Azure queues.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="20a16-531">Contexte et problème</span><span class="sxs-lookup"><span data-stu-id="20a16-531">Context and problem</span></span>
<span data-ttu-id="20a16-532">EGTs activer les transactions atomiques entre plusieurs entités qui partagent hello même clé de partition.</span><span class="sxs-lookup"><span data-stu-id="20a16-532">EGTs enable atomic transactions across multiple entities that share hello same partition key.</span></span> <span data-ttu-id="20a16-533">Pour des raisons d’évolutivité et des performances, vous pouvez décider d’entités toostore qui ont des exigences de cohérence dans des partitions distinctes ou dans un système de stockage distincts : dans ce scénario, vous ne pouvez pas utiliser EGTs toomaintain cohérence.</span><span class="sxs-lookup"><span data-stu-id="20a16-533">For performance and scalability reasons, you might decide toostore entities that have consistency requirements in separate partitions or in a separate storage system: in such a scenario, you cannot use EGTs toomaintain consistency.</span></span> <span data-ttu-id="20a16-534">Par exemple, peut avoir une cohérence éventuelle de toomaintain exigence entre :</span><span class="sxs-lookup"><span data-stu-id="20a16-534">For example, you might have a requirement toomaintain eventual consistency between:</span></span>  

* <span data-ttu-id="20a16-535">Entités stockées dans deux partitions différentes dans la même table, dans des tables différentes, dans différents comptes de stockage de hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-535">Entities stored in two different partitions in hello same table, in different tables, in in different storage accounts.</span></span>  
* <span data-ttu-id="20a16-536">Une entité stockées Bonjour service de Table et un objet blob dans hello service Blob.</span><span class="sxs-lookup"><span data-stu-id="20a16-536">An entity stored in hello Table service and a blob stored in hello Blob service.</span></span>  
* <span data-ttu-id="20a16-537">Une entité est stockée dans le service de Table hello et un fichier dans un système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="20a16-537">An entity stored in hello Table service and a file in a file system.</span></span>  
* <span data-ttu-id="20a16-538">Une entité stocker Bonjour service de Table encore indexées à l’aide du service Azure Search de hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-538">An entity store in hello Table service yet indexed using hello Azure Search service.</span></span>  

#### <a name="solution"></a><span data-ttu-id="20a16-539">Solution</span><span class="sxs-lookup"><span data-stu-id="20a16-539">Solution</span></span>
<span data-ttu-id="20a16-540">À l'aide des files d'attente Azure, vous pouvez implémenter une solution cohérente entre plusieurs partitions ou systèmes de stockage.</span><span class="sxs-lookup"><span data-stu-id="20a16-540">By using Azure queues, you can implement a solution that delivers eventual consistency across two or more partitions or storage systems.</span></span>
<span data-ttu-id="20a16-541">tooillustrate cette approche, vous possédez une exigence toobe tooarchive en mesure d’anciennes employé entités.</span><span class="sxs-lookup"><span data-stu-id="20a16-541">tooillustrate this approach, assume you have a requirement toobe able tooarchive old employee entities.</span></span> <span data-ttu-id="20a16-542">Les anciennes entités d'employés sont rarement interrogées et doivent être exclues de toutes les activités impliquant des employés actuels.</span><span class="sxs-lookup"><span data-stu-id="20a16-542">Old employee entities are rarely queried and should be excluded from any activities that deal with current employees.</span></span> <span data-ttu-id="20a16-543">tooimplement cette exigence, vous stockez les employés actifs dans hello **actuel** table et les anciens employés Bonjour **Archive** table.</span><span class="sxs-lookup"><span data-stu-id="20a16-543">tooimplement this requirement you store active employees in hello **Current** table and old employees in hello **Archive** table.</span></span> <span data-ttu-id="20a16-544">L’archivage d’un employé nécessite que vous toodelete entité hello hello **actuel** de table et ajouter hello entité toohello **Archive** table, mais vous ne pouvez pas utiliser un tooperform EGT ces deux opérations.</span><span class="sxs-lookup"><span data-stu-id="20a16-544">Archiving an employee requires you toodelete hello entity from hello **Current** table and add hello entity toohello **Archive** table, but you cannot use an EGT tooperform these two operations.</span></span> <span data-ttu-id="20a16-545">risque de hello tooavoid qu’une défaillance, une entité tooappear dans les deux ou aucune des tables, l’opération d’archivage hello doit être cohérente.</span><span class="sxs-lookup"><span data-stu-id="20a16-545">tooavoid hello risk that a failure causes an entity tooappear in both or neither tables, hello archive operation must be eventually consistent.</span></span> <span data-ttu-id="20a16-546">Hello diagramme de séquence suivant décrit les étapes de hello dans cette opération.</span><span class="sxs-lookup"><span data-stu-id="20a16-546">hello following sequence diagram outlines hello steps in this operation.</span></span> <span data-ttu-id="20a16-547">Informations supplémentaires sont disponibles pour les chemins d’accès de l’exception suivante du texte hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-547">More detail is provided for exception paths in hello text following.</span></span>  

![][12]

<span data-ttu-id="20a16-548">Un client lance une opération d’archivage hello en plaçant un message dans une file d’attente Azure, dans cet employé de tooarchive exemple #456.</span><span class="sxs-lookup"><span data-stu-id="20a16-548">A client initiates hello archive operation by placing a message on an Azure queue, in this example tooarchive employee #456.</span></span> <span data-ttu-id="20a16-549">Un rôle de travail interroge la file d’attente hello pour les nouveaux messages ; Lorsqu’il trouve un, il lit le message de type hello et laisse une copie masquée sur la file d’attente hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-549">A worker role polls hello queue for new messages; when it finds one, it reads hello message and leaves a hidden copy on hello queue.</span></span> <span data-ttu-id="20a16-550">rôle de travail Hello extrait ensuite une copie de l’entité de hello hello **actuel** table, insère une copie Bonjour **Archive** table, puis hello suppressions d’origine à partir de hello **actuel**table.</span><span class="sxs-lookup"><span data-stu-id="20a16-550">hello worker role next fetches a copy of hello entity from hello **Current** table, inserts a copy in hello **Archive** table, and then deletes hello original from hello **Current** table.</span></span> <span data-ttu-id="20a16-551">Enfin, s’il n’y a aucuns erreurs des étapes précédentes de hello, rôle de travail hello supprime message de type hello masqué à partir de la file d’attente hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-551">Finally, if there were no errors from hello previous steps, hello worker role deletes hello hidden message from hello queue.</span></span>  

<span data-ttu-id="20a16-552">Dans cet exemple, l’étape 4 insère employé de hello hello **Archive** table.</span><span class="sxs-lookup"><span data-stu-id="20a16-552">In this example, step 4 inserts hello employee into hello **Archive** table.</span></span> <span data-ttu-id="20a16-553">Il peut ajouter hello employé tooa objet blob dans hello service Blob ou un fichier dans un système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="20a16-553">It could add hello employee tooa blob in hello Blob service or a file in a file system.</span></span>  

#### <a name="recovering-from-failures"></a><span data-ttu-id="20a16-554">Récupération après échec</span><span class="sxs-lookup"><span data-stu-id="20a16-554">Recovering from failures</span></span>
<span data-ttu-id="20a16-555">Il est important que hello opérations dans les étapes **4** et **5** doit être *idempotent* au cas où l’opération d’archivage hello toorestart a besoin de rôle de travail hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-555">It is important that hello operations in steps **4** and **5** must be *idempotent* in case hello worker role needs toorestart hello archive operation.</span></span> <span data-ttu-id="20a16-556">Si vous utilisez le service de Table hello, de l’étape **4** vous devez utiliser une opération « Insérer ou remplacer » ; pour l’étape **5** vous devez utiliser un « supprimer si existe « opération dans la bibliothèque cliente de hello que vous utilisez.</span><span class="sxs-lookup"><span data-stu-id="20a16-556">If you are using hello Table service, for step **4** you should use an "insert or replace" operation; for step **5** you should use a "delete if exists" operation in hello client library you are using.</span></span> <span data-ttu-id="20a16-557">Si vous utilisez un autre système de stockage, vous devez utiliser une opération idempotent appropriée.</span><span class="sxs-lookup"><span data-stu-id="20a16-557">If you are using another storage system, you must use an appropriate idempotent operation.</span></span>  

<span data-ttu-id="20a16-558">Si le rôle de travail hello ne termine jamais étape **6**, puis une fois que vous continuez à recevoir un message de type hello du délai d’attente sur la file d’attente hello préparer pour hello travail rôle tootry tooreprocess.</span><span class="sxs-lookup"><span data-stu-id="20a16-558">If hello worker role never completes step **6**, then after a timeout hello message reappears on hello queue ready for hello worker role tootry tooreprocess it.</span></span> <span data-ttu-id="20a16-559">rôle de travail Hello peut vérifier le nombre de fois où un message sur la file d’attente hello a été lu et, si nécessaire, indicateur, il est un message « incohérent » un examen plus approfondi en l’envoyant tooa séparer la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="20a16-559">hello worker role can check how many times a message on hello queue has been read and, if necessary, flag it is a "poison" message for investigation by sending it tooa separate queue.</span></span> <span data-ttu-id="20a16-560">Pour plus d’informations sur la lecture de messages de la file d’attente et la vérification hello dequeue count, consultez [Get Messages](https://msdn.microsoft.com/library/azure/dd179474.aspx).</span><span class="sxs-lookup"><span data-stu-id="20a16-560">For more information about reading queue messages and checking hello dequeue count, see [Get Messages](https://msdn.microsoft.com/library/azure/dd179474.aspx).</span></span>  

<span data-ttu-id="20a16-561">Certaines erreurs à partir des services de Table et de la file d’attente hello sont des erreurs temporaires et votre application cliente doit inclure toohandle logique de nouvelle tentative approprié les.</span><span class="sxs-lookup"><span data-stu-id="20a16-561">Some errors from hello Table and Queue services are transient errors, and your client application should include suitable retry logic toohandle them.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="20a16-562">Problèmes et considérations</span><span class="sxs-lookup"><span data-stu-id="20a16-562">Issues and considerations</span></span>
<span data-ttu-id="20a16-563">Prendre en compte les points suivants lorsque vous décidez de hello comment tooimplement ce modèle :</span><span class="sxs-lookup"><span data-stu-id="20a16-563">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="20a16-564">Cette solution ne fournit pas d'isolation des transactions.</span><span class="sxs-lookup"><span data-stu-id="20a16-564">This solution does not provide for transaction isolation.</span></span> <span data-ttu-id="20a16-565">Par exemple, un client peut lire hello **actuel** et **Archive** tables lorsque le rôle de travail hello s’est produit entre les étapes **4** et **5**et consultez un vue incohérente des données de hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-565">For example, a client could read hello **Current** and **Archive** tables when hello worker role was between steps **4** and **5**, and see an inconsistent view of hello data.</span></span> <span data-ttu-id="20a16-566">Notez que les données de salutation sera cohérentes par la suite.</span><span class="sxs-lookup"><span data-stu-id="20a16-566">Note that hello data will be consistent eventually.</span></span>  
* <span data-ttu-id="20a16-567">Il se peut que vous devez vous assurer que les étapes 4 et 5 sont idempotents dans cohérence éventuelle tooensure de commande.</span><span class="sxs-lookup"><span data-stu-id="20a16-567">You must be sure that steps 4 and 5 are idempotent in order tooensure eventual consistency.</span></span>  
* <span data-ttu-id="20a16-568">Vous pouvez adapter la solution de hello à l’aide de plusieurs files d’attente et les instances de rôle de travail.</span><span class="sxs-lookup"><span data-stu-id="20a16-568">You can scale hello solution by using multiple queues and worker role instances.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="20a16-569">Lorsque toouse ce modèle</span><span class="sxs-lookup"><span data-stu-id="20a16-569">When toouse this pattern</span></span>
<span data-ttu-id="20a16-570">Utilisez ce modèle lorsque vous souhaitez que la cohérence éventuelle de tooguarantee entre des entités qui existent dans différentes partitions ou tables.</span><span class="sxs-lookup"><span data-stu-id="20a16-570">Use this pattern when you want tooguarantee eventual consistency between entities that exist in different partitions or tables.</span></span> <span data-ttu-id="20a16-571">Vous pouvez étendre cette cohérence éventuelle tooensure de modèle pour les opérations sur le service de Table hello et service d’objets Blob hello et autres sources de données non - Azure Storage comme système de fichiers de base de données ou hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-571">You can extend this pattern tooensure eventual consistency for operations across hello Table service and hello Blob service and other non-Azure Storage data sources such as database or hello file system.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="20a16-572">Conseils et modèles connexes</span><span class="sxs-lookup"><span data-stu-id="20a16-572">Related patterns and guidance</span></span>
<span data-ttu-id="20a16-573">Hello suivantes des modèles et des instructions peuvent également être intéressant lorsque vous implémentez ce modèle :</span><span class="sxs-lookup"><span data-stu-id="20a16-573">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="20a16-574">Transactions de groupe d’entités</span><span class="sxs-lookup"><span data-stu-id="20a16-574">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="20a16-575">Fusion ou remplacement</span><span class="sxs-lookup"><span data-stu-id="20a16-575">Merge or replace</span></span>](#merge-or-replace)  

> [!NOTE]
> <span data-ttu-id="20a16-576">Si l’isolation des transactions est importante tooyour solution, vous devez envisager de reconcevoir votre tooenable de tables vous toouse EGTs.</span><span class="sxs-lookup"><span data-stu-id="20a16-576">If transaction isolation is important tooyour solution, you should consider redesigning your tables tooenable you toouse EGTs.</span></span>  
> 
> 

### <a name="index-entities-pattern"></a><span data-ttu-id="20a16-577">Modèle d’entités d’index</span><span class="sxs-lookup"><span data-stu-id="20a16-577">Index Entities Pattern</span></span>
<span data-ttu-id="20a16-578">Mettre à jour les index entités tooenable recherches efficaces qui retournent les listes des entités.</span><span class="sxs-lookup"><span data-stu-id="20a16-578">Maintain index entities tooenable efficient searches that return lists of entities.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="20a16-579">Contexte et problème</span><span class="sxs-lookup"><span data-stu-id="20a16-579">Context and problem</span></span>
<span data-ttu-id="20a16-580">Hello service de Table indexe automatiquement des entités à l’aide de hello **PartitionKey** et **RowKey** valeurs.</span><span class="sxs-lookup"><span data-stu-id="20a16-580">hello Table service automatically indexes entities using hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="20a16-581">Cela permet une tooretrieve d’application client une entité efficacement à l’aide d’une requête de point.</span><span class="sxs-lookup"><span data-stu-id="20a16-581">This enables a client application tooretrieve an entity efficiently using a point query.</span></span> <span data-ttu-id="20a16-582">Par exemple, à l’aide de la structure de la table hello illustré ci-dessous, une application cliente peut récupérer une entité employee individuels en utilisant le nom du service informatique hello et id d’employé hello (hello **PartitionKey** et **RowKey** ).</span><span class="sxs-lookup"><span data-stu-id="20a16-582">For example, using hello table structure shown below, a client application can efficiently retrieve an individual employee entity by using hello department name and hello employee id (hello **PartitionKey** and **RowKey**).</span></span>  

![][13]

<span data-ttu-id="20a16-583">Si vous voulez également tooretrieve en mesure de toobe une liste des entités de l’employé en fonction de la valeur hello d’une autre propriété non uniques, telles que son nom, vous devez utiliser une partition moins efficace analyse toofind correspondances au lieu d’utiliser un index toolook les configurer directement.</span><span class="sxs-lookup"><span data-stu-id="20a16-583">If you also want toobe able tooretrieve a list of employee entities based on hello value of another non-unique property, such as their last name, you must use a less efficient partition scan toofind matches rather than using an index toolook them up directly.</span></span> <span data-ttu-id="20a16-584">Il s’agit, car le service de table hello ne fournit pas d’index secondaires.</span><span class="sxs-lookup"><span data-stu-id="20a16-584">This is because hello table service does not provide secondary indexes.</span></span>  

#### <a name="solution"></a><span data-ttu-id="20a16-585">Solution</span><span class="sxs-lookup"><span data-stu-id="20a16-585">Solution</span></span>
<span data-ttu-id="20a16-586">recherche de tooenable par nom avec structure d’entité hello illustrée ci-dessus, vous devez gérer des listes d’ID d’employé.</span><span class="sxs-lookup"><span data-stu-id="20a16-586">tooenable lookup by last name with hello entity structure shown above, you must maintain lists of employee ids.</span></span> <span data-ttu-id="20a16-587">Si vous souhaitez que les entités tooretrieve hello employé avec un nom donné, tels que Jones, vous devez d’abord localiser liste hello des ID d’employés pour les employés Jones comme leur nom et puis d’extraire ces entités employé.</span><span class="sxs-lookup"><span data-stu-id="20a16-587">If you want tooretrieve hello employee entities with a particular last name, such as Jones, you must first locate hello list of employee ids for employees with Jones as their last name, and then retrieve those employee entities.</span></span> <span data-ttu-id="20a16-588">Il existe trois options principales pour le stockage des listes hello d’ID d’employé :</span><span class="sxs-lookup"><span data-stu-id="20a16-588">There are three main options for storing hello lists of employee ids:</span></span>  

* <span data-ttu-id="20a16-589">Le stockage d'objets blob.</span><span class="sxs-lookup"><span data-stu-id="20a16-589">Use blob storage.</span></span>  
* <span data-ttu-id="20a16-590">Créer des entités de l’index dans hello même partition en tant qu’entités d’employé hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-590">Create index entities in hello same partition as hello employee entities.</span></span>  
* <span data-ttu-id="20a16-591">La création d'entités d'index dans une table ou une partition séparée.</span><span class="sxs-lookup"><span data-stu-id="20a16-591">Create index entities in a separate partition or table.</span></span>  

<span data-ttu-id="20a16-592"><u>Méthode nº 1 : stockage d’objets blob</u></span><span class="sxs-lookup"><span data-stu-id="20a16-592"><u>Option #1: Use blob storage</u></span></span>  

<span data-ttu-id="20a16-593">Pour la première option de hello, vous créez un objet blob pour chaque nom unique et chaque magasin d’objets blob une liste de hello **PartitionKey** (service) et **RowKey** valeurs (id d’employé) pour les employés qui ont ce dernier. nom.</span><span class="sxs-lookup"><span data-stu-id="20a16-593">For hello first option, you create a blob for every unique last name, and in each blob store a list of hello **PartitionKey** (department) and **RowKey** (employee id) values for employees that have that last name.</span></span> <span data-ttu-id="20a16-594">Lorsque vous ajoutez ou supprimez un employé, vous devez vous assurer que contenu hello du blob pertinentes de hello est cohérent avec les entités d’employé hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-594">When you add or delete an employee you should ensure that hello content of hello relevant blob is eventually consistent with hello employee entities.</span></span>  

<span data-ttu-id="20a16-595"><u>Option #2 :</u> entités Create index hello même partition</span><span class="sxs-lookup"><span data-stu-id="20a16-595"><u>Option #2:</u> Create index entities in hello same partition</span></span>  

<span data-ttu-id="20a16-596">Pour la deuxième option de hello, utilisez les entités index qui stockent les données suivantes de hello :</span><span class="sxs-lookup"><span data-stu-id="20a16-596">For hello second option, use index entities that store hello following data:</span></span>  

![][14]

<span data-ttu-id="20a16-597">Hello **EmployeeIDs** propriété contient une liste des ID d’employés pour les employés avec nom hello stockée Bonjour **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="20a16-597">hello **EmployeeIDs** property contains a list of employee ids for employees with hello last name stored in hello **RowKey**.</span></span>  

<span data-ttu-id="20a16-598">Hello étapes suivantes décrivent les processus hello que vous devez suivre lorsque vous ajoutez un nouvel employé si vous utilisez la deuxième option de hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-598">hello following steps outline hello process you should follow when you are adding a new employee if you are using hello second option.</span></span> <span data-ttu-id="20a16-599">Dans cet exemple, nous ajoutons un employé avec l’Id 000152 et un nom de famille Jones dans le service des ventes hello :</span><span class="sxs-lookup"><span data-stu-id="20a16-599">In this example, we are adding an employee with Id 000152 and a last name Jones in hello Sales department:</span></span>  

1. <span data-ttu-id="20a16-600">Récupérer l’entité d’index hello avec un **PartitionKey** de valeur « Ventes » et hello **RowKey** valeur « Jones ».</span><span class="sxs-lookup"><span data-stu-id="20a16-600">Retrieve hello index entity with a **PartitionKey** value "Sales" and hello **RowKey** value "Jones."</span></span> <span data-ttu-id="20a16-601">Enregistrez hello ETag de toouse de cette entité à l’étape 2.</span><span class="sxs-lookup"><span data-stu-id="20a16-601">Save hello ETag of this entity toouse in step 2.</span></span>  
2. <span data-ttu-id="20a16-602">Créer une transaction de groupe d’entités (autrement dit, une opération de traitement par lots) qui insère l’entité employee hello (**PartitionKey** valeur « Ventes » et **RowKey** valeur « 000152 »), et les mises à jour hello entité d’index ( **PartitionKey** valeur « Ventes » et **RowKey** valeur « Jones ») en ajoutant hello nouvelle employee id toohello liste hello EmployeeIDs champ.</span><span class="sxs-lookup"><span data-stu-id="20a16-602">Create an entity group transaction (that is, a batch operation) that inserts hello new employee entity (**PartitionKey** value "Sales" and **RowKey** value "000152"), and updates hello index entity (**PartitionKey** value "Sales" and **RowKey** value "Jones") by adding hello new employee id toohello list in hello EmployeeIDs field.</span></span> <span data-ttu-id="20a16-603">Pour plus d’informations sur les transactions de groupe d’entités, consultez [Transactions de groupe d’entités](#entity-group-transactions).</span><span class="sxs-lookup"><span data-stu-id="20a16-603">For more information about entity group transactions, see [Entity Group Transactions](#entity-group-transactions).</span></span>  
3. <span data-ttu-id="20a16-604">Si la transaction de groupe d’entités hello échoue en raison d’une erreur d’accès concurrentiel optimiste (quelqu'un d’autre a modifié uniquement l’entité d’index hello), vous devez toostart sur à l’étape 1 à nouveau.</span><span class="sxs-lookup"><span data-stu-id="20a16-604">If hello entity group transaction fails because of an optimistic concurrency error (someone else has just modified hello index entity), then you need toostart over at step 1 again.</span></span>  

<span data-ttu-id="20a16-605">Vous pouvez utiliser un toodeleting approche similaire employé si vous utilisez la deuxième option de hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-605">You can use a similar approach toodeleting an employee if you are using hello second option.</span></span> <span data-ttu-id="20a16-606">La modification du nom d’un employé est légèrement plus complexe, car vous devez tooexecute une transaction de groupe d’entités qui met à jour les trois entités : hello entité employee, hello index pour nom ancienne hello et hello index pour hello nouveau nom.</span><span class="sxs-lookup"><span data-stu-id="20a16-606">Changing an employee's last name is slightly more complex because you will need tooexecute an entity group transaction that updates three entities: hello employee entity, hello index entity for hello old last name, and hello index entity for hello new last name.</span></span> <span data-ttu-id="20a16-607">Vous devez extraire chaque entité avant d’apporter toutes les modifications dans l’ordre des valeurs d’ETag hello tooretrieve que vous pouvez ensuite utiliser les mises à jour de hello tooperform à l’aide de l’accès concurrentiel optimiste.</span><span class="sxs-lookup"><span data-stu-id="20a16-607">You must retrieve each entity before making any changes in order tooretrieve hello ETag values that you can then use tooperform hello updates using optimistic concurrency.</span></span>  

<span data-ttu-id="20a16-608">Hello étapes suivantes décrivent les processus hello que vous devez suivre lorsque vous avez besoin de toolook de tous les employés hello avec un nom donné dans un service si vous utilisez la deuxième option de hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-608">hello following steps outline hello process you should follow when you need toolook up all hello employees with a given last name in a department if you are using hello second option.</span></span> <span data-ttu-id="20a16-609">Dans cet exemple, nous recherchons les tous les employés hello avec le nom de famille Jones dans le service des ventes hello :</span><span class="sxs-lookup"><span data-stu-id="20a16-609">In this example, we are looking up all hello employees with last name Jones in hello Sales department:</span></span>  

1. <span data-ttu-id="20a16-610">Récupérer l’entité d’index hello avec un **PartitionKey** de valeur « Ventes » et hello **RowKey** valeur « Jones ».</span><span class="sxs-lookup"><span data-stu-id="20a16-610">Retrieve hello index entity with a **PartitionKey** value "Sales" and hello **RowKey** value "Jones."</span></span>  
2. <span data-ttu-id="20a16-611">Analyser la liste hello des identificateurs dans le champ de EmployeeIDs hello des employés.</span><span class="sxs-lookup"><span data-stu-id="20a16-611">Parse hello list of employee Ids in hello EmployeeIDs field.</span></span>  
3. <span data-ttu-id="20a16-612">Si vous avez besoin des informations supplémentaires sur chacun de ces employés (par exemple, leurs adresses de messagerie), extraire chacune des entités d’employé hello à l’aide de **PartitionKey** valeur « Ventes » et **RowKey** les valeurs à partir de liste Hello d’employés obtenu à l’étape 2.</span><span class="sxs-lookup"><span data-stu-id="20a16-612">If you need additional information about each of these employees (such as their email addresses), retrieve each of hello employee entities using **PartitionKey** value "Sales" and **RowKey** values from hello list of employees you obtained in step 2.</span></span>  

<span data-ttu-id="20a16-613"><u>Méthode nº 3 :</u> création d’entités d’index dans une table ou une partition séparée</span><span class="sxs-lookup"><span data-stu-id="20a16-613"><u>Option #3:</u> Create index entities in a separate partition or table</span></span>  

<span data-ttu-id="20a16-614">Pour la troisième option de hello, utilisez les entités index qui stockent les données suivantes de hello :</span><span class="sxs-lookup"><span data-stu-id="20a16-614">For hello third option, use index entities that store hello following data:</span></span>  

![][15]

<span data-ttu-id="20a16-615">Hello **EmployeeIDs** propriété contient une liste des ID d’employés pour les employés avec nom hello stockée Bonjour **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="20a16-615">hello **EmployeeIDs** property contains a list of employee ids for employees with hello last name stored in hello **RowKey**.</span></span>  

<span data-ttu-id="20a16-616">Avec l’option de tiers hello, vous ne pouvez pas utiliser EGTs toomaintain cohérence hello index entités étant dans une partition distincte à partir des entités employé hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-616">With hello third option, you cannot use EGTs toomaintain consistency because hello index entities are in a separate partition from hello employee entities.</span></span> <span data-ttu-id="20a16-617">Vous devez vous assurer que les entités index hello cohérentes avec les entités d’employé hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-617">You should ensure that hello index entities are eventually consistent with hello employee entities.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="20a16-618">Problèmes et considérations</span><span class="sxs-lookup"><span data-stu-id="20a16-618">Issues and considerations</span></span>
<span data-ttu-id="20a16-619">Prendre en compte les points suivants lorsque vous décidez de hello comment tooimplement ce modèle :</span><span class="sxs-lookup"><span data-stu-id="20a16-619">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="20a16-620">Cette solution requiert tooretrieve au moins deux requêtes correspondance entités : un tooquery hello index liste les entités tooobtain hello de **RowKey** de valeurs et interroge ensuite tooretrieve chaque entité dans la liste de hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-620">This solution requires at least two queries tooretrieve matching entities: one tooquery hello index entities tooobtain hello list of **RowKey** values, and then queries tooretrieve each entity in hello list.</span></span>  
* <span data-ttu-id="20a16-621">Étant donné qu’une entité individuelle a une taille maximale de 1 Mo, option #2 et l’option #3 dans la solution de hello supposent que liste hello des ID d’employés pour n’importe quel nom donné n’est jamais supérieure à 1 Mo.</span><span class="sxs-lookup"><span data-stu-id="20a16-621">Given that an individual entity has a maximum size of 1 MB, option #2 and option #3 in hello solution assume that hello list of employee ids for any given last name is never greater than 1 MB.</span></span> <span data-ttu-id="20a16-622">Si la liste hello d’ID d’employé est probablement toobe supérieur à 1 Mo, utiliser l’option #1 et stocker des données d’index hello dans le stockage blob.</span><span class="sxs-lookup"><span data-stu-id="20a16-622">If hello list of employee ids is likely toobe greater than 1 MB in size, use option #1 and store hello index data in blob storage.</span></span>  
* <span data-ttu-id="20a16-623">Si vous utilisez l’option #2 (à l’aide de EGTs toohandle Ajout et suppression des employés et la modification du nom d’un employé) vous devez déterminer si le volume hello de transactions s’approche des limites d’extensibilité hello dans une partition donnée.</span><span class="sxs-lookup"><span data-stu-id="20a16-623">If you use option #2 (using EGTs toohandle adding and deleting employees, and changing an employee's last name) you must evaluate if hello volume of transactions will approach hello scalability limits in a given partition.</span></span> <span data-ttu-id="20a16-624">Si c’est le cas de hello, vous devez envisager une solution cohérente (option #1 ou #3) qui utilise la mise à jour de files d’attente toohandle hello demande et permet de vous toostore vos entités de l’index dans une partition distincte à partir des entités employé hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-624">If this is hello case, you should consider an eventually consistent solution (option #1 or option #3) that uses queues toohandle hello update requests and enables you toostore your index entities in a separate partition from hello employee entities.</span></span>  
* <span data-ttu-id="20a16-625">Option #2 dans cette solution suppose que vous souhaitez toolook par nom de famille dans un service : par exemple, vous souhaitez tooretrieve une liste d’employés avec un nom de famille Jones dans le service des ventes hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-625">Option #2 in this solution assumes that you want toolook up by last name within a department: for example, you want tooretrieve a list of employees with a last name Jones in hello Sales department.</span></span> <span data-ttu-id="20a16-626">Si vous souhaitez toobe les toolook en mesure de configurer tous les employés hello avec un nom de famille Jones dans toute l’organisation hello, utilisez l’option #1 ou #3.</span><span class="sxs-lookup"><span data-stu-id="20a16-626">If you want toobe able toolook up all hello employees with a last name Jones across hello whole organization, use either option #1 or option #3.</span></span>
* <span data-ttu-id="20a16-627">Vous pouvez implémenter une solution basée sur la file d’attente qui assure la cohérence éventuelle (voir hello [modèle de transactions cohérente](#eventually-consistent-transactions-pattern) pour plus d’informations).</span><span class="sxs-lookup"><span data-stu-id="20a16-627">You can implement a queue-based solution that delivers eventual consistency (see hello [Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) for more details).</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="20a16-628">Lorsque toouse ce modèle</span><span class="sxs-lookup"><span data-stu-id="20a16-628">When toouse this pattern</span></span>
<span data-ttu-id="20a16-629">Utilisez ce modèle lorsque vous souhaitez toolookup un ensemble d’entités qui partagent toutes une valeur de propriété courantes, telles que tous les employés dont le nom de famille hello Jones.</span><span class="sxs-lookup"><span data-stu-id="20a16-629">Use this pattern when you want toolookup a set of entities that all share a common property value, such as all employees with hello last name Jones.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="20a16-630">Conseils et modèles connexes</span><span class="sxs-lookup"><span data-stu-id="20a16-630">Related patterns and guidance</span></span>
<span data-ttu-id="20a16-631">Hello suivantes des modèles et des instructions peuvent également être intéressant lorsque vous implémentez ce modèle :</span><span class="sxs-lookup"><span data-stu-id="20a16-631">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="20a16-632">Modèle de clé composée</span><span class="sxs-lookup"><span data-stu-id="20a16-632">Compound key pattern</span></span>](#compound-key-pattern)  
* [<span data-ttu-id="20a16-633">Modèle de transactions cohérentes</span><span class="sxs-lookup"><span data-stu-id="20a16-633">Eventually consistent transactions pattern</span></span>](#eventually-consistent-transactions-pattern)  
* [<span data-ttu-id="20a16-634">Transactions de groupe d’entités</span><span class="sxs-lookup"><span data-stu-id="20a16-634">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="20a16-635">Utilisation des types d’entités hétérogènes</span><span class="sxs-lookup"><span data-stu-id="20a16-635">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)  

### <a name="denormalization-pattern"></a><span data-ttu-id="20a16-636">Modèle de dénormalisation</span><span class="sxs-lookup"><span data-stu-id="20a16-636">Denormalization pattern</span></span>
<span data-ttu-id="20a16-637">Combiner des données connexes dans une seule entité de tooenable tooretrieve tous hello des données que vous avez besoin d’une requête de point unique.</span><span class="sxs-lookup"><span data-stu-id="20a16-637">Combine related data together in a single entity tooenable you tooretrieve all hello data you need with a single point query.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="20a16-638">Contexte et problème</span><span class="sxs-lookup"><span data-stu-id="20a16-638">Context and problem</span></span>
<span data-ttu-id="20a16-639">Dans une base de données relationnelle, vous normalisez généralement la déduplication des données tooremove résultant dans les requêtes qui extraient des données provenant de plusieurs tables.</span><span class="sxs-lookup"><span data-stu-id="20a16-639">In a relational database, you typically normalize data tooremove duplication resulting in queries that retrieve data from multiple tables.</span></span> <span data-ttu-id="20a16-640">Si vous normalisez vos données dans des tables Azure, vous devez vous plusieurs allers-retours de hello client toohello server tooretrieve vos données connexes.</span><span class="sxs-lookup"><span data-stu-id="20a16-640">If you normalize your data in Azure tables, you must make multiple round trips from hello client toohello server tooretrieve your related data.</span></span> <span data-ttu-id="20a16-641">Par exemple, avec la structure de la table hello illustré ci-dessous, vous avez besoin de deux arrondir allers-retours tooretrieve hello plus d’informations pour un service : une toofetch entité du service hello qui inclut l’id du Gestionnaire de hello et détails d’un autre demande toofetch hello du gestionnaire un employé entité.</span><span class="sxs-lookup"><span data-stu-id="20a16-641">For example, with hello table structure shown below you need two round trips tooretrieve hello details for a department: one toofetch hello department entity that includes hello manager's id, and then another request toofetch hello manager's details in an employee entity.</span></span>  

![][16]

#### <a name="solution"></a><span data-ttu-id="20a16-642">Solution</span><span class="sxs-lookup"><span data-stu-id="20a16-642">Solution</span></span>
<span data-ttu-id="20a16-643">Au lieu de stocker les données de salutation dans deux entités distinctes, dénormaliser les données hello et conserver une copie de détails du Gestionnaire de hello dans entité du service hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-643">Instead of storing hello data in two separate entities, denormalize hello data and keep a copy of hello manager's details in hello department entity.</span></span> <span data-ttu-id="20a16-644">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="20a16-644">For example:</span></span>  

![][17]

<span data-ttu-id="20a16-645">Avec les entités de service stockées avec ces propriétés, vous pouvez maintenant récupérer tous les détails de hello que vous avez besoin sur un service à l’aide d’une requête de point.</span><span class="sxs-lookup"><span data-stu-id="20a16-645">With department entities stored with these properties, you can now retrieve all hello details you need about a department using a point query.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="20a16-646">Problèmes et considérations</span><span class="sxs-lookup"><span data-stu-id="20a16-646">Issues and considerations</span></span>
<span data-ttu-id="20a16-647">Prendre en compte les points suivants lorsque vous décidez de hello comment tooimplement ce modèle :</span><span class="sxs-lookup"><span data-stu-id="20a16-647">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="20a16-648">Des coûts réels sont associés au stockage des données à deux reprises.</span><span class="sxs-lookup"><span data-stu-id="20a16-648">There is some cost overhead associated with storing some data twice.</span></span> <span data-ttu-id="20a16-649">amélioration des performances (résultant de service de stockage moins demandes toohello) généralement Hello compense marginal augmentation des coûts de stockage hello (et ce coût est décalé partiellement par une réduction de nombre hello de transactions vous avez besoin des détails de hello toofetch d’un service).</span><span class="sxs-lookup"><span data-stu-id="20a16-649">hello performance benefit (resulting from fewer requests toohello storage service) typically outweighs hello marginal increase in storage costs (and this cost is partially offset by a reduction in hello number of transactions you require toofetch hello details of a department).</span></span>  
* <span data-ttu-id="20a16-650">Vous devez maintenir la cohérence de hello de hello deux entités qui stockent des informations sur les gestionnaires.</span><span class="sxs-lookup"><span data-stu-id="20a16-650">You must maintain hello consistency of hello two entities that store information about managers.</span></span> <span data-ttu-id="20a16-651">Vous pouvez gérer des problème de cohérence hello à l’aide de EGTs tooupdate plusieurs entités dans une seule transaction atomique : dans ce cas, hello service et hello employé pour le Gestionnaire de service hello sont stockés dans hello même partition.</span><span class="sxs-lookup"><span data-stu-id="20a16-651">You can handle hello consistency issue by using EGTs tooupdate multiple entities in a single atomic transaction: in this case, hello department entity, and hello employee entity for hello department manager are stored in hello same partition.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="20a16-652">Lorsque toouse ce modèle</span><span class="sxs-lookup"><span data-stu-id="20a16-652">When toouse this pattern</span></span>
<span data-ttu-id="20a16-653">Utilisez ce modèle lorsque vous devez fréquemment toolook les informations associées.</span><span class="sxs-lookup"><span data-stu-id="20a16-653">Use this pattern when you frequently need toolook up related information.</span></span> <span data-ttu-id="20a16-654">Ce modèle réduit le nombre hello de votre client doit faire des données de hello tooretrieve qu'il nécessite des requêtes.</span><span class="sxs-lookup"><span data-stu-id="20a16-654">This pattern reduces hello number of queries your client must make tooretrieve hello data it requires.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="20a16-655">Conseils et modèles connexes</span><span class="sxs-lookup"><span data-stu-id="20a16-655">Related patterns and guidance</span></span>
<span data-ttu-id="20a16-656">Hello suivantes des modèles et des instructions peuvent également être intéressant lorsque vous implémentez ce modèle :</span><span class="sxs-lookup"><span data-stu-id="20a16-656">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="20a16-657">Modèle de clé composée</span><span class="sxs-lookup"><span data-stu-id="20a16-657">Compound key pattern</span></span>](#compound-key-pattern)  
* [<span data-ttu-id="20a16-658">Transactions de groupe d’entités</span><span class="sxs-lookup"><span data-stu-id="20a16-658">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="20a16-659">Utilisation des types d’entités hétérogènes</span><span class="sxs-lookup"><span data-stu-id="20a16-659">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)

### <a name="compound-key-pattern"></a><span data-ttu-id="20a16-660">Modèle de clé composée</span><span class="sxs-lookup"><span data-stu-id="20a16-660">Compound key pattern</span></span>
<span data-ttu-id="20a16-661">Utilisez composé **RowKey** valeurs tooenable un toolookup client liés de données avec une requête de point unique.</span><span class="sxs-lookup"><span data-stu-id="20a16-661">Use compound **RowKey** values tooenable a client toolookup related data with a single point query.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="20a16-662">Contexte et problème</span><span class="sxs-lookup"><span data-stu-id="20a16-662">Context and problem</span></span>
<span data-ttu-id="20a16-663">Dans une base de données relationnelle, il est toouse naturel des jointures dans les requêtes tooreturn connexes du client toohello de données dans une requête unique.</span><span class="sxs-lookup"><span data-stu-id="20a16-663">In a relational database, it is quite natural toouse joins in queries tooreturn related pieces of data toohello client in a single query.</span></span> <span data-ttu-id="20a16-664">Par exemple, vous pouvez utiliser hello employee id toolook la liste des entités connexes qui contiennent des performances et de consulter les données pour cet employé.</span><span class="sxs-lookup"><span data-stu-id="20a16-664">For example, you might use hello employee id toolook up a list of related entities that contain performance and review data for that employee.</span></span>  

<span data-ttu-id="20a16-665">Supposons que vous stockez des entités employee hello service de Table à l’aide de hello suivant structure :</span><span class="sxs-lookup"><span data-stu-id="20a16-665">Assume you are storing employee entities in hello Table service using hello following structure:</span></span>  

![][18]

<span data-ttu-id="20a16-666">Vous devez également toostore des données historiques relatives tooreviews et performances de chaque employé de hello année a travaillé pour votre organisation et vous devez tooaccess en mesure de toobe ces informations par année.</span><span class="sxs-lookup"><span data-stu-id="20a16-666">You also need toostore historical data relating tooreviews and performance for each year hello employee has worked for your organization and you need toobe able tooaccess this information by year.</span></span> <span data-ttu-id="20a16-667">Une option est toocreate une autre table qui stocke les entités avec hello suivant structure :</span><span class="sxs-lookup"><span data-stu-id="20a16-667">One option is toocreate another table that stores entities with hello following structure:</span></span>  

![][19]

<span data-ttu-id="20a16-668">Notez que cette approche que vous pouvez décider tooduplicate certaines informations (par exemple, prénom et nom) de hello nouvelle entité tooenable vous tooretrieve vos données grâce à une demande unique.</span><span class="sxs-lookup"><span data-stu-id="20a16-668">Notice that with this approach you may decide tooduplicate some information (such as first name and last name) in hello new entity tooenable you tooretrieve your data with a single request.</span></span> <span data-ttu-id="20a16-669">Toutefois, vous ne peut pas assurer la cohérence forte, car vous ne pouvez pas utiliser un EGT tooupdate hello deux entités atomiquement.</span><span class="sxs-lookup"><span data-stu-id="20a16-669">However, you cannot maintain strong consistency because you cannot use an EGT tooupdate hello two entities atomically.</span></span>  

#### <a name="solution"></a><span data-ttu-id="20a16-670">Solution</span><span class="sxs-lookup"><span data-stu-id="20a16-670">Solution</span></span>
<span data-ttu-id="20a16-671">Stocker un nouveau type d’entité dans votre table d’origine à l’aide des entités avec hello suivant structure :</span><span class="sxs-lookup"><span data-stu-id="20a16-671">Store a new entity type in your original table using entities with hello following structure:</span></span>  

![][20]

<span data-ttu-id="20a16-672">Notez comment hello **RowKey** est maintenant une clé composée constituée par id d’employé hello et année hello de données de révision hello qui vous permet de tooretrieve hello des performances de l’employé et passez en revue les données avec une demande unique pour une entité unique.</span><span class="sxs-lookup"><span data-stu-id="20a16-672">Notice how hello **RowKey** is now a compound key made up of hello employee id and hello year of hello review data that enables you tooretrieve hello employee's performance and review data with a single request for a single entity.</span></span>  

<span data-ttu-id="20a16-673">Hello, l’exemple suivant indique comment vous pouvez récupérer toutes les données de révision hello pour un employé donné (par exemple, employé 000123 dans le service des ventes hello) :</span><span class="sxs-lookup"><span data-stu-id="20a16-673">hello following example outlines how you can retrieve all hello review data for a particular employee (such as employee 000123 in hello Sales department):</span></span>  

<span data-ttu-id="20a16-674">$filter=(PartitionKey eq 'Sales') and (RowKey ge 'empid_000123') and (RowKey lt 'empid_000124')&$select=RowKey,Manager Rating,Peer Rating,Comments</span><span class="sxs-lookup"><span data-stu-id="20a16-674">$filter=(PartitionKey eq 'Sales') and (RowKey ge 'empid_000123') and (RowKey lt 'empid_000124')&$select=RowKey,Manager Rating,Peer Rating,Comments</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="20a16-675">Problèmes et considérations</span><span class="sxs-lookup"><span data-stu-id="20a16-675">Issues and considerations</span></span>
<span data-ttu-id="20a16-676">Prendre en compte les points suivants lorsque vous décidez de hello comment tooimplement ce modèle :</span><span class="sxs-lookup"><span data-stu-id="20a16-676">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="20a16-677">Vous devez utiliser un caractère de séparation appropriés qui le rend facile tooparse hello **RowKey** valeur : par exemple, **000123_2012**.</span><span class="sxs-lookup"><span data-stu-id="20a16-677">You should use a suitable separator character that makes it easy tooparse hello **RowKey** value: for example, **000123_2012**.</span></span>  
* <span data-ttu-id="20a16-678">Vous stockez également cette entité Bonjour même partition en tant que d’autres entités qui contiennent des données associées pour hello même employé, ce qui signifie que vous pouvez utiliser la cohérence forte EGTs toomaintain.</span><span class="sxs-lookup"><span data-stu-id="20a16-678">You are also storing this entity in hello same partition as other entities that contain related data for hello same employee, which means you can use EGTs toomaintain strong consistency.</span></span>
* <span data-ttu-id="20a16-679">Vous devez envisager la fréquence à laquelle vous interroge hello données toodetermine si ce modèle est approprié.</span><span class="sxs-lookup"><span data-stu-id="20a16-679">You should consider how frequently you will query hello data toodetermine whether this pattern is appropriate.</span></span>  <span data-ttu-id="20a16-680">Par exemple, si vous accédez à hello rarement des données de révision et hello de données principal employé souvent que vous devez les conserver en tant qu’entités distinctes.</span><span class="sxs-lookup"><span data-stu-id="20a16-680">For example, if you will access hello review data infrequently and hello main employee data often you should keep them as separate entities.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="20a16-681">Lorsque toouse ce modèle</span><span class="sxs-lookup"><span data-stu-id="20a16-681">When toouse this pattern</span></span>
<span data-ttu-id="20a16-682">Utilisez ce modèle lorsque vous avez besoin de toostore une ou plusieurs des entités connexes que vous interrogez fréquemment.</span><span class="sxs-lookup"><span data-stu-id="20a16-682">Use this pattern when you need toostore one or more related entities that you query frequently.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="20a16-683">Conseils et modèles connexes</span><span class="sxs-lookup"><span data-stu-id="20a16-683">Related patterns and guidance</span></span>
<span data-ttu-id="20a16-684">Hello suivantes des modèles et des instructions peuvent également être intéressant lorsque vous implémentez ce modèle :</span><span class="sxs-lookup"><span data-stu-id="20a16-684">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="20a16-685">Transactions de groupe d’entités</span><span class="sxs-lookup"><span data-stu-id="20a16-685">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="20a16-686">Utilisation des types d’entités hétérogènes</span><span class="sxs-lookup"><span data-stu-id="20a16-686">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)  
* [<span data-ttu-id="20a16-687">Modèle de transactions cohérentes</span><span class="sxs-lookup"><span data-stu-id="20a16-687">Eventually consistent transactions pattern</span></span>](#eventually-consistent-transactions-pattern)  

### <a name="log-tail-pattern"></a><span data-ttu-id="20a16-688">Modèle de fin de journal</span><span class="sxs-lookup"><span data-stu-id="20a16-688">Log tail pattern</span></span>
<span data-ttu-id="20a16-689">Récupérer hello  *n*  entités la plus récemment ajoutée tooa partition en utilisant un **RowKey** valeur trie inverse de date et l’ordre chronologique.</span><span class="sxs-lookup"><span data-stu-id="20a16-689">Retrieve hello *n* entities most recently added tooa partition by using a **RowKey** value that sorts in reverse date and time order.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="20a16-690">Contexte et problème</span><span class="sxs-lookup"><span data-stu-id="20a16-690">Context and problem</span></span>
<span data-ttu-id="20a16-691">Une exigence courante est d’être en mesure de tooretrieve entités hello plus récemment créé, par exemple hello dix dernières notes de frais soumises par un employé.</span><span class="sxs-lookup"><span data-stu-id="20a16-691">A common requirement is be able tooretrieve hello most recently created entities, for example hello ten most recent expense claims submitted by an employee.</span></span> <span data-ttu-id="20a16-692">Prise en charge des requêtes de table un **$top** hello de tooreturn d’opération de requête tout d’abord  *n*  entités à partir d’un ensemble : il n’existe aucune requête équivalente tooreturn hello dernière n entités d’opération dans un jeu.</span><span class="sxs-lookup"><span data-stu-id="20a16-692">Table queries support a **$top** query operation tooreturn hello first *n* entities from a set: there is no equivalent query operation tooreturn hello last n entities in a set.</span></span>  

#### <a name="solution"></a><span data-ttu-id="20a16-693">Solution</span><span class="sxs-lookup"><span data-stu-id="20a16-693">Solution</span></span>
<span data-ttu-id="20a16-694">Les entités de hello Store à l’aide un **RowKey** que naturellement trie dans l’ordre inverse date/heure commande à l’aide d’entrée la plus récente hello est toujours hello dans le tableau de hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-694">Store hello entities using a **RowKey** that naturally sorts in reverse date/time order by using so hello most recent entry is always hello first one in hello table.</span></span>  

<span data-ttu-id="20a16-695">Par exemple, tooretrieve en mesure de toobe hello dix dernières notes de frais soumises par un employé, vous pouvez utiliser une valeur de graduation inverse hello dérivée de date/heure actuelle.</span><span class="sxs-lookup"><span data-stu-id="20a16-695">For example, toobe able tooretrieve hello ten most recent expense claims submitted by an employee, you can use a reverse tick value derived from hello current date/time.</span></span> <span data-ttu-id="20a16-696">Hello exemple de code c# suivant montre une façon toocreate une valeur « inversé graduations » approprié pour un **RowKey** qui effectue le tri de toohello plus récente de hello plus ancienne :</span><span class="sxs-lookup"><span data-stu-id="20a16-696">hello following C# code sample shows one way toocreate a suitable "inverted ticks" value for a **RowKey** that sorts from hello most recent toohello oldest:</span></span>  

`string invertedTicks = string.Format("{0:D19}", DateTime.MaxValue.Ticks - DateTime.UtcNow.Ticks);`  

<span data-ttu-id="20a16-697">Vous pouvez revenir durée toohello date à l’aide de hello suivant de code :</span><span class="sxs-lookup"><span data-stu-id="20a16-697">You can get back toohello date time value using hello following code:</span></span>  

`DateTime dt = new DateTime(DateTime.MaxValue.Ticks - Int64.Parse(invertedTicks));`  

<span data-ttu-id="20a16-698">requête de table Hello ressemble à ceci :</span><span class="sxs-lookup"><span data-stu-id="20a16-698">hello table query looks like this:</span></span>  

`https://myaccount.table.core.windows.net/EmployeeExpense(PartitionKey='empid')?$top=10`  

#### <a name="issues-and-considerations"></a><span data-ttu-id="20a16-699">Problèmes et considérations</span><span class="sxs-lookup"><span data-stu-id="20a16-699">Issues and considerations</span></span>
<span data-ttu-id="20a16-700">Prendre en compte les points suivants lorsque vous décidez de hello comment tooimplement ce modèle :</span><span class="sxs-lookup"><span data-stu-id="20a16-700">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="20a16-701">Vous devez faire précéder valeur des graduations inverse hello avec des zéros non significatifs trie de valeur de chaîne hello tooensure comme prévu.</span><span class="sxs-lookup"><span data-stu-id="20a16-701">You must pad hello reverse tick value with leading zeroes tooensure hello string value sorts as expected.</span></span>  
* <span data-ttu-id="20a16-702">Vous devez être conscient des objectifs d’évolutivité hello au niveau hello d’une partition.</span><span class="sxs-lookup"><span data-stu-id="20a16-702">You must be aware of hello scalability targets at hello level of a partition.</span></span> <span data-ttu-id="20a16-703">Veillez à ne pas créer des partitions de zone sensible.</span><span class="sxs-lookup"><span data-stu-id="20a16-703">Be careful not create hot spot partitions.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="20a16-704">Lorsque toouse ce modèle</span><span class="sxs-lookup"><span data-stu-id="20a16-704">When toouse this pattern</span></span>
<span data-ttu-id="20a16-705">Utilisez ce modèle lorsque vous avez besoin d’entités tooaccess dans l’ordre de date/heure inverse ou lorsque vous devez tooaccess hello plus récemment ajouté des entités.</span><span class="sxs-lookup"><span data-stu-id="20a16-705">Use this pattern when you need tooaccess entities in reverse date/time order or when you need tooaccess hello most recently added entities.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="20a16-706">Conseils et modèles connexes</span><span class="sxs-lookup"><span data-stu-id="20a16-706">Related patterns and guidance</span></span>
<span data-ttu-id="20a16-707">Hello suivantes des modèles et des instructions peuvent également être intéressant lorsque vous implémentez ce modèle :</span><span class="sxs-lookup"><span data-stu-id="20a16-707">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="20a16-708">Ajouter un anti-modèle ou un préfixe d’anti-modèle</span><span class="sxs-lookup"><span data-stu-id="20a16-708">Prepend / append anti-pattern</span></span>](#prepend-append-anti-pattern)  
* [<span data-ttu-id="20a16-709">Récupération des entités</span><span class="sxs-lookup"><span data-stu-id="20a16-709">Retrieving entities</span></span>](#retrieving-entities)  

### <a name="high-volume-delete-pattern"></a><span data-ttu-id="20a16-710">Modèle de suppression de volume élevé</span><span class="sxs-lookup"><span data-stu-id="20a16-710">High volume delete pattern</span></span>
<span data-ttu-id="20a16-711">Activer la suppression d’un volume élevé d’entités hello en stockant toutes les entités hello pour suppression simultanée dans leur propre table distincte ; vous supprimez des entités de hello en supprimant la table de hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-711">Enable hello deletion of a high volume of entities by storing all hello entities for simultaneous deletion in their own separate table; you delete hello entities by deleting hello table.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="20a16-712">Contexte et problème</span><span class="sxs-lookup"><span data-stu-id="20a16-712">Context and problem</span></span>
<span data-ttu-id="20a16-713">De nombreuses applications supprimer les anciennes données qui n’a plus besoin application de client toobe tooa disponibles, ou cette application hello a archivé le support de stockage tooanother.</span><span class="sxs-lookup"><span data-stu-id="20a16-713">Many applications delete old data which no longer needs toobe available tooa client application, or that hello application has archived tooanother storage medium.</span></span> <span data-ttu-id="20a16-714">Vous identifiez généralement ces données à une date : par exemple, vous avez des enregistrements toodelete a besoin de toutes les demandes de connexion qui ont plus de 60 jours.</span><span class="sxs-lookup"><span data-stu-id="20a16-714">You typically identify such data by a date: for example, you have a requirement toodelete records of all login requests that are more than 60 days old.</span></span>  

<span data-ttu-id="20a16-715">Une conception possible est toouse hello horodatage de la demande de connexion hello Bonjour **RowKey**:</span><span class="sxs-lookup"><span data-stu-id="20a16-715">One possible design is toouse hello date and time of hello login request in hello **RowKey**:</span></span>  

![][21]

<span data-ttu-id="20a16-716">Cette approche évite les zones réactives de partition, car l’application hello peut insérer et supprimer des entités de connexion pour chaque utilisateur dans une partition distincte.</span><span class="sxs-lookup"><span data-stu-id="20a16-716">This approach avoids partition hotspots because hello application can insert and delete login entities for each user in a separate partition.</span></span> <span data-ttu-id="20a16-717">Toutefois, cette approche peut s’avérer onéreuse beaucoup de temps si vous avez un grand nombre d’entités, car vous devez tout d’abord tooperform une analyse de table dans l’ordre tooidentify tous les toodelete d’entités hello et vous devez le supprimer chaque entité ancien.</span><span class="sxs-lookup"><span data-stu-id="20a16-717">However, this approach may be costly and time consuming if you have a large number of entities because first you need tooperform a table scan in order tooidentify all hello entities toodelete, and then you must delete each old entity.</span></span> <span data-ttu-id="20a16-718">Notez que vous pouvez réduire le nombre hello d’allers-retours toohello serveur requis toodelete hello anciennes entités par le traitement par lots de plusieurs demandes de suppression dans EGTs.</span><span class="sxs-lookup"><span data-stu-id="20a16-718">Note that you can reduce hello number of round trips toohello server required toodelete hello old entities by batching multiple delete requests into EGTs.</span></span>  

#### <a name="solution"></a><span data-ttu-id="20a16-719">Solution</span><span class="sxs-lookup"><span data-stu-id="20a16-719">Solution</span></span>
<span data-ttu-id="20a16-720">Utilisez une table distincte pour chaque jour de tentative de connexion.</span><span class="sxs-lookup"><span data-stu-id="20a16-720">Use a separate table for each day of login attempts.</span></span> <span data-ttu-id="20a16-721">Vous pouvez utiliser la conception d’entité hello ci-dessus tooavoid hotspots lorsque vous insérez des entités, et la suppression des anciennes entités est maintenant simplement une question de la suppression d’une table de tous les jours (une seule opération de stockage) au lieu de la recherche et la suppression des milliers de entités de connexion individuelle tous les jours.</span><span class="sxs-lookup"><span data-stu-id="20a16-721">You can use hello entity design above tooavoid hotspots when you are inserting entities, and deleting old entities is now simply a question of deleting one table every day (a single storage operation) instead of finding and deleting hundreds and thousands of individual login entities every day.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="20a16-722">Problèmes et considérations</span><span class="sxs-lookup"><span data-stu-id="20a16-722">Issues and considerations</span></span>
<span data-ttu-id="20a16-723">Prendre en compte les points suivants lorsque vous décidez de hello comment tooimplement ce modèle :</span><span class="sxs-lookup"><span data-stu-id="20a16-723">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="20a16-724">Votre conception prend en charge les autres méthodes que votre application utilisera les données de salutation telles que la recherche des entités spécifiques, en liaison avec d’autres données, ou générer des informations d’agrégation ?</span><span class="sxs-lookup"><span data-stu-id="20a16-724">Does your design support other ways your application will use hello data such as looking up specific entities, linking with other data, or generating aggregate information?</span></span>  
* <span data-ttu-id="20a16-725">Votre conception évite-t-elle les zones sensibles lorsque vous insérez de nouvelles entités ?</span><span class="sxs-lookup"><span data-stu-id="20a16-725">Does your design avoid hot spots when you are inserting new entities?</span></span>  
* <span data-ttu-id="20a16-726">Attendez un délai, si vous souhaitez tooreuse hello même nom de la table après sa suppression.</span><span class="sxs-lookup"><span data-stu-id="20a16-726">Expect a delay if you want tooreuse hello same table name after deleting it.</span></span> <span data-ttu-id="20a16-727">Il s’agit d’une meilleure tooalways utiliser des noms de table unique.</span><span class="sxs-lookup"><span data-stu-id="20a16-727">It's better tooalways use unique table names.</span></span>  
* <span data-ttu-id="20a16-728">Prévoyez une limitation lorsque vous utilisez tout d’abord une nouvelle table tandis que hello service de Table apprend les modèles d’accès hello et distribue les partitions de hello entre les nœuds.</span><span class="sxs-lookup"><span data-stu-id="20a16-728">Expect some throttling when you first use a new table while hello Table service learns hello access patterns and distributes hello partitions across nodes.</span></span> <span data-ttu-id="20a16-729">Vous devez envisager la fréquence à laquelle vous avez besoin de toocreate nouvelles tables.</span><span class="sxs-lookup"><span data-stu-id="20a16-729">You should consider how frequently you need toocreate new tables.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="20a16-730">Lorsque toouse ce modèle</span><span class="sxs-lookup"><span data-stu-id="20a16-730">When toouse this pattern</span></span>
<span data-ttu-id="20a16-731">Utilisez ce modèle lorsque vous avez un grand nombre d’entités que vous devez supprimer à hello même temps.</span><span class="sxs-lookup"><span data-stu-id="20a16-731">Use this pattern when you have a high volume of entities that you must delete at hello same time.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="20a16-732">Conseils et modèles connexes</span><span class="sxs-lookup"><span data-stu-id="20a16-732">Related patterns and guidance</span></span>
<span data-ttu-id="20a16-733">Hello suivantes des modèles et des instructions peuvent également être intéressant lorsque vous implémentez ce modèle :</span><span class="sxs-lookup"><span data-stu-id="20a16-733">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="20a16-734">Transactions de groupe d’entités</span><span class="sxs-lookup"><span data-stu-id="20a16-734">Entity Group Transactions</span></span>](#entity-group-transactions)
* [<span data-ttu-id="20a16-735">Modification des entités</span><span class="sxs-lookup"><span data-stu-id="20a16-735">Modifying entities</span></span>](#modifying-entities)  

### <a name="data-series-pattern"></a><span data-ttu-id="20a16-736">Modèle de série de données</span><span class="sxs-lookup"><span data-stu-id="20a16-736">Data series pattern</span></span>
<span data-ttu-id="20a16-737">Série de données complète de magasin seule entité toominimize hello de plusieurs demandes.</span><span class="sxs-lookup"><span data-stu-id="20a16-737">Store complete data series in a single entity toominimize hello number of requests you make.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="20a16-738">Contexte et problème</span><span class="sxs-lookup"><span data-stu-id="20a16-738">Context and problem</span></span>
<span data-ttu-id="20a16-739">Un scénario courant consiste pour une application toostore une série de données qu’elle nécessite généralement tooretrieve tous en même temps.</span><span class="sxs-lookup"><span data-stu-id="20a16-739">A common scenario is for an application toostore a series of data that it typically needs tooretrieve all at once.</span></span> <span data-ttu-id="20a16-740">Par exemple, votre application peut enregistrer les messages de messagerie instantanée combien chaque employé envoie toutes les heures et ensuite utiliser cette tooplot informations envoyée par chaque utilisateur sur le nombre de messages hello 24 heures précédentes.</span><span class="sxs-lookup"><span data-stu-id="20a16-740">For example, your application might record how many IM messages each employee sends every hour, and then use this information tooplot how many messages each user sent over hello preceding 24 hours.</span></span> <span data-ttu-id="20a16-741">Un modèle peut être toostore des 24 entités pour chaque employé :</span><span class="sxs-lookup"><span data-stu-id="20a16-741">One design might be toostore 24 entities for each employee:</span></span>  

![][22]

<span data-ttu-id="20a16-742">Grâce à cette conception, vous pouvez facilement localiser et hello entité tooupdate de mettre à jour pour chaque employé chaque fois que la valeur du nombre de messages hello tooupdate a besoin d’application hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-742">With this design, you can easily locate and update hello entity tooupdate for each employee whenever hello application needs tooupdate hello message count value.</span></span> <span data-ttu-id="20a16-743">Toutefois, tooretrieve hello informations tooplot un graphique de l’activité hello de hello 24 heures précédentes, vous devez récupérer des 24 entités.</span><span class="sxs-lookup"><span data-stu-id="20a16-743">However, tooretrieve hello information tooplot a chart of hello activity for hello preceding 24 hours, you must retrieve 24 entities.</span></span>  

#### <a name="solution"></a><span data-ttu-id="20a16-744">Solution</span><span class="sxs-lookup"><span data-stu-id="20a16-744">Solution</span></span>
<span data-ttu-id="20a16-745">Utilisez hello suivant de modèle avec un nombre de messages hello toostore propriété distinct pour chaque heure :</span><span class="sxs-lookup"><span data-stu-id="20a16-745">Use hello following design with a separate property toostore hello message count for each hour:</span></span>  

![][23]

<span data-ttu-id="20a16-746">Grâce à cette conception, vous pouvez utiliser un nombre de messages de fusion opération tooupdate hello pour un employé pour une heure spécifique.</span><span class="sxs-lookup"><span data-stu-id="20a16-746">With this design, you can use a merge operation tooupdate hello message count for an employee for a specific hour.</span></span> <span data-ttu-id="20a16-747">Maintenant, vous pouvez récupérer toutes les informations de hello vous avez besoin de graphique de hello tooplot à l’aide d’une requête pour une entité unique.</span><span class="sxs-lookup"><span data-stu-id="20a16-747">Now, you can retrieve all hello information you need tooplot hello chart using a request for a single entity.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="20a16-748">Problèmes et considérations</span><span class="sxs-lookup"><span data-stu-id="20a16-748">Issues and considerations</span></span>
<span data-ttu-id="20a16-749">Prendre en compte les points suivants lorsque vous décidez de hello comment tooimplement ce modèle :</span><span class="sxs-lookup"><span data-stu-id="20a16-749">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="20a16-750">Si votre série de données complète n’est pas adaptée à une seule entité (une entité peut avoir des propriétés de too252), utilisez un autre magasin de données comme un objet blob.</span><span class="sxs-lookup"><span data-stu-id="20a16-750">If your complete data series does not fit into a single entity (an entity can have up too252 properties), use an alternative data store such as a blob.</span></span>  
* <span data-ttu-id="20a16-751">Si vous avez plusieurs clients simultanément mise à jour d’une entité, vous devez toouse hello **ETag** tooimplement l’accès concurrentiel optimiste.</span><span class="sxs-lookup"><span data-stu-id="20a16-751">If you have multiple clients updating an entity simultaneously, you will need toouse hello **ETag** tooimplement optimistic concurrency.</span></span> <span data-ttu-id="20a16-752">Si vous avez de nombreux clients, vous pouvez rencontrer une contention élevée.</span><span class="sxs-lookup"><span data-stu-id="20a16-752">If you have many clients, you may experience high contention.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="20a16-753">Lorsque toouse ce modèle</span><span class="sxs-lookup"><span data-stu-id="20a16-753">When toouse this pattern</span></span>
<span data-ttu-id="20a16-754">Utilisez ce modèle lorsque vous avez besoin de tooupdate et récupérer une série de données associée à une entité individuelle.</span><span class="sxs-lookup"><span data-stu-id="20a16-754">Use this pattern when you need tooupdate and retrieve a data series associated with an individual entity.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="20a16-755">Conseils et modèles connexes</span><span class="sxs-lookup"><span data-stu-id="20a16-755">Related patterns and guidance</span></span>
<span data-ttu-id="20a16-756">Hello suivantes des modèles et des instructions peuvent également être intéressant lorsque vous implémentez ce modèle :</span><span class="sxs-lookup"><span data-stu-id="20a16-756">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="20a16-757">Modèle d'entités volumineuses</span><span class="sxs-lookup"><span data-stu-id="20a16-757">Large entities pattern</span></span>](#large-entities-pattern)  
* [<span data-ttu-id="20a16-758">Fusion ou remplacement</span><span class="sxs-lookup"><span data-stu-id="20a16-758">Merge or replace</span></span>](#merge-or-replace)  
* <span data-ttu-id="20a16-759">[Modèle de transactions cohérente](#eventually-consistent-transactions-pattern) (si vous stockez des séries de données hello dans un objet blob)</span><span class="sxs-lookup"><span data-stu-id="20a16-759">[Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) (if you are storing hello data series in a blob)</span></span>  

### <a name="wide-entities-pattern"></a><span data-ttu-id="20a16-760">Modèle d’entités larges</span><span class="sxs-lookup"><span data-stu-id="20a16-760">Wide entities pattern</span></span>
<span data-ttu-id="20a16-761">Utiliser des entités logiques plusieurs entités physiques toostore avec plus de 252 propriétés.</span><span class="sxs-lookup"><span data-stu-id="20a16-761">Use multiple physical entities toostore logical entities with more than 252 properties.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="20a16-762">Contexte et problème</span><span class="sxs-lookup"><span data-stu-id="20a16-762">Context and problem</span></span>
<span data-ttu-id="20a16-763">Une entité individuelle peut avoir des propriétés, pas plus de 252 (à l’exception des propriétés du système obligatoire hello) et ne peut pas stocker plus de 1 Mo de données au total.</span><span class="sxs-lookup"><span data-stu-id="20a16-763">An individual entity can have no more than 252 properties (excluding hello mandatory system properties) and cannot store more than 1 MB of data in total.</span></span> <span data-ttu-id="20a16-764">Dans une base de données relationnelle, vous obtiendrez en général arrondit les limites de taille hello d’une ligne par ajout d’une nouvelle table et application d’une relation 1 à 1 entre eux.</span><span class="sxs-lookup"><span data-stu-id="20a16-764">In a relational database, you would typically get round any limits on hello size of a row by adding a new table and enforcing a 1-to-1 relationship between them.</span></span>  

#### <a name="solution"></a><span data-ttu-id="20a16-765">Solution</span><span class="sxs-lookup"><span data-stu-id="20a16-765">Solution</span></span>
<span data-ttu-id="20a16-766">À l’aide du service de Table hello, vous pouvez stocker plusieurs entités toorepresent un objet unique grandes entreprises avec plus de 252 propriétés.</span><span class="sxs-lookup"><span data-stu-id="20a16-766">Using hello Table service, you can store multiple entities toorepresent a single large business object with more than 252 properties.</span></span> <span data-ttu-id="20a16-767">Par exemple, si vous souhaitez toostore nombre hello de messages de messagerie instantanée envoyées par chaque employé pour hello cours des 365 derniers jours, vous pouvez utiliser hello suivant le modèle qui utilise deux entités avec des schémas différents :</span><span class="sxs-lookup"><span data-stu-id="20a16-767">For example, if you want toostore a count of hello number of IM messages sent by each employee for hello last 365 days, you could use hello following design that uses two entities with different schemas:</span></span>  

![][24]

<span data-ttu-id="20a16-768">Si vous avez besoin de toomake une modification qui nécessite la mise à jour à la fois tookeep entités les synchronisés entre eux, vous pouvez utiliser un EGT.</span><span class="sxs-lookup"><span data-stu-id="20a16-768">If you need toomake a change that requires updating both entities tookeep them synchronized with each other you can use an EGT.</span></span> <span data-ttu-id="20a16-769">Sinon, vous pouvez utiliser un nombre de messages de fusion unique opération tooupdate hello pour un jour spécifique.</span><span class="sxs-lookup"><span data-stu-id="20a16-769">Otherwise, you can use a single merge operation tooupdate hello message count for a specific day.</span></span> <span data-ttu-id="20a16-770">tooretrieve tous hello des données pour un employé individuel, vous devez récupérer les deux entités, vous pouvez faire avec deux demandes efficace qui utilisent à la fois un **PartitionKey** et un **RowKey** valeur.</span><span class="sxs-lookup"><span data-stu-id="20a16-770">tooretrieve all hello data for an individual employee you must retrieve both entities, which you can do with two efficient requests that use both a **PartitionKey** and a **RowKey** value.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="20a16-771">Problèmes et considérations</span><span class="sxs-lookup"><span data-stu-id="20a16-771">Issues and considerations</span></span>
<span data-ttu-id="20a16-772">Prendre en compte les points suivants lorsque vous décidez de hello comment tooimplement ce modèle :</span><span class="sxs-lookup"><span data-stu-id="20a16-772">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="20a16-773">La récupération d’une entité logique complète implique au moins deux transactions de stockage : entité physique d’un tooretrieve chaque.</span><span class="sxs-lookup"><span data-stu-id="20a16-773">Retrieving a complete logical entity involves at least two storage transactions: one tooretrieve each physical entity.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="20a16-774">Lorsque toouse ce modèle</span><span class="sxs-lookup"><span data-stu-id="20a16-774">When toouse this pattern</span></span>
<span data-ttu-id="20a16-775">Utilisez ce modèle lorsque le service de Table besoin toostore les entités dont la taille ou le nombre de propriétés dépasse les limites de hello pour une entité individuelle dans hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-775">Use this pattern when  need toostore entities whose size or number of properties exceeds hello limits for an individual entity in hello Table service.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="20a16-776">Conseils et modèles connexes</span><span class="sxs-lookup"><span data-stu-id="20a16-776">Related patterns and guidance</span></span>
<span data-ttu-id="20a16-777">Hello suivantes des modèles et des instructions peuvent également être intéressant lorsque vous implémentez ce modèle :</span><span class="sxs-lookup"><span data-stu-id="20a16-777">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="20a16-778">Transactions de groupe d’entités</span><span class="sxs-lookup"><span data-stu-id="20a16-778">Entity Group Transactions</span></span>](#entity-group-transactions)
* [<span data-ttu-id="20a16-779">Fusion ou remplacement</span><span class="sxs-lookup"><span data-stu-id="20a16-779">Merge or replace</span></span>](#merge-or-replace)

### <a name="large-entities-pattern"></a><span data-ttu-id="20a16-780">Modèle d’entités volumineuses</span><span class="sxs-lookup"><span data-stu-id="20a16-780">Large entities pattern</span></span>
<span data-ttu-id="20a16-781">Utiliser les valeurs de propriété volumineux de toostore de stockage blob.</span><span class="sxs-lookup"><span data-stu-id="20a16-781">Use blob storage toostore large property values.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="20a16-782">Contexte et problème</span><span class="sxs-lookup"><span data-stu-id="20a16-782">Context and problem</span></span>
<span data-ttu-id="20a16-783">Une entité individuelle ne peut pas stocker plus de 1 Mo de données au total.</span><span class="sxs-lookup"><span data-stu-id="20a16-783">An individual entity cannot store more than 1 MB of data in total.</span></span> <span data-ttu-id="20a16-784">Si une ou plusieurs des propriétés de stockent des valeurs qui provoquent de taille totale de hello de votre entité de tooexceed cette valeur, vous ne peut pas stocker l’entité toute entière de hello Bonjour service de Table.</span><span class="sxs-lookup"><span data-stu-id="20a16-784">If one or several of your properties store values that cause hello total size of your entity tooexceed this value, you cannot store hello entire entity in hello Table service.</span></span>  

#### <a name="solution"></a><span data-ttu-id="20a16-785">Solution</span><span class="sxs-lookup"><span data-stu-id="20a16-785">Solution</span></span>
<span data-ttu-id="20a16-786">Si votre entité dépasse 1 Mo la taille, car une ou plusieurs propriétés contiennent une grande quantité de données, vous pouvez stocker des données dans hello service Blob et adresse hello d’objet blob de hello puis à stocker dans une propriété d’entité de hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-786">If your entity exceeds 1 MB in size because one or more properties contain a large amount of data, you can store data in hello Blob service and then store hello address of hello blob in a property in hello entity.</span></span> <span data-ttu-id="20a16-787">Par exemple, vous pouvez stocker des photos hello d’un employé dans le stockage blob et stocker des photos toohello lien Bonjour **Photo** propriété de votre entité employee :</span><span class="sxs-lookup"><span data-stu-id="20a16-787">For example, you can store hello photo of an employee in blob storage and store a link toohello photo in hello **Photo** property of your employee entity:</span></span>  

![][25]

#### <a name="issues-and-considerations"></a><span data-ttu-id="20a16-788">Problèmes et considérations</span><span class="sxs-lookup"><span data-stu-id="20a16-788">Issues and considerations</span></span>
<span data-ttu-id="20a16-789">Prendre en compte les points suivants lorsque vous décidez de hello comment tooimplement ce modèle :</span><span class="sxs-lookup"><span data-stu-id="20a16-789">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="20a16-790">toomaintain la cohérence éventuelle entre entité hello Bonjour service de Table et les données de hello Bonjour service Blob, utilisez hello [modèle de transactions cohérente](#eventually-consistent-transactions-pattern) toomaintain vos entités.</span><span class="sxs-lookup"><span data-stu-id="20a16-790">toomaintain eventual consistency between hello entity in hello Table service and hello data in hello Blob service, use hello [Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) toomaintain your entities.</span></span>
* <span data-ttu-id="20a16-791">La récupération d’une entité complète implique au moins deux transactions de stockage : une entité de hello tooretrieve et un tooretrieve hello des données blob.</span><span class="sxs-lookup"><span data-stu-id="20a16-791">Retrieving a complete entity involves at least two storage transactions: one tooretrieve hello entity and one tooretrieve hello blob data.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="20a16-792">Lorsque toouse ce modèle</span><span class="sxs-lookup"><span data-stu-id="20a16-792">When toouse this pattern</span></span>
<span data-ttu-id="20a16-793">Utilisez ce modèle lorsque vous avez besoin d’entités toostore dont la taille dépasse les limites de hello pour une entité individuelle dans le service de Table hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-793">Use this pattern when you need toostore entities whose size exceeds hello limits for an individual entity in hello Table service.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="20a16-794">Conseils et modèles connexes</span><span class="sxs-lookup"><span data-stu-id="20a16-794">Related patterns and guidance</span></span>
<span data-ttu-id="20a16-795">Hello suivantes des modèles et des instructions peuvent également être intéressant lorsque vous implémentez ce modèle :</span><span class="sxs-lookup"><span data-stu-id="20a16-795">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="20a16-796">Modèle de transactions cohérentes</span><span class="sxs-lookup"><span data-stu-id="20a16-796">Eventually consistent transactions pattern</span></span>](#eventually-consistent-transactions-pattern)  
* [<span data-ttu-id="20a16-797">Modèle d’entités larges</span><span class="sxs-lookup"><span data-stu-id="20a16-797">Wide entities pattern</span></span>](#wide-entities-pattern)

<a name="prepend-append-anti-pattern"></a>

### <a name="prependappend-anti-pattern"></a><span data-ttu-id="20a16-798">Ajouter un anti-modèle ou un préfixe d'anti-modèle</span><span class="sxs-lookup"><span data-stu-id="20a16-798">Prepend/append anti-pattern</span></span>
<span data-ttu-id="20a16-799">Augmenter l’évolutivité lorsque vous avez un nombre important d’insertions en répartissant les insertions de hello sur plusieurs partitions.</span><span class="sxs-lookup"><span data-stu-id="20a16-799">Increase scalability when you have a high volume of inserts by spreading hello inserts across multiple partitions.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="20a16-800">Contexte et problème</span><span class="sxs-lookup"><span data-stu-id="20a16-800">Context and problem</span></span>
<span data-ttu-id="20a16-801">Ajoutant au début ou de l’ajout des entités de tooyour stockée d’entités en général des résultats dans une application hello Ajout de nouvelles entités toohello tout d’abord ou la dernière partition d’une séquence de partitions.</span><span class="sxs-lookup"><span data-stu-id="20a16-801">Prepending or appending entities tooyour stored entities typically results in hello application adding new entities toohello first or last partition of a sequence of partitions.</span></span> <span data-ttu-id="20a16-802">Dans ce cas, toutes les insertions hello à un moment donné sont se produisent dans la même partition, la création d’un point d’accès qui empêche l’équilibrage de charge de service de table hello insère entre plusieurs nœuds de hello et éventuellement à l’origine de votre l’évolutivité des applications toohit hello cibles pour la partition.</span><span class="sxs-lookup"><span data-stu-id="20a16-802">In this case, all of hello inserts at any given time are taking place in hello same partition, creating a hotspot that prevents hello table service from load balancing inserts across multiple nodes, and possibly causing your application toohit hello scalability targets for partition.</span></span> <span data-ttu-id="20a16-803">Par exemple, si vous avez une application d’accès réseau de journaux et les ressources par les employés, peut entraîner une structure d’entité comme indiqué ci-dessous hello partition de heure actuelle devenir une zone réactive si volume hello de transactions atteint cible d’évolutivité hello pour une partition individuelle :</span><span class="sxs-lookup"><span data-stu-id="20a16-803">For example, if you have an application that logs network and resource access by employees, then an entity structure as shown below could result in hello current hour's partition becoming a hotspot if hello volume of transactions reaches hello scalability target for an individual partition:</span></span>  

![][26]

#### <a name="solution"></a><span data-ttu-id="20a16-804">Solution</span><span class="sxs-lookup"><span data-stu-id="20a16-804">Solution</span></span>
<span data-ttu-id="20a16-805">Hello structure autre entité suivante permet d’éviter une zone réactive de n’importe quelle partition particulière en tant qu’événements de journaux d’application hello :</span><span class="sxs-lookup"><span data-stu-id="20a16-805">hello following alternative entity structure avoids a hotspot on any particular partition as hello application logs events:</span></span>  

![][27]

<span data-ttu-id="20a16-806">Notez avec cet exemple, comment les deux hello **PartitionKey** et **RowKey** sont des clés composées.</span><span class="sxs-lookup"><span data-stu-id="20a16-806">Notice with this example how both hello **PartitionKey** and **RowKey** are compound keys.</span></span> <span data-ttu-id="20a16-807">Hello **PartitionKey** utilise le service de hello et journalisation de hello employee id toodistribute sur plusieurs partitions.</span><span class="sxs-lookup"><span data-stu-id="20a16-807">hello **PartitionKey** uses both hello department and employee id toodistribute hello logging across multiple partitions.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="20a16-808">Problèmes et considérations</span><span class="sxs-lookup"><span data-stu-id="20a16-808">Issues and considerations</span></span>
<span data-ttu-id="20a16-809">Prendre en compte les points suivants lorsque vous décidez de hello comment tooimplement ce modèle :</span><span class="sxs-lookup"><span data-stu-id="20a16-809">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="20a16-810">Permet de votre application cliente a hello autre structure de clés qui vous évite de créer des partitions à chaud lors des insertions efficacement en charge les requêtes hello ?</span><span class="sxs-lookup"><span data-stu-id="20a16-810">Does hello alternative key structure that avoids creating hot partitions on inserts efficiently support hello queries your client application makes?</span></span>  
* <span data-ttu-id="20a16-811">Votre volume escompté des transactions signifie que vous tooreach susceptible d’objectifs d’évolutivité hello pour une partition individuelle et être limitée par le service de stockage hello ?</span><span class="sxs-lookup"><span data-stu-id="20a16-811">Does your anticipated volume of transactions mean that you are likely tooreach hello scalability targets for an individual partition and be throttled by hello storage service?</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="20a16-812">Lorsque toouse ce modèle</span><span class="sxs-lookup"><span data-stu-id="20a16-812">When toouse this pattern</span></span>
<span data-ttu-id="20a16-813">Évitez anti-modèle ajouter/ajouter hello lorsque votre volume de transactions est probablement tooresult de limitation par le service de stockage hello lorsque vous accédez à une partition à chaud.</span><span class="sxs-lookup"><span data-stu-id="20a16-813">Avoid hello prepend/append anti-pattern when your volume of transactions is likely tooresult in throttling by hello storage service when you access a hot partition.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="20a16-814">Conseils et modèles connexes</span><span class="sxs-lookup"><span data-stu-id="20a16-814">Related patterns and guidance</span></span>
<span data-ttu-id="20a16-815">Hello suivantes des modèles et des instructions peuvent également être intéressant lorsque vous implémentez ce modèle :</span><span class="sxs-lookup"><span data-stu-id="20a16-815">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="20a16-816">Modèle de clé composée</span><span class="sxs-lookup"><span data-stu-id="20a16-816">Compound key pattern</span></span>](#compound-key-pattern)  
* [<span data-ttu-id="20a16-817">Modèle de fin de journal</span><span class="sxs-lookup"><span data-stu-id="20a16-817">Log tail pattern</span></span>](#log-tail-pattern)  
* [<span data-ttu-id="20a16-818">Modification des entités</span><span class="sxs-lookup"><span data-stu-id="20a16-818">Modifying entities</span></span>](#modifying-entities)  

### <a name="log-data-anti-pattern"></a><span data-ttu-id="20a16-819">Journalisation de l'anti-modèle de données</span><span class="sxs-lookup"><span data-stu-id="20a16-819">Log data anti-pattern</span></span>
<span data-ttu-id="20a16-820">En règle générale, vous devez utiliser hello service Blob au lieu de hello données du journal toostore Table service.</span><span class="sxs-lookup"><span data-stu-id="20a16-820">Typically, you should use hello Blob service instead of hello Table service toostore log data.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="20a16-821">Contexte et problème</span><span class="sxs-lookup"><span data-stu-id="20a16-821">Context and problem</span></span>
<span data-ttu-id="20a16-822">Cas d’utilisation commun pour les données de journal sont tooretrieve une sélection d’entrées de journal pour une plage de date/heure spécifique : par exemple, vous souhaitez toofind tous hello erreur et messages critiques que votre application connectée entre 15:04 et 15:06 à une date spécifique.</span><span class="sxs-lookup"><span data-stu-id="20a16-822">A common use case for log data is tooretrieve a selection of log entries for a specific date/time range: for example, you want toofind all hello error and critical messages that your application logged between 15:04 and 15:06 on a specific date.</span></span> <span data-ttu-id="20a16-823">Vous ne souhaitez pas toouse hello date et heure hello message toodetermine hello partition des journaux vous enregistrez le journal des entités à : que les résultats dans une partition à chaud, car le partagent à un moment donné, toutes les entités de journal hello hello même **PartitionKey** valeur (consultez la section de hello [ajoutez/ajouter l’anti-modèle](#prepend-append-anti-pattern)).</span><span class="sxs-lookup"><span data-stu-id="20a16-823">You do not want toouse hello date and time of hello log message toodetermine hello partition you save log entities to: that results in a hot partition because at any given time, all hello log entities will share hello same **PartitionKey** value (see hello section [Prepend/append anti-pattern](#prepend-append-anti-pattern)).</span></span> <span data-ttu-id="20a16-824">Par exemple, hello suivant le schéma de l’entité pour un message du journal des résultats dans une partition à chaud comme application hello écrit les messages du journal partition toohello pour hello date et heure :</span><span class="sxs-lookup"><span data-stu-id="20a16-824">For example, hello following entity schema for a log message results in a hot partition because hello application writes all log messages toohello partition for hello current date and hour:</span></span>  

![][28]

<span data-ttu-id="20a16-825">Dans cet exemple, hello **RowKey** inclut hello date et heure tooensure de message de journal hello que les messages du journal sont stockés triées par ordre de date/heure et un id de message au cas où plusieurs messages de journal partagent hello mêmes date et heure.</span><span class="sxs-lookup"><span data-stu-id="20a16-825">In this example, hello **RowKey** includes hello date and time of hello log message tooensure that log messages are stored sorted in date/time order, and includes a message id in case multiple log messages share hello same date and time.</span></span>  

<span data-ttu-id="20a16-826">Une autre approche consiste à toouse un **PartitionKey** qui garantit que l’application hello écrit des messages dans une plage de partitions.</span><span class="sxs-lookup"><span data-stu-id="20a16-826">Another approach is toouse a **PartitionKey** that ensures that hello application writes messages across a range of partitions.</span></span> <span data-ttu-id="20a16-827">Par exemple, si la source hello du message de journal hello fournit un toodistribute moyen des messages entre ces partitions, vous pouvez utiliser hello suivant le schéma de l’entité :</span><span class="sxs-lookup"><span data-stu-id="20a16-827">For example, if hello source of hello log message provides a way toodistribute messages across many partitions, you could use hello following entity schema:</span></span>  

![][29]

<span data-ttu-id="20a16-828">Toutefois, le problème hello avec ce schéma est que tooretrieve tous hello des messages de journal pour un intervalle de temps spécifique, vous devez rechercher chaque partition dans la table de hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-828">However, hello problem with this schema is that tooretrieve all hello log messages for a specific time span you must search every partition in hello table.</span></span>

#### <a name="solution"></a><span data-ttu-id="20a16-829">Solution</span><span class="sxs-lookup"><span data-stu-id="20a16-829">Solution</span></span>
<span data-ttu-id="20a16-830">Hello précédente section hello en surbrillance d’un problème de la tentative de toouse hello des entrées de journal de Table service toostore et deux satisfaisante suggéré, conçoit.</span><span class="sxs-lookup"><span data-stu-id="20a16-830">hello previous section highlighted hello problem of trying toouse hello Table service toostore log entries and suggested two, unsatisfactory, designs.</span></span> <span data-ttu-id="20a16-831">Une solution conduite tooa de partition à chaud avec risque de hello de performances de l’écriture de messages de journal ; Hello autre solution a entraîné médiocrité des performances en raison de hello exigence tooscan chaque partition dans les messages de journal hello table tooretrieve pour un intervalle de temps spécifique.</span><span class="sxs-lookup"><span data-stu-id="20a16-831">One solution led tooa hot partition with hello risk of poor performance writing log messages; hello other solution resulted in poor query performance because of hello requirement tooscan every partition in hello table tooretrieve log messages for a specific time span.</span></span> <span data-ttu-id="20a16-832">Stockage d’objets BLOB offre une meilleure solution pour ce type de scénario et Voici comment Azure stockage Analytique magasins hello données de journalisation.</span><span class="sxs-lookup"><span data-stu-id="20a16-832">Blob storage offers a better solution for this type of scenario and this is how Azure Storage Analytics stores hello log data it collects.</span></span>  

<span data-ttu-id="20a16-833">Cette section décrit comment Analytique de stockage stocke des données de journal dans le stockage d’objets blob en guise d’illustration de ces données toostoring approche qui généralement d’une requête par plage.</span><span class="sxs-lookup"><span data-stu-id="20a16-833">This section outlines how Storage Analytics stores log data in blob storage as an illustration of this approach toostoring data that you typically query by range.</span></span>  

<span data-ttu-id="20a16-834">Storage Analytics stocke les messages de journalisation dans un format délimité dans plusieurs objets blob.</span><span class="sxs-lookup"><span data-stu-id="20a16-834">Storage Analytics stores log messages in a delimited format in multiple blobs.</span></span> <span data-ttu-id="20a16-835">format délimité de Hello facilite pour un client de données d’application tooparse hello dans le message du journal hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-835">hello delimited format makes it easy for a client application tooparse hello data in hello log message.</span></span>  

<span data-ttu-id="20a16-836">Stockage Analytique utilise une convention d’affectation de noms pour les objets BLOB qui vous permet de toolocate hello blob (ou des objets BLOB) qui contiennent des messages de journal hello que vous recherchez.</span><span class="sxs-lookup"><span data-stu-id="20a16-836">Storage Analytics uses a naming convention for blobs that enables you toolocate hello blob (or blobs) that contain hello log messages for which you are searching.</span></span> <span data-ttu-id="20a16-837">Par exemple, un objet blob nommé « queue/2014/07/31/1800/000001.log » contient des messages du journal qui concernent le service de file d’attente toohello heure hello en commençant à 18:00 31 juillet 2014.</span><span class="sxs-lookup"><span data-stu-id="20a16-837">For example, a blob named "queue/2014/07/31/1800/000001.log" contains log messages that relate toohello queue service for hello hour starting at 18:00 on 31 July 2014.</span></span> <span data-ttu-id="20a16-838">Hello « 000001 » indique qu’il s’agit du journal première hello pour cette période.</span><span class="sxs-lookup"><span data-stu-id="20a16-838">hello "000001" indicates that this is hello first log file for this period.</span></span> <span data-ttu-id="20a16-839">Analytique de stockage enregistre également les horodatages hello Hello premier et dernier journal des messages stockés dans le fichier de hello dans le cadre des métadonnées d’objet blob hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-839">Storage Analytics also records hello timestamps of hello first and last log messages stored in hello file as part of hello blob's metadata.</span></span> <span data-ttu-id="20a16-840">Hello API pour permet de stockage d’objets blob vous recherchez des objets BLOB dans un conteneur selon un préfixe de nom : toolocate tous les objets BLOB hello qui contiennent la file d’attente les données du journal pour les heures hello en commençant à 18:00, vous pouvez utiliser hello préfixe « file d’attente/2014/07/31/1800. »</span><span class="sxs-lookup"><span data-stu-id="20a16-840">hello API for blob storage enables you locate blobs in a container based on a name prefix: toolocate all hello blobs that contain queue log data for hello hour starting at 18:00, you can use hello prefix "queue/2014/07/31/1800."</span></span>  

<span data-ttu-id="20a16-841">Stockage Analytique met en mémoire tampon des messages de journal en interne et met à jour périodiquement les blob approprié hello ou crée un nouveau avec le dernier lot de hello des entrées de journal.</span><span class="sxs-lookup"><span data-stu-id="20a16-841">Storage Analytics buffers log messages internally and then periodically updates hello appropriate blob or creates a new one with hello latest batch of log entries.</span></span> <span data-ttu-id="20a16-842">Cela réduit le nombre de hello d’écritures, il doit effectuer toohello service d’objets blob.</span><span class="sxs-lookup"><span data-stu-id="20a16-842">This reduces hello number of writes it must perform toohello blob service.</span></span>  

<span data-ttu-id="20a16-843">Si vous implémentez une solution similaire dans votre propre application, vous devez considérer comment toomanage hello compromis entre la fiabilité (écriture de chaque stockage tooblob de journal d’entrée lors de sa réalisation) et de coût et d’évolutivité (mise en mémoire tampon des mises à jour dans votre application et les écrire tooblob stockage dans des lots).</span><span class="sxs-lookup"><span data-stu-id="20a16-843">If you are implementing a similar solution in your own application, you must consider how toomanage hello trade-off between reliability (writing every log entry tooblob storage as it happens) and cost and scalability (buffering updates in your application and writing them tooblob storage in batches).</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="20a16-844">Problèmes et considérations</span><span class="sxs-lookup"><span data-stu-id="20a16-844">Issues and considerations</span></span>
<span data-ttu-id="20a16-845">Tenez compte des points suivants lorsque vous décidez comment toostore enregistrer les données de hello :</span><span class="sxs-lookup"><span data-stu-id="20a16-845">Consider hello following points when deciding how toostore log data:</span></span>  

* <span data-ttu-id="20a16-846">Si vous créez une conception de table qui évite les partitions sensibles potentielles, il est possible que l'accès aux données de journalisation ne soit pas très efficace.</span><span class="sxs-lookup"><span data-stu-id="20a16-846">If you create a table design that avoids potential hot partitions, you may find that you cannot access your log data efficiently.</span></span>  
* <span data-ttu-id="20a16-847">tooprocess les données du journal, un client doit souvent tooload nombre d’enregistrements.</span><span class="sxs-lookup"><span data-stu-id="20a16-847">tooprocess log data, a client often needs tooload many records.</span></span>  
* <span data-ttu-id="20a16-848">Bien que les données de journalisation soient souvent structurées, le stockage d'objets blob peut être une meilleure solution.</span><span class="sxs-lookup"><span data-stu-id="20a16-848">Although log data is often structured, blob storage may be a better solution.</span></span>  

### <a name="implementation-considerations"></a><span data-ttu-id="20a16-849">Considérations relatives à l'implémentation</span><span class="sxs-lookup"><span data-stu-id="20a16-849">Implementation considerations</span></span>
<span data-ttu-id="20a16-850">Cette section décrit certaines des toobear de considérations hello à l’esprit lorsque vous implémentez les modèles hello décrits dans les sections précédentes hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-850">This section discusses some of hello considerations toobear in mind when you implement hello patterns described in hello previous sections.</span></span> <span data-ttu-id="20a16-851">La plupart de cette section utilise des exemples écrits en c# qui utilisent la bibliothèque cliente de stockage (version 4.3.0 lors de l’écriture hello) de hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-851">Most of this section uses examples written in C# that use hello Storage Client Library (version 4.3.0 at hello time of writing).</span></span>  

### <a name="retrieving-entities"></a><span data-ttu-id="20a16-852">Récupération des entités</span><span class="sxs-lookup"><span data-stu-id="20a16-852">Retrieving entities</span></span>
<span data-ttu-id="20a16-853">Comme indiqué dans la section de hello [conception pour l’interrogation](#design-for-querying), requête plus efficace de hello est une requête de point.</span><span class="sxs-lookup"><span data-stu-id="20a16-853">As discussed in hello section [Design for querying](#design-for-querying), hello most efficient query is a point query.</span></span> <span data-ttu-id="20a16-854">Toutefois, dans certains cas vous devrez peut-être tooretrieve plusieurs entités.</span><span class="sxs-lookup"><span data-stu-id="20a16-854">However, in some scenarios you may need tooretrieve multiple entities.</span></span> <span data-ttu-id="20a16-855">Cette section décrit certaines entités de tooretrieving approches courantes à l’aide de la bibliothèque cliente de stockage de hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-855">This section describes some common approaches tooretrieving entities using hello Storage Client Library.</span></span>  

#### <a name="executing-a-point-query-using-hello-storage-client-library"></a><span data-ttu-id="20a16-856">Exécution d’une requête de point à l’aide de la bibliothèque cliente de stockage de hello</span><span class="sxs-lookup"><span data-stu-id="20a16-856">Executing a point query using hello Storage Client Library</span></span>
<span data-ttu-id="20a16-857">tooexecute de façon plus simple Hello une requête de point est toouse hello **récupérer** opération de table comme indiqué dans hello suivant extrait de code c# qui Récupère une entité avec une **PartitionKey** de valeur « ventes » et un  **RowKey** de valeur « 212 » :</span><span class="sxs-lookup"><span data-stu-id="20a16-857">hello easiest way tooexecute a point query is toouse hello **Retrieve** table operation as shown in hello following C# code snippet that retrieves an entity with a **PartitionKey** of value "Sales" and a **RowKey** of value "212":</span></span>  

```csharp
TableOperation retrieveOperation = TableOperation.Retrieve<EmployeeEntity>("Sales", "212");
var retrieveResult = employeeTable.Execute(retrieveOperation);
if (retrieveResult.Result != null)
{
    EmployeeEntity employee = (EmployeeEntity)retrieveResult.Result;
    ...
}  
```

<span data-ttu-id="20a16-858">Notez la façon dont cet exemple attend les entités hello il récupère toobe de type **EmployeeEntity**.</span><span class="sxs-lookup"><span data-stu-id="20a16-858">Notice how this example expects hello entity it retrieves toobe of type **EmployeeEntity**.</span></span>  

#### <a name="retrieving-multiple-entities-using-linq"></a><span data-ttu-id="20a16-859">Récupération de plusieurs entités à l’aide de LINQ</span><span class="sxs-lookup"><span data-stu-id="20a16-859">Retrieving multiple entities using LINQ</span></span>
<span data-ttu-id="20a16-860">Vous pouvez extraire plusieurs entités à l’aide de LINQ avec la bibliothèque cliente de stockage et en spécifiant une requête avec une clause **where** .</span><span class="sxs-lookup"><span data-stu-id="20a16-860">You can retrieve multiple entities by using LINQ with Storage Client Library and specifying a query with a **where** clause.</span></span> <span data-ttu-id="20a16-861">tooavoid une analyse de table, vous devez toujours inclure hello **PartitionKey** valeur Bonjour où clause et si possible hello **RowKey** tooavoid les analyses de table et de partition de valeur.</span><span class="sxs-lookup"><span data-stu-id="20a16-861">tooavoid a table scan, you should always include hello **PartitionKey** value in hello where clause, and if possible hello **RowKey** value tooavoid table and partition scans.</span></span> <span data-ttu-id="20a16-862">Hello service table prend en charge un ensemble limité de toouse de (supérieur à, supérieur ou égal à, inférieur à, inférieur ou égal, égal et n’est pas égal) d’opérateurs de comparaison dans hello où clause.</span><span class="sxs-lookup"><span data-stu-id="20a16-862">hello table service supports a limited set of comparison operators (greater than, greater than or equal, less than, less than or equal, equal, and not equal) toouse in hello where clause.</span></span> <span data-ttu-id="20a16-863">Hello extrait de code c# suivant recherche tous les employés hello dont le nom commence par « B » (en supposant que hello **RowKey** magasins hello nom) dans le service commercial hello (en supposant que hello **PartitionKey** magasins hello nom du service) :</span><span class="sxs-lookup"><span data-stu-id="20a16-863">hello following C# code snippet finds all hello employees whose last name starts with "B" (assuming that hello **RowKey** stores hello last name) in hello sales department (assuming hello **PartitionKey** stores hello department name):</span></span>  

```csharp
TableQuery<EmployeeEntity> employeeQuery = employeeTable.CreateQuery<EmployeeEntity>();
var query = (from employee in employeeQuery
            where employee.PartitionKey == "Sales" &&
            employee.RowKey.CompareTo("B") >= 0 &&
            employee.RowKey.CompareTo("C") < 0
            select employee).AsTableQuery();
var employees = query.Execute();  
```

<span data-ttu-id="20a16-864">Notez la façon dont les requêtes hello spécifie à la fois un **RowKey** et un **PartitionKey** tooensure de meilleur performances.</span><span class="sxs-lookup"><span data-stu-id="20a16-864">Notice how hello query specifies both a **RowKey** and a **PartitionKey** tooensure better performance.</span></span>  

<span data-ttu-id="20a16-865">Hello exemple de code suivant montre une fonctionnalité équivalente à l’aide des API fluent de hello (pour plus d’informations sur l’API fluent en général, consultez [meilleures pratiques pour la conception d’une API Fluent](http://visualstudiomagazine.com/articles/2013/12/01/best-practices-for-designing-a-fluent-api.aspx)) :</span><span class="sxs-lookup"><span data-stu-id="20a16-865">hello following code sample shows equivalent functionality using hello fluent API (for more information about fluent APIs in general, see [Best Practices for Designing a Fluent API](http://visualstudiomagazine.com/articles/2013/12/01/best-practices-for-designing-a-fluent-api.aspx)):</span></span>  

```csharp
TableQuery<EmployeeEntity> employeeQuery = new TableQuery<EmployeeEntity>().Where(
    TableQuery.CombineFilters(
    TableQuery.CombineFilters(
        TableQuery.GenerateFilterCondition(
    "PartitionKey", QueryComparisons.Equal, "Sales"),
    TableOperators.And,
    TableQuery.GenerateFilterCondition(
    "RowKey", QueryComparisons.GreaterThanOrEqual, "B")
),
TableOperators.And,
TableQuery.GenerateFilterCondition("RowKey", QueryComparisons.LessThan, "C")
    )
);
var employees = employeeTable.ExecuteQuery(employeeQuery);  
```

> [!NOTE]
> <span data-ttu-id="20a16-866">exemple Hello imbrique plusieurs **CombineFilters** tooinclude de méthodes hello trois conditions de filtre.</span><span class="sxs-lookup"><span data-stu-id="20a16-866">hello sample nests multiple **CombineFilters** methods tooinclude hello three filter conditions.</span></span>  
> 
> 

#### <a name="retrieving-large-numbers-of-entities-from-a-query"></a><span data-ttu-id="20a16-867">Récupération d'un grand nombre d'entités à partir d'une requête</span><span class="sxs-lookup"><span data-stu-id="20a16-867">Retrieving large numbers of entities from a query</span></span>
<span data-ttu-id="20a16-868">Une requête optimale renvoie une entité individuelle basée sur une valeur de **PartitionKey** et une valeur de **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="20a16-868">An optimal query returns an individual entity based on a **PartitionKey** value and a **RowKey** value.</span></span> <span data-ttu-id="20a16-869">Toutefois, dans certains scénarios vous avez peut-être un tooreturn exigence d’entités à partir de hello même partition ou même à partir de plusieurs partitions.</span><span class="sxs-lookup"><span data-stu-id="20a16-869">However, in some scenarios you may have a requirement tooreturn many entities from hello same partition or even from many partitions.</span></span>  

<span data-ttu-id="20a16-870">Vous devez toujours entièrement tester les performances de hello de votre application dans de tels scénarios.</span><span class="sxs-lookup"><span data-stu-id="20a16-870">You should always fully test hello performance of your application in such scenarios.</span></span>  

<span data-ttu-id="20a16-871">Une requête sur le service de table hello peut renvoyer un maximum de 1 000 entités à la fois et peut s’exécuter pendant un maximum de cinq secondes.</span><span class="sxs-lookup"><span data-stu-id="20a16-871">A query against hello table service may return a maximum of 1,000 entities at one time and may execute for a maximum of five seconds.</span></span> <span data-ttu-id="20a16-872">Si le jeu de résultats hello contient plus de 1 000 entités, si la requête de hello ne s’est pas terminée dans les cinq secondes, ou si la requête de hello dépasse la limite de partition hello, hello service Table renvoie un tooenable de jeton de continuation hello messages hello du client application toorequest ensemble suivant d’entités.</span><span class="sxs-lookup"><span data-stu-id="20a16-872">If hello result set contains more than 1,000 entities, if hello query did not complete within five seconds, or if hello query crosses hello partition boundary, hello Table service returns a continuation token tooenable hello client application toorequest hello next set of entities.</span></span> <span data-ttu-id="20a16-873">Pour plus d’informations sur la façon dont fonctionnent les jetons de continuation, consultez [Délai de requête et pagination](http://msdn.microsoft.com/library/azure/dd135718.aspx).</span><span class="sxs-lookup"><span data-stu-id="20a16-873">For more information about how continuation tokens work, see [Query Timeout and Pagination](http://msdn.microsoft.com/library/azure/dd135718.aspx).</span></span>  

<span data-ttu-id="20a16-874">Si vous utilisez hello bibliothèque cliente de stockage, il peut gérer automatiquement les jetons de continuation pour vous qu’elle retourne des entités à partir de hello service de Table.</span><span class="sxs-lookup"><span data-stu-id="20a16-874">If you are using hello Storage Client Library, it can automatically handle continuation tokens for you as it returns entities from hello Table service.</span></span> <span data-ttu-id="20a16-875">Hello c# exemple de code suivant à l’aide de hello bibliothèque cliente de stockage automatiquement gère les jetons de continuation si le service de table hello les retourne dans une réponse :</span><span class="sxs-lookup"><span data-stu-id="20a16-875">hello following C# code sample using hello Storage Client Library automatically handles continuation tokens if hello table service returns them in a response:</span></span>  

```csharp
string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, "Sales");
TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter);

var employees = employeeTable.ExecuteQuery(employeeQuery);
foreach (var emp in employees)
{
        ...
}  
```

<span data-ttu-id="20a16-876">Hello suivant de code c# gère les jetons de continuation explicitement :</span><span class="sxs-lookup"><span data-stu-id="20a16-876">hello following C# code handles continuation tokens explicitly:</span></span>  

```csharp
string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, "Sales");
TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter);

TableContinuationToken continuationToken = null;

do
{
        var employees = employeeTable.ExecuteQuerySegmented(
        employeeQuery, continuationToken);
    foreach (var emp in employees)
    {
    ...
    }
    continuationToken = employees.ContinuationToken;
} while (continuationToken != null);  
```

<span data-ttu-id="20a16-877">À l’aide de jetons de continuation explicitement, vous pouvez contrôler quand votre application récupère le segment suivant de hello de données.</span><span class="sxs-lookup"><span data-stu-id="20a16-877">By using continuation tokens explicitly, you can control when your application retrieves hello next segment of data.</span></span> <span data-ttu-id="20a16-878">Par exemple, si votre application cliente Active toopage les utilisateurs par le biais des entités hello stockées dans une table, un utilisateur peut décider pas toopage via toutes les entités hello hello requête extrait votre application uniquement utiliserait un Bonjour tooretrieve de jeton de continuation suivant segment lors de l’utilisateur de hello a fini de pagination de toutes les entités hello dans le segment actuel de hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-878">For example, if your client application enables users toopage through hello entities stored in a table, a user may decide not toopage through all hello entities retrieved by hello query so your application would only use a continuation token tooretrieve hello next segment when hello user had finished paging through all hello entities in hello current segment.</span></span> <span data-ttu-id="20a16-879">Cette approche présente plusieurs avantages :</span><span class="sxs-lookup"><span data-stu-id="20a16-879">This approach has several benefits:</span></span>  

* <span data-ttu-id="20a16-880">Il vous permet de durée hello toolimit tooretrieve de données à partir de hello service de Table et que vous déplacez réseau hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-880">It enables you toolimit hello amount of data tooretrieve from hello Table service and that you move over hello network.</span></span>  
* <span data-ttu-id="20a16-881">Il permet de vous tooperform e/s asynchrone dans .NET.</span><span class="sxs-lookup"><span data-stu-id="20a16-881">It enables you tooperform asynchronous IO in .NET.</span></span>  
* <span data-ttu-id="20a16-882">Il vous permet le stockage de jeton toopersistent tooserialize hello continuation pour pouvoir continuer dans les cas de hello d’incident d’application.</span><span class="sxs-lookup"><span data-stu-id="20a16-882">It enables you tooserialize hello continuation token toopersistent storage so you can continue in hello event of an application crash.</span></span>  

> [!NOTE]
> <span data-ttu-id="20a16-883">En général, un jeton de liaison retourne un segment contenant 1 000 entités, bien qu'il puisse y en avoir moins.</span><span class="sxs-lookup"><span data-stu-id="20a16-883">A continuation token typically returns a segment containing 1,000 entities, although it may be fewer.</span></span> <span data-ttu-id="20a16-884">C’est également hello cas si vous limitez le nombre de hello d’une requête retourne à l’aide des entrées **prendre** tooreturn hello première n entités qui correspondent à vos critères de recherche : service de table hello peut retourner un segment contenant moins de n entités le long avec un tooenable de jeton de continuation vous tooretrieve hello autres entités.</span><span class="sxs-lookup"><span data-stu-id="20a16-884">This is also hello case if you limit hello number of entries a query returns by using **Take** tooreturn hello first n entities that match your lookup criteria: hello table service may return a segment containing fewer than n entities along with a continuation token tooenable you tooretrieve hello remaining entities.</span></span>  
> 
> 

<span data-ttu-id="20a16-885">Hello code c# suivant montre comment le nombre de hello toomodify d’entités retournées à l’intérieur d’un segment :</span><span class="sxs-lookup"><span data-stu-id="20a16-885">hello following C# code shows how toomodify hello number of entities returned inside a segment:</span></span>  

```csharp
employeeQuery.TakeCount = 50;  
```

#### <a name="server-side-projection"></a><span data-ttu-id="20a16-886">Projection côté serveur</span><span class="sxs-lookup"><span data-stu-id="20a16-886">Server-side projection</span></span>
<span data-ttu-id="20a16-887">Une seule entité too255 propriétés et d’être up too1 Mo.</span><span class="sxs-lookup"><span data-stu-id="20a16-887">A single entity can have up too255 properties and be up too1 MB in size.</span></span> <span data-ttu-id="20a16-888">Lorsque vous interrogez la table de hello et récupérer des entités, vous devrez peut-être pas toutes les propriétés de hello et peut éviter le transfert de données inutilement (toohelp réduire la latence et coût).</span><span class="sxs-lookup"><span data-stu-id="20a16-888">When you query hello table and retrieve entities, you may not need all hello properties and can avoid transferring data unnecessarily (toohelp reduce latency and cost).</span></span> <span data-ttu-id="20a16-889">Vous pouvez utiliser les propriétés de hello simplement de tootransfer de projection du côté serveur, que vous avez besoin.</span><span class="sxs-lookup"><span data-stu-id="20a16-889">You can use server-side projection tootransfer just hello properties you need.</span></span> <span data-ttu-id="20a16-890">Bonjour exemple suivant est extrait simplement hello **messagerie** propriété (avec **PartitionKey**, **RowKey**, **Timestamp**et  **ETag**) à partir des entités hello sélectionnées par la requête de hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-890">hello following example is retrieves just hello **Email** property (along with **PartitionKey**, **RowKey**, **Timestamp**, and **ETag**) from hello entities selected by hello query.</span></span>  

```csharp
string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, "Sales");
List<string> columns = new List<string>() { "Email" };
TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter).Select(columns);

var entities = employeeTable.ExecuteQuery(employeeQuery);
foreach (var e in entities)
{
        Console.WriteLine("RowKey: {0}, EmployeeEmail: {1}", e.RowKey, e.Email);
}  
```

<span data-ttu-id="20a16-891">Notez comment hello **RowKey** valeur est disponible même si elle ne figurait pas dans la liste hello des propriétés tooretrieve.</span><span class="sxs-lookup"><span data-stu-id="20a16-891">Notice how hello **RowKey** value is available even though it was not included in hello list of properties tooretrieve.</span></span>  

### <a name="modifying-entities"></a><span data-ttu-id="20a16-892">Modification des entités</span><span class="sxs-lookup"><span data-stu-id="20a16-892">Modifying entities</span></span>
<span data-ttu-id="20a16-893">Hello bibliothèque cliente de stockage permet toomodify vos entités stockées dans le service de table hello par l’insertion, la suppression et la mise à jour des entités.</span><span class="sxs-lookup"><span data-stu-id="20a16-893">hello Storage Client Library enables you toomodify your entities stored in hello table service by inserting, deleting, and updating entities.</span></span> <span data-ttu-id="20a16-894">Vous pouvez utiliser EGTs toobatch plusieurs insert, update et delete opérations nombre de hello tooreduce ensemble d’allers-retours requis et améliorer les performances de hello de votre solution.</span><span class="sxs-lookup"><span data-stu-id="20a16-894">You can use EGTs toobatch multiple insert, update, and delete operations together tooreduce hello number of round trips required and improve hello performance of your solution.</span></span>  

<span data-ttu-id="20a16-895">Notez que les exceptions levées lorsque hello bibliothèque cliente de stockage s’exécute en général un EGT incluent des index hello d’entité hello hello lot toofail à l’origine.</span><span class="sxs-lookup"><span data-stu-id="20a16-895">Note that exceptions thrown when hello Storage Client Library executes an EGT typically include hello index of hello entity that caused hello batch toofail.</span></span> <span data-ttu-id="20a16-896">Cela est utile lorsque vous déboguez du code qui utilise des EGT.</span><span class="sxs-lookup"><span data-stu-id="20a16-896">This is helpful when you are debugging code that uses EGTs.</span></span>  

<span data-ttu-id="20a16-897">Nous vous conseillons de réfléchir également à la façon dont votre conception affecte la méthode de votre application cliente pour gérer les opérations d'accès concurrentiel et de mises à jour.</span><span class="sxs-lookup"><span data-stu-id="20a16-897">You should also consider how your design affects how your client application handles concurrency and update operations.</span></span>  

#### <a name="managing-concurrency"></a><span data-ttu-id="20a16-898">Gérer l'accès concurrentiel</span><span class="sxs-lookup"><span data-stu-id="20a16-898">Managing concurrency</span></span>
<span data-ttu-id="20a16-899">Par défaut, le service de table hello implémente optimiste de contrôle d’accès concurrentiel au niveau de hello d’entités individuelles pour **insérer**, **fusion**, et **supprimer** opérations, Bien qu’il soit possible pour un Bonjour tooforce de client de service toobypass table ces vérifications.</span><span class="sxs-lookup"><span data-stu-id="20a16-899">By default, hello table service implements optimistic concurrency checks at hello level of individual entities for **Insert**, **Merge**, and **Delete** operations, although it is possible for a client tooforce hello table service toobypass these checks.</span></span> <span data-ttu-id="20a16-900">Pour plus d’informations sur la manière dont service de table hello gère l’accès concurrentiel, consultez [la gestion de l’accès concurrentiel dans Microsoft Azure Storage](../storage/common/storage-concurrency.md).</span><span class="sxs-lookup"><span data-stu-id="20a16-900">For more information about how hello table service manages concurrency, see  [Managing Concurrency in Microsoft Azure Storage](../storage/common/storage-concurrency.md).</span></span>  

#### <a name="merge-or-replace"></a><span data-ttu-id="20a16-901">Fusion ou remplacement</span><span class="sxs-lookup"><span data-stu-id="20a16-901">Merge or replace</span></span>
<span data-ttu-id="20a16-902">Hello **remplacer** méthode Hello **TableOperation** classe remplace toujours l’entité complète de hello Bonjour service de Table.</span><span class="sxs-lookup"><span data-stu-id="20a16-902">hello **Replace** method of hello **TableOperation** class always replaces hello complete entity in hello Table service.</span></span> <span data-ttu-id="20a16-903">Si vous n’incluez pas une propriété dans la demande hello lorsque cette propriété existe dans l’entité de stockée hello, demande de hello supprime que la propriété à partir de hello stockées entité.</span><span class="sxs-lookup"><span data-stu-id="20a16-903">If you do not include a property in hello request when that property exists in hello stored entity, hello request removes that property from hello stored entity.</span></span> <span data-ttu-id="20a16-904">Sauf si vous souhaitez tooremove une propriété explicitement à partir d’une entité stockée, vous devez inclure chaque propriété dans la demande hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-904">Unless you want tooremove a property explicitly from a stored entity, you must include every property in hello request.</span></span>  

<span data-ttu-id="20a16-905">Vous pouvez utiliser hello **fusion** méthode Hello **TableOperation** classe tooreduce hello quantité des données que vous envoyez service de Table toohello lorsque vous souhaitez tooupdate une entité.</span><span class="sxs-lookup"><span data-stu-id="20a16-905">You can use hello **Merge** method of hello **TableOperation** class tooreduce hello amount of data that you send toohello Table service when you want tooupdate an entity.</span></span> <span data-ttu-id="20a16-906">Hello **fusion** méthode remplace toutes les propriétés de l’entité de hello stockée avec les valeurs de propriété d’entité hello inclus dans la demande de hello, mais laisse intactes toutes les propriétés de hello stockées entité qui ne sont pas inclus dans la demande hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-906">hello **Merge** method replaces any properties in hello stored entity with property values from hello entity included in hello request, but leaves intact any properties in hello stored entity that are not included in hello request.</span></span> <span data-ttu-id="20a16-907">Cela est utile si vous avez entités volumineuses, il vous suffit de tooupdate un petit nombre de propriétés dans une demande.</span><span class="sxs-lookup"><span data-stu-id="20a16-907">This is useful if you have large entities and only need tooupdate a small number of properties in a request.</span></span>  

> [!NOTE]
> <span data-ttu-id="20a16-908">Hello **remplacer** et **fusion** méthodes échouent si hello entité n’existe pas.</span><span class="sxs-lookup"><span data-stu-id="20a16-908">hello **Replace** and **Merge** methods fail if hello entity does not exist.</span></span> <span data-ttu-id="20a16-909">En guise d’alternative, vous pouvez utiliser hello **InsertOrReplace** et **InsertOrMerge** des méthodes qui créent une nouvelle entité si elle n’existe pas.</span><span class="sxs-lookup"><span data-stu-id="20a16-909">As an alternative, you can use hello **InsertOrReplace** and **InsertOrMerge** methods that create a new entity if it doesn't exist.</span></span>  
> 
> 

### <a name="working-with-heterogeneous-entity-types"></a><span data-ttu-id="20a16-910">Utilisation des types d’entités hétérogènes</span><span class="sxs-lookup"><span data-stu-id="20a16-910">Working with heterogeneous entity types</span></span>
<span data-ttu-id="20a16-911">Hello service de Table est un *sans schéma* magasin de tables qui signifie qu’une seule table peut stocker des entités de plusieurs types en fournissant une grande souplesse dans votre conception.</span><span class="sxs-lookup"><span data-stu-id="20a16-911">hello Table service is a *schema-less* table store that means that a single table can store entities of multiple types providing great flexibility in your design.</span></span> <span data-ttu-id="20a16-912">Hello exemple suivant illustre une table qui stocke les entités de service et de l’employé :</span><span class="sxs-lookup"><span data-stu-id="20a16-912">hello following example illustrates a table storing both employee and department entities:</span></span>  

<table>
<tr>
<th><span data-ttu-id="20a16-913">PartitionKey</span><span class="sxs-lookup"><span data-stu-id="20a16-913">PartitionKey</span></span></th>
<th><span data-ttu-id="20a16-914">RowKey</span><span class="sxs-lookup"><span data-stu-id="20a16-914">RowKey</span></span></th>
<th><span data-ttu-id="20a16-915">Timestamp</span><span class="sxs-lookup"><span data-stu-id="20a16-915">Timestamp</span></span></th>
<th></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="20a16-916">FirstName</span><span class="sxs-lookup"><span data-stu-id="20a16-916">FirstName</span></span></th>
<th><span data-ttu-id="20a16-917">LastName</span><span class="sxs-lookup"><span data-stu-id="20a16-917">LastName</span></span></th>
<th><span data-ttu-id="20a16-918">Age</span><span class="sxs-lookup"><span data-stu-id="20a16-918">Age</span></span></th>
<th><span data-ttu-id="20a16-919">Email</span><span class="sxs-lookup"><span data-stu-id="20a16-919">Email</span></span></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="20a16-920">FirstName</span><span class="sxs-lookup"><span data-stu-id="20a16-920">FirstName</span></span></th>
<th><span data-ttu-id="20a16-921">LastName</span><span class="sxs-lookup"><span data-stu-id="20a16-921">LastName</span></span></th>
<th><span data-ttu-id="20a16-922">Age</span><span class="sxs-lookup"><span data-stu-id="20a16-922">Age</span></span></th>
<th><span data-ttu-id="20a16-923">Email</span><span class="sxs-lookup"><span data-stu-id="20a16-923">Email</span></span></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="20a16-924">DepartmentName</span><span class="sxs-lookup"><span data-stu-id="20a16-924">DepartmentName</span></span></th>
<th><span data-ttu-id="20a16-925">EmployeeCount</span><span class="sxs-lookup"><span data-stu-id="20a16-925">EmployeeCount</span></span></th>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</table>
</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="20a16-926">FirstName</span><span class="sxs-lookup"><span data-stu-id="20a16-926">FirstName</span></span></th>
<th><span data-ttu-id="20a16-927">LastName</span><span class="sxs-lookup"><span data-stu-id="20a16-927">LastName</span></span></th>
<th><span data-ttu-id="20a16-928">Age</span><span class="sxs-lookup"><span data-stu-id="20a16-928">Age</span></span></th>
<th><span data-ttu-id="20a16-929">Email</span><span class="sxs-lookup"><span data-stu-id="20a16-929">Email</span></span></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</td>
</tr>
</table>

<span data-ttu-id="20a16-930">Notez que chaque entité doit toujours avoir les valeurs **PartitionKey**, **RowKey** et **Timestamp**, mais elle peut aussi avoir n’importe quel ensemble de propriétés.</span><span class="sxs-lookup"><span data-stu-id="20a16-930">Note that each entity must still have **PartitionKey**, **RowKey**, and **Timestamp** values, but may have any set of properties.</span></span> <span data-ttu-id="20a16-931">En outre, aucune est tooindicate hello de type d’une entité, sauf si vous choisissez toostore ces informations quelque part.</span><span class="sxs-lookup"><span data-stu-id="20a16-931">Furthermore, there is nothing tooindicate hello type of an entity unless you choose toostore that information somewhere.</span></span> <span data-ttu-id="20a16-932">Il existe deux options pour identifier le type d’entité hello :</span><span class="sxs-lookup"><span data-stu-id="20a16-932">There are two options for identifying hello entity type:</span></span>  

* <span data-ttu-id="20a16-933">Ajouter toohello de type d’entité hello **RowKey** (ou éventuellement hello **PartitionKey**).</span><span class="sxs-lookup"><span data-stu-id="20a16-933">Prepend hello entity type toohello **RowKey** (or possibly hello **PartitionKey**).</span></span> <span data-ttu-id="20a16-934">Par exemple, **EMPLOYEE_000123** ou **DEPARTMENT_SALES** en tant que valeurs de **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="20a16-934">For example, **EMPLOYEE_000123** or **DEPARTMENT_SALES** as **RowKey** values.</span></span>  
* <span data-ttu-id="20a16-935">Utilisez un type d’entité propriété distinct toorecord hello comme indiqué dans le tableau hello ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="20a16-935">Use a separate property toorecord hello entity type as shown in hello table below.</span></span>  

<table>
<tr>
<th><span data-ttu-id="20a16-936">PartitionKey</span><span class="sxs-lookup"><span data-stu-id="20a16-936">PartitionKey</span></span></th>
<th><span data-ttu-id="20a16-937">RowKey</span><span class="sxs-lookup"><span data-stu-id="20a16-937">RowKey</span></span></th>
<th><span data-ttu-id="20a16-938">Timestamp</span><span class="sxs-lookup"><span data-stu-id="20a16-938">Timestamp</span></span></th>
<th></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="20a16-939">EventType</span><span class="sxs-lookup"><span data-stu-id="20a16-939">EntityType</span></span></th>
<th><span data-ttu-id="20a16-940">FirstName</span><span class="sxs-lookup"><span data-stu-id="20a16-940">FirstName</span></span></th>
<th><span data-ttu-id="20a16-941">LastName</span><span class="sxs-lookup"><span data-stu-id="20a16-941">LastName</span></span></th>
<th><span data-ttu-id="20a16-942">Age</span><span class="sxs-lookup"><span data-stu-id="20a16-942">Age</span></span></th>
<th><span data-ttu-id="20a16-943">Email</span><span class="sxs-lookup"><span data-stu-id="20a16-943">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="20a16-944">Employee</span><span class="sxs-lookup"><span data-stu-id="20a16-944">Employee</span></span></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="20a16-945">EntityType</span><span class="sxs-lookup"><span data-stu-id="20a16-945">EntityType</span></span></th>
<th><span data-ttu-id="20a16-946">FirstName</span><span class="sxs-lookup"><span data-stu-id="20a16-946">FirstName</span></span></th>
<th><span data-ttu-id="20a16-947">LastName</span><span class="sxs-lookup"><span data-stu-id="20a16-947">LastName</span></span></th>
<th><span data-ttu-id="20a16-948">Age</span><span class="sxs-lookup"><span data-stu-id="20a16-948">Age</span></span></th>
<th><span data-ttu-id="20a16-949">Email</span><span class="sxs-lookup"><span data-stu-id="20a16-949">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="20a16-950">Employee</span><span class="sxs-lookup"><span data-stu-id="20a16-950">Employee</span></span></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="20a16-951">EventType</span><span class="sxs-lookup"><span data-stu-id="20a16-951">EntityType</span></span></th>
<th><span data-ttu-id="20a16-952">DepartmentName</span><span class="sxs-lookup"><span data-stu-id="20a16-952">DepartmentName</span></span></th>
<th><span data-ttu-id="20a16-953">EmployeeCount</span><span class="sxs-lookup"><span data-stu-id="20a16-953">EmployeeCount</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="20a16-954">department</span><span class="sxs-lookup"><span data-stu-id="20a16-954">Department</span></span></td>
<td></td>
<td></td>
</tr>
</table>
</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="20a16-955">EventType</span><span class="sxs-lookup"><span data-stu-id="20a16-955">EntityType</span></span></th>
<th><span data-ttu-id="20a16-956">FirstName</span><span class="sxs-lookup"><span data-stu-id="20a16-956">FirstName</span></span></th>
<th><span data-ttu-id="20a16-957">LastName</span><span class="sxs-lookup"><span data-stu-id="20a16-957">LastName</span></span></th>
<th><span data-ttu-id="20a16-958">Age</span><span class="sxs-lookup"><span data-stu-id="20a16-958">Age</span></span></th>
<th><span data-ttu-id="20a16-959">Email</span><span class="sxs-lookup"><span data-stu-id="20a16-959">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="20a16-960">Employee</span><span class="sxs-lookup"><span data-stu-id="20a16-960">Employee</span></span></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</td>
</tr>
</table>

<span data-ttu-id="20a16-961">première option Hello, ajoutant hello entité type toohello **RowKey**, est utile s’il existe un risque que les deux entités de types différents peuvent avoir hello même valeur de clé.</span><span class="sxs-lookup"><span data-stu-id="20a16-961">hello first option, prepending hello entity type toohello **RowKey**, is useful if there is a possibility that two entities of different types might have hello same key value.</span></span> <span data-ttu-id="20a16-962">Il regroupe également des entités de hello même type ensemble dans la partition de hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-962">It also groups entities of hello same type together in hello partition.</span></span>  

<span data-ttu-id="20a16-963">Hello techniques présentées dans cette section sont particulièrement toohello discussion [des relations d’héritage](#inheritance-relationships) plus haut dans ce guide dans la section de hello [modélisation relations](#modelling-relationships).</span><span class="sxs-lookup"><span data-stu-id="20a16-963">hello techniques discussed in this section are especially relevant toohello discussion [Inheritance relationships](#inheritance-relationships) earlier in this guide in hello section [Modelling relationships](#modelling-relationships).</span></span>  

> [!NOTE]
> <span data-ttu-id="20a16-964">Vous devez envisager d’inclure un numéro de version dans hello entité type valeur tooenable client applications tooevolve POCO des objets et travailler avec des versions différentes.</span><span class="sxs-lookup"><span data-stu-id="20a16-964">You should consider including a version number in hello entity type value tooenable client applications tooevolve POCO objects and work with different versions.</span></span>  
> 
> 

<span data-ttu-id="20a16-965">Hello reste de cette section décrit certaines des fonctionnalités hello Bonjour bibliothèque cliente de stockage qui facilitent l’utilisation de plusieurs types d’entités Bonjour, même table.</span><span class="sxs-lookup"><span data-stu-id="20a16-965">hello remainder of this section describes some of hello features in hello Storage Client Library that facilitate working with multiple entity types in hello same table.</span></span>  

#### <a name="retrieving-heterogeneous-entity-types"></a><span data-ttu-id="20a16-966">Récupération de types d'entités hétérogènes</span><span class="sxs-lookup"><span data-stu-id="20a16-966">Retrieving heterogeneous entity types</span></span>
<span data-ttu-id="20a16-967">Si vous utilisez hello bibliothèque cliente de stockage, vous avez trois options pour travailler avec plusieurs types d’entités.</span><span class="sxs-lookup"><span data-stu-id="20a16-967">If you are using hello Storage Client Library, you have three options for working with multiple entity types.</span></span>  

<span data-ttu-id="20a16-968">Si vous connaissez le type hello d’entité hello stockée avec un spécifique **RowKey** et **PartitionKey** valeurs, vous pouvez spécifier le type d’entité hello lorsque vous récupérez une entité de hello comme indiqué dans les exemples hello deux précédents pour récupérer les entités de type **EmployeeEntity**: [l’exécution d’une requête de point à l’aide de la bibliothèque cliente de stockage de hello](#executing-a-point-query-using-the-storage-client-library) et [la récupération de plusieurs entités à l’aide de LINQ](#retrieving-multiple-entities-using-linq).</span><span class="sxs-lookup"><span data-stu-id="20a16-968">If you know hello type of hello entity stored with a specific **RowKey** and **PartitionKey** values, then you can specify hello entity type when you retrieve hello entity as shown in hello previous two examples that retrieve entities of type **EmployeeEntity**: [Executing a point query using hello Storage Client Library](#executing-a-point-query-using-the-storage-client-library) and [Retrieving multiple entities using LINQ](#retrieving-multiple-entities-using-linq).</span></span>  

<span data-ttu-id="20a16-969">deuxième option de Hello est toouse hello **DynamicTableEntity** type (un sac de propriétés) au lieu d’un type d’entité POCO concrète (cette option peut également améliorer les performances, car il n’existe aucun besoin tooserialize et désérialiser les entités hello trop. Types de réseau).</span><span class="sxs-lookup"><span data-stu-id="20a16-969">hello second option is toouse hello **DynamicTableEntity** type (a property bag) instead of a concrete POCO entity type (this option may also improve performance because there is no need tooserialize and deserialize hello entity too.NET types).</span></span> <span data-ttu-id="20a16-970">Hello suivant le code c# potentiellement récupère plusieurs entités de différents types de table de hello, mais retourne toutes les entités en tant que **DynamicTableEntity** instances.</span><span class="sxs-lookup"><span data-stu-id="20a16-970">hello following C# code potentially retrieves multiple entities of different types from hello table, but returns all entities as **DynamicTableEntity** instances.</span></span> <span data-ttu-id="20a16-971">Il utilise ensuite hello **EntityType** type hello toodetermine de chaque entité :</span><span class="sxs-lookup"><span data-stu-id="20a16-971">It then uses hello **EntityType** property toodetermine hello type of each entity:</span></span>  

```csharp
string filter = TableQuery.CombineFilters(
    TableQuery.GenerateFilterCondition("PartitionKey",
    QueryComparisons.Equal, "Sales"),
    TableOperators.And,
    TableQuery.CombineFilters(
    TableQuery.GenerateFilterCondition("RowKey",
                    QueryComparisons.GreaterThanOrEqual, "B"),
        TableOperators.And,
        TableQuery.GenerateFilterCondition("RowKey",
        QueryComparisons.LessThan, "F")
    )
);
TableQuery<DynamicTableEntity> entityQuery =
    new TableQuery<DynamicTableEntity>().Where(filter);
var employees = employeeTable.ExecuteQuery(entityQuery);

IEnumerable<DynamicTableEntity> entities = employeeTable.ExecuteQuery(entityQuery);
foreach (var e in entities)
{
EntityProperty entityTypeProperty;
if (e.Properties.TryGetValue("EntityType", out entityTypeProperty))
{
    if (entityTypeProperty.StringValue == "Employee")
    {
        // Use entityTypeProperty, RowKey, PartitionKey, Etag, and Timestamp
        }
    }
}  
```

<span data-ttu-id="20a16-972">Notez que tooretrieve autres propriétés que vous devez utiliser hello **TryGetValue** méthode sur hello **propriétés** propriété Hello **DynamicTableEntity** classe.</span><span class="sxs-lookup"><span data-stu-id="20a16-972">Note that tooretrieve other properties you must use hello **TryGetValue** method on hello **Properties** property of hello **DynamicTableEntity** class.</span></span>  

<span data-ttu-id="20a16-973">Une troisième option est toocombine à l’aide de hello **DynamicTableEntity** type et un **EntityResolver** instance.</span><span class="sxs-lookup"><span data-stu-id="20a16-973">A third option is toocombine using hello **DynamicTableEntity** type and an **EntityResolver** instance.</span></span> <span data-ttu-id="20a16-974">Cela vous permet de tooresolve toomultiple POCO types Bonjour même requête.</span><span class="sxs-lookup"><span data-stu-id="20a16-974">This enables you tooresolve toomultiple POCO types in hello same query.</span></span> <span data-ttu-id="20a16-975">Dans cet exemple, hello **EntityResolver** délégué à l’aide de hello **EntityType** toodistinguish de propriété entre types hello deux d’entité qui hello requête retourne.</span><span class="sxs-lookup"><span data-stu-id="20a16-975">In this example, hello **EntityResolver** delegate is using hello **EntityType** property toodistinguish between hello two types of entity that hello query returns.</span></span> <span data-ttu-id="20a16-976">Hello **résoudre** méthode utilise hello **résolveur** déléguer tooresolve **DynamicTableEntity** trop d’instances**TableEntity** instances.</span><span class="sxs-lookup"><span data-stu-id="20a16-976">hello **Resolve** method uses hello **resolver** delegate tooresolve **DynamicTableEntity** instances too**TableEntity** instances.</span></span>  

```csharp
EntityResolver<TableEntity> resolver = (pk, rk, ts, props, etag) =>
{

        TableEntity resolvedEntity = null;
        if (props["EntityType"].StringValue == "Department")
        {
        resolvedEntity = new DepartmentEntity();
        }
        else if (props["EntityType"].StringValue == "Employee")
        {
        resolvedEntity = new EmployeeEntity();
        }
        else throw new ArgumentException("Unrecognized entity", "props");

        resolvedEntity.PartitionKey = pk;
        resolvedEntity.RowKey = rk;
        resolvedEntity.Timestamp = ts;
        resolvedEntity.ETag = etag;
        resolvedEntity.ReadEntity(props, null);
        return resolvedEntity;
};

string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, "Sales");
TableQuery<DynamicTableEntity> entityQuery =
        new TableQuery<DynamicTableEntity>().Where(filter);

var entities = employeeTable.ExecuteQuery(entityQuery, resolver);
foreach (var e in entities)
{
        if (e is DepartmentEntity)
        {
    ...
        }
        if (e is EmployeeEntity)
        {
    ...
        }
}  
```

#### <a name="modifying-heterogeneous-entity-types"></a><span data-ttu-id="20a16-977">Modification des types d'entités hétérogènes</span><span class="sxs-lookup"><span data-stu-id="20a16-977">Modifying heterogeneous entity types</span></span>
<span data-ttu-id="20a16-978">Il est inutile type hello de tooknow d’une entité de toodelete vous savez toujours de type hello d’une entité lorsque vous insérez.</span><span class="sxs-lookup"><span data-stu-id="20a16-978">You do not need tooknow hello type of an entity toodelete it, and you always know hello type of an entity when you insert it.</span></span> <span data-ttu-id="20a16-979">Toutefois, vous pouvez utiliser **DynamicTableEntity** tooupdate une entité de type sans connaître son type et sans l’aide d’une classe d’entité POCO.</span><span class="sxs-lookup"><span data-stu-id="20a16-979">However, you can use **DynamicTableEntity** type tooupdate an entity without knowing its type and without using a POCO entity class.</span></span> <span data-ttu-id="20a16-980">Hello exemple de code suivant récupère une entité unique et vérifie hello **EmployeeCount** propriété existe avant la mise à jour.</span><span class="sxs-lookup"><span data-stu-id="20a16-980">hello following code sample retrieves a single entity, and checks hello **EmployeeCount** property exists before updating it.</span></span>  

```csharp
TableResult result =
        employeeTable.Execute(TableOperation.Retrieve(partitionKey, rowKey));
DynamicTableEntity department = (DynamicTableEntity)result.Result;

EntityProperty countProperty;

if (!department.Properties.TryGetValue("EmployeeCount", out countProperty))
{
        throw new
        InvalidOperationException("Invalid entity, EmployeeCount property not found.");
}
countProperty.Int32Value += 1;
employeeTable.Execute(TableOperation.Merge(department));  
```

### <a name="controlling-access-with-shared-access-signatures"></a><span data-ttu-id="20a16-981">Contrôle d’accès avec des signatures d’accès partagé</span><span class="sxs-lookup"><span data-stu-id="20a16-981">Controlling access with Shared Access Signatures</span></span>
<span data-ttu-id="20a16-982">Vous pouvez utiliser la Signature d’accès partagé (SAS) jetons tooenable client applications toomodify (et interroger) les entités de table directement sans tooauthenticate besoin de hello directement avec le service de table hello.</span><span class="sxs-lookup"><span data-stu-id="20a16-982">You can use Shared Access Signature (SAS) tokens tooenable client applications toomodify (and query) table entities directly without hello need tooauthenticate directly with hello table service.</span></span> <span data-ttu-id="20a16-983">En règle générale, il existe des trois principaux avantages toousing SAP dans votre application :</span><span class="sxs-lookup"><span data-stu-id="20a16-983">Typically, there are three main benefits toousing SAS in your application:</span></span>  

* <span data-ttu-id="20a16-984">Vous n’avez pas besoin de toodistribute votre stockage compte tooan clé de plateforme sécurisée (par exemple, un appareil mobile) dans l’ordre tooallow tooaccess de cet appareil et modifier des entités Bonjour service de Table.</span><span class="sxs-lookup"><span data-stu-id="20a16-984">You do not need toodistribute your storage account key tooan insecure platform (such as a mobile device) in order tooallow that device tooaccess and modify entities in hello Table service.</span></span>  
* <span data-ttu-id="20a16-985">Vous pouvez décharger certaines tâches de travail de hello ce site web et exécutent des rôles de travail dans la gestion de vos appareils de tooclient des entités telles que les ordinateurs des utilisateurs finaux et les appareils mobiles.</span><span class="sxs-lookup"><span data-stu-id="20a16-985">You can offload some of hello work that web and worker roles perform in managing your entities tooclient devices such as end-user computers and mobile devices.</span></span>  
* <span data-ttu-id="20a16-986">Vous pouvez affecter une contrainte et temps limité d’ensemble du client de tooa autorisations (par exemple, pour autoriser l’accès en lecture seule toospecific ressources).</span><span class="sxs-lookup"><span data-stu-id="20a16-986">You can assign a constrained and time limited set of permissions tooa client (such as allowing read-only access toospecific resources).</span></span>  

<span data-ttu-id="20a16-987">Pour plus d’informations sur l’utilisation de jetons SAP avec hello service de Table, consultez [à l’aide de Signatures SAP (accès partagé)](../storage/common/storage-dotnet-shared-access-signature-part-1.md).</span><span class="sxs-lookup"><span data-stu-id="20a16-987">For more information about using SAS tokens with hello Table service, see [Using Shared Access Signatures (SAS)](../storage/common/storage-dotnet-shared-access-signature-part-1.md).</span></span>  

<span data-ttu-id="20a16-988">Toutefois, vous devez toujours générer des jetons SAP hello qui accordent un client application toohello entités hello service de table : vous devez le faire dans un environnement qui a sécuriser l’accès aux clés de compte de stockage tooyour.</span><span class="sxs-lookup"><span data-stu-id="20a16-988">However, you must still generate hello SAS tokens that grant a client application toohello entities in hello table service: you should do this in an environment that has secure access tooyour storage account keys.</span></span> <span data-ttu-id="20a16-989">En règle générale, vous utilisez un web ou travail rôle toogenerate hello SAS des jetons et remettre les applications clientes toohello qui doivent accéder à des entités de tooyour.</span><span class="sxs-lookup"><span data-stu-id="20a16-989">Typically, you use a web or worker role toogenerate hello SAS tokens and deliver them toohello client applications that need access tooyour entities.</span></span> <span data-ttu-id="20a16-990">Car il existe toujours une surcharge impliquées dans la génération et de distribution tooclients de jetons SAS, vous devez envisager la meilleure façon tooreduce cette surcharge, surtout dans les scénarios de haut volume.</span><span class="sxs-lookup"><span data-stu-id="20a16-990">Because there is still an overhead involved in generating and delivering SAS tokens tooclients, you should consider how best tooreduce this overhead, especially in high-volume scenarios.</span></span>  

<span data-ttu-id="20a16-991">Il est possible de toogenerate un jeton SAP qu’accorde accéder au sous-ensemble tooa d’entités hello dans une table.</span><span class="sxs-lookup"><span data-stu-id="20a16-991">It is possible toogenerate a SAS token that grants access tooa subset of hello entities in a table.</span></span> <span data-ttu-id="20a16-992">Par défaut, vous créez un jeton SAP pour une table entière, mais il est également possible de toospecify que tooeither d’accès de jeton grant hello SAS une plage de **PartitionKey** valeurs ou une plage de **PartitionKey** et  **RowKey** valeurs.</span><span class="sxs-lookup"><span data-stu-id="20a16-992">By default, you create a SAS token for an entire table, but it is also possible toospecify that hello SAS token grant access tooeither a range of **PartitionKey** values, or a range of **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="20a16-993">Vous pouvez choisir toogenerate jetons SAP pour les utilisateurs individuels de votre système de telle sorte que chaque jeton d’utilisateur SAP ne lui permet d’accéder tootheir des entités propre Bonjour service de table.</span><span class="sxs-lookup"><span data-stu-id="20a16-993">You might choose toogenerate SAS tokens for individual users of your system such that each user's SAS token only allows them access tootheir own entities in hello table service.</span></span>  

### <a name="asynchronous-and-parallel-operations"></a><span data-ttu-id="20a16-994">Opérations asynchrones et parallèles</span><span class="sxs-lookup"><span data-stu-id="20a16-994">Asynchronous and parallel operations</span></span>
<span data-ttu-id="20a16-995">Si vous effectuez la diffusion de vos demandes sur plusieurs partitions, vous pouvez améliorer le débit et la réactivité du client en utilisant des requêtes asynchrones ou parallèles.</span><span class="sxs-lookup"><span data-stu-id="20a16-995">Provided you are spreading your requests across multiple partitions, you can improve throughput and client responsiveness by using asynchronous or parallel queries.</span></span>
<span data-ttu-id="20a16-996">Par exemple, vous pouvez avoir plusieurs instances de rôle de travail accédant à vos tables en parallèle.</span><span class="sxs-lookup"><span data-stu-id="20a16-996">For example, you might have two or more worker role instances accessing your tables in parallel.</span></span> <span data-ttu-id="20a16-997">Vous pouvez disposer de rôles de travail individuels responsables des ensembles particuliers de partitions, ou tout simplement avoir plusieurs instances de rôle de travail, chaque tooaccess en mesure de tous les hello partitions dans une table.</span><span class="sxs-lookup"><span data-stu-id="20a16-997">You could have individual worker roles responsible for particular sets of partitions, or simply have multiple worker role instances, each able tooaccess all hello partitions in a table.</span></span>  

<span data-ttu-id="20a16-998">Dans une instance cliente, vous pouvez améliorer le débit en exécutant des opérations de stockage en mode asynchrone.</span><span class="sxs-lookup"><span data-stu-id="20a16-998">Within a client instance, you can improve throughput by executing storage operations asynchronously.</span></span> <span data-ttu-id="20a16-999">Hello bibliothèque cliente de stockage permet de modifications et toowrite facilement des requêtes asynchrones.</span><span class="sxs-lookup"><span data-stu-id="20a16-999">hello Storage Client Library makes it easy toowrite asynchronous queries and modifications.</span></span> <span data-ttu-id="20a16-1000">Par exemple, vous pouvez commencer avec une méthode synchrone hello qui Récupère toutes les entités hello dans une partition comme indiqué dans hello suivant de code c# :</span><span class="sxs-lookup"><span data-stu-id="20a16-1000">For example, you might start with hello synchronous method that retrieves all hello entities in a partition as shown in hello following C# code:</span></span>  

```csharp
private static void ManyEntitiesQuery(CloudTable employeeTable, string department)
{
        string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, department);
        TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter);

        TableContinuationToken continuationToken = null;

        do
        {
        var employees = employeeTable.ExecuteQuerySegmented(
                employeeQuery, continuationToken);
        foreach (var emp in employees)
    {
        ...
    }
        continuationToken = employees.ContinuationToken;
        } while (continuationToken != null);
}  
```

<span data-ttu-id="20a16-1001">Vous pouvez facilement modifier ce code pour cette requête hello s’exécute de façon asynchrone, comme suit :</span><span class="sxs-lookup"><span data-stu-id="20a16-1001">You can easily modify this code so that hello query runs asynchronously as follows:</span></span>  

```csharp
private static async Task ManyEntitiesQueryAsync(CloudTable employeeTable, string department)
{
        string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, department);
        TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter);
        TableContinuationToken continuationToken = null;

        do
        {
        var employees = await employeeTable.ExecuteQuerySegmentedAsync(
                employeeQuery, continuationToken);
        foreach (var emp in employees)
        {
            ...
        }
        continuationToken = employees.ContinuationToken;
            } while (continuationToken != null);
}  
```

<span data-ttu-id="20a16-1002">Dans cet exemple asynchrone, vous pouvez voir les suivant hello change à partir de la version synchrone de hello :</span><span class="sxs-lookup"><span data-stu-id="20a16-1002">In this asynchronous example, you can see hello following changes from hello synchronous version:</span></span>  

* <span data-ttu-id="20a16-1003">signature de méthode Hello inclut désormais hello **async** modificateur et retourne un **tâche** instance.</span><span class="sxs-lookup"><span data-stu-id="20a16-1003">hello method signature now includes hello **async** modifier and returns a **Task** instance.</span></span>  
* <span data-ttu-id="20a16-1004">Au lieu de l’appel hello **ExecuteSegmented** tooretrieve résultats de la méthode, hello méthode maintenant les appels hello **ExecuteSegmentedAsync** hello (méthode) et utilise **await** modificateur tooretrieve résultats de façon asynchrone.</span><span class="sxs-lookup"><span data-stu-id="20a16-1004">Instead of calling hello **ExecuteSegmented** method tooretrieve results, hello method now calls hello **ExecuteSegmentedAsync** method and uses hello **await** modifier tooretrieve results asynchronously.</span></span>  

<span data-ttu-id="20a16-1005">application cliente de Hello peut appeler cette méthode plusieurs fois (avec des valeurs différentes pour hello **service** paramètre), et chaque requête est exécutée sur un thread distinct.</span><span class="sxs-lookup"><span data-stu-id="20a16-1005">hello client application can call this method multiple times (with different values for hello **department** parameter), and each query will run on a separate thread.</span></span>  

<span data-ttu-id="20a16-1006">Notez qu’il n’existe aucune version asynchrone de hello **Execute** méthode Bonjour **TableQuery** classe car hello **IEnumerable** interface ne prend pas en charge asynchrone énumération.</span><span class="sxs-lookup"><span data-stu-id="20a16-1006">Note that there is no asynchronous version of hello **Execute** method in hello **TableQuery** class because hello **IEnumerable** interface does not support asynchronous enumeration.</span></span>  

<span data-ttu-id="20a16-1007">Vous pouvez également insérer, mettre à jour et supprimer des entités de façon asynchrone.</span><span class="sxs-lookup"><span data-stu-id="20a16-1007">You can also insert, update, and delete entities asynchronously.</span></span> <span data-ttu-id="20a16-1008">Hello exemple c# suivant montre une méthode simple et synchrone de tooinsert ou remplace une entité employee :</span><span class="sxs-lookup"><span data-stu-id="20a16-1008">hello following C# example shows a simple, synchronous method tooinsert or replace an employee entity:</span></span>  

```csharp
private static void SimpleEmployeeUpsert(CloudTable employeeTable,
        EmployeeEntity employee)
{
        TableResult result = employeeTable
        .Execute(TableOperation.InsertOrReplace(employee));
        Console.WriteLine("HTTP Status: {0}", result.HttpStatusCode);
}  
```

<span data-ttu-id="20a16-1009">Vous pouvez facilement modifier ce code afin que la mise à jour hello s’exécute de façon asynchrone, comme suit :</span><span class="sxs-lookup"><span data-stu-id="20a16-1009">You can easily modify this code so that hello update runs asynchronously as follows:</span></span>  

```csharp
private static async Task SimpleEmployeeUpsertAsync(CloudTable employeeTable,
        EmployeeEntity employee)
{
        TableResult result = await employeeTable
        .ExecuteAsync(TableOperation.InsertOrReplace(employee));
        Console.WriteLine("HTTP Status: {0}", result.HttpStatusCode);
}  
```

<span data-ttu-id="20a16-1010">Dans cet exemple asynchrone, vous pouvez voir les suivant hello change à partir de la version synchrone de hello :</span><span class="sxs-lookup"><span data-stu-id="20a16-1010">In this asynchronous example, you can see hello following changes from hello synchronous version:</span></span>  

* <span data-ttu-id="20a16-1011">signature de méthode Hello inclut désormais hello **async** modificateur et retourne un **tâche** instance.</span><span class="sxs-lookup"><span data-stu-id="20a16-1011">hello method signature now includes hello **async** modifier and returns a **Task** instance.</span></span>  
* <span data-ttu-id="20a16-1012">Au lieu de l’appel hello **Execute** entité de méthode tooupdate hello, hello méthode maintenant les appels hello **ExecuteAsync** hello (méthode) et utilise **await** modificateur tooretrieve résultats de façon asynchrone.</span><span class="sxs-lookup"><span data-stu-id="20a16-1012">Instead of calling hello **Execute** method tooupdate hello entity, hello method now calls hello **ExecuteAsync** method and uses hello **await** modifier tooretrieve results asynchronously.</span></span>  

<span data-ttu-id="20a16-1013">application cliente de Hello peut appeler plusieurs méthodes asynchrones, telle que celle-ci, et chaque appel de méthode s’exécute sur un thread distinct.</span><span class="sxs-lookup"><span data-stu-id="20a16-1013">hello client application can call multiple asynchronous methods like this one, and each method invocation will run on a separate thread.</span></span>  

### <a name="credits"></a><span data-ttu-id="20a16-1014">Crédits</span><span class="sxs-lookup"><span data-stu-id="20a16-1014">Credits</span></span>
<span data-ttu-id="20a16-1015">Nous aimerions hello toothank suit les membres de l’équipe Azure pour leurs contributions de hello : Dominic Betts, Jason Hogg, Jean Ghanem, Jai Haridas, Jeff Irwin, Vamshidhar Kommineni, Vinay Shah et Serdar Ozler ainsi que Tom Hollander de DX de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="20a16-1015">We would like toothank hello following members of hello Azure team for their contributions: Dominic Betts, Jason Hogg, Jean Ghanem, Jai Haridas, Jeff Irwin, Vamshidhar Kommineni, Vinay Shah and Serdar Ozler as well as  Tom Hollander from Microsoft DX.</span></span> 

<span data-ttu-id="20a16-1016">Nous aimerions également hello toothank suivant du MVP Microsoft pour leurs commentaires précieux à Microsoft pendant les cycles de révision : Igor Papirov et Edward Bakker.</span><span class="sxs-lookup"><span data-stu-id="20a16-1016">We would also like toothank hello following Microsoft MVP's for their valuable feedback during review cycles: Igor Papirov and Edward Bakker.</span></span>

[1]: ./media/storage-table-design-guide/storage-table-design-IMAGE01.png
[2]: ./media/storage-table-design-guide/storage-table-design-IMAGE02.png
[3]: ./media/storage-table-design-guide/storage-table-design-IMAGE03.png
[4]: ./media/storage-table-design-guide/storage-table-design-IMAGE04.png
[5]: ./media/storage-table-design-guide/storage-table-design-IMAGE05.png
[6]: ./media/storage-table-design-guide/storage-table-design-IMAGE06.png
[7]: ./media/storage-table-design-guide/storage-table-design-IMAGE07.png
[8]: ./media/storage-table-design-guide/storage-table-design-IMAGE08.png
[9]: ./media/storage-table-design-guide/storage-table-design-IMAGE09.png
[10]: ./media/storage-table-design-guide/storage-table-design-IMAGE10.png
[11]: ./media/storage-table-design-guide/storage-table-design-IMAGE11.png
[12]: ./media/storage-table-design-guide/storage-table-design-IMAGE12.png
[13]: ./media/storage-table-design-guide/storage-table-design-IMAGE13.png
[14]: ./media/storage-table-design-guide/storage-table-design-IMAGE14.png
[15]: ./media/storage-table-design-guide/storage-table-design-IMAGE15.png
[16]: ./media/storage-table-design-guide/storage-table-design-IMAGE16.png
[17]: ./media/storage-table-design-guide/storage-table-design-IMAGE17.png
[18]: ./media/storage-table-design-guide/storage-table-design-IMAGE18.png
[19]: ./media/storage-table-design-guide/storage-table-design-IMAGE19.png
[20]: ./media/storage-table-design-guide/storage-table-design-IMAGE20.png
[21]: ./media/storage-table-design-guide/storage-table-design-IMAGE21.png
[22]: ./media/storage-table-design-guide/storage-table-design-IMAGE22.png
[23]: ./media/storage-table-design-guide/storage-table-design-IMAGE23.png
[24]: ./media/storage-table-design-guide/storage-table-design-IMAGE24.png
[25]: ./media/storage-table-design-guide/storage-table-design-IMAGE25.png
[26]: ./media/storage-table-design-guide/storage-table-design-IMAGE26.png
[27]: ./media/storage-table-design-guide/storage-table-design-IMAGE27.png
[28]: ./media/storage-table-design-guide/storage-table-design-IMAGE28.png
[29]: ./media/storage-table-design-guide/storage-table-design-IMAGE29.png

