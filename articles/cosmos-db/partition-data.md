---
title: "aaaPartitioning et la mise à l’échelle horizontale dans la base de données Azure Cosmos | Documents Microsoft"
description: "En savoir plus sur le partitionnement de base de données Azure Cosmos, comment tooconfigure partitionnement et les clés de partition, et comment toopick hello droite clé de partition pour votre application."
services: cosmos-db
author: arramac
manager: jhubbard
editor: monicar
documentationcenter: 
ms.assetid: cac9a8cd-b5a3-4827-8505-d40bb61b2416
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/10/2017
ms.author: arramac
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: 87d56db8c4ccc6b94b1650baff0fcfb3db6d1777
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="how-toopartition-and-scale-in-azure-cosmos-db"></a><span data-ttu-id="891d4-103">Comment toopartition et l’échelle dans la base de données Azure Cosmos</span><span class="sxs-lookup"><span data-stu-id="891d4-103">How toopartition and scale in Azure Cosmos DB</span></span>

<span data-ttu-id="891d4-104">[Base de données Microsoft Azure Cosmos](https://azure.microsoft.com/services/cosmos-db/) est un toohelp de service conçu global de base de données distribuées, comportant plusieurs modèles vous atteindre des performances rapides et prévisibles et une échelle en toute transparence avec votre application qu’elle se développe.</span><span class="sxs-lookup"><span data-stu-id="891d4-104">[Microsoft Azure Cosmos DB](https://azure.microsoft.com/services/cosmos-db/) is a global distributed, multi-model database service designed toohelp you achieve fast, predictable performance and scale seamlessly along with your application as it grows.</span></span> <span data-ttu-id="891d4-105">Cet article fournit une vue d’ensemble de comment le partitionnement fonctionne pour toutes les données hello les modèles dans la base de données Azure Cosmos et décrit comment vous pouvez configurer l’échelle de base de données Azure Cosmos conteneurs tooeffectively vos applications.</span><span class="sxs-lookup"><span data-stu-id="891d4-105">This article provides an overview of how partitioning works for all hello data models in Azure Cosmos DB, and describes how you can configure Azure Cosmos DB containers tooeffectively scale your applications.</span></span>

<span data-ttu-id="891d4-106">Le partitionnement et les clés de partition sont également abordés dans cette vidéo Azure Friday avec Scott Hanselman et Shireesh Thota, responsable principal de l’ingénierie Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="891d4-106">Partitioning and partition keys are also covered in this Azure Friday video with Scott Hanselman and Azure Cosmos DB Principal Engineering Manager, Shireesh Thota.</span></span>

> [!VIDEO https://channel9.msdn.com/Shows/Azure-Friday/Azure-DocumentDB-Elastic-Scale-Partitioning/player]
> 

## <a name="partitioning-in-azure-cosmos-db"></a><span data-ttu-id="891d4-107">Partitionnement dans Azure Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="891d4-107">Partitioning in Azure Cosmos DB</span></span>
<span data-ttu-id="891d4-108">Dans Azure Cosmos DB, vous pouvez stocker et interroger des données sans schéma avec des délais de réponse de l’ordre des millisecondes à n’importe quelle échelle.</span><span class="sxs-lookup"><span data-stu-id="891d4-108">In Azure Cosmos DB, you can store and query schema-less data with order-of-millisecond response times at any scale.</span></span> <span data-ttu-id="891d4-109">Azure Cosmos DB fournit des conteneurs pour le stockage des données, appelés **collections (pour les documents), graphiques ou tables**.</span><span class="sxs-lookup"><span data-stu-id="891d4-109">Cosmos DB provides containers for storing data called **collections (for document), graphs, or tables**.</span></span> <span data-ttu-id="891d4-110">Les conteneurs sont des ressources logiques. Ils peuvent s’étendre sur plusieurs partitions physiques ou serveurs.</span><span class="sxs-lookup"><span data-stu-id="891d4-110">Containers are logical resources and can span one or more physical partitions or servers.</span></span> <span data-ttu-id="891d4-111">nombre de Hello de partitions est déterminé par DB Cosmos en fonction de la taille de stockage hello et débit approvisionné de hello du conteneur de hello.</span><span class="sxs-lookup"><span data-stu-id="891d4-111">hello number of partitions is determined by Cosmos DB based on hello storage size and hello provisioned throughput of hello container.</span></span> <span data-ttu-id="891d4-112">Chaque partition dans Azure Cosmos DB dispose d’une quantité fixe de stockage SSD associé. Elle est également répliquée pour offrir une haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="891d4-112">Every partition in Cosmos DB has a fixed amount of SSD-backed storage associated with it, and is replicated for high availability.</span></span> <span data-ttu-id="891d4-113">Gestion des partitions est entièrement gérée par la base de données Azure Cosmos, et ne pas avoir un code complexe toowrite ou de gérer vos partitions.</span><span class="sxs-lookup"><span data-stu-id="891d4-113">Partition management is fully managed by Azure Cosmos DB, and you do not have toowrite complex code or manage your partitions.</span></span> <span data-ttu-id="891d4-114">Les conteneurs Cosmos DB sont illimités en termes de débit et de stockage.</span><span class="sxs-lookup"><span data-stu-id="891d4-114">Cosmos DB containers are unlimited in terms of storage and throughput.</span></span> 

![horizontal](./media/introduction/azure-cosmos-db-partitioning.png) 

<span data-ttu-id="891d4-116">Le partitionnement est transparent tooyour application.</span><span class="sxs-lookup"><span data-stu-id="891d4-116">Partitioning is transparent tooyour application.</span></span> <span data-ttu-id="891d4-117">COSMOS DB prend en charge rapides lectures et écritures, requêtes, la logique transactionnelle, niveaux de cohérence et contrôle d’accès précis via la ressource de conteneur unique tooa méthodes/API.</span><span class="sxs-lookup"><span data-stu-id="891d4-117">Cosmos DB supports fast reads and writes, queries, transactional logic, consistency levels, and fine-grained access control via methods/APIs tooa single container resource.</span></span> <span data-ttu-id="891d4-118">descripteurs de service Hello distribution des données sur plusieurs partitions et le routage de partition de requête demandes toohello droite.</span><span class="sxs-lookup"><span data-stu-id="891d4-118">hello service handles distributing data across partitions and routing query requests toohello right partition.</span></span> 

<span data-ttu-id="891d4-119">Comment le partitionnement fonctionne-t-il ?</span><span class="sxs-lookup"><span data-stu-id="891d4-119">How does partitioning work?</span></span> <span data-ttu-id="891d4-120">Chaque élément doit avoir une clé de partition et une clé de ligne, qui l’identifient de façon.</span><span class="sxs-lookup"><span data-stu-id="891d4-120">Each item must have a partition key and a row key, which uniquely identify it.</span></span> <span data-ttu-id="891d4-121">Votre clé de partition agit comme une partition logique pour vos données et fournit à Cosmos DB une frontière naturelle pour la distribution des données sur plusieurs partitions.</span><span class="sxs-lookup"><span data-stu-id="891d4-121">Your partition key acts as a logical partition for your data, and provides Cosmos DB with a natural boundary for distributing data across partitions.</span></span> <span data-ttu-id="891d4-122">En bref, voici comment le partitionnement fonctionne dans Azure Cosmos DB :</span><span class="sxs-lookup"><span data-stu-id="891d4-122">In brief, here is how partitioning works in Azure Cosmos DB:</span></span>

* <span data-ttu-id="891d4-123">Vous devez configurer un conteneur Cosmos DB avec un débit de `T` requêtes/s</span><span class="sxs-lookup"><span data-stu-id="891d4-123">You provision a Cosmos DB container with `T` requests/s throughput</span></span>
* <span data-ttu-id="891d4-124">Coulisses de hello, partitions de dispositions Cosmos DB nécessaire tooserve `T` demandes/s.</span><span class="sxs-lookup"><span data-stu-id="891d4-124">Behind hello scenes, Cosmos DB provisions partitions needed tooserve `T` requests/s.</span></span> <span data-ttu-id="891d4-125">Si `T` est supérieur au débit maximal de hello par partition `t`, puis les dispositions Cosmos DB `N`  =  `T/t` partitions</span><span class="sxs-lookup"><span data-stu-id="891d4-125">If `T` is higher than hello maximum throughput per partition `t`, then Cosmos DB provisions `N` = `T/t` partitions</span></span>
* <span data-ttu-id="891d4-126">COSMOS DB alloue hello clé d’espace de partition hachages clés uniformément entre hello `N` partitions.</span><span class="sxs-lookup"><span data-stu-id="891d4-126">Cosmos DB allocates hello key space of partition key hashes evenly across hello `N` partitions.</span></span> <span data-ttu-id="891d4-127">Par conséquent, chaque partition (physique) héberge N-1 valeurs de clé de partition (partitions logiques)</span><span class="sxs-lookup"><span data-stu-id="891d4-127">So, each partition (physical partition) hosts 1-N partition key values (logical partitions)</span></span>
* <span data-ttu-id="891d4-128">Lorsqu’une partition physique `p` atteint sa limite de stockage, base de données Cosmos fractionne en toute transparence `p` en deux partitions nouvelle `p1` et `p2` et distribue les valeurs correspondant tooroughly moitié hello clés tooeach de hello partitions.</span><span class="sxs-lookup"><span data-stu-id="891d4-128">When a physical partition `p` reaches its storage limit, Cosmos DB seamlessly splits `p` into two new partitions `p1` and `p2` and distributes values corresponding tooroughly half hello keys tooeach of hello partitions.</span></span> <span data-ttu-id="891d4-129">Cette opération de fractionnement est invisible tooyour application.</span><span class="sxs-lookup"><span data-stu-id="891d4-129">This split operation is invisible tooyour application.</span></span>
* <span data-ttu-id="891d4-130">De même, lorsque vous déployez un débit supérieur `t*N` débit, Cosmos DB fractionne un ou plusieurs de vos partitions toosupport hello plus élevé de débit</span><span class="sxs-lookup"><span data-stu-id="891d4-130">Similarly, when you provision throughput higher than `t*N` throughput, Cosmos DB splits one or more of your partitions toosupport hello higher throughput</span></span>

<span data-ttu-id="891d4-131">sémantique Hello pour les clés de partition est légèrement différentes toomatch la sémantique hello de chaque API, comme indiqué dans hello tableau suivant :</span><span class="sxs-lookup"><span data-stu-id="891d4-131">hello semantics for partition keys are slightly different toomatch hello semantics of each API, as shown in hello following table:</span></span>

| <span data-ttu-id="891d4-132">API</span><span class="sxs-lookup"><span data-stu-id="891d4-132">API</span></span> | <span data-ttu-id="891d4-133">Partition Key</span><span class="sxs-lookup"><span data-stu-id="891d4-133">Partition Key</span></span> | <span data-ttu-id="891d4-134">Row Key</span><span class="sxs-lookup"><span data-stu-id="891d4-134">Row Key</span></span> |
| --- | --- | --- |
| <span data-ttu-id="891d4-135">Base de données de documents</span><span class="sxs-lookup"><span data-stu-id="891d4-135">DocumentDB</span></span> | <span data-ttu-id="891d4-136">custom partition key path</span><span class="sxs-lookup"><span data-stu-id="891d4-136">custom partition key path</span></span> | <span data-ttu-id="891d4-137">`id` (fixe)</span><span class="sxs-lookup"><span data-stu-id="891d4-137">fixed `id`</span></span> | 
| <span data-ttu-id="891d4-138">MongoDB</span><span class="sxs-lookup"><span data-stu-id="891d4-138">MongoDB</span></span> | <span data-ttu-id="891d4-139">clé de partitionnement personnalisée</span><span class="sxs-lookup"><span data-stu-id="891d4-139">custom shard key</span></span>  | <span data-ttu-id="891d4-140">`_id` (fixe)</span><span class="sxs-lookup"><span data-stu-id="891d4-140">fixed `_id`</span></span> | 
| <span data-ttu-id="891d4-141">Graph</span><span class="sxs-lookup"><span data-stu-id="891d4-141">Graph</span></span> | <span data-ttu-id="891d4-142">propriété de clé de partition personnalisée</span><span class="sxs-lookup"><span data-stu-id="891d4-142">custom partition key property</span></span> | <span data-ttu-id="891d4-143">`id` (fixe)</span><span class="sxs-lookup"><span data-stu-id="891d4-143">fixed `id`</span></span> | 
| <span data-ttu-id="891d4-144">Table</span><span class="sxs-lookup"><span data-stu-id="891d4-144">Table</span></span> | <span data-ttu-id="891d4-145">`PartitionKey` (fixe)</span><span class="sxs-lookup"><span data-stu-id="891d4-145">fixed `PartitionKey`</span></span> | <span data-ttu-id="891d4-146">`RowKey` (fixe)</span><span class="sxs-lookup"><span data-stu-id="891d4-146">fixed `RowKey`</span></span> | 

<span data-ttu-id="891d4-147">Cosmos DB utilise le partitionnement basé sur le hachage.</span><span class="sxs-lookup"><span data-stu-id="891d4-147">Cosmos DB uses hash-based partitioning.</span></span> <span data-ttu-id="891d4-148">Lorsque vous écrivez un élément, Cosmos DB hache la valeur de clé de partition hello et utilisez hello haché résultat toodetermine élément partition toostore hello dans.</span><span class="sxs-lookup"><span data-stu-id="891d4-148">When you write an item, Cosmos DB hashes hello partition key value and use hello hashed result toodetermine which partition toostore hello item in.</span></span> <span data-ttu-id="891d4-149">Tous les éléments avec hello la même clé de partition dans des magasins de COSMOS DB hello même partition physique.</span><span class="sxs-lookup"><span data-stu-id="891d4-149">Cosmos DB stores all items with hello same partition key in hello same physical partition.</span></span> <span data-ttu-id="891d4-150">choix de Hello de clé de partition hello est une décision importante que vous avez toomake au moment du design.</span><span class="sxs-lookup"><span data-stu-id="891d4-150">hello choice of hello partition key is an important decision that you have toomake at design time.</span></span> <span data-ttu-id="891d4-151">Vous devez choisir un nom de propriété qui possède une large plage de valeurs et des modèles d’accès uniformes.</span><span class="sxs-lookup"><span data-stu-id="891d4-151">You must pick a property name that has a wide range of values and has even access patterns.</span></span>

> [!NOTE]
> <span data-ttu-id="891d4-152">Il s’agit d’une meilleure toohave de pratique une clé de partition avec de nombreuses valeurs distinctes (100 s-pour 1 000 au minimum).</span><span class="sxs-lookup"><span data-stu-id="891d4-152">It is a best practice toohave a partition key with many distinct values (100s-1000s at a minimum).</span></span>
>

<span data-ttu-id="891d4-153">Les conteneurs Azure Cosmos DB peuvent être créés comme étant « fixes » ou « illimités ».</span><span class="sxs-lookup"><span data-stu-id="891d4-153">Azure Cosmos DB containers can be created as "fixed" or "unlimited."</span></span> <span data-ttu-id="891d4-154">Les conteneurs de taille fixe ont une limite maximale de 10 Go et de 10 000 RU/s de débit.</span><span class="sxs-lookup"><span data-stu-id="891d4-154">Fixed-size containers have a maximum limit of 10 GB and 10,000 RU/s throughput.</span></span> <span data-ttu-id="891d4-155">Certaines API permettent toobe de clé de partition hello omis pour les conteneurs de taille fixe.</span><span class="sxs-lookup"><span data-stu-id="891d4-155">Some APIs allow hello partition key toobe omitted for fixed-size containers.</span></span> <span data-ttu-id="891d4-156">toocreate un conteneur comme étant illimité, vous devez spécifier un débit minimum de 2500 ur/s.</span><span class="sxs-lookup"><span data-stu-id="891d4-156">toocreate a container as unlimited, you must specify a minimum throughput of 2500 RU/s.</span></span>

## <a name="partitioning-and-provisioned-throughput"></a><span data-ttu-id="891d4-157">Partitionnement et débit approvisionné</span><span class="sxs-lookup"><span data-stu-id="891d4-157">Partitioning and provisioned throughput</span></span>
<span data-ttu-id="891d4-158">Cosmos DB est conçu pour offrir des performances prévisibles.</span><span class="sxs-lookup"><span data-stu-id="891d4-158">Cosmos DB is designed for predictable performance.</span></span> <span data-ttu-id="891d4-159">Lorsque vous créez un conteneur, vous réservez le débit en termes de **[d’unités de requête](request-units.md) (RU) par seconde avec un ajout potentiel pour les unités de requête par minute**.</span><span class="sxs-lookup"><span data-stu-id="891d4-159">When you create a container, you reserve throughput in terms of **[request units](request-units.md) (RU) per second with a potential add-on for RU per minute**.</span></span> <span data-ttu-id="891d4-160">Chaque requête est assignée à un coût unitaire de demande qui est le montant proportionnel toohello de ressources système telles que le processeur, mémoire et e/s consommées par opération de hello.</span><span class="sxs-lookup"><span data-stu-id="891d4-160">Each request is assigned a request unit charge that is proportionate toohello amount of system resources like CPU, Memory, and IO consumed by hello operation.</span></span> <span data-ttu-id="891d4-161">La lecture d’un document de 1 ko avec une cohérence de session consomme une unité de demande.</span><span class="sxs-lookup"><span data-stu-id="891d4-161">A read of a 1-KB document with Session consistency consumes one request unit.</span></span> <span data-ttu-id="891d4-162">Une lecture est 1 RU, quelle que soit le nombre de hello d’éléments stockés ou hello du nombre de demandes simultanées en cours d’exécution à hello même temps.</span><span class="sxs-lookup"><span data-stu-id="891d4-162">A read is 1 RU regardless of hello number of items stored or hello number of concurrent requests running at hello same time.</span></span> <span data-ttu-id="891d4-163">Les éléments plus volumineux nécessitent plus élevé d’unités de demande en fonction de la taille de hello.</span><span class="sxs-lookup"><span data-stu-id="891d4-163">Larger items require higher request units depending on hello size.</span></span> <span data-ttu-id="891d4-164">Si vous connaissez taille hello vos entités et hello du nombre de lectures vous devez toosupport pour votre application, vous pouvez configurer la quantité exacte de hello du débit requis pour votre application de lecture de vos besoins.</span><span class="sxs-lookup"><span data-stu-id="891d4-164">If you know hello size of your entities and hello number of reads you need toosupport for your application, you can provision hello exact amount of throughput required for your application's read needs.</span></span> 

> [!NOTE]
> <span data-ttu-id="891d4-165">tooachieve hello un débit complet du conteneur de hello, vous devez choisir une clé de partition qui vous permet de tooevenly distribuer les requêtes entre certaines valeurs de clé de partition distincte.</span><span class="sxs-lookup"><span data-stu-id="891d4-165">tooachieve hello full throughput of hello container, you must choose a partition key that allows you tooevenly distribute requests among some distinct partition key values.</span></span>
> 
> 

<a name="designing-for-partitioning"></a>
## <a name="working-with-hello-azure-cosmos-db-apis"></a><span data-ttu-id="891d4-166">Utilisation des API de base de données Azure Cosmos de hello</span><span class="sxs-lookup"><span data-stu-id="891d4-166">Working with hello Azure Cosmos DB APIs</span></span>
<span data-ttu-id="891d4-167">Vous pouvez utiliser hello portail Azure ou les conteneurs de toocreate CLI d’Azure et mettre à l’échelle à tout moment.</span><span class="sxs-lookup"><span data-stu-id="891d4-167">You can use hello Azure portal or Azure CLI toocreate containers and scale them at any time.</span></span> <span data-ttu-id="891d4-168">Cette section montre comment les conteneurs toocreate et spécifiez hello débit et la partition de définition de la clé dans chacune des hello les API prises en charge.</span><span class="sxs-lookup"><span data-stu-id="891d4-168">This section shows how toocreate containers and specify hello throughput and partition key definition in each of hello supported APIs.</span></span>

### <a name="documentdb-api"></a><span data-ttu-id="891d4-169">API DocumentDB</span><span class="sxs-lookup"><span data-stu-id="891d4-169">DocumentDB API</span></span>
<span data-ttu-id="891d4-170">Hello suivant l’exemple montre comment un conteneur (collection) à l’aide de toocreate hello API DocumentDB.</span><span class="sxs-lookup"><span data-stu-id="891d4-170">hello following sample shows how toocreate a container (collection) using hello DocumentDB API.</span></span> <span data-ttu-id="891d4-171">Vous trouverez plus de détails dans [Partitionnement avec l’API DocumentDB](partition-data.md).</span><span class="sxs-lookup"><span data-stu-id="891d4-171">You can find more details in [Partitioning with DocumentDB API](partition-data.md).</span></span>

```csharp
DocumentClient client = new DocumentClient(new Uri(endpoint), authKey);
await client.CreateDatabaseAsync(new Database { Id = "db" });

DocumentCollection myCollection = new DocumentCollection();
myCollection.Id = "coll";
myCollection.PartitionKey.Paths.Add("/deviceId");

await client.CreateDocumentCollectionAsync(
    UriFactory.CreateDatabaseUri("db"),
    myCollection,
    new RequestOptions { OfferThroughput = 20000 });
```

<span data-ttu-id="891d4-172">Vous pouvez lire un élément (document) à l’aide de hello `GET` méthode hello API REST ou en utilisant les `ReadDocumentAsync` dans un des kits de développement logiciel de hello.</span><span class="sxs-lookup"><span data-stu-id="891d4-172">You can read an item (document) using hello `GET` method in hello REST API or using `ReadDocumentAsync` in one of hello SDKs.</span></span>

```csharp
// Read document. Needs hello partition key and hello ID toobe specified
DeviceReading document = await client.ReadDocumentAsync<DeviceReading>(
  UriFactory.CreateDocumentUri("db", "coll", "XMS-001-FE24C"), 
  new RequestOptions { PartitionKey = new PartitionKey("XMS-0001") });
```

### <a name="mongodb-api"></a><span data-ttu-id="891d4-173">API MongoDB</span><span class="sxs-lookup"><span data-stu-id="891d4-173">MongoDB API</span></span>
<span data-ttu-id="891d4-174">Avec hello MongoDB API, vous pouvez créer une collection partitionnée à l’aide de votre outil préféré, le pilote ou le Kit de développement logiciel.</span><span class="sxs-lookup"><span data-stu-id="891d4-174">With hello MongoDB API, you can create a sharded collection through your favorite tool, driver, or SDK.</span></span> <span data-ttu-id="891d4-175">Dans cet exemple, nous utilisons hello de commande Mongo pour la création de la collection hello.</span><span class="sxs-lookup"><span data-stu-id="891d4-175">In this example, we use hello Mongo Shell for hello collection creation.</span></span>

<span data-ttu-id="891d4-176">Bonjour interpréteur de commandes Mongo :</span><span class="sxs-lookup"><span data-stu-id="891d4-176">In hello Mongo Shell:</span></span>

```
db.runCommand( { shardCollection: "admin.people", key: { region: "hashed" } } )
```
    
<span data-ttu-id="891d4-177">Résultats :</span><span class="sxs-lookup"><span data-stu-id="891d4-177">Results:</span></span>

```JSON
{
    "_t" : "ShardCollectionResponse",
    "ok" : 1,
    "collectionsharded" : "admin.people"
}
```

### <a name="table-api"></a><span data-ttu-id="891d4-178">API de table</span><span class="sxs-lookup"><span data-stu-id="891d4-178">Table API</span></span>

<span data-ttu-id="891d4-179">Avec hello API de Table, vous devez spécifier le débit pour les tables hello configuration appSettings de hello pour votre application :</span><span class="sxs-lookup"><span data-stu-id="891d4-179">With hello Table API, you specify hello throughput for tables in hello appSettings configuration for your application:</span></span>

```xml
<configuration>
    <appSettings>
      <!--Table creation options -->
      <add key="TableThroughput" value="700"/>
    </appSettings>
</configuration>
```

<span data-ttu-id="891d4-180">Ensuite, vous créez une table à l’aide du stockage de Table Azure hello SDK.</span><span class="sxs-lookup"><span data-stu-id="891d4-180">Then you create a table using hello Azure Table storage SDK.</span></span> <span data-ttu-id="891d4-181">clé de partition Hello est implicitement créé en tant que hello `PartitionKey` valeur.</span><span class="sxs-lookup"><span data-stu-id="891d4-181">hello partition key is implicitly created as hello `PartitionKey` value.</span></span> 

```csharp
CloudTableClient tableClient = storageAccount.CreateCloudTableClient();

CloudTable table = tableClient.GetTableReference("people");
table.CreateIfNotExists();
```

<span data-ttu-id="891d4-182">Vous pouvez récupérer une entité unique à l’aide de hello suivant extrait de code :</span><span class="sxs-lookup"><span data-stu-id="891d4-182">You can retrieve a single entity using hello following snippet:</span></span>

```csharp
// Create a retrieve operation that takes a customer entity.
TableOperation retrieveOperation = TableOperation.Retrieve<CustomerEntity>("Smith", "Ben");

// Execute hello retrieve operation.
TableResult retrievedResult = table.Execute(retrieveOperation);
```
<span data-ttu-id="891d4-183">Consultez [développement avec hello API Table](tutorial-develop-table-dotnet.md) pour plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="891d4-183">See [Developing with hello Table API](tutorial-develop-table-dotnet.md) for more details.</span></span>

### <a name="graph-api"></a><span data-ttu-id="891d4-184">API Graph</span><span class="sxs-lookup"><span data-stu-id="891d4-184">Graph API</span></span>

<span data-ttu-id="891d4-185">Avec hello API Graph, vous devez utiliser hello portail Azure ou les conteneurs de toocreate CLI.</span><span class="sxs-lookup"><span data-stu-id="891d4-185">With hello Graph API, you must use hello Azure portal or CLI toocreate containers.</span></span> <span data-ttu-id="891d4-186">Ou bien, Azure Cosmos DB étant comportant plusieurs modèle, vous pouvez une des hello autres toocreate de modèles et mettre à l’échelle de votre conteneur graphique.</span><span class="sxs-lookup"><span data-stu-id="891d4-186">Alternatively, since Azure Cosmos DB is multi-model, you can use one of hello other models toocreate and scale your graph container.</span></span>

<span data-ttu-id="891d4-187">Vous pouvez lire les sommets ou un bord à l’aide de la clé de partition hello et id dans GREMLINE.</span><span class="sxs-lookup"><span data-stu-id="891d4-187">You can read any vertex or edge using hello partition key and id in Gremlin.</span></span> <span data-ttu-id="891d4-188">Par exemple, pour un graphique avec la région (« USA ») en tant que clé de partition hello et « Seattle » en tant que clé de ligne hello, vous trouverez un sommet à l’aide de la syntaxe de hello :</span><span class="sxs-lookup"><span data-stu-id="891d4-188">For example, for a graph with region ("USA") as hello partition key, and "Seattle" as hello row key, you can find a vertex using hello following syntax:</span></span>

```
g.V(['USA', 'Seattle'])
```

<span data-ttu-id="891d4-189">Même avec les contours, vous pouvez référencer un bord à l’aide de la clé de partition hello et clé de ligne.</span><span class="sxs-lookup"><span data-stu-id="891d4-189">Same with edges, you can reference an edge using hello partition key and row key.</span></span>

```
g.E(['USA', 'I5'])
```

<span data-ttu-id="891d4-190">Consultez la page [Prise en charge de Gremlin pour Cosmos DB](gremlin-support.md) pour plus de détails.</span><span class="sxs-lookup"><span data-stu-id="891d4-190">See [Gremlin support for Cosmos DB](gremlin-support.md) for more details.</span></span>


<a name="designing-for-partitioning"></a>
## <a name="designing-for-partitioning"></a><span data-ttu-id="891d4-191">Conception du partitionnement</span><span class="sxs-lookup"><span data-stu-id="891d4-191">Designing for partitioning</span></span>
<span data-ttu-id="891d4-192">tooscale efficacement avec la base de données Azure Cosmos, vous devez toopick une bonne clé de partition lorsque vous créez votre conteneur.</span><span class="sxs-lookup"><span data-stu-id="891d4-192">tooscale effectively with Azure Cosmos DB, you need toopick a good partition key when you create your container.</span></span> <span data-ttu-id="891d4-193">Il existe deux considérations essentielles pour le choix d’une clé de partition :</span><span class="sxs-lookup"><span data-stu-id="891d4-193">There are two key considerations for choosing a partition key:</span></span>

* <span data-ttu-id="891d4-194">**Limite de requête et les transactions**: votre choix de clé de partition doit équilibrer l’utilisation des hello hello besoin tooenable de transactions par rapport à hello exigence toodistribute vos entités sur plusieurs tooensure de clés de partition d’une solution évolutive.</span><span class="sxs-lookup"><span data-stu-id="891d4-194">**Boundary for query and transactions**: Your choice of partition key should balance hello need tooenable hello use of transactions against hello requirement toodistribute your entities across multiple partition keys tooensure a scalable solution.</span></span> <span data-ttu-id="891d4-195">Une des extrémités, vous pouvez définir hello même clé de partition pour tous vos éléments, mais cela peut limiter l’extensibilité du hello de votre solution.</span><span class="sxs-lookup"><span data-stu-id="891d4-195">At one extreme, you could set hello same partition key for all your items, but this may limit hello scalability of your solution.</span></span> <span data-ttu-id="891d4-196">À hello inverse, vous pouvez affecter une clé de partition unique pour chaque élément, ce qui serait hautement évolutive, mais vous empêchent de l’utilisation de transactions entre des documents via des procédures stockées et les déclencheurs.</span><span class="sxs-lookup"><span data-stu-id="891d4-196">At hello other extreme, you could assign a unique partition key for each item, which would be highly scalable but would prevent you from using cross document transactions via stored procedures and triggers.</span></span> <span data-ttu-id="891d4-197">Une clé de partition idéale est un qui vous permet de toouse des requêtes efficaces et qui a une cardinalité suffisamment tooensure votre solution est évolutive.</span><span class="sxs-lookup"><span data-stu-id="891d4-197">An ideal partition key is one that enables you toouse efficient queries and that has sufficient cardinality tooensure your solution is scalable.</span></span> 
* <span data-ttu-id="891d4-198">**Aucun goulet d’étranglement de performances et de stockage**: il est important de toopick une propriété qui permet d’écrit toobe répartis entre les différentes valeurs distinctes.</span><span class="sxs-lookup"><span data-stu-id="891d4-198">**No storage and performance bottlenecks**: It is important toopick a property that allows writes toobe distributed across various distinct values.</span></span> <span data-ttu-id="891d4-199">Demandes toohello même clé de partition ne peut pas dépasser le débit d’une partition unique hello et sont limités.</span><span class="sxs-lookup"><span data-stu-id="891d4-199">Requests toohello same partition key cannot exceed hello throughput of a single partition, and are throttled.</span></span> <span data-ttu-id="891d4-200">Il est donc important toopick une clé de partition qui n’entraîne pas de « zones réactives » au sein de votre application.</span><span class="sxs-lookup"><span data-stu-id="891d4-200">So it is important toopick a partition key that does not result in "hot spots" within your application.</span></span> <span data-ttu-id="891d4-201">Puisque toutes les données hello pour une clé de partition unique doit être stockée dans une partition, il est également recommandé des clés de partition tooavoid qui ont des volumes élevés de données pour hello même valeur.</span><span class="sxs-lookup"><span data-stu-id="891d4-201">Since all hello data for a single partition key must be stored within a partition, it is also recommended tooavoid partition keys that have high volumes of data for hello same value.</span></span> 

<span data-ttu-id="891d4-202">Nous allons examiner quelques scénarios réels et les bonnes clés de partition à chaque fois :</span><span class="sxs-lookup"><span data-stu-id="891d4-202">Let's look at a few real-world scenarios, and good partition keys for each:</span></span>
* <span data-ttu-id="891d4-203">Si vous implémentez un service de profil utilisateur principal, l’ID d’utilisateur hello est un bon choix pour la clé de partition.</span><span class="sxs-lookup"><span data-stu-id="891d4-203">If you’re implementing a user profile backend, then hello user ID is a good choice for partition key.</span></span>
* <span data-ttu-id="891d4-204">Si vous stockez des données IoT, comme l’état d’appareil, un ID d’appareil constitue un bon choix pour la clé de partition.</span><span class="sxs-lookup"><span data-stu-id="891d4-204">If you’re storing IoT data for example, device state, a device ID is a good choice for partition key.</span></span>
* <span data-ttu-id="891d4-205">Si vous utilisez une base de données Azure Cosmos pour la journalisation des données de série chronologique, puis hello nom d’hôte ou l’ID de processus est un bon choix pour la clé de partition.</span><span class="sxs-lookup"><span data-stu-id="891d4-205">If you’re using Azure Cosmos DB for logging time-series data, then hello hostname or process ID is a good choice for partition key.</span></span>
* <span data-ttu-id="891d4-206">Si vous disposez d’une architecture mutualisée, ID de client hello est un bon choix pour la clé de partition.</span><span class="sxs-lookup"><span data-stu-id="891d4-206">If you have a multi-tenant architecture, hello tenant ID is a good choice for partition key.</span></span>

<span data-ttu-id="891d4-207">Dans certains cas comme IoT d’utilisation et les profils utilisateur, clé de partition hello peut être hello même comme id (clé de document).</span><span class="sxs-lookup"><span data-stu-id="891d4-207">In some use cases like IoT and user profiles, hello partition key might be hello same as your id (document key).</span></span> <span data-ttu-id="891d4-208">Dans d’autres données de série chronologique hello, vous pouvez avoir une clé de partition qui est différente de celle des id de hello.</span><span class="sxs-lookup"><span data-stu-id="891d4-208">In others like hello time series data, you might have a partition key that’s different than hello id.</span></span>

### <a name="partitioning-and-loggingtime-series-data"></a><span data-ttu-id="891d4-209">Partitionnement et journalisation de données de série chronologique</span><span class="sxs-lookup"><span data-stu-id="891d4-209">Partitioning and logging/time-series data</span></span>
<span data-ttu-id="891d4-210">Un des cas d’usage courants hello de base de données Cosmos est pour l’enregistrement et les données de télémétrie.</span><span class="sxs-lookup"><span data-stu-id="891d4-210">One of hello common use cases of Cosmos DB is for logging and telemetry.</span></span> <span data-ttu-id="891d4-211">Il est important toopick une bonne clé de partition, car vous devrez peut-être tooread/écriture d’importants volumes de données.</span><span class="sxs-lookup"><span data-stu-id="891d4-211">It is important toopick a good partition key since you might need tooread/write vast volumes of data.</span></span> <span data-ttu-id="891d4-212">choix de Hello dépend de votre en lecture et écriture taux et les types de requêtes que vous attendez toorun.</span><span class="sxs-lookup"><span data-stu-id="891d4-212">hello choice depends on your read and write rates and kinds of queries you expect toorun.</span></span> <span data-ttu-id="891d4-213">Voici quelques conseils sur la façon de toochoose une bonne clé de partition.</span><span class="sxs-lookup"><span data-stu-id="891d4-213">Here are some tips on how toochoose a good partition key.</span></span>

* <span data-ttu-id="891d4-214">Si votre cas d’usage implique un petit taux d’écrit accumulation sur une longue période de temps et besoin tooquery par plages d’horodatages et les autres filtres, puis à l’aide d’un correctif cumulatif de timestamp hello, par exemple, date comme une clé de partition est une bonne approche.</span><span class="sxs-lookup"><span data-stu-id="891d4-214">If your use case involves a small rate of writes accumulating over a long period of time, and need tooquery by ranges of timestamps and other filters, then using a rollup of hello timestamp, for example,  date as a partition key is a good approach.</span></span> <span data-ttu-id="891d4-215">Ainsi, vous tooquery sur toutes les données hello pour une date à partir d’une seule partition.</span><span class="sxs-lookup"><span data-stu-id="891d4-215">This allows you tooquery over all hello data for a date from a single partition.</span></span> 
* <span data-ttu-id="891d4-216">Si votre charge de travail est lourde en écriture, ce qui est plus courant, vous devez utiliser une clé de partition qui n’est pas basée sur l’horodatage, afin que Cosmos DB puisse répartir uniformément les écritures sur diverses partitions.</span><span class="sxs-lookup"><span data-stu-id="891d4-216">If your workload is written heavy, which is more common, you should use a partition key that’s not based on timestamp so that Cosmos DB can distribute writes evenly across various partitions.</span></span> <span data-ttu-id="891d4-217">Dans ce cas, un nom d’hôte, un ID de processus, un ID d’activité ou une autre propriété présentant une cardinalité élevée constituent un bon choix.</span><span class="sxs-lookup"><span data-stu-id="891d4-217">Here a hostname, process ID, activity ID, or another property with high cardinality is a good choice.</span></span> 
* <span data-ttu-id="891d4-218">Une troisième méthode est un hybride une où vous disposez de plusieurs conteneurs, une pour chaque jour/mois et de clé de partition hello est une propriété granulaire comme nom d’hôte.</span><span class="sxs-lookup"><span data-stu-id="891d4-218">A third approach is a hybrid one where you have multiple containers, one for each day/month and hello partition key is a granular property like hostname.</span></span> <span data-ttu-id="891d4-219">Cela a pour avantage hello que vous pouvez définir différents débit en fonction de la fenêtre de temps hello, par exemple, conteneur hello pour hello mois en cours est configuré avec un débit plus élevé, car il fait Office de lectures et écritures, tandis que les mois précédents à diminuer le débit depuis ils servent uniquement des lectures.</span><span class="sxs-lookup"><span data-stu-id="891d4-219">This has hello benefit that you can set different throughput based on hello time window, for example, hello container for hello current month is provisioned with higher throughput since it serves reads and writes, whereas previous months with lower throughput since they only serve reads.</span></span>

### <a name="partitioning-and-multi-tenancy"></a><span data-ttu-id="891d4-220">Partitionnement et mutualisation</span><span class="sxs-lookup"><span data-stu-id="891d4-220">Partitioning and multi-tenancy</span></span>
<span data-ttu-id="891d4-221">Si vous implémentez une application mutualisée à l’aide de Cosmos DB, il existe deux modèles populaires : une clé de partition par client et un conteneur par client.</span><span class="sxs-lookup"><span data-stu-id="891d4-221">If you are implementing a multi-tenant application using Cosmos DB, there are two popular patterns – one partition key per tenant, and one container per tenant.</span></span> <span data-ttu-id="891d4-222">Avantages et inconvénients de chaque hello sont :</span><span class="sxs-lookup"><span data-stu-id="891d4-222">Here are hello pros and cons for each:</span></span>

* <span data-ttu-id="891d4-223">Une clé de partition par client : dans ce modèle, les clients sont colocalisés au sein d’un conteneur unique.</span><span class="sxs-lookup"><span data-stu-id="891d4-223">One Partition Key per tenant: In this model, tenants are collocated within a single container.</span></span> <span data-ttu-id="891d4-224">Mais les requêtes et les insertions pour les éléments avec un seul client peuvent être exécutées sur une partition unique.</span><span class="sxs-lookup"><span data-stu-id="891d4-224">But queries and inserts for items within a single tenant can be performed against a single partition.</span></span> <span data-ttu-id="891d4-225">Vous pouvez également implémenter une logique transactionnelle sur tous les éléments avec un client.</span><span class="sxs-lookup"><span data-stu-id="891d4-225">You can also implement transactional logic across all items within a tenant.</span></span> <span data-ttu-id="891d4-226">Étant donné que plusieurs clients partagent un conteneur, vous économisez des coûts de stockage et de débit en regroupant les ressources pour les clients dans un seul conteneur plutôt que d’approvisionner une marge supplémentaire pour chaque client.</span><span class="sxs-lookup"><span data-stu-id="891d4-226">Since multiple tenants share a container, you can save storage and throughput costs by pooling resources for tenants within a single container rather than provisioning extra headroom for each tenant.</span></span> <span data-ttu-id="891d4-227">Hello inconvénient que vous n’avez pas l’isolation des performances par locataire.</span><span class="sxs-lookup"><span data-stu-id="891d4-227">hello drawback is that you do not have performance isolation per tenant.</span></span> <span data-ttu-id="891d4-228">Augmentation des performances ou de débit s’appliquent toohello tout conteneur vs ciblés augmente pour les clients.</span><span class="sxs-lookup"><span data-stu-id="891d4-228">Performance/throughput increases apply toohello entire container vs targeted increases for tenants.</span></span>
* <span data-ttu-id="891d4-229">Un conteneur par client : chaque client possède son propre conteneur.</span><span class="sxs-lookup"><span data-stu-id="891d4-229">One Container per tenant: Each tenant has its own container.</span></span> <span data-ttu-id="891d4-230">Dans ce modèle, vous pouvez réserver des performances par client.</span><span class="sxs-lookup"><span data-stu-id="891d4-230">In this model, you can reserve performance per tenant.</span></span> <span data-ttu-id="891d4-231">Avec le nouveau modèle de tarification du provisionnement de Cosmos DB, ce modèle est plus rentable pour les applications mutualisées avec peu de clients.</span><span class="sxs-lookup"><span data-stu-id="891d4-231">With Cosmos DB's new provisioning pricing model, this model is more cost-effective for multi-tenant applications with a few tenants.</span></span>

<span data-ttu-id="891d4-232">Vous pouvez également utiliser une approche hiérarchisé combinaison collocates petits locataires et migre le plus grand conteneur propre tootheir de clients.</span><span class="sxs-lookup"><span data-stu-id="891d4-232">You can also use a combination/tiered approach that collocates small tenants and migrates larger tenants tootheir own container.</span></span>

## <a name="next-steps"></a><span data-ttu-id="891d4-233">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="891d4-233">Next steps</span></span>
<span data-ttu-id="891d4-234">Dans cet article, nous avons proposé une vue d’ensemble des concepts et bonnes pratiques pour le partitionnement avec l’API Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="891d4-234">In this article, we provided an overview for an overview of concepts and best practices for partitioning with any Azure Cosmos DB API.</span></span> 

* <span data-ttu-id="891d4-235">Apprenez-en davantage sur le [débit approvisionné dans Azure Cosmos DB](request-units.md)</span><span class="sxs-lookup"><span data-stu-id="891d4-235">Learn about [provisioned throughput in Azure Cosmos DB](request-units.md)</span></span>
* <span data-ttu-id="891d4-236">En savoir plus sur la [distribution globale dans Azure Cosmos DB](distribute-data-globally.md)</span><span class="sxs-lookup"><span data-stu-id="891d4-236">Learn about [global distribution in Azure Cosmos DB](distribute-data-globally.md)</span></span>



