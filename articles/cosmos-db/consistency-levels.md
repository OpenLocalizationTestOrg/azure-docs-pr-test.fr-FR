---
title: "Niveaux de cohérence dans Azure Cosmos DB | Microsoft Docs"
description: "Azure Cosmos DB offre cinq niveaux de cohérence qui permettent de faire des compromis avisés entre cohérence éventuelle, disponibilité et latence."
keywords: "cohérence éventuelle, azure cosmos db, azure, Microsoft Azure"
services: cosmos-db
author: mimig1
manager: jhubbard
editor: cgronlun
documentationcenter: 
ms.assetid: 3fe51cfa-a889-4a4a-b320-16bf871fe74c
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/16/2017
ms.author: mimig
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: a1ebec2285982c70aa9dc49950769fe18e2e2d0d
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/03/2017
---
# <a name="tunable-data-consistency-levels-in-azure-cosmos-db"></a><span data-ttu-id="b70cb-104">Niveaux de cohérence des données paramétrables dans Azure Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="b70cb-104">Tunable data consistency levels in Azure Cosmos DB</span></span>
<span data-ttu-id="b70cb-105">Azure Cosmos DB a été conçu dès le départ pour être distribué à l’échelle mondiale.</span><span class="sxs-lookup"><span data-stu-id="b70cb-105">Azure Cosmos DB is designed from the ground up with global distribution in mind for every data model.</span></span> <span data-ttu-id="b70cb-106">Il offre des garanties de latence faible prévisible, un SLA de disponibilité à 99,99 % et plusieurs modèles de cohérence souples bien définis.</span><span class="sxs-lookup"><span data-stu-id="b70cb-106">It is designed to offer predictable low latency guarantees, a 99.99% availability SLA, and multiple well-defined relaxed consistency models.</span></span> <span data-ttu-id="b70cb-107">Pour le moment, Azure Cosmos DB prend en charge cinq niveaux de cohérence : Fort, Obsolescence limitée, Session, Préfixe cohérent et Éventuel.</span><span class="sxs-lookup"><span data-stu-id="b70cb-107">Currently, Azure Cosmos DB provides five consistency levels: strong, bounded-staleness, session, consistent prefix, and eventual.</span></span> 

<span data-ttu-id="b70cb-108">Outre les modèles de cohérence **fort** et **éventuel** souvent offerts par les bases de données distribuées, Azure Cosmos DB propose trois modèles de cohérence supplémentaires soigneusement codifiés et mis en œuvre, et dont l’utilité a été validée dans des conditions d’utilisation réelles.</span><span class="sxs-lookup"><span data-stu-id="b70cb-108">Besides **strong** and **eventual consistency** models commonly offered by distributed databases, Azure Cosmos DB offers three more carefully codified and operationalized consistency models, and has validated their usefulness against real world use cases.</span></span> <span data-ttu-id="b70cb-109">Ces niveaux de cohérence sont **obsolescence limitée**, **session** et **préfixe cohérent**.</span><span class="sxs-lookup"><span data-stu-id="b70cb-109">These are the **bounded staleness**, **session**, and **consistent prefix** consistency levels.</span></span> <span data-ttu-id="b70cb-110">Ensemble, ces cinq niveaux de cohérence vous permettent de trouver un bon compromis entre cohérence, disponibilité et latence.</span><span class="sxs-lookup"><span data-stu-id="b70cb-110">Collectively these five consistency levels enable you to make well-reasoned trade-offs between consistency, availability, and latency.</span></span> 

## <a name="distributed-databases-and-consistency"></a><span data-ttu-id="b70cb-111">Bases de données distribuées et cohérence</span><span class="sxs-lookup"><span data-stu-id="b70cb-111">Distributed databases and consistency</span></span>
<span data-ttu-id="b70cb-112">Les bases de données distribuées commerciales se répartissent en deux catégories : les bases de données qui n’offrent pas de choix de cohérence bien définis et démontrables et celles qui offrent deux possibilités de programmabilité extrêmes (cohérence éventuelle et forte).</span><span class="sxs-lookup"><span data-stu-id="b70cb-112">Commercial distributed databases fall into two categories: databases that do not offer well-defined, provable consistency choices at all, and databases which offer two extreme programmability choices (strong vs. eventual consistency).</span></span> 

<span data-ttu-id="b70cb-113">La première option embrouille les développeurs d’applications en raison des menus détails de leurs protocoles de réplication et les oblige à faire des compromis difficiles entre cohérence, disponibilité, latence et débit.</span><span class="sxs-lookup"><span data-stu-id="b70cb-113">The former burdens application developers with minutia of their replication protocols and expects them to make difficult tradeoffs between consistency, availability, latency, and throughput.</span></span> <span data-ttu-id="b70cb-114">La deuxième option demande de choisir l’un des deux extrêmes.</span><span class="sxs-lookup"><span data-stu-id="b70cb-114">The latter puts a pressure to choose one of the two extremes.</span></span> <span data-ttu-id="b70cb-115">En dépit de l’abondance des études et des propositions concernant plus de 50 modèles de cohérence, la communauté des bases de données distribuées n’a pas été en mesure de commercialiser des niveaux de cohérence allant au-delà de la cohérence forte ou éventuelle.</span><span class="sxs-lookup"><span data-stu-id="b70cb-115">Despite the abundance of research and proposals for more than 50 consistency models, the distributed database community has not been able to commercialize consistency levels beyond strong and eventual consistency.</span></span> <span data-ttu-id="b70cb-116">Cosmos DB vous permet aux développeurs de choisir entre cinq modèles de cohérence bien définis couvrant tout l’éventail de cohérences : fort, obsolescence limitée, [session](http://dl.acm.org/citation.cfm?id=383631), préfixe cohérent et éventuel.</span><span class="sxs-lookup"><span data-stu-id="b70cb-116">Cosmos DB allows developers to choose between five well-defined consistency models along the consistency spectrum – strong, bounded staleness, [session](http://dl.acm.org/citation.cfm?id=383631), consistent prefix, and eventual.</span></span> 

![Azure Cosmos DB offre le choix entre plusieurs modèles de cohérence bien définis (souples)](./media/consistency-levels/five-consistency-levels.png)

<span data-ttu-id="b70cb-118">Le tableau suivant illustre les garanties spécifiques que chaque niveau de cohérence fournit.</span><span class="sxs-lookup"><span data-stu-id="b70cb-118">The following table illustrates the specific guarantees each consistency level provides.</span></span>
 
<span data-ttu-id="b70cb-119">**Niveaux de cohérence et garanties**</span><span class="sxs-lookup"><span data-stu-id="b70cb-119">**Consistency Levels and guarantees**</span></span>

| <span data-ttu-id="b70cb-120">Niveau de cohérence</span><span class="sxs-lookup"><span data-stu-id="b70cb-120">Consistency Level</span></span> | <span data-ttu-id="b70cb-121">Garanties</span><span class="sxs-lookup"><span data-stu-id="b70cb-121">Guarantees</span></span> |
| --- | --- |
| <span data-ttu-id="b70cb-122">Remarque</span><span class="sxs-lookup"><span data-stu-id="b70cb-122">Strong</span></span> | <span data-ttu-id="b70cb-123">Linéarisabilité</span><span class="sxs-lookup"><span data-stu-id="b70cb-123">Linearizability</span></span> |
| <span data-ttu-id="b70cb-124">Obsolescence limitée</span><span class="sxs-lookup"><span data-stu-id="b70cb-124">Bounded Staleness</span></span> | <span data-ttu-id="b70cb-125">Préfixe cohérent.</span><span class="sxs-lookup"><span data-stu-id="b70cb-125">Consistent Prefix.</span></span> <span data-ttu-id="b70cb-126">Retard des lectures par rapport aux écritures par k préfixes ou un intervalle t</span><span class="sxs-lookup"><span data-stu-id="b70cb-126">Reads lag behind writes by k prefixes or t interval</span></span> |
| <span data-ttu-id="b70cb-127">session</span><span class="sxs-lookup"><span data-stu-id="b70cb-127">Session</span></span>   | <span data-ttu-id="b70cb-128">Préfixe cohérent.</span><span class="sxs-lookup"><span data-stu-id="b70cb-128">Consistent Prefix.</span></span> <span data-ttu-id="b70cb-129">Lectures unitones, écritures unitones, lecture de vos écritures, l’écriture suit les lectures</span><span class="sxs-lookup"><span data-stu-id="b70cb-129">Monotonic reads, monotonic writes, read-your-writes, write-follows-reads</span></span> |
| <span data-ttu-id="b70cb-130">Préfixe cohérent</span><span class="sxs-lookup"><span data-stu-id="b70cb-130">Consistent Prefix</span></span> | <span data-ttu-id="b70cb-131">Les mises à jour retournées sont un préfixe de toutes les mises à jour, sans interruption</span><span class="sxs-lookup"><span data-stu-id="b70cb-131">Updates returned are some prefix of all the updates, with no gaps</span></span> |
| <span data-ttu-id="b70cb-132">Eventual (Éventuel)</span><span class="sxs-lookup"><span data-stu-id="b70cb-132">Eventual</span></span>  | <span data-ttu-id="b70cb-133">Lectures en désordre</span><span class="sxs-lookup"><span data-stu-id="b70cb-133">Out of order reads</span></span> |

<span data-ttu-id="b70cb-134">Vous pouvez configurer le niveau de cohérence par défaut de votre compte Cosmos DB (et remplacer ultérieurement la cohérence sur une demande de lecture spécifique).</span><span class="sxs-lookup"><span data-stu-id="b70cb-134">You can configure the default consistency level on your Cosmos DB account (and later override the consistency on a specific read request).</span></span> <span data-ttu-id="b70cb-135">En interne, le niveau de cohérence par défaut s’applique aux données au sein des groupes de partitions qui peuvent chevaucher différentes régions.</span><span class="sxs-lookup"><span data-stu-id="b70cb-135">Internally, the default consistency level applies to data within the partition sets which may span regions.</span></span> <span data-ttu-id="b70cb-136">Environ 73 % de nos clients utilisent la cohérence de session et 20 % y préfèrent l’obsolescence limitée.</span><span class="sxs-lookup"><span data-stu-id="b70cb-136">About 73% of our tenants use session consistency and 20% prefer bounded staleness.</span></span> <span data-ttu-id="b70cb-137">Nous observons qu’environ 3 % de nos clients expérimentent initialement différents niveaux de cohérence avant de choisir une cohérence spécifique pour leur application.</span><span class="sxs-lookup"><span data-stu-id="b70cb-137">We observe that approximately 3% of our customers experiment with various consistency levels initially before settling on a specific consistency choice for their application.</span></span> <span data-ttu-id="b70cb-138">Nous observons également que seuls 2 % de nos clients modifient les niveaux de cohérence sur demande.</span><span class="sxs-lookup"><span data-stu-id="b70cb-138">We also observe that only 2% of our tenants override consistency levels on a per request basis.</span></span> 

<span data-ttu-id="b70cb-139">Dans DB Cosmos, les lectures au niveaux de cohérence session, préfixe cohérent et cohérence éventuelle sont deux fois meilleur marché que les lectures aux niveaux de cohérence fort ou obsolescence limitée.</span><span class="sxs-lookup"><span data-stu-id="b70cb-139">In Cosmos DB, reads served at session, consistent prefix and eventual consistency are twice as cheap as reads with strong or bounded staleness consistency.</span></span> <span data-ttu-id="b70cb-140">Cosmos DB offre des SLA à 99,99 % exhaustifs de pointe, incluant des garanties de cohérence en plus de la disponibilité, du débit et de la latence.</span><span class="sxs-lookup"><span data-stu-id="b70cb-140">Cosmos DB has industry leading comprehensive 99.99% SLAs including consistency guarantees along with availability, throughput, and latency.</span></span> <span data-ttu-id="b70cb-141">Nous utilisons un [vérificateur de linéarisabilité](http://dl.acm.org/citation.cfm?id=1806634) qui opère en permanence sur nos résultats de télémétrie de service et vous signale ouvertement toutes les violations de cohérence.</span><span class="sxs-lookup"><span data-stu-id="b70cb-141">We employ a [linearizability checker](http://dl.acm.org/citation.cfm?id=1806634), which continuously operates over our service telemetry and openly reports any consistency violations to you.</span></span> <span data-ttu-id="b70cb-142">Pour le niveau de cohérence obsolescence limitée, nous surveillons et signalons toute violation des limites k et t.</span><span class="sxs-lookup"><span data-stu-id="b70cb-142">For bounded staleness, we monitor and report any violations to k and t bounds.</span></span> <span data-ttu-id="b70cb-143">Pour les cinq niveaux de cohérence souple, nous vous signalons aussi directement la [métrique probabiliste d’obsolescence limitée](http://dl.acm.org/citation.cfm?id=2212359).</span><span class="sxs-lookup"><span data-stu-id="b70cb-143">For all five relaxed consistency levels, we also report the [probabilistic bounded staleness metric](http://dl.acm.org/citation.cfm?id=2212359) directly to you.</span></span>  

## <a name="scope-of-consistency"></a><span data-ttu-id="b70cb-144">Portée de la cohérence</span><span class="sxs-lookup"><span data-stu-id="b70cb-144">Scope of consistency</span></span>
<span data-ttu-id="b70cb-145">La granularité de la cohérence est limitée à la demande d’un utilisateur unique.</span><span class="sxs-lookup"><span data-stu-id="b70cb-145">The granularity of consistency is scoped to a single user request.</span></span> <span data-ttu-id="b70cb-146">Une demande d’écriture peut correspondre à une transaction d’insertion, de remplacement, d’upsert ou de suppression.</span><span class="sxs-lookup"><span data-stu-id="b70cb-146">A write request may correspond to an insert, replace, upsert, or delete transaction.</span></span> <span data-ttu-id="b70cb-147">Comme dans le cas des écritures, une transaction de lecture/requête est également limitée à une demande d’utilisateur unique.</span><span class="sxs-lookup"><span data-stu-id="b70cb-147">As with writes, a read/query transaction is also scoped to a single user request.</span></span> <span data-ttu-id="b70cb-148">L’utilisateur peut être amené à paginer un grand jeu de résultats, s’étendant sur plusieurs partitions, mais chaque transaction de lecture se limite à une seule page et est traitée à partir d’une seule partition.</span><span class="sxs-lookup"><span data-stu-id="b70cb-148">The user may be required to paginate over a large result-set, spanning multiple partitions, but each read transaction is scoped to a single page and served from within a single partition.</span></span>

## <a name="consistency-levels"></a><span data-ttu-id="b70cb-149">Niveaux de cohérence</span><span class="sxs-lookup"><span data-stu-id="b70cb-149">Consistency levels</span></span>
<span data-ttu-id="b70cb-150">Vous pouvez configurer un niveau de cohérence par défaut sur votre compte de base de données, qui s’applique à toutes les collections (et bases de données) sous votre compte Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="b70cb-150">You can configure a default consistency level on your database account that applies to all collections (and databases) under your Cosmos DB account.</span></span> <span data-ttu-id="b70cb-151">Par défaut, toutes les lectures et requêtes émises vers les ressources définies par l’utilisateur utilisent le niveau de cohérence par défaut spécifié sur le compte de base de données.</span><span class="sxs-lookup"><span data-stu-id="b70cb-151">By default, all reads and queries issued against the user-defined resources use the default consistency level specified on the database account.</span></span> <span data-ttu-id="b70cb-152">Vous pouvez assouplir le niveau de cohérence d’une demande spécifique de lecture/requête donnée dans chacune des API prises en charge.</span><span class="sxs-lookup"><span data-stu-id="b70cb-152">You can relax the consistency level of a specific read/query request using in each of the supported APIs.</span></span> <span data-ttu-id="b70cb-153">Cinq types de niveaux de cohérence sont pris en charge par le protocole de réplication de d’Azure Cosmos DB. Ils offrent un compromis clair entre les garanties de cohérence spécifiques et les performances, comme décrit dans cette section.</span><span class="sxs-lookup"><span data-stu-id="b70cb-153">There are five types of consistency levels supported by the Azure Cosmos DB replication protocol that provide a clear trade-off between specific consistency guarantees and performance, as described in this section.</span></span>

<span data-ttu-id="b70cb-154">**Remarque**:</span><span class="sxs-lookup"><span data-stu-id="b70cb-154">**Strong**:</span></span> 

* <span data-ttu-id="b70cb-155">Une cohérence forte offre une garantie de [linéarisabilité](https://aphyr.com/posts/313-strong-consistency-models) qui permet de s’assurer que les lectures renvoient la version la plus récente d’un élément.</span><span class="sxs-lookup"><span data-stu-id="b70cb-155">Strong consistency offers a [linearizability](https://aphyr.com/posts/313-strong-consistency-models) guarantee with the reads guaranteed to return the most recent version of an item.</span></span> 
* <span data-ttu-id="b70cb-156">la cohérence forte garantit qu'une écriture est visible uniquement après sa validation durable par le quorum majoritaire de réplicas.</span><span class="sxs-lookup"><span data-stu-id="b70cb-156">Strong consistency guarantees that a write is only visible after it is committed durably by the majority quorum of replicas.</span></span> <span data-ttu-id="b70cb-157">Une écriture est soit validée durablement de manière synchrone par les quorums principal et secondaire, soit abandonnée.</span><span class="sxs-lookup"><span data-stu-id="b70cb-157">A write is either synchronously committed durably by both the primary and the quorum of secondaries, or it is aborted.</span></span> <span data-ttu-id="b70cb-158">Une lecture est toujours reconnue par le quorum de lecture majoritaire : un client ne voit jamais une écriture partielle ou non validée. Il est assuré de lire la toute dernière écriture reconnue.</span><span class="sxs-lookup"><span data-stu-id="b70cb-158">A read is always acknowledged by the majority read quorum, a client can never see an uncommitted or partial write and is always guaranteed to read the latest acknowledged write.</span></span> 
* <span data-ttu-id="b70cb-159">Les comptes Azure Cosmos DB configurés pour utiliser une cohérence forte ne peuvent pas associer plus d’une région Azure à leur compte.</span><span class="sxs-lookup"><span data-stu-id="b70cb-159">Azure Cosmos DB accounts that are configured to use strong consistency cannot associate more than one Azure region with their Azure Cosmos DB account.</span></span> 
* <span data-ttu-id="b70cb-160">Le coût d’une opération de lecture (en termes [d’unités de requête](request-units.md) consommées) avec une cohérence forte est supérieur à celui des niveaux Session et Éventuel, mais équivalent à celui du niveau Obsolescence limitée.</span><span class="sxs-lookup"><span data-stu-id="b70cb-160">The cost of a read operation (in terms of [request units](request-units.md) consumed) with strong consistency is higher than session and eventual, but the same as bounded staleness.</span></span>

<span data-ttu-id="b70cb-161">**Obsolescence limitée**:</span><span class="sxs-lookup"><span data-stu-id="b70cb-161">**Bounded staleness**:</span></span> 

* <span data-ttu-id="b70cb-162">Le niveau de cohérence obsolescence limitée garantit que les lectures sont retardées derrière les écritures par, au plus, des versions ou préfixes *K* d’un élément ou un intervalle de temps *t*.</span><span class="sxs-lookup"><span data-stu-id="b70cb-162">Bounded staleness consistency guarantees that the reads may lag behind writes by at most *K* versions or prefixes of an item or *t* time-interval.</span></span> 
* <span data-ttu-id="b70cb-163">Par conséquent, lors du choix du niveau de cohérence obsolescence limitée, l’« obsolescence » peut être configurée de deux façons : par le nombre de versions *K* de l’élément par lequel les lectures sont retardées derrière les écritures, et l’intervalle de temps *t*</span><span class="sxs-lookup"><span data-stu-id="b70cb-163">Therefore, when choosing bounded staleness, the "staleness" can be configured in two ways: number of versions *K* of the item by which the reads lag behind the writes, and the time interval *t*</span></span> 
* <span data-ttu-id="b70cb-164">La cohérence de type obsolescence limitée fournit l’ordre global total, en dehors de la « fenêtre d’obsolescence ».</span><span class="sxs-lookup"><span data-stu-id="b70cb-164">Bounded staleness offers total global order except within the "staleness window."</span></span> <span data-ttu-id="b70cb-165">Notez que des garanties de lecture unitone existent dans une région à l’intérieur et en dehors de la « fenêtre d’obsolescence ».</span><span class="sxs-lookup"><span data-stu-id="b70cb-165">The monotonic read guarantees exists within a region both inside and outside the "staleness window."</span></span> 
* <span data-ttu-id="b70cb-166">La cohérence Obsolescence limitée fournit une meilleure garantie de cohérence que le niveau Session ou Éventuel.</span><span class="sxs-lookup"><span data-stu-id="b70cb-166">Bounded staleness provides a stronger consistency guarantee than session or eventual consistency.</span></span> <span data-ttu-id="b70cb-167">Pour les applications distribuées à l’échelle mondiale, nous recommandons d’utiliser la cohérence Obsolescence limitée pour les scénarios dans lesquels vous voulez obtenir une cohérence forte en plus d’une disponibilité à 99,99 % et d’une latence faible.</span><span class="sxs-lookup"><span data-stu-id="b70cb-167">For globally distributed applications, we recommend you use bounded staleness for scenarios where you would like to have strong consistency but also want 99.99% availability and low latency.</span></span> 
* <span data-ttu-id="b70cb-168">Les comptes Azure Cosmos DB configurés avec une cohérence de type obsolescence limitée peuvent associer n’importe quel nombre de régions Azure avec leur compte.</span><span class="sxs-lookup"><span data-stu-id="b70cb-168">Azure Cosmos DB accounts that are configured with bounded staleness consistency can associate any number of Azure regions with their Azure Cosmos DB account.</span></span> 
* <span data-ttu-id="b70cb-169">Le coût d’une opération de lecture (en termes d’unités de requête consommées) en fonction de l’obsolescence limitée est supérieur à celui des niveaux de cohérence Session et Éventuel, mais identique au niveau de cohérence forte.</span><span class="sxs-lookup"><span data-stu-id="b70cb-169">The cost of a read operation (in terms of RUs consumed) with bounded staleness is higher than session and eventual consistency, but the same as strong consistency.</span></span>

<span data-ttu-id="b70cb-170">**Session**:</span><span class="sxs-lookup"><span data-stu-id="b70cb-170">**Session**:</span></span> 

* <span data-ttu-id="b70cb-171">contrairement aux modèles de cohérence globaux offerts par les niveaux de cohérence Fort et Obsolescence limitée, le niveau Session s’étend à une session client spécifique.</span><span class="sxs-lookup"><span data-stu-id="b70cb-171">Unlike the global consistency models offered by strong and bounded staleness consistency levels, session consistency is scoped to a client session.</span></span> 
* <span data-ttu-id="b70cb-172">La cohérence Session est idéale pour tous les scénarios dans lesquels une session utilisateur ou d’appareil est impliquée, car elle garantit des lectures unitones, des écritures unitones et des garanties de lecture de vos propres écritures.</span><span class="sxs-lookup"><span data-stu-id="b70cb-172">Session consistency is ideal for all scenarios where a device or user session is involved since it guarantees monotonic reads, monotonic writes, and read your own writes (RYW) guarantees.</span></span> 
* <span data-ttu-id="b70cb-173">Ce niveau fournit une cohérence prévisible pour une session, et un débit de lecture maximal en offrant la latence d’écriture et de lecture la plus basse.</span><span class="sxs-lookup"><span data-stu-id="b70cb-173">Session consistency provides predictable consistency for a session, and maximum read throughput while offering the lowest latency writes and reads.</span></span> 
* <span data-ttu-id="b70cb-174">Les comptes Azure Cosmos DB configurés avec une cohérence de type session peuvent associer n’importe quel nombre de régions Azure avec leur compte.</span><span class="sxs-lookup"><span data-stu-id="b70cb-174">Azure Cosmos DB accounts that are configured with session consistency can associate any number of Azure regions with their Azure Cosmos DB account.</span></span> 
* <span data-ttu-id="b70cb-175">Le coût d’une opération de lecture (en termes d’unités de requête consommées) avec un niveau de cohérence Session est inférieur à celui des niveaux Fort et Obsolescence limitée, mais supérieur au niveau Éventuel.</span><span class="sxs-lookup"><span data-stu-id="b70cb-175">The cost of a read operation (in terms of RUs consumed) with session consistency level is less than strong and bounded staleness, but more than eventual consistency</span></span>

<span data-ttu-id="b70cb-176"><a id="consistent-prefix"></a>
**Préfixe cohérent** :</span><span class="sxs-lookup"><span data-stu-id="b70cb-176"><a id="consistent-prefix"></a>
**Consistent Prefix**:</span></span> 

* <span data-ttu-id="b70cb-177">Le niveau de cohérence préfixe cohérent garantit qu’en l’absence d’autres écritures, les réplicas du groupe finissent par converger.</span><span class="sxs-lookup"><span data-stu-id="b70cb-177">Consistent prefix guarantees that in absence of any further writes, the replicas within the group eventually converge.</span></span> 
* <span data-ttu-id="b70cb-178">Le niveau de cohérence préfixe cohérent garantit que les lectures ne voient jamais d’écritures dans le désordre.</span><span class="sxs-lookup"><span data-stu-id="b70cb-178">Consistent prefix guarantees that reads never see out of order writes.</span></span> <span data-ttu-id="b70cb-179">Si les écritures ont été effectuées dans l’ordre `A, B, C`, un client voit `A`, `A,B` ou `A,B,C`, mais jamais dans le désordre comme `A,C` ou `B,A,C`.</span><span class="sxs-lookup"><span data-stu-id="b70cb-179">If writes were performed in the order `A, B, C`, then a client sees either `A`, `A,B`, or `A,B,C`, but never out of order like `A,C` or `B,A,C`.</span></span>
* <span data-ttu-id="b70cb-180">Les comptes Azure Cosmos DB configurés avec une cohérence de type préfixe cohérent peuvent associer n’importe quel nombre de régions Azure avec leur compte.</span><span class="sxs-lookup"><span data-stu-id="b70cb-180">Azure Cosmos DB accounts that are configured with consistent prefix consistency can associate any number of Azure regions with their Azure Cosmos DB account.</span></span> 

<span data-ttu-id="b70cb-181">**Eventual (Éventuel)**:</span><span class="sxs-lookup"><span data-stu-id="b70cb-181">**Eventual**:</span></span> 

* <span data-ttu-id="b70cb-182">Le niveau de cohérence Éventuel garantit qu’en l’absence d’autres écritures, les réplicas du groupe finissent par converger.</span><span class="sxs-lookup"><span data-stu-id="b70cb-182">Eventual consistency guarantees that in absence of any further writes, the replicas within the group eventually converge.</span></span> 
* <span data-ttu-id="b70cb-183">Il s’agit de la forme de cohérence la plus faible qui permet à un client d’obtenir des valeurs plus anciennes que celles qu’il a pu voir précédemment.</span><span class="sxs-lookup"><span data-stu-id="b70cb-183">Eventual consistency is the weakest form of consistency where a client may get the values that are older than the ones it had seen before.</span></span>
* <span data-ttu-id="b70cb-184">Le niveau Éventuel fournit la cohérence la plus faible en matière de lecture, tout en offrant la latence la moins élevée pour les lectures et les écritures.</span><span class="sxs-lookup"><span data-stu-id="b70cb-184">Eventual consistency provides the weakest read consistency but offers the lowest latency for both reads and writes.</span></span>
* <span data-ttu-id="b70cb-185">Les comptes Azure Cosmos DB configurés avec une cohérence éventuelle peuvent associer n’importe quel nombre de régions Azure avec leur compte.</span><span class="sxs-lookup"><span data-stu-id="b70cb-185">Azure Cosmos DB accounts that are configured with eventual consistency can associate any number of Azure regions with their Azure Cosmos DB account.</span></span> 
* <span data-ttu-id="b70cb-186">Le coût d’une opération de lecture (en termes d’unités de requête consommées) avec un niveau de cohérence éventuelle est le plus bas de tous les niveaux de cohérence d’Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="b70cb-186">The cost of a read operation (in terms of RUs consumed) with the eventual consistency level is the lowest of all the Azure Cosmos DB consistency levels.</span></span>

## <a name="configuring-the-default-consistency-level"></a><span data-ttu-id="b70cb-187">Configuration du niveau de cohérence par défaut</span><span class="sxs-lookup"><span data-stu-id="b70cb-187">Configuring the default consistency level</span></span>
1. <span data-ttu-id="b70cb-188">Dans la barre de lancement du [portail Azure](https://portal.azure.com/), cliquez sur **Azure Cosmos DB**.</span><span class="sxs-lookup"><span data-stu-id="b70cb-188">In the [Azure portal](https://portal.azure.com/), in the Jumpbar, click **Azure Cosmos DB**.</span></span>
2. <span data-ttu-id="b70cb-189">Dans le panneau **Azure Cosmos DB**, sélectionnez le compte de base de données à modifier.</span><span class="sxs-lookup"><span data-stu-id="b70cb-189">In the **Azure Cosmos DB** blade, select the database account to modify.</span></span>
3. <span data-ttu-id="b70cb-190">Dans le panneau du compte, cliquez sur **Cohérence par défaut**.</span><span class="sxs-lookup"><span data-stu-id="b70cb-190">In the account blade, click **Default consistency**.</span></span>
4. <span data-ttu-id="b70cb-191">Dans le panneau **Cohérence par défaut**, sélectionnez le nouveau niveau de cohérence et cliquez sur **Enregistrer**.</span><span class="sxs-lookup"><span data-stu-id="b70cb-191">In the **Default Consistency** blade, select the new consistency level and click **Save**.</span></span>
   
    ![Capture d’écran montrant l’icône Paramètres et l’entrée Cohérence par défaut](./media/consistency-levels/database-consistency-level-1.png)

## <a name="consistency-levels-for-queries"></a><span data-ttu-id="b70cb-193">Niveaux de cohérence des requêtes</span><span class="sxs-lookup"><span data-stu-id="b70cb-193">Consistency levels for queries</span></span>
<span data-ttu-id="b70cb-194">Par défaut, pour les ressources définies par l’utilisateur, le niveau de cohérence des requêtes est identique à celui des lectures.</span><span class="sxs-lookup"><span data-stu-id="b70cb-194">By default, for user-defined resources, the consistency level for queries is the same as the consistency level for reads.</span></span> <span data-ttu-id="b70cb-195">Par défaut, l’index est mis à jour de manière synchrone lors de chaque insertion, remplacement ou suppression d’un élément dans le conteneur Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="b70cb-195">By default, the index is updated synchronously on each insert, replace, or delete of an item to the Cosmos DB container.</span></span> <span data-ttu-id="b70cb-196">Cela permet aux requêtes d’offrir le même niveau de cohérence que celui des lectures de point.</span><span class="sxs-lookup"><span data-stu-id="b70cb-196">This enables the queries to honor the same consistency level as that of point reads.</span></span> <span data-ttu-id="b70cb-197">Si Azure Cosmos DB est optimisé pour les écritures et prend en charge des volumes soutenus d’écritures, la maintenance d’index synchrone et les requêtes cohérentes, vous pouvez configurer certaines collections de manière à ce que la mise à jour de l’index soit effectuée en différé.</span><span class="sxs-lookup"><span data-stu-id="b70cb-197">While Azure Cosmos DB is write optimized and supports sustained volumes of writes, synchronous index maintenance and serving consistent queries, you can configure certain collections to update their index lazily.</span></span> <span data-ttu-id="b70cb-198">Ce processus permet d'optimiser encore plus les performances des écritures. Il est idéal pour les scénarios d'ingestion en bloc lorsqu'une charge de travail implique principalement des lectures.</span><span class="sxs-lookup"><span data-stu-id="b70cb-198">Lazy indexing further boosts the write performance and is ideal for bulk ingestion scenarios when a workload is primarily read-heavy.</span></span>  

| <span data-ttu-id="b70cb-199">Mode d'indexation</span><span class="sxs-lookup"><span data-stu-id="b70cb-199">Indexing Mode</span></span> | <span data-ttu-id="b70cb-200">Lectures</span><span class="sxs-lookup"><span data-stu-id="b70cb-200">Reads</span></span> | <span data-ttu-id="b70cb-201">Requêtes</span><span class="sxs-lookup"><span data-stu-id="b70cb-201">Queries</span></span> |
| --- | --- | --- |
| <span data-ttu-id="b70cb-202">Cohérence (par défaut)</span><span class="sxs-lookup"><span data-stu-id="b70cb-202">Consistent (default)</span></span> |<span data-ttu-id="b70cb-203">Choisir parmi Fort, Obsolescence limitée, Session, Préfixe cohérent et Éventuel</span><span class="sxs-lookup"><span data-stu-id="b70cb-203">Select from strong, bounded staleness, session, consistent prefix, or eventual</span></span> |<span data-ttu-id="b70cb-204">Choisir parmi Fort, Obsolescence limitée, Session et Éventuel</span><span class="sxs-lookup"><span data-stu-id="b70cb-204">Select from strong, bounded staleness, session, or eventual</span></span> |
| <span data-ttu-id="b70cb-205">Différé</span><span class="sxs-lookup"><span data-stu-id="b70cb-205">Lazy</span></span> |<span data-ttu-id="b70cb-206">Choisir parmi Fort, Obsolescence limitée, Session, Préfixe cohérent et Éventuel</span><span class="sxs-lookup"><span data-stu-id="b70cb-206">Select from strong, bounded staleness, session, consistent prefix, or eventual</span></span> |<span data-ttu-id="b70cb-207">Eventual (Éventuel)</span><span class="sxs-lookup"><span data-stu-id="b70cb-207">Eventual</span></span> |
| <span data-ttu-id="b70cb-208">Aucun</span><span class="sxs-lookup"><span data-stu-id="b70cb-208">None</span></span> |<span data-ttu-id="b70cb-209">Choisir parmi Fort, Obsolescence limitée, Session, Préfixe cohérent et Éventuel</span><span class="sxs-lookup"><span data-stu-id="b70cb-209">Select from strong, bounded staleness, session, consistent prefix, or eventual</span></span> |<span data-ttu-id="b70cb-210">Non applicable</span><span class="sxs-lookup"><span data-stu-id="b70cb-210">Not applicable</span></span> |

<span data-ttu-id="b70cb-211">Comme pour les demandes de lecture, vous pouvez réduire le niveau de cohérence d’une demande de requête spécifique dans chaque API.</span><span class="sxs-lookup"><span data-stu-id="b70cb-211">As with read requests, you can lower the consistency level of a specific query request in each API.</span></span>

## <a name="next-steps"></a><span data-ttu-id="b70cb-212">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="b70cb-212">Next steps</span></span>
<span data-ttu-id="b70cb-213">Si vous souhaitez en lire plus sur les niveaux de cohérence et les différents compromis, nous vous recommandons les ressources suivantes :</span><span class="sxs-lookup"><span data-stu-id="b70cb-213">If you'd like to do more reading about consistency levels and tradeoffs, we recommend the following resources:</span></span>

* <span data-ttu-id="b70cb-214">Doug Terry.</span><span class="sxs-lookup"><span data-stu-id="b70cb-214">Doug Terry.</span></span> <span data-ttu-id="b70cb-215">La cohérence des données répliquées expliquée par le baseball (vidéo).</span><span class="sxs-lookup"><span data-stu-id="b70cb-215">Replicated Data Consistency explained through baseball (video).</span></span>   
  [<span data-ttu-id="b70cb-216">https://www.youtube.com/watch?v=gluIh8zd26I</span><span class="sxs-lookup"><span data-stu-id="b70cb-216">https://www.youtube.com/watch?v=gluIh8zd26I</span></span>](https://www.youtube.com/watch?v=gluIh8zd26I)
* <span data-ttu-id="b70cb-217">Doug Terry.</span><span class="sxs-lookup"><span data-stu-id="b70cb-217">Doug Terry.</span></span> <span data-ttu-id="b70cb-218">La cohérence des données répliquées basée sur l’exemple du baseball.</span><span class="sxs-lookup"><span data-stu-id="b70cb-218">Replicated Data Consistency explained through baseball.</span></span>   
  [<span data-ttu-id="b70cb-219">http://research.microsoft.com/pubs/157411/ConsistencyAndBaseballReport.pdf</span><span class="sxs-lookup"><span data-stu-id="b70cb-219">http://research.microsoft.com/pubs/157411/ConsistencyAndBaseballReport.pdf</span></span>](http://research.microsoft.com/pubs/157411/ConsistencyAndBaseballReport.pdf)
* <span data-ttu-id="b70cb-220">Doug Terry.</span><span class="sxs-lookup"><span data-stu-id="b70cb-220">Doug Terry.</span></span> <span data-ttu-id="b70cb-221">Le niveau Par session garantit des données répliquées peu cohérentes.</span><span class="sxs-lookup"><span data-stu-id="b70cb-221">Session Guarantees for Weakly Consistent Replicated Data.</span></span>   
  [<span data-ttu-id="b70cb-222">http://dl.acm.org/citation.cfm?id=383631</span><span class="sxs-lookup"><span data-stu-id="b70cb-222">http://dl.acm.org/citation.cfm?id=383631</span></span>](http://dl.acm.org/citation.cfm?id=383631)
* <span data-ttu-id="b70cb-223">Daniel Abadi.</span><span class="sxs-lookup"><span data-stu-id="b70cb-223">Daniel Abadi.</span></span> <span data-ttu-id="b70cb-224">Cohérence des compromis en termes de conception de systèmes de base de données distribuée moderne : CAP n’est qu’une partie de l’histoire.</span><span class="sxs-lookup"><span data-stu-id="b70cb-224">Consistency Tradeoffs in Modern Distributed Database Systems Design: CAP is only part of the story”.</span></span>   
  [<span data-ttu-id="b70cb-225">http://computer.org/csdl/mags/co/2012/02/mco2012020037-abs.html</span><span class="sxs-lookup"><span data-stu-id="b70cb-225">http://computer.org/csdl/mags/co/2012/02/mco2012020037-abs.html</span></span>](http://computer.org/csdl/mags/co/2012/02/mco2012020037-abs.html)
* <span data-ttu-id="b70cb-226">Peter Bailis, Shivaram Venkataraman, Michael J. Franklin, Joseph M. Hellerstein, Ion Stoica.</span><span class="sxs-lookup"><span data-stu-id="b70cb-226">Peter Bailis, Shivaram Venkataraman, Michael J. Franklin, Joseph M. Hellerstein, Ion Stoica.</span></span> <span data-ttu-id="b70cb-227">Probabilités en fonction de l'obsolescence (PBS) pour les quorums partiels pratiques</span><span class="sxs-lookup"><span data-stu-id="b70cb-227">Probabilistic Bounded Staleness (PBS) for Practical Partial Quorums.</span></span>   
  [<span data-ttu-id="b70cb-228">http://vldb.org/pvldb/vol5/p776_peterbailis_vldb2012.pdf</span><span class="sxs-lookup"><span data-stu-id="b70cb-228">http://vldb.org/pvldb/vol5/p776_peterbailis_vldb2012.pdf</span></span>](http://vldb.org/pvldb/vol5/p776_peterbailis_vldb2012.pdf)
* <span data-ttu-id="b70cb-229">Werner Vogels.</span><span class="sxs-lookup"><span data-stu-id="b70cb-229">Werner Vogels.</span></span> <span data-ttu-id="b70cb-230">Niveau de cohérence Éventuel repensé.</span><span class="sxs-lookup"><span data-stu-id="b70cb-230">Eventual Consistent - Revisited.</span></span>    
  [<span data-ttu-id="b70cb-231">http://allthingsdistributed.com/2008/12/eventually_consistent.html</span><span class="sxs-lookup"><span data-stu-id="b70cb-231">http://allthingsdistributed.com/2008/12/eventually_consistent.html</span></span>](http://allthingsdistributed.com/2008/12/eventually_consistent.html)
* <span data-ttu-id="b70cb-232">Moni Naor , Avishai Wool, The Load, Capacity, and Availability of Quorum Systems, SIAM Journal on Computing, v.27 n.2, p.423-447, avril 1998.</span><span class="sxs-lookup"><span data-stu-id="b70cb-232">Moni Naor , Avishai Wool, The Load, Capacity, and Availability of Quorum Systems, SIAM Journal on Computing, v.27 n.2, p.423-447, April 1998.</span></span>
  [<span data-ttu-id="b70cb-233">http://epubs.siam.org/doi/abs/10.1137/S0097539795281232</span><span class="sxs-lookup"><span data-stu-id="b70cb-233">http://epubs.siam.org/doi/abs/10.1137/S0097539795281232</span></span>](http://epubs.siam.org/doi/abs/10.1137/S0097539795281232)
* <span data-ttu-id="b70cb-234">Sebastian Burckhardt, Chris Dern, Macanal Musuvathi, Roy Tan, Line-up : a complete and automatic linearizability checker, Proceedings of the 2010 ACM SIGPLAN conference on Programming language design and implementation, 05-10 juin 2010, Toronto, Ontario, Canada  [doi>10.1145/1806596.1806634] [http://dl.acm.org/citation.cfm?id=1806634](http://dl.acm.org/citation.cfm?id=1806634)</span><span class="sxs-lookup"><span data-stu-id="b70cb-234">Sebastian Burckhardt, Chris Dern, Macanal Musuvathi, Roy Tan, Line-up: a complete and automatic linearizability checker, Proceedings of the 2010 ACM SIGPLAN conference on Programming language design and implementation, June 05-10, 2010, Toronto, Ontario, Canada  [doi>10.1145/1806596.1806634] [http://dl.acm.org/citation.cfm?id=1806634](http://dl.acm.org/citation.cfm?id=1806634)</span></span>
* <span data-ttu-id="b70cb-235">Peter Bailis, Shivaram Venkataraman, Michael J. Franklin, Joseph M. Hellerstein, Ion Stoica, Probabilistically bounded staleness for practical partial quorums, Proceedings of the VLDB Endowment, v.5 n.8, p.776-787, avril 2012 [http://dl.acm.org/citation.cfm?id=2212359](http://dl.acm.org/citation.cfm?id=2212359)</span><span class="sxs-lookup"><span data-stu-id="b70cb-235">Peter Bailis, Shivaram Venkataraman, Michael J. Franklin, Joseph M. Hellerstein , Ion Stoica, Probabilistically bounded staleness for practical partial quorums, Proceedings of the VLDB Endowment, v.5 n.8, p.776-787, April 2012 [http://dl.acm.org/citation.cfm?id=2212359](http://dl.acm.org/citation.cfm?id=2212359)</span></span>
