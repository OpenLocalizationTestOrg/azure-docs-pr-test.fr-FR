---
title: "aaaOnline sauvegarde et restauration avec la base de données Azure Cosmos | Documents Microsoft"
description: "Découvrez comment tooperform automatique de sauvegarde et de restauration sur une base de données de la base de données Azure Cosmos."
keywords: sauvegarde et restauration, sauvegarde en ligne
services: cosmos-db
documentationcenter: 
author: RahulPrasad16
manager: jhubbard
editor: monicar
ms.assetid: 98eade4a-7ef4-4667-b167-6603ecd80b79
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: multiple
ms.topic: article
ms.date: 08/11/2017
ms.author: raprasa
ms.openlocfilehash: a0b464c95681dfc7b5462b02bf04c2c43d6bc16f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/06/2017
---
# <a name="automatic-online-backup-and-restore-with-azure-cosmos-db"></a><span data-ttu-id="9d152-104">Sauvegarde et restauration en ligne automatiques avec Azure Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="9d152-104">Automatic online backup and restore with Azure Cosmos DB</span></span>
<span data-ttu-id="9d152-105">Azure Cosmos DB sauvegarde automatiquement toutes vos données à intervalles réguliers.</span><span class="sxs-lookup"><span data-stu-id="9d152-105">Azure Cosmos DB automatically takes backups of all your data at regular intervals.</span></span> <span data-ttu-id="9d152-106">les sauvegardes automatiques Hello sont effectuées sans affecter les performances de hello ou la disponibilité de vos opérations de base de données.</span><span class="sxs-lookup"><span data-stu-id="9d152-106">hello automatic backups are taken without affecting hello performance or availability of your database operations.</span></span> <span data-ttu-id="9d152-107">Toutes vos sauvegardes sont stockées séparément dans un autre service de stockage, et ces sauvegardes sont répliquées globalement pour garantir la résilience contre les sinistres régionaux.</span><span class="sxs-lookup"><span data-stu-id="9d152-107">All your backups are stored separately in another storage service, and those backups are globally replicated for resiliency against regional disasters.</span></span> <span data-ttu-id="9d152-108">les sauvegardes automatiques Hello sont conçues pour les scénarios lorsque vous supprimez accidentellement le conteneur de votre base de données Comos et version ultérieure requièrent la récupération des données ou une solution de récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="9d152-108">hello automatic backups are intended for scenarios when you accidentally delete your Comos DB container and later require data recovery or a disaster recovery solution.</span></span>  

<span data-ttu-id="9d152-109">Cet article commence par un bref récapitulatif de la redondance des données hello et la disponibilité de base de données Cosmos et puis présente les sauvegardes.</span><span class="sxs-lookup"><span data-stu-id="9d152-109">This article starts with a quick recap of hello data redundancy and availability in Cosmos DB, and then discusses backups.</span></span> 

## <a name="high-availability-with-cosmos-db---a-recap"></a><span data-ttu-id="9d152-110">Récapitulatif de la haute disponibilité avec Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="9d152-110">High availability with Cosmos DB - a recap</span></span>
<span data-ttu-id="9d152-111">COSMOS DB est conçue toobe [distribués internationalement](distribute-data-globally.md) : elle vous permet de tooscale débit dans plusieurs régions Azure, ainsi que la stratégie de basculement et son API multihébergement transparent.</span><span class="sxs-lookup"><span data-stu-id="9d152-111">Cosmos DB is designed toobe [globally distributed](distribute-data-globally.md) – it allows you tooscale throughput across multiple Azure regions along with policy driven failover and transparent multi-homing APIs.</span></span> <span data-ttu-id="9d152-112">En tant qu’une offre de système de base de données [disponibilité de 99,99 % SLA](https://azure.microsoft.com/support/legal/sla/cosmos-db), toutes les écritures hello dans Cosmos DB sont des disques toolocal durablement validée par un quorum de réplicas au sein d’un centre de données local avant d’accuser réception toohello client.</span><span class="sxs-lookup"><span data-stu-id="9d152-112">As a database system offering [99.99% availability SLAs](https://azure.microsoft.com/support/legal/sla/cosmos-db), all hello writes in Cosmos DB are durably committed toolocal disks by a quorum of replicas within a local data center before acknowledging toohello client.</span></span> <span data-ttu-id="9d152-113">Notez que hello haute disponibilité de base de données Cosmos s’appuie sur le stockage local et ne dépend pas de toutes les technologies de stockage externe.</span><span class="sxs-lookup"><span data-stu-id="9d152-113">Note that hello high availability of Cosmos DB relies on local storage and does not depend on any external storage technologies.</span></span> <span data-ttu-id="9d152-114">En outre, si votre compte de base de données est associé à plusieurs régions Azure, vos écritures sont également répliquées entre les autres régions.</span><span class="sxs-lookup"><span data-stu-id="9d152-114">Additionally, if your database account is associated with more than one Azure region, your writes are replicated across other regions as well.</span></span> <span data-ttu-id="9d152-115">tooscale vos données de débit et l’accès à faible latence, vous pouvez avoir plusieurs lire régions associées à votre compte de base de données que vous le souhaitez.</span><span class="sxs-lookup"><span data-stu-id="9d152-115">tooscale your throughput and access data at low latencies, you can have as many read regions associated with your database account as you like.</span></span> <span data-ttu-id="9d152-116">Dans chaque région de lecture, les données de salutation (répliquée) sont rendue persistante durablement sur un jeu de réplicas.</span><span class="sxs-lookup"><span data-stu-id="9d152-116">In each read region, hello (replicated) data is durably persisted across a replica set.</span></span>  

<span data-ttu-id="9d152-117">Comme illustré dans hello suivant schéma, un seul conteneur de base de données Cosmos est [partitionnées horizontalement](partition-data.md).</span><span class="sxs-lookup"><span data-stu-id="9d152-117">As illustrated in hello following diagram, a single Cosmos DB container is [horizontally partitioned](partition-data.md).</span></span> <span data-ttu-id="9d152-118">Une « partition » est indiquée par un cercle Bonjour suivant schéma, et chaque partition devient hautement disponible via un jeu de réplicas.</span><span class="sxs-lookup"><span data-stu-id="9d152-118">A “partition” is denoted by a circle in hello following diagram, and each partition is made highly available via a replica set.</span></span> <span data-ttu-id="9d152-119">Il s’agit de distribution local hello au sein d’une seule région Azure (signalée par l’axe des X hello).</span><span class="sxs-lookup"><span data-stu-id="9d152-119">This is hello local distribution within a single Azure region (denoted by hello X axis).</span></span> <span data-ttu-id="9d152-120">En outre, chaque partition (avec son jeu de réplica correspondant) est ensuite globalement distribuée dans plusieurs régions associées à votre compte de base de données (par exemple, dans cette illustration hello trois régions : États-Unis, ouest des États-Unis et en Inde centrale).</span><span class="sxs-lookup"><span data-stu-id="9d152-120">Further, each partition (with its corresponding replica set) is then globally distributed across multiple regions associated with your database account (for example, in this illustration hello three regions – East US, West US and Central India).</span></span> <span data-ttu-id="9d152-121">Hello « plage de partition » est distribués internationalement entité comprenant plusieurs copies de vos données dans chaque région (signalée par l’axe des Y de hello).</span><span class="sxs-lookup"><span data-stu-id="9d152-121">hello “partition set” is a globally distributed entity comprising of multiple copies of your data in each region (denoted by hello Y axis).</span></span> <span data-ttu-id="9d152-122">Vous pouvez affecter de priorité de régions toohello associées à votre compte de base de données et base de données Cosmos va en toute transparence basculement toohello la zone suivante en cas d’incident.</span><span class="sxs-lookup"><span data-stu-id="9d152-122">You can assign priority toohello regions associated with your database account and Cosmos DB will transparently failover toohello next region in case of disaster.</span></span> <span data-ttu-id="9d152-123">Vous pouvez aussi simuler de basculement tootest hello bout en bout pour la disponibilité de votre application.</span><span class="sxs-lookup"><span data-stu-id="9d152-123">You can also manually simulate failover tootest hello end-to-end availability of your application.</span></span>  

<span data-ttu-id="9d152-124">Hello image suivante illustre la grande redondance avec Cosmos DB hello.</span><span class="sxs-lookup"><span data-stu-id="9d152-124">hello following image illustrates hello high degree of redundancy with Cosmos DB.</span></span>

![Degré élevé de redondance avec Cosmos DB](./media/online-backup-and-restore/redundancy.png)

![Degré élevé de redondance avec Cosmos DB](./media/online-backup-and-restore/global-distribution.png)

## <a name="full-automatic-online-backups"></a><span data-ttu-id="9d152-127">Sauvegardes complètes, automatiques, en ligne</span><span class="sxs-lookup"><span data-stu-id="9d152-127">Full, automatic, online backups</span></span>
<span data-ttu-id="9d152-128">Oups, j’ai supprimé mon conteneur ou ma base de données !</span><span class="sxs-lookup"><span data-stu-id="9d152-128">Oops, I deleted my container or database!</span></span> <span data-ttu-id="9d152-129">Avec la base de données Cosmos, non seulement vos données, mais les sauvegardes hello de vos données sont également créées les sinistres tooregional hautement résilientes et redondants.</span><span class="sxs-lookup"><span data-stu-id="9d152-129">With Cosmos DB, not only your data, but hello backups of your data are also made highly redundant and resilient tooregional disasters.</span></span> <span data-ttu-id="9d152-130">Actuellement, ces sauvegardes automatisées sont effectuées environ toutes les quatre heures et les deux sauvegardes les plus récentes sont stockées en permanence.</span><span class="sxs-lookup"><span data-stu-id="9d152-130">These automated backups are currently taken approximately every four hours and latest 2 backups are stored at all times.</span></span> <span data-ttu-id="9d152-131">Si les données de salutation sont accidentellement supprimé ou endommagé, veuillez [contactez le support Azure](https://azure.microsoft.com/support/options/) dans les 8 heures.</span><span class="sxs-lookup"><span data-stu-id="9d152-131">If hello data is accidently dropped or corrupted, please [contact Azure support](https://azure.microsoft.com/support/options/) within 8 hours.</span></span> 

<span data-ttu-id="9d152-132">sauvegardes de Hello sont effectuées sans affecter les performances de hello ou la disponibilité de vos opérations de base de données.</span><span class="sxs-lookup"><span data-stu-id="9d152-132">hello backups are taken without affecting hello performance or availability of your database operations.</span></span> <span data-ttu-id="9d152-133">COSMOS DB accepte les sauvegarde hello en arrière-plan de hello sans consommer votre RUs approvisionnés ou affecter les performances de hello et sans affecter la disponibilité de hello de votre base de données.</span><span class="sxs-lookup"><span data-stu-id="9d152-133">Cosmos DB takes hello backup in hello background without consuming your provisioned RUs or affecting hello performance and without affecting hello availability of your database.</span></span> 

<span data-ttu-id="9d152-134">Contrairement à vos données sont stockées dans la base de données Cosmos, les sauvegardes automatiques hello sont stockés dans le service de stockage d’objets Blob Azure.</span><span class="sxs-lookup"><span data-stu-id="9d152-134">Unlike your data that is stored inside Cosmos DB, hello automatic backups are stored in Azure Blob Storage service.</span></span> <span data-ttu-id="9d152-135">téléchargement de faible latence/efficace hello tooguarantee, instantané hello de votre sauvegarde est instance tooan téléchargé de stockage d’objets Blob Azure dans hello même région que hello écriture région actuelle de votre compte de base de données de base de données Cosmos.</span><span class="sxs-lookup"><span data-stu-id="9d152-135">tooguarantee hello low latency/efficient upload, hello snapshot of your backup is uploaded tooan instance of Azure Blob storage in hello same region as hello current write region of your Cosmos DB database account.</span></span> <span data-ttu-id="9d152-136">Pour assurer la résilience contre les sinistres régionaux, chaque instantané de vos données de sauvegarde dans le stockage d’objets Blob Azure à nouveau répliquée à l’aide la région tooanother stockage géo-redondant (GRS).</span><span class="sxs-lookup"><span data-stu-id="9d152-136">For resiliency against regional disaster, each snapshot of your backup data in Azure Blob Storage is again replicated via geo-redundant storage (GRS) tooanother region.</span></span> <span data-ttu-id="9d152-137">Hello diagramme suivant montre que hello entière Cosmos DB conteneur (avec toutes les trois partitions principales dans l’ouest des États-Unis, dans cet exemple) est sauvegardé dans un compte de stockage d’objets Blob Azure à distance ouest des États-Unis et ensuite GRS répliquées tooEast US.</span><span class="sxs-lookup"><span data-stu-id="9d152-137">hello following diagram shows that hello entire Cosmos DB container (with all three primary partitions in West US, in this example) is backed up in a remote Azure Blob Storage account in West US and then GRS replicated tooEast US.</span></span> 

<span data-ttu-id="9d152-138">Hello image suivante illustre les sauvegardes complètes périodiques de toutes les entités de base de données Cosmos dans le stockage Azure GRS.</span><span class="sxs-lookup"><span data-stu-id="9d152-138">hello following image illustrates periodic full backups of all Cosmos DB entities in GRS Azure Storage.</span></span>

![Sauvegardes complètes périodiques de toutes les entités Cosmos DB dans Stockage Azure GRS](./media/online-backup-and-restore/automatic-backup.png)

## <a name="backup-retention-period"></a><span data-ttu-id="9d152-140">Période de rétention des sauvegardes</span><span class="sxs-lookup"><span data-stu-id="9d152-140">Backup retention period</span></span>
<span data-ttu-id="9d152-141">Comme décrit ci-dessus, base de données Azure Cosmos prendre des instantanés de vos données toutes les quatre heures et conserve les instantanés de deux derniers hello de chaque partition pendant 30 jours.</span><span class="sxs-lookup"><span data-stu-id="9d152-141">As described above, Azure Cosmos DB takes snapshots of your data every four hours and retains hello last two snapshots of every partition for 30 days.</span></span> <span data-ttu-id="9d152-142">Conformément à nos obligations réglementaires, les instantanés sont supprimés au bout de 90 jours.</span><span class="sxs-lookup"><span data-stu-id="9d152-142">Per our compliance regulations, snapshots are purged after 90 days.</span></span>

<span data-ttu-id="9d152-143">Si vous souhaitez toomaintain vos propres instantanés, vous pouvez utiliser tooJSON l’option d’exportation hello Bonjour Azure Cosmos DB [l’outil de Migration de données](import-data.md#export-to-json-file) tooschedule des sauvegardes supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="9d152-143">If you want toomaintain your own snapshots, you can use hello export tooJSON option in hello Azure Cosmos DB [Data Migration tool](import-data.md#export-to-json-file) tooschedule additional backups.</span></span> 

## <a name="restoring-a-database-from-an-online-backup"></a><span data-ttu-id="9d152-144">Restauration d’une base de données depuis une sauvegarde en ligne</span><span class="sxs-lookup"><span data-stu-id="9d152-144">Restoring a database from an online backup</span></span>
<span data-ttu-id="9d152-145">Si vous supprimez accidentellement votre base de données ou de la collection, vous pouvez [un ticket de support de fichiers](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade) ou [le support technique Azure](https://azure.microsoft.com/support/options/) toorestore les données de salutation à partir de la dernière sauvegarde d’automatique hello.</span><span class="sxs-lookup"><span data-stu-id="9d152-145">If you accidentally delete your database or collection, you can [file a support ticket](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade) or [call Azure support](https://azure.microsoft.com/support/options/) toorestore hello data from hello last automatic backup.</span></span> <span data-ttu-id="9d152-146">Si vous devez toorestore votre base de données en raison du problème d’altération des données, consultez [la gestion des données endommagées](#handling-data-corruption) dont vous avez besoin tootake supplémentaire étapes tooprevent hello endommagé données à partir de sauvegardes de hello pénétrer.</span><span class="sxs-lookup"><span data-stu-id="9d152-146">If you need toorestore your database because of data corruption issue, see [Handling data corruption](#handling-data-corruption) as you need tootake additional steps tooprevent hello corrupted data from penetrating hello backups.</span></span> <span data-ttu-id="9d152-147">Pour obtenir un instantané spécifique de votre toobe sauvegarde restaurée, Cosmos DB requiert que les données de salutation n’étaient disponibles pour la durée du cycle de sauvegarde hello pour cet instantané hello.</span><span class="sxs-lookup"><span data-stu-id="9d152-147">For a specific snapshot of your backup toobe restored, Cosmos DB requires that hello data was available for hello duration of hello backup cycle for that snapshot.</span></span>

## <a name="handling-data-corruption"></a><span data-ttu-id="9d152-148">Gestion de l’altération des données</span><span class="sxs-lookup"><span data-stu-id="9d152-148">Handling data corruption</span></span>
<span data-ttu-id="9d152-149">Azure Cosmos DB conserve les sauvegardes de deux derniers hello de chaque partition dans le système de hello.</span><span class="sxs-lookup"><span data-stu-id="9d152-149">Azure Cosmos DB retains hello last two backups of every partition in hello system.</span></span> <span data-ttu-id="9d152-150">Ce modèle fonctionne très bien quand un conteneur (collection de documents, graphique, table) ou une base de données est accidentellement supprimé, car une des dernières versions de hello peut être restaurée.</span><span class="sxs-lookup"><span data-stu-id="9d152-150">This model works very well when a container (collection of documents, graph, table) or a database is accidentally deleted since one of hello last versions can be restored.</span></span> <span data-ttu-id="9d152-151">Toutefois, dans hello cas lorsque lorsque les utilisateurs peuvent présenter un problème d’altération des données, base de données Azure Cosmos peuvent ne pas savoir hello d’altération des données, et il est possible que hello altération peuvent ont été les sauvegardes hello.</span><span class="sxs-lookup"><span data-stu-id="9d152-151">However, in hello case when when users may introduce a data corruption issue, Azure Cosmos DB may be unaware of hello data corruption, and it is possible that hello corruption may have penetrated hello backups.</span></span> <span data-ttu-id="9d152-152">Dès qu’il est endommagé, vous devez supprimer le conteneur hello endommagé (collection/graphique/table) afin que les sauvegardes sont protégés contre l’écrasement des données corrompues.</span><span class="sxs-lookup"><span data-stu-id="9d152-152">As soon as corruption is detected, you should delete hello corrupted container (collection/graph/table) so that backups are protected from being overwritten with corrupted data.</span></span> <span data-ttu-id="9d152-153">Depuis la dernière sauvegarde de hello peut être de quatre heures, l’utilisateur de hello peut employer [modifier le flux](change-feed.md) toocapture et magasin hello dernière quatre heures de données avant de supprimer le conteneur de hello.</span><span class="sxs-lookup"><span data-stu-id="9d152-153">Since hello last backup could be four hours old, hello user can employ [change feed](change-feed.md) toocapture and store hello last four hours worth of data before deleting hello container.</span></span>

## <a name="next-steps"></a><span data-ttu-id="9d152-154">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="9d152-154">Next steps</span></span>

<span data-ttu-id="9d152-155">reportez-vous à votre base de données dans plusieurs centres de données, tooreplicate [distribuer vos données globalement avec Cosmos DB](distribute-data-globally.md).</span><span class="sxs-lookup"><span data-stu-id="9d152-155">tooreplicate your database in multiple data centers, see [distribute your data globally with Cosmos DB](distribute-data-globally.md).</span></span> 

<span data-ttu-id="9d152-156">toofile contact prise en charge d’Azure, [soumettent un ticket de hello Azure portal](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade).</span><span class="sxs-lookup"><span data-stu-id="9d152-156">toofile contact Azure Support, [file a ticket from hello Azure portal](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade).</span></span>

