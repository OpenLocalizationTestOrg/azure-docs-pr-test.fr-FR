---
title: "Collecter les journaux personnalisés dans OMS Log Analytics | Microsoft Docs"
description: "Log Analytics peut collecter des événements dans des fichiers texte sur des ordinateurs Windows et Linux.  Cet article décrit comment définir un nouveau journal personnalisé et les détails des enregistrements qu’il crée dans le référentiel OMS."
services: log-analytics
documentationcenter: 
author: bwren
manager: jwhit
editor: tysonn
ms.assetid: aca7f6bb-6f53-4fd4-a45c-93f12ead4ae1
ms.service: log-analytics
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 08/15/2017
ms.author: bwren
ms.openlocfilehash: b7f28868e3ffdf95dbe39872f382e7c97eae692c
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/18/2017
---
# <a name="custom-logs-in-log-analytics"></a><span data-ttu-id="6d2ab-104">Journaux personnalisés dans Log Analytics</span><span class="sxs-lookup"><span data-stu-id="6d2ab-104">Custom logs in Log Analytics</span></span>
<span data-ttu-id="6d2ab-105">La source de données Journaux personnalisés de Log Analytics vous permet de collecter des événements stockés dans des fichiers texte sur les ordinateurs Windows et Linux.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-105">The Custom Logs data source in Log Analytics allows you to collect events from text files on both Windows and Linux computers.</span></span> <span data-ttu-id="6d2ab-106">De nombreuses applications consignent des informations dans des fichiers texte au lieu des services de journalisation standard tels que le Journal des événements Windows ou Syslog.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-106">Many applications log information to text files instead of standard logging services such as Windows Event log or Syslog.</span></span>  <span data-ttu-id="6d2ab-107">Une fois collectés, vous pouvez analyser chaque enregistrement du journal dans des champs individuels à l’aide de la fonctionnalité [Champs Personnalisés](log-analytics-custom-fields.md) de Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-107">Once collected, you can parse each record in the log in to individual fields using the [Custom Fields](log-analytics-custom-fields.md) feature of Log Analytics.</span></span>

![Collecte de journaux personnalisés](media/log-analytics-data-sources-custom-logs/overview.png)

<span data-ttu-id="6d2ab-109">Les fichiers journaux à collecter doivent correspondre aux critères suivants.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-109">The log files to be collected must match the following criteria.</span></span>

- <span data-ttu-id="6d2ab-110">Le journal doit comporter une seule entrée par ligne ou utiliser un horodatage correspondant à l’un des formats suivants au début de chaque entrée.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-110">The log must either have a single entry per line or use a timestamp matching one of the following formats at the start of each entry.</span></span>

    <span data-ttu-id="6d2ab-111">AAAA-MM-JJ HH:MM:SS </span><span class="sxs-lookup"><span data-stu-id="6d2ab-111">YYYY-MM-DD HH:MM:SS</span></span><br><span data-ttu-id="6d2ab-112">M/J/AAAA HH:MM:SS AM/PM</span><span class="sxs-lookup"><span data-stu-id="6d2ab-112">M/D/YYYY HH:MM:SS AM/PM</span></span> <br><span data-ttu-id="6d2ab-113">Mois JJ,AAAA HH:MM:SS</span><span class="sxs-lookup"><span data-stu-id="6d2ab-113">Mon DD,YYYY HH:MM:SS</span></span>

- <span data-ttu-id="6d2ab-114">Le fichier journal ne doit pas autoriser les mises à jour circulaires, où de nouvelles entrées sont consignées.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-114">The log file must not allow circular updates where the file is overwritten with new entries.</span></span>
- <span data-ttu-id="6d2ab-115">Le fichier journal doit utiliser l’encodage ASCII ou UTF-8.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-115">The log file must use ASCII or UTF-8 encoding.</span></span>  <span data-ttu-id="6d2ab-116">Les autres formats, par exemple UTF-16, ne sont pas pris en charge.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-116">Other formats such as UTF-16 are not supported.</span></span>

>[!NOTE]
><span data-ttu-id="6d2ab-117">Si le fichier journal contient des entrées dupliquées, Log Analytics les collecte.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-117">If there are duplicate entries in the log file, Log Analytics will collect them.</span></span>  <span data-ttu-id="6d2ab-118">Toutefois, les résultats de la recherche seront incohérents dans les cas où les résultats du filtre affichent un nombre d’événements supérieur au nombre de résultats.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-118">However, the search results will be inconsistent where the filter results show more events than the result count.</span></span>  <span data-ttu-id="6d2ab-119">Il est important de valider le journal pour déterminer si l’application qui le crée cause ce comportement et résoudre, si possible, le problème avant la création de la définition de collection de journal personnalisée.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-119">It will be important that you validate the log to determine if the application that creates it is causing this behavior and address it if possible before creating the custom log collection definition.</span></span>  
>
  
## <a name="defining-a-custom-log"></a><span data-ttu-id="6d2ab-120">Définition d’un journal personnalisé</span><span class="sxs-lookup"><span data-stu-id="6d2ab-120">Defining a custom log</span></span>
<span data-ttu-id="6d2ab-121">Utilisez la procédure suivante pour définir un fichier journal personnalisé.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-121">Use the following procedure to define a custom log file.</span></span>  <span data-ttu-id="6d2ab-122">Rendez-vous à la fin de cet article pour une procédure détaillée d’ajout d’un journal personnalisé.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-122">Scroll to the end of this article for a walkthrough of a sample of adding a custom log.</span></span>

### <a name="step-1-open-the-custom-log-wizard"></a><span data-ttu-id="6d2ab-123">Étape 1.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-123">Step 1.</span></span> <span data-ttu-id="6d2ab-124">Ouvrir l’Assistant Journal personnalisé</span><span class="sxs-lookup"><span data-stu-id="6d2ab-124">Open the Custom Log Wizard</span></span>
<span data-ttu-id="6d2ab-125">L’Assistant Journal personnalisé s’exécute dans le portail OMS et vous permet de définir un nouveau journal personnalisé de collecte.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-125">The Custom Log Wizard runs in the OMS portal and allows you to define a new custom log to collect.</span></span>

1. <span data-ttu-id="6d2ab-126">Dans le portail OMS, accédez à **Paramètres**.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-126">In the OMS portal, go to **Settings**.</span></span>
2. <span data-ttu-id="6d2ab-127">Cliquez sur **Données** puis sur **Journaux personnalisés**.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-127">Click on **Data** and then **Custom logs**.</span></span>
3. <span data-ttu-id="6d2ab-128">Par défaut, toutes les modifications de configuration sont automatiquement transmises à l’ensemble des agents.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-128">By default, all configuration changes are automatically pushed to all agents.</span></span>  <span data-ttu-id="6d2ab-129">Pour les agents Linux, un fichier de configuration est envoyé au collecteur de données Fluentd.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-129">For Linux agents, a configuration file is sent to the Fluentd data collector.</span></span>  <span data-ttu-id="6d2ab-130">Si vous souhaitez modifier ce fichier manuellement sur chaque agent Linux, décochez la case *Appliquer la configuration ci-dessous à mes machines Linux*.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-130">If you wish to modify this file manually on each Linux agent, then uncheck the box *Apply below configuration to my Linux machines*.</span></span>
4. <span data-ttu-id="6d2ab-131">Cliquez sur **Ajouter+** pour ouvrir l’Assistant Journal personnalisé.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-131">Click **Add+** to open the Custom Log Wizard.</span></span>

### <a name="step-2-upload-and-parse-a-sample-log"></a><span data-ttu-id="6d2ab-132">Étape 2.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-132">Step 2.</span></span> <span data-ttu-id="6d2ab-133">Télécharger et analyser un exemple de journal</span><span class="sxs-lookup"><span data-stu-id="6d2ab-133">Upload and parse a sample log</span></span>
<span data-ttu-id="6d2ab-134">Commencez par télécharger un exemple du journal personnalisé.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-134">You start by uploading a sample of the custom log.</span></span>  <span data-ttu-id="6d2ab-135">L’assistant analyse et affiche les entrées de ce fichier afin que vous les validiez.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-135">The wizard will parse and display the entries in this file for you to validate.</span></span>  <span data-ttu-id="6d2ab-136">Log Analytics utilise le délimiteur que vous spécifiez pour identifier chaque enregistrement.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-136">Log Analytics will use the delimiter that you specify to identify each record.</span></span>

<span data-ttu-id="6d2ab-137">**Nouvelle ligne** .</span><span class="sxs-lookup"><span data-stu-id="6d2ab-137">**New Line** is the default delimiter and is used for log files that have a single entry per line.</span></span>  <span data-ttu-id="6d2ab-138">Si la ligne commence par un horodatage dans un des formats disponibles, vous pouvez spécifier un délimiteur **Horodatage** prenant en charge les entrées qui s’étendent sur plusieurs lignes.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-138">If the line starts with a date and time in one of the available formats, then you can specify a **Timestamp** delimiter which supports entries that span more than one line.</span></span>

<span data-ttu-id="6d2ab-139">Si un délimiteur Horodatage est utilisé, la propriété TimeGenerated de chaque enregistrement stocké dans OMS contiendra la date et l’heure spécifiées pour cette entrée dans le fichier journal.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-139">If a timestamp delimiter is used, then the TimeGenerated property of each record stored in OMS will be populated with the date/time specified for that entry in the log file.</span></span>  <span data-ttu-id="6d2ab-140">Si un délimiteur Nouvelle ligne est utilisé, la propriété TimeGenerated est renseignée avec la date et l’heure auxquelles Log Analytics a collecté l’entrée.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-140">If a new line delimiter is used, then TimeGenerated is populated with date and time that Log Analytics collected the entry.</span></span>

> [!NOTE]
> <span data-ttu-id="6d2ab-141">Pour l’instant, Log Analytics traite la date et l’heure collectées dans un journal à l’aide d’un délimiteur Horodatage UTC.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-141">Log Analytics currently treats the date/time collected from a log using a timestamp delimiter as UTC.</span></span>  <span data-ttu-id="6d2ab-142">Très bientôt, c’est le fuseau horaire qui sera utilisé sur l’agent.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-142">This will soon be changed to use the time zone on the agent.</span></span>
>
>

1. <span data-ttu-id="6d2ab-143">Cliquez sur **Parcourir** et accédez à un exemple de fichier.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-143">Click **Browse** and browse to a sample file.</span></span>  <span data-ttu-id="6d2ab-144">Notez que ce bouton peut s’appeler **Choisir un fichier** dans certains navigateurs.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-144">Note that this may button may be labeled **Choose File** in some browsers.</span></span>
2. <span data-ttu-id="6d2ab-145">Cliquez sur **Suivant**.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-145">Click **Next**.</span></span>
3. <span data-ttu-id="6d2ab-146">L’Assistant Journal personnalisé télécharge le fichier et répertorie les enregistrements qu’il identifie.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-146">The Custom Log Wizard will upload the file and list the records that it identifies.</span></span>
4. <span data-ttu-id="6d2ab-147">Remplacez le délimiteur utilisé pour identifier un nouvel enregistrement par celui qui identifie au mieux les enregistrements de votre fichier journal.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-147">Change the delimiter that is used to identify a new record and select the delimiter that best identifies the records in your log file.</span></span>
5. <span data-ttu-id="6d2ab-148">Cliquez sur **Suivant**.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-148">Click **Next**.</span></span>

### <a name="step-3-add-log-collection-paths"></a><span data-ttu-id="6d2ab-149">Étape 3.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-149">Step 3.</span></span> <span data-ttu-id="6d2ab-150">Ajouter des chemins de collecte de journaux</span><span class="sxs-lookup"><span data-stu-id="6d2ab-150">Add log collection paths</span></span>
<span data-ttu-id="6d2ab-151">Vous devez définir un ou plusieurs chemins indiquant à l’agent où trouver le journal personnalisé.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-151">You must define one or more paths on the agent where it can locate the custom log.</span></span>  <span data-ttu-id="6d2ab-152">Vous pouvez soit fournir le chemin d’accès et le nom du fichier journal, soit indiquer un chemin d’accès avec un caractère générique pour le nom.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-152">You can either provide a specific path and name for the log file, or you can specify a path with a wildcard for the name.</span></span>  <span data-ttu-id="6d2ab-153">Ce mécanisme prend en charge les applications qui créent un fichier par jour ou lorsqu’un fichier atteint une certaine taille.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-153">This supports applications that create a new file each day or when one file reaches a certain size.</span></span>  <span data-ttu-id="6d2ab-154">Vous pouvez également fournir plusieurs chemins d’accès pour un fichier journal.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-154">You can also provide multiple paths for a single log file.</span></span>

<span data-ttu-id="6d2ab-155">Par exemple, une application peut créer un fichier journal chaque jour avec la date dans le nom, comme dans log20100316.txt.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-155">For example, an application might create a log file each day with the date included in the name as in log20100316.txt.</span></span> <span data-ttu-id="6d2ab-156">Par exemple, ce modèle peut être *log\*.txt* et s’appliquer à un fichier journal conforme à la convention de dénomination de l’application.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-156">A pattern for such a log might be *log\*.txt* which would apply to any log file following the application’s naming scheme.</span></span>

<span data-ttu-id="6d2ab-157">Le tableau suivant fournit des exemples de modèles valides pour différents fichiers journaux.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-157">The following table provides examples of valid patterns to specify different log files.</span></span>

| <span data-ttu-id="6d2ab-158">Description</span><span class="sxs-lookup"><span data-stu-id="6d2ab-158">Description</span></span> | <span data-ttu-id="6d2ab-159">Chemin</span><span class="sxs-lookup"><span data-stu-id="6d2ab-159">Path</span></span> |
|:--- |:--- |
| <span data-ttu-id="6d2ab-160">Tous les fichiers sous *C:\Logs* avec l’extension .txt sur l’agent Windows</span><span class="sxs-lookup"><span data-stu-id="6d2ab-160">All files in *C:\Logs* with .txt extension on Windows agent</span></span> |<span data-ttu-id="6d2ab-161">C:\Logs\\\*.txt</span><span class="sxs-lookup"><span data-stu-id="6d2ab-161">C:\Logs\\\*.txt</span></span> |
| <span data-ttu-id="6d2ab-162">Tous les fichiers sous *C:\Logs* avec un nom commençant par log et portant l’extension .txt sur l’agent Windows</span><span class="sxs-lookup"><span data-stu-id="6d2ab-162">All files in *C:\Logs* with a name starting with log and a .txt extension on Windows agent</span></span> |<span data-ttu-id="6d2ab-163">C:\Logs\log\*.txt</span><span class="sxs-lookup"><span data-stu-id="6d2ab-163">C:\Logs\log\*.txt</span></span> |
| <span data-ttu-id="6d2ab-164">Tous les fichiers sous */var/log/audit* avec l’extension .txt sur l’agent Linux</span><span class="sxs-lookup"><span data-stu-id="6d2ab-164">All files in */var/log/audit* with .txt extension on Linux agent</span></span> |<span data-ttu-id="6d2ab-165">/var/log/audit/*.txt</span><span class="sxs-lookup"><span data-stu-id="6d2ab-165">/var/log/audit/*.txt</span></span> |
| <span data-ttu-id="6d2ab-166">Tous les fichiers sous */var/log/audit* avec un nom commençant par log et portant l’extension .txt sur l’agent Linux</span><span class="sxs-lookup"><span data-stu-id="6d2ab-166">All files in */var/log/audit* with a name starting with log and a .txt extension on Linux agent</span></span> |<span data-ttu-id="6d2ab-167">/var/log/audit/log\*.txt</span><span class="sxs-lookup"><span data-stu-id="6d2ab-167">/var/log/audit/log\*.txt</span></span> |

1. <span data-ttu-id="6d2ab-168">Sélectionnez Windows ou Linux pour spécifier le format du chemin d’accès que vous ajoutez.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-168">Select Windows or Linux to specify which path format you are adding.</span></span>
2. <span data-ttu-id="6d2ab-169">Tapez le chemin d’accès et cliquez sur le bouton **+** .</span><span class="sxs-lookup"><span data-stu-id="6d2ab-169">Type in the path and click the **+** button.</span></span>
3. <span data-ttu-id="6d2ab-170">Répétez la procédure pour les chemins d’accès supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-170">Repeat the process for any additional paths.</span></span>

### <a name="step-4-provide-a-name-and-description-for-the-log"></a><span data-ttu-id="6d2ab-171">Étape 4.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-171">Step 4.</span></span> <span data-ttu-id="6d2ab-172">Indiquer le nom et la description du journal</span><span class="sxs-lookup"><span data-stu-id="6d2ab-172">Provide a name and description for the log</span></span>
<span data-ttu-id="6d2ab-173">Le nom que vous spécifiez sera utilisé pour le type de journal, comme indiqué ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-173">The name that you specify will be used for the log type as described above.</span></span>  <span data-ttu-id="6d2ab-174">Il se termine toujours par _CL pour le distinguer d’un journal personnalisé.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-174">It will always end with _CL to distinguish it as a custom log.</span></span>

1. <span data-ttu-id="6d2ab-175">Indiquez le nom du journal.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-175">Type in a name for the log.</span></span>  <span data-ttu-id="6d2ab-176">Le suffixe **\_CL** est ajouté automatiquement.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-176">The **\_CL** suffix is automatically provided.</span></span>
2. <span data-ttu-id="6d2ab-177">Si vous le souhaitez, renseignez le champ **Description**.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-177">Add an optional **Description**.</span></span>
3. <span data-ttu-id="6d2ab-178">Cliquez sur **Suivant** pour enregistrer la définition du journal personnalisé.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-178">Click **Next** to save the custom log definition.</span></span>

### <a name="step-5-validate-that-the-custom-logs-are-being-collected"></a><span data-ttu-id="6d2ab-179">Étape 5.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-179">Step 5.</span></span> <span data-ttu-id="6d2ab-180">Vérifier que les journaux personnalisés sont collectés</span><span class="sxs-lookup"><span data-stu-id="6d2ab-180">Validate that the custom logs are being collected</span></span>
<span data-ttu-id="6d2ab-181">Il faut parfois une heure pour que les données initiales d’un nouveau journal personnalisé apparaissent dans Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-181">It may take up to an hour for the initial data from a new custom log to appear in Log Analytics.</span></span>  <span data-ttu-id="6d2ab-182">La collecte des entrées commence par les journaux situés à l’emplacement spécifié, à partir du moment où vous avez défini le journal personnalisé.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-182">It will start collecting entries from the logs found in the path you specified from the point that you defined the custom log.</span></span>  <span data-ttu-id="6d2ab-183">Log Analytics ne conserve pas les entrées que vous avez téléchargées lors de la création du journal personnalisé, mais celles figurant dans les fichiers journaux qu’il trouve.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-183">It will not retain the entries that you uploaded during the custom log creation, but it will collect already existing entries in the log files that it locates.</span></span>

<span data-ttu-id="6d2ab-184">Lorsque Log Analytics commence la collecte du journal personnalisé, ses enregistrements sont accessibles en effectuant une recherche de journal.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-184">Once Log Analytics starts collecting from the custom log, its records will be available with a Log Search.</span></span>  <span data-ttu-id="6d2ab-185">Utilisez le nom que vous avez donné au journal personnalisé, comme le **Type** dans votre requête.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-185">Use the name that you gave the custom log as the **Type** in your query.</span></span>

> [!NOTE]
> <span data-ttu-id="6d2ab-186">Si la propriété RawData est manquante dans la recherche, vous devrez peut-être fermer et rouvrir votre navigateur.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-186">If the RawData property is missing from the search, you may need to close and reopen your browser.</span></span>
>
>

### <a name="step-6-parse-the-custom-log-entries"></a><span data-ttu-id="6d2ab-187">Étape 6.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-187">Step 6.</span></span> <span data-ttu-id="6d2ab-188">Analyser les entrées du journal personnalisé</span><span class="sxs-lookup"><span data-stu-id="6d2ab-188">Parse the custom log entries</span></span>
<span data-ttu-id="6d2ab-189">L’entrée de journal est stockée dans une propriété unique appelée **RawData**.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-189">The entire log entry will be stored in a single property called **RawData**.</span></span>  <span data-ttu-id="6d2ab-190">Vous souhaiterez certainement séparer les différents éléments d’information de chaque entrée dans des propriétés séparées dans l’enregistrement.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-190">You will most likely want to separate the different pieces of information in each entry into individual properties stored in the record.</span></span>  <span data-ttu-id="6d2ab-191">Pour ce faire, utilisez la fonction [Champs personnalisés](log-analytics-custom-fields.md) de Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-191">You do this using the [Custom Fields](log-analytics-custom-fields.md) feature of Log Analytics.</span></span>

<span data-ttu-id="6d2ab-192">La procédure détaillée pour analyser l’entrée de journal personnalisé n’est pas décrite ici.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-192">Detailed steps for parsing the custom log entry are not provided here.</span></span>  <span data-ttu-id="6d2ab-193">Pour plus d’informations sur cette procédure, consultez la documentation sur [Champs personnalisés](log-analytics-custom-fields.md) .</span><span class="sxs-lookup"><span data-stu-id="6d2ab-193">Please refer to the [Custom Fields](log-analytics-custom-fields.md) documentation for this information.</span></span>

## <a name="disabling-a-custom-log"></a><span data-ttu-id="6d2ab-194">Désactivation d’un journal personnalisé</span><span class="sxs-lookup"><span data-stu-id="6d2ab-194">Disabling a custom log</span></span>
<span data-ttu-id="6d2ab-195">Vous ne pouvez pas supprimer une définition de journal personnalisé une fois qu’elle a été créée, mais vous pouvez la désactiver en supprimant tous ses chemins de regroupement.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-195">You cannot remove a custom log definition once it's been created, but you can disable it by removing all of its collection paths.</span></span>

1. <span data-ttu-id="6d2ab-196">Dans le portail OMS, accédez à **Paramètres**.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-196">In the OMS portal, go to **Settings**.</span></span>
2. <span data-ttu-id="6d2ab-197">Cliquez sur **Données** puis sur **Journaux personnalisés**.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-197">Click on **Data** and then **Custom logs**.</span></span>
3. <span data-ttu-id="6d2ab-198">Cliquez sur **Détails** en regard de la définition de journal personnalisé à désactiver.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-198">Click **Details** next to the custom log definition to disable.</span></span>
4. <span data-ttu-id="6d2ab-199">Supprimez tous les chemins de regroupement pour la définition de journal personnalisé.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-199">Remove each of the collection paths for the custom log definition.</span></span>

## <a name="data-collection"></a><span data-ttu-id="6d2ab-200">Collecte des données</span><span class="sxs-lookup"><span data-stu-id="6d2ab-200">Data collection</span></span>
<span data-ttu-id="6d2ab-201">Log Analytics collecte les nouvelles entrées de chaque journal personnalisé toutes les 5 minutes environ.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-201">Log Analytics will collect new entries from each custom log approximately every 5 minutes.</span></span>  <span data-ttu-id="6d2ab-202">L’agent enregistre sa place dans chaque fichier journal dont il la collecte.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-202">The agent will record its place in each log file that it collects from.</span></span>  <span data-ttu-id="6d2ab-203">Si l’agent est hors connexion pendant un moment, Log Analytics collecte les entrées à partir de là où il s’était arrêté, même si ces entrées ont été créées lorsque l’agent était hors connexion.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-203">If the agent goes offline for a period of time, then Log Analytics will collect entries from where it last left off, even if those entries were created while the agent was offline.</span></span>

<span data-ttu-id="6d2ab-204">L’entrée de journal est intégralement inscrite dans une propriété unique appelée **RawData**.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-204">The entire contents of the log entry are written to a single property called **RawData**.</span></span>  <span data-ttu-id="6d2ab-205">Vous pouvez l’analyser dans plusieurs propriétés que vous pouvez analyser et interroger, en définissant [Champs personnalisés](log-analytics-custom-fields.md) après avoir créé le journal personnalisé.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-205">You can parse this into multiple properties that can be analyzed and searched separately by defining [Custom Fields](log-analytics-custom-fields.md) after you have created the custom log.</span></span>

## <a name="custom-log-record-properties"></a><span data-ttu-id="6d2ab-206">Propriétés d’enregistrement de journal personnalisé</span><span class="sxs-lookup"><span data-stu-id="6d2ab-206">Custom log record properties</span></span>
<span data-ttu-id="6d2ab-207">Les enregistrements de journal personnalisé sont caractérisés par le nom du journal que vous fournissez et les propriétés dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-207">Custom log records have a type with the log name that you provide and the properties in the following table.</span></span>

| <span data-ttu-id="6d2ab-208">Propriété</span><span class="sxs-lookup"><span data-stu-id="6d2ab-208">Property</span></span> | <span data-ttu-id="6d2ab-209">Description</span><span class="sxs-lookup"><span data-stu-id="6d2ab-209">Description</span></span> |
|:--- |:--- |
| <span data-ttu-id="6d2ab-210">TimeGenerated</span><span class="sxs-lookup"><span data-stu-id="6d2ab-210">TimeGenerated</span></span> |<span data-ttu-id="6d2ab-211">Date et heure auxquelles l’enregistrement a été collecté par Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-211">Date and time that the record was collected by Log Analytics.</span></span>  <span data-ttu-id="6d2ab-212">Si le journal utilise un délimiteur basé sur l’heure, il s’agit de l’heure collectée à partir de l’entrée.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-212">If the log uses a time-based delimiter then this is the time collected from the entry.</span></span> |
| <span data-ttu-id="6d2ab-213">SourceSystem</span><span class="sxs-lookup"><span data-stu-id="6d2ab-213">SourceSystem</span></span> |<span data-ttu-id="6d2ab-214">Type d’agent auprès duquel l’enregistrement a été collecté.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-214">Type of agent the record was collected from.</span></span> <br> <span data-ttu-id="6d2ab-215">Ops Manager : Agent Windows. Connexion directe ou System Center Operations Manager</span><span class="sxs-lookup"><span data-stu-id="6d2ab-215">OpsManager – Windows agent, either direct connect or System Center Operations Manager</span></span> <br> <span data-ttu-id="6d2ab-216">Linux – Tous les agents Linux</span><span class="sxs-lookup"><span data-stu-id="6d2ab-216">Linux – All Linux agents</span></span> |
| <span data-ttu-id="6d2ab-217">RawData</span><span class="sxs-lookup"><span data-stu-id="6d2ab-217">RawData</span></span> |<span data-ttu-id="6d2ab-218">Texte complet de l’entrée collectée.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-218">Full text of the collected entry.</span></span> |
| <span data-ttu-id="6d2ab-219">ManagementGroupName</span><span class="sxs-lookup"><span data-stu-id="6d2ab-219">ManagementGroupName</span></span> |<span data-ttu-id="6d2ab-220">Nom du groupe d’administration pour les agents System Center Operations Manage</span><span class="sxs-lookup"><span data-stu-id="6d2ab-220">Name of the management group for System Center Operations Manage agents.</span></span>  <span data-ttu-id="6d2ab-221">Pour les autres agents, il s’agit d’AOI-\<workspace ID\></span><span class="sxs-lookup"><span data-stu-id="6d2ab-221">For other agents, this is AOI-\<workspace ID\></span></span> |

## <a name="log-searches-with-custom-log-records"></a><span data-ttu-id="6d2ab-222">Recherches de journal avec des enregistrements de journal personnalisé</span><span class="sxs-lookup"><span data-stu-id="6d2ab-222">Log searches with custom log records</span></span>
<span data-ttu-id="6d2ab-223">Les enregistrements de journaux personnalisés sont stockés dans le référentiel OMS, comme les enregistrements d’autres sources de données.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-223">Records from custom logs are stored in the OMS repository just like records from any other data source.</span></span>  <span data-ttu-id="6d2ab-224">Leur type correspond au nom que vous fournissez lorsque vous définissez le journal. Vous pouvez donc utiliser la propriété Type dans votre recherche pour récupérer les enregistrements collectés dans un journal spécifique.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-224">They will have a type matching the name that you provide when you define the log, so you can use the Type property in your search to retrieve records collected from a specific log.</span></span>

<span data-ttu-id="6d2ab-225">Le tableau suivant fournit plusieurs exemples de recherches qui extraient des enregistrements de journaux personnalisés.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-225">The following table provides different examples of log searches that retrieve records from custom logs.</span></span>

| <span data-ttu-id="6d2ab-226">Interroger</span><span class="sxs-lookup"><span data-stu-id="6d2ab-226">Query</span></span> | <span data-ttu-id="6d2ab-227">Description</span><span class="sxs-lookup"><span data-stu-id="6d2ab-227">Description</span></span> |
|:--- |:--- |
| <span data-ttu-id="6d2ab-228">Type=MyApp_CL</span><span class="sxs-lookup"><span data-stu-id="6d2ab-228">Type=MyApp_CL</span></span> |<span data-ttu-id="6d2ab-229">Tous les événements du fichier journal nommé MyApp_CL.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-229">All events from a custom log named MyApp_CL.</span></span> |
| <span data-ttu-id="6d2ab-230">Type=MyApp_CL Severity_CF=error</span><span class="sxs-lookup"><span data-stu-id="6d2ab-230">Type=MyApp_CL Severity_CF=error</span></span> |<span data-ttu-id="6d2ab-231">Tous les événements d’un journal personnalisé nommé MyApp_CL avec la valeur *error* dans le champ personnalisé nommé *Severity_CF*.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-231">All events from a custom log named MyApp_CL with a value of *error* in a custom field named *Severity_CF*.</span></span> |

>[!NOTE]
> <span data-ttu-id="6d2ab-232">Si votre espace de travail a été mis à niveau vers le [nouveau langage de requête Log Analytics](log-analytics-log-search-upgrade.md), les requêtes ci-dessus seront remplacées par les suivantes.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-232">If your workspace has been upgraded to the [new Log Analytics query language](log-analytics-log-search-upgrade.md), then the above queries would change to the following.</span></span>

> | <span data-ttu-id="6d2ab-233">Interroger</span><span class="sxs-lookup"><span data-stu-id="6d2ab-233">Query</span></span> | <span data-ttu-id="6d2ab-234">Description</span><span class="sxs-lookup"><span data-stu-id="6d2ab-234">Description</span></span> |
|:--- |:--- |
| <span data-ttu-id="6d2ab-235">MyApp_CL</span><span class="sxs-lookup"><span data-stu-id="6d2ab-235">MyApp_CL</span></span> |<span data-ttu-id="6d2ab-236">Tous les événements du fichier journal nommé MyApp_CL.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-236">All events from a custom log named MyApp_CL.</span></span> |
| <span data-ttu-id="6d2ab-237">MyApp_CL &#124; where Severity_CF=="error"</span><span class="sxs-lookup"><span data-stu-id="6d2ab-237">MyApp_CL &#124; where Severity_CF=="error"</span></span> |<span data-ttu-id="6d2ab-238">Tous les événements d’un journal personnalisé nommé MyApp_CL avec la valeur *error* dans le champ personnalisé nommé *Severity_CF*.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-238">All events from a custom log named MyApp_CL with a value of *error* in a custom field named *Severity_CF*.</span></span> |


## <a name="sample-walkthrough-of-adding-a-custom-log"></a><span data-ttu-id="6d2ab-239">Exemple de procédure d’ajout d’un journal personnalisé</span><span class="sxs-lookup"><span data-stu-id="6d2ab-239">Sample walkthrough of adding a custom log</span></span>
<span data-ttu-id="6d2ab-240">La section suivante décrit la procédure complète de création d’un champ personnalisé.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-240">The following section walks through an example of creating a custom log.</span></span>  <span data-ttu-id="6d2ab-241">L’exemple de journal collecté comporte une seule entrée sur chaque ligne commençant par une date et une heure, suivie de plusieurs champs (code, état et message) séparés par des virgules.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-241">The sample log being collected has a single entry on each line starting with a date and time and then comma-delimited fields for code, status, and message.</span></span>  <span data-ttu-id="6d2ab-242">Plusieurs exemples d’entrée sont présentés ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-242">Several sample entries are shown below.</span></span>

    2016-03-10 01:34:36 207,Success,Client 05a26a97-272a-4bc9-8f64-269d154b0e39 connected
    2016-03-10 01:33:33 208,Warning,Client ec53d95c-1c88-41ae-8174-92104212de5d disconnected
    2016-03-10 01:35:44 209,Success,Transaction 10d65890-b003-48f8-9cfc-9c74b51189c8 succeeded
    2016-03-10 01:38:22 302,Error,Application could not connect to database
    2016-03-10 01:31:34 303,Error,Application lost connection to database

### <a name="upload-and-parse-a-sample-log"></a><span data-ttu-id="6d2ab-243">Télécharger et analyser un exemple de journal</span><span class="sxs-lookup"><span data-stu-id="6d2ab-243">Upload and parse a sample log</span></span>
<span data-ttu-id="6d2ab-244">Nous fournissons un des fichiers journaux et nous voyons les événements qu’il va collecter.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-244">We provide one of the log files and can see the events that it will be collecting.</span></span>  <span data-ttu-id="6d2ab-245">Dans ce cas, le délimiteur Nouvelle ligne suffit.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-245">In this case New Line is a sufficient delimiter.</span></span>  <span data-ttu-id="6d2ab-246">Cependant, si une entrée du journal s’étend sur plusieurs lignes, il faut utiliser un délimiteur Horodatage.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-246">If a single entry in the log could span multiple lines though, then a timestamp delimiter would need to be used.</span></span>

![Télécharger et analyser un exemple de journal](media/log-analytics-data-sources-custom-logs/delimiter.png)

### <a name="add-log-collection-paths"></a><span data-ttu-id="6d2ab-248">Ajouter des chemins de collecte de journaux</span><span class="sxs-lookup"><span data-stu-id="6d2ab-248">Add log collection paths</span></span>
<span data-ttu-id="6d2ab-249">Les fichiers journaux se situeront dans *C:\MyApp\Logs*.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-249">The log files will be located in *C:\MyApp\Logs*.</span></span>  <span data-ttu-id="6d2ab-250">Un fichier sera créé chaque jour avec un nom comprenant la date au format *appAAAAMMJJ.log*.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-250">A new file will be created each day with a name that includes the date in the pattern *appYYYYMMDD.log*.</span></span>  <span data-ttu-id="6d2ab-251">Le format adapté à ce fichier journal est *C:\MyApp\Logs\\\\*.log*.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-251">A sufficient pattern for this log would be *C:\MyApp\Logs\\\*.log*.</span></span>

![Chemin de collecte de journaux](media/log-analytics-data-sources-custom-logs/collection-path.png)

### <a name="provide-a-name-and-description-for-the-log"></a><span data-ttu-id="6d2ab-253">Indiquer le nom et la description du journal</span><span class="sxs-lookup"><span data-stu-id="6d2ab-253">Provide a name and description for the log</span></span>
<span data-ttu-id="6d2ab-254">Nous utilisons le nom *MyApp_CL* et complétons le champ **Description**.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-254">We use a name of *MyApp_CL* and type in a **Description**.</span></span>

![Nom du journal](media/log-analytics-data-sources-custom-logs/log-name.png)

### <a name="validate-that-the-custom-logs-are-being-collected"></a><span data-ttu-id="6d2ab-256">Vérifier que les journaux personnalisés sont collectés</span><span class="sxs-lookup"><span data-stu-id="6d2ab-256">Validate that the custom logs are being collected</span></span>
<span data-ttu-id="6d2ab-257">Nous utilisons une requête *Type=MyApp_CL* pour retourner tous les enregistrements du journal collecté.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-257">We use a query of *Type=MyApp_CL* to return all records from the collected log.</span></span>

![Requête de journal sans aucun champ personnalisé](media/log-analytics-data-sources-custom-logs/query-01.png)

### <a name="parse-the-custom-log-entries"></a><span data-ttu-id="6d2ab-259">Analyser les entrées du journal personnalisé</span><span class="sxs-lookup"><span data-stu-id="6d2ab-259">Parse the custom log entries</span></span>
<span data-ttu-id="6d2ab-260">Nous utilisons Champs personnalisés pour définir les champs *EventTime*, *Code*, *Status* et *Message*, et pouvons voir la différence dans les enregistrements retournés par la requête.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-260">We use Custom Fields to define the *EventTime*, *Code*, *Status*, and *Message* fields and we can see the difference in the records that are returned by the query.</span></span>

![Requête de journal avec des champs personnalisés](media/log-analytics-data-sources-custom-logs/query-02.png)

## <a name="next-steps"></a><span data-ttu-id="6d2ab-262">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="6d2ab-262">Next steps</span></span>
* <span data-ttu-id="6d2ab-263">Utilisez [Champs personnalisés](log-analytics-custom-fields.md) pour analyser les entrées du journal personnalisé dans des champs individuels.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-263">Use [Custom Fields](log-analytics-custom-fields.md) to parse the entries in the custom log in to individual fields.</span></span>
* <span data-ttu-id="6d2ab-264">En savoir plus sur les [recherches de journal](log-analytics-log-searches.md) pour analyser les données collectées dans des sources de données et des solutions.</span><span class="sxs-lookup"><span data-stu-id="6d2ab-264">Learn about [log searches](log-analytics-log-searches.md) to analyze the data collected from data sources and solutions.</span></span>
