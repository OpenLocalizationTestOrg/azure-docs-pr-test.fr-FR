---
title: Solution Azure SQL Analytics dans Log Analytics | Microsoft Docs
description: "La solution Azure SQL Analytics vous permet de gérer vos instances Azure SQL Database."
services: log-analytics
documentationcenter: 
author: bandersmsft
manager: carmonm
editor: 
ms.assetid: b2712749-1ded-40c4-b211-abc51cc65171
ms.service: log-analytics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/13/2017
ms.author: banders
ms.openlocfilehash: cab45cc6dd621eb4a95ef5f1842ec38c25e980b6
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/03/2017
---
# <a name="monitor-azure-sql-database-using-azure-sql-analytics-preview-in-log-analytics"></a><span data-ttu-id="7c443-103">Surveiller Azure SQL Database à l’aide d’Azure SQL Analytics (version préliminaire) dans Log Analytics</span><span class="sxs-lookup"><span data-stu-id="7c443-103">Monitor Azure SQL Database using Azure SQL Analytics (Preview) in Log Analytics</span></span>

![Symbole Azure SQL Analytics](./media/log-analytics-azure-sql/azure-sql-symbol.png)

<span data-ttu-id="7c443-105">La solution Azure SQL Analytics d’Azure Log Analytics collecte et affiche d’importantes mesures de performances de SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="7c443-105">The Azure SQL Analytics solution in Azure Log Analytics collects and visualizes important SQL Azure performance metrics.</span></span> <span data-ttu-id="7c443-106">En vous appuyant sur les mesures collectées avec la solution, vous êtes en mesure de créer des règles et des alertes personnalisées de surveillance.</span><span class="sxs-lookup"><span data-stu-id="7c443-106">By using the metrics that you collect with the solution, you can create custom monitoring rules and alerts.</span></span> <span data-ttu-id="7c443-107">Par ailleurs, vous pouvez surveiller les mesures associées à Azure SQL Database et aux pools élastiques au sein de plusieurs abonnements Azure et pools élastiques, et afficher ces données.</span><span class="sxs-lookup"><span data-stu-id="7c443-107">And, you can monitor Azure SQL Database and elastic pool metrics across multiple Azure subscriptions and elastic pools and visualize them.</span></span> <span data-ttu-id="7c443-108">La solution vous aide également à identifier les problèmes sur chacune des couches de votre pile applicative.</span><span class="sxs-lookup"><span data-stu-id="7c443-108">The solution also helps you to identify issues at each layer of your application stack.</span></span>  <span data-ttu-id="7c443-109">Elle utilise les [données de diagnostic Azure](log-analytics-azure-storage.md) avec les vues Log Analytics pour présenter les données relatives à l’ensemble de vos instances Azure SQL Database et de vos pools élastiques dans un espace de travail Log Analytics unique.</span><span class="sxs-lookup"><span data-stu-id="7c443-109">It uses [Azure Diagnostic metrics](log-analytics-azure-storage.md) together with Log Analytics views to present data about all your Azure SQL databases and elastic pools in a single Log Analytics workspace.</span></span>

<span data-ttu-id="7c443-110">Actuellement, cette solution en version préliminaire prend en charge jusqu’à 150 000 instances Azure SQL Database et 5 000 pools élastiques SQL par espace de travail.</span><span class="sxs-lookup"><span data-stu-id="7c443-110">Currently, this preview solution supports up to 150,000 Azure SQL Databases and 5,000 SQL Elastic Pools per workspace.</span></span>

<span data-ttu-id="7c443-111">La solution Azure SQL Analytics, comme d’autres solutions disponibles pour Log Analytics, prend en charge la surveillance et la réception des notifications sur l’intégrité de vos ressources Azure, ici d’Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="7c443-111">The Azure SQL Analytics solution, like others available for Log Analytics, helps you monitor and receive notifications about the health of your Azure resources—in this case, Azure SQL Database.</span></span> <span data-ttu-id="7c443-112">Microsoft Azure SQL Database est un service évolutif de base de données relationnelle qui offre des fonctionnalités similaires à celles de SQL Server aux applications exécutées dans le cloud Azure.</span><span class="sxs-lookup"><span data-stu-id="7c443-112">Microsoft Azure SQL Database is a scalable relational database service that provides familiar SQL-Server-like capabilities to applications running in the Azure cloud.</span></span> <span data-ttu-id="7c443-113">Log Analytics prend en charge la collecte, la mise en correspondance et l’affichage des données structurées et non structurées.</span><span class="sxs-lookup"><span data-stu-id="7c443-113">Log Analytics helps you to collect, correlate, and visualize structured and unstructured data.</span></span>

## <a name="connected-sources"></a><span data-ttu-id="7c443-114">Sources connectées</span><span class="sxs-lookup"><span data-stu-id="7c443-114">Connected sources</span></span>

<span data-ttu-id="7c443-115">La solution Azure SQL Analytics n’utilise pas d’agent pour établir la connexion avec le service Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="7c443-115">The Azure SQL Analytics solution doesn't use agents to connect to the Log Analytics service.</span></span>

<span data-ttu-id="7c443-116">Le tableau suivant décrit les sources connectées qui sont prises en charge par cette solution.</span><span class="sxs-lookup"><span data-stu-id="7c443-116">The following table describes the connected sources that are supported by this solution.</span></span>

| <span data-ttu-id="7c443-117">Source connectée</span><span class="sxs-lookup"><span data-stu-id="7c443-117">Connected Source</span></span> | <span data-ttu-id="7c443-118">Support</span><span class="sxs-lookup"><span data-stu-id="7c443-118">Support</span></span> | <span data-ttu-id="7c443-119">Description</span><span class="sxs-lookup"><span data-stu-id="7c443-119">Description</span></span> |
| --- | --- | --- |
| [<span data-ttu-id="7c443-120">Agents Windows</span><span class="sxs-lookup"><span data-stu-id="7c443-120">Windows agents</span></span>](log-analytics-windows-agents.md) | <span data-ttu-id="7c443-121">Non</span><span class="sxs-lookup"><span data-stu-id="7c443-121">No</span></span> | <span data-ttu-id="7c443-122">Les agents directs Windows ne sont pas utilisés par la solution.</span><span class="sxs-lookup"><span data-stu-id="7c443-122">Direct Windows agents are not used by the solution.</span></span> |
| [<span data-ttu-id="7c443-123">Agents Linux</span><span class="sxs-lookup"><span data-stu-id="7c443-123">Linux agents</span></span>](log-analytics-linux-agents.md) | <span data-ttu-id="7c443-124">Non</span><span class="sxs-lookup"><span data-stu-id="7c443-124">No</span></span> | <span data-ttu-id="7c443-125">Les agents directs Linux ne sont pas utilisés par la solution.</span><span class="sxs-lookup"><span data-stu-id="7c443-125">Direct Linux agents are not used by the solution.</span></span> |
| [<span data-ttu-id="7c443-126">Groupe d’administration SCOM</span><span class="sxs-lookup"><span data-stu-id="7c443-126">SCOM management group</span></span>](log-analytics-om-agents.md) | <span data-ttu-id="7c443-127">Non</span><span class="sxs-lookup"><span data-stu-id="7c443-127">No</span></span> | <span data-ttu-id="7c443-128">La solution ne valorise aucune connexion directe entre l’agent SCOM et Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="7c443-128">A direct connection from the SCOM agent to Log Analytics is not used by the solution.</span></span> |
| [<span data-ttu-id="7c443-129">Compte Stockage Azure</span><span class="sxs-lookup"><span data-stu-id="7c443-129">Azure storage account</span></span>](log-analytics-azure-storage.md) | <span data-ttu-id="7c443-130">Non</span><span class="sxs-lookup"><span data-stu-id="7c443-130">No</span></span> | <span data-ttu-id="7c443-131">Log Analytics ne lit pas les données du compte de stockage.</span><span class="sxs-lookup"><span data-stu-id="7c443-131">Log Analytics does not read the data from a storage account.</span></span> |
| [<span data-ttu-id="7c443-132">Diagnostics Azure</span><span class="sxs-lookup"><span data-stu-id="7c443-132">Azure diagnostics</span></span>](log-analytics-azure-storage.md) | <span data-ttu-id="7c443-133">Oui</span><span class="sxs-lookup"><span data-stu-id="7c443-133">Yes</span></span> | <span data-ttu-id="7c443-134">Les données de mesure Azure sont transmises à Log Analytics directement par Azure.</span><span class="sxs-lookup"><span data-stu-id="7c443-134">Azure metric data is sent to Log Analytics directly by Azure.</span></span> |

## <a name="prerequisites"></a><span data-ttu-id="7c443-135">Composants requis</span><span class="sxs-lookup"><span data-stu-id="7c443-135">Prerequisites</span></span>

- <span data-ttu-id="7c443-136">Un abonnement Azure.</span><span class="sxs-lookup"><span data-stu-id="7c443-136">An Azure Subscription.</span></span> <span data-ttu-id="7c443-137">Si vous n’en avez pas, créez-en un [gratuitement](https://azure.microsoft.com/free/).</span><span class="sxs-lookup"><span data-stu-id="7c443-137">If you don't have one, you can create one for [free](https://azure.microsoft.com/free/).</span></span>
- <span data-ttu-id="7c443-138">Un espace de travail Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="7c443-138">A Log Analytics workspace.</span></span> <span data-ttu-id="7c443-139">Vous pouvez utiliser un élément existant, ou en [créez un nouveau](log-analytics-get-started.md) avant de commencer à utiliser cette solution.</span><span class="sxs-lookup"><span data-stu-id="7c443-139">You can use an existing one, or you can [create a new one](log-analytics-get-started.md) before you start using this solution.</span></span>
- <span data-ttu-id="7c443-140">Activez les diagnostics Azure pour vos instances Azure SQL Database et vos pools élastiques et [configurez-les pour l’envoi de leurs données vers Log Analytics](https://blogs.technet.microsoft.com/msoms/2017/01/17/enable-azure-resource-metrics-logging-using-powershell/).</span><span class="sxs-lookup"><span data-stu-id="7c443-140">Enable Azure Diagnostics for your Azure SQL databases and elastic pools and [configure them to send their data to Log Analytics](https://blogs.technet.microsoft.com/msoms/2017/01/17/enable-azure-resource-metrics-logging-using-powershell/).</span></span>

## <a name="configuration"></a><span data-ttu-id="7c443-141">Configuration</span><span class="sxs-lookup"><span data-stu-id="7c443-141">Configuration</span></span>

<span data-ttu-id="7c443-142">Exécutez la procédure suivante afin d’ajouter la solution Azure SQL Analytics dans votre espace de travail.</span><span class="sxs-lookup"><span data-stu-id="7c443-142">Perform the following steps to add the Azure SQL Analytics solution to your workspace.</span></span>

1. <span data-ttu-id="7c443-143">Ajoutez la solution Azure SQL Analytics à votre espace de travail depuis la [Place de marché Azure](https://azuremarketplace.microsoft.com/en-us/marketplace/apps/Microsoft.AzureSQLAnalyticsOMS?tab=Overview) ou en procédant de la manière décrite dans [Ajouter des solutions Log Analytics à partir de la galerie de solutions](log-analytics-add-solutions.md).</span><span class="sxs-lookup"><span data-stu-id="7c443-143">Add the Azure SQL Analytics solution to your workspace from [Azure marketplace](https://azuremarketplace.microsoft.com/en-us/marketplace/apps/Microsoft.AzureSQLAnalyticsOMS?tab=Overview) or by using the process described in [Add Log Analytics solutions from the Solutions Gallery](log-analytics-add-solutions.md).</span></span>
2. <span data-ttu-id="7c443-144">Dans le portail Azure, cliquez sur **Nouveau** (le symbole +), puis sur la liste de ressources, et sélectionnez **Surveillance et gestion**.</span><span class="sxs-lookup"><span data-stu-id="7c443-144">In the Azure portal, click **New** (the + symbol), then in the list of resources, select **Monitoring + Management**.</span></span>  
    <span data-ttu-id="7c443-145">![Surveillance et gestion](./media/log-analytics-azure-sql/monitoring-management.png)</span><span class="sxs-lookup"><span data-stu-id="7c443-145">![Monitoring + Management](./media/log-analytics-azure-sql/monitoring-management.png)</span></span>
3. <span data-ttu-id="7c443-146">Dans la liste **Surveillance et gestion**, cliquez sur **Afficher tout**.</span><span class="sxs-lookup"><span data-stu-id="7c443-146">In the **Monitoring + Management** list click **See all**.</span></span>
4. <span data-ttu-id="7c443-147">Dans la liste **Recommandé**, cliquez sur **Plus**. Ensuite, dans la nouvelle liste, recherchez **Azure SQL Analytics (version préliminaire)** et sélectionnez cet élément.</span><span class="sxs-lookup"><span data-stu-id="7c443-147">In the **Recommended** list, click **More** , and then in the new list, find **Azure SQL Analytics (Preview)** and then select it.</span></span>  
    <span data-ttu-id="7c443-148">![Solution Azure SQL Analytics](./media/log-analytics-azure-sql/azure-sql-solution-portal.png)</span><span class="sxs-lookup"><span data-stu-id="7c443-148">![Azure SQL Analytics solution](./media/log-analytics-azure-sql/azure-sql-solution-portal.png)</span></span>
5. <span data-ttu-id="7c443-149">Dans le panneau **Azure SQL Analytics (version préliminaire)**, cliquez sur **Créer**.</span><span class="sxs-lookup"><span data-stu-id="7c443-149">In the **Azure SQL Analytics (Preview)** blade, click **Create**.</span></span>  
    <span data-ttu-id="7c443-150">![Créer](./media/log-analytics-azure-sql/portal-create.png)</span><span class="sxs-lookup"><span data-stu-id="7c443-150">![Create](./media/log-analytics-azure-sql/portal-create.png)</span></span>
6. <span data-ttu-id="7c443-151">Dans le panneau **Créer une nouvelle solution**, sélectionnez l’espace de travail que vous souhaitez ajouter à la solution, puis cliquez sur **Créer**.</span><span class="sxs-lookup"><span data-stu-id="7c443-151">In the **Create new solution** blade, select the workspace that you want to add the solution to and then click **Create**.</span></span>  
    <span data-ttu-id="7c443-152">![ajouter à l’espace de travail](./media/log-analytics-azure-sql/add-to-workspace.png)</span><span class="sxs-lookup"><span data-stu-id="7c443-152">![add to workspace](./media/log-analytics-azure-sql/add-to-workspace.png)</span></span>


### <a name="to-configure-multiple-azure-subscriptions"></a><span data-ttu-id="7c443-153">Pour configurer plusieurs abonnements Azure</span><span class="sxs-lookup"><span data-stu-id="7c443-153">To configure multiple Azure subscriptions</span></span>

<span data-ttu-id="7c443-154">Pour prendre en charge plusieurs abonnements, utilisez le script PowerShell de [Enable Azure resource metrics logging using PowerShell](https://blogs.technet.microsoft.com/msoms/2017/01/17/enable-azure-resource-metrics-logging-using-powershell/) (Activer la journalisation des mesures de ressources Azure à l’aide de PowerShell).</span><span class="sxs-lookup"><span data-stu-id="7c443-154">To support multiple subscriptions, use the PowerShell script from [Enable Azure resource metrics logging using PowerShell](https://blogs.technet.microsoft.com/msoms/2017/01/17/enable-azure-resource-metrics-logging-using-powershell/).</span></span> <span data-ttu-id="7c443-155">Fournissez l’ID de ressource d’espace de travail en tant que paramètre lors de l’exécution du script pour transmettre les données des ressources d’un abonnement Azure vers un espace de travail d’un autre abonnement Azure.</span><span class="sxs-lookup"><span data-stu-id="7c443-155">Provide the workspace resource ID as a parameter when executing the script to send diagnostic data from resources in one Azure subscription to a workspace in another Azure subscription.</span></span>

<span data-ttu-id="7c443-156">**Exemple**</span><span class="sxs-lookup"><span data-stu-id="7c443-156">**Example**</span></span>

```
PS C:\> $WSID = "/subscriptions/<subID>/resourcegroups/oms/providers/microsoft.operationalinsights/workspaces/omsws"
```

```
PS C:\> .\Enable-AzureRMDiagnostics.ps1 -WSID $WSID
```

## <a name="using-the-solution"></a><span data-ttu-id="7c443-157">Utilisation de la solution</span><span class="sxs-lookup"><span data-stu-id="7c443-157">Using the solution</span></span>

<span data-ttu-id="7c443-158">Lorsque vous ajoutez la solution à votre espace de travail, la vignette Azure SQL Analytics est également ajoutée ; elle apparaît dans la Vue d’ensemble.</span><span class="sxs-lookup"><span data-stu-id="7c443-158">When you add the solution to your workspace, the Azure SQL Analytics tile is added to your workspace, and it appears in Overview.</span></span> <span data-ttu-id="7c443-159">La vignette indique le nombre d’instances Azure SQL Database et de pools élastiques Azure SQL auxquels la solution est associée.</span><span class="sxs-lookup"><span data-stu-id="7c443-159">The tile shows the number of Azure SQL databases and Azure SQL elastic pools that the solution is connected to.</span></span>

![Vignette Azure SQL Analytics](./media/log-analytics-azure-sql/azure-sql-sol-tile.png)

### <a name="viewing-azure-sql-analytics-data"></a><span data-ttu-id="7c443-161">Affichage des données Azure SQL Analytics</span><span class="sxs-lookup"><span data-stu-id="7c443-161">Viewing Azure SQL Analytics data</span></span>

<span data-ttu-id="7c443-162">Cliquez sur la vignette **Azure SQL Analytics** afin d’ouvrir le tableau de bord Azure SQL Analytics.</span><span class="sxs-lookup"><span data-stu-id="7c443-162">Click on the **Azure SQL Analytics** tile to open the Azure SQL Analytics dashboard.</span></span> <span data-ttu-id="7c443-163">Le tableau de bord comprend les panneaux définis ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="7c443-163">The dashboard includes the blades defined below.</span></span> <span data-ttu-id="7c443-164">Chaque panneau répertorie jusqu’à 15 ressources (abonnement, serveur, pool élastique et base de données).</span><span class="sxs-lookup"><span data-stu-id="7c443-164">Each blade lists up to 15 resources (subscription, server, elastic pool, and database).</span></span> <span data-ttu-id="7c443-165">Cliquez sur une des ressources pour ouvrir le tableau de bord correspondant.</span><span class="sxs-lookup"><span data-stu-id="7c443-165">Click any of the resources to open the dashboard for that specific resource.</span></span> <span data-ttu-id="7c443-166">Les pools élastiques et les bases de données contiennent des graphiques avec des mesures pour une ressource donnée.</span><span class="sxs-lookup"><span data-stu-id="7c443-166">Elastic Pool or Database contains the charts with metrics for a selected resource.</span></span> <span data-ttu-id="7c443-167">Cliquez sur un graphique pour ouvrir la boîte de dialogue Recherche dans les journaux.</span><span class="sxs-lookup"><span data-stu-id="7c443-167">Click a chart to open the Log Search dialog.</span></span>

| <span data-ttu-id="7c443-168">Panneau</span><span class="sxs-lookup"><span data-stu-id="7c443-168">Blade</span></span> | <span data-ttu-id="7c443-169">Description</span><span class="sxs-lookup"><span data-stu-id="7c443-169">Description</span></span> |
|---|---|
| <span data-ttu-id="7c443-170">Abonnements</span><span class="sxs-lookup"><span data-stu-id="7c443-170">Subscriptions</span></span> | <span data-ttu-id="7c443-171">Liste des abonnements avec le nombre de bases de données, de pools et de serveurs connectés.</span><span class="sxs-lookup"><span data-stu-id="7c443-171">List of subscriptions with number of connected servers, pools, and databases.</span></span> |
| <span data-ttu-id="7c443-172">Serveurs</span><span class="sxs-lookup"><span data-stu-id="7c443-172">Servers</span></span> | <span data-ttu-id="7c443-173">Liste des serveurs avec le nombre de bases de données et de pools connectés.</span><span class="sxs-lookup"><span data-stu-id="7c443-173">List of servers with number of connected pools and databases.</span></span> |
| <span data-ttu-id="7c443-174">Pools élastiques</span><span class="sxs-lookup"><span data-stu-id="7c443-174">Elastic Pools</span></span> | <span data-ttu-id="7c443-175">Liste des pools élastiques connectés avec les Go et eDTU maximum dans la période observée.</span><span class="sxs-lookup"><span data-stu-id="7c443-175">List of connected elastic pools with maximum GB and eDTU in the observed period.</span></span> |
|<span data-ttu-id="7c443-176">Bases de données</span><span class="sxs-lookup"><span data-stu-id="7c443-176">Databases</span></span> | <span data-ttu-id="7c443-177">Liste des bases de données connectées avec les Go et DTU maximum dans la période observée.</span><span class="sxs-lookup"><span data-stu-id="7c443-177">List of connected databases with maximum GB and DTU in the observed period.</span></span>|


### <a name="analyze-data-and-create-alerts"></a><span data-ttu-id="7c443-178">Analyser les données et créer des alertes</span><span class="sxs-lookup"><span data-stu-id="7c443-178">Analyze data and create alerts</span></span>

<span data-ttu-id="7c443-179">Vous pouvez facilement créer des alertes avec les données provenant de ressources Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="7c443-179">You can easily create alerts with the data coming from Azure SQL Database resources.</span></span> <span data-ttu-id="7c443-180">Voici quelques requêtes utiles de [Recherche dans les journaux](log-analytics-log-searches.md) que vous pouvez utiliser pour créer des alertes :</span><span class="sxs-lookup"><span data-stu-id="7c443-180">Here are a couple of useful [log search](log-analytics-log-searches.md) queries that you can use for alerting:</span></span>

[!include[log-analytics-log-search-nextgeneration](../../includes/log-analytics-log-search-nextgeneration.md)]


<span data-ttu-id="7c443-181">*DTU élevé sur Azure SQL Database*</span><span class="sxs-lookup"><span data-stu-id="7c443-181">*High DTU on Azure SQL Database*</span></span>

```
Type=AzureMetrics ResourceProvider="MICROSOFT.SQL" ResourceId=*"/DATABASES/"* MetricName=dtu_consumption_percent | measure Avg(Average) by Resource interval 5minutes
```

<span data-ttu-id="7c443-182">*DTU élevé sur un pool élastique Azure SQL Database*</span><span class="sxs-lookup"><span data-stu-id="7c443-182">*High DTU on Azure SQL Database Elastic Pool*</span></span>

```
Type=AzureMetrics ResourceProvider="MICROSOFT.SQL" ResourceId=*"/ELASTICPOOLS/"* MetricName=dtu_consumption_percent | measure avg(Average) by Resource interval 5minutes
```

<span data-ttu-id="7c443-183">Vous pouvez utiliser ces requêtes de type alertes pour signaler que certains seuils sont atteints pour Azure SQL Database comme pour les pools élastiques.</span><span class="sxs-lookup"><span data-stu-id="7c443-183">You can use these alert-based queries to alert on specific thresholds for both Azure SQL Database and elastic pools.</span></span> <span data-ttu-id="7c443-184">Pour configurer une alerte pour votre espace de travail OMS :</span><span class="sxs-lookup"><span data-stu-id="7c443-184">To configure an alert for your OMS workspace:</span></span>

#### <a name="to-configure-an-alert-for-your-workspace"></a><span data-ttu-id="7c443-185">Pour configurer une alerte pour votre espace de travail</span><span class="sxs-lookup"><span data-stu-id="7c443-185">To configure an alert for your workspace</span></span>

1. <span data-ttu-id="7c443-186">Accédez au [portail OMS](http://mms.microsoft.com/), puis connectez-vous.</span><span class="sxs-lookup"><span data-stu-id="7c443-186">Go to the [OMS portal](http://mms.microsoft.com/) and sign in.</span></span>
2. <span data-ttu-id="7c443-187">Ouvrez l’espace de travail configuré pour la solution.</span><span class="sxs-lookup"><span data-stu-id="7c443-187">Open the workspace that you have configured for the solution.</span></span>
3. <span data-ttu-id="7c443-188">Sur la page Vue d’ensemble, cliquez sur la vignette **Azure SQL Analytics (version préliminaire)**.</span><span class="sxs-lookup"><span data-stu-id="7c443-188">On the Overview page, click the **Azure SQL Analytics (Preview)** tile.</span></span>
4. <span data-ttu-id="7c443-189">Exécutez l’un des exemples de requêtes.</span><span class="sxs-lookup"><span data-stu-id="7c443-189">Run one of the example queries.</span></span>
5. <span data-ttu-id="7c443-190">Dans la recherche dans les journaux, cliquez sur **Alerte**.</span><span class="sxs-lookup"><span data-stu-id="7c443-190">In Log Search, click **Alert**.</span></span>  
<span data-ttu-id="7c443-191">![création d’une alerte dans la recherche](./media/log-analytics-azure-sql/create-alert01.png)</span><span class="sxs-lookup"><span data-stu-id="7c443-191">![create alert in search](./media/log-analytics-azure-sql/create-alert01.png)</span></span>
6. <span data-ttu-id="7c443-192">Sur la page **Ajouter une règle d’alerte**, configurez les propriétés appropriées et les seuils spécifiques, puis cliquez sur **Enregistrer**.</span><span class="sxs-lookup"><span data-stu-id="7c443-192">On the **Add Alert Rule** page, configure the appropriate properties and the specific thresholds that you want and then click **Save**.</span></span>  
<span data-ttu-id="7c443-193">![ajout d’une règle d’alerte](./media/log-analytics-azure-sql/create-alert02.png)</span><span class="sxs-lookup"><span data-stu-id="7c443-193">![add alert rule](./media/log-analytics-azure-sql/create-alert02.png)</span></span>

### <a name="act-on-azure-sql-analytics-data"></a><span data-ttu-id="7c443-194">Utilisation des données Azure SQL Analytics</span><span class="sxs-lookup"><span data-stu-id="7c443-194">Act on Azure SQL Analytics data</span></span>

<span data-ttu-id="7c443-195">Par exemple, l’une des requêtes les plus utiles que vous pouvez exécuter implique la comparaison de l’utilisation des unités de débit de base de données (DTU, Database Throughput Unit) sur l’ensemble des pools élastiques Azure SQL de tous vos abonnements Azure.</span><span class="sxs-lookup"><span data-stu-id="7c443-195">As an example, one of the most useful queries that you can perform is to compare the DTU utilization for all Azure SQL Elastic Pools across all your Azure subscriptions.</span></span> <span data-ttu-id="7c443-196">L’utilisation de DTU constitue un moyen de décrire la capacité relative d’un niveau de performance des bases de données et des pools de base, Standard et Premium.</span><span class="sxs-lookup"><span data-stu-id="7c443-196">Database Throughput Unit (DTU) provides a way to describe the relative capacity of a performance level of Basic, Standard, and Premium databases and pools.</span></span> <span data-ttu-id="7c443-197">Les DTU sont une mesure combinant la quantité d’UC, la mémoire, les lectures et les écritures.</span><span class="sxs-lookup"><span data-stu-id="7c443-197">DTUs are based on a blended measure of CPU, memory, reads, and writes.</span></span> <span data-ttu-id="7c443-198">À mesure de l’augmentation de la valeur DTU, la puissance fournie par le niveau de performance augmente.</span><span class="sxs-lookup"><span data-stu-id="7c443-198">As DTUs increase, the power offered by the performance level increases.</span></span> <span data-ttu-id="7c443-199">Par exemple un niveau de performance avec 5 DTU présente une puissance 5 fois supérieure à un niveau de performance affichant 1 DTU.</span><span class="sxs-lookup"><span data-stu-id="7c443-199">For example, a performance level with 5 DTUs has five times more power than a performance level with 1 DTU.</span></span> <span data-ttu-id="7c443-200">Un quota de DTU est associé à chaque serveur et pool élastique.</span><span class="sxs-lookup"><span data-stu-id="7c443-200">A maximum DTU quota applies to each server and elastic pool.</span></span>

<span data-ttu-id="7c443-201">En exécutant la requête suivante dans la recherche des journaux, vous pouvez facilement identifier une sous-utilisation ou une surutilisation de vos pools élastiques SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="7c443-201">By running the following Log Search query, you can easily tell if you are underutilizing or over utilizing your SQL Azure elastic pools.</span></span>

```
Type=AzureMetrics ResourceId=*"/ELASTICPOOLS/"* MetricName=dtu_consumption_percent | measure avg(Average) by Resource | display LineChart
```

>[!NOTE]
> <span data-ttu-id="7c443-202">Si vous avez mis à niveau votre espace de travail vers le [nouveau langage de requête dans Log Analytics](log-analytics-log-search-upgrade.md), remplacez la requête ci-dessus par la requête ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="7c443-202">If your workspace has been upgraded to the [new Log Analytics query language](log-analytics-log-search-upgrade.md), then the above query would change to the following.</span></span>
>
>`search in (AzureMetrics) isnotempty(ResourceId) and "/ELASTICPOOLS/" and MetricName == "dtu_consumption_percent" | summarize AggregatedValue = avg(Average) by bin(TimeGenerated, 1h), Resource | render timechart`

<span data-ttu-id="7c443-203">Dans l’exemple suivant, vous pouvez constater qu’un pool élastique présente un taux élevé d’utilisation avoisinant les 100 % de valeur DTU, tandis que les autres affichent un taux très faible.</span><span class="sxs-lookup"><span data-stu-id="7c443-203">In the following example, you can see that one elastic pool has a high usage near 100% DTU while others have very little usage.</span></span> <span data-ttu-id="7c443-204">Vous pouvez effectuer d’autres recherches pour résoudre les problèmes associés aux potentielles modifications récentes apportées dans votre environnement, à l’aide des journaux d’activité Azure.</span><span class="sxs-lookup"><span data-stu-id="7c443-204">You can investigate further to troubleshoot potential recent changes in your environment using Azure Activity logs.</span></span>

![Résultats de la recherche dans les journaux - Utilisation élevée](./media/log-analytics-azure-sql/log-search-high-util.png)

## <a name="see-also"></a><span data-ttu-id="7c443-206">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="7c443-206">See also</span></span>

- <span data-ttu-id="7c443-207">Utilisez les [Recherches de journal](log-analytics-log-searches.md) dans Log Analytics pour afficher les données détaillées sur Azure SQL.</span><span class="sxs-lookup"><span data-stu-id="7c443-207">Use [Log Searches](log-analytics-log-searches.md) in Log Analytics to view detailed Azure SQL data.</span></span>
- <span data-ttu-id="7c443-208">[Créer un tableau de bord personnalisé](log-analytics-dashboards.md) comportant les données Azure SQL.</span><span class="sxs-lookup"><span data-stu-id="7c443-208">[Create your own dashboards](log-analytics-dashboards.md) showing Azure SQL data.</span></span>
- <span data-ttu-id="7c443-209">[Create and manage alert rules in Log Analytics with the OMS portal](log-analytics-alerts.md) (Créer et gérer des règles d’alerte dans Log Analytics dans Log Analytics à l’aide du portail OMS).</span><span class="sxs-lookup"><span data-stu-id="7c443-209">[Create alerts](log-analytics-alerts.md) when specific Azure SQL events occur.</span></span>
