---
title: Solution Analyse VMware dans Log Analytics | Microsoft Docs
description: "Découvrez comment la solution Analyse VMware peut vous aider à gérer les journaux et à surveiller les hôtes ESXi."
services: log-analytics
documentationcenter: 
author: bandersmsft
manager: carmonm
editor: 
ms.assetid: 16516639-cc1e-465c-a22f-022f3be297f1
ms.service: log-analytics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/11/2017
ms.author: banders
ms.openlocfilehash: 17072c4b6e4fdf6e4dc2b7a6a4ded7fa9f9f6fde
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/18/2017
---
# <a name="vmware-monitoring-preview-solution-in-log-analytics"></a><span data-ttu-id="ad907-103">Solution Analyse VMware (version préliminaire) dans Log Analytics</span><span class="sxs-lookup"><span data-stu-id="ad907-103">VMware Monitoring (Preview) solution in Log Analytics</span></span>

![Symbole VMware](./media/log-analytics-vmware/vmware-symbol.png)

<span data-ttu-id="ad907-105">La solution Analyse VMware dans Log Analytics vous aide à créer une approche centralisée de la journalisation et de l’analyse des journaux VMware volumineux.</span><span class="sxs-lookup"><span data-stu-id="ad907-105">The VMware Monitoring solution in Log Analytics is a solution that helps you create a centralized logging and monitoring approach for large VMware logs.</span></span> <span data-ttu-id="ad907-106">Cet article décrit comment dépanner, capturer et gérer les hôtes ESXi dans un emplacement unique à l’aide de la solution.</span><span class="sxs-lookup"><span data-stu-id="ad907-106">This article describes how you can troubleshoot, capture, and manage the ESXi hosts in a single location using the solution.</span></span> <span data-ttu-id="ad907-107">La solution vous permet de consulter des données détaillées pour tous vos hôtes ESXi dans un emplacement unique.</span><span class="sxs-lookup"><span data-stu-id="ad907-107">With the solution, you can see detailed data for all your ESXi hosts in a single location.</span></span> <span data-ttu-id="ad907-108">Vous pouvez voir le nombre, l’état et les tendances des principaux événements des hôtes de machine virtuelle et ESXi, fournis via les journaux d’hôte ESXi.</span><span class="sxs-lookup"><span data-stu-id="ad907-108">You can see top event counts, status, and trends of VM and ESXi hosts provided through the ESXi host logs.</span></span> <span data-ttu-id="ad907-109">Vous pouvez résoudre des problèmes en consultant des journaux d’hôte ESXi centralisés et en y effectuant des recherches.</span><span class="sxs-lookup"><span data-stu-id="ad907-109">You can troubleshoot by viewing and searching centralized ESXi host logs.</span></span> <span data-ttu-id="ad907-110">Et vous pouvez créer des alertes basées sur des requêtes de recherche de journal.</span><span class="sxs-lookup"><span data-stu-id="ad907-110">And, you can create alerts based on log search queries.</span></span>

<span data-ttu-id="ad907-111">La solution utilise la fonctionnalité syslog native de l’hôte ESXi pour transmettre des données à une machine virtuelle cible, qui dispose de l’agent OMS.</span><span class="sxs-lookup"><span data-stu-id="ad907-111">The solution uses native syslog functionality of the ESXi host to push data to a target VM, which has OMS Agent.</span></span> <span data-ttu-id="ad907-112">Toutefois, la solution n’écrit pas de fichiers dans syslog sur la machine virtuelle cible.</span><span class="sxs-lookup"><span data-stu-id="ad907-112">However, the solution doesn't write files into syslog within the target VM.</span></span> <span data-ttu-id="ad907-113">L’agent OMS ouvre le port 1514 et l’écoute.</span><span class="sxs-lookup"><span data-stu-id="ad907-113">The OMS agent opens port 1514 and listens to this.</span></span> <span data-ttu-id="ad907-114">Une fois les données reçues, l’agent OMS envoie les données dans OMS.</span><span class="sxs-lookup"><span data-stu-id="ad907-114">Once it receives the data, the OMS agent pushes the data into OMS.</span></span>

## <a name="installing-and-configuring-the-solution"></a><span data-ttu-id="ad907-115">Installation et configuration de la solution</span><span class="sxs-lookup"><span data-stu-id="ad907-115">Installing and configuring the solution</span></span>
<span data-ttu-id="ad907-116">Utilisez les informations suivantes pour installer et configurer la solution.</span><span class="sxs-lookup"><span data-stu-id="ad907-116">Use the following information to install and configure the solution.</span></span>

* <span data-ttu-id="ad907-117">Ajoutez la solution Analyse VMware à votre espace de travail OMS en procédant de la manière décrite dans [Ajouter des solutions Log Analytics à partir de la galerie de solutions](log-analytics-add-solutions.md).</span><span class="sxs-lookup"><span data-stu-id="ad907-117">Add the VMware Monitoring solution to your OMS workspace using the process described in [Add Log Analytics solutions from the Solutions Gallery](log-analytics-add-solutions.md).</span></span>

#### <a name="supported-vmware-esxi-hosts"></a><span data-ttu-id="ad907-118">Hôtes VMware ESXi pris en charge</span><span class="sxs-lookup"><span data-stu-id="ad907-118">Supported VMware ESXi hosts</span></span>
<span data-ttu-id="ad907-119">vSphere ESXi Host 5.5 et 6.0</span><span class="sxs-lookup"><span data-stu-id="ad907-119">vSphere ESXi Host 5.5 and 6.0</span></span>

#### <a name="prepare-a-linux-server"></a><span data-ttu-id="ad907-120">Préparer un serveur Linux</span><span class="sxs-lookup"><span data-stu-id="ad907-120">Prepare a Linux server</span></span>
<span data-ttu-id="ad907-121">Créez une machine virtuelle de système d’exploitation Linux pour recevoir toutes les données Syslog des hôtes ESXi.</span><span class="sxs-lookup"><span data-stu-id="ad907-121">Create a Linux operating system VM to receive all syslog data from the ESXi hosts.</span></span> <span data-ttu-id="ad907-122">L’[Agent OMS Linux](log-analytics-linux-agents.md) est le point de regroupement de toutes les données syslog de l’hôte ESXi.</span><span class="sxs-lookup"><span data-stu-id="ad907-122">The [OMS Linux Agent](log-analytics-linux-agents.md) is the collection point for all ESXi host syslog data.</span></span> <span data-ttu-id="ad907-123">Vous pouvez utiliser plusieurs hôtes ESXi pour transférer des journaux à un seul serveur Linux, comme dans l’exemple suivant.</span><span class="sxs-lookup"><span data-stu-id="ad907-123">You can use multiple ESXi hosts to forward logs to a single Linux server, as in the following example.</span></span>  

   ![Flux Syslog](./media/log-analytics-vmware/diagram.png)

### <a name="configure-syslog-collection"></a><span data-ttu-id="ad907-125">Configurer la collecte Syslog</span><span class="sxs-lookup"><span data-stu-id="ad907-125">Configure syslog collection</span></span>
1. <span data-ttu-id="ad907-126">Configurez le transfert de Syslog à VSphere.</span><span class="sxs-lookup"><span data-stu-id="ad907-126">Set up syslog forwarding for VSphere.</span></span> <span data-ttu-id="ad907-127">Pour plus d’informations sur la configuration du transfert de Syslog, voir [Configuration de Syslog sur ESXi 5.x et 6.0 (2003322)](https://kb.vmware.com/selfservice/microsites/search.do?language=en_US&cmd=displayKC&externalId=2003322).</span><span class="sxs-lookup"><span data-stu-id="ad907-127">For detailed information to help set up syslog forwarding, see [Configuring syslog on ESXi 5.x and 6.0 (2003322)](https://kb.vmware.com/selfservice/microsites/search.do?language=en_US&cmd=displayKC&externalId=2003322).</span></span> <span data-ttu-id="ad907-128">Accédez à **Configuration de l’hôte ESXi** > **Logiciel** > **Paramètres avancés** > **Syslog**.</span><span class="sxs-lookup"><span data-stu-id="ad907-128">Go to **ESXi Host Configuration** > **Software** > **Advanced Settings** > **Syslog**.</span></span>
   <span data-ttu-id="ad907-129">![vsphereconfig](./media/log-analytics-vmware/vsphere1.png)</span><span class="sxs-lookup"><span data-stu-id="ad907-129">![vsphereconfig](./media/log-analytics-vmware/vsphere1.png)</span></span>  
2. <span data-ttu-id="ad907-130">Dans le champ *Syslog.global.logHost*, ajoutez votre serveur Linux et le numéro de port *1514*.</span><span class="sxs-lookup"><span data-stu-id="ad907-130">In the *Syslog.global.logHost* field, add your Linux server and the port number *1514*.</span></span> <span data-ttu-id="ad907-131">Par exemple, `tcp://hostname:1514` ou `tcp://123.456.789.101:1514`.</span><span class="sxs-lookup"><span data-stu-id="ad907-131">For example, `tcp://hostname:1514` or `tcp://123.456.789.101:1514`</span></span>
3. <span data-ttu-id="ad907-132">Ouvrez le pare-feu d’hôte ESXi pour Syslog.</span><span class="sxs-lookup"><span data-stu-id="ad907-132">Open the ESXi host firewall for syslog.</span></span> <span data-ttu-id="ad907-133">**Configuration de l’hôte ESXi** > **Logiciels** > **Profil de sécurité** > **Pare-feu**, puis ouvrez **Propriétés**.</span><span class="sxs-lookup"><span data-stu-id="ad907-133">**ESXi Host Configuration** > **Software** > **Security Profile** > **Firewall** and open **Properties**.</span></span>  

    ![vspherefw](./media/log-analytics-vmware/vsphere2.png)  

    ![vspherefwproperties](./media/log-analytics-vmware/vsphere3.png)  
4. <span data-ttu-id="ad907-136">Vérifiez sur la Console vSphere que ce Syslog est correctement configuré.</span><span class="sxs-lookup"><span data-stu-id="ad907-136">Check the vSphere Console to verify that that syslog is properly set up.</span></span> <span data-ttu-id="ad907-137">Vérifiez sur l’hôte ESXI que le port **1514** est configuré.</span><span class="sxs-lookup"><span data-stu-id="ad907-137">Confirm on the ESXI host that port **1514** is configured.</span></span>
5. <span data-ttu-id="ad907-138">Téléchargez et installez l’Agent OMS pour Linux sur le serveur Linux.</span><span class="sxs-lookup"><span data-stu-id="ad907-138">Download and install the OMS Agent for Linux on the Linux server.</span></span> <span data-ttu-id="ad907-139">Pour plus d’informations, consultez la [documentation de l’Agent OMS pour Linux](https://github.com/Microsoft/OMS-Agent-for-Linux).</span><span class="sxs-lookup"><span data-stu-id="ad907-139">For more information, see the [Documentation for OMS Agent for Linux](https://github.com/Microsoft/OMS-Agent-for-Linux).</span></span>
6. <span data-ttu-id="ad907-140">Une fois l’Agent OMS pour Linux installé, accédez au répertoire /etc/opt/microsoft/omsagent/sysconf/omsagent.d, copiez le fichier vmware_esxi.conf vers le répertoire /etc/opt/microsoft/omsagent/conf/omsagent.d, puis modifiez le propriétaire/groupe et les autorisations du fichier.</span><span class="sxs-lookup"><span data-stu-id="ad907-140">After the OMS Agent for Linux is installed, go to the  /etc/opt/microsoft/omsagent/sysconf/omsagent.d directory and copy the vmware_esxi.conf file to the /etc/opt/microsoft/omsagent/conf/omsagent.d directory and the change the owner/group and permissions of the file.</span></span> <span data-ttu-id="ad907-141">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="ad907-141">For example:</span></span>

    ```
    sudo cp /etc/opt/microsoft/omsagent/sysconf/omsagent.d/vmware_esxi.conf /etc/opt/microsoft/omsagent/conf/omsagent.d
   sudo chown omsagent:omiusers /etc/opt/microsoft/omsagent/conf/omsagent.d/vmware_esxi.conf
    ```
7. <span data-ttu-id="ad907-142">Redémarrez l’Agent OMS pour Linux en exécutant `sudo /opt/microsoft/omsagent/bin/service_control restart`.</span><span class="sxs-lookup"><span data-stu-id="ad907-142">Restart the OMS Agent for Linux by running `sudo /opt/microsoft/omsagent/bin/service_control restart`.</span></span>
8. <span data-ttu-id="ad907-143">Testez la connectivité entre le serveur Linux et de l’hôte ESXi en utilisant la commande `nc`sur l’hôte ESXi.</span><span class="sxs-lookup"><span data-stu-id="ad907-143">Test the connectivity between the Linux server and the ESXi host by using the `nc` command on the ESXi Host.</span></span> <span data-ttu-id="ad907-144">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="ad907-144">For example:</span></span>

    ```
    [root@ESXiHost:~] nc -z 123.456.789.101 1514
    Connection to 123.456.789.101 1514 port [tcp/*] succeeded!
    ```

9. <span data-ttu-id="ad907-145">Dans le portail OMS, effectuer une recherche de journal pour `Type=VMware_CL`.</span><span class="sxs-lookup"><span data-stu-id="ad907-145">In the OMS Portal, perform a log search for `Type=VMware_CL`.</span></span> <span data-ttu-id="ad907-146">Quand OMS collecte les données Syslog, il conserve le format Syslog.</span><span class="sxs-lookup"><span data-stu-id="ad907-146">When OMS collects the syslog data, it retains the syslog format.</span></span> <span data-ttu-id="ad907-147">Dans le portail, certains des champs sont capturés, tel que *Hostname* et *ProcessName*.</span><span class="sxs-lookup"><span data-stu-id="ad907-147">In the portal, some specific fields are captured, such as *Hostname* and *ProcessName*.</span></span>  

    ![type](./media/log-analytics-vmware/type.png)  

    <span data-ttu-id="ad907-149">Si vos résultats de recherche de vue de journal sont similaires à l’image ci-dessus, vous êtes prêt à utiliser le tableau de bord de la solution OMS Analyse VMware.</span><span class="sxs-lookup"><span data-stu-id="ad907-149">If your view log search results are similar to the image above, you're set to use the OMS VMware Monitoring solution dashboard.</span></span>  

## <a name="vmware-data-collection-details"></a><span data-ttu-id="ad907-150">Détails sur la collecte de données Linux</span><span class="sxs-lookup"><span data-stu-id="ad907-150">VMware data collection details</span></span>
<span data-ttu-id="ad907-151">La solution Analyse VMware collecte diverses mesures de performances et données de journaux à partir des hôtes ESXi à l’aide des Agents OMS pour Linux que vous avez activés.</span><span class="sxs-lookup"><span data-stu-id="ad907-151">The VMware Monitoring solution collects various performance metrics and log data from ESXi hosts using the OMS Agents for Linux that you have enabled.</span></span>

<span data-ttu-id="ad907-152">Le tableau suivant présente les méthodes de collecte des données et d’autres informations sur le mode de collecte.</span><span class="sxs-lookup"><span data-stu-id="ad907-152">The following table shows data collection methods and other details about how data is collected.</span></span>

| <span data-ttu-id="ad907-153">plateforme</span><span class="sxs-lookup"><span data-stu-id="ad907-153">platform</span></span> | <span data-ttu-id="ad907-154">Agent OMS pour Linux</span><span class="sxs-lookup"><span data-stu-id="ad907-154">OMS Agent for Linux</span></span> | <span data-ttu-id="ad907-155">Agent SCOM</span><span class="sxs-lookup"><span data-stu-id="ad907-155">SCOM agent</span></span> | <span data-ttu-id="ad907-156">Stockage Azure</span><span class="sxs-lookup"><span data-stu-id="ad907-156">Azure Storage</span></span> | <span data-ttu-id="ad907-157">SCOM requis ?</span><span class="sxs-lookup"><span data-stu-id="ad907-157">SCOM required?</span></span> | <span data-ttu-id="ad907-158">Données de l’agent SCOM envoyées via un groupe d’administration</span><span class="sxs-lookup"><span data-stu-id="ad907-158">SCOM agent data sent via management group</span></span> | <span data-ttu-id="ad907-159">fréquence de collecte</span><span class="sxs-lookup"><span data-stu-id="ad907-159">collection frequency</span></span> |
| --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="ad907-160">Linux</span><span class="sxs-lookup"><span data-stu-id="ad907-160">Linux</span></span> |<span data-ttu-id="ad907-161">&#8226;</span><span class="sxs-lookup"><span data-stu-id="ad907-161">&#8226;</span></span> |  |  |  |  |<span data-ttu-id="ad907-162">Toutes les 3 minutes.</span><span class="sxs-lookup"><span data-stu-id="ad907-162">every 3 minutes</span></span> |

<span data-ttu-id="ad907-163">Le tableau suivant affiche des exemples de champs de données collectés par la solution Analyse VMware :</span><span class="sxs-lookup"><span data-stu-id="ad907-163">The following table show examples of data fields collected by the VMware Monitoring solution:</span></span>

| <span data-ttu-id="ad907-164">Nom du champ</span><span class="sxs-lookup"><span data-stu-id="ad907-164">field name</span></span> | <span data-ttu-id="ad907-165">Description</span><span class="sxs-lookup"><span data-stu-id="ad907-165">description</span></span> |
| --- | --- |
| <span data-ttu-id="ad907-166">Device_s</span><span class="sxs-lookup"><span data-stu-id="ad907-166">Device_s</span></span> |<span data-ttu-id="ad907-167">appareils de stockage VMware</span><span class="sxs-lookup"><span data-stu-id="ad907-167">VMware storage devices</span></span> |
| <span data-ttu-id="ad907-168">ESXIFailure_s</span><span class="sxs-lookup"><span data-stu-id="ad907-168">ESXIFailure_s</span></span> |<span data-ttu-id="ad907-169">types d’échec</span><span class="sxs-lookup"><span data-stu-id="ad907-169">failure types</span></span> |
| <span data-ttu-id="ad907-170">EventTime_t</span><span class="sxs-lookup"><span data-stu-id="ad907-170">EventTime_t</span></span> |<span data-ttu-id="ad907-171">heure à laquelle l’événement s’est produit</span><span class="sxs-lookup"><span data-stu-id="ad907-171">time when event occurred</span></span> |
| <span data-ttu-id="ad907-172">HostName_s</span><span class="sxs-lookup"><span data-stu-id="ad907-172">HostName_s</span></span> |<span data-ttu-id="ad907-173">nom d’hôte ESXi</span><span class="sxs-lookup"><span data-stu-id="ad907-173">ESXi host name</span></span> |
| <span data-ttu-id="ad907-174">Operation_s</span><span class="sxs-lookup"><span data-stu-id="ad907-174">Operation_s</span></span> |<span data-ttu-id="ad907-175">créer ou supprimer une machine virtuelle</span><span class="sxs-lookup"><span data-stu-id="ad907-175">create VM or delete VM</span></span> |
| <span data-ttu-id="ad907-176">ProcessName_s</span><span class="sxs-lookup"><span data-stu-id="ad907-176">ProcessName_s</span></span> |<span data-ttu-id="ad907-177">nom de l’événement</span><span class="sxs-lookup"><span data-stu-id="ad907-177">event name</span></span> |
| <span data-ttu-id="ad907-178">ResourceId_s</span><span class="sxs-lookup"><span data-stu-id="ad907-178">ResourceId_s</span></span> |<span data-ttu-id="ad907-179">nom de l’hôte VMware</span><span class="sxs-lookup"><span data-stu-id="ad907-179">name of the VMware host</span></span> |
| <span data-ttu-id="ad907-180">ResourceLocation_s</span><span class="sxs-lookup"><span data-stu-id="ad907-180">ResourceLocation_s</span></span> |<span data-ttu-id="ad907-181">VMware</span><span class="sxs-lookup"><span data-stu-id="ad907-181">VMware</span></span> |
| <span data-ttu-id="ad907-182">ResourceName_s</span><span class="sxs-lookup"><span data-stu-id="ad907-182">ResourceName_s</span></span> |<span data-ttu-id="ad907-183">VMware</span><span class="sxs-lookup"><span data-stu-id="ad907-183">VMware</span></span> |
| <span data-ttu-id="ad907-184">ResourceType_s</span><span class="sxs-lookup"><span data-stu-id="ad907-184">ResourceType_s</span></span> |<span data-ttu-id="ad907-185">Hyper-V</span><span class="sxs-lookup"><span data-stu-id="ad907-185">Hyper-V</span></span> |
| <span data-ttu-id="ad907-186">SCSIStatus_s</span><span class="sxs-lookup"><span data-stu-id="ad907-186">SCSIStatus_s</span></span> |<span data-ttu-id="ad907-187">Statut SCSI de VMware</span><span class="sxs-lookup"><span data-stu-id="ad907-187">VMware SCSI status</span></span> |
| <span data-ttu-id="ad907-188">SyslogMessage_s</span><span class="sxs-lookup"><span data-stu-id="ad907-188">SyslogMessage_s</span></span> |<span data-ttu-id="ad907-189">données Syslog</span><span class="sxs-lookup"><span data-stu-id="ad907-189">Syslog data</span></span> |
| <span data-ttu-id="ad907-190">UserName_s</span><span class="sxs-lookup"><span data-stu-id="ad907-190">UserName_s</span></span> |<span data-ttu-id="ad907-191">utilisateur qui a créé ou supprimé la machine virtuelle</span><span class="sxs-lookup"><span data-stu-id="ad907-191">user who created or deleted VM</span></span> |
| <span data-ttu-id="ad907-192">VMName_s</span><span class="sxs-lookup"><span data-stu-id="ad907-192">VMName_s</span></span> |<span data-ttu-id="ad907-193">nom de la machine virtuelle</span><span class="sxs-lookup"><span data-stu-id="ad907-193">VM name</span></span> |
| <span data-ttu-id="ad907-194">Ordinateur</span><span class="sxs-lookup"><span data-stu-id="ad907-194">Computer</span></span> |<span data-ttu-id="ad907-195">ordinateur hôte</span><span class="sxs-lookup"><span data-stu-id="ad907-195">host computer</span></span> |
| <span data-ttu-id="ad907-196">TimeGenerated</span><span class="sxs-lookup"><span data-stu-id="ad907-196">TimeGenerated</span></span> |<span data-ttu-id="ad907-197">heure à laquelle les données ont été générées</span><span class="sxs-lookup"><span data-stu-id="ad907-197">time the data was generated</span></span> |
| <span data-ttu-id="ad907-198">DataCenter_s</span><span class="sxs-lookup"><span data-stu-id="ad907-198">DataCenter_s</span></span> |<span data-ttu-id="ad907-199">centre de données VMware</span><span class="sxs-lookup"><span data-stu-id="ad907-199">VMware datacenter</span></span> |
| <span data-ttu-id="ad907-200">StorageLatency_s</span><span class="sxs-lookup"><span data-stu-id="ad907-200">StorageLatency_s</span></span> |<span data-ttu-id="ad907-201">latence de stockage (ms)</span><span class="sxs-lookup"><span data-stu-id="ad907-201">storage latency (ms)</span></span> |

## <a name="vmware-monitoring-solution-overview"></a><span data-ttu-id="ad907-202">Présentation de la solution Analyse VMware</span><span class="sxs-lookup"><span data-stu-id="ad907-202">VMware Monitoring solution overview</span></span>
<span data-ttu-id="ad907-203">La vignette VMware apparaît dans le portail OMS.</span><span class="sxs-lookup"><span data-stu-id="ad907-203">The VMware tile appears in the OMS portal.</span></span> <span data-ttu-id="ad907-204">Elle fournit une vue d’ensemble des erreurs.</span><span class="sxs-lookup"><span data-stu-id="ad907-204">It provides a high-level view of any failures.</span></span> <span data-ttu-id="ad907-205">Lorsque vous cliquez sur la vignette, vous accédez à l’affichage du tableau de bord.</span><span class="sxs-lookup"><span data-stu-id="ad907-205">When you click the tile, you go into a dashboard view.</span></span>

![vignette](./media/log-analytics-vmware/tile.png)

#### <a name="navigate-the-dashboard-view"></a><span data-ttu-id="ad907-207">Accédez à l’affichage du tableau de bord</span><span class="sxs-lookup"><span data-stu-id="ad907-207">Navigate the dashboard view</span></span>
<span data-ttu-id="ad907-208">Dans l’affichage du tableau de bord **VMware**, les panneaux sont organisés par :</span><span class="sxs-lookup"><span data-stu-id="ad907-208">In the **VMware** dashboard view, blades are organized by:</span></span>

* <span data-ttu-id="ad907-209">Nombre d’états d’échec</span><span class="sxs-lookup"><span data-stu-id="ad907-209">Failure Status Count</span></span>
* <span data-ttu-id="ad907-210">Hôte principal par nombre d’événements</span><span class="sxs-lookup"><span data-stu-id="ad907-210">Top Host by Event Counts</span></span>
* <span data-ttu-id="ad907-211">Nombres d’événements principaux</span><span class="sxs-lookup"><span data-stu-id="ad907-211">Top Event Counts</span></span>
* <span data-ttu-id="ad907-212">Activités de machine virtuelle</span><span class="sxs-lookup"><span data-stu-id="ad907-212">Virtual Machine Activities</span></span>
* <span data-ttu-id="ad907-213">Événements de disque de l’hôte ESXi</span><span class="sxs-lookup"><span data-stu-id="ad907-213">ESXi Host Disk Events</span></span>

![solution1](./media/log-analytics-vmware/solutionview1-1.png)

![solution2](./media/log-analytics-vmware/solutionview1-2.png)

<span data-ttu-id="ad907-216">Cliquez sur n’importe quel panneau pour ouvrir le volet de recherche de Log Analytics qui affiche des informations détaillées spécifiques pour le panneau.</span><span class="sxs-lookup"><span data-stu-id="ad907-216">Click any blade to open Log Analytics search pane that shows detailed information specific for the blade.</span></span>

<span data-ttu-id="ad907-217">À partir d’ici, vous pouvez modifier la requête de recherche pour l’adapter à un aspect spécifique.</span><span class="sxs-lookup"><span data-stu-id="ad907-217">From here, you can edit the search query to modify it for something specific.</span></span> <span data-ttu-id="ad907-218">Pour un didacticiel relatifs aux principes de base de recherche OMS, voir le [didacticiel de recherche de journal OMS](log-analytics-log-searches.md).</span><span class="sxs-lookup"><span data-stu-id="ad907-218">For a tutorial on the basics of OMS search, check out the [OMS log search tutorial.](log-analytics-log-searches.md)</span></span>

#### <a name="find-esxi-host-events"></a><span data-ttu-id="ad907-219">Rechercher des événements de l’hôte ESXi</span><span class="sxs-lookup"><span data-stu-id="ad907-219">Find ESXi host events</span></span>
<span data-ttu-id="ad907-220">Un seul hôte ESXi génère plusieurs journaux basés sur leurs processus.</span><span class="sxs-lookup"><span data-stu-id="ad907-220">A single ESXi host generates multiple logs, based on their processes.</span></span> <span data-ttu-id="ad907-221">La solution Analyse VMware les centralise et résume les nombres d’événements.</span><span class="sxs-lookup"><span data-stu-id="ad907-221">The VMware Monitoring solution centralizes them and summarizes the event counts.</span></span> <span data-ttu-id="ad907-222">Cette vue centralisée vous permet de comprendre quel hôte ESXi a un volume élevé d’événements ainsi que les événements qui se produisent le plus fréquemment dans votre environnement.</span><span class="sxs-lookup"><span data-stu-id="ad907-222">This centralized view helps you understand which ESXi host has a high volume of events and what events occur most frequently in your environment.</span></span>

![événement](./media/log-analytics-vmware/events.png)

<span data-ttu-id="ad907-224">Vous pouvez approfondir davantage en cliquant sur un hôte ESXi ou un type d’événement.</span><span class="sxs-lookup"><span data-stu-id="ad907-224">You can drill further by clicking an ESXi host or an event type.</span></span>

<span data-ttu-id="ad907-225">Lorsque vous cliquez sur un nom d’hôte ESXi, vous voyez les informations de cet hôte ESXi.</span><span class="sxs-lookup"><span data-stu-id="ad907-225">When you click an ESXi host name, you view information from that ESXi host.</span></span> <span data-ttu-id="ad907-226">Si vous souhaitez affiner des résultats avec le type d’événement, ajoutez `“ProcessName_s=EVENT TYPE”` à votre requête de recherche.</span><span class="sxs-lookup"><span data-stu-id="ad907-226">If you want to narrow results with the event type, add `“ProcessName_s=EVENT TYPE”` in your search query.</span></span> <span data-ttu-id="ad907-227">Vous pouvez sélectionner **ProcessName** dans le filtre de recherche.</span><span class="sxs-lookup"><span data-stu-id="ad907-227">You can select **ProcessName** in the search filter.</span></span> <span data-ttu-id="ad907-228">Cela restreint les informations pour vous.</span><span class="sxs-lookup"><span data-stu-id="ad907-228">That narrows the information for you.</span></span>

![explorer](./media/log-analytics-vmware/eventhostdrilldown.png)

#### <a name="find-high-vm-activities"></a><span data-ttu-id="ad907-230">Rechercher les activités de machine virtuelle élevées</span><span class="sxs-lookup"><span data-stu-id="ad907-230">Find high VM activities</span></span>
<span data-ttu-id="ad907-231">Une machine virtuelle peut être créée et supprimée sur tout hôte ESXi.</span><span class="sxs-lookup"><span data-stu-id="ad907-231">A virtual machine can be created and deleted on any ESXi host.</span></span> <span data-ttu-id="ad907-232">Il est utile pour un administrateur d’identifier le nombre de machines virtuelles que crée un hôte ESXi.</span><span class="sxs-lookup"><span data-stu-id="ad907-232">It's helpful for an administrator to identify how many VMs an ESXi host creates.</span></span> <span data-ttu-id="ad907-233">Cela aide ensuite à comprendre la planification des performances et de la capacité.</span><span class="sxs-lookup"><span data-stu-id="ad907-233">That in-turn, helps to understand performance and capacity planning.</span></span> <span data-ttu-id="ad907-234">Il est essentiel de suivre les événements d’activité de machine virtuelle lors de la gestion de votre environnement.</span><span class="sxs-lookup"><span data-stu-id="ad907-234">Keeping track of VM activity events is crucial when managing your environment.</span></span>

![explorer](./media/log-analytics-vmware/vmactivities1.png)

<span data-ttu-id="ad907-236">Si vous souhaitez voir d’autres données de création de machine virtuelle hôte ESXi, cliquez sur un nom d’hôte ESXi.</span><span class="sxs-lookup"><span data-stu-id="ad907-236">If you want to see additional ESXi host VM creation data, click an ESXi host name.</span></span>

![explorer](./media/log-analytics-vmware/createvm.png)

#### <a name="common-search-queries"></a><span data-ttu-id="ad907-238">Requêtes de recherche courantes</span><span class="sxs-lookup"><span data-stu-id="ad907-238">Common search queries</span></span>
<span data-ttu-id="ad907-239">La solution inclut d’autres requêtes utiles qui peuvent vous aider à gérer vos hôtes ESXi, telles que l’espace de stockage élevé, la latence du stockage et la défaillance de chemin.</span><span class="sxs-lookup"><span data-stu-id="ad907-239">The solution includes other useful queries that can help you manage your ESXi hosts, such as high storage space, storage latency, and path failure.</span></span>

[!include[log-analytics-log-search-nextgeneration](../../includes/log-analytics-log-search-nextgeneration.md)]

![requêtes](./media/log-analytics-vmware/queries.png)


#### <a name="save-queries"></a><span data-ttu-id="ad907-241">Enregistrer des requêtes</span><span class="sxs-lookup"><span data-stu-id="ad907-241">Save queries</span></span>
<span data-ttu-id="ad907-242">L’enregistrement des requêtes de recherche est une fonctionnalité standard dans OMS, qui peut vous aider à conserver toutes les requêtes que vous avez trouvées utiles.</span><span class="sxs-lookup"><span data-stu-id="ad907-242">Saving search queries is a standard feature in OMS and can help you keep any queries that you’ve found useful.</span></span> <span data-ttu-id="ad907-243">Après avoir créé une requête que vous trouvez utile, enregistrez-la en cliquant sur **Favorites**.</span><span class="sxs-lookup"><span data-stu-id="ad907-243">After you create a query that you find useful, save it by clicking the **Favorites**.</span></span> <span data-ttu-id="ad907-244">Vous pouvez réutiliser facilement une requête enregistrée à partir de la page [Mon tableau de bord](log-analytics-dashboards.md) dans laquelle vous pouvez créer vos propres tableaux de bord personnalisés.</span><span class="sxs-lookup"><span data-stu-id="ad907-244">A saved query lets you easily reuse it later from the [My Dashboard](log-analytics-dashboards.md) page where you can create your own custom dashboards.</span></span>

![DockerDashboardView](./media/log-analytics-vmware/dockerdashboardview.png)

#### <a name="create-alerts-from-queries"></a><span data-ttu-id="ad907-246">Créer des alertes à partir de requêtes</span><span class="sxs-lookup"><span data-stu-id="ad907-246">Create alerts from queries</span></span>
<span data-ttu-id="ad907-247">Après avoir créé vos requêtes, vous pouvez les utiliser pour vous avertir quand des événements spécifiques se produisent.</span><span class="sxs-lookup"><span data-stu-id="ad907-247">After you’ve created your queries, you might want to use the queries to alert you when specific events occur.</span></span> <span data-ttu-id="ad907-248">Pour plus d’informations sur la création d’alertes, voir [Alertes dans Log Analytics](log-analytics-alerts.md).</span><span class="sxs-lookup"><span data-stu-id="ad907-248">See [Alerts in Log Analytics](log-analytics-alerts.md) for information about how to create alerts.</span></span> <span data-ttu-id="ad907-249">Pour obtenir des exemples de requêtes d’alerte et d’autres requêtes, voir le billet de blog [Monitor VMware using OMS Log Analytics](https://blogs.technet.microsoft.com/msoms/2016/06/15/monitor-vmware-using-oms-log-analytics) (Analyser VMware à l’aide d’OMS Log Analytics).</span><span class="sxs-lookup"><span data-stu-id="ad907-249">For examples of alerting queries and other query examples, see the [Monitor VMware using OMS Log Analytics](https://blogs.technet.microsoft.com/msoms/2016/06/15/monitor-vmware-using-oms-log-analytics) blog post.</span></span>

## <a name="frequently-asked-questions"></a><span data-ttu-id="ad907-250">Forum Aux Questions</span><span class="sxs-lookup"><span data-stu-id="ad907-250">Frequently asked questions</span></span>
### <a name="what-do-i-need-to-do-on-the-esxi-host-setting-what-impact-will-it-have-on-my-current-environment"></a><span data-ttu-id="ad907-251">Que dois-je faire avec les paramètres d’hôte ESXi ?</span><span class="sxs-lookup"><span data-stu-id="ad907-251">What do I need to do on the ESXi host setting?</span></span> <span data-ttu-id="ad907-252">Quel sera l’impact sur mon environnement actuel ?</span><span class="sxs-lookup"><span data-stu-id="ad907-252">What impact will it have on my current environment?</span></span>
<span data-ttu-id="ad907-253">La solution utilise le mécanisme de transfert syslog natif de l’hôte ESXi.</span><span class="sxs-lookup"><span data-stu-id="ad907-253">The solution uses the native ESXi Host Syslog forwarding mechanism.</span></span> <span data-ttu-id="ad907-254">Vous n’avez pas besoin d’autres logiciels Microsoft sur l’hôte ESXi pour capturer les journaux.</span><span class="sxs-lookup"><span data-stu-id="ad907-254">You don't need any additional Microsoft software on the ESXi Host to capture the logs.</span></span> <span data-ttu-id="ad907-255">L’impact sur votre environnement existant devrait être faible.</span><span class="sxs-lookup"><span data-stu-id="ad907-255">It should have a low impact to your existing environment.</span></span> <span data-ttu-id="ad907-256">Toutefois, vous devez absolument définir le transfert syslog, une fonctionnalité d’ESXI.</span><span class="sxs-lookup"><span data-stu-id="ad907-256">However, you do need to set syslog forwarding, which is ESXI functionality.</span></span>

### <a name="do-i-need-to-restart-my-esxi-host"></a><span data-ttu-id="ad907-257">Dois-je redémarrer mon hôte ESXi ?</span><span class="sxs-lookup"><span data-stu-id="ad907-257">Do I need to restart my ESXi host?</span></span>
<span data-ttu-id="ad907-258">Non.</span><span class="sxs-lookup"><span data-stu-id="ad907-258">No.</span></span> <span data-ttu-id="ad907-259">Ce processus ne nécessite pas de redémarrage.</span><span class="sxs-lookup"><span data-stu-id="ad907-259">This process does not require a restart.</span></span> <span data-ttu-id="ad907-260">Parfois, vSphere n’actualise pas correctement syslog.</span><span class="sxs-lookup"><span data-stu-id="ad907-260">Sometimes, vSphere does not properly update the syslog.</span></span> <span data-ttu-id="ad907-261">Dans ce cas, ouvrez une session sur l’hôte ESXi et rechargez le journal système.</span><span class="sxs-lookup"><span data-stu-id="ad907-261">In such a case, log on to the ESXi host and reload the syslog.</span></span> <span data-ttu-id="ad907-262">Encore une fois, il n’est pas obligatoire de redémarrer l’hôte. Ainsi, ce processus ne perturbe pas votre environnement.</span><span class="sxs-lookup"><span data-stu-id="ad907-262">Again, you don't have to restart the host, so this process isn't disruptive to your environment.</span></span>

### <a name="can-i-increase-or-decrease-the-volume-of-log-data-sent-to-oms"></a><span data-ttu-id="ad907-263">Puis-je augmenter ou diminuer le volume de données de journal envoyé à OMS ?</span><span class="sxs-lookup"><span data-stu-id="ad907-263">Can I increase or decrease the volume of log data sent to OMS?</span></span>
<span data-ttu-id="ad907-264">Oui, vous pouvez.</span><span class="sxs-lookup"><span data-stu-id="ad907-264">Yes you can.</span></span> <span data-ttu-id="ad907-265">Vous pouvez utiliser les paramètres de niveau de journal hôte ESXi dans vSphere.</span><span class="sxs-lookup"><span data-stu-id="ad907-265">You can use the ESXi Host Log Level settings in vSphere.</span></span> <span data-ttu-id="ad907-266">La collecte des journaux est basée sur le niveau *info*.</span><span class="sxs-lookup"><span data-stu-id="ad907-266">Log collection is based on the *info* level.</span></span> <span data-ttu-id="ad907-267">Ainsi, si vous souhaitez vérifier la création ou la suppression de machines virtuelles, vous devez conserver le niveau *info* sur Hostd.</span><span class="sxs-lookup"><span data-stu-id="ad907-267">So, if you want to audit VM creation or deletion, you need to keep the *info* level on Hostd.</span></span> <span data-ttu-id="ad907-268">Pour plus d’informations, consultez la [Base de connaissances VMware](https://kb.vmware.com/selfservice/microsites/search.do?&cmd=displayKC&externalId=1017658).</span><span class="sxs-lookup"><span data-stu-id="ad907-268">For more information, see the [VMware Knowledge Base](https://kb.vmware.com/selfservice/microsites/search.do?&cmd=displayKC&externalId=1017658).</span></span>

### <a name="why-is-hostd-not-providing-data-to-oms-my-log-setting-is-set-to-info"></a><span data-ttu-id="ad907-269">Pourquoi Hostd ne fournit-il pas de données à OMS ?</span><span class="sxs-lookup"><span data-stu-id="ad907-269">Why is Hostd not providing data to OMS?</span></span> <span data-ttu-id="ad907-270">Mon journal est défini sur info.</span><span class="sxs-lookup"><span data-stu-id="ad907-270">My log setting is set to info.</span></span>
<span data-ttu-id="ad907-271">Il y a un problème avec l’hôte ESXi pour l’horodatage de syslog.</span><span class="sxs-lookup"><span data-stu-id="ad907-271">There was an ESXi host bug for the syslog timestamp.</span></span> <span data-ttu-id="ad907-272">Pour plus d’informations, consultez la [Base de connaissances VMware](https://kb.vmware.com/selfservice/microsites/search.do?language=en_US&cmd=displayKC&externalId=2111202).</span><span class="sxs-lookup"><span data-stu-id="ad907-272">For more information, see the [VMware Knowledge Base](https://kb.vmware.com/selfservice/microsites/search.do?language=en_US&cmd=displayKC&externalId=2111202).</span></span> <span data-ttu-id="ad907-273">Après avoir appliqué la solution de contournement, Hostd devrait fonctionner normalement.</span><span class="sxs-lookup"><span data-stu-id="ad907-273">After you apply the workaround, Hostd should function normally.</span></span>

### <a name="can-i-have-multiple-esxi-hosts-forwarding-syslog-data-to-a-single-vm-with-omsagent"></a><span data-ttu-id="ad907-274">Est-il possible que plusieurs hôtes ESXi transfèrent les données de syslog vers une seule machine virtuelle avec omsagent ?</span><span class="sxs-lookup"><span data-stu-id="ad907-274">Can I have multiple ESXi hosts forwarding syslog data to a single VM with omsagent?</span></span>
<span data-ttu-id="ad907-275">Oui.</span><span class="sxs-lookup"><span data-stu-id="ad907-275">Yes.</span></span> <span data-ttu-id="ad907-276">Plusieurs hôtes ESXi peuvent transférer des données vers une seule machine virtuelle avec omsagent.</span><span class="sxs-lookup"><span data-stu-id="ad907-276">You can have multiple ESXi hosts forwarding to a single VM with omsagent.</span></span>

### <a name="why-dont-i-see-data-flowing-into-oms"></a><span data-ttu-id="ad907-277">Pourquoi ne puis-je pas voir les données échangées avec OMS ?</span><span class="sxs-lookup"><span data-stu-id="ad907-277">Why don't I see data flowing into OMS?</span></span>
<span data-ttu-id="ad907-278">Il peut y avoir plusieurs raisons :</span><span class="sxs-lookup"><span data-stu-id="ad907-278">There can be multiple reasons:</span></span>

* <span data-ttu-id="ad907-279">L’hôte ESXi ne transmet pas correctement les données vers la machine virtuelle qui exécute omsagent.</span><span class="sxs-lookup"><span data-stu-id="ad907-279">The ESXi host is not correctly pushing data to the VM running omsagent.</span></span> <span data-ttu-id="ad907-280">Pour tester cela, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="ad907-280">To test, perform the following steps:</span></span>

  1. <span data-ttu-id="ad907-281">Pour vérifier cela, ouvrez une session sur l’hôte ESXi à l’aide de ssh et exécutez la commande suivante : `nc -z ipaddressofVM 1514`</span><span class="sxs-lookup"><span data-stu-id="ad907-281">To confirm, log on to the ESXi host using ssh and run the following command: `nc -z ipaddressofVM 1514`</span></span>

      <span data-ttu-id="ad907-282">Si cela n’a pas réussi, les paramètres de vSphere dans la Configuration avancée ne sont probablement pas corrects.</span><span class="sxs-lookup"><span data-stu-id="ad907-282">If this is not successful, vSphere settings in the Advanced Configuration are likely not correct.</span></span> <span data-ttu-id="ad907-283">Consultez [Configurer la collecte Syslog](#configure-syslog-collection) pour plus d’informations sur la configuration de l’hôte ESXi pour le transfert de syslog.</span><span class="sxs-lookup"><span data-stu-id="ad907-283">See [Configure syslog collection](#configure-syslog-collection) for information about how to set up the ESXi host for syslog forwarding.</span></span>
  2. <span data-ttu-id="ad907-284">Si la connectivité du port syslog est correcte, mais que vous ne voyez toujours pas de données, rechargez syslog sur l’hôte ESXi à l’aide de ssh pour exécuter la commande suivante : ` esxcli system syslog reload`</span><span class="sxs-lookup"><span data-stu-id="ad907-284">If syslog port connectivity is successful, but you don't still see any data, then reload the syslog on the ESXi host by using ssh to run the following command: ` esxcli system syslog reload`</span></span>
* <span data-ttu-id="ad907-285">La machine virtuelle avec OMS Agent n’est pas configurée correctement.</span><span class="sxs-lookup"><span data-stu-id="ad907-285">The VM with OMS Agent is not set correctly.</span></span> <span data-ttu-id="ad907-286">Pour tester cela, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="ad907-286">To test this, perform the following steps:</span></span>

  1. <span data-ttu-id="ad907-287">OMS écoute sur le port 1514 et transmet les données à OMS.</span><span class="sxs-lookup"><span data-stu-id="ad907-287">OMS listens to the port 1514 and pushes data into OMS.</span></span> <span data-ttu-id="ad907-288">Pour vérifier qu’il est ouvert, utilisez la commande suivante : `netstat -a | grep 1514`</span><span class="sxs-lookup"><span data-stu-id="ad907-288">To verify that it is open, run the following command: `netstat -a | grep 1514`</span></span>
  2. <span data-ttu-id="ad907-289">Vous devez voir le port `1514/tcp` ouvert.</span><span class="sxs-lookup"><span data-stu-id="ad907-289">You should see port `1514/tcp` open.</span></span> <span data-ttu-id="ad907-290">Si ce n’est pas le cas, vérifiez qu’omsagent est correctement installé.</span><span class="sxs-lookup"><span data-stu-id="ad907-290">If you do not, verify that the omsagent is installed correctly.</span></span> <span data-ttu-id="ad907-291">Si vous ne voyez pas les informations de port, le port syslog n’est pas ouvert sur la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="ad907-291">If you do not see the port information, then the syslog port is not open on the VM.</span></span>

     1. <span data-ttu-id="ad907-292">Vérifiez que l’agent OMS s’exécute à l’aide de `ps -ef | grep oms`.</span><span class="sxs-lookup"><span data-stu-id="ad907-292">Verify that the OMS Agent is running by using `ps -ef | grep oms`.</span></span> <span data-ttu-id="ad907-293">S’il n’est pas en cours d’exécution, démarrez le processus en exécutant la commande ` sudo /opt/microsoft/omsagent/bin/service_control start`</span><span class="sxs-lookup"><span data-stu-id="ad907-293">If it is not running, start the process by running the command ` sudo /opt/microsoft/omsagent/bin/service_control start`</span></span>
     2. <span data-ttu-id="ad907-294">Ouvrez le fichier `/etc/opt/microsoft/omsagent/conf/omsagent.d/vmware_esxi.conf` .</span><span class="sxs-lookup"><span data-stu-id="ad907-294">Open the `/etc/opt/microsoft/omsagent/conf/omsagent.d/vmware_esxi.conf` file.</span></span>

         <span data-ttu-id="ad907-295">Vérifiez que les paramètres de groupe et d’utilisateur sont valides, comme dans : `-rw-r--r-- 1 omsagent omiusers 677 Sep 20 16:46 vmware_esxi.conf`</span><span class="sxs-lookup"><span data-stu-id="ad907-295">Verify that the proper user and group setting is valid, similar to: `-rw-r--r-- 1 omsagent omiusers 677 Sep 20 16:46 vmware_esxi.conf`</span></span>

         <span data-ttu-id="ad907-296">Si le fichier n’existe pas ou que les paramètres de groupe et d’utilisateur sont incorrects, prenez une mesure corrective en [Préparant un serveur Linux](#prepare-a-linux-server).</span><span class="sxs-lookup"><span data-stu-id="ad907-296">If the file does not exist or the user and group setting is wrong, take corrective action by [Preparing a Linux server](#prepare-a-linux-server).</span></span>

## <a name="next-steps"></a><span data-ttu-id="ad907-297">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="ad907-297">Next steps</span></span>
* <span data-ttu-id="ad907-298">Utiliser des [recherches de journal](log-analytics-log-searches.md) dans Log Analytics pour afficher des données détaillées de l’hôte VMware.</span><span class="sxs-lookup"><span data-stu-id="ad907-298">Use [Log Searches](log-analytics-log-searches.md) in Log Analytics to view detailed VMware host data.</span></span>
* <span data-ttu-id="ad907-299">[Créer vos propres tableaux de bord](log-analytics-dashboards.md) affichant des données de l’hôte VMware.</span><span class="sxs-lookup"><span data-stu-id="ad907-299">[Create your own dashboards](log-analytics-dashboards.md) showing VMware host data.</span></span>
* <span data-ttu-id="ad907-300">[Créer des alertes](log-analytics-alerts.md) lorsque des événements d’hôte VMware spécifiques se produisent.</span><span class="sxs-lookup"><span data-stu-id="ad907-300">[Create alerts](log-analytics-alerts.md) when specific VMware host events occur.</span></span>
