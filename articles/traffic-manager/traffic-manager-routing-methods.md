---
title: "Azure Traffic Manager - Méthodes de routage du trafic | Microsoft Docs"
description: "Cet article va vous aider à comprendre les différentes méthodes de routage du trafic utilisées par Traffic Manager."
services: traffic-manager
documentationcenter: 
author: KumudD
manager: timlt
editor: 
ms.assetid: db1efbf6-6762-4c7a-ac99-675d4eeb54d0
ms.service: traffic-manager
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 07/13/2017
ms.author: kumud
ms.openlocfilehash: fe776e24a4f78b389c6096694055b38befa3c419
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/03/2017
---
# <a name="traffic-manager-routing-methods"></a><span data-ttu-id="aaa0a-103">Méthodes de routage de Traffic Manager</span><span class="sxs-lookup"><span data-stu-id="aaa0a-103">Traffic Manager routing methods</span></span>

<span data-ttu-id="aaa0a-104">Azure Traffic Manager prend en charge quatre méthodes de routage du trafic pour déterminer comment router le trafic réseau vers les différents points de terminaison de service.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-104">Azure Traffic Manager supports four traffic-routing methods to determine how to route network traffic to the various service endpoints.</span></span> <span data-ttu-id="aaa0a-105">Traffic Manager applique la méthode de routage du trafic à chaque requête DNS qu’il reçoit.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-105">Traffic Manager applies the traffic-routing method to each DNS query it receives.</span></span> <span data-ttu-id="aaa0a-106">La méthode de routage du trafic détermine le point de terminaison retourné dans la réponse DNS.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-106">The traffic-routing method determines which endpoint returned in the DNS response.</span></span>

<span data-ttu-id="aaa0a-107">Quatre méthodes de routage du trafic sont disponibles dans Traffic Manager :</span><span class="sxs-lookup"><span data-stu-id="aaa0a-107">There are four traffic routing methods available in Traffic Manager:</span></span>

* <span data-ttu-id="aaa0a-108">**[Priorité ](#priority):** sélectionnez **Priority** (Priorité) si vous souhaitez utiliser un point de terminaison de service principal pour tout le trafic et disposer de sauvegardes au cas où les points de terminaison principaux ou de sauvegarde ne sont pas disponibles.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-108">**[Priority](#priority):** Select **Priority** when you want to use a primary service endpoint for all traffic, and provide backups in case the primary or the backup endpoints are unavailable.</span></span>
* <span data-ttu-id="aaa0a-109">**[Pondération ](#weighted):** sélectionnez **Weighted** (Pondéré) si vous souhaitez distribuer le trafic entrant sur un ensemble de points de terminaison, soit uniformément, soit en fonction du poids que vous définissez.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-109">**[Weighted](#weighted):** Select **Weighted** when you want to distribute traffic across a set of endpoints, either evenly or according to weights, which you define.</span></span>
* <span data-ttu-id="aaa0a-110">**[Performances ](#performance):** sélectionnez **Performance** quand vos points de terminaison se trouvent sur des emplacements géographiques différents et que vous souhaitez que les utilisateurs finaux utilisent le point de terminaison « le plus proche » en termes de latence réseau la plus faible.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-110">**[Performance](#performance):** Select **Performance** when you have endpoints in different geographic locations and you want end users to use the "closest" endpoint in terms of the lowest network latency.</span></span>
* <span data-ttu-id="aaa0a-111">**[Géographique ](#geographic):** sélectionnez **Geographic** (Géographique) pour diriger les utilisateurs vers des points de terminaison spécifiques (Azure, externes ou imbriqués) selon l’emplacement géographique dont leur requête DNS provient.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-111">**[Geographic](#geographic):** Select **Geographic** so that users are directed to specific endpoints (Azure, External, or Nested) based on which geographic location their DNS query originates from.</span></span> <span data-ttu-id="aaa0a-112">Cette option permet aux clients Traffic Manager de mettre en œuvre des scénarios où il est important de connaître la région géographique des utilisateurs et de router leur trafic en fonction de celle-ci.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-112">This empowers Traffic Manager customers to enable scenarios where knowing a user’s geographic region and routing them based on that is important.</span></span> <span data-ttu-id="aaa0a-113">Exemples : respect des obligations en matière de souveraineté des données, localisation de contenu et d’expérience utilisateur, mesure du trafic en provenance de différentes régions.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-113">Examples include complying with data sovereignty mandates, localization of content & user experience and measuring traffic from different regions.</span></span>

<span data-ttu-id="aaa0a-114">Tous les profils Traffic Manager incluent une surveillance de l’intégrité des points de terminaison et un basculement de point de terminaison automatique.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-114">All Traffic Manager profiles include monitoring of endpoint health and automatic endpoint failover.</span></span> <span data-ttu-id="aaa0a-115">Pour plus d’informations, consultez la rubrique relative à la [surveillance des points de terminaison avec Traffic Manager](traffic-manager-monitoring.md).</span><span class="sxs-lookup"><span data-stu-id="aaa0a-115">For more information, see [Traffic Manager Endpoint Monitoring](traffic-manager-monitoring.md).</span></span> <span data-ttu-id="aaa0a-116">Un profil Traffic Manager donné ne peut utiliser qu’une seule méthode de routage du trafic.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-116">A single Traffic Manager profile can use only one traffic routing method.</span></span> <span data-ttu-id="aaa0a-117">Vous pouvez sélectionner une méthode de routage du trafic différente pour votre profil à tout moment.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-117">You can select a different traffic routing method for your profile at any time.</span></span> <span data-ttu-id="aaa0a-118">Les modifications sont appliquées dans la minute, sans aucun temps d’arrêt.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-118">Changes are applied within one minute, and no downtime is incurred.</span></span> <span data-ttu-id="aaa0a-119">Les méthodes de routage du trafic peuvent être combinées dans des profils Traffic Manager imbriqués.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-119">Traffic-routing methods can be combined by using nested Traffic Manager profiles.</span></span> <span data-ttu-id="aaa0a-120">Une imbrication permet de créer des configurations de routage du trafic sophistiquées et flexibles répondant aux besoins d’applications complexes plus importantes.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-120">Nesting enables sophisticated and flexible traffic-routing configurations that meet the needs of larger, complex applications.</span></span> <span data-ttu-id="aaa0a-121">Pour plus d’informations, consultez [Profils Traffic Manager imbriqués](traffic-manager-nested-profiles.md).</span><span class="sxs-lookup"><span data-stu-id="aaa0a-121">For more information, see [nested Traffic Manager profiles](traffic-manager-nested-profiles.md).</span></span>

## <span data-ttu-id="aaa0a-122"><a name = "priority"></a>Méthode de routage du trafic basé sur la priorité</span><span class="sxs-lookup"><span data-stu-id="aaa0a-122"><a name = "priority"></a>Priority traffic-routing method</span></span>

<span data-ttu-id="aaa0a-123">Souvent, une organisation souhaite assurer la fiabilité de ses services en déployant un ou plusieurs services de sauvegarde utilisables en cas de défaillance du service principal.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-123">Often an organization wants to provide reliability for its services by deploying one or more backup services in case their primary service goes down.</span></span> <span data-ttu-id="aaa0a-124">La méthode de routage du trafic « Priorité » permet aux clients Azure d’implémenter facilement ce modèle de basculement.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-124">The 'Priority' traffic-routing method allows Azure customers to easily implement this failover pattern.</span></span>

![Méthode de routage du trafic « Priorité » d’Azure Traffic Manager][1]

<span data-ttu-id="aaa0a-126">Le profil Traffic Manager contient une liste hiérarchisée de points de terminaison de service.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-126">The Traffic Manager profile contains a prioritized list of service endpoints.</span></span> <span data-ttu-id="aaa0a-127">Par défaut, Traffic Manager envoie tout le trafic vers le point de terminaison principal (priorité la plus élevée).</span><span class="sxs-lookup"><span data-stu-id="aaa0a-127">By default, Traffic Manager sends all traffic to the primary (highest-priority) endpoint.</span></span> <span data-ttu-id="aaa0a-128">Si le point de terminaison principal n’est pas disponible, Traffic Manager route le trafic vers le deuxième point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-128">If the primary endpoint is not available, Traffic Manager routes the traffic to the second endpoint.</span></span> <span data-ttu-id="aaa0a-129">Si les points de terminaison de type principal et secondaire ne sont pas disponibles, le trafic est envoyé vers le troisième, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-129">If both the primary and secondary endpoints are not available, the traffic goes to the third, and so on.</span></span> <span data-ttu-id="aaa0a-130">La disponibilité du point de terminaison est basée sur l’état configuré (activé ou désactivé) et la surveillance du point de terminaison en cours.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-130">Availability of the endpoint is based on the configured status (enabled or disabled) and the ongoing endpoint monitoring.</span></span>

### <a name="configuring-endpoints"></a><span data-ttu-id="aaa0a-131">Configuration de points de terminaison</span><span class="sxs-lookup"><span data-stu-id="aaa0a-131">Configuring endpoints</span></span>

<span data-ttu-id="aaa0a-132">Avec Azure Resource Manager, vous configurez la priorité de point de terminaison explicitement à l’aide de la propriété « priority » pour chaque point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-132">With Azure Resource Manager, you configure the endpoint priority explicitly using the 'priority' property for each endpoint.</span></span> <span data-ttu-id="aaa0a-133">Cette propriété est une valeur comprise entre 1 et 1000.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-133">This property is a value between 1 and 1000.</span></span> <span data-ttu-id="aaa0a-134">Plus la valeur est basse, plus la priorité est élevée.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-134">Lower values represent a higher priority.</span></span> <span data-ttu-id="aaa0a-135">Des points de terminaison ne peuvent pas partager des valeurs de priorité.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-135">Endpoints cannot share priority values.</span></span> <span data-ttu-id="aaa0a-136">La définition de la propriété est facultative.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-136">Setting the property is optional.</span></span> <span data-ttu-id="aaa0a-137">En cas d’omission, une priorité par défaut basée sur l’ordre du point de terminaison est utilisée.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-137">When omitted, a default priority based on the endpoint order is used.</span></span>

##<span data-ttu-id="aaa0a-138"><a name = "weighted"></a>Méthode de routage du trafic basé sur la pondération</span><span class="sxs-lookup"><span data-stu-id="aaa0a-138"><a name = "weighted"></a>Weighted traffic-routing method</span></span>
<span data-ttu-id="aaa0a-139">La méthode de routage du trafic « Pondéré » vous permet de répartir le trafic uniformément ou d’utiliser une pondération prédéfinie.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-139">The 'Weighted' traffic-routing method allows you to distribute traffic evenly or to use a pre-defined weighting.</span></span>

![Méthode de routage du trafic « Pondéré » d’Azure Traffic Manager][2]

<span data-ttu-id="aaa0a-141">Dans la méthode de routage du trafic Pondéré, vous affectez une pondération à chaque point de terminaison dans la configuration du profil Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-141">In the Weighted traffic-routing method, you assign a weight to each endpoint in the Traffic Manager profile configuration.</span></span> <span data-ttu-id="aaa0a-142">La pondération est un entier compris entre 1 et 1000.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-142">The weight is an integer from 1 to 1000.</span></span> <span data-ttu-id="aaa0a-143">Ce paramètre est facultatif.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-143">This parameter is optional.</span></span> <span data-ttu-id="aaa0a-144">En cas d’omission, Traffic Manager utilise la pondération par défaut « 1 ».</span><span class="sxs-lookup"><span data-stu-id="aaa0a-144">If omitted, Traffic Managers uses a default weight of '1'.</span></span>

<span data-ttu-id="aaa0a-145">Pour chaque requête DNS reçue, Traffic Manager choisit au hasard un point de terminaison disponible.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-145">For each DNS query received, Traffic Manager randomly chooses an available endpoint.</span></span> <span data-ttu-id="aaa0a-146">La probabilité de choisir un point de terminaison dépend des pondérations assignées à tous les points de terminaison disponibles.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-146">The probability of choosing an endpoint is based on the weights assigned to all available endpoints.</span></span> <span data-ttu-id="aaa0a-147">L’utilisation de la même pondération pour tous les points de terminaison produit une distribution uniforme du trafic.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-147">Using the same weight across all endpoints results in an even traffic distribution.</span></span> <span data-ttu-id="aaa0a-148">L’utilisation de pondérations supérieures ou inférieures sur certains points de terminaison a pour effet que ceux-ci sont retournés plus ou moins fréquemment dans les réponses DNS.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-148">Using higher or lower weights on specific endpoints causes those endpoints to be returned more or less frequently in the DNS responses.</span></span>

<span data-ttu-id="aaa0a-149">La méthode pondérée permet des scénarios utiles :</span><span class="sxs-lookup"><span data-stu-id="aaa0a-149">The weighted method enables some useful scenarios:</span></span>

* <span data-ttu-id="aaa0a-150">Mise à niveau progressive d’une application : allouez un pourcentage de trafic à acheminer vers un nouveau point de terminaison, puis augmentez progressivement le trafic au fil du temps jusqu’à 100 %.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-150">Gradual application upgrade: Allocate a percentage of traffic to route to a new endpoint, and gradually increase the traffic over time to 100%.</span></span>
* <span data-ttu-id="aaa0a-151">Migration d’application vers Azure : créez un profil avec des points de terminaison Azure et externes.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-151">Application migration to Azure: Create a profile with both Azure and external endpoints.</span></span> <span data-ttu-id="aaa0a-152">Ajustez la pondération des points de terminaison pour privilégier les nouveaux points de terminaison.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-152">Adjust the weight of the endpoints to prefer the new endpoints.</span></span>
* <span data-ttu-id="aaa0a-153">Extension du cloud pour une capacité supplémentaire : étendez rapidement un déploiement local dans le cloud en le plaçant derrière un profil Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-153">Cloud-bursting for additional capacity: Quickly expand an on-premises deployment into the cloud by putting it behind a Traffic Manager profile.</span></span> <span data-ttu-id="aaa0a-154">Quand vous avez besoin d'une capacité supplémentaire dans le cloud, vous pouvez ajouter ou activer des points de terminaison supplémentaires et spécifier quelle partie du trafic est destinée à chaque point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-154">When you need extra capacity in the cloud, you can add or enable more endpoints and specify what portion of traffic goes to each endpoint.</span></span>

<span data-ttu-id="aaa0a-155">Le portail Azure Resource Manager prend en charge la configuration de routage du trafic Pondéré.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-155">The Resource Manager Azure portal supports the configuration of weighted traffic routing.</span></span>  <span data-ttu-id="aaa0a-156">Vous pouvez configurer les pondérations à l’aide des versions Resource Manager d’Azure PowerShell, de l’interface Azure CLI et des API REST.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-156">You can configure weights using the Resource Manager versions of Azure PowerShell, CLI, and the REST APIs.</span></span>

<span data-ttu-id="aaa0a-157">Il est important de comprendre que les réponses DNS sont mises en cache par les clients et les serveurs DNS récursifs que les clients utilisent pour résoudre les noms DNS.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-157">It is important to understand that DNS responses are cached by clients and by the recursive DNS servers that the clients use to resolve DNS names.</span></span> <span data-ttu-id="aaa0a-158">Cette mise en cache peut avoir une incidence sur les distributions de trafic pondérées.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-158">This caching can have an impact on weighted traffic distributions.</span></span> <span data-ttu-id="aaa0a-159">Lorsque le nombre de clients et de serveurs DNS récursifs est élevé, la distribution du trafic fonctionne comme prévu.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-159">When the number of clients and recursive DNS servers is large, traffic distribution works as expected.</span></span> <span data-ttu-id="aaa0a-160">En revanche, si le nombre de clients ou de serveurs DNS récursifs est peu élevé, la mise en cache peut fausser sensiblement la distribution du trafic.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-160">However, when the number of clients or recursive DNS servers is small, caching can significantly skew the traffic distribution.</span></span>

<span data-ttu-id="aaa0a-161">Les cas d’utilisation courants sont les suivants :</span><span class="sxs-lookup"><span data-stu-id="aaa0a-161">Common use cases include:</span></span>

* <span data-ttu-id="aaa0a-162">les environnements de développement et de test ;</span><span class="sxs-lookup"><span data-stu-id="aaa0a-162">Development and testing environments</span></span>
* <span data-ttu-id="aaa0a-163">les communications d’application à application ;</span><span class="sxs-lookup"><span data-stu-id="aaa0a-163">Application-to-application communications</span></span>
* <span data-ttu-id="aaa0a-164">les applications destinées à une base étroite d’utilisateurs qui partagent une infrastructure DNS récursive commune (par exemple, des employés d’une entreprise se connectant via un proxy).</span><span class="sxs-lookup"><span data-stu-id="aaa0a-164">Applications aimed at a narrow user-base that share a common recursive DNS infrastructure (for example, employees of company connecting through a proxy)</span></span>

<span data-ttu-id="aaa0a-165">Ces effets de mise en cache DNS sont communs à tous les systèmes de routage du trafic basés sur DNS, pas seulement à Azure Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-165">These DNS caching effects are common to all DNS-based traffic routing systems, not just Azure Traffic Manager.</span></span> <span data-ttu-id="aaa0a-166">Dans certains cas, la solution peut constituer à effacer le cache DNS de manière explicite.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-166">In some cases, explicitly clearing the DNS cache may provide a workaround.</span></span> <span data-ttu-id="aaa0a-167">Dans d’autres cas, une autre méthode de routage du trafic peut être plus appropriée.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-167">In other cases, an alternative traffic-routing method may be more appropriate.</span></span>

## <span data-ttu-id="aaa0a-168"><a name = "performance"></a>Méthode de routage du trafic basé sur les performances</span><span class="sxs-lookup"><span data-stu-id="aaa0a-168"><a name = "performance"></a>Performance traffic-routing method</span></span>

<span data-ttu-id="aaa0a-169">Un déploiement de points de terminaison en deux emplacements ou plus dans le monde peut améliorer la réactivité de nombreuses applications en routant le trafic vers l’emplacement « le plus proche » de vous.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-169">Deploying endpoints in two or more locations across the globe can improve the responsiveness of many applications by routing traffic to the location that is 'closest' to you.</span></span> <span data-ttu-id="aaa0a-170">La méthode de routage du trafic « Performance » offre cette possibilité.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-170">The 'Performance' traffic-routing method provides this capability.</span></span>

![Méthode de routage du trafic « Performance » d’Azure Traffic Manager][3]

<span data-ttu-id="aaa0a-172">Le point de terminaison « le plus proche » n’est pas nécessairement le plus proche en termes de distance géographique.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-172">The 'closest' endpoint is not necessarily closest as measured by geographic distance.</span></span> <span data-ttu-id="aaa0a-173">Au lieu de cela, la méthode de routage du trafic « Performance » détermine le point de terminaison le plus proche en mesurant le temps de réponse (ou latence) du réseau.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-173">Instead, the 'Performance' traffic-routing method determines the closest endpoint by measuring network latency.</span></span> <span data-ttu-id="aaa0a-174">Traffic Manager tient à jour une Table de latence Internet pour suivre le temps d’aller-retour entre les plages d’adresses IP et chaque centre de données Azure.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-174">Traffic Manager maintains an Internet Latency Table to track the round-trip time between IP address ranges and each Azure datacenter.</span></span>

<span data-ttu-id="aaa0a-175">Traffic Manager recherche l’adresse IP source de la demande DNS entrante dans la Table de latence Internet.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-175">Traffic Manager looks up the source IP address of the incoming DNS request in the Internet Latency Table.</span></span> <span data-ttu-id="aaa0a-176">Traffic Manager choisit un point de terminaison disponible dans le centre de données Azure dont la latence est la plus faible pour la plage d’adresses IP, puis renvoie ce point de terminaison dans la réponse DNS.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-176">Traffic Manager chooses an available endpoint in the Azure datacenter that has the lowest latency for that IP address range, then returns that endpoint in the DNS response.</span></span>

<span data-ttu-id="aaa0a-177">Comme expliqué dans [Fonctionnement de Traffic Manager](traffic-manager-overview.md#how-traffic-manager-works), Traffic Manager ne reçoit pas de requêtes DNS provenant directement de clients.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-177">As explained in [How Traffic Manager Works](traffic-manager-overview.md#how-traffic-manager-works), Traffic Manager does not receive DNS queries directly from clients.</span></span> <span data-ttu-id="aaa0a-178">Au lieu de cela, les requêtes DNS proviennent du service DNS récursif que les clients sont configurés pour utiliser.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-178">Rather, DNS queries come from the recursive DNS service that the clients are configured to use.</span></span> <span data-ttu-id="aaa0a-179">Par conséquent, l’adresse IP utilisée pour déterminer le point de terminaison « le plus proche » n’est pas l’adresse IP du client, mais celle du service DNS récursif.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-179">Therefore, the IP address used to determine the 'closest' endpoint is not the client's IP address, but it is the IP address of the recursive DNS service.</span></span> <span data-ttu-id="aaa0a-180">Dans la pratique, cette adresse IP est un bon proxy pour le client.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-180">In practice, this IP address is a good proxy for the client.</span></span>


<span data-ttu-id="aaa0a-181">Traffic Manager met régulièrement à jour la Table de latence Internet pour refléter les modifications de l’Internet global et des nouvelles régions Azure.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-181">Traffic Manager regularly updates the Internet Latency Table to account for changes in the global Internet and new Azure regions.</span></span> <span data-ttu-id="aaa0a-182">Toutefois, les performances des applications varient en fonction des variations en temps réel de la charge sur Internet.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-182">However, application performance varies based on real-time variations in load across the Internet.</span></span> <span data-ttu-id="aaa0a-183">Le routage du trafic Performance ne surveille pas la charge sur un point de terminaison de service donné.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-183">Performance traffic-routing does not monitor load on a given service endpoint.</span></span> <span data-ttu-id="aaa0a-184">En revanche, si un point de terminaison devient indisponible, Traffic Manager ne l’inclut pas dans les réponses aux requêtes DNS.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-184">However, if an endpoint becomes unavailable, Traffic Manager does not include it in DNS query responses.</span></span>


<span data-ttu-id="aaa0a-185">Points à noter :</span><span class="sxs-lookup"><span data-stu-id="aaa0a-185">Points to note:</span></span>

* <span data-ttu-id="aaa0a-186">Si votre profil contient plusieurs points de terminaison situés dans la même région Azure, Traffic Manager répartit uniformément le trafic entre les points de terminaison disponibles dans cette région.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-186">If your profile contains multiple endpoints in the same Azure region, then Traffic Manager distributes traffic evenly across the available endpoints in that region.</span></span> <span data-ttu-id="aaa0a-187">Si vous préférez une distribution de trafic différente au sein d’une région, vous pouvez utiliser des [profils Traffic Manager imbriqués](traffic-manager-nested-profiles.md).</span><span class="sxs-lookup"><span data-stu-id="aaa0a-187">If you prefer a different traffic distribution within a region, you can use [nested Traffic Manager profiles](traffic-manager-nested-profiles.md).</span></span>
* <span data-ttu-id="aaa0a-188">Si tous les points de terminaison activés dans la région Azure la plus proche sont défectueux, Traffic Manager déplace le trafic vers les points de terminaison dans la région Azure la plus proche suivante.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-188">If all enabled endpoints in the closest Azure region are degraded, Traffic Manager moves traffic to the endpoints in the next closest Azure region.</span></span> <span data-ttu-id="aaa0a-189">Si vous souhaitez définir une séquence de basculement préférée, utilisez des [profils Traffic Manager imbriqués](traffic-manager-nested-profiles.md).</span><span class="sxs-lookup"><span data-stu-id="aaa0a-189">If you want to define a preferred failover sequence, use [nested Traffic Manager profiles](traffic-manager-nested-profiles.md).</span></span>
* <span data-ttu-id="aaa0a-190">Si vous utilisez la méthode de routage du trafic basé sur les performances avec des points de terminaison externes ou des points de terminaison imbriqués, vous devez spécifier l’emplacement de ces points de terminaison.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-190">When using the Performance traffic routing method with external endpoints or nested endpoints, you need to specify the location of those endpoints.</span></span> <span data-ttu-id="aaa0a-191">Choisissez la région Azure la plus proche de votre déploiement.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-191">Choose the Azure region closest to your deployment.</span></span> <span data-ttu-id="aaa0a-192">Ces emplacements sont les valeurs prises en charge par la Table de latence Internet.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-192">Those locations are the values supported by the Internet Latency Table.</span></span>
* <span data-ttu-id="aaa0a-193">L’algorithme qui choisit le point de terminaison est déterministe.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-193">The algorithm that chooses the endpoint is deterministic.</span></span> <span data-ttu-id="aaa0a-194">Des requêtes DNS répétées à partir du même client sont dirigées vers le même point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-194">Repeated DNS queries from the same client are directed to the same endpoint.</span></span> <span data-ttu-id="aaa0a-195">En règle générale, les clients utilisent des serveurs DNS récursifs différents quand ils se déplacent.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-195">Typically, clients use different recursive DNS servers when traveling.</span></span> <span data-ttu-id="aaa0a-196">Le client peut être routé vers un point de terminaison différent.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-196">The client may be routed to a different endpoint.</span></span> <span data-ttu-id="aaa0a-197">Le routage peut également être affecté par des mises à jour de la Table de latence Internet.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-197">Routing can also be affected by updates to the Internet Latency Table.</span></span> <span data-ttu-id="aaa0a-198">Par conséquent, la méthode de routage du trafic Performance ne garantit pas qu’un client est toujours routé vers le même point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-198">Therefore, the Performance traffic-routing method does not guarantee that a client is always routed to the same endpoint.</span></span>
* <span data-ttu-id="aaa0a-199">Lorsque la Table de latence Internet change, il se peut que certains clients soient dirigés vers un point de terminaison différent.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-199">When the Internet Latency Table changes, you may notice that some clients are directed to a different endpoint.</span></span> <span data-ttu-id="aaa0a-200">La précision de ce changement de routage varie en fonction des données de latence en cours.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-200">This routing change is more accurate based on current latency data.</span></span> <span data-ttu-id="aaa0a-201">Ces mises à jour sont essentielles pour conserver l’exactitude du routage du trafic « Performance », car Internet évolue en permanence.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-201">These updates are essential to maintain the accuracy of Performance traffic-routing as the Internet continually evolves.</span></span>

## <span data-ttu-id="aaa0a-202"><a name = "geographic"></a>Méthode de routage du trafic Geographic (Géographique)</span><span class="sxs-lookup"><span data-stu-id="aaa0a-202"><a name = "geographic"></a>Geographic traffic-routing method</span></span>

<span data-ttu-id="aaa0a-203">Les profils Traffic Manager peuvent être configurés de manière à utiliser la méthode de routage Geographic (Géographique) pour diriger les utilisateurs vers des points de terminaison spécifiques (Azure, externes ou imbriqués) selon l’emplacement géographique dont leur requête DNS provient.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-203">Traffic Manager profiles can be configured to use the Geographic routing method so that users are directed to specific endpoints (Azure, External or Nested) based on which geographic location their DNS query originates from.</span></span> <span data-ttu-id="aaa0a-204">Cette option permet aux clients Traffic Manager de mettre en œuvre des scénarios où il est important de connaître la région géographique des utilisateurs et de router leur trafic en fonction de celle-ci.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-204">This empowers Traffic Manager customers to enable scenarios where knowing a user’s geographic region and routing them based on that is important.</span></span> <span data-ttu-id="aaa0a-205">Exemples : respect des obligations en matière de souveraineté des données, localisation de contenu et d’expérience utilisateur, mesure du trafic en provenance de différentes régions.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-205">Examples include complying with data sovereignty mandates, localization of content & user experience and measuring traffic from different regions.</span></span>
<span data-ttu-id="aaa0a-206">Lorsqu’un profil est configuré pour le routage géographique, un ensemble de régions géographiques doit être affecté à chaque point de terminaison associé à ce profil.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-206">When a profile is configured for geographic routing, each endpoint associated with that profile needs to have a set of geographic regions assigned to it.</span></span> <span data-ttu-id="aaa0a-207">Une région géographique peut présenter les niveaux de granularité suivants :</span><span class="sxs-lookup"><span data-stu-id="aaa0a-207">A geographic region can be at following levels of granularity</span></span> 
- <span data-ttu-id="aaa0a-208">World (Monde) : n’importe quelle région</span><span class="sxs-lookup"><span data-stu-id="aaa0a-208">World– any region</span></span>
- <span data-ttu-id="aaa0a-209">Regional Grouping (Regroupement régional) : Afrique, Moyen-Orient, Australie/Pacifique, etc.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-209">Regional Grouping – for example, Africa, Middle East, Australia/Pacific etc.</span></span> 
- <span data-ttu-id="aaa0a-210">Country/Region (Pays/Région) : Irlande, Pérou, Hong Kong (R.A.S.), etc.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-210">Country/Region – for example, Ireland, Peru, Hong Kong SAR etc.</span></span> 
- <span data-ttu-id="aaa0a-211">State/Province (État/Province) : États-Unis-Californie, Australie-Queensland, Canada-Alberta, etc. (Remarque : ce niveau de granularité est pris en charge uniquement pour les états/provinces de l’Australie, du Canada, du Royaume-Uni et des États-Unis.)</span><span class="sxs-lookup"><span data-stu-id="aaa0a-211">State/Province – for example, USA-California, Australia-Queensland, Canada-Alberta etc. (note: this granularity level is supported only for states / provinces in Australia, Canada, UK, and USA).</span></span>

<span data-ttu-id="aaa0a-212">Lorsqu’une région ou un ensemble de régions est affecté à un point de terminaison, toutes les demandes provenant de ces régions sont routées exclusivement vers ce point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-212">When a region or a set of regions is assigned to an endpoint, any requests from those regions gets routed only to that endpoint.</span></span> <span data-ttu-id="aaa0a-213">Traffic Manager utilise l’adresse IP source de la requête DNS pour déterminer la région où l’utilisateur effectue sa requête. Il s’agit en général de l’adresse IP du programme de résolution DNS local qui effectue la requête pour le compte de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-213">Traffic Manager uses the source IP address of the DNS query to determine the region from which a user is querying from – usually this is the IP address of the local DNS resolver doing the query on behalf of the user.</span></span>  

![Méthode de routage du trafic « Geographic » (Géographique) d’Azure Traffic Manager](./media/traffic-manager-routing-methods/geographic.png)

<span data-ttu-id="aaa0a-215">Traffic Manager analyse l’adresse IP source de la requête DNS afin de déterminer la région géographique d’origine de cette dernière.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-215">Traffic Manager reads the source IP address of the DNS query and decides which geographic region it is originating from.</span></span> <span data-ttu-id="aaa0a-216">Il examine ensuite s’il existe un point de terminaison auquel cette région géographique est mappée.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-216">It then looks to see if there is an endpoint that has this geographic region mapped to it.</span></span> <span data-ttu-id="aaa0a-217">Cette recherche commence au niveau de granularité le plus bas (State/Province [État/Province] où il est pris en charge, Pays/Région ailleurs) et remonte jusqu’au niveau le plus élevé, à savoir **World** (Monde).</span><span class="sxs-lookup"><span data-stu-id="aaa0a-217">This lookup starts at the lowest granularity level (State/Province where it is supported, else at the Country/Region level) and goes all the way up to the highest level, which is **World**.</span></span> <span data-ttu-id="aaa0a-218">La première correspondance trouvée à l’aide de ce balayage est désignée en tant que point de terminaison à renvoyer dans la réponse à la requête.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-218">The first match found using this traversal is designated as the endpoint to return in the query response.</span></span> <span data-ttu-id="aaa0a-219">En cas de correspondance avec un point de terminaison de type imbriqué, un point de terminaison de ce profil enfant est renvoyé en fonction de sa méthode de routage.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-219">When matching with a Nested type endpoint, an endpoint within that child profile is returned, based on its routing method.</span></span> <span data-ttu-id="aaa0a-220">Les points suivants s’appliquent à ce comportement :</span><span class="sxs-lookup"><span data-stu-id="aaa0a-220">The following points are applicable to this behavior:</span></span>

- <span data-ttu-id="aaa0a-221">Une zone géographique peut être mappée à un seul point de terminaison dans un profil Traffic Manager lorsque le type de routage est défini sur Geographic (Géographique).</span><span class="sxs-lookup"><span data-stu-id="aaa0a-221">A geographic region can be mapped only to one endpoint in a Traffic Manager profile when the routing type is Geographic Routing.</span></span> <span data-ttu-id="aaa0a-222">Cela garantit un routage déterministe du trafic des utilisateurs et permet aux clients de mettre en œuvre des scénarios nécessitant des limites géographiques claires.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-222">This ensures that routing of users is deterministic, and customers can enable scenarios that require unambiguous geographic boundaries.</span></span>
- <span data-ttu-id="aaa0a-223">Si la région d’un utilisateur correspond au mappage géographique de deux points de terminaison différents, Traffic Manager sélectionne le point de terminaison présentant le niveau de granularité le plus bas et n’envisage pas la possibilité de router les demandes provenant de cette région vers l’autre point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-223">If a user’s region comes under two different endpoints’ geographic mapping, Traffic Manager selects the endpoint with the lowest granularity and does not consider routing requests from that region to the other endpoint.</span></span> <span data-ttu-id="aaa0a-224">Par exemple, considérons un profil présentant le type de routage Geographic (Géographique) et deux points de terminaison, Endpoint1 et Endpoint2.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-224">For example, consider a Geographic Routing type profile with two endpoints - Endpoint1 and Endpoint2.</span></span> <span data-ttu-id="aaa0a-225">Endpoint1 est configuré pour recevoir le trafic provenant d’Irlande et Endpoint2 est configuré pour recevoir le trafic provenant d’Europe.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-225">Endpoint1 is configured to receive traffic from Ireland and Endpoint2 is configured to receive traffic from Europe.</span></span> <span data-ttu-id="aaa0a-226">Une demande provenant d’Irlande est systématiquement routée vers le point de terminaison Endpoint1.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-226">If a request originates from Ireland, it is always routed to Endpoint1.</span></span>
- <span data-ttu-id="aaa0a-227">Comme une région peut être mappée à un seul point de terminaison, Traffic Manager renvoie ce point de terminaison, qu’il soit intègre ou non.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-227">Since a region can be mapped only to one endpoint, Traffic Manager returns it regardless of whether the endpoint is healthy or not.</span></span>

    >[!IMPORTANT]
    ><span data-ttu-id="aaa0a-228">Il est vivement recommandé aux clients utilisant la méthode de routage Geographic (Géographique) de l’associer avec les points de terminaison de type imbriqué qui présentent des profils enfants contenant au moins deux points de terminaison.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-228">It is strongly recommended that customers using the geographic routing method associate it with the Nested type endpoints that has child profiles containing at least two endpoints within each.</span></span>
- <span data-ttu-id="aaa0a-229">Si une correspondance de point de terminaison est trouvée et que ce point de terminaison se trouve à l’état **Arrêté**, Traffic Manager renvoie une réponse NODATA.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-229">If an endpoint match is found and that endpoint is in the **Stopped** state, Traffic Manager returns a NODATA response.</span></span> <span data-ttu-id="aaa0a-230">Dans ce cas, aucune autre recherche n’est effectuée plus haut dans la hiérarchie de la région géographique.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-230">In this case, no further lookups is made higher up in the geographic region hierarchy.</span></span> <span data-ttu-id="aaa0a-231">Ce comportement s’applique également aux points de terminaison de type imbriqué lorsque le profil enfant se trouve à l’état **Arrêté** ou **Désactivé**.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-231">This behavior is also applicable for nested endpoint types when the child profile is in the **Stopped** or **Disabled** state.</span></span>
- <span data-ttu-id="aaa0a-232">Si un point de terminaison se trouve à l’état **Désactivé**, il n’est pas inclus dans le processus de mise en correspondance avec la région.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-232">If an endpoint displays a **Disabled** status, it won’t be included in the region matching process.</span></span> <span data-ttu-id="aaa0a-233">Ce comportement s’applique également aux points de terminaison de type imbriqué lorsque le point de terminaison se trouve à l’état **Désactivé**.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-233">This behavior is also applicable for nested endpoint types when the endpoint is in the **Disabled** state.</span></span>
- <span data-ttu-id="aaa0a-234">Si une requête provient d’une région géographique qui n’a aucun mappage dans ce profil, Traffic Manager renvoie une réponse NODATA.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-234">If a query is coming from a geographic region that has no mapping in that profile, Traffic Manager returns a NODATA response.</span></span> <span data-ttu-id="aaa0a-235">Par conséquent, il est vivement recommandé aux clients d’utiliser le routage géographique avec un point de terminaison, idéalement de type imbriqué avec au moins deux points de terminaison dans le profil enfant, auquel la région **World** (Monde) est affectée.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-235">Therefore, it is strongly recommended that customers use geographic routing with one endpoint, ideally of type Nested with at least two endpoints within the child profile, with the region **World** assigned to it.</span></span> <span data-ttu-id="aaa0a-236">Cela garantit également que les adresses IP qui ne sont mappées à aucune région sont gérées.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-236">This also ensures that any IP addresses that do not map to a region are handled.</span></span>

<span data-ttu-id="aaa0a-237">Comme expliqué dans [Fonctionnement de Traffic Manager](traffic-manager-how-traffic-manager-works.md), Traffic Manager ne reçoit pas de requêtes DNS provenant directement de clients.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-237">As explained in [How Traffic Manager Works](traffic-manager-how-traffic-manager-works.md), Traffic Manager does not receive DNS queries directly from clients.</span></span> <span data-ttu-id="aaa0a-238">Au lieu de cela, les requêtes DNS proviennent du service DNS récursif que les clients sont configurés pour utiliser.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-238">Rather, DNS queries come from the recursive DNS service that the clients are configured to use.</span></span> <span data-ttu-id="aaa0a-239">Par conséquent, l’adresse IP utilisée pour déterminer la région n’est pas l’adresse IP du client, mais celle du service DNS récursif.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-239">Therefore, the IP address used to determine the region is not the client's IP address, but it is the IP address of the recursive DNS service.</span></span> <span data-ttu-id="aaa0a-240">Dans la pratique, cette adresse IP est un bon proxy pour le client.</span><span class="sxs-lookup"><span data-stu-id="aaa0a-240">In practice, this IP address is a good proxy for the client.</span></span>


## <a name="next-steps"></a><span data-ttu-id="aaa0a-241">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="aaa0a-241">Next steps</span></span>

<span data-ttu-id="aaa0a-242">Découvrez comment développer des applications à haute disponibilité à l’aide de la [surveillance de points de terminaison Traffic Manager](traffic-manager-monitoring.md)</span><span class="sxs-lookup"><span data-stu-id="aaa0a-242">Learn how to develop high-availability applications using [Traffic Manager endpoint monitoring](traffic-manager-monitoring.md)</span></span>

<span data-ttu-id="aaa0a-243">En savoir plus sur la [création d’un profil Traffic Manager](traffic-manager-create-profile.md)</span><span class="sxs-lookup"><span data-stu-id="aaa0a-243">Learn how to [create a Traffic Manager profile](traffic-manager-create-profile.md)</span></span>

<!--Image references-->
[1]: ./media/traffic-manager-routing-methods/priority.png
[2]: ./media/traffic-manager-routing-methods/weighted.png
[3]: ./media/traffic-manager-routing-methods/performance.png



