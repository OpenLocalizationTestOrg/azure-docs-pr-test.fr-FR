---
title: "Surveillance des points de terminaison Azure Traffic Manager | Microsoft Docs"
description: "Cet article explique comment Traffic Manager utilise la surveillance des points de terminaison et le basculement automatique des points de terminaison pour aider les clients Azure à déployer des applications haute disponibilité"
services: traffic-manager
documentationcenter: 
author: kumudd
manager: timlt
editor: 
ms.assetid: fff25ac3-d13a-4af9-8916-7c72e3d64bc7
ms.service: traffic-manager
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 06/22/2017
ms.author: kumud
ms.openlocfilehash: 5ce000814f2f5899a7338fdefb39c4873c006b1d
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/11/2017
---
# <a name="traffic-manager-endpoint-monitoring"></a><span data-ttu-id="ce917-103">Surveillance des points de terminaison Traffic Manager</span><span class="sxs-lookup"><span data-stu-id="ce917-103">Traffic Manager endpoint monitoring</span></span>

<span data-ttu-id="ce917-104">Azure Traffic Manager inclut la surveillance intégrée des points de terminaison et leur basculement automatique.</span><span class="sxs-lookup"><span data-stu-id="ce917-104">Azure Traffic Manager includes built-in endpoint monitoring and automatic endpoint failover.</span></span> <span data-ttu-id="ce917-105">Cette fonctionnalité vous aide à fournir des applications haute disponibilité résistantes aux défaillances des points de terminaison, notamment les défaillances des régions Azure.</span><span class="sxs-lookup"><span data-stu-id="ce917-105">This feature helps you deliver high-availability applications that are resilient to endpoint failure, including Azure region failures.</span></span>

## <a name="configure-endpoint-monitoring"></a><span data-ttu-id="ce917-106">Configuration de la surveillance des points de terminaison</span><span class="sxs-lookup"><span data-stu-id="ce917-106">Configure endpoint monitoring</span></span>

<span data-ttu-id="ce917-107">Pour configurer la surveillance des points de terminaison, vous devez spécifier les paramètres suivants sur votre profil Traffic Manager :</span><span class="sxs-lookup"><span data-stu-id="ce917-107">To configure endpoint monitoring, you must specify the following settings on your Traffic Manager profile:</span></span>

* <span data-ttu-id="ce917-108">**Protocole**.</span><span class="sxs-lookup"><span data-stu-id="ce917-108">**Protocol**.</span></span> <span data-ttu-id="ce917-109">Sélectionnez HTTP, HTTPS ou TCP comme protocole utilisé par Traffic Manager lors de la détection du point de terminaison pour contrôler son intégrité.</span><span class="sxs-lookup"><span data-stu-id="ce917-109">Choose HTTP, HTTPS, or TCP as the protocol that Traffic Manager uses when probing your endpoint to check its health.</span></span> <span data-ttu-id="ce917-110">Notez que la surveillance HTTPS ne vérifie pas si votre certificat SSL est valide, mais uniquement s’il est présent.</span><span class="sxs-lookup"><span data-stu-id="ce917-110">HTTPS monitoring does not verify whether your SSL certificate is valid--it only checks that the certificate is present.</span></span>
* <span data-ttu-id="ce917-111">**Port**.</span><span class="sxs-lookup"><span data-stu-id="ce917-111">**Port**.</span></span> <span data-ttu-id="ce917-112">Choisissez le port utilisé pour la requête.</span><span class="sxs-lookup"><span data-stu-id="ce917-112">Choose the port used for the request.</span></span>
* <span data-ttu-id="ce917-113">**Chemin d’accès**.</span><span class="sxs-lookup"><span data-stu-id="ce917-113">**Path**.</span></span> <span data-ttu-id="ce917-114">Ce paramètre de configuration est valide uniquement pour les protocoles HTTP et HTTPS pour lesquels la configuration du chemin est obligatoire.</span><span class="sxs-lookup"><span data-stu-id="ce917-114">This configuration setting is valid only for the HTTP and HTTPS protocols, for which specifying the path setting is required.</span></span> <span data-ttu-id="ce917-115">La configuration de ce paramètre pour le protocole de surveillance TCP provoque une erreur.</span><span class="sxs-lookup"><span data-stu-id="ce917-115">Providing this setting for the TCP monitoring protocol results in an error.</span></span> <span data-ttu-id="ce917-116">Pour le protocole TCP, indiquez le chemin d’accès relatif et le nom du fichier ou de la page web auxquels la surveillance accède.</span><span class="sxs-lookup"><span data-stu-id="ce917-116">For TCP protocol, give the relative path and the name of the webpage or the file that the monitoring accesses.</span></span> <span data-ttu-id="ce917-117">Une barre oblique (/) est une entrée valide pour le chemin d’accès relatif.</span><span class="sxs-lookup"><span data-stu-id="ce917-117">A forward slash (/) is a valid entry for the relative path.</span></span> <span data-ttu-id="ce917-118">Cette valeur indique que le fichier est dans le répertoire racine (par défaut).</span><span class="sxs-lookup"><span data-stu-id="ce917-118">This value implies that the file is in the root directory (default).</span></span>
* <span data-ttu-id="ce917-119">**Intervalle de détection**.</span><span class="sxs-lookup"><span data-stu-id="ce917-119">**Probing Interval**.</span></span> <span data-ttu-id="ce917-120">Cette valeur spécifie la fréquence à laquelle l’intégrité d’un point de terminaison est contrôlée par un agent de détection Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="ce917-120">This value specifies how often an endpoint is checked for its health from a Traffic Manager probing agent.</span></span> <span data-ttu-id="ce917-121">Vous pouvez spécifier deux valeurs ici : 30 secondes (détection normale) et 10 secondes (détection rapide).</span><span class="sxs-lookup"><span data-stu-id="ce917-121">You can specify two values here: 30 seconds (normal probing) and 10 seconds (fast probing).</span></span> <span data-ttu-id="ce917-122">Si aucune valeur n’est fournie, le profil définit par défaut la valeur sur 30 secondes.</span><span class="sxs-lookup"><span data-stu-id="ce917-122">If no values are provided, the profile sets to a default value of 30 seconds.</span></span> <span data-ttu-id="ce917-123">Visitez la page [Tarification de Traffic Manager](https://azure.microsoft.com/pricing/details/traffic-manager) pour en savoir plus sur la tarification pour la détection rapide.</span><span class="sxs-lookup"><span data-stu-id="ce917-123">Visit the [Traffic Manager Pricing](https://azure.microsoft.com/pricing/details/traffic-manager) page to learn more about fast probing pricing.</span></span>
* <span data-ttu-id="ce917-124">**Nombre d’échecs tolérés**.</span><span class="sxs-lookup"><span data-stu-id="ce917-124">**Tolerated Number of Failures**.</span></span> <span data-ttu-id="ce917-125">Cette valeur spécifie le nombre d’échecs tolérés par un agent de détection de Traffic Manager avant que le point de terminaison soit considéré comme défectueux.</span><span class="sxs-lookup"><span data-stu-id="ce917-125">This value specifies how many failures a Traffic Manager probing agent tolerates before marking that endpoint as unhealthy.</span></span> <span data-ttu-id="ce917-126">La valeur peut être comprise entre 0 et 9.</span><span class="sxs-lookup"><span data-stu-id="ce917-126">Its value can range between 0 and 9.</span></span> <span data-ttu-id="ce917-127">Une valeur égale à 0 signifie qu’il suffit d’un seul échec lors de l’analyse pour que le point de terminaison soit considéré comme défectueux.</span><span class="sxs-lookup"><span data-stu-id="ce917-127">A value of 0 means a single monitoring failure can cause that endpoint to be marked as unhealthy.</span></span> <span data-ttu-id="ce917-128">Si aucune valeur n’est spécifiée, la valeur par défaut est 3.</span><span class="sxs-lookup"><span data-stu-id="ce917-128">If no value is specified, it uses the default value of 3.</span></span>
* <span data-ttu-id="ce917-129">**Délai d’expiration de la surveillance**.</span><span class="sxs-lookup"><span data-stu-id="ce917-129">**Monitoring Timeout**.</span></span> <span data-ttu-id="ce917-130">Cette propriété spécifie le temps que l’agent de détection de Traffic Manager doit attendre avant de considérer que la procédure comme un échec lorsqu’une sonde de vérification de l’intégrité est envoyée au point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="ce917-130">This property specifies the amount of time the Traffic Manager probing agent should wait before considering that check a failure when a health check probe is sent to the endpoint.</span></span> <span data-ttu-id="ce917-131">Si l’intervalle de détection est défini sur 30 secondes, vous pouvez définir la valeur du délai d’expiration entre 5 et 10 secondes.</span><span class="sxs-lookup"><span data-stu-id="ce917-131">If the Probing Interval is set to 30 seconds, then you can set the Timeout value between 5 and 10 seconds.</span></span> <span data-ttu-id="ce917-132">Si aucune valeur n’est spécifiée, la valeur par défaut est 10 secondes.</span><span class="sxs-lookup"><span data-stu-id="ce917-132">If no value is specified, it uses a default value of 10 seconds.</span></span> <span data-ttu-id="ce917-133">Si l’intervalle de détection est défini sur 10 secondes, vous pouvez définir la valeur du délai d’expiration entre 5 et 9 secondes.</span><span class="sxs-lookup"><span data-stu-id="ce917-133">If the Probing Interval is set to 10 seconds, then you can set the Timeout value between 5 and 9 seconds.</span></span> <span data-ttu-id="ce917-134">Si aucune valeur n’est spécifiée pour le délai d’expiration, la valeur par défaut est 9 secondes.</span><span class="sxs-lookup"><span data-stu-id="ce917-134">If no Timeout value is specified, it uses a default value of 9 seconds.</span></span>

![Surveillance des points de terminaison Traffic Manager](./media/traffic-manager-monitoring/endpoint-monitoring-settings.png)

<span data-ttu-id="ce917-136">**Figure 1 : surveillance des points de terminaison Traffic Manager**</span><span class="sxs-lookup"><span data-stu-id="ce917-136">**Figure 1:  Traffic Manager endpoint monitoring**</span></span>

## <a name="how-endpoint-monitoring-works"></a><span data-ttu-id="ce917-137">Fonctionnement de la surveillance des points de terminaison</span><span class="sxs-lookup"><span data-stu-id="ce917-137">How endpoint monitoring works</span></span>

<span data-ttu-id="ce917-138">Si le protocole de surveillance est défini sur HTTP ou HTTPS, l’agent de détection de Traffic Manager effectue une requête GET vers le point de terminaison à l’aide du protocole, du port et du chemin d’accès relatif donnés.</span><span class="sxs-lookup"><span data-stu-id="ce917-138">If the monitoring protocol is set as HTTP or HTTPS, the Traffic Manager probing agent makes a GET request to the endpoint using the protocol, port, and relative path given.</span></span> <span data-ttu-id="ce917-139">S’il obtient une réponse 200-OK, ce point de terminaison est considéré comme sain.</span><span class="sxs-lookup"><span data-stu-id="ce917-139">If it gets back a 200-OK response, then that endpoint is considered healthy.</span></span> <span data-ttu-id="ce917-140">Si la réponse est une valeur différente, ou si aucune réponse n’est reçue dans le délai spécifié, l’agent de détection Traffic Manager refait une tentative en fonction du nombre d’échecs tolérés défini (aucune nouvelle tentative si cette valeur est définie sur 0).</span><span class="sxs-lookup"><span data-stu-id="ce917-140">If the response is a different value, or, if no response is received within the timeout period specified, then the Traffic Manager probing agent re-attempts according to the Tolerated Number of Failures setting (no re-attempts are done if this setting is 0).</span></span> <span data-ttu-id="ce917-141">Si le nombre d’échecs consécutifs est supérieur au nombre d’échecs tolérés, ce point de terminaison est considéré comme défectueux.</span><span class="sxs-lookup"><span data-stu-id="ce917-141">If the number of consecutive failures is higher than the Tolerated Number of Failures setting, then that endpoint is marked as unhealthy.</span></span> 

<span data-ttu-id="ce917-142">Si le protocole de surveillance est TCP, l’agent de détection de Traffic Manager lance une demande de connexion TCP à l’aide du port spécifié.</span><span class="sxs-lookup"><span data-stu-id="ce917-142">If the monitoring protocol is TCP, the Traffic Manager probing agent initiates a TCP connection request using the port specified.</span></span> <span data-ttu-id="ce917-143">Si le point de terminaison répond positivement à la requête de connexion, le contrôle d’intégrité est considéré comme une réussite et l’agent de détection de Traffic Manager rétablit la connexion TCP.</span><span class="sxs-lookup"><span data-stu-id="ce917-143">If the endpoint responds to the request with a response to establish the connection, that health check is marked as a success and the Traffic Manager probing agent resets the TCP connection.</span></span> <span data-ttu-id="ce917-144">Si la réponse est différente ou si aucune réponse n’est reçue dans le délai spécifié, l’agent de détection Traffic Manager refait une tentative en fonction du nombre d’échecs tolérés défini (aucune nouvelle tentative si cette valeur est définie sur 0).</span><span class="sxs-lookup"><span data-stu-id="ce917-144">If the response is a different value, or if no response is received within the timeout period specified, the Traffic Manager probing agent re-attempts according to the Tolerated Number of Failures setting (no re-attempts are made if this setting is 0).</span></span> <span data-ttu-id="ce917-145">Si le nombre d’échecs consécutifs est supérieur au nombre d’échecs tolérés, ce point de terminaison est considéré comme défectueux.</span><span class="sxs-lookup"><span data-stu-id="ce917-145">If the number of consecutive failures is higher than the Tolerated Number of Failures setting, then that endpoint is marked unhealthy.</span></span>

<span data-ttu-id="ce917-146">Dans tous les cas, Traffic Manager sonde plusieurs emplacements et identifie les échecs dans chaque région.</span><span class="sxs-lookup"><span data-stu-id="ce917-146">In all cases, Traffic Manager probes from multiple locations and the consecutive failure determination happens within each region.</span></span> <span data-ttu-id="ce917-147">Cela signifie également que les points de terminaison reçoivent des sondes d’intégrité à partir de Traffic Manager à une fréquence supérieure à celle du paramètre utilisé pour l’intervalle de détection.</span><span class="sxs-lookup"><span data-stu-id="ce917-147">This also means that endpoints are receiving health probes from Traffic Manager with a higher frequency than the setting used for Probing Interval.</span></span>

>[!NOTE]
><span data-ttu-id="ce917-148">Pour le protocole de surveillance HTTP ou HTTPS, il convient d’implémenter une page personnalisée dans l’application, côté point de terminaison. Par exemple : /health.aspx.</span><span class="sxs-lookup"><span data-stu-id="ce917-148">For HTTP or HTTPS monitoring protocol, a common practice on the endpoint side is to implement a custom page within your application - for example, /health.aspx.</span></span> <span data-ttu-id="ce917-149">À l’aide de ce chemin d’accès pour la surveillance, vous pouvez effectuer des vérifications spécifiques aux applications, telles que la vérification des compteurs de performance ou de la disponibilité de la base de données.</span><span class="sxs-lookup"><span data-stu-id="ce917-149">Using this path for monitoring, you can perform application-specific checks, such as checking performance counters or verifying database availability.</span></span> <span data-ttu-id="ce917-150">Sur la base de ces contrôles personnalisés, la page renvoie un code d’état HTTP approprié.</span><span class="sxs-lookup"><span data-stu-id="ce917-150">Based on these custom checks, the page returns an appropriate HTTP status code.</span></span>

<span data-ttu-id="ce917-151">Tous les points de terminaison dans un profil Traffic Manager partagent les mêmes paramètres de surveillance.</span><span class="sxs-lookup"><span data-stu-id="ce917-151">All endpoints in a Traffic Manager profile share monitoring settings.</span></span> <span data-ttu-id="ce917-152">Si vous devez utiliser différents paramètres de surveillance pour les différents points de terminaison, vous pouvez créer des [profils Traffic Manager imbriqués](traffic-manager-nested-profiles.md#example-5-per-endpoint-monitoring-settings).</span><span class="sxs-lookup"><span data-stu-id="ce917-152">If you need to use different monitoring settings for different endpoints, you can create [nested Traffic Manager profiles](traffic-manager-nested-profiles.md#example-5-per-endpoint-monitoring-settings).</span></span>

## <a name="endpoint-and-profile-status"></a><span data-ttu-id="ce917-153">État des points de terminaison et des profils</span><span class="sxs-lookup"><span data-stu-id="ce917-153">Endpoint and profile status</span></span>

<span data-ttu-id="ce917-154">Vous pouvez activer et désactiver les points de terminaison et les profils Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="ce917-154">You can enable and disable Traffic Manager profiles and endpoints.</span></span> <span data-ttu-id="ce917-155">Toutefois, un changement d’état du point de terminaison peut survenir également comme conséquence des paramètres et des processus automatisés de Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="ce917-155">However, a change in endpoint status also might occur as a result of Traffic Manager automated settings and processes.</span></span>

### <a name="endpoint-status"></a><span data-ttu-id="ce917-156">État du point de terminaison</span><span class="sxs-lookup"><span data-stu-id="ce917-156">Endpoint status</span></span>

<span data-ttu-id="ce917-157">Vous pouvez activer ou désactiver un point de terminaison spécifique.</span><span class="sxs-lookup"><span data-stu-id="ce917-157">You can enable or disable a specific endpoint.</span></span> <span data-ttu-id="ce917-158">Le service sous-jacent, qui peut toujours être sain, n’est pas affecté.</span><span class="sxs-lookup"><span data-stu-id="ce917-158">The underlying service, which might still be healthy, is unaffected.</span></span> <span data-ttu-id="ce917-159">En modifiant l’état du point de terminaison, vous contrôlez la disponibilité du point de terminaison dans le profil Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="ce917-159">Changing the endpoint status controls the availability of the endpoint in the Traffic Manager profile.</span></span> <span data-ttu-id="ce917-160">Lorsque l’état d’un point de terminaison est désactivé, Traffic Manager ne vérifie pas son intégrité et le point de terminaison n’est pas inclus dans une réponse DNS.</span><span class="sxs-lookup"><span data-stu-id="ce917-160">When an endpoint status is disabled, Traffic Manager does not check its health and the endpoint is not included in a DNS response.</span></span>

### <a name="profile-status"></a><span data-ttu-id="ce917-161">État du profil</span><span class="sxs-lookup"><span data-stu-id="ce917-161">Profile status</span></span>

<span data-ttu-id="ce917-162">En utilisant le paramètre d’état de profil, vous pouvez activer ou désactiver un profil spécifique.</span><span class="sxs-lookup"><span data-stu-id="ce917-162">Using the profile status setting, you can enable or disable a specific profile.</span></span> <span data-ttu-id="ce917-163">Alors que l’état du point de terminaison affecte un seul point de terminaison, l’état du profil affecte le profil complet, donc l’ensemble des points de terminaison.</span><span class="sxs-lookup"><span data-stu-id="ce917-163">While endpoint status affects a single endpoint, profile status affects the entire profile, including all endpoints.</span></span> <span data-ttu-id="ce917-164">Lorsque vous désactivez un profil, l’intégrité des points de terminaison n’est pas vérifiée et aucun point de terminaison n’est inclus dans une réponse DNS.</span><span class="sxs-lookup"><span data-stu-id="ce917-164">When you disable a profile, the endpoints are not checked for health and no endpoints are included in a DNS response.</span></span> <span data-ttu-id="ce917-165">Un code de réponse [NXDOMAIN](https://tools.ietf.org/html/rfc2308) est renvoyé pour la requête DNS.</span><span class="sxs-lookup"><span data-stu-id="ce917-165">An [NXDOMAIN](https://tools.ietf.org/html/rfc2308) response code is returned for the DNS query.</span></span>

### <a name="endpoint-monitor-status"></a><span data-ttu-id="ce917-166">État de surveillance des points de terminaison</span><span class="sxs-lookup"><span data-stu-id="ce917-166">Endpoint monitor status</span></span>

<span data-ttu-id="ce917-167">L’état de surveillance des points de terminaison est une valeur générée par Traffic Manager qui affiche l’état du point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="ce917-167">Endpoint monitor status is a Traffic Manager-generated value that shows the status of the endpoint.</span></span> <span data-ttu-id="ce917-168">Vous ne pouvez pas modifier ce paramètre manuellement.</span><span class="sxs-lookup"><span data-stu-id="ce917-168">You cannot change this setting manually.</span></span> <span data-ttu-id="ce917-169">L’état de surveillance des points de terminaison est une combinaison des résultats de la surveillance du point de terminaison et de l’état du point de terminaison configuré.</span><span class="sxs-lookup"><span data-stu-id="ce917-169">The endpoint monitor status is a combination of the results of endpoint monitoring and the configured endpoint status.</span></span> <span data-ttu-id="ce917-170">Les valeurs possibles de l’état de surveillance des points de terminaison sont affichées dans la table suivante :</span><span class="sxs-lookup"><span data-stu-id="ce917-170">The possible values of endpoint monitor status are shown in the following table:</span></span>

| <span data-ttu-id="ce917-171">État du profil</span><span class="sxs-lookup"><span data-stu-id="ce917-171">Profile status</span></span> | <span data-ttu-id="ce917-172">État du point de terminaison</span><span class="sxs-lookup"><span data-stu-id="ce917-172">Endpoint status</span></span> | <span data-ttu-id="ce917-173">État de surveillance des points de terminaison</span><span class="sxs-lookup"><span data-stu-id="ce917-173">Endpoint monitor status</span></span> | <span data-ttu-id="ce917-174">Remarques</span><span class="sxs-lookup"><span data-stu-id="ce917-174">Notes</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="ce917-175">Désactivé</span><span class="sxs-lookup"><span data-stu-id="ce917-175">Disabled</span></span> |<span data-ttu-id="ce917-176">Activé</span><span class="sxs-lookup"><span data-stu-id="ce917-176">Enabled</span></span> |<span data-ttu-id="ce917-177">Inactif</span><span class="sxs-lookup"><span data-stu-id="ce917-177">Inactive</span></span> |<span data-ttu-id="ce917-178">Le profil a été désactivé.</span><span class="sxs-lookup"><span data-stu-id="ce917-178">The profile has been disabled.</span></span> <span data-ttu-id="ce917-179">Même si l’état du point de terminaison est Activé, l’état du profil (Désactivé) a la priorité.</span><span class="sxs-lookup"><span data-stu-id="ce917-179">Although the endpoint status is Enabled, the profile status (Disabled) takes precedence.</span></span> <span data-ttu-id="ce917-180">Dans les profils désactivés, les points de terminaison ne sont pas surveillés.</span><span class="sxs-lookup"><span data-stu-id="ce917-180">Endpoints in disabled profiles are not monitored.</span></span> <span data-ttu-id="ce917-181">Un code de réponse NXDOMAIN est renvoyé pour la requête DNS.</span><span class="sxs-lookup"><span data-stu-id="ce917-181">An NXDOMAIN response code is returned for the DNS query.</span></span> |
| <span data-ttu-id="ce917-182">&lt;any&gt;</span><span class="sxs-lookup"><span data-stu-id="ce917-182">&lt;any&gt;</span></span> |<span data-ttu-id="ce917-183">Désactivé</span><span class="sxs-lookup"><span data-stu-id="ce917-183">Disabled</span></span> |<span data-ttu-id="ce917-184">Désactivé</span><span class="sxs-lookup"><span data-stu-id="ce917-184">Disabled</span></span> |<span data-ttu-id="ce917-185">Le point de terminaison a été désactivé.</span><span class="sxs-lookup"><span data-stu-id="ce917-185">The endpoint has been disabled.</span></span> <span data-ttu-id="ce917-186">Les points de terminaison désactivés ne sont pas surveillés.</span><span class="sxs-lookup"><span data-stu-id="ce917-186">Disabled endpoints are not monitored.</span></span> <span data-ttu-id="ce917-187">Le point de terminaison n’est pas inclus dans les réponses DNS, et par conséquent, il ne reçoit pas de trafic.</span><span class="sxs-lookup"><span data-stu-id="ce917-187">The endpoint is not included in DNS responses, therefore, it does not receive traffic.</span></span> |
| <span data-ttu-id="ce917-188">Activé</span><span class="sxs-lookup"><span data-stu-id="ce917-188">Enabled</span></span> |<span data-ttu-id="ce917-189">Activé</span><span class="sxs-lookup"><span data-stu-id="ce917-189">Enabled</span></span> |<span data-ttu-id="ce917-190">En ligne</span><span class="sxs-lookup"><span data-stu-id="ce917-190">Online</span></span> |<span data-ttu-id="ce917-191">Le point de terminaison est surveillé et sain.</span><span class="sxs-lookup"><span data-stu-id="ce917-191">The endpoint is monitored and is healthy.</span></span> <span data-ttu-id="ce917-192">Il est inclus dans les réponses DNS et peut recevoir le trafic.</span><span class="sxs-lookup"><span data-stu-id="ce917-192">It is included in DNS responses and can receive traffic.</span></span> |
| <span data-ttu-id="ce917-193">Activé</span><span class="sxs-lookup"><span data-stu-id="ce917-193">Enabled</span></span> |<span data-ttu-id="ce917-194">Activé</span><span class="sxs-lookup"><span data-stu-id="ce917-194">Enabled</span></span> |<span data-ttu-id="ce917-195">Détérioré</span><span class="sxs-lookup"><span data-stu-id="ce917-195">Degraded</span></span> |<span data-ttu-id="ce917-196">Les contrôles d’intégrité de surveillance des points de terminaison sont défaillants.</span><span class="sxs-lookup"><span data-stu-id="ce917-196">Endpoint monitoring health checks are failing.</span></span> <span data-ttu-id="ce917-197">Le point de terminaison n’est pas inclus dans les réponses DNS et ne reçoit pas de trafic.</span><span class="sxs-lookup"><span data-stu-id="ce917-197">The endpoint is not included in DNS responses and does not receive traffic.</span></span> <br><span data-ttu-id="ce917-198">Exception : si tous les points de terminaison sont défectueux, auquel cas l’on considère qu’ils sont tous renvoyés dans la réponse à la requête.</span><span class="sxs-lookup"><span data-stu-id="ce917-198">An exception to this is if all endpoints are degraded, in which case all of them are considered to be returned in the query response).</span></span></br>|
| <span data-ttu-id="ce917-199">Activé</span><span class="sxs-lookup"><span data-stu-id="ce917-199">Enabled</span></span> |<span data-ttu-id="ce917-200">Activé</span><span class="sxs-lookup"><span data-stu-id="ce917-200">Enabled</span></span> |<span data-ttu-id="ce917-201">CheckingEndpoint</span><span class="sxs-lookup"><span data-stu-id="ce917-201">CheckingEndpoint</span></span> |<span data-ttu-id="ce917-202">Le point de terminaison est surveillé, mais les résultats de la première analyse n’ont pas encore été reçus.</span><span class="sxs-lookup"><span data-stu-id="ce917-202">The endpoint is monitored, but the results of the first probe have not been received yet.</span></span> <span data-ttu-id="ce917-203">CheckingEndpoint est un état temporaire qui survient généralement immédiatement après l’ajout ou l’activation d’un point de terminaison dans le profil.</span><span class="sxs-lookup"><span data-stu-id="ce917-203">CheckingEndpoint is a temporary state that usually occurs immediately after adding or enabling an endpoint in the profile.</span></span> <span data-ttu-id="ce917-204">Un point de terminaison avec cet état est inclus dans les réponses DNS et peut recevoir le trafic.</span><span class="sxs-lookup"><span data-stu-id="ce917-204">An endpoint in this state is included in DNS responses and can receive traffic.</span></span> |
| <span data-ttu-id="ce917-205">Activé</span><span class="sxs-lookup"><span data-stu-id="ce917-205">Enabled</span></span> |<span data-ttu-id="ce917-206">Activé</span><span class="sxs-lookup"><span data-stu-id="ce917-206">Enabled</span></span> |<span data-ttu-id="ce917-207">Arrêté</span><span class="sxs-lookup"><span data-stu-id="ce917-207">Stopped</span></span> |<span data-ttu-id="ce917-208">Le service cloud ou l’application web vers lequel/laquelle le point de terminaison pointe ne s’exécute pas.</span><span class="sxs-lookup"><span data-stu-id="ce917-208">The cloud service or web app that the endpoint points to is not running.</span></span> <span data-ttu-id="ce917-209">Vérifiez les paramètres du service cloud ou de l’application web.</span><span class="sxs-lookup"><span data-stu-id="ce917-209">Check the cloud service or web app settings.</span></span> <span data-ttu-id="ce917-210">Cela peut également se produire si le point de terminaison est de type imbriqué et que le profil enfant est désactivé ou inactif.</span><span class="sxs-lookup"><span data-stu-id="ce917-210">This can also happen if the endpoint is of type nested endpoint and the child profile is disabled or is inactive.</span></span> <br><span data-ttu-id="ce917-211">Un point de terminaison avec l’état Arrêté n’est pas surveillé.</span><span class="sxs-lookup"><span data-stu-id="ce917-211">An endpoint with a Stopped status is not monitored.</span></span> <span data-ttu-id="ce917-212">Il n’est pas inclus dans les réponses DNS et ne reçoit pas de trafic.</span><span class="sxs-lookup"><span data-stu-id="ce917-212">It is not included in DNS responses and does not receive traffic.</span></span> <span data-ttu-id="ce917-213">Exception : si tous les points de terminaison sont défectueux, auquel cas l’on considère qu’ils sont tous renvoyés dans la réponse à la requête.</span><span class="sxs-lookup"><span data-stu-id="ce917-213">An exception to this is if all endpoints are degraded, in which case all of them will be considered to be returned in the query response.</span></span></br>|

<span data-ttu-id="ce917-214">Pour savoir comment l’état de surveillance des points de terminaison est calculé pour les points de terminaison imbriqués, consultez la section relative aux [profils Traffic Manager imbriqués](traffic-manager-nested-profiles.md).</span><span class="sxs-lookup"><span data-stu-id="ce917-214">For details about how endpoint monitor status is calculated for nested endpoints, see [nested Traffic Manager profiles](traffic-manager-nested-profiles.md).</span></span>

### <a name="profile-monitor-status"></a><span data-ttu-id="ce917-215">État de surveillance du profil</span><span class="sxs-lookup"><span data-stu-id="ce917-215">Profile monitor status</span></span>

<span data-ttu-id="ce917-216">L’état de surveillance du profil est une combinaison de l’état du profil configuré et des valeurs de l’état de surveillance de l’ensemble des points de terminaison.</span><span class="sxs-lookup"><span data-stu-id="ce917-216">The profile monitor status is a combination of the configured profile status and the endpoint monitor status values for all endpoints.</span></span> <span data-ttu-id="ce917-217">Les valeurs possibles sont décrites dans le tableau suivant :</span><span class="sxs-lookup"><span data-stu-id="ce917-217">The possible values are described in the following table:</span></span>

| <span data-ttu-id="ce917-218">État du profil (conformément à la configuration)</span><span class="sxs-lookup"><span data-stu-id="ce917-218">Profile status (as configured)</span></span> | <span data-ttu-id="ce917-219">État de surveillance des points de terminaison</span><span class="sxs-lookup"><span data-stu-id="ce917-219">Endpoint monitor status</span></span> | <span data-ttu-id="ce917-220">État de surveillance du profil</span><span class="sxs-lookup"><span data-stu-id="ce917-220">Profile monitor status</span></span> | <span data-ttu-id="ce917-221">Remarques</span><span class="sxs-lookup"><span data-stu-id="ce917-221">Notes</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="ce917-222">Désactivé</span><span class="sxs-lookup"><span data-stu-id="ce917-222">Disabled</span></span> |<span data-ttu-id="ce917-223">&lt;any&gt;  ou profil sans points de terminaison définis.</span><span class="sxs-lookup"><span data-stu-id="ce917-223">&lt;any&gt; or a profile with no defined endpoints.</span></span> |<span data-ttu-id="ce917-224">Désactivé</span><span class="sxs-lookup"><span data-stu-id="ce917-224">Disabled</span></span> |<span data-ttu-id="ce917-225">Le profil a été désactivé.</span><span class="sxs-lookup"><span data-stu-id="ce917-225">The profile has been disabled.</span></span> |
| <span data-ttu-id="ce917-226">Activé</span><span class="sxs-lookup"><span data-stu-id="ce917-226">Enabled</span></span> |<span data-ttu-id="ce917-227">Un ou plusieurs points de terminaison ont l’état Détérioré.</span><span class="sxs-lookup"><span data-stu-id="ce917-227">The status of at least one endpoint is Degraded.</span></span> |<span data-ttu-id="ce917-228">Détérioré</span><span class="sxs-lookup"><span data-stu-id="ce917-228">Degraded</span></span> |<span data-ttu-id="ce917-229">Passez en revue les valeurs d’état de chaque point de terminaison pour déterminer quels points de terminaison doivent être examinés.</span><span class="sxs-lookup"><span data-stu-id="ce917-229">Review the individual endpoint status values to determine which endpoints require further attention.</span></span> |
| <span data-ttu-id="ce917-230">Activé</span><span class="sxs-lookup"><span data-stu-id="ce917-230">Enabled</span></span> |<span data-ttu-id="ce917-231">Un ou plusieurs points de terminaison ont l’état En ligne.</span><span class="sxs-lookup"><span data-stu-id="ce917-231">The status of at least one endpoint is Online.</span></span> <span data-ttu-id="ce917-232">Aucun point de terminaison n’a l’état Détérioré.</span><span class="sxs-lookup"><span data-stu-id="ce917-232">No endpoints have a Degraded status.</span></span> |<span data-ttu-id="ce917-233">En ligne</span><span class="sxs-lookup"><span data-stu-id="ce917-233">Online</span></span> |<span data-ttu-id="ce917-234">Le service accepte le trafic.</span><span class="sxs-lookup"><span data-stu-id="ce917-234">The service is accepting traffic.</span></span> <span data-ttu-id="ce917-235">Aucune action supplémentaire n’est requise.</span><span class="sxs-lookup"><span data-stu-id="ce917-235">No further action is required.</span></span> |
| <span data-ttu-id="ce917-236">Activé</span><span class="sxs-lookup"><span data-stu-id="ce917-236">Enabled</span></span> |<span data-ttu-id="ce917-237">Un ou plusieurs points de terminaison ont l’état CheckingEndpoint.</span><span class="sxs-lookup"><span data-stu-id="ce917-237">The status of at least one endpoint is CheckingEndpoint.</span></span> <span data-ttu-id="ce917-238">Aucun point de terminaison n’a l’état En ligne ou Détérioré.</span><span class="sxs-lookup"><span data-stu-id="ce917-238">No endpoints are in Online or Degraded status.</span></span> |<span data-ttu-id="ce917-239">CheckingEndpoints</span><span class="sxs-lookup"><span data-stu-id="ce917-239">CheckingEndpoints</span></span> |<span data-ttu-id="ce917-240">Cet état de transition se produit lorsqu’un profil est créé ou activé.</span><span class="sxs-lookup"><span data-stu-id="ce917-240">This transition state occurs when a profile if created or enabled.</span></span> <span data-ttu-id="ce917-241">L’intégrité du point de terminaison est vérifiée pour la première fois.</span><span class="sxs-lookup"><span data-stu-id="ce917-241">The endpoint health is being checked for the first time.</span></span> |
| <span data-ttu-id="ce917-242">Activé</span><span class="sxs-lookup"><span data-stu-id="ce917-242">Enabled</span></span> |<span data-ttu-id="ce917-243">Tous les points de terminaison dans le profil ont l’état Désactivé ou Arrêté, ou le profil n’inclut aucun point de terminaison défini.</span><span class="sxs-lookup"><span data-stu-id="ce917-243">The statuses of all endpoints in the profile are either Disabled or Stopped, or the profile has no defined endpoints.</span></span> |<span data-ttu-id="ce917-244">Inactif</span><span class="sxs-lookup"><span data-stu-id="ce917-244">Inactive</span></span> |<span data-ttu-id="ce917-245">Aucun point de terminaison n’est actif, mais le profil est toujours Activé.</span><span class="sxs-lookup"><span data-stu-id="ce917-245">No endpoints are active, but the profile is still Enabled.</span></span> |

## <a name="endpoint-failover-and-recovery"></a><span data-ttu-id="ce917-246">Basculement et récupération du point de terminaison</span><span class="sxs-lookup"><span data-stu-id="ce917-246">Endpoint failover and recovery</span></span>

<span data-ttu-id="ce917-247">Traffic Manager vérifie périodiquement l’intégrité de chaque point de terminaison, y compris des points de terminaison défectueux.</span><span class="sxs-lookup"><span data-stu-id="ce917-247">Traffic Manager periodically checks the health of every endpoint, including unhealthy endpoints.</span></span> <span data-ttu-id="ce917-248">Traffic Manager détecte lorsque l’intégrité d’un point de terminaison est rétablie et ramène celui-ci en rotation.</span><span class="sxs-lookup"><span data-stu-id="ce917-248">Traffic Manager detects when an endpoint becomes healthy and brings it back into rotation.</span></span>

<span data-ttu-id="ce917-249">Un point de terminaison est défectueux lorsque l’un des événements suivants se produit :</span><span class="sxs-lookup"><span data-stu-id="ce917-249">An endpoint is unhealthy when any of the following events occur:</span></span>
- <span data-ttu-id="ce917-250">Si le protocole de surveillance est HTTP ou HTTPS :</span><span class="sxs-lookup"><span data-stu-id="ce917-250">If the monitoring protocol is HTTP or HTTPS:</span></span>
    - <span data-ttu-id="ce917-251">Réception d’une réponse autre que 200 (y compris un code 2xx différent ou une redirection 301/302).</span><span class="sxs-lookup"><span data-stu-id="ce917-251">A non-200 response is received (including a different 2xx code, or a 301/302 redirect).</span></span>
- <span data-ttu-id="ce917-252">Si le protocole de surveillance est TCP :</span><span class="sxs-lookup"><span data-stu-id="ce917-252">If the monitoring protocol is TCP:</span></span> 
    - <span data-ttu-id="ce917-253">Réception d’une réponse autre que ACK ou SYN-ACK, en réponse à la requête SYNC envoyée par Traffic Manager pour tenter d’établir une connexion.</span><span class="sxs-lookup"><span data-stu-id="ce917-253">A response other than ACK or SYN-ACK is received in response to the SYNC request sent by Traffic Manager to attempt a connection establishment.</span></span>
- <span data-ttu-id="ce917-254">Délai d’expiration.</span><span class="sxs-lookup"><span data-stu-id="ce917-254">Timeout.</span></span> 
- <span data-ttu-id="ce917-255">Tout autre problème de connexion qui fait que le point de terminaison n’est ne pas accessible.</span><span class="sxs-lookup"><span data-stu-id="ce917-255">Any other connection issue resulting in the endpoint being not reachable.</span></span>

<span data-ttu-id="ce917-256">Pour plus d’informations sur le dépannage des vérifications en échec, consultez [Résolution des problèmes liés à l’état Détérioré d’Azure Traffic Manager](traffic-manager-troubleshooting-degraded.md).</span><span class="sxs-lookup"><span data-stu-id="ce917-256">For more information about troubleshooting failed checks, see [Troubleshooting Degraded status on Azure Traffic Manager](traffic-manager-troubleshooting-degraded.md).</span></span> 

<span data-ttu-id="ce917-257">La chronologie de la Figure 2 est une description détaillée du processus de surveillance du point de terminaison de Traffic Manager, avec les paramètres suivants : le protocole de surveillance est HTTP, l’intervalle de détection est 30 secondes, le nombre d’échecs tolérés est 3, le délai d’expiration est 10 secondes et la durée de vie DNS est 30 secondes.</span><span class="sxs-lookup"><span data-stu-id="ce917-257">The following timeline in Figure 2 is a detailed description of the monitoring process of Traffic Manager endpoint that has the following settings: monitoring protocol is HTTP, probing interval is 30 seconds, number of tolerated failures is 3, timeout value is 10 seconds, and DNS TTL is 30 seconds.</span></span>

![Séquence de basculement et de restauration automatique des points de terminaison Traffic Manager](./media/traffic-manager-monitoring/timeline.png)

<span data-ttu-id="ce917-259">**Figure 2 : séquence de basculement et de récupération des points de terminaison Traffic Manager**</span><span class="sxs-lookup"><span data-stu-id="ce917-259">**Figure 2:  Traffic manager endpoint failover and recovery sequence**</span></span>

1. <span data-ttu-id="ce917-260">**GET**.</span><span class="sxs-lookup"><span data-stu-id="ce917-260">**GET**.</span></span> <span data-ttu-id="ce917-261">Pour chaque point de terminaison, le système de surveillance de Traffic Manager exécute une requête GET sur le chemin d’accès spécifié dans les paramètres de surveillance.</span><span class="sxs-lookup"><span data-stu-id="ce917-261">For each endpoint, the Traffic Manager monitoring system performs a GET request on the path specified in the monitoring settings.</span></span>
2. <span data-ttu-id="ce917-262">**200 OK**.</span><span class="sxs-lookup"><span data-stu-id="ce917-262">**200 OK**.</span></span> <span data-ttu-id="ce917-263">Le système de surveillance attend un message HTTP 200 OK dans un délai de 10 secondes.</span><span class="sxs-lookup"><span data-stu-id="ce917-263">The monitoring system expects an HTTP 200 OK message to be returned within 10 seconds.</span></span> <span data-ttu-id="ce917-264">Lorsqu’il reçoit cette réponse, il reconnaît que le service est disponible.</span><span class="sxs-lookup"><span data-stu-id="ce917-264">When it receives this response, it recognizes that the service is available.</span></span>
3. <span data-ttu-id="ce917-265">**30 secondes entre les contrôles**.</span><span class="sxs-lookup"><span data-stu-id="ce917-265">**30 seconds between checks**.</span></span> <span data-ttu-id="ce917-266">Le contrôle d’intégrité du point de terminaison est répété toutes les 30 secondes.</span><span class="sxs-lookup"><span data-stu-id="ce917-266">The endpoint health check is repeated every 30 seconds.</span></span>
4. <span data-ttu-id="ce917-267">**Service indisponible**.</span><span class="sxs-lookup"><span data-stu-id="ce917-267">**Service unavailable**.</span></span> <span data-ttu-id="ce917-268">Le service devient indisponible.</span><span class="sxs-lookup"><span data-stu-id="ce917-268">The service becomes unavailable.</span></span> <span data-ttu-id="ce917-269">Traffic Manager n’est pas averti avant le prochain contrôle d’intégrité.</span><span class="sxs-lookup"><span data-stu-id="ce917-269">Traffic Manager will not know until the next health check.</span></span>
5. <span data-ttu-id="ce917-270">**Tente d’accéder au chemin d’accès de surveillance**.</span><span class="sxs-lookup"><span data-stu-id="ce917-270">**Attempts to access the monitoring path**.</span></span> <span data-ttu-id="ce917-271">Le système de surveillance exécute une requête GET, mais ne reçoit pas de réponse au cours du délai d’expiration de 10 secondes (sinon, une réponse autre que 200 peut être reçue).</span><span class="sxs-lookup"><span data-stu-id="ce917-271">The monitoring system performs a GET request, but does not receive a response within the timeout period of 10 seconds (alternatively, a non-200 response may be received).</span></span> <span data-ttu-id="ce917-272">Il effectue ensuite trois essais supplémentaires par intervalles de 30 secondes.</span><span class="sxs-lookup"><span data-stu-id="ce917-272">It then tries three more times, at 30-second intervals.</span></span> <span data-ttu-id="ce917-273">Lorsque l’un des essais aboutit, le nombre d’essais est réinitialisé.</span><span class="sxs-lookup"><span data-stu-id="ce917-273">If one of the tries is successful, then the number of tries is reset.</span></span>
6. <span data-ttu-id="ce917-274">**État défini comme Détérioré**.</span><span class="sxs-lookup"><span data-stu-id="ce917-274">**Status set to Degraded**.</span></span> <span data-ttu-id="ce917-275">Après un quatrième échec consécutif, le système de surveillance marque l’état du point de terminaison non disponible comme Détérioré.</span><span class="sxs-lookup"><span data-stu-id="ce917-275">After a fourth consecutive failure, the monitoring system marks the unavailable endpoint status as Degraded.</span></span>
7. <span data-ttu-id="ce917-276">**Le trafic est détourné vers les autres points de terminaison**.</span><span class="sxs-lookup"><span data-stu-id="ce917-276">**Traffic is diverted to other endpoints**.</span></span> <span data-ttu-id="ce917-277">Les serveurs de noms DNS Traffic Manager sont mis à jour et Traffic Manager ne renvoie plus le point de terminaison en réponse aux requêtes DNS.</span><span class="sxs-lookup"><span data-stu-id="ce917-277">The Traffic Manager DNS name servers are updated and Traffic Manager no longer returns the endpoint in response to DNS queries.</span></span> <span data-ttu-id="ce917-278">Les nouvelles connexions sont dirigées vers les autres points de terminaison disponibles.</span><span class="sxs-lookup"><span data-stu-id="ce917-278">New connections are directed to other, available endpoints.</span></span> <span data-ttu-id="ce917-279">Toutefois, les réponses DNS précédentes incluant ce point de terminaison peuvent toujours être mises en cache par des serveurs DNS et des clients DNS récursifs.</span><span class="sxs-lookup"><span data-stu-id="ce917-279">However, previous DNS responses that include this endpoint may still be cached by recursive DNS servers and DNS clients.</span></span> <span data-ttu-id="ce917-280">Les clients continuent à utiliser le point de terminaison jusqu’à l’expiration du cache DNS.</span><span class="sxs-lookup"><span data-stu-id="ce917-280">Clients continue to use the endpoint until the DNS cache expires.</span></span> <span data-ttu-id="ce917-281">Lorsque les caches DNS expirent, les clients exécutent de nouvelles requêtes DNS et sont dirigés vers des points de terminaison différents.</span><span class="sxs-lookup"><span data-stu-id="ce917-281">As the DNS cache expires, clients make new DNS queries and are directed to different endpoints.</span></span> <span data-ttu-id="ce917-282">La durée du cache est contrôlée par le paramètre TTL dans le profil Traffic Manager (par exemple, 30 secondes).</span><span class="sxs-lookup"><span data-stu-id="ce917-282">The cache duration is controlled by the TTL setting in the Traffic Manager profile, for example, 30 seconds.</span></span>
8. <span data-ttu-id="ce917-283">**Les contrôles d’intégrité continuent**.</span><span class="sxs-lookup"><span data-stu-id="ce917-283">**Health checks continue**.</span></span> <span data-ttu-id="ce917-284">Traffic Manager continue à contrôler l’intégrité du point de terminaison pendant qu’il se trouve dans l’état Détérioré.</span><span class="sxs-lookup"><span data-stu-id="ce917-284">Traffic Manager continues to check the health of the endpoint while it has a Degraded status.</span></span> <span data-ttu-id="ce917-285">Traffic Manager détecte les points de terminaison dont l’intégrité a été restaurée.</span><span class="sxs-lookup"><span data-stu-id="ce917-285">Traffic Manager detects when the endpoint returns to health.</span></span>
9. <span data-ttu-id="ce917-286">**Le service est remis en ligne**.</span><span class="sxs-lookup"><span data-stu-id="ce917-286">**Service comes back online**.</span></span> <span data-ttu-id="ce917-287">Le service devient disponible.</span><span class="sxs-lookup"><span data-stu-id="ce917-287">The service becomes available.</span></span> <span data-ttu-id="ce917-288">Le point de terminaison conserve sont état Détérioré dans Traffic Manager jusqu’à ce que le système de surveillance effectue le contrôle d’intégrité suivant.</span><span class="sxs-lookup"><span data-stu-id="ce917-288">The endpoint retains its Degraded status in Traffic Manager until the monitoring system performs its next health check.</span></span>
10. <span data-ttu-id="ce917-289">**Le trafic vers le service est rétabli**.</span><span class="sxs-lookup"><span data-stu-id="ce917-289">**Traffic to service resumes**.</span></span> <span data-ttu-id="ce917-290">Traffic Manager envoie une requête GET et reçoit une réponse d’état 200 OK.</span><span class="sxs-lookup"><span data-stu-id="ce917-290">Traffic Manager sends a GET request and receives a 200 OK status response.</span></span> <span data-ttu-id="ce917-291">Le service a retrouvé son intégrité.</span><span class="sxs-lookup"><span data-stu-id="ce917-291">The service has returned to a healthy state.</span></span> <span data-ttu-id="ce917-292">Les serveurs de noms Traffic Manager sont mis à jour et commencent à distribuer le nom DNS du service dans les réponses DNS.</span><span class="sxs-lookup"><span data-stu-id="ce917-292">The Traffic Manager name servers are updated, and they begin to hand out the service's DNS name in DNS responses.</span></span> <span data-ttu-id="ce917-293">Le trafic retourne au point de terminaison tandis que les réponses DNS mises en cache et renvoyées vers d’autres points de terminaison expirent et que les connexions existantes à d’autres points de terminaison s’arrêtent.</span><span class="sxs-lookup"><span data-stu-id="ce917-293">Traffic returns to the endpoint as cached DNS responses that return other endpoints expire, and as existing connections to other endpoints are terminated.</span></span>

    > [!NOTE]
    > <span data-ttu-id="ce917-294">Étant donné que Traffic Manager fonctionne au niveau du DNS, il ne peut pas modifier les connexions existantes à un point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="ce917-294">Because Traffic Manager works at the DNS level, it cannot influence existing connections to any endpoint.</span></span> <span data-ttu-id="ce917-295">Lorsqu’il dirige le trafic entre les points de terminaison (en modifiant les paramètres de profil, ou lors d’un basculement ou d’une restauration automatique), Traffic Manager dirige les nouvelles connexions vers les points de terminaison disponibles.</span><span class="sxs-lookup"><span data-stu-id="ce917-295">When it directs traffic between endpoints (either by changed profile settings, or during failover or failback), Traffic Manager directs new connections to available endpoints.</span></span> <span data-ttu-id="ce917-296">Toutefois, les autres points de terminaison peuvent continuer à recevoir le trafic via les connexions existantes, jusqu’à ce que ces sessions s’arrêtent.</span><span class="sxs-lookup"><span data-stu-id="ce917-296">However, other endpoints might continue to receive traffic via existing connections until those sessions are terminated.</span></span> <span data-ttu-id="ce917-297">Pour libérer le trafic à partir des connexions existantes, les applications doivent limiter la durée de session utilisée avec chaque point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="ce917-297">To enable traffic to drain from existing connections, applications should limit the session duration used with each endpoint.</span></span>

## <a name="traffic-routing-methods"></a><span data-ttu-id="ce917-298">Méthodes de routage du trafic</span><span class="sxs-lookup"><span data-stu-id="ce917-298">Traffic-routing methods</span></span>

<span data-ttu-id="ce917-299">Lorsqu’un point de terminaison est détérioré, il n’est plus renvoyé en réponse aux requêtes DNS.</span><span class="sxs-lookup"><span data-stu-id="ce917-299">When an endpoint has a Degraded status, it is no longer returned in response to DNS queries.</span></span> <span data-ttu-id="ce917-300">Au lieu de cela, un autre point de terminaison est choisi et renvoyé.</span><span class="sxs-lookup"><span data-stu-id="ce917-300">Instead, an alternative endpoint is chosen and returned.</span></span> <span data-ttu-id="ce917-301">La méthode de routage du trafic configurée dans le profil détermine la manière dont le point de terminaison de remplacement est sélectionné.</span><span class="sxs-lookup"><span data-stu-id="ce917-301">The traffic-routing method configured in the profile determines how the alternative endpoint is chosen.</span></span>

* <span data-ttu-id="ce917-302">**Priorité**.</span><span class="sxs-lookup"><span data-stu-id="ce917-302">**Priority**.</span></span> <span data-ttu-id="ce917-303">Les points de terminaison forment une liste hiérarchisée.</span><span class="sxs-lookup"><span data-stu-id="ce917-303">Endpoints form a prioritized list.</span></span> <span data-ttu-id="ce917-304">Le premier point de terminaison disponible sur la liste est toujours renvoyé.</span><span class="sxs-lookup"><span data-stu-id="ce917-304">The first available endpoint on the list is always returned.</span></span> <span data-ttu-id="ce917-305">Si l’état d’un point de terminaison est Détérioré, alors le point de terminaison disponible suivant est renvoyé.</span><span class="sxs-lookup"><span data-stu-id="ce917-305">If an endpoint status is Degraded, then the next available endpoint is returned.</span></span>
* <span data-ttu-id="ce917-306">**Pondération**.</span><span class="sxs-lookup"><span data-stu-id="ce917-306">**Weighted**.</span></span> <span data-ttu-id="ce917-307">Le point de terminaison de remplacement est choisi de façon aléatoire parmi tous les points de terminaison disponibles en fonction des pondérations qui leur ont été affectées et des pondérations des autres points de terminaison disponibles.</span><span class="sxs-lookup"><span data-stu-id="ce917-307">Any available endpoint is chosen at random based on their assigned weights and the weights of the other available endpoints.</span></span>
* <span data-ttu-id="ce917-308">**Performances**.</span><span class="sxs-lookup"><span data-stu-id="ce917-308">**Performance**.</span></span> <span data-ttu-id="ce917-309">Le point de terminaison le plus proche de l’utilisateur final est renvoyé.</span><span class="sxs-lookup"><span data-stu-id="ce917-309">The endpoint closest to the end user is returned.</span></span> <span data-ttu-id="ce917-310">Si ce point de terminaison est indisponible, un point de terminaison est choisi de façon aléatoire parmi tous les autres points de terminaison disponibles.</span><span class="sxs-lookup"><span data-stu-id="ce917-310">If that endpoint is unavailable, an endpoint is randomly chosen from all the other available endpoints.</span></span> <span data-ttu-id="ce917-311">En choisissant un point de terminaison aléatoire, le système évite une défaillance en cascade qui peut se produire lorsque le point de terminaison suivant le plus proche est surchargé.</span><span class="sxs-lookup"><span data-stu-id="ce917-311">Choosing a random endpoint avoids a cascading failure that can occur when the next-closest endpoint becomes overloaded.</span></span> <span data-ttu-id="ce917-312">Vous pouvez configurer d’autres plans de basculement pour le routage du trafic à l’aide des [profils Traffic Manager imbriqués](traffic-manager-nested-profiles.md#example-4-controlling-performance-traffic-routing-between-multiple-endpoints-in-the-same-region).</span><span class="sxs-lookup"><span data-stu-id="ce917-312">You can configure alternative failover plans for performance traffic-routing by using [nested Traffic Manager profiles](traffic-manager-nested-profiles.md#example-4-controlling-performance-traffic-routing-between-multiple-endpoints-in-the-same-region).</span></span>
* <span data-ttu-id="ce917-313">**Géographique**.</span><span class="sxs-lookup"><span data-stu-id="ce917-313">**Geographic**.</span></span> <span data-ttu-id="ce917-314">Le point de terminaison mappé pour servir la zone géographique en fonction de l’adresse IP de la requête est renvoyé.</span><span class="sxs-lookup"><span data-stu-id="ce917-314">The endpoint mapped to serve the geographic location based on the query request IP’s is returned.</span></span> <span data-ttu-id="ce917-315">Si ce point de terminaison n’est pas disponible, aucun autre point de terminaison ne sera sélectionné pour le basculement, car un emplacement géographique ne peut être mappé qu’à un seul point de terminaison dans un profil (plus de détails dans la rubrique [FAQ](traffic-manager-FAQs.md#traffic-manager-geographic-traffic-routing-method)).</span><span class="sxs-lookup"><span data-stu-id="ce917-315">If that endpoint is unavailable, another endpoint will not be selected to failover to, since a geographic location can be mapped only to one endpoint in a profile (more details are in the [FAQ](traffic-manager-FAQs.md#traffic-manager-geographic-traffic-routing-method)).</span></span> <span data-ttu-id="ce917-316">Lorsque le routage géographique est utilisé, nous recommandons aux clients d’utiliser des profiles Traffic Manager imbriqués avec plusieurs points de terminaison comme points de terminaison du profil.</span><span class="sxs-lookup"><span data-stu-id="ce917-316">As a best practice, when using geographic routing, we recommend customers to use nested Traffic Manager profiles with more than one endpoint as the endpoints of the profile.</span></span>

<span data-ttu-id="ce917-317">Pour plus d’informations, consultez la rubrique relative aux [méthodes de routage du trafic dans Traffic Manager](traffic-manager-routing-methods.md).</span><span class="sxs-lookup"><span data-stu-id="ce917-317">For more information, see [Traffic Manager traffic-routing methods](traffic-manager-routing-methods.md).</span></span>

> [!NOTE]
> <span data-ttu-id="ce917-318">Une exception au comportement normal de routage du trafic se produit lorsque tous les points de terminaison éligibles sont détériorés.</span><span class="sxs-lookup"><span data-stu-id="ce917-318">One exception to normal traffic-routing behavior occurs when all eligible endpoints have a degraded status.</span></span> <span data-ttu-id="ce917-319">Traffic Manager effectue alors un service de type « meilleur effort » et *réagit comme si tous les points de terminaison présentant un état Détérioré étaient en fait en ligne*.</span><span class="sxs-lookup"><span data-stu-id="ce917-319">Traffic Manager makes a "best effort" attempt and *responds as if all the Degraded status endpoints actually are in an online state*.</span></span> <span data-ttu-id="ce917-320">Ce comportement est préférable à l’autre solution, qui serait de ne renvoyer aucun point de terminaison dans la réponse DNS.</span><span class="sxs-lookup"><span data-stu-id="ce917-320">This behavior is preferable to the alternative, which would be to not return any endpoint in the DNS response.</span></span> <span data-ttu-id="ce917-321">Les points de terminaison désactivés ou arrêtés ne sont pas surveillés et ne sont par conséquent pas éligibles pour le trafic.</span><span class="sxs-lookup"><span data-stu-id="ce917-321">Disabled or Stopped endpoints are not monitored, therefore, they are not considered eligible for traffic.</span></span>
>
> <span data-ttu-id="ce917-322">Cette situation est généralement due à une configuration incorrecte du service, par exemple :</span><span class="sxs-lookup"><span data-stu-id="ce917-322">This condition is commonly caused by improper configuration of the service, such as:</span></span>
>
> * <span data-ttu-id="ce917-323">Une ACL bloque les contrôles d’intégrité de Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="ce917-323">An access control list [ACL] blocking the Traffic Manager health checks.</span></span>
> * <span data-ttu-id="ce917-324">Une mauvaise configuration du port ou du protocole de surveillance dans le profil Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="ce917-324">An improper configuration of the monitoring port or protocol in the Traffic manager profile.</span></span>
>
> <span data-ttu-id="ce917-325">La conséquence de ce comportement est la suivante : lorsque les contrôles d’intégrité de Traffic Manager ne sont pas configurés correctement, du point de vue du routage du trafic il semble que Traffic Manager *fonctionne* correctement.</span><span class="sxs-lookup"><span data-stu-id="ce917-325">The consequence of this behavior is that if Traffic Manager health checks are not configured correctly, it might appear from the traffic routing as though Traffic Manager *is* working properly.</span></span> <span data-ttu-id="ce917-326">Toutefois, dans ce cas, le basculement de point de terminaison ne peut pas se produire, ce qui affecte la disponibilité globale de l’application.</span><span class="sxs-lookup"><span data-stu-id="ce917-326">However, in this case, endpoint failover cannot happen which affects overall application availability.</span></span> <span data-ttu-id="ce917-327">Il est donc important de vérifier que le profil affiche un état En ligne et non Détérioré.</span><span class="sxs-lookup"><span data-stu-id="ce917-327">It is important to check that the profile shows an Online status, not a Degraded status.</span></span> <span data-ttu-id="ce917-328">L’état En ligne indique que les contrôles d’intégrité de Traffic Manager fonctionnent comme prévu.</span><span class="sxs-lookup"><span data-stu-id="ce917-328">An Online status indicates that the Traffic Manager health checks are working as expected.</span></span>

<span data-ttu-id="ce917-329">Pour plus d’informations sur le dépannage des contrôles d’intégrité, consultez la section [Résolution des problèmes liés à l’état Détérioré d’Azure Traffic Manager](traffic-manager-troubleshooting-degraded.md).</span><span class="sxs-lookup"><span data-stu-id="ce917-329">For more information about troubleshooting failed health checks, see [Troubleshooting Degraded status on Azure Traffic Manager](traffic-manager-troubleshooting-degraded.md).</span></span>



## <a name="next-steps"></a><span data-ttu-id="ce917-330">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="ce917-330">Next steps</span></span>

<span data-ttu-id="ce917-331">En savoir plus sur le [fonctionnement de Traffic Manager](traffic-manager-how-traffic-manager-works.md)</span><span class="sxs-lookup"><span data-stu-id="ce917-331">Learn [how Traffic Manager works](traffic-manager-how-traffic-manager-works.md)</span></span>

<span data-ttu-id="ce917-332">En savoir plus sur les [méthodes de routage du trafic](traffic-manager-routing-methods.md) prises en charge par Traffic Manager</span><span class="sxs-lookup"><span data-stu-id="ce917-332">Learn more about the [traffic-routing methods](traffic-manager-routing-methods.md) supported by Traffic Manager</span></span>

<span data-ttu-id="ce917-333">En savoir plus sur la [création d’un profil Traffic Manager](traffic-manager-manage-profiles.md)</span><span class="sxs-lookup"><span data-stu-id="ce917-333">Learn how to [create a Traffic Manager profile](traffic-manager-manage-profiles.md)</span></span>

<span data-ttu-id="ce917-334">[Résolution des problèmes liés à l’état Détérioré](traffic-manager-troubleshooting-degraded.md) sur un point de terminaison Traffic Manager</span><span class="sxs-lookup"><span data-stu-id="ce917-334">[Troubleshoot Degraded status](traffic-manager-troubleshooting-degraded.md) on a Traffic Manager endpoint</span></span>
