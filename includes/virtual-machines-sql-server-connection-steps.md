### <a name="open-tcp-ports-in-the-windows-firewall-for-the-default-instance-of-the-database-engine"></a><span data-ttu-id="49bef-101">Ouverture de ports TCP dans le pare-feu Windows pour l'instance par défaut du moteur de base de données</span><span class="sxs-lookup"><span data-stu-id="49bef-101">Open TCP ports in the Windows firewall for the default instance of the Database Engine</span></span>
1. <span data-ttu-id="49bef-102">Connectez-vous à la machine virtuelle avec le Bureau à distance.</span><span class="sxs-lookup"><span data-stu-id="49bef-102">Connect to the virtual machine with Remote Desktop.</span></span> <span data-ttu-id="49bef-103">Pour obtenir des instructions détaillées sur la connexion à la machine virtuelle, consultez [Ouvrir la machine virtuelle à l’aide du Bureau à distance](../articles/virtual-machines/windows/sql/virtual-machines-windows-portal-sql-server-provision.md#open-the-vm-with-remote-desktop).</span><span class="sxs-lookup"><span data-stu-id="49bef-103">For detailed instructions on connecting to the VM, see [Open a SQL VM with Remote Desktop](../articles/virtual-machines/windows/sql/virtual-machines-windows-portal-sql-server-provision.md#open-the-vm-with-remote-desktop).</span></span>
2. <span data-ttu-id="49bef-104">Une fois connecté, sur l’écran d’accueil, tapez **WF.msc**, puis appuyez sur ENTRÉE.</span><span class="sxs-lookup"><span data-stu-id="49bef-104">Once logged in, at the Start screen, type **WF.msc**, and then hit ENTER.</span></span>
   
    ![Démarrer le programme du pare-feu](./media/virtual-machines-sql-server-connection-steps/12Open-WF.png)
3. <span data-ttu-id="49bef-106">Dans le **Pare-feu Windows avec fonctions avancées de sécurité**, dans le volet gauche, cliquez avec le bouton droit sur **Règles de trafic entrant**, puis sur **Nouvelle règle** dans le volet d’action.</span><span class="sxs-lookup"><span data-stu-id="49bef-106">In the **Windows Firewall with Advanced Security**, in the left pane, right-click **Inbound Rules**, and then click **New Rule** in the action pane.</span></span>
   
    ![Nouvelle règle](./media/virtual-machines-sql-server-connection-steps/13New-FW-Rule.png)
4. <span data-ttu-id="49bef-108">Dans la boîte de dialogue de **Assistant Nouvelle règle de trafic entrant**, sous **Type de règle**, sélectionnez **Port**, puis cliquez sur **Suivant**.</span><span class="sxs-lookup"><span data-stu-id="49bef-108">In the **New Inbound Rule Wizard** dialog box, under **Rule Type**, select **Port**, and then click **Next**.</span></span>
5. <span data-ttu-id="49bef-109">Dans la boîte de dialogue **Protocole et ports**, utilisez le paramètre par défaut **TCP**.</span><span class="sxs-lookup"><span data-stu-id="49bef-109">In the **Protocol and Ports** dialog, use the default **TCP**.</span></span> <span data-ttu-id="49bef-110">Dans la boîte de dialogue **Ports locaux spécifiques**, entrez le numéro de port de l’instance du moteur de base de données (**1433** pour l’instance par défaut, ou le numéro que vous avez choisi pour le port privé à l’étape du point de terminaison).</span><span class="sxs-lookup"><span data-stu-id="49bef-110">In the **Specific local ports** box, then type the port number of the instance of the Database Engine (**1433** for the default instance or your choice for the private port in the endpoint step).</span></span>
   
    ![Port TCP 1433](./media/virtual-machines-sql-server-connection-steps/14Port-1433.png)
6. <span data-ttu-id="49bef-112">Cliquez sur **Suivant**.</span><span class="sxs-lookup"><span data-stu-id="49bef-112">Click **Next**.</span></span>
7. <span data-ttu-id="49bef-113">Dans la boîte de dialogue **Action**, sélectionnez **Autoriser la connexion**, puis cliquez sur **Suivant**.</span><span class="sxs-lookup"><span data-stu-id="49bef-113">In the **Action** dialog box, select **Allow the connection**, and then click **Next**.</span></span>
   
    <span data-ttu-id="49bef-114">**Remarque relative à la sécurité** : la sélection de l’option **Autoriser la connexion si elle est sécurisée** peut renforcer la sécurité.</span><span class="sxs-lookup"><span data-stu-id="49bef-114">**Security Note:** Selecting **Allow the connection if it is secure** can provide additional security.</span></span> <span data-ttu-id="49bef-115">Sélectionnez cette option si vous voulez configurer des options de sécurité supplémentaires dans votre environnement.</span><span class="sxs-lookup"><span data-stu-id="49bef-115">Select this option if you want to configure additional security options in your environment.</span></span>
   
    ![Autoriser les connexions](./media/virtual-machines-sql-server-connection-steps/15Allow-Connection.png)
8. <span data-ttu-id="49bef-117">Dans la boîte de dialogue **Profil**, sélectionnez **Public**, **Privé** et **Domaine**.</span><span class="sxs-lookup"><span data-stu-id="49bef-117">In the **Profile** dialog box, select **Public**, **Private**, and **Domain**.</span></span> <span data-ttu-id="49bef-118">Cliquez ensuite sur **Suivant**.</span><span class="sxs-lookup"><span data-stu-id="49bef-118">Then click **Next**.</span></span>
   
    <span data-ttu-id="49bef-119">**Remarque relative à la sécurité** : la sélection de l’option **Public** autorise l’accès via Internet.</span><span class="sxs-lookup"><span data-stu-id="49bef-119">**Security Note:**  Selecting **Public** allows access over the internet.</span></span> <span data-ttu-id="49bef-120">Lorsque cela est possible, sélectionnez un profil plus restrictif.</span><span class="sxs-lookup"><span data-stu-id="49bef-120">Whenever possible, select a more restrictive profile.</span></span>
   
    ![Profil public](./media/virtual-machines-sql-server-connection-steps/16Public-Private-Domain-Profile.png)
9. <span data-ttu-id="49bef-122">Dans la boîte de dialogue **Nom**, entrez un nom et une description pour cette règle, puis cliquez sur **Terminer**.</span><span class="sxs-lookup"><span data-stu-id="49bef-122">In the **Name** dialog box, type a name and description for this rule, and then click **Finish**.</span></span>
   
    ![Nom de la règle](./media/virtual-machines-sql-server-connection-steps/17Rule-Name.png)

<span data-ttu-id="49bef-124">Le cas échéant, ouvrez des ports supplémentaires pour les autres composants.</span><span class="sxs-lookup"><span data-stu-id="49bef-124">Open additional ports for other components as needed.</span></span> <span data-ttu-id="49bef-125">Pour plus d'informations, consultez la page [Configurer le Pare-feu Windows pour autoriser l'accès à SQL Server](http://msdn.microsoft.com/library/cc646023.aspx).</span><span class="sxs-lookup"><span data-stu-id="49bef-125">For more information, see [Configuring the Windows Firewall to Allow SQL Server Access](http://msdn.microsoft.com/library/cc646023.aspx).</span></span>

### <a name="configure-sql-server-to-listen-on-the-tcp-protocol"></a><span data-ttu-id="49bef-126">Configuration de SQL Server pour écouter le protocole TCP</span><span class="sxs-lookup"><span data-stu-id="49bef-126">Configure SQL Server to listen on the TCP protocol</span></span>

[!INCLUDE [Enable TCP](virtual-machines-sql-server-connection-tcp-protocol.md)]

### <a name="configure-sql-server-for-mixed-mode-authentication"></a><span data-ttu-id="49bef-127">Configuration de SQL Server pour l'authentification en mode mixte</span><span class="sxs-lookup"><span data-stu-id="49bef-127">Configure SQL Server for mixed mode authentication</span></span>
<span data-ttu-id="49bef-128">Le moteur de base de données de SQL Server ne peut pas utiliser l'authentification Windows sans un environnement de domaine.</span><span class="sxs-lookup"><span data-stu-id="49bef-128">The SQL Server Database Engine cannot use Windows Authentication without domain environment.</span></span> <span data-ttu-id="49bef-129">Pour vous connecter au moteur de base de données à partir d'un autre ordinateur, configurez SQL Server pour l'authentification en mode mixte</span><span class="sxs-lookup"><span data-stu-id="49bef-129">To connect to the Database Engine from another computer, configure SQL Server for mixed mode authentication.</span></span> <span data-ttu-id="49bef-130">qui permet l'authentification SQL Server et l'authentification Windows</span><span class="sxs-lookup"><span data-stu-id="49bef-130">Mixed mode authentication allows both SQL Server Authentication and Windows Authentication.</span></span>

> [!NOTE]
> <span data-ttu-id="49bef-131">(il n’est pas nécessaire de configurer l’authentification en mode mixte si vous avez configuré un réseau virtuel Azure avec un environnement de domaine configuré).</span><span class="sxs-lookup"><span data-stu-id="49bef-131">Configuring mixed mode authentication might not be necessary if you have configured an Azure Virtual Network with a configured domain environment.</span></span>
> 
> 

1. <span data-ttu-id="49bef-132">Lorsque vous êtes connecté à la machine virtuelle, sur la page de démarrage, tapez **SQL Server Management Studio** et cliquez sur l’icône sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="49bef-132">While connected to the virtual machine, on the Start page, type **SQL Server Management Studio** and click the selected icon.</span></span>
   
    <span data-ttu-id="49bef-133">Lorsque vous ouvrez Management Studio pour la première fois, il doit créer l’environnement Management Studio pour les utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="49bef-133">The first time you open Management Studio it must create the users Management Studio environment.</span></span> <span data-ttu-id="49bef-134">Cette opération peut prendre du temps.</span><span class="sxs-lookup"><span data-stu-id="49bef-134">This may take a few moments.</span></span>
2. <span data-ttu-id="49bef-135">Management Studio affiche la boîte de dialogue **Se connecter au serveur** .</span><span class="sxs-lookup"><span data-stu-id="49bef-135">Management Studio presents the **Connect to Server** dialog box.</span></span> <span data-ttu-id="49bef-136">Dans la zone **Nom du serveur**, tapez le nom de la machine virtuelle pour vous connecter au moteur de base de données avec l’explorateur d’objets (au lieu du nom de machine virtuelle, vous pouvez également utiliser **(local)** ou un simple point unique comme **nom du serveur**).</span><span class="sxs-lookup"><span data-stu-id="49bef-136">In the **Server name** box, type the name of the virtual machine to connect to the Database Engine  with the Object Explorer (Instead of the virtual machine name you can also use **(local)** or a single period as the **Server name**).</span></span> <span data-ttu-id="49bef-137">Sélectionnez **Authentification Windows** et laissez ***your_VM_name*\your_local_administrator** dans la zone **Nom d’utilisateur**.</span><span class="sxs-lookup"><span data-stu-id="49bef-137">Select **Windows Authentication**, and leave ***your_VM_name*\your_local_administrator** in the **User name** box.</span></span> <span data-ttu-id="49bef-138">Cliquez sur **Connecter**.</span><span class="sxs-lookup"><span data-stu-id="49bef-138">Click **Connect**.</span></span>
   
    ![Se connecter au serveur](./media/virtual-machines-sql-server-connection-steps/19Connect-to-Server.png)
3. <span data-ttu-id="49bef-140">Dans SQL Server Management Studio Object Explorer, cliquez avec le bouton droit sur le nom de l'instance de SQL Server (le nom de la machine virtuelle), puis cliquez sur **Propriétés**.</span><span class="sxs-lookup"><span data-stu-id="49bef-140">In SQL Server Management Studio Object Explorer, right-click the name of the instance of SQL Server (the virtual machine name), and then click **Properties**.</span></span>
   
    ![Propriétés de serveur](./media/virtual-machines-sql-server-connection-steps/20Server-Properties.png)
4. <span data-ttu-id="49bef-142">Dans la page **Sécurité**, sous **Authentification du serveur**, sélectionnez **Mode d’authentification SQL Server et Windows**, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="49bef-142">On the **Security** page, under **Server authentication**, select **SQL Server and Windows Authentication mode**, and then click **OK**.</span></span>
   
    ![Sélectionner le mode d'authentification](./media/virtual-machines-sql-server-connection-steps/21Mixed-Mode.png)
5. <span data-ttu-id="49bef-144">Dans la boîte de dialogue SQL Server Management Studio, cliquez sur **OK** pour confirmer l'obligation de redémarrer SQL Server.</span><span class="sxs-lookup"><span data-stu-id="49bef-144">In the SQL Server Management Studio dialog box, click **OK** to acknowledge the requirement to restart SQL Server.</span></span>
6. <span data-ttu-id="49bef-145">Dans l’Explorateur d’objets, cliquez avec le bouton droit sur votre serveur, puis cliquez sur **Redémarrer**.</span><span class="sxs-lookup"><span data-stu-id="49bef-145">In Object Explorer, right-click your server, and then click **Restart**.</span></span> <span data-ttu-id="49bef-146">(si SQL Server Agent est exécuté, il doit également être redémarré).</span><span class="sxs-lookup"><span data-stu-id="49bef-146">(If SQL Server Agent is running, it must also be restarted.)</span></span>
   
    ![Redémarrer](./media/virtual-machines-sql-server-connection-steps/22Restart2.png)
7. <span data-ttu-id="49bef-148">Dans la boîte de dialogue SQL Server Management Studio, cliquez sur **Oui** pour confirmer que vous voulez redémarrer SQL Server.</span><span class="sxs-lookup"><span data-stu-id="49bef-148">In the SQL Server Management Studio dialog box, click **Yes** to agree that you want to restart SQL Server.</span></span>

### <a name="create-sql-server-authentication-logins"></a><span data-ttu-id="49bef-149">Création de connexions d'authentification SQL Server</span><span class="sxs-lookup"><span data-stu-id="49bef-149">Create SQL Server authentication logins</span></span>
<span data-ttu-id="49bef-150">Pour vous connecter au moteur de base de données à partir d'un autre ordinateur, vous devez créer au moins une connexion d'authentification SQL Server.</span><span class="sxs-lookup"><span data-stu-id="49bef-150">To connect to the Database Engine from another computer, you must create at least one SQL Server authentication login.</span></span>

1. <span data-ttu-id="49bef-151">Dans SQL Server Management Studio Object Explorer, développez le dossier de l'instance de serveur dans laquelle vous voulez créer la connexion.</span><span class="sxs-lookup"><span data-stu-id="49bef-151">In SQL Server Management Studio Object Explorer, expand the folder of the server instance in which you want to create the new login.</span></span>
2. <span data-ttu-id="49bef-152">Cliquez avec le bouton droit sur le dossier **Sécurité**, pointez sur **Nouveau**, puis sélectionnez **Connexion...**.</span><span class="sxs-lookup"><span data-stu-id="49bef-152">Right-click the **Security** folder, point to **New**, and select **Login...**.</span></span>
   
    ![Nouvelle connexion](./media/virtual-machines-sql-server-connection-steps/23New-Login.png)
3. <span data-ttu-id="49bef-154">Dans la boîte de dialogue **Nouvelle connexion**, sur la page **Général**, entrez le nom du nouvel utilisateur dans la zone **Nom de connexion**.</span><span class="sxs-lookup"><span data-stu-id="49bef-154">In the **Login - New** dialog box, on the **General** page, enter the name of the new user in the **Login name** box.</span></span>
4. <span data-ttu-id="49bef-155">Sélectionnez **Authentification SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="49bef-155">Select **SQL Server authentication**.</span></span>
5. <span data-ttu-id="49bef-156">Dans la zone **Mot de passe** , entrez un mot de passe pour le nouvel utilisateur.</span><span class="sxs-lookup"><span data-stu-id="49bef-156">In the **Password** box, enter a password for the new user.</span></span> <span data-ttu-id="49bef-157">Entrez de nouveau ce mot de passe dans la zone **Confirmer le mot de passe** .</span><span class="sxs-lookup"><span data-stu-id="49bef-157">Enter that password again into the **Confirm Password** box.</span></span>
6. <span data-ttu-id="49bef-158">Sélectionnez les options de mise en œuvre de mot de passe nécessaires (**Appliquer la stratégie de mot de passe**, **Appliquer l’expiration du mot de passe**, et **L’utilisateur doit changer de mot de passe à la prochaine connexion**).</span><span class="sxs-lookup"><span data-stu-id="49bef-158">Select the password enforcement options required (**Enforce password policy**, **Enforce password expiration**, and **User must change password at next login**).</span></span> <span data-ttu-id="49bef-159">Si vous utilisez cette connexion pour vous-même, il est inutile d’exiger un mot de passe à la prochaine connexion.</span><span class="sxs-lookup"><span data-stu-id="49bef-159">If you are using this login for yourself, you do not need to require a password change at the next login.</span></span>
7. <span data-ttu-id="49bef-160">Dans la liste **Base de données par défaut** , sélectionnez une base de données par défaut pour la connexion.</span><span class="sxs-lookup"><span data-stu-id="49bef-160">From the **Default database** list, select a default database for the login.</span></span> <span data-ttu-id="49bef-161">**principale** .</span><span class="sxs-lookup"><span data-stu-id="49bef-161">**master** is the default for this option.</span></span> <span data-ttu-id="49bef-162">Si vous n'avez pas encore créé de base de données d'utilisateur, gardez la valeur par défaut **master**.</span><span class="sxs-lookup"><span data-stu-id="49bef-162">If you have not yet created a user database, leave this set to **master**.</span></span>
   
    ![Propriétés de connexion](./media/virtual-machines-sql-server-connection-steps/24Test-Login.png)
8. <span data-ttu-id="49bef-164">S’il s’agit de votre première connexion, vous pouvez désigner cette connexion en tant qu’administrateur SQL Server.</span><span class="sxs-lookup"><span data-stu-id="49bef-164">If this is the first login you are creating, you may want to designate this login as a SQL Server administrator.</span></span> <span data-ttu-id="49bef-165">Si tel est le cas, sur la page **Rôles du serveur**, activez la case à cocher **administrateur système**.</span><span class="sxs-lookup"><span data-stu-id="49bef-165">If so, on the **Server Roles** page, check **sysadmin**.</span></span>
   
   > [!NOTE]
   > <span data-ttu-id="49bef-166">les membres du rôle serveur administrateur système fixe contrôlent complètement le moteur de base de données.</span><span class="sxs-lookup"><span data-stu-id="49bef-166">Members of the sysadmin fixed server role have complete control of the Database Engine.</span></span> <span data-ttu-id="49bef-167">Vous devez limiter soigneusement l'appartenance à ce rôle.</span><span class="sxs-lookup"><span data-stu-id="49bef-167">You should carefully restrict membership in this role.</span></span>
   > 
   > 
   
   ![administrateur système](./media/virtual-machines-sql-server-connection-steps/25sysadmin.png)
9. <span data-ttu-id="49bef-169">Cliquez sur OK.</span><span class="sxs-lookup"><span data-stu-id="49bef-169">Click OK.</span></span>

<span data-ttu-id="49bef-170">Pour plus d'informations sur les connexions SQL Server, consultez la page [Créer un compte de connexion](http://msdn.microsoft.com/library/aa337562.aspx).</span><span class="sxs-lookup"><span data-stu-id="49bef-170">For more information about SQL Server logins, see [Create a Login](http://msdn.microsoft.com/library/aa337562.aspx).</span></span>

