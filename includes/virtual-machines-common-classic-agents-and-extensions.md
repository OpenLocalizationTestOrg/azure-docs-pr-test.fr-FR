

<span data-ttu-id="2bc42-101">Les extensions de machine virtuelle peuvent vous aider à :</span><span class="sxs-lookup"><span data-stu-id="2bc42-101">VM extensions can help you:</span></span>

* <span data-ttu-id="2bc42-102">modifier les fonctionnalités de sécurité et d'identité telles que la réinitialisation des valeurs de compte et l'utilisation de logiciels anti-programmes malveillants ;</span><span class="sxs-lookup"><span data-stu-id="2bc42-102">Modify security and identity features, such as resetting account values and using antimalware</span></span>
* <span data-ttu-id="2bc42-103">démarrer, arrêter ou configurer la surveillance et les diagnostics ;</span><span class="sxs-lookup"><span data-stu-id="2bc42-103">Start, stop, or configure monitoring and diagnostics</span></span>
* <span data-ttu-id="2bc42-104">réinitialiser ou installer des fonctionnalités de connectivité, telles que RDP et SSH ;</span><span class="sxs-lookup"><span data-stu-id="2bc42-104">Reset or install connectivity features, such as RDP and SSH</span></span>
* <span data-ttu-id="2bc42-105">diagnostiquer, surveiller et gérer vos machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="2bc42-105">Diagnose, monitor, and manage your VMs</span></span>

<span data-ttu-id="2bc42-106">Il existe de nombreuses autres fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="2bc42-106">There are many other features as well.</span></span> <span data-ttu-id="2bc42-107">De nouvelles fonctionnalités d’extension de machine virtuelle sont publiées régulièrement.</span><span class="sxs-lookup"><span data-stu-id="2bc42-107">New VM Extension features are released regularly.</span></span> <span data-ttu-id="2bc42-108">Cet article décrit les agents de machine virtuelle Azure pour Windows et Linux, et la manière dont ils prennent en charge la fonctionnalité d'extension de machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="2bc42-108">This article describes the Azure VM Agents for Windows and Linux, and how they support VM Extension functionality.</span></span> <span data-ttu-id="2bc42-109">Pour obtenir une liste des extensions de machine virtuelle par catégorie de fonctionnalité, consultez l’article [Fonctionnalités et extensions de machine virtuelle Azure](../articles/virtual-machines/windows/extensions-features.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="2bc42-109">For a listing of VM Extensions by feature category, see [Azure VM Extensions and Features](../articles/virtual-machines/windows/extensions-features.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>

## <a name="azure-vm-agents-for-windows-and-linux"></a><span data-ttu-id="2bc42-110">Agents de machine virtuelle Azure pour Windows et Linux</span><span class="sxs-lookup"><span data-stu-id="2bc42-110">Azure VM Agents for Windows and Linux</span></span>
<span data-ttu-id="2bc42-111">L'agent de machines virtuelles Azure (VM Agent) est un processus léger et sécurisé qui installe, configure et supprime des extensions de machine virtuelle sur des instances de machines virtuelles Azure.</span><span class="sxs-lookup"><span data-stu-id="2bc42-111">The Azure Virtual Machines Agent (VM Agent) is a secured, light-weight process that installs, configures, and removes VM extensions on instances of Azure Virtual Machines.</span></span> <span data-ttu-id="2bc42-112">L'agent de machine virtuelle joue le rôle du service de contrôle local sécurisé pour votre machine virtuelle Azure.</span><span class="sxs-lookup"><span data-stu-id="2bc42-112">The VM Agent acts as the secure local control service for your Azure VM.</span></span> <span data-ttu-id="2bc42-113">Les extensions chargées par l'agent fournissent des fonctionnalités spécifiques pour augmenter votre productivité à l'aide de l'instance.</span><span class="sxs-lookup"><span data-stu-id="2bc42-113">The extensions that the agent loads provide specific features to increase your productivity using the instance.</span></span>

<span data-ttu-id="2bc42-114">Il existe deux agents de machine virtuelle Azure, un pour les machines virtuelles Windows et l'autre pour les machines virtuelles Linux.</span><span class="sxs-lookup"><span data-stu-id="2bc42-114">Two Azure VM Agents exist, one for Windows VMs and one for Linux VMs.</span></span>

<span data-ttu-id="2bc42-115">Si vous souhaitez qu’une instance de machine virtuelle utilise une ou plusieurs extensions de machine virtuelle, un agent de machine virtuelle doit avoir été installé.</span><span class="sxs-lookup"><span data-stu-id="2bc42-115">If you want a virtual machine instance to use one or more VM extensions, the instance must have an installed VM Agent.</span></span> <span data-ttu-id="2bc42-116">Une image de machine virtuelle créée à l’aide du portail Azure et une image du **Marketplace** installent automatiquement un agent de machine virtuelle dans le processus de création.</span><span class="sxs-lookup"><span data-stu-id="2bc42-116">A virtual machine image created by using the Azure portal and an image from the **Marketplace** automatically installs a VM Agent in the creation process.</span></span> <span data-ttu-id="2bc42-117">Si une instance de machine virtuelle n’a pas d’agent de machine virtuelle, vous pouvez installer ce dernier après la création de l’instance de machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="2bc42-117">If a virtual machine instance lacks a VM Agent, you can install the VM Agent after the virtual machine instance is created.</span></span> <span data-ttu-id="2bc42-118">Vous pouvez également installer l’agent dans une image de machine virtuelle personnalisée que vous devez alors charger.</span><span class="sxs-lookup"><span data-stu-id="2bc42-118">Or, you can install the agent in a custom VM image that you then upload.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="2bc42-119">Ces agents de machine virtuelle sont des services légers permettant la gestion sécurisée des instances de machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="2bc42-119">These VM Agents are very light-weight, services that enable secured administration of virtual machine instances.</span></span> <span data-ttu-id="2bc42-120">Il se peut que vous ne souhaitiez pas utiliser l'agent de machine virtuelle dans certains cas.</span><span class="sxs-lookup"><span data-stu-id="2bc42-120">There might be cases in which you do not want the VM Agent.</span></span> <span data-ttu-id="2bc42-121">Veillez alors à créer des machines virtuelles sur lesquelles l’agent de machine virtuelle n'est pas installé à l’aide de l’interface CLI Azure ou de PowerShell.</span><span class="sxs-lookup"><span data-stu-id="2bc42-121">If so, be sure to create VMs that do not have the VM Agent installed using the Azure CLI or PowerShell.</span></span> <span data-ttu-id="2bc42-122">Bien que l'agent de machine virtuelle puisse être supprimé physiquement, le comportement des extensions de machine virtuelle sur l'instance n'est pas défini.</span><span class="sxs-lookup"><span data-stu-id="2bc42-122">Although the VM Agent can be removed physically, the behavior of VM Extensions on the instance is undefined.</span></span> <span data-ttu-id="2bc42-123">Par conséquent, la suppression d’un agent de machine virtuelle installé n’est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="2bc42-123">As a result, removing an installed VM Agent is not supported.</span></span>
>

<span data-ttu-id="2bc42-124">L'agent de machine virtuelle est activé dans les situations suivantes :</span><span class="sxs-lookup"><span data-stu-id="2bc42-124">The VM Agent is enabled in the following situations:</span></span>

* <span data-ttu-id="2bc42-125">Lorsque vous créez une instance d’une machine virtuelle à l’aide du portail Azure et que vous sélectionnez une image du **Marketplace**,</span><span class="sxs-lookup"><span data-stu-id="2bc42-125">When you create an instance of a VM by using the Azure portal and selecting an image from the **Marketplace**,</span></span>
* <span data-ttu-id="2bc42-126">Quand vous créez une instance d’une machine virtuelle à l’aide de l’applet de commande [New-AzureVM](https://msdn.microsoft.com/library/azure/dn495254.aspx) ou [New-AzureQuickVM](https://msdn.microsoft.com/library/azure/dn495183.aspx).</span><span class="sxs-lookup"><span data-stu-id="2bc42-126">When you create an instance of a VM by using the [New-AzureVM](https://msdn.microsoft.com/library/azure/dn495254.aspx) or the [New-AzureQuickVM](https://msdn.microsoft.com/library/azure/dn495183.aspx) cmdlet.</span></span> <span data-ttu-id="2bc42-127">Vous pouvez créer une machine virtuelle sans agent de machine virtuelle installé en ajoutant le paramètre **–DisableGuestAgent** à l’applet de commande [Add-AzureProvisioningConfig](https://msdn.microsoft.com/library/azure/dn495299.aspx),</span><span class="sxs-lookup"><span data-stu-id="2bc42-127">You can create a VM without a VM Agent by adding the **–DisableGuestAgent** parameter to the [Add-AzureProvisioningConfig](https://msdn.microsoft.com/library/azure/dn495299.aspx) cmdlet,</span></span>

* <span data-ttu-id="2bc42-128">Lorsque vous téléchargez et installez manuellement l’agent de machine virtuelle sur une instance de machine virtuelle existante et définissez la valeur **ProvisionGuestAgent** sur **true**.</span><span class="sxs-lookup"><span data-stu-id="2bc42-128">When you manually download and install the VM Agent on an existing VM instance, and set the **ProvisionGuestAgent** value to **true**.</span></span> <span data-ttu-id="2bc42-129">Vous pouvez utiliser cette technique pour les agents Windows et Linux, à l’aide d’une commande PowerShell ou d’un appel REST.</span><span class="sxs-lookup"><span data-stu-id="2bc42-129">You can use this technique for Windows and Linux agents, by using a PowerShell command or a REST call.</span></span> <span data-ttu-id="2bc42-130">(Si vous ne définissez pas la valeur **ProvisionGuestAgent** après l'installation manuelle de l'agent de machine virtuelle, l'ajout de l'agent de machine virtuelle n'est pas détecté correctement.) L’exemple de code suivant montre comment effectuer cette opération à l’aide de PowerShell où les arguments `$svc` et `$name` ont déjà été spécifiés :</span><span class="sxs-lookup"><span data-stu-id="2bc42-130">(If you do not set the **ProvisionGuestAgent** value after manually installing the VM Agent, the addition of the VM Agent is not detected properly.) The following code example shows how to do this using PowerShell where the `$svc` and `$name` arguments have already been determined:</span></span>

      $vm = Get-AzureVM –ServiceName $svc –Name $name
      $vm.VM.ProvisionGuestAgent = $TRUE
      Update-AzureVM –Name $name –VM $vm.VM –ServiceName $svc

* <span data-ttu-id="2bc42-131">Lorsque vous créez une image de machine virtuelle qui inclut un agent de machine virtuelle installé.</span><span class="sxs-lookup"><span data-stu-id="2bc42-131">When you create a VM image that includes an installed VM Agent.</span></span> <span data-ttu-id="2bc42-132">Une fois que l’image avec l’agent de machine virtuelle existe, vous pouvez la télécharger sur Azure.</span><span class="sxs-lookup"><span data-stu-id="2bc42-132">Once the image with the VM Agent exists, you can upload that image to Azure.</span></span> <span data-ttu-id="2bc42-133">Pour une machine virtuelle Windows, téléchargez le [fichier Windows VM Agent .msi](http://go.microsoft.com/fwlink/?LinkID=394789) et installez l’agent de machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="2bc42-133">For a Windows VM, download the [Windows VM Agent .msi file](http://go.microsoft.com/fwlink/?LinkID=394789) and install the VM Agent.</span></span> <span data-ttu-id="2bc42-134">Pour une machine virtuelle Linux, installez-le à partir du référentiel GitHub accessible à l’adresse <https://github.com/Azure/WALinuxAgent>.</span><span class="sxs-lookup"><span data-stu-id="2bc42-134">For a Linux VM, install the VM Agent from the GitHub repository located at <https://github.com/Azure/WALinuxAgent>.</span></span> <span data-ttu-id="2bc42-135">Pour plus d’informations sur la procédure d’installation de l’agent de machine virtuelle sur Linux, consultez le [Guide d’utilisateur de l’agent Linux Azure](../articles/virtual-machines/linux/agent-user-guide.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="2bc42-135">For more information on how to install the VM Agent on Linux, see the [Azure Linux VM Agent User Guide](../articles/virtual-machines/linux/agent-user-guide.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span></span>

> [!NOTE]
> <span data-ttu-id="2bc42-136">Dans PaaS, l’agent de machine virtuelle est appelé **WindowsAzureGuestAgent**.</span><span class="sxs-lookup"><span data-stu-id="2bc42-136">In PaaS, the VM Agent is called **WindowsAzureGuestAgent**, and is always available on Web and Worker Role VMs.</span></span> <span data-ttu-id="2bc42-137">(Pour plus d’informations, consultez le billet de blog [Azure Role Architecture](http://blogs.msdn.com/b/kwill/archive/2011/05/05/windows-azure-role-architecture.aspx) (Architecture de rôle Azure).) L'agent de machine virtuelle pour les machines virtuelles de rôle peut maintenant ajouter des extensions aux machines virtuelles de service cloud de la même manière que pour les machines virtuelles persistantes.</span><span class="sxs-lookup"><span data-stu-id="2bc42-137">(For more information, see [Azure Role Architecture](http://blogs.msdn.com/b/kwill/archive/2011/05/05/windows-azure-role-architecture.aspx).) The VM Agent for Role VMs can now add extensions to the cloud service VMs in the same way that it does for persistent Virtual Machines.</span></span> <span data-ttu-id="2bc42-138">La différence majeure entre les extensions de machine virtuelle sur les machines virtuelles de rôle et les machines virtuelles persistantes se trouve lors de l’ajout des extensions de machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="2bc42-138">The biggest difference between VM Extensions on role VMs and persistent VMs is when the VM extensions are added.</span></span> <span data-ttu-id="2bc42-139">Avec les machines virtuelles de rôle, les extensions sont d’abord ajoutées au service cloud, puis aux déploiements au sein de ce service cloud.</span><span class="sxs-lookup"><span data-stu-id="2bc42-139">With role VMs, extensions are added first to the cloud service, then to the deployments within that cloud service.</span></span>
>
> <span data-ttu-id="2bc42-140">Utilisez l’applet de commande [Get-AzureServiceAvailableExtension](https://msdn.microsoft.com/library/azure/dn722498.aspx) pour répertorier toutes les extensions de machine virtuelle de rôle disponibles.</span><span class="sxs-lookup"><span data-stu-id="2bc42-140">Use the [Get-AzureServiceAvailableExtension](https://msdn.microsoft.com/library/azure/dn722498.aspx) cmdlet to list all available role VM extensions.</span></span>
>
>

## <a name="find-add-update-and-remove-vm-extensions"></a><span data-ttu-id="2bc42-141">Rechercher, ajouter, mettre à jour et supprimer des extensions de machine virtuelle</span><span class="sxs-lookup"><span data-stu-id="2bc42-141">Find, Add, Update, and Remove VM Extensions</span></span>
<span data-ttu-id="2bc42-142">Pour plus d’informations sur ces tâches, consultez l’article expliquant comment [ajouter, rechercher, mettre à jour et supprimer des extensions de machines virtuelles Azure](../articles/virtual-machines/windows/classic/manage-extensions.md?toc=%2fazure%2fvirtual-machines%2fwindows%2fclassic%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="2bc42-142">For details on these tasks, see [Add, Find, Update, and Remove Azure VM Extensions](../articles/virtual-machines/windows/classic/manage-extensions.md?toc=%2fazure%2fvirtual-machines%2fwindows%2fclassic%2ftoc.json).</span></span>
