# <a name="common-errors-during-classic-tooazure-resource-manager-migration"></a><span data-ttu-id="05806-101">Erreurs courantes lors classique tooAzure migration du Gestionnaire de ressources</span><span class="sxs-lookup"><span data-stu-id="05806-101">Common errors during Classic tooAzure Resource Manager migration</span></span>
<span data-ttu-id="05806-102">Catalogues de cet article hello des erreurs et des solutions d’atténuation plus courants lors de la migration de hello des ressources IaaS de pile de déploiement classique Azure modèle toohello Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="05806-102">This article catalogs hello most common errors and mitigations during hello migration of IaaS resources from Azure classic deployment model toohello Azure Resource Manager stack.</span></span>

## <a name="list-of-errors"></a><span data-ttu-id="05806-103">Liste d’erreurs</span><span class="sxs-lookup"><span data-stu-id="05806-103">List of errors</span></span>
| <span data-ttu-id="05806-104">Chaîne d’erreur</span><span class="sxs-lookup"><span data-stu-id="05806-104">Error string</span></span> | <span data-ttu-id="05806-105">Atténuation</span><span class="sxs-lookup"><span data-stu-id="05806-105">Mitigation</span></span> |
| --- | --- |
| <span data-ttu-id="05806-106">Erreur interne du serveur</span><span class="sxs-lookup"><span data-stu-id="05806-106">Internal server error</span></span> |<span data-ttu-id="05806-107">Dans certains cas, il s’agit d’une erreur temporaire qui disparaît à la tentative suivante.</span><span class="sxs-lookup"><span data-stu-id="05806-107">In some cases, this is a transient error that goes away with a retry.</span></span> <span data-ttu-id="05806-108">S’il continue toopersist, [contactez le support Azure](../articles/azure-supportability/how-to-create-azure-support-request.md) besoins d’examen des journaux de la plateforme.</span><span class="sxs-lookup"><span data-stu-id="05806-108">If it continues toopersist, [contact Azure support](../articles/azure-supportability/how-to-create-azure-support-request.md) as it needs investigation of platform logs.</span></span> <br><br> <span data-ttu-id="05806-109">**Remarque :** une fois que l’incident de hello est suivi par l’équipe de support hello, n’essayez pas tout atténuation automatique car cela peut avoir des conséquences inattendues sur votre environnement.</span><span class="sxs-lookup"><span data-stu-id="05806-109">**NOTE:** Once hello incident is tracked by hello support team, please do not attempt any self-mitigation as this might have unintended consequences on your environment.</span></span> |
| <span data-ttu-id="05806-110">La migration n’est pas prise en charge pour le déploiement {deployment-name} dans le service hébergé {hosted-service-name} car il s’agit d’un déploiement PaaS (Web/Worker).</span><span class="sxs-lookup"><span data-stu-id="05806-110">Migration is not supported for Deployment {deployment-name}  in HostedService {hosted-service-name} because it is a PaaS deployment (Web/Worker).</span></span> |<span data-ttu-id="05806-111">Cela se produit lorsque le déploiement contient un rôle web/de travail.</span><span class="sxs-lookup"><span data-stu-id="05806-111">This happens when a deployment contains a web/worker role.</span></span> <span data-ttu-id="05806-112">Étant donné que la migration est uniquement prise en charge pour les Machines virtuelles, veuillez supprimer hello/rôle de déploiement de hello et réessayez la migration.</span><span class="sxs-lookup"><span data-stu-id="05806-112">Since migration is only supported for Virtual Machines, please remove hello web/worker role from hello deployment and try migration again.</span></span> |
| <span data-ttu-id="05806-113">Échec du déploiement du modèle {template-name}.</span><span class="sxs-lookup"><span data-stu-id="05806-113">Template {template-name} deployment failed.</span></span> <span data-ttu-id="05806-114">CorrelationId={guid}</span><span class="sxs-lookup"><span data-stu-id="05806-114">CorrelationId={guid}</span></span> |<span data-ttu-id="05806-115">Dans hello back-end du service de migration, nous utilisons des ressources de toocreate modèles Azure Resource Manager dans la pile du Gestionnaire de ressources Azure hello.</span><span class="sxs-lookup"><span data-stu-id="05806-115">In hello backend of migration service, we use Azure Resource Manager templates toocreate resources in hello Azure Resource Manager stack.</span></span> <span data-ttu-id="05806-116">Étant donné que les modèles sont idempotents, généralement vous pouvez réessayer en toute sécurité tooget d’opération de migration hello au-delà de cette erreur.</span><span class="sxs-lookup"><span data-stu-id="05806-116">Since templates are idempotent, usually you can safely retry hello migration operation tooget past this error.</span></span> <span data-ttu-id="05806-117">Si cette erreur persiste toopersist, veuillez [contactez le support Azure](../articles/azure-supportability/how-to-create-azure-support-request.md) et leur accorder hello CorrelationId.</span><span class="sxs-lookup"><span data-stu-id="05806-117">If this error continues toopersist, please [contact Azure support](../articles/azure-supportability/how-to-create-azure-support-request.md) and give them hello CorrelationId.</span></span> <br><br> <span data-ttu-id="05806-118">**Remarque :** une fois que l’incident de hello est suivi par l’équipe de support hello, n’essayez pas tout atténuation automatique car cela peut avoir des conséquences inattendues sur votre environnement.</span><span class="sxs-lookup"><span data-stu-id="05806-118">**NOTE:** Once hello incident is tracked by hello support team, please do not attempt any self-mitigation as this might have unintended consequences on your environment.</span></span> |
| <span data-ttu-id="05806-119">réseau virtuel de Hello {virtual-network-name} n’existe pas.</span><span class="sxs-lookup"><span data-stu-id="05806-119">hello virtual network {virtual-network-name} does not exist.</span></span> |<span data-ttu-id="05806-120">Cela peut se produire si vous avez créé hello réseau virtuel dans le nouveau portail de Azure hello.</span><span class="sxs-lookup"><span data-stu-id="05806-120">This can happen if you created hello Virtual Network in hello new Azure portal.</span></span> <span data-ttu-id="05806-121">nom de réseau virtuel réel Hello suit le modèle de hello « groupe * <VNET name>»</span><span class="sxs-lookup"><span data-stu-id="05806-121">hello actual Virtual Network name follows hello pattern "Group * <VNET name>"</span></span> |
| <span data-ttu-id="05806-122">La machine virtuelle {vm-name} du service hébergé {hosted-service-name} contient une extension {extension-name} qui n’est pas prise en charge dans Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="05806-122">VM {vm-name} in HostedService {hosted-service-name} contains Extension {extension-name} which is not supported in Azure Resource Manager.</span></span> <span data-ttu-id="05806-123">Il est recommandé de toouninstall à partir de hello machine virtuelle avant de poursuivre la migration.</span><span class="sxs-lookup"><span data-stu-id="05806-123">It is recommended toouninstall it from hello VM before continuing with migration.</span></span> |<span data-ttu-id="05806-124">Les extensions XML telles que BGInfo 1.* ne sont pas prises en charge dans Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="05806-124">XML extensions such as BGInfo 1.* are not supported in Azure Resource Manager.</span></span> <span data-ttu-id="05806-125">Par conséquent, elles ne peuvent pas faire l’objet d’une migration.</span><span class="sxs-lookup"><span data-stu-id="05806-125">Therefore, these extensions cannot be migrated.</span></span> <span data-ttu-id="05806-126">Si ces extensions sont gauche hello installés sur virtual machine, ils sont automatiquement désinstallés avant la fin de la migration hello.</span><span class="sxs-lookup"><span data-stu-id="05806-126">If these extensions are left installed on hello virtual machine, they are automatically uninstalled before completing hello migration.</span></span> |
| <span data-ttu-id="05806-127">La machine virtuelle {vm-name} du service hébergé {hosted-service-name} contient l’extension VMSnapshot/VMSnapshotLinux, dont la migration n’est actuellement pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="05806-127">VM {vm-name} in HostedService {hosted-service-name} contains Extension VMSnapshot/VMSnapshotLinux, which is currently not supported for Migration.</span></span> <span data-ttu-id="05806-128">Désinstaller de hello machine virtuelle et l’ajouter à l’aide de Azure Resource Manager une fois hello Migration est terminée.</span><span class="sxs-lookup"><span data-stu-id="05806-128">Uninstall it from hello VM and add it back using Azure Resource Manager after hello Migration is Complete</span></span> |<span data-ttu-id="05806-129">Il s’agit de scénario hello où hello virtual machine est configurée pour Azure Backup.</span><span class="sxs-lookup"><span data-stu-id="05806-129">This is hello scenario where hello virtual machine is configured for Azure Backup.</span></span> <span data-ttu-id="05806-130">Étant donné que ce scénario n’est actuellement pas pris en charge, procédez comme solution de contournement hello à https://aka.ms/vmbackupmigration</span><span class="sxs-lookup"><span data-stu-id="05806-130">Since this is currently an unsupported scenario, please follow hello workaround at https://aka.ms/vmbackupmigration</span></span> |
| <span data-ttu-id="05806-131">Machine virtuelle {vm-name} dans le service hébergé {hébergé-service-name} contient l’Extension {extension-name}, dont l’état n’est pas signalée à partir de la machine virtuelle de hello.</span><span class="sxs-lookup"><span data-stu-id="05806-131">VM {vm-name} in HostedService {hosted-service-name} contains Extension {extension-name} whose Status is not being reported from hello VM.</span></span> <span data-ttu-id="05806-132">Par conséquent, elle ne peut pas faire l’objet d’une migration.</span><span class="sxs-lookup"><span data-stu-id="05806-132">Hence, this VM cannot be migrated.</span></span> <span data-ttu-id="05806-133">Vérifiez que hello état de l’Extension est signalé ou désinstaller l’extension de hello à partir de la machine virtuelle de hello et recommencez la migration.</span><span class="sxs-lookup"><span data-stu-id="05806-133">Ensure that hello Extension status is being reported or uninstall hello extension from hello VM and retry migration.</span></span> <br><br> <span data-ttu-id="05806-134">La machine virtuelle {vm-name} du service hébergé {hosted-service-name} contient une extension {extension-name} qui génère l’état de gestionnaire : {handler-status}.</span><span class="sxs-lookup"><span data-stu-id="05806-134">VM {vm-name} in HostedService {hosted-service-name} contains Extension {extension-name} reporting Handler Status: {handler-status}.</span></span> <span data-ttu-id="05806-135">Par conséquent, hello machine virtuelle ne peut pas être migré.</span><span class="sxs-lookup"><span data-stu-id="05806-135">Hence, hello VM cannot be migrated.</span></span> <span data-ttu-id="05806-136">Vérifiez que le statut de gestionnaire d’Extension hello signalé est {gestionnaire-status} ou désinstallez-la de hello machine virtuelle et recommencez la migration.</span><span class="sxs-lookup"><span data-stu-id="05806-136">Ensure that hello Extension handler status being reported is {handler-status} or uninstall it from hello VM and retry migration.</span></span> <br><br> <span data-ttu-id="05806-137">Agent de machine virtuelle pour la machine virtuelle {vm-name} dans le service hébergé {hébergé-service-name} est reporting hello état global de l’agent comme n’étant pas prêt.</span><span class="sxs-lookup"><span data-stu-id="05806-137">VM Agent for VM {vm-name} in HostedService {hosted-service-name} is reporting hello overall agent status as Not Ready.</span></span> <span data-ttu-id="05806-138">Par conséquent, hello machine virtuelle ne pas être migrée, s’il a une extension peut être migrée.</span><span class="sxs-lookup"><span data-stu-id="05806-138">Hence, hello VM may not be migrated, if it has a migratable extension.</span></span> <span data-ttu-id="05806-139">Assurez-vous que l’Agent de machine virtuelle hello est signalent l’état de l’agent global comme prêt.</span><span class="sxs-lookup"><span data-stu-id="05806-139">Ensure that hello VM Agent is reporting overall agent status as Ready.</span></span> <span data-ttu-id="05806-140">Consultez toohttps://aka.ms/classiciaasmigrationfaqs.</span><span class="sxs-lookup"><span data-stu-id="05806-140">Refer toohttps://aka.ms/classiciaasmigrationfaqs.</span></span> |<span data-ttu-id="05806-141">L’agent invité Azure et les Extensions de machine virtuelle doivent sortant internet access toohello VM stockage compte toopopulate leur état.</span><span class="sxs-lookup"><span data-stu-id="05806-141">Azure guest agent & VM Extensions need outbound internet access toohello VM storage account toopopulate their status.</span></span> <span data-ttu-id="05806-142">Causes les plus courantes d’échec de l’état :</span><span class="sxs-lookup"><span data-stu-id="05806-142">Common causes of status failure include</span></span> <li> <span data-ttu-id="05806-143">un groupe de sécurité réseau qui bloque l’accès sortant toohello internet</span><span class="sxs-lookup"><span data-stu-id="05806-143">a Network Security Group that blocks outbound access toohello internet</span></span> <li> <span data-ttu-id="05806-144">Si hello réseau virtuel a local sur les serveurs DNS et connectivité DNS est perdu</span><span class="sxs-lookup"><span data-stu-id="05806-144">If hello VNET has on-prem DNS servers and DNS connectivity is lost</span></span> <br><br> <span data-ttu-id="05806-145">Si vous continuez toosee un état non pris en charge, vous pouvez désinstaller hello extensions tooskip cette vérification et déplacer vers le bas dans la migration.</span><span class="sxs-lookup"><span data-stu-id="05806-145">If you continue toosee an unsupported status, you can uninstall hello extensions tooskip this check and move forward with migration.</span></span> |
| <span data-ttu-id="05806-146">La migration n’est pas prise en charge pour le déploiement {deployment-name} dans le service hébergé {hosted-service-name} car il contient plusieurs groupes à haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="05806-146">Migration is not supported for Deployment {deployment-name} in HostedService {hosted-service-name} because it has multiple Availability Sets.</span></span> |<span data-ttu-id="05806-147">Actuellement, seuls les services hébergés contenant au maximum un groupe à haute disponibilité peuvent faire l’objet d’une migration.</span><span class="sxs-lookup"><span data-stu-id="05806-147">Currently, only hosted services that have 1 or less Availability sets can be migrated.</span></span> <span data-ttu-id="05806-148">toowork résoudre ce problème, déplacez hello supplémentaire à haute disponibilité et de machines virtuelles dans ces tooa d’ensembles de disponibilité différent d’un service hébergé.</span><span class="sxs-lookup"><span data-stu-id="05806-148">toowork around this problem, please move hello additional Availability sets and Virtual machines in those Availability sets tooa different hosted service.</span></span> |
| <span data-ttu-id="05806-149">La migration n’est pas prise en charge pour le déploiement {déploiement-name} dans le service hébergé {hébergé-service-name, car il possède des machines virtuelles qui ne font pas partie de hello à haute disponibilité même si le service hébergé de hello contient un.</span><span class="sxs-lookup"><span data-stu-id="05806-149">Migration is not supported for Deployment {deployment-name} in HostedService {hosted-service-name because it has VMs that are not part of hello Availability Set even though hello HostedService contains one.</span></span> |<span data-ttu-id="05806-150">solution de contournement Hello pour ce scénario est tooeither déplacer tous les ordinateurs virtuels hello dans une disponibilité unique définir ou supprimer tous les ordinateurs virtuels à partir de hello à haute disponibilité dans le service hébergé de hello.</span><span class="sxs-lookup"><span data-stu-id="05806-150">hello workaround for this scenario is tooeither move all hello virtual machines into a single Availability set or remove all Virtual machines from hello Availability set in hello hosted service.</span></span> |
| <span data-ttu-id="05806-151">Compte/le service hébergé/virtuel de stockage réseau {virtual-network-name} est en cours de hello en cours de migration et il ne peut pas être changé</span><span class="sxs-lookup"><span data-stu-id="05806-151">Storage account/HostedService/Virtual Network {virtual-network-name} is in hello process of being migrated and hence cannot be changed</span></span> |<span data-ttu-id="05806-152">Cette erreur se produit lorsque hello opération de migration « Préparer » a été effectué sur la ressource de hello et une opération qui pourrait permettre une ressource de toohello de modification est déclenchée.</span><span class="sxs-lookup"><span data-stu-id="05806-152">This error happens when hello "Prepare" migration operation has been completed on hello resource and an operation that would make a change toohello resource is triggered.</span></span> <span data-ttu-id="05806-153">En raison de verrou hello sur le plan de gestion hello après l’opération de « Préparation », n’importe quelle ressource de toohello de modifications sont bloquées.</span><span class="sxs-lookup"><span data-stu-id="05806-153">Because of hello lock on hello management plane after "Prepare" operation, any changes toohello resource are blocked.</span></span> <span data-ttu-id="05806-154">plan de gestion toounlock hello, vous pouvez exécuter hello « Valider » migration opération toocomplete la migration ou hello « Annuler » migration opération tooroll précédent hello opération de « Préparation ».</span><span class="sxs-lookup"><span data-stu-id="05806-154">toounlock hello management plane, you can run hello "Commit" migration operation toocomplete migration or hello "Abort" migration operation tooroll back hello "Prepare" operation.</span></span> |
| <span data-ttu-id="05806-155">La migration n’est pas autorisée pour le service hébergé {hosted-service-name} car il contient une machine virtuelle {vm-name} à l’état : RoleStateUnknown.</span><span class="sxs-lookup"><span data-stu-id="05806-155">Migration is not allowed for HostedService {hosted-service-name} because it has VM {vm-name} in State: RoleStateUnknown.</span></span> <span data-ttu-id="05806-156">La migration est autorisée uniquement lorsque hello machine virtuelle est dans un des éléments suivants de hello États - en cours d’exécution, arrêté, arrêté désalloué.</span><span class="sxs-lookup"><span data-stu-id="05806-156">Migration is allowed only when hello VM is in one of hello following states - Running, Stopped, Stopped Deallocated.</span></span> |<span data-ttu-id="05806-157">Hello machine virtuelle peut être en cours via une transition d’état, ce qui se produit généralement lorsque lors d’une opération de mise à jour sur hello le service hébergé comme un redémarrage, etc. installation de l’extension. Il est recommandé pour toocomplete d’opération de mise à jour hello sur le service hébergé de hello avant la tentative de migration.</span><span class="sxs-lookup"><span data-stu-id="05806-157">hello VM might be undergoing through a state transition, which usually happens when during an update operation on hello HostedService such as a reboot, extension installation etc. It is recommended for hello update operation toocomplete on hello HostedService before trying migration.</span></span> |
| <span data-ttu-id="05806-158">Déploiement {déploiement-name} dans le service hébergé {hébergé-service-name} contient une machine virtuelle {vm-name} avec un disque de données {données-disque-name} dont {size-of-the-vhd-blob-backing-the-data-disk} de la taille en octets blob physique ne correspond pas à {de taille logique hello disque de données de machine virtuelle Size-of-the-Data-Disk-specified-in-the-VM-API} octets.</span><span class="sxs-lookup"><span data-stu-id="05806-158">Deployment {deployment-name} in HostedService {hosted-service-name} contains a VM {vm-name} with Data Disk {data-disk-name} whose physical blob size {size-of-the-vhd-blob-backing-the-data-disk} bytes does not match hello VM Data Disk logical size {size-of-the-data-disk-specified-in-the-vm-api} bytes.</span></span> <span data-ttu-id="05806-159">La migration va être effectuée sans spécification d’une taille de disque de données hello pour hello Azure Resource Manager VM.</span><span class="sxs-lookup"><span data-stu-id="05806-159">Migration will proceed without specifying a size for hello data disk for hello Azure Resource Manager VM.</span></span> | <span data-ttu-id="05806-160">Cette erreur se produit si vous avez redimensionné blob de disque dur virtuel hello sans mettre à jour de la taille de hello dans le modèle de machine virtuelle API hello.</span><span class="sxs-lookup"><span data-stu-id="05806-160">This error happens if you've resized hello VHD blob without updating hello size in hello VM API model.</span></span> <span data-ttu-id="05806-161">Vous trouverez les étapes de correction détaillées [ci-dessous](#vm-with-data-disk-whose-physical-blob-size-bytes-does-not-match-the-vm-data-disk-logical-size-bytes).</span><span class="sxs-lookup"><span data-stu-id="05806-161">Detailed mitigation steps are outlined [below](#vm-with-data-disk-whose-physical-blob-size-bytes-does-not-match-the-vm-data-disk-logical-size-bytes).</span></span>|
| <span data-ttu-id="05806-162">Une exception de stockage s’est produite lors de la validation du disque de données {nom du disque de données} avec le lien du support {URI du disque de données} pour la machine virtuelle {nom de la machine virtuelle} dans le service cloud {nom du service cloud}.</span><span class="sxs-lookup"><span data-stu-id="05806-162">A storage exception occurred while validating data disk {data disk name} with media link {data disk Uri} for VM {VM name} in Cloud Service {Cloud Service name}.</span></span> <span data-ttu-id="05806-163">Vérifiez que ce lien de support de disque dur virtuel hello est accessible à cet ordinateur virtuel</span><span class="sxs-lookup"><span data-stu-id="05806-163">Please ensure that hello VHD media link is accessible for this virtual machine</span></span> | <span data-ttu-id="05806-164">Cette erreur peut se produire si les disques hello Hello machine virtuelle a été supprimé ou n’est pas plus accessible.</span><span class="sxs-lookup"><span data-stu-id="05806-164">This error can happen if hello disks of hello VM have been deleted or are not accessible anymore.</span></span> <span data-ttu-id="05806-165">Assurez-vous que disques hello pour hello machine virtuelle existe.</span><span class="sxs-lookup"><span data-stu-id="05806-165">Please make sure hello disks for hello VM exist.</span></span>|
| <span data-ttu-id="05806-166">La machine virtuelle {nom de la machine virtuelle} dans le service hébergé {nom du service cloud} contient un disque avec un élément MediaLink {vhd-uri} ayant le nom d’objet blob {vhd-nom d’objet blob} qui n’est pas pris en charge dans Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="05806-166">VM {vm-name} in HostedService {cloud-service-name} contains Disk with MediaLink {vhd-uri} which has blob name {vhd-blob-name}  that is not supported in Azure Resource Manager.</span></span> | <span data-ttu-id="05806-167">Cette erreur se produit lorsque hello du nom d’objet blob de hello est « / » y n'est pas prise en charge dans le fournisseur de ressources de calcul actuellement.</span><span class="sxs-lookup"><span data-stu-id="05806-167">This error occurs when hello name of hello blob has a "/" in it which is not supported in Compute Resource Provider currently.</span></span> |
| <span data-ttu-id="05806-168">La migration n’est pas autorisée pour le déploiement {déploiement-name} dans le service hébergé {cloud-service-name}, car il n’est pas dans la portée régionale de hello.</span><span class="sxs-lookup"><span data-stu-id="05806-168">Migration is not allowed for Deployment {deployment-name} in HostedService {cloud-service-name} as it is not in hello regional scope.</span></span> <span data-ttu-id="05806-169">Consultez toohttp://aka.ms/regionalscope pour déplacer cette étendue tooregional de déploiement.</span><span class="sxs-lookup"><span data-stu-id="05806-169">Please refer toohttp://aka.ms/regionalscope for moving this deployment tooregional scope.</span></span> | <span data-ttu-id="05806-170">En 2014, Azure a annoncé que les ressources réseau seront déplace d’une étendue de tooregional de niveau de la portée de cluster.</span><span class="sxs-lookup"><span data-stu-id="05806-170">In 2014, Azure announced that networking resources will move from a cluster level scope tooregional scope.</span></span> <span data-ttu-id="05806-171">Pour plus d’informations ( http://aka.ms/regionalscope ), consultez l’article [ http://aka.ms/regionalscope ].</span><span class="sxs-lookup"><span data-stu-id="05806-171">See [http://aka.ms/regionalscope] for more details (http://aka.ms/regionalscope).</span></span> <span data-ttu-id="05806-172">Cette erreur se produit lorsque le déploiement hello en cours de migration n’a pas une opération de mise à jour, ce qui déplace automatiquement portée régionale de tooa.</span><span class="sxs-lookup"><span data-stu-id="05806-172">This error happens when hello deployment being migrated has not had an update operation, which automatically moves it tooa regional scope.</span></span> <span data-ttu-id="05806-173">Meilleure solution est tooeither ajouter un point de terminaison de tooa machine virtuelle ou données disque toohello machine virtuelle et recommencez la migration.</span><span class="sxs-lookup"><span data-stu-id="05806-173">Best workaround is tooeither add an endpoint tooa VM or a data disk toohello VM and then retry migration.</span></span> <br> <span data-ttu-id="05806-174">Consultez [comment tooset des points de terminaison sur un ordinateur de virtuel Windows classique dans Azure](../articles/virtual-machines/windows/classic/setup-endpoints.md#create-an-endpoint) ou [attacher une machine virtuelle données disque tooa Windows créée avec le modèle de déploiement classique de hello](../articles/virtual-machines/windows/classic/attach-disk.md)</span><span class="sxs-lookup"><span data-stu-id="05806-174">See [How tooset up endpoints on a classic Windows virtual machine in Azure](../articles/virtual-machines/windows/classic/setup-endpoints.md#create-an-endpoint) or [Attach a data disk tooa Windows virtual machine created with hello classic deployment model](../articles/virtual-machines/windows/classic/attach-disk.md)</span></span>|


## <a name="detailed-mitigations"></a><span data-ttu-id="05806-175">Étapes de correction détaillées</span><span class="sxs-lookup"><span data-stu-id="05806-175">Detailed mitigations</span></span>

### <a name="vm-with-data-disk-whose-physical-blob-size-bytes-does-not-match-hello-vm-data-disk-logical-size-bytes"></a><span data-ttu-id="05806-176">Machine virtuelle avec disque de données taille en octets d’objets blob dont physique ne correspond pas à octets de taille logique de disque de données de machine virtuelle hello.</span><span class="sxs-lookup"><span data-stu-id="05806-176">VM with Data Disk whose physical blob size bytes does not match hello VM Data Disk logical size bytes.</span></span>

<span data-ttu-id="05806-177">Cela se produit lorsque hello taille logique de disque de données peut obtenir synchronisée avec la taille du blob hello réelle disque dur virtuel.</span><span class="sxs-lookup"><span data-stu-id="05806-177">This happens when hello Data disk logical size can get out of sync with hello actual VHD blob size.</span></span> <span data-ttu-id="05806-178">Cela peut être facilement vérifié à l’aide de hello suivant de commandes :</span><span class="sxs-lookup"><span data-stu-id="05806-178">This can be easily verified using hello following commands:</span></span>

#### <a name="verifying-hello-issue"></a><span data-ttu-id="05806-179">Vérification de problème de hello</span><span class="sxs-lookup"><span data-stu-id="05806-179">Verifying hello issue</span></span>

```PowerShell
# Store hello VM details in hello VM object
$vm = Get-AzureVM -ServiceName $servicename -Name $vmname

# Display hello data disk properties
# NOTE hello data disk LogicalDiskSizeInGB below which is 11GB. Also note hello MediaLink Uri of hello VHD blob as we'll use this in hello next step
$vm.VM.DataVirtualHardDisks


HostCaching         : None
DiskLabel           : 
DiskName            : coreosvm-coreosvm-0-201611230636240687
Lun                 : 0
LogicalDiskSizeInGB : 11
MediaLink           : https://contosostorage.blob.core.windows.net/vhds/coreosvm-dd1.vhd
SourceMediaLink     : 
IOType              : Standard
ExtensionData       : 

# Now get hello properties of hello blob backing hello data disk above
# NOTE hello size of hello blob is about 15 GB which is different from LogicalDiskSizeInGB above
$blob = Get-AzureStorageblob -Blob "coreosvm-dd1.vhd" -Container vhds 

$blob

ICloudBlob        : Microsoft.WindowsAzure.Storage.Blob.CloudPageBlob
BlobType          : PageBlob
Length            : 16106127872
ContentType       : application/octet-stream
LastModified      : 11/23/2016 7:16:22 AM +00:00
SnapshotTime      : 
ContinuationToken : 
Context           : Microsoft.WindowsAzure.Commands.Common.Storage.AzureStorageContext
Name              : coreosvm-dd1.vhd
```

#### <a name="mitigating-hello-issue"></a><span data-ttu-id="05806-180">Atténuation de problème de hello</span><span class="sxs-lookup"><span data-stu-id="05806-180">Mitigating hello issue</span></span>

```PowerShell
# Convert hello blob size in bytes tooGB into a variable which we'll use later
$newSize = [int]($blob.Length / 1GB)

# See hello calculated size in GB
$newSize

15

# Store hello disk name of hello data disk as we'll use this tooidentify hello disk toobe updated
$diskName = $vm.VM.DataVirtualHardDisks[0].DiskName

# Identify hello LUN of hello data disk tooremove
$lunToRemove = $vm.VM.DataVirtualHardDisks[0].Lun

# Now remove hello data disk from hello VM so that hello disk isn't leased by hello VM and it's size can be updated
Remove-AzureDataDisk -LUN $lunToRemove -VM $vm | Update-AzureVm -Name $vmname -ServiceName $servicename

OperationDescription OperationId                          OperationStatus
-------------------- -----------                          ---------------
Update-AzureVM       213xx1-b44b-1v6n-23gg-591f2a13cd16   Succeeded  

# Verify we have hello right disk that's going toobe updated
Get-AzureDisk -DiskName $diskName

AffinityGroup        : 
AttachedTo           : 
IsCorrupted          : False
Label                : 
Location             : East US
DiskSizeInGB         : 11
MediaLink            : https://contosostorage.blob.core.windows.net/vhds/coreosvm-dd1.vhd
DiskName             : coreosvm-coreosvm-0-201611230636240687
SourceImageName      : 
OS                   : 
IOType               : Standard
OperationDescription : Get-AzureDisk
OperationId          : 0c56a2b7-a325-123b-7043-74c27d5a61fd
OperationStatus      : Succeeded

# Now update hello disk toohello new size
Update-AzureDisk -DiskName $diskName -ResizedSizeInGB $newSize -Label $diskName

OperationDescription OperationId                          OperationStatus
-------------------- -----------                          ---------------
Update-AzureDisk     cv134b65-1b6n-8908-abuo-ce9e395ac3e7 Succeeded 

# Now verify that hello "DiskSizeInGB" property of hello disk matches hello size of hello blob 
Get-AzureDisk -DiskName $diskName


AffinityGroup        : 
AttachedTo           : 
IsCorrupted          : False
Label                : coreosvm-coreosvm-0-201611230636240687
Location             : East US
DiskSizeInGB         : 15
MediaLink            : https://contosostorage.blob.core.windows.net/vhds/coreosvm-dd1.vhd
DiskName             : coreosvm-coreosvm-0-201611230636240687
SourceImageName      : 
OS                   : 
IOType               : Standard
OperationDescription : Get-AzureDisk
OperationId          : 1v53bde5-cv56-5621-9078-16b9c8a0bad2
OperationStatus      : Succeeded

# Now we'll add hello disk back toohello VM as a data disk. First we need tooget an updated VM object
$vm = Get-AzureVM -ServiceName $servicename -Name $vmname

Add-AzureDataDisk -Import -DiskName $diskName -LUN 0 -VM $vm -HostCaching ReadWrite | Update-AzureVm -Name $vmname -ServiceName $servicename

OperationDescription OperationId                          OperationStatus
-------------------- -----------                          ---------------
Update-AzureVM       b0ad3d4c-4v68-45vb-xxc1-134fd010d0f8 Succeeded      
```

### <a name="moving-a-vm-tooa-different-subscription-after-completing-migration"></a><span data-ttu-id="05806-181">Déplacement d’un machine virtuelle tooa autre abonnement après avoir effectué la migration</span><span class="sxs-lookup"><span data-stu-id="05806-181">Moving a VM tooa different subscription after completing migration</span></span>

<span data-ttu-id="05806-182">Après avoir terminé le processus de migration hello, vous souhaiterez abonnement de tooanother toomove hello machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="05806-182">After you complete hello migration process, you may want toomove hello VM tooanother subscription.</span></span> <span data-ttu-id="05806-183">Toutefois, si vous avez un code secret ou du certificat sur hello déplacer des ordinateurs virtuels qui fait référence à une ressource du coffre de clés, hello est actuellement pas pris en charge.</span><span class="sxs-lookup"><span data-stu-id="05806-183">However, if you have a secret/certificate on hello VM that references a Key Vault resource, hello move is currently not supported.</span></span> <span data-ttu-id="05806-184">Hello ci-dessous les instructions vous permettra de problème de hello tooworkaround.</span><span class="sxs-lookup"><span data-stu-id="05806-184">hello below instructions will allow you tooworkaround hello issue.</span></span> 

#### <a name="powershell"></a><span data-ttu-id="05806-185">PowerShell</span><span class="sxs-lookup"><span data-stu-id="05806-185">PowerShell</span></span>
```powershell
$vm = Get-AzureRmVM -ResourceGroupName "MyRG" -Name "MyVM"
Remove-AzureRmVMSecret -VM $vm
Update-AzureRmVM -ResourceGroupName "MyRG" -VM $vm
```
#### <a name="azure-cli-20"></a><span data-ttu-id="05806-186">Azure CLI 2.0</span><span class="sxs-lookup"><span data-stu-id="05806-186">Azure CLI 2.0</span></span>

```bash
az vm update -g "myrg" -n "myvm" --set osProfile.Secrets=[]
```
