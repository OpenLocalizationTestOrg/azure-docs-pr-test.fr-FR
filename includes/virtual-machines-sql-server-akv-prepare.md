## <a name="prepare-for-akv-integration"></a><span data-ttu-id="446d5-101">Préparation pour AKV Integration</span><span class="sxs-lookup"><span data-stu-id="446d5-101">Prepare for AKV Integration</span></span>
<span data-ttu-id="446d5-102">toouse Azure Key Vault Integration tooconfigure votre machine virtuelle SQL Server, il existe plusieurs conditions préalables :</span><span class="sxs-lookup"><span data-stu-id="446d5-102">toouse Azure Key Vault Integration tooconfigure your SQL Server VM, there are several prerequisites:</span></span> 

1. [<span data-ttu-id="446d5-103">Installation d'Azure Powershell</span><span class="sxs-lookup"><span data-stu-id="446d5-103">Install Azure Powershell</span></span>](#install-azure-powershell)
2. [<span data-ttu-id="446d5-104">Création d'un Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="446d5-104">Create an Azure Active Directory</span></span>](#create-an-azure-active-directory)
3. [<span data-ttu-id="446d5-105">Création d’un coffre de clés</span><span class="sxs-lookup"><span data-stu-id="446d5-105">Create a key vault</span></span>](#create-a-key-vault)

<span data-ttu-id="446d5-106">Hello sections suivantes décrivent ces conditions préalables et les informations hello applets de commande PowerShell toocollect toolater exécuter hello.</span><span class="sxs-lookup"><span data-stu-id="446d5-106">hello following sections describe these prerequisites and hello information you need toocollect toolater run hello PowerShell cmdlets.</span></span>

### <a name="install-azure-powershell"></a><span data-ttu-id="446d5-107">Installation d'Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="446d5-107">Install Azure PowerShell</span></span>
<span data-ttu-id="446d5-108">Vérifiez que vous avez installé hello la dernière version du SDK de PowerShell Azure.</span><span class="sxs-lookup"><span data-stu-id="446d5-108">Make sure you have installed hello latest Azure PowerShell SDK.</span></span> <span data-ttu-id="446d5-109">Pour plus d’informations, consultez [comment tooinstall et configurer Azure PowerShell](/powershell/azureps-cmdlets-docs).</span><span class="sxs-lookup"><span data-stu-id="446d5-109">For more information, see [How tooinstall and configure Azure PowerShell](/powershell/azureps-cmdlets-docs).</span></span>

### <a name="create-an-azure-active-directory"></a><span data-ttu-id="446d5-110">Création d'un Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="446d5-110">Create an Azure Active Directory</span></span>
<span data-ttu-id="446d5-111">Tout d’abord, vous devez toohave une [Azure Active Directory](https://azure.microsoft.com/trial/get-started-active-directory/) (AAD) dans votre abonnement.</span><span class="sxs-lookup"><span data-stu-id="446d5-111">First, you need toohave an [Azure Active Directory](https://azure.microsoft.com/trial/get-started-active-directory/) (AAD) in your subscription.</span></span> <span data-ttu-id="446d5-112">Parmi les nombreux avantages, cela vous permet toogrant autorisation tooyour coffre de clés pour certaines applications et les utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="446d5-112">Among many benefits, this allows you toogrant permission tooyour key vault for certain users and applications.</span></span>

<span data-ttu-id="446d5-113">Inscrivez ensuite une application auprès d'ADD.</span><span class="sxs-lookup"><span data-stu-id="446d5-113">Next, register an application with AAD.</span></span> <span data-ttu-id="446d5-114">Cela vous donnera un compte de Principal du Service qui a accès tooyour coffre de clés dont votre machine virtuelle a besoin.</span><span class="sxs-lookup"><span data-stu-id="446d5-114">This will give you a Service Principal account that has access tooyour key vault which your VM will need.</span></span> <span data-ttu-id="446d5-115">Dans l’article de coffre de clés Azure hello, vous pouvez trouver ces étapes Bonjour [inscrire une application avec Azure Active Directory](../articles/key-vault/key-vault-get-started.md#register) section, ou vous pouvez voir les étapes de hello avec des captures d’écran Bonjour **obtenir une identité pour l’application hello section** de [ce billet de blog](http://blogs.technet.com/b/kv/archive/2015/01/09/azure-key-vault-step-by-step.aspx).</span><span class="sxs-lookup"><span data-stu-id="446d5-115">In hello Azure Key Vault article, you can find these steps in hello [Register an application with Azure Active Directory](../articles/key-vault/key-vault-get-started.md#register) section, or you can see hello steps with screen shots in hello **Get an identity for hello application section** of [this blog post](http://blogs.technet.com/b/kv/archive/2015/01/09/azure-key-vault-step-by-step.aspx).</span></span> <span data-ttu-id="446d5-116">Avant d’effectuer ces étapes, notez que vous devez hello toocollect informations au cours de cette inscription est nécessaire ultérieurement, lorsque vous activez Azure Key Vault Integration sur votre VM SQL suivantes.</span><span class="sxs-lookup"><span data-stu-id="446d5-116">Before completing these steps, note that you need toocollect hello following information during this registration that is needed later when you enable Azure Key Vault Integration on your SQL VM.</span></span>

* <span data-ttu-id="446d5-117">Une fois l’application hello est ajoutée, recherche hello **ID CLIENT** sur hello **configurer** onglet.   ![ID de Client Azure Active Directory](./media/virtual-machines-sql-server-akv-prepare/aad-client-id.png)</span><span class="sxs-lookup"><span data-stu-id="446d5-117">After hello application is added, find hello **CLIENT ID**  on hello **CONFIGURE** tab.   ![Azure Active Directory Client ID](./media/virtual-machines-sql-server-akv-prepare/aad-client-id.png)</span></span>
  
    <span data-ttu-id="446d5-118">ID de client Hello est attribué toohello ultérieure **$spName** paramètre (nom Principal de Service) dans tooenable de script PowerShell hello Azure Key Vault Integration.</span><span class="sxs-lookup"><span data-stu-id="446d5-118">hello client ID is assigned later toohello **$spName** (Service Principal name) parameter in hello PowerShell script tooenable Azure Key Vault Integration.</span></span> 
* <span data-ttu-id="446d5-119">En outre, lors de ces étapes lorsque vous créez votre clé, copier hello la clé secrète pour votre clé comme indiqué dans hello suivant capture d’écran.</span><span class="sxs-lookup"><span data-stu-id="446d5-119">Also, during these steps when you create your key, copy hello secret for your key as is shown in hello following screenshot.</span></span> <span data-ttu-id="446d5-120">Cette clé secrète est attribué ultérieure toohello **$spSecret** paramètre (secret Principal du Service) de script PowerShell hello.</span><span class="sxs-lookup"><span data-stu-id="446d5-120">This key secret is assigned later toohello **$spSecret** (Service Principal secret) parameter in hello PowerShell script.</span></span>  
    <span data-ttu-id="446d5-121">![Secret Azure Active Directory](./media/virtual-machines-sql-server-akv-prepare/aad-sp-secret.png)</span><span class="sxs-lookup"><span data-stu-id="446d5-121">![Azure Active Directory Secret](./media/virtual-machines-sql-server-akv-prepare/aad-sp-secret.png)</span></span>
* <span data-ttu-id="446d5-122">Vous devez autoriser cette nouvelle ID toohave messages hello du client les autorisations d’accès suivantes : **chiffrer**, **déchiffrer**, **wrapKey**, **unwrapKey**, **signe**, et **vérifier**.</span><span class="sxs-lookup"><span data-stu-id="446d5-122">You must authorize this new client ID toohave hello following access permissions: **encrypt**, **decrypt**, **wrapKey**, **unwrapKey**, **sign**, and **verify**.</span></span> <span data-ttu-id="446d5-123">Cette opération s’effectue par hello [Set-AzureRmKeyVaultAccessPolicy](https://msdn.microsoft.com/library/azure/mt603625.aspx) applet de commande.</span><span class="sxs-lookup"><span data-stu-id="446d5-123">This is done with hello [Set-AzureRmKeyVaultAccessPolicy](https://msdn.microsoft.com/library/azure/mt603625.aspx) cmdlet.</span></span> <span data-ttu-id="446d5-124">Pour plus d’informations, consultez [Authorize hello application toouse hello clé ou le secret](../articles/key-vault/key-vault-get-started.md#authorize).</span><span class="sxs-lookup"><span data-stu-id="446d5-124">For more information see [Authorize hello application toouse hello key or secret](../articles/key-vault/key-vault-get-started.md#authorize).</span></span>

### <a name="create-a-key-vault"></a><span data-ttu-id="446d5-125">Création d’un coffre de clés</span><span class="sxs-lookup"><span data-stu-id="446d5-125">Create a key vault</span></span>
<span data-ttu-id="446d5-126">Dans toouse Azure Key Vault toostore hello clés de commande que vous allez utiliser pour le chiffrement dans votre machine virtuelle, vous avez besoin d’un coffre de clés tooa accès.</span><span class="sxs-lookup"><span data-stu-id="446d5-126">In order toouse Azure Key Vault toostore hello keys you will use for encryption in your VM, you need access tooa key vault.</span></span> <span data-ttu-id="446d5-127">Si vous n’avez pas déjà configuré votre coffre de clés, créez-le en suivant les étapes de hello Bonjour [prise en main d’Azure Key Vault](../articles/key-vault/key-vault-get-started.md) rubrique.</span><span class="sxs-lookup"><span data-stu-id="446d5-127">If you have not already set up your key vault, create one by following hello steps in hello [Getting Started with Azure Key Vault](../articles/key-vault/key-vault-get-started.md) topic.</span></span> <span data-ttu-id="446d5-128">Avant d’effectuer ces étapes, notez qu’il existe certaines informations que vous devez toocollect au cours de ce qui sont nécessaire ultérieurement lorsque vous activez Azure Key Vault Integration sur votre VM SQL.</span><span class="sxs-lookup"><span data-stu-id="446d5-128">Before completing these steps, note that there is some information you need toocollect during this set up that is needed later when you enable Azure Key Vault Integration on your SQL VM.</span></span>

<span data-ttu-id="446d5-129">Lorsque vous obtenez toohello créer une étape de coffre de clés, hello de Remarque retourné **vaultUri** propriété, qui est l’URL de coffre de clés hello.</span><span class="sxs-lookup"><span data-stu-id="446d5-129">When you get toohello Create a key vault step, note hello returned **vaultUri** property, which is hello key vault URL.</span></span> <span data-ttu-id="446d5-130">Dans l’exemple hello fournie dans cette étape, illustrée ci-dessous, nom de coffre de clés hello est ContosoKeyVault, par conséquent, les URL de coffre de clés hello serait https://contosokeyvault.vault.azure.net/.</span><span class="sxs-lookup"><span data-stu-id="446d5-130">In hello example provided in that step, shown below, hello key vault name is ContosoKeyVault, therefore hello key vault URL would be https://contosokeyvault.vault.azure.net/.</span></span>

    New-AzureRmKeyVault -VaultName 'ContosoKeyVault' -ResourceGroupName 'ContosoResourceGroup' -Location 'East Asia'

<span data-ttu-id="446d5-131">URL de coffre de clés Hello est attribué ultérieure toohello **$akvURL** paramètre hello PowerShell script tooenable Azure Key Vault Integration.</span><span class="sxs-lookup"><span data-stu-id="446d5-131">hello key vault URL is assigned later toohello **$akvURL** parameter in hello PowerShell script tooenable Azure Key Vault Integration.</span></span>

